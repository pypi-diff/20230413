# Comparing `tmp/supy-2023.2.23.dev0-cp39-cp39-win_amd64.whl.zip` & `tmp/supy-2023.4.14.dev0-cp39-cp39-win_amd64.whl.zip`

## zipinfo {}

```diff
@@ -1,63 +1,64 @@
-Zip file size: 2907915 bytes, number of entries: 61
--rw-rw-rw-  2.0 fat     1027 b- defN 23-Feb-23 00:25 supy/__init__.py
--rw-rw-rw-  2.0 fat    13025 b- defN 23-Feb-23 00:25 supy/_check.py
--rw-rw-rw-  2.0 fat     1943 b- defN 23-Feb-23 00:25 supy/_env.py
--rw-rw-rw-  2.0 fat    65655 b- defN 23-Feb-23 00:25 supy/_load.py
--rw-rw-rw-  2.0 fat     2771 b- defN 23-Feb-23 00:25 supy/_misc.py
--rw-rw-rw-  2.0 fat     7237 b- defN 23-Feb-23 00:25 supy/_post.py
--rw-rw-rw-  2.0 fat    19960 b- defN 23-Feb-23 00:25 supy/_run.py
--rw-rw-rw-  2.0 fat    19179 b- defN 23-Feb-23 00:25 supy/_save.py
--rw-rw-rw-  2.0 fat    18173 b- defN 23-Feb-23 00:25 supy/_supy_module.py
--rw-rw-rw-  2.0 fat     1890 b- defN 23-Feb-23 00:25 supy/_version.py
--rw-rw-rw-  2.0 fat      185 b- defN 23-Feb-23 00:28 supy/_version_scm.py
--rw-rw-rw-  2.0 fat    45386 b- defN 23-Feb-23 00:25 supy/checker_rules_indiv.json
--rw-rw-rw-  2.0 fat      472 b- defN 23-Feb-23 00:25 supy/checker_rules_joint.json
--rw-rw-rw-  2.0 fat     7654 b- defN 23-Feb-23 00:25 supy/code2file.json
--rw-rw-rw-  2.0 fat    20576 b- defN 23-Feb-23 00:25 supy/var2siteselect.json
--rw-rw-rw-  2.0 fat     3938 b- defN 23-Feb-23 00:25 supy/cmd/SUEWS.py
--rw-rw-rw-  2.0 fat       74 b- defN 23-Feb-23 00:25 supy/cmd/__init__.py
--rw-rw-rw-  2.0 fat     1347 b- defN 23-Feb-23 00:25 supy/cmd/table_converter.py
--rw-rw-rw-  2.0 fat      942 b- defN 23-Feb-23 00:25 supy/sample_run/RunControl.nml
--rw-rw-rw-  2.0 fat      278 b- defN 23-Feb-23 00:25 supy/sample_run/Input/ESTMinput.nml
--rw-rw-rw-  2.0 fat     2736 b- defN 23-Feb-23 00:25 supy/sample_run/Input/GridLayoutKc.nml
--rw-rw-rw-  2.0 fat      857 b- defN 23-Feb-23 00:25 supy/sample_run/Input/InitialConditionsKc_2011.nml
--rw-rw-rw-  2.0 fat  1103872 b- defN 23-Feb-23 00:25 supy/sample_run/Input/Kc_2011_data_60.txt
--rw-rw-rw-  2.0 fat  1115676 b- defN 23-Feb-23 00:25 supy/sample_run/Input/Kc_2012_data_60.txt
--rw-rw-rw-  2.0 fat     6296 b- defN 23-Feb-23 00:25 supy/sample_run/Input/SUEWS_AnthropogenicEmission.txt
--rw-rw-rw-  2.0 fat      845 b- defN 23-Feb-23 00:25 supy/sample_run/Input/SUEWS_BiogenCO2.txt
--rw-rw-rw-  2.0 fat      460 b- defN 23-Feb-23 00:25 supy/sample_run/Input/SUEWS_Conductance.txt
--rw-rw-rw-  2.0 fat    12795 b- defN 23-Feb-23 00:25 supy/sample_run/Input/SUEWS_ESTMCoefficients.txt
--rw-rw-rw-  2.0 fat     1826 b- defN 23-Feb-23 00:25 supy/sample_run/Input/SUEWS_Irrigation.txt
--rw-rw-rw-  2.0 fat     3366 b- defN 23-Feb-23 00:25 supy/sample_run/Input/SUEWS_NonVeg.txt
--rw-rw-rw-  2.0 fat     6674 b- defN 23-Feb-23 00:25 supy/sample_run/Input/SUEWS_OHMCoefficients.txt
--rw-rw-rw-  2.0 fat     4944 b- defN 23-Feb-23 00:25 supy/sample_run/Input/SUEWS_Profiles.txt
--rw-rw-rw-  2.0 fat      425 b- defN 23-Feb-23 00:25 supy/sample_run/Input/SUEWS_SPARTACUS.nml
--rw-rw-rw-  2.0 fat     4647 b- defN 23-Feb-23 00:25 supy/sample_run/Input/SUEWS_SiteSelect.txt
--rw-rw-rw-  2.0 fat     1672 b- defN 23-Feb-23 00:25 supy/sample_run/Input/SUEWS_Snow.txt
--rw-rw-rw-  2.0 fat     1901 b- defN 23-Feb-23 00:25 supy/sample_run/Input/SUEWS_Soil.txt
--rw-rw-rw-  2.0 fat     6127 b- defN 23-Feb-23 00:25 supy/sample_run/Input/SUEWS_Veg.txt
--rw-rw-rw-  2.0 fat     1526 b- defN 23-Feb-23 00:25 supy/sample_run/Input/SUEWS_Water.txt
--rw-rw-rw-  2.0 fat     2459 b- defN 23-Feb-23 00:25 supy/sample_run/Input/SUEWS_WithinGridWaterDist.txt
--rw-rw-rw-  2.0 fat      766 b- defN 23-Feb-23 00:25 supy/supy_driver/__init__.py
--rw-rw-rw-  2.0 fat 10506874 b- defN 23-Feb-23 00:29 supy/supy_driver/suews_driver.cp39-win_amd64.pyd
--rw-rw-rw-  2.0 fat     8693 b- defN 23-Feb-23 00:25 supy/util/_UMEP2epw.py
--rw-rw-rw-  2.0 fat     1027 b- defN 23-Feb-23 00:25 supy/util/__init__.py
--rw-rw-rw-  2.0 fat     9211 b- defN 23-Feb-23 00:25 supy/util/_atm.py
--rw-rw-rw-  2.0 fat    15593 b- defN 23-Feb-23 00:25 supy/util/_converter.py
--rw-rw-rw-  2.0 fat     6619 b- defN 23-Feb-23 00:25 supy/util/_debug.py
--rw-rw-rw-  2.0 fat    38856 b- defN 23-Feb-23 00:25 supy/util/_era5.py
--rw-rw-rw-  2.0 fat     9478 b- defN 23-Feb-23 00:25 supy/util/_gap_filler.py
--rw-rw-rw-  2.0 fat    21137 b- defN 23-Feb-23 00:25 supy/util/_gs.py
--rw-rw-rw-  2.0 fat     2210 b- defN 23-Feb-23 00:25 supy/util/_io.py
--rw-rw-rw-  2.0 fat     6246 b- defN 23-Feb-23 00:25 supy/util/_ohm.py
--rw-rw-rw-  2.0 fat    12659 b- defN 23-Feb-23 00:25 supy/util/_plot.py
--rw-rw-rw-  2.0 fat     7608 b- defN 23-Feb-23 00:25 supy/util/_roughness.py
--rw-rw-rw-  2.0 fat    16446 b- defN 23-Feb-23 00:25 supy/util/_tmy.py
--rw-rw-rw-  2.0 fat     7065 b- defN 23-Feb-23 00:25 supy/util/_wrf.py
--rw-rw-rw-  2.0 fat    12599 b- defN 23-Feb-23 00:25 supy/util/rules.csv
--rw-rw-rw-  2.0 fat     1458 b- defN 23-Feb-23 00:29 supy-2023.2.23.dev0.dist-info/METADATA
--rw-rw-rw-  2.0 fat      100 b- defN 23-Feb-23 00:29 supy-2023.2.23.dev0.dist-info/WHEEL
--rw-rw-rw-  2.0 fat      111 b- defN 23-Feb-23 00:29 supy-2023.2.23.dev0.dist-info/entry_points.txt
--rw-rw-rw-  2.0 fat        5 b- defN 23-Feb-23 00:29 supy-2023.2.23.dev0.dist-info/top_level.txt
-?rw-rw-r--  2.0 fat     5184 b- defN 23-Feb-23 00:29 supy-2023.2.23.dev0.dist-info/RECORD
-61 files, 13200761 bytes uncompressed, 2899751 bytes compressed:  78.0%
+Zip file size: 2043463 bytes, number of entries: 62
+-rw-rw-rw-  2.0 fat     1027 b- defN 23-Apr-13 14:00 supy/__init__.py
+-rw-rw-rw-  2.0 fat    13025 b- defN 23-Apr-13 14:00 supy/_check.py
+-rw-rw-rw-  2.0 fat     1943 b- defN 23-Apr-13 14:00 supy/_env.py
+-rw-rw-rw-  2.0 fat    66236 b- defN 23-Apr-13 14:00 supy/_load.py
+-rw-rw-rw-  2.0 fat     2771 b- defN 23-Apr-13 14:00 supy/_misc.py
+-rw-rw-rw-  2.0 fat     7820 b- defN 23-Apr-13 14:00 supy/_post.py
+-rw-rw-rw-  2.0 fat    19206 b- defN 23-Apr-13 14:00 supy/_run.py
+-rw-rw-rw-  2.0 fat    19179 b- defN 23-Apr-13 14:00 supy/_save.py
+-rw-rw-rw-  2.0 fat  6710851 b- defN 23-Apr-13 14:04 supy/_supy_driver.cp37-win_amd64.pyd
+-rw-rw-rw-  2.0 fat      639 b- defN 23-Apr-13 14:00 supy/_supy_driver_wrapper.py
+-rw-rw-rw-  2.0 fat    18173 b- defN 23-Apr-13 14:00 supy/_supy_module.py
+-rw-rw-rw-  2.0 fat     1890 b- defN 23-Apr-13 14:00 supy/_version.py
+-rw-rw-rw-  2.0 fat      185 b- defN 23-Apr-13 14:04 supy/_version_scm.py
+-rw-rw-rw-  2.0 fat    44404 b- defN 23-Apr-13 14:00 supy/checker_rules_indiv.json
+-rw-rw-rw-  2.0 fat      472 b- defN 23-Apr-13 14:00 supy/checker_rules_joint.json
+-rw-rw-rw-  2.0 fat     7654 b- defN 23-Apr-13 14:00 supy/code2file.json
+-rw-rw-rw-  2.0 fat   294102 b- defN 23-Apr-13 14:02 supy/supy_driver.py
+-rw-rw-rw-  2.0 fat    20536 b- defN 23-Apr-13 14:00 supy/var2siteselect.json
+-rw-rw-rw-  2.0 fat     4488 b- defN 23-Apr-13 14:00 supy/cmd/SUEWS.py
+-rw-rw-rw-  2.0 fat       74 b- defN 23-Apr-13 14:00 supy/cmd/__init__.py
+-rw-rw-rw-  2.0 fat     1347 b- defN 23-Apr-13 14:00 supy/cmd/table_converter.py
+-rw-rw-rw-  2.0 fat      942 b- defN 23-Apr-13 14:00 supy/sample_run/RunControl.nml
+-rw-rw-rw-  2.0 fat      278 b- defN 23-Apr-13 14:00 supy/sample_run/Input/ESTMinput.nml
+-rw-rw-rw-  2.0 fat     2736 b- defN 23-Apr-13 14:00 supy/sample_run/Input/GridLayoutKc.nml
+-rw-rw-rw-  2.0 fat      857 b- defN 23-Apr-13 14:00 supy/sample_run/Input/InitialConditionsKc_2011.nml
+-rw-rw-rw-  2.0 fat  1103872 b- defN 23-Apr-13 14:00 supy/sample_run/Input/Kc_2011_data_60.txt
+-rw-rw-rw-  2.0 fat  1115676 b- defN 23-Apr-13 14:00 supy/sample_run/Input/Kc_2012_data_60.txt
+-rw-rw-rw-  2.0 fat     6296 b- defN 23-Apr-13 14:00 supy/sample_run/Input/SUEWS_AnthropogenicEmission.txt
+-rw-rw-rw-  2.0 fat      845 b- defN 23-Apr-13 14:00 supy/sample_run/Input/SUEWS_BiogenCO2.txt
+-rw-rw-rw-  2.0 fat      460 b- defN 23-Apr-13 14:00 supy/sample_run/Input/SUEWS_Conductance.txt
+-rw-rw-rw-  2.0 fat    12795 b- defN 23-Apr-13 14:00 supy/sample_run/Input/SUEWS_ESTMCoefficients.txt
+-rw-rw-rw-  2.0 fat     1826 b- defN 23-Apr-13 14:00 supy/sample_run/Input/SUEWS_Irrigation.txt
+-rw-rw-rw-  2.0 fat     3366 b- defN 23-Apr-13 14:00 supy/sample_run/Input/SUEWS_NonVeg.txt
+-rw-rw-rw-  2.0 fat     6674 b- defN 23-Apr-13 14:00 supy/sample_run/Input/SUEWS_OHMCoefficients.txt
+-rw-rw-rw-  2.0 fat     4944 b- defN 23-Apr-13 14:00 supy/sample_run/Input/SUEWS_Profiles.txt
+-rw-rw-rw-  2.0 fat      425 b- defN 23-Apr-13 14:00 supy/sample_run/Input/SUEWS_SPARTACUS.nml
+-rw-rw-rw-  2.0 fat     4647 b- defN 23-Apr-13 14:00 supy/sample_run/Input/SUEWS_SiteSelect.txt
+-rw-rw-rw-  2.0 fat     1672 b- defN 23-Apr-13 14:00 supy/sample_run/Input/SUEWS_Snow.txt
+-rw-rw-rw-  2.0 fat     1901 b- defN 23-Apr-13 14:00 supy/sample_run/Input/SUEWS_Soil.txt
+-rw-rw-rw-  2.0 fat     6127 b- defN 23-Apr-13 14:00 supy/sample_run/Input/SUEWS_Veg.txt
+-rw-rw-rw-  2.0 fat     1526 b- defN 23-Apr-13 14:00 supy/sample_run/Input/SUEWS_Water.txt
+-rw-rw-rw-  2.0 fat     2459 b- defN 23-Apr-13 14:00 supy/sample_run/Input/SUEWS_WithinGridWaterDist.txt
+-rw-rw-rw-  2.0 fat     8693 b- defN 23-Apr-13 14:00 supy/util/_UMEP2epw.py
+-rw-rw-rw-  2.0 fat     1027 b- defN 23-Apr-13 14:00 supy/util/__init__.py
+-rw-rw-rw-  2.0 fat     9211 b- defN 23-Apr-13 14:00 supy/util/_atm.py
+-rw-rw-rw-  2.0 fat    15593 b- defN 23-Apr-13 14:00 supy/util/_converter.py
+-rw-rw-rw-  2.0 fat     6619 b- defN 23-Apr-13 14:00 supy/util/_debug.py
+-rw-rw-rw-  2.0 fat    38856 b- defN 23-Apr-13 14:00 supy/util/_era5.py
+-rw-rw-rw-  2.0 fat     9478 b- defN 23-Apr-13 14:00 supy/util/_gap_filler.py
+-rw-rw-rw-  2.0 fat    21137 b- defN 23-Apr-13 14:00 supy/util/_gs.py
+-rw-rw-rw-  2.0 fat     2210 b- defN 23-Apr-13 14:00 supy/util/_io.py
+-rw-rw-rw-  2.0 fat     6246 b- defN 23-Apr-13 14:00 supy/util/_ohm.py
+-rw-rw-rw-  2.0 fat    12659 b- defN 23-Apr-13 14:00 supy/util/_plot.py
+-rw-rw-rw-  2.0 fat     7608 b- defN 23-Apr-13 14:00 supy/util/_roughness.py
+-rw-rw-rw-  2.0 fat    16446 b- defN 23-Apr-13 14:00 supy/util/_tmy.py
+-rw-rw-rw-  2.0 fat     7065 b- defN 23-Apr-13 14:00 supy/util/_wrf.py
+-rw-rw-rw-  2.0 fat    12808 b- defN 23-Apr-13 14:00 supy/util/rules.csv
+-rw-rw-rw-  2.0 fat     1482 b- defN 23-Apr-13 14:04 supy-2023.4.14.dev0.dist-info/METADATA
+-rw-rw-rw-  2.0 fat      100 b- defN 23-Apr-13 14:04 supy-2023.4.14.dev0.dist-info/WHEEL
+-rw-rw-rw-  2.0 fat      111 b- defN 23-Apr-13 14:04 supy-2023.4.14.dev0.dist-info/entry_points.txt
+-rw-rw-rw-  2.0 fat       17 b- defN 23-Apr-13 14:04 supy-2023.4.14.dev0.dist-info/top_level.txt
+-rw-rw-r--  2.0 fat     5250 b- defN 23-Apr-13 14:04 supy-2023.4.14.dev0.dist-info/RECORD
+62 files, 9698962 bytes uncompressed, 2035209 bytes compressed:  79.0%
```

## zipnote {}

```diff
@@ -18,14 +18,20 @@
 
 Filename: supy/_run.py
 Comment: 
 
 Filename: supy/_save.py
 Comment: 
 
+Filename: supy/_supy_driver.cp37-win_amd64.pyd
+Comment: 
+
+Filename: supy/_supy_driver_wrapper.py
+Comment: 
+
 Filename: supy/_supy_module.py
 Comment: 
 
 Filename: supy/_version.py
 Comment: 
 
 Filename: supy/_version_scm.py
@@ -36,14 +42,17 @@
 
 Filename: supy/checker_rules_joint.json
 Comment: 
 
 Filename: supy/code2file.json
 Comment: 
 
+Filename: supy/supy_driver.py
+Comment: 
+
 Filename: supy/var2siteselect.json
 Comment: 
 
 Filename: supy/cmd/SUEWS.py
 Comment: 
 
 Filename: supy/cmd/__init__.py
@@ -111,20 +120,14 @@
 
 Filename: supy/sample_run/Input/SUEWS_Water.txt
 Comment: 
 
 Filename: supy/sample_run/Input/SUEWS_WithinGridWaterDist.txt
 Comment: 
 
-Filename: supy/supy_driver/__init__.py
-Comment: 
-
-Filename: supy/supy_driver/suews_driver.cp39-win_amd64.pyd
-Comment: 
-
 Filename: supy/util/_UMEP2epw.py
 Comment: 
 
 Filename: supy/util/__init__.py
 Comment: 
 
 Filename: supy/util/_atm.py
@@ -162,23 +165,23 @@
 
 Filename: supy/util/_wrf.py
 Comment: 
 
 Filename: supy/util/rules.csv
 Comment: 
 
-Filename: supy-2023.2.23.dev0.dist-info/METADATA
+Filename: supy-2023.4.14.dev0.dist-info/METADATA
 Comment: 
 
-Filename: supy-2023.2.23.dev0.dist-info/WHEEL
+Filename: supy-2023.4.14.dev0.dist-info/WHEEL
 Comment: 
 
-Filename: supy-2023.2.23.dev0.dist-info/entry_points.txt
+Filename: supy-2023.4.14.dev0.dist-info/entry_points.txt
 Comment: 
 
-Filename: supy-2023.2.23.dev0.dist-info/top_level.txt
+Filename: supy-2023.4.14.dev0.dist-info/top_level.txt
 Comment: 
 
-Filename: supy-2023.2.23.dev0.dist-info/RECORD
+Filename: supy-2023.4.14.dev0.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## supy/_load.py

```diff
@@ -1,26 +1,32 @@
 import functools
 from datetime import timedelta
 from pathlib import Path
 
 import f90nml
 import numpy as np
 import pandas as pd
-# import .supy_driver as spd
+
+
 # from .supy_driver import suews_driver as sd
-from .supy_driver.suews_driver import suews_driver as sd
+# from ._supy_driver_wrapper import suews_driver as sd
+from . import _supy_driver as _sd
 
 from ._env import logger_supy, trv_supy_module
 from ._misc import path_insensitive
 
+# print("Loading supy module ...")
+# print(dir(sd))
+# print(sd.f90wrap_suews_cal_main.__doc__)
+
 
 ########################################################################
 # get_args_suews can get the interface information
 # of the f2py-converted Fortran interface
-def get_args_suews(docstring=sd.suews_cal_main.__doc__):
+def get_args_suews(docstring=_sd.f90wrap_suews_cal_main.__doc__):
     # split doc lines for processing
     docLines = np.array(docstring.splitlines(), dtype=str)
 
     dict_inout_sd = extract_dict_docs(docLines)
 
     return dict_inout_sd
 
@@ -28,43 +34,54 @@
 def extract_dict_docs(docLines):
     # get the information of input variables for SUEWS_driver
     ser_docs = pd.Series(docLines)
     varInputLines = ser_docs[ser_docs.str.contains("input|in/output")].values
     varInputInfo = np.array(
         [[xx.rstrip() for xx in x.split(":")] for x in varInputLines]
     )
+    # varInputInfo
     dict_InputInfo = {xx[0]: xx[1] for xx in varInputInfo}
     dict_InOutInfo = {xx[0]: xx[1] for xx in varInputInfo if "in/out" in xx[1]}
+
+    list_var_inout = tuple(dict_InOutInfo.keys())
+    list_var_in = tuple(set(dict_InputInfo.keys()))
+    # dict_InOutInfo
     # get the information of output variables for SUEWS_driver
-    posOutput = np.where(docLines == "Returns")
-    varOutputLines = docLines[posOutput[0][0] + 2 :]
+
+    varOutputLines = ser_docs[ser_docs.str.startswith(("dataout", "dailystate"))].values
+
+    # varOutputLines = docLines[posOutput[0][0] + 2 :]
     varOutputInfo = np.array(
         [[xx.rstrip() for xx in x.split(":")] for x in varOutputLines]
     )
+    # varOutputInfo
     dict_OutputInfo = {xx[0]: xx[1] for xx in varOutputInfo}
+    list_var_out = tuple(dict_OutputInfo.keys())
+    list_var_inout = set(list_var_inout) - set(list_var_out)
+    # list_var_in= set(list_var_in) - set(list_var_out)
     # pack in/out results:
     dict_inout_sd = {
         # 'input' and 'output' are dict's that store variable information:
         # 1. intent: e.g., input, in/output
         # 2. dimension: e.g., (366,7)
         "input": dict_InputInfo,
         "output": dict_OutputInfo,
         # 'var_input' and 'var_output' are tuples,
         # that keep the order of arguments as in the Fortran subroutine
-        "var_input": tuple(varInputInfo[:, 0]),
-        "var_inout": tuple(dict_InOutInfo.keys()),
-        "var_output": tuple(varOutputInfo[:, 0]),
+        "var_input": list_var_in,
+        "var_inout": list_var_inout,
+        "var_output": list_var_out,
     }
     return dict_inout_sd
 
 
 # for `suews_cal_multitsteps`
 def get_args_suews_multitsteps():
     # split doc lines for processing
-    docLines = np.array(sd.suews_cal_multitsteps.__doc__.splitlines(), dtype=str)
+    docLines = np.array(_sd.f90wrap_suews_cal_multitsteps.__doc__.splitlines(), dtype=str)
 
     dict_inout_sd = extract_dict_docs(docLines)
 
     return dict_inout_sd
 
 
 # store these lists for later use
@@ -84,15 +101,15 @@
 
 # variables used in df_state
 set_var_use = set_var_input.intersection(set_var_input_multitsteps)
 
 ##############################################################################
 # input processor
 # 1. surface properties will be retrieved and packed together for later use
-# 2. met forcing conditions will splitted into time steps and used to derive
+# 2. met forcing conditions will split into time steps and used to derive
 # other information
 
 ######################################################################
 # descriptive list/dicts for variables
 # minimal required input files for configuration:
 list_file_input = [
     "SUEWS_AnthropogenicEmission.txt",
@@ -211,23 +228,28 @@
 def gen_suews_arg_info_df(docstring):
     dict_info = get_args_suews(docstring)["input"]
     # dict_info.update(get_args_suews(docstring)['output'])
     dict_info = {var: extract_var_info(var, dict_info) for var in dict_info}
     df_info = pd.DataFrame(dict_info).T
     return df_info
 
+
 # note: infer data types for variables to avoid type conversion
-df_info_suews_cal_main = gen_suews_arg_info_df(sd.suews_cal_main.__doc__).infer_objects()
-df_info_suews_cal_multitsteps = gen_suews_arg_info_df(sd.suews_cal_multitsteps.__doc__).infer_objects()
+df_info_suews_cal_main = gen_suews_arg_info_df(
+    _sd.f90wrap_suews_cal_main.__doc__
+).infer_objects()
+df_info_suews_cal_multitsteps = gen_suews_arg_info_df(
+    _sd.f90wrap_suews_cal_multitsteps.__doc__
+).infer_objects()
 
 df_var_info = df_info_suews_cal_multitsteps.merge(
     df_info_suews_cal_main,
     how="outer",
 )
-df_var_info=df_var_info.set_index("name")
+df_var_info = df_var_info.set_index("name")
 
 
 # load model settings
 # load configurations: mod_config
 # process RunControl.nml
 # this function can handle all SUEWS nml files
 def load_SUEWS_nml_simple(path_file):
@@ -1261,18 +1283,18 @@
     df_state_slim.columns = df_state_slim.columns.remove_unused_levels()
 
     return df_state_slim
 
 
 # mod_config: static properties
 dict_RunControl_default = {
-    "aerodynamicresistancemethod": 2,
-    "basetmethod": 1,
+    # "aerodynamicresistancemethod": 2, #removed in SUEWS v2023
+    # "basetmethod": 1, #removed in SUEWS v2023
     "evapmethod": 2,
-    "laicalcyes": 1,
+    # "laicalcyes": 1, #removed in SUEWS v2023
     "veg_type": 1,
     "diagnose": 0,
     "diagnosedisagg": 0,
     "diagnosedisaggestm": 0,
     "diagqn": 0,
     "diagqs": 0,
     "keeptstepfilesin": 0,
```

## supy/_post.py

```diff
@@ -83,15 +83,15 @@
     xx3 = gb_xx2.agg(lambda x: tuple(x.values)).applymap(np.array)
 
     return xx3
 
 
 # generate MultiIndex for variable groups
 def gen_index(varline_x):
-    var_x = varline_x.replace("dataoutline", "").replace("line", "")
+    var_x = varline_x.replace("dataout", "").replace("block", "").replace("line", "")
     group = var_df_lower[var_x]
     var = var_df.loc[group].index.tolist()
     mindex = pd.MultiIndex.from_product([[group], var], names=["group", "var"])
     return mindex
 
 
 # generate one MultiIndex from a whole dict
@@ -112,15 +112,19 @@
 def comb_gen_Series(dict_x):
     x_keys = dict_x.keys()
     res_Series = pd.concat([gen_Series(dict_x, k) for k in x_keys])
     return res_Series
 
 
 # pack up output of `run_suews`
-def pack_df_output(dict_output):
+def pack_df_output_line(dict_output):
+    import pickle
+
+    pickle.dump(dict_output, open("dict_output.pkl", "wb"))
+    print("dict_output saved to dict_output.pkl")
     # TODO: add output levels as in the Fortran version
     df_output = pd.DataFrame(dict_output).T
     # df_output = pd.concat(dict_output).to_frame().unstack()
     # set index level names
     index = df_output.index.set_names(["datetime", "grid"])
     # clean columns
     columns = gen_MultiIndex(df_output.iloc[0])
@@ -154,31 +158,43 @@
 
     # set index level names
     df_grid_res.index.set_names(["grid", "datetime"], inplace=True)
 
     return df_grid_res
 
 
+def pack_df_output_block(dict_output_block, df_forcing_block):
+    col_df = gen_MultiIndex(dict_output_block)
+    val_df = np.hstack([ar[:, 5:] for ar in dict_output_block.values()])
+    ind_df = df_forcing_block.index.rename("datetime")
+    df_out = pd.DataFrame(val_df, columns=col_df, index=ind_df)
+
+    return df_out
+
+
 # resample supy output
 def resample_output(df_output, freq="60T", dict_aggm=dict_var_aggm):
-
     # get grid and group names
     list_grid = df_output.index.get_level_values("grid").unique()
     list_group = df_output.columns.get_level_values("group").unique()
 
     # resampling output according to different rules defined in dict_aggm
     # note the setting in .resample: (closed='right',label='right')
     # which is to conform to SUEWS convention
     # that timestamp refer to the ending of previous period
     df_rsmp = pd.concat(
         {
             grid: pd.concat(
                 {
                     group: df_output.loc[grid, group]
-                    .resample(freq, closed="right", label="right",)
+                    .resample(
+                        freq,
+                        closed="right",
+                        label="right",
+                    )
                     .agg(dict_aggm[group])
                     for group in list_group
                 },
                 axis=1,
                 names=["group", "var"],
             )
             for grid in list_grid
```

## supy/_run.py

```diff
@@ -11,26 +11,26 @@
 from ast import literal_eval
 from pathlib import Path
 from typing import Tuple
 import pandas
 
 import numpy as np
 import pandas as pd
-from .supy_driver import suews_driver as sd
+from ._supy_driver_wrapper import suews_driver as sd
 
 from ._load import (
     df_var_info,
     list_var_inout,
     list_var_inout_multitsteps,
     list_var_input,
     list_var_input_multitsteps,
     list_var_output,
     list_var_output_multitsteps,
 )
-from ._post import pack_df_output, pack_df_output_array, pack_df_state
+from ._post import pack_df_output_line, pack_df_output_array, pack_df_state
 
 from ._env import logger_supy
 
 from .util._debug import save_zip_debug
 
 
 ##############################################################################
@@ -60,14 +60,17 @@
             print(f"{var} is not in dict_input")
             print("\n")
 
     dict_input = {k: dict_input[k] for k in list_var_input}
 
     # main calculation:
     try:
+        # import pickle
+        # pickle.dump(dict_input, open("dict_input.pkl", "wb"))
+        # print("dict_input.pkl saved")
         res_suews_tstep = sd.suews_cal_main(**dict_input)
     except Exception as ex:
         # show trace info
         logger_supy.exception(traceback.format_exc())
         # show SUEWS fatal error details produced by SUEWS kernel
         with open("problems.txt", "r") as f:
             logger_supy.critical(f.read())
@@ -84,43 +87,63 @@
         )
 
         # update timestep info
         dict_state_end["tstep_prev"] = dict_state_end["tstep"]
         dict_state_end["dt_since_start"] += dict_state_end["tstep"]
 
         # pack output
-        dict_output = {k: v for k, v in zip(list_var_output, res_suews_tstep)}
+        list_var = [
+            var
+            for var in dir(res_suews_tstep)
+            if not var.startswith("_") and not callable(getattr(res_suews_tstep, var))
+        ]
+        list_arr = [
+            (
+                getattr(res_suews_tstep, var)
+                if "datetime" in var
+                else getattr(res_suews_tstep, var)[5:]
+            )
+            for var in list_var
+        ]
+        dict_output = dict(zip(list_var, list_arr))
+        # dict_output = {k: v for k, v in zip(list_var_output, res_suews_tstep)}
 
         return dict_state_end, dict_output
 
 
 # high-level wrapper: suews_cal_tstep
 # def suews_cal_tstep_multi(df_state_start_grid, df_met_forcing_block):
-def suews_cal_tstep_multi(dict_state_start_grid, df_met_forcing_block):
+def suews_cal_tstep_multi(dict_state_start, df_forcing_block):
+    from ._post import pack_df_output_block
+
     # use single dict as input for suews_cal_main
-    dict_input = copy.deepcopy(dict_state_start_grid)
+    dict_input = copy.deepcopy(dict_state_start)
     dict_input.update(
         {
             "metforcingblock": np.array(
-                df_met_forcing_block.drop(
+                df_forcing_block.drop(
                     columns=[
                         "metforcingdata_grid",
                         "ts5mindata_ir",
                         "isec",
                     ]
                 ),
                 order="F",
             ),
-            "ts5mindata_ir": np.array(df_met_forcing_block["ts5mindata_ir"], order="F"),
-            "len_sim": np.array(df_met_forcing_block.shape[0], dtype=int),
+            "ts5mindata_ir": np.array(df_forcing_block["ts5mindata_ir"], order="F"),
+            "len_sim": np.array(df_forcing_block.shape[0], dtype=int),
         }
     )
     dict_input = {k: dict_input[k] for k in list_var_input_multitsteps}
+    # dict_input = {k: dict_input[k] if k in dict_input else np.array([0.0]) for k in list_var_input_multitsteps}
+
+    # print('list_var_input_multitsteps',list_var_input_multitsteps)
 
     # main calculation:
+
     try:
         res_suews_tstep_multi = sd.suews_cal_multitsteps(**dict_input)
     except Exception as ex:
         # show trace info
         # print(traceback.format_exc())
         # show SUEWS fatal error details produced by SUEWS kernel
         with open("problems.txt", "r") as f:
@@ -128,32 +151,41 @@
         # clean slate
         # os.remove('problems.txt')
         # sys.exit()
         # raise RuntimeError("Something bad happened") from exs
         logger_supy.critical("SUEWS kernel error")
     else:
         # update state variables
-        # dict_state_end = copy.copy(dict_input)
-        dict_state_end = copy.deepcopy(dict_state_start_grid)
+        # dict_state_end = copy.deepcopy(dict_input)
+        dict_state_end = copy.deepcopy(dict_state_start)
+
         dict_state_end.update(
             {var: dict_input[var] for var in list_var_inout_multitsteps}
+            # {var: dict_input[var] for var in list(dict_input.keys())}
         )
 
         # update timestep info
         dict_state_end["tstep_prev"] = dict_state_end["tstep"]
-        idx_dt = df_met_forcing_block.index
+        idx_dt = df_forcing_block.index
         duration_s = int((idx_dt[-1] - idx_dt[0]).total_seconds())
         dict_state_end["dt_since_start"] += duration_s + dict_state_end["tstep"]
 
-        # pack output
-        dict_output_array = {
-            k: v for k, v in zip(list_var_output[1:], res_suews_tstep_multi)
-        }
+        # pack output into dataframe
+        list_var = [
+            var
+            for var in dir(res_suews_tstep_multi)
+            if not var.startswith("_")
+            and not callable(getattr(res_suews_tstep_multi, var))
+        ]
+        list_arr = [getattr(res_suews_tstep_multi, var) for var in sorted(list_var)]
+        dict_output_array = dict(zip(list_var, list_arr))
+        df_output_block = pack_df_output_block(dict_output_array, df_forcing_block)
 
-        return dict_state_end, dict_output_array
+
+        return dict_state_end, df_output_block
 
 
 # dataframe based wrapper
 # serial mode:
 def run_supy_ser(
     df_forcing: pandas.DataFrame,
     df_state_init: pandas.DataFrame,
@@ -200,15 +232,18 @@
         idx_dt = df_init.index.get_level_values("datetime").unique()
         dt_last = idx_dt.max()
         df_init = df_init.loc[dt_last]
 
     # add placeholder variables for df_forcing
     # `metforcingdata_grid` and `ts5mindata_ir` are used by AnOHM and ESTM, respectively
     # they are now temporarily disabled in supy
-    df_forcing = df_forcing.assign(metforcingdata_grid=0, ts5mindata_ir=0,).rename(
+    df_forcing = df_forcing.assign(
+        metforcingdata_grid=0,
+        ts5mindata_ir=0,
+    ).rename(
         # rename is a workaround to resolve naming inconsistency between
         # suews fortran code interface and input forcing file headers
         columns={
             "%" + "iy": "iy",
             "id": "id",
             "it": "it",
             "imin": "imin",
@@ -268,15 +303,15 @@
     df_forcing = df_forcing.loc[:, list_var_forcing]
 
     # grid list determined by initial states
     list_grid = df_init.index
 
     # initialise dicts for holding results and model states
     dict_state = {}
-    dict_output = {}
+    dict_df_output = {}
 
     # initial and final tsteps retrieved from forcing data
     tstep_init = df_forcing.index[0]
     tstep_final = df_forcing.index[-1]
     # tstep size retrieved from forcing data
     freq = df_forcing.index.freq
 
@@ -287,130 +322,97 @@
         for grid, ser_state_init in df_init.iterrows()
     }
 
     # remove 'problems.txt'
     if Path("problems.txt").exists():
         os.remove("problems.txt")
 
+    # for multi-year run, reduce the whole df_forcing into {chunk_day}-day chunks for less memory consumption
+    idx_start = df_forcing.index.min()
+    idx_all = df_forcing.index
     if save_state:
-        # use slower more functional single step wrapper
-
-        # convert df to dict with `itertuples` for better performance
-        dict_forcing = {row.Index: row._asdict() for row in df_forcing.itertuples()}
-
-        for tstep in df_forcing.index:
-            # temporal loop
-            # initialise output of tstep:
-            # load met_forcing if the same across all grids:
-            met_forcing_tstep = dict_forcing[tstep]
-            # print(met_forcing_tstep.keys())
-            # spatial loop
-            for grid in list_grid:
-                dict_state_start = dict_state[(tstep, grid)]
-                # calculation at one step:
-                try:
-                    dict_state_end, dict_output_tstep = suews_cal_tstep(
-                        dict_state_start, met_forcing_tstep
-                    )
-                except:
-                    # if calculation fails, save the state and output of the previous step
-                    path_zip_debug = save_zip_debug(df_forcing, df_state_init)
-                    raise RuntimeError(
-                        f"\n====================\n"
-                        f"SUEWS kernel error!\n"
-                        f"A zip file for debugging has been saved as `{path_zip_debug.as_posix()}`:"
-                        f"Please report this issue with the above zip file to the developer at"
-                        f" https://github.com/UMEP-dev/SuPy/issues/new?assignees=&labels=&template=issue-report.md."
-                        f"\n====================\n")
-
-                # update output & model state at tstep for the current grid
-                dict_output.update({(tstep, grid): dict_output_tstep})
-                dict_state.update({(tstep + 1 * freq, grid): dict_state_end})
-
-        # pack results as easier DataFrames
-        df_output = pack_df_output(dict_output).swaplevel(0, 1)
-        # drop unnecessary 'datetime' as it is already included in the index
-        df_output = df_output.drop(columns=["datetime"], level=0)
-        df_state_final = pack_df_state(dict_state).swaplevel(0, 1)
-
+        # if save_state is True, the forcing is split into chunks of every timestep
+        # this is to ensure that the model states are saved at each timestep
+        grp_forcing_chunk = df_forcing.groupby(idx_all)
     else:
-        # for multi-year run, reduce the whole df_forcing into {chunk_day}-day chunks for less memory consumption
-        idx_start = df_forcing.index.min()
-        idx_all = df_forcing.index
         grp_forcing_chunk = df_forcing.groupby(
             (idx_all - idx_start) // pd.Timedelta(chunk_day, "d")
         )
-        if len(grp_forcing_chunk) > 1:
-            df_state_init_chunk = df_state_init.copy()
-            list_df_output = []
-            list_df_state = []
-            for grp in grp_forcing_chunk.groups:
-                # get forcing of a specific year
-                df_forcing_chunk = grp_forcing_chunk.get_group(grp)
-                # run supy: actual execution done in the `else` clause below
-                df_output_yr, df_state_final_chunk = run_supy_ser(
-                    df_forcing_chunk, df_state_init_chunk, chunk_day=chunk_day
-                )
-                df_state_init_chunk = df_state_final_chunk.copy()
-                # collect results
-                list_df_output.append(df_output_yr)
-                list_df_state.append(df_state_final_chunk)
-
-            # re-organise results of each year
-            df_output = pd.concat(list_df_output).sort_index()
-            df_state_final = pd.concat(list_df_state).sort_index().drop_duplicates()
-            return df_output, df_state_final
+    n_chunk = len(grp_forcing_chunk)
+    if n_chunk > 1:
+        logger_supy.info(
+            f"Forcing is split into {n_chunk:d} chunks for less memory consumption."
+        )
+        df_state_init_chunk = df_state_init.copy()
+        list_df_output = []
+        list_df_state = []
+        for grp in grp_forcing_chunk.groups:
+            # get forcing of a specific year
+            df_forcing_chunk = grp_forcing_chunk.get_group(grp)
+            # run supy: actual execution done in the `else` clause below
+            df_output_chunk, df_state_final_chunk = run_supy_ser(
+                df_forcing_chunk, df_state_init_chunk, chunk_day=chunk_day
+            )
+            df_state_init_chunk = df_state_final_chunk.copy()
+            # collect results
+            list_df_output.append(df_output_chunk)
+            list_df_state.append(df_state_final_chunk)
+
+        # re-organise results of each year
+        df_output = pd.concat(list_df_output).sort_index()
+        df_state_final = pd.concat(list_df_state).sort_index().drop_duplicates()
+        return df_output, df_state_final
 
-        else:
-            # for single-chunk run (1 chunk = {chunk_day} years), directly put df_forcing into supy_driver for calculation
-            # use higher level wrapper that calculate at a `block` level
-            # for better performance
-
-            # # construct input list for `Pool.starmap`
-            # construct input list for `dask.bag`
-            list_dict_input = [
-                # (dict_state[(tstep_init, grid)], df_forcing)
-                dict_state[(tstep_init, grid)]
-                for grid in list_grid
+    else:
+        # for single-chunk run (1 chunk = {chunk_day} years), directly put df_forcing into supy_driver for calculation
+        # use higher level wrapper that calculate at a `block` level
+        # for better performance
+
+        # # construct input list for `Pool.starmap`
+        # construct input list for `dask.bag`
+        list_dict_state_input = [
+            # (dict_state[(tstep_init, grid)], df_forcing)
+            dict_state[(tstep_init, grid)]
+            for grid in list_grid
+        ]
+
+        try:
+            list_res_grid = [
+                suews_cal_tstep_multi(dict_state_input, df_forcing)
+                for dict_state_input in list_dict_state_input
             ]
+            list_dict_state_end, list_df_output = zip(*list_res_grid)
+
+        except:
+            path_zip_debug = save_zip_debug(df_forcing, df_state_init)
+            raise RuntimeError(
+                f"\n====================\n"
+                f"SUEWS kernel error!\n"
+                f"A zip file for debugging has been saved as `{path_zip_debug.as_posix()}`:"
+                f"Please report this issue with the above zip file to the developer at"
+                f" https://github.com/UMEP-dev/SuPy/issues/new?assignees=&labels=&template=issue-report.md."
+                f"\n====================\n"
+            )
+
+        # collect output arrays
+        dict_df_output = {
+            grid: df_output for grid, df_output in zip(list_grid, list_df_output)
+        }
+
+        # collect final states
+        dict_state_final_tstep = {
+            (tstep_final + freq, grid): dict_state_end
+            for grid, dict_state_end in zip(list_grid, list_dict_state_end)
+        }
+        dict_state.update(dict_state_final_tstep)
 
-            try:
-                list_res = [
-                    suews_cal_tstep_multi(dict_input_grid, df_forcing)
-                    for dict_input_grid in list_dict_input
-                ]
-                list_state_end, list_output_array = zip(*list_res)
-
-            except:
-                path_zip_debug = save_zip_debug(df_forcing, df_state_init)
-                raise RuntimeError(
-                    f"\n====================\n"
-                    f"SUEWS kernel error!\n"
-                    f"A zip file for debugging has been saved as `{path_zip_debug.as_posix()}`:"
-                    f"Please report this issue with the above zip file to the developer at"
-                    f" https://github.com/UMEP-dev/SuPy/issues/new?assignees=&labels=&template=issue-report.md."
-                    f"\n====================\n")
-
-            # collect output arrays
-            dict_output = {
-                grid: dict_output_array
-                for grid, dict_output_array in zip(list_grid, list_output_array)
-            }
-
-            # collect final states
-            dict_state_final_tstep = {
-                (tstep_final + freq, grid): dict_state_end
-                for grid, dict_state_end in zip(list_grid, list_state_end)
-            }
-            dict_state.update(dict_state_final_tstep)
-
-            # save results as time-aware DataFrame
-            df_output0 = pack_df_output_array(dict_output, df_forcing)
-            df_output = df_output0.replace(-999.0, np.nan)
-            df_state_final = pack_df_state(dict_state).swaplevel(0, 1)
+        # save results as time-aware DataFrame
+        df_output0 = pd.concat(dict_df_output, names=["grid"]).sort_index()
+        df_output = df_output0.replace(-999.0, np.nan)
+        df_state_final = pack_df_state(dict_state).swaplevel(0, 1)
 
     # drop ESTM for now as it is not supported yet
     df_output = df_output.drop("ESTM", axis=1, level="group")
     # trim multi-index based columns
     df_output.columns = df_output.columns.remove_unused_levels()
 
     # pack final model states into a proper dataframe
@@ -464,18 +466,15 @@
                     list_n_yr,
                     list_dir_temp,
                 ),
             )
 
         # load dumped h5 files
         df_output = pd.concat(
-            [
-                pd.read_pickle(path_dir_temp / f"{n}_out.pkl")
-                for n in np.arange(n_grid)
-            ]
+            [pd.read_pickle(path_dir_temp / f"{n}_out.pkl") for n in np.arange(n_grid)]
         )
         df_state_final = pd.concat(
             [
                 pd.read_pickle(path_dir_temp / f"{n}_state.pkl")
                 for n in np.arange(n_grid)
             ]
         )
```

## supy/_version_scm.py

```diff
@@ -1,4 +1,4 @@
 # file generated by setuptools_scm
 # don't change, don't track in version control
-__version__ = version = '2023.2.23.dev0'
-__version_tuple__ = version_tuple = (2023, 2, 23, 'dev0')
+__version__ = version = '2023.4.14.dev0'
+__version_tuple__ = version_tuple = (2023, 4, 14, 'dev0')
```

## supy/checker_rules_indiv.json

### Pretty-printed

 * *Similarity: 0.9301470588235294%*

 * *Differences: {"'g_k'": "OrderedDict([('cat', 'grid'), ('logic', 'NA'), ('param', OrderedDict()), ('unit', "*

 * *          "'1')])",*

 * * "'g_max'": "OrderedDict([('cat', 'grid'), ('logic', 'range'), ('param', OrderedDict([('max', 10), "*

 * *            "('min', 0)])), ('unit', '1')])",*

 * * "'g_q_base'": "OrderedDict([('cat', 'grid'), ('logic', 'NA'), ('param', OrderedDict()), ('unit', "*

 * *               "'1')])",*

 * * "'g_q_shape'": "OrderedDict([('cat', 'grid'), ('logic', 'NA'), ('param', OrderedDict()), ('unit', "*

 * *                "'1')])" […]*

```diff
@@ -25,20 +25,14 @@
         "optional": false,
         "param": {
             "max": 60,
             "min": 0.0001
         },
         "unit": "m s-1"
     },
-    "aerodynamicresistancemethod": {
-        "cat": "cfg",
-        "logic": "NA",
-        "param": {},
-        "unit": "1"
-    },
     "ah_min": {
         "cat": "grid",
         "logic": "range",
         "param": {
             "max": "inf",
             "min": 0
         },
@@ -250,23 +244,14 @@
         "logic": "range",
         "param": {
             "max": "inf",
             "min": "-inf"
         },
         "unit": "1"
     },
-    "baset_hc": {
-        "cat": "grid",
-        "logic": "range",
-        "param": {
-            "max": "inf",
-            "min": "-inf"
-        },
-        "unit": "1"
-    },
     "baset_heating": {
         "cat": "grid",
         "logic": "range",
         "param": {
             "max": "inf",
             "min": "-inf"
         },
@@ -277,25 +262,14 @@
         "logic": "range",
         "param": {
             "max": "inf",
             "min": "-inf"
         },
         "unit": "1"
     },
-    "basetmethod": {
-        "cat": "grid",
-        "logic": "method",
-        "param": {
-            "allowed": [
-                1,
-                2
-            ]
-        },
-        "unit": "1"
-    },
     "beta_bioco2": {
         "cat": "grid",
         "logic": "NA",
         "param": {},
         "unit": "1"
     },
     "beta_enh_bioco2": {
@@ -464,26 +438,14 @@
     },
     "diagnose": {
         "cat": "grid",
         "logic": "NA",
         "param": {},
         "unit": "1"
     },
-    "diagqn": {
-        "cat": "grid",
-        "logic": "NA",
-        "param": {},
-        "unit": "1"
-    },
-    "diagqs": {
-        "cat": "grid",
-        "logic": "NA",
-        "param": {},
-        "unit": "1"
-    },
     "dqndt": {
         "cat": "grid",
         "logic": "NA",
         "param": {},
         "unit": "1"
     },
     "dqnsdt": {
@@ -588,20 +550,14 @@
     },
     "enef_v_jkm": {
         "cat": "grid",
         "logic": "NA",
         "param": {},
         "unit": "1"
     },
-    "evapmethod": {
-        "cat": "grid",
-        "logic": "NA",
-        "param": {},
-        "unit": "1"
-    },
     "evetreeh": {
         "cat": "grid",
         "logic": "range",
         "param": {
             "max": "inf",
             "min": 0
         },
@@ -678,48 +634,48 @@
         "logic": "range",
         "param": {
             "max": 1,
             "min": 0
         },
         "unit": "1"
     },
-    "g1": {
+    "g_k": {
+        "cat": "grid",
+        "logic": "NA",
+        "param": {},
+        "unit": "1"
+    },
+    "g_max": {
         "cat": "grid",
         "logic": "range",
         "param": {
             "max": 10,
             "min": 0
         },
         "unit": "1"
     },
-    "g2": {
+    "g_q_base": {
         "cat": "grid",
         "logic": "NA",
         "param": {},
         "unit": "1"
     },
-    "g3": {
+    "g_q_shape": {
         "cat": "grid",
         "logic": "NA",
         "param": {},
         "unit": "1"
     },
-    "g4": {
+    "g_sm": {
         "cat": "grid",
         "logic": "NA",
         "param": {},
         "unit": "1"
     },
-    "g5": {
-        "cat": "grid",
-        "logic": "NA",
-        "param": {},
-        "unit": "1"
-    },
-    "g6": {
+    "g_t": {
         "cat": "grid",
         "logic": "NA",
         "param": {},
         "unit": "1"
     },
     "gdd_id": {
         "cat": "grid",
@@ -972,20 +928,14 @@
         "logic": "range",
         "param": {
             "max": "inf",
             "min": 0
         },
         "unit": "1"
     },
-    "laicalcyes": {
-        "cat": "grid",
-        "logic": "NA",
-        "param": {},
-        "unit": "1"
-    },
     "laimax": {
         "cat": "grid",
         "logic": "range",
         "param": {
             "max": "inf",
             "min": 0
         },
```

## supy/var2siteselect.json

### Pretty-printed

 * *Similarity: 0.9139072847682119%*

 * *Differences: {"'g_k'": "OrderedDict([('CondCode', 'G2')])",*

 * * "'g_max'": "OrderedDict([('CondCode', 'G1')])",*

 * * "'g_q_base'": "OrderedDict([('CondCode', 'G3')])",*

 * * "'g_q_shape'": "OrderedDict([('CondCode', 'G4')])",*

 * * "'g_sm'": "OrderedDict([('CondCode', 'G6')])",*

 * * "'g_t'": "OrderedDict([('CondCode', 'G5')])",*

 * * 'delete': "['baset_hc', 'g1', 'g2', 'g3', 'g4', 'g5', 'g6']"}*

```diff
@@ -80,17 +80,14 @@
     },
     "baset_cooling": {
         "AnthropogenicCode": [
             "TCritic_Cooling_WD",
             "TCritic_Cooling_WE"
         ]
     },
-    "baset_hc": {
-        "AnthropogenicCode": "BaseT_HC"
-    },
     "baset_heating": {
         "AnthropogenicCode": [
             "TCritic_Heating_WD",
             "TCritic_Heating_WE"
         ]
     },
     "basete": {
@@ -213,32 +210,32 @@
     },
     "frfossilfuel_nonheat": {
         "AnthropogenicCode": "FrFossilFuel_NonHeat"
     },
     "frpddwe": {
         "AnthropogenicCode": "FrPDDwe"
     },
-    "g1": {
-        "CondCode": "G1"
-    },
-    "g2": {
+    "g_k": {
         "CondCode": "G2"
     },
-    "g3": {
+    "g_max": {
+        "CondCode": "G1"
+    },
+    "g_q_base": {
         "CondCode": "G3"
     },
-    "g4": {
+    "g_q_shape": {
         "CondCode": "G4"
     },
-    "g5": {
-        "CondCode": "G5"
-    },
-    "g6": {
+    "g_sm": {
         "CondCode": "G6"
     },
+    "g_t": {
+        "CondCode": "G5"
+    },
     "gddfull": {
         "Code_DecTr": "GDDFull",
         "Code_EveTr": "GDDFull",
         "Code_Grass": "GDDFull"
     },
     "gsmodel": {
         "CondCode": "gsModel"
```

## supy/cmd/SUEWS.py

```diff
@@ -6,33 +6,52 @@
 
 from .._supy_module import init_supy, run_supy, save_supy, load_forcing_grid, pd, Path
 
 from .._version import show_version, __version__
 
 from .._load import load_SUEWS_nml_simple
 
+
 # run the whole supy workflow mimicking SUEWS binary
-@click.command(short_help="Run SUEWS simulation using settings in PATH_RUNCONTROL")
-@click.argument(
-    "path_runcontrol", default="./RunControl.nml", type=click.Path(exists=True),
+@click.command(
+    short_help="Run SUEWS simulation using settings in PATH_RUNCONTROL",
+    help='''
+Run SUEWS simulation using settings in PATH_RUNCONTROL
+(default: "./RunControl.nml", i.e., the RunControl namelist file in the current directory).
+
+Examples:
+
+1. Run SUEWS simulation using the RunControl namelist file in the current directory:
+
+    $ suews-run -p ./RunControl.nml
+
+2. Run SUEWS simulation using an arbitray RunControl namelist file by specifying the path to the RunControl namelist file:
+
+    $ suews-run -p /path/to/RunControl.nml
+''',
+)
+@click.option(
+    "--path_runcontrol",
+    "-p",
+    default="./RunControl.nml",
+    type=click.Path(exists=True),
+    help="Path to the RunControl namelist file (default: ./RunControl.nml).",
 )
 def SUEWS(path_runcontrol):
-    """Run SUEWS simulation using settings in PATH_RUNCONTROL (default: "./RunControl.nml", i.e., the RunControl namelist file in the current directory).
-    """
+    """Run SUEWS simulation using settings in PATH_RUNCONTROL (default: "./RunControl.nml", i.e., the RunControl namelist file in the current directory)."""
 
     # show version info
     click.echo(
         f"""
 ===========================================
 Running SUEWS via SuPy ...
 supy version: {__version__}
 
 Documentation sites:
 SUEWS: https://suews.readthedocs.io/
-SuPy: https://supy.readthedocs.io/
 ===========================================
     """
     )
 
     try:
         path_runcontrol = Path(path_runcontrol).resolve()
         # init supy
```

## supy/util/rules.csv

```diff
@@ -1,8 +1,12 @@
 From,To,Action,File,Variable,Column,Value
+2021a,2023a,Delete,RunControl.nml,DiagQS,-999,-999
+2021a,2023a,Delete,RunControl.nml,DiagQN,-999,-999
+2021a,2023a,Delete,SUEWS_AnthropogenicHeat.txt,BaseT_HC,-999,-999
+2020a,2021a,Keep,-999,-999,-999,-999
 2019b,2020a,Add,SUEWS_Irrigation.txt,H_maintain,6,-999
 2019b,2020a,Add,RunControl.nml,BaseTMethod,-999,1
 2019b,2020a,Add,SUEWS_SiteSelect.txt,IrrFr_Water,27,0
 2019b,2020a,Add,SUEWS_SiteSelect.txt,IrrFr_BSoil,26,0
 2019b,2020a,Add,SUEWS_SiteSelect.txt,IrrFr_Bldgs,22,0
 2019b,2020a,Add,SUEWS_SiteSelect.txt,IrrFr_Paved,21,0
 2019b,2020a,Rename,SUEWS_AnthropogenicEmission.txt,BaseTHDD,21,BaseT_HC
```

## Comparing `supy-2023.2.23.dev0.dist-info/METADATA` & `supy-2023.4.14.dev0.dist-info/METADATA`

 * *Files 6% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: supy
-Version: 2023.2.23.dev0
+Version: 2023.4.14.dev0
 Summary: the SUEWS model that speaks python
 Home-page: https://github.com/UMEP-Dev/SuPy
 Author: Dr Ting Sun, Dr Hamidreza Omidvar, Prof Sue Grimmond
 Author-email: ting.sun@ucl.ac.uk, h.omidvar@reading.ac.uk, c.s.grimmond@reading.ac.uk
 License: GPL-V3.0
 Platform: UNKNOWN
 Classifier: Programming Language :: Python :: 3 :: Only
@@ -18,14 +18,15 @@
 Classifier: Operating System :: MacOS :: MacOS X
 Classifier: Operating System :: Microsoft :: Windows
 Classifier: Operating System :: POSIX :: Linux
 Requires-Python: ~=3.7
 Description-Content-Type: text/markdown
 Requires-Dist: matplotlib
 Requires-Dist: chardet
+Requires-Dist: f90wrap
 Requires-Dist: scipy
 Requires-Dist: dask
 Requires-Dist: f90nml
 Requires-Dist: seaborn
 Requires-Dist: atmosp
 Requires-Dist: cdsapi
 Requires-Dist: xarray
```

## Comparing `supy-2023.2.23.dev0.dist-info/RECORD` & `supy-2023.4.14.dev0.dist-info/RECORD`

 * *Files 27% similar despite different names*

```diff
@@ -1,23 +1,26 @@
 supy/__init__.py,sha256=103B49Q_NsSHtacCL-XBL8DNoUzzj5S5VWiiPs9NqK4,1027
 supy/_check.py,sha256=wsw58LOncTFr_AjM6ib9L52wAhtlz_Vtp3h8r-J_qH8,13025
 supy/_env.py,sha256=c0rEMADbtYi84mwsgxZ37XzD-5cf4A0OXJ9jBTTbiVk,1943
-supy/_load.py,sha256=lWov5jBsnoxEWy2fO_6x2uBuH72B5WjqqKDvjYOBhaQ,65655
+supy/_load.py,sha256=Bfx_qsR2M89AzwJEvyHPXryz4jQj4euxehA2er3sYtk,66236
 supy/_misc.py,sha256=PSxs994EDZGJhhq29I3YgqIIdG1hFm6EMQLcBhjWEro,2771
-supy/_post.py,sha256=y_0qefgWEL7-pkW03FlR62y34luuxHXnw9kDxjELTqI,7237
-supy/_run.py,sha256=RTThiyrq86IZd6PH7KlboGMJLrnLinGBU1ruyKaFVzM,19960
+supy/_post.py,sha256=cDTCWE6O_zr4-mgwZBVGuO6Y9E3XMp2RfV9CWeDVw4o,7820
+supy/_run.py,sha256=9jf-5OrRppQltK0a7ewuWOnuej-ViOyLUmSxdmoibJU,19206
 supy/_save.py,sha256=K5uzGdETGnyqyz3925MPAAhqVjJCXwR-r0MMGpVhfu8,19179
+supy/_supy_driver.cp37-win_amd64.pyd,sha256=eLDV1zYAkjanco_oFYqCZK_fQqHTuT9pCA5XKKxKorQ,6710851
+supy/_supy_driver_wrapper.py,sha256=-Ih0hGEWJzZrEfknOklGEOUOSD7pzofWXrcGoZAeaC0,639
 supy/_supy_module.py,sha256=FC5efNeaVPo1BYBwTdYytiS-qayzQmvC6zbPfQ01tZs,18173
 supy/_version.py,sha256=28alDKQPmYPCHGGhS5R_bApXBCoKghyzGOd6HkVinRM,1890
-supy/_version_scm.py,sha256=f5RnAlU-w3xHcSm_zcfkxU6ySy9P48pLUHPeJCmQv1w,185
-supy/checker_rules_indiv.json,sha256=TjLBY8OIAaeSthX01M_SVZoymxG3tWNAa0JqpGVOB-8,45386
+supy/_version_scm.py,sha256=2mq-ldutsRl98nG5uKehGPyWNQs1UXZMDmmIxzNNgY0,185
+supy/checker_rules_indiv.json,sha256=9poLlZV0odTr1pWGsPA4Atc59rSp65SrguMoRy2R1nw,44404
 supy/checker_rules_joint.json,sha256=Owoyct-XzfsG_rtIe14uVowpd2aiQ9F-tfhgzMm25w8,472
 supy/code2file.json,sha256=79N-Mb2si66wHt-HAaPmW7ejvUP8c6d1b9C6lqOvqqM,7654
-supy/var2siteselect.json,sha256=VfUHmVtPoPwmGjIiQy7QLF-9AMx-CMBd_u2zsURsQXE,20576
-supy/cmd/SUEWS.py,sha256=iD9_MjE1QPNZaaH8DxdfNBmZe2axtaH3tD9gB57ReaQ,3938
+supy/supy_driver.py,sha256=GCgWRY6GugIE5VyTpJbJSWVtwGKRpGPfzhQmqO0gAPI,294102
+supy/var2siteselect.json,sha256=4bi_Zgxa6OEJ2QNnF8mbYWb5ZtXrx6xKL9fOGrsxKjU,20536
+supy/cmd/SUEWS.py,sha256=ELH5vppMcnkg5N8Ir23J2Rck84D0KdYSl66LcGO4YN0,4488
 supy/cmd/__init__.py,sha256=15oZ2OiK-E2dWdq6WHrEIP1BURPRfS53L75MxFMukPs,74
 supy/cmd/table_converter.py,sha256=Hxw4k-PSpbiaWN68c2qOv0kkjo8qi8broc4H2ayqzLo,1347
 supy/sample_run/RunControl.nml,sha256=xTRdHD7Ox3GrR_kRDHyMmfxVdedq3aDamU2RcIRJNKs,942
 supy/sample_run/Input/ESTMinput.nml,sha256=zjSuQC421lO8IBYdk2wL1XvWPkJ3XyWFpCHJ6p998Us,278
 supy/sample_run/Input/GridLayoutKc.nml,sha256=rxDI8uDPgwWRPPHItjkYVk_3IahtJbhvP2qXtpebRnE,2736
 supy/sample_run/Input/InitialConditionsKc_2011.nml,sha256=2VzKb6nRXRa9jA-x8tBs7hHwmr7Xip8TIn4G59y3S0U,857
 supy/sample_run/Input/Kc_2011_data_60.txt,sha256=vF8PgOtF1ozUGb2vIlnxF1mh35jKyhuClC4Iqf3fJSM,1103872
@@ -33,29 +36,27 @@
 supy/sample_run/Input/SUEWS_SPARTACUS.nml,sha256=kJvgU_HqSdQ-_fqhB-LtNU9rMjSU_sfRRKi20tN0WVs,425
 supy/sample_run/Input/SUEWS_SiteSelect.txt,sha256=mCv1v3vP-Pcj6-22LlJbHn0brVh7VObLOWQEAUonnms,4647
 supy/sample_run/Input/SUEWS_Snow.txt,sha256=9kA8ClByCMA2pKlnFEwl_bC5MbT6vrKmqjIWrO-6z6k,1672
 supy/sample_run/Input/SUEWS_Soil.txt,sha256=DJOfzGAhv5gUFRb0eh5YDBgI7-Y7YkKIuxWLf5uDOzk,1901
 supy/sample_run/Input/SUEWS_Veg.txt,sha256=a_wsB_XD9tjRFoepAmgnojdqq5bkXs1wy6Iw8fPrMDw,6127
 supy/sample_run/Input/SUEWS_Water.txt,sha256=yqpJuX2nvlAqIN8OOKfzWAwhEf94l38y-yshXZWc6bQ,1526
 supy/sample_run/Input/SUEWS_WithinGridWaterDist.txt,sha256=v_XOhJNlEUPnVqa6yTzUnTGEsKKfPWJBQ_FX0MjBB1Y,2459
-supy/supy_driver/__init__.py,sha256=URvpSNWjCnWxP_mkRis6s0FVibnQR6L1KrHeF71Ti30,766
-supy/supy_driver/suews_driver.cp39-win_amd64.pyd,sha256=UDkGuam_I4OQUL8CVY7a6H39NvPtVxN-WXuuYpuENQY,10506874
 supy/util/_UMEP2epw.py,sha256=z7bpnRCFPGR251-UC5Tb58WdY1QKTTjg9yNK7wmDqJM,8693
 supy/util/__init__.py,sha256=UzPbkEKkMNuIGbvBfeMv_nE_6m7y_brRxkSV4FFdRQ8,1027
 supy/util/_atm.py,sha256=hA7eWO15PSWD4H3HZDm5ahZgEdynPFKQTACngd1ghYw,9211
 supy/util/_converter.py,sha256=mcz8Nf9UpoTO0uOwXL6a-_MviZ7fGuAI24rFJP0jmb8,15593
 supy/util/_debug.py,sha256=QuqB5uZ0mv2YNpsHK2FNaOC1ZkDbJJss7jV9v0iHiOY,6619
 supy/util/_era5.py,sha256=6xJnknBcxE_885SY4t7KNk38iOBvAoaOkY07MFGcDJU,38856
 supy/util/_gap_filler.py,sha256=hpdA-F-YU4bEHAEnfzT7Os1AVJokwP6mQaW0UScXYJA,9478
 supy/util/_gs.py,sha256=DKb_wsXeCKdXOswD31fPPPrvjEf23-y0CbTZxRWfwvg,21137
 supy/util/_io.py,sha256=PYif-297xsjN1-w51B5eGnRxweUtR1RmV0ZD3kkVJh4,2210
 supy/util/_ohm.py,sha256=8NRh-svGsLQw2SmUWdUReE6XF8dLPkwfeGEpX9uiebk,6246
 supy/util/_plot.py,sha256=w5CUe850XKJ-Welo56d5aNmo1pTdg7j4URnEYiNHz0o,12659
 supy/util/_roughness.py,sha256=EyWpBzWy_tUESs9ALyMFtsFXUIlGDHlzJc0NVfHhJyI,7608
 supy/util/_tmy.py,sha256=QL9dxe2Ip8I73urKQfhAuKf8ExMqsC9f6RwF-HKuT5o,16446
 supy/util/_wrf.py,sha256=kDAa-dAtE-BDeQo2ruNL1ccyLq8K976vlnhDE7Eawz4,7065
-supy/util/rules.csv,sha256=MoH1m10CDZB2HHFDQGOHubjpJp1Po5DKG1n9D44lOFI,12599
-supy-2023.2.23.dev0.dist-info/METADATA,sha256=azWSvOFCM6EmCIsdVIkIfMZbOios7S9ScWQKUVBAUgo,1458
-supy-2023.2.23.dev0.dist-info/WHEEL,sha256=J_4V_gB-O6Y7Pn6lk91K27JaIhI-q07YM5J8Ufzqla4,100
-supy-2023.2.23.dev0.dist-info/entry_points.txt,sha256=5Nv6FKulSvatdsNG4haNMPYri1GRJT3NEvKMGk9SVIw,111
-supy-2023.2.23.dev0.dist-info/top_level.txt,sha256=PLA0Ofny9HkM1cdMYkCcd91PdxUIA6jBC6mkiaEFwwk,5
-supy-2023.2.23.dev0.dist-info/RECORD,,
+supy/util/rules.csv,sha256=Bn7eEJJOWV4bgNElxHbMYcvNbdDAIYFWgVStX5vwi3Y,12808
+supy-2023.4.14.dev0.dist-info/METADATA,sha256=UJl3vzrlIUqoBgtLCkd5JWrqeZYo8ZnQMbC0SE4sYaA,1482
+supy-2023.4.14.dev0.dist-info/WHEEL,sha256=eep6QWEFiQfg2wcclssb_WY-D33AnLYLnEKGA9Rn-VU,100
+supy-2023.4.14.dev0.dist-info/entry_points.txt,sha256=5Nv6FKulSvatdsNG4haNMPYri1GRJT3NEvKMGk9SVIw,111
+supy-2023.4.14.dev0.dist-info/top_level.txt,sha256=rVhw4M1mleXH2HUWckzO7ommHf0UWAd2oXIq3JexmDE,17
+supy-2023.4.14.dev0.dist-info/RECORD,,
```

