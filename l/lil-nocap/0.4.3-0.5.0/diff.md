# Comparing `tmp/lil_nocap-0.4.3.tar.gz` & `tmp/lil_nocap-0.5.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "lil_nocap-0.4.3.tar", max compression
+gzip compressed data, was "lil_nocap-0.5.0.tar", max compression
```

## Comparing `lil_nocap-0.4.3.tar` & `lil_nocap-0.5.0.tar`

### file list

```diff
@@ -1,10 +1,10 @@
--rw-r--r--   0        0        0      880 2023-03-06 16:52:30.868465 lil_nocap-0.4.3/README.md
--rw-r--r--   0        0        0    28672 2023-03-23 15:47:19.957428 lil_nocap-0.4.3/lil_nocap/.nocap.py.swp
--rw-r--r--   0        0        0        1 2023-03-06 16:52:30.869054 lil_nocap-0.4.3/lil_nocap/__init__.py
--rw-r--r--   0        0        0     9383 2023-03-23 15:47:15.933357 lil_nocap-0.4.3/lil_nocap/nocap.py
--rw-r--r--   0        0        0        0 2023-03-23 15:05:43.219167 lil_nocap-0.4.3/lil_nocap/opinions.jsonl
--rw-r--r--   0        0        0      324 2023-03-20 15:40:07.101005 lil_nocap-0.4.3/lil_nocap/test.py
--rw-r--r--   0        0        0        0 2023-03-20 15:34:19.022580 lil_nocap-0.4.3/lil_nocap/test.txt
--rw-r--r--   0        0        0      495 2023-03-23 15:48:30.302953 lil_nocap-0.4.3/pyproject.toml
--rw-r--r--   0        0        0     1729 1970-01-01 00:00:00.000000 lil_nocap-0.4.3/setup.py
--rw-r--r--   0        0        0     1597 1970-01-01 00:00:00.000000 lil_nocap-0.4.3/PKG-INFO
+-rw-r--r--   0        0        0      880 2023-03-29 18:43:43.824841 lil_nocap-0.5.0/README.md
+-rw-r--r--   0        0        0    24576 2023-04-13 14:10:51.196482 lil_nocap-0.5.0/lil_nocap/.__init__.py.swp
+-rw-r--r--   0        0        0    12288 2023-04-13 14:33:01.005102 lil_nocap-0.5.0/lil_nocap/.nocap.py.swp
+-rw-r--r--   0        0        0     9805 2023-04-13 14:10:45.247746 lil_nocap-0.5.0/lil_nocap/__init__.py
+-rw-r--r--   0        0        0        0 2023-03-23 15:05:43.219167 lil_nocap-0.5.0/lil_nocap/opinions.jsonl
+-rw-r--r--   0        0        0      324 2023-03-20 15:40:07.101005 lil_nocap-0.5.0/lil_nocap/test.py
+-rw-r--r--   0        0        0        0 2023-03-20 15:34:19.022580 lil_nocap-0.5.0/lil_nocap/test.txt
+-rw-r--r--   0        0        0      498 2023-04-13 14:37:03.461610 lil_nocap-0.5.0/pyproject.toml
+-rw-r--r--   0        0        0     1732 1970-01-01 00:00:00.000000 lil_nocap-0.5.0/setup.py
+-rw-r--r--   0        0        0     1597 1970-01-01 00:00:00.000000 lil_nocap-0.5.0/PKG-INFO
```

### Comparing `lil_nocap-0.4.3/README.md` & `lil_nocap-0.5.0/README.md`

 * *Files identical despite different names*

### Comparing `lil_nocap-0.4.3/lil_nocap/.nocap.py.swp` & `lil_nocap-0.5.0/lil_nocap/.__init__.py.swp`

 * *Files 16% similar despite different names*

```diff
@@ -1,18 +1,18 @@
 00000000: 6230 5649 4d20 382e 3200 0000 0010 0000  b0VIM 8.2.......
-00000010: 8374 1c64 2f75 a000 7f19 0000 7361 6265  .t.d/u......sabe
+00000010: 650d 3864 bc7a be00 c451 0000 7361 6265  e.8d.z...Q..sabe
 00000020: 6c6f 7365 7468 756d 686c 616d 6269 0000  losethumhlambi..
 00000030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000040: 0000 0000 484c 5343 3032 5a56 3342 434d  ....HLSC02ZV3BCM
 00000050: 4436 5400 0000 0000 0000 0000 0000 0000  D6T.............
 00000060: 0000 0000 0000 0000 0000 0000 7e73 6162  ............~sab
 00000070: 656c 6f73 6574 6875 6d68 6c61 6d62 692f  elosethumhlambi/
 00000080: 446f 6375 6d65 6e74 732f 4769 7448 7562  Documents/GitHub
 00000090: 2f6e 6f63 6170 2f6c 696c 5f6e 6f63 6170  /nocap/lil_nocap
-000000a0: 2f6e 6f63 6170 2e70 7900 0000 0000 0000  /nocap.py.......
+000000a0: 2f5f 5f69 6e69 745f 5f2e 7079 0000 0000  /__init__.py....
 000000b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -250,25 +250,25 @@
 00000f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00001000: 7470 0500 7f00 0000 0200 0000 0000 0000  tp..............
-00001010: 2e00 0000 0000 0000 0100 0000 0000 0000  ................
-00001020: 0100 0000 0000 0000 0600 0000 0000 0000  ................
-00001030: 3d00 0000 0000 0000 3000 0000 0000 0000  =.......0.......
-00001040: 0100 0000 0000 0000 0400 0000 0000 0000  ................
-00001050: 2b00 0000 0000 0000 6b00 0000 0000 0000  +.......k.......
-00001060: 0100 0000 0000 0000 0500 0000 0000 0000  ................
-00001070: 4300 0000 0000 0000 9700 0000 0000 0000  C...............
-00001080: 0100 0000 0000 0000 0300 0000 0000 0000  ................
-00001090: 4800 0000 0000 0000 d900 0000 0000 0000  H...............
-000010a0: 0100 0000 0000 0000 0000 0000 0000 0000  ................
+00001000: 7470 0400 7f00 0000 0200 0000 0000 0000  tp..............
+00001010: 6900 0000 0000 0000 0100 0000 0000 0000  i...............
+00001020: 0100 0000 0000 0000 0400 0000 0000 0000  ................
+00001030: 2d00 0000 0000 0000 6c00 0000 0000 0000  -.......l.......
+00001040: 0100 0000 0000 0000 0500 0000 0000 0000  ................
+00001050: 4600 0000 0000 0000 9800 0000 0000 0000  F...............
+00001060: 0100 0000 0000 0000 0300 0000 0000 0000  ................
+00001070: 5400 0000 0000 0000 de00 0000 0000 0000  T...............
+00001080: 0100 0000 0000 0000 0000 0000 0000 0000  ................
+00001090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000010a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000010f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -506,294 +506,294 @@
 00001f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00001ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00002000: 6164 0000 3209 0000 060a 0000 0010 0000  ad..2...........
-00002010: 2e00 0000 0000 0000 f00f 0000 dc0f 0000  ................
-00002020: c90f 0000 bd0f 0000 8f0f 0000 720f 0000  ............r...
-00002030: 660f 0000 580f 0000 4e0f 0000 410f 0000  f...X...N...A...
-00002040: 400f 0000 330f 0000 d70e 0000 b30e 0000  @...3...........
-00002050: 7f0e 0000 5f0e 0000 3d0e 0000 190e 0000  ...._...=.......
-00002060: 180e 0000 ec0d 0000 ac0d 0000 7c0d 0000  ............|...
-00002070: 4e0d 0000 4d0d 0000 1c0d 0000 ef0c 0000  N...M...........
-00002080: ee0c 0000 d60c 0000 d50c 0000 c00c 0000  ................
-00002090: 770c 0000 250c 0000 dd0b 0000 950b 0000  w...%...........
-000020a0: 470b 0000 2b0b 0000 080b 0000 040b 0000  G...+...........
-000020b0: ff0a 0000 d80a 0000 b70a 0000 920a 0000  ................
-000020c0: 710a 0000 4b0a 0000 290a 0000 060a 0000  q...K...).......
-000020d0: 050a 0000 020a 0000 ec09 0000 a609 0000  ................
-000020e0: 6109 0000 4209 0000 3009 0000 1009 0000  a...B...0.......
-000020f0: f208 0000 da08 0000 d908 0000 9c08 0000  ................
-00002100: 2208 0000 0208 0000 d807 0000 ab07 0000  "...............
-00002110: 7907 0000 4907 0000 3b07 0000 1d07 0000  y...I...;.......
-00002120: c706 0000 5806 0000 4e06 0000 e405 0000  ....X...N.......
-00002130: c605 0000 8705 0000 7905 0000 7805 0000  ........y...x...
-00002140: 6105 0000 4105 0000 2905 0000 2805 0000  a...A...)...(...
-00002150: f804 0000 d104 0000 ce04 0000 9f04 0000  ................
-00002160: 7804 0000 6a04 0000 4e04 0000 3804 0000  x...j...N...8...
-00002170: 1a04 0000 fa03 0000 dd03 0000 bc03 0000  ................
-00002180: b703 0000 9b03 0000 8903 0000 6b03 0000  ............k...
-00002190: 5903 0000 3a03 0000 2703 0000 0803 0000  Y...:...'.......
-000021a0: f402 0000 d602 0000 c302 0000 a402 0000  ................
-000021b0: 9102 0000 8102 0000 8002 0000 4b02 0000  ............K...
-000021c0: e001 0000 0000 0000 0000 0000 0000 0000  ................
+00002000: 6164 0000 4100 0000 0102 0000 0010 0000  ad..A...........
+00002010: 6900 0000 0000 0000 f00f 0000 dc0f 0000  i...............
+00002020: c90f 0000 bd0f 0000 8f0f 0000 730f 0000  ............s...
+00002030: 560f 0000 4a0f 0000 3c0f 0000 320f 0000  V...J...<...2...
+00002040: 250f 0000 1b0f 0000 1a0f 0000 0d0f 0000  %...............
+00002050: b10e 0000 8d0e 0000 590e 0000 390e 0000  ........Y...9...
+00002060: 170e 0000 f30d 0000 f20d 0000 c60d 0000  ................
+00002070: 860d 0000 560d 0000 280d 0000 270d 0000  ....V...(...'...
+00002080: f60c 0000 c90c 0000 c80c 0000 b30c 0000  ................
+00002090: 6a0c 0000 180c 0000 d00b 0000 880b 0000  j...............
+000020a0: 3a0b 0000 1e0b 0000 fb0a 0000 f60a 0000  :...............
+000020b0: cf0a 0000 ae0a 0000 890a 0000 680a 0000  ............h...
+000020c0: 420a 0000 200a 0000 fd09 0000 e709 0000  B... ...........
+000020d0: d709 0000 c109 0000 7b09 0000 2109 0000  ........{...!...
+000020e0: 0209 0000 f008 0000 d008 0000 b208 0000  ................
+000020f0: 9a08 0000 9908 0000 5c08 0000 e207 0000  ........\.......
+00002100: c207 0000 9807 0000 6b07 0000 3907 0000  ........k...9...
+00002110: 0907 0000 fb06 0000 dd06 0000 8706 0000  ................
+00002120: 1306 0000 0906 0000 9a05 0000 7c05 0000  ............|...
+00002130: 3d05 0000 2f05 0000 2e05 0000 1705 0000  =.../...........
+00002140: f704 0000 df04 0000 de04 0000 ae04 0000  ................
+00002150: 8704 0000 8404 0000 5504 0000 2e04 0000  ........U.......
+00002160: 2004 0000 0404 0000 ee03 0000 d003 0000   ...............
+00002170: b003 0000 9303 0000 7203 0000 6d03 0000  ........r...m...
+00002180: 5103 0000 3f03 0000 2103 0000 0f03 0000  Q...?...!.......
+00002190: f002 0000 dd02 0000 be02 0000 aa02 0000  ................
+000021a0: 8c02 0000 7902 0000 5a02 0000 4702 0000  ....y...Z...G...
+000021b0: 3702 0000 3602 0000 0102 0000 0002 0000  7...6...........
+000021c0: e801 0000 e701 0000 0000 0000 0000 0000  ................
 000021d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000021e0: 2020 2020 6369 7465 735f 746f 203d 2064      cites_to = d
-000021f0: 665f 6369 7461 7469 6f6e 735b 6466 5f63  f_citations[df_c
-00002200: 6974 6174 696f 6e73 5b27 6369 7469 6e67  itations['citing
-00002210: 5f6f 7069 6e69 6f6e 5f69 6427 5d20 3d3d  _opinion_id'] ==
-00002220: 206f 7069 6e69 6f6e 5f69 645d 5b27 6369   opinion_id]['ci
-00002230: 7465 645f 6f70 696e 696f 6e5f 6964 275d  ted_opinion_id']
-00002240: 2e74 6f5f 6c69 7374 2829 0020 2064 6566  .to_list().  def
-00002250: 2067 6574 5f63 6974 6174 696f 6e73 2873   get_citations(s
-00002260: 656c 662c 206f 7069 6e69 6f6e 5f69 642c  elf, opinion_id,
-00002270: 2064 665f 6369 7461 7469 6f6e 7329 3a00   df_citations):.
-00002280: 0020 2020 2072 6574 7572 6e20 7465 7874  .    return text
-00002290: 0020 2020 2020 2020 2074 6578 7420 3d20  .        text = 
-000022a0: 686c 6100 2020 2020 656c 6966 2069 7369  hla.    elif isi
-000022b0: 6e73 7461 6e63 6528 686c 612c 2073 7472  nstance(hla, str
-000022c0: 293a 0020 2020 2020 2020 2074 6578 7420  ):.        text 
-000022d0: 3d20 7868 2000 2020 2020 656c 6966 2069  = xh .    elif i
-000022e0: 7369 6e73 7461 6e63 6528 7868 2c20 7374  sinstance(xh, st
-000022f0: 7229 3a00 2020 2020 2020 2020 7465 7874  r):.        text
-00002300: 203d 2068 6c63 2000 2020 2020 656c 6966   = hlc .    elif
-00002310: 2069 7369 6e73 7461 6e63 6528 686c 632c   isinstance(hlc,
-00002320: 2073 7472 293a 0020 2020 2020 2020 2074   str):.        t
-00002330: 6578 7420 3d20 686c 6200 2020 2020 656c  ext = hlb.    el
-00002340: 6966 2069 7369 6e73 7461 6e63 6528 686c  if isinstance(hl
-00002350: 622c 2073 7472 293a 0020 2020 2020 2020  b, str):.       
-00002360: 2074 6578 7420 3d20 686c 0020 2020 2065   text = hl.    e
-00002370: 6c69 6620 6973 696e 7374 616e 6365 2868  lif isinstance(h
-00002380: 6c2c 2073 7472 293a 0020 2020 2020 2020  l, str):.       
-00002390: 2074 6578 7420 3d20 7074 0020 2020 2069   text = pt.    i
-000023a0: 6620 6973 696e 7374 616e 6365 2870 742c  f isinstance(pt,
-000023b0: 2073 7472 293a 0020 2020 2000 2020 2020   str):.    .    
-000023c0: 686c 6120 3d20 6f70 696e 696f 6e2e 6874  hla = opinion.ht
-000023d0: 6d6c 5f61 6e6f 6e5f 3230 3230 0020 2020  ml_anon_2020.   
-000023e0: 2078 6820 3d20 6f70 696e 696f 6e2e 786d   xh = opinion.xm
-000023f0: 6c5f 6861 7276 6172 6400 2020 2020 686c  l_harvard.    hl
-00002400: 6320 3d20 6f70 696e 696f 6e2e 6874 6d6c  c = opinion.html
-00002410: 5f63 6f6c 756d 6269 6100 2020 2020 686c  _columbia.    hl
-00002420: 6220 3d20 6f70 696e 696f 6e2e 6874 6d6c  b = opinion.html
-00002430: 5f6c 6177 626f 7800 2020 2020 686c 203d  _lawbox.    hl =
-00002440: 206f 7069 6e69 6f6e 2e68 746d 6c00 2020   opinion.html.  
-00002450: 2020 7074 203d 206f 7069 6e69 6f6e 2e70    pt = opinion.p
-00002460: 6c61 696e 5f74 6578 7400 2020 2020 7465  lain_text.    te
-00002470: 7874 203d 2027 2700 2020 6465 6620 6765  xt = ''.  def ge
-00002480: 745f 6f70 696e 696f 6e5f 7465 7874 2873  t_opinion_text(s
-00002490: 656c 662c 206f 7069 6e69 6f6e 293a 0020  elf, opinion):. 
-000024a0: 2023 2061 6363 6570 7473 2061 2073 6572   # accepts a ser
-000024b0: 6965 7320 2d2d 2061 2072 6f77 2066 726f  ies -- a row fro
-000024c0: 6d20 6120 6461 7461 6672 616d 6500 2020  m a dataframe.  
-000024d0: 0020 2020 2072 6574 7572 6e20 6466 2e6c  .    return df.l
-000024e0: 6f63 5b64 665b 636f 6c75 6d6e 5d20 3d3d  oc[df[column] ==
-000024f0: 206d 6174 6368 5d00 2020 6465 6620 6466   match].  def df
-00002500: 5f72 6f77 5f62 795f 7661 6c75 6528 7365  _row_by_value(se
-00002510: 6c66 2c20 6466 2c20 636f 6c75 6d6e 2c20  lf, df, column, 
-00002520: 6d61 7463 6829 3a00 0020 2020 2072 6574  match):..    ret
-00002530: 7572 6e20 7365 6c66 2e5f 636c 6965 6e74  urn self._client
-00002540: 0020 2064 6566 2067 6574 5f63 6c75 7374  .  def get_clust
-00002550: 6572 5f63 6c69 656e 7428 7365 6c66 293a  er_client(self):
-00002560: 0020 2023 2067 6574 2063 6c75 7374 6572  .  # get cluster
-00002570: 2063 6c69 656e 7400 0020 2020 2072 6574   client..    ret
-00002580: 7572 6e20 6466 0020 2020 2070 7269 6e74  urn df.    print
-00002590: 2866 277b 6669 6c65 6e61 6d65 7d20 7265  (f'{filename} re
-000025a0: 6164 2069 6e20 7b69 6e74 2828 656e 642d  ad in {int((end-
-000025b0: 7374 6172 7429 2f36 3029 7d20 6d69 6e75  start)/60)} minu
-000025c0: 7465 7327 2900 2020 2020 656e 6420 3d20  tes').    end = 
-000025d0: 7469 6d65 2e70 6572 665f 636f 756e 7465  time.perf_counte
-000025e0: 7228 2900 2020 2020 2020 2020 6466 203d  r().        df =
-000025f0: 2070 642e 7265 6164 5f63 7376 2866 696c   pd.read_csv(fil
-00002600: 656e 616d 652c 2064 7479 7065 3d64 7479  ename, dtype=dty
-00002610: 7065 2c20 7061 7273 655f 6461 7465 733d  pe, parse_dates=
-00002620: 7061 7273 655f 6461 7465 732c 2075 7365  parse_dates, use
-00002630: 636f 6c73 3d75 7365 636f 6c73 2c20 696e  cols=usecols, in
-00002640: 6465 785f 636f 6c3d 4e6f 6e65 2900 2020  dex_col=None).  
-00002650: 2020 656c 7365 3a00 2020 2020 2020 2020    else:.        
-00002660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002670: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00002680: 7479 7065 3d64 7479 7065 2c20 7061 7273  type=dtype, pars
-00002690: 655f 6461 7465 733d 7061 7273 655f 6461  e_dates=parse_da
-000026a0: 7465 732c 2075 7365 636f 6c73 3d75 7365  tes, usecols=use
-000026b0: 636f 6c73 2c20 696e 6465 785f 636f 6c3d  cols, index_col=
-000026c0: 4e6f 6e65 2929 0020 2020 2020 2020 2064  None)).        d
-000026d0: 6620 3d20 7064 2e63 6f6e 6361 7428 7365  f = pd.concat(se
-000026e0: 6c66 2e72 6561 645f 6373 765f 6173 5f64  lf.read_csv_as_d
-000026f0: 6673 2866 696c 656e 616d 652c 206e 756d  fs(filename, num
-00002700: 5f64 6673 3d31 302a 2a35 2c20 6d61 785f  _dfs=10**5, max_
-00002710: 726f 7773 3d31 302a 2a37 2c20 0020 2020  rows=10**7, .   
-00002720: 2069 6620 6669 6c65 5f73 697a 655f 6762   if file_size_gb
-00002730: 203e 206d 6178 5f67 623a 0020 2020 2064   > max_gb:.    d
-00002740: 6620 3d20 4e6f 6e65 0020 2020 2070 7269  f = None.    pri
-00002750: 6e74 2822 4669 6c65 2053 697a 6520 6973  nt("File Size is
-00002760: 203a 222c 2066 696c 655f 7369 7a65 5f67   :", file_size_g
-00002770: 622c 2022 4742 2229 0020 2020 2070 7269  b, "GB").    pri
-00002780: 6e74 2866 2749 6d70 6f72 7469 6e67 207b  nt(f'Importing {
-00002790: 6669 6c65 6e61 6d65 7d20 6173 2061 2064  filename} as a d
-000027a0: 6174 6166 7261 6d65 2729 0020 2020 2066  ataframe').    f
-000027b0: 696c 655f 7369 7a65 5f67 6220 3d20 726f  ile_size_gb = ro
-000027c0: 756e 6428 6669 6c65 5f73 697a 652f 3130  und(file_size/10
-000027d0: 2a2a 392c 2032 2900 2020 2020 6669 6c65  **9, 2).    file
-000027e0: 5f73 697a 6520 3d20 6f73 2e70 6174 682e  _size = os.path.
-000027f0: 6765 7473 697a 6528 6669 6c65 6e61 6d65  getsize(filename
-00002800: 2900 2020 2020 7374 6172 7420 3d20 7469  ).    start = ti
-00002810: 6d65 2e70 6572 665f 636f 756e 7465 7228  me.perf_counter(
-00002820: 2900 2020 6465 6620 6373 765f 746f 5f64  ).  def csv_to_d
-00002830: 6628 7365 6c66 2c20 6669 6c65 6e61 6d65  f(self, filename
-00002840: 2c20 6474 7970 6520 3d20 4e6f 6e65 2c20  , dtype = None, 
-00002850: 7061 7273 655f 6461 7465 7320 3d20 4e6f  parse_dates = No
-00002860: 6e65 2c20 6d61 785f 6762 3d35 2c20 6e75  ne, max_gb=5, nu
-00002870: 6d5f 6466 733d 3130 2a2a 332c 2075 7365  m_dfs=10**3, use
-00002880: 636f 6c73 3d4e 6f6e 652c 2069 6e64 6578  cols=None, index
-00002890: 5f63 6f6c 3d4e 6f6e 6529 3a00 2020 2320  _col=None):.  # 
-000028a0: 6765 7420 6120 706f 7465 6e74 6961 6c6c  get a potentiall
-000028b0: 7920 6c61 7267 6520 6373 7620 616e 6420  y large csv and 
-000028c0: 7475 726e 2069 7420 696e 746f 2061 2044  turn it into a D
-000028d0: 6174 6146 7261 6d65 0000 2020 2020 7265  ataFrame..    re
-000028e0: 7475 726e 2064 6673 5f6f 7069 6e69 6f6e  turn dfs_opinion
-000028f0: 7300 2020 2020 2020 2020 636f 756e 7465  s.        counte
-00002900: 7220 3d20 636f 756e 7465 7220 2b20 3100  r = counter + 1.
-00002910: 2020 2020 2020 2020 6466 735f 6f70 696e          dfs_opin
-00002920: 696f 6e73 2e61 7070 656e 6428 6466 2900  ions.append(df).
-00002930: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-00002940: 6b00 2020 2020 2020 2020 6966 2063 6f75  k.        if cou
-00002950: 6e74 6572 203e 3d20 6e75 6d5f 6466 733a  nter >= num_dfs:
-00002960: 0020 2020 2020 2020 2020 2020 2020 2020  .               
-00002970: 2020 2020 2020 2020 2020 2070 6172 7365             parse
-00002980: 5f64 6174 6573 3d70 6172 7365 5f64 6174  _dates=parse_dat
-00002990: 6573 2c20 7573 6563 6f6c 733d 7573 6563  es, usecols=usec
-000029a0: 6f6c 7329 3a00 2020 2020 666f 7220 6466  ols):.    for df
-000029b0: 2069 6e20 7064 2e72 6561 645f 6373 7628   in pd.read_csv(
-000029c0: 6669 6c65 6e61 6d65 2c20 6368 756e 6b73  filename, chunks
-000029d0: 697a 653d 6d61 785f 726f 7773 2c20 6474  ize=max_rows, dt
-000029e0: 7970 653d 6474 7970 652c 2000 2020 2020  ype=dtype, .    
-000029f0: 6466 735f 6f70 696e 696f 6e73 203d 205b  dfs_opinions = [
-00002a00: 5d00 2020 2020 2020 2020 2020 2020 2020  ].              
-00002a10: 2020 2020 2020 2020 2020 696e 6465 785f            index_
-00002a20: 636f 6c3d 4e6f 6e65 0020 2020 2020 2020  col=None.       
-00002a30: 2020 2020 2020 2020 2020 2020 2075 7365               use
-00002a40: 636f 6c73 3d4e 6f6e 652c 0020 2020 2020  cols=None,.     
-00002a50: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00002a60: 6172 7365 5f64 6174 6573 3d4e 6f6e 652c  arse_dates=None,
-00002a70: 0020 2020 2020 2020 2020 2020 2020 2020  .               
-00002a80: 2020 2020 2064 7479 7065 3d4e 6f6e 652c       dtype=None,
-00002a90: 2000 2020 2020 2020 2020 2020 2020 2020   .              
-00002aa0: 2020 2020 2020 6d61 785f 726f 7773 3d31        max_rows=1
-00002ab0: 302a 2a35 2c20 0020 2020 2020 2020 2020  0**5, .         
-00002ac0: 2020 2020 2020 2020 2020 206e 756d 5f64             num_d
-00002ad0: 6673 3d31 302c 2000 2020 6465 6620 7265  fs=10, .  def re
-00002ae0: 6164 5f63 7376 5f61 735f 6466 7328 7365  ad_csv_as_dfs(se
-00002af0: 6c66 2c20 6669 6c65 6e61 6d65 2c20 0020  lf, filename, . 
-00002b00: 2020 2000 2020 2000 2020 2020 4e6f 4361     .   .    NoCa
-00002b10: 7028 6f2c 206f 632c 2063 2c20 642c 2063  p(o, oc, c, d, c
-00002b20: 6d29 2e73 7461 7274 2829 0020 2064 6566  m).start().  def
-00002b30: 2063 6c69 286f 2c20 6f63 2c20 632c 2064   cli(o, oc, c, d
-00002b40: 2c20 636d 293a 0020 2040 636c 6963 6b2e  , cm):.  @click.
-00002b50: 6f70 7469 6f6e 2827 2d63 6d27 2c20 6865  option('-cm', he
-00002b60: 6c70 3d22 6c6f 6361 6c20 7061 7468 2074  lp="local path t
-00002b70: 6f20 6369 7461 7469 6f6e 206d 6170 2066  o citation map f
-00002b80: 696c 6522 2c20 7265 7175 6972 6564 3d54  ile", required=T
-00002b90: 7275 6529 0020 2040 636c 6963 6b2e 6f70  rue).  @click.op
-00002ba0: 7469 6f6e 2827 2d64 272c 2068 656c 703d  tion('-d', help=
-00002bb0: 226c 6f63 616c 2070 6174 6820 746f 2064  "local path to d
-00002bc0: 6f63 6b65 7473 2066 696c 6522 2c20 7265  ockets file", re
-00002bd0: 7175 6972 6564 3d54 7275 6529 0020 2040  quired=True).  @
-00002be0: 636c 6963 6b2e 6f70 7469 6f6e 2827 2d63  click.option('-c
-00002bf0: 272c 2068 656c 703d 226c 6f63 616c 2070  ', help="local p
-00002c00: 6174 6820 746f 2063 6f75 7274 7320 6669  ath to courts fi
-00002c10: 6c65 2022 2c20 7265 7175 6972 6564 3d54  le ", required=T
-00002c20: 7275 6529 0020 2040 636c 6963 6b2e 6f70  rue).  @click.op
-00002c30: 7469 6f6e 2827 2d6f 6327 2c20 6865 6c70  tion('-oc', help
-00002c40: 3d22 6c6f 6361 6c20 7061 7468 2074 6f20  ="local path to 
-00002c50: 6f70 696e 696f 6e20 636c 7573 7465 7273  opinion clusters
-00002c60: 2066 696c 6522 2c20 7265 7175 6972 6564   file", required
-00002c70: 3d54 7275 6529 0020 2040 636c 6963 6b2e  =True).  @click.
-00002c80: 6f70 7469 6f6e 2827 2d6f 272c 2068 656c  option('-o', hel
-00002c90: 703d 226c 6f63 616c 2070 6174 6820 746f  p="local path to
-00002ca0: 206f 7069 6e69 6f6e 7320 6669 6c65 222c   opinions file",
-00002cb0: 2072 6571 7569 7265 643d 5472 7565 2900   required=True).
-00002cc0: 2020 4063 6c69 636b 2e63 6f6d 6d61 6e64    @click.command
-00002cd0: 2829 2020 0000 2020 2020 7365 6c66 2e5f  ()  ..    self._
-00002ce0: 636c 6965 6e74 203d 204e 6f6e 6500 0020  client = None.. 
-00002cf0: 2020 2073 656c 662e 4461 7461 4672 616d     self.DataFram
-00002d00: 6520 3d20 7064 2e63 6f72 652e 6672 616d  e = pd.core.fram
-00002d10: 652e 4461 7461 4672 616d 6500 2020 2020  e.DataFrame.    
-00002d20: 2373 656c 662e 5f64 665f 6f70 696e 696f  #self._df_opinio
-00002d30: 6e73 203d 2073 656c 662e 696e 6974 5f6f  ns = self.init_o
-00002d40: 7069 6e69 6f6e 735f 6466 2829 0000 2020  pinions_df()..  
-00002d50: 2020 7365 6c66 2e5f 6466 5f64 6f63 6b65    self._df_docke
-00002d60: 7473 203d 2073 656c 662e 696e 6974 5f64  ts = self.init_d
-00002d70: 6f63 6b65 7473 5f64 6628 2900 2020 2020  ockets_df().    
-00002d80: 7365 6c66 2e5f 6466 5f63 6974 6174 696f  self._df_citatio
-00002d90: 6e20 3d20 7365 6c66 2e69 6e69 745f 6369  n = self.init_ci
-00002da0: 7461 7469 6f6e 5f64 6628 2900 2020 2020  tation_df().    
-00002db0: 7365 6c66 2e5f 6466 5f6f 7069 6e69 6f6e  self._df_opinion
-00002dc0: 5f63 6c75 7374 6572 7320 3d20 7365 6c66  _clusters = self
-00002dd0: 2e69 6e69 745f 6f70 696e 696f 6e5f 636c  .init_opinion_cl
-00002de0: 7573 7465 7273 5f64 6628 2900 2020 2020  usters_df().    
-00002df0: 7365 6c66 2e5f 6466 5f63 6f75 7274 7320  self._df_courts 
-00002e00: 3d20 7365 6c66 2e69 6e69 745f 636f 7572  = self.init_cour
-00002e10: 7473 5f64 6628 2900 0020 2020 2073 656c  ts_df()..    sel
-00002e20: 662e 5f63 6974 6174 696f 6e5f 666e 203d  f._citation_fn =
-00002e30: 2063 6974 6174 696f 6e5f 666e 0020 2020   citation_fn.   
-00002e40: 2073 656c 662e 5f64 6f63 6b65 7473 5f66   self._dockets_f
-00002e50: 6e20 3d20 646f 636b 6574 735f 666e 0020  n = dockets_fn. 
-00002e60: 2020 2073 656c 662e 5f63 6f75 7274 735f     self._courts_
-00002e70: 666e 203d 2063 6f75 7274 735f 666e 0020  fn = courts_fn. 
-00002e80: 2020 2073 656c 662e 5f6f 7069 6e69 6f6e     self._opinion
-00002e90: 5f63 6c75 7374 6572 735f 666e 203d 206f  _clusters_fn = o
-00002ea0: 7069 6e69 6f6e 5f63 6c75 7374 6572 735f  pinion_clusters_
-00002eb0: 666e 0020 2020 2073 656c 662e 5f6f 7069  fn.    self._opi
-00002ec0: 6e69 6f6e 735f 666e 203d 206f 7069 6e69  nions_fn = opini
-00002ed0: 6f6e 735f 666e 0020 2064 6566 205f 5f69  ons_fn.  def __i
-00002ee0: 6e69 745f 5f28 7365 6c66 2c20 6f70 696e  nit__(self, opin
-00002ef0: 696f 6e73 5f66 6e2c 206f 7069 6e69 6f6e  ions_fn, opinion
-00002f00: 5f63 6c75 7374 6572 735f 666e 2c20 636f  _clusters_fn, co
-00002f10: 7572 7473 5f66 6e2c 2064 6f63 6b65 7473  urts_fn, dockets
-00002f20: 5f66 6e2c 2063 6974 6174 696f 6e5f 666e  _fn, citation_fn
-00002f30: 293a 0063 6c61 7373 204e 6f43 6170 3a00  ):.class NoCap:.
-00002f40: 0069 6d70 6f72 7420 636c 6963 6b00 696d  .import click.im
-00002f50: 706f 7274 206f 7300 696d 706f 7274 2074  port os.import t
-00002f60: 696d 6569 7400 696d 706f 7274 2074 696d  imeit.import tim
-00002f70: 6500 696d 706f 7274 206d 756c 7469 7072  e.import multipr
-00002f80: 6f63 6573 7369 6e67 2061 7320 6d70 0066  ocessing as mp.f
+000021e0: 0000 0000 0000 0000 2020 6465 6620 6765  ........  def ge
+000021f0: 745f 6369 7461 7469 6f6e 7328 7365 6c66  t_citations(self
+00002200: 2020 2064 6566 2067 6574 5f63 6974 6174     def get_citat
+00002210: 696f 6e73 2873 656c 662c 206f 7069 6e69  ions(self, opini
+00002220: 6f6e 5f69 642c 2064 665f 6369 7461 7469  on_id, df_citati
+00002230: 6f6e 7329 3a00 0020 2020 2072 6574 7572  ons):..    retur
+00002240: 6e20 7465 7874 0020 2020 2020 2020 2074  n text.        t
+00002250: 6578 7420 3d20 686c 6100 2020 2020 656c  ext = hla.    el
+00002260: 6966 2069 7369 6e73 7461 6e63 6528 686c  if isinstance(hl
+00002270: 612c 2073 7472 293a 0020 2020 2020 2020  a, str):.       
+00002280: 2074 6578 7420 3d20 7868 2000 2020 2020   text = xh .    
+00002290: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+000022a0: 7868 2c20 7374 7229 3a00 2020 2020 2020  xh, str):.      
+000022b0: 2020 7465 7874 203d 2068 6c63 2000 2020    text = hlc .  
+000022c0: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+000022d0: 6528 686c 632c 2073 7472 293a 0020 2020  e(hlc, str):.   
+000022e0: 2020 2020 2074 6578 7420 3d20 686c 6200       text = hlb.
+000022f0: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+00002300: 6e63 6528 686c 622c 2073 7472 293a 0020  nce(hlb, str):. 
+00002310: 2020 2020 2020 2074 6578 7420 3d20 686c         text = hl
+00002320: 0020 2020 2065 6c69 6620 6973 696e 7374  .    elif isinst
+00002330: 616e 6365 2868 6c2c 2073 7472 293a 0020  ance(hl, str):. 
+00002340: 2020 2020 2020 2074 6578 7420 3d20 7074         text = pt
+00002350: 0020 2020 2069 6620 6973 696e 7374 616e  .    if isinstan
+00002360: 6365 2870 742c 2073 7472 293a 0020 2020  ce(pt, str):.   
+00002370: 2000 2020 2020 686c 6120 3d20 6f70 696e   .    hla = opin
+00002380: 696f 6e2e 6874 6d6c 5f61 6e6f 6e5f 3230  ion.html_anon_20
+00002390: 3230 0020 2020 2078 6820 3d20 6f70 696e  20.    xh = opin
+000023a0: 696f 6e2e 786d 6c5f 6861 7276 6172 6400  ion.xml_harvard.
+000023b0: 2020 2020 686c 6320 3d20 6f70 696e 696f      hlc = opinio
+000023c0: 6e2e 6874 6d6c 5f63 6f6c 756d 6269 6100  n.html_columbia.
+000023d0: 2020 2020 686c 6220 3d20 6f70 696e 696f      hlb = opinio
+000023e0: 6e2e 6874 6d6c 5f6c 6177 626f 7800 2020  n.html_lawbox.  
+000023f0: 2020 686c 203d 206f 7069 6e69 6f6e 2e68    hl = opinion.h
+00002400: 746d 6c00 2020 2020 7074 203d 206f 7069  tml.    pt = opi
+00002410: 6e69 6f6e 2e70 6c61 696e 5f74 6578 7400  nion.plain_text.
+00002420: 2020 2020 7465 7874 203d 2027 2700 2020      text = ''.  
+00002430: 6465 6620 6765 745f 6f70 696e 696f 6e5f  def get_opinion_
+00002440: 7465 7874 2873 656c 662c 206f 7069 6e69  text(self, opini
+00002450: 6f6e 293a 0020 2023 2061 6363 6570 7473  on):.  # accepts
+00002460: 2061 2073 6572 6965 7320 2d2d 2061 2072   a series -- a r
+00002470: 6f77 2066 726f 6d20 6120 6461 7461 6672  ow from a datafr
+00002480: 616d 6500 2020 0020 2020 2072 6574 7572  ame.  .    retur
+00002490: 6e20 6466 2e6c 6f63 5b64 665b 636f 6c75  n df.loc[df[colu
+000024a0: 6d6e 5d20 3d3d 206d 6174 6368 5d00 2020  mn] == match].  
+000024b0: 6465 6620 6466 5f72 6f77 5f62 795f 7661  def df_row_by_va
+000024c0: 6c75 6528 7365 6c66 2c20 6466 2c20 636f  lue(self, df, co
+000024d0: 6c75 6d6e 2c20 6d61 7463 6829 3a00 0020  lumn, match):.. 
+000024e0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+000024f0: 636c 6965 6e74 0020 2064 6566 2067 6574  client.  def get
+00002500: 5f63 6c75 7374 6572 5f63 6c69 656e 7428  _cluster_client(
+00002510: 7365 6c66 293a 0020 2023 2067 6574 2063  self):.  # get c
+00002520: 6c75 7374 6572 2063 6c69 656e 7400 0020  luster client.. 
+00002530: 2020 2072 6574 7572 6e20 6466 0020 2020     return df.   
+00002540: 2070 7269 6e74 2866 277b 6669 6c65 6e61   print(f'{filena
+00002550: 6d65 7d20 7265 6164 2069 6e20 7b69 6e74  me} read in {int
+00002560: 2828 656e 642d 7374 6172 7429 2f36 3029  ((end-start)/60)
+00002570: 7d20 6d69 6e75 7465 7327 2900 2020 2020  } minutes').    
+00002580: 656e 6420 3d20 7469 6d65 2e70 6572 665f  end = time.perf_
+00002590: 636f 756e 7465 7228 2900 2020 2020 2020  counter().      
+000025a0: 2020 6466 203d 2070 642e 7265 6164 5f63    df = pd.read_c
+000025b0: 7376 2866 696c 656e 616d 652c 2064 7479  sv(filename, dty
+000025c0: 7065 3d64 7479 7065 2c20 7061 7273 655f  pe=dtype, parse_
+000025d0: 6461 7465 733d 7061 7273 655f 6461 7465  dates=parse_date
+000025e0: 732c 2075 7365 636f 6c73 3d75 7365 636f  s, usecols=useco
+000025f0: 6c73 2c20 696e 6465 785f 636f 6c3d 696e  ls, index_col=in
+00002600: 6465 785f 636f 6c29 0020 2020 2065 6c73  dex_col).    els
+00002610: 653a 0020 2020 2020 2020 2020 2020 2020  e:.             
+00002620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002630: 2020 2020 2020 2020 2020 6474 7970 653d            dtype=
+00002640: 6474 7970 652c 2070 6172 7365 5f64 6174  dtype, parse_dat
+00002650: 6573 3d70 6172 7365 5f64 6174 6573 2c20  es=parse_dates, 
+00002660: 7573 6563 6f6c 733d 7573 6563 6f6c 732c  usecols=usecols,
+00002670: 2069 6e64 6578 5f63 6f6c 3d69 6e64 6578   index_col=index
+00002680: 5f63 6f6c 2929 0020 2020 2020 2020 2064  _col)).        d
+00002690: 6620 3d20 7064 2e63 6f6e 6361 7428 7365  f = pd.concat(se
+000026a0: 6c66 2e72 6561 645f 6373 765f 6173 5f64  lf.read_csv_as_d
+000026b0: 6673 2866 696c 656e 616d 652c 206e 756d  fs(filename, num
+000026c0: 5f64 6673 3d31 302a 2a35 2c20 6d61 785f  _dfs=10**5, max_
+000026d0: 726f 7773 3d31 302a 2a37 2c20 0020 2020  rows=10**7, .   
+000026e0: 2069 6620 6669 6c65 5f73 697a 655f 6762   if file_size_gb
+000026f0: 203e 206d 6178 5f67 623a 0020 2020 2064   > max_gb:.    d
+00002700: 6620 3d20 4e6f 6e65 0020 2020 2070 7269  f = None.    pri
+00002710: 6e74 2822 4669 6c65 2053 697a 6520 6973  nt("File Size is
+00002720: 203a 222c 2066 696c 655f 7369 7a65 5f67   :", file_size_g
+00002730: 622c 2022 4742 2229 0020 2020 2070 7269  b, "GB").    pri
+00002740: 6e74 2866 2749 6d70 6f72 7469 6e67 207b  nt(f'Importing {
+00002750: 6669 6c65 6e61 6d65 7d20 6173 2061 2064  filename} as a d
+00002760: 6174 6166 7261 6d65 2729 0020 2020 2066  ataframe').    f
+00002770: 696c 655f 7369 7a65 5f67 6220 3d20 726f  ile_size_gb = ro
+00002780: 756e 6428 6669 6c65 5f73 697a 652f 3130  und(file_size/10
+00002790: 2a2a 392c 2032 2900 2020 2020 6669 6c65  **9, 2).    file
+000027a0: 5f73 697a 6520 3d20 6f73 2e70 6174 682e  _size = os.path.
+000027b0: 6765 7473 697a 6528 6669 6c65 6e61 6d65  getsize(filename
+000027c0: 2900 2020 2020 7374 6172 7420 3d20 7469  ).    start = ti
+000027d0: 6d65 2e70 6572 665f 636f 756e 7465 7228  me.perf_counter(
+000027e0: 2900 2020 6465 6620 6373 765f 746f 5f64  ).  def csv_to_d
+000027f0: 6628 7365 6c66 2c20 6669 6c65 6e61 6d65  f(self, filename
+00002800: 2c20 6474 7970 6520 3d20 4e6f 6e65 2c20  , dtype = None, 
+00002810: 7061 7273 655f 6461 7465 7320 3d20 4e6f  parse_dates = No
+00002820: 6e65 2c20 6d61 785f 6762 3d35 2c20 6e75  ne, max_gb=5, nu
+00002830: 6d5f 6466 733d 3130 2a2a 332c 2075 7365  m_dfs=10**3, use
+00002840: 636f 6c73 3d4e 6f6e 652c 2069 6e64 6578  cols=None, index
+00002850: 5f63 6f6c 3d4e 6f6e 6529 3a00 2020 2320  _col=None):.  # 
+00002860: 6765 7420 6120 706f 7465 6e74 6961 6c6c  get a potentiall
+00002870: 7920 6c61 7267 6520 6373 7620 616e 6420  y large csv and 
+00002880: 7475 726e 2069 7420 696e 746f 2061 2044  turn it into a D
+00002890: 6174 6146 7261 6d65 0000 2020 2020 7265  ataFrame..    re
+000028a0: 7475 726e 2064 6673 5f6f 7069 6e69 6f6e  turn dfs_opinion
+000028b0: 7300 2020 2020 2020 2020 636f 756e 7465  s.        counte
+000028c0: 7220 3d20 636f 756e 7465 7220 2b20 3100  r = counter + 1.
+000028d0: 2020 2020 2020 2020 6466 735f 6f70 696e          dfs_opin
+000028e0: 696f 6e73 2e61 7070 656e 6428 6466 2900  ions.append(df).
+000028f0: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+00002900: 6b00 2020 2020 2020 2020 6966 2063 6f75  k.        if cou
+00002910: 6e74 6572 203e 3d20 6e75 6d5f 6466 733a  nter >= num_dfs:
+00002920: 0020 2020 2020 2020 2020 2020 2020 2020  .               
+00002930: 2020 2020 2020 2020 2020 2070 6172 7365             parse
+00002940: 5f64 6174 6573 3d70 6172 7365 5f64 6174  _dates=parse_dat
+00002950: 6573 2c20 7573 6563 6f6c 733d 7573 6563  es, usecols=usec
+00002960: 6f6c 732c 2069 6e64 6578 5f63 6f6c 3d69  ols, index_col=i
+00002970: 6e64 6578 5f63 6f6c 293a 0020 2020 2066  ndex_col):.    f
+00002980: 6f72 2064 6620 696e 2070 642e 7265 6164  or df in pd.read
+00002990: 5f63 7376 2866 696c 656e 616d 652c 2063  _csv(filename, c
+000029a0: 6875 6e6b 7369 7a65 3d6d 6178 5f72 6f77  hunksize=max_row
+000029b0: 732c 2064 7479 7065 3d64 7479 7065 2c20  s, dtype=dtype, 
+000029c0: 0020 2020 2064 6673 5f6f 7069 6e69 6f6e  .    dfs_opinion
+000029d0: 7320 3d20 5b5d 0020 2020 2063 6f75 6e74  s = [].    count
+000029e0: 6572 203d 2030 0020 2020 2020 2020 2020  er = 0.         
+000029f0: 2020 2020 2020 2020 2020 293a 0020 2020            ):.   
+00002a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002a10: 2069 6e64 6578 5f63 6f6c 3d4e 6f6e 6500   index_col=None.
+00002a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002a30: 2020 2020 7573 6563 6f6c 733d 4e6f 6e65      usecols=None
+00002a40: 2c00 2020 2020 2020 2020 2020 2020 2020  ,.              
+00002a50: 2020 2020 2020 7061 7273 655f 6461 7465        parse_date
+00002a60: 733d 4e6f 6e65 2c00 2020 2020 2020 2020  s=None,.        
+00002a70: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
+00002a80: 653d 4e6f 6e65 2c20 0020 2020 2020 2020  e=None, .       
+00002a90: 2020 2020 2020 2020 2020 2020 206d 6178               max
+00002aa0: 5f72 6f77 733d 3130 2a2a 352c 2000 2020  _rows=10**5, .  
+00002ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002ac0: 2020 6e75 6d5f 6466 733d 3130 2c20 0020    num_dfs=10, . 
+00002ad0: 2064 6566 2072 6561 645f 6373 765f 6173   def read_csv_as
+00002ae0: 5f64 6673 2873 656c 662c 2066 696c 656e  _dfs(self, filen
+00002af0: 616d 652c 2000 2020 2020 0020 2020 204e  ame, .    .    N
+00002b00: 6f43 6170 286f 2c20 6f63 2c20 632c 2064  oCap(o, oc, c, d
+00002b10: 2c20 636d 292e 7374 6172 7428 2900 2020  , cm).start().  
+00002b20: 6465 6620 636c 6928 6f2c 206f 632c 2063  def cli(o, oc, c
+00002b30: 2c20 642c 2063 6d29 3a00 2020 4063 6c69  , d, cm):.  @cli
+00002b40: 636b 2e6f 7074 696f 6e28 272d 636d 272c  ck.option('-cm',
+00002b50: 2068 656c 703d 226c 6f63 616c 2070 6174   help="local pat
+00002b60: 6820 746f 2063 6974 6174 696f 6e20 6d61  h to citation ma
+00002b70: 7020 6669 6c65 222c 2072 6571 7569 7265  p file", require
+00002b80: 643d 5472 7565 2900 2020 4063 6c69 636b  d=True).  @click
+00002b90: 2e6f 7074 696f 6e28 272d 6427 2c20 6865  .option('-d', he
+00002ba0: 6c70 3d22 6c6f 6361 6c20 7061 7468 2074  lp="local path t
+00002bb0: 6f20 646f 636b 6574 7320 6669 6c65 222c  o dockets file",
+00002bc0: 2072 6571 7569 7265 643d 5472 7565 2900   required=True).
+00002bd0: 2020 4063 6c69 636b 2e6f 7074 696f 6e28    @click.option(
+00002be0: 272d 6327 2c20 6865 6c70 3d22 6c6f 6361  '-c', help="loca
+00002bf0: 6c20 7061 7468 2074 6f20 636f 7572 7473  l path to courts
+00002c00: 2066 696c 6520 222c 2072 6571 7569 7265   file ", require
+00002c10: 643d 5472 7565 2900 2020 4063 6c69 636b  d=True).  @click
+00002c20: 2e6f 7074 696f 6e28 272d 6f63 272c 2068  .option('-oc', h
+00002c30: 656c 703d 226c 6f63 616c 2070 6174 6820  elp="local path 
+00002c40: 746f 206f 7069 6e69 6f6e 2063 6c75 7374  to opinion clust
+00002c50: 6572 7320 6669 6c65 222c 2072 6571 7569  ers file", requi
+00002c60: 7265 643d 5472 7565 2900 2020 4063 6c69  red=True).  @cli
+00002c70: 636b 2e6f 7074 696f 6e28 272d 6f27 2c20  ck.option('-o', 
+00002c80: 6865 6c70 3d22 6c6f 6361 6c20 7061 7468  help="local path
+00002c90: 2074 6f20 6f70 696e 696f 6e73 2066 696c   to opinions fil
+00002ca0: 6522 2c20 7265 7175 6972 6564 3d54 7275  e", required=Tru
+00002cb0: 6529 0020 2040 636c 6963 6b2e 636f 6d6d  e).  @click.comm
+00002cc0: 616e 6428 2920 2000 0020 2020 2073 656c  and()  ..    sel
+00002cd0: 662e 4461 7461 4672 616d 6520 3d20 7064  f.DataFrame = pd
+00002ce0: 2e63 6f72 652e 6672 616d 652e 4461 7461  .core.frame.Data
+00002cf0: 4672 616d 6500 2020 2020 2373 656c 662e  Frame.    #self.
+00002d00: 5f64 665f 6f70 696e 696f 6e73 203d 2073  _df_opinions = s
+00002d10: 656c 662e 696e 6974 5f6f 7069 6e69 6f6e  elf.init_opinion
+00002d20: 735f 6466 2829 0000 2020 2020 7365 6c66  s_df()..    self
+00002d30: 2e5f 6466 5f64 6f63 6b65 7473 203d 2073  ._df_dockets = s
+00002d40: 656c 662e 696e 6974 5f64 6f63 6b65 7473  elf.init_dockets
+00002d50: 5f64 6628 2900 2020 2020 7365 6c66 2e5f  _df().    self._
+00002d60: 6466 5f63 6974 6174 696f 6e20 3d20 7365  df_citation = se
+00002d70: 6c66 2e69 6e69 745f 6369 7461 7469 6f6e  lf.init_citation
+00002d80: 5f64 6628 2900 2020 2020 7365 6c66 2e5f  _df().    self._
+00002d90: 6466 5f6f 7069 6e69 6f6e 5f63 6c75 7374  df_opinion_clust
+00002da0: 6572 7320 3d20 7365 6c66 2e69 6e69 745f  ers = self.init_
+00002db0: 6f70 696e 696f 6e5f 636c 7573 7465 7273  opinion_clusters
+00002dc0: 5f64 6628 2900 2020 2020 7365 6c66 2e5f  _df().    self._
+00002dd0: 6466 5f63 6f75 7274 7320 3d20 7365 6c66  df_courts = self
+00002de0: 2e69 6e69 745f 636f 7572 7473 5f64 6628  .init_courts_df(
+00002df0: 2900 0020 2020 2073 656c 662e 5f63 6974  )..    self._cit
+00002e00: 6174 696f 6e5f 666e 203d 2063 6974 6174  ation_fn = citat
+00002e10: 696f 6e5f 666e 0020 2020 2073 656c 662e  ion_fn.    self.
+00002e20: 5f64 6f63 6b65 7473 5f66 6e20 3d20 646f  _dockets_fn = do
+00002e30: 636b 6574 735f 666e 0020 2020 2073 656c  ckets_fn.    sel
+00002e40: 662e 5f63 6f75 7274 735f 666e 203d 2063  f._courts_fn = c
+00002e50: 6f75 7274 735f 666e 0020 2020 2073 656c  ourts_fn.    sel
+00002e60: 662e 5f6f 7069 6e69 6f6e 5f63 6c75 7374  f._opinion_clust
+00002e70: 6572 735f 666e 203d 206f 7069 6e69 6f6e  ers_fn = opinion
+00002e80: 5f63 6c75 7374 6572 735f 666e 0020 2020  _clusters_fn.   
+00002e90: 2073 656c 662e 5f6f 7069 6e69 6f6e 735f   self._opinions_
+00002ea0: 666e 203d 206f 7069 6e69 6f6e 735f 666e  fn = opinions_fn
+00002eb0: 0020 2064 6566 205f 5f69 6e69 745f 5f28  .  def __init__(
+00002ec0: 7365 6c66 2c20 6f70 696e 696f 6e73 5f66  self, opinions_f
+00002ed0: 6e2c 206f 7069 6e69 6f6e 5f63 6c75 7374  n, opinion_clust
+00002ee0: 6572 735f 666e 2c20 636f 7572 7473 5f66  ers_fn, courts_f
+00002ef0: 6e2c 2064 6f63 6b65 7473 5f66 6e2c 2063  n, dockets_fn, c
+00002f00: 6974 6174 696f 6e5f 666e 293a 0063 6c61  itation_fn):.cla
+00002f10: 7373 204e 6f43 6170 3a00 0069 6d70 6f72  ss NoCap:..impor
+00002f20: 7420 7265 0069 6d70 6f72 7420 636c 6963  t re.import clic
+00002f30: 6b00 696d 706f 7274 206f 7300 696d 706f  k.import os.impo
+00002f40: 7274 2074 696d 6569 7400 696d 706f 7274  rt timeit.import
+00002f50: 2074 696d 6500 696d 706f 7274 206d 756c   time.import mul
+00002f60: 7469 7072 6f63 6573 7369 6e67 2061 7320  tiprocessing as 
+00002f70: 6d70 0069 6d70 6f72 7420 6461 736b 2e64  mp.import dask.d
+00002f80: 6174 6166 7261 6d65 2061 7320 6464 0066  ataframe as dd.f
 00002f90: 726f 6d20 6461 736b 2e64 6973 7472 6962  rom dask.distrib
 00002fa0: 7574 6564 2069 6d70 6f72 7420 436c 6965  uted import Clie
 00002fb0: 6e74 2c20 7072 6f67 7265 7373 0069 6d70  nt, progress.imp
 00002fc0: 6f72 7420 6461 736b 0069 6d70 6f72 7420  ort dask.import 
 00002fd0: 6e75 6d70 7920 6173 206e 7000 696d 706f  numpy as np.impo
 00002fe0: 7274 2070 616e 6461 7320 6173 2070 6400  rt pandas as pd.
 00002ff0: 2321 2f75 7372 2f62 696e 2f65 6e76 2000  #!/usr/bin/env .
-00003000: 6164 0000 1807 0000 5408 0000 0010 0000  ad......T.......
-00003010: 4800 0000 0000 0000 d50f 0000 c70f 0000  H...............
-00003020: bd0f 0000 b70f 0000 a80f 0000 a70f 0000  ................
-00003030: 8c0f 0000 830f 0000 710f 0000 570f 0000  ........q...W...
-00003040: 3b0f 0000 210f 0000 060f 0000 ec0e 0000  ;...!...........
-00003050: d80e 0000 bd0e 0000 a00e 0000 830e 0000  ................
-00003060: 6f0e 0000 360e 0000 220e 0000 140e 0000  o...6...".......
-00003070: 130e 0000 000e 0000 e00d 0000 cd0d 0000  ................
-00003080: b60d 0000 940d 0000 750d 0000 560d 0000  ........u...V...
-00003090: 3d0d 0000 1d0d 0000 fb0c 0000 d80c 0000  =...............
-000030a0: b00c 0000 920c 0000 8c0c 0000 590c 0000  ............Y...
-000030b0: 2c0c 0000 f10b 0000 c10b 0000 6e0b 0000  ,...........n...
-000030c0: 560b 0000 400b 0000 c80a 0000 a30a 0000  V...@...........
-000030d0: 860a 0000 740a 0000 5a0a 0000 3e0a 0000  ....t...Z...>...
-000030e0: 240a 0000 090a 0000 ef09 0000 db09 0000  $...............
-000030f0: c009 0000 a309 0000 8609 0000 6d09 0000  ............m...
-00003100: 6c09 0000 3409 0000 0909 0000 df08 0000  l...4...........
-00003110: c108 0000 bc08 0000 9e08 0000 8408 0000  ................
-00003120: 8308 0000 8208 0000 6708 0000 5908 0000  ........g...Y...
-00003130: 5508 0000 5408 0000 0000 0000 0000 0000  U...T...........
-00003140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003000: 6164 0000 5c04 0000 c805 0000 0010 0000  ad..\...........
+00003010: 5400 0000 0000 0000 c40f 0000 8f0f 0000  T...............
+00003020: 650f 0000 2c0f 0000 0c0f 0000 ed0e 0000  e...,...........
+00003030: b40e 0000 710e 0000 510e 0000 2f0e 0000  ....q...Q.../...
+00003040: f80d 0000 dd0d 0000 a40d 0000 790d 0000  ............y...
+00003050: 6b0d 0000 610d 0000 5b0d 0000 4c0d 0000  k...a...[...L...
+00003060: 4b0d 0000 300d 0000 270d 0000 150d 0000  K...0...'.......
+00003070: fb0c 0000 df0c 0000 c50c 0000 aa0c 0000  ................
+00003080: 900c 0000 7c0c 0000 610c 0000 440c 0000  ....|...a...D...
+00003090: 270c 0000 130c 0000 d60b 0000 c20b 0000  '...............
+000030a0: b40b 0000 b30b 0000 8f0b 0000 7e0b 0000  ............~...
+000030b0: 590b 0000 3d0b 0000 090b 0000 ec0a 0000  Y...=...........
+000030c0: c90a 0000 c40a 0000 b10a 0000 910a 0000  ................
+000030d0: 7f0a 0000 680a 0000 460a 0000 270a 0000  ....h...F...'...
+000030e0: 080a 0000 ef09 0000 cf09 0000 ad09 0000  ................
+000030f0: 8a09 0000 6209 0000 4409 0000 3e09 0000  ....b...D...>...
+00003100: 2e09 0000 1d09 0000 0109 0000 e808 0000  ................
+00003110: cf08 0000 b508 0000 9c08 0000 8908 0000  ................
+00003120: 6f08 0000 5308 0000 3608 0000 1308 0000  o...S...6.......
+00003130: 0708 0000 d407 0000 a707 0000 6c07 0000  ............l...
+00003140: 3c07 0000 eb06 0000 7006 0000 4c06 0000  <.......p...L...
+00003150: 2a06 0000 0c06 0000 f205 0000 f105 0000  *...............
+00003160: d605 0000 c805 0000 a105 0000 9505 0000  ................
+00003170: e005 0000 7105 0000 6a05 0000 0000 0000  ....q...j.......
 00003180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000031a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000031b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000031c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000031d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000031e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -848,460 +848,460 @@
 000034f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000035a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000035b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000035c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000035d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000035e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000035f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000036a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000036b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000036c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000036d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000036e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000036f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000037a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000037b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000037c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000037d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000037e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000037f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003800: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003850: 0000 0000 0020 2020 0020 204e 6f43 6170  .....   .  NoCap
-00003860: 2e63 6c69 2829 0069 6620 5f5f 6e61 6d65  .cli().if __name
-00003870: 5f5f 203d 3d20 275f 5f6d 6169 6e5f 5f27  __ == '__main__'
-00003880: 3a00 0000 2020 2020 7072 696e 7428 2865  :...    print((e
-00003890: 6e64 2d73 7461 7274 292f 3630 2900 2020  nd-start)/60).  
-000038a0: 2020 656e 6420 3d20 7469 6d65 2e70 6572    end = time.per
-000038b0: 665f 636f 756e 7465 7228 2900 2020 2020  f_counter().    
-000038c0: 0020 2020 2070 7269 6e74 282a 7265 7375  .    print(*resu
-000038d0: 6c74 732c 2073 6570 3d27 5c6e 2729 0020  lts, sep='\n'). 
-000038e0: 2020 2072 6573 756c 7473 203d 2064 6173     results = das
-000038f0: 6b2e 636f 6d70 7574 6528 2a6c 617a 795f  k.compute(*lazy_
-00003900: 7265 7375 6c74 7329 0020 2020 2020 2020  results).       
-00003910: 2020 206c 617a 795f 7265 7375 6c74 732e     lazy_results.
-00003920: 6170 7065 6e64 286c 617a 795f 7265 7375  append(lazy_resu
-00003930: 6c74 2900 2020 2020 2020 2020 2020 6c61  lt).          la
-00003940: 7a79 5f72 6573 756c 7420 3d20 6461 736b  zy_result = dask
-00003950: 2e64 656c 6179 6564 2873 656c 662e 7072  .delayed(self.pr
-00003960: 6f63 6573 7329 2872 6f77 2900 0020 2020  ocess)(row)..   
-00003970: 2020 2020 2020 205d 5d2e 6974 6572 726f         ]].iterro
-00003980: 7773 2829 3a00 2020 2020 2020 2020 2020  ws():.          
+00003560: 0000 0000 0000 0000 0000 0020 204e 6f43  ...........  NoC
+00003570: 6120 204e 6f43 6170 2e63 6c69 2829 0069  a  NoCap.cli().i
+00003580: 6620 5f5f 6e61 6d20 204e 6f43 6170 2e63  f __nam  NoCap.c
+00003590: 6c69 2829 0020 204e 6f43 6170 2e63 6c69  li().  NoCap.cli
+000035a0: 2820 204e 6f43 6170 2e63 6c69 2829 0069  (  NoCap.cli().i
+000035b0: 6620 5f5f 6e61 6d65 5f5f 203d 3d20 275f  f __name__ == '_
+000035c0: 5f20 204e 6f43 2020 2020 4e6f 4361 702e  _  NoC    NoCap.
+000035d0: 636c 6928 2900 6966 205f 5f6e 616d 655f  cli().if __name_
+000035e0: 5f20 3d3d 2027 5f5f 6d61 696e 5f5f 273a  _ == '__main__':
+000035f0: 0000 2020 2020 7072 696e 7428 2865 6e64  ..    print((end
+00003600: 2d73 7461 7274 292f 3630 2900 2020 2020  -start)/60).    
+00003610: 656e 6420 3d20 7469 6d65 2e70 6572 665f  end = time.perf_
+00003620: 636f 756e 7465 7228 2900 2020 2020 2020  counter().      
+00003630: 7365 6c66 2e70 726f 6365 7373 5f64 6628  self.process_df(
+00003640: 6466 2c20 636c 6965 6e74 2900 2020 2020  df, client).    
+00003650: 2020 7072 696e 7428 274e 6f77 2072 6561    print('Now rea
+00003660: 6469 6e67 206f 7069 6e69 6f6e 7327 2900  ding opinions').
+00003670: 2020 2020 666f 7220 6466 2069 6e20 7064      for df in pd
+00003680: 2e72 6561 645f 6373 7628 7365 6c66 2e5f  .read_csv(self._
+00003690: 6f70 696e 696f 6e73 5f66 6e2c 2063 6875  opinions_fn, chu
+000036a0: 6e6b 7369 7a65 3d6d 6178 5f72 6f77 732c  nksize=max_rows,
+000036b0: 2064 7479 7065 3d6f 7069 6e69 6f6e 5f64   dtype=opinion_d
+000036c0: 7479 7065 732c 2070 6172 7365 5f64 6174  types, parse_dat
+000036d0: 6573 3d4e 6f6e 652c 2075 7365 636f 6c73  es=None, usecols
+000036e0: 3d75 7365 636f 6c73 293a 0020 2020 2063  =usecols):.    c
+000036f0: 6c69 656e 7420 3d20 436c 6965 6e74 2874  lient = Client(t
+00003700: 6872 6561 6473 5f70 6572 5f77 6f72 6b65  hreads_per_worke
+00003710: 723d 342c 206e 5f77 6f72 6b65 7273 203d  r=4, n_workers =
+00003720: 2069 6e74 286d 702e 6370 755f 636f 756e   int(mp.cpu_coun
+00003730: 7428 2920 2a20 2e33 3529 2900 2020 2020  t() * .35)).    
+00003740: 7072 696e 7428 2246 696c 6520 5369 7a65  print("File Size
+00003750: 2069 7320 3a22 2c20 6669 6c65 5f73 697a   is :", file_siz
+00003760: 655f 6762 2c20 2247 4222 2900 2020 2020  e_gb, "GB").    
+00003770: 7072 696e 7428 6627 496d 706f 7274 696e  print(f'Importin
+00003780: 6720 7b73 656c 662e 5f6f 7069 6e69 6f6e  g {self._opinion
+00003790: 735f 666e 7d20 6173 2061 2064 6174 6166  s_fn} as a dataf
+000037a0: 7261 6d65 2729 0020 2020 2066 696c 655f  rame').    file_
+000037b0: 7369 7a65 5f67 6220 3d20 726f 756e 6428  size_gb = round(
+000037c0: 6669 6c65 5f73 697a 652f 3130 2a2a 392c  file_size/10**9,
+000037d0: 2032 2900 2020 2020 6669 6c65 5f73 697a   2).    file_siz
+000037e0: 6520 3d20 6f73 2e70 6174 682e 6765 7473  e = os.path.gets
+000037f0: 697a 6528 7365 6c66 2e5f 6f70 696e 696f  ize(self._opinio
+00003800: 6e73 5f66 6e29 0020 2020 2020 2020 2020  ns_fn).         
+00003810: 205d 0020 2020 2020 2020 2020 2020 276c   ].           'l
+00003820: 6f63 616c 5f70 6174 6827 2020 2020 2020  ocal_path'      
+00003830: 2020 2020 2000 2020 2020 2020 2020 2020       .          
+00003840: 2027 6874 6d6c 5f61 6e6f 6e5f 3230 3230   'html_anon_2020
+00003850: 272c 0020 2020 2020 2020 2020 2020 2768  ',.           'h
+00003860: 746d 6c5f 636f 6c75 6d62 6961 272c 0020  tml_columbia',. 
+00003870: 2020 2020 2020 2020 2020 2768 746d 6c5f            'html_
+00003880: 6c61 7762 6f78 272c 0020 2020 2020 2020  lawbox',.       
+00003890: 2020 2020 2768 746d 6c27 2c00 2020 2020      'html',.    
+000038a0: 2020 2020 2020 2027 706c 6169 6e5f 7465         'plain_te
+000038b0: 7874 272c 0020 2020 2020 2020 2020 2020  xt',.           
+000038c0: 2778 6d6c 5f68 6172 7661 7264 272c 0020  'xml_harvard',. 
+000038d0: 2020 2020 2020 2020 2020 2763 6c75 7374            'clust
+000038e0: 6572 5f69 6427 2c00 2020 2020 2020 2020  er_id',.        
+000038f0: 2020 2027 6c6f 6361 6c5f 7061 7468 272c     'local_path',
+00003900: 0020 2020 2020 2020 2020 2020 2764 6f77  .           'dow
+00003910: 6e6c 6f61 645f 7572 6c27 2c20 0020 2020  nload_url', .   
+00003920: 2020 2020 2020 2020 2769 6427 2c00 2020          'id',.  
+00003930: 2020 7573 6563 6f6c 7320 3d20 5b00 2020    usecols = [.  
+00003940: 2020 7d00 2020 2020 2020 2020 276c 6f63    }.        'loc
+00003950: 616c 5f70 6174 6827 3a27 7374 7269 6e67  al_path':'string
+00003960: 2700 2020 2020 2020 2020 2768 746d 6c5f  '.        'html_
+00003970: 7769 7468 5f63 6974 6174 696f 6e73 273a  with_citations':
+00003980: 2773 7472 696e 6727 2c00 2020 2020 2020  'string',.      
 00003990: 2020 2768 746d 6c5f 616e 6f6e 5f32 3032    'html_anon_202
-000039a0: 3027 0020 2020 2020 2020 2020 2020 2027  0'.            '
-000039b0: 6874 6d6c 5f63 6f6c 756d 6269 6127 2c00  html_columbia',.
-000039c0: 2020 2020 2020 2020 2020 2020 2768 746d              'htm
-000039d0: 6c5f 6c61 7762 6f78 272c 0020 2020 2020  l_lawbox',.     
-000039e0: 2020 2020 2020 2027 6874 6d6c 272c 0020         'html',. 
-000039f0: 2020 2020 2020 2020 2020 2027 706c 6169             'plai
-00003a00: 6e5f 7465 7874 272c 0020 2020 2020 2020  n_text',.       
-00003a10: 2020 2020 2027 786d 6c5f 6861 7276 6172       'xml_harvar
-00003a20: 6427 2c00 2020 2020 2020 2020 2020 2020  d',.            
-00003a30: 2763 6c75 7374 6572 5f69 6427 2c00 2020  'cluster_id',.  
-00003a40: 2020 2020 2020 2020 2020 2764 6f77 6e6c            'downl
-00003a50: 6f61 645f 7572 6c27 2c00 2020 2020 2020  oad_url',.      
-00003a60: 2020 2020 2020 276c 6f63 616c 5f70 6174        'local_pat
-00003a70: 6827 2c00 2020 2020 2020 2020 2020 2020  h',.            
-00003a80: 2769 6427 2c00 2020 2020 2020 666f 7220  'id',.      for 
-00003a90: 696e 6465 782c 2072 6f77 2069 6e20 6466  index, row in df
-00003aa0: 5b5b 0020 2020 2020 2023 7072 696e 7428  [[.      #print(
-00003ab0: 274e 6f77 2072 6561 6469 6e67 206f 7069  'Now reading opi
-00003ac0: 6e69 6f6e 7327 2900 2020 2020 666f 7220  nions').    for 
-00003ad0: 6466 2069 6e20 7064 2e72 6561 645f 6373  df in pd.read_cs
-00003ae0: 7628 7365 6c66 2e5f 6f70 696e 696f 6e73  v(self._opinions
-00003af0: 5f66 6e2c 2063 6875 6e6b 7369 7a65 3d6d  _fn, chunksize=m
-00003b00: 6178 5f72 6f77 732c 2064 7479 7065 3d6f  ax_rows, dtype=o
-00003b10: 7069 6e69 6f6e 5f64 7479 7065 732c 2070  pinion_dtypes, p
-00003b20: 6172 7365 5f64 6174 6573 3d4e 6f6e 652c  arse_dates=None,
-00003b30: 2075 7365 636f 6c73 3d4e 6f6e 6529 3a00   usecols=None):.
-00003b40: 2020 2020 6c61 7a79 5f72 6573 756c 7473      lazy_results
-00003b50: 203d 205b 5d00 2020 2020 7072 696e 7428   = [].    print(
-00003b60: 7365 6c66 2e5f 636c 6965 6e74 2900 2020  self._client).  
-00003b70: 2020 7365 6c66 2e5f 636c 6965 6e74 203d    self._client =
-00003b80: 2043 6c69 656e 7428 7468 7265 6164 735f   Client(threads_
-00003b90: 7065 725f 776f 726b 6572 3d34 2c20 6e5f  per_worker=4, n_
-00003ba0: 776f 726b 6572 7320 3d20 696e 7428 6d70  workers = int(mp
-00003bb0: 2e63 7075 5f63 6f75 6e74 2829 2f32 2929  .cpu_count()/2))
-00003bc0: 0020 2020 2070 7269 6e74 2822 4669 6c65  .    print("File
-00003bd0: 2053 697a 6520 6973 203a 222c 2066 696c   Size is :", fil
-00003be0: 655f 7369 7a65 5f67 622c 2022 4742 2229  e_size_gb, "GB")
-00003bf0: 0020 2020 2070 7269 6e74 2866 2749 6d70  .    print(f'Imp
-00003c00: 6f72 7469 6e67 207b 7365 6c66 2e5f 6f70  orting {self._op
-00003c10: 696e 696f 6e73 5f66 6e7d 2061 7320 6120  inions_fn} as a 
-00003c20: 6461 7461 6672 616d 6527 2900 2020 2020  dataframe').    
-00003c30: 6669 6c65 5f73 697a 655f 6762 203d 2072  file_size_gb = r
-00003c40: 6f75 6e64 2866 696c 655f 7369 7a65 2f31  ound(file_size/1
-00003c50: 302a 2a39 2c20 3229 0020 2020 2066 696c  0**9, 2).    fil
-00003c60: 655f 7369 7a65 203d 206f 732e 7061 7468  e_size = os.path
-00003c70: 2e67 6574 7369 7a65 2873 656c 662e 5f6f  .getsize(self._o
-00003c80: 7069 6e69 6f6e 735f 666e 2900 2020 2020  pinions_fn).    
-00003c90: 7d00 2020 2020 2020 2020 276c 6f63 616c  }.        'local
-00003ca0: 5f70 6174 6827 3a27 7374 7269 6e67 2700  _path':'string'.
-00003cb0: 2020 2020 2020 2020 2768 746d 6c5f 7769          'html_wi
-00003cc0: 7468 5f63 6974 6174 696f 6e73 273a 2773  th_citations':'s
-00003cd0: 7472 696e 6727 2c00 2020 2020 2020 2020  tring',.        
-00003ce0: 2768 746d 6c5f 616e 6f6e 5f32 3032 3027  'html_anon_2020'
-00003cf0: 3a27 7374 7269 6e67 272c 0020 2020 2020  :'string',.     
-00003d00: 2020 2027 6874 6d6c 5f63 6f6c 756d 6269     'html_columbi
-00003d10: 6127 3a27 7374 7269 6e67 272c 0020 2020  a':'string',.   
-00003d20: 2020 2020 2027 6874 6d6c 5f6c 6177 626f       'html_lawbo
-00003d30: 7827 3a27 7374 7269 6e67 272c 0020 2020  x':'string',.   
-00003d40: 2020 2020 2027 6874 6d6c 273a 2773 7472       'html':'str
-00003d50: 696e 6727 2c00 2020 2020 2020 2020 2770  ing',.        'p
-00003d60: 6c61 696e 5f74 6578 7427 3a27 7374 7269  lain_text':'stri
-00003d70: 6e67 272c 0020 2020 2020 2020 2027 6c6f  ng',.        'lo
-00003d80: 6361 6c5f 7061 7468 273a 2773 7472 696e  cal_path':'strin
-00003d90: 6727 2c00 2020 2020 2020 2020 2764 6f77  g',.        'dow
-00003da0: 6e6c 6f61 645f 7572 6c27 3a20 2773 7472  nload_url': 'str
-00003db0: 696e 6727 2c00 2020 2020 6f70 696e 696f  ing',.    opinio
-00003dc0: 6e5f 6474 7970 6573 203d 207b 0020 2020  n_dtypes = {.   
-00003dd0: 206d 6178 5f72 6f77 7320 3d20 3530 3000   max_rows = 500.
-00003de0: 2020 2020 7374 6172 7420 3d20 7469 6d65      start = time
-00003df0: 2e70 6572 665f 636f 756e 7465 7228 2900  .perf_counter().
-00003e00: 2020 6465 6620 7374 6172 7428 7365 6c66    def start(self
-00003e10: 293a 0000 2020 2020 2020 2020 2020 2920  ):..          ) 
-00003e20: 2000 2020 2020 2020 2020 2020 2020 6178   .            ax
-00003e30: 6973 3d31 2c00 2020 2020 2020 2020 2020  is=1,.          
-00003e40: 2020 6c61 6d62 6461 2072 6f77 3a20 7072    lambda row: pr
-00003e50: 696e 7428 6627 7b73 656c 662e 7072 6f63  int(f'{self.proc
-00003e60: 6573 7328 726f 7729 7d5c 6e27 292c 0020  ess(row)}\n'),. 
-00003e70: 2020 2020 2020 2020 205d 5d2e 6170 706c           ]].appl
-00003e80: 7928 0020 2020 2020 2020 2020 2020 2027  y(.            '
-00003e90: 6874 6d6c 5f61 6e6f 6e5f 3230 3230 2700  html_anon_2020'.
-00003ea0: 2020 2020 2020 2020 2020 2020 2768 746d              'htm
-00003eb0: 6c5f 636f 6c75 6d62 6961 272c 0020 2020  l_columbia',.   
-00003ec0: 2020 2020 2020 2020 2027 6874 6d6c 5f6c           'html_l
-00003ed0: 6177 626f 7827 2c00 2020 2020 2020 2020  awbox',.        
-00003ee0: 2020 2020 2768 746d 6c27 2c00 2020 2020      'html',.    
-00003ef0: 2020 2020 2020 2020 2770 6c61 696e 5f74          'plain_t
-00003f00: 6578 7427 2c00 2020 2020 2020 2020 2020  ext',.          
-00003f10: 2020 2778 6d6c 5f68 6172 7661 7264 272c    'xml_harvard',
-00003f20: 0020 2020 2020 2020 2020 2020 2027 636c  .            'cl
-00003f30: 7573 7465 725f 6964 272c 0020 2020 2020  uster_id',.     
-00003f40: 2020 2020 2020 2027 646f 776e 6c6f 6164         'download
-00003f50: 5f75 726c 272c 0020 2020 2020 2020 2020  _url',.         
-00003f60: 2020 2027 6c6f 6361 6c5f 7061 7468 272c     'local_path',
-00003f70: 0020 2020 2020 2020 2020 2020 2027 6964  .            'id
-00003f80: 272c 0020 2020 2064 665b 5b00 2020 6465  ',.    df[[.  de
-00003f90: 6620 5f74 6178 6f6e 6966 7928 7365 6c66  f _taxonify(self
-00003fa0: 2c20 6466 293a 0000 2020 2020 7265 7475  , df):..    retu
-00003fb0: 726e 206f 626a 0020 2020 207d 0020 2020  rn obj.    }.   
-00003fc0: 2020 2020 207d 0020 2020 2020 2020 2020       }.         
-00003fd0: 2020 207d 0020 2020 2020 2020 2020 2020     }.           
-00003fe0: 2020 2020 2027 6175 7468 6f72 273a 2027       'author': '
-00003ff0: 272c 2027 7479 7065 273a 2027 277d 5d00  ', 'type': ''}].
-00004000: 6164 0000 6909 0000 310a 0000 0010 0000  ad..i...1.......
-00004010: 2b00 0000 0000 0000 950f 0000 880f 0000  +...............
-00004020: 6b0f 0000 4f0f 0000 490f 0000 480f 0000  k...O...I...H...
-00004030: 2f0f 0000 0a0f 0000 da0e 0000 7b0e 0000  /...........{...
-00004040: 7a0e 0000 5f0e 0000 380e 0000 1f0e 0000  z..._...8.......
-00004050: fd0d 0000 de0d 0000 bf0d 0000 a60d 0000  ................
-00004060: 860d 0000 640d 0000 410d 0000 190d 0000  ....d...A.......
-00004070: fb0c 0000 f20c 0000 f10c 0000 960c 0000  ................
-00004080: 950c 0000 720c 0000 430c 0000 f60b 0000  ....r...C.......
-00004090: 8b0b 0000 8a0b 0000 700b 0000 4a0b 0000  ........p...J...
-000040a0: 340b 0000 1b0b 0000 130b 0000 120b 0000  4...............
-000040b0: ff0a 0000 e40a 0000 db0a 0000 da0a 0000  ................
-000040c0: 310a 0000 e809 0000 660a 0000 3f0a 0000  1.......f...?...
-000040d0: 0a0a 0000 090a 0000 fc09 0000 e109 0000  ................
-000040e0: c409 0000 c309 0000 a609 0000 8709 0000  ................
-000040f0: 8409 0000 6809 0000 4a09 0000 4909 0000  ....h...J...I...
-00004100: 2409 0000 fd08 0000 fc08 0000 df08 0000  $...............
-00004110: d408 0000 cd08 0000 c108 0000 9b08 0000  ................
-00004120: 7708 0000 5508 0000 2e08 0000 0f08 0000  w...U...........
-00004130: e807 0000 e707 0000 9307 0000 2a07 0000  ............*...
-00004140: 2907 0000 e206 0000 b406 0000 6f06 0000  )...........o...
-00004150: 6e06 0000 4f06 0000 3606 0000 2606 0000  n...O...6...&...
-00004160: cf05 0000 b705 0000 a805 0000 a705 0000  ................
-00004170: 8b05 0000 4d05 0000 2405 0000 fb04 0000  ....M...$.......
-00004180: fa04 0000 ee04 0000 ce04 0000 c504 0000  ................
-00004190: b904 0000 9f04 0000 7704 0000 3b04 0000  ........w...;...
-000041a0: 0604 0000 c903 0000 9003 0000 7003 0000  ............p...
-000041b0: 5103 0000 1803 0000 d502 0000 b502 0000  Q...............
-000041c0: 6302 0000 2c02 0000 1102 0000 d801 0000  c...,...........
-000041d0: e901 0000 0000 0000 2020 2020 2020 2020  ........        
-000041e0: 2020 2020 2020 2020 2774 6578 7427 3a20          'text': 
-000041f0: 7365 6c66 2e67 6574 5f6f 7069 6e69 6f6e  self.get_opinion
-00004200: 5f74 6578 7428 6f70 696e 696f 6e29 2c20  _text(opinion), 
-00004210: 0020 2020 2020 2020 2020 2020 2027 6f70  .            'op
-00004220: 696e 696f 6e73 273a 205b 7b00 2020 2020  inions': [{.    
-00004230: 2020 2020 2020 2020 2768 6561 645f 6d61          'head_ma
-00004240: 7474 6572 273a 2727 2c20 2341 736b 2043  tter':'', #Ask C
-00004250: 4c20 6162 6f75 7420 636f 7079 7269 6768  L about copyrigh
-00004260: 742c 0020 2020 2020 2020 2020 2020 2027  t,.            '
-00004270: 6a75 6467 6573 273a 206a 7564 6765 732e  judges': judges.
-00004280: 696c 6f63 5b30 5d2e 7370 6c69 7428 272c  iloc[0].split(',
-00004290: 2729 2069 6620 6a75 6467 6573 2e6e 6f74  ') if judges.not
-000042a0: 6e61 2829 2e62 6f6f 6c28 2920 656c 7365  na().bool() else
-000042b0: 205b 5d2c 0020 2020 2020 2020 2027 6361   [],.        'ca
-000042c0: 7365 626f 6479 2720 3a20 7b27 6461 7461  sebody' : {'data
-000042d0: 273a 207b 0020 2020 2020 2020 2027 6a75  ': {.        'ju
-000042e0: 7269 7364 6963 7469 6f6e 2720 3a20 7b27  risdiction' : {'
-000042f0: 6e61 6d65 273a 2063 6f75 7274 5f72 6f77  name': court_row
-00004300: 2e6a 7572 6973 6469 6374 696f 6e2e 696c  .jurisdiction.il
-00004310: 6f63 5b30 5d7d 2c00 2020 2020 2020 2020  oc[0]},.        
-00004320: 2763 6f75 7274 2720 3a20 7b27 6e61 6d65  'court' : {'name
-00004330: 273a 2063 6f75 7274 5f72 6f77 2e66 756c  ': court_row.ful
-00004340: 6c5f 6e61 6d65 2e69 6c6f 635b 305d 7d2c  l_name.iloc[0]},
-00004350: 0020 2020 2020 2020 2027 6369 7465 735f  .        'cites_
-00004360: 746f 2720 3a20 6369 7465 735f 746f 2c00  to' : cites_to,.
-00004370: 2020 2020 2020 2020 2763 6974 6174 696f          'citatio
-00004380: 6e73 2720 3a20 6369 7465 645f 6279 2c00  ns' : cited_by,.
-00004390: 2020 2020 2020 2020 2764 6f63 6b65 745f          'docket_
-000043a0: 6e75 6d62 6572 2720 3a20 636c 7573 7465  number' : cluste
-000043b0: 725f 726f 772e 646f 636b 6574 5f69 642e  r_row.docket_id.
-000043c0: 696c 6f63 5b30 5d2c 0020 2020 2020 2020  iloc[0],.       
-000043d0: 2027 6465 6369 7369 6f6e 5f64 6174 6527   'decision_date'
-000043e0: 3a20 646f 636b 6574 5f72 6f77 2e64 6174  : docket_row.dat
-000043f0: 655f 7465 726d 696e 6174 6564 2e69 6c6f  e_terminated.ilo
-00004400: 635b 305d 2c00 2020 2020 2020 2020 276e  c[0],.        'n
-00004410: 616d 6527 203a 2063 6c75 7374 6572 5f72  ame' : cluster_r
-00004420: 6f77 2e63 6173 655f 6e61 6d65 5f66 756c  ow.case_name_ful
-00004430: 6c2e 696c 6f63 5b30 5d2c 0020 2020 2020  l.iloc[0],.     
-00004440: 2020 2027 6e61 6d65 5f61 6262 7265 7669     'name_abbrevi
-00004450: 6174 696f 6e27 3a20 636c 7573 7465 725f  ation': cluster_
-00004460: 726f 772e 6361 7365 5f6e 616d 652e 696c  row.case_name.il
-00004470: 6f63 5b30 5d2c 0020 2020 2020 2020 2027  oc[0],.        '
-00004480: 7572 6c27 3a20 6f70 696e 696f 6e5b 2764  url': opinion['d
-00004490: 6f77 6e6c 6f61 645f 7572 6c27 5d2c 0020  ownload_url'],. 
-000044a0: 2020 2020 2020 2027 6964 273a 2063 6c75         'id': clu
-000044b0: 7374 6572 5f69 642c 0020 2020 206f 626a  ster_id,.    obj
-000044c0: 203d 207b 0020 2020 2020 2020 2000 2020   = {.        .  
-000044d0: 2020 6a75 6467 6573 203d 2063 6c75 7374    judges = clust
-000044e0: 6572 5f72 6f77 2e6a 7564 6765 7300 2020  er_row.judges.  
-000044f0: 2020 236a 7564 6765 7300 0020 2020 2063    #judges..    c
-00004500: 6974 6564 5f62 7920 3d20 6369 7461 7469  ited_by = citati
-00004510: 6f6e 5f69 6e66 6f5b 2763 6974 6564 5f62  on_info['cited_b
-00004520: 7927 5d00 2020 2020 6369 7465 735f 746f  y'].    cites_to
-00004530: 203d 2063 6974 6174 696f 6e5f 696e 666f   = citation_info
-00004540: 5b27 6369 7465 735f 746f 275d 0020 2020  ['cites_to'].   
-00004550: 2063 6974 6174 696f 6e5f 696e 666f 203d   citation_info =
-00004560: 2073 656c 662e 6765 745f 6369 7461 7469   self.get_citati
-00004570: 6f6e 7328 6f70 696e 696f 6e5f 6964 2c20  ons(opinion_id, 
-00004580: 6369 7461 7469 6f6e 7329 0020 2020 2023  citations).    #
-00004590: 2067 6574 206f 7069 6e69 6f6e 7320 6369   get opinions ci
-000045a0: 7465 6420 746f 0000 2020 2020 2020 2020  ted to..        
-000045b0: 7265 7475 726e 0020 2020 2069 6620 636f  return.    if co
-000045c0: 7572 745f 726f 772e 656d 7074 793a 0020  urt_row.empty:. 
-000045d0: 2020 2063 6f75 7274 5f72 6f77 3a20 7365     court_row: se
-000045e0: 6c66 2e44 6174 6146 7261 6d65 203d 2063  lf.DataFrame = c
-000045f0: 6f75 7274 735b 636f 7572 7473 5b27 6964  ourts[courts['id
-00004600: 275d 203d 3d20 646f 636b 6574 5f72 6f77  '] == docket_row
-00004610: 5b27 636f 7572 745f 6964 275d 2e69 6c6f  ['court_id'].ilo
-00004620: 635b 305d 5d00 2020 2020 2020 2020 7265  c[0]].        re
-00004630: 7475 726e 2000 2020 2020 6966 2064 6f63  turn .    if doc
-00004640: 6b65 745f 726f 772e 656d 7074 793a 0020  ket_row.empty:. 
-00004650: 2020 2023 2072 6574 7572 6e20 6561 726c     # return earl
-00004660: 7920 6966 2074 6865 7265 2773 2000 0020  y if there's .. 
-00004670: 2020 2064 6f63 6b65 745f 726f 773a 2073     docket_row: s
-00004680: 656c 662e 4461 7461 4672 616d 6520 3d20  elf.DataFrame = 
-00004690: 646f 636b 6574 735b 646f 636b 6574 735b  dockets[dockets[
-000046a0: 2769 6427 5d20 3d3d 2064 6f63 6b65 745f  'id'] == docket_
-000046b0: 6964 5d00 2020 2020 646f 636b 6574 5f69  id].    docket_i
-000046c0: 6420 3d20 696e 7428 636c 7573 7465 725f  d = int(cluster_
-000046d0: 726f 775b 2764 6f63 6b65 745f 6964 275d  row['docket_id']
-000046e0: 2900 2020 2020 2320 6765 7420 636f 7272  ).    # get corr
-000046f0: 6573 706f 6e64 696e 6720 726f 7720 6672  esponding row fr
-00004700: 6f6d 2064 6f63 6b65 7420 6466 2062 6173  om docket df bas
-00004710: 6564 206f 6e20 636c 7573 7465 7220 6f70  ed on cluster op
-00004720: 696e 696f 6e20 6964 0000 2020 2020 636c  inion id..    cl
-00004730: 7573 7465 725f 726f 773a 2073 656c 662e  uster_row: self.
-00004740: 4461 7461 4672 616d 6520 3d20 7365 6c66  DataFrame = self
-00004750: 2e64 665f 726f 775f 6279 5f76 616c 7565  .df_row_by_value
-00004760: 2873 656c 662e 6765 745f 6f70 696e 696f  (self.get_opinio
-00004770: 6e73 5f63 6c75 7374 6572 5f64 6628 292c  ns_cluster_df(),
-00004780: 2027 6964 272c 2063 6c75 7374 6572 5f69   'id', cluster_i
-00004790: 6429 0020 2020 2023 2067 6574 2065 6163  d).    # get eac
-000047a0: 6820 636f 7272 6573 706f 6e64 696e 6720  h corresponding 
-000047b0: 726f 7720 6672 6f6d 2063 6c75 7374 6572  row from cluster
-000047c0: 732c 2064 6f63 6b65 7473 2c20 636f 7572  s, dockets, cour
-000047d0: 7473 2062 6173 6564 206f 6e20 6f70 696e  ts based on opin
-000047e0: 696f 6e20 6964 0000 2020 2020 636c 7573  ion id..    clus
-000047f0: 7465 725f 6964 203d 206f 7069 6e69 6f6e  ter_id = opinion
-00004800: 5b27 636c 7573 7465 725f 6964 275d 0020  ['cluster_id']. 
-00004810: 2020 206f 7069 6e69 6f6e 5f69 6420 3d20     opinion_id = 
-00004820: 6f70 696e 696f 6e5b 2769 6427 5d00 2020  opinion['id'].  
-00004830: 2020 6369 7461 7469 6f6e 7320 3d20 7365    citations = se
-00004840: 6c66 2e67 6574 5f63 6974 6174 696f 6e5f  lf.get_citation_
-00004850: 6466 2829 0020 2020 2063 6f75 7274 7320  df().    courts 
-00004860: 3d20 7365 6c66 2e67 6574 5f63 6f75 7274  = self.get_court
-00004870: 735f 6466 2829 0020 2020 2064 6f63 6b65  s_df().    docke
-00004880: 7473 203d 2073 656c 662e 6765 745f 646f  ts = self.get_do
-00004890: 636b 6574 735f 6466 2829 0020 2064 6566  ckets_df().  def
-000048a0: 2070 726f 6365 7373 2873 656c 662c 206f   process(self, o
-000048b0: 7069 6e69 6f6e 2920 2d3e 2064 6963 743a  pinion) -> dict:
-000048c0: 0020 2023 2070 726f 6365 7373 0020 2020  .  # process.   
-000048d0: 2020 2000 2020 2020 2020 7061 7373 0020     .      pass. 
-000048e0: 2064 6566 2067 6574 5f6f 7069 6e69 6f6e   def get_opinion
-000048f0: 735f 6466 2873 656c 6629 3a00 0020 2020  s_df(self):..   
-00004900: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00004910: 6466 5f6f 7069 6e69 6f6e 5f63 6c75 7374  df_opinion_clust
-00004920: 6572 7300 2020 6465 6620 6765 745f 6f70  ers.  def get_op
-00004930: 696e 696f 6e73 5f63 6c75 7374 6572 5f64  inions_cluster_d
-00004940: 6628 7365 6c66 293a 0000 2020 2020 2020  f(self):..      
-00004950: 7265 7475 726e 2073 656c 662e 5f64 665f  return self._df_
-00004960: 646f 636b 6574 7300 2020 6465 6620 6765  dockets.  def ge
-00004970: 745f 646f 636b 6574 735f 6466 2873 656c  t_dockets_df(sel
-00004980: 6629 3a00 2020 0020 2020 2020 2072 6574  f):.  .      ret
-00004990: 7572 6e20 7365 6c66 2e5f 6466 5f63 6974  urn self._df_cit
-000049a0: 6174 696f 6e00 2020 6465 6620 6765 745f  ation.  def get_
-000049b0: 6369 7461 7469 6f6e 5f64 6628 7365 6c66  citation_df(self
-000049c0: 293a 0000 2020 2020 2020 7265 7475 726e  ):..      return
-000049d0: 2073 656c 662e 5f64 665f 636f 7572 7473   self._df_courts
-000049e0: 0020 2064 6566 2067 2020 2020 2020 7265  .  def g      re
-000049f0: 7475 726e 2073 656c 662e 6373 765f 746f  turn self.csv_to
-00004a00: 5f64 6628 666e 206f 7220 7365 6c66 2e5f  _df(fn or self._
-00004a10: 646f 636b 6574 735f 666e 2c20 6474 7970  dockets_fn, dtyp
-00004a20: 653d 6d79 5f74 7970 6573 2c20 7061 7273  e=my_types, pars
-00004a30: 6520 2020 2020 2072 6574 7572 6e20 7365  e      return se
-00004a40: 6c66 2e63 7376 5f74 6f5f 6466 2866 6e20  lf.csv_to_df(fn 
-00004a50: 6f72 2073 656c 662e 5f64 6f63 6b65 7473  or self._dockets
-00004a60: 5f66 6e2c 2064 7479 7065 3d6d 795f 7479  _fn, dtype=my_ty
-00004a70: 7065 732c 2070 6172 7365 5f64 6174 6573  pes, parse_dates
-00004a80: 3d70 6172 7365 5f64 6174 6573 2c20 7573  =parse_dates, us
-00004a90: 6563 6f6c 733d 5b27 636f 7572 745f 6964  ecols=['court_id
-00004aa0: 272c 2027 6964 272c 2027 6461 7465 5f74  ', 'id', 'date_t
-00004ab0: 6572 6d69 6e61 7465 6427 5d2c 2069 6e64  erminated'], ind
-00004ac0: 6578 5f63 6f6c 3d27 6964 2729 2e73 6f72  ex_col='id').sor
-00004ad0: 745f 696e 6465 7828 2900 0020 2020 2020  t_index()..     
-00004ae0: 207d 2000 2020 2020 2020 2763 6f75 7274   } .      'court
-00004af0: 5f69 6427 3a20 2773 7472 696e 6727 0020  _id': 'string'. 
-00004b00: 2020 2020 206d 795f 7479 7065 7320 3d20       my_types = 
-00004b10: 7b00 0020 2020 2020 205d 0020 2020 2020  {..      ].     
-00004b20: 2027 6461 7465 5f74 6572 6d69 6e61 7465   'date_terminate
-00004b30: 6427 2c00 2020 2020 2020 7061 7273 655f  d',.      parse_
-00004b40: 6461 7465 7320 3d20 5b00 2020 6465 6620  dates = [.  def 
-00004b50: 696e 6974 5f64 6f63 6b65 7473 5f64 6628  init_dockets_df(
-00004b60: 7365 6c66 2c20 666e 3d4e 6f6e 6529 3a00  self, fn=None):.
-00004b70: 2020 2320 696e 6974 6961 6c69 7a65 2064    # initialize d
-00004b80: 6f63 6b65 7473 2064 6600 0020 2020 2020  ockets df..     
-00004b90: 2072 6574 7572 6e20 7365 6c66 2e63 7376   return self.csv
-00004ba0: 5f74 6f5f 6466 2866 6e20 6f72 2073 656c  _to_df(fn or sel
-00004bb0: 662e 5f6f 7069 6e69 6f6e 5f63 6c75 7374  f._opinion_clust
-00004bc0: 6572 735f 666e 2c20 7573 6563 6f6c 733d  ers_fn, usecols=
-00004bd0: 7573 6563 6f6c 732c 2069 6e64 6578 5f63  usecols, index_c
-00004be0: 6f6c 3d27 6964 2729 2e73 6f72 745f 696e  ol='id').sort_in
-00004bf0: 6465 7828 2900 2020 2020 2020 7573 6563  dex().      usec
-00004c00: 6f6c 7320 3d20 5b27 6964 272c 2027 6a75  ols = ['id', 'ju
-00004c10: 6467 6573 272c 2027 646f 636b 6574 5f69  dges', 'docket_i
-00004c20: 6427 2c20 2763 6173 655f 6e61 6d65 272c  d', 'case_name',
-00004c30: 2027 6361 7365 5f6e 616d 655f 6675 6c6c   'case_name_full
-00004c40: 275d 0020 2064 6566 2069 6e69 745f 6f70  '].  def init_op
-00004c50: 696e 696f 6e5f 636c 7573 7465 7273 5f64  inion_clusters_d
-00004c60: 6628 7365 6c66 2c20 666e 3d4e 6f6e 6529  f(self, fn=None)
-00004c70: 3a00 2020 2320 696e 6974 6961 6c69 7a65  :.  # initialize
-00004c80: 206f 7069 6e69 6f6e 2063 6c75 7374 6572   opinion cluster
-00004c90: 7320 6466 0000 2020 2020 2020 7265 7475  s df..      retu
-00004ca0: 726e 2073 656c 662e 6373 765f 746f 5f64  rn self.csv_to_d
-00004cb0: 6628 666e 206f 7220 7365 6c66 2e5f 6f70  f(fn or self._op
-00004cc0: 696e 696f 6e73 5f66 6e2c 2064 7479 7065  inions_fn, dtype
-00004cd0: 3d6f 7069 6e69 6f6e 5f64 7479 7065 732c  =opinion_dtypes,
-00004ce0: 2069 6e64 6578 5f63 6f6c 3d27 6964 2729   index_col='id')
-00004cf0: 0000 2020 2020 2020 7d20 0020 2020 2020  ..      } .     
-00004d00: 2020 2027 6c6f 6361 6c5f 7061 7468 273a     'local_path':
-00004d10: 2773 7472 696e 6727 0020 2020 2020 2020  'string'.       
-00004d20: 2027 6874 6d6c 5f77 6974 685f 6369 7461   'html_with_cita
-00004d30: 7469 6f6e 7327 3a27 7374 7269 6e67 272c  tions':'string',
-00004d40: 0020 2020 2020 2020 2027 6874 6d6c 5f61  .        'html_a
-00004d50: 6e6f 6e5f 3230 3230 273a 2773 7472 696e  non_2020':'strin
-00004d60: 6727 2c00 2020 2020 2020 2020 2768 746d  g',.        'htm
-00004d70: 6c5f 636f 6c75 6d62 6961 273a 2773 7472  l_columbia':'str
-00004d80: 696e 6727 2c00 2020 2020 2020 2020 2768  ing',.        'h
-00004d90: 746d 6c5f 6c61 7762 6f78 273a 2773 7472  tml_lawbox':'str
-00004da0: 696e 6727 2c00 2020 2020 2020 2020 2768  ing',.        'h
-00004db0: 746d 6c27 3a27 7374 7269 6e67 272c 0020  tml':'string',. 
-00004dc0: 2020 2020 2020 2027 706c 6169 6e5f 7465         'plain_te
-00004dd0: 7874 273a 2773 7472 696e 6727 2c00 2020  xt':'string',.  
-00004de0: 2020 2020 2020 276c 6f63 616c 5f70 6174        'local_pat
-00004df0: 6827 3a27 7374 7269 6e67 272c 0020 2020  h':'string',.   
-00004e00: 2020 2020 2027 646f 776e 6c6f 6164 5f75       'download_u
-00004e10: 726c 273a 2027 7374 7269 6e67 272c 0020  rl': 'string',. 
-00004e20: 2020 2020 206f 7069 6e69 6f6e 5f64 7479       opinion_dty
-00004e30: 7065 7320 3d20 7b00 2020 6465 6620 696e  pes = {.  def in
-00004e40: 6974 5f6f 7069 6e69 6f6e 735f 6466 2873  it_opinions_df(s
-00004e50: 656c 662c 2066 6e3d 4e6f 6e65 293a 0020  elf, fn=None):. 
-00004e60: 2023 2069 6e69 7469 616c 697a 6520 6f70   # initialize op
-00004e70: 696e 696f 6e73 2064 6600 0020 2020 2072  inions df..    r
-00004e80: 6574 7572 6e20 7365 6c66 2e63 7376 5f74  eturn self.csv_t
-00004e90: 6f5f 6466 2866 6e20 6f72 2073 656c 662e  o_df(fn or self.
-00004ea0: 5f63 6f75 7274 735f 666e 2c20 7573 6563  _courts_fn, usec
-00004eb0: 6f6c 733d 7573 6563 6f6c 732c 2069 6e64  ols=usecols, ind
-00004ec0: 6578 5f63 6f6c 3d27 6964 2729 2e73 6f72  ex_col='id').sor
-00004ed0: 745f 696e 6465 7828 2900 2020 2020 7573  t_index().    us
-00004ee0: 6563 6f6c 7320 3d20 5b27 6964 272c 2766  ecols = ['id','f
-00004ef0: 756c 6c5f 6e61 6d65 272c 276a 7572 6973  ull_name','juris
-00004f00: 6469 6374 696f 6e27 5d00 2020 6465 6620  diction'].  def 
-00004f10: 696e 6974 5f63 6f75 7274 735f 6466 2873  init_courts_df(s
-00004f20: 656c 662c 2066 6e3d 4e6f 6e65 293a 0020  elf, fn=None):. 
-00004f30: 2023 2069 6e69 7469 616c 697a 6520 636f   # initialize co
-00004f40: 7572 7473 2064 6600 0020 2020 207d 0020  urts df..    }. 
-00004f50: 2020 2020 2020 2027 6369 7465 645f 6279         'cited_by
-00004f60: 273a 6369 7465 645f 6279 0020 2020 2020  ':cited_by.     
-00004f70: 2020 2027 6369 7465 735f 746f 273a 6369     'cites_to':ci
-00004f80: 7465 735f 746f 2c00 2020 2020 7265 7475  tes_to,.    retu
-00004f90: 726e 207b 0020 2020 2063 6974 6564 5f62  rn {.    cited_b
-00004fa0: 7920 3d20 6466 5f63 6974 6174 696f 6e73  y = df_citations
+000039a0: 3027 3a27 7374 7269 6e67 272c 0020 2020  0':'string',.   
+000039b0: 2020 2020 2027 6874 6d6c 5f63 6f6c 756d       'html_colum
+000039c0: 6269 6127 3a27 7374 7269 6e67 272c 0020  bia':'string',. 
+000039d0: 2020 2020 2020 2027 6874 6d6c 5f6c 6177         'html_law
+000039e0: 626f 7827 3a27 7374 7269 6e67 272c 0020  box':'string',. 
+000039f0: 2020 2020 2020 2027 6874 6d6c 273a 2773         'html':'s
+00003a00: 7472 696e 6727 2c00 2020 2020 2020 2020  tring',.        
+00003a10: 2770 6c61 696e 5f74 6578 7427 3a27 7374  'plain_text':'st
+00003a20: 7269 6e67 272c 0020 2020 2020 2020 2027  ring',.        '
+00003a30: 6c6f 6361 6c5f 7061 7468 273a 2773 7472  local_path':'str
+00003a40: 696e 6727 2c00 2020 2020 2020 2020 2764  ing',.        'd
+00003a50: 6f77 6e6c 6f61 645f 7572 6c27 3a20 2773  ownload_url': 's
+00003a60: 7472 696e 6727 2c00 2020 2020 6f70 696e  tring',.    opin
+00003a70: 696f 6e5f 6474 7970 6573 203d 207b 0020  ion_dtypes = {. 
+00003a80: 2020 206d 6178 5f72 6f77 7320 3d20 3530     max_rows = 50
+00003a90: 0020 2020 2073 7461 7274 203d 2074 696d  .    start = tim
+00003aa0: 652e 7065 7266 5f63 6f75 6e74 6572 2829  e.perf_counter()
+00003ab0: 0020 2064 6566 2073 7461 7274 2873 656c  .  def start(sel
+00003ac0: 6629 3a00 2020 2020 0020 2020 2023 7265  f):.    .    #re
+00003ad0: 7475 726e 2063 6c69 656e 742e 6761 7468  turn client.gath
+00003ae0: 6572 2866 7574 7572 6573 2900 2020 2020  er(futures).    
+00003af0: 2020 6675 7475 7265 732e 6170 7065 6e64    futures.append
+00003b00: 2866 7574 7572 6529 0020 2020 2020 2066  (future).      f
+00003b10: 7574 7572 6520 3d20 636c 6965 6e74 2e73  uture = client.s
+00003b20: 7562 6d69 7428 7365 6c66 2e70 726f 6365  ubmit(self.proce
+00003b30: 7373 5f72 6f77 2c20 726f 7729 0020 2020  ss_row, row).   
+00003b40: 2020 2073 656c 662e 7072 6f63 6573 735f     self.process_
+00003b50: 726f 7728 726f 7729 0020 2020 2066 6f72  row(row).    for
+00003b60: 2069 6e64 6578 2c20 726f 7720 696e 2064   index, row in d
+00003b70: 662e 6974 6572 726f 7773 2829 3a00 2020  f.iterrows():.  
+00003b80: 2020 6675 7475 7265 7320 3d20 5b5d 0020    futures = []. 
+00003b90: 2064 6566 2070 726f 6365 7373 5f64 6628   def process_df(
+00003ba0: 7365 6c66 2c20 6466 2c20 636c 6965 6e74  self, df, client
+00003bb0: 293a 0000 2020 2020 2020 2020 2020 2920  ):..          ) 
+00003bc0: 2000 2020 2020 2020 2020 2020 2020 6178   .            ax
+00003bd0: 6973 3d31 2c00 2020 2020 2020 2020 2020  is=1,.          
+00003be0: 2020 6c61 6d62 6461 2072 6f77 3a20 7072    lambda row: pr
+00003bf0: 696e 7428 6627 7b73 656c 662e 7072 6f63  int(f'{self.proc
+00003c00: 6573 735f 726f 7728 726f 7729 7d5c 6e27  ess_row(row)}\n'
+00003c10: 292c 0020 2020 2020 2020 2020 205d 5d2e  ),.          ]].
+00003c20: 6170 706c 7928 0020 2020 2020 2020 2020  apply(.         
+00003c30: 2020 2027 6874 6d6c 5f61 6e6f 6e5f 3230     'html_anon_20
+00003c40: 3230 2700 2020 2020 2020 2020 2020 2020  20'.            
+00003c50: 2768 746d 6c5f 636f 6c75 6d62 6961 272c  'html_columbia',
+00003c60: 0020 2020 2020 2020 2020 2020 2027 6874  .            'ht
+00003c70: 6d6c 5f6c 6177 626f 7827 2c00 2020 2020  ml_lawbox',.    
+00003c80: 2020 2020 2020 2020 2768 746d 6c27 2c00          'html',.
+00003c90: 2020 2020 2020 2020 2020 2020 2770 6c61              'pla
+00003ca0: 696e 5f74 6578 7427 2c00 2020 2020 2020  in_text',.      
+00003cb0: 2020 2020 2020 2778 6d6c 5f68 6172 7661        'xml_harva
+00003cc0: 7264 272c 0020 2020 2020 2020 2020 2020  rd',.           
+00003cd0: 2027 636c 7573 7465 725f 6964 272c 0020   'cluster_id',. 
+00003ce0: 2020 2020 2020 2020 2020 2027 646f 776e             'down
+00003cf0: 6c6f 6164 5f75 726c 272c 0020 2020 2020  load_url',.     
+00003d00: 2020 2020 2020 2027 6c6f 6361 6c5f 7061         'local_pa
+00003d10: 7468 272c 0020 2020 2020 2020 2020 2020  th',.           
+00003d20: 2027 6964 272c 0020 2020 2064 665b 5b00   'id',.    df[[.
+00003d30: 2020 6465 6620 5f74 6178 6f6e 6966 7928    def _taxonify(
+00003d40: 7365 6c66 2c20 6466 293a 0000 2020 2020  self, df):..    
+00003d50: 7265 7475 726e 206f 626a 0020 2020 207d  return obj.    }
+00003d60: 0020 2020 2020 2020 207d 0020 2020 2020  .        }.     
+00003d70: 2020 2020 2020 207d 0020 2020 2020 2020         }.       
+00003d80: 2020 2020 2020 2020 2027 6175 7468 6f72           'author
+00003d90: 273a 2027 272c 2027 7479 7065 273a 2027  ': '', 'type': '
+00003da0: 277d 5d00 2020 2020 2020 2020 2020 2020  '}].            
+00003db0: 2020 2020 2774 6578 7427 3a20 7365 6c66      'text': self
+00003dc0: 2e67 6574 5f6f 7069 6e69 6f6e 5f74 6578  .get_opinion_tex
+00003dd0: 7428 6f70 696e 696f 6e29 2c20 0020 2020  t(opinion), .   
+00003de0: 2020 2020 2020 2020 2027 6f70 696e 696f           'opinio
+00003df0: 6e73 273a 205b 7b00 2020 2020 2020 2020  ns': [{.        
+00003e00: 2020 2020 2768 6561 645f 6d61 7474 6572      'head_matter
+00003e10: 273a 2727 2c20 2341 736b 2043 4c20 6162  ':'', #Ask CL ab
+00003e20: 6f75 7420 636f 7079 7269 6768 742c 0020  out copyright,. 
+00003e30: 2020 2020 2020 2020 2020 2027 6a75 6467             'judg
+00003e40: 6573 273a 206a 7564 6765 5f6c 6973 742c  es': judge_list,
+00003e50: 0020 2020 2020 2020 2027 6361 7365 626f  .        'casebo
+00003e60: 6479 2720 3a20 7b27 6461 7461 273a 207b  dy' : {'data': {
+00003e70: 0020 2020 2020 2020 2027 6a75 7269 7364  .        'jurisd
+00003e80: 6963 7469 6f6e 2720 3a20 7b27 6e61 6d65  iction' : {'name
+00003e90: 273a 2063 6f75 7274 5f72 6f77 2e6a 7572  ': court_row.jur
+00003ea0: 6973 6469 6374 696f 6e2e 696c 6f63 5b30  isdiction.iloc[0
+00003eb0: 5d7d 2c00 2020 2020 2020 2020 2763 6f75  ]},.        'cou
+00003ec0: 7274 2720 3a20 7b27 6e61 6d65 273a 2063  rt' : {'name': c
+00003ed0: 6f75 7274 5f72 6f77 2e66 756c 6c5f 6e61  ourt_row.full_na
+00003ee0: 6d65 2e69 6c6f 635b 305d 7d2c 0020 2020  me.iloc[0]},.   
+00003ef0: 2020 2020 2027 6369 7465 735f 746f 2720       'cites_to' 
+00003f00: 3a20 6369 7465 735f 746f 2c00 2020 2020  : cites_to,.    
+00003f10: 2020 2020 2763 6974 6174 696f 6e73 2720      'citations' 
+00003f20: 3a20 6369 7465 645f 6279 2c00 2020 2020  : cited_by,.    
+00003f30: 2020 2020 2764 6f63 6b65 745f 6e75 6d62      'docket_numb
+00003f40: 6572 2720 3a20 636c 7573 7465 725f 726f  er' : cluster_ro
+00003f50: 772e 646f 636b 6574 5f69 642e 696c 6f63  w.docket_id.iloc
+00003f60: 5b30 5d2c 0020 2020 2020 2020 2027 6465  [0],.        'de
+00003f70: 6369 7369 6f6e 5f64 6174 6527 3a20 6461  cision_date': da
+00003f80: 7465 5f74 6572 6d69 6e61 7465 642c 0020  te_terminated,. 
+00003f90: 2020 2020 2020 2027 6e61 6d65 2720 3a20         'name' : 
+00003fa0: 636c 7573 7465 725f 726f 772e 6361 7365  cluster_row.case
+00003fb0: 5f6e 616d 655f 6675 6c6c 2e69 6c6f 635b  _name_full.iloc[
+00003fc0: 305d 2c00 2020 2020 2020 2020 276e 616d  0],.        'nam
+00003fd0: 655f 6162 6272 6576 6961 7469 6f6e 273a  e_abbreviation':
+00003fe0: 2063 6c75 7374 6572 5f72 6f77 2e63 6173   cluster_row.cas
+00003ff0: 655f 6e61 6d65 2e69 6c6f 635b 305d 2c00  e_name.iloc[0],.
+00004000: 6164 0000 5609 0000 260a 0000 0010 0000  ad..V...&.......
+00004010: 2d00 0000 0000 0000 950f 0000 2a0f 0000  -...........*...
+00004020: 1d0f 0000 000f 0000 e40e 0000 de0e 0000  ................
+00004030: dd0e 0000 c40e 0000 9f0e 0000 6f0e 0000  ............o...
+00004040: 600e 0000 440e 0000 250e 0000 1f0e 0000  `...D...%.......
+00004050: cf0d 0000 ce0d 0000 b30d 0000 8c0d 0000  ................
+00004060: 730d 0000 510d 0000 320d 0000 130d 0000  s...Q...2.......
+00004070: fa0c 0000 da0c 0000 b80c 0000 950c 0000  ................
+00004080: 6d0c 0000 4f0c 0000 460c 0000 450c 0000  m...O...F...E...
+00004090: ea0b 0000 e90b 0000 c60b 0000 970b 0000  ................
+000040a0: 4a0b 0000 390b 0000 1e0b 0000 000b 0000  J...9...........
+000040b0: de0a 0000 d60a 0000 7a0a 0000 790a 0000  ........z...y...
+000040c0: 5f0a 0000 390a 0000 260a 0000 250a 0000  _...9...&...%...
+000040d0: 020a 0000 010a 0000 9109 0000 6609 0000  ............f...
+000040e0: 6509 0000 4609 0000 1f09 0000 ea08 0000  e...F...........
+000040f0: e908 0000 dc08 0000 c108 0000 a408 0000  ................
+00004100: a308 0000 8608 0000 6708 0000 6408 0000  ........g...d...
+00004110: 4808 0000 2a08 0000 2908 0000 0408 0000  H...*...).......
+00004120: dd07 0000 dc07 0000 bf07 0000 b407 0000  ................
+00004130: ad07 0000 a107 0000 7707 0000 5307 0000  ........w...S...
+00004140: 3107 0000 0a07 0000 eb06 0000 c406 0000  1...............
+00004150: c306 0000 a306 0000 a206 0000 4e06 0000  ............N...
+00004160: e505 0000 e405 0000 9d05 0000 6f05 0000  ............o...
+00004170: 3005 0000 2f05 0000 1005 0000 eb04 0000  0.../...........
+00004180: db04 0000 b104 0000 7504 0000 5d04 0000  ........u...]...
+00004190: 4e04 0000 4d04 0000 3104 0000 f303 0000  N...M...1.......
+000041a0: ca03 0000 a103 0000 a003 0000 9403 0000  ................
+000041b0: 7403 0000 6103 0000 5303 0000 3e03 0000  t...a...S...>...
+000041c0: f502 0000 ca02 0000 c402 0000 bb02 0000  ................
+000041d0: 7802 0000 3b02 0000 3a02 0000 2e02 0000  x...;...:.......
+000041e0: 1402 0000 ec01 0000 0000 0000 2020 2020  ............    
+000041f0: 2020 2020 2775 726c 273a 206f 7069 6e69      'url': opini
+00004200: 6f6e 5b27 646f 776e 6c6f 6164 5f75 726c  on['download_url
+00004210: 275d 2c00 2020 2020 2020 2020 2769 6427  '],.        'id'
+00004220: 3a20 636c 7573 7465 725f 6964 2c00 2020  : cluster_id,.  
+00004230: 2020 6f62 6a20 3d20 7b00 0020 2020 2064    obj = {..    d
+00004240: 6174 655f 7465 726d 696e 6174 6564 203d  ate_terminated =
+00004250: 206c 6973 7428 646f 636b 6574 5f72 6f77   list(docket_row
+00004260: 5b27 6461 7465 5f74 6572 6d69 6e61 7465  ['date_terminate
+00004270: 6427 5d29 5b30 5d00 2020 2020 2320 736f  d'])[0].    # so
+00004280: 6d65 7469 6d65 7320 6461 7465 5f74 6572  metimes date_ter
+00004290: 6d69 6e61 7465 6420 6d61 7920 6265 206d  minated may be m
+000042a0: 6973 7369 6e67 2061 6e64 2072 6563 6f72  issing and recor
+000042b0: 6465 6420 6173 204e 614e 0020 2020 2020  ded as NaN.     
+000042c0: 2020 2000 2020 2020 5d00 2020 2020 2020     .    ].      
+000042d0: 2020 6966 206e 6f74 2072 652e 6d61 7463    if not re.matc
+000042e0: 6828 275b 636a 5d3f 6a5c 2e27 2c20 6a75  h('[cj]?j\.', ju
+000042f0: 6467 6529 0020 2020 2020 2020 2020 2020  dge).           
+00004300: 2028 6a75 6467 6573 2e69 6c6f 635b 305d   (judges.iloc[0]
+00004310: 2e73 706c 6974 2827 2c27 2920 6966 206a  .split(',') if j
+00004320: 7564 6765 732e 6e6f 746e 6128 292e 626f  udges.notna().bo
+00004330: 6f6c 2829 2065 6c73 6520 5b5d 2900 2020  ol() else []).  
+00004340: 2020 2020 2020 666f 7220 6a75 6467 6520        for judge 
+00004350: 696e 0020 2020 2020 2020 206a 7564 6765  in.        judge
+00004360: 0020 2020 206a 7564 6765 5f6c 6973 7420  .    judge_list 
+00004370: 3d20 5b00 2020 2020 6a75 6467 6573 203d  = [.    judges =
+00004380: 2063 6c75 7374 6572 5f72 6f77 2e6a 7564   cluster_row.jud
+00004390: 6765 7300 2020 2020 236a 7564 6765 7300  ges.    #judges.
+000043a0: 0020 2020 2063 6974 6564 5f62 7920 3d20  .    cited_by = 
+000043b0: 6369 7461 7469 6f6e 5f69 6e66 6f5b 2763  citation_info['c
+000043c0: 6974 6564 5f62 7927 5d00 2020 2020 6369  ited_by'].    ci
+000043d0: 7465 735f 746f 203d 2063 6974 6174 696f  tes_to = citatio
+000043e0: 6e5f 696e 666f 5b27 6369 7465 735f 746f  n_info['cites_to
+000043f0: 275d 0020 2020 2063 6974 6174 696f 6e5f  '].    citation_
+00004400: 696e 666f 203d 2073 656c 662e 6765 745f  info = self.get_
+00004410: 6369 7461 7469 6f6e 7328 6f70 696e 696f  citations(opinio
+00004420: 6e5f 6964 2c20 6369 7461 7469 6f6e 7329  n_id, citations)
+00004430: 0020 2020 2023 2067 6574 206f 7069 6e69  .    # get opini
+00004440: 6f6e 7320 6369 7465 6420 746f 0000 2020  ons cited to..  
+00004450: 2020 2020 2020 7265 7475 726e 0020 2020        return.   
+00004460: 2069 6620 636f 7572 745f 726f 772e 656d   if court_row.em
+00004470: 7074 793a 0020 2020 2063 6f75 7274 5f72  pty:.    court_r
+00004480: 6f77 3a20 7365 6c66 2e44 6174 6146 7261  ow: self.DataFra
+00004490: 6d65 203d 2063 6f75 7274 735b 636f 7572  me = courts[cour
+000044a0: 7473 5b27 6964 275d 203d 3d20 6369 645d  ts['id'] == cid]
+000044b0: 0020 2020 2063 6964 203d 206c 6973 7428  .    cid = list(
+000044c0: 646f 636b 6574 5f72 6f77 5b27 636f 7572  docket_row['cour
+000044d0: 745f 6964 275d 295b 305d 0020 2020 2020  t_id'])[0].     
+000044e0: 2020 2072 6574 7572 6e20 0020 2020 2069     return .    i
+000044f0: 6620 6c65 6e28 646f 636b 6574 5f72 6f77  f len(docket_row
+00004500: 2e63 6f6c 756d 6e73 2920 3d3d 2030 3a00  .columns) == 0:.
+00004510: 2020 2020 2320 7265 7475 726e 2065 6172      # return ear
+00004520: 6c79 2069 6620 7468 6572 6527 7320 0000  ly if there's ..
+00004530: 2020 2020 646f 636b 6574 5f72 6f77 203d      docket_row =
+00004540: 2064 6f63 6b65 7473 5b64 6f63 6b65 7473   dockets[dockets
+00004550: 5b27 6964 275d 203d 3d20 646f 636b 6574  ['id'] == docket
+00004560: 5f69 645d 2e63 6f6d 7075 7465 2829 0020  _id].compute(). 
+00004570: 2020 2064 6f63 6b65 745f 6964 203d 2069     docket_id = i
+00004580: 6e74 2863 6c75 7374 6572 5f72 6f77 5b27  nt(cluster_row['
+00004590: 646f 636b 6574 5f69 6427 5d29 0020 2020  docket_id']).   
+000045a0: 2023 2067 6574 2063 6f72 7265 7370 6f6e   # get correspon
+000045b0: 6469 6e67 2072 6f77 2066 726f 6d20 646f  ding row from do
+000045c0: 636b 6574 2064 6620 6261 7365 6420 6f6e  cket df based on
+000045d0: 2063 6c75 7374 6572 206f 7069 6e69 6f6e   cluster opinion
+000045e0: 2069 6400 0020 2020 2063 6c75 7374 6572   id..    cluster
+000045f0: 5f72 6f77 3a20 7365 6c66 2e44 6174 6146  _row: self.DataF
+00004600: 7261 6d65 203d 2073 656c 662e 6466 5f72  rame = self.df_r
+00004610: 6f77 5f62 795f 7661 6c75 6528 7365 6c66  ow_by_value(self
+00004620: 2e67 6574 5f6f 7069 6e69 6f6e 735f 636c  .get_opinions_cl
+00004630: 7573 7465 725f 6466 2829 2c20 2769 6427  uster_df(), 'id'
+00004640: 2c20 636c 7573 7465 725f 6964 2900 2020  , cluster_id).  
+00004650: 2020 2320 6765 7420 6561 6368 2063 6f72    # get each cor
+00004660: 7265 7370 6f6e 6469 6e67 2072 6f77 2066  responding row f
+00004670: 726f 6d20 636c 7573 7465 7273 2c20 646f  rom clusters, do
+00004680: 636b 6574 732c 2063 6f75 7274 7320 6261  ckets, courts ba
+00004690: 7365 6420 6f6e 206f 7069 6e69 6f6e 2069  sed on opinion i
+000046a0: 6400 0020 2020 2069 6d70 6f72 7420 7064  d..    import pd
+000046b0: 623b 2070 6462 2e73 6574 5f74 7261 6365  b; pdb.set_trace
+000046c0: 2829 0000 2020 2020 636c 7573 7465 725f  ()..    cluster_
+000046d0: 6964 203d 206f 7069 6e69 6f6e 5b27 636c  id = opinion['cl
+000046e0: 7573 7465 725f 6964 275d 0020 2020 206f  uster_id'].    o
+000046f0: 7069 6e69 6f6e 5f69 6420 3d20 6f70 696e  pinion_id = opin
+00004700: 696f 6e5b 2769 6427 5d00 2020 2020 6369  ion['id'].    ci
+00004710: 7461 7469 6f6e 7320 3d20 7365 6c66 2e67  tations = self.g
+00004720: 6574 5f63 6974 6174 696f 6e5f 6466 2829  et_citation_df()
+00004730: 0020 2020 2063 6f75 7274 7320 3d20 7365  .    courts = se
+00004740: 6c66 2e67 6574 5f63 6f75 7274 735f 6466  lf.get_courts_df
+00004750: 2829 0020 2020 2064 6f63 6b65 7473 203d  ().    dockets =
+00004760: 2073 656c 662e 6765 745f 646f 636b 6574   self.get_docket
+00004770: 735f 6466 2829 0020 2064 6566 2070 726f  s_df().  def pro
+00004780: 6365 7373 5f72 6f77 2873 656c 662c 206f  cess_row(self, o
+00004790: 7069 6e69 6f6e 2920 2d3e 2064 6963 743a  pinion) -> dict:
+000047a0: 0020 2023 2070 726f 6365 7373 0020 2020  .  # process.   
+000047b0: 2020 2000 2020 2020 2020 7061 7373 0020     .      pass. 
+000047c0: 2064 6566 2067 6574 5f6f 7069 6e69 6f6e   def get_opinion
+000047d0: 735f 6466 2873 656c 6629 3a00 0020 2020  s_df(self):..   
+000047e0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+000047f0: 6466 5f6f 7069 6e69 6f6e 5f63 6c75 7374  df_opinion_clust
+00004800: 6572 7300 2020 6465 6620 6765 745f 6f70  ers.  def get_op
+00004810: 696e 696f 6e73 5f63 6c75 7374 6572 5f64  inions_cluster_d
+00004820: 6628 7365 6c66 293a 0000 2020 2020 2020  f(self):..      
+00004830: 7265 7475 726e 2073 656c 662e 5f64 665f  return self._df_
+00004840: 646f 636b 6574 7300 2020 6465 6620 6765  dockets.  def ge
+00004850: 745f 646f 636b 6574 735f 6466 2873 656c  t_dockets_df(sel
+00004860: 6629 3a00 2020 0020 2020 2020 2072 6574  f):.  .      ret
+00004870: 7572 6e20 7365 6c66 2e5f 6466 5f63 6974  urn self._df_cit
+00004880: 6174 696f 6e00 2020 6465 6620 6765 745f  ation.  def get_
+00004890: 6369 7461 7469 6f6e 5f64 6628 7365 6c66  citation_df(self
+000048a0: 293a 0000 2020 2020 2020 7265 7475 726e  ):..      return
+000048b0: 2073 656c 662e 5f64 665f 636f 7572 7473   self._df_courts
+000048c0: 0020 2064 6566 2067 6574 5f63 6f75 7274  .  def get_court
+000048d0: 735f 6466 2873 656c 6629 3a00 2020 2323  s_df(self):.  ##
+000048e0: 2047 6574 7465 7273 0000 2020 2020 2020   Getters..      
+000048f0: 7265 7475 726e 2073 656c 662e 6373 765f  return self.csv_
+00004900: 746f 5f64 6628 666e 206f 7220 7365 6c66  to_df(fn or self
+00004910: 2e5f 6369 7461 7469 6f6e 5f66 6e29 0020  ._citation_fn). 
+00004920: 2064 6566 2069 6e69 745f 6369 7461 7469   def init_citati
+00004930: 6f6e 5f64 6628 7365 6c66 2c20 666e 3d4e  on_df(self, fn=N
+00004940: 6f6e 6529 3a00 2020 2320 696e 6974 6961  one):.  # initia
+00004950: 6c69 7a65 2063 6974 6174 696f 6e20 6d61  lize citation ma
+00004960: 7020 6466 0000 2020 2020 2020 2020 2020  p df..          
+00004970: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00004980: 6c6f 636b 7369 7a65 3d22 3332 4d42 2229  locksize="32MB")
+00004990: 0020 2020 2020 2072 6574 7572 6e20 6464  .      return dd
+000049a0: 2e72 6561 645f 6373 7628 666e 206f 7220  .read_csv(fn or 
+000049b0: 7365 6c66 2e5f 646f 636b 6574 735f 666e  self._dockets_fn
+000049c0: 2c20 6474 7970 653d 6d79 5f74 7970 6573  , dtype=my_types
+000049d0: 2c20 7573 6563 6f6c 733d 5b27 636f 7572  , usecols=['cour
+000049e0: 745f 6964 272c 2027 6964 272c 2027 6461  t_id', 'id', 'da
+000049f0: 7465 5f74 6572 6d69 6e61 7465 6427 5d2c  te_terminated'],
+00004a00: 0000 2020 2020 2020 7d20 0020 2020 2020  ..      } .     
+00004a10: 2027 636f 7572 745f 6964 273a 2027 7374   'court_id': 'st
+00004a20: 7269 6e67 2700 2020 2020 2020 6d79 5f74  ring'.      my_t
+00004a30: 7970 6573 203d 207b 0020 2064 6566 2069  ypes = {.  def i
+00004a40: 6e69 745f 646f 636b 6574 735f 6466 2873  nit_dockets_df(s
+00004a50: 656c 662c 2066 6e3d 4e6f 6e65 293a 0020  elf, fn=None):. 
+00004a60: 2023 2069 6e69 7469 616c 697a 6520 646f   # initialize do
+00004a70: 636b 6574 7320 6466 0000 2020 2020 2020  ckets df..      
+00004a80: 7265 7475 726e 2073 656c 662e 6373 765f  return self.csv_
+00004a90: 746f 5f64 6628 666e 206f 7220 7365 6c66  to_df(fn or self
+00004aa0: 2e5f 6f70 696e 696f 6e5f 636c 7573 7465  ._opinion_cluste
+00004ab0: 7273 5f66 6e2c 2064 7479 7065 3d64 7479  rs_fn, dtype=dty
+00004ac0: 7065 732c 2075 7365 636f 6c73 3d75 7365  pes, usecols=use
+00004ad0: 636f 6c73 2900 2020 2020 2020 7d00 2020  cols).      }.  
+00004ae0: 2020 2020 2020 2763 6173 655f 6e61 6d65        'case_name
+00004af0: 5f66 756c 6c27 3a27 7374 7269 6e67 2700  _full':'string'.
+00004b00: 2020 2020 2020 2020 2763 6173 655f 6e61          'case_na
+00004b10: 6d65 273a 2773 7472 696e 6727 2c00 2020  me':'string',.  
+00004b20: 2020 2020 2020 276a 7564 6765 7327 3a27        'judges':'
+00004b30: 7374 7269 6e67 272c 0020 2020 2020 2064  string',.      d
+00004b40: 7479 7065 7320 3d20 7b00 2020 2020 2020  types = {.      
+00004b50: 7573 6563 6f6c 7320 3d20 5b27 6964 272c  usecols = ['id',
+00004b60: 2027 6a75 6467 6573 272c 2027 646f 636b   'judges', 'dock
+00004b70: 6574 5f69 6427 2c20 2763 6173 655f 6e61  et_id', 'case_na
+00004b80: 6d65 272c 2027 6361 7365 5f6e 616d 655f  me', 'case_name_
+00004b90: 6675 6c6c 275d 0020 2064 6566 2069 6e69  full'].  def ini
+00004ba0: 745f 6f70 696e 696f 6e5f 636c 7573 7465  t_opinion_cluste
+00004bb0: 7273 5f64 6628 7365 6c66 2c20 666e 3d4e  rs_df(self, fn=N
+00004bc0: 6f6e 6529 3a00 2020 2320 696e 6974 6961  one):.  # initia
+00004bd0: 6c69 7a65 206f 7069 6e69 6f6e 2063 6c75  lize opinion clu
+00004be0: 7374 6572 7320 6466 0000 2020 2020 2020  sters df..      
+00004bf0: 7265 7475 726e 2073 656c 662e 6373 765f  return self.csv_
+00004c00: 746f 5f64 6628 666e 206f 7220 7365 6c66  to_df(fn or self
+00004c10: 2e5f 6f70 696e 696f 6e73 5f66 6e2c 2064  ._opinions_fn, d
+00004c20: 7479 7065 3d6f 7069 6e69 6f6e 5f64 7479  type=opinion_dty
+00004c30: 7065 732c 2069 6e64 6578 5f63 6f6c 3d27  pes, index_col='
+00004c40: 6964 2729 0000 2020 2020 2020 7d20 0020  id')..      } . 
+00004c50: 2020 2020 2020 2027 6c6f 6361 6c5f 7061         'local_pa
+00004c60: 7468 273a 2773 7472 696e 6727 0020 2020  th':'string'.   
+00004c70: 2020 2020 2027 6874 6d6c 5f77 6974 685f       'html_with_
+00004c80: 6369 7461 7469 6f6e 7327 3a27 7374 7269  citations':'stri
+00004c90: 6e67 272c 0020 2020 2020 2020 2027 6874  ng',.        'ht
+00004ca0: 6d6c 5f61 6e6f 6e5f 3230 3230 273a 2773  ml_anon_2020':'s
+00004cb0: 7472 696e 6727 2c00 2020 2020 2020 2020  tring',.        
+00004cc0: 2768 746d 6c5f 636f 6c75 6d62 6961 273a  'html_columbia':
+00004cd0: 2773 7472 696e 6727 2c00 2020 2020 2020  'string',.      
+00004ce0: 2020 2768 746d 6c5f 6c61 7762 6f78 273a    'html_lawbox':
+00004cf0: 2773 7472 696e 6727 2c00 2020 2020 2020  'string',.      
+00004d00: 2020 2768 746d 6c27 3a27 7374 7269 6e67    'html':'string
+00004d10: 272c 0020 2020 2020 2020 2027 706c 6169  ',.        'plai
+00004d20: 6e5f 7465 7874 273a 2773 7472 696e 6727  n_text':'string'
+00004d30: 2c00 2020 2020 2020 2020 276c 6f63 616c  ,.        'local
+00004d40: 5f70 6174 6827 3a27 7374 7269 6e67 272c  _path':'string',
+00004d50: 0020 2020 2020 2020 2027 646f 776e 6c6f  .        'downlo
+00004d60: 6164 5f75 726c 273a 2027 7374 7269 6e67  ad_url': 'string
+00004d70: 272c 0020 2020 2020 206f 7069 6e69 6f6e  ',.      opinion
+00004d80: 5f64 7479 7065 7320 3d20 7b00 2020 6465  _dtypes = {.  de
+00004d90: 6620 696e 6974 5f6f 7069 6e69 6f6e 735f  f init_opinions_
+00004da0: 6466 2873 656c 662c 2066 6e3d 4e6f 6e65  df(self, fn=None
+00004db0: 293a 0020 2023 2069 6e69 7469 616c 697a  ):.  # initializ
+00004dc0: 6520 6f70 696e 696f 6e73 2064 6600 0020  e opinions df.. 
+00004dd0: 2020 2072 6574 7572 6e20 7365 6c66 2e63     return self.c
+00004de0: 7376 5f74 6f5f 6466 2866 6e20 6f72 2073  sv_to_df(fn or s
+00004df0: 656c 662e 5f63 6f75 7274 735f 666e 2c20  elf._courts_fn, 
+00004e00: 6474 7970 653d 6474 7970 6573 2c20 7573  dtype=dtypes, us
+00004e10: 6563 6f6c 733d 7573 6563 6f6c 7329 0020  ecols=usecols). 
+00004e20: 2020 207d 0020 2020 2020 2027 6a75 7269     }.      'juri
+00004e30: 7364 6963 7469 6f6e 273a 2027 7374 7269  sdiction': 'stri
+00004e40: 6e67 2700 2020 2020 2020 2766 756c 6c6e  ng'.      'fulln
+00004e50: 616d 6527 3a20 2773 7472 696e 6727 2c00  ame': 'string',.
+00004e60: 2020 2020 6474 7970 6573 203d 207b 0020      dtypes = {. 
+00004e70: 2020 2075 7365 636f 6c73 203d 205b 2769     usecols = ['i
+00004e80: 6427 2c27 6675 6c6c 5f6e 616d 6527 2c27  d','full_name','
+00004e90: 6a75 7269 7364 6963 7469 6f6e 275d 0020  jurisdiction']. 
+00004ea0: 2064 6566 2069 6e69 745f 636f 7572 7473   def init_courts
+00004eb0: 5f64 6628 7365 6c66 2c20 666e 3d4e 6f6e  _df(self, fn=Non
+00004ec0: 6529 3a00 2020 2320 696e 6974 6961 6c69  e):.  # initiali
+00004ed0: 7a65 2063 6f75 7274 7320 6466 0000 2020  ze courts df..  
+00004ee0: 2020 7d00 2020 2020 2020 2020 2763 6974    }.        'cit
+00004ef0: 6564 5f62 7927 3a63 6974 6564 5f62 7900  ed_by':cited_by.
+00004f00: 2020 2020 2020 2020 2763 6974 6573 5f74          'cites_t
+00004f10: 6f27 3a63 6974 6573 5f74 6f2c 0020 2020  o':cites_to,.   
+00004f20: 2072 6574 7572 6e20 7b00 2020 2020 6369   return {.    ci
+00004f30: 7465 645f 6279 203d 2064 665f 6369 7461  ted_by = df_cita
+00004f40: 7469 6f6e 735b 6466 5f63 6974 6174 696f  tions[df_citatio
+00004f50: 6e73 5b27 6369 7465 645f 6f70 696e 696f  ns['cited_opinio
+00004f60: 6e5f 6964 275d 203d 3d20 6f70 696e 696f  n_id'] == opinio
+00004f70: 6e5f 6964 5d5b 2763 6974 696e 675f 6f70  n_id]['citing_op
+00004f80: 696e 696f 6e5f 6964 275d 2e74 6f5f 6c69  inion_id'].to_li
+00004f90: 7374 2829 0020 2020 2063 6974 6573 5f74  st().    cites_t
+00004fa0: 6f20 3d20 6466 5f63 6974 6174 696f 6e73  o = df_citations
 00004fb0: 5b64 665f 6369 7461 7469 6f6e 735b 2763  [df_citations['c
-00004fc0: 6974 6564 5f6f 7069 6e69 6f6e 5f69 6427  ited_opinion_id'
-00004fd0: 5d20 3d3d 206f 7069 6e69 6f6e 5f69 645d  ] == opinion_id]
-00004fe0: 5b27 6369 7469 6e67 5f6f 7069 6e69 6f6e  ['citing_opinion
+00004fc0: 6974 696e 675f 6f70 696e 696f 6e5f 6964  iting_opinion_id
+00004fd0: 275d 203d 3d20 6f70 696e 696f 6e5f 6964  '] == opinion_id
+00004fe0: 5d5b 2763 6974 6564 5f6f 7069 6e69 6f6e  ]['cited_opinion
 00004ff0: 5f69 6427 5d2e 746f 5f6c 6973 7428 2900  _id'].to_list().
-00005000: 6164 0000 0d06 0000 3507 0000 0010 0000  ad......5.......
-00005010: 4300 0000 0000 0000 ff0f 0000 e00f 0000  C...............
-00005020: b90f 0000 670f 0000 660f 0000 590f 0000  ....g...f...Y...
-00005030: 3e0f 0000 210f 0000 200f 0000 030f 0000  >...!... .......
-00005040: e40e 0000 e10e 0000 c50e 0000 a70e 0000  ................
-00005050: a60e 0000 810e 0000 5a0e 0000 590e 0000  ........Z...Y...
-00005060: 3c0e 0000 310e 0000 2a0e 0000 1e0e 0000  <...1...*.......
-00005070: f80d 0000 d40d 0000 b20d 0000 8b0d 0000  ................
-00005080: 6c0d 0000 450d 0000 440d 0000 f00c 0000  l...E...D.......
-00005090: 870c 0000 860c 0000 3f0c 0000 110c 0000  ........?.......
-000050a0: cc0b 0000 cb0b 0000 ac0b 0000 930b 0000  ................
-000050b0: 830b 0000 2c0b 0000 140b 0000 050b 0000  ....,...........
-000050c0: 040b 0000 e80a 0000 aa0a 0000 810a 0000  ................
-000050d0: 580a 0000 570a 0000 4b0a 0000 2b0a 0000  X...W...K...+...
-000050e0: 220a 0000 160a 0000 fc09 0000 d409 0000  "...............
-000050f0: 9809 0000 6309 0000 2609 0000 ed08 0000  ....c...&.......
-00005100: cd08 0000 ae08 0000 7508 0000 3208 0000  ........u...2...
-00005110: 1208 0000 c007 0000 8907 0000 6e07 0000  ............n...
-00005120: 3507 0000 0000 0000 0000 0000 0000 0000  5...............
-00005130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005000: 6164 0000 9006 0000 c407 0000 0010 0000  ad..............
+00005010: 4600 0000 0000 0000 e40f 0000 c20f 0000  F...............
+00005020: b90f 0000 b80f 0000 480f 0000 1d0f 0000  ........H.......
+00005030: 1c0f 0000 fd0e 0000 d60e 0000 a10e 0000  ................
+00005040: a00e 0000 930e 0000 780e 0000 5b0e 0000  ........x...[...
+00005050: 5a0e 0000 3d0e 0000 1e0e 0000 1b0e 0000  Z...=...........
+00005060: ff0d 0000 e10d 0000 e00d 0000 bb0d 0000  ................
+00005070: 940d 0000 930d 0000 760d 0000 6b0d 0000  ........v...k...
+00005080: 640d 0000 580d 0000 2e0d 0000 0a0d 0000  d...X...........
+00005090: e80c 0000 c10c 0000 a20c 0000 7b0c 0000  ............{...
+000050a0: 7a0c 0000 260c 0000 bd0b 0000 bc0b 0000  z...&...........
+000050b0: 750b 0000 470b 0000 080b 0000 070b 0000  u...G...........
+000050c0: e80a 0000 c30a 0000 b30a 0000 890a 0000  ................
+000050d0: 4d0a 0000 350a 0000 260a 0000 250a 0000  M...5...&...%...
+000050e0: 090a 0000 cb09 0000 a209 0000 7909 0000  ............y...
+000050f0: 7809 0000 6c09 0000 4c09 0000 3909 0000  x...l...L...9...
+00005100: 2b09 0000 1609 0000 cd08 0000 a208 0000  +...............
+00005110: 9c08 0000 9308 0000 5008 0000 1308 0000  ........P.......
+00005120: 1208 0000 0608 0000 ec07 0000 c407 0000  ................
+00005130: c307 0000 a307 0000 0000 0000 0000 0000  ................
 00005140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000051a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -1389,404 +1389,148 @@
 000056c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000056d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000056e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000056f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00005720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00005730: 0000 0000 0020 2020 2020 2020 2020 2020  .....           
-00005740: 2020 2020 2027 7465 7874 273a 2073 656c       'text': sel
-00005750: 662e 6765 745f 6f70 696e 696f 6e5f 7465  f.get_opinion_te
-00005760: 7874 286f 7069 6e69 6f6e 292c 2000 2020  xt(opinion), .  
-00005770: 2020 2020 2020 2020 2020 276f 7069 6e69            'opini
-00005780: 6f6e 7327 3a20 5b7b 0020 2020 2020 2020  ons': [{.       
-00005790: 2020 2020 2027 6865 6164 5f6d 6174 7465       'head_matte
-000057a0: 7227 3a27 272c 2023 4173 6b20 434c 2061  r':'', #Ask CL a
-000057b0: 626f 7574 2063 6f70 7972 6967 6874 2c00  bout copyright,.
-000057c0: 2020 2020 2020 2020 2020 2020 276a 7564              'jud
-000057d0: 6765 7327 3a20 6a75 6467 6573 2e69 6c6f  ges': judges.ilo
-000057e0: 635b 305d 2e73 706c 6974 2827 2c27 2920  c[0].split(',') 
-000057f0: 6966 206a 7564 6765 732e 6e6f 746e 6128  if judges.notna(
-00005800: 292e 626f 6f6c 2829 2065 6c73 6520 5b5d  ).bool() else []
-00005810: 2c00 2020 2020 2020 2020 2763 6173 6562  ,.        'caseb
-00005820: 6f64 7927 203a 207b 2764 6174 6127 3a20  ody' : {'data': 
-00005830: 7b00 2020 2020 2020 2020 276a 7572 6973  {.        'juris
-00005840: 6469 6374 696f 6e27 203a 207b 276e 616d  diction' : {'nam
-00005850: 6527 3a20 636f 7572 745f 726f 772e 6a75  e': court_row.ju
-00005860: 7269 7364 6963 7469 6f6e 2e69 6c6f 635b  risdiction.iloc[
-00005870: 305d 7d2c 0020 2020 2020 2020 2027 636f  0]},.        'co
-00005880: 7572 7427 203a 207b 276e 616d 6527 3a20  urt' : {'name': 
-00005890: 636f 7572 745f 726f 772e 6675 6c6c 5f6e  court_row.full_n
-000058a0: 616d 652e 696c 6f63 5b30 5d7d 2c00 2020  ame.iloc[0]},.  
-000058b0: 2020 2020 2020 2763 6974 6573 5f74 6f27        'cites_to'
-000058c0: 203a 2063 6974 6573 5f74 6f2c 0020 2020   : cites_to,.   
-000058d0: 2020 2020 2027 6369 7461 7469 6f6e 7327       'citations'
-000058e0: 203a 2063 6974 6564 5f62 792c 0020 2020   : cited_by,.   
-000058f0: 2020 2020 2027 646f 636b 6574 5f6e 756d       'docket_num
-00005900: 6265 7227 203a 2063 6c75 7374 6572 5f72  ber' : cluster_r
-00005910: 6f77 2e64 6f63 6b65 745f 6964 2e69 6c6f  ow.docket_id.ilo
-00005920: 635b 305d 2c00 2020 2020 2020 2020 2764  c[0],.        'd
-00005930: 6563 6973 696f 6e5f 6461 7465 273a 2064  ecision_date': d
-00005940: 6f63 6b65 745f 726f 772e 6461 7465 5f74  ocket_row.date_t
-00005950: 6572 6d69 6e61 7465 642e 696c 6f63 5b30  erminated.iloc[0
-00005960: 5d2c 0020 2020 2020 2020 2027 6e61 6d65  ],.        'name
-00005970: 2720 3a20 636c 7573 7465 725f 726f 772e  ' : cluster_row.
-00005980: 6361 7365 5f6e 616d 655f 6675 6c6c 2e69  case_name_full.i
-00005990: 6c6f 635b 305d 2c00 2020 2020 2020 2020  loc[0],.        
-000059a0: 276e 616d 655f 6162 6272 6576 6961 7469  'name_abbreviati
-000059b0: 6f6e 273a 2063 6c75 7374 6572 5f72 6f77  on': cluster_row
-000059c0: 2e63 6173 655f 6e61 6d65 2e69 6c6f 635b  .case_name.iloc[
-000059d0: 305d 2c00 2020 2020 2020 2020 2775 726c  0],.        'url
-000059e0: 273a 206f 7069 6e69 6f6e 5b27 646f 776e  ': opinion['down
-000059f0: 6c6f 6164 5f75 726c 275d 2c00 2020 2020  load_url'],.    
-00005a00: 2020 2020 2769 6427 3a20 636c 7573 7465      'id': cluste
-00005a10: 725f 6964 2c00 2020 2020 6f62 6a20 3d20  r_id,.    obj = 
-00005a20: 7b00 2020 2020 2020 2020 0020 2020 206a  {.        .    j
-00005a30: 7564 6765 7320 3d20 636c 7573 7465 725f  udges = cluster_
-00005a40: 726f 772e 6a75 6467 6573 0020 2020 2023  row.judges.    #
-00005a50: 6a75 6467 6573 0000 2020 2020 6369 7465  judges..    cite
-00005a60: 645f 6279 203d 2063 6974 6174 696f 6e5f  d_by = citation_
-00005a70: 696e 666f 5b27 6369 7465 645f 6279 275d  info['cited_by']
-00005a80: 0020 2020 2063 6974 6573 5f74 6f20 3d20  .    cites_to = 
-00005a90: 6369 7461 7469 6f6e 5f69 6e66 6f5b 2763  citation_info['c
-00005aa0: 6974 6573 5f74 6f27 5d00 2020 2020 6369  ites_to'].    ci
-00005ab0: 7461 7469 6f6e 5f69 6e66 6f20 3d20 7365  tation_info = se
-00005ac0: 6c66 2e67 6574 5f63 6974 6174 696f 6e73  lf.get_citations
-00005ad0: 286f 7069 6e69 6f6e 5f69 642c 2063 6974  (opinion_id, cit
-00005ae0: 6174 696f 6e73 2900 2020 2020 2320 6765  ations).    # ge
-00005af0: 7420 6f70 696e 696f 6e73 2063 6974 6564  t opinions cited
-00005b00: 2074 6f00 0020 2020 2020 2020 2072 6574   to..        ret
-00005b10: 7572 6e00 2020 2020 6966 2063 6f75 7274  urn.    if court
-00005b20: 5f72 6f77 2e65 6d70 7479 3a00 2020 2020  _row.empty:.    
-00005b30: 636f 7572 745f 726f 773a 2073 656c 662e  court_row: self.
-00005b40: 4461 7461 4672 616d 6520 3d20 636f 7572  DataFrame = cour
-00005b50: 7473 5b63 6f75 7274 735b 2769 6427 5d20  ts[courts['id'] 
-00005b60: 3d3d 2064 6f63 6b65 745f 726f 775b 2763  == docket_row['c
-00005b70: 6f75 7274 5f69 6427 5d2e 696c 6f63 5b30  ourt_id'].iloc[0
-00005b80: 5d5d 0020 2020 2020 2020 2072 6574 7572  ]].        retur
-00005b90: 6e20 0020 2020 2069 6620 646f 636b 6574  n .    if docket
-00005ba0: 5f72 6f77 2e65 6d70 7479 3a00 2020 2020  _row.empty:.    
-00005bb0: 2320 7265 7475 726e 2065 6172 6c79 2069  # return early i
-00005bc0: 6620 7468 6572 6527 7320 0000 2020 2020  f there's ..    
-00005bd0: 646f 636b 6574 5f72 6f77 3a20 7365 6c66  docket_row: self
-00005be0: 2e44 6174 6146 7261 6d65 203d 2064 6f63  .DataFrame = doc
-00005bf0: 6b65 7473 5b64 6f63 6b65 7473 5b27 6964  kets[dockets['id
-00005c00: 275d 203d 3d20 646f 636b 6574 5f69 645d  '] == docket_id]
-00005c10: 0020 2020 2064 6f63 6b65 745f 6964 203d  .    docket_id =
-00005c20: 2069 6e74 2863 6c75 7374 6572 5f72 6f77   int(cluster_row
-00005c30: 5b27 646f 636b 6574 5f69 6427 5d29 0020  ['docket_id']). 
-00005c40: 2020 2023 2067 6574 2063 6f72 7265 7370     # get corresp
-00005c50: 6f6e 6469 6e67 2072 6f77 2066 726f 6d20  onding row from 
-00005c60: 646f 636b 6574 2064 6620 6261 7365 6420  docket df based 
-00005c70: 6f6e 2063 6c75 7374 6572 206f 7069 6e69  on cluster opini
-00005c80: 6f6e 2069 6400 0020 2020 2063 6c75 7374  on id..    clust
-00005c90: 6572 5f72 6f77 3a20 7365 6c66 2e44 6174  er_row: self.Dat
-00005ca0: 6146 7261 6d65 203d 2073 656c 662e 6466  aFrame = self.df
-00005cb0: 5f72 6f77 5f62 795f 7661 6c75 6528 7365  _row_by_value(se
-00005cc0: 6c66 2e67 6574 5f6f 7069 6e69 6f6e 735f  lf.get_opinions_
-00005cd0: 636c 7573 7465 725f 6466 2829 2c20 2769  cluster_df(), 'i
-00005ce0: 6427 2c20 636c 7573 7465 725f 6964 2900  d', cluster_id).
-00005cf0: 2020 2020 2320 6765 7420 6561 6368 2063      # get each c
-00005d00: 6f72 7265 7370 6f6e 6469 6e67 2072 6f77  orresponding row
-00005d10: 2066 726f 6d20 636c 7573 7465 7273 2c20   from clusters, 
-00005d20: 646f 636b 6574 732c 2063 6f75 7274 7320  dockets, courts 
-00005d30: 6261 7365 6420 6f6e 206f 7069 6e69 6f6e  based on opinion
-00005d40: 2069 6400 0020 2020 2063 6c75 7374 6572   id..    cluster
-00005d50: 5f69 6420 3d20 6f70 696e 696f 6e5b 2763  _id = opinion['c
-00005d60: 6c75 7374 6572 5f69 6427 5d00 2020 2020  luster_id'].    
-00005d70: 6f70 696e 696f 6e5f 6964 203d 206f 7069  opinion_id = opi
-00005d80: 6e69 6f6e 5b27 6964 275d 0020 2020 2063  nion['id'].    c
-00005d90: 6974 6174 696f 6e73 203d 2073 656c 662e  itations = self.
-00005da0: 6765 745f 6369 7461 7469 6f6e 5f64 6628  get_citation_df(
-00005db0: 2900 2020 2020 636f 7572 7473 203d 2073  ).    courts = s
-00005dc0: 656c 662e 6765 745f 636f 7572 7473 5f64  elf.get_courts_d
-00005dd0: 6628 2900 2020 2020 646f 636b 6574 7320  f().    dockets 
-00005de0: 3d20 7365 6c66 2e67 6574 5f64 6f63 6b65  = self.get_docke
-00005df0: 7473 5f64 6628 2900 2020 6465 6620 7072  ts_df().  def pr
-00005e00: 6f63 6573 7328 7365 6c66 2c20 6f70 696e  ocess(self, opin
-00005e10: 696f 6e29 202d 3e20 6469 6374 3a00 2020  ion) -> dict:.  
-00005e20: 2320 7072 6f63 6573 7300 2020 2020 2020  # process.      
-00005e30: 0020 2020 2020 2070 6173 7300 2020 6465  .      pass.  de
-00005e40: 6620 6765 745f 6f70 696e 696f 6e73 5f64  f get_opinions_d
-00005e50: 6628 7365 6c66 293a 0000 2020 2020 2020  f(self):..      
-00005e60: 7265 7475 726e 2073 656c 662e 5f64 665f  return self._df_
-00005e70: 6f70 696e 696f 6e5f 636c 7573 7465 7273  opinion_clusters
-00005e80: 0020 2064 6566 2067 6574 5f6f 7069 6e69  .  def get_opini
-00005e90: 6f6e 735f 636c 7573 7465 725f 6466 2873  ons_cluster_df(s
-00005ea0: 656c 6629 3a00 0020 2020 2020 2072 6574  elf):..      ret
-00005eb0: 7572 6e20 7365 6c66 2e5f 6466 5f64 6f63  urn self._df_doc
-00005ec0: 6b65 7473 0020 2064 6566 2067 6574 5f64  kets.  def get_d
-00005ed0: 6f63 6b65 7473 5f64 6628 7365 6c66 293a  ockets_df(self):
-00005ee0: 0020 2000 2020 2020 2020 7265 7475 726e  .  .      return
-00005ef0: 2073 656c 662e 5f64 665f 6369 7461 7469   self._df_citati
-00005f00: 6f6e 0020 2064 6566 2067 6574 5f63 6974  on.  def get_cit
-00005f10: 6174 696f 6e5f 6466 2873 656c 6629 3a00  ation_df(self):.
-00005f20: 0020 2020 2020 2072 6574 7572 6e20 7365  .      return se
-00005f30: 6c66 2e5f 6466 5f63 6f75 7274 7300 2020  lf._df_courts.  
-00005f40: 6465 6620 6765 745f 636f 7572 7473 5f64  def get_courts_d
-00005f50: 6628 7365 6c66 293a 0020 2023 2320 4765  f(self):.  ## Ge
-00005f60: 7474 6572 7300 0020 2020 2020 2072 6574  tters..      ret
-00005f70: 7572 6e20 7365 6c66 2e63 7376 5f74 6f5f  urn self.csv_to_
-00005f80: 6466 2866 6e20 6f72 2073 656c 662e 5f63  df(fn or self._c
-00005f90: 6974 6174 696f 6e5f 666e 2c20 696e 6465  itation_fn, inde
-00005fa0: 785f 636f 6c3d 2769 6427 292e 736f 7274  x_col='id').sort
-00005fb0: 5f69 6e64 6578 2829 0020 2064 6566 2069  _index().  def i
-00005fc0: 6e69 745f 6369 7461 7469 6f6e 5f64 6628  nit_citation_df(
-00005fd0: 7365 6c66 2c20 666e 3d4e 6f6e 6529 3a00  self, fn=None):.
-00005fe0: 2020 2320 696e 6974 6961 6c69 7a65 2063    # initialize c
-00005ff0: 6974 6174 696f 6e20 6d61 7020 6466 0000  itation map df..
-00006000: 6164 0000 8906 0000 9907 0000 0010 0000  ad..............
-00006010: 3d00 0000 0000 0000 ea0f 0000 da0f 0000  =...............
-00006020: c40f 0000 7e0f 0000 240f 0000 050f 0000  ....~...$.......
-00006030: f30e 0000 d30e 0000 b50e 0000 9d0e 0000  ................
-00006040: 9c0e 0000 5f0e 0000 e50d 0000 c50d 0000  ...._...........
-00006050: 9b0d 0000 6e0d 0000 3c0d 0000 0c0d 0000  ....n...<.......
-00006060: fe0c 0000 e00c 0000 8a0c 0000 160c 0000  ................
-00006070: 0c0c 0000 9d0b 0000 7f0b 0000 400b 0000  ............@...
-00006080: 320b 0000 310b 0000 1a0b 0000 fa0a 0000  2...1...........
-00006090: e20a 0000 e10a 0000 b10a 0000 8a0a 0000  ................
-000060a0: 870a 0000 580a 0000 310a 0000 230a 0000  ....X...1...#...
-000060b0: 070a 0000 f109 0000 d309 0000 b309 0000  ................
-000060c0: 9609 0000 7509 0000 7009 0000 5409 0000  ....u...p...T...
-000060d0: 4209 0000 2409 0000 1209 0000 f308 0000  B...$...........
-000060e0: e008 0000 c108 0000 ad08 0000 8f08 0000  ................
-000060f0: 7c08 0000 5d08 0000 4a08 0000 3a08 0000  |...]...J...:...
-00006100: 3908 0000 0408 0000 9907 0000 9d07 0000  9...............
-00006110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000061a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000061b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000061c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000061d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000061e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000061f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000062a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000062b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000062c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000062d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000062e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000062f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000063a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000063b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000063c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000063d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000063e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000063f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006400: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000064a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000064b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000064c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000064d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000064e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000064f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000065a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000065b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000065c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000065d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000065e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000065f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000066a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000066b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000066c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000066d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000066e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000066f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006790: 0000 0000 0000 0000 0020 2020 2063 6974  .........    cit
-000067a0: 6573 5f74 6f20 3d20 6466 5f63 6974 6174  es_to = df_citat
-000067b0: 696f 6e73 5b64 665f 6369 7461 7469 6f6e  ions[df_citation
-000067c0: 735b 2763 6974 696e 675f 6f70 696e 696f  s['citing_opinio
-000067d0: 6e5f 6964 275d 203d 3d20 6f70 696e 696f  n_id'] == opinio
-000067e0: 6e5f 6964 5d5b 2763 6974 6564 5f6f 7069  n_id]['cited_opi
-000067f0: 6e69 6f6e 5f69 6427 5d2e 746f 5f6c 6973  nion_id'].to_lis
-00006800: 7428 2900 2020 6465 6620 6765 745f 6369  t().  def get_ci
-00006810: 7461 7469 6f6e 7328 7365 6c66 2c20 6f70  tations(self, op
-00006820: 696e 696f 6e5f 6964 2c20 6466 5f63 6974  inion_id, df_cit
-00006830: 6174 696f 6e73 293a 0000 2020 2020 7265  ations):..    re
-00006840: 7475 726e 2074 6578 7400 2020 2020 2020  turn text.      
-00006850: 2020 7465 7874 203d 2068 6c61 0020 2020    text = hla.   
-00006860: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
-00006870: 2868 6c61 2c20 7374 7229 3a00 2020 2020  (hla, str):.    
-00006880: 2020 2020 7465 7874 203d 2078 6820 0020      text = xh . 
-00006890: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
-000068a0: 6365 2878 682c 2073 7472 293a 0020 2020  ce(xh, str):.   
-000068b0: 2020 2020 2074 6578 7420 3d20 686c 6320       text = hlc 
-000068c0: 0020 2020 2065 6c69 6620 6973 696e 7374  .    elif isinst
-000068d0: 616e 6365 2868 6c63 2c20 7374 7229 3a00  ance(hlc, str):.
-000068e0: 2020 2020 2020 2020 7465 7874 203d 2068          text = h
-000068f0: 6c62 0020 2020 2065 6c69 6620 6973 696e  lb.    elif isin
-00006900: 7374 616e 6365 2868 6c62 2c20 7374 7229  stance(hlb, str)
-00006910: 3a00 2020 2020 2020 2020 7465 7874 203d  :.        text =
-00006920: 2068 6c00 2020 2020 656c 6966 2069 7369   hl.    elif isi
-00006930: 6e73 7461 6e63 6528 686c 2c20 7374 7229  nstance(hl, str)
-00006940: 3a00 2020 2020 2020 2020 7465 7874 203d  :.        text =
-00006950: 2070 7400 2020 2020 6966 2069 7369 6e73   pt.    if isins
-00006960: 7461 6e63 6528 7074 2c20 7374 7229 3a00  tance(pt, str):.
-00006970: 2020 2020 0020 2020 2068 6c61 203d 206f      .    hla = o
-00006980: 7069 6e69 6f6e 2e68 746d 6c5f 616e 6f6e  pinion.html_anon
-00006990: 5f32 3032 3000 2020 2020 7868 203d 206f  _2020.    xh = o
-000069a0: 7069 6e69 6f6e 2e78 6d6c 5f68 6172 7661  pinion.xml_harva
-000069b0: 7264 0020 2020 2068 6c63 203d 206f 7069  rd.    hlc = opi
-000069c0: 6e69 6f6e 2e68 746d 6c5f 636f 6c75 6d62  nion.html_columb
-000069d0: 6961 0020 2020 2068 6c62 203d 206f 7069  ia.    hlb = opi
-000069e0: 6e69 6f6e 2e68 746d 6c5f 6c61 7762 6f78  nion.html_lawbox
-000069f0: 0020 2020 2068 6c20 3d20 6f70 696e 696f  .    hl = opinio
-00006a00: 6e2e 6874 6d6c 0020 2020 2070 7420 3d20  n.html.    pt = 
-00006a10: 6f70 696e 696f 6e2e 706c 6169 6e5f 7465  opinion.plain_te
-00006a20: 7874 0020 2020 2074 6578 7420 3d20 2727  xt.    text = ''
-00006a30: 0020 2064 6566 2067 6574 5f6f 7069 6e69  .  def get_opini
-00006a40: 6f6e 5f74 6578 7428 7365 6c66 2c20 6f70  on_text(self, op
-00006a50: 696e 696f 6e29 3a00 2020 2320 6163 6365  inion):.  # acce
-00006a60: 7074 7320 6120 7365 7269 6573 202d 2d20  pts a series -- 
-00006a70: 6120 726f 7720 6672 6f6d 2061 2064 6174  a row from a dat
-00006a80: 6166 7261 6d65 0020 2000 2020 2020 7265  aframe.  .    re
-00006a90: 7475 726e 2064 662e 6c6f 635b 6466 5b63  turn df.loc[df[c
-00006aa0: 6f6c 756d 6e5d 203d 3d20 6d61 7463 685d  olumn] == match]
-00006ab0: 0020 2064 6566 2064 665f 726f 775f 6279  .  def df_row_by
-00006ac0: 5f76 616c 7565 2873 656c 662c 2064 662c  _value(self, df,
-00006ad0: 2063 6f6c 756d 6e2c 206d 6174 6368 293a   column, match):
-00006ae0: 0000 2020 2020 7265 7475 726e 2073 656c  ..    return sel
-00006af0: 662e 5f63 6c69 656e 7400 2020 6465 6620  f._client.  def 
-00006b00: 6765 745f 636c 7573 7465 725f 636c 6965  get_cluster_clie
-00006b10: 6e74 2873 656c 6629 3a00 2020 2320 6765  nt(self):.  # ge
-00006b20: 7420 636c 7573 7465 7220 636c 6965 6e74  t cluster client
-00006b30: 0000 2020 2020 7265 7475 726e 2064 6600  ..    return df.
-00006b40: 2020 2020 7072 696e 7428 6627 7b66 696c      print(f'{fil
-00006b50: 656e 616d 657d 2072 6561 6420 696e 207b  ename} read in {
-00006b60: 696e 7428 2865 6e64 2d73 7461 7274 292f  int((end-start)/
-00006b70: 3630 297d 206d 696e 7574 6573 2729 0020  60)} minutes'). 
-00006b80: 2020 2065 6e64 203d 2074 696d 652e 7065     end = time.pe
-00006b90: 7266 5f63 6f75 6e74 6572 2829 0020 2020  rf_counter().   
-00006ba0: 2020 2020 2064 6620 3d20 7064 2e72 6561       df = pd.rea
-00006bb0: 645f 6373 7628 6669 6c65 6e61 6d65 2c20  d_csv(filename, 
-00006bc0: 6474 7970 653d 6474 7970 652c 2070 6172  dtype=dtype, par
-00006bd0: 7365 5f64 6174 6573 3d70 6172 7365 5f64  se_dates=parse_d
-00006be0: 6174 6573 2c20 7573 6563 6f6c 733d 7573  ates, usecols=us
-00006bf0: 6563 6f6c 732c 2069 6e64 6578 5f63 6f6c  ecols, index_col
-00006c00: 3d69 6e64 6578 5f63 6f6c 2900 2020 2020  =index_col).    
-00006c10: 656c 7365 3a00 2020 2020 2020 2020 2020  else:.          
-00006c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c30: 2020 2020 2020 2020 2020 2020 2064 7479               dty
-00006c40: 7065 3d64 7479 7065 2c20 7061 7273 655f  pe=dtype, parse_
-00006c50: 6461 7465 733d 7061 7273 655f 6461 7465  dates=parse_date
-00006c60: 732c 2075 7365 636f 6c73 3d75 7365 636f  s, usecols=useco
-00006c70: 6c73 2c20 696e 6465 785f 636f 6c3d 696e  ls, index_col=in
-00006c80: 6465 785f 636f 6c29 2900 2020 2020 2020  dex_col)).      
-00006c90: 2020 6466 203d 2070 642e 636f 6e63 6174    df = pd.concat
-00006ca0: 2873 656c 662e 7265 6164 5f63 7376 5f61  (self.read_csv_a
-00006cb0: 735f 6466 7328 6669 6c65 6e61 6d65 2c20  s_dfs(filename, 
-00006cc0: 6e75 6d5f 6466 733d 3130 2a2a 352c 206d  num_dfs=10**5, m
-00006cd0: 6178 5f72 6f77 733d 3130 2a2a 372c 2000  ax_rows=10**7, .
-00006ce0: 2020 2020 6966 2066 696c 655f 7369 7a65      if file_size
-00006cf0: 5f67 6220 3e20 6d61 785f 6762 3a00 2020  _gb > max_gb:.  
-00006d00: 2020 6466 203d 204e 6f6e 6500 2020 2020    df = None.    
-00006d10: 7072 696e 7428 2246 696c 6520 5369 7a65  print("File Size
-00006d20: 2069 7320 3a22 2c20 6669 6c65 5f73 697a   is :", file_siz
-00006d30: 655f 6762 2c20 2247 4222 2900 2020 2020  e_gb, "GB").    
-00006d40: 7072 696e 7428 6627 496d 706f 7274 696e  print(f'Importin
-00006d50: 6720 7b66 696c 656e 616d 657d 2061 7320  g {filename} as 
-00006d60: 6120 6461 7461 6672 616d 6527 2900 2020  a dataframe').  
-00006d70: 2020 6669 6c65 5f73 697a 655f 6762 203d    file_size_gb =
-00006d80: 2072 6f75 6e64 2866 696c 655f 7369 7a65   round(file_size
-00006d90: 2f31 302a 2a39 2c20 3229 0020 2020 2066  /10**9, 2).    f
-00006da0: 696c 655f 7369 7a65 203d 206f 732e 7061  ile_size = os.pa
-00006db0: 7468 2e67 6574 7369 7a65 2866 696c 656e  th.getsize(filen
-00006dc0: 616d 6529 0020 2020 2073 7461 7274 203d  ame).    start =
-00006dd0: 2074 696d 652e 7065 7266 5f63 6f75 6e74   time.perf_count
-00006de0: 6572 2829 0020 2064 6566 2063 7376 5f74  er().  def csv_t
-00006df0: 6f5f 6466 2873 656c 662c 2066 696c 656e  o_df(self, filen
-00006e00: 616d 652c 2064 7479 7065 203d 204e 6f6e  ame, dtype = Non
-00006e10: 652c 2070 6172 7365 5f64 6174 6573 203d  e, parse_dates =
-00006e20: 204e 6f6e 652c 206d 6178 5f67 623d 352c   None, max_gb=5,
-00006e30: 206e 756d 5f64 6673 3d31 302a 2a33 2c20   num_dfs=10**3, 
-00006e40: 7573 6563 6f6c 733d 4e6f 6e65 2c20 696e  usecols=None, in
-00006e50: 6465 785f 636f 6c3d 4e6f 6e65 293a 0020  dex_col=None):. 
-00006e60: 2023 2067 6574 2061 2070 6f74 656e 7469   # get a potenti
-00006e70: 616c 6c79 206c 6172 6765 2063 7376 2061  ally large csv a
-00006e80: 6e64 2074 7572 6e20 6974 2069 6e74 6f20  nd turn it into 
-00006e90: 6120 4461 7461 4672 616d 6500 0020 2020  a DataFrame..   
-00006ea0: 2072 6574 7572 6e20 6466 735f 6f70 696e   return dfs_opin
-00006eb0: 696f 6e73 0020 2020 2020 2020 2063 6f75  ions.        cou
-00006ec0: 6e74 6572 203d 2063 6f75 6e74 6572 202b  nter = counter +
-00006ed0: 2031 0020 2020 2020 2020 2064 6673 5f6f   1.        dfs_o
-00006ee0: 7069 6e69 6f6e 732e 6170 7065 6e64 2864  pinions.append(d
-00006ef0: 6629 0020 2020 2020 2020 2020 2020 2062  f).            b
-00006f00: 7265 616b 0020 2020 2020 2020 2069 6620  reak.        if 
-00006f10: 636f 756e 7465 7220 3e3d 206e 756d 5f64  counter >= num_d
-00006f20: 6673 3a00 2020 2020 2020 2020 2020 2020  fs:.            
-00006f30: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00006f40: 7273 655f 6461 7465 733d 7061 7273 655f  rse_dates=parse_
-00006f50: 6461 7465 732c 2075 7365 636f 6c73 3d75  dates, usecols=u
-00006f60: 7365 636f 6c73 2c20 696e 6465 785f 636f  secols, index_co
-00006f70: 6c3d 696e 6465 785f 636f 6c29 3a00 2020  l=index_col):.  
-00006f80: 2020 666f 7220 6466 2069 6e20 7064 2e72    for df in pd.r
-00006f90: 6561 645f 6373 7628 6669 6c65 6e61 6d65  ead_csv(filename
-00006fa0: 2c20 6368 756e 6b73 697a 653d 6d61 785f  , chunksize=max_
-00006fb0: 726f 7773 2c20 6474 7970 653d 6474 7970  rows, dtype=dtyp
-00006fc0: 652c 2000 2020 2020 6466 735f 6f70 696e  e, .    dfs_opin
-00006fd0: 696f 6e73 203d 205b 5d00 2020 2020 636f  ions = [].    co
-00006fe0: 756e 7465 7220 3d20 3000 2020 2020 2020  unter = 0.      
-00006ff0: 2020 2020 2020 2020 2020 2020 2029 3a00               ):.
+00005730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00005790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000057a0: 0000 0020 2020 2020 2020 2027 7572 6c27  ...        'url'
+000057b0: 3a20 6f70 696e 696f 6e5b 2764 6f77 6e6c  : opinion['downl
+000057c0: 6f61 6420 2020 2020 2020 2020 2775 726c  oad         'url
+000057d0: 273a 206f 7069 6e69 6f6e 5b27 646f 776e  ': opinion['down
+000057e0: 6c6f 6164 5f75 726c 275d 2c00 2020 2020  load_url'],.    
+000057f0: 2020 2020 2769 6427 3a20 636c 7573 7465      'id': cluste
+00005800: 725f 6964 2c00 2020 2020 6f62 6a20 3d20  r_id,.    obj = 
+00005810: 7b00 0020 2020 2064 6174 655f 7465 726d  {..    date_term
+00005820: 696e 6174 6564 203d 206c 6973 7428 646f  inated = list(do
+00005830: 636b 6574 5f72 6f77 5b27 6461 7465 5f74  cket_row['date_t
+00005840: 6572 6d69 6e61 7465 6427 5d29 5b30 5d00  erminated'])[0].
+00005850: 2020 2020 2320 736f 6d65 7469 6d65 7320      # sometimes 
+00005860: 6461 7465 5f74 6572 6d69 6e61 7465 6420  date_terminated 
+00005870: 6d61 7920 6265 206d 6973 7369 6e67 2061  may be missing a
+00005880: 6e64 2072 6563 6f72 6465 6420 6173 204e  nd recorded as N
+00005890: 614e 0020 2020 2020 2020 2000 2020 2020  aN.        .    
+000058a0: 5d00 2020 2020 2020 2020 6966 206e 6f74  ].        if not
+000058b0: 2072 652e 6d61 7463 6828 275b 636a 5d3f   re.match('[cj]?
+000058c0: 6a5c 2e27 2c20 6a75 6467 6529 0020 2020  j\.', judge).   
+000058d0: 2020 2020 2020 2020 2028 6a75 6467 6573           (judges
+000058e0: 2e69 6c6f 635b 305d 2e73 706c 6974 2827  .iloc[0].split('
+000058f0: 2c27 2920 6966 206a 7564 6765 732e 6e6f  ,') if judges.no
+00005900: 746e 6128 292e 626f 6f6c 2829 2065 6c73  tna().bool() els
+00005910: 6520 5b5d 2900 2020 2020 2020 2020 666f  e []).        fo
+00005920: 7220 6a75 6467 6520 696e 0020 2020 2020  r judge in.     
+00005930: 2020 206a 7564 6765 0020 2020 206a 7564     judge.    jud
+00005940: 6765 5f6c 6973 7420 3d20 5b00 2020 2020  ge_list = [.    
+00005950: 6a75 6467 6573 203d 2063 6c75 7374 6572  judges = cluster
+00005960: 5f72 6f77 2e6a 7564 6765 7300 2020 2020  _row.judges.    
+00005970: 236a 7564 6765 7300 0020 2020 2063 6974  #judges..    cit
+00005980: 6564 5f62 7920 3d20 6369 7461 7469 6f6e  ed_by = citation
+00005990: 5f69 6e66 6f5b 2763 6974 6564 5f62 7927  _info['cited_by'
+000059a0: 5d00 2020 2020 6369 7465 735f 746f 203d  ].    cites_to =
+000059b0: 2063 6974 6174 696f 6e5f 696e 666f 5b27   citation_info['
+000059c0: 6369 7465 735f 746f 275d 0020 2020 2063  cites_to'].    c
+000059d0: 6974 6174 696f 6e5f 696e 666f 203d 2073  itation_info = s
+000059e0: 656c 662e 6765 745f 6369 7461 7469 6f6e  elf.get_citation
+000059f0: 7328 6f70 696e 696f 6e5f 6964 2c20 6369  s(opinion_id, ci
+00005a00: 7461 7469 6f6e 7329 0020 2020 2023 2067  tations).    # g
+00005a10: 6574 206f 7069 6e69 6f6e 7320 6369 7465  et opinions cite
+00005a20: 6420 746f 0000 2020 2020 2020 2020 7265  d to..        re
+00005a30: 7475 726e 0020 2020 2069 6620 636f 7572  turn.    if cour
+00005a40: 745f 726f 772e 656d 7074 793a 0020 2020  t_row.empty:.   
+00005a50: 2063 6f75 7274 5f72 6f77 3a20 7365 6c66   court_row: self
+00005a60: 2e44 6174 6146 7261 6d65 203d 2063 6f75  .DataFrame = cou
+00005a70: 7274 735b 636f 7572 7473 5b27 6964 275d  rts[courts['id']
+00005a80: 203d 3d20 6369 645d 0020 2020 2063 6964   == cid].    cid
+00005a90: 203d 206c 6973 7428 646f 636b 6574 5f72   = list(docket_r
+00005aa0: 6f77 5b27 636f 7572 745f 6964 275d 295b  ow['court_id'])[
+00005ab0: 305d 0020 2020 2020 2020 2072 6574 7572  0].        retur
+00005ac0: 6e20 0020 2020 2069 6620 6c65 6e28 646f  n .    if len(do
+00005ad0: 636b 6574 5f72 6f77 2e63 6f6c 756d 6e73  cket_row.columns
+00005ae0: 2920 3d3d 2030 3a00 2020 2020 2320 7265  ) == 0:.    # re
+00005af0: 7475 726e 2065 6172 6c79 2069 6620 7468  turn early if th
+00005b00: 6572 6527 7320 0000 2020 2020 646f 636b  ere's ..    dock
+00005b10: 6574 5f72 6f77 203d 2064 6f63 6b65 7473  et_row = dockets
+00005b20: 5b64 6f63 6b65 7473 5b27 6964 275d 203d  [dockets['id'] =
+00005b30: 3d20 646f 636b 6574 5f69 645d 2e63 6f6d  = docket_id].com
+00005b40: 7075 7465 2829 0020 2020 2064 6f63 6b65  pute().    docke
+00005b50: 745f 6964 203d 2069 6e74 2863 6c75 7374  t_id = int(clust
+00005b60: 6572 5f72 6f77 5b27 646f 636b 6574 5f69  er_row['docket_i
+00005b70: 6427 5d29 0020 2020 2023 2067 6574 2063  d']).    # get c
+00005b80: 6f72 7265 7370 6f6e 6469 6e67 2072 6f77  orresponding row
+00005b90: 2066 726f 6d20 646f 636b 6574 2064 6620   from docket df 
+00005ba0: 6261 7365 6420 6f6e 2063 6c75 7374 6572  based on cluster
+00005bb0: 206f 7069 6e69 6f6e 2069 6400 0020 2020   opinion id..   
+00005bc0: 2063 6c75 7374 6572 5f72 6f77 3a20 7365   cluster_row: se
+00005bd0: 6c66 2e44 6174 6146 7261 6d65 203d 2073  lf.DataFrame = s
+00005be0: 656c 662e 6466 5f72 6f77 5f62 795f 7661  elf.df_row_by_va
+00005bf0: 6c75 6528 7365 6c66 2e67 6574 5f6f 7069  lue(self.get_opi
+00005c00: 6e69 6f6e 735f 636c 7573 7465 725f 6466  nions_cluster_df
+00005c10: 2829 2c20 2769 6427 2c20 636c 7573 7465  (), 'id', cluste
+00005c20: 725f 6964 2900 2020 2020 2320 6765 7420  r_id).    # get 
+00005c30: 6561 6368 2063 6f72 7265 7370 6f6e 6469  each correspondi
+00005c40: 6e67 2072 6f77 2066 726f 6d20 636c 7573  ng row from clus
+00005c50: 7465 7273 2c20 646f 636b 6574 732c 2063  ters, dockets, c
+00005c60: 6f75 7274 7320 6261 7365 6420 6f6e 206f  ourts based on o
+00005c70: 7069 6e69 6f6e 2069 6400 0020 2020 2063  pinion id..    c
+00005c80: 6c75 7374 6572 5f69 6420 3d20 6f70 696e  luster_id = opin
+00005c90: 696f 6e5b 2763 6c75 7374 6572 5f69 6427  ion['cluster_id'
+00005ca0: 5d00 2020 2020 6f70 696e 696f 6e5f 6964  ].    opinion_id
+00005cb0: 203d 206f 7069 6e69 6f6e 5b27 6964 275d   = opinion['id']
+00005cc0: 0020 2020 2063 6974 6174 696f 6e73 203d  .    citations =
+00005cd0: 2073 656c 662e 6765 745f 6369 7461 7469   self.get_citati
+00005ce0: 6f6e 5f64 6628 2900 2020 2020 636f 7572  on_df().    cour
+00005cf0: 7473 203d 2073 656c 662e 6765 745f 636f  ts = self.get_co
+00005d00: 7572 7473 5f64 6628 2900 2020 2020 646f  urts_df().    do
+00005d10: 636b 6574 7320 3d20 7365 6c66 2e67 6574  ckets = self.get
+00005d20: 5f64 6f63 6b65 7473 5f64 6628 2900 2020  _dockets_df().  
+00005d30: 6465 6620 7072 6f63 6573 735f 726f 7728  def process_row(
+00005d40: 7365 6c66 2c20 6f70 696e 696f 6e29 202d  self, opinion) -
+00005d50: 3e20 6469 6374 3a00 2020 2320 7072 6f63  > dict:.  # proc
+00005d60: 6573 7300 2020 2020 2020 0020 2020 2020  ess.      .     
+00005d70: 2070 6173 7300 2020 6465 6620 6765 745f   pass.  def get_
+00005d80: 6f70 696e 696f 6e73 5f64 6628 7365 6c66  opinions_df(self
+00005d90: 293a 0000 2020 2020 2020 7265 7475 726e  ):..      return
+00005da0: 2073 656c 662e 5f64 665f 6f70 696e 696f   self._df_opinio
+00005db0: 6e5f 636c 7573 7465 7273 0020 2064 6566  n_clusters.  def
+00005dc0: 2067 6574 5f6f 7069 6e69 6f6e 735f 636c   get_opinions_cl
+00005dd0: 7573 7465 725f 6466 2873 656c 6629 3a00  uster_df(self):.
+00005de0: 0020 2020 2020 2072 6574 7572 6e20 7365  .      return se
+00005df0: 6c66 2e5f 6466 5f64 6f63 6b65 7473 0020  lf._df_dockets. 
+00005e00: 2064 6566 2067 6574 5f64 6f63 6b65 7473   def get_dockets
+00005e10: 5f64 6628 7365 6c66 293a 0020 2000 2020  _df(self):.  .  
+00005e20: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00005e30: 5f64 665f 6369 7461 7469 6f6e 0020 2064  _df_citation.  d
+00005e40: 6566 2067 6574 5f63 6974 6174 696f 6e5f  ef get_citation_
+00005e50: 6466 2873 656c 6629 3a00 0020 2020 2020  df(self):..     
+00005e60: 2072 6574 7572 6e20 7365 6c66 2e5f 6466   return self._df
+00005e70: 5f63 6f75 7274 7300 2020 6465 6620 6765  _courts.  def ge
+00005e80: 745f 636f 7572 7473 5f64 6628 7365 6c66  t_courts_df(self
+00005e90: 293a 0020 2023 2320 4765 7474 6572 7300  ):.  ## Getters.
+00005ea0: 0020 2020 2020 2072 6574 7572 6e20 7365  .      return se
+00005eb0: 6c66 2e63 7376 5f74 6f5f 6466 2866 6e20  lf.csv_to_df(fn 
+00005ec0: 6f72 2073 656c 662e 5f63 6974 6174 696f  or self._citatio
+00005ed0: 6e5f 666e 2900 2020 6465 6620 696e 6974  n_fn).  def init
+00005ee0: 5f63 6974 6174 696f 6e5f 6466 2873 656c  _citation_df(sel
+00005ef0: 662c 2066 6e3d 4e6f 6e65 293a 0020 2023  f, fn=None):.  #
+00005f00: 2069 6e69 7469 616c 697a 6520 6369 7461   initialize cita
+00005f10: 7469 6f6e 206d 6170 2064 6600 0020 2020  tion map df..   
+00005f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005f30: 2020 2020 2020 626c 6f63 6b73 697a 653d        blocksize=
+00005f40: 2233 324d 4222 2900 2020 2020 2020 7265  "32MB").      re
+00005f50: 7475 726e 2064 642e 7265 6164 5f63 7376  turn dd.read_csv
+00005f60: 2866 6e20 6f72 2073 656c 662e 5f64 6f63  (fn or self._doc
+00005f70: 6b65 7473 5f66 6e2c 2064 7479 7065 3d6d  kets_fn, dtype=m
+00005f80: 795f 7479 7065 732c 2075 7365 636f 6c73  y_types, usecols
+00005f90: 3d5b 2763 6f75 7274 5f69 6427 2c20 2769  =['court_id', 'i
+00005fa0: 6427 2c20 2764 6174 655f 7465 726d 696e  d', 'date_termin
+00005fb0: 6174 6564 275d 2c00 0020 2020 2020 207d  ated'],..      }
+00005fc0: 2000 2020 2020 2020 2764 6174 655f 7465   .      'date_te
+00005fd0: 726d 696e 6174 6564 273a 2027 7374 7269  rminated': 'stri
+00005fe0: 6e67 2700 2020 2020 2020 2763 6f75 7274  ng'.      'court
+00005ff0: 5f69 6427 3a20 2773 7472 696e 6727 2c00  _id': 'string',.
```

### Comparing `lil_nocap-0.4.3/lil_nocap/nocap.py` & `lil_nocap-0.5.0/lil_nocap/__init__.py`

 * *Files 10% similar despite different names*

```diff
@@ -1,17 +1,19 @@
 #!/usr/bin/env 
 import pandas as pd
 import numpy as np
 import dask
 from dask.distributed import Client, progress
+import dask.dataframe as dd
 import multiprocessing as mp
 import time
 import timeit
 import os
 import click
+import re
 
 class NoCap:
   def __init__(self, opinions_fn, opinion_clusters_fn, courts_fn, dockets_fn, citation_fn):
     self._opinions_fn = opinions_fn
     self._opinion_clusters_fn = opinion_clusters_fn
     self._courts_fn = courts_fn
     self._dockets_fn = dockets_fn
@@ -21,25 +23,22 @@
     self._df_opinion_clusters = self.init_opinion_clusters_df()
     self._df_citation = self.init_citation_df()
     self._df_dockets = self.init_dockets_df()
 
     #self._df_opinions = self.init_opinions_df()
     self.DataFrame = pd.core.frame.DataFrame
 
-    self._client = None
-
   @click.command()  
   @click.option('-o', help="local path to opinions file", required=True)
   @click.option('-oc', help="local path to opinion clusters file", required=True)
   @click.option('-c', help="local path to courts file ", required=True)
   @click.option('-d', help="local path to dockets file", required=True)
   @click.option('-cm', help="local path to citation map file", required=True)
   def cli(o, oc, c, d, cm):
     NoCap(o, oc, c, d, cm).start()
-   
     
   def read_csv_as_dfs(self, filename, 
                     num_dfs=10, 
                     max_rows=10**5, 
                     dtype=None, 
                     parse_dates=None,
                     usecols=None,
@@ -110,15 +109,19 @@
         'cites_to':cites_to,
         'cited_by':cited_by
     }
 
   # initialize courts df
   def init_courts_df(self, fn=None):
     usecols = ['id','full_name','jurisdiction']
-    return self.csv_to_df(fn or self._courts_fn, usecols=usecols, index_col='id').sort_index()
+    dtypes = {
+      'fullname': 'string',
+      'jurisdiction': 'string'
+    }
+    return self.csv_to_df(fn or self._courts_fn, dtype=dtypes, usecols=usecols)
 
   # initialize opinions df
   def init_opinions_df(self, fn=None):
       opinion_dtypes = {
         'download_url': 'string',
         'local_path':'string',
         'plain_text':'string',
@@ -131,31 +134,34 @@
       } 
 
       return self.csv_to_df(fn or self._opinions_fn, dtype=opinion_dtypes, index_col='id')
 
   # initialize opinion clusters df
   def init_opinion_clusters_df(self, fn=None):
       usecols = ['id', 'judges', 'docket_id', 'case_name', 'case_name_full']
-      return self.csv_to_df(fn or self._opinion_clusters_fn, usecols=usecols, index_col='id').sort_index()
+      dtypes = {
+        'judges':'string',
+        'case_name':'string',
+        'case_name_full':'string'
+      }
+      return self.csv_to_df(fn or self._opinion_clusters_fn, dtype=dtypes, usecols=usecols)
 
   # initialize dockets df
   def init_dockets_df(self, fn=None):
-      parse_dates = [
-      'date_terminated',
-      ]
-
       my_types = {
-      'court_id': 'string'
+      'court_id': 'string',
+      'date_terminated': 'string'
       } 
 
-      return self.csv_to_df(fn or self._dockets_fn, dtype=my_types, parse_dates=parse_dates, usecols=['court_id', 'id', 'date_terminated'], index_col='id').sort_index()
+      return dd.read_csv(fn or self._dockets_fn, dtype=my_types, usecols=['court_id', 'id', 'date_terminated'],
+                         blocksize="32MB")
 
   # initialize citation map df
   def init_citation_df(self, fn=None):
-      return self.csv_to_df(fn or self._citation_fn, index_col='id').sort_index()
+      return self.csv_to_df(fn or self._citation_fn)
 
   ## Getters
   def get_courts_df(self):
       return self._df_courts
 
   def get_citation_df(self):
       return self._df_citation
@@ -166,56 +172,66 @@
   def get_opinions_cluster_df(self):
       return self._df_opinion_clusters
 
   def get_opinions_df(self):
       pass
       
   # process
-  def process(self, opinion) -> dict:
+  def process_row(self, opinion) -> dict:
     dockets = self.get_dockets_df()
     courts = self.get_courts_df()
     citations = self.get_citation_df()
     opinion_id = opinion['id']
     cluster_id = opinion['cluster_id']
 
     # get each corresponding row from clusters, dockets, courts based on opinion id
     cluster_row: self.DataFrame = self.df_row_by_value(self.get_opinions_cluster_df(), 'id', cluster_id)
 
     # get corresponding row from docket df based on cluster opinion id
     docket_id = int(cluster_row['docket_id'])
-    docket_row: self.DataFrame = dockets[dockets['id'] == docket_id]
+    docket_row = dockets[dockets['id'] == docket_id].compute()
 
     # return early if there's 
-    if docket_row.empty:
+    if len(docket_row.columns) == 0:
         return 
-    court_row: self.DataFrame = courts[courts['id'] == docket_row['court_id'].iloc[0]]
+    cid = list(docket_row['court_id'])[0]
+    court_row: self.DataFrame = courts[courts['id'] == cid]
     if court_row.empty:
         return
 
     # get opinions cited to
     citation_info = self.get_citations(opinion_id, citations)
     cites_to = citation_info['cites_to']
     cited_by = citation_info['cited_by']
 
     #judges
     judges = cluster_row.judges
+    judge_list = [
+        judge
+        for judge in
+            (judges.iloc[0].split(',') if judges.notna().bool() else [])
+        if not re.match('[cj]?j\.', judge)
+    ]
         
+    # sometimes date_terminated may be missing and recorded as NaN
+    date_terminated = list(docket_row['date_terminated'])[0]
+
     obj = {
         'id': cluster_id,
         'url': opinion['download_url'],
         'name_abbreviation': cluster_row.case_name.iloc[0],
         'name' : cluster_row.case_name_full.iloc[0],
-        'decision_date': docket_row.date_terminated.iloc[0],
+        'decision_date': date_terminated,
         'docket_number' : cluster_row.docket_id.iloc[0],
         'citations' : cited_by,
         'cites_to' : cites_to,
         'court' : {'name': court_row.full_name.iloc[0]},
         'jurisdiction' : {'name': court_row.jurisdiction.iloc[0]},
         'casebody' : {'data': {
-            'judges': judges.iloc[0].split(',') if judges.notna().bool() else [],
+            'judges': judge_list,
             'head_matter':'', #Ask CL about copyright,
             'opinions': [{
                 'text': self.get_opinion_text(opinion), 
                 'author': '', 'type': ''}]
             }
         }
     }
@@ -230,60 +246,59 @@
             'xml_harvard',
             'plain_text',
             'html',
             'html_lawbox',
             'html_columbia',
             'html_anon_2020'
           ]].apply(
-            lambda row: print(f'{self.process(row)}\n'),
+            lambda row: print(f'{self.process_row(row)}\n'),
             axis=1,
           )  
 
+  def process_df(self, df, client):
+    futures = []
+    for index, row in df.iterrows():
+      self.process_row(row)
+      future = client.submit(self.process_row, row)
+      futures.append(future)
+    #return client.gather(futures)
+    
   def start(self):
     start = time.perf_counter()
-    max_rows = 500
+    max_rows = 50
     opinion_dtypes = {
         'download_url': 'string',
         'local_path':'string',
         'plain_text':'string',
         'html':'string',
         'html_lawbox':'string',
         'html_columbia':'string',
         'html_anon_2020':'string',
         'html_with_citations':'string',
         'local_path':'string'
     }
+    usecols = [
+           'id',
+           'download_url', 
+           'local_path',
+           'cluster_id',
+           'xml_harvard',
+           'plain_text',
+           'html',
+           'html_lawbox',
+           'html_columbia',
+           'html_anon_2020',
+           'local_path'           
+          ]
     file_size = os.path.getsize(self._opinions_fn)
     file_size_gb = round(file_size/10**9, 2)
     print(f'Importing {self._opinions_fn} as a dataframe')
     print("File Size is :", file_size_gb, "GB")
-    self._client = Client(threads_per_worker=4, n_workers = int(mp.cpu_count()/2))
-    print(self._client)
-    lazy_results = []
-    for df in pd.read_csv(self._opinions_fn, chunksize=max_rows, dtype=opinion_dtypes, parse_dates=None, usecols=None):
-      #print('Now reading opinions')
-      for index, row in df[[
-            'id',
-            'local_path',
-            'download_url',
-            'cluster_id',
-            'xml_harvard',
-            'plain_text',
-            'html',
-            'html_lawbox',
-            'html_columbia',
-            'html_anon_2020'
-          ]].iterrows():
-
-          lazy_result = dask.delayed(self.process)(row)
-          lazy_results.append(lazy_result)
-    results = dask.compute(*lazy_results)
-    print(*results, sep='\n')
-    
+    client = Client(threads_per_worker=4, n_workers = int(mp.cpu_count() * .35))
+    for df in pd.read_csv(self._opinions_fn, chunksize=max_rows, dtype=opinion_dtypes, parse_dates=None, usecols=usecols):
+      print('Now reading opinions')
+      self.process_df(df, client)
     end = time.perf_counter()
     print((end-start)/60)
 
-
 if __name__ == '__main__':
   NoCap.cli()
-   
-
```

### Comparing `lil_nocap-0.4.3/setup.py` & `lil_nocap-0.5.0/setup.py`

 * *Files 6% similar despite different names*

```diff
@@ -10,19 +10,19 @@
 install_requires = \
 ['click>=8.1.3,<9.0.0',
  'dask[dataframe]>=2023.3.0,<2024.0.0',
  'numpy>=1.24.2,<2.0.0',
  'pandas>=1.5.3,<2.0.0']
 
 entry_points = \
-{'console_scripts': ['nocap = lil_nocap.nocap:NoCap.cli']}
+{'console_scripts': ['nocap = lil_nocap.__init__:NoCap.cli']}
 
 setup_kwargs = {
     'name': 'lil-nocap',
-    'version': '0.4.3',
+    'version': '0.5.0',
     'description': 'A package for downloading bulk files from courtlistener',
     'long_description': "# Easy Bulk export, no cap\nThis repository provides scripts and notebooks that make it easy to export data in bulk from CourtListener's freely available downloads.\n\n##\n* [x] Create first version of notebook suitable for Data Scientists\n  * [x] Create the appropriate _dtypes_ to optimize panda storage\n  * [x] Select necessary cols _usecols_, for example 'created_by' date field indicating a database _insert_ isn't necessary\n  * [x] Read the _opinions.csv_ (190+gb) chunk at a time from disk while converting into JSON\n* [ ] Create a standalone script that can be piped to other tools\n  * [x] Create PyPi library using [Poetry](https://python-poetry.org/): [package](https://pypi.org/project/lil-nocap)\n  * [x] Output script using [json lines](https://jsonlines.org/examples/) format\n* [ ] Improve speed by using [DASK DataFrame](https://docs.dask.org/en/stable/dataframe.html)\n\n",
     'author': 'sabzo',
     'author_email': 'sabelo@sabelo.io',
     'maintainer': 'None',
     'maintainer_email': 'None',
     'url': 'None',
```

### Comparing `lil_nocap-0.4.3/PKG-INFO` & `lil_nocap-0.5.0/PKG-INFO`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: lil-nocap
-Version: 0.4.3
+Version: 0.5.0
 Summary: A package for downloading bulk files from courtlistener
 License: MIT
 Author: sabzo
 Author-email: sabelo@sabelo.io
 Requires-Python: >=3.8,<4.0
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Programming Language :: Python :: 3
```

