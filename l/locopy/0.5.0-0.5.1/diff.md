# Comparing `tmp/locopy-0.5.0.tar.gz` & `tmp/locopy-0.5.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "locopy-0.5.0.tar", last modified: Tue Aug 16 19:55:35 2022, max compression
+gzip compressed data, was "locopy-0.5.1.tar", last modified: Thu Apr 13 19:43:02 2023, max compression
```

## Comparing `locopy-0.5.0.tar` & `locopy-0.5.1.tar`

 * *Command `'html2text {}'` failed with exit code 1. (No output)*

```diff
@@ -3,39 +3,39 @@
 00000020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00000070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
 00000080: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00000090: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00000090: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
 000000a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000000f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00000110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00000140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00000150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00000160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000001f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000200: 3238 206d 7469 6d65 3d31 3636 3036 3739  28 mtime=1660679
-00000210: 3733 352e 3939 3037 3438 360a 0000 0000  735.9907486.....
+00000200: 3238 206d 7469 6d65 3d31 3638 3134 3134  28 mtime=1681414
+00000210: 3938 322e 3937 3839 3434 350a 0000 0000  982.9789445.....
 00000220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -58,36 +58,36 @@
 00000390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000003f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000400: 6c6f 636f 7079 2d30 2e35 2e30 2f00 0000  locopy-0.5.0/...
+00000400: 6c6f 636f 7079 2d30 2e35 2e31 2f00 0000  locopy-0.5.1/...
 00000410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000460: 0000 0000 3030 3030 3735 3500 3030 3030  ....0000755.0000
-00000470: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00000480: 3030 3030 3030 3000 3134 3237 3637 3733  0000000.14276773
-00000490: 3037 3000 3031 3232 3230 0020 3500 0000  070.012220. 5...
+00000460: 0000 0000 3030 3030 3735 3500 3030 3031  ....0000755.0001
+00000470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00000480: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
+00000490: 3030 3000 3031 3336 3234 0020 3500 0000  000.013624. 5...
 000004a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000004f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000500: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+00000500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00000510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000520: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00000520: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00000530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00000540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00000550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00000560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000005a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000005b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000005c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -99,39 +99,39 @@
 00000620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00000670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
 00000680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00000690: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00000690: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 000006a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000006b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000006c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000006d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000006e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000006f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00000710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00000740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00000750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00000760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000007f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000800: 3232 206d 7469 6d65 3d31 3636 3036 3739  22 mtime=1660679
-00000810: 3631 312e 300a 0000 0000 0000 0000 0000  611.0...........
+00000800: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+00000810: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
 00000820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -154,36 +154,36 @@
 00000990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000009f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000a00: 6c6f 636f 7079 2d30 2e35 2e30 2f4c 4943  locopy-0.5.0/LIC
+00000a00: 6c6f 636f 7079 2d30 2e35 2e31 2f4c 4943  locopy-0.5.1/LIC
 00000a10: 454e 5345 0000 0000 0000 0000 0000 0000  ENSE............
 00000a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000a60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00000a70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00000a80: 3030 3236 3133 3500 3134 3237 3637 3732  0026135.14276772
-00000a90: 3637 3300 3031 3332 3434 0020 3000 0000  673.013244. 0...
+00000a60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00000a70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00000a80: 3030 3236 3133 3500 3030 3030 3030 3030  0026135.00000000
+00000a90: 3030 3000 3031 3436 3430 0020 3000 0000  000.014640. 0...
 00000aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000b00: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+00000b00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00000b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000b20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00000b20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00000b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00000b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00000b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00000b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00000b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00000bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -931,39 +931,39 @@
 00003a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00003a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
 00003a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00003a90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00003a90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 00003aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00003b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00003b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00003b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003c00: 3232 206d 7469 6d65 3d31 3636 3036 3739  22 mtime=1660679
-00003c10: 3631 312e 300a 0000 0000 0000 0000 0000  611.0...........
+00003c00: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+00003c10: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
 00003c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -986,36 +986,36 @@
 00003d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003e00: 6c6f 636f 7079 2d30 2e35 2e30 2f4d 414e  locopy-0.5.0/MAN
+00003e00: 6c6f 636f 7079 2d30 2e35 2e31 2f4d 414e  locopy-0.5.1/MAN
 00003e10: 4946 4553 542e 696e 0000 0000 0000 0000  IFEST.in........
 00003e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003e60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00003e70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00003e80: 3030 3030 3037 3400 3134 3237 3637 3732  0000074.14276772
-00003e90: 3637 3300 3031 3337 3637 0020 3000 0000  673.013767. 0...
+00003e60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00003e70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00003e80: 3030 3030 3037 3400 3030 3030 3030 3030  0000074.00000000
+00003e90: 3030 3000 3031 3533 3633 0020 3000 0000  000.015363. 0...
 00003ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003f00: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+00003f00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00003f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003f20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00003f20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00003f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00003f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00003f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00003f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00003f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00003fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -1059,39 +1059,39 @@
 00004220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00004270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
 00004280: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00004290: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00004290: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
 000042a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000042b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000042c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000042d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000042e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000042f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00004310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00004350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00004360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000043a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000043b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000043c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000043d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000043e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000043f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004400: 3238 206d 7469 6d65 3d31 3636 3036 3739  28 mtime=1660679
-00004410: 3733 352e 3939 3130 3034 320a 0000 0000  735.9910042.....
+00004400: 3238 206d 7469 6d65 3d31 3638 3134 3134  28 mtime=1681414
+00004410: 3938 322e 3937 3839 3434 350a 0000 0000  982.9789445.....
 00004420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -1114,50 +1114,50 @@
 00004590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000045a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000045b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000045c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000045d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000045e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000045f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004600: 6c6f 636f 7079 2d30 2e35 2e30 2f50 4b47  locopy-0.5.0/PKG
+00004600: 6c6f 636f 7079 2d30 2e35 2e31 2f50 4b47  locopy-0.5.1/PKG
 00004610: 2d49 4e46 4f00 0000 0000 0000 0000 0000  -INFO...........
 00004620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00004670: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00004680: 3030 3133 3333 3600 3134 3237 3637 3733  0013336.14276773
-00004690: 3037 3000 3031 3333 3233 0020 3000 0000  070.013323. 0...
+00004660: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00004670: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00004680: 3030 3133 3333 3600 3030 3030 3030 3030  0013336.00000000
+00004690: 3030 3000 3031 3437 3237 0020 3000 0000  000.014727. 0...
 000046a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000046b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000046c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000046d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000046e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000046f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004700: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+00004700: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00004710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004720: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00004720: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00004730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00004750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00004740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00004750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00004760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000047a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000047b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000047c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000047d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000047e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000047f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00004800: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
 00004810: 3a20 322e 310a 4e61 6d65 3a20 6c6f 636f  : 2.1.Name: loco
 00004820: 7079 0a56 6572 7369 6f6e 3a20 302e 352e  py.Version: 0.5.
-00004830: 300a 5375 6d6d 6172 793a 204c 6f61 6469  0.Summary: Loadi
+00004830: 310a 5375 6d6d 6172 793a 204c 6f61 6469  1.Summary: Loadi
 00004840: 6e67 2f55 6e6c 6f61 6469 6e67 2074 6f20  ng/Unloading to 
 00004850: 416d 617a 6f6e 2052 6564 7368 6966 7420  Amazon Redshift 
 00004860: 7573 696e 6720 5079 7468 6f6e 0a48 6f6d  using Python.Hom
 00004870: 652d 7061 6765 3a20 6874 7470 733a 2f2f  e-page: https://
 00004880: 6769 7468 7562 2e63 6f6d 2f63 6170 6974  github.com/capit
 00004890: 616c 6f6e 652f 6c6f 636f 7079 0a41 7574  alone/locopy.Aut
 000048a0: 686f 723a 2046 6169 7361 6c20 446f 7361  hor: Faisal Dosa
@@ -1539,39 +1539,39 @@
 00006020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00006070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
 00006080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00006090: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00006090: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 000060a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000060b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000060c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000060d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000060e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000060f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00006110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00006150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00006160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000061a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000061b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000061c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000061d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000061e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000061f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006200: 3232 206d 7469 6d65 3d31 3636 3036 3739  22 mtime=1660679
-00006210: 3631 312e 300a 0000 0000 0000 0000 0000  611.0...........
+00006200: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+00006210: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
 00006220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -1594,36 +1594,36 @@
 00006390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000063a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000063b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000063c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000063d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000063e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000063f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006400: 6c6f 636f 7079 2d30 2e35 2e30 2f52 4541  locopy-0.5.0/REA
+00006400: 6c6f 636f 7079 2d30 2e35 2e31 2f52 4541  locopy-0.5.1/REA
 00006410: 444d 452e 7273 7400 0000 0000 0000 0000  DME.rst.........
 00006420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00006470: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00006480: 3030 3132 3337 3400 3134 3237 3637 3732  0012374.14276772
-00006490: 3637 3300 3031 3337 3236 0020 3000 0000  673.013726. 0...
+00006460: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00006470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00006480: 3030 3132 3337 3400 3030 3030 3030 3030  0012374.00000000
+00006490: 3030 3000 3031 3533 3232 0020 3000 0000  000.015322. 0...
 000064a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000064b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000064c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000064d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000064e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000064f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006500: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+00006500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00006510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006520: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00006520: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00006530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00006550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00006540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00006550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00006560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00006590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000065a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000065b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000065c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -1987,39 +1987,39 @@
 00007c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007c60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00007c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
 00007c80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00007c90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00007c90: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
 00007ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00007d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00007d40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00007d50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00007d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00007e00: 3238 206d 7469 6d65 3d31 3636 3036 3739  28 mtime=1660679
-00007e10: 3733 352e 3937 3835 3732 360a 0000 0000  735.9785726.....
+00007e00: 3238 206d 7469 6d65 3d31 3638 3134 3134  28 mtime=1681414
+00007e10: 3938 322e 3937 3839 3434 350a 0000 0000  982.9789445.....
 00007e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -2042,36 +2042,36 @@
 00007f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00007ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008000: 6c6f 636f 7079 2d30 2e35 2e30 2f6c 6f63  locopy-0.5.0/loc
+00008000: 6c6f 636f 7079 2d30 2e35 2e31 2f6c 6f63  locopy-0.5.1/loc
 00008010: 6f70 792f 0000 0000 0000 0000 0000 0000  opy/............
 00008020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008060: 0000 0000 3030 3030 3735 3500 3030 3030  ....0000755.0000
-00008070: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00008080: 3030 3030 3030 3000 3134 3237 3637 3733  0000000.14276773
-00008090: 3037 3000 3031 3335 3235 0020 3500 0000  070.013525. 5...
+00008060: 0000 0000 3030 3030 3735 3500 3030 3031  ....0000755.0001
+00008070: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00008080: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
+00008090: 3030 3000 3031 3531 3331 0020 3500 0000  000.015131. 5...
 000080a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000080b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000080c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000080d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000080e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000080f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008100: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+00008100: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00008110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008120: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00008120: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00008130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00008140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00008150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00008160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000081a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000081b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000081c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -2083,39 +2083,39 @@
 00008220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00008270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
 00008280: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00008290: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00008290: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 000082a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000082b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000082c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000082d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000082e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000082f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00008310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00008340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00008350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00008360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000083f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008400: 3232 206d 7469 6d65 3d31 3636 3036 3739  22 mtime=1660679
-00008410: 3631 312e 300a 0000 0000 0000 0000 0000  611.0...........
+00008400: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+00008410: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
 00008420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -2138,36 +2138,36 @@
 00008590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000085f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008600: 6c6f 636f 7079 2d30 2e35 2e30 2f6c 6f63  locopy-0.5.0/loc
+00008600: 6c6f 636f 7079 2d30 2e35 2e31 2f6c 6f63  locopy-0.5.1/loc
 00008610: 6f70 792f 5f5f 696e 6974 5f5f 2e70 7900  opy/__init__.py.
 00008620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008660: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00008670: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00008680: 3030 3031 3434 3000 3134 3237 3637 3732  0001440.14276772
-00008690: 3637 3300 3031 3536 3435 0020 3000 0000  673.015645. 0...
+00008660: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00008670: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00008680: 3030 3031 3434 3000 3030 3030 3030 3030  0001440.00000000
+00008690: 3030 3000 3031 3732 3431 0020 3000 0000  000.017241. 0...
 000086a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000086b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000086c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000086d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000086e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000086f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008700: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+00008700: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00008710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008720: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00008720: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00008730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00008740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00008750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00008760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000087a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000087b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000087c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -2243,39 +2243,39 @@
 00008c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008c60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00008c70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
 00008c80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00008c90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00008c90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 00008ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008d00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00008d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00008d40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00008d50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00008d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00008e00: 3232 206d 7469 6d65 3d31 3636 3036 3739  22 mtime=1660679
-00008e10: 3631 312e 300a 0000 0000 0000 0000 0000  611.0...........
+00008e00: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+00008e10: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
 00008e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -2298,36 +2298,36 @@
 00008f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00008ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009000: 6c6f 636f 7079 2d30 2e35 2e30 2f6c 6f63  locopy-0.5.0/loc
+00009000: 6c6f 636f 7079 2d30 2e35 2e31 2f6c 6f63  locopy-0.5.1/loc
 00009010: 6f70 792f 5f76 6572 7369 6f6e 2e70 7900  opy/_version.py.
 00009020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009060: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00009070: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00009080: 3030 3031 3330 3400 3134 3237 3637 3732  0001304.14276772
-00009090: 3637 3300 3031 3537 3331 0020 3000 0000  673.015731. 0...
+00009060: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00009070: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00009080: 3030 3031 3330 3400 3030 3030 3030 3030  0001304.00000000
+00009090: 3030 3000 3031 3733 3235 0020 3000 0000  000.017325. 0...
 000090a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000090b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000090c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000090d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000090e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000090f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009100: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+00009100: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00009110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009120: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00009120: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00009130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00009150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00009160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000091a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000091b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000091c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -2374,15 +2374,15 @@
 00009450: 4c69 6365 6e73 6520 666f 7220 7468 6520  License for the 
 00009460: 7370 6563 6966 6963 206c 616e 6775 6167  specific languag
 00009470: 6520 676f 7665 726e 696e 6720 7065 726d  e governing perm
 00009480: 6973 7369 6f6e 7320 616e 640a 2320 6c69  issions and.# li
 00009490: 6d69 7461 7469 6f6e 7320 756e 6465 7220  mitations under 
 000094a0: 7468 6520 4c69 6365 6e73 652e 0a0a 5f5f  the License...__
 000094b0: 7665 7273 696f 6e5f 5f20 3d20 2230 2e35  version__ = "0.5
-000094c0: 2e30 220a 0000 0000 0000 0000 0000 0000  .0".............
+000094c0: 2e31 220a 0000 0000 0000 0000 0000 0000  .1".............
 000094d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000094e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000094f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -2403,39 +2403,39 @@
 00009620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00009670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
 00009680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00009690: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00009690: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 000096a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000096b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000096c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000096d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000096e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000096f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00009710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00009750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00009760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000097a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000097b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000097c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000097d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000097e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000097f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009800: 3232 206d 7469 6d65 3d31 3636 3036 3739  22 mtime=1660679
-00009810: 3631 312e 300a 0000 0000 0000 0000 0000  611.0...........
+00009800: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+00009810: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
 00009820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -2458,36 +2458,36 @@
 00009990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000099a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000099b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000099c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000099d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000099e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000099f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a00: 6c6f 636f 7079 2d30 2e35 2e30 2f6c 6f63  locopy-0.5.0/loc
+00009a00: 6c6f 636f 7079 2d30 2e35 2e31 2f6c 6f63  locopy-0.5.1/loc
 00009a10: 6f70 792f 6461 7461 6261 7365 2e70 7900  opy/database.py.
 00009a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009a60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00009a70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00009a80: 3030 3230 3036 3200 3134 3237 3637 3732  0020062.14276772
-00009a90: 3637 3300 3031 3536 3533 0020 3000 0000  673.015653. 0...
+00009a60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00009a70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00009a80: 3030 3230 3036 3200 3030 3030 3030 3030  0020062.00000000
+00009a90: 3030 3000 3031 3732 3437 0020 3000 0000  000.017247. 0...
 00009aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b00: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+00009b00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00009b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00009b20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00009b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00009b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00009b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00009b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00009b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00009bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -3043,39 +3043,39 @@
 0000be20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000be30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000be40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000be50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000be60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 0000be70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
 0000be80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0000be90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+0000be90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 0000bea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000beb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bf00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0000bf10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bf20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bf30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000bf40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000bf50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000bf40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0000bf50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 0000bf60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bf70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bf80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bf90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000bff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c000: 3232 206d 7469 6d65 3d31 3636 3036 3739  22 mtime=1660679
-0000c010: 3631 312e 300a 0000 0000 0000 0000 0000  611.0...........
+0000c000: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+0000c010: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
 0000c020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -3098,36 +3098,36 @@
 0000c190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c200: 6c6f 636f 7079 2d30 2e35 2e30 2f6c 6f63  locopy-0.5.0/loc
+0000c200: 6c6f 636f 7079 2d30 2e35 2e31 2f6c 6f63  locopy-0.5.1/loc
 0000c210: 6f70 792f 6572 726f 7273 2e70 7900 0000  opy/errors.py...
 0000c220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c260: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-0000c270: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-0000c280: 3030 3033 3733 3500 3134 3237 3637 3732  0003735.14276772
-0000c290: 3637 3300 3031 3534 3333 0020 3000 0000  673.015433. 0...
+0000c260: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+0000c270: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0000c280: 3030 3033 3733 3500 3030 3030 3030 3030  0003735.00000000
+0000c290: 3030 3000 3031 3730 3237 0020 3000 0000  000.017027. 0...
 0000c2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c300: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+0000c300: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 0000c310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c320: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+0000c320: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 0000c330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000c350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000c340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0000c350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 0000c360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000c3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -3267,39 +3267,39 @@
 0000cc20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cc60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 0000cc70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
 0000cc80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0000cc90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+0000cc90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 0000cca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ccb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ccc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ccd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ccf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cd00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0000cd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cd40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000cd50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000cd40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0000cd50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 0000cd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000ce00: 3232 206d 7469 6d65 3d31 3636 3036 3739  22 mtime=1660679
-0000ce10: 3631 312e 300a 0000 0000 0000 0000 0000  611.0...........
+0000ce00: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+0000ce10: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
 0000ce20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ce30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ce40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ce50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ce60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ce70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ce80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -3322,36 +3322,36 @@
 0000cf90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000cff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d000: 6c6f 636f 7079 2d30 2e35 2e30 2f6c 6f63  locopy-0.5.0/loc
+0000d000: 6c6f 636f 7079 2d30 2e35 2e31 2f6c 6f63  locopy-0.5.1/loc
 0000d010: 6f70 792f 6c6f 6767 6572 2e70 7900 0000  opy/logger.py...
 0000d020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d060: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-0000d070: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-0000d080: 3030 3033 3632 3300 3134 3237 3637 3732  0003623.14276772
-0000d090: 3637 3300 3031 3533 3732 0020 3000 0000  673.015372. 0...
+0000d060: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+0000d070: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0000d080: 3030 3033 3632 3300 3030 3030 3030 3030  0003623.00000000
+0000d090: 3030 3000 3031 3637 3636 0020 3000 0000  000.016766. 0...
 0000d0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d100: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+0000d100: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 0000d110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d120: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+0000d120: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 0000d130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000d150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000d140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0000d150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 0000d160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000d1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -3491,39 +3491,39 @@
 0000da20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000da30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000da40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000da50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000da60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 0000da70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
 0000da80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0000da90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+0000da90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 0000daa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000daf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000db00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0000db10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000db20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000db30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000db40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000db50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000db40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0000db50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 0000db60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000db70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000db80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000db90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000dc00: 3232 206d 7469 6d65 3d31 3636 3036 3739  22 mtime=1660679
-0000dc10: 3631 312e 300a 0000 0000 0000 0000 0000  611.0...........
+0000dc00: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+0000dc10: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
 0000dc20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dc30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dc40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dc50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dc60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dc70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dc80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -3546,36 +3546,36 @@
 0000dd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ddb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ddc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ddd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ddf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000de00: 6c6f 636f 7079 2d30 2e35 2e30 2f6c 6f63  locopy-0.5.0/loc
+0000de00: 6c6f 636f 7079 2d30 2e35 2e31 2f6c 6f63  locopy-0.5.1/loc
 0000de10: 6f70 792f 7265 6473 6869 6674 2e70 7900  opy/redshift.py.
 0000de20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000de30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000de40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000de50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000de60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-0000de70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-0000de80: 3030 3531 3733 3500 3134 3237 3637 3732  0051735.14276772
-0000de90: 3637 3300 3031 3537 3332 0020 3000 0000  673.015732. 0...
+0000de60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+0000de70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0000de80: 3030 3531 3733 3500 3030 3030 3030 3030  0051735.00000000
+0000de90: 3030 3000 3031 3733 3236 0020 3000 0000  000.017326. 0...
 0000dea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000deb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000ded0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000def0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000df00: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+0000df00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 0000df10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000df20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+0000df20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 0000df30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000df40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0000df50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0000df40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0000df50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 0000df60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000df70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000df80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000df90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0000dfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4931,39 +4931,39 @@
 00013420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00013470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
 00013480: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00013490: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00013490: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 000134a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000134b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000134c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000134d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000134e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000134f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00013510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00013550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00013560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000135a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000135b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000135c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000135d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000135e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000135f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013600: 3232 206d 7469 6d65 3d31 3636 3036 3739  22 mtime=1660679
-00013610: 3631 312e 300a 0000 0000 0000 0000 0000  611.0...........
+00013600: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+00013610: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
 00013620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -4986,36 +4986,36 @@
 00013790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000137a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000137b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000137c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000137d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000137e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000137f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013800: 6c6f 636f 7079 2d30 2e35 2e30 2f6c 6f63  locopy-0.5.0/loc
+00013800: 6c6f 636f 7079 2d30 2e35 2e31 2f6c 6f63  locopy-0.5.1/loc
 00013810: 6f70 792f 7333 2e70 7900 0000 0000 0000  opy/s3.py.......
 00013820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013860: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00013870: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00013880: 3030 3237 3330 3200 3134 3237 3637 3732  0027302.14276772
-00013890: 3637 3300 3031 3434 3430 0020 3000 0000  673.014440. 0...
+00013860: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00013870: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00013880: 3030 3237 3330 3200 3030 3030 3030 3030  0027302.00000000
+00013890: 3030 3000 3031 3630 3334 0020 3000 0000  000.016034. 0...
 000138a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000138b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000138c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000138d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000138e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000138f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013900: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+00013900: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00013910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013920: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00013920: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00013930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00013950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00013940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00013950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00013960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00013990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000139a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000139b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000139c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -5795,39 +5795,39 @@
 00016a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016a60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00016a70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
 00016a80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00016a90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00016a90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 00016aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016b00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00016b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016b40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00016b50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00016b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016c00: 3232 206d 7469 6d65 3d31 3636 3036 3739  22 mtime=1660679
-00016c10: 3631 312e 300a 0000 0000 0000 0000 0000  611.0...........
+00016c00: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+00016c10: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
 00016c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -5850,36 +5850,36 @@
 00016d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016e00: 6c6f 636f 7079 2d30 2e35 2e30 2f6c 6f63  locopy-0.5.0/loc
+00016e00: 6c6f 636f 7079 2d30 2e35 2e31 2f6c 6f63  locopy-0.5.1/loc
 00016e10: 6f70 792f 736e 6f77 666c 616b 652e 7079  opy/snowflake.py
 00016e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016e60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00016e70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00016e80: 3030 3431 3235 3500 3134 3237 3637 3732  0041255.14276772
-00016e90: 3637 3300 3031 3631 3037 0020 3000 0000  673.016107. 0...
+00016e60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00016e70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00016e80: 3030 3431 3235 3500 3030 3030 3030 3030  0041255.00000000
+00016e90: 3030 3000 3031 3735 3033 0020 3000 0000  000.017503. 0...
 00016ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016f00: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+00016f00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00016f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016f20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00016f20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00016f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00016f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00016f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00016f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00016f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00016fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -6979,39 +6979,39 @@
 0001b420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 0001b470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
 0001b480: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0001b490: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+0001b490: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 0001b4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0001b510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0001b550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 0001b560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b600: 3232 206d 7469 6d65 3d31 3636 3036 3739  22 mtime=1660679
-0001b610: 3631 312e 300a 0000 0000 0000 0000 0000  611.0...........
+0001b600: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+0001b610: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
 0001b620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -7034,36 +7034,36 @@
 0001b790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b800: 6c6f 636f 7079 2d30 2e35 2e30 2f6c 6f63  locopy-0.5.0/loc
+0001b800: 6c6f 636f 7079 2d30 2e35 2e31 2f6c 6f63  locopy-0.5.1/loc
 0001b810: 6f70 792f 7574 696c 6974 792e 7079 0000  opy/utility.py..
 0001b820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b860: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-0001b870: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-0001b880: 3030 3237 3136 3700 3134 3237 3637 3732  0027167.14276772
-0001b890: 3637 3300 3031 3536 3237 0020 3000 0000  673.015627. 0...
+0001b860: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+0001b870: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0001b880: 3030 3237 3136 3700 3030 3030 3030 3030  0027167.00000000
+0001b890: 3030 3000 3031 3732 3233 0020 3000 0000  000.017223. 0...
 0001b8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b900: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+0001b900: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 0001b910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b920: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+0001b920: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 0001b930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001b950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001b940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0001b950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 0001b960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001b9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -7843,39 +7843,39 @@
 0001ea20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ea30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ea40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ea50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ea60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 0001ea70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
 0001ea80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-0001ea90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+0001ea90: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
 0001eaa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001eab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001eac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ead0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001eae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001eaf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001eb00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0001eb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001eb20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001eb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001eb50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001eb40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0001eb50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 0001eb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001eb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001eb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001eb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001eba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ebb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ebc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ebd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ebe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ebf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ec00: 3238 206d 7469 6d65 3d31 3636 3036 3739  28 mtime=1660679
-0001ec10: 3733 352e 3939 3031 3139 350a 0000 0000  735.9901195.....
+0001ec00: 3238 206d 7469 6d65 3d31 3638 3134 3134  28 mtime=1681414
+0001ec10: 3938 322e 3937 3839 3434 350a 0000 0000  982.9789445.....
 0001ec20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ec30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ec40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ec50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ec60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ec70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ec80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -7898,36 +7898,36 @@
 0001ed90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001eda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001edb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001edc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001edd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ede0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001edf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ee00: 6c6f 636f 7079 2d30 2e35 2e30 2f6c 6f63  locopy-0.5.0/loc
+0001ee00: 6c6f 636f 7079 2d30 2e35 2e31 2f6c 6f63  locopy-0.5.1/loc
 0001ee10: 6f70 792e 6567 672d 696e 666f 2f00 0000  opy.egg-info/...
 0001ee20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ee30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ee40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ee50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ee60: 0000 0000 3030 3030 3735 3500 3030 3030  ....0000755.0000
-0001ee70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-0001ee80: 3030 3030 3030 3000 3134 3237 3637 3733  0000000.14276773
-0001ee90: 3037 3000 3031 3532 3137 0020 3500 0000  070.015217. 5...
+0001ee60: 0000 0000 3030 3030 3735 3500 3030 3031  ....0000755.0001
+0001ee70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0001ee80: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
+0001ee90: 3030 3000 3031 3636 3233 0020 3500 0000  000.016623. 5...
 0001eea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001eeb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001eec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001eed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001eee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001eef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ef00: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+0001ef00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 0001ef10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ef20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+0001ef20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 0001ef30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ef40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001ef50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001ef40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0001ef50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 0001ef60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ef70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ef80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001ef90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001efa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001efb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001efc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -7939,39 +7939,39 @@
 0001f020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 0001f070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
 0001f080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-0001f090: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+0001f090: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 0001f0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 0001f110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0001f150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 0001f160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f200: 3232 206d 7469 6d65 3d31 3636 3036 3739  22 mtime=1660679
-0001f210: 3733 352e 300a 0000 0000 0000 0000 0000  735.0...........
+0001f200: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+0001f210: 3938 322e 300a 0000 0000 0000 0000 0000  982.0...........
 0001f220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -7994,50 +7994,50 @@
 0001f390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f400: 6c6f 636f 7079 2d30 2e35 2e30 2f6c 6f63  locopy-0.5.0/loc
+0001f400: 6c6f 636f 7079 2d30 2e35 2e31 2f6c 6f63  locopy-0.5.1/loc
 0001f410: 6f70 792e 6567 672d 696e 666f 2f50 4b47  opy.egg-info/PKG
 0001f420: 2d49 4e46 4f00 0000 0000 0000 0000 0000  -INFO...........
 0001f430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f460: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-0001f470: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-0001f480: 3030 3133 3333 3600 3134 3237 3637 3733  0013336.14276773
-0001f490: 3036 3700 3031 3633 3330 0020 3000 0000  067.016330. 0...
+0001f460: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+0001f470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0001f480: 3030 3133 3333 3600 3030 3030 3030 3030  0013336.00000000
+0001f490: 3030 3000 3031 3737 3236 0020 3000 0000  000.017726. 0...
 0001f4a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f4b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f4c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f4d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f4e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f4f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f500: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+0001f500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 0001f510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f520: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+0001f520: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 0001f530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-0001f550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0001f540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0001f550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 0001f560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 0001f600: 4d65 7461 6461 7461 2d56 6572 7369 6f6e  Metadata-Version
 0001f610: 3a20 322e 310a 4e61 6d65 3a20 6c6f 636f  : 2.1.Name: loco
 0001f620: 7079 0a56 6572 7369 6f6e 3a20 302e 352e  py.Version: 0.5.
-0001f630: 300a 5375 6d6d 6172 793a 204c 6f61 6469  0.Summary: Loadi
+0001f630: 310a 5375 6d6d 6172 793a 204c 6f61 6469  1.Summary: Loadi
 0001f640: 6e67 2f55 6e6c 6f61 6469 6e67 2074 6f20  ng/Unloading to 
 0001f650: 416d 617a 6f6e 2052 6564 7368 6966 7420  Amazon Redshift 
 0001f660: 7573 696e 6720 5079 7468 6f6e 0a48 6f6d  using Python.Hom
 0001f670: 652d 7061 6765 3a20 6874 7470 733a 2f2f  e-page: https://
 0001f680: 6769 7468 7562 2e63 6f6d 2f63 6170 6974  github.com/capit
 0001f690: 616c 6f6e 652f 6c6f 636f 7079 0a41 7574  alone/locopy.Aut
 0001f6a0: 686f 723a 2046 6169 7361 6c20 446f 7361  hor: Faisal Dosa
@@ -8419,39 +8419,39 @@
 00020e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
 00020e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
 00020e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00020e90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00020e90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 00020ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00020f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00020f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00020f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00020f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00020f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00020ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021000: 3232 206d 7469 6d65 3d31 3636 3036 3739  22 mtime=1660679
-00021010: 3733 352e 300a 0000 0000 0000 0000 0000  735.0...........
+00021000: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+00021010: 3938 322e 300a 0000 0000 0000 0000 0000  982.0...........
 00021020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -8474,36 +8474,36 @@
 00021190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000211a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000211b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000211c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000211d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000211e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000211f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021200: 6c6f 636f 7079 2d30 2e35 2e30 2f6c 6f63  locopy-0.5.0/loc
+00021200: 6c6f 636f 7079 2d30 2e35 2e31 2f6c 6f63  locopy-0.5.1/loc
 00021210: 6f70 792e 6567 672d 696e 666f 2f53 4f55  opy.egg-info/SOU
 00021220: 5243 4553 2e74 7874 0000 0000 0000 0000  RCES.txt........
 00021230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021260: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00021270: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00021280: 3030 3030 3632 3500 3134 3237 3637 3733  0000625.14276773
-00021290: 3036 3700 3031 3731 3134 0020 3000 0000  067.017114. 0...
+00021260: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00021270: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00021280: 3030 3031 3037 3100 3030 3030 3030 3030  0001071.00000000
+00021290: 3030 3000 3032 3035 3036 0020 3000 0000  000.020506. 0...
 000212a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000212b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000212c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000212d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000212e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000212f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021300: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+00021300: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00021310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021320: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00021320: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00021330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00021350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00021360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000213a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000213b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000213c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -8531,38 +8531,38 @@
 00021520: 6567 672d 696e 666f 2f64 6570 656e 6465  egg-info/depende
 00021530: 6e63 795f 6c69 6e6b 732e 7478 740a 6c6f  ncy_links.txt.lo
 00021540: 636f 7079 2e65 6767 2d69 6e66 6f2f 6e6f  copy.egg-info/no
 00021550: 742d 7a69 702d 7361 6665 0a6c 6f63 6f70  t-zip-safe.locop
 00021560: 792e 6567 672d 696e 666f 2f72 6571 7569  y.egg-info/requi
 00021570: 7265 732e 7478 740a 6c6f 636f 7079 2e65  res.txt.locopy.e
 00021580: 6767 2d69 6e66 6f2f 746f 705f 6c65 7665  gg-info/top_leve
-00021590: 6c2e 7478 7400 0000 0000 0000 0000 0000  l.txt...........
-000215a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000215b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000215c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000215d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000215e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000215f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00021610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021590: 6c2e 7478 740a 7465 7374 732f 7465 7374  l.txt.tests/test
+000215a0: 5f64 6174 6162 6173 652e 7079 0a74 6573  _database.py.tes
+000215b0: 7473 2f74 6573 745f 696e 7465 6772 6174  ts/test_integrat
+000215c0: 696f 6e2e 7079 0a74 6573 7473 2f74 6573  ion.py.tests/tes
+000215d0: 745f 696e 7465 6772 6174 696f 6e5f 7366  t_integration_sf
+000215e0: 2e70 790a 7465 7374 732f 7465 7374 5f72  .py.tests/test_r
+000215f0: 6564 7368 6966 742e 7079 0a74 6573 7473  edshift.py.tests
+00021600: 2f74 6573 745f 7333 2e70 790a 7465 7374  /test_s3.py.test
+00021610: 732f 7465 7374 5f73 6e6f 7766 6c61 6b65  s/test_snowflake
+00021620: 2e70 790a 7465 7374 732f 7465 7374 5f75  .py.tests/test_u
+00021630: 7469 6c69 7479 2e70 7900 0000 0000 0000  tility.py.......
 00021640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00021670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00021680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00021690: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00021660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000216a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000216b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000216c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000216d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000216e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000216f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00021700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -8570,127 +8570,127 @@
 00021790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000217a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000217b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000217c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000217d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000217e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000217f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021800: 3232 206d 7469 6d65 3d31 3636 3036 3739  22 mtime=1660679
-00021810: 3733 352e 300a 0000 0000 0000 0000 0000  735.0...........
+00021800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00021810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00021870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00021880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00021890: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 000218a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000218b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000218c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000218d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000218e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000218f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00021910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00021950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00021960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000219a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000219b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000219c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000219d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000219e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000219f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021a00: 6c6f 636f 7079 2d30 2e35 2e30 2f6c 6f63  locopy-0.5.0/loc
-00021a10: 6f70 792e 6567 672d 696e 666f 2f64 6570  opy.egg-info/dep
-00021a20: 656e 6465 6e63 795f 6c69 6e6b 732e 7478  endency_links.tx
-00021a30: 7400 0000 0000 0000 0000 0000 0000 0000  t...............
+00021a00: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+00021a10: 3938 322e 300a 0000 0000 0000 0000 0000  982.0...........
+00021a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021a60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00021a70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00021a80: 3030 3030 3030 3100 3134 3237 3637 3733  0000001.14276773
-00021a90: 3036 3700 3032 3132 3733 0020 3000 0000  067.021273. 0...
+00021a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b00: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+00021b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021b20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00021b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021c00: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
-00021c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021c00: 6c6f 636f 7079 2d30 2e35 2e31 2f6c 6f63  locopy-0.5.1/loc
+00021c10: 6f70 792e 6567 672d 696e 666f 2f64 6570  opy.egg-info/dep
+00021c20: 656e 6465 6e63 795f 6c69 6e6b 732e 7478  endency_links.tx
+00021c30: 7400 0000 0000 0000 0000 0000 0000 0000  t...............
 00021c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021c60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00021c70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00021c80: 3030 3030 3030 3100 3030 3030 3030 3030  0000001.00000000
+00021c90: 3030 3000 3032 3236 3731 0020 3000 0000  000.022671. 0...
 00021ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021d00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00021d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021d20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00021d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021d40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00021d50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00021d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00021e00: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
 00021e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00021e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00021e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00021e90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00021e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00021e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00021f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00021f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -8698,127 +8698,127 @@
 00021f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00021ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022000: 3232 206d 7469 6d65 3d31 3636 3036 3739  22 mtime=1660679
-00022010: 3639 332e 300a 0000 0000 0000 0000 0000  693.0...........
+00022000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00022010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00022070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00022080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00022090: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 000220a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000220b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000220c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000220d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000220e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000220f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00022110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00022150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00022160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000221a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000221b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000221c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000221d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000221e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000221f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022200: 6c6f 636f 7079 2d30 2e35 2e30 2f6c 6f63  locopy-0.5.0/loc
-00022210: 6f70 792e 6567 672d 696e 666f 2f6e 6f74  opy.egg-info/not
-00022220: 2d7a 6970 2d73 6166 6500 0000 0000 0000  -zip-safe.......
+00022200: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+00022210: 3937 382e 300a 0000 0000 0000 0000 0000  978.0...........
+00022220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022260: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00022270: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00022280: 3030 3030 3030 3100 3134 3237 3637 3733  0000001.14276773
-00022290: 3031 3500 3031 3734 3434 0020 3000 0000  015.017444. 0...
+00022260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000222a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000222b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000222c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000222d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000222e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000222f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022300: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+00022300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022320: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00022320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000223a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000223b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000223c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000223d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000223e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000223f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022400: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
-00022410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022400: 6c6f 636f 7079 2d30 2e35 2e31 2f6c 6f63  locopy-0.5.1/loc
+00022410: 6f70 792e 6567 672d 696e 666f 2f6e 6f74  opy.egg-info/not
+00022420: 2d7a 6970 2d73 6166 6500 0000 0000 0000  -zip-safe.......
 00022430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022460: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00022470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00022480: 3030 3030 3030 3100 3030 3030 3030 3030  0000001.00000000
+00022490: 3030 3000 3032 3130 3531 0020 3000 0000  000.021051. 0...
 000224a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000224b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000224c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000224d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000224e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000224f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00022510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022520: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00022530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00022550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00022560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000225a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000225b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000225c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000225d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000225e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000225f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00022600: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
 00022610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00022670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00022680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00022690: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00022660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000226a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000226b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000226c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000226d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000226e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000226f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00022700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -8826,255 +8826,255 @@
 00022790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000227a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000227b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000227c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000227d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000227e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000227f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022800: 3232 206d 7469 6d65 3d31 3636 3036 3739  22 mtime=1660679
-00022810: 3733 352e 300a 0000 0000 0000 0000 0000  735.0...........
+00022800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00022810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00022870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00022880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00022890: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 000228a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000228b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000228c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000228d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000228e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000228f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00022910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00022950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00022960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000229a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000229b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000229c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000229d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000229e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000229f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022a00: 6c6f 636f 7079 2d30 2e35 2e30 2f6c 6f63  locopy-0.5.0/loc
-00022a10: 6f70 792e 6567 672d 696e 666f 2f72 6571  opy.egg-info/req
-00022a20: 7569 7265 732e 7478 7400 0000 0000 0000  uires.txt.......
+00022a00: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+00022a10: 3938 322e 300a 0000 0000 0000 0000 0000  982.0...........
+00022a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022a60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00022a70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00022a80: 3030 3030 3730 3600 3134 3237 3637 3733  0000706.14276773
-00022a90: 3036 3700 3031 3736 3330 0020 3000 0000  067.017630. 0...
+00022a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022b00: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+00022b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022b20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00022b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022c00: 626f 746f 333c 3d31 2e32 342e 3530 2c3e  boto3<=1.24.50,>
-00022c10: 3d31 2e39 2e39 320a 5079 5941 4d4c 3c3d  =1.9.92.PyYAML<=
-00022c20: 362e 302c 3e3d 352e 310a 7061 6e64 6173  6.0,>=5.1.pandas
-00022c30: 3c3d 312e 342e 332c 3e3d 302e 3235 2e32  <=1.4.3,>=0.25.2
-00022c40: 0a6e 756d 7079 3c3d 312e 3233 2e31 2c3e  .numpy<=1.23.1,>
-00022c50: 3d31 2e32 322e 300a 0a5b 6275 696c 645d  =1.22.0..[build]
-00022c60: 0a74 7769 6e65 0a77 6865 656c 0a0a 5b64  .twine.wheel..[d
-00022c70: 6576 5d0a 6879 706f 7468 6573 6973 0a70  ev].hypothesis.p
-00022c80: 7974 6573 740a 7079 7465 7374 2d63 6f76  ytest.pytest-cov
-00022c90: 0a73 7068 696e 780a 7370 6869 6e78 5f72  .sphinx.sphinx_r
-00022ca0: 7464 5f74 6865 6d65 0a70 7265 2d63 6f6d  td_theme.pre-com
-00022cb0: 6d69 740a 626c 6163 6b0a 6973 6f72 740a  mit.black.isort.
-00022cc0: 7477 696e 650a 7768 6565 6c0a 0a5b 646f  twine.wheel..[do
-00022cd0: 6373 5d0a 7370 6869 6e78 0a73 7068 696e  cs].sphinx.sphin
-00022ce0: 785f 7274 645f 7468 656d 650a 0a5b 6564  x_rtd_theme..[ed
-00022cf0: 6765 7465 7374 5d0a 6564 6765 7465 7374  getest].edgetest
-00022d00: 0a65 6467 6574 6573 742d 636f 6e64 610a  .edgetest-conda.
-00022d10: 0a5b 7067 3830 3030 5d0a 7067 3830 3030  .[pg8000].pg8000
-00022d20: 3e3d 312e 3133 2e31 0a0a 5b70 7379 636f  >=1.13.1..[psyco
-00022d30: 7067 325d 0a70 7379 636f 7067 322d 6269  pg2].psycopg2-bi
-00022d40: 6e61 7279 3e3d 322e 372e 370a 0a5b 7161  nary>=2.7.7..[qa
-00022d50: 5d0a 7072 652d 636f 6d6d 6974 0a62 6c61  ].pre-commit.bla
-00022d60: 636b 0a69 736f 7274 0a0a 5b73 6e6f 7766  ck.isort..[snowf
-00022d70: 6c61 6b65 5d0a 736e 6f77 666c 616b 652d  lake].snowflake-
-00022d80: 636f 6e6e 6563 746f 722d 7079 7468 6f6e  connector-python
-00022d90: 5b70 616e 6461 735d 3e3d 322e 312e 320a  [pandas]>=2.1.2.
-00022da0: 0a5b 7465 7374 735d 0a68 7970 6f74 6865  .[tests].hypothe
-00022db0: 7369 730a 7079 7465 7374 0a70 7974 6573  sis.pytest.pytes
-00022dc0: 742d 636f 760a 0000 0000 0000 0000 0000  t-cov...........
+00022c00: 6c6f 636f 7079 2d30 2e35 2e31 2f6c 6f63  locopy-0.5.1/loc
+00022c10: 6f70 792e 6567 672d 696e 666f 2f72 6571  opy.egg-info/req
+00022c20: 7569 7265 732e 7478 7400 0000 0000 0000  uires.txt.......
+00022c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022c60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00022c70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00022c80: 3030 3030 3732 3300 3030 3030 3030 3030  0000723.00000000
+00022c90: 3030 3000 3032 3132 3235 0020 3000 0000  000.021225. 0...
+00022ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022d00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00022d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022d20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00022d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022d40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00022d50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00022d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00022e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00022e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00022e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00022e90: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-00022ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00022f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00022fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00022e00: 626f 746f 333c 3d31 2e32 362e 3130 382c  boto3<=1.26.108,
+00022e10: 3e3d 312e 392e 3932 0a50 7959 414d 4c3c  >=1.9.92.PyYAML<
+00022e20: 3d36 2e30 2c3e 3d35 2e31 0a70 616e 6461  =6.0,>=5.1.panda
+00022e30: 733c 3d32 2e30 2e30 2c3e 3d30 2e32 352e  s<=2.0.0,>=0.25.
+00022e40: 320a 6e75 6d70 793c 3d31 2e32 342e 322c  2.numpy<=1.24.2,
+00022e50: 3e3d 312e 3232 2e30 0a0a 5b62 7569 6c64  >=1.22.0..[build
+00022e60: 5d0a 6275 696c 640a 7477 696e 650a 7768  ].build.twine.wh
+00022e70: 6565 6c0a 0a5b 6465 765d 0a68 7970 6f74  eel..[dev].hypot
+00022e80: 6865 7369 730a 7079 7465 7374 0a70 7974  hesis.pytest.pyt
+00022e90: 6573 742d 636f 760a 7370 6869 6e78 0a73  est-cov.sphinx.s
+00022ea0: 7068 696e 785f 7274 645f 7468 656d 650a  phinx_rtd_theme.
+00022eb0: 7072 652d 636f 6d6d 6974 0a62 6c61 636b  pre-commit.black
+00022ec0: 0a69 736f 7274 0a62 7569 6c64 0a74 7769  .isort.build.twi
+00022ed0: 6e65 0a77 6865 656c 0a0a 5b64 6f63 735d  ne.wheel..[docs]
+00022ee0: 0a73 7068 696e 780a 7370 6869 6e78 5f72  .sphinx.sphinx_r
+00022ef0: 7464 5f74 6865 6d65 0a0a 5b65 6467 6574  td_theme..[edget
+00022f00: 6573 745d 0a65 6467 6574 6573 740a 6564  est].edgetest.ed
+00022f10: 6765 7465 7374 2d63 6f6e 6461 0a0a 5b70  getest-conda..[p
+00022f20: 6738 3030 305d 0a70 6738 3030 303e 3d31  g8000].pg8000>=1
+00022f30: 2e31 332e 310a 0a5b 7073 7963 6f70 6732  .13.1..[psycopg2
+00022f40: 5d0a 7073 7963 6f70 6732 2d62 696e 6172  ].psycopg2-binar
+00022f50: 793e 3d32 2e37 2e37 0a0a 5b71 615d 0a70  y>=2.7.7..[qa].p
+00022f60: 7265 2d63 6f6d 6d69 740a 626c 6163 6b0a  re-commit.black.
+00022f70: 6973 6f72 740a 0a5b 736e 6f77 666c 616b  isort..[snowflak
+00022f80: 655d 0a73 6e6f 7766 6c61 6b65 2d63 6f6e  e].snowflake-con
+00022f90: 6e65 6374 6f72 2d70 7974 686f 6e5b 7061  nector-python[pa
+00022fa0: 6e64 6173 5d3e 3d32 2e31 2e32 0a0a 5b74  ndas]>=2.1.2..[t
+00022fb0: 6573 7473 5d0a 6879 706f 7468 6573 6973  ests].hypothesis
+00022fc0: 0a70 7974 6573 740a 7079 7465 7374 2d63  .pytest.pytest-c
+00022fd0: 6f76 0a00 0000 0000 0000 0000 0000 0000  ov..............
 00022fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00022ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023000: 3232 206d 7469 6d65 3d31 3636 3036 3739  22 mtime=1660679
-00023010: 3733 352e 300a 0000 0000 0000 0000 0000  735.0...........
+00023000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00023010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00023070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00023080: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00023090: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 000230a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000230b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000230c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000230d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000230e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000230f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00023110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00023150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00023160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000231a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000231b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000231c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000231d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000231e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000231f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023200: 6c6f 636f 7079 2d30 2e35 2e30 2f6c 6f63  locopy-0.5.0/loc
-00023210: 6f70 792e 6567 672d 696e 666f 2f74 6f70  opy.egg-info/top
-00023220: 5f6c 6576 656c 2e74 7874 0000 0000 0000  _level.txt......
+00023200: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+00023210: 3938 322e 300a 0000 0000 0000 0000 0000  982.0...........
+00023220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023260: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00023270: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00023280: 3030 3030 3030 3700 3134 3237 3637 3733  0000007.14276773
-00023290: 3036 3700 3031 3737 3534 0020 3000 0000  067.017754. 0...
+00023260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000232a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000232b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000232c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000232d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000232e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000232f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023300: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+00023300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023320: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00023320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000233a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000233b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000233c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000233d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000233e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000233f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023400: 6c6f 636f 7079 0a00 0000 0000 0000 0000  locopy..........
-00023410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023400: 6c6f 636f 7079 2d30 2e35 2e31 2f6c 6f63  locopy-0.5.1/loc
+00023410: 6f70 792e 6567 672d 696e 666f 2f74 6f70  opy.egg-info/top
+00023420: 5f6c 6576 656c 2e74 7874 0000 0000 0000  _level.txt......
 00023430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023460: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00023470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00023480: 3030 3030 3030 3700 3030 3030 3030 3030  0000007.00000000
+00023490: 3030 3000 3032 3133 3532 0020 3000 0000  000.021352. 0...
 000234a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000234b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000234c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000234d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000234e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000234f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00023510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023520: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00023530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00023550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00023560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000235f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00023600: 6c6f 636f 7079 0a00 0000 0000 0000 0000  locopy..........
 00023610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00023670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00023680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00023690: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
+00023660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000236a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000236b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000236c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000236d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000236e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000236f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00023700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -9082,127 +9082,127 @@
 00023790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000237f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023800: 3232 206d 7469 6d65 3d31 3636 3036 3739  22 mtime=1660679
-00023810: 3631 312e 300a 0000 0000 0000 0000 0000  611.0...........
+00023800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00023810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00023870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00023880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00023890: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 000238a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000238b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000238c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000238d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000238e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000238f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00023910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00023950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00023960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000239a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000239b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000239c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000239d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000239e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000239f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023a00: 6c6f 636f 7079 2d30 2e35 2e30 2f72 6571  locopy-0.5.0/req
-00023a10: 7569 7265 6d65 6e74 732e 7478 7400 0000  uirements.txt...
+00023a00: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+00023a10: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
 00023a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023a60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00023a70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00023a80: 3030 3030 3132 3700 3134 3237 3637 3732  0000127.14276772
-00023a90: 3637 3300 3031 3535 3134 0020 3000 0000  673.015514. 0...
+00023a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023b00: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+00023b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023b20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00023b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023c00: 626f 746f 333c 3d31 2e32 342e 3530 2c3e  boto3<=1.24.50,>
-00023c10: 3d31 2e39 2e39 320a 5079 5941 4d4c 3c3d  =1.9.92.PyYAML<=
-00023c20: 362e 302c 3e3d 352e 310a 7061 6e64 6173  6.0,>=5.1.pandas
-00023c30: 3c3d 312e 342e 332c 3e3d 302e 3235 2e32  <=1.4.3,>=0.25.2
-00023c40: 0a6e 756d 7079 3c3d 312e 3233 2e31 2c3e  .numpy<=1.23.1,>
-00023c50: 3d31 2e32 322e 3000 0000 0000 0000 0000  =1.22.0.........
-00023c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023c00: 6c6f 636f 7079 2d30 2e35 2e31 2f72 6571  locopy-0.5.1/req
+00023c10: 7569 7265 6d65 6e74 732e 7478 7400 0000  uirements.txt...
+00023c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023c60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00023c70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00023c80: 3030 3030 3133 3000 3030 3030 3030 3030  0000130.00000000
+00023c90: 3030 3000 3031 3731 3032 0020 3000 0000  000.017102. 0...
 00023ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023d00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00023d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023d20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00023d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023d40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00023d50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00023d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00023e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00023e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00023e80: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
-00023e90: 3030 3000 3031 3032 3132 0020 7800 0000  000.010212. x...
+00023e00: 626f 746f 333c 3d31 2e32 362e 3130 382c  boto3<=1.26.108,
+00023e10: 3e3d 312e 392e 3932 0a50 7959 414d 4c3c  >=1.9.92.PyYAML<
+00023e20: 3d36 2e30 2c3e 3d35 2e31 0a70 616e 6461  =6.0,>=5.1.panda
+00023e30: 733c 3d32 2e30 2e30 2c3e 3d30 2e32 352e  s<=2.0.0,>=0.25.
+00023e40: 320a 6e75 6d70 793c 3d31 2e32 342e 322c  2.numpy<=1.24.2,
+00023e50: 3e3d 312e 3232 2e30 0000 0000 0000 0000  >=1.22.0........
+00023e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00023e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00023f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00023f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -9210,375 +9210,375 @@
 00023f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00023ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024000: 3238 206d 7469 6d65 3d31 3636 3036 3739  28 mtime=1660679
-00024010: 3733 352e 3939 3232 3335 340a 0000 0000  735.9922354.....
+00024000: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00024010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024060: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00024070: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00024080: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00024090: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
 000240a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000240b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000240c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000240d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000240e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000240f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024100: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00024110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024140: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00024150: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00024160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000241a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000241b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000241c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000241d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000241e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000241f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024200: 6c6f 636f 7079 2d30 2e35 2e30 2f73 6574  locopy-0.5.0/set
-00024210: 7570 2e63 6667 0000 0000 0000 0000 0000  up.cfg..........
+00024200: 3238 206d 7469 6d65 3d31 3638 3134 3134  28 mtime=1681414
+00024210: 3938 322e 3937 3839 3434 350a 0000 0000  982.9789445.....
 00024220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024260: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00024270: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00024280: 3030 3030 3535 3600 3134 3237 3637 3733  0000556.14276773
-00024290: 3037 3000 3031 3430 3437 0020 3000 0000  070.014047. 0...
+00024260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000242a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000242b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000242c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000242d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000242e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000242f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024300: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+00024300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024320: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00024320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000243a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000243b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000243c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000243d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000243e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000243f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024400: 5b69 736f 7274 5d0a 6d75 6c74 695f 6c69  [isort].multi_li
-00024410: 6e65 5f6f 7574 7075 7420 3d20 330a 696e  ne_output = 3.in
-00024420: 636c 7564 655f 7472 6169 6c69 6e67 5f63  clude_trailing_c
-00024430: 6f6d 6d61 203d 2054 7275 650a 666f 7263  omma = True.forc
-00024440: 655f 6772 6964 5f77 7261 7020 3d20 300a  e_grid_wrap = 0.
-00024450: 7573 655f 7061 7265 6e74 6865 7365 7320  use_parentheses 
-00024460: 3d20 5472 7565 0a6c 696e 655f 6c65 6e67  = True.line_leng
-00024470: 7468 203d 2038 380a 0a5b 6f70 7469 6f6e  th = 88..[option
-00024480: 735d 0a69 6e73 7461 6c6c 5f72 6571 7569  s].install_requi
-00024490: 7265 7320 3d20 0a0a 5b65 6467 6574 6573  res = ..[edgetes
-000244a0: 742e 656e 7673 2e63 6f72 655d 0a70 7974  t.envs.core].pyt
-000244b0: 686f 6e5f 7665 7273 696f 6e20 3d20 332e  hon_version = 3.
-000244c0: 390a 6578 7472 6173 203d 200a 0974 6573  9.extras = ..tes
-000244d0: 7473 0a09 7073 7963 6f70 6732 0a09 7067  ts..psycopg2..pg
-000244e0: 3830 3030 0a09 736e 6f77 666c 616b 650a  8000..snowflake.
-000244f0: 636f 6d6d 616e 6420 3d20 0a09 7079 7465  command = ..pyte
-00024500: 7374 2074 6573 7473 202d 6d20 276e 6f74  st tests -m 'not
-00024510: 2069 6e74 6567 7261 7469 6f6e 270a 7570   integration'.up
-00024520: 6772 6164 6520 3d20 0a09 626f 746f 330a  grade = ..boto3.
-00024530: 0950 7959 414d 4c0a 0970 616e 6461 730a  .PyYAML..pandas.
-00024540: 096e 756d 7079 0a0a 5b65 6767 5f69 6e66  .numpy..[egg_inf
-00024550: 6f5d 0a74 6167 5f62 7569 6c64 203d 200a  o].tag_build = .
-00024560: 7461 675f 6461 7465 203d 2030 0a0a 0000  tag_date = 0....
+00024400: 6c6f 636f 7079 2d30 2e35 2e31 2f73 6574  locopy-0.5.1/set
+00024410: 7570 2e63 6667 0000 0000 0000 0000 0000  up.cfg..........
+00024420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024460: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00024470: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00024480: 3030 3030 3535 3600 3030 3030 3030 3030  0000556.00000000
+00024490: 3030 3000 3031 3534 3533 0020 3000 0000  000.015453. 0...
+000244a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000244b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000244c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000244d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000244e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000244f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024500: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00024510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024520: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00024530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00024550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00024560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000245a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000245b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000245c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000245d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000245e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000245f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
-00024610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
-00024670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
-00024680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
-00024690: 3030 3000 3031 3032 3133 0020 7800 0000  000.010213. x...
-000246a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000246b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000246c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000246d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000246e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000246f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
-00024710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024600: 5b69 736f 7274 5d0a 6d75 6c74 695f 6c69  [isort].multi_li
+00024610: 6e65 5f6f 7574 7075 7420 3d20 330a 696e  ne_output = 3.in
+00024620: 636c 7564 655f 7472 6169 6c69 6e67 5f63  clude_trailing_c
+00024630: 6f6d 6d61 203d 2054 7275 650a 666f 7263  omma = True.forc
+00024640: 655f 6772 6964 5f77 7261 7020 3d20 300a  e_grid_wrap = 0.
+00024650: 7573 655f 7061 7265 6e74 6865 7365 7320  use_parentheses 
+00024660: 3d20 5472 7565 0a6c 696e 655f 6c65 6e67  = True.line_leng
+00024670: 7468 203d 2038 380a 0a5b 6f70 7469 6f6e  th = 88..[option
+00024680: 735d 0a69 6e73 7461 6c6c 5f72 6571 7569  s].install_requi
+00024690: 7265 7320 3d20 0a0a 5b65 6467 6574 6573  res = ..[edgetes
+000246a0: 742e 656e 7673 2e63 6f72 655d 0a70 7974  t.envs.core].pyt
+000246b0: 686f 6e5f 7665 7273 696f 6e20 3d20 332e  hon_version = 3.
+000246c0: 390a 6578 7472 6173 203d 200a 0974 6573  9.extras = ..tes
+000246d0: 7473 0a09 7073 7963 6f70 6732 0a09 7067  ts..psycopg2..pg
+000246e0: 3830 3030 0a09 736e 6f77 666c 616b 650a  8000..snowflake.
+000246f0: 636f 6d6d 616e 6420 3d20 0a09 7079 7465  command = ..pyte
+00024700: 7374 2074 6573 7473 202d 6d20 276e 6f74  st tests -m 'not
+00024710: 2069 6e74 6567 7261 7469 6f6e 270a 7570   integration'.up
+00024720: 6772 6164 6520 3d20 0a09 626f 746f 330a  grade = ..boto3.
+00024730: 0950 7959 414d 4c0a 0970 616e 6461 730a  .PyYAML..pandas.
+00024740: 096e 756d 7079 0a0a 5b65 6767 5f69 6e66  .numpy..[egg_inf
+00024750: 6f5d 0a74 6167 5f62 7569 6c64 203d 200a  o].tag_build = .
+00024760: 7461 675f 6461 7465 203d 2030 0a0a 0000  tag_date = 0....
 00024770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000247a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000247b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000247c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000247d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000247e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000247f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024800: 3232 206d 7469 6d65 3d31 3636 3036 3739  22 mtime=1660679
-00024810: 3631 312e 300a 0000 0000 0000 0000 0000  611.0...........
+00024800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00024810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00024870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00024880: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00024890: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 000248a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000248b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000248c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000248d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000248e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000248f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00024910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00024950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00024960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000249a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000249b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000249c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000249d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000249e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000249f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024a00: 6c6f 636f 7079 2d30 2e35 2e30 2f73 6574  locopy-0.5.0/set
-00024a10: 7570 2e70 7900 0000 0000 0000 0000 0000  up.py...........
+00024a00: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+00024a10: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
 00024a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024a60: 0000 0000 3030 3030 3634 3400 3030 3030  ....0000644.0000
-00024a70: 3736 3500 3030 3030 3032 3400 3030 3030  765.0000024.0000
-00024a80: 3030 3034 3230 3200 3134 3237 3637 3732  0004202.14276772
-00024a90: 3637 3300 3031 3337 3430 0020 3000 0000  673.013740. 0...
+00024a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024b00: 0075 7374 6172 0030 3066 6169 7361 6c00  .ustar.00faisal.
+00024b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024b20: 0000 0000 0000 0000 0073 7461 6666 0000  .........staff..
+00024b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00024bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00024c00: 2320 5350 4458 2d43 6f70 7972 6967 6874  # SPDX-Copyright
-00024c10: 3a20 436f 7079 7269 6768 7420 2863 2920  : Copyright (c) 
-00024c20: 4361 7069 7461 6c20 4f6e 6520 5365 7276  Capital One Serv
-00024c30: 6963 6573 2c20 4c4c 430a 2320 5350 4458  ices, LLC.# SPDX
-00024c40: 2d4c 6963 656e 7365 2d49 6465 6e74 6966  -License-Identif
-00024c50: 6965 723a 2041 7061 6368 652d 322e 300a  ier: Apache-2.0.
-00024c60: 2320 436f 7079 7269 6768 7420 3230 3138  # Copyright 2018
-00024c70: 2043 6170 6974 616c 204f 6e65 2053 6572   Capital One Ser
-00024c80: 7669 6365 732c 204c 4c43 0a23 0a23 204c  vices, LLC.#.# L
-00024c90: 6963 656e 7365 6420 756e 6465 7220 7468  icensed under th
-00024ca0: 6520 4170 6163 6865 204c 6963 656e 7365  e Apache License
-00024cb0: 2c20 5665 7273 696f 6e20 322e 3020 2874  , Version 2.0 (t
-00024cc0: 6865 2022 4c69 6365 6e73 6522 293b 0a23  he "License");.#
-00024cd0: 2079 6f75 206d 6179 206e 6f74 2075 7365   you may not use
-00024ce0: 2074 6869 7320 6669 6c65 2065 7863 6570   this file excep
-00024cf0: 7420 696e 2063 6f6d 706c 6961 6e63 6520  t in compliance 
-00024d00: 7769 7468 2074 6865 204c 6963 656e 7365  with the License
-00024d10: 2e0a 2320 596f 7520 6d61 7920 6f62 7461  ..# You may obta
-00024d20: 696e 2061 2063 6f70 7920 6f66 2074 6865  in a copy of the
-00024d30: 204c 6963 656e 7365 2061 740a 230a 2320   License at.#.# 
-00024d40: 2020 2020 6874 7470 3a2f 2f77 7777 2e61      http://www.a
-00024d50: 7061 6368 652e 6f72 672f 6c69 6365 6e73  pache.org/licens
-00024d60: 6573 2f4c 4943 454e 5345 2d32 2e30 0a23  es/LICENSE-2.0.#
-00024d70: 0a23 2055 6e6c 6573 7320 7265 7175 6972  .# Unless requir
-00024d80: 6564 2062 7920 6170 706c 6963 6162 6c65  ed by applicable
-00024d90: 206c 6177 206f 7220 6167 7265 6564 2074   law or agreed t
-00024da0: 6f20 696e 2077 7269 7469 6e67 2c20 736f  o in writing, so
-00024db0: 6674 7761 7265 0a23 2064 6973 7472 6962  ftware.# distrib
-00024dc0: 7574 6564 2075 6e64 6572 2074 6865 204c  uted under the L
-00024dd0: 6963 656e 7365 2069 7320 6469 7374 7269  icense is distri
-00024de0: 6275 7465 6420 6f6e 2061 6e20 2241 5320  buted on an "AS 
-00024df0: 4953 2220 4241 5349 532c 0a23 2057 4954  IS" BASIS,.# WIT
-00024e00: 484f 5554 2057 4152 5241 4e54 4945 5320  HOUT WARRANTIES 
-00024e10: 4f52 2043 4f4e 4449 5449 4f4e 5320 4f46  OR CONDITIONS OF
-00024e20: 2041 4e59 204b 494e 442c 2065 6974 6865   ANY KIND, eithe
-00024e30: 7220 6578 7072 6573 7320 6f72 2069 6d70  r express or imp
-00024e40: 6c69 6564 2e0a 2320 5365 6520 7468 6520  lied..# See the 
-00024e50: 4c69 6365 6e73 6520 666f 7220 7468 6520  License for the 
-00024e60: 7370 6563 6966 6963 206c 616e 6775 6167  specific languag
-00024e70: 6520 676f 7665 726e 696e 6720 7065 726d  e governing perm
-00024e80: 6973 7369 6f6e 7320 616e 640a 2320 6c69  issions and.# li
-00024e90: 6d69 7461 7469 6f6e 7320 756e 6465 7220  mitations under 
-00024ea0: 7468 6520 4c69 6365 6e73 652e 0a0a 696d  the License...im
-00024eb0: 706f 7274 206f 730a 0a66 726f 6d20 7365  port os..from se
-00024ec0: 7475 7074 6f6f 6c73 2069 6d70 6f72 7420  tuptools import 
-00024ed0: 7365 7475 700a 0a43 5552 525f 4449 5220  setup..CURR_DIR 
-00024ee0: 3d20 6f73 2e70 6174 682e 6162 7370 6174  = os.path.abspat
-00024ef0: 6828 6f73 2e70 6174 682e 6469 726e 616d  h(os.path.dirnam
-00024f00: 6528 5f5f 6669 6c65 5f5f 2929 0a0a 7769  e(__file__))..wi
-00024f10: 7468 206f 7065 6e28 6f73 2e70 6174 682e  th open(os.path.
-00024f20: 6a6f 696e 2843 5552 525f 4449 522c 2022  join(CURR_DIR, "
-00024f30: 5245 4144 4d45 2e72 7374 2229 2c20 656e  README.rst"), en
-00024f40: 636f 6469 6e67 3d22 7574 662d 3822 2920  coding="utf-8") 
-00024f50: 6173 2066 696c 655f 6f70 656e 3a0a 2020  as file_open:.  
-00024f60: 2020 4c4f 4e47 5f44 4553 4352 4950 5449    LONG_DESCRIPTI
-00024f70: 4f4e 203d 2066 696c 655f 6f70 656e 2e72  ON = file_open.r
-00024f80: 6561 6428 290a 0a77 6974 6820 6f70 656e  ead()..with open
-00024f90: 286f 732e 7061 7468 2e6a 6f69 6e28 4355  (os.path.join(CU
-00024fa0: 5252 5f44 4952 2c20 2272 6571 7569 7265  RR_DIR, "require
-00024fb0: 6d65 6e74 732e 7478 7422 292c 2065 6e63  ments.txt"), enc
-00024fc0: 6f64 696e 673d 2275 7466 2d38 2229 2061  oding="utf-8") a
-00024fd0: 7320 6669 6c65 5f6f 7065 6e3a 0a20 2020  s file_open:.   
-00024fe0: 2049 4e53 5441 4c4c 5f52 4551 5549 5245   INSTALL_REQUIRE
-00024ff0: 5320 3d20 6669 6c65 5f6f 7065 6e2e 7265  S = file_open.re
-00025000: 6164 2829 2e73 706c 6974 2822 5c6e 2229  ad().split("\n")
-00025010: 0a0a 6578 6563 286f 7065 6e28 226c 6f63  ..exec(open("loc
-00025020: 6f70 792f 5f76 6572 7369 6f6e 2e70 7922  opy/_version.py"
-00025030: 292e 7265 6164 2829 290a 0a0a 2320 4e6f  ).read())...# No
-00025040: 2076 6572 7369 6f6e 696e 6720 6f6e 2065   versioning on e
-00025050: 7874 7261 7320 666f 7220 6465 762c 2061  xtras for dev, a
-00025060: 6c77 6179 7320 6772 6162 2074 6865 206c  lways grab the l
-00025070: 6174 6573 740a 4558 5452 4153 5f52 4551  atest.EXTRAS_REQ
-00025080: 5549 5245 203d 207b 0a20 2020 2022 7073  UIRE = {.    "ps
-00025090: 7963 6f70 6732 223a 205b 2270 7379 636f  ycopg2": ["psyco
-000250a0: 7067 322d 6269 6e61 7279 3e3d 322e 372e  pg2-binary>=2.7.
-000250b0: 3722 5d2c 0a20 2020 2022 7067 3830 3030  7"],.    "pg8000
-000250c0: 223a 205b 2270 6738 3030 303e 3d31 2e31  ": ["pg8000>=1.1
-000250d0: 332e 3122 5d2c 0a20 2020 2022 736e 6f77  3.1"],.    "snow
-000250e0: 666c 616b 6522 3a20 5b22 736e 6f77 666c  flake": ["snowfl
-000250f0: 616b 652d 636f 6e6e 6563 746f 722d 7079  ake-connector-py
-00025100: 7468 6f6e 5b70 616e 6461 735d 3e3d 322e  thon[pandas]>=2.
-00025110: 312e 3222 5d2c 0a20 2020 2022 646f 6373  1.2"],.    "docs
-00025120: 223a 205b 2273 7068 696e 7822 2c20 2273  ": ["sphinx", "s
-00025130: 7068 696e 785f 7274 645f 7468 656d 6522  phinx_rtd_theme"
-00025140: 5d2c 0a20 2020 2022 7465 7374 7322 3a20  ],.    "tests": 
-00025150: 5b0a 2020 2020 2020 2020 2268 7970 6f74  [.        "hypot
-00025160: 6865 7369 7322 2c0a 2020 2020 2020 2020  hesis",.        
-00025170: 2270 7974 6573 7422 2c0a 2020 2020 2020  "pytest",.      
-00025180: 2020 2270 7974 6573 742d 636f 7622 2c0a    "pytest-cov",.
-00025190: 2020 2020 5d2c 0a20 2020 2022 7161 223a      ],.    "qa":
-000251a0: 205b 0a20 2020 2020 2020 2022 7072 652d   [.        "pre-
-000251b0: 636f 6d6d 6974 222c 0a20 2020 2020 2020  commit",.       
-000251c0: 2022 626c 6163 6b22 2c0a 2020 2020 2020   "black",.      
-000251d0: 2020 2269 736f 7274 222c 0a20 2020 205d    "isort",.    ]
-000251e0: 2c0a 2020 2020 2262 7569 6c64 223a 205b  ,.    "build": [
-000251f0: 2274 7769 6e65 222c 2022 7768 6565 6c22  "twine", "wheel"
-00025200: 5d2c 0a20 2020 2022 6564 6765 7465 7374  ],.    "edgetest
-00025210: 223a 205b 2265 6467 6574 6573 7422 2c20  ": ["edgetest", 
-00025220: 2265 6467 6574 6573 742d 636f 6e64 6122  "edgetest-conda"
-00025230: 5d2c 0a7d 0a0a 4558 5452 4153 5f52 4551  ],.}..EXTRAS_REQ
-00025240: 5549 5245 5b22 6465 7622 5d20 3d20 280a  UIRE["dev"] = (.
-00025250: 2020 2020 4558 5452 4153 5f52 4551 5549      EXTRAS_REQUI
-00025260: 5245 5b22 7465 7374 7322 5d0a 2020 2020  RE["tests"].    
-00025270: 2b20 4558 5452 4153 5f52 4551 5549 5245  + EXTRAS_REQUIRE
-00025280: 5b22 646f 6373 225d 0a20 2020 202b 2045  ["docs"].    + E
-00025290: 5854 5241 535f 5245 5155 4952 455b 2271  XTRAS_REQUIRE["q
-000252a0: 6122 5d0a 2020 2020 2b20 4558 5452 4153  a"].    + EXTRAS
-000252b0: 5f52 4551 5549 5245 5b22 6275 696c 6422  _REQUIRE["build"
-000252c0: 5d0a 290a 0a0a 7365 7475 7028 0a20 2020  ].)...setup(.   
-000252d0: 206e 616d 653d 226c 6f63 6f70 7922 2c0a   name="locopy",.
-000252e0: 2020 2020 7665 7273 696f 6e3d 5f5f 7665      version=__ve
-000252f0: 7273 696f 6e5f 5f2c 0a20 2020 2064 6573  rsion__,.    des
-00025300: 6372 6970 7469 6f6e 3d22 4c6f 6164 696e  cription="Loadin
-00025310: 672f 556e 6c6f 6164 696e 6720 746f 2041  g/Unloading to A
-00025320: 6d61 7a6f 6e20 5265 6473 6869 6674 2075  mazon Redshift u
-00025330: 7369 6e67 2050 7974 686f 6e22 2c0a 2020  sing Python",.  
-00025340: 2020 6c6f 6e67 5f64 6573 6372 6970 7469    long_descripti
-00025350: 6f6e 3d4c 4f4e 475f 4445 5343 5249 5054  on=LONG_DESCRIPT
-00025360: 494f 4e2c 0a20 2020 2075 726c 3d22 6874  ION,.    url="ht
-00025370: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
-00025380: 2f63 6170 6974 616c 6f6e 652f 6c6f 636f  /capitalone/loco
-00025390: 7079 222c 0a20 2020 2061 7574 686f 723d  py",.    author=
-000253a0: 2246 6169 7361 6c20 446f 7361 6e69 222c  "Faisal Dosani",
-000253b0: 0a20 2020 2061 7574 686f 725f 656d 6169  .    author_emai
-000253c0: 6c3d 2266 6169 7361 6c2e 646f 7361 6e69  l="faisal.dosani
-000253d0: 4063 6170 6974 616c 6f6e 652e 636f 6d22  @capitalone.com"
-000253e0: 2c0a 2020 2020 6c69 6365 6e73 653d 2241  ,.    license="A
-000253f0: 7061 6368 6520 536f 6674 7761 7265 204c  pache Software L
-00025400: 6963 656e 7365 222c 0a20 2020 2070 6163  icense",.    pac
-00025410: 6b61 6765 733d 5b22 6c6f 636f 7079 225d  kages=["locopy"]
-00025420: 2c0a 2020 2020 696e 7374 616c 6c5f 7265  ,.    install_re
-00025430: 7175 6972 6573 3d49 4e53 5441 4c4c 5f52  quires=INSTALL_R
-00025440: 4551 5549 5245 532c 0a20 2020 2065 7874  EQUIRES,.    ext
-00025450: 7261 735f 7265 7175 6972 653d 4558 5452  ras_require=EXTR
-00025460: 4153 5f52 4551 5549 5245 2c0a 2020 2020  AS_REQUIRE,.    
-00025470: 7a69 705f 7361 6665 3d46 616c 7365 2c0a  zip_safe=False,.
-00025480: 290a 0000 0000 0000 0000 0000 0000 0000  )...............
-00025490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000254a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000254b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000254c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000254d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000254e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000254f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000255a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000255b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000255c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000255d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000255e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000255f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024c00: 6c6f 636f 7079 2d30 2e35 2e31 2f73 6574  locopy-0.5.1/set
+00024c10: 7570 2e70 7900 0000 0000 0000 0000 0000  up.py...........
+00024c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024c60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00024c70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00024c80: 3030 3034 3231 3300 3030 3030 3030 3030  0004213.00000000
+00024c90: 3030 3000 3031 3533 3336 0020 3000 0000  000.015336. 0...
+00024ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024d00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00024d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024d20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00024d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024d40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00024d50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00024d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00024e00: 2320 5350 4458 2d43 6f70 7972 6967 6874  # SPDX-Copyright
+00024e10: 3a20 436f 7079 7269 6768 7420 2863 2920  : Copyright (c) 
+00024e20: 4361 7069 7461 6c20 4f6e 6520 5365 7276  Capital One Serv
+00024e30: 6963 6573 2c20 4c4c 430a 2320 5350 4458  ices, LLC.# SPDX
+00024e40: 2d4c 6963 656e 7365 2d49 6465 6e74 6966  -License-Identif
+00024e50: 6965 723a 2041 7061 6368 652d 322e 300a  ier: Apache-2.0.
+00024e60: 2320 436f 7079 7269 6768 7420 3230 3138  # Copyright 2018
+00024e70: 2043 6170 6974 616c 204f 6e65 2053 6572   Capital One Ser
+00024e80: 7669 6365 732c 204c 4c43 0a23 0a23 204c  vices, LLC.#.# L
+00024e90: 6963 656e 7365 6420 756e 6465 7220 7468  icensed under th
+00024ea0: 6520 4170 6163 6865 204c 6963 656e 7365  e Apache License
+00024eb0: 2c20 5665 7273 696f 6e20 322e 3020 2874  , Version 2.0 (t
+00024ec0: 6865 2022 4c69 6365 6e73 6522 293b 0a23  he "License");.#
+00024ed0: 2079 6f75 206d 6179 206e 6f74 2075 7365   you may not use
+00024ee0: 2074 6869 7320 6669 6c65 2065 7863 6570   this file excep
+00024ef0: 7420 696e 2063 6f6d 706c 6961 6e63 6520  t in compliance 
+00024f00: 7769 7468 2074 6865 204c 6963 656e 7365  with the License
+00024f10: 2e0a 2320 596f 7520 6d61 7920 6f62 7461  ..# You may obta
+00024f20: 696e 2061 2063 6f70 7920 6f66 2074 6865  in a copy of the
+00024f30: 204c 6963 656e 7365 2061 740a 230a 2320   License at.#.# 
+00024f40: 2020 2020 6874 7470 3a2f 2f77 7777 2e61      http://www.a
+00024f50: 7061 6368 652e 6f72 672f 6c69 6365 6e73  pache.org/licens
+00024f60: 6573 2f4c 4943 454e 5345 2d32 2e30 0a23  es/LICENSE-2.0.#
+00024f70: 0a23 2055 6e6c 6573 7320 7265 7175 6972  .# Unless requir
+00024f80: 6564 2062 7920 6170 706c 6963 6162 6c65  ed by applicable
+00024f90: 206c 6177 206f 7220 6167 7265 6564 2074   law or agreed t
+00024fa0: 6f20 696e 2077 7269 7469 6e67 2c20 736f  o in writing, so
+00024fb0: 6674 7761 7265 0a23 2064 6973 7472 6962  ftware.# distrib
+00024fc0: 7574 6564 2075 6e64 6572 2074 6865 204c  uted under the L
+00024fd0: 6963 656e 7365 2069 7320 6469 7374 7269  icense is distri
+00024fe0: 6275 7465 6420 6f6e 2061 6e20 2241 5320  buted on an "AS 
+00024ff0: 4953 2220 4241 5349 532c 0a23 2057 4954  IS" BASIS,.# WIT
+00025000: 484f 5554 2057 4152 5241 4e54 4945 5320  HOUT WARRANTIES 
+00025010: 4f52 2043 4f4e 4449 5449 4f4e 5320 4f46  OR CONDITIONS OF
+00025020: 2041 4e59 204b 494e 442c 2065 6974 6865   ANY KIND, eithe
+00025030: 7220 6578 7072 6573 7320 6f72 2069 6d70  r express or imp
+00025040: 6c69 6564 2e0a 2320 5365 6520 7468 6520  lied..# See the 
+00025050: 4c69 6365 6e73 6520 666f 7220 7468 6520  License for the 
+00025060: 7370 6563 6966 6963 206c 616e 6775 6167  specific languag
+00025070: 6520 676f 7665 726e 696e 6720 7065 726d  e governing perm
+00025080: 6973 7369 6f6e 7320 616e 640a 2320 6c69  issions and.# li
+00025090: 6d69 7461 7469 6f6e 7320 756e 6465 7220  mitations under 
+000250a0: 7468 6520 4c69 6365 6e73 652e 0a0a 696d  the License...im
+000250b0: 706f 7274 206f 730a 0a66 726f 6d20 7365  port os..from se
+000250c0: 7475 7074 6f6f 6c73 2069 6d70 6f72 7420  tuptools import 
+000250d0: 7365 7475 700a 0a43 5552 525f 4449 5220  setup..CURR_DIR 
+000250e0: 3d20 6f73 2e70 6174 682e 6162 7370 6174  = os.path.abspat
+000250f0: 6828 6f73 2e70 6174 682e 6469 726e 616d  h(os.path.dirnam
+00025100: 6528 5f5f 6669 6c65 5f5f 2929 0a0a 7769  e(__file__))..wi
+00025110: 7468 206f 7065 6e28 6f73 2e70 6174 682e  th open(os.path.
+00025120: 6a6f 696e 2843 5552 525f 4449 522c 2022  join(CURR_DIR, "
+00025130: 5245 4144 4d45 2e72 7374 2229 2c20 656e  README.rst"), en
+00025140: 636f 6469 6e67 3d22 7574 662d 3822 2920  coding="utf-8") 
+00025150: 6173 2066 696c 655f 6f70 656e 3a0a 2020  as file_open:.  
+00025160: 2020 4c4f 4e47 5f44 4553 4352 4950 5449    LONG_DESCRIPTI
+00025170: 4f4e 203d 2066 696c 655f 6f70 656e 2e72  ON = file_open.r
+00025180: 6561 6428 290a 0a77 6974 6820 6f70 656e  ead()..with open
+00025190: 286f 732e 7061 7468 2e6a 6f69 6e28 4355  (os.path.join(CU
+000251a0: 5252 5f44 4952 2c20 2272 6571 7569 7265  RR_DIR, "require
+000251b0: 6d65 6e74 732e 7478 7422 292c 2065 6e63  ments.txt"), enc
+000251c0: 6f64 696e 673d 2275 7466 2d38 2229 2061  oding="utf-8") a
+000251d0: 7320 6669 6c65 5f6f 7065 6e3a 0a20 2020  s file_open:.   
+000251e0: 2049 4e53 5441 4c4c 5f52 4551 5549 5245   INSTALL_REQUIRE
+000251f0: 5320 3d20 6669 6c65 5f6f 7065 6e2e 7265  S = file_open.re
+00025200: 6164 2829 2e73 706c 6974 2822 5c6e 2229  ad().split("\n")
+00025210: 0a0a 6578 6563 286f 7065 6e28 226c 6f63  ..exec(open("loc
+00025220: 6f70 792f 5f76 6572 7369 6f6e 2e70 7922  opy/_version.py"
+00025230: 292e 7265 6164 2829 290a 0a0a 2320 4e6f  ).read())...# No
+00025240: 2076 6572 7369 6f6e 696e 6720 6f6e 2065   versioning on e
+00025250: 7874 7261 7320 666f 7220 6465 762c 2061  xtras for dev, a
+00025260: 6c77 6179 7320 6772 6162 2074 6865 206c  lways grab the l
+00025270: 6174 6573 740a 4558 5452 4153 5f52 4551  atest.EXTRAS_REQ
+00025280: 5549 5245 203d 207b 0a20 2020 2022 7073  UIRE = {.    "ps
+00025290: 7963 6f70 6732 223a 205b 2270 7379 636f  ycopg2": ["psyco
+000252a0: 7067 322d 6269 6e61 7279 3e3d 322e 372e  pg2-binary>=2.7.
+000252b0: 3722 5d2c 0a20 2020 2022 7067 3830 3030  7"],.    "pg8000
+000252c0: 223a 205b 2270 6738 3030 303e 3d31 2e31  ": ["pg8000>=1.1
+000252d0: 332e 3122 5d2c 0a20 2020 2022 736e 6f77  3.1"],.    "snow
+000252e0: 666c 616b 6522 3a20 5b22 736e 6f77 666c  flake": ["snowfl
+000252f0: 616b 652d 636f 6e6e 6563 746f 722d 7079  ake-connector-py
+00025300: 7468 6f6e 5b70 616e 6461 735d 3e3d 322e  thon[pandas]>=2.
+00025310: 312e 3222 5d2c 0a20 2020 2022 646f 6373  1.2"],.    "docs
+00025320: 223a 205b 2273 7068 696e 7822 2c20 2273  ": ["sphinx", "s
+00025330: 7068 696e 785f 7274 645f 7468 656d 6522  phinx_rtd_theme"
+00025340: 5d2c 0a20 2020 2022 7465 7374 7322 3a20  ],.    "tests": 
+00025350: 5b0a 2020 2020 2020 2020 2268 7970 6f74  [.        "hypot
+00025360: 6865 7369 7322 2c0a 2020 2020 2020 2020  hesis",.        
+00025370: 2270 7974 6573 7422 2c0a 2020 2020 2020  "pytest",.      
+00025380: 2020 2270 7974 6573 742d 636f 7622 2c0a    "pytest-cov",.
+00025390: 2020 2020 5d2c 0a20 2020 2022 7161 223a      ],.    "qa":
+000253a0: 205b 0a20 2020 2020 2020 2022 7072 652d   [.        "pre-
+000253b0: 636f 6d6d 6974 222c 0a20 2020 2020 2020  commit",.       
+000253c0: 2022 626c 6163 6b22 2c0a 2020 2020 2020   "black",.      
+000253d0: 2020 2269 736f 7274 222c 0a20 2020 205d    "isort",.    ]
+000253e0: 2c0a 2020 2020 2262 7569 6c64 223a 205b  ,.    "build": [
+000253f0: 2262 7569 6c64 222c 2022 7477 696e 6522  "build", "twine"
+00025400: 2c20 2277 6865 656c 225d 2c0a 2020 2020  , "wheel"],.    
+00025410: 2265 6467 6574 6573 7422 3a20 5b22 6564  "edgetest": ["ed
+00025420: 6765 7465 7374 222c 2022 6564 6765 7465  getest", "edgete
+00025430: 7374 2d63 6f6e 6461 225d 2c0a 7d0a 0a45  st-conda"],.}..E
+00025440: 5854 5241 535f 5245 5155 4952 455b 2264  XTRAS_REQUIRE["d
+00025450: 6576 225d 203d 2028 0a20 2020 2045 5854  ev"] = (.    EXT
+00025460: 5241 535f 5245 5155 4952 455b 2274 6573  RAS_REQUIRE["tes
+00025470: 7473 225d 0a20 2020 202b 2045 5854 5241  ts"].    + EXTRA
+00025480: 535f 5245 5155 4952 455b 2264 6f63 7322  S_REQUIRE["docs"
+00025490: 5d0a 2020 2020 2b20 4558 5452 4153 5f52  ].    + EXTRAS_R
+000254a0: 4551 5549 5245 5b22 7161 225d 0a20 2020  EQUIRE["qa"].   
+000254b0: 202b 2045 5854 5241 535f 5245 5155 4952   + EXTRAS_REQUIR
+000254c0: 455b 2262 7569 6c64 225d 0a29 0a0a 0a73  E["build"].)...s
+000254d0: 6574 7570 280a 2020 2020 6e61 6d65 3d22  etup(.    name="
+000254e0: 6c6f 636f 7079 222c 0a20 2020 2076 6572  locopy",.    ver
+000254f0: 7369 6f6e 3d5f 5f76 6572 7369 6f6e 5f5f  sion=__version__
+00025500: 2c0a 2020 2020 6465 7363 7269 7074 696f  ,.    descriptio
+00025510: 6e3d 224c 6f61 6469 6e67 2f55 6e6c 6f61  n="Loading/Unloa
+00025520: 6469 6e67 2074 6f20 416d 617a 6f6e 2052  ding to Amazon R
+00025530: 6564 7368 6966 7420 7573 696e 6720 5079  edshift using Py
+00025540: 7468 6f6e 222c 0a20 2020 206c 6f6e 675f  thon",.    long_
+00025550: 6465 7363 7269 7074 696f 6e3d 4c4f 4e47  description=LONG
+00025560: 5f44 4553 4352 4950 5449 4f4e 2c0a 2020  _DESCRIPTION,.  
+00025570: 2020 7572 6c3d 2268 7474 7073 3a2f 2f67    url="https://g
+00025580: 6974 6875 622e 636f 6d2f 6361 7069 7461  ithub.com/capita
+00025590: 6c6f 6e65 2f6c 6f63 6f70 7922 2c0a 2020  lone/locopy",.  
+000255a0: 2020 6175 7468 6f72 3d22 4661 6973 616c    author="Faisal
+000255b0: 2044 6f73 616e 6922 2c0a 2020 2020 6175   Dosani",.    au
+000255c0: 7468 6f72 5f65 6d61 696c 3d22 6661 6973  thor_email="fais
+000255d0: 616c 2e64 6f73 616e 6940 6361 7069 7461  al.dosani@capita
+000255e0: 6c6f 6e65 2e63 6f6d 222c 0a20 2020 206c  lone.com",.    l
+000255f0: 6963 656e 7365 3d22 4170 6163 6865 2053  icense="Apache S
+00025600: 6f66 7477 6172 6520 4c69 6365 6e73 6522  oftware License"
+00025610: 2c0a 2020 2020 7061 636b 6167 6573 3d5b  ,.    packages=[
+00025620: 226c 6f63 6f70 7922 5d2c 0a20 2020 2069  "locopy"],.    i
+00025630: 6e73 7461 6c6c 5f72 6571 7569 7265 733d  nstall_requires=
+00025640: 494e 5354 414c 4c5f 5245 5155 4952 4553  INSTALL_REQUIRES
+00025650: 2c0a 2020 2020 6578 7472 6173 5f72 6571  ,.    extras_req
+00025660: 7569 7265 3d45 5854 5241 535f 5245 5155  uire=EXTRAS_REQU
+00025670: 4952 452c 0a20 2020 207a 6970 5f73 6166  IRE,.    zip_saf
+00025680: 653d 4661 6c73 652c 0a29 0a00 0000 0000  e=False,.)......
 00025690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000256a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000256b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000256c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000256d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000256e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000256f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -9594,48 +9594,48 @@
 00025790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000257a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000257b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000257c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000257d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000257e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000257f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025800: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025800: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
 00025810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025860: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00025870: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00025880: 3030 3030 3033 3400 3030 3030 3030 3030  0000034.00000000
+00025890: 3030 3000 3031 3134 3532 0020 7800 0000  000.011452. x...
 000258a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000258b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000258c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000258d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000258e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000258f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025900: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00025910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00025950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00025960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000259a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000259b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000259c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000259d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000259e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000259f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025a00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025a00: 3238 206d 7469 6d65 3d31 3638 3134 3134  28 mtime=1681414
+00025a10: 3938 322e 3937 3839 3434 350a 0000 0000  982.9789445.....
 00025a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -9658,80 +9658,80 @@
 00025b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025c00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025c00: 6c6f 636f 7079 2d30 2e35 2e31 2f74 6573  locopy-0.5.1/tes
+00025c10: 7473 2f00 0000 0000 0000 0000 0000 0000  ts/.............
 00025c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025c60: 0000 0000 3030 3030 3735 3500 3030 3031  ....0000755.0001
+00025c70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00025c80: 3030 3030 3030 3000 3030 3030 3030 3030  0000000.00000000
+00025c90: 3030 3000 3031 3437 3636 0020 3500 0000  000.014766. 5...
 00025ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025d00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00025d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025d20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00025d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025d40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00025d50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00025d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025e00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
 00025e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00025e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00025e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00025e90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
 00025ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
 00025f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00025f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00025f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00025f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00025f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00025ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026000: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026000: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+00026010: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
 00026020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
@@ -9754,487 +9754,8167 @@
 00026190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000261a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000261b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000261c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000261d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000261e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000261f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026200: 6c6f 636f 7079 2d30 2e35 2e31 2f74 6573  locopy-0.5.1/tes
+00026210: 7473 2f74 6573 745f 6461 7461 6261 7365  ts/test_database
+00026220: 2e70 7900 0000 0000 0000 0000 0000 0000  .py.............
 00026230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026260: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00026270: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00026280: 3030 3234 3135 3300 3030 3030 3030 3030  0024153.00000000
+00026290: 3030 3000 3032 3031 3530 0020 3000 0000  000.020150. 0...
 000262a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000262b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000262c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000262d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000262e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000262f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026300: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
 00026310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026320: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
 00026330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00026350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
 00026360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 00026390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000263a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000263b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000263c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000263d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000263e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
 000263f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026400: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000264a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000264b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000264c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000264d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000264e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000264f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000265a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000265b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000265c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000265d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000265e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000265f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000266a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000266b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000266c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000266d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000266e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000266f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000267a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000267b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000267c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000267d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000267e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000267f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026800: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000268a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000268b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000268c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000268d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000268e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000268f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000269a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000269b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000269c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000269d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000269e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000269f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026a00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026c00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026e00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00026ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027000: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000270a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000270b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000270c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000270d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000270e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000270f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000271a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000271b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000271c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000271d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000271e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000271f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000272a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000272b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000272c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000272d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000272e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000272f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000273a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000273b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000273c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000273d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000273e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000273f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027400: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000274a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000274b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000274c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000274d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000274e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000274f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000275a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000275b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000275c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000275d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000275e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000275f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000276a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000276b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000276c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000276d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000276e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000276f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000277a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000277b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000277c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000277d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000277e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000277f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027800: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000278a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000278b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000278c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000278d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000278e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000278f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000279a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000279b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000279c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000279d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000279e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-000279f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027a00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027c00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027e00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
-00027ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00026400: 2320 4d49 5420 4c69 6365 6e73 650a 230a  # MIT License.#.
+00026410: 2320 436f 7079 7269 6768 7420 2863 2920  # Copyright (c) 
+00026420: 3230 3138 2043 6170 6974 616c 204f 6e65  2018 Capital One
+00026430: 2053 6572 7669 6365 732c 204c 4c43 0a23   Services, LLC.#
+00026440: 0a23 2050 6572 6d69 7373 696f 6e20 6973  .# Permission is
+00026450: 2068 6572 6562 7920 6772 616e 7465 642c   hereby granted,
+00026460: 2066 7265 6520 6f66 2063 6861 7267 652c   free of charge,
+00026470: 2074 6f20 616e 7920 7065 7273 6f6e 206f   to any person o
+00026480: 6274 6169 6e69 6e67 2061 2063 6f70 790a  btaining a copy.
+00026490: 2320 6f66 2074 6869 7320 736f 6674 7761  # of this softwa
+000264a0: 7265 2061 6e64 2061 7373 6f63 6961 7465  re and associate
+000264b0: 6420 646f 6375 6d65 6e74 6174 696f 6e20  d documentation 
+000264c0: 6669 6c65 7320 2874 6865 2022 536f 6674  files (the "Soft
+000264d0: 7761 7265 2229 2c20 746f 2064 6561 6c0a  ware"), to deal.
+000264e0: 2320 696e 2074 6865 2053 6f66 7477 6172  # in the Softwar
+000264f0: 6520 7769 7468 6f75 7420 7265 7374 7269  e without restri
+00026500: 6374 696f 6e2c 2069 6e63 6c75 6469 6e67  ction, including
+00026510: 2077 6974 686f 7574 206c 696d 6974 6174   without limitat
+00026520: 696f 6e20 7468 6520 7269 6768 7473 0a23  ion the rights.#
+00026530: 2074 6f20 7573 652c 2063 6f70 792c 206d   to use, copy, m
+00026540: 6f64 6966 792c 206d 6572 6765 2c20 7075  odify, merge, pu
+00026550: 626c 6973 682c 2064 6973 7472 6962 7574  blish, distribut
+00026560: 652c 2073 7562 6c69 6365 6e73 652c 2061  e, sublicense, a
+00026570: 6e64 2f6f 7220 7365 6c6c 0a23 2063 6f70  nd/or sell.# cop
+00026580: 6965 7320 6f66 2074 6865 2053 6f66 7477  ies of the Softw
+00026590: 6172 652c 2061 6e64 2074 6f20 7065 726d  are, and to perm
+000265a0: 6974 2070 6572 736f 6e73 2074 6f20 7768  it persons to wh
+000265b0: 6f6d 2074 6865 2053 6f66 7477 6172 6520  om the Software 
+000265c0: 6973 0a23 2066 7572 6e69 7368 6564 2074  is.# furnished t
+000265d0: 6f20 646f 2073 6f2c 2073 7562 6a65 6374  o do so, subject
+000265e0: 2074 6f20 7468 6520 666f 6c6c 6f77 696e   to the followin
+000265f0: 6720 636f 6e64 6974 696f 6e73 3a0a 230a  g conditions:.#.
+00026600: 2320 5468 6520 6162 6f76 6520 636f 7079  # The above copy
+00026610: 7269 6768 7420 6e6f 7469 6365 2061 6e64  right notice and
+00026620: 2074 6869 7320 7065 726d 6973 7369 6f6e   this permission
+00026630: 206e 6f74 6963 6520 7368 616c 6c20 6265   notice shall be
+00026640: 2069 6e63 6c75 6465 6420 696e 2061 6c6c   included in all
+00026650: 0a23 2063 6f70 6965 7320 6f72 2073 7562  .# copies or sub
+00026660: 7374 616e 7469 616c 2070 6f72 7469 6f6e  stantial portion
+00026670: 7320 6f66 2074 6865 2053 6f66 7477 6172  s of the Softwar
+00026680: 652e 0a23 0a23 2054 4845 2053 4f46 5457  e..#.# THE SOFTW
+00026690: 4152 4520 4953 2050 524f 5649 4445 4420  ARE IS PROVIDED 
+000266a0: 2241 5320 4953 222c 2057 4954 484f 5554  "AS IS", WITHOUT
+000266b0: 2057 4152 5241 4e54 5920 4f46 2041 4e59   WARRANTY OF ANY
+000266c0: 204b 494e 442c 2045 5850 5245 5353 204f   KIND, EXPRESS O
+000266d0: 520a 2320 494d 504c 4945 442c 2049 4e43  R.# IMPLIED, INC
+000266e0: 4c55 4449 4e47 2042 5554 204e 4f54 204c  LUDING BUT NOT L
+000266f0: 494d 4954 4544 2054 4f20 5448 4520 5741  IMITED TO THE WA
+00026700: 5252 414e 5449 4553 204f 4620 4d45 5243  RRANTIES OF MERC
+00026710: 4841 4e54 4142 494c 4954 592c 0a23 2046  HANTABILITY,.# F
+00026720: 4954 4e45 5353 2046 4f52 2041 2050 4152  ITNESS FOR A PAR
+00026730: 5449 4355 4c41 5220 5055 5250 4f53 4520  TICULAR PURPOSE 
+00026740: 414e 4420 4e4f 4e49 4e46 5249 4e47 454d  AND NONINFRINGEM
+00026750: 454e 542e 2049 4e20 4e4f 2045 5645 4e54  ENT. IN NO EVENT
+00026760: 2053 4841 4c4c 2054 4845 0a23 2041 5554   SHALL THE.# AUT
+00026770: 484f 5253 204f 5220 434f 5059 5249 4748  HORS OR COPYRIGH
+00026780: 5420 484f 4c44 4552 5320 4245 204c 4941  T HOLDERS BE LIA
+00026790: 424c 4520 464f 5220 414e 5920 434c 4149  BLE FOR ANY CLAI
+000267a0: 4d2c 2044 414d 4147 4553 204f 5220 4f54  M, DAMAGES OR OT
+000267b0: 4845 520a 2320 4c49 4142 494c 4954 592c  HER.# LIABILITY,
+000267c0: 2057 4845 5448 4552 2049 4e20 414e 2041   WHETHER IN AN A
+000267d0: 4354 494f 4e20 4f46 2043 4f4e 5452 4143  CTION OF CONTRAC
+000267e0: 542c 2054 4f52 5420 4f52 204f 5448 4552  T, TORT OR OTHER
+000267f0: 5749 5345 2c20 4152 4953 494e 4720 4652  WISE, ARISING FR
+00026800: 4f4d 2c0a 2320 4f55 5420 4f46 204f 5220  OM,.# OUT OF OR 
+00026810: 494e 2043 4f4e 4e45 4354 494f 4e20 5749  IN CONNECTION WI
+00026820: 5448 2054 4845 2053 4f46 5457 4152 4520  TH THE SOFTWARE 
+00026830: 4f52 2054 4845 2055 5345 204f 5220 4f54  OR THE USE OR OT
+00026840: 4845 5220 4445 414c 494e 4753 2049 4e20  HER DEALINGS IN 
+00026850: 5448 450a 2320 534f 4654 5741 5245 2e0a  THE.# SOFTWARE..
+00026860: 0a69 6d70 6f72 7420 7371 6c69 7465 330a  .import sqlite3.
+00026870: 6672 6f6d 2075 6e69 7474 6573 7420 696d  from unittest im
+00026880: 706f 7274 206d 6f63 6b0a 0a69 6d70 6f72  port mock..impor
+00026890: 7420 7067 3830 3030 0a69 6d70 6f72 7420  t pg8000.import 
+000268a0: 7073 7963 6f70 6732 0a69 6d70 6f72 7420  psycopg2.import 
+000268b0: 7079 7465 7374 0a69 6d70 6f72 7420 736e  pytest.import sn
+000268c0: 6f77 666c 616b 652e 636f 6e6e 6563 746f  owflake.connecto
+000268d0: 720a 0a66 726f 6d20 6c6f 636f 7079 2069  r..from locopy i
+000268e0: 6d70 6f72 7420 4461 7461 6261 7365 0a66  mport Database.f
+000268f0: 726f 6d20 6c6f 636f 7079 2e65 7272 6f72  rom locopy.error
+00026900: 7320 696d 706f 7274 2043 7265 6465 6e74  s import Credent
+00026910: 6961 6c73 4572 726f 722c 2044 4245 7272  ialsError, DBErr
+00026920: 6f72 0a0a 474f 4f44 5f43 4f4e 4649 475f  or..GOOD_CONFIG_
+00026930: 5941 4d4c 203d 2022 2222 0a68 6f73 743a  YAML = """.host:
+00026940: 2068 6f73 740a 706f 7274 3a20 3132 3334   host.port: 1234
+00026950: 0a64 6174 6162 6173 653a 2064 6174 6162  .database: datab
+00026960: 6173 650a 7573 6572 3a20 6964 0a70 6173  ase.user: id.pas
+00026970: 7377 6f72 643a 2070 6173 730a 6f74 6865  sword: pass.othe
+00026980: 723a 2073 7475 6666 0a65 7874 7261 3a20  r: stuff.extra: 
+00026990: 3132 330a 616e 6f74 6865 723a 2033 3231  123.another: 321
+000269a0: 2222 220a 0a44 4241 5049 5320 3d20 5b73  """..DBAPIS = [s
+000269b0: 716c 6974 6533 2c20 7067 3830 3030 2c20  qlite3, pg8000, 
+000269c0: 7073 7963 6f70 6732 2c20 736e 6f77 666c  psycopg2, snowfl
+000269d0: 616b 652e 636f 6e6e 6563 746f 725d 0a0a  ake.connector]..
+000269e0: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
+000269f0: 7261 6d65 7472 697a 6528 2264 6261 7069  rametrize("dbapi
+00026a00: 222c 2044 4241 5049 5329 0a64 6566 2074  ", DBAPIS).def t
+00026a10: 6573 745f 6461 7461 6261 7365 5f63 6f6e  est_database_con
+00026a20: 7374 7275 6374 6f72 2863 7265 6465 6e74  structor(credent
+00026a30: 6961 6c73 2c20 6462 6170 6929 3a0a 2020  ials, dbapi):.  
+00026a40: 2020 6420 3d20 4461 7461 6261 7365 2864    d = Database(d
+00026a50: 6261 7069 3d64 6261 7069 2c20 2a2a 6372  bapi=dbapi, **cr
+00026a60: 6564 656e 7469 616c 7329 0a20 2020 2061  edentials).    a
+00026a70: 7373 6572 7420 642e 636f 6e6e 6563 7469  ssert d.connecti
+00026a80: 6f6e 5b22 686f 7374 225d 203d 3d20 2268  on["host"] == "h
+00026a90: 6f73 7422 0a20 2020 2061 7373 6572 7420  ost".    assert 
+00026aa0: 642e 636f 6e6e 6563 7469 6f6e 5b22 706f  d.connection["po
+00026ab0: 7274 225d 203d 3d20 2270 6f72 7422 0a20  rt"] == "port". 
+00026ac0: 2020 2061 7373 6572 7420 642e 636f 6e6e     assert d.conn
+00026ad0: 6563 7469 6f6e 5b22 6461 7461 6261 7365  ection["database
+00026ae0: 225d 203d 3d20 2264 6174 6162 6173 6522  "] == "database"
+00026af0: 0a20 2020 2061 7373 6572 7420 642e 636f  .    assert d.co
+00026b00: 6e6e 6563 7469 6f6e 5b22 7573 6572 225d  nnection["user"]
+00026b10: 203d 3d20 2275 7365 7222 0a20 2020 2061   == "user".    a
+00026b20: 7373 6572 7420 642e 636f 6e6e 6563 7469  ssert d.connecti
+00026b30: 6f6e 5b22 7061 7373 776f 7264 225d 203d  on["password"] =
+00026b40: 3d20 2270 6173 7377 6f72 6422 0a0a 0a40  = "password"...@
+00026b50: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
+00026b60: 6d65 7472 697a 6528 2264 6261 7069 222c  metrize("dbapi",
+00026b70: 2044 4241 5049 5329 0a64 6566 2074 6573   DBAPIS).def tes
+00026b80: 745f 6461 7461 6261 7365 5f63 6f6e 7374  t_database_const
+00026b90: 7275 6374 6f72 5f6b 7761 7267 7328 6462  ructor_kwargs(db
+00026ba0: 6170 6929 3a0a 2020 2020 6420 3d20 4461  api):.    d = Da
+00026bb0: 7461 6261 7365 280a 2020 2020 2020 2020  tabase(.        
+00026bc0: 6462 6170 693d 6462 6170 692c 2068 6f73  dbapi=dbapi, hos
+00026bd0: 743d 2268 6f73 7422 2c20 706f 7274 3d22  t="host", port="
+00026be0: 706f 7274 222c 2064 6174 6162 6173 653d  port", database=
+00026bf0: 2264 6174 6162 6173 6522 2c20 7573 6572  "database", user
+00026c00: 3d22 7573 6572 222c 2070 6173 7377 6f72  ="user", passwor
+00026c10: 643d 2270 6173 7377 6f72 6422 0a20 2020  d="password".   
+00026c20: 2029 0a20 2020 2061 7373 6572 7420 642e   ).    assert d.
+00026c30: 636f 6e6e 6563 7469 6f6e 5b22 686f 7374  connection["host
+00026c40: 225d 203d 3d20 2268 6f73 7422 0a20 2020  "] == "host".   
+00026c50: 2061 7373 6572 7420 642e 636f 6e6e 6563   assert d.connec
+00026c60: 7469 6f6e 5b22 706f 7274 225d 203d 3d20  tion["port"] == 
+00026c70: 2270 6f72 7422 0a20 2020 2061 7373 6572  "port".    asser
+00026c80: 7420 642e 636f 6e6e 6563 7469 6f6e 5b22  t d.connection["
+00026c90: 6461 7461 6261 7365 225d 203d 3d20 2264  database"] == "d
+00026ca0: 6174 6162 6173 6522 0a20 2020 2061 7373  atabase".    ass
+00026cb0: 6572 7420 642e 636f 6e6e 6563 7469 6f6e  ert d.connection
+00026cc0: 5b22 7573 6572 225d 203d 3d20 2275 7365  ["user"] == "use
+00026cd0: 7222 0a20 2020 2061 7373 6572 7420 642e  r".    assert d.
+00026ce0: 636f 6e6e 6563 7469 6f6e 5b22 7061 7373  connection["pass
+00026cf0: 776f 7264 225d 203d 3d20 2270 6173 7377  word"] == "passw
+00026d00: 6f72 6422 0a0a 0a40 7079 7465 7374 2e6d  ord"...@pytest.m
+00026d10: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
+00026d20: 2264 6261 7069 222c 2044 4241 5049 5329  "dbapi", DBAPIS)
+00026d30: 0a40 6d6f 636b 2e70 6174 6368 2822 6c6f  .@mock.patch("lo
+00026d40: 636f 7079 2e75 7469 6c69 7479 2e6f 7065  copy.utility.ope
+00026d50: 6e22 2c20 6d6f 636b 2e6d 6f63 6b5f 6f70  n", mock.mock_op
+00026d60: 656e 2872 6561 645f 6461 7461 3d47 4f4f  en(read_data=GOO
+00026d70: 445f 434f 4e46 4947 5f59 414d 4c29 290a  D_CONFIG_YAML)).
+00026d80: 6465 6620 7465 7374 5f64 6174 6162 6173  def test_databas
+00026d90: 655f 636f 6e73 7472 7563 746f 725f 6b77  e_constructor_kw
+00026da0: 6172 6773 5f61 6e64 5f79 616d 6c28 6462  args_and_yaml(db
+00026db0: 6170 6929 3a0a 2020 2020 7769 7468 2070  api):.    with p
+00026dc0: 7974 6573 742e 7261 6973 6573 2843 7265  ytest.raises(Cre
+00026dd0: 6465 6e74 6961 6c73 4572 726f 7229 3a0a  dentialsError):.
+00026de0: 2020 2020 2020 2020 4461 7461 6261 7365          Database
+00026df0: 280a 2020 2020 2020 2020 2020 2020 6462  (.            db
+00026e00: 6170 693d 6462 6170 692c 0a20 2020 2020  api=dbapi,.     
+00026e10: 2020 2020 2020 2063 6f6e 6669 675f 7961         config_ya
+00026e20: 6d6c 3d22 736f 6d65 5f63 6f6e 6669 672e  ml="some_config.
+00026e30: 796d 6c22 2c0a 2020 2020 2020 2020 2020  yml",.          
+00026e40: 2020 686f 7374 3d22 686f 7374 222c 0a20    host="host",. 
+00026e50: 2020 2020 2020 2020 2020 2070 6f72 743d             port=
+00026e60: 2270 6f72 7422 2c0a 2020 2020 2020 2020  "port",.        
+00026e70: 2020 2020 6461 7461 6261 7365 3d22 6461      database="da
+00026e80: 7461 6261 7365 222c 0a20 2020 2020 2020  tabase",.       
+00026e90: 2020 2020 2075 7365 723d 2275 7365 7222       user="user"
+00026ea0: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
+00026eb0: 7373 776f 7264 3d22 7061 7373 776f 7264  ssword="password
+00026ec0: 222c 0a20 2020 2020 2020 2029 0a0a 0a40  ",.        )...@
+00026ed0: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
+00026ee0: 6d65 7472 697a 6528 2264 6261 7069 222c  metrize("dbapi",
+00026ef0: 2044 4241 5049 5329 0a64 6566 2074 6573   DBAPIS).def tes
+00026f00: 745f 6461 7461 6261 7365 5f63 6f6e 7374  t_database_const
+00026f10: 7275 6374 6f72 5f77 6974 685f 6578 7472  ructor_with_extr
+00026f20: 6173 2863 7265 6465 6e74 6961 6c73 2c20  as(credentials, 
+00026f30: 6462 6170 6929 3a0a 2020 2020 6372 6564  dbapi):.    cred
+00026f40: 656e 7469 616c 735b 2265 7874 7261 225d  entials["extra"]
+00026f50: 203d 2031 3233 0a20 2020 2063 7265 6465   = 123.    crede
+00026f60: 6e74 6961 6c73 5b22 616e 6f74 6865 7222  ntials["another"
+00026f70: 5d20 3d20 3332 310a 2020 2020 6420 3d20  ] = 321.    d = 
+00026f80: 4461 7461 6261 7365 2864 6261 7069 3d64  Database(dbapi=d
+00026f90: 6261 7069 2c20 2a2a 6372 6564 656e 7469  bapi, **credenti
+00026fa0: 616c 7329 0a20 2020 2061 7373 6572 7420  als).    assert 
+00026fb0: 642e 636f 6e6e 6563 7469 6f6e 5b22 686f  d.connection["ho
+00026fc0: 7374 225d 203d 3d20 2268 6f73 7422 0a20  st"] == "host". 
+00026fd0: 2020 2061 7373 6572 7420 642e 636f 6e6e     assert d.conn
+00026fe0: 6563 7469 6f6e 5b22 706f 7274 225d 203d  ection["port"] =
+00026ff0: 3d20 2270 6f72 7422 0a20 2020 2061 7373  = "port".    ass
+00027000: 6572 7420 642e 636f 6e6e 6563 7469 6f6e  ert d.connection
+00027010: 5b22 6461 7461 6261 7365 225d 203d 3d20  ["database"] == 
+00027020: 2264 6174 6162 6173 6522 0a20 2020 2061  "database".    a
+00027030: 7373 6572 7420 642e 636f 6e6e 6563 7469  ssert d.connecti
+00027040: 6f6e 5b22 7573 6572 225d 203d 3d20 2275  on["user"] == "u
+00027050: 7365 7222 0a20 2020 2061 7373 6572 7420  ser".    assert 
+00027060: 642e 636f 6e6e 6563 7469 6f6e 5b22 7061  d.connection["pa
+00027070: 7373 776f 7264 225d 203d 3d20 2270 6173  ssword"] == "pas
+00027080: 7377 6f72 6422 0a20 2020 2061 7373 6572  sword".    asser
+00027090: 7420 642e 636f 6e6e 6563 7469 6f6e 5b22  t d.connection["
+000270a0: 6578 7472 6122 5d20 3d3d 2031 3233 0a20  extra"] == 123. 
+000270b0: 2020 2061 7373 6572 7420 642e 636f 6e6e     assert d.conn
+000270c0: 6563 7469 6f6e 5b22 616e 6f74 6865 7222  ection["another"
+000270d0: 5d20 3d3d 2033 3231 0a0a 0a40 7079 7465  ] == 321...@pyte
+000270e0: 7374 2e6d 6172 6b2e 7061 7261 6d65 7472  st.mark.parametr
+000270f0: 697a 6528 2264 6261 7069 222c 2044 4241  ize("dbapi", DBA
+00027100: 5049 5329 0a40 6d6f 636b 2e70 6174 6368  PIS).@mock.patch
+00027110: 2822 6c6f 636f 7079 2e75 7469 6c69 7479  ("locopy.utility
+00027120: 2e6f 7065 6e22 2c20 6d6f 636b 2e6d 6f63  .open", mock.moc
+00027130: 6b5f 6f70 656e 2872 6561 645f 6461 7461  k_open(read_data
+00027140: 3d47 4f4f 445f 434f 4e46 4947 5f59 414d  =GOOD_CONFIG_YAM
+00027150: 4c29 290a 6465 6620 7465 7374 5f64 6174  L)).def test_dat
+00027160: 6162 6173 655f 636f 6e73 7472 7563 746f  abase_constructo
+00027170: 725f 7961 6d6c 2864 6261 7069 293a 0a20  r_yaml(dbapi):. 
+00027180: 2020 2064 203d 2044 6174 6162 6173 6528     d = Database(
+00027190: 6462 6170 693d 6462 6170 692c 2063 6f6e  dbapi=dbapi, con
+000271a0: 6669 675f 7961 6d6c 3d22 736f 6d65 5f63  fig_yaml="some_c
+000271b0: 6f6e 6669 672e 796d 6c22 290a 2020 2020  onfig.yml").    
+000271c0: 6173 7365 7274 2064 2e63 6f6e 6e65 6374  assert d.connect
+000271d0: 696f 6e5b 2268 6f73 7422 5d20 3d3d 2022  ion["host"] == "
+000271e0: 686f 7374 220a 2020 2020 6173 7365 7274  host".    assert
+000271f0: 2064 2e63 6f6e 6e65 6374 696f 6e5b 2270   d.connection["p
+00027200: 6f72 7422 5d20 3d3d 2031 3233 340a 2020  ort"] == 1234.  
+00027210: 2020 6173 7365 7274 2064 2e63 6f6e 6e65    assert d.conne
+00027220: 6374 696f 6e5b 2264 6174 6162 6173 6522  ction["database"
+00027230: 5d20 3d3d 2022 6461 7461 6261 7365 220a  ] == "database".
+00027240: 2020 2020 6173 7365 7274 2064 2e63 6f6e      assert d.con
+00027250: 6e65 6374 696f 6e5b 2275 7365 7222 5d20  nection["user"] 
+00027260: 3d3d 2022 6964 220a 2020 2020 6173 7365  == "id".    asse
+00027270: 7274 2064 2e63 6f6e 6e65 6374 696f 6e5b  rt d.connection[
+00027280: 2270 6173 7377 6f72 6422 5d20 3d3d 2022  "password"] == "
+00027290: 7061 7373 220a 2020 2020 6173 7365 7274  pass".    assert
+000272a0: 2064 2e63 6f6e 6e65 6374 696f 6e5b 226f   d.connection["o
+000272b0: 7468 6572 225d 203d 3d20 2273 7475 6666  ther"] == "stuff
+000272c0: 220a 2020 2020 6173 7365 7274 2064 2e63  ".    assert d.c
+000272d0: 6f6e 6e65 6374 696f 6e5b 2265 7874 7261  onnection["extra
+000272e0: 225d 203d 3d20 3132 330a 2020 2020 6173  "] == 123.    as
+000272f0: 7365 7274 2064 2e63 6f6e 6e65 6374 696f  sert d.connectio
+00027300: 6e5b 2261 6e6f 7468 6572 225d 203d 3d20  n["another"] == 
+00027310: 3332 310a 0a0a 4070 7974 6573 742e 6d61  321...@pytest.ma
+00027320: 726b 2e70 6172 616d 6574 7269 7a65 2822  rk.parametrize("
+00027330: 6462 6170 6922 2c20 4442 4150 4953 290a  dbapi", DBAPIS).
+00027340: 6465 6620 7465 7374 5f69 735f 636f 6e6e  def test_is_conn
+00027350: 6563 7465 6428 6372 6564 656e 7469 616c  ected(credential
+00027360: 732c 2064 6261 7069 293a 0a20 2020 2077  s, dbapi):.    w
+00027370: 6974 6820 6d6f 636b 2e70 6174 6368 2864  ith mock.patch(d
+00027380: 6261 7069 2e5f 5f6e 616d 655f 5f20 2b20  bapi.__name__ + 
+00027390: 222e 636f 6e6e 6563 7422 2920 6173 206d  ".connect") as m
+000273a0: 6f63 6b5f 636f 6e6e 6563 743a 0a20 2020  ock_connect:.   
+000273b0: 2020 2020 2062 203d 2044 6174 6162 6173       b = Databas
+000273c0: 6528 6462 6170 693d 6462 6170 692c 202a  e(dbapi=dbapi, *
+000273d0: 2a63 7265 6465 6e74 6961 6c73 290a 2020  *credentials).  
+000273e0: 2020 2020 2020 6173 7365 7274 2062 2e5f        assert b._
+000273f0: 6973 5f63 6f6e 6e65 6374 6564 2829 2069  is_connected() i
+00027400: 7320 4661 6c73 650a 0a20 2020 2077 6974  s False..    wit
+00027410: 6820 6d6f 636b 2e70 6174 6368 2864 6261  h mock.patch(dba
+00027420: 7069 2e5f 5f6e 616d 655f 5f20 2b20 222e  pi.__name__ + ".
+00027430: 636f 6e6e 6563 7422 2920 6173 206d 6f63  connect") as moc
+00027440: 6b5f 636f 6e6e 6563 743a 0a20 2020 2020  k_connect:.     
+00027450: 2020 2062 203d 2044 6174 6162 6173 6528     b = Database(
+00027460: 6462 6170 693d 6462 6170 692c 202a 2a63  dbapi=dbapi, **c
+00027470: 7265 6465 6e74 6961 6c73 290a 2020 2020  redentials).    
+00027480: 2020 2020 622e 636f 6e6e 6563 7428 290a      b.connect().
+00027490: 2020 2020 2020 2020 6173 7365 7274 2062          assert b
+000274a0: 2e5f 6973 5f63 6f6e 6e65 6374 6564 2829  ._is_connected()
+000274b0: 2069 7320 5472 7565 0a0a 2020 2020 2320   is True..    # 
+000274c0: 7468 726f 7773 2065 7863 6570 7469 6f6e  throws exception
+000274d0: 2069 6e20 5f69 735f 636f 6e6e 6563 7465   in _is_connecte
+000274e0: 640a 2020 2020 6220 3d20 4461 7461 6261  d.    b = Databa
+000274f0: 7365 2864 6261 7069 3d64 6261 7069 2c20  se(dbapi=dbapi, 
+00027500: 2a2a 6372 6564 656e 7469 616c 7329 0a20  **credentials). 
+00027510: 2020 2064 656c 2062 2e63 6f6e 6e0a 2020     del b.conn.  
+00027520: 2020 6173 7365 7274 2062 2e5f 6973 5f63    assert b._is_c
+00027530: 6f6e 6e65 6374 6564 2829 2069 7320 4661  onnected() is Fa
+00027540: 6c73 650a 0a0a 4070 7974 6573 742e 6d61  lse...@pytest.ma
+00027550: 726b 2e70 6172 616d 6574 7269 7a65 2822  rk.parametrize("
+00027560: 6462 6170 6922 2c20 4442 4150 4953 290a  dbapi", DBAPIS).
+00027570: 6465 6620 7465 7374 5f63 6f6e 6e65 6374  def test_connect
+00027580: 2863 7265 6465 6e74 6961 6c73 2c20 6462  (credentials, db
+00027590: 6170 6929 3a0a 2020 2020 7769 7468 206d  api):.    with m
+000275a0: 6f63 6b2e 7061 7463 6828 6462 6170 692e  ock.patch(dbapi.
+000275b0: 5f5f 6e61 6d65 5f5f 202b 2022 2e63 6f6e  __name__ + ".con
+000275c0: 6e65 6374 2229 2061 7320 6d6f 636b 5f63  nect") as mock_c
+000275d0: 6f6e 6e65 6374 3a0a 2020 2020 2020 2020  onnect:.        
+000275e0: 6220 3d20 4461 7461 6261 7365 2864 6261  b = Database(dba
+000275f0: 7069 3d64 6261 7069 2c20 2a2a 6372 6564  pi=dbapi, **cred
+00027600: 656e 7469 616c 7329 0a20 2020 2020 2020  entials).       
+00027610: 2062 2e63 6f6e 6e65 6374 2829 0a20 2020   b.connect().   
+00027620: 2020 2020 206d 6f63 6b5f 636f 6e6e 6563       mock_connec
+00027630: 742e 6173 7365 7274 5f63 616c 6c65 645f  t.assert_called_
+00027640: 7769 7468 280a 2020 2020 2020 2020 2020  with(.          
+00027650: 2020 686f 7374 3d22 686f 7374 222c 2075    host="host", u
+00027660: 7365 723d 2275 7365 7222 2c20 706f 7274  ser="user", port
+00027670: 3d22 706f 7274 222c 2070 6173 7377 6f72  ="port", passwor
+00027680: 643d 2270 6173 7377 6f72 6422 2c20 6461  d="password", da
+00027690: 7461 6261 7365 3d22 6461 7461 6261 7365  tabase="database
+000276a0: 220a 2020 2020 2020 2020 290a 0a20 2020  ".        )..   
+000276b0: 2063 7265 6465 6e74 6961 6c73 5b22 6578   credentials["ex
+000276c0: 7472 6122 5d20 3d20 3132 330a 2020 2020  tra"] = 123.    
+000276d0: 6372 6564 656e 7469 616c 735b 2261 6e6f  credentials["ano
+000276e0: 7468 6572 225d 203d 2033 3231 0a20 2020  ther"] = 321.   
+000276f0: 2077 6974 6820 6d6f 636b 2e70 6174 6368   with mock.patch
+00027700: 2864 6261 7069 2e5f 5f6e 616d 655f 5f20  (dbapi.__name__ 
+00027710: 2b20 222e 636f 6e6e 6563 7422 2920 6173  + ".connect") as
+00027720: 206d 6f63 6b5f 636f 6e6e 6563 743a 0a20   mock_connect:. 
+00027730: 2020 2020 2020 2062 203d 2044 6174 6162         b = Datab
+00027740: 6173 6528 6462 6170 693d 6462 6170 692c  ase(dbapi=dbapi,
+00027750: 202a 2a63 7265 6465 6e74 6961 6c73 290a   **credentials).
+00027760: 2020 2020 2020 2020 622e 636f 6e6e 6563          b.connec
+00027770: 7428 290a 2020 2020 2020 2020 6d6f 636b  t().        mock
+00027780: 5f63 6f6e 6e65 6374 2e61 7373 6572 745f  _connect.assert_
+00027790: 6361 6c6c 6564 5f77 6974 6828 0a20 2020  called_with(.   
+000277a0: 2020 2020 2020 2020 2068 6f73 743d 2268           host="h
+000277b0: 6f73 7422 2c0a 2020 2020 2020 2020 2020  ost",.          
+000277c0: 2020 7573 6572 3d22 7573 6572 222c 0a20    user="user",. 
+000277d0: 2020 2020 2020 2020 2020 2070 6f72 743d             port=
+000277e0: 2270 6f72 7422 2c0a 2020 2020 2020 2020  "port",.        
+000277f0: 2020 2020 7061 7373 776f 7264 3d22 7061      password="pa
+00027800: 7373 776f 7264 222c 0a20 2020 2020 2020  ssword",.       
+00027810: 2020 2020 2064 6174 6162 6173 653d 2264       database="d
+00027820: 6174 6162 6173 6522 2c0a 2020 2020 2020  atabase",.      
+00027830: 2020 2020 2020 6578 7472 613d 3132 332c        extra=123,
+00027840: 0a20 2020 2020 2020 2020 2020 2061 6e6f  .            ano
+00027850: 7468 6572 3d33 3231 2c0a 2020 2020 2020  ther=321,.      
+00027860: 2020 290a 0a20 2020 2023 2073 6964 6520    )..    # side 
+00027870: 6566 6665 6374 2065 7863 6570 7469 6f6e  effect exception
+00027880: 0a20 2020 206d 6f63 6b5f 636f 6e6e 6563  .    mock_connec
+00027890: 742e 7369 6465 5f65 6666 6563 7420 3d20  t.side_effect = 
+000278a0: 4578 6365 7074 696f 6e28 2243 6f6e 6e65  Exception("Conne
+000278b0: 6374 2045 7863 6570 7469 6f6e 2229 0a20  ct Exception"). 
+000278c0: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
+000278d0: 6169 7365 7328 4442 4572 726f 7229 3a0a  aises(DBError):.
+000278e0: 2020 2020 2020 2020 622e 636f 6e6e 6563          b.connec
+000278f0: 7428 290a 0a0a 4070 7974 6573 742e 6d61  t()...@pytest.ma
+00027900: 726b 2e70 6172 616d 6574 7269 7a65 2822  rk.parametrize("
+00027910: 6462 6170 6922 2c20 4442 4150 4953 290a  dbapi", DBAPIS).
+00027920: 6465 6620 7465 7374 5f64 6973 636f 6e6e  def test_disconn
+00027930: 6563 7428 6372 6564 656e 7469 616c 732c  ect(credentials,
+00027940: 2064 6261 7069 293a 0a20 2020 2077 6974   dbapi):.    wit
+00027950: 6820 6d6f 636b 2e70 6174 6368 2864 6261  h mock.patch(dba
+00027960: 7069 2e5f 5f6e 616d 655f 5f20 2b20 222e  pi.__name__ + ".
+00027970: 636f 6e6e 6563 7422 2920 6173 206d 6f63  connect") as moc
+00027980: 6b5f 636f 6e6e 6563 743a 0a20 2020 2020  k_connect:.     
+00027990: 2020 2062 203d 2044 6174 6162 6173 6528     b = Database(
+000279a0: 6462 6170 693d 6462 6170 692c 202a 2a63  dbapi=dbapi, **c
+000279b0: 7265 6465 6e74 6961 6c73 290a 2020 2020  redentials).    
+000279c0: 2020 2020 622e 636f 6e6e 6563 7428 290a      b.connect().
+000279d0: 2020 2020 2020 2020 622e 6469 7363 6f6e          b.discon
+000279e0: 6e65 6374 2829 0a20 2020 2020 2020 2062  nect().        b
+000279f0: 2e63 6f6e 6e2e 636c 6f73 652e 6173 7365  .conn.close.asse
+00027a00: 7274 5f63 616c 6c65 645f 7769 7468 2829  rt_called_with()
+00027a10: 0a20 2020 2020 2020 2062 2e63 7572 736f  .        b.curso
+00027a20: 722e 636c 6f73 652e 6173 7365 7274 5f63  r.close.assert_c
+00027a30: 616c 6c65 645f 7769 7468 2829 0a0a 2020  alled_with()..  
+00027a40: 2020 2320 7369 6465 2065 6666 6563 7420    # side effect 
+00027a50: 6578 6365 7074 696f 6e0a 2020 2020 7769  exception.    wi
+00027a60: 7468 206d 6f63 6b2e 7061 7463 6828 6462  th mock.patch(db
+00027a70: 6170 692e 5f5f 6e61 6d65 5f5f 202b 2022  api.__name__ + "
+00027a80: 2e63 6f6e 6e65 6374 2229 2061 7320 6d6f  .connect") as mo
+00027a90: 636b 5f63 6f6e 6e65 6374 3a0a 2020 2020  ck_connect:.    
+00027aa0: 2020 2020 622e 636f 6e6e 6563 7428 290a      b.connect().
+00027ab0: 2020 2020 2020 2020 622e 636f 6e6e 2e63          b.conn.c
+00027ac0: 6c6f 7365 2e73 6964 655f 6566 6665 6374  lose.side_effect
+00027ad0: 203d 2045 7863 6570 7469 6f6e 2822 4469   = Exception("Di
+00027ae0: 7363 6f6e 6e65 6374 2045 7863 6570 7469  sconnect Excepti
+00027af0: 6f6e 2229 0a20 2020 2020 2020 2077 6974  on").        wit
+00027b00: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
+00027b10: 4442 4572 726f 7229 3a0a 2020 2020 2020  DBError):.      
+00027b20: 2020 2020 2020 622e 6469 7363 6f6e 6e65        b.disconne
+00027b30: 6374 2829 0a0a 0a40 7079 7465 7374 2e6d  ct()...@pytest.m
+00027b40: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
+00027b50: 2264 6261 7069 222c 2044 4241 5049 5329  "dbapi", DBAPIS)
+00027b60: 0a64 6566 2074 6573 745f 6469 7363 6f6e  .def test_discon
+00027b70: 6e65 6374 5f6e 6f5f 636f 6e6e 2863 7265  nect_no_conn(cre
+00027b80: 6465 6e74 6961 6c73 2c20 6462 6170 6929  dentials, dbapi)
+00027b90: 3a0a 2020 2020 7769 7468 206d 6f63 6b2e  :.    with mock.
+00027ba0: 7061 7463 6828 6462 6170 692e 5f5f 6e61  patch(dbapi.__na
+00027bb0: 6d65 5f5f 202b 2022 2e63 6f6e 6e65 6374  me__ + ".connect
+00027bc0: 2229 2061 7320 6d6f 636b 5f63 6f6e 6e65  ") as mock_conne
+00027bd0: 6374 3a0a 2020 2020 2020 2020 6220 3d20  ct:.        b = 
+00027be0: 4461 7461 6261 7365 2864 6261 7069 3d64  Database(dbapi=d
+00027bf0: 6261 7069 2c20 2a2a 6372 6564 656e 7469  bapi, **credenti
+00027c00: 616c 7329 0a20 2020 2020 2020 2062 2e64  als).        b.d
+00027c10: 6973 636f 6e6e 6563 7428 290a 0a0a 4070  isconnect()...@p
+00027c20: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
+00027c30: 6574 7269 7a65 2822 6462 6170 6922 2c20  etrize("dbapi", 
+00027c40: 4442 4150 4953 290a 6465 6620 7465 7374  DBAPIS).def test
+00027c50: 5f65 7865 6375 7465 2863 7265 6465 6e74  _execute(credent
+00027c60: 6961 6c73 2c20 6462 6170 6929 3a0a 2020  ials, dbapi):.  
+00027c70: 2020 7769 7468 206d 6f63 6b2e 7061 7463    with mock.patc
+00027c80: 6828 6462 6170 692e 5f5f 6e61 6d65 5f5f  h(dbapi.__name__
+00027c90: 202b 2022 2e63 6f6e 6e65 6374 2229 2061   + ".connect") a
+00027ca0: 7320 6d6f 636b 5f63 6f6e 6e65 6374 3a0a  s mock_connect:.
+00027cb0: 2020 2020 2020 2020 7769 7468 2044 6174          with Dat
+00027cc0: 6162 6173 6528 6462 6170 693d 6462 6170  abase(dbapi=dbap
+00027cd0: 692c 202a 2a63 7265 6465 6e74 6961 6c73  i, **credentials
+00027ce0: 2920 6173 2074 6573 743a 0a20 2020 2020  ) as test:.     
+00027cf0: 2020 2020 2020 2070 7269 6e74 2874 6573         print(tes
+00027d00: 7429 0a20 2020 2020 2020 2020 2020 2074  t).            t
+00027d10: 6573 742e 6578 6563 7574 6528 2253 454c  est.execute("SEL
+00027d20: 4543 5420 2a20 4652 4f4d 2073 6f6d 655f  ECT * FROM some_
+00027d30: 7461 626c 6522 290a 2020 2020 2020 2020  table").        
+00027d40: 2020 2020 6173 7365 7274 2074 6573 742e      assert test.
+00027d50: 6375 7273 6f72 2e65 7865 6375 7465 2e63  cursor.execute.c
+00027d60: 616c 6c65 6420 6973 2054 7275 650a 0a0a  alled is True...
+00027d70: 4070 7974 6573 742e 6d61 726b 2e70 6172  @pytest.mark.par
+00027d80: 616d 6574 7269 7a65 2822 6462 6170 6922  ametrize("dbapi"
+00027d90: 2c20 4442 4150 4953 290a 6465 6620 7465  , DBAPIS).def te
+00027da0: 7374 5f65 7865 6375 7465 5f6e 6f5f 636f  st_execute_no_co
+00027db0: 6e6e 6563 7469 6f6e 5f65 7863 6570 7469  nnection_excepti
+00027dc0: 6f6e 2863 7265 6465 6e74 6961 6c73 2c20  on(credentials, 
+00027dd0: 6462 6170 6929 3a0a 2020 2020 7769 7468  dbapi):.    with
+00027de0: 206d 6f63 6b2e 7061 7463 6828 6462 6170   mock.patch(dbap
+00027df0: 692e 5f5f 6e61 6d65 5f5f 202b 2022 2e63  i.__name__ + ".c
+00027e00: 6f6e 6e65 6374 2229 2061 7320 6d6f 636b  onnect") as mock
+00027e10: 5f63 6f6e 6e65 6374 3a0a 2020 2020 2020  _connect:.      
+00027e20: 2020 7465 7374 203d 2044 6174 6162 6173    test = Databas
+00027e30: 6528 6462 6170 693d 6462 6170 692c 202a  e(dbapi=dbapi, *
+00027e40: 2a63 7265 6465 6e74 6961 6c73 290a 2020  *credentials).  
+00027e50: 2020 2020 2020 7465 7374 2e63 6f6e 6e20        test.conn 
+00027e60: 3d20 4e6f 6e65 0a20 2020 2020 2020 2074  = None.        t
+00027e70: 6573 742e 6375 7273 6f72 203d 204e 6f6e  est.cursor = Non
+00027e80: 650a 2020 2020 2020 2020 7769 7468 2070  e.        with p
+00027e90: 7974 6573 742e 7261 6973 6573 2844 4245  ytest.raises(DBE
+00027ea0: 7272 6f72 293a 0a20 2020 2020 2020 2020  rror):.         
+00027eb0: 2020 2074 6573 742e 6578 6563 7574 6528     test.execute(
+00027ec0: 2253 454c 4543 5420 2a20 4652 4f4d 2073  "SELECT * FROM s
+00027ed0: 6f6d 655f 7461 626c 6522 290a 0a0a 4070  ome_table")...@p
+00027ee0: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
+00027ef0: 6574 7269 7a65 2822 6462 6170 6922 2c20  etrize("dbapi", 
+00027f00: 4442 4150 4953 290a 6465 6620 7465 7374  DBAPIS).def test
+00027f10: 5f65 7865 6375 7465 5f73 716c 5f65 7863  _execute_sql_exc
+00027f20: 6570 7469 6f6e 2863 7265 6465 6e74 6961  eption(credentia
+00027f30: 6c73 2c20 6462 6170 6929 3a0a 2020 2020  ls, dbapi):.    
+00027f40: 7769 7468 206d 6f63 6b2e 7061 7463 6828  with mock.patch(
+00027f50: 6462 6170 692e 5f5f 6e61 6d65 5f5f 202b  dbapi.__name__ +
+00027f60: 2022 2e63 6f6e 6e65 6374 2229 2061 7320   ".connect") as 
+00027f70: 6d6f 636b 5f63 6f6e 6e65 6374 3a0a 2020  mock_connect:.  
+00027f80: 2020 2020 2020 7769 7468 2044 6174 6162        with Datab
+00027f90: 6173 6528 6462 6170 693d 6462 6170 692c  ase(dbapi=dbapi,
+00027fa0: 202a 2a63 7265 6465 6e74 6961 6c73 2920   **credentials) 
+00027fb0: 6173 2074 6573 743a 0a20 2020 2020 2020  as test:.       
+00027fc0: 2020 2020 2074 6573 742e 6375 7273 6f72       test.cursor
+00027fd0: 2e65 7865 6375 7465 2e73 6964 655f 6566  .execute.side_ef
+00027fe0: 6665 6374 203d 2045 7863 6570 7469 6f6e  fect = Exception
+00027ff0: 2822 5351 4c20 4578 6365 7074 696f 6e22  ("SQL Exception"
+00028000: 290a 2020 2020 2020 2020 2020 2020 7769  ).            wi
+00028010: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
+00028020: 2844 4245 7272 6f72 293a 0a20 2020 2020  (DBError):.     
+00028030: 2020 2020 2020 2020 2020 2074 6573 742e             test.
+00028040: 6578 6563 7574 6528 2253 454c 4543 5420  execute("SELECT 
+00028050: 2a20 4652 4f4d 2073 6f6d 655f 7461 626c  * FROM some_tabl
+00028060: 6522 290a 0a0a 4070 7974 6573 742e 6d61  e")...@pytest.ma
+00028070: 726b 2e70 6172 616d 6574 7269 7a65 2822  rk.parametrize("
+00028080: 6462 6170 6922 2c20 4442 4150 4953 290a  dbapi", DBAPIS).
+00028090: 406d 6f63 6b2e 7061 7463 6828 2270 616e  @mock.patch("pan
+000280a0: 6461 732e 4461 7461 4672 616d 6522 290a  das.DataFrame").
+000280b0: 6465 6620 7465 7374 5f74 6f5f 6461 7461  def test_to_data
+000280c0: 6672 616d 655f 616c 6c28 6d6f 636b 5f70  frame_all(mock_p
+000280d0: 616e 6461 732c 2063 7265 6465 6e74 6961  andas, credentia
+000280e0: 6c73 2c20 6462 6170 6929 3a0a 2020 2020  ls, dbapi):.    
+000280f0: 7769 7468 206d 6f63 6b2e 7061 7463 6828  with mock.patch(
+00028100: 6462 6170 692e 5f5f 6e61 6d65 5f5f 202b  dbapi.__name__ +
+00028110: 2022 2e63 6f6e 6e65 6374 2229 2061 7320   ".connect") as 
+00028120: 6d6f 636b 5f63 6f6e 6e65 6374 3a0a 2020  mock_connect:.  
+00028130: 2020 2020 2020 6d6f 636b 5f63 6f6e 6e65        mock_conne
+00028140: 6374 2e72 6574 7572 6e5f 7661 6c75 652e  ct.return_value.
+00028150: 6375 7273 6f72 2e72 6574 7572 6e5f 7661  cursor.return_va
+00028160: 6c75 652e 6665 7463 6861 6c6c 2e72 6574  lue.fetchall.ret
+00028170: 7572 6e5f 7661 6c75 6520 3d20 5b28 312c  urn_value = [(1,
+00028180: 2032 292c 2028 322c 2033 292c 2028 332c   2), (2, 3), (3,
+00028190: 295d 0a20 2020 2020 2020 2077 6974 6820  )].        with 
+000281a0: 4461 7461 6261 7365 2864 6261 7069 3d64  Database(dbapi=d
+000281b0: 6261 7069 2c20 2a2a 6372 6564 656e 7469  bapi, **credenti
+000281c0: 616c 7329 2061 7320 7465 7374 3a0a 2020  als) as test:.  
+000281d0: 2020 2020 2020 2020 2020 7465 7374 2e65            test.e
+000281e0: 7865 6375 7465 2822 5345 4c45 4354 2027  xecute("SELECT '
+000281f0: 6865 6c6c 6f20 776f 726c 6427 2041 5320  hello world' AS 
+00028200: 666c 6422 290a 2020 2020 2020 2020 2020  fld").          
+00028210: 2020 6466 203d 2074 6573 742e 746f 5f64    df = test.to_d
+00028220: 6174 6166 7261 6d65 2829 0a0a 2020 2020  ataframe()..    
+00028230: 6173 7365 7274 206d 6f63 6b5f 636f 6e6e  assert mock_conn
+00028240: 6563 742e 7265 7475 726e 5f76 616c 7565  ect.return_value
+00028250: 2e63 7572 736f 722e 7265 7475 726e 5f76  .cursor.return_v
+00028260: 616c 7565 2e66 6574 6368 616c 6c2e 6361  alue.fetchall.ca
+00028270: 6c6c 6564 0a20 2020 206d 6f63 6b5f 7061  lled.    mock_pa
+00028280: 6e64 6173 2e61 7373 6572 745f 6361 6c6c  ndas.assert_call
+00028290: 6564 5f77 6974 6828 7465 7374 2e63 7572  ed_with(test.cur
+000282a0: 736f 722e 6665 7463 6861 6c6c 2829 2c20  sor.fetchall(), 
+000282b0: 636f 6c75 6d6e 733d 5b5d 290a 0a0a 4070  columns=[])...@p
+000282c0: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
+000282d0: 6574 7269 7a65 2822 6462 6170 6922 2c20  etrize("dbapi", 
+000282e0: 4442 4150 4953 290a 406d 6f63 6b2e 7061  DBAPIS).@mock.pa
+000282f0: 7463 6828 2270 616e 6461 732e 4461 7461  tch("pandas.Data
+00028300: 4672 616d 6522 290a 6465 6620 7465 7374  Frame").def test
+00028310: 5f74 6f5f 6461 7461 6672 616d 655f 6375  _to_dataframe_cu
+00028320: 7374 6f6d 5f73 697a 6528 6d6f 636b 5f70  stom_size(mock_p
+00028330: 616e 6461 732c 2063 7265 6465 6e74 6961  andas, credentia
+00028340: 6c73 2c20 6462 6170 6929 3a0a 2020 2020  ls, dbapi):.    
+00028350: 7769 7468 206d 6f63 6b2e 7061 7463 6828  with mock.patch(
+00028360: 6462 6170 692e 5f5f 6e61 6d65 5f5f 202b  dbapi.__name__ +
+00028370: 2022 2e63 6f6e 6e65 6374 2229 2061 7320   ".connect") as 
+00028380: 6d6f 636b 5f63 6f6e 6e65 6374 3a0a 2020  mock_connect:.  
+00028390: 2020 2020 2020 6d6f 636b 5f63 6f6e 6e65        mock_conne
+000283a0: 6374 2e72 6574 7572 6e5f 7661 6c75 652e  ct.return_value.
+000283b0: 6375 7273 6f72 2e72 6574 7572 6e5f 7661  cursor.return_va
+000283c0: 6c75 652e 6665 7463 686d 616e 792e 7265  lue.fetchmany.re
+000283d0: 7475 726e 5f76 616c 7565 203d 205b 0a20  turn_value = [. 
+000283e0: 2020 2020 2020 2020 2020 2028 312c 2032             (1, 2
+000283f0: 292c 0a20 2020 2020 2020 2020 2020 2028  ),.            (
+00028400: 322c 2033 292c 0a20 2020 2020 2020 2020  2, 3),.         
+00028410: 2020 2028 332c 292c 0a20 2020 2020 2020     (3,),.       
+00028420: 205d 0a20 2020 2020 2020 2077 6974 6820   ].        with 
+00028430: 4461 7461 6261 7365 2864 6261 7069 3d64  Database(dbapi=d
+00028440: 6261 7069 2c20 2a2a 6372 6564 656e 7469  bapi, **credenti
+00028450: 616c 7329 2061 7320 7465 7374 3a0a 2020  als) as test:.  
+00028460: 2020 2020 2020 2020 2020 7465 7374 2e65            test.e
+00028470: 7865 6375 7465 2822 5345 4c45 4354 2027  xecute("SELECT '
+00028480: 6865 6c6c 6f20 776f 726c 6427 2041 5320  hello world' AS 
+00028490: 666c 6422 290a 2020 2020 2020 2020 2020  fld").          
+000284a0: 2020 6466 203d 2074 6573 742e 746f 5f64    df = test.to_d
+000284b0: 6174 6166 7261 6d65 2873 697a 653d 3529  ataframe(size=5)
+000284c0: 0a0a 2020 2020 6d6f 636b 5f63 6f6e 6e65  ..    mock_conne
+000284d0: 6374 2e72 6574 7572 6e5f 7661 6c75 652e  ct.return_value.
+000284e0: 6375 7273 6f72 2e72 6574 7572 6e5f 7661  cursor.return_va
+000284f0: 6c75 652e 6665 7463 686d 616e 792e 6173  lue.fetchmany.as
+00028500: 7365 7274 5f63 616c 6c65 645f 7769 7468  sert_called_with
+00028510: 2835 290a 2020 2020 6d6f 636b 5f70 616e  (5).    mock_pan
+00028520: 6461 732e 6173 7365 7274 5f63 616c 6c65  das.assert_calle
+00028530: 645f 7769 7468 2874 6573 742e 6375 7273  d_with(test.curs
+00028540: 6f72 2e66 6574 6368 6d61 6e79 2829 2c20  or.fetchmany(), 
+00028550: 636f 6c75 6d6e 733d 5b5d 290a 0a0a 4070  columns=[])...@p
+00028560: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
+00028570: 6574 7269 7a65 2822 6462 6170 6922 2c20  etrize("dbapi", 
+00028580: 4442 4150 4953 290a 406d 6f63 6b2e 7061  DBAPIS).@mock.pa
+00028590: 7463 6828 2270 616e 6461 732e 4461 7461  tch("pandas.Data
+000285a0: 4672 616d 6522 290a 6465 6620 7465 7374  Frame").def test
+000285b0: 5f74 6f5f 6461 7461 6672 616d 655f 6e6f  _to_dataframe_no
+000285c0: 6e65 286d 6f63 6b5f 7061 6e64 6173 2c20  ne(mock_pandas, 
+000285d0: 6372 6564 656e 7469 616c 732c 2064 6261  credentials, dba
+000285e0: 7069 293a 0a20 2020 2077 6974 6820 6d6f  pi):.    with mo
+000285f0: 636b 2e70 6174 6368 2864 6261 7069 2e5f  ck.patch(dbapi._
+00028600: 5f6e 616d 655f 5f20 2b20 222e 636f 6e6e  _name__ + ".conn
+00028610: 6563 7422 2920 6173 206d 6f63 6b5f 636f  ect") as mock_co
+00028620: 6e6e 6563 743a 0a20 2020 2020 2020 206d  nnect:.        m
+00028630: 6f63 6b5f 636f 6e6e 6563 742e 7265 7475  ock_connect.retu
+00028640: 726e 5f76 616c 7565 2e63 7572 736f 722e  rn_value.cursor.
+00028650: 7265 7475 726e 5f76 616c 7565 2e66 6574  return_value.fet
+00028660: 6368 6d61 6e79 2e72 6574 7572 6e5f 7661  chmany.return_va
+00028670: 6c75 6520 3d20 5b5d 0a20 2020 2020 2020  lue = [].       
+00028680: 2077 6974 6820 4461 7461 6261 7365 2864   with Database(d
+00028690: 6261 7069 3d64 6261 7069 2c20 2a2a 6372  bapi=dbapi, **cr
+000286a0: 6564 656e 7469 616c 7329 2061 7320 7465  edentials) as te
+000286b0: 7374 3a0a 2020 2020 2020 2020 2020 2020  st:.            
+000286c0: 7465 7374 2e65 7865 6375 7465 2822 5345  test.execute("SE
+000286d0: 4c45 4354 2027 6865 6c6c 6f20 776f 726c  LECT 'hello worl
+000286e0: 6427 2057 4845 5245 2031 3d30 2229 0a20  d' WHERE 1=0"). 
+000286f0: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+00028700: 7420 7465 7374 2e74 6f5f 6461 7461 6672  t test.to_datafr
+00028710: 616d 6528 7369 7a65 3d35 2920 6973 204e  ame(size=5) is N
+00028720: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+00028730: 6d6f 636b 5f70 616e 6461 732e 6173 7365  mock_pandas.asse
+00028740: 7274 5f6e 6f74 5f63 616c 6c65 6428 290a  rt_not_called().
+00028750: 0a0a 4070 7974 6573 742e 6d61 726b 2e70  ..@pytest.mark.p
+00028760: 6172 616d 6574 7269 7a65 2822 6462 6170  arametrize("dbap
+00028770: 6922 2c20 4442 4150 4953 290a 6465 6620  i", DBAPIS).def 
+00028780: 7465 7374 5f67 6574 5f63 6f6c 756d 6e5f  test_get_column_
+00028790: 6e61 6d65 7328 6372 6564 656e 7469 616c  names(credential
+000287a0: 732c 2064 6261 7069 293a 0a20 2020 2077  s, dbapi):.    w
+000287b0: 6974 6820 6d6f 636b 2e70 6174 6368 2864  ith mock.patch(d
+000287c0: 6261 7069 2e5f 5f6e 616d 655f 5f20 2b20  bapi.__name__ + 
+000287d0: 222e 636f 6e6e 6563 7422 2920 6173 206d  ".connect") as m
+000287e0: 6f63 6b5f 636f 6e6e 6563 743a 0a20 2020  ock_connect:.   
+000287f0: 2020 2020 206d 6f63 6b5f 636f 6e6e 6563       mock_connec
+00028800: 742e 7265 7475 726e 5f76 616c 7565 2e63  t.return_value.c
+00028810: 7572 736f 722e 7265 7475 726e 5f76 616c  ursor.return_val
+00028820: 7565 2e64 6573 6372 6970 7469 6f6e 203d  ue.description =
+00028830: 205b 5b22 434f 4c31 225d 2c20 5b22 434f   [["COL1"], ["CO
+00028840: 4c32 225d 5d0a 2020 2020 2020 2020 7769  L2"]].        wi
+00028850: 7468 2044 6174 6162 6173 6528 6462 6170  th Database(dbap
+00028860: 693d 6462 6170 692c 202a 2a63 7265 6465  i=dbapi, **crede
+00028870: 6e74 6961 6c73 2920 6173 2074 6573 743a  ntials) as test:
+00028880: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
+00028890: 6572 7420 7465 7374 2e63 6f6c 756d 6e5f  ert test.column_
+000288a0: 6e61 6d65 7328 2920 3d3d 205b 2263 6f6c  names() == ["col
+000288b0: 3122 2c20 2263 6f6c 3222 5d0a 0a20 2020  1", "col2"]..   
+000288c0: 2020 2020 206d 6f63 6b5f 636f 6e6e 6563       mock_connec
+000288d0: 742e 7265 7475 726e 5f76 616c 7565 2e63  t.return_value.c
+000288e0: 7572 736f 722e 7265 7475 726e 5f76 616c  ursor.return_val
+000288f0: 7565 2e64 6573 6372 6970 7469 6f6e 203d  ue.description =
+00028900: 205b 2822 434f 4c31 222c 292c 2028 2243   [("COL1",), ("C
+00028910: 4f4c 3222 2c29 5d0a 2020 2020 2020 2020  OL2",)].        
+00028920: 7769 7468 2044 6174 6162 6173 6528 6462  with Database(db
+00028930: 6170 693d 6462 6170 692c 202a 2a63 7265  api=dbapi, **cre
+00028940: 6465 6e74 6961 6c73 2920 6173 2074 6573  dentials) as tes
+00028950: 743a 0a20 2020 2020 2020 2020 2020 2061  t:.            a
+00028960: 7373 6572 7420 7465 7374 2e63 6f6c 756d  ssert test.colum
+00028970: 6e5f 6e61 6d65 7328 2920 3d3d 205b 2263  n_names() == ["c
+00028980: 6f6c 3122 2c20 2263 6f6c 3222 5d0a 0a20  ol1", "col2"].. 
+00028990: 2020 2020 2020 206d 6f63 6b5f 636f 6e6e         mock_conn
+000289a0: 6563 742e 7265 7475 726e 5f76 616c 7565  ect.return_value
+000289b0: 2e63 7572 736f 722e 7265 7475 726e 5f76  .cursor.return_v
+000289c0: 616c 7565 2e64 6573 6372 6970 7469 6f6e  alue.description
+000289d0: 203d 2028 2822 434f 4c31 222c 292c 2028   = (("COL1",), (
+000289e0: 2243 4f4c 3222 2c29 290a 2020 2020 2020  "COL2",)).      
+000289f0: 2020 7769 7468 2044 6174 6162 6173 6528    with Database(
+00028a00: 6462 6170 693d 6462 6170 692c 202a 2a63  dbapi=dbapi, **c
+00028a10: 7265 6465 6e74 6961 6c73 2920 6173 2074  redentials) as t
+00028a20: 6573 743a 0a20 2020 2020 2020 2020 2020  est:.           
+00028a30: 2061 7373 6572 7420 7465 7374 2e63 6f6c   assert test.col
+00028a40: 756d 6e5f 6e61 6d65 7328 2920 3d3d 205b  umn_names() == [
+00028a50: 2263 6f6c 3122 2c20 2263 6f6c 3222 5d0a  "col1", "col2"].
+00028a60: 0a0a 4070 7974 6573 742e 6d61 726b 2e70  ..@pytest.mark.p
+00028a70: 6172 616d 6574 7269 7a65 2822 6462 6170  arametrize("dbap
+00028a80: 6922 2c20 4442 4150 4953 290a 6465 6620  i", DBAPIS).def 
+00028a90: 7465 7374 5f74 6f5f 6469 6374 2863 7265  test_to_dict(cre
+00028aa0: 6465 6e74 6961 6c73 2c20 6462 6170 6929  dentials, dbapi)
+00028ab0: 3a0a 2020 2020 6465 6620 636f 6c73 2829  :.    def cols()
+00028ac0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+00028ad0: 205b 2263 6f6c 3122 2c20 2263 6f6c 3222   ["col1", "col2"
+00028ae0: 5d0a 0a20 2020 2074 6573 7420 3d20 4461  ]..    test = Da
+00028af0: 7461 6261 7365 2864 6261 7069 3d64 6261  tabase(dbapi=dba
+00028b00: 7069 2c20 2a2a 6372 6564 656e 7469 616c  pi, **credential
+00028b10: 7329 0a0a 2020 2020 7465 7374 2e63 6f6c  s)..    test.col
+00028b20: 756d 6e5f 6e61 6d65 7320 3d20 636f 6c73  umn_names = cols
+00028b30: 0a20 2020 2074 6573 742e 6375 7273 6f72  .    test.cursor
+00028b40: 203d 205b 2831 2c20 3229 2c20 2832 2c20   = [(1, 2), (2, 
+00028b50: 3329 2c20 2833 2c29 5d0a 2020 2020 6173  3), (3,)].    as
+00028b60: 7365 7274 206c 6973 7428 7465 7374 2e74  sert list(test.t
+00028b70: 6f5f 6469 6374 2829 2920 3d3d 205b 7b22  o_dict()) == [{"
+00028b80: 636f 6c31 223a 2031 2c20 2263 6f6c 3222  col1": 1, "col2"
+00028b90: 3a20 327d 2c20 7b22 636f 6c31 223a 2032  : 2}, {"col1": 2
+00028ba0: 2c20 2263 6f6c 3222 3a20 337d 2c20 7b22  , "col2": 3}, {"
+00028bb0: 636f 6c31 223a 2033 7d5d 0a0a 2020 2020  col1": 3}]..    
+00028bc0: 7465 7374 2e63 6f6c 756d 6e5f 6e61 6d65  test.column_name
+00028bd0: 7320 3d20 636f 6c73 0a20 2020 2074 6573  s = cols.    tes
+00028be0: 742e 6375 7273 6f72 203d 205b 2822 6122  t.cursor = [("a"
+00028bf0: 2c20 3229 2c20 2832 2c20 3329 2c20 2822  , 2), (2, 3), ("
+00028c00: 6222 2c29 5d0a 2020 2020 6173 7365 7274  b",)].    assert
+00028c10: 206c 6973 7428 7465 7374 2e74 6f5f 6469   list(test.to_di
+00028c20: 6374 2829 2920 3d3d 205b 7b22 636f 6c31  ct()) == [{"col1
+00028c30: 223a 2022 6122 2c20 2263 6f6c 3222 3a20  ": "a", "col2": 
+00028c40: 327d 2c20 7b22 636f 6c31 223a 2032 2c20  2}, {"col1": 2, 
+00028c50: 2263 6f6c 3222 3a20 337d 2c20 7b22 636f  "col2": 3}, {"co
+00028c60: 6c31 223a 2022 6222 7d5d 0a00 0000 0000  l1": "b"}]......
+00028c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028e00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00028e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028e60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00028e70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00028e80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00028e90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+00028ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028f00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00028f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028f40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00028f50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00028f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00028ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029000: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+00029010: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
+00029020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000290a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000290b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000290c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000290d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000290e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000290f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000291a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000291b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000291c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000291d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000291e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000291f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029200: 6c6f 636f 7079 2d30 2e35 2e31 2f74 6573  locopy-0.5.1/tes
+00029210: 7473 2f74 6573 745f 696e 7465 6772 6174  ts/test_integrat
+00029220: 696f 6e2e 7079 0000 0000 0000 0000 0000  ion.py..........
+00029230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029260: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00029270: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00029280: 3030 3234 3232 3400 3030 3030 3030 3030  0024224.00000000
+00029290: 3030 3000 3032 3037 3236 0020 3000 0000  000.020726. 0...
+000292a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000292b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000292c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000292d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000292e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000292f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029300: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00029310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029320: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00029330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00029350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00029360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000293a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000293b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000293c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000293d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000293e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000293f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00029400: 2320 4d49 5420 4c69 6365 6e73 650a 230a  # MIT License.#.
+00029410: 2320 436f 7079 7269 6768 7420 2863 2920  # Copyright (c) 
+00029420: 3230 3138 2043 6170 6974 616c 204f 6e65  2018 Capital One
+00029430: 2053 6572 7669 6365 732c 204c 4c43 0a23   Services, LLC.#
+00029440: 0a23 2050 6572 6d69 7373 696f 6e20 6973  .# Permission is
+00029450: 2068 6572 6562 7920 6772 616e 7465 642c   hereby granted,
+00029460: 2066 7265 6520 6f66 2063 6861 7267 652c   free of charge,
+00029470: 2074 6f20 616e 7920 7065 7273 6f6e 206f   to any person o
+00029480: 6274 6169 6e69 6e67 2061 2063 6f70 790a  btaining a copy.
+00029490: 2320 6f66 2074 6869 7320 736f 6674 7761  # of this softwa
+000294a0: 7265 2061 6e64 2061 7373 6f63 6961 7465  re and associate
+000294b0: 6420 646f 6375 6d65 6e74 6174 696f 6e20  d documentation 
+000294c0: 6669 6c65 7320 2874 6865 2022 536f 6674  files (the "Soft
+000294d0: 7761 7265 2229 2c20 746f 2064 6561 6c0a  ware"), to deal.
+000294e0: 2320 696e 2074 6865 2053 6f66 7477 6172  # in the Softwar
+000294f0: 6520 7769 7468 6f75 7420 7265 7374 7269  e without restri
+00029500: 6374 696f 6e2c 2069 6e63 6c75 6469 6e67  ction, including
+00029510: 2077 6974 686f 7574 206c 696d 6974 6174   without limitat
+00029520: 696f 6e20 7468 6520 7269 6768 7473 0a23  ion the rights.#
+00029530: 2074 6f20 7573 652c 2063 6f70 792c 206d   to use, copy, m
+00029540: 6f64 6966 792c 206d 6572 6765 2c20 7075  odify, merge, pu
+00029550: 626c 6973 682c 2064 6973 7472 6962 7574  blish, distribut
+00029560: 652c 2073 7562 6c69 6365 6e73 652c 2061  e, sublicense, a
+00029570: 6e64 2f6f 7220 7365 6c6c 0a23 2063 6f70  nd/or sell.# cop
+00029580: 6965 7320 6f66 2074 6865 2053 6f66 7477  ies of the Softw
+00029590: 6172 652c 2061 6e64 2074 6f20 7065 726d  are, and to perm
+000295a0: 6974 2070 6572 736f 6e73 2074 6f20 7768  it persons to wh
+000295b0: 6f6d 2074 6865 2053 6f66 7477 6172 6520  om the Software 
+000295c0: 6973 0a23 2066 7572 6e69 7368 6564 2074  is.# furnished t
+000295d0: 6f20 646f 2073 6f2c 2073 7562 6a65 6374  o do so, subject
+000295e0: 2074 6f20 7468 6520 666f 6c6c 6f77 696e   to the followin
+000295f0: 6720 636f 6e64 6974 696f 6e73 3a0a 230a  g conditions:.#.
+00029600: 2320 5468 6520 6162 6f76 6520 636f 7079  # The above copy
+00029610: 7269 6768 7420 6e6f 7469 6365 2061 6e64  right notice and
+00029620: 2074 6869 7320 7065 726d 6973 7369 6f6e   this permission
+00029630: 206e 6f74 6963 6520 7368 616c 6c20 6265   notice shall be
+00029640: 2069 6e63 6c75 6465 6420 696e 2061 6c6c   included in all
+00029650: 0a23 2063 6f70 6965 7320 6f72 2073 7562  .# copies or sub
+00029660: 7374 616e 7469 616c 2070 6f72 7469 6f6e  stantial portion
+00029670: 7320 6f66 2074 6865 2053 6f66 7477 6172  s of the Softwar
+00029680: 652e 0a23 0a23 2054 4845 2053 4f46 5457  e..#.# THE SOFTW
+00029690: 4152 4520 4953 2050 524f 5649 4445 4420  ARE IS PROVIDED 
+000296a0: 2241 5320 4953 222c 2057 4954 484f 5554  "AS IS", WITHOUT
+000296b0: 2057 4152 5241 4e54 5920 4f46 2041 4e59   WARRANTY OF ANY
+000296c0: 204b 494e 442c 2045 5850 5245 5353 204f   KIND, EXPRESS O
+000296d0: 520a 2320 494d 504c 4945 442c 2049 4e43  R.# IMPLIED, INC
+000296e0: 4c55 4449 4e47 2042 5554 204e 4f54 204c  LUDING BUT NOT L
+000296f0: 494d 4954 4544 2054 4f20 5448 4520 5741  IMITED TO THE WA
+00029700: 5252 414e 5449 4553 204f 4620 4d45 5243  RRANTIES OF MERC
+00029710: 4841 4e54 4142 494c 4954 592c 0a23 2046  HANTABILITY,.# F
+00029720: 4954 4e45 5353 2046 4f52 2041 2050 4152  ITNESS FOR A PAR
+00029730: 5449 4355 4c41 5220 5055 5250 4f53 4520  TICULAR PURPOSE 
+00029740: 414e 4420 4e4f 4e49 4e46 5249 4e47 454d  AND NONINFRINGEM
+00029750: 454e 542e 2049 4e20 4e4f 2045 5645 4e54  ENT. IN NO EVENT
+00029760: 2053 4841 4c4c 2054 4845 0a23 2041 5554   SHALL THE.# AUT
+00029770: 484f 5253 204f 5220 434f 5059 5249 4748  HORS OR COPYRIGH
+00029780: 5420 484f 4c44 4552 5320 4245 204c 4941  T HOLDERS BE LIA
+00029790: 424c 4520 464f 5220 414e 5920 434c 4149  BLE FOR ANY CLAI
+000297a0: 4d2c 2044 414d 4147 4553 204f 5220 4f54  M, DAMAGES OR OT
+000297b0: 4845 520a 2320 4c49 4142 494c 4954 592c  HER.# LIABILITY,
+000297c0: 2057 4845 5448 4552 2049 4e20 414e 2041   WHETHER IN AN A
+000297d0: 4354 494f 4e20 4f46 2043 4f4e 5452 4143  CTION OF CONTRAC
+000297e0: 542c 2054 4f52 5420 4f52 204f 5448 4552  T, TORT OR OTHER
+000297f0: 5749 5345 2c20 4152 4953 494e 4720 4652  WISE, ARISING FR
+00029800: 4f4d 2c0a 2320 4f55 5420 4f46 204f 5220  OM,.# OUT OF OR 
+00029810: 494e 2043 4f4e 4e45 4354 494f 4e20 5749  IN CONNECTION WI
+00029820: 5448 2054 4845 2053 4f46 5457 4152 4520  TH THE SOFTWARE 
+00029830: 4f52 2054 4845 2055 5345 204f 5220 4f54  OR THE USE OR OT
+00029840: 4845 5220 4445 414c 494e 4753 2049 4e20  HER DEALINGS IN 
+00029850: 5448 450a 2320 534f 4654 5741 5245 2e0a  THE.# SOFTWARE..
+00029860: 0a69 6d70 6f72 7420 6669 6c65 636d 700a  .import filecmp.
+00029870: 696d 706f 7274 206f 730a 6672 6f6d 2070  import os.from p
+00029880: 6174 686c 6962 2069 6d70 6f72 7420 5061  athlib import Pa
+00029890: 7468 0a0a 696d 706f 7274 2062 6f74 6f33  th..import boto3
+000298a0: 0a69 6d70 6f72 7420 6e75 6d70 7920 6173  .import numpy as
+000298b0: 206e 700a 696d 706f 7274 2070 616e 6461   np.import panda
+000298c0: 7320 6173 2070 640a 696d 706f 7274 2070  s as pd.import p
+000298d0: 6738 3030 300a 696d 706f 7274 2070 7379  g8000.import psy
+000298e0: 636f 7067 320a 696d 706f 7274 2070 7974  copg2.import pyt
+000298f0: 6573 740a 0a69 6d70 6f72 7420 6c6f 636f  est..import loco
+00029900: 7079 0a0a 4442 4150 4953 203d 205b 7067  py..DBAPIS = [pg
+00029910: 3830 3030 2c20 7073 7963 6f70 6732 5d0a  8000, psycopg2].
+00029920: 494e 5445 4752 4154 494f 4e5f 4352 4544  INTEGRATION_CRED
+00029930: 5320 3d20 7374 7228 5061 7468 2e68 6f6d  S = str(Path.hom
+00029940: 6528 2929 202b 2022 2f2e 6c6f 636f 7079  e()) + "/.locopy
+00029950: 7263 220a 5333 5f42 5543 4b45 5420 3d20  rc".S3_BUCKET = 
+00029960: 226c 6f63 6f70 792d 696e 7465 6772 6174  "locopy-integrat
+00029970: 696f 6e2d 7465 7374 696e 6722 0a43 5552  ion-testing".CUR
+00029980: 525f 4449 5220 3d20 6f73 2e70 6174 682e  R_DIR = os.path.
+00029990: 6469 726e 616d 6528 6f73 2e70 6174 682e  dirname(os.path.
+000299a0: 6162 7370 6174 6828 5f5f 6669 6c65 5f5f  abspath(__file__
+000299b0: 2929 0a4c 4f43 414c 5f46 494c 4520 3d20  )).LOCAL_FILE = 
+000299c0: 6f73 2e70 6174 682e 6a6f 696e 2843 5552  os.path.join(CUR
+000299d0: 525f 4449 522c 2022 6461 7461 222c 2022  R_DIR, "data", "
+000299e0: 6d6f 636b 5f66 696c 652e 7478 7422 290a  mock_file.txt").
+000299f0: 4c4f 4341 4c5f 4649 4c45 5f48 4541 4445  LOCAL_FILE_HEADE
+00029a00: 5220 3d20 6f73 2e70 6174 682e 6a6f 696e  R = os.path.join
+00029a10: 2843 5552 525f 4449 522c 2022 6461 7461  (CURR_DIR, "data
+00029a20: 222c 2022 6d6f 636b 5f66 696c 655f 6865  ", "mock_file_he
+00029a30: 6164 6572 2e74 7874 2229 0a4c 4f43 414c  ader.txt").LOCAL
+00029a40: 5f46 494c 455f 444c 203d 206f 732e 7061  _FILE_DL = os.pa
+00029a50: 7468 2e6a 6f69 6e28 4355 5252 5f44 4952  th.join(CURR_DIR
+00029a60: 2c20 2264 6174 6122 2c20 226d 6f63 6b5f  , "data", "mock_
+00029a70: 6669 6c65 5f64 6c2e 7478 7422 290a 554e  file_dl.txt").UN
+00029a80: 4c4f 4144 5f50 4154 4820 3d20 6f73 2e70  LOAD_PATH = os.p
+00029a90: 6174 682e 6a6f 696e 2843 5552 525f 4449  ath.join(CURR_DI
+00029aa0: 522c 2022 6461 7461 222c 2022 756e 6c6f  R, "data", "unlo
+00029ab0: 6164 5f70 6174 6822 290a 5445 5354 5f44  ad_path").TEST_D
+00029ac0: 4620 3d20 7064 2e72 6561 645f 6373 7628  F = pd.read_csv(
+00029ad0: 6f73 2e70 6174 682e 6a6f 696e 2843 5552  os.path.join(CUR
+00029ae0: 525f 4449 522c 2022 6461 7461 222c 2022  R_DIR, "data", "
+00029af0: 6d6f 636b 5f64 6174 6166 7261 6d65 2e74  mock_dataframe.t
+00029b00: 7874 2229 2c20 7365 703d 222c 2229 0a54  xt"), sep=",").T
+00029b10: 4553 545f 4446 5f32 203d 2070 642e 7265  EST_DF_2 = pd.re
+00029b20: 6164 5f63 7376 286f 732e 7061 7468 2e6a  ad_csv(os.path.j
+00029b30: 6f69 6e28 4355 5252 5f44 4952 2c20 2264  oin(CURR_DIR, "d
+00029b40: 6174 6122 2c20 226d 6f63 6b5f 6461 7461  ata", "mock_data
+00029b50: 6672 616d 655f 322e 7478 7422 292c 2073  frame_2.txt"), s
+00029b60: 6570 3d22 2c22 290a 0a43 5245 4453 5f44  ep=",")..CREDS_D
+00029b70: 4943 5420 3d20 6c6f 636f 7079 2e75 7469  ICT = locopy.uti
+00029b80: 6c69 7479 2e72 6561 645f 636f 6e66 6967  lity.read_config
+00029b90: 5f79 616d 6c28 494e 5445 4752 4154 494f  _yaml(INTEGRATIO
+00029ba0: 4e5f 4352 4544 5329 0a0a 0a40 7079 7465  N_CREDS)...@pyte
+00029bb0: 7374 2e66 6978 7475 7265 2829 0a64 6566  st.fixture().def
+00029bc0: 2073 335f 6275 636b 6574 2829 3a0a 2020   s3_bucket():.  
+00029bd0: 2020 7365 7373 696f 6e20 3d20 626f 746f    session = boto
+00029be0: 332e 5365 7373 696f 6e28 7072 6f66 696c  3.Session(profil
+00029bf0: 655f 6e61 6d65 3d43 5245 4453 5f44 4943  e_name=CREDS_DIC
+00029c00: 545b 2270 726f 6669 6c65 225d 290a 2020  T["profile"]).  
+00029c10: 2020 6320 3d20 7365 7373 696f 6e2e 636c    c = session.cl
+00029c20: 6965 6e74 2822 7333 2229 0a20 2020 2063  ient("s3").    c
+00029c30: 2e63 7265 6174 655f 6275 636b 6574 2842  .create_bucket(B
+00029c40: 7563 6b65 743d 5333 5f42 5543 4b45 5429  ucket=S3_BUCKET)
+00029c50: 0a20 2020 2079 6965 6c64 2063 0a20 2020  .    yield c.   
+00029c60: 2072 203d 2073 6573 7369 6f6e 2e72 6573   r = session.res
+00029c70: 6f75 7263 6528 2273 3322 292e 4275 636b  ource("s3").Buck
+00029c80: 6574 2853 335f 4255 434b 4554 290a 2020  et(S3_BUCKET).  
+00029c90: 2020 722e 6f62 6a65 6374 732e 616c 6c28    r.objects.all(
+00029ca0: 292e 6465 6c65 7465 2829 0a20 2020 2072  ).delete().    r
+00029cb0: 2e64 656c 6574 6528 290a 0a0a 4070 7974  .delete()...@pyt
+00029cc0: 6573 742e 6d61 726b 2e69 6e74 6567 7261  est.mark.integra
+00029cd0: 7469 6f6e 0a40 7079 7465 7374 2e6d 6172  tion.@pytest.mar
+00029ce0: 6b2e 7061 7261 6d65 7472 697a 6528 2264  k.parametrize("d
+00029cf0: 6261 7069 222c 2044 4241 5049 5329 0a64  bapi", DBAPIS).d
+00029d00: 6566 2074 6573 745f 7265 6473 6869 6674  ef test_redshift
+00029d10: 5f65 7865 6375 7465 5f73 696e 676c 655f  _execute_single_
+00029d20: 726f 7773 2864 6261 7069 293a 0a0a 2020  rows(dbapi):..  
+00029d30: 2020 6578 7065 6374 6564 203d 2070 642e    expected = pd.
+00029d40: 4461 7461 4672 616d 6528 7b22 6669 656c  DataFrame({"fiel
+00029d50: 645f 3122 3a20 5b31 5d2c 2022 6669 656c  d_1": [1], "fiel
+00029d60: 645f 3222 3a20 5b32 5d7d 290a 2020 2020  d_2": [2]}).    
+00029d70: 7769 7468 206c 6f63 6f70 792e 5265 6473  with locopy.Reds
+00029d80: 6869 6674 2864 6261 7069 3d64 6261 7069  hift(dbapi=dbapi
+00029d90: 2c20 2a2a 4352 4544 535f 4449 4354 2920  , **CREDS_DICT) 
+00029da0: 6173 2074 6573 743a 0a20 2020 2020 2020  as test:.       
+00029db0: 2074 6573 742e 6578 6563 7574 6528 2253   test.execute("S
+00029dc0: 454c 4543 5420 3120 4153 2066 6965 6c64  ELECT 1 AS field
+00029dd0: 5f31 2c20 3220 4153 2066 6965 6c64 5f32  _1, 2 AS field_2
+00029de0: 2022 290a 2020 2020 2020 2020 6466 203d   ").        df =
+00029df0: 2074 6573 742e 746f 5f64 6174 6166 7261   test.to_datafra
+00029e00: 6d65 2829 0a0a 2020 2020 6173 7365 7274  me()..    assert
+00029e10: 206e 702e 616c 6c63 6c6f 7365 2864 665b   np.allclose(df[
+00029e20: 2266 6965 6c64 5f31 225d 2c20 6578 7065  "field_1"], expe
+00029e30: 6374 6564 5b22 6669 656c 645f 3122 5d29  cted["field_1"])
+00029e40: 0a0a 0a40 7079 7465 7374 2e6d 6172 6b2e  ...@pytest.mark.
+00029e50: 696e 7465 6772 6174 696f 6e0a 4070 7974  integration.@pyt
+00029e60: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
+00029e70: 7269 7a65 2822 6462 6170 6922 2c20 4442  rize("dbapi", DB
+00029e80: 4150 4953 290a 6465 6620 7465 7374 5f72  APIS).def test_r
+00029e90: 6564 7368 6966 745f 6578 6563 7574 655f  edshift_execute_
+00029ea0: 6d75 6c74 6970 6c65 5f72 6f77 7328 6462  multiple_rows(db
+00029eb0: 6170 6929 3a0a 0a20 2020 2065 7870 6563  api):..    expec
+00029ec0: 7465 6420 3d20 7064 2e44 6174 6146 7261  ted = pd.DataFra
+00029ed0: 6d65 287b 2266 6965 6c64 5f31 223a 205b  me({"field_1": [
+00029ee0: 312c 2032 5d2c 2022 6669 656c 645f 3222  1, 2], "field_2"
+00029ef0: 3a20 5b31 2c20 325d 7d29 0a20 2020 2077  : [1, 2]}).    w
+00029f00: 6974 6820 6c6f 636f 7079 2e52 6564 7368  ith locopy.Redsh
+00029f10: 6966 7428 6462 6170 693d 6462 6170 692c  ift(dbapi=dbapi,
+00029f20: 202a 2a43 5245 4453 5f44 4943 5429 2061   **CREDS_DICT) a
+00029f30: 7320 7465 7374 3a0a 2020 2020 2020 2020  s test:.        
+00029f40: 7465 7374 2e65 7865 6375 7465 280a 2020  test.execute(.  
+00029f50: 2020 2020 2020 2020 2020 2253 454c 4543            "SELEC
+00029f60: 5420 3120 4153 2066 6965 6c64 5f31 2c20  T 1 AS field_1, 
+00029f70: 3120 4153 2066 6965 6c64 5f32 2022 0a20  1 AS field_2 ". 
+00029f80: 2020 2020 2020 2020 2020 2022 554e 494f             "UNIO
+00029f90: 4e20 220a 2020 2020 2020 2020 2020 2020  N ".            
+00029fa0: 2253 454c 4543 5420 3220 4153 2066 6965  "SELECT 2 AS fie
+00029fb0: 6c64 5f31 2c20 3220 4153 2066 6965 6c64  ld_1, 2 AS field
+00029fc0: 5f32 220a 2020 2020 2020 2020 290a 2020  _2".        ).  
+00029fd0: 2020 2020 2020 6466 203d 2074 6573 742e        df = test.
+00029fe0: 746f 5f64 6174 6166 7261 6d65 2829 0a0a  to_dataframe()..
+00029ff0: 2020 2020 6173 7365 7274 206e 702e 616c      assert np.al
+0002a000: 6c63 6c6f 7365 2864 665b 2266 6965 6c64  lclose(df["field
+0002a010: 5f31 225d 2c20 6578 7065 6374 6564 5b22  _1"], expected["
+0002a020: 6669 656c 645f 3122 5d29 0a20 2020 2061  field_1"]).    a
+0002a030: 7373 6572 7420 6e70 2e61 6c6c 636c 6f73  ssert np.allclos
+0002a040: 6528 6466 5b22 6669 656c 645f 3222 5d2c  e(df["field_2"],
+0002a050: 2065 7870 6563 7465 645b 2266 6965 6c64   expected["field
+0002a060: 5f32 225d 290a 0a0a 4070 7974 6573 742e  _2"])...@pytest.
+0002a070: 6d61 726b 2e69 6e74 6567 7261 7469 6f6e  mark.integration
+0002a080: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
+0002a090: 7261 6d65 7472 697a 6528 2264 6261 7069  rametrize("dbapi
+0002a0a0: 222c 2044 4241 5049 5329 0a64 6566 2074  ", DBAPIS).def t
+0002a0b0: 6573 745f 7333 5f75 706c 6f61 645f 646f  est_s3_upload_do
+0002a0c0: 776e 6c6f 6164 5f66 696c 6528 7333 5f62  wnload_file(s3_b
+0002a0d0: 7563 6b65 742c 2064 6261 7069 293a 0a0a  ucket, dbapi):..
+0002a0e0: 2020 2020 7333 203d 206c 6f63 6f70 792e      s3 = locopy.
+0002a0f0: 5333 282a 2a43 5245 4453 5f44 4943 5429  S3(**CREDS_DICT)
+0002a100: 0a20 2020 2073 332e 7570 6c6f 6164 5f74  .    s3.upload_t
+0002a110: 6f5f 7333 284c 4f43 414c 5f46 494c 452c  o_s3(LOCAL_FILE,
+0002a120: 2053 335f 4255 434b 4554 2c20 226d 7966   S3_BUCKET, "myf
+0002a130: 696c 652e 7478 7422 290a 0a20 2020 2073  ile.txt")..    s
+0002a140: 3320 3d20 6c6f 636f 7079 2e53 3328 2a2a  3 = locopy.S3(**
+0002a150: 4352 4544 535f 4449 4354 290a 2020 2020  CREDS_DICT).    
+0002a160: 7333 2e64 6f77 6e6c 6f61 645f 6672 6f6d  s3.download_from
+0002a170: 5f73 3328 5333 5f42 5543 4b45 542c 2022  _s3(S3_BUCKET, "
+0002a180: 6d79 6669 6c65 2e74 7874 222c 204c 4f43  myfile.txt", LOC
+0002a190: 414c 5f46 494c 455f 444c 290a 0a20 2020  AL_FILE_DL)..   
+0002a1a0: 2061 7373 6572 7420 6669 6c65 636d 702e   assert filecmp.
+0002a1b0: 636d 7028 4c4f 4341 4c5f 4649 4c45 2c20  cmp(LOCAL_FILE, 
+0002a1c0: 4c4f 4341 4c5f 4649 4c45 5f44 4c29 0a20  LOCAL_FILE_DL). 
+0002a1d0: 2020 206f 732e 7265 6d6f 7665 284c 4f43     os.remove(LOC
+0002a1e0: 414c 5f46 494c 455f 444c 290a 0a0a 4070  AL_FILE_DL)...@p
+0002a1f0: 7974 6573 742e 6d61 726b 2e69 6e74 6567  ytest.mark.integ
+0002a200: 7261 7469 6f6e 0a40 7079 7465 7374 2e6d  ration.@pytest.m
+0002a210: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
+0002a220: 2264 6261 7069 222c 2044 4241 5049 5329  "dbapi", DBAPIS)
+0002a230: 0a64 6566 2074 6573 745f 636f 7079 2873  .def test_copy(s
+0002a240: 335f 6275 636b 6574 2c20 6462 6170 6929  3_bucket, dbapi)
+0002a250: 3a0a 0a20 2020 2077 6974 6820 6c6f 636f  :..    with loco
+0002a260: 7079 2e52 6564 7368 6966 7428 6462 6170  py.Redshift(dbap
+0002a270: 693d 6462 6170 692c 202a 2a43 5245 4453  i=dbapi, **CREDS
+0002a280: 5f44 4943 5429 2061 7320 7265 6473 6869  _DICT) as redshi
+0002a290: 6674 3a0a 2020 2020 2020 2020 7265 6473  ft:.        reds
+0002a2a0: 6869 6674 2e65 7865 6375 7465 280a 2020  hift.execute(.  
+0002a2b0: 2020 2020 2020 2020 2020 2243 5245 4154            "CREAT
+0002a2c0: 4520 5445 4d50 4f52 4152 5920 5441 424c  E TEMPORARY TABL
+0002a2d0: 4520 6c6f 636f 7079 5f69 6e74 6567 7261  E locopy_integra
+0002a2e0: 7469 6f6e 5f74 6573 7469 6e67 2028 6964  tion_testing (id
+0002a2f0: 2049 4e54 4547 4552 2c20 7661 7269 6162   INTEGER, variab
+0002a300: 6c65 2056 4152 4348 4152 2832 3029 2920  le VARCHAR(20)) 
+0002a310: 4449 5354 4b45 5928 7661 7269 6162 6c65  DISTKEY(variable
+0002a320: 2922 0a20 2020 2020 2020 2029 0a20 2020  )".        ).   
+0002a330: 2020 2020 2072 6564 7368 6966 742e 6c6f       redshift.lo
+0002a340: 6164 5f61 6e64 5f63 6f70 7928 0a20 2020  ad_and_copy(.   
+0002a350: 2020 2020 2020 2020 204c 4f43 414c 5f46           LOCAL_F
+0002a360: 494c 452c 0a20 2020 2020 2020 2020 2020  ILE,.           
+0002a370: 2053 335f 4255 434b 4554 2c0a 2020 2020   S3_BUCKET,.    
+0002a380: 2020 2020 2020 2020 226c 6f63 6f70 795f          "locopy_
+0002a390: 696e 7465 6772 6174 696f 6e5f 7465 7374  integration_test
+0002a3a0: 696e 6722 2c0a 2020 2020 2020 2020 2020  ing",.          
+0002a3b0: 2020 6465 6c69 6d3d 227c 222c 0a20 2020    delim="|",.   
+0002a3c0: 2020 2020 2020 2020 2064 656c 6574 655f           delete_
+0002a3d0: 7333 5f61 6674 6572 3d54 7275 652c 0a20  s3_after=True,. 
+0002a3e0: 2020 2020 2020 2020 2020 2063 6f6d 7072             compr
+0002a3f0: 6573 733d 4661 6c73 652c 0a20 2020 2020  ess=False,.     
+0002a400: 2020 2029 0a20 2020 2020 2020 2072 6564     ).        red
+0002a410: 7368 6966 742e 6578 6563 7574 6528 2253  shift.execute("S
+0002a420: 454c 4543 5420 2a20 4652 4f4d 206c 6f63  ELECT * FROM loc
+0002a430: 6f70 795f 696e 7465 6772 6174 696f 6e5f  opy_integration_
+0002a440: 7465 7374 696e 6720 4f52 4445 5220 4259  testing ORDER BY
+0002a450: 2069 6422 290a 2020 2020 2020 2020 7265   id").        re
+0002a460: 7375 6c74 7320 3d20 7265 6473 6869 6674  sults = redshift
+0002a470: 2e63 7572 736f 722e 6665 7463 6861 6c6c  .cursor.fetchall
+0002a480: 2829 0a0a 2020 2020 2020 2020 6578 7065  ()..        expe
+0002a490: 6374 6564 203d 205b 0a20 2020 2020 2020  cted = [.       
+0002a4a0: 2020 2020 2028 312c 2022 5468 6973 2069       (1, "This i
+0002a4b0: c5a1 206c 696e 6520 3122 292c 0a20 2020  .. line 1"),.   
+0002a4c0: 2020 2020 2020 2020 2028 322c 2022 5468           (2, "Th
+0002a4d0: 6973 2069 7320 6c69 6ec3 a920 3222 292c  is is lin.. 2"),
+0002a4e0: 0a20 2020 2020 2020 2020 2020 2028 332c  .            (3,
+0002a4f0: 2022 5468 6973 2069 7320 6c69 6e65 2033   "This is line 3
+0002a500: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
+0002a510: 2834 2c20 2254 6869 7320 6973 206c c3af  (4, "This is l..
+0002a520: 6e65 2034 2229 2c0a 2020 2020 2020 2020  ne 4"),.        
+0002a530: 5d0a 0a20 2020 2020 2020 2066 6f72 2069  ]..        for i
+0002a540: 2c20 7265 7375 6c74 2069 6e20 656e 756d  , result in enum
+0002a550: 6572 6174 6528 7265 7375 6c74 7329 3a0a  erate(results):.
+0002a560: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+0002a570: 7274 2072 6573 756c 745b 305d 203d 3d20  rt result[0] == 
+0002a580: 6578 7065 6374 6564 5b69 5d5b 305d 0a20  expected[i][0]. 
+0002a590: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+0002a5a0: 7420 7265 7375 6c74 5b31 5d20 3d3d 2065  t result[1] == e
+0002a5b0: 7870 6563 7465 645b 695d 5b31 5d0a 0a0a  xpected[i][1]...
+0002a5c0: 4070 7974 6573 742e 6d61 726b 2e69 6e74  @pytest.mark.int
+0002a5d0: 6567 7261 7469 6f6e 0a40 7079 7465 7374  egration.@pytest
+0002a5e0: 2e6d 6172 6b2e 7061 7261 6d65 7472 697a  .mark.parametriz
+0002a5f0: 6528 2264 6261 7069 222c 2044 4241 5049  e("dbapi", DBAPI
+0002a600: 5329 0a64 6566 2074 6573 745f 636f 7079  S).def test_copy
+0002a610: 5f73 706c 6974 5f69 676e 6f72 6528 7333  _split_ignore(s3
+0002a620: 5f62 7563 6b65 742c 2064 6261 7069 293a  _bucket, dbapi):
+0002a630: 0a0a 2020 2020 7769 7468 206c 6f63 6f70  ..    with locop
+0002a640: 792e 5265 6473 6869 6674 2864 6261 7069  y.Redshift(dbapi
+0002a650: 3d64 6261 7069 2c20 2a2a 4352 4544 535f  =dbapi, **CREDS_
+0002a660: 4449 4354 2920 6173 2072 6564 7368 6966  DICT) as redshif
+0002a670: 743a 0a20 2020 2020 2020 2072 6564 7368  t:.        redsh
+0002a680: 6966 742e 6578 6563 7574 6528 0a20 2020  ift.execute(.   
+0002a690: 2020 2020 2020 2020 2022 4352 4541 5445           "CREATE
+0002a6a0: 2054 454d 504f 5241 5259 2054 4142 4c45   TEMPORARY TABLE
+0002a6b0: 206c 6f63 6f70 795f 696e 7465 6772 6174   locopy_integrat
+0002a6c0: 696f 6e5f 7465 7374 696e 6720 2869 6420  ion_testing (id 
+0002a6d0: 494e 5445 4745 522c 2076 6172 6961 626c  INTEGER, variabl
+0002a6e0: 6520 5641 5243 4841 5228 3230 2929 2044  e VARCHAR(20)) D
+0002a6f0: 4953 544b 4559 2876 6172 6961 626c 6529  ISTKEY(variable)
+0002a700: 220a 2020 2020 2020 2020 290a 2020 2020  ".        ).    
+0002a710: 2020 2020 7265 6473 6869 6674 2e6c 6f61      redshift.loa
+0002a720: 645f 616e 645f 636f 7079 280a 2020 2020  d_and_copy(.    
+0002a730: 2020 2020 2020 2020 4c4f 4341 4c5f 4649          LOCAL_FI
+0002a740: 4c45 5f48 4541 4445 522c 0a20 2020 2020  LE_HEADER,.     
+0002a750: 2020 2020 2020 2053 335f 4255 434b 4554         S3_BUCKET
+0002a760: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
+0002a770: 6f63 6f70 795f 696e 7465 6772 6174 696f  ocopy_integratio
+0002a780: 6e5f 7465 7374 696e 6722 2c0a 2020 2020  n_testing",.    
+0002a790: 2020 2020 2020 2020 6465 6c69 6d3d 227c          delim="|
+0002a7a0: 222c 0a20 2020 2020 2020 2020 2020 2064  ",.            d
+0002a7b0: 656c 6574 655f 7333 5f61 6674 6572 3d54  elete_s3_after=T
+0002a7c0: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
+0002a7d0: 2063 6f6d 7072 6573 733d 4661 6c73 652c   compress=False,
+0002a7e0: 0a20 2020 2020 2020 2020 2020 2073 706c  .            spl
+0002a7f0: 6974 733d 342c 0a20 2020 2020 2020 2020  its=4,.         
+0002a800: 2020 2063 6f70 795f 6f70 7469 6f6e 733d     copy_options=
+0002a810: 5b22 4947 4e4f 5245 4845 4144 4552 2061  ["IGNOREHEADER a
+0002a820: 7320 3122 5d2c 0a20 2020 2020 2020 2029  s 1"],.        )
+0002a830: 0a20 2020 2020 2020 2072 6564 7368 6966  .        redshif
+0002a840: 742e 6578 6563 7574 6528 2253 454c 4543  t.execute("SELEC
+0002a850: 5420 2a20 4652 4f4d 206c 6f63 6f70 795f  T * FROM locopy_
+0002a860: 696e 7465 6772 6174 696f 6e5f 7465 7374  integration_test
+0002a870: 696e 6720 4f52 4445 5220 4259 2069 6422  ing ORDER BY id"
+0002a880: 290a 2020 2020 2020 2020 7265 7375 6c74  ).        result
+0002a890: 7320 3d20 7265 6473 6869 6674 2e63 7572  s = redshift.cur
+0002a8a0: 736f 722e 6665 7463 6861 6c6c 2829 0a0a  sor.fetchall()..
+0002a8b0: 2020 2020 2020 2020 6578 7065 6374 6564          expected
+0002a8c0: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
+0002a8d0: 2028 312c 2022 5468 6973 2069 c5a1 206c   (1, "This i.. l
+0002a8e0: 696e 6520 3122 292c 0a20 2020 2020 2020  ine 1"),.       
+0002a8f0: 2020 2020 2028 322c 2022 5468 6973 2069       (2, "This i
+0002a900: 7320 6c69 6ec3 a920 3222 292c 0a20 2020  s lin.. 2"),.   
+0002a910: 2020 2020 2020 2020 2028 332c 2022 5468           (3, "Th
+0002a920: 6973 2069 7320 6c69 6e65 2033 2229 2c0a  is is line 3"),.
+0002a930: 2020 2020 2020 2020 2020 2020 2834 2c20              (4, 
+0002a940: 2254 6869 7320 6973 206c c3af 6e65 2034  "This is l..ne 4
+0002a950: 2229 2c0a 2020 2020 2020 2020 5d0a 0a20  "),.        ].. 
+0002a960: 2020 2020 2020 2066 6f72 2069 2c20 7265         for i, re
+0002a970: 7375 6c74 2069 6e20 656e 756d 6572 6174  sult in enumerat
+0002a980: 6528 7265 7375 6c74 7329 3a0a 2020 2020  e(results):.    
+0002a990: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
+0002a9a0: 6573 756c 745b 305d 203d 3d20 6578 7065  esult[0] == expe
+0002a9b0: 6374 6564 5b69 5d5b 305d 0a20 2020 2020  cted[i][0].     
+0002a9c0: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
+0002a9d0: 7375 6c74 5b31 5d20 3d3d 2065 7870 6563  sult[1] == expec
+0002a9e0: 7465 645b 695d 5b31 5d0a 2020 2020 2020  ted[i][1].      
+0002a9f0: 2020 2020 2020 6f73 2e72 656d 6f76 6528        os.remove(
+0002aa00: 4c4f 4341 4c5f 4649 4c45 5f48 4541 4445  LOCAL_FILE_HEADE
+0002aa10: 5220 2b20 222e 7b30 7d22 2e66 6f72 6d61  R + ".{0}".forma
+0002aa20: 7428 6929 290a 0a0a 4070 7974 6573 742e  t(i))...@pytest.
+0002aa30: 6d61 726b 2e69 6e74 6567 7261 7469 6f6e  mark.integration
+0002aa40: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
+0002aa50: 7261 6d65 7472 697a 6528 2264 6261 7069  rametrize("dbapi
+0002aa60: 222c 2044 4241 5049 5329 0a64 6566 2074  ", DBAPIS).def t
+0002aa70: 6573 745f 756e 6c6f 6164 2873 335f 6275  est_unload(s3_bu
+0002aa80: 636b 6574 2c20 6462 6170 6929 3a0a 0a20  cket, dbapi):.. 
+0002aa90: 2020 2077 6974 6820 6c6f 636f 7079 2e52     with locopy.R
+0002aaa0: 6564 7368 6966 7428 6462 6170 693d 6462  edshift(dbapi=db
+0002aab0: 6170 692c 202a 2a43 5245 4453 5f44 4943  api, **CREDS_DIC
+0002aac0: 5429 2061 7320 7265 6473 6869 6674 3a0a  T) as redshift:.
+0002aad0: 2020 2020 2020 2020 7265 6473 6869 6674          redshift
+0002aae0: 2e65 7865 6375 7465 280a 2020 2020 2020  .execute(.      
+0002aaf0: 2020 2020 2020 2243 5245 4154 4520 5445        "CREATE TE
+0002ab00: 4d50 4f52 4152 5920 5441 424c 4520 6c6f  MPORARY TABLE lo
+0002ab10: 636f 7079 5f69 6e74 6567 7261 7469 6f6e  copy_integration
+0002ab20: 5f74 6573 7469 6e67 2041 5320 5345 4c45  _testing AS SELE
+0002ab30: 4354 2028 2732 3031 372d 3132 2d33 3127  CT ('2017-12-31'
+0002ab40: 3a3a 6461 7465 202b 2072 6f77 5f6e 756d  ::date + row_num
+0002ab50: 6265 7228 2920 6f76 6572 2028 6f72 6465  ber() over (orde
+0002ab60: 7220 6279 2031 2929 3a3a 6461 7465 2066  r by 1))::date f
+0002ab70: 726f 6d20 5356 565f 5441 424c 4553 204c  rom SVV_TABLES L
+0002ab80: 494d 4954 2035 220a 2020 2020 2020 2020  IMIT 5".        
+0002ab90: 290a 2020 2020 2020 2020 7371 6c20 3d20  ).        sql = 
+0002aba0: 2253 454c 4543 5420 2a20 4652 4f4d 206c  "SELECT * FROM l
+0002abb0: 6f63 6f70 795f 696e 7465 6772 6174 696f  ocopy_integratio
+0002abc0: 6e5f 7465 7374 696e 6722 0a20 2020 2020  n_testing".     
+0002abd0: 2020 2072 6564 7368 6966 742e 756e 6c6f     redshift.unlo
+0002abe0: 6164 5f61 6e64 5f63 6f70 7928 7371 6c2c  ad_and_copy(sql,
+0002abf0: 2053 335f 4255 434b 4554 2c20 6465 6c69   S3_BUCKET, deli
+0002ac00: 6d3d 227c 222c 2065 7870 6f72 745f 7061  m="|", export_pa
+0002ac10: 7468 3d4c 4f43 414c 5f46 494c 455f 444c  th=LOCAL_FILE_DL
+0002ac20: 290a 2020 2020 2020 2020 7265 6473 6869  ).        redshi
+0002ac30: 6674 2e65 7865 6375 7465 2822 5345 4c45  ft.execute("SELE
+0002ac40: 4354 202a 2046 524f 4d20 6c6f 636f 7079  CT * FROM locopy
+0002ac50: 5f69 6e74 6567 7261 7469 6f6e 5f74 6573  _integration_tes
+0002ac60: 7469 6e67 204f 5244 4552 2042 5920 6461  ting ORDER BY da
+0002ac70: 7465 2229 0a20 2020 2020 2020 2072 6573  te").        res
+0002ac80: 756c 7473 203d 2072 6564 7368 6966 742e  ults = redshift.
+0002ac90: 6375 7273 6f72 2e66 6574 6368 616c 6c28  cursor.fetchall(
+0002aca0: 290a 0a20 2020 2020 2020 2065 7870 6563  )..        expec
+0002acb0: 7465 6420 3d20 5b0a 2020 2020 2020 2020  ted = [.        
+0002acc0: 2020 2020 2822 3230 3138 2d30 312d 3031      ("2018-01-01
+0002acd0: 222c 292c 0a20 2020 2020 2020 2020 2020  ",),.           
+0002ace0: 2028 2232 3031 382d 3031 2d30 3222 2c29   ("2018-01-02",)
+0002acf0: 2c0a 2020 2020 2020 2020 2020 2020 2822  ,.            ("
+0002ad00: 3230 3138 2d30 312d 3033 222c 292c 0a20  2018-01-03",),. 
+0002ad10: 2020 2020 2020 2020 2020 2028 2232 3031             ("201
+0002ad20: 382d 3031 2d30 3422 2c29 2c0a 2020 2020  8-01-04",),.    
+0002ad30: 2020 2020 2020 2020 2822 3230 3138 2d30          ("2018-0
+0002ad40: 312d 3035 222c 292c 0a20 2020 2020 2020  1-05",),.       
+0002ad50: 205d 0a0a 2020 2020 2020 2020 666f 7220   ]..        for 
+0002ad60: 692c 2072 6573 756c 7420 696e 2065 6e75  i, result in enu
+0002ad70: 6d65 7261 7465 2872 6573 756c 7473 293a  merate(results):
+0002ad80: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
+0002ad90: 6572 7420 7265 7375 6c74 5b30 5d2e 7374  ert result[0].st
+0002ada0: 7266 7469 6d65 2822 2559 2d25 6d2d 2564  rftime("%Y-%m-%d
+0002adb0: 2229 203d 3d20 6578 7065 6374 6564 5b69  ") == expected[i
+0002adc0: 5d5b 305d 0a0a 2020 2020 2020 2020 6f73  ][0]..        os
+0002add0: 2e72 656d 6f76 6528 4c4f 4341 4c5f 4649  .remove(LOCAL_FI
+0002ade0: 4c45 5f44 4c29 0a0a 0a40 7079 7465 7374  LE_DL)...@pytest
+0002adf0: 2e6d 6172 6b2e 696e 7465 6772 6174 696f  .mark.integratio
+0002ae00: 6e0a 4070 7974 6573 742e 6d61 726b 2e70  n.@pytest.mark.p
+0002ae10: 6172 616d 6574 7269 7a65 2822 6462 6170  arametrize("dbap
+0002ae20: 6922 2c20 4442 4150 4953 290a 6465 6620  i", DBAPIS).def 
+0002ae30: 7465 7374 5f75 6e6c 6f61 645f 7261 775f  test_unload_raw_
+0002ae40: 756e 6c6f 6164 5f70 6174 6828 7333 5f62  unload_path(s3_b
+0002ae50: 7563 6b65 742c 2064 6261 7069 293a 0a20  ucket, dbapi):. 
+0002ae60: 2020 206f 732e 6d6b 6469 7228 554e 4c4f     os.mkdir(UNLO
+0002ae70: 4144 5f50 4154 4829 0a0a 2020 2020 7769  AD_PATH)..    wi
+0002ae80: 7468 206c 6f63 6f70 792e 5265 6473 6869  th locopy.Redshi
+0002ae90: 6674 2864 6261 7069 3d64 6261 7069 2c20  ft(dbapi=dbapi, 
+0002aea0: 2a2a 4352 4544 535f 4449 4354 2920 6173  **CREDS_DICT) as
+0002aeb0: 2072 6564 7368 6966 743a 0a20 2020 2020   redshift:.     
+0002aec0: 2020 2072 6564 7368 6966 742e 6578 6563     redshift.exec
+0002aed0: 7574 6528 0a20 2020 2020 2020 2020 2020  ute(.           
+0002aee0: 2022 4352 4541 5445 2054 454d 504f 5241   "CREATE TEMPORA
+0002aef0: 5259 2054 4142 4c45 206c 6f63 6f70 795f  RY TABLE locopy_
+0002af00: 696e 7465 6772 6174 696f 6e5f 7465 7374  integration_test
+0002af10: 696e 6720 4153 2053 454c 4543 5420 2827  ing AS SELECT ('
+0002af20: 3230 3137 2d31 322d 3331 273a 3a64 6174  2017-12-31'::dat
+0002af30: 6520 2b20 726f 775f 6e75 6d62 6572 2829  e + row_number()
+0002af40: 206f 7665 7220 286f 7264 6572 2062 7920   over (order by 
+0002af50: 3129 293a 3a64 6174 6520 6672 6f6d 2053  1))::date from S
+0002af60: 5656 5f54 4142 4c45 5320 4c49 4d49 5420  VV_TABLES LIMIT 
+0002af70: 3522 0a20 2020 2020 2020 2029 0a20 2020  5".        ).   
+0002af80: 2020 2020 2073 716c 203d 2022 5345 4c45       sql = "SELE
+0002af90: 4354 202a 2046 524f 4d20 6c6f 636f 7079  CT * FROM locopy
+0002afa0: 5f69 6e74 6567 7261 7469 6f6e 5f74 6573  _integration_tes
+0002afb0: 7469 6e67 220a 2020 2020 2020 2020 7265  ting".        re
+0002afc0: 6473 6869 6674 2e75 6e6c 6f61 645f 616e  dshift.unload_an
+0002afd0: 645f 636f 7079 280a 2020 2020 2020 2020  d_copy(.        
+0002afe0: 2020 2020 7371 6c2c 0a20 2020 2020 2020      sql,.       
+0002aff0: 2020 2020 2053 335f 4255 434b 4554 2c0a       S3_BUCKET,.
+0002b000: 2020 2020 2020 2020 2020 2020 6465 6c69              deli
+0002b010: 6d3d 227c 222c 0a20 2020 2020 2020 2020  m="|",.         
+0002b020: 2020 2072 6177 5f75 6e6c 6f61 645f 7061     raw_unload_pa
+0002b030: 7468 3d55 4e4c 4f41 445f 5041 5448 2c0a  th=UNLOAD_PATH,.
+0002b040: 2020 2020 2020 2020 2020 2020 6578 706f              expo
+0002b050: 7274 5f70 6174 683d 4c4f 4341 4c5f 4649  rt_path=LOCAL_FI
+0002b060: 4c45 5f44 4c2c 0a20 2020 2020 2020 2029  LE_DL,.        )
+0002b070: 0a20 2020 2020 2020 2072 6564 7368 6966  .        redshif
+0002b080: 742e 6578 6563 7574 6528 2253 454c 4543  t.execute("SELEC
+0002b090: 5420 2a20 4652 4f4d 206c 6f63 6f70 795f  T * FROM locopy_
+0002b0a0: 696e 7465 6772 6174 696f 6e5f 7465 7374  integration_test
+0002b0b0: 696e 6720 4f52 4445 5220 4259 2064 6174  ing ORDER BY dat
+0002b0c0: 6522 290a 2020 2020 2020 2020 7265 7375  e").        resu
+0002b0d0: 6c74 7320 3d20 7265 6473 6869 6674 2e63  lts = redshift.c
+0002b0e0: 7572 736f 722e 6665 7463 6861 6c6c 2829  ursor.fetchall()
+0002b0f0: 0a0a 2020 2020 2020 2020 6578 7065 6374  ..        expect
+0002b100: 6564 203d 205b 0a20 2020 2020 2020 2020  ed = [.         
+0002b110: 2020 2028 2232 3031 382d 3031 2d30 3122     ("2018-01-01"
+0002b120: 2c29 2c0a 2020 2020 2020 2020 2020 2020  ,),.            
+0002b130: 2822 3230 3138 2d30 312d 3032 222c 292c  ("2018-01-02",),
+0002b140: 0a20 2020 2020 2020 2020 2020 2028 2232  .            ("2
+0002b150: 3031 382d 3031 2d30 3322 2c29 2c0a 2020  018-01-03",),.  
+0002b160: 2020 2020 2020 2020 2020 2822 3230 3138            ("2018
+0002b170: 2d30 312d 3034 222c 292c 0a20 2020 2020  -01-04",),.     
+0002b180: 2020 2020 2020 2028 2232 3031 382d 3031         ("2018-01
+0002b190: 2d30 3522 2c29 2c0a 2020 2020 2020 2020  -05",),.        
+0002b1a0: 5d0a 0a20 2020 2020 2020 2066 6f72 2069  ]..        for i
+0002b1b0: 2c20 7265 7375 6c74 2069 6e20 656e 756d  , result in enum
+0002b1c0: 6572 6174 6528 7265 7375 6c74 7329 3a0a  erate(results):.
+0002b1d0: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+0002b1e0: 7274 2072 6573 756c 745b 305d 2e73 7472  rt result[0].str
+0002b1f0: 6674 696d 6528 2225 592d 256d 2d25 6422  ftime("%Y-%m-%d"
+0002b200: 2920 3d3d 2065 7870 6563 7465 645b 695d  ) == expected[i]
+0002b210: 5b30 5d0a 0a20 2020 2020 2020 206f 732e  [0]..        os.
+0002b220: 726d 6469 7228 554e 4c4f 4144 5f50 4154  rmdir(UNLOAD_PAT
+0002b230: 4829 0a20 2020 2020 2020 206f 732e 7265  H).        os.re
+0002b240: 6d6f 7665 284c 4f43 414c 5f46 494c 455f  move(LOCAL_FILE_
+0002b250: 444c 290a 0a0a 4070 7974 6573 742e 6d61  DL)...@pytest.ma
+0002b260: 726b 2e69 6e74 6567 7261 7469 6f6e 0a40  rk.integration.@
+0002b270: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
+0002b280: 6d65 7472 697a 6528 2264 6261 7069 222c  metrize("dbapi",
+0002b290: 2044 4241 5049 5329 0a64 6566 2074 6573   DBAPIS).def tes
+0002b2a0: 745f 696e 7365 7274 5f64 6174 6166 7261  t_insert_datafra
+0002b2b0: 6d65 5f74 6f5f 7461 626c 6528 7333 5f62  me_to_table(s3_b
+0002b2c0: 7563 6b65 742c 2064 6261 7069 293a 0a0a  ucket, dbapi):..
+0002b2d0: 2020 2020 7769 7468 206c 6f63 6f70 792e      with locopy.
+0002b2e0: 5265 6473 6869 6674 2864 6261 7069 3d64  Redshift(dbapi=d
+0002b2f0: 6261 7069 2c20 2a2a 4352 4544 535f 4449  bapi, **CREDS_DI
+0002b300: 4354 2920 6173 2072 6564 7368 6966 743a  CT) as redshift:
+0002b310: 0a20 2020 2020 2020 2072 6564 7368 6966  .        redshif
+0002b320: 742e 696e 7365 7274 5f64 6174 6166 7261  t.insert_datafra
+0002b330: 6d65 5f74 6f5f 7461 626c 6528 5445 5354  me_to_table(TEST
+0002b340: 5f44 462c 2022 6c6f 636f 7079 5f64 665f  _DF, "locopy_df_
+0002b350: 7465 7374 222c 2063 7265 6174 653d 5472  test", create=Tr
+0002b360: 7565 290a 2020 2020 2020 2020 7265 6473  ue).        reds
+0002b370: 6869 6674 2e65 7865 6375 7465 2822 5345  hift.execute("SE
+0002b380: 4c45 4354 2061 2c20 622c 2063 2046 524f  LECT a, b, c FRO
+0002b390: 4d20 6c6f 636f 7079 5f64 665f 7465 7374  M locopy_df_test
+0002b3a0: 204f 5244 4552 2042 5920 6120 4153 4322   ORDER BY a ASC"
+0002b3b0: 290a 2020 2020 2020 2020 7265 7375 6c74  ).        result
+0002b3c0: 7320 3d20 7265 6473 6869 6674 2e63 7572  s = redshift.cur
+0002b3d0: 736f 722e 6665 7463 6861 6c6c 2829 0a20  sor.fetchall(). 
+0002b3e0: 2020 2020 2020 2072 6564 7368 6966 742e         redshift.
+0002b3f0: 6578 6563 7574 6528 2264 726f 7020 7461  execute("drop ta
+0002b400: 626c 6520 6966 2065 7869 7374 7320 6c6f  ble if exists lo
+0002b410: 636f 7079 5f64 665f 7465 7374 2229 0a0a  copy_df_test")..
+0002b420: 2020 2020 2020 2020 6578 7065 6374 6564          expected
+0002b430: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
+0002b440: 2028 312c 2022 7822 2c20 7064 2e74 6f5f   (1, "x", pd.to_
+0002b450: 6461 7465 7469 6d65 2822 3230 3131 2d30  datetime("2011-0
+0002b460: 312d 3031 2229 2e64 6174 6528 2929 2c0a  1-01").date()),.
+0002b470: 2020 2020 2020 2020 2020 2020 2832 2c20              (2, 
+0002b480: 2279 222c 2070 642e 746f 5f64 6174 6574  "y", pd.to_datet
+0002b490: 696d 6528 2232 3030 312d 3034 2d30 3222  ime("2001-04-02"
+0002b4a0: 292e 6461 7465 2829 292c 0a20 2020 2020  ).date()),.     
+0002b4b0: 2020 205d 0a0a 2020 2020 2020 2020 6173     ]..        as
+0002b4c0: 7365 7274 206c 656e 2865 7870 6563 7465  sert len(expecte
+0002b4d0: 6429 203d 3d20 6c65 6e28 7265 7375 6c74  d) == len(result
+0002b4e0: 7329 0a20 2020 2020 2020 2066 6f72 2069  s).        for i
+0002b4f0: 2c20 7265 7375 6c74 2069 6e20 656e 756d  , result in enum
+0002b500: 6572 6174 6528 7265 7375 6c74 7329 3a0a  erate(results):.
+0002b510: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+0002b520: 7274 2072 6573 756c 745b 305d 203d 3d20  rt result[0] == 
+0002b530: 6578 7065 6374 6564 5b69 5d5b 305d 0a20  expected[i][0]. 
+0002b540: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+0002b550: 7420 7265 7375 6c74 5b31 5d20 3d3d 2065  t result[1] == e
+0002b560: 7870 6563 7465 645b 695d 5b31 5d0a 2020  xpected[i][1].  
+0002b570: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+0002b580: 2072 6573 756c 745b 325d 203d 3d20 6578   result[2] == ex
+0002b590: 7065 6374 6564 5b69 5d5b 325d 0a0a 2020  pected[i][2]..  
+0002b5a0: 2020 2020 2020 7265 6473 6869 6674 2e69        redshift.i
+0002b5b0: 6e73 6572 745f 6461 7461 6672 616d 655f  nsert_dataframe_
+0002b5c0: 746f 5f74 6162 6c65 280a 2020 2020 2020  to_table(.      
+0002b5d0: 2020 2020 2020 5445 5354 5f44 465f 322c        TEST_DF_2,
+0002b5e0: 2022 6c6f 636f 7079 5f74 6573 745f 3222   "locopy_test_2"
+0002b5f0: 2c20 6372 6561 7465 3d54 7275 652c 2062  , create=True, b
+0002b600: 6174 6368 5f73 697a 653d 330a 2020 2020  atch_size=3.    
+0002b610: 2020 2020 290a 2020 2020 2020 2020 7265      ).        re
+0002b620: 6473 6869 6674 2e65 7865 6375 7465 2822  dshift.execute("
+0002b630: 5345 4c45 4354 2063 6f6c 312c 2063 6f6c  SELECT col1, col
+0002b640: 3220 4652 4f4d 206c 6f63 6f70 795f 7465  2 FROM locopy_te
+0002b650: 7374 5f32 204f 5244 4552 2042 5920 636f  st_2 ORDER BY co
+0002b660: 6c31 2041 5343 2229 0a20 2020 2020 2020  l1 ASC").       
+0002b670: 2072 6573 756c 7473 203d 2072 6564 7368   results = redsh
+0002b680: 6966 742e 6375 7273 6f72 2e66 6574 6368  ift.cursor.fetch
+0002b690: 616c 6c28 290a 2020 2020 2020 2020 7265  all().        re
+0002b6a0: 6473 6869 6674 2e65 7865 6375 7465 2822  dshift.execute("
+0002b6b0: 6472 6f70 2074 6162 6c65 2069 6620 6578  drop table if ex
+0002b6c0: 6973 7473 206c 6f63 6f70 795f 7465 7374  ists locopy_test
+0002b6d0: 5f32 2229 0a0a 2020 2020 2020 2020 6578  _2")..        ex
+0002b6e0: 7065 6374 6564 203d 205b 0a20 2020 2020  pected = [.     
+0002b6f0: 2020 2020 2020 2028 312c 2022 6122 292c         (1, "a"),
+0002b700: 0a20 2020 2020 2020 2020 2020 2028 322c  .            (2,
+0002b710: 2022 6222 292c 0a20 2020 2020 2020 2020   "b"),.         
+0002b720: 2020 2028 332c 2022 6322 292c 0a20 2020     (3, "c"),.   
+0002b730: 2020 2020 2020 2020 2028 342c 2022 6422           (4, "d"
+0002b740: 292c 0a20 2020 2020 2020 2020 2020 2028  ),.            (
+0002b750: 352c 2022 6522 292c 0a20 2020 2020 2020  5, "e"),.       
+0002b760: 2020 2020 2028 362c 2022 6622 292c 0a20       (6, "f"),. 
+0002b770: 2020 2020 2020 2020 2020 2028 372c 2022             (7, "
+0002b780: 6722 292c 0a20 2020 2020 2020 205d 0a0a  g"),.        ]..
+0002b790: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
+0002b7a0: 656e 2865 7870 6563 7465 6429 203d 3d20  en(expected) == 
+0002b7b0: 6c65 6e28 7265 7375 6c74 7329 0a20 2020  len(results).   
+0002b7c0: 2020 2020 2066 6f72 2069 2c20 7265 7375       for i, resu
+0002b7d0: 6c74 2069 6e20 656e 756d 6572 6174 6528  lt in enumerate(
+0002b7e0: 7265 7375 6c74 7329 3a0a 2020 2020 2020  results):.      
+0002b7f0: 2020 2020 2020 6173 7365 7274 2072 6573        assert res
+0002b800: 756c 745b 305d 203d 3d20 6578 7065 6374  ult[0] == expect
+0002b810: 6564 5b69 5d5b 305d 0a20 2020 2020 2020  ed[i][0].       
+0002b820: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
+0002b830: 6c74 5b31 5d20 3d3d 2065 7870 6563 7465  lt[1] == expecte
+0002b840: 645b 695d 5b31 5d0a 0a20 2020 2020 2020  d[i][1]..       
+0002b850: 2066 726f 6d20 6465 6369 6d61 6c20 696d   from decimal im
+0002b860: 706f 7274 2044 6563 696d 616c 0a0a 2020  port Decimal..  
+0002b870: 2020 2020 2020 5445 5354 5f44 465f 3320        TEST_DF_3 
+0002b880: 3d20 7064 2e44 6174 6146 7261 6d65 280a  = pd.DataFrame(.
+0002b890: 2020 2020 2020 2020 2020 2020 7b0a 2020              {.  
+0002b8a0: 2020 2020 2020 2020 2020 2020 2020 2261                "a
+0002b8b0: 223a 205b 312c 2032 5d2c 0a20 2020 2020  ": [1, 2],.     
+0002b8c0: 2020 2020 2020 2020 2020 2022 6222 3a20             "b": 
+0002b8d0: 5b70 642e 746f 5f64 6174 6574 696d 6528  [pd.to_datetime(
+0002b8e0: 2232 3031 332d 3031 2d30 3122 292c 2070  "2013-01-01"), p
+0002b8f0: 642e 746f 5f64 6174 6574 696d 6528 2232  d.to_datetime("2
+0002b900: 3031 392d 3031 2d30 3122 295d 2c0a 2020  019-01-01")],.  
+0002b910: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+0002b920: 223a 205b 5472 7565 2c20 4661 6c73 655d  ": [True, False]
+0002b930: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002b940: 2020 2264 223a 205b 4465 6369 6d61 6c28    "d": [Decimal(
+0002b950: 3229 2c20 4465 6369 6d61 6c28 3329 5d2c  2), Decimal(3)],
+0002b960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002b970: 2022 6522 3a20 5b4e 6f6e 652c 2022 7827   "e": [None, "x'
+0002b980: 7922 5d2c 0a20 2020 2020 2020 2020 2020  y"],.           
+0002b990: 207d 0a20 2020 2020 2020 2029 0a20 2020   }.        ).   
+0002b9a0: 2020 2020 2072 6564 7368 6966 742e 696e       redshift.in
+0002b9b0: 7365 7274 5f64 6174 6166 7261 6d65 5f74  sert_dataframe_t
+0002b9c0: 6f5f 7461 626c 6528 5445 5354 5f44 465f  o_table(TEST_DF_
+0002b9d0: 332c 2022 6c6f 636f 7079 5f74 6573 745f  3, "locopy_test_
+0002b9e0: 3322 2c20 6372 6561 7465 3d54 7275 6529  3", create=True)
+0002b9f0: 0a20 2020 2020 2020 2072 6564 7368 6966  .        redshif
+0002ba00: 742e 6578 6563 7574 6528 2253 454c 4543  t.execute("SELEC
+0002ba10: 5420 612c 2062 2c20 632c 2064 2c20 6520  T a, b, c, d, e 
+0002ba20: 4652 4f4d 206c 6f63 6f70 795f 7465 7374  FROM locopy_test
+0002ba30: 5f33 204f 5244 4552 2042 5920 6120 4153  _3 ORDER BY a AS
+0002ba40: 4322 290a 2020 2020 2020 2020 7265 7375  C").        resu
+0002ba50: 6c74 7320 3d20 7265 6473 6869 6674 2e63  lts = redshift.c
+0002ba60: 7572 736f 722e 6665 7463 6861 6c6c 2829  ursor.fetchall()
+0002ba70: 0a20 2020 2020 2020 2072 6564 7368 6966  .        redshif
+0002ba80: 742e 6578 6563 7574 6528 2264 726f 7020  t.execute("drop 
+0002ba90: 7461 626c 6520 6966 2065 7869 7374 7320  table if exists 
+0002baa0: 6c6f 636f 7079 5f74 6573 745f 3322 290a  locopy_test_3").
+0002bab0: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
+0002bac0: 6420 3d20 5b0a 2020 2020 2020 2020 2020  d = [.          
+0002bad0: 2020 2831 2c20 7064 2e74 6f5f 6461 7465    (1, pd.to_date
+0002bae0: 7469 6d65 2822 3230 3133 2d30 312d 3031  time("2013-01-01
+0002baf0: 2229 2c20 5472 7565 2c20 322c 204e 6f6e  "), True, 2, Non
+0002bb00: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
+0002bb10: 2832 2c20 7064 2e74 6f5f 6461 7465 7469  (2, pd.to_dateti
+0002bb20: 6d65 2822 3230 3139 2d30 312d 3031 2229  me("2019-01-01")
+0002bb30: 2c20 4661 6c73 652c 2033 2c20 2278 2779  , False, 3, "x'y
+0002bb40: 2229 2c0a 2020 2020 2020 2020 5d0a 0a20  "),.        ].. 
+0002bb50: 2020 2020 2020 2061 7373 6572 7420 6c65         assert le
+0002bb60: 6e28 6578 7065 6374 6564 2920 3d3d 206c  n(expected) == l
+0002bb70: 656e 2872 6573 756c 7473 290a 2020 2020  en(results).    
+0002bb80: 2020 2020 666f 7220 692c 2072 6573 756c      for i, resul
+0002bb90: 7420 696e 2065 6e75 6d65 7261 7465 2872  t in enumerate(r
+0002bba0: 6573 756c 7473 293a 0a20 2020 2020 2020  esults):.       
+0002bbb0: 2020 2020 2061 7373 6572 7420 7265 7375       assert resu
+0002bbc0: 6c74 5b30 5d20 3d3d 2065 7870 6563 7465  lt[0] == expecte
+0002bbd0: 645b 695d 5b30 5d0a 2020 2020 2020 2020  d[i][0].        
+0002bbe0: 2020 2020 6173 7365 7274 2072 6573 756c      assert resul
+0002bbf0: 745b 315d 203d 3d20 6578 7065 6374 6564  t[1] == expected
+0002bc00: 5b69 5d5b 315d 0a20 2020 2020 2020 2020  [i][1].         
+0002bc10: 2020 2061 7373 6572 7420 7265 7375 6c74     assert result
+0002bc20: 5b32 5d20 3d3d 2065 7870 6563 7465 645b  [2] == expected[
+0002bc30: 695d 5b32 5d0a 2020 2020 2020 2020 2020  i][2].          
+0002bc40: 2020 6173 7365 7274 2072 6573 756c 745b    assert result[
+0002bc50: 335d 203d 3d20 6578 7065 6374 6564 5b69  3] == expected[i
+0002bc60: 5d5b 335d 0a20 2020 2020 2020 2020 2020  ][3].           
+0002bc70: 2061 7373 6572 7420 7265 7375 6c74 5b34   assert result[4
+0002bc80: 5d20 3d3d 2065 7870 6563 7465 645b 695d  ] == expected[i]
+0002bc90: 5b34 5d0a 0000 0000 0000 0000 0000 0000  [4].............
+0002bca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bcb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bcc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bcd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bcf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bd00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bd10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bd20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bd30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bd40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bd50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bd60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bd70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bd80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bd90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bdb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bdc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bdd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bde0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bdf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002be00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0002be10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002be20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002be30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002be40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002be50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002be60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0002be70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0002be80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0002be90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+0002bea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002beb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bf00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0002bf10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bf20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bf30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bf40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0002bf50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0002bf60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bf70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bf80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bf90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bfa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bfb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bfc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bfd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bfe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002bff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c000: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+0002c010: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
+0002c020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c200: 6c6f 636f 7079 2d30 2e35 2e31 2f74 6573  locopy-0.5.1/tes
+0002c210: 7473 2f74 6573 745f 696e 7465 6772 6174  ts/test_integrat
+0002c220: 696f 6e5f 7366 2e70 7900 0000 0000 0000  ion_sf.py.......
+0002c230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c260: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+0002c270: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0002c280: 3030 3234 3335 3300 3030 3030 3030 3030  0024353.00000000
+0002c290: 3030 3000 3032 3134 3231 0020 3000 0000  000.021421. 0...
+0002c2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c300: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0002c310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c320: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0002c330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0002c350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0002c360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002c400: 2320 4d49 5420 4c69 6365 6e73 650a 230a  # MIT License.#.
+0002c410: 2320 436f 7079 7269 6768 7420 2863 2920  # Copyright (c) 
+0002c420: 3230 3138 2043 6170 6974 616c 204f 6e65  2018 Capital One
+0002c430: 2053 6572 7669 6365 732c 204c 4c43 0a23   Services, LLC.#
+0002c440: 0a23 2050 6572 6d69 7373 696f 6e20 6973  .# Permission is
+0002c450: 2068 6572 6562 7920 6772 616e 7465 642c   hereby granted,
+0002c460: 2066 7265 6520 6f66 2063 6861 7267 652c   free of charge,
+0002c470: 2074 6f20 616e 7920 7065 7273 6f6e 206f   to any person o
+0002c480: 6274 6169 6e69 6e67 2061 2063 6f70 790a  btaining a copy.
+0002c490: 2320 6f66 2074 6869 7320 736f 6674 7761  # of this softwa
+0002c4a0: 7265 2061 6e64 2061 7373 6f63 6961 7465  re and associate
+0002c4b0: 6420 646f 6375 6d65 6e74 6174 696f 6e20  d documentation 
+0002c4c0: 6669 6c65 7320 2874 6865 2022 536f 6674  files (the "Soft
+0002c4d0: 7761 7265 2229 2c20 746f 2064 6561 6c0a  ware"), to deal.
+0002c4e0: 2320 696e 2074 6865 2053 6f66 7477 6172  # in the Softwar
+0002c4f0: 6520 7769 7468 6f75 7420 7265 7374 7269  e without restri
+0002c500: 6374 696f 6e2c 2069 6e63 6c75 6469 6e67  ction, including
+0002c510: 2077 6974 686f 7574 206c 696d 6974 6174   without limitat
+0002c520: 696f 6e20 7468 6520 7269 6768 7473 0a23  ion the rights.#
+0002c530: 2074 6f20 7573 652c 2063 6f70 792c 206d   to use, copy, m
+0002c540: 6f64 6966 792c 206d 6572 6765 2c20 7075  odify, merge, pu
+0002c550: 626c 6973 682c 2064 6973 7472 6962 7574  blish, distribut
+0002c560: 652c 2073 7562 6c69 6365 6e73 652c 2061  e, sublicense, a
+0002c570: 6e64 2f6f 7220 7365 6c6c 0a23 2063 6f70  nd/or sell.# cop
+0002c580: 6965 7320 6f66 2074 6865 2053 6f66 7477  ies of the Softw
+0002c590: 6172 652c 2061 6e64 2074 6f20 7065 726d  are, and to perm
+0002c5a0: 6974 2070 6572 736f 6e73 2074 6f20 7768  it persons to wh
+0002c5b0: 6f6d 2074 6865 2053 6f66 7477 6172 6520  om the Software 
+0002c5c0: 6973 0a23 2066 7572 6e69 7368 6564 2074  is.# furnished t
+0002c5d0: 6f20 646f 2073 6f2c 2073 7562 6a65 6374  o do so, subject
+0002c5e0: 2074 6f20 7468 6520 666f 6c6c 6f77 696e   to the followin
+0002c5f0: 6720 636f 6e64 6974 696f 6e73 3a0a 230a  g conditions:.#.
+0002c600: 2320 5468 6520 6162 6f76 6520 636f 7079  # The above copy
+0002c610: 7269 6768 7420 6e6f 7469 6365 2061 6e64  right notice and
+0002c620: 2074 6869 7320 7065 726d 6973 7369 6f6e   this permission
+0002c630: 206e 6f74 6963 6520 7368 616c 6c20 6265   notice shall be
+0002c640: 2069 6e63 6c75 6465 6420 696e 2061 6c6c   included in all
+0002c650: 0a23 2063 6f70 6965 7320 6f72 2073 7562  .# copies or sub
+0002c660: 7374 616e 7469 616c 2070 6f72 7469 6f6e  stantial portion
+0002c670: 7320 6f66 2074 6865 2053 6f66 7477 6172  s of the Softwar
+0002c680: 652e 0a23 0a23 2054 4845 2053 4f46 5457  e..#.# THE SOFTW
+0002c690: 4152 4520 4953 2050 524f 5649 4445 4420  ARE IS PROVIDED 
+0002c6a0: 2241 5320 4953 222c 2057 4954 484f 5554  "AS IS", WITHOUT
+0002c6b0: 2057 4152 5241 4e54 5920 4f46 2041 4e59   WARRANTY OF ANY
+0002c6c0: 204b 494e 442c 2045 5850 5245 5353 204f   KIND, EXPRESS O
+0002c6d0: 520a 2320 494d 504c 4945 442c 2049 4e43  R.# IMPLIED, INC
+0002c6e0: 4c55 4449 4e47 2042 5554 204e 4f54 204c  LUDING BUT NOT L
+0002c6f0: 494d 4954 4544 2054 4f20 5448 4520 5741  IMITED TO THE WA
+0002c700: 5252 414e 5449 4553 204f 4620 4d45 5243  RRANTIES OF MERC
+0002c710: 4841 4e54 4142 494c 4954 592c 0a23 2046  HANTABILITY,.# F
+0002c720: 4954 4e45 5353 2046 4f52 2041 2050 4152  ITNESS FOR A PAR
+0002c730: 5449 4355 4c41 5220 5055 5250 4f53 4520  TICULAR PURPOSE 
+0002c740: 414e 4420 4e4f 4e49 4e46 5249 4e47 454d  AND NONINFRINGEM
+0002c750: 454e 542e 2049 4e20 4e4f 2045 5645 4e54  ENT. IN NO EVENT
+0002c760: 2053 4841 4c4c 2054 4845 0a23 2041 5554   SHALL THE.# AUT
+0002c770: 484f 5253 204f 5220 434f 5059 5249 4748  HORS OR COPYRIGH
+0002c780: 5420 484f 4c44 4552 5320 4245 204c 4941  T HOLDERS BE LIA
+0002c790: 424c 4520 464f 5220 414e 5920 434c 4149  BLE FOR ANY CLAI
+0002c7a0: 4d2c 2044 414d 4147 4553 204f 5220 4f54  M, DAMAGES OR OT
+0002c7b0: 4845 520a 2320 4c49 4142 494c 4954 592c  HER.# LIABILITY,
+0002c7c0: 2057 4845 5448 4552 2049 4e20 414e 2041   WHETHER IN AN A
+0002c7d0: 4354 494f 4e20 4f46 2043 4f4e 5452 4143  CTION OF CONTRAC
+0002c7e0: 542c 2054 4f52 5420 4f52 204f 5448 4552  T, TORT OR OTHER
+0002c7f0: 5749 5345 2c20 4152 4953 494e 4720 4652  WISE, ARISING FR
+0002c800: 4f4d 2c0a 2320 4f55 5420 4f46 204f 5220  OM,.# OUT OF OR 
+0002c810: 494e 2043 4f4e 4e45 4354 494f 4e20 5749  IN CONNECTION WI
+0002c820: 5448 2054 4845 2053 4f46 5457 4152 4520  TH THE SOFTWARE 
+0002c830: 4f52 2054 4845 2055 5345 204f 5220 4f54  OR THE USE OR OT
+0002c840: 4845 5220 4445 414c 494e 4753 2049 4e20  HER DEALINGS IN 
+0002c850: 5448 450a 2320 534f 4654 5741 5245 2e0a  THE.# SOFTWARE..
+0002c860: 0a69 6d70 6f72 7420 6669 6c65 636d 700a  .import filecmp.
+0002c870: 696d 706f 7274 206f 730a 696d 706f 7274  import os.import
+0002c880: 2073 6875 7469 6c0a 6672 6f6d 2070 6174   shutil.from pat
+0002c890: 686c 6962 2069 6d70 6f72 7420 5061 7468  hlib import Path
+0002c8a0: 0a0a 696d 706f 7274 2062 6f74 6f33 0a69  ..import boto3.i
+0002c8b0: 6d70 6f72 7420 6e75 6d70 7920 6173 206e  mport numpy as n
+0002c8c0: 700a 696d 706f 7274 2070 616e 6461 7320  p.import pandas 
+0002c8d0: 6173 2070 640a 696d 706f 7274 2070 7974  as pd.import pyt
+0002c8e0: 6573 740a 696d 706f 7274 2073 6e6f 7766  est.import snowf
+0002c8f0: 6c61 6b65 2e63 6f6e 6e65 6374 6f72 0a0a  lake.connector..
+0002c900: 696d 706f 7274 206c 6f63 6f70 790a 0a44  import locopy..D
+0002c910: 4241 5049 5320 3d20 5b73 6e6f 7766 6c61  BAPIS = [snowfla
+0002c920: 6b65 2e63 6f6e 6e65 6374 6f72 5d0a 494e  ke.connector].IN
+0002c930: 5445 4752 4154 494f 4e5f 4352 4544 5320  TEGRATION_CREDS 
+0002c940: 3d20 7374 7228 5061 7468 2e68 6f6d 6528  = str(Path.home(
+0002c950: 2929 202b 206f 732e 7365 7020 2b20 222e  )) + os.sep + ".
+0002c960: 6c6f 636f 7079 2d73 6672 6322 0a53 335f  locopy-sfrc".S3_
+0002c970: 4255 434b 4554 203d 2022 6c6f 636f 7079  BUCKET = "locopy
+0002c980: 2d69 6e74 6567 7261 7469 6f6e 2d74 6573  -integration-tes
+0002c990: 7469 6e67 220a 4355 5252 5f44 4952 203d  ting".CURR_DIR =
+0002c9a0: 206f 732e 7061 7468 2e64 6972 6e61 6d65   os.path.dirname
+0002c9b0: 286f 732e 7061 7468 2e61 6273 7061 7468  (os.path.abspath
+0002c9c0: 285f 5f66 696c 655f 5f29 290a 4c4f 4341  (__file__)).LOCA
+0002c9d0: 4c5f 4649 4c45 203d 206f 732e 7061 7468  L_FILE = os.path
+0002c9e0: 2e6a 6f69 6e28 4355 5252 5f44 4952 2c20  .join(CURR_DIR, 
+0002c9f0: 2264 6174 6122 2c20 226d 6f63 6b5f 6669  "data", "mock_fi
+0002ca00: 6c65 2e74 7874 2229 0a4c 4f43 414c 5f46  le.txt").LOCAL_F
+0002ca10: 494c 455f 4a53 4f4e 203d 206f 732e 7061  ILE_JSON = os.pa
+0002ca20: 7468 2e6a 6f69 6e28 4355 5252 5f44 4952  th.join(CURR_DIR
+0002ca30: 2c20 2264 6174 6122 2c20 226d 6f63 6b5f  , "data", "mock_
+0002ca40: 6669 6c65 2e6a 736f 6e22 290a 4c4f 4341  file.json").LOCA
+0002ca50: 4c5f 4649 4c45 5f44 4c20 3d20 6f73 2e70  L_FILE_DL = os.p
+0002ca60: 6174 682e 6a6f 696e 2843 5552 525f 4449  ath.join(CURR_DI
+0002ca70: 522c 2022 6461 7461 222c 2022 6d6f 636b  R, "data", "mock
+0002ca80: 5f66 696c 655f 646c 2e74 7874 2229 0a54  _file_dl.txt").T
+0002ca90: 4553 545f 4446 203d 2070 642e 7265 6164  EST_DF = pd.read
+0002caa0: 5f63 7376 286f 732e 7061 7468 2e6a 6f69  _csv(os.path.joi
+0002cab0: 6e28 4355 5252 5f44 4952 2c20 2264 6174  n(CURR_DIR, "dat
+0002cac0: 6122 2c20 226d 6f63 6b5f 6461 7461 6672  a", "mock_datafr
+0002cad0: 616d 652e 7478 7422 292c 2073 6570 3d22  ame.txt"), sep="
+0002cae0: 2c22 290a 5445 5354 5f44 465f 3220 3d20  ,").TEST_DF_2 = 
+0002caf0: 7064 2e72 6561 645f 6373 7628 6f73 2e70  pd.read_csv(os.p
+0002cb00: 6174 682e 6a6f 696e 2843 5552 525f 4449  ath.join(CURR_DI
+0002cb10: 522c 2022 6461 7461 222c 2022 6d6f 636b  R, "data", "mock
+0002cb20: 5f64 6174 6166 7261 6d65 5f32 2e74 7874  _dataframe_2.txt
+0002cb30: 2229 2c20 7365 703d 222c 2229 0a0a 4352  "), sep=",")..CR
+0002cb40: 4544 535f 4449 4354 203d 206c 6f63 6f70  EDS_DICT = locop
+0002cb50: 792e 7574 696c 6974 792e 7265 6164 5f63  y.utility.read_c
+0002cb60: 6f6e 6669 675f 7961 6d6c 2849 4e54 4547  onfig_yaml(INTEG
+0002cb70: 5241 5449 4f4e 5f43 5245 4453 290a 0a0a  RATION_CREDS)...
+0002cb80: 4070 7974 6573 742e 6669 7874 7572 6528  @pytest.fixture(
+0002cb90: 290a 6465 6620 7333 5f62 7563 6b65 7428  ).def s3_bucket(
+0002cba0: 293a 0a20 2020 2073 6573 7369 6f6e 203d  ):.    session =
+0002cbb0: 2062 6f74 6f33 2e53 6573 7369 6f6e 2870   boto3.Session(p
+0002cbc0: 726f 6669 6c65 5f6e 616d 653d 4352 4544  rofile_name=CRED
+0002cbd0: 535f 4449 4354 5b22 7072 6f66 696c 6522  S_DICT["profile"
+0002cbe0: 5d29 0a20 2020 2063 203d 2073 6573 7369  ]).    c = sessi
+0002cbf0: 6f6e 2e63 6c69 656e 7428 2273 3322 290a  on.client("s3").
+0002cc00: 2020 2020 632e 6372 6561 7465 5f62 7563      c.create_buc
+0002cc10: 6b65 7428 4275 636b 6574 3d53 335f 4255  ket(Bucket=S3_BU
+0002cc20: 434b 4554 290a 2020 2020 7969 656c 6420  CKET).    yield 
+0002cc30: 630a 2020 2020 7220 3d20 7365 7373 696f  c.    r = sessio
+0002cc40: 6e2e 7265 736f 7572 6365 2822 7333 2229  n.resource("s3")
+0002cc50: 2e42 7563 6b65 7428 5333 5f42 5543 4b45  .Bucket(S3_BUCKE
+0002cc60: 5429 0a20 2020 2072 2e6f 626a 6563 7473  T).    r.objects
+0002cc70: 2e61 6c6c 2829 2e64 656c 6574 6528 290a  .all().delete().
+0002cc80: 2020 2020 722e 6465 6c65 7465 2829 0a0a      r.delete()..
+0002cc90: 0a40 7079 7465 7374 2e6d 6172 6b2e 696e  .@pytest.mark.in
+0002cca0: 7465 6772 6174 696f 6e0a 4070 7974 6573  tegration.@pytes
+0002ccb0: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
+0002ccc0: 7a65 2822 6462 6170 6922 2c20 4442 4150  ze("dbapi", DBAP
+0002ccd0: 4953 290a 6465 6620 7465 7374 5f73 6e6f  IS).def test_sno
+0002cce0: 7766 6c61 6b65 5f65 7865 6375 7465 5f73  wflake_execute_s
+0002ccf0: 696e 676c 655f 726f 7773 2864 6261 7069  ingle_rows(dbapi
+0002cd00: 293a 0a0a 2020 2020 6578 7065 6374 6564  ):..    expected
+0002cd10: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
+0002cd20: 7b22 6669 656c 645f 3122 3a20 5b31 5d2c  {"field_1": [1],
+0002cd30: 2022 6669 656c 645f 3222 3a20 5b32 5d7d   "field_2": [2]}
+0002cd40: 290a 2020 2020 7769 7468 206c 6f63 6f70  ).    with locop
+0002cd50: 792e 536e 6f77 666c 616b 6528 6462 6170  y.Snowflake(dbap
+0002cd60: 693d 6462 6170 692c 202a 2a43 5245 4453  i=dbapi, **CREDS
+0002cd70: 5f44 4943 5429 2061 7320 7465 7374 3a0a  _DICT) as test:.
+0002cd80: 2020 2020 2020 2020 7465 7374 2e65 7865          test.exe
+0002cd90: 6375 7465 2822 5345 4c45 4354 2031 2041  cute("SELECT 1 A
+0002cda0: 5320 6669 656c 645f 312c 2032 2041 5320  S field_1, 2 AS 
+0002cdb0: 6669 656c 645f 3220 2229 0a20 2020 2020  field_2 ").     
+0002cdc0: 2020 2064 6620 3d20 7465 7374 2e74 6f5f     df = test.to_
+0002cdd0: 6461 7461 6672 616d 6528 290a 2020 2020  dataframe().    
+0002cde0: 2020 2020 6466 2e63 6f6c 756d 6e73 203d      df.columns =
+0002cdf0: 205b 632e 6c6f 7765 7228 2920 666f 7220   [c.lower() for 
+0002ce00: 6320 696e 2064 662e 636f 6c75 6d6e 735d  c in df.columns]
+0002ce10: 0a0a 2020 2020 6173 7365 7274 206e 702e  ..    assert np.
+0002ce20: 616c 6c63 6c6f 7365 2864 665b 2266 6965  allclose(df["fie
+0002ce30: 6c64 5f31 225d 2c20 6578 7065 6374 6564  ld_1"], expected
+0002ce40: 5b22 6669 656c 645f 3122 5d29 0a0a 0a40  ["field_1"])...@
+0002ce50: 7079 7465 7374 2e6d 6172 6b2e 696e 7465  pytest.mark.inte
+0002ce60: 6772 6174 696f 6e0a 4070 7974 6573 742e  gration.@pytest.
+0002ce70: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
+0002ce80: 2822 6462 6170 6922 2c20 4442 4150 4953  ("dbapi", DBAPIS
+0002ce90: 290a 6465 6620 7465 7374 5f73 6e6f 7766  ).def test_snowf
+0002cea0: 6c61 6b65 5f65 7865 6375 7465 5f6d 756c  lake_execute_mul
+0002ceb0: 7469 706c 655f 726f 7773 2864 6261 7069  tiple_rows(dbapi
+0002cec0: 293a 0a0a 2020 2020 6578 7065 6374 6564  ):..    expected
+0002ced0: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
+0002cee0: 7b22 6669 656c 645f 3122 3a20 5b31 2c20  {"field_1": [1, 
+0002cef0: 325d 2c20 2266 6965 6c64 5f32 223a 205b  2], "field_2": [
+0002cf00: 312c 2032 5d7d 290a 2020 2020 7769 7468  1, 2]}).    with
+0002cf10: 206c 6f63 6f70 792e 536e 6f77 666c 616b   locopy.Snowflak
+0002cf20: 6528 6462 6170 693d 6462 6170 692c 202a  e(dbapi=dbapi, *
+0002cf30: 2a43 5245 4453 5f44 4943 5429 2061 7320  *CREDS_DICT) as 
+0002cf40: 7465 7374 3a0a 2020 2020 2020 2020 7465  test:.        te
+0002cf50: 7374 2e65 7865 6375 7465 280a 2020 2020  st.execute(.    
+0002cf60: 2020 2020 2020 2020 2253 454c 4543 5420          "SELECT 
+0002cf70: 3120 4153 2066 6965 6c64 5f31 2c20 3120  1 AS field_1, 1 
+0002cf80: 4153 2066 6965 6c64 5f32 2022 2022 554e  AS field_2 " "UN
+0002cf90: 494f 4e20 2220 2253 454c 4543 5420 3220  ION " "SELECT 2 
+0002cfa0: 4153 2066 6965 6c64 5f31 2c20 3220 4153  AS field_1, 2 AS
+0002cfb0: 2066 6965 6c64 5f32 220a 2020 2020 2020   field_2".      
+0002cfc0: 2020 290a 2020 2020 2020 2020 6466 203d    ).        df =
+0002cfd0: 2074 6573 742e 746f 5f64 6174 6166 7261   test.to_datafra
+0002cfe0: 6d65 2829 0a20 2020 2020 2020 2064 662e  me().        df.
+0002cff0: 636f 6c75 6d6e 7320 3d20 5b63 2e6c 6f77  columns = [c.low
+0002d000: 6572 2829 2066 6f72 2063 2069 6e20 6466  er() for c in df
+0002d010: 2e63 6f6c 756d 6e73 5d0a 0a20 2020 2061  .columns]..    a
+0002d020: 7373 6572 7420 6e70 2e61 6c6c 636c 6f73  ssert np.allclos
+0002d030: 6528 6466 5b22 6669 656c 645f 3122 5d2c  e(df["field_1"],
+0002d040: 2065 7870 6563 7465 645b 2266 6965 6c64   expected["field
+0002d050: 5f31 225d 290a 2020 2020 6173 7365 7274  _1"]).    assert
+0002d060: 206e 702e 616c 6c63 6c6f 7365 2864 665b   np.allclose(df[
+0002d070: 2266 6965 6c64 5f32 225d 2c20 6578 7065  "field_2"], expe
+0002d080: 6374 6564 5b22 6669 656c 645f 3222 5d29  cted["field_2"])
+0002d090: 0a0a 0a40 7079 7465 7374 2e6d 6172 6b2e  ...@pytest.mark.
+0002d0a0: 696e 7465 6772 6174 696f 6e0a 4070 7974  integration.@pyt
+0002d0b0: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
+0002d0c0: 7269 7a65 2822 6462 6170 6922 2c20 4442  rize("dbapi", DB
+0002d0d0: 4150 4953 290a 6465 6620 7465 7374 5f75  APIS).def test_u
+0002d0e0: 706c 6f61 645f 646f 776e 6c6f 6164 5f69  pload_download_i
+0002d0f0: 6e74 6572 6e61 6c28 6462 6170 6929 3a0a  nternal(dbapi):.
+0002d100: 0a20 2020 2077 6974 6820 6c6f 636f 7079  .    with locopy
+0002d110: 2e53 6e6f 7766 6c61 6b65 2864 6261 7069  .Snowflake(dbapi
+0002d120: 3d64 6261 7069 2c20 2a2a 4352 4544 535f  =dbapi, **CREDS_
+0002d130: 4449 4354 2920 6173 2074 6573 743a 0a20  DICT) as test:. 
+0002d140: 2020 2020 2020 2023 2064 656c 6574 6520         # delete 
+0002d150: 6966 2065 7869 7374 730a 2020 2020 2020  if exists.      
+0002d160: 2020 7465 7374 2e65 7865 6375 7465 2822    test.execute("
+0002d170: 5245 4d4f 5645 2040 7e2f 7374 6167 6564  REMOVE @~/staged
+0002d180: 2f6d 6f63 6b5f 6669 6c65 5f64 6c2e 7478  /mock_file_dl.tx
+0002d190: 7422 290a 0a20 2020 2020 2020 2023 2074  t")..        # t
+0002d1a0: 6573 740a 2020 2020 2020 2020 7368 7574  est.        shut
+0002d1b0: 696c 2e63 6f70 7928 4c4f 4341 4c5f 4649  il.copy(LOCAL_FI
+0002d1c0: 4c45 2c20 4c4f 4341 4c5f 4649 4c45 5f44  LE, LOCAL_FILE_D
+0002d1d0: 4c29 0a20 2020 2020 2020 2074 6573 742e  L).        test.
+0002d1e0: 7570 6c6f 6164 5f74 6f5f 696e 7465 726e  upload_to_intern
+0002d1f0: 616c 284c 4f43 414c 5f46 494c 455f 444c  al(LOCAL_FILE_DL
+0002d200: 2c20 2240 7e2f 7374 6167 6564 2f22 2c20  , "@~/staged/", 
+0002d210: 6175 746f 5f63 6f6d 7072 6573 733d 4661  auto_compress=Fa
+0002d220: 6c73 6529 0a20 2020 2020 2020 2074 6573  lse).        tes
+0002d230: 742e 6578 6563 7574 6528 224c 4953 5420  t.execute("LIST 
+0002d240: 407e 2f73 7461 6765 642f 6d6f 636b 5f66  @~/staged/mock_f
+0002d250: 696c 655f 646c 2e74 7874 2229 0a20 2020  ile_dl.txt").   
+0002d260: 2020 2020 2072 6573 203d 2074 6573 742e       res = test.
+0002d270: 6375 7273 6f72 2e66 6574 6368 616c 6c28  cursor.fetchall(
+0002d280: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+0002d290: 2072 6573 5b30 5d5b 305d 203d 3d20 2273   res[0][0] == "s
+0002d2a0: 7461 6765 642f 6d6f 636b 5f66 696c 655f  taged/mock_file_
+0002d2b0: 646c 2e74 7874 220a 0a20 2020 2020 2020  dl.txt"..       
+0002d2c0: 2074 6573 742e 646f 776e 6c6f 6164 5f66   test.download_f
+0002d2d0: 726f 6d5f 696e 7465 726e 616c 280a 2020  rom_internal(.  
+0002d2e0: 2020 2020 2020 2020 2020 2240 7e2f 7374            "@~/st
+0002d2f0: 6167 6564 2f6d 6f63 6b5f 6669 6c65 5f64  aged/mock_file_d
+0002d300: 6c2e 7478 7422 2c20 6f73 2e70 6174 682e  l.txt", os.path.
+0002d310: 6469 726e 616d 6528 4c4f 4341 4c5f 4649  dirname(LOCAL_FI
+0002d320: 4c45 5f44 4c29 202b 206f 732e 7365 700a  LE_DL) + os.sep.
+0002d330: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0002d340: 2020 6173 7365 7274 2066 696c 6563 6d70    assert filecmp
+0002d350: 2e63 6d70 284c 4f43 414c 5f46 494c 452c  .cmp(LOCAL_FILE,
+0002d360: 204c 4f43 414c 5f46 494c 455f 444c 290a   LOCAL_FILE_DL).
+0002d370: 0a20 2020 2020 2020 2023 2063 6c65 616e  .        # clean
+0002d380: 2075 700a 2020 2020 2020 2020 7465 7374   up.        test
+0002d390: 2e65 7865 6375 7465 2822 5245 4d4f 5645  .execute("REMOVE
+0002d3a0: 2040 7e2f 7374 6167 6564 2f6d 6f63 6b5f   @~/staged/mock_
+0002d3b0: 6669 6c65 5f64 6c2e 7478 7422 290a 2020  file_dl.txt").  
+0002d3c0: 2020 2020 2020 6f73 2e72 656d 6f76 6528        os.remove(
+0002d3d0: 4c4f 4341 4c5f 4649 4c45 5f44 4c29 0a0a  LOCAL_FILE_DL)..
+0002d3e0: 0a40 7079 7465 7374 2e6d 6172 6b2e 696e  .@pytest.mark.in
+0002d3f0: 7465 6772 6174 696f 6e0a 4070 7974 6573  tegration.@pytes
+0002d400: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
+0002d410: 7a65 2822 6462 6170 6922 2c20 4442 4150  ze("dbapi", DBAP
+0002d420: 4953 290a 6465 6620 7465 7374 5f63 6f70  IS).def test_cop
+0002d430: 7928 6462 6170 6929 3a0a 0a20 2020 2077  y(dbapi):..    w
+0002d440: 6974 6820 6c6f 636f 7079 2e53 6e6f 7766  ith locopy.Snowf
+0002d450: 6c61 6b65 2864 6261 7069 3d64 6261 7069  lake(dbapi=dbapi
+0002d460: 2c20 2a2a 4352 4544 535f 4449 4354 2920  , **CREDS_DICT) 
+0002d470: 6173 2074 6573 743a 0a20 2020 2020 2020  as test:.       
+0002d480: 2074 6573 742e 7570 6c6f 6164 5f74 6f5f   test.upload_to_
+0002d490: 696e 7465 726e 616c 284c 4f43 414c 5f46  internal(LOCAL_F
+0002d4a0: 494c 452c 2022 407e 2f73 7461 6765 642f  ILE, "@~/staged/
+0002d4b0: 2229 0a20 2020 2020 2020 2074 6573 742e  ").        test.
+0002d4c0: 6578 6563 7574 6528 2255 5345 2053 4348  execute("USE SCH
+0002d4d0: 454d 4120 7b7d 222e 666f 726d 6174 2843  EMA {}".format(C
+0002d4e0: 5245 4453 5f44 4943 545b 2273 6368 656d  REDS_DICT["schem
+0002d4f0: 6122 5d29 290a 2020 2020 2020 2020 7465  a"])).        te
+0002d500: 7374 2e65 7865 6375 7465 280a 2020 2020  st.execute(.    
+0002d510: 2020 2020 2020 2020 2243 5245 4154 4520          "CREATE 
+0002d520: 4f52 2052 4550 4c41 4345 2054 454d 504f  OR REPLACE TEMPO
+0002d530: 5241 5259 2054 4142 4c45 206c 6f63 6f70  RARY TABLE locop
+0002d540: 795f 696e 7465 6772 6174 696f 6e5f 7465  y_integration_te
+0002d550: 7374 696e 6720 2869 6420 494e 5445 4745  sting (id INTEGE
+0002d560: 522c 2076 6172 6961 626c 6520 5641 5243  R, variable VARC
+0002d570: 4841 5228 3230 2929 220a 2020 2020 2020  HAR(20))".      
+0002d580: 2020 290a 2020 2020 2020 2020 7465 7374    ).        test
+0002d590: 2e63 6f70 7928 0a20 2020 2020 2020 2020  .copy(.         
+0002d5a0: 2020 2022 6c6f 636f 7079 5f69 6e74 6567     "locopy_integ
+0002d5b0: 7261 7469 6f6e 5f74 6573 7469 6e67 222c  ration_testing",
+0002d5c0: 0a20 2020 2020 2020 2020 2020 2022 407e  .            "@~
+0002d5d0: 2f73 7461 6765 642f 6d6f 636b 5f66 696c  /staged/mock_fil
+0002d5e0: 652e 7478 742e 677a 222c 0a20 2020 2020  e.txt.gz",.     
+0002d5f0: 2020 2020 2020 2063 6f70 795f 6f70 7469         copy_opti
+0002d600: 6f6e 733d 5b22 5055 5247 4520 3d20 5452  ons=["PURGE = TR
+0002d610: 5545 225d 2c0a 2020 2020 2020 2020 290a  UE"],.        ).
+0002d620: 2020 2020 2020 2020 7465 7374 2e65 7865          test.exe
+0002d630: 6375 7465 2822 5345 4c45 4354 202a 2046  cute("SELECT * F
+0002d640: 524f 4d20 6c6f 636f 7079 5f69 6e74 6567  ROM locopy_integ
+0002d650: 7261 7469 6f6e 5f74 6573 7469 6e67 204f  ration_testing O
+0002d660: 5244 4552 2042 5920 6964 2229 0a20 2020  RDER BY id").   
+0002d670: 2020 2020 2072 6573 756c 7473 203d 2074       results = t
+0002d680: 6573 742e 6375 7273 6f72 2e66 6574 6368  est.cursor.fetch
+0002d690: 616c 6c28 290a 0a20 2020 2020 2020 2065  all()..        e
+0002d6a0: 7870 6563 7465 6420 3d20 5b0a 2020 2020  xpected = [.    
+0002d6b0: 2020 2020 2020 2020 2831 2c20 2254 6869          (1, "Thi
+0002d6c0: 7320 69c5 a120 6c69 6e65 2031 2229 2c0a  s i.. line 1"),.
+0002d6d0: 2020 2020 2020 2020 2020 2020 2832 2c20              (2, 
+0002d6e0: 2254 6869 7320 6973 206c 696e c3a9 2032  "This is lin.. 2
+0002d6f0: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
+0002d700: 2833 2c20 2254 6869 7320 6973 206c 696e  (3, "This is lin
+0002d710: 6520 3322 292c 0a20 2020 2020 2020 2020  e 3"),.         
+0002d720: 2020 2028 342c 2022 5468 6973 2069 7320     (4, "This is 
+0002d730: 6cc3 af6e 6520 3422 292c 0a20 2020 2020  l..ne 4"),.     
+0002d740: 2020 205d 0a0a 2020 2020 2020 2020 666f     ]..        fo
+0002d750: 7220 692c 2072 6573 756c 7420 696e 2065  r i, result in e
+0002d760: 6e75 6d65 7261 7465 2872 6573 756c 7473  numerate(results
+0002d770: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
+0002d780: 7373 6572 7420 7265 7375 6c74 5b30 5d20  ssert result[0] 
+0002d790: 3d3d 2065 7870 6563 7465 645b 695d 5b30  == expected[i][0
+0002d7a0: 5d0a 2020 2020 2020 2020 2020 2020 6173  ].            as
+0002d7b0: 7365 7274 2072 6573 756c 745b 315d 203d  sert result[1] =
+0002d7c0: 3d20 6578 7065 6374 6564 5b69 5d5b 315d  = expected[i][1]
+0002d7d0: 0a0a 0a40 7079 7465 7374 2e6d 6172 6b2e  ...@pytest.mark.
+0002d7e0: 696e 7465 6772 6174 696f 6e0a 4070 7974  integration.@pyt
+0002d7f0: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
+0002d800: 7269 7a65 2822 6462 6170 6922 2c20 4442  rize("dbapi", DB
+0002d810: 4150 4953 290a 6465 6620 7465 7374 5f63  APIS).def test_c
+0002d820: 6f70 795f 6a73 6f6e 2864 6261 7069 293a  opy_json(dbapi):
+0002d830: 0a0a 2020 2020 7769 7468 206c 6f63 6f70  ..    with locop
+0002d840: 792e 536e 6f77 666c 616b 6528 6462 6170  y.Snowflake(dbap
+0002d850: 693d 6462 6170 692c 202a 2a43 5245 4453  i=dbapi, **CREDS
+0002d860: 5f44 4943 5429 2061 7320 7465 7374 3a0a  _DICT) as test:.
+0002d870: 2020 2020 2020 2020 7465 7374 2e75 706c          test.upl
+0002d880: 6f61 645f 746f 5f69 6e74 6572 6e61 6c28  oad_to_internal(
+0002d890: 4c4f 4341 4c5f 4649 4c45 5f4a 534f 4e2c  LOCAL_FILE_JSON,
+0002d8a0: 2022 407e 2f73 7461 6765 642f 2229 0a20   "@~/staged/"). 
+0002d8b0: 2020 2020 2020 2074 6573 742e 6578 6563         test.exec
+0002d8c0: 7574 6528 2255 5345 2053 4348 454d 4120  ute("USE SCHEMA 
+0002d8d0: 7b7d 222e 666f 726d 6174 2843 5245 4453  {}".format(CREDS
+0002d8e0: 5f44 4943 545b 2273 6368 656d 6122 5d29  _DICT["schema"])
+0002d8f0: 290a 2020 2020 2020 2020 7465 7374 2e65  ).        test.e
+0002d900: 7865 6375 7465 280a 2020 2020 2020 2020  xecute(.        
+0002d910: 2020 2020 2243 5245 4154 4520 4f52 2052      "CREATE OR R
+0002d920: 4550 4c41 4345 2054 454d 504f 5241 5259  EPLACE TEMPORARY
+0002d930: 2054 4142 4c45 206c 6f63 6f70 795f 696e   TABLE locopy_in
+0002d940: 7465 6772 6174 696f 6e5f 7465 7374 696e  tegration_testin
+0002d950: 6720 2876 6172 6961 626c 6520 5641 5249  g (variable VARI
+0002d960: 414e 5429 220a 2020 2020 2020 2020 290a  ANT)".        ).
+0002d970: 2020 2020 2020 2020 7465 7374 2e63 6f70          test.cop
+0002d980: 7928 0a20 2020 2020 2020 2020 2020 2022  y(.            "
+0002d990: 6c6f 636f 7079 5f69 6e74 6567 7261 7469  locopy_integrati
+0002d9a0: 6f6e 5f74 6573 7469 6e67 222c 0a20 2020  on_testing",.   
+0002d9b0: 2020 2020 2020 2020 2022 407e 2f73 7461           "@~/sta
+0002d9c0: 6765 642f 6d6f 636b 5f66 696c 652e 6a73  ged/mock_file.js
+0002d9d0: 6f6e 2e67 7a22 2c0a 2020 2020 2020 2020  on.gz",.        
+0002d9e0: 2020 2020 6669 6c65 5f74 7970 653d 226a      file_type="j
+0002d9f0: 736f 6e22 2c0a 2020 2020 2020 2020 2020  son",.          
+0002da00: 2020 636f 7079 5f6f 7074 696f 6e73 3d5b    copy_options=[
+0002da10: 2250 5552 4745 203d 2054 5255 4522 5d2c  "PURGE = TRUE"],
+0002da20: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0002da30: 2020 2074 6573 742e 6578 6563 7574 6528     test.execute(
+0002da40: 0a20 2020 2020 2020 2020 2020 2022 5345  .            "SE
+0002da50: 4c45 4354 2076 6172 6961 626c 653a 6c6f  LECT variable:lo
+0002da60: 6361 7469 6f6e 3a63 6974 792c 2076 6172  cation:city, var
+0002da70: 6961 626c 653a 7072 6963 6520 4652 4f4d  iable:price FROM
+0002da80: 206c 6f63 6f70 795f 696e 7465 6772 6174   locopy_integrat
+0002da90: 696f 6e5f 7465 7374 696e 6720 4f52 4445  ion_testing ORDE
+0002daa0: 5220 4259 2076 6172 6961 626c 6522 0a20  R BY variable". 
+0002dab0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0002dac0: 2072 6573 756c 7473 203d 2074 6573 742e   results = test.
+0002dad0: 6375 7273 6f72 2e66 6574 6368 616c 6c28  cursor.fetchall(
+0002dae0: 290a 0a20 2020 2020 2020 2065 7870 6563  )..        expec
+0002daf0: 7465 6420 3d20 5b0a 2020 2020 2020 2020  ted = [.        
+0002db00: 2020 2020 2827 2242 656c 6d6f 6e74 2227      ('"Belmont"'
+0002db10: 2c20 2722 3932 3536 3722 2729 2c0a 2020  , '"92567"'),.  
+0002db20: 2020 2020 2020 2020 2020 2827 224c 6578            ('"Lex
+0002db30: 696e 6774 6f6e 2227 2c20 2722 3735 3833  ington"', '"7583
+0002db40: 3622 2729 2c0a 2020 2020 2020 2020 2020  6"'),.          
+0002db50: 2020 2827 2257 696e 6368 6573 7465 7222    ('"Winchester"
+0002db60: 272c 2027 2238 3939 3231 2227 292c 0a20  ', '"89921"'),. 
+0002db70: 2020 2020 2020 205d 0a0a 2020 2020 2020         ]..      
+0002db80: 2020 666f 7220 692c 2072 6573 756c 7420    for i, result 
+0002db90: 696e 2065 6e75 6d65 7261 7465 2872 6573  in enumerate(res
+0002dba0: 756c 7473 293a 0a20 2020 2020 2020 2020  ults):.         
+0002dbb0: 2020 2061 7373 6572 7420 7265 7375 6c74     assert result
+0002dbc0: 5b30 5d20 3d3d 2065 7870 6563 7465 645b  [0] == expected[
+0002dbd0: 695d 5b30 5d0a 2020 2020 2020 2020 2020  i][0].          
+0002dbe0: 2020 6173 7365 7274 2072 6573 756c 745b    assert result[
+0002dbf0: 315d 203d 3d20 6578 7065 6374 6564 5b69  1] == expected[i
+0002dc00: 5d5b 315d 0a0a 0a40 7079 7465 7374 2e6d  ][1]...@pytest.m
+0002dc10: 6172 6b2e 696e 7465 6772 6174 696f 6e0a  ark.integration.
+0002dc20: 4070 7974 6573 742e 6d61 726b 2e70 6172  @pytest.mark.par
+0002dc30: 616d 6574 7269 7a65 2822 6462 6170 6922  ametrize("dbapi"
+0002dc40: 2c20 4442 4150 4953 290a 6465 6620 7465  , DBAPIS).def te
+0002dc50: 7374 5f74 6f5f 6461 7461 6672 616d 6528  st_to_dataframe(
+0002dc60: 6462 6170 6929 3a0a 0a20 2020 2077 6974  dbapi):..    wit
+0002dc70: 6820 6c6f 636f 7079 2e53 6e6f 7766 6c61  h locopy.Snowfla
+0002dc80: 6b65 2864 6261 7069 3d64 6261 7069 2c20  ke(dbapi=dbapi, 
+0002dc90: 2a2a 4352 4544 535f 4449 4354 2920 6173  **CREDS_DICT) as
+0002dca0: 2074 6573 743a 0a20 2020 2020 2020 2074   test:.        t
+0002dcb0: 6573 742e 7570 6c6f 6164 5f74 6f5f 696e  est.upload_to_in
+0002dcc0: 7465 726e 616c 284c 4f43 414c 5f46 494c  ternal(LOCAL_FIL
+0002dcd0: 455f 4a53 4f4e 2c20 2240 7e2f 7374 6167  E_JSON, "@~/stag
+0002dce0: 6564 2f22 290a 2020 2020 2020 2020 7465  ed/").        te
+0002dcf0: 7374 2e65 7865 6375 7465 2822 5553 4520  st.execute("USE 
+0002dd00: 5343 4845 4d41 207b 7d22 2e66 6f72 6d61  SCHEMA {}".forma
+0002dd10: 7428 4352 4544 535f 4449 4354 5b22 7363  t(CREDS_DICT["sc
+0002dd20: 6865 6d61 225d 2929 0a20 2020 2020 2020  hema"])).       
+0002dd30: 2074 6573 742e 6578 6563 7574 6528 0a20   test.execute(. 
+0002dd40: 2020 2020 2020 2020 2020 2022 4352 4541             "CREA
+0002dd50: 5445 204f 5220 5245 504c 4143 4520 5445  TE OR REPLACE TE
+0002dd60: 4d50 4f52 4152 5920 5441 424c 4520 6c6f  MPORARY TABLE lo
+0002dd70: 636f 7079 5f69 6e74 6567 7261 7469 6f6e  copy_integration
+0002dd80: 5f74 6573 7469 6e67 2028 7661 7269 6162  _testing (variab
+0002dd90: 6c65 2056 4152 4941 4e54 2922 0a20 2020  le VARIANT)".   
+0002dda0: 2020 2020 2029 0a20 2020 2020 2020 2074       ).        t
+0002ddb0: 6573 742e 636f 7079 280a 2020 2020 2020  est.copy(.      
+0002ddc0: 2020 2020 2020 226c 6f63 6f70 795f 696e        "locopy_in
+0002ddd0: 7465 6772 6174 696f 6e5f 7465 7374 696e  tegration_testin
+0002dde0: 6722 2c0a 2020 2020 2020 2020 2020 2020  g",.            
+0002ddf0: 2240 7e2f 7374 6167 6564 2f6d 6f63 6b5f  "@~/staged/mock_
+0002de00: 6669 6c65 2e6a 736f 6e2e 677a 222c 0a20  file.json.gz",. 
+0002de10: 2020 2020 2020 2020 2020 2066 696c 655f             file_
+0002de20: 7479 7065 3d22 6a73 6f6e 222c 0a20 2020  type="json",.   
+0002de30: 2020 2020 2020 2020 2063 6f70 795f 6f70           copy_op
+0002de40: 7469 6f6e 733d 5b22 5055 5247 4520 3d20  tions=["PURGE = 
+0002de50: 5452 5545 225d 2c0a 2020 2020 2020 2020  TRUE"],.        
+0002de60: 290a 0a20 2020 2020 2020 2023 2067 6574  )..        # get
+0002de70: 2061 6c6c 0a20 2020 2020 2020 2074 6573   all.        tes
+0002de80: 742e 6578 6563 7574 6528 0a20 2020 2020  t.execute(.     
+0002de90: 2020 2020 2020 2022 5345 4c45 4354 2076         "SELECT v
+0002dea0: 6172 6961 626c 653a 6c6f 6361 7469 6f6e  ariable:location
+0002deb0: 3a63 6974 792c 2076 6172 6961 626c 653a  :city, variable:
+0002dec0: 7072 6963 6520 4652 4f4d 206c 6f63 6f70  price FROM locop
+0002ded0: 795f 696e 7465 6772 6174 696f 6e5f 7465  y_integration_te
+0002dee0: 7374 696e 6720 4f52 4445 5220 4259 2076  sting ORDER BY v
+0002def0: 6172 6961 626c 6522 0a20 2020 2020 2020  ariable".       
+0002df00: 2029 0a20 2020 2020 2020 2072 6573 756c   ).        resul
+0002df10: 7420 3d20 7465 7374 2e74 6f5f 6461 7461  t = test.to_data
+0002df20: 6672 616d 6528 290a 2020 2020 2020 2020  frame().        
+0002df30: 7265 7375 6c74 2e63 6f6c 756d 6e73 203d  result.columns =
+0002df40: 205b 632e 6c6f 7765 7228 2920 666f 7220   [c.lower() for 
+0002df50: 6320 696e 2072 6573 756c 742e 636f 6c75  c in result.colu
+0002df60: 6d6e 735d 0a20 2020 2020 2020 2065 7870  mns].        exp
+0002df70: 6563 7465 6420 3d20 7064 2e44 6174 6146  ected = pd.DataF
+0002df80: 7261 6d65 280a 2020 2020 2020 2020 2020  rame(.          
+0002df90: 2020 5b28 2722 4265 6c6d 6f6e 7422 272c    [('"Belmont"',
+0002dfa0: 2027 2239 3235 3637 2227 292c 2028 2722   '"92567"'), ('"
+0002dfb0: 4c65 7869 6e67 746f 6e22 272c 2027 2237  Lexington"', '"7
+0002dfc0: 3538 3336 2227 292c 2028 2722 5769 6e63  5836"'), ('"Winc
+0002dfd0: 6865 7374 6572 2227 2c20 2722 3839 3932  hester"', '"8992
+0002dfe0: 3122 2729 2c5d 2c0a 2020 2020 2020 2020  1"'),],.        
+0002dff0: 2020 2020 636f 6c75 6d6e 733d 5b22 7661      columns=["va
+0002e000: 7269 6162 6c65 3a6c 6f63 6174 696f 6e3a  riable:location:
+0002e010: 6369 7479 222c 2022 7661 7269 6162 6c65  city", "variable
+0002e020: 3a70 7269 6365 225d 2c0a 2020 2020 2020  :price"],.      
+0002e030: 2020 290a 0a20 2020 2020 2020 2061 7373    )..        ass
+0002e040: 6572 7420 2872 6573 756c 745b 2276 6172  ert (result["var
+0002e050: 6961 626c 653a 6c6f 6361 7469 6f6e 3a63  iable:location:c
+0002e060: 6974 7922 5d20 3d3d 2065 7870 6563 7465  ity"] == expecte
+0002e070: 645b 2276 6172 6961 626c 653a 6c6f 6361  d["variable:loca
+0002e080: 7469 6f6e 3a63 6974 7922 5d29 2e61 6c6c  tion:city"]).all
+0002e090: 2829 0a20 2020 2020 2020 2061 7373 6572  ().        asser
+0002e0a0: 7420 2872 6573 756c 745b 2276 6172 6961  t (result["varia
+0002e0b0: 626c 653a 7072 6963 6522 5d20 3d3d 2065  ble:price"] == e
+0002e0c0: 7870 6563 7465 645b 2276 6172 6961 626c  xpected["variabl
+0002e0d0: 653a 7072 6963 6522 5d29 2e61 6c6c 2829  e:price"]).all()
+0002e0e0: 0a0a 2020 2020 2020 2020 2320 7769 7468  ..        # with
+0002e0f0: 2073 697a 6520 6f66 2032 0a20 2020 2020   size of 2.     
+0002e100: 2020 2074 6573 742e 6578 6563 7574 6528     test.execute(
+0002e110: 0a20 2020 2020 2020 2020 2020 2022 5345  .            "SE
+0002e120: 4c45 4354 2076 6172 6961 626c 653a 6c6f  LECT variable:lo
+0002e130: 6361 7469 6f6e 3a63 6974 792c 2076 6172  cation:city, var
+0002e140: 6961 626c 653a 7072 6963 6520 4652 4f4d  iable:price FROM
+0002e150: 206c 6f63 6f70 795f 696e 7465 6772 6174   locopy_integrat
+0002e160: 696f 6e5f 7465 7374 696e 6720 4f52 4445  ion_testing ORDE
+0002e170: 5220 4259 2076 6172 6961 626c 6522 0a20  R BY variable". 
+0002e180: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0002e190: 2072 6573 756c 7420 3d20 7465 7374 2e74   result = test.t
+0002e1a0: 6f5f 6461 7461 6672 616d 6528 7369 7a65  o_dataframe(size
+0002e1b0: 3d32 290a 2020 2020 2020 2020 7265 7375  =2).        resu
+0002e1c0: 6c74 2e63 6f6c 756d 6e73 203d 205b 632e  lt.columns = [c.
+0002e1d0: 6c6f 7765 7228 2920 666f 7220 6320 696e  lower() for c in
+0002e1e0: 2072 6573 756c 742e 636f 6c75 6d6e 735d   result.columns]
+0002e1f0: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
+0002e200: 6420 3d20 7064 2e44 6174 6146 7261 6d65  d = pd.DataFrame
+0002e210: 280a 2020 2020 2020 2020 2020 2020 5b28  (.            [(
+0002e220: 2722 4265 6c6d 6f6e 7422 272c 2027 2239  '"Belmont"', '"9
+0002e230: 3235 3637 2227 292c 2028 2722 4c65 7869  2567"'), ('"Lexi
+0002e240: 6e67 746f 6e22 272c 2027 2237 3538 3336  ngton"', '"75836
+0002e250: 2227 292c 5d2c 0a20 2020 2020 2020 2020  "'),],.         
+0002e260: 2020 2063 6f6c 756d 6e73 3d5b 2276 6172     columns=["var
+0002e270: 6961 626c 653a 6c6f 6361 7469 6f6e 3a63  iable:location:c
+0002e280: 6974 7922 2c20 2276 6172 6961 626c 653a  ity", "variable:
+0002e290: 7072 6963 6522 5d2c 0a20 2020 2020 2020  price"],.       
+0002e2a0: 2029 0a0a 2020 2020 2020 2020 6173 7365   )..        asse
+0002e2b0: 7274 2028 7265 7375 6c74 5b22 7661 7269  rt (result["vari
+0002e2c0: 6162 6c65 3a6c 6f63 6174 696f 6e3a 6369  able:location:ci
+0002e2d0: 7479 225d 203d 3d20 6578 7065 6374 6564  ty"] == expected
+0002e2e0: 5b22 7661 7269 6162 6c65 3a6c 6f63 6174  ["variable:locat
+0002e2f0: 696f 6e3a 6369 7479 225d 292e 616c 6c28  ion:city"]).all(
+0002e300: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+0002e310: 2028 7265 7375 6c74 5b22 7661 7269 6162   (result["variab
+0002e320: 6c65 3a70 7269 6365 225d 203d 3d20 6578  le:price"] == ex
+0002e330: 7065 6374 6564 5b22 7661 7269 6162 6c65  pected["variable
+0002e340: 3a70 7269 6365 225d 292e 616c 6c28 290a  :price"]).all().
+0002e350: 0a20 2020 2020 2020 2023 2077 6974 6820  .        # with 
+0002e360: 6e6f 6e2d 7365 6c65 6374 2071 7565 7279  non-select query
+0002e370: 0a20 2020 2020 2020 2074 6573 742e 6578  .        test.ex
+0002e380: 6563 7574 6528 2244 524f 5020 7461 626c  ecute("DROP tabl
+0002e390: 6520 6c6f 636f 7079 5f69 6e74 6567 7261  e locopy_integra
+0002e3a0: 7469 6f6e 5f74 6573 7469 6e67 2229 0a20  tion_testing"). 
+0002e3b0: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+0002e3c0: 7465 7374 2e74 6f5f 6461 7461 6672 616d  test.to_datafram
+0002e3d0: 6528 290a 2020 2020 2020 2020 6173 7365  e().        asse
+0002e3e0: 7274 2072 6573 756c 745b 2273 7461 7475  rt result["statu
+0002e3f0: 7322 5d5b 305d 203d 3d20 224c 4f43 4f50  s"][0] == "LOCOP
+0002e400: 595f 494e 5445 4752 4154 494f 4e5f 5445  Y_INTEGRATION_TE
+0002e410: 5354 494e 4720 7375 6363 6573 7366 756c  STING successful
+0002e420: 6c79 2064 726f 7070 6564 2e22 0a0a 0a40  ly dropped."...@
+0002e430: 7079 7465 7374 2e6d 6172 6b2e 696e 7465  pytest.mark.inte
+0002e440: 6772 6174 696f 6e0a 4070 7974 6573 742e  gration.@pytest.
+0002e450: 6d61 726b 2e70 6172 616d 6574 7269 7a65  mark.parametrize
+0002e460: 2822 6462 6170 6922 2c20 4442 4150 4953  ("dbapi", DBAPIS
+0002e470: 290a 6465 6620 7465 7374 5f69 6e73 6572  ).def test_inser
+0002e480: 745f 6461 7461 6672 616d 655f 746f 5f74  t_dataframe_to_t
+0002e490: 6162 6c65 2864 6261 7069 293a 0a0a 2020  able(dbapi):..  
+0002e4a0: 2020 7769 7468 206c 6f63 6f70 792e 536e    with locopy.Sn
+0002e4b0: 6f77 666c 616b 6528 6462 6170 693d 6462  owflake(dbapi=db
+0002e4c0: 6170 692c 202a 2a43 5245 4453 5f44 4943  api, **CREDS_DIC
+0002e4d0: 5429 2061 7320 7465 7374 3a0a 2020 2020  T) as test:.    
+0002e4e0: 2020 2020 7465 7374 2e69 6e73 6572 745f      test.insert_
+0002e4f0: 6461 7461 6672 616d 655f 746f 5f74 6162  dataframe_to_tab
+0002e500: 6c65 2854 4553 545f 4446 2c20 2274 6573  le(TEST_DF, "tes
+0002e510: 7422 2c20 6372 6561 7465 3d54 7275 6529  t", create=True)
+0002e520: 0a20 2020 2020 2020 2074 6573 742e 6578  .        test.ex
+0002e530: 6563 7574 6528 2253 454c 4543 5420 612c  ecute("SELECT a,
+0002e540: 2062 2c20 6320 4652 4f4d 2074 6573 7420   b, c FROM test 
+0002e550: 4f52 4445 5220 4259 2061 2041 5343 2229  ORDER BY a ASC")
+0002e560: 0a20 2020 2020 2020 2072 6573 756c 7473  .        results
+0002e570: 203d 2074 6573 742e 6375 7273 6f72 2e66   = test.cursor.f
+0002e580: 6574 6368 616c 6c28 290a 2020 2020 2020  etchall().      
+0002e590: 2020 7465 7374 2e65 7865 6375 7465 2822    test.execute("
+0002e5a0: 6472 6f70 2074 6162 6c65 2069 6620 6578  drop table if ex
+0002e5b0: 6973 7473 2074 6573 7422 290a 0a20 2020  ists test")..   
+0002e5c0: 2020 2020 2065 7870 6563 7465 6420 3d20       expected = 
+0002e5d0: 5b0a 2020 2020 2020 2020 2020 2020 2831  [.            (1
+0002e5e0: 2c20 2278 222c 2070 642e 746f 5f64 6174  , "x", pd.to_dat
+0002e5f0: 6574 696d 6528 2232 3031 312d 3031 2d30  etime("2011-01-0
+0002e600: 3122 292e 6461 7465 2829 292c 0a20 2020  1").date()),.   
+0002e610: 2020 2020 2020 2020 2028 322c 2022 7922           (2, "y"
+0002e620: 2c20 7064 2e74 6f5f 6461 7465 7469 6d65  , pd.to_datetime
+0002e630: 2822 3230 3031 2d30 342d 3032 2229 2e64  ("2001-04-02").d
+0002e640: 6174 6528 2929 2c0a 2020 2020 2020 2020  ate()),.        
+0002e650: 5d0a 0a20 2020 2020 2020 2061 7373 6572  ]..        asser
+0002e660: 7420 6c65 6e28 6578 7065 6374 6564 2920  t len(expected) 
+0002e670: 3d3d 206c 656e 2872 6573 756c 7473 290a  == len(results).
+0002e680: 2020 2020 2020 2020 666f 7220 692c 2072          for i, r
+0002e690: 6573 756c 7420 696e 2065 6e75 6d65 7261  esult in enumera
+0002e6a0: 7465 2872 6573 756c 7473 293a 0a20 2020  te(results):.   
+0002e6b0: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+0002e6c0: 7265 7375 6c74 5b30 5d20 3d3d 2065 7870  result[0] == exp
+0002e6d0: 6563 7465 645b 695d 5b30 5d0a 2020 2020  ected[i][0].    
+0002e6e0: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
+0002e6f0: 6573 756c 745b 315d 203d 3d20 6578 7065  esult[1] == expe
+0002e700: 6374 6564 5b69 5d5b 315d 0a20 2020 2020  cted[i][1].     
+0002e710: 2020 2020 2020 2061 7373 6572 7420 7265         assert re
+0002e720: 7375 6c74 5b32 5d20 3d3d 2065 7870 6563  sult[2] == expec
+0002e730: 7465 645b 695d 5b32 5d0a 0a20 2020 2020  ted[i][2]..     
+0002e740: 2020 2074 6573 742e 696e 7365 7274 5f64     test.insert_d
+0002e750: 6174 6166 7261 6d65 5f74 6f5f 7461 626c  ataframe_to_tabl
+0002e760: 6528 5445 5354 5f44 465f 322c 2022 7465  e(TEST_DF_2, "te
+0002e770: 7374 5f32 222c 2063 7265 6174 653d 5472  st_2", create=Tr
+0002e780: 7565 290a 2020 2020 2020 2020 7465 7374  ue).        test
+0002e790: 2e65 7865 6375 7465 2822 5345 4c45 4354  .execute("SELECT
+0002e7a0: 2063 6f6c 312c 2063 6f6c 3220 4652 4f4d   col1, col2 FROM
+0002e7b0: 2074 6573 745f 3220 4f52 4445 5220 4259   test_2 ORDER BY
+0002e7c0: 2063 6f6c 3120 4153 4322 290a 2020 2020   col1 ASC").    
+0002e7d0: 2020 2020 7265 7375 6c74 7320 3d20 7465      results = te
+0002e7e0: 7374 2e63 7572 736f 722e 6665 7463 6861  st.cursor.fetcha
+0002e7f0: 6c6c 2829 0a20 2020 2020 2020 2074 6573  ll().        tes
+0002e800: 742e 6578 6563 7574 6528 2264 726f 7020  t.execute("drop 
+0002e810: 7461 626c 6520 6966 2065 7869 7374 7320  table if exists 
+0002e820: 7465 7374 5f32 2229 0a0a 2020 2020 2020  test_2")..      
+0002e830: 2020 6578 7065 6374 6564 203d 205b 2831    expected = [(1
+0002e840: 2c20 2261 2229 2c20 2832 2c20 2262 2229  , "a"), (2, "b")
+0002e850: 2c20 2833 2c20 2263 2229 2c20 2834 2c20  , (3, "c"), (4, 
+0002e860: 2264 2229 2c20 2835 2c20 2265 2229 2c20  "d"), (5, "e"), 
+0002e870: 2836 2c20 2266 2229 2c20 2837 2c20 2267  (6, "f"), (7, "g
+0002e880: 2229 5d0a 0a20 2020 2020 2020 2061 7373  ")]..        ass
+0002e890: 6572 7420 6c65 6e28 6578 7065 6374 6564  ert len(expected
+0002e8a0: 2920 3d3d 206c 656e 2872 6573 756c 7473  ) == len(results
+0002e8b0: 290a 2020 2020 2020 2020 666f 7220 692c  ).        for i,
+0002e8c0: 2072 6573 756c 7420 696e 2065 6e75 6d65   result in enume
+0002e8d0: 7261 7465 2872 6573 756c 7473 293a 0a20  rate(results):. 
+0002e8e0: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+0002e8f0: 7420 7265 7375 6c74 5b30 5d20 3d3d 2065  t result[0] == e
+0002e900: 7870 6563 7465 645b 695d 5b30 5d0a 2020  xpected[i][0].  
+0002e910: 2020 2020 2020 2020 2020 6173 7365 7274            assert
+0002e920: 2072 6573 756c 745b 315d 203d 3d20 6578   result[1] == ex
+0002e930: 7065 6374 6564 5b69 5d5b 315d 0a0a 2020  pected[i][1]..  
+0002e940: 2020 2020 2020 6672 6f6d 2064 6563 696d        from decim
+0002e950: 616c 2069 6d70 6f72 7420 4465 6369 6d61  al import Decima
+0002e960: 6c0a 0a20 2020 2020 2020 2054 4553 545f  l..        TEST_
+0002e970: 4446 5f33 203d 2070 642e 4461 7461 4672  DF_3 = pd.DataFr
+0002e980: 616d 6528 0a20 2020 2020 2020 2020 2020  ame(.           
+0002e990: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
+0002e9a0: 2020 2022 6122 3a20 5b31 2c20 325d 2c0a     "a": [1, 2],.
+0002e9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e9c0: 2262 223a 205b 7064 2e74 6f5f 6461 7465  "b": [pd.to_date
+0002e9d0: 7469 6d65 2822 3230 3133 2d30 312d 3031  time("2013-01-01
+0002e9e0: 2229 2c20 7064 2e74 6f5f 6461 7465 7469  "), pd.to_dateti
+0002e9f0: 6d65 2822 3230 3139 2d30 312d 3031 2229  me("2019-01-01")
+0002ea00: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0002ea10: 2020 2022 6322 3a20 5b22 312e 3222 2c20     "c": ["1.2", 
+0002ea20: 2233 2e35 225d 2c0a 2020 2020 2020 2020  "3.5"],.        
+0002ea30: 2020 2020 2020 2020 2264 223a 205b 4465          "d": [De
+0002ea40: 6369 6d61 6c28 3229 2c20 4465 6369 6d61  cimal(2), Decima
+0002ea50: 6c28 3329 5d2c 0a20 2020 2020 2020 2020  l(3)],.         
+0002ea60: 2020 2020 2020 2022 6522 3a20 7064 2e53         "e": pd.S
+0002ea70: 6572 6965 7328 5b30 2c20 315d 2c20 6474  eries([0, 1], dt
+0002ea80: 7970 653d 2263 6174 6567 6f72 7922 292c  ype="category"),
+0002ea90: 0a20 2020 2020 2020 2020 2020 207d 0a20  .            }. 
+0002eaa0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0002eab0: 2074 6573 742e 696e 7365 7274 5f64 6174   test.insert_dat
+0002eac0: 6166 7261 6d65 5f74 6f5f 7461 626c 6528  aframe_to_table(
+0002ead0: 5445 5354 5f44 465f 332c 2022 7465 7374  TEST_DF_3, "test
+0002eae0: 5f33 222c 2063 7265 6174 653d 5472 7565  _3", create=True
+0002eaf0: 290a 2020 2020 2020 2020 7465 7374 2e65  ).        test.e
+0002eb00: 7865 6375 7465 2822 5345 4c45 4354 2061  xecute("SELECT a
+0002eb10: 2c20 622c 2063 2c20 642c 2065 2046 524f  , b, c, d, e FRO
+0002eb20: 4d20 7465 7374 5f33 204f 5244 4552 2042  M test_3 ORDER B
+0002eb30: 5920 6120 4153 4322 290a 2020 2020 2020  Y a ASC").      
+0002eb40: 2020 7265 7375 6c74 7320 3d20 7465 7374    results = test
+0002eb50: 2e63 7572 736f 722e 6665 7463 6861 6c6c  .cursor.fetchall
+0002eb60: 2829 0a20 2020 2020 2020 2074 6573 742e  ().        test.
+0002eb70: 6578 6563 7574 6528 2264 726f 7020 7461  execute("drop ta
+0002eb80: 626c 6520 6966 2065 7869 7374 7320 7465  ble if exists te
+0002eb90: 7374 5f33 2229 0a0a 2020 2020 2020 2020  st_3")..        
+0002eba0: 6578 7065 6374 6564 203d 205b 0a20 2020  expected = [.   
+0002ebb0: 2020 2020 2020 2020 2028 312c 2070 642e           (1, pd.
+0002ebc0: 746f 5f64 6174 6574 696d 6528 2232 3031  to_datetime("201
+0002ebd0: 332d 3031 2d30 3122 292c 2031 2e32 2c20  3-01-01"), 1.2, 
+0002ebe0: 322c 2022 3022 292c 0a20 2020 2020 2020  2, "0"),.       
+0002ebf0: 2020 2020 2028 322c 2070 642e 746f 5f64       (2, pd.to_d
+0002ec00: 6174 6574 696d 6528 2232 3031 392d 3031  atetime("2019-01
+0002ec10: 2d30 3122 292c 2033 2e35 2c20 332c 2022  -01"), 3.5, 3, "
+0002ec20: 3122 292c 0a20 2020 2020 2020 205d 0a0a  1"),.        ]..
+0002ec30: 2020 2020 2020 2020 6173 7365 7274 206c          assert l
+0002ec40: 656e 2865 7870 6563 7465 6429 203d 3d20  en(expected) == 
+0002ec50: 6c65 6e28 7265 7375 6c74 7329 0a20 2020  len(results).   
+0002ec60: 2020 2020 2066 6f72 2069 2c20 7265 7375       for i, resu
+0002ec70: 6c74 2069 6e20 656e 756d 6572 6174 6528  lt in enumerate(
+0002ec80: 7265 7375 6c74 7329 3a0a 2020 2020 2020  results):.      
+0002ec90: 2020 2020 2020 666f 7220 6a2c 2069 7465        for j, ite
+0002eca0: 6d20 696e 2065 6e75 6d65 7261 7465 2872  m in enumerate(r
+0002ecb0: 6573 756c 7429 3a0a 2020 2020 2020 2020  esult):.        
+0002ecc0: 2020 2020 2020 2020 6173 7365 7274 2072          assert r
+0002ecd0: 6573 756c 745b 6a5d 203d 3d20 6578 7065  esult[j] == expe
+0002ece0: 6374 6564 5b69 5d5b 6a5d 0a00 0000 0000  cted[i][j]......
+0002ecf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ed00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ed10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ed20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ed30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ed40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ed50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ed60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ed70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ed80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ed90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002eda0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002edb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002edc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002edd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ede0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002edf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ee00: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0002ee10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ee20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ee30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ee40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ee50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ee60: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0002ee70: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0002ee80: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0002ee90: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+0002eea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002eeb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002eec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002eed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002eee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002eef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ef00: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0002ef10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ef20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ef30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ef40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0002ef50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0002ef60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ef70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ef80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002ef90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002efa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002efb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002efc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002efd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002efe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002eff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f000: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+0002f010: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
+0002f020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f0a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f0b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f0c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f0d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f0e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f0f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f1a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f1b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f1c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f1d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f1e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f1f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f200: 6c6f 636f 7079 2d30 2e35 2e31 2f74 6573  locopy-0.5.1/tes
+0002f210: 7473 2f74 6573 745f 7265 6473 6869 6674  ts/test_redshift
+0002f220: 2e70 7900 0000 0000 0000 0000 0000 0000  .py.............
+0002f230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f260: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+0002f270: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0002f280: 3031 3036 3531 3200 3030 3030 3030 3030  0106512.00000000
+0002f290: 3030 3000 3032 3032 3134 0020 3000 0000  000.020214. 0...
+0002f2a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f2b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f2c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f2d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f2e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f2f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f300: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0002f310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f320: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0002f330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0002f350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0002f360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f3a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f3b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f3c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f3d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f3e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f3f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0002f400: 2320 4d49 5420 4c69 6365 6e73 650a 230a  # MIT License.#.
+0002f410: 2320 436f 7079 7269 6768 7420 2863 2920  # Copyright (c) 
+0002f420: 3230 3138 2043 6170 6974 616c 204f 6e65  2018 Capital One
+0002f430: 2053 6572 7669 6365 732c 204c 4c43 0a23   Services, LLC.#
+0002f440: 0a23 2050 6572 6d69 7373 696f 6e20 6973  .# Permission is
+0002f450: 2068 6572 6562 7920 6772 616e 7465 642c   hereby granted,
+0002f460: 2066 7265 6520 6f66 2063 6861 7267 652c   free of charge,
+0002f470: 2074 6f20 616e 7920 7065 7273 6f6e 206f   to any person o
+0002f480: 6274 6169 6e69 6e67 2061 2063 6f70 790a  btaining a copy.
+0002f490: 2320 6f66 2074 6869 7320 736f 6674 7761  # of this softwa
+0002f4a0: 7265 2061 6e64 2061 7373 6f63 6961 7465  re and associate
+0002f4b0: 6420 646f 6375 6d65 6e74 6174 696f 6e20  d documentation 
+0002f4c0: 6669 6c65 7320 2874 6865 2022 536f 6674  files (the "Soft
+0002f4d0: 7761 7265 2229 2c20 746f 2064 6561 6c0a  ware"), to deal.
+0002f4e0: 2320 696e 2074 6865 2053 6f66 7477 6172  # in the Softwar
+0002f4f0: 6520 7769 7468 6f75 7420 7265 7374 7269  e without restri
+0002f500: 6374 696f 6e2c 2069 6e63 6c75 6469 6e67  ction, including
+0002f510: 2077 6974 686f 7574 206c 696d 6974 6174   without limitat
+0002f520: 696f 6e20 7468 6520 7269 6768 7473 0a23  ion the rights.#
+0002f530: 2074 6f20 7573 652c 2063 6f70 792c 206d   to use, copy, m
+0002f540: 6f64 6966 792c 206d 6572 6765 2c20 7075  odify, merge, pu
+0002f550: 626c 6973 682c 2064 6973 7472 6962 7574  blish, distribut
+0002f560: 652c 2073 7562 6c69 6365 6e73 652c 2061  e, sublicense, a
+0002f570: 6e64 2f6f 7220 7365 6c6c 0a23 2063 6f70  nd/or sell.# cop
+0002f580: 6965 7320 6f66 2074 6865 2053 6f66 7477  ies of the Softw
+0002f590: 6172 652c 2061 6e64 2074 6f20 7065 726d  are, and to perm
+0002f5a0: 6974 2070 6572 736f 6e73 2074 6f20 7768  it persons to wh
+0002f5b0: 6f6d 2074 6865 2053 6f66 7477 6172 6520  om the Software 
+0002f5c0: 6973 0a23 2066 7572 6e69 7368 6564 2074  is.# furnished t
+0002f5d0: 6f20 646f 2073 6f2c 2073 7562 6a65 6374  o do so, subject
+0002f5e0: 2074 6f20 7468 6520 666f 6c6c 6f77 696e   to the followin
+0002f5f0: 6720 636f 6e64 6974 696f 6e73 3a0a 230a  g conditions:.#.
+0002f600: 2320 5468 6520 6162 6f76 6520 636f 7079  # The above copy
+0002f610: 7269 6768 7420 6e6f 7469 6365 2061 6e64  right notice and
+0002f620: 2074 6869 7320 7065 726d 6973 7369 6f6e   this permission
+0002f630: 206e 6f74 6963 6520 7368 616c 6c20 6265   notice shall be
+0002f640: 2069 6e63 6c75 6465 6420 696e 2061 6c6c   included in all
+0002f650: 0a23 2063 6f70 6965 7320 6f72 2073 7562  .# copies or sub
+0002f660: 7374 616e 7469 616c 2070 6f72 7469 6f6e  stantial portion
+0002f670: 7320 6f66 2074 6865 2053 6f66 7477 6172  s of the Softwar
+0002f680: 652e 0a23 0a23 2054 4845 2053 4f46 5457  e..#.# THE SOFTW
+0002f690: 4152 4520 4953 2050 524f 5649 4445 4420  ARE IS PROVIDED 
+0002f6a0: 2241 5320 4953 222c 2057 4954 484f 5554  "AS IS", WITHOUT
+0002f6b0: 2057 4152 5241 4e54 5920 4f46 2041 4e59   WARRANTY OF ANY
+0002f6c0: 204b 494e 442c 2045 5850 5245 5353 204f   KIND, EXPRESS O
+0002f6d0: 520a 2320 494d 504c 4945 442c 2049 4e43  R.# IMPLIED, INC
+0002f6e0: 4c55 4449 4e47 2042 5554 204e 4f54 204c  LUDING BUT NOT L
+0002f6f0: 494d 4954 4544 2054 4f20 5448 4520 5741  IMITED TO THE WA
+0002f700: 5252 414e 5449 4553 204f 4620 4d45 5243  RRANTIES OF MERC
+0002f710: 4841 4e54 4142 494c 4954 592c 0a23 2046  HANTABILITY,.# F
+0002f720: 4954 4e45 5353 2046 4f52 2041 2050 4152  ITNESS FOR A PAR
+0002f730: 5449 4355 4c41 5220 5055 5250 4f53 4520  TICULAR PURPOSE 
+0002f740: 414e 4420 4e4f 4e49 4e46 5249 4e47 454d  AND NONINFRINGEM
+0002f750: 454e 542e 2049 4e20 4e4f 2045 5645 4e54  ENT. IN NO EVENT
+0002f760: 2053 4841 4c4c 2054 4845 0a23 2041 5554   SHALL THE.# AUT
+0002f770: 484f 5253 204f 5220 434f 5059 5249 4748  HORS OR COPYRIGH
+0002f780: 5420 484f 4c44 4552 5320 4245 204c 4941  T HOLDERS BE LIA
+0002f790: 424c 4520 464f 5220 414e 5920 434c 4149  BLE FOR ANY CLAI
+0002f7a0: 4d2c 2044 414d 4147 4553 204f 5220 4f54  M, DAMAGES OR OT
+0002f7b0: 4845 520a 2320 4c49 4142 494c 4954 592c  HER.# LIABILITY,
+0002f7c0: 2057 4845 5448 4552 2049 4e20 414e 2041   WHETHER IN AN A
+0002f7d0: 4354 494f 4e20 4f46 2043 4f4e 5452 4143  CTION OF CONTRAC
+0002f7e0: 542c 2054 4f52 5420 4f52 204f 5448 4552  T, TORT OR OTHER
+0002f7f0: 5749 5345 2c20 4152 4953 494e 4720 4652  WISE, ARISING FR
+0002f800: 4f4d 2c0a 2320 4f55 5420 4f46 204f 5220  OM,.# OUT OF OR 
+0002f810: 494e 2043 4f4e 4e45 4354 494f 4e20 5749  IN CONNECTION WI
+0002f820: 5448 2054 4845 2053 4f46 5457 4152 4520  TH THE SOFTWARE 
+0002f830: 4f52 2054 4845 2055 5345 204f 5220 4f54  OR THE USE OR OT
+0002f840: 4845 5220 4445 414c 494e 4753 2049 4e20  HER DEALINGS IN 
+0002f850: 5448 450a 2320 534f 4654 5741 5245 2e0a  THE.# SOFTWARE..
+0002f860: 0a69 6d70 6f72 7420 6f73 0a66 726f 6d20  .import os.from 
+0002f870: 636f 6c6c 6563 7469 6f6e 7320 696d 706f  collections impo
+0002f880: 7274 204f 7264 6572 6564 4469 6374 0a66  rt OrderedDict.f
+0002f890: 726f 6d20 756e 6974 7465 7374 2069 6d70  rom unittest imp
+0002f8a0: 6f72 7420 6d6f 636b 0a0a 696d 706f 7274  ort mock..import
+0002f8b0: 2070 6738 3030 300a 696d 706f 7274 2070   pg8000.import p
+0002f8c0: 7379 636f 7067 320a 696d 706f 7274 2070  sycopg2.import p
+0002f8d0: 7974 6573 740a 0a69 6d70 6f72 7420 6c6f  ytest..import lo
+0002f8e0: 636f 7079 0a66 726f 6d20 6c6f 636f 7079  copy.from locopy
+0002f8f0: 2069 6d70 6f72 7420 5265 6473 6869 6674   import Redshift
+0002f900: 0a66 726f 6d20 6c6f 636f 7079 2e65 7272  .from locopy.err
+0002f910: 6f72 7320 696d 706f 7274 2043 7265 6465  ors import Crede
+0002f920: 6e74 6961 6c73 4572 726f 722c 2044 4245  ntialsError, DBE
+0002f930: 7272 6f72 0a0a 5052 4f46 494c 4520 3d20  rror..PROFILE = 
+0002f940: 2274 6573 7422 0a47 4f4f 445f 434f 4e46  "test".GOOD_CONF
+0002f950: 4947 5f59 414d 4c20 3d20 2222 220a 686f  IG_YAML = """.ho
+0002f960: 7374 3a20 686f 7374 0a70 6f72 743a 2070  st: host.port: p
+0002f970: 6f72 740a 6461 7461 6261 7365 3a20 6461  ort.database: da
+0002f980: 7461 6261 7365 0a75 7365 723a 2075 7365  tabase.user: use
+0002f990: 720a 7061 7373 776f 7264 3a20 7061 7373  r.password: pass
+0002f9a0: 776f 7264 2222 220a 0a44 4241 5049 5320  word"""..DBAPIS 
+0002f9b0: 3d20 5b70 6738 3030 302c 2070 7379 636f  = [pg8000, psyco
+0002f9c0: 7067 325d 0a43 5552 525f 4449 5220 3d20  pg2].CURR_DIR = 
+0002f9d0: 6f73 2e70 6174 682e 6469 726e 616d 6528  os.path.dirname(
+0002f9e0: 6f73 2e70 6174 682e 6162 7370 6174 6828  os.path.abspath(
+0002f9f0: 5f5f 6669 6c65 5f5f 2929 0a0a 0a64 6566  __file__))...def
+0002fa00: 2074 6573 745f 6164 645f 6465 6661 756c   test_add_defaul
+0002fa10: 745f 636f 7079 5f6f 7074 696f 6e73 2829  t_copy_options()
+0002fa20: 3a0a 2020 2020 6173 7365 7274 206c 6f63  :.    assert loc
+0002fa30: 6f70 792e 7265 6473 6869 6674 2e61 6464  opy.redshift.add
+0002fa40: 5f64 6566 6175 6c74 5f63 6f70 795f 6f70  _default_copy_op
+0002fa50: 7469 6f6e 7328 2920 3d3d 205b 0a20 2020  tions() == [.   
+0002fa60: 2020 2020 2022 4441 5445 464f 524d 4154       "DATEFORMAT
+0002fa70: 2027 6175 746f 2722 2c0a 2020 2020 2020   'auto'",.      
+0002fa80: 2020 2243 4f4d 5055 5044 4154 4520 4f4e    "COMPUPDATE ON
+0002fa90: 222c 0a20 2020 2020 2020 2022 5452 554e  ",.        "TRUN
+0002faa0: 4341 5445 434f 4c55 4d4e 5322 2c0a 2020  CATECOLUMNS",.  
+0002fab0: 2020 5d0a 2020 2020 6173 7365 7274 206c    ].    assert l
+0002fac0: 6f63 6f70 792e 7265 6473 6869 6674 2e61  ocopy.redshift.a
+0002fad0: 6464 5f64 6566 6175 6c74 5f63 6f70 795f  dd_default_copy_
+0002fae0: 6f70 7469 6f6e 7328 5b22 4441 5445 464f  options(["DATEFO
+0002faf0: 524d 4154 2027 6f74 6865 7227 222c 2022  RMAT 'other'", "
+0002fb00: 4e55 4c4c 2041 5320 2762 6c61 6827 225d  NULL AS 'blah'"]
+0002fb10: 2920 3d3d 205b 0a20 2020 2020 2020 2022  ) == [.        "
+0002fb20: 4441 5445 464f 524d 4154 2027 6f74 6865  DATEFORMAT 'othe
+0002fb30: 7227 222c 0a20 2020 2020 2020 2022 4e55  r'",.        "NU
+0002fb40: 4c4c 2041 5320 2762 6c61 6827 222c 0a20  LL AS 'blah'",. 
+0002fb50: 2020 2020 2020 2022 434f 4d50 5550 4441         "COMPUPDA
+0002fb60: 5445 204f 4e22 2c0a 2020 2020 2020 2020  TE ON",.        
+0002fb70: 2254 5255 4e43 4154 4543 4f4c 554d 4e53  "TRUNCATECOLUMNS
+0002fb80: 222c 0a20 2020 205d 0a0a 0a64 6566 2074  ",.    ]...def t
+0002fb90: 6573 745f 636f 6d62 696e 655f 636f 7079  est_combine_copy
+0002fba0: 5f6f 7074 696f 6e73 2829 3a0a 2020 2020  _options():.    
+0002fbb0: 6173 7365 7274 206c 6f63 6f70 792e 7265  assert locopy.re
+0002fbc0: 6473 6869 6674 2e63 6f6d 6269 6e65 5f63  dshift.combine_c
+0002fbd0: 6f70 795f 6f70 7469 6f6e 7328 6c6f 636f  opy_options(loco
+0002fbe0: 7079 2e72 6564 7368 6966 742e 6164 645f  py.redshift.add_
+0002fbf0: 6465 6661 756c 745f 636f 7079 5f6f 7074  default_copy_opt
+0002fc00: 696f 6e73 2829 2920 3d3d 2028 0a20 2020  ions()) == (.   
+0002fc10: 2020 2020 2022 4441 5445 464f 524d 4154       "DATEFORMAT
+0002fc20: 2027 6175 746f 2720 434f 4d50 5550 4441   'auto' COMPUPDA
+0002fc30: 5445 2022 2022 4f4e 2054 5255 4e43 4154  TE " "ON TRUNCAT
+0002fc40: 4543 4f4c 554d 4e53 220a 2020 2020 290a  ECOLUMNS".    ).
+0002fc50: 0a0a 4070 7974 6573 742e 6d61 726b 2e70  ..@pytest.mark.p
+0002fc60: 6172 616d 6574 7269 7a65 2822 6462 6170  arametrize("dbap
+0002fc70: 6922 2c20 4442 4150 4953 290a 406d 6f63  i", DBAPIS).@moc
+0002fc80: 6b2e 7061 7463 6828 226c 6f63 6f70 792e  k.patch("locopy.
+0002fc90: 7333 2e53 6573 7369 6f6e 2229 0a64 6566  s3.Session").def
+0002fca0: 2074 6573 745f 636f 6e73 7472 7563 746f   test_constructo
+0002fcb0: 7228 6d6f 636b 5f73 6573 7369 6f6e 2c20  r(mock_session, 
+0002fcc0: 6372 6564 656e 7469 616c 732c 2064 6261  credentials, dba
+0002fcd0: 7069 293a 0a20 2020 2072 203d 2052 6564  pi):.    r = Red
+0002fce0: 7368 6966 7428 7072 6f66 696c 653d 5052  shift(profile=PR
+0002fcf0: 4f46 494c 452c 2064 6261 7069 3d64 6261  OFILE, dbapi=dba
+0002fd00: 7069 2c20 2a2a 6372 6564 656e 7469 616c  pi, **credential
+0002fd10: 7329 0a20 2020 206d 6f63 6b5f 7365 7373  s).    mock_sess
+0002fd20: 696f 6e2e 6173 7365 7274 5f63 616c 6c65  ion.assert_calle
+0002fd30: 645f 7769 7468 2870 726f 6669 6c65 5f6e  d_with(profile_n
+0002fd40: 616d 653d 5052 4f46 494c 4529 0a20 2020  ame=PROFILE).   
+0002fd50: 2061 7373 6572 7420 722e 7072 6f66 696c   assert r.profil
+0002fd60: 6520 3d3d 2050 524f 4649 4c45 0a20 2020  e == PROFILE.   
+0002fd70: 2061 7373 6572 7420 722e 6b6d 735f 6b65   assert r.kms_ke
+0002fd80: 7920 3d3d 204e 6f6e 650a 2020 2020 6173  y == None.    as
+0002fd90: 7365 7274 2072 2e63 6f6e 6e65 6374 696f  sert r.connectio
+0002fda0: 6e5b 2268 6f73 7422 5d20 3d3d 2022 686f  n["host"] == "ho
+0002fdb0: 7374 220a 2020 2020 6173 7365 7274 2072  st".    assert r
+0002fdc0: 2e63 6f6e 6e65 6374 696f 6e5b 2270 6f72  .connection["por
+0002fdd0: 7422 5d20 3d3d 2022 706f 7274 220a 2020  t"] == "port".  
+0002fde0: 2020 6173 7365 7274 2072 2e63 6f6e 6e65    assert r.conne
+0002fdf0: 6374 696f 6e5b 2264 6174 6162 6173 6522  ction["database"
+0002fe00: 5d20 3d3d 2022 6461 7461 6261 7365 220a  ] == "database".
+0002fe10: 2020 2020 6173 7365 7274 2072 2e63 6f6e      assert r.con
+0002fe20: 6e65 6374 696f 6e5b 2275 7365 7222 5d20  nection["user"] 
+0002fe30: 3d3d 2022 7573 6572 220a 2020 2020 6173  == "user".    as
+0002fe40: 7365 7274 2072 2e63 6f6e 6e65 6374 696f  sert r.connectio
+0002fe50: 6e5b 2270 6173 7377 6f72 6422 5d20 3d3d  n["password"] ==
+0002fe60: 2022 7061 7373 776f 7264 220a 0a0a 4070   "password"...@p
+0002fe70: 7974 6573 742e 6d61 726b 2e70 6172 616d  ytest.mark.param
+0002fe80: 6574 7269 7a65 2822 6462 6170 6922 2c20  etrize("dbapi", 
+0002fe90: 4442 4150 4953 290a 6465 6620 7465 7374  DBAPIS).def test
+0002fea0: 5f63 6f6e 7374 7275 6374 6f72 5f63 7265  _constructor_cre
+0002feb0: 6465 6e74 6961 6c5f 6572 726f 7228 6372  dential_error(cr
+0002fec0: 6564 656e 7469 616c 732c 2064 6261 7069  edentials, dbapi
+0002fed0: 2c20 6361 706c 6f67 293a 0a20 2020 2072  , caplog):.    r
+0002fee0: 203d 2052 6564 7368 6966 7428 6462 6170   = Redshift(dbap
+0002fef0: 693d 6462 6170 692c 202a 2a63 7265 6465  i=dbapi, **crede
+0002ff00: 6e74 6961 6c73 290a 2020 2020 6173 7365  ntials).    asse
+0002ff10: 7274 2022 5333 2063 7265 6465 6e74 6961  rt "S3 credentia
+0002ff20: 6c73 2077 6572 6520 6e6f 7420 666f 756e  ls were not foun
+0002ff30: 642e 2053 3320 6675 6e63 7469 6f6e 616c  d. S3 functional
+0002ff40: 6974 7920 6973 2064 6973 6162 6c65 6422  ity is disabled"
+0002ff50: 2069 6e20 6361 706c 6f67 2e74 6578 740a   in caplog.text.
+0002ff60: 0a0a 4070 7974 6573 742e 6d61 726b 2e70  ..@pytest.mark.p
+0002ff70: 6172 616d 6574 7269 7a65 2822 6462 6170  arametrize("dbap
+0002ff80: 6922 2c20 4442 4150 4953 290a 406d 6f63  i", DBAPIS).@moc
+0002ff90: 6b2e 7061 7463 6828 226c 6f63 6f70 792e  k.patch("locopy.
+0002ffa0: 7574 696c 6974 792e 6f70 656e 222c 206d  utility.open", m
+0002ffb0: 6f63 6b2e 6d6f 636b 5f6f 7065 6e28 7265  ock.mock_open(re
+0002ffc0: 6164 5f64 6174 613d 474f 4f44 5f43 4f4e  ad_data=GOOD_CON
+0002ffd0: 4649 475f 5941 4d4c 2929 0a40 6d6f 636b  FIG_YAML)).@mock
+0002ffe0: 2e70 6174 6368 2822 6c6f 636f 7079 2e73  .patch("locopy.s
+0002fff0: 332e 5365 7373 696f 6e22 290a 6465 6620  3.Session").def 
+00030000: 7465 7374 5f63 6f6e 7374 7275 6374 6f72  test_constructor
+00030010: 5f79 616d 6c28 6d6f 636b 5f73 6573 7369  _yaml(mock_sessi
+00030020: 6f6e 2c20 6462 6170 6929 3a0a 2020 2020  on, dbapi):.    
+00030030: 7220 3d20 5265 6473 6869 6674 2870 726f  r = Redshift(pro
+00030040: 6669 6c65 3d50 524f 4649 4c45 2c20 6462  file=PROFILE, db
+00030050: 6170 693d 6462 6170 692c 2063 6f6e 6669  api=dbapi, confi
+00030060: 675f 7961 6d6c 3d22 736f 6d65 5f63 6f6e  g_yaml="some_con
+00030070: 6669 672e 796d 6c22 290a 2020 2020 6d6f  fig.yml").    mo
+00030080: 636b 5f73 6573 7369 6f6e 2e61 7373 6572  ck_session.asser
+00030090: 745f 6361 6c6c 6564 5f77 6974 6828 7072  t_called_with(pr
+000300a0: 6f66 696c 655f 6e61 6d65 3d50 524f 4649  ofile_name=PROFI
+000300b0: 4c45 290a 2020 2020 6173 7365 7274 2072  LE).    assert r
+000300c0: 2e70 726f 6669 6c65 203d 3d20 5052 4f46  .profile == PROF
+000300d0: 494c 450a 2020 2020 6173 7365 7274 2072  ILE.    assert r
+000300e0: 2e6b 6d73 5f6b 6579 203d 3d20 4e6f 6e65  .kms_key == None
+000300f0: 0a20 2020 2061 7373 6572 7420 722e 636f  .    assert r.co
+00030100: 6e6e 6563 7469 6f6e 5b22 686f 7374 225d  nnection["host"]
+00030110: 203d 3d20 2268 6f73 7422 0a20 2020 2061   == "host".    a
+00030120: 7373 6572 7420 722e 636f 6e6e 6563 7469  ssert r.connecti
+00030130: 6f6e 5b22 706f 7274 225d 203d 3d20 2270  on["port"] == "p
+00030140: 6f72 7422 0a20 2020 2061 7373 6572 7420  ort".    assert 
+00030150: 722e 636f 6e6e 6563 7469 6f6e 5b22 6461  r.connection["da
+00030160: 7461 6261 7365 225d 203d 3d20 2264 6174  tabase"] == "dat
+00030170: 6162 6173 6522 0a20 2020 2061 7373 6572  abase".    asser
+00030180: 7420 722e 636f 6e6e 6563 7469 6f6e 5b22  t r.connection["
+00030190: 7573 6572 225d 203d 3d20 2275 7365 7222  user"] == "user"
+000301a0: 0a20 2020 2061 7373 6572 7420 722e 636f  .    assert r.co
+000301b0: 6e6e 6563 7469 6f6e 5b22 7061 7373 776f  nnection["passwo
+000301c0: 7264 225d 203d 3d20 2270 6173 7377 6f72  rd"] == "passwor
+000301d0: 6422 0a0a 0a40 7079 7465 7374 2e6d 6172  d"...@pytest.mar
+000301e0: 6b2e 7061 7261 6d65 7472 697a 6528 2264  k.parametrize("d
+000301f0: 6261 7069 222c 2044 4241 5049 5329 0a40  bapi", DBAPIS).@
+00030200: 6d6f 636b 2e70 6174 6368 2822 6c6f 636f  mock.patch("loco
+00030210: 7079 2e73 332e 5365 7373 696f 6e22 290a  py.s3.Session").
+00030220: 6465 6620 7465 7374 5f72 6564 7368 6966  def test_redshif
+00030230: 745f 636f 6e6e 6563 7428 6d6f 636b 5f73  t_connect(mock_s
+00030240: 6573 7369 6f6e 2c20 6372 6564 656e 7469  ession, credenti
+00030250: 616c 732c 2064 6261 7069 293a 0a20 2020  als, dbapi):.   
+00030260: 2077 6974 6820 6d6f 636b 2e70 6174 6368   with mock.patch
+00030270: 2864 6261 7069 2e5f 5f6e 616d 655f 5f20  (dbapi.__name__ 
+00030280: 2b20 222e 636f 6e6e 6563 7422 2920 6173  + ".connect") as
+00030290: 206d 6f63 6b5f 636f 6e6e 6563 743a 0a20   mock_connect:. 
+000302a0: 2020 2020 2020 2072 203d 2052 6564 7368         r = Redsh
+000302b0: 6966 7428 7072 6f66 696c 653d 5052 4f46  ift(profile=PROF
+000302c0: 494c 452c 2064 6261 7069 3d64 6261 7069  ILE, dbapi=dbapi
+000302d0: 2c20 2a2a 6372 6564 656e 7469 616c 7329  , **credentials)
+000302e0: 0a20 2020 2020 2020 2072 2e63 6f6e 6e65  .        r.conne
+000302f0: 6374 2829 0a0a 2020 2020 2020 2020 6966  ct()..        if
+00030300: 2064 6261 7069 2e5f 5f6e 616d 655f 5f20   dbapi.__name__ 
+00030310: 3d3d 2022 7067 3830 3030 223a 0a20 2020  == "pg8000":.   
+00030320: 2020 2020 2020 2020 206d 6f63 6b5f 636f           mock_co
+00030330: 6e6e 6563 742e 6173 7365 7274 5f63 616c  nnect.assert_cal
+00030340: 6c65 645f 7769 7468 280a 2020 2020 2020  led_with(.      
+00030350: 2020 2020 2020 2020 2020 686f 7374 3d22            host="
+00030360: 686f 7374 222c 0a20 2020 2020 2020 2020  host",.         
+00030370: 2020 2020 2020 2075 7365 723d 2275 7365         user="use
+00030380: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
+00030390: 2020 2020 706f 7274 3d22 706f 7274 222c      port="port",
+000303a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000303b0: 2070 6173 7377 6f72 643d 2270 6173 7377   password="passw
+000303c0: 6f72 6422 2c0a 2020 2020 2020 2020 2020  ord",.          
+000303d0: 2020 2020 2020 6461 7461 6261 7365 3d22        database="
+000303e0: 6461 7461 6261 7365 222c 0a20 2020 2020  database",.     
+000303f0: 2020 2020 2020 2020 2020 2073 736c 5f63             ssl_c
+00030400: 6f6e 7465 7874 3d54 7275 652c 0a20 2020  ontext=True,.   
+00030410: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00030420: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00030430: 2020 2020 206d 6f63 6b5f 636f 6e6e 6563       mock_connec
+00030440: 742e 6173 7365 7274 5f63 616c 6c65 645f  t.assert_called_
+00030450: 7769 7468 280a 2020 2020 2020 2020 2020  with(.          
+00030460: 2020 2020 2020 686f 7374 3d22 686f 7374        host="host
+00030470: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00030480: 2020 2075 7365 723d 2275 7365 7222 2c0a     user="user",.
+00030490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000304a0: 706f 7274 3d22 706f 7274 222c 0a20 2020  port="port",.   
+000304b0: 2020 2020 2020 2020 2020 2020 2070 6173               pas
+000304c0: 7377 6f72 643d 2270 6173 7377 6f72 6422  sword="password"
+000304d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000304e0: 2020 6461 7461 6261 7365 3d22 6461 7461    database="data
+000304f0: 6261 7365 222c 0a20 2020 2020 2020 2020  base",.         
+00030500: 2020 2020 2020 2073 736c 6d6f 6465 3d22         sslmode="
+00030510: 7265 7175 6972 6522 2c0a 2020 2020 2020  require",.      
+00030520: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00030530: 722e 636f 6e6e 2e63 7572 736f 722e 6173  r.conn.cursor.as
+00030540: 7365 7274 5f63 616c 6c65 645f 7769 7468  sert_called_with
+00030550: 2829 0a0a 2020 2020 2020 2020 2320 7369  ()..        # si
+00030560: 6465 2065 6666 6563 7420 6578 6365 7074  de effect except
+00030570: 696f 6e0a 2020 2020 2020 2020 6d6f 636b  ion.        mock
+00030580: 5f63 6f6e 6e65 6374 2e73 6964 655f 6566  _connect.side_ef
+00030590: 6665 6374 203d 2045 7863 6570 7469 6f6e  fect = Exception
+000305a0: 2822 436f 6e6e 6563 7420 4578 6365 7074  ("Connect Except
+000305b0: 696f 6e22 290a 2020 2020 2020 2020 7769  ion").        wi
+000305c0: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
+000305d0: 2844 4245 7272 6f72 293a 0a20 2020 2020  (DBError):.     
+000305e0: 2020 2020 2020 2072 2e63 6f6e 6e65 6374         r.connect
+000305f0: 2829 0a0a 0a40 7079 7465 7374 2e6d 6172  ()...@pytest.mar
+00030600: 6b2e 7061 7261 6d65 7472 697a 6528 2264  k.parametrize("d
+00030610: 6261 7069 222c 2044 4241 5049 5329 0a40  bapi", DBAPIS).@
+00030620: 6d6f 636b 2e70 6174 6368 2822 6c6f 636f  mock.patch("loco
+00030630: 7079 2e73 332e 5365 7373 696f 6e22 290a  py.s3.Session").
+00030640: 406d 6f63 6b2e 7061 7463 6828 226c 6f63  @mock.patch("loc
+00030650: 6f70 792e 7265 6473 6869 6674 2e52 6564  opy.redshift.Red
+00030660: 7368 6966 742e 6578 6563 7574 6522 290a  shift.execute").
+00030670: 6465 6620 7465 7374 5f63 6f70 795f 7061  def test_copy_pa
+00030680: 7271 7565 7428 6d6f 636b 5f65 7865 6375  rquet(mock_execu
+00030690: 7465 2c20 6d6f 636b 5f73 6573 7369 6f6e  te, mock_session
+000306a0: 2c20 6372 6564 656e 7469 616c 732c 2064  , credentials, d
+000306b0: 6261 7069 293a 0a20 2020 2077 6974 6820  bapi):.    with 
+000306c0: 6d6f 636b 2e70 6174 6368 2864 6261 7069  mock.patch(dbapi
+000306d0: 2e5f 5f6e 616d 655f 5f20 2b20 222e 636f  .__name__ + ".co
+000306e0: 6e6e 6563 7422 2920 6173 206d 6f63 6b5f  nnect") as mock_
+000306f0: 636f 6e6e 6563 743a 0a20 2020 2020 2020  connect:.       
+00030700: 2072 203d 2052 6564 7368 6966 7428 7072   r = Redshift(pr
+00030710: 6f66 696c 653d 5052 4f46 494c 452c 2064  ofile=PROFILE, d
+00030720: 6261 7069 3d64 6261 7069 2c20 2a2a 6372  bapi=dbapi, **cr
+00030730: 6564 656e 7469 616c 7329 0a20 2020 2020  edentials).     
+00030740: 2020 2072 2e63 6f6e 6e65 6374 2829 0a20     r.connect(). 
+00030750: 2020 2020 2020 2072 2e63 6f70 7928 2274         r.copy("t
+00030760: 6162 6c65 222c 2073 3370 6174 683d 2270  able", s3path="p
+00030770: 6174 6822 2c20 6465 6c69 6d3d 4e6f 6e65  ath", delim=None
+00030780: 2c20 636f 7079 5f6f 7074 696f 6e73 3d5b  , copy_options=[
+00030790: 2250 4152 5155 4554 225d 290a 2020 2020  "PARQUET"]).    
+000307a0: 2020 2020 7465 7374 5f73 716c 203d 2028      test_sql = (
+000307b0: 0a20 2020 2020 2020 2020 2020 2022 434f  .            "CO
+000307c0: 5059 207b 307d 2046 524f 4d20 277b 317d  PY {0} FROM '{1}
+000307d0: 2720 220a 2020 2020 2020 2020 2020 2020  ' ".            
+000307e0: 2243 5245 4445 4e54 4941 4c53 2027 7b32  "CREDENTIALS '{2
+000307f0: 7d27 2022 0a20 2020 2020 2020 2020 2020  }' ".           
+00030800: 2022 7b33 7d3b 222e 666f 726d 6174 2822   "{3};".format("
+00030810: 7461 626c 6522 2c20 2270 6174 6822 2c20  table", "path", 
+00030820: 722e 5f63 7265 6465 6e74 6961 6c73 5f73  r._credentials_s
+00030830: 7472 696e 6728 292c 2022 5041 5251 5545  tring(), "PARQUE
+00030840: 5422 290a 2020 2020 2020 2020 290a 2020  T").        ).  
+00030850: 2020 2020 2020 6173 7365 7274 206d 6f63        assert moc
+00030860: 6b5f 6578 6563 7574 652e 6361 6c6c 6564  k_execute.called
+00030870: 5f77 6974 6828 7465 7374 5f73 716c 2c20  _with(test_sql, 
+00030880: 636f 6d6d 6974 3d54 7275 6529 0a20 2020  commit=True).   
+00030890: 2020 2020 206d 6f63 6b5f 6578 6563 7574       mock_execut
+000308a0: 652e 7265 7365 745f 6d6f 636b 2829 0a20  e.reset_mock(). 
+000308b0: 2020 2020 2020 206d 6f63 6b5f 7365 7373         mock_sess
+000308c0: 696f 6e2e 7265 7365 745f 6d6f 636b 2829  ion.reset_mock()
+000308d0: 0a20 2020 2020 2020 2072 2e63 6f70 7928  .        r.copy(
+000308e0: 2274 6162 6c65 222c 2073 3370 6174 683d  "table", s3path=
+000308f0: 2270 6174 6822 2c20 6465 6c69 6d3d 4e6f  "path", delim=No
+00030900: 6e65 290a 2020 2020 2020 2020 7465 7374  ne).        test
+00030910: 5f73 716c 203d 2028 0a20 2020 2020 2020  _sql = (.       
+00030920: 2020 2020 2022 434f 5059 207b 307d 2046       "COPY {0} F
+00030930: 524f 4d20 277b 317d 2720 220a 2020 2020  ROM '{1}' ".    
+00030940: 2020 2020 2020 2020 2243 5245 4445 4e54          "CREDENT
+00030950: 4941 4c53 2027 7b32 7d27 2022 0a20 2020  IALS '{2}' ".   
+00030960: 2020 2020 2020 2020 2022 7b33 7d3b 222e           "{3};".
+00030970: 666f 726d 6174 280a 2020 2020 2020 2020  format(.        
+00030980: 2020 2020 2020 2020 2274 6162 6c65 222c          "table",
+00030990: 2022 7061 7468 222c 2072 2e5f 6372 6564   "path", r._cred
+000309a0: 656e 7469 616c 735f 7374 7269 6e67 2829  entials_string()
+000309b0: 2c20 6c6f 636f 7079 2e72 6564 7368 6966  , locopy.redshif
+000309c0: 742e 6164 645f 6465 6661 756c 745f 636f  t.add_default_co
+000309d0: 7079 5f6f 7074 696f 6e73 2829 0a20 2020  py_options().   
+000309e0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+000309f0: 2020 2029 0a20 2020 2020 2020 2061 7373     ).        ass
+00030a00: 6572 7420 6d6f 636b 5f65 7865 6375 7465  ert mock_execute
+00030a10: 2e63 616c 6c65 645f 7769 7468 2874 6573  .called_with(tes
+00030a20: 745f 7371 6c2c 2063 6f6d 6d69 743d 5472  t_sql, commit=Tr
+00030a30: 7565 290a 0a0a 4070 7974 6573 742e 6d61  ue)...@pytest.ma
+00030a40: 726b 2e70 6172 616d 6574 7269 7a65 2822  rk.parametrize("
+00030a50: 6462 6170 6922 2c20 4442 4150 4953 290a  dbapi", DBAPIS).
+00030a60: 406d 6f63 6b2e 7061 7463 6828 226c 6f63  @mock.patch("loc
+00030a70: 6f70 792e 7574 696c 6974 792e 6f73 2e72  opy.utility.os.r
+00030a80: 656d 6f76 6522 290a 406d 6f63 6b2e 7061  emove").@mock.pa
+00030a90: 7463 6828 226c 6f63 6f70 792e 7265 6473  tch("locopy.reds
+00030aa0: 6869 6674 2e52 6564 7368 6966 742e 636f  hift.Redshift.co
+00030ab0: 7079 2229 0a40 6d6f 636b 2e70 6174 6368  py").@mock.patch
+00030ac0: 2822 6c6f 636f 7079 2e72 6564 7368 6966  ("locopy.redshif
+00030ad0: 742e 5265 6473 6869 6674 2e75 706c 6f61  t.Redshift.uploa
+00030ae0: 645f 746f 5f73 3322 290a 406d 6f63 6b2e  d_to_s3").@mock.
+00030af0: 7061 7463 6828 226c 6f63 6f70 792e 7265  patch("locopy.re
+00030b00: 6473 6869 6674 2e52 6564 7368 6966 742e  dshift.Redshift.
+00030b10: 6465 6c65 7465 5f66 726f 6d5f 7333 2229  delete_from_s3")
+00030b20: 0a40 6d6f 636b 2e70 6174 6368 2822 6c6f  .@mock.patch("lo
+00030b30: 636f 7079 2e73 332e 5365 7373 696f 6e22  copy.s3.Session"
+00030b40: 290a 406d 6f63 6b2e 7061 7463 6828 226c  ).@mock.patch("l
+00030b50: 6f63 6f70 792e 7265 6473 6869 6674 2e63  ocopy.redshift.c
+00030b60: 6f6d 7072 6573 735f 6669 6c65 5f6c 6973  ompress_file_lis
+00030b70: 7422 290a 406d 6f63 6b2e 7061 7463 6828  t").@mock.patch(
+00030b80: 226c 6f63 6f70 792e 7265 6473 6869 6674  "locopy.redshift
+00030b90: 2e73 706c 6974 5f66 696c 6522 290a 6465  .split_file").de
+00030ba0: 6620 7465 7374 5f6c 6f61 645f 616e 645f  f test_load_and_
+00030bb0: 636f 7079 280a 2020 2020 6d6f 636b 5f73  copy(.    mock_s
+00030bc0: 706c 6974 5f66 696c 652c 0a20 2020 206d  plit_file,.    m
+00030bd0: 6f63 6b5f 636f 6d70 7265 7373 5f66 696c  ock_compress_fil
+00030be0: 655f 6c69 7374 2c0a 2020 2020 6d6f 636b  e_list,.    mock
+00030bf0: 5f73 6573 7369 6f6e 2c0a 2020 2020 6d6f  _session,.    mo
+00030c00: 636b 5f73 335f 6465 6c65 7465 2c0a 2020  ck_s3_delete,.  
+00030c10: 2020 6d6f 636b 5f73 335f 7570 6c6f 6164    mock_s3_upload
+00030c20: 2c0a 2020 2020 6d6f 636b 5f72 735f 636f  ,.    mock_rs_co
+00030c30: 7079 2c0a 2020 2020 6d6f 636b 5f72 656d  py,.    mock_rem
+00030c40: 6f76 652c 0a20 2020 2063 7265 6465 6e74  ove,.    credent
+00030c50: 6961 6c73 2c0a 2020 2020 6462 6170 692c  ials,.    dbapi,
+00030c60: 0a29 3a0a 2020 2020 6465 6620 7265 7365  .):.    def rese
+00030c70: 745f 6d6f 636b 7328 293a 0a20 2020 2020  t_mocks():.     
+00030c80: 2020 206d 6f63 6b5f 7370 6c69 745f 6669     mock_split_fi
+00030c90: 6c65 2e72 6573 6574 5f6d 6f63 6b28 290a  le.reset_mock().
+00030ca0: 2020 2020 2020 2020 6d6f 636b 5f63 6f6d          mock_com
+00030cb0: 7072 6573 735f 6669 6c65 5f6c 6973 742e  press_file_list.
+00030cc0: 7265 7365 745f 6d6f 636b 2829 0a20 2020  reset_mock().   
+00030cd0: 2020 2020 206d 6f63 6b5f 7333 5f75 706c       mock_s3_upl
+00030ce0: 6f61 642e 7265 7365 745f 6d6f 636b 2829  oad.reset_mock()
+00030cf0: 0a20 2020 2020 2020 206d 6f63 6b5f 7333  .        mock_s3
+00030d00: 5f64 656c 6574 652e 7265 7365 745f 6d6f  _delete.reset_mo
+00030d10: 636b 2829 0a20 2020 2020 2020 206d 6f63  ck().        moc
+00030d20: 6b5f 7273 5f63 6f70 792e 7265 7365 745f  k_rs_copy.reset_
+00030d30: 6d6f 636b 2829 0a20 2020 2020 2020 206d  mock().        m
+00030d40: 6f63 6b5f 7265 6d6f 7665 2e72 6573 6574  ock_remove.reset
+00030d50: 5f6d 6f63 6b28 290a 0a20 2020 2077 6974  _mock()..    wit
+00030d60: 6820 6d6f 636b 2e70 6174 6368 2864 6261  h mock.patch(dba
+00030d70: 7069 2e5f 5f6e 616d 655f 5f20 2b20 222e  pi.__name__ + ".
+00030d80: 636f 6e6e 6563 7422 2920 6173 206d 6f63  connect") as moc
+00030d90: 6b5f 636f 6e6e 6563 743a 0a20 2020 2020  k_connect:.     
+00030da0: 2020 2072 203d 2052 6564 7368 6966 7428     r = Redshift(
+00030db0: 6462 6170 693d 6462 6170 692c 202a 2a63  dbapi=dbapi, **c
+00030dc0: 7265 6465 6e74 6961 6c73 290a 2020 2020  redentials).    
+00030dd0: 2020 2020 722e 636f 6e6e 6563 7428 290a      r.connect().
+00030de0: 0a20 2020 2020 2020 2065 7870 6563 7465  .        expecte
+00030df0: 645f 6361 6c6c 735f 6e6f 5f66 6f6c 6465  d_calls_no_folde
+00030e00: 7220 3d20 5b0a 2020 2020 2020 2020 2020  r = [.          
+00030e10: 2020 6d6f 636b 2e63 616c 6c28 222f 7061    mock.call("/pa
+00030e20: 7468 2f6c 6f63 616c 5f66 696c 652e 3022  th/local_file.0"
+00030e30: 2c20 2273 335f 6275 636b 6574 222c 2022  , "s3_bucket", "
+00030e40: 6c6f 6361 6c5f 6669 6c65 2e30 2229 2c0a  local_file.0"),.
+00030e50: 2020 2020 2020 2020 2020 2020 6d6f 636b              mock
+00030e60: 2e63 616c 6c28 222f 7061 7468 2f6c 6f63  .call("/path/loc
+00030e70: 616c 5f66 696c 652e 3122 2c20 2273 335f  al_file.1", "s3_
+00030e80: 6275 636b 6574 222c 2022 6c6f 6361 6c5f  bucket", "local_
+00030e90: 6669 6c65 2e31 2229 2c0a 2020 2020 2020  file.1"),.      
+00030ea0: 2020 2020 2020 6d6f 636b 2e63 616c 6c28        mock.call(
+00030eb0: 222f 7061 7468 2f6c 6f63 616c 5f66 696c  "/path/local_fil
+00030ec0: 652e 3222 2c20 2273 335f 6275 636b 6574  e.2", "s3_bucket
+00030ed0: 222c 2022 6c6f 6361 6c5f 6669 6c65 2e32  ", "local_file.2
+00030ee0: 2229 2c0a 2020 2020 2020 2020 5d0a 0a20  "),.        ].. 
+00030ef0: 2020 2020 2020 2065 7870 6563 7465 645f         expected_
+00030f00: 6361 6c6c 735f 6e6f 5f66 6f6c 6465 725f  calls_no_folder_
+00030f10: 677a 6970 203d 205b 0a20 2020 2020 2020  gzip = [.       
+00030f20: 2020 2020 206d 6f63 6b2e 6361 6c6c 2822       mock.call("
+00030f30: 2f70 6174 682f 6c6f 6361 6c5f 6669 6c65  /path/local_file
+00030f40: 2e30 2e67 7a22 2c20 2273 335f 6275 636b  .0.gz", "s3_buck
+00030f50: 6574 222c 2022 6c6f 6361 6c5f 6669 6c65  et", "local_file
+00030f60: 2e30 2e67 7a22 292c 0a20 2020 2020 2020  .0.gz"),.       
+00030f70: 2020 2020 206d 6f63 6b2e 6361 6c6c 2822       mock.call("
+00030f80: 2f70 6174 682f 6c6f 6361 6c5f 6669 6c65  /path/local_file
+00030f90: 2e31 2e67 7a22 2c20 2273 335f 6275 636b  .1.gz", "s3_buck
+00030fa0: 6574 222c 2022 6c6f 6361 6c5f 6669 6c65  et", "local_file
+00030fb0: 2e31 2e67 7a22 292c 0a20 2020 2020 2020  .1.gz"),.       
+00030fc0: 2020 2020 206d 6f63 6b2e 6361 6c6c 2822       mock.call("
+00030fd0: 2f70 6174 682f 6c6f 6361 6c5f 6669 6c65  /path/local_file
+00030fe0: 2e32 2e67 7a22 2c20 2273 335f 6275 636b  .2.gz", "s3_buck
+00030ff0: 6574 222c 2022 6c6f 6361 6c5f 6669 6c65  et", "local_file
+00031000: 2e32 2e67 7a22 292c 0a20 2020 2020 2020  .2.gz"),.       
+00031010: 205d 0a0a 2020 2020 2020 2020 6578 7065   ]..        expe
+00031020: 6374 6564 5f63 616c 6c73 5f66 6f6c 6465  cted_calls_folde
+00031030: 7220 3d20 5b0a 2020 2020 2020 2020 2020  r = [.          
+00031040: 2020 6d6f 636b 2e63 616c 6c28 222f 7061    mock.call("/pa
+00031050: 7468 2f6c 6f63 616c 5f66 696c 652e 3022  th/local_file.0"
+00031060: 2c20 2273 335f 6275 636b 6574 222c 2022  , "s3_bucket", "
+00031070: 7465 7374 2f6c 6f63 616c 5f66 696c 652e  test/local_file.
+00031080: 3022 292c 0a20 2020 2020 2020 2020 2020  0"),.           
+00031090: 206d 6f63 6b2e 6361 6c6c 2822 2f70 6174   mock.call("/pat
+000310a0: 682f 6c6f 6361 6c5f 6669 6c65 2e31 222c  h/local_file.1",
+000310b0: 2022 7333 5f62 7563 6b65 7422 2c20 2274   "s3_bucket", "t
+000310c0: 6573 742f 6c6f 6361 6c5f 6669 6c65 2e31  est/local_file.1
+000310d0: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
+000310e0: 6d6f 636b 2e63 616c 6c28 222f 7061 7468  mock.call("/path
+000310f0: 2f6c 6f63 616c 5f66 696c 652e 3222 2c20  /local_file.2", 
+00031100: 2273 335f 6275 636b 6574 222c 2022 7465  "s3_bucket", "te
+00031110: 7374 2f6c 6f63 616c 5f66 696c 652e 3222  st/local_file.2"
+00031120: 292c 0a20 2020 2020 2020 205d 0a0a 2020  ),.        ]..  
+00031130: 2020 2020 2020 6578 7065 6374 6564 5f63        expected_c
+00031140: 616c 6c73 5f66 6f6c 6465 725f 677a 6970  alls_folder_gzip
+00031150: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
+00031160: 206d 6f63 6b2e 6361 6c6c 2822 2f70 6174   mock.call("/pat
+00031170: 682f 6c6f 6361 6c5f 6669 6c65 2e30 2e67  h/local_file.0.g
+00031180: 7a22 2c20 2273 335f 6275 636b 6574 222c  z", "s3_bucket",
+00031190: 2022 7465 7374 2f6c 6f63 616c 5f66 696c   "test/local_fil
+000311a0: 652e 302e 677a 2229 2c0a 2020 2020 2020  e.0.gz"),.      
+000311b0: 2020 2020 2020 6d6f 636b 2e63 616c 6c28        mock.call(
+000311c0: 222f 7061 7468 2f6c 6f63 616c 5f66 696c  "/path/local_fil
+000311d0: 652e 312e 677a 222c 2022 7333 5f62 7563  e.1.gz", "s3_buc
+000311e0: 6b65 7422 2c20 2274 6573 742f 6c6f 6361  ket", "test/loca
+000311f0: 6c5f 6669 6c65 2e31 2e67 7a22 292c 0a20  l_file.1.gz"),. 
+00031200: 2020 2020 2020 2020 2020 206d 6f63 6b2e             mock.
+00031210: 6361 6c6c 2822 2f70 6174 682f 6c6f 6361  call("/path/loca
+00031220: 6c5f 6669 6c65 2e32 2e67 7a22 2c20 2273  l_file.2.gz", "s
+00031230: 335f 6275 636b 6574 222c 2022 7465 7374  3_bucket", "test
+00031240: 2f6c 6f63 616c 5f66 696c 652e 322e 677a  /local_file.2.gz
+00031250: 2229 2c0a 2020 2020 2020 2020 5d0a 0a20  "),.        ].. 
+00031260: 2020 2020 2020 206d 6f63 6b5f 7370 6c69         mock_spli
+00031270: 745f 6669 6c65 2e72 6574 7572 6e5f 7661  t_file.return_va
+00031280: 6c75 6520 3d20 5b22 2f70 6174 682f 6c6f  lue = ["/path/lo
+00031290: 6361 6c5f 6669 6c65 2e74 7874 225d 0a20  cal_file.txt"]. 
+000312a0: 2020 2020 2020 206d 6f63 6b5f 636f 6d70         mock_comp
+000312b0: 7265 7373 5f66 696c 655f 6c69 7374 2e72  ress_file_list.r
+000312c0: 6574 7572 6e5f 7661 6c75 6520 3d20 5b22  eturn_value = ["
+000312d0: 2f70 6174 682f 6c6f 6361 6c5f 6669 6c65  /path/local_file
+000312e0: 2e74 7874 2e67 7a22 5d0a 2020 2020 2020  .txt.gz"].      
+000312f0: 2020 722e 6c6f 6164 5f61 6e64 5f63 6f70    r.load_and_cop
+00031300: 7928 222f 7061 7468 2f6c 6f63 616c 5f66  y("/path/local_f
+00031310: 696c 652e 7478 7422 2c20 2273 335f 6275  ile.txt", "s3_bu
+00031320: 636b 6574 222c 2022 7461 626c 655f 6e61  cket", "table_na
+00031330: 6d65 222c 2064 656c 696d 3d22 7c22 290a  me", delim="|").
+00031340: 0a20 2020 2020 2020 2023 2061 7373 6572  .        # asser
+00031350: 740a 2020 2020 2020 2020 6173 7365 7274  t.        assert
+00031360: 206d 6f63 6b5f 7370 6c69 745f 6669 6c65   mock_split_file
+00031370: 2e63 616c 6c65 640a 2020 2020 2020 2020  .called.        
+00031380: 6d6f 636b 5f63 6f6d 7072 6573 735f 6669  mock_compress_fi
+00031390: 6c65 5f6c 6973 742e 6173 7365 7274 5f63  le_list.assert_c
+000313a0: 616c 6c65 645f 7769 7468 285b 222f 7061  alled_with(["/pa
+000313b0: 7468 2f6c 6f63 616c 5f66 696c 652e 7478  th/local_file.tx
+000313c0: 7422 5d29 0a20 2020 2020 2020 2023 206d  t"]).        # m
+000313d0: 6f63 6b5f 7265 6d6f 7665 2e61 7373 6572  ock_remove.asser
+000313e0: 745f 6361 6c6c 6564 5f77 6974 6828 222f  t_called_with("/
+000313f0: 7061 7468 2f6c 6f63 616c 5f66 696c 652e  path/local_file.
+00031400: 7478 7422 290a 2020 2020 2020 2020 6d6f  txt").        mo
+00031410: 636b 5f73 335f 7570 6c6f 6164 2e61 7373  ck_s3_upload.ass
+00031420: 6572 745f 6361 6c6c 6564 5f77 6974 6828  ert_called_with(
+00031430: 0a20 2020 2020 2020 2020 2020 2022 2f70  .            "/p
+00031440: 6174 682f 6c6f 6361 6c5f 6669 6c65 2e74  ath/local_file.t
+00031450: 7874 2e67 7a22 2c20 2273 335f 6275 636b  xt.gz", "s3_buck
+00031460: 6574 222c 2022 6c6f 6361 6c5f 6669 6c65  et", "local_file
+00031470: 2e74 7874 2e67 7a22 0a20 2020 2020 2020  .txt.gz".       
+00031480: 2029 0a20 2020 2020 2020 206d 6f63 6b5f   ).        mock_
+00031490: 7273 5f63 6f70 792e 6173 7365 7274 5f63  rs_copy.assert_c
+000314a0: 616c 6c65 645f 7769 7468 280a 2020 2020  alled_with(.    
+000314b0: 2020 2020 2020 2020 2274 6162 6c65 5f6e          "table_n
+000314c0: 616d 6522 2c20 2273 333a 2f2f 7333 5f62  ame", "s3://s3_b
+000314d0: 7563 6b65 742f 6c6f 6361 6c5f 6669 6c65  ucket/local_file
+000314e0: 222c 2022 7c22 2c20 636f 7079 5f6f 7074  ", "|", copy_opt
+000314f0: 696f 6e73 3d5b 2247 5a49 5022 5d0a 2020  ions=["GZIP"].  
+00031500: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00031510: 6173 7365 7274 206e 6f74 206d 6f63 6b5f  assert not mock_
+00031520: 7333 5f64 656c 6574 652e 6361 6c6c 6564  s3_delete.called
+00031530: 2c20 224f 6e6c 7920 6465 6c65 7465 2077  , "Only delete w
+00031540: 6865 6e20 6578 706c 6963 6974 220a 0a20  hen explicit".. 
+00031550: 2020 2020 2020 2072 6573 6574 5f6d 6f63         reset_moc
+00031560: 6b73 2829 0a20 2020 2020 2020 206d 6f63  ks().        moc
+00031570: 6b5f 7370 6c69 745f 6669 6c65 2e72 6574  k_split_file.ret
+00031580: 7572 6e5f 7661 6c75 6520 3d20 5b0a 2020  urn_value = [.  
+00031590: 2020 2020 2020 2020 2020 222f 7061 7468            "/path
+000315a0: 2f6c 6f63 616c 5f66 696c 652e 3022 2c0a  /local_file.0",.
+000315b0: 2020 2020 2020 2020 2020 2020 222f 7061              "/pa
+000315c0: 7468 2f6c 6f63 616c 5f66 696c 652e 3122  th/local_file.1"
+000315d0: 2c0a 2020 2020 2020 2020 2020 2020 222f  ,.            "/
+000315e0: 7061 7468 2f6c 6f63 616c 5f66 696c 652e  path/local_file.
+000315f0: 3222 2c0a 2020 2020 2020 2020 5d0a 2020  2",.        ].  
+00031600: 2020 2020 2020 6d6f 636b 5f63 6f6d 7072        mock_compr
+00031610: 6573 735f 6669 6c65 5f6c 6973 742e 7265  ess_file_list.re
+00031620: 7475 726e 5f76 616c 7565 203d 205b 0a20  turn_value = [. 
+00031630: 2020 2020 2020 2020 2020 2022 2f70 6174             "/pat
+00031640: 682f 6c6f 6361 6c5f 6669 6c65 2e30 2e67  h/local_file.0.g
+00031650: 7a22 2c0a 2020 2020 2020 2020 2020 2020  z",.            
+00031660: 222f 7061 7468 2f6c 6f63 616c 5f66 696c  "/path/local_fil
+00031670: 652e 312e 677a 222c 0a20 2020 2020 2020  e.1.gz",.       
+00031680: 2020 2020 2022 2f70 6174 682f 6c6f 6361       "/path/loca
+00031690: 6c5f 6669 6c65 2e32 2e67 7a22 2c0a 2020  l_file.2.gz",.  
+000316a0: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
+000316b0: 722e 6c6f 6164 5f61 6e64 5f63 6f70 7928  r.load_and_copy(
+000316c0: 0a20 2020 2020 2020 2020 2020 2022 2f70  .            "/p
+000316d0: 6174 682f 6c6f 6361 6c5f 6669 6c65 222c  ath/local_file",
+000316e0: 0a20 2020 2020 2020 2020 2020 2022 7333  .            "s3
+000316f0: 5f62 7563 6b65 7422 2c0a 2020 2020 2020  _bucket",.      
+00031700: 2020 2020 2020 2274 6162 6c65 5f6e 616d        "table_nam
+00031710: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+00031720: 6465 6c69 6d3d 227c 222c 0a20 2020 2020  delim="|",.     
+00031730: 2020 2020 2020 2063 6f70 795f 6f70 7469         copy_opti
+00031740: 6f6e 733d 5b22 534f 4d45 204f 5054 494f  ons=["SOME OPTIO
+00031750: 4e22 5d2c 0a20 2020 2020 2020 2020 2020  N"],.           
+00031760: 2073 706c 6974 733d 332c 0a20 2020 2020   splits=3,.     
+00031770: 2020 2020 2020 2064 656c 6574 655f 7333         delete_s3
+00031780: 5f61 6674 6572 3d54 7275 652c 0a20 2020  _after=True,.   
+00031790: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+000317a0: 2320 6173 7365 7274 0a20 2020 2020 2020  # assert.       
+000317b0: 206d 6f63 6b5f 7370 6c69 745f 6669 6c65   mock_split_file
+000317c0: 2e61 7373 6572 745f 6361 6c6c 6564 5f77  .assert_called_w
+000317d0: 6974 6828 0a20 2020 2020 2020 2020 2020  ith(.           
+000317e0: 2022 2f70 6174 682f 6c6f 6361 6c5f 6669   "/path/local_fi
+000317f0: 6c65 222c 2022 2f70 6174 682f 6c6f 6361  le", "/path/loca
+00031800: 6c5f 6669 6c65 222c 2073 706c 6974 733d  l_file", splits=
+00031810: 332c 2069 676e 6f72 655f 6865 6164 6572  3, ignore_header
+00031820: 3d30 0a20 2020 2020 2020 2029 0a20 2020  =0.        ).   
+00031830: 2020 2020 206d 6f63 6b5f 636f 6d70 7265       mock_compre
+00031840: 7373 5f66 696c 655f 6c69 7374 2e61 7373  ss_file_list.ass
+00031850: 6572 745f 6361 6c6c 6564 5f77 6974 6828  ert_called_with(
+00031860: 0a20 2020 2020 2020 2020 2020 205b 222f  .            ["/
+00031870: 7061 7468 2f6c 6f63 616c 5f66 696c 652e  path/local_file.
+00031880: 3022 2c20 222f 7061 7468 2f6c 6f63 616c  0", "/path/local
+00031890: 5f66 696c 652e 3122 2c20 222f 7061 7468  _file.1", "/path
+000318a0: 2f6c 6f63 616c 5f66 696c 652e 3222 5d0a  /local_file.2"].
+000318b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000318c0: 2020 2320 6d6f 636b 5f72 656d 6f76 652e    # mock_remove.
+000318d0: 6173 7365 7274 5f63 616c 6c65 645f 7769  assert_called_wi
+000318e0: 7468 2822 2f70 6174 682f 6c6f 6361 6c5f  th("/path/local_
+000318f0: 6669 6c65 2e32 2229 0a20 2020 2020 2020  file.2").       
+00031900: 206d 6f63 6b5f 7333 5f75 706c 6f61 642e   mock_s3_upload.
+00031910: 6173 7365 7274 5f68 6173 5f63 616c 6c73  assert_has_calls
+00031920: 2865 7870 6563 7465 645f 6361 6c6c 735f  (expected_calls_
+00031930: 6e6f 5f66 6f6c 6465 725f 677a 6970 290a  no_folder_gzip).
+00031940: 2020 2020 2020 2020 6d6f 636b 5f72 735f          mock_rs_
+00031950: 636f 7079 2e61 7373 6572 745f 6361 6c6c  copy.assert_call
+00031960: 6564 5f77 6974 6828 0a20 2020 2020 2020  ed_with(.       
+00031970: 2020 2020 2022 7461 626c 655f 6e61 6d65       "table_name
+00031980: 222c 2022 7333 3a2f 2f73 335f 6275 636b  ", "s3://s3_buck
+00031990: 6574 2f6c 6f63 616c 5f66 696c 6522 2c20  et/local_file", 
+000319a0: 227c 222c 2063 6f70 795f 6f70 7469 6f6e  "|", copy_option
+000319b0: 733d 5b22 534f 4d45 204f 5054 494f 4e22  s=["SOME OPTION"
+000319c0: 2c20 2247 5a49 5022 5d0a 2020 2020 2020  , "GZIP"].      
+000319d0: 2020 290a 2020 2020 2020 2020 6173 7365    ).        asse
+000319e0: 7274 206d 6f63 6b5f 7333 5f64 656c 6574  rt mock_s3_delet
+000319f0: 652e 6361 6c6c 6564 5f77 6974 6828 2273  e.called_with("s
+00031a00: 335f 6275 636b 6574 222c 2022 6c6f 6361  3_bucket", "loca
+00031a10: 6c5f 6669 6c65 2e30 2e67 7a22 290a 2020  l_file.0.gz").  
+00031a20: 2020 2020 2020 6173 7365 7274 206d 6f63        assert moc
+00031a30: 6b5f 7333 5f64 656c 6574 652e 6361 6c6c  k_s3_delete.call
+00031a40: 6564 5f77 6974 6828 2273 335f 6275 636b  ed_with("s3_buck
+00031a50: 6574 222c 2022 6c6f 6361 6c5f 6669 6c65  et", "local_file
+00031a60: 2e31 2e67 7a22 290a 2020 2020 2020 2020  .1.gz").        
+00031a70: 6173 7365 7274 206d 6f63 6b5f 7333 5f64  assert mock_s3_d
+00031a80: 656c 6574 652e 6361 6c6c 6564 5f77 6974  elete.called_wit
+00031a90: 6828 2273 335f 6275 636b 6574 222c 2022  h("s3_bucket", "
+00031aa0: 6c6f 6361 6c5f 6669 6c65 2e32 2e67 7a22  local_file.2.gz"
+00031ab0: 290a 0a20 2020 2020 2020 2072 6573 6574  )..        reset
+00031ac0: 5f6d 6f63 6b73 2829 0a20 2020 2020 2020  _mocks().       
+00031ad0: 206d 6f63 6b5f 7370 6c69 745f 6669 6c65   mock_split_file
+00031ae0: 2e72 6574 7572 6e5f 7661 6c75 6520 3d20  .return_value = 
+00031af0: 5b22 2f70 6174 682f 6c6f 6361 6c5f 6669  ["/path/local_fi
+00031b00: 6c65 225d 0a20 2020 2020 2020 206d 6f63  le"].        moc
+00031b10: 6b5f 636f 6d70 7265 7373 5f66 696c 655f  k_compress_file_
+00031b20: 6c69 7374 2e72 6574 7572 6e5f 7661 6c75  list.return_valu
+00031b30: 6520 3d20 5b22 2f70 6174 682f 6c6f 6361  e = ["/path/loca
+00031b40: 6c5f 6669 6c65 2e67 7a22 5d0a 2020 2020  l_file.gz"].    
+00031b50: 2020 2020 722e 6c6f 6164 5f61 6e64 5f63      r.load_and_c
+00031b60: 6f70 7928 0a20 2020 2020 2020 2020 2020  opy(.           
+00031b70: 2022 2f70 6174 682f 6c6f 6361 6c5f 6669   "/path/local_fi
+00031b80: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
+00031b90: 2022 7333 5f62 7563 6b65 7422 2c0a 2020   "s3_bucket",.  
+00031ba0: 2020 2020 2020 2020 2020 2274 6162 6c65            "table
+00031bb0: 5f6e 616d 6522 2c0a 2020 2020 2020 2020  _name",.        
+00031bc0: 2020 2020 6465 6c69 6d3d 222c 222c 0a20      delim=",",. 
+00031bd0: 2020 2020 2020 2020 2020 2063 6f70 795f             copy_
+00031be0: 6f70 7469 6f6e 733d 5b22 534f 4d45 204f  options=["SOME O
+00031bf0: 5054 494f 4e22 5d2c 0a20 2020 2020 2020  PTION"],.       
+00031c00: 2020 2020 2063 6f6d 7072 6573 733d 4661       compress=Fa
+00031c10: 6c73 652c 0a20 2020 2020 2020 2029 0a20  lse,.        ). 
+00031c20: 2020 2020 2020 2023 2061 7373 6572 740a         # assert.
+00031c30: 2020 2020 2020 2020 6173 7365 7274 206d          assert m
+00031c40: 6f63 6b5f 7370 6c69 745f 6669 6c65 2e63  ock_split_file.c
+00031c50: 616c 6c65 640a 2020 2020 2020 2020 6173  alled.        as
+00031c60: 7365 7274 206e 6f74 206d 6f63 6b5f 636f  sert not mock_co
+00031c70: 6d70 7265 7373 5f66 696c 655f 6c69 7374  mpress_file_list
+00031c80: 2e63 616c 6c65 640a 2020 2020 2020 2020  .called.        
+00031c90: 2320 6173 7365 7274 206e 6f74 206d 6f63  # assert not moc
+00031ca0: 6b5f 7265 6d6f 7665 2e63 616c 6c65 640a  k_remove.called.
+00031cb0: 2020 2020 2020 2020 6d6f 636b 5f73 335f          mock_s3_
+00031cc0: 7570 6c6f 6164 2e61 7373 6572 745f 6361  upload.assert_ca
+00031cd0: 6c6c 6564 5f77 6974 6828 222f 7061 7468  lled_with("/path
+00031ce0: 2f6c 6f63 616c 5f66 696c 6522 2c20 2273  /local_file", "s
+00031cf0: 335f 6275 636b 6574 222c 2022 6c6f 6361  3_bucket", "loca
+00031d00: 6c5f 6669 6c65 2229 0a20 2020 2020 2020  l_file").       
+00031d10: 206d 6f63 6b5f 7273 5f63 6f70 792e 6173   mock_rs_copy.as
+00031d20: 7365 7274 5f63 616c 6c65 645f 7769 7468  sert_called_with
+00031d30: 280a 2020 2020 2020 2020 2020 2020 2274  (.            "t
+00031d40: 6162 6c65 5f6e 616d 6522 2c20 2273 333a  able_name", "s3:
+00031d50: 2f2f 7333 5f62 7563 6b65 742f 6c6f 6361  //s3_bucket/loca
+00031d60: 6c5f 6669 6c65 222c 2022 2c22 2c20 636f  l_file", ",", co
+00031d70: 7079 5f6f 7074 696f 6e73 3d5b 2253 4f4d  py_options=["SOM
+00031d80: 4520 4f50 5449 4f4e 225d 0a20 2020 2020  E OPTION"].     
+00031d90: 2020 2029 0a20 2020 2020 2020 2061 7373     ).        ass
+00031da0: 6572 7420 6e6f 7420 6d6f 636b 5f73 335f  ert not mock_s3_
+00031db0: 6465 6c65 7465 2e63 616c 6c65 642c 2022  delete.called, "
+00031dc0: 4f6e 6c79 2064 656c 6574 6520 7768 656e  Only delete when
+00031dd0: 2065 7870 6c69 6369 7422 0a0a 2020 2020   explicit"..    
+00031de0: 2020 2020 7265 7365 745f 6d6f 636b 7328      reset_mocks(
+00031df0: 290a 2020 2020 2020 2020 6d6f 636b 5f73  ).        mock_s
+00031e00: 706c 6974 5f66 696c 652e 7265 7475 726e  plit_file.return
+00031e10: 5f76 616c 7565 203d 205b 0a20 2020 2020  _value = [.     
+00031e20: 2020 2020 2020 2022 2f70 6174 682f 6c6f         "/path/lo
+00031e30: 6361 6c5f 6669 6c65 2e30 222c 0a20 2020  cal_file.0",.   
+00031e40: 2020 2020 2020 2020 2022 2f70 6174 682f           "/path/
+00031e50: 6c6f 6361 6c5f 6669 6c65 2e31 222c 0a20  local_file.1",. 
+00031e60: 2020 2020 2020 2020 2020 2022 2f70 6174             "/pat
+00031e70: 682f 6c6f 6361 6c5f 6669 6c65 2e32 222c  h/local_file.2",
+00031e80: 0a20 2020 2020 2020 205d 0a20 2020 2020  .        ].     
+00031e90: 2020 2072 2e6c 6f61 645f 616e 645f 636f     r.load_and_co
+00031ea0: 7079 280a 2020 2020 2020 2020 2020 2020  py(.            
+00031eb0: 222f 7061 7468 2f6c 6f63 616c 5f66 696c  "/path/local_fil
+00031ec0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+00031ed0: 2273 335f 6275 636b 6574 222c 0a20 2020  "s3_bucket",.   
+00031ee0: 2020 2020 2020 2020 2022 7461 626c 655f           "table_
+00031ef0: 6e61 6d65 222c 0a20 2020 2020 2020 2020  name",.         
+00031f00: 2020 2064 656c 696d 3d22 7c22 2c0a 2020     delim="|",.  
+00031f10: 2020 2020 2020 2020 2020 636f 7079 5f6f            copy_o
+00031f20: 7074 696f 6e73 3d5b 2253 4f4d 4520 4f50  ptions=["SOME OP
+00031f30: 5449 4f4e 225d 2c0a 2020 2020 2020 2020  TION"],.        
+00031f40: 2020 2020 7370 6c69 7473 3d33 2c0a 2020      splits=3,.  
+00031f50: 2020 2020 2020 2020 2020 636f 6d70 7265            compre
+00031f60: 7373 3d46 616c 7365 2c0a 2020 2020 2020  ss=False,.      
+00031f70: 2020 290a 2020 2020 2020 2020 2320 6173    ).        # as
+00031f80: 7365 7274 0a20 2020 2020 2020 206d 6f63  sert.        moc
+00031f90: 6b5f 7370 6c69 745f 6669 6c65 2e61 7373  k_split_file.ass
+00031fa0: 6572 745f 6361 6c6c 6564 5f77 6974 6828  ert_called_with(
+00031fb0: 0a20 2020 2020 2020 2020 2020 2022 2f70  .            "/p
+00031fc0: 6174 682f 6c6f 6361 6c5f 6669 6c65 222c  ath/local_file",
+00031fd0: 2022 2f70 6174 682f 6c6f 6361 6c5f 6669   "/path/local_fi
+00031fe0: 6c65 222c 2073 706c 6974 733d 332c 2069  le", splits=3, i
+00031ff0: 676e 6f72 655f 6865 6164 6572 3d30 0a20  gnore_header=0. 
+00032000: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00032010: 2061 7373 6572 7420 6e6f 7420 6d6f 636b   assert not mock
+00032020: 5f63 6f6d 7072 6573 735f 6669 6c65 5f6c  _compress_file_l
+00032030: 6973 742e 6361 6c6c 6564 0a20 2020 2020  ist.called.     
+00032040: 2020 2023 2061 7373 6572 7420 6e6f 7420     # assert not 
+00032050: 6d6f 636b 5f72 656d 6f76 652e 6361 6c6c  mock_remove.call
+00032060: 6564 0a20 2020 2020 2020 206d 6f63 6b5f  ed.        mock_
+00032070: 7333 5f75 706c 6f61 642e 6173 7365 7274  s3_upload.assert
+00032080: 5f68 6173 5f63 616c 6c73 2865 7870 6563  _has_calls(expec
+00032090: 7465 645f 6361 6c6c 735f 6e6f 5f66 6f6c  ted_calls_no_fol
+000320a0: 6465 7229 0a20 2020 2020 2020 206d 6f63  der).        moc
+000320b0: 6b5f 7273 5f63 6f70 792e 6173 7365 7274  k_rs_copy.assert
+000320c0: 5f63 616c 6c65 645f 7769 7468 280a 2020  _called_with(.  
+000320d0: 2020 2020 2020 2020 2020 2274 6162 6c65            "table
+000320e0: 5f6e 616d 6522 2c20 2273 333a 2f2f 7333  _name", "s3://s3
+000320f0: 5f62 7563 6b65 742f 6c6f 6361 6c5f 6669  _bucket/local_fi
+00032100: 6c65 222c 2022 7c22 2c20 636f 7079 5f6f  le", "|", copy_o
+00032110: 7074 696f 6e73 3d5b 2253 4f4d 4520 4f50  ptions=["SOME OP
+00032120: 5449 4f4e 225d 0a20 2020 2020 2020 2029  TION"].        )
+00032130: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00032140: 6e6f 7420 6d6f 636b 5f73 335f 6465 6c65  not mock_s3_dele
+00032150: 7465 2e63 616c 6c65 640a 0a20 2020 2020  te.called..     
+00032160: 2020 2023 2077 6974 6820 6120 7333 5f66     # with a s3_f
+00032170: 6f6c 6465 7220 696e 636c 7564 6564 2061  older included a
+00032180: 6e64 206e 6f20 7370 6c69 7473 0a20 2020  nd no splits.   
+00032190: 2020 2020 2072 6573 6574 5f6d 6f63 6b73       reset_mocks
+000321a0: 2829 0a20 2020 2020 2020 206d 6f63 6b5f  ().        mock_
+000321b0: 7370 6c69 745f 6669 6c65 2e72 6574 7572  split_file.retur
+000321c0: 6e5f 7661 6c75 6520 3d20 5b22 2f70 6174  n_value = ["/pat
+000321d0: 682f 6c6f 6361 6c5f 6669 6c65 2e74 7874  h/local_file.txt
+000321e0: 225d 0a20 2020 2020 2020 2072 2e6c 6f61  "].        r.loa
+000321f0: 645f 616e 645f 636f 7079 280a 2020 2020  d_and_copy(.    
+00032200: 2020 2020 2020 2020 222f 7061 7468 2f6c          "/path/l
+00032210: 6f63 616c 5f66 696c 652e 7478 7422 2c0a  ocal_file.txt",.
+00032220: 2020 2020 2020 2020 2020 2020 2273 335f              "s3_
+00032230: 6275 636b 6574 222c 0a20 2020 2020 2020  bucket",.       
+00032240: 2020 2020 2022 7461 626c 655f 6e61 6d65       "table_name
+00032250: 222c 0a20 2020 2020 2020 2020 2020 2064  ",.            d
+00032260: 656c 696d 3d22 7c22 2c0a 2020 2020 2020  elim="|",.      
+00032270: 2020 2020 2020 636f 7079 5f6f 7074 696f        copy_optio
+00032280: 6e73 3d5b 2253 4f4d 4520 4f50 5449 4f4e  ns=["SOME OPTION
+00032290: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
+000322a0: 636f 6d70 7265 7373 3d46 616c 7365 2c0a  compress=False,.
+000322b0: 2020 2020 2020 2020 2020 2020 7333 5f66              s3_f
+000322c0: 6f6c 6465 723d 2274 6573 7422 2c0a 2020  older="test",.  
+000322d0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000322e0: 2320 6173 7365 7274 0a20 2020 2020 2020  # assert.       
+000322f0: 2061 7373 6572 7420 6d6f 636b 5f73 706c   assert mock_spl
+00032300: 6974 5f66 696c 652e 6361 6c6c 6564 0a20  it_file.called. 
+00032310: 2020 2020 2020 2061 7373 6572 7420 6e6f         assert no
+00032320: 7420 6d6f 636b 5f63 6f6d 7072 6573 735f  t mock_compress_
+00032330: 6669 6c65 5f6c 6973 742e 6361 6c6c 6564  file_list.called
+00032340: 0a20 2020 2020 2020 2023 2061 7373 6572  .        # asser
+00032350: 7420 6e6f 7420 6d6f 636b 5f72 656d 6f76  t not mock_remov
+00032360: 652e 6361 6c6c 6564 0a20 2020 2020 2020  e.called.       
+00032370: 206d 6f63 6b5f 7333 5f75 706c 6f61 642e   mock_s3_upload.
+00032380: 6173 7365 7274 5f63 616c 6c65 645f 7769  assert_called_wi
+00032390: 7468 280a 2020 2020 2020 2020 2020 2020  th(.            
+000323a0: 222f 7061 7468 2f6c 6f63 616c 5f66 696c  "/path/local_fil
+000323b0: 652e 7478 7422 2c20 2273 335f 6275 636b  e.txt", "s3_buck
+000323c0: 6574 222c 2022 7465 7374 2f6c 6f63 616c  et", "test/local
+000323d0: 5f66 696c 652e 7478 7422 0a20 2020 2020  _file.txt".     
+000323e0: 2020 2029 0a20 2020 2020 2020 206d 6f63     ).        moc
+000323f0: 6b5f 7273 5f63 6f70 792e 6173 7365 7274  k_rs_copy.assert
+00032400: 5f63 616c 6c65 645f 7769 7468 280a 2020  _called_with(.  
+00032410: 2020 2020 2020 2020 2020 2274 6162 6c65            "table
+00032420: 5f6e 616d 6522 2c20 2273 333a 2f2f 7333  _name", "s3://s3
+00032430: 5f62 7563 6b65 742f 7465 7374 2f6c 6f63  _bucket/test/loc
+00032440: 616c 5f66 696c 6522 2c20 227c 222c 2063  al_file", "|", c
+00032450: 6f70 795f 6f70 7469 6f6e 733d 5b22 534f  opy_options=["SO
+00032460: 4d45 204f 5054 494f 4e22 5d0a 2020 2020  ME OPTION"].    
+00032470: 2020 2020 290a 2020 2020 2020 2020 6173      ).        as
+00032480: 7365 7274 206e 6f74 206d 6f63 6b5f 7333  sert not mock_s3
+00032490: 5f64 656c 6574 652e 6361 6c6c 6564 0a0a  _delete.called..
+000324a0: 2020 2020 2020 2020 2320 7769 7468 2061          # with a
+000324b0: 2073 335f 666f 6c64 6572 2069 6e63 6c75   s3_folder inclu
+000324c0: 6465 6420 616e 6420 7370 6c69 7473 0a20  ded and splits. 
+000324d0: 2020 2020 2020 2072 6573 6574 5f6d 6f63         reset_moc
+000324e0: 6b73 2829 0a20 2020 2020 2020 206d 6f63  ks().        moc
+000324f0: 6b5f 7370 6c69 745f 6669 6c65 2e72 6574  k_split_file.ret
+00032500: 7572 6e5f 7661 6c75 6520 3d20 5b0a 2020  urn_value = [.  
+00032510: 2020 2020 2020 2020 2020 222f 7061 7468            "/path
+00032520: 2f6c 6f63 616c 5f66 696c 652e 3022 2c0a  /local_file.0",.
+00032530: 2020 2020 2020 2020 2020 2020 222f 7061              "/pa
+00032540: 7468 2f6c 6f63 616c 5f66 696c 652e 3122  th/local_file.1"
+00032550: 2c0a 2020 2020 2020 2020 2020 2020 222f  ,.            "/
+00032560: 7061 7468 2f6c 6f63 616c 5f66 696c 652e  path/local_file.
+00032570: 3222 2c0a 2020 2020 2020 2020 5d0a 0a20  2",.        ].. 
+00032580: 2020 2020 2020 2072 2e6c 6f61 645f 616e         r.load_an
+00032590: 645f 636f 7079 280a 2020 2020 2020 2020  d_copy(.        
+000325a0: 2020 2020 222f 7061 7468 2f6c 6f63 616c      "/path/local
+000325b0: 5f66 696c 6522 2c0a 2020 2020 2020 2020  _file",.        
+000325c0: 2020 2020 2273 335f 6275 636b 6574 222c      "s3_bucket",
+000325d0: 0a20 2020 2020 2020 2020 2020 2022 7461  .            "ta
+000325e0: 626c 655f 6e61 6d65 222c 0a20 2020 2020  ble_name",.     
+000325f0: 2020 2020 2020 2064 656c 696d 3d22 7c22         delim="|"
+00032600: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
+00032610: 7079 5f6f 7074 696f 6e73 3d5b 2253 4f4d  py_options=["SOM
+00032620: 4520 4f50 5449 4f4e 225d 2c0a 2020 2020  E OPTION"],.    
+00032630: 2020 2020 2020 2020 7370 6c69 7473 3d33          splits=3
+00032640: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
+00032650: 6d70 7265 7373 3d46 616c 7365 2c0a 2020  mpress=False,.  
+00032660: 2020 2020 2020 2020 2020 7333 5f66 6f6c            s3_fol
+00032670: 6465 723d 2274 6573 7422 2c0a 2020 2020  der="test",.    
+00032680: 2020 2020 2020 2020 6465 6c65 7465 5f73          delete_s
+00032690: 335f 6166 7465 723d 5472 7565 2c0a 2020  3_after=True,.  
+000326a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000326b0: 2320 6173 7365 7274 0a20 2020 2020 2020  # assert.       
+000326c0: 206d 6f63 6b5f 7370 6c69 745f 6669 6c65   mock_split_file
+000326d0: 2e61 7373 6572 745f 6361 6c6c 6564 5f77  .assert_called_w
+000326e0: 6974 6828 0a20 2020 2020 2020 2020 2020  ith(.           
+000326f0: 2022 2f70 6174 682f 6c6f 6361 6c5f 6669   "/path/local_fi
+00032700: 6c65 222c 2022 2f70 6174 682f 6c6f 6361  le", "/path/loca
+00032710: 6c5f 6669 6c65 222c 2073 706c 6974 733d  l_file", splits=
+00032720: 332c 2069 676e 6f72 655f 6865 6164 6572  3, ignore_header
+00032730: 3d30 0a20 2020 2020 2020 2029 0a20 2020  =0.        ).   
+00032740: 2020 2020 2061 7373 6572 7420 6e6f 7420       assert not 
+00032750: 6d6f 636b 5f63 6f6d 7072 6573 735f 6669  mock_compress_fi
+00032760: 6c65 5f6c 6973 742e 6361 6c6c 6564 0a20  le_list.called. 
+00032770: 2020 2020 2020 2023 2061 7373 6572 7420         # assert 
+00032780: 6e6f 7420 6d6f 636b 5f72 656d 6f76 652e  not mock_remove.
+00032790: 6361 6c6c 6564 0a20 2020 2020 2020 206d  called.        m
+000327a0: 6f63 6b5f 7333 5f75 706c 6f61 642e 6173  ock_s3_upload.as
+000327b0: 7365 7274 5f68 6173 5f63 616c 6c73 2865  sert_has_calls(e
+000327c0: 7870 6563 7465 645f 6361 6c6c 735f 666f  xpected_calls_fo
+000327d0: 6c64 6572 290a 2020 2020 2020 2020 6d6f  lder).        mo
+000327e0: 636b 5f72 735f 636f 7079 2e61 7373 6572  ck_rs_copy.asser
+000327f0: 745f 6361 6c6c 6564 5f77 6974 6828 0a20  t_called_with(. 
+00032800: 2020 2020 2020 2020 2020 2022 7461 626c             "tabl
+00032810: 655f 6e61 6d65 222c 2022 7333 3a2f 2f73  e_name", "s3://s
+00032820: 335f 6275 636b 6574 2f74 6573 742f 6c6f  3_bucket/test/lo
+00032830: 6361 6c5f 6669 6c65 222c 2022 7c22 2c20  cal_file", "|", 
+00032840: 636f 7079 5f6f 7074 696f 6e73 3d5b 2253  copy_options=["S
+00032850: 4f4d 4520 4f50 5449 4f4e 225d 0a20 2020  OME OPTION"].   
+00032860: 2020 2020 2029 0a20 2020 2020 2020 2061       ).        a
+00032870: 7373 6572 7420 6d6f 636b 5f73 335f 6465  ssert mock_s3_de
+00032880: 6c65 7465 2e63 616c 6c65 645f 7769 7468  lete.called_with
+00032890: 2822 7333 5f62 7563 6b65 7422 2c20 2274  ("s3_bucket", "t
+000328a0: 6573 742f 6c6f 6361 6c5f 6669 6c65 2e30  est/local_file.0
+000328b0: 2229 0a20 2020 2020 2020 2061 7373 6572  ").        asser
+000328c0: 7420 6d6f 636b 5f73 335f 6465 6c65 7465  t mock_s3_delete
+000328d0: 2e63 616c 6c65 645f 7769 7468 2822 7333  .called_with("s3
+000328e0: 5f62 7563 6b65 7422 2c20 2274 6573 742f  _bucket", "test/
+000328f0: 6c6f 6361 6c5f 6669 6c65 2e31 2229 0a20  local_file.1"). 
+00032900: 2020 2020 2020 2061 7373 6572 7420 6d6f         assert mo
+00032910: 636b 5f73 335f 6465 6c65 7465 2e63 616c  ck_s3_delete.cal
+00032920: 6c65 645f 7769 7468 2822 7333 5f62 7563  led_with("s3_buc
+00032930: 6b65 7422 2c20 2274 6573 742f 6c6f 6361  ket", "test/loca
+00032940: 6c5f 6669 6c65 2e32 2229 0a0a 2020 2020  l_file.2")..    
+00032950: 2020 2020 2320 7769 7468 2061 2073 335f      # with a s3_
+00032960: 666f 6c64 6572 2069 6e63 6c75 6465 6420  folder included 
+00032970: 2c20 7370 6c69 7473 2c20 616e 6420 677a  , splits, and gz
+00032980: 6970 0a20 2020 2020 2020 2072 6573 6574  ip.        reset
+00032990: 5f6d 6f63 6b73 2829 0a20 2020 2020 2020  _mocks().       
+000329a0: 206d 6f63 6b5f 7370 6c69 745f 6669 6c65   mock_split_file
+000329b0: 2e72 6574 7572 6e5f 7661 6c75 6520 3d20  .return_value = 
+000329c0: 5b0a 2020 2020 2020 2020 2020 2020 222f  [.            "/
+000329d0: 7061 7468 2f6c 6f63 616c 5f66 696c 652e  path/local_file.
+000329e0: 3022 2c0a 2020 2020 2020 2020 2020 2020  0",.            
+000329f0: 222f 7061 7468 2f6c 6f63 616c 5f66 696c  "/path/local_fil
+00032a00: 652e 3122 2c0a 2020 2020 2020 2020 2020  e.1",.          
+00032a10: 2020 222f 7061 7468 2f6c 6f63 616c 5f66    "/path/local_f
+00032a20: 696c 652e 3222 2c0a 2020 2020 2020 2020  ile.2",.        
+00032a30: 5d0a 2020 2020 2020 2020 6d6f 636b 5f63  ].        mock_c
+00032a40: 6f6d 7072 6573 735f 6669 6c65 5f6c 6973  ompress_file_lis
+00032a50: 742e 7265 7475 726e 5f76 616c 7565 203d  t.return_value =
+00032a60: 205b 0a20 2020 2020 2020 2020 2020 2022   [.            "
+00032a70: 2f70 6174 682f 6c6f 6361 6c5f 6669 6c65  /path/local_file
+00032a80: 2e30 2e67 7a22 2c0a 2020 2020 2020 2020  .0.gz",.        
+00032a90: 2020 2020 222f 7061 7468 2f6c 6f63 616c      "/path/local
+00032aa0: 5f66 696c 652e 312e 677a 222c 0a20 2020  _file.1.gz",.   
+00032ab0: 2020 2020 2020 2020 2022 2f70 6174 682f           "/path/
+00032ac0: 6c6f 6361 6c5f 6669 6c65 2e32 2e67 7a22  local_file.2.gz"
+00032ad0: 2c0a 2020 2020 2020 2020 5d0a 2020 2020  ,.        ].    
+00032ae0: 2020 2020 722e 6c6f 6164 5f61 6e64 5f63      r.load_and_c
+00032af0: 6f70 7928 0a20 2020 2020 2020 2020 2020  opy(.           
+00032b00: 2022 2f70 6174 682f 6c6f 6361 6c5f 6669   "/path/local_fi
+00032b10: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
+00032b20: 2022 7333 5f62 7563 6b65 7422 2c0a 2020   "s3_bucket",.  
+00032b30: 2020 2020 2020 2020 2020 2274 6162 6c65            "table
+00032b40: 5f6e 616d 6522 2c0a 2020 2020 2020 2020  _name",.        
+00032b50: 2020 2020 6465 6c69 6d3d 227c 222c 0a20      delim="|",. 
+00032b60: 2020 2020 2020 2020 2020 2063 6f70 795f             copy_
+00032b70: 6f70 7469 6f6e 733d 5b22 534f 4d45 204f  options=["SOME O
+00032b80: 5054 494f 4e22 5d2c 0a20 2020 2020 2020  PTION"],.       
+00032b90: 2020 2020 2073 706c 6974 733d 332c 0a20       splits=3,. 
+00032ba0: 2020 2020 2020 2020 2020 2073 335f 666f             s3_fo
+00032bb0: 6c64 6572 3d22 7465 7374 222c 0a20 2020  lder="test",.   
+00032bc0: 2020 2020 2029 0a20 2020 2020 2020 2023       ).        #
+00032bd0: 2061 7373 6572 740a 2020 2020 2020 2020   assert.        
+00032be0: 6d6f 636b 5f73 706c 6974 5f66 696c 652e  mock_split_file.
+00032bf0: 6173 7365 7274 5f63 616c 6c65 645f 7769  assert_called_wi
+00032c00: 7468 280a 2020 2020 2020 2020 2020 2020  th(.            
+00032c10: 222f 7061 7468 2f6c 6f63 616c 5f66 696c  "/path/local_fil
+00032c20: 6522 2c20 222f 7061 7468 2f6c 6f63 616c  e", "/path/local
+00032c30: 5f66 696c 6522 2c20 7370 6c69 7473 3d33  _file", splits=3
+00032c40: 2c20 6967 6e6f 7265 5f68 6561 6465 723d  , ignore_header=
+00032c50: 300a 2020 2020 2020 2020 290a 2020 2020  0.        ).    
+00032c60: 2020 2020 6173 7365 7274 206d 6f63 6b5f      assert mock_
+00032c70: 636f 6d70 7265 7373 5f66 696c 655f 6c69  compress_file_li
+00032c80: 7374 2e63 616c 6c65 640a 2020 2020 2020  st.called.      
+00032c90: 2020 2320 6173 7365 7274 206d 6f63 6b5f    # assert mock_
+00032ca0: 7265 6d6f 7665 2e63 616c 6c65 640a 2020  remove.called.  
+00032cb0: 2020 2020 2020 6d6f 636b 5f73 335f 7570        mock_s3_up
+00032cc0: 6c6f 6164 2e61 7373 6572 745f 6861 735f  load.assert_has_
+00032cd0: 6361 6c6c 7328 6578 7065 6374 6564 5f63  calls(expected_c
+00032ce0: 616c 6c73 5f66 6f6c 6465 725f 677a 6970  alls_folder_gzip
+00032cf0: 290a 2020 2020 2020 2020 6d6f 636b 5f72  ).        mock_r
+00032d00: 735f 636f 7079 2e61 7373 6572 745f 6361  s_copy.assert_ca
+00032d10: 6c6c 6564 5f77 6974 6828 0a20 2020 2020  lled_with(.     
+00032d20: 2020 2020 2020 2022 7461 626c 655f 6e61         "table_na
+00032d30: 6d65 222c 0a20 2020 2020 2020 2020 2020  me",.           
+00032d40: 2022 7333 3a2f 2f73 335f 6275 636b 6574   "s3://s3_bucket
+00032d50: 2f74 6573 742f 6c6f 6361 6c5f 6669 6c65  /test/local_file
+00032d60: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
+00032d70: 7c22 2c0a 2020 2020 2020 2020 2020 2020  |",.            
+00032d80: 636f 7079 5f6f 7074 696f 6e73 3d5b 2253  copy_options=["S
+00032d90: 4f4d 4520 4f50 5449 4f4e 222c 2022 475a  OME OPTION", "GZ
+00032da0: 4950 225d 2c0a 2020 2020 2020 2020 290a  IP"],.        ).
+00032db0: 2020 2020 2020 2020 6173 7365 7274 206e          assert n
+00032dc0: 6f74 206d 6f63 6b5f 7333 5f64 656c 6574  ot mock_s3_delet
+00032dd0: 652e 6361 6c6c 6564 0a0a 0a40 7079 7465  e.called...@pyte
+00032de0: 7374 2e6d 6172 6b2e 7061 7261 6d65 7472  st.mark.parametr
+00032df0: 697a 6528 2264 6261 7069 222c 2044 4241  ize("dbapi", DBA
+00032e00: 5049 5329 0a40 6d6f 636b 2e70 6174 6368  PIS).@mock.patch
+00032e10: 2822 6c6f 636f 7079 2e75 7469 6c69 7479  ("locopy.utility
+00032e20: 2e6f 732e 7265 6d6f 7665 2229 0a40 6d6f  .os.remove").@mo
+00032e30: 636b 2e70 6174 6368 2822 6c6f 636f 7079  ck.patch("locopy
+00032e40: 2e72 6564 7368 6966 742e 5265 6473 6869  .redshift.Redshi
+00032e50: 6674 2e63 6f70 7922 290a 406d 6f63 6b2e  ft.copy").@mock.
+00032e60: 7061 7463 6828 226c 6f63 6f70 792e 7265  patch("locopy.re
+00032e70: 6473 6869 6674 2e52 6564 7368 6966 742e  dshift.Redshift.
+00032e80: 7570 6c6f 6164 5f74 6f5f 7333 2229 0a40  upload_to_s3").@
+00032e90: 6d6f 636b 2e70 6174 6368 2822 6c6f 636f  mock.patch("loco
+00032ea0: 7079 2e72 6564 7368 6966 742e 5265 6473  py.redshift.Reds
+00032eb0: 6869 6674 2e64 656c 6574 655f 6672 6f6d  hift.delete_from
+00032ec0: 5f73 3322 290a 406d 6f63 6b2e 7061 7463  _s3").@mock.patc
+00032ed0: 6828 226c 6f63 6f70 792e 7333 2e53 6573  h("locopy.s3.Ses
+00032ee0: 7369 6f6e 2229 0a40 6d6f 636b 2e70 6174  sion").@mock.pat
+00032ef0: 6368 2822 6c6f 636f 7079 2e72 6564 7368  ch("locopy.redsh
+00032f00: 6966 742e 636f 6d70 7265 7373 5f66 696c  ift.compress_fil
+00032f10: 655f 6c69 7374 2229 0a40 6d6f 636b 2e70  e_list").@mock.p
+00032f20: 6174 6368 2822 6c6f 636f 7079 2e72 6564  atch("locopy.red
+00032f30: 7368 6966 742e 7370 6c69 745f 6669 6c65  shift.split_file
+00032f40: 2229 0a64 6566 2074 6573 745f 6c6f 6164  ").def test_load
+00032f50: 5f61 6e64 5f63 6f70 795f 7370 6c69 745f  _and_copy_split_
+00032f60: 616e 645f 6865 6164 6572 280a 2020 2020  and_header(.    
+00032f70: 6d6f 636b 5f73 706c 6974 5f66 696c 652c  mock_split_file,
+00032f80: 0a20 2020 206d 6f63 6b5f 636f 6d70 7265  .    mock_compre
+00032f90: 7373 5f66 696c 655f 6c69 7374 2c0a 2020  ss_file_list,.  
+00032fa0: 2020 6d6f 636b 5f73 6573 7369 6f6e 2c0a    mock_session,.
+00032fb0: 2020 2020 6d6f 636b 5f73 335f 6465 6c65      mock_s3_dele
+00032fc0: 7465 2c0a 2020 2020 6d6f 636b 5f73 335f  te,.    mock_s3_
+00032fd0: 7570 6c6f 6164 2c0a 2020 2020 6d6f 636b  upload,.    mock
+00032fe0: 5f72 735f 636f 7079 2c0a 2020 2020 6d6f  _rs_copy,.    mo
+00032ff0: 636b 5f72 656d 6f76 652c 0a20 2020 2063  ck_remove,.    c
+00033000: 7265 6465 6e74 6961 6c73 2c0a 2020 2020  redentials,.    
+00033010: 6462 6170 692c 0a29 3a0a 2020 2020 6465  dbapi,.):.    de
+00033020: 6620 7265 7365 745f 6d6f 636b 7328 293a  f reset_mocks():
+00033030: 0a20 2020 2020 2020 206d 6f63 6b5f 7370  .        mock_sp
+00033040: 6c69 745f 6669 6c65 2e72 6573 6574 5f6d  lit_file.reset_m
+00033050: 6f63 6b28 290a 2020 2020 2020 2020 6d6f  ock().        mo
+00033060: 636b 5f63 6f6d 7072 6573 735f 6669 6c65  ck_compress_file
+00033070: 5f6c 6973 742e 7265 7365 745f 6d6f 636b  _list.reset_mock
+00033080: 2829 0a20 2020 2020 2020 206d 6f63 6b5f  ().        mock_
+00033090: 7333 5f75 706c 6f61 642e 7265 7365 745f  s3_upload.reset_
+000330a0: 6d6f 636b 2829 0a20 2020 2020 2020 206d  mock().        m
+000330b0: 6f63 6b5f 7333 5f64 656c 6574 652e 7265  ock_s3_delete.re
+000330c0: 7365 745f 6d6f 636b 2829 0a20 2020 2020  set_mock().     
+000330d0: 2020 206d 6f63 6b5f 7273 5f63 6f70 792e     mock_rs_copy.
+000330e0: 7265 7365 745f 6d6f 636b 2829 0a20 2020  reset_mock().   
+000330f0: 2020 2020 206d 6f63 6b5f 7265 6d6f 7665       mock_remove
+00033100: 2e72 6573 6574 5f6d 6f63 6b28 290a 0a20  .reset_mock().. 
+00033110: 2020 2077 6974 6820 6d6f 636b 2e70 6174     with mock.pat
+00033120: 6368 2864 6261 7069 2e5f 5f6e 616d 655f  ch(dbapi.__name_
+00033130: 5f20 2b20 222e 636f 6e6e 6563 7422 2920  _ + ".connect") 
+00033140: 6173 206d 6f63 6b5f 636f 6e6e 6563 743a  as mock_connect:
+00033150: 0a20 2020 2020 2020 2072 203d 2052 6564  .        r = Red
+00033160: 7368 6966 7428 6462 6170 693d 6462 6170  shift(dbapi=dbap
+00033170: 692c 202a 2a63 7265 6465 6e74 6961 6c73  i, **credentials
+00033180: 290a 2020 2020 2020 2020 722e 636f 6e6e  ).        r.conn
+00033190: 6563 7428 290a 0a20 2020 2020 2020 2065  ect()..        e
+000331a0: 7870 6563 7465 645f 6361 6c6c 735f 6e6f  xpected_calls_no
+000331b0: 5f66 6f6c 6465 7220 3d20 5b0a 2020 2020  _folder = [.    
+000331c0: 2020 2020 2020 2020 6d6f 636b 2e63 616c          mock.cal
+000331d0: 6c28 222f 7061 7468 2f6c 6f63 616c 5f66  l("/path/local_f
+000331e0: 696c 652e 3022 2c20 2273 335f 6275 636b  ile.0", "s3_buck
+000331f0: 6574 222c 2022 6c6f 6361 6c5f 6669 6c65  et", "local_file
+00033200: 2e30 2229 2c0a 2020 2020 2020 2020 2020  .0"),.          
+00033210: 2020 6d6f 636b 2e63 616c 6c28 222f 7061    mock.call("/pa
+00033220: 7468 2f6c 6f63 616c 5f66 696c 652e 3122  th/local_file.1"
+00033230: 2c20 2273 335f 6275 636b 6574 222c 2022  , "s3_bucket", "
+00033240: 6c6f 6361 6c5f 6669 6c65 2e31 2229 2c0a  local_file.1"),.
+00033250: 2020 2020 2020 2020 2020 2020 6d6f 636b              mock
+00033260: 2e63 616c 6c28 222f 7061 7468 2f6c 6f63  .call("/path/loc
+00033270: 616c 5f66 696c 652e 3222 2c20 2273 335f  al_file.2", "s3_
+00033280: 6275 636b 6574 222c 2022 6c6f 6361 6c5f  bucket", "local_
+00033290: 6669 6c65 2e32 2229 2c0a 2020 2020 2020  file.2"),.      
+000332a0: 2020 5d0a 0a20 2020 2020 2020 2065 7870    ]..        exp
+000332b0: 6563 7465 645f 6361 6c6c 735f 6e6f 5f66  ected_calls_no_f
+000332c0: 6f6c 6465 725f 677a 6970 203d 205b 0a20  older_gzip = [. 
+000332d0: 2020 2020 2020 2020 2020 206d 6f63 6b2e             mock.
+000332e0: 6361 6c6c 2822 2f70 6174 682f 6c6f 6361  call("/path/loca
+000332f0: 6c5f 6669 6c65 2e30 2e67 7a22 2c20 2273  l_file.0.gz", "s
+00033300: 335f 6275 636b 6574 222c 2022 6c6f 6361  3_bucket", "loca
+00033310: 6c5f 6669 6c65 2e30 2e67 7a22 292c 0a20  l_file.0.gz"),. 
+00033320: 2020 2020 2020 2020 2020 206d 6f63 6b2e             mock.
+00033330: 6361 6c6c 2822 2f70 6174 682f 6c6f 6361  call("/path/loca
+00033340: 6c5f 6669 6c65 2e31 2e67 7a22 2c20 2273  l_file.1.gz", "s
+00033350: 335f 6275 636b 6574 222c 2022 6c6f 6361  3_bucket", "loca
+00033360: 6c5f 6669 6c65 2e31 2e67 7a22 292c 0a20  l_file.1.gz"),. 
+00033370: 2020 2020 2020 2020 2020 206d 6f63 6b2e             mock.
+00033380: 6361 6c6c 2822 2f70 6174 682f 6c6f 6361  call("/path/loca
+00033390: 6c5f 6669 6c65 2e32 2e67 7a22 2c20 2273  l_file.2.gz", "s
+000333a0: 335f 6275 636b 6574 222c 2022 6c6f 6361  3_bucket", "loca
+000333b0: 6c5f 6669 6c65 2e32 2e67 7a22 292c 0a20  l_file.2.gz"),. 
+000333c0: 2020 2020 2020 205d 0a0a 2020 2020 2020         ]..      
+000333d0: 2020 6578 7065 6374 6564 5f63 616c 6c73    expected_calls
+000333e0: 5f66 6f6c 6465 7220 3d20 5b0a 2020 2020  _folder = [.    
+000333f0: 2020 2020 2020 2020 6d6f 636b 2e63 616c          mock.cal
+00033400: 6c28 222f 7061 7468 2f6c 6f63 616c 5f66  l("/path/local_f
+00033410: 696c 652e 3022 2c20 2273 335f 6275 636b  ile.0", "s3_buck
+00033420: 6574 222c 2022 7465 7374 2f6c 6f63 616c  et", "test/local
+00033430: 5f66 696c 652e 3022 292c 0a20 2020 2020  _file.0"),.     
+00033440: 2020 2020 2020 206d 6f63 6b2e 6361 6c6c         mock.call
+00033450: 2822 2f70 6174 682f 6c6f 6361 6c5f 6669  ("/path/local_fi
+00033460: 6c65 2e31 222c 2022 7333 5f62 7563 6b65  le.1", "s3_bucke
+00033470: 7422 2c20 2274 6573 742f 6c6f 6361 6c5f  t", "test/local_
+00033480: 6669 6c65 2e31 2229 2c0a 2020 2020 2020  file.1"),.      
+00033490: 2020 2020 2020 6d6f 636b 2e63 616c 6c28        mock.call(
+000334a0: 222f 7061 7468 2f6c 6f63 616c 5f66 696c  "/path/local_fil
+000334b0: 652e 3222 2c20 2273 335f 6275 636b 6574  e.2", "s3_bucket
+000334c0: 222c 2022 7465 7374 2f6c 6f63 616c 5f66  ", "test/local_f
+000334d0: 696c 652e 3222 292c 0a20 2020 2020 2020  ile.2"),.       
+000334e0: 205d 0a0a 2020 2020 2020 2020 6578 7065   ]..        expe
+000334f0: 6374 6564 5f63 616c 6c73 5f66 6f6c 6465  cted_calls_folde
+00033500: 725f 677a 6970 203d 205b 0a20 2020 2020  r_gzip = [.     
+00033510: 2020 2020 2020 206d 6f63 6b2e 6361 6c6c         mock.call
+00033520: 2822 2f70 6174 682f 6c6f 6361 6c5f 6669  ("/path/local_fi
+00033530: 6c65 2e30 2e67 7a22 2c20 2273 335f 6275  le.0.gz", "s3_bu
+00033540: 636b 6574 222c 2022 7465 7374 2f6c 6f63  cket", "test/loc
+00033550: 616c 5f66 696c 652e 302e 677a 2229 2c0a  al_file.0.gz"),.
+00033560: 2020 2020 2020 2020 2020 2020 6d6f 636b              mock
+00033570: 2e63 616c 6c28 222f 7061 7468 2f6c 6f63  .call("/path/loc
+00033580: 616c 5f66 696c 652e 312e 677a 222c 2022  al_file.1.gz", "
+00033590: 7333 5f62 7563 6b65 7422 2c20 2274 6573  s3_bucket", "tes
+000335a0: 742f 6c6f 6361 6c5f 6669 6c65 2e31 2e67  t/local_file.1.g
+000335b0: 7a22 292c 0a20 2020 2020 2020 2020 2020  z"),.           
+000335c0: 206d 6f63 6b2e 6361 6c6c 2822 2f70 6174   mock.call("/pat
+000335d0: 682f 6c6f 6361 6c5f 6669 6c65 2e32 2e67  h/local_file.2.g
+000335e0: 7a22 2c20 2273 335f 6275 636b 6574 222c  z", "s3_bucket",
+000335f0: 2022 7465 7374 2f6c 6f63 616c 5f66 696c   "test/local_fil
+00033600: 652e 322e 677a 2229 2c0a 2020 2020 2020  e.2.gz"),.      
+00033610: 2020 5d0a 0a20 2020 2020 2020 206d 6f63    ]..        moc
+00033620: 6b5f 7370 6c69 745f 6669 6c65 2e72 6574  k_split_file.ret
+00033630: 7572 6e5f 7661 6c75 6520 3d20 5b22 2f70  urn_value = ["/p
+00033640: 6174 682f 6c6f 6361 6c5f 6669 6c65 2e74  ath/local_file.t
+00033650: 7874 225d 0a20 2020 2020 2020 206d 6f63  xt"].        moc
+00033660: 6b5f 636f 6d70 7265 7373 5f66 696c 655f  k_compress_file_
+00033670: 6c69 7374 2e72 6574 7572 6e5f 7661 6c75  list.return_valu
+00033680: 6520 3d20 5b22 2f70 6174 682f 6c6f 6361  e = ["/path/loca
+00033690: 6c5f 6669 6c65 2e74 7874 2e67 7a22 5d0a  l_file.txt.gz"].
+000336a0: 0a20 2020 2020 2020 2023 2323 2320 6e65  .        #### ne
+000336b0: 6974 6865 7220 6967 6e6f 7265 206f 7220  ither ignore or 
+000336c0: 7370 6c69 7420 6f6e 6c79 0a20 2020 2020  split only.     
+000336d0: 2020 2072 2e6c 6f61 645f 616e 645f 636f     r.load_and_co
+000336e0: 7079 2822 2f70 6174 682f 6c6f 6361 6c5f  py("/path/local_
+000336f0: 6669 6c65 2e74 7874 222c 2022 7333 5f62  file.txt", "s3_b
+00033700: 7563 6b65 7422 2c20 2274 6162 6c65 5f6e  ucket", "table_n
+00033710: 616d 6522 2c20 6465 6c69 6d3d 227c 2229  ame", delim="|")
+00033720: 0a0a 2020 2020 2020 2020 2320 6173 7365  ..        # asse
+00033730: 7274 0a20 2020 2020 2020 2061 7373 6572  rt.        asser
+00033740: 7420 6d6f 636b 5f73 706c 6974 5f66 696c  t mock_split_fil
+00033750: 652e 6361 6c6c 6564 0a20 2020 2020 2020  e.called.       
+00033760: 206d 6f63 6b5f 636f 6d70 7265 7373 5f66   mock_compress_f
+00033770: 696c 655f 6c69 7374 2e61 7373 6572 745f  ile_list.assert_
+00033780: 6361 6c6c 6564 5f77 6974 6828 5b22 2f70  called_with(["/p
+00033790: 6174 682f 6c6f 6361 6c5f 6669 6c65 2e74  ath/local_file.t
+000337a0: 7874 225d 290a 2020 2020 2020 2020 2320  xt"]).        # 
+000337b0: 6d6f 636b 5f72 656d 6f76 652e 6173 7365  mock_remove.asse
+000337c0: 7274 5f63 616c 6c65 645f 7769 7468 2822  rt_called_with("
+000337d0: 2f70 6174 682f 6c6f 6361 6c5f 6669 6c65  /path/local_file
+000337e0: 2e74 7874 2229 0a20 2020 2020 2020 206d  .txt").        m
+000337f0: 6f63 6b5f 7333 5f75 706c 6f61 642e 6173  ock_s3_upload.as
+00033800: 7365 7274 5f63 616c 6c65 645f 7769 7468  sert_called_with
+00033810: 280a 2020 2020 2020 2020 2020 2020 222f  (.            "/
+00033820: 7061 7468 2f6c 6f63 616c 5f66 696c 652e  path/local_file.
+00033830: 7478 742e 677a 222c 2022 7333 5f62 7563  txt.gz", "s3_buc
+00033840: 6b65 7422 2c20 226c 6f63 616c 5f66 696c  ket", "local_fil
+00033850: 652e 7478 742e 677a 220a 2020 2020 2020  e.txt.gz".      
+00033860: 2020 290a 2020 2020 2020 2020 6d6f 636b    ).        mock
+00033870: 5f72 735f 636f 7079 2e61 7373 6572 745f  _rs_copy.assert_
+00033880: 6361 6c6c 6564 5f77 6974 6828 0a20 2020  called_with(.   
+00033890: 2020 2020 2020 2020 2022 7461 626c 655f           "table_
+000338a0: 6e61 6d65 222c 2022 7333 3a2f 2f73 335f  name", "s3://s3_
+000338b0: 6275 636b 6574 2f6c 6f63 616c 5f66 696c  bucket/local_fil
+000338c0: 6522 2c20 227c 222c 2063 6f70 795f 6f70  e", "|", copy_op
+000338d0: 7469 6f6e 733d 5b22 475a 4950 225d 0a20  tions=["GZIP"]. 
+000338e0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000338f0: 2061 7373 6572 7420 6e6f 7420 6d6f 636b   assert not mock
+00033900: 5f73 335f 6465 6c65 7465 2e63 616c 6c65  _s3_delete.calle
+00033910: 642c 2022 4f6e 6c79 2064 656c 6574 6520  d, "Only delete 
+00033920: 7768 656e 2065 7870 6c69 6369 7422 0a0a  when explicit"..
+00033930: 2020 2020 2020 2020 2323 2323 2069 676e          #### ign
+00033940: 6f72 6520 6f6e 6c79 0a20 2020 2020 2020  ore only.       
+00033950: 2072 6573 6574 5f6d 6f63 6b73 2829 0a20   reset_mocks(). 
+00033960: 2020 2020 2020 2072 2e6c 6f61 645f 616e         r.load_an
+00033970: 645f 636f 7079 280a 2020 2020 2020 2020  d_copy(.        
+00033980: 2020 2020 222f 7061 7468 2f6c 6f63 616c      "/path/local
+00033990: 5f66 696c 652e 7478 7422 2c0a 2020 2020  _file.txt",.    
+000339a0: 2020 2020 2020 2020 2273 335f 6275 636b          "s3_buck
+000339b0: 6574 222c 0a20 2020 2020 2020 2020 2020  et",.           
+000339c0: 2022 7461 626c 655f 6e61 6d65 222c 0a20   "table_name",. 
+000339d0: 2020 2020 2020 2020 2020 2064 656c 696d             delim
+000339e0: 3d22 7c22 2c0a 2020 2020 2020 2020 2020  ="|",.          
+000339f0: 2020 636f 7079 5f6f 7074 696f 6e73 3d5b    copy_options=[
+00033a00: 2249 474e 4f52 4548 4541 4445 5220 6173  "IGNOREHEADER as
+00033a10: 2031 225d 2c0a 2020 2020 2020 2020 290a   1"],.        ).
+00033a20: 0a20 2020 2020 2020 2023 2061 7373 6572  .        # asser
+00033a30: 740a 2020 2020 2020 2020 6173 7365 7274  t.        assert
+00033a40: 206d 6f63 6b5f 7370 6c69 745f 6669 6c65   mock_split_file
+00033a50: 2e63 616c 6c65 640a 2020 2020 2020 2020  .called.        
+00033a60: 6d6f 636b 5f63 6f6d 7072 6573 735f 6669  mock_compress_fi
+00033a70: 6c65 5f6c 6973 742e 6173 7365 7274 5f63  le_list.assert_c
+00033a80: 616c 6c65 645f 7769 7468 285b 222f 7061  alled_with(["/pa
+00033a90: 7468 2f6c 6f63 616c 5f66 696c 652e 7478  th/local_file.tx
+00033aa0: 7422 5d29 0a20 2020 2020 2020 2023 206d  t"]).        # m
+00033ab0: 6f63 6b5f 7265 6d6f 7665 2e61 7373 6572  ock_remove.asser
+00033ac0: 745f 6361 6c6c 6564 5f77 6974 6828 222f  t_called_with("/
+00033ad0: 7061 7468 2f6c 6f63 616c 5f66 696c 652e  path/local_file.
+00033ae0: 7478 7422 290a 2020 2020 2020 2020 6d6f  txt").        mo
+00033af0: 636b 5f73 335f 7570 6c6f 6164 2e61 7373  ck_s3_upload.ass
+00033b00: 6572 745f 6361 6c6c 6564 5f77 6974 6828  ert_called_with(
+00033b10: 0a20 2020 2020 2020 2020 2020 2022 2f70  .            "/p
+00033b20: 6174 682f 6c6f 6361 6c5f 6669 6c65 2e74  ath/local_file.t
+00033b30: 7874 2e67 7a22 2c20 2273 335f 6275 636b  xt.gz", "s3_buck
+00033b40: 6574 222c 2022 6c6f 6361 6c5f 6669 6c65  et", "local_file
+00033b50: 2e74 7874 2e67 7a22 0a20 2020 2020 2020  .txt.gz".       
+00033b60: 2029 0a20 2020 2020 2020 206d 6f63 6b5f   ).        mock_
+00033b70: 7273 5f63 6f70 792e 6173 7365 7274 5f63  rs_copy.assert_c
+00033b80: 616c 6c65 645f 7769 7468 280a 2020 2020  alled_with(.    
+00033b90: 2020 2020 2020 2020 2274 6162 6c65 5f6e          "table_n
+00033ba0: 616d 6522 2c0a 2020 2020 2020 2020 2020  ame",.          
+00033bb0: 2020 2273 333a 2f2f 7333 5f62 7563 6b65    "s3://s3_bucke
+00033bc0: 742f 6c6f 6361 6c5f 6669 6c65 222c 0a20  t/local_file",. 
+00033bd0: 2020 2020 2020 2020 2020 2022 7c22 2c0a             "|",.
+00033be0: 2020 2020 2020 2020 2020 2020 636f 7079              copy
+00033bf0: 5f6f 7074 696f 6e73 3d5b 2249 474e 4f52  _options=["IGNOR
+00033c00: 4548 4541 4445 5220 6173 2031 222c 2022  EHEADER as 1", "
+00033c10: 475a 4950 225d 2c0a 2020 2020 2020 2020  GZIP"],.        
+00033c20: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00033c30: 206e 6f74 206d 6f63 6b5f 7333 5f64 656c   not mock_s3_del
+00033c40: 6574 652e 6361 6c6c 6564 2c20 224f 6e6c  ete.called, "Onl
+00033c50: 7920 6465 6c65 7465 2077 6865 6e20 6578  y delete when ex
+00033c60: 706c 6963 6974 220a 0a20 2020 2020 2020  plicit"..       
+00033c70: 2023 2323 2320 7370 6c69 7420 6f6e 6c79   #### split only
+00033c80: 0a20 2020 2020 2020 2072 6573 6574 5f6d  .        reset_m
+00033c90: 6f63 6b73 2829 0a20 2020 2020 2020 206d  ocks().        m
+00033ca0: 6f63 6b5f 7370 6c69 745f 6669 6c65 2e72  ock_split_file.r
+00033cb0: 6574 7572 6e5f 7661 6c75 6520 3d20 5b0a  eturn_value = [.
+00033cc0: 2020 2020 2020 2020 2020 2020 222f 7061              "/pa
+00033cd0: 7468 2f6c 6f63 616c 5f66 696c 652e 3022  th/local_file.0"
+00033ce0: 2c0a 2020 2020 2020 2020 2020 2020 222f  ,.            "/
+00033cf0: 7061 7468 2f6c 6f63 616c 5f66 696c 652e  path/local_file.
+00033d00: 3122 2c0a 2020 2020 2020 2020 2020 2020  1",.            
+00033d10: 222f 7061 7468 2f6c 6f63 616c 5f66 696c  "/path/local_fil
+00033d20: 652e 3222 2c0a 2020 2020 2020 2020 5d0a  e.2",.        ].
+00033d30: 2020 2020 2020 2020 6d6f 636b 5f63 6f6d          mock_com
+00033d40: 7072 6573 735f 6669 6c65 5f6c 6973 742e  press_file_list.
+00033d50: 7265 7475 726e 5f76 616c 7565 203d 205b  return_value = [
+00033d60: 0a20 2020 2020 2020 2020 2020 2022 2f70  .            "/p
+00033d70: 6174 682f 6c6f 6361 6c5f 6669 6c65 2e30  ath/local_file.0
+00033d80: 2e67 7a22 2c0a 2020 2020 2020 2020 2020  .gz",.          
+00033d90: 2020 222f 7061 7468 2f6c 6f63 616c 5f66    "/path/local_f
+00033da0: 696c 652e 312e 677a 222c 0a20 2020 2020  ile.1.gz",.     
+00033db0: 2020 2020 2020 2022 2f70 6174 682f 6c6f         "/path/lo
+00033dc0: 6361 6c5f 6669 6c65 2e32 2e67 7a22 2c0a  cal_file.2.gz",.
+00033dd0: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
+00033de0: 2020 722e 6c6f 6164 5f61 6e64 5f63 6f70    r.load_and_cop
+00033df0: 7928 0a20 2020 2020 2020 2020 2020 2022  y(.            "
+00033e00: 2f70 6174 682f 6c6f 6361 6c5f 6669 6c65  /path/local_file
+00033e10: 222c 2022 7333 5f62 7563 6b65 7422 2c20  ", "s3_bucket", 
+00033e20: 2274 6162 6c65 5f6e 616d 6522 2c20 6465  "table_name", de
+00033e30: 6c69 6d3d 227c 222c 2073 706c 6974 733d  lim="|", splits=
+00033e40: 332c 2064 656c 6574 655f 7333 5f61 6674  3, delete_s3_aft
+00033e50: 6572 3d54 7275 650a 2020 2020 2020 2020  er=True.        
+00033e60: 290a 0a20 2020 2020 2020 2023 2061 7373  )..        # ass
+00033e70: 6572 740a 2020 2020 2020 2020 6d6f 636b  ert.        mock
+00033e80: 5f73 706c 6974 5f66 696c 652e 6173 7365  _split_file.asse
+00033e90: 7274 5f63 616c 6c65 645f 7769 7468 280a  rt_called_with(.
+00033ea0: 2020 2020 2020 2020 2020 2020 222f 7061              "/pa
+00033eb0: 7468 2f6c 6f63 616c 5f66 696c 6522 2c20  th/local_file", 
+00033ec0: 222f 7061 7468 2f6c 6f63 616c 5f66 696c  "/path/local_fil
+00033ed0: 6522 2c20 7370 6c69 7473 3d33 2c20 6967  e", splits=3, ig
+00033ee0: 6e6f 7265 5f68 6561 6465 723d 300a 2020  nore_header=0.  
+00033ef0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00033f00: 6d6f 636b 5f63 6f6d 7072 6573 735f 6669  mock_compress_fi
+00033f10: 6c65 5f6c 6973 742e 6173 7365 7274 5f63  le_list.assert_c
+00033f20: 616c 6c65 645f 7769 7468 280a 2020 2020  alled_with(.    
+00033f30: 2020 2020 2020 2020 5b22 2f70 6174 682f          ["/path/
+00033f40: 6c6f 6361 6c5f 6669 6c65 2e30 222c 2022  local_file.0", "
+00033f50: 2f70 6174 682f 6c6f 6361 6c5f 6669 6c65  /path/local_file
+00033f60: 2e31 222c 2022 2f70 6174 682f 6c6f 6361  .1", "/path/loca
+00033f70: 6c5f 6669 6c65 2e32 225d 0a20 2020 2020  l_file.2"].     
+00033f80: 2020 2029 0a20 2020 2020 2020 206d 6f63     ).        moc
+00033f90: 6b5f 7333 5f75 706c 6f61 642e 6173 7365  k_s3_upload.asse
+00033fa0: 7274 5f68 6173 5f63 616c 6c73 2865 7870  rt_has_calls(exp
+00033fb0: 6563 7465 645f 6361 6c6c 735f 6e6f 5f66  ected_calls_no_f
+00033fc0: 6f6c 6465 725f 677a 6970 290a 2020 2020  older_gzip).    
+00033fd0: 2020 2020 6d6f 636b 5f72 735f 636f 7079      mock_rs_copy
+00033fe0: 2e61 7373 6572 745f 6361 6c6c 6564 5f77  .assert_called_w
+00033ff0: 6974 6828 0a20 2020 2020 2020 2020 2020  ith(.           
+00034000: 2022 7461 626c 655f 6e61 6d65 222c 2022   "table_name", "
+00034010: 7333 3a2f 2f73 335f 6275 636b 6574 2f6c  s3://s3_bucket/l
+00034020: 6f63 616c 5f66 696c 6522 2c20 227c 222c  ocal_file", "|",
+00034030: 2063 6f70 795f 6f70 7469 6f6e 733d 5b22   copy_options=["
+00034040: 475a 4950 225d 0a20 2020 2020 2020 2029  GZIP"].        )
+00034050: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+00034060: 6d6f 636b 5f73 335f 6465 6c65 7465 2e63  mock_s3_delete.c
+00034070: 616c 6c65 645f 7769 7468 2822 7333 5f62  alled_with("s3_b
+00034080: 7563 6b65 7422 2c20 226c 6f63 616c 5f66  ucket", "local_f
+00034090: 696c 652e 302e 677a 2229 0a20 2020 2020  ile.0.gz").     
+000340a0: 2020 2061 7373 6572 7420 6d6f 636b 5f73     assert mock_s
+000340b0: 335f 6465 6c65 7465 2e63 616c 6c65 645f  3_delete.called_
+000340c0: 7769 7468 2822 7333 5f62 7563 6b65 7422  with("s3_bucket"
+000340d0: 2c20 226c 6f63 616c 5f66 696c 652e 312e  , "local_file.1.
+000340e0: 677a 2229 0a20 2020 2020 2020 2061 7373  gz").        ass
+000340f0: 6572 7420 6d6f 636b 5f73 335f 6465 6c65  ert mock_s3_dele
+00034100: 7465 2e63 616c 6c65 645f 7769 7468 2822  te.called_with("
+00034110: 7333 5f62 7563 6b65 7422 2c20 226c 6f63  s3_bucket", "loc
+00034120: 616c 5f66 696c 652e 322e 677a 2229 0a0a  al_file.2.gz")..
+00034130: 2020 2020 2020 2020 2323 2323 2073 706c          #### spl
+00034140: 6974 2061 6e64 2069 676e 6f72 650a 2020  it and ignore.  
+00034150: 2020 2020 2020 7265 7365 745f 6d6f 636b        reset_mock
+00034160: 7328 290a 2020 2020 2020 2020 6d6f 636b  s().        mock
+00034170: 5f73 706c 6974 5f66 696c 652e 7265 7475  _split_file.retu
+00034180: 726e 5f76 616c 7565 203d 205b 0a20 2020  rn_value = [.   
+00034190: 2020 2020 2020 2020 2022 2f70 6174 682f           "/path/
+000341a0: 6c6f 6361 6c5f 6669 6c65 2e30 222c 0a20  local_file.0",. 
+000341b0: 2020 2020 2020 2020 2020 2022 2f70 6174             "/pat
+000341c0: 682f 6c6f 6361 6c5f 6669 6c65 2e31 222c  h/local_file.1",
+000341d0: 0a20 2020 2020 2020 2020 2020 2022 2f70  .            "/p
+000341e0: 6174 682f 6c6f 6361 6c5f 6669 6c65 2e32  ath/local_file.2
+000341f0: 222c 0a20 2020 2020 2020 205d 0a20 2020  ",.        ].   
+00034200: 2020 2020 206d 6f63 6b5f 636f 6d70 7265       mock_compre
+00034210: 7373 5f66 696c 655f 6c69 7374 2e72 6574  ss_file_list.ret
+00034220: 7572 6e5f 7661 6c75 6520 3d20 5b0a 2020  urn_value = [.  
+00034230: 2020 2020 2020 2020 2020 222f 7061 7468            "/path
+00034240: 2f6c 6f63 616c 5f66 696c 652e 302e 677a  /local_file.0.gz
+00034250: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
+00034260: 2f70 6174 682f 6c6f 6361 6c5f 6669 6c65  /path/local_file
+00034270: 2e31 2e67 7a22 2c0a 2020 2020 2020 2020  .1.gz",.        
+00034280: 2020 2020 222f 7061 7468 2f6c 6f63 616c      "/path/local
+00034290: 5f66 696c 652e 322e 677a 222c 0a20 2020  _file.2.gz",.   
+000342a0: 2020 2020 205d 0a20 2020 2020 2020 2072       ].        r
+000342b0: 2e6c 6f61 645f 616e 645f 636f 7079 280a  .load_and_copy(.
+000342c0: 2020 2020 2020 2020 2020 2020 222f 7061              "/pa
+000342d0: 7468 2f6c 6f63 616c 5f66 696c 6522 2c0a  th/local_file",.
+000342e0: 2020 2020 2020 2020 2020 2020 2273 335f              "s3_
+000342f0: 6275 636b 6574 222c 0a20 2020 2020 2020  bucket",.       
+00034300: 2020 2020 2022 7461 626c 655f 6e61 6d65       "table_name
+00034310: 222c 0a20 2020 2020 2020 2020 2020 2064  ",.            d
+00034320: 656c 696d 3d22 7c22 2c0a 2020 2020 2020  elim="|",.      
+00034330: 2020 2020 2020 636f 7079 5f6f 7074 696f        copy_optio
+00034340: 6e73 3d5b 2249 474e 4f52 4548 4541 4445  ns=["IGNOREHEADE
+00034350: 5220 6173 2031 225d 2c0a 2020 2020 2020  R as 1"],.      
+00034360: 2020 2020 2020 7370 6c69 7473 3d33 2c0a        splits=3,.
+00034370: 2020 2020 2020 2020 2020 2020 6465 6c65              dele
+00034380: 7465 5f73 335f 6166 7465 723d 5472 7565  te_s3_after=True
+00034390: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+000343a0: 2020 2020 2023 2061 7373 6572 740a 2020       # assert.  
+000343b0: 2020 2020 2020 6d6f 636b 5f73 706c 6974        mock_split
+000343c0: 5f66 696c 652e 6173 7365 7274 5f63 616c  _file.assert_cal
+000343d0: 6c65 645f 7769 7468 280a 2020 2020 2020  led_with(.      
+000343e0: 2020 2020 2020 222f 7061 7468 2f6c 6f63        "/path/loc
+000343f0: 616c 5f66 696c 6522 2c20 222f 7061 7468  al_file", "/path
+00034400: 2f6c 6f63 616c 5f66 696c 6522 2c20 7370  /local_file", sp
+00034410: 6c69 7473 3d33 2c20 6967 6e6f 7265 5f68  lits=3, ignore_h
+00034420: 6561 6465 723d 310a 2020 2020 2020 2020  eader=1.        
+00034430: 290a 2020 2020 2020 2020 6d6f 636b 5f63  ).        mock_c
+00034440: 6f6d 7072 6573 735f 6669 6c65 5f6c 6973  ompress_file_lis
+00034450: 742e 6173 7365 7274 5f63 616c 6c65 645f  t.assert_called_
+00034460: 7769 7468 280a 2020 2020 2020 2020 2020  with(.          
+00034470: 2020 5b22 2f70 6174 682f 6c6f 6361 6c5f    ["/path/local_
+00034480: 6669 6c65 2e30 222c 2022 2f70 6174 682f  file.0", "/path/
+00034490: 6c6f 6361 6c5f 6669 6c65 2e31 222c 2022  local_file.1", "
+000344a0: 2f70 6174 682f 6c6f 6361 6c5f 6669 6c65  /path/local_file
+000344b0: 2e32 225d 0a20 2020 2020 2020 2029 0a20  .2"].        ). 
+000344c0: 2020 2020 2020 2023 206d 6f63 6b5f 7265         # mock_re
+000344d0: 6d6f 7665 2e61 7373 6572 745f 6361 6c6c  move.assert_call
+000344e0: 6564 5f77 6974 6828 222f 7061 7468 2f6c  ed_with("/path/l
+000344f0: 6f63 616c 5f66 696c 652e 3222 290a 2020  ocal_file.2").  
+00034500: 2020 2020 2020 6d6f 636b 5f73 335f 7570        mock_s3_up
+00034510: 6c6f 6164 2e61 7373 6572 745f 6861 735f  load.assert_has_
+00034520: 6361 6c6c 7328 6578 7065 6374 6564 5f63  calls(expected_c
+00034530: 616c 6c73 5f6e 6f5f 666f 6c64 6572 5f67  alls_no_folder_g
+00034540: 7a69 7029 0a20 2020 2020 2020 206d 6f63  zip).        moc
+00034550: 6b5f 7273 5f63 6f70 792e 6173 7365 7274  k_rs_copy.assert
+00034560: 5f63 616c 6c65 645f 7769 7468 280a 2020  _called_with(.  
+00034570: 2020 2020 2020 2020 2020 2274 6162 6c65            "table
+00034580: 5f6e 616d 6522 2c20 2273 333a 2f2f 7333  _name", "s3://s3
+00034590: 5f62 7563 6b65 742f 6c6f 6361 6c5f 6669  _bucket/local_fi
+000345a0: 6c65 222c 2022 7c22 2c20 636f 7079 5f6f  le", "|", copy_o
+000345b0: 7074 696f 6e73 3d5b 2247 5a49 5022 5d0a  ptions=["GZIP"].
+000345c0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000345d0: 2020 6173 7365 7274 206d 6f63 6b5f 7333    assert mock_s3
+000345e0: 5f64 656c 6574 652e 6361 6c6c 6564 5f77  _delete.called_w
+000345f0: 6974 6828 2273 335f 6275 636b 6574 222c  ith("s3_bucket",
+00034600: 2022 6c6f 6361 6c5f 6669 6c65 2e30 2e67   "local_file.0.g
+00034610: 7a22 290a 2020 2020 2020 2020 6173 7365  z").        asse
+00034620: 7274 206d 6f63 6b5f 7333 5f64 656c 6574  rt mock_s3_delet
+00034630: 652e 6361 6c6c 6564 5f77 6974 6828 2273  e.called_with("s
+00034640: 335f 6275 636b 6574 222c 2022 6c6f 6361  3_bucket", "loca
+00034650: 6c5f 6669 6c65 2e31 2e67 7a22 290a 2020  l_file.1.gz").  
+00034660: 2020 2020 2020 6173 7365 7274 206d 6f63        assert moc
+00034670: 6b5f 7333 5f64 656c 6574 652e 6361 6c6c  k_s3_delete.call
+00034680: 6564 5f77 6974 6828 2273 335f 6275 636b  ed_with("s3_buck
+00034690: 6574 222c 2022 6c6f 6361 6c5f 6669 6c65  et", "local_file
+000346a0: 2e32 2e67 7a22 290a 0a0a 4070 7974 6573  .2.gz")...@pytes
+000346b0: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
+000346c0: 7a65 2822 6462 6170 6922 2c20 4442 4150  ze("dbapi", DBAP
+000346d0: 4953 290a 406d 6f63 6b2e 7061 7463 6828  IS).@mock.patch(
+000346e0: 226c 6f63 6f70 792e 7333 2e53 6573 7369  "locopy.s3.Sessi
+000346f0: 6f6e 2229 0a64 6566 2074 6573 745f 7265  on").def test_re
+00034700: 6473 6869 6674 636f 7079 286d 6f63 6b5f  dshiftcopy(mock_
+00034710: 7365 7373 696f 6e2c 2063 7265 6465 6e74  session, credent
+00034720: 6961 6c73 2c20 6462 6170 6929 3a0a 0a20  ials, dbapi):.. 
+00034730: 2020 2077 6974 6820 6d6f 636b 2e70 6174     with mock.pat
+00034740: 6368 2864 6261 7069 2e5f 5f6e 616d 655f  ch(dbapi.__name_
+00034750: 5f20 2b20 222e 636f 6e6e 6563 7422 2920  _ + ".connect") 
+00034760: 6173 206d 6f63 6b5f 636f 6e6e 6563 743a  as mock_connect:
+00034770: 0a20 2020 2020 2020 2072 203d 206c 6f63  .        r = loc
+00034780: 6f70 792e 5265 6473 6869 6674 2864 6261  opy.Redshift(dba
+00034790: 7069 3d64 6261 7069 2c20 2a2a 6372 6564  pi=dbapi, **cred
+000347a0: 656e 7469 616c 7329 0a20 2020 2020 2020  entials).       
+000347b0: 2072 2e63 6f6e 6e65 6374 2829 0a20 2020   r.connect().   
+000347c0: 2020 2020 2072 2e63 6f70 7928 2274 6162       r.copy("tab
+000347d0: 6c65 222c 2022 7333 6275 636b 6574 2229  le", "s3bucket")
+000347e0: 0a20 2020 2020 2020 2061 7373 6572 7420  .        assert 
+000347f0: 6d6f 636b 5f63 6f6e 6e65 6374 2e72 6574  mock_connect.ret
+00034800: 7572 6e5f 7661 6c75 652e 6375 7273 6f72  urn_value.cursor
+00034810: 2e72 6574 7572 6e5f 7661 6c75 652e 6578  .return_value.ex
+00034820: 6563 7574 652e 6361 6c6c 6564 0a20 2020  ecute.called.   
+00034830: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
+00034840: 2020 206d 6f63 6b5f 636f 6e6e 6563 742e     mock_connect.
+00034850: 7265 7475 726e 5f76 616c 7565 2e63 7572  return_value.cur
+00034860: 736f 722e 7265 7475 726e 5f76 616c 7565  sor.return_value
+00034870: 2e65 7865 6375 7465 2e61 7373 6572 745f  .execute.assert_
+00034880: 6361 6c6c 6564 5f77 6974 6828 0a20 2020  called_with(.   
+00034890: 2020 2020 2020 2020 2020 2020 2022 434f               "CO
+000348a0: 5059 2074 6162 6c65 2046 524f 4d20 2773  PY table FROM 's
+000348b0: 3362 7563 6b65 7427 2043 5245 4445 4e54  3bucket' CREDENT
+000348c0: 4941 4c53 2022 0a20 2020 2020 2020 2020  IALS ".         
+000348d0: 2020 2020 2020 2022 2761 7773 5f61 6363         "'aws_acc
+000348e0: 6573 735f 6b65 795f 6964 3d7b 307d 3b61  ess_key_id={0};a
+000348f0: 7773 5f73 6563 7265 745f 6163 6365 7373  ws_secret_access
+00034900: 5f6b 6579 3d7b 317d 3b74 6f6b 656e 3d7b  _key={1};token={
+00034910: 327d 2720 220a 2020 2020 2020 2020 2020  2}' ".          
+00034920: 2020 2020 2020 2244 454c 494d 4954 4552        "DELIMITER
+00034930: 2027 7c27 2044 4154 4546 4f52 4d41 5420   '|' DATEFORMAT 
+00034940: 2761 7574 6f27 2043 4f4d 5055 5044 4154  'auto' COMPUPDAT
+00034950: 4520 4f4e 2022 0a20 2020 2020 2020 2020  E ON ".         
+00034960: 2020 2020 2020 2022 5452 554e 4341 5445         "TRUNCATE
+00034970: 434f 4c55 4d4e 533b 222e 666f 726d 6174  COLUMNS;".format
+00034980: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00034990: 2020 2020 2020 722e 7365 7373 696f 6e2e        r.session.
+000349a0: 6765 745f 6372 6564 656e 7469 616c 7328  get_credentials(
+000349b0: 292e 6163 6365 7373 5f6b 6579 2c0a 2020  ).access_key,.  
+000349c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000349d0: 2020 722e 7365 7373 696f 6e2e 6765 745f    r.session.get_
+000349e0: 6372 6564 656e 7469 616c 7328 292e 7365  credentials().se
+000349f0: 6372 6574 5f6b 6579 2c0a 2020 2020 2020  cret_key,.      
+00034a00: 2020 2020 2020 2020 2020 2020 2020 722e                r.
+00034a10: 7365 7373 696f 6e2e 6765 745f 6372 6564  session.get_cred
+00034a20: 656e 7469 616c 7328 292e 746f 6b65 6e2c  entials().token,
+00034a30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034a40: 2029 2c0a 2020 2020 2020 2020 2020 2020   ),.            
+00034a50: 2020 2020 2829 2c0a 2020 2020 2020 2020      (),.        
+00034a60: 2020 2020 290a 2020 2020 2020 2020 290a      ).        ).
+00034a70: 0a20 2020 2020 2020 2023 2074 6162 2064  .        # tab d
+00034a80: 656c 696d 0a20 2020 2020 2020 2072 2e63  elim.        r.c
+00034a90: 6f70 7928 2274 6162 6c65 222c 2022 7333  opy("table", "s3
+00034aa0: 6275 636b 6574 222c 2064 656c 696d 3d22  bucket", delim="
+00034ab0: 5c74 2229 0a20 2020 2020 2020 2061 7373  \t").        ass
+00034ac0: 6572 7420 6d6f 636b 5f63 6f6e 6e65 6374  ert mock_connect
+00034ad0: 2e72 6574 7572 6e5f 7661 6c75 652e 6375  .return_value.cu
+00034ae0: 7273 6f72 2e72 6574 7572 6e5f 7661 6c75  rsor.return_valu
+00034af0: 652e 6578 6563 7574 652e 6361 6c6c 6564  e.execute.called
+00034b00: 0a20 2020 2020 2020 2028 0a20 2020 2020  .        (.     
+00034b10: 2020 2020 2020 206d 6f63 6b5f 636f 6e6e         mock_conn
+00034b20: 6563 742e 7265 7475 726e 5f76 616c 7565  ect.return_value
+00034b30: 2e63 7572 736f 722e 7265 7475 726e 5f76  .cursor.return_v
+00034b40: 616c 7565 2e65 7865 6375 7465 2e61 7373  alue.execute.ass
+00034b50: 6572 745f 6361 6c6c 6564 5f77 6974 6828  ert_called_with(
+00034b60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034b70: 2022 434f 5059 2074 6162 6c65 2046 524f   "COPY table FRO
+00034b80: 4d20 2773 3362 7563 6b65 7427 2043 5245  M 's3bucket' CRE
+00034b90: 4445 4e54 4941 4c53 2022 0a20 2020 2020  DENTIALS ".     
+00034ba0: 2020 2020 2020 2020 2020 2022 2761 7773             "'aws
+00034bb0: 5f61 6363 6573 735f 6b65 795f 6964 3d7b  _access_key_id={
+00034bc0: 307d 3b61 7773 5f73 6563 7265 745f 6163  0};aws_secret_ac
+00034bd0: 6365 7373 5f6b 6579 3d7b 317d 3b74 6f6b  cess_key={1};tok
+00034be0: 656e 3d7b 327d 2720 220a 2020 2020 2020  en={2}' ".      
+00034bf0: 2020 2020 2020 2020 2020 2244 454c 494d            "DELIM
+00034c00: 4954 4552 2027 5c74 2720 4441 5445 464f  ITER '\t' DATEFO
+00034c10: 524d 4154 2027 6175 746f 2720 434f 4d50  RMAT 'auto' COMP
+00034c20: 5550 4441 5445 204f 4e20 220a 2020 2020  UPDATE ON ".    
+00034c30: 2020 2020 2020 2020 2020 2020 2254 5255              "TRU
+00034c40: 4e43 4154 4543 4f4c 554d 4e53 3b22 2e66  NCATECOLUMNS;".f
+00034c50: 6f72 6d61 7428 0a20 2020 2020 2020 2020  ormat(.         
+00034c60: 2020 2020 2020 2020 2020 2072 2e73 6573             r.ses
+00034c70: 7369 6f6e 2e67 6574 5f63 7265 6465 6e74  sion.get_credent
+00034c80: 6961 6c73 2829 2e61 6363 6573 735f 6b65  ials().access_ke
+00034c90: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+00034ca0: 2020 2020 2020 2072 2e73 6573 7369 6f6e         r.session
+00034cb0: 2e67 6574 5f63 7265 6465 6e74 6961 6c73  .get_credentials
+00034cc0: 2829 2e73 6563 7265 745f 6b65 792c 0a20  ().secret_key,. 
+00034cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034ce0: 2020 2072 2e73 6573 7369 6f6e 2e67 6574     r.session.get
+00034cf0: 5f63 7265 6465 6e74 6961 6c73 2829 2e74  _credentials().t
+00034d00: 6f6b 656e 2c0a 2020 2020 2020 2020 2020  oken,.          
+00034d10: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
+00034d20: 2020 2020 2020 2020 2028 292c 0a20 2020           (),.   
+00034d30: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00034d40: 2020 2029 0a20 2020 2020 2020 2023 206e     ).        # n
+00034d50: 6f20 6465 6c69 6d0a 2020 2020 2020 2020  o delim.        
+00034d60: 722e 636f 7079 2822 7461 626c 6522 2c20  r.copy("table", 
+00034d70: 2273 3362 7563 6b65 7422 2c20 6465 6c69  "s3bucket", deli
+00034d80: 6d3d 4e6f 6e65 290a 2020 2020 2020 2020  m=None).        
+00034d90: 6173 7365 7274 206d 6f63 6b5f 636f 6e6e  assert mock_conn
+00034da0: 6563 742e 7265 7475 726e 5f76 616c 7565  ect.return_value
+00034db0: 2e63 7572 736f 722e 7265 7475 726e 5f76  .cursor.return_v
+00034dc0: 616c 7565 2e65 7865 6375 7465 2e63 616c  alue.execute.cal
+00034dd0: 6c65 640a 2020 2020 2020 2020 280a 2020  led.        (.  
+00034de0: 2020 2020 2020 2020 2020 6d6f 636b 5f63            mock_c
+00034df0: 6f6e 6e65 6374 2e72 6574 7572 6e5f 7661  onnect.return_va
+00034e00: 6c75 652e 6375 7273 6f72 2e72 6574 7572  lue.cursor.retur
+00034e10: 6e5f 7661 6c75 652e 6578 6563 7574 652e  n_value.execute.
+00034e20: 6173 7365 7274 5f63 616c 6c65 645f 7769  assert_called_wi
+00034e30: 7468 280a 2020 2020 2020 2020 2020 2020  th(.            
+00034e40: 2020 2020 2243 4f50 5920 7461 626c 6520      "COPY table 
+00034e50: 4652 4f4d 2027 7333 6275 636b 6574 2720  FROM 's3bucket' 
+00034e60: 4352 4544 454e 5449 414c 5320 220a 2020  CREDENTIALS ".  
+00034e70: 2020 2020 2020 2020 2020 2020 2020 2227                "'
+00034e80: 6177 735f 6163 6365 7373 5f6b 6579 5f69  aws_access_key_i
+00034e90: 643d 7b30 7d3b 6177 735f 7365 6372 6574  d={0};aws_secret
+00034ea0: 5f61 6363 6573 735f 6b65 793d 7b31 7d3b  _access_key={1};
+00034eb0: 746f 6b65 6e3d 7b32 7d27 2022 0a20 2020  token={2}' ".   
+00034ec0: 2020 2020 2020 2020 2020 2020 2022 4441               "DA
+00034ed0: 5445 464f 524d 4154 2027 6175 746f 2720  TEFORMAT 'auto' 
+00034ee0: 434f 4d50 5550 4441 5445 204f 4e20 220a  COMPUPDATE ON ".
+00034ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034f00: 2254 5255 4e43 4154 4543 4f4c 554d 4e53  "TRUNCATECOLUMNS
+00034f10: 3b22 2e66 6f72 6d61 7428 0a20 2020 2020  ;".format(.     
+00034f20: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00034f30: 2e73 6573 7369 6f6e 2e67 6574 5f63 7265  .session.get_cre
+00034f40: 6465 6e74 6961 6c73 2829 2e61 6363 6573  dentials().acces
+00034f50: 735f 6b65 792c 0a20 2020 2020 2020 2020  s_key,.         
+00034f60: 2020 2020 2020 2020 2020 2072 2e73 6573             r.ses
+00034f70: 7369 6f6e 2e67 6574 5f63 7265 6465 6e74  sion.get_credent
+00034f80: 6961 6c73 2829 2e73 6563 7265 745f 6b65  ials().secret_ke
+00034f90: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+00034fa0: 2020 2020 2020 2072 2e73 6573 7369 6f6e         r.session
+00034fb0: 2e67 6574 5f63 7265 6465 6e74 6961 6c73  .get_credentials
+00034fc0: 2829 2e74 6f6b 656e 2c0a 2020 2020 2020  ().token,.      
+00034fd0: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+00034fe0: 2020 2020 2020 2020 2020 2020 2028 292c               (),
+00034ff0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00035000: 2020 2020 2020 2029 0a0a 0a40 7079 7465         )...@pyte
+00035010: 7374 2e6d 6172 6b2e 7061 7261 6d65 7472  st.mark.parametr
+00035020: 697a 6528 2264 6261 7069 222c 2044 4241  ize("dbapi", DBA
+00035030: 5049 5329 0a40 6d6f 636b 2e70 6174 6368  PIS).@mock.patch
+00035040: 2822 6c6f 636f 7079 2e73 332e 5365 7373  ("locopy.s3.Sess
+00035050: 696f 6e22 290a 406d 6f63 6b2e 7061 7463  ion").@mock.patc
+00035060: 6828 226c 6f63 6f70 792e 6461 7461 6261  h("locopy.databa
+00035070: 7365 2e44 6174 6162 6173 652e 5f69 735f  se.Database._is_
+00035080: 636f 6e6e 6563 7465 6422 290a 6465 6620  connected").def 
+00035090: 7465 7374 5f72 6564 7368 6966 7463 6f70  test_redshiftcop
+000350a0: 795f 6578 6365 7074 696f 6e28 6d6f 636b  y_exception(mock
+000350b0: 5f63 6f6e 6e65 6374 6564 2c20 6d6f 636b  _connected, mock
+000350c0: 5f73 6573 7369 6f6e 2c20 6372 6564 656e  _session, creden
+000350d0: 7469 616c 732c 2064 6261 7069 293a 0a0a  tials, dbapi):..
+000350e0: 2020 2020 7769 7468 206d 6f63 6b2e 7061      with mock.pa
+000350f0: 7463 6828 6462 6170 692e 5f5f 6e61 6d65  tch(dbapi.__name
+00035100: 5f5f 202b 2022 2e63 6f6e 6e65 6374 2229  __ + ".connect")
+00035110: 2061 7320 6d6f 636b 5f63 6f6e 6e65 6374   as mock_connect
+00035120: 3a0a 2020 2020 2020 2020 7220 3d20 6c6f  :.        r = lo
+00035130: 636f 7079 2e52 6564 7368 6966 7428 6462  copy.Redshift(db
+00035140: 6170 693d 6462 6170 692c 202a 2a63 7265  api=dbapi, **cre
+00035150: 6465 6e74 6961 6c73 290a 2020 2020 2020  dentials).      
+00035160: 2020 6d6f 636b 5f63 6f6e 6e65 6374 6564    mock_connected
+00035170: 2e72 6574 7572 6e5f 7661 6c75 6520 3d20  .return_value = 
+00035180: 4661 6c73 650a 0a20 2020 2020 2020 2077  False..        w
+00035190: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+000351a0: 7328 4442 4572 726f 7229 3a0a 2020 2020  s(DBError):.    
+000351b0: 2020 2020 2020 2020 722e 636f 7079 2822          r.copy("
+000351c0: 7461 626c 6522 2c20 2273 3362 7563 6b65  table", "s3bucke
+000351d0: 7422 290a 0a20 2020 2020 2020 206d 6f63  t")..        moc
+000351e0: 6b5f 636f 6e6e 6563 7465 642e 7265 7475  k_connected.retu
+000351f0: 726e 5f76 616c 7565 203d 2054 7275 650a  rn_value = True.
+00035200: 2020 2020 2020 2020 286d 6f63 6b5f 636f          (mock_co
+00035210: 6e6e 6563 742e 7265 7475 726e 5f76 616c  nnect.return_val
+00035220: 7565 2e63 7572 736f 722e 7265 7475 726e  ue.cursor.return
+00035230: 5f76 616c 7565 2e65 7865 6375 7465 2e73  _value.execute.s
+00035240: 6964 655f 6566 6665 6374 2920 3d20 4578  ide_effect) = Ex
+00035250: 6365 7074 696f 6e28 0a20 2020 2020 2020  ception(.       
+00035260: 2020 2020 2022 434f 5059 2045 7863 6570       "COPY Excep
+00035270: 7469 6f6e 220a 2020 2020 2020 2020 290a  tion".        ).
+00035280: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
+00035290: 6573 742e 7261 6973 6573 2844 4245 7272  est.raises(DBErr
+000352a0: 6f72 293a 0a20 2020 2020 2020 2020 2020  or):.           
+000352b0: 2072 2e63 6f70 7928 2274 6162 6c65 222c   r.copy("table",
+000352c0: 2022 7333 6275 636b 6574 2229 0a0a 0a40   "s3bucket")...@
+000352d0: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
+000352e0: 6d65 7472 697a 6528 2264 6261 7069 222c  metrize("dbapi",
+000352f0: 2044 4241 5049 5329 0a40 6d6f 636b 2e70   DBAPIS).@mock.p
+00035300: 6174 6368 2822 6c6f 636f 7079 2e72 6564  atch("locopy.red
+00035310: 7368 6966 742e 636f 6e63 6174 656e 6174  shift.concatenat
+00035320: 655f 6669 6c65 7322 290a 406d 6f63 6b2e  e_files").@mock.
+00035330: 7061 7463 6828 226c 6f63 6f70 792e 7333  patch("locopy.s3
+00035340: 2e53 332e 6465 6c65 7465 5f6c 6973 745f  .S3.delete_list_
+00035350: 6672 6f6d 5f73 3322 290a 406d 6f63 6b2e  from_s3").@mock.
+00035360: 7061 7463 6828 226c 6f63 6f70 792e 7265  patch("locopy.re
+00035370: 6473 6869 6674 2e77 7269 7465 5f66 696c  dshift.write_fil
+00035380: 6522 290a 406d 6f63 6b2e 7061 7463 6828  e").@mock.patch(
+00035390: 226c 6f63 6f70 792e 7333 2e53 332e 646f  "locopy.s3.S3.do
+000353a0: 776e 6c6f 6164 5f6c 6973 745f 6672 6f6d  wnload_list_from
+000353b0: 5f73 3322 290a 406d 6f63 6b2e 7061 7463  _s3").@mock.patc
+000353c0: 6828 226c 6f63 6f70 792e 7265 6473 6869  h("locopy.redshi
+000353d0: 6674 2e52 6564 7368 6966 742e 5f67 6574  ft.Redshift._get
+000353e0: 5f63 6f6c 756d 6e5f 6e61 6d65 7322 290a  _column_names").
+000353f0: 406d 6f63 6b2e 7061 7463 6828 226c 6f63  @mock.patch("loc
+00035400: 6f70 792e 7265 6473 6869 6674 2e52 6564  opy.redshift.Red
+00035410: 7368 6966 742e 5f75 6e6c 6f61 645f 6765  shift._unload_ge
+00035420: 6e65 7261 7465 645f 6669 6c65 7322 290a  nerated_files").
+00035430: 406d 6f63 6b2e 7061 7463 6828 226c 6f63  @mock.patch("loc
+00035440: 6f70 792e 7265 6473 6869 6674 2e52 6564  opy.redshift.Red
+00035450: 7368 6966 742e 756e 6c6f 6164 2229 0a40  shift.unload").@
+00035460: 6d6f 636b 2e70 6174 6368 2822 6c6f 636f  mock.patch("loco
+00035470: 7079 2e73 332e 5333 2e5f 6765 6e65 7261  py.s3.S3._genera
+00035480: 7465 5f75 6e6c 6f61 645f 7061 7468 2229  te_unload_path")
+00035490: 0a40 6d6f 636b 2e70 6174 6368 2822 6c6f  .@mock.patch("lo
+000354a0: 636f 7079 2e73 332e 5365 7373 696f 6e22  copy.s3.Session"
+000354b0: 290a 6465 6620 7465 7374 5f75 6e6c 6f61  ).def test_unloa
+000354c0: 645f 616e 645f 636f 7079 280a 2020 2020  d_and_copy(.    
+000354d0: 6d6f 636b 5f73 6573 7369 6f6e 2c0a 2020  mock_session,.  
+000354e0: 2020 6d6f 636b 5f67 656e 6572 6174 655f    mock_generate_
+000354f0: 756e 6c6f 6164 5f70 6174 682c 0a20 2020  unload_path,.   
+00035500: 206d 6f63 6b5f 756e 6c6f 6164 2c0a 2020   mock_unload,.  
+00035510: 2020 6d6f 636b 5f75 6e6c 6f61 645f 6765    mock_unload_ge
+00035520: 6e65 7261 7465 645f 6669 6c65 732c 0a20  nerated_files,. 
+00035530: 2020 206d 6f63 6b5f 6765 745f 636f 6c5f     mock_get_col_
+00035540: 6e61 6d65 732c 0a20 2020 206d 6f63 6b5f  names,.    mock_
+00035550: 646f 776e 6c6f 6164 5f6c 6973 745f 6672  download_list_fr
+00035560: 6f6d 5f73 332c 0a20 2020 206d 6f63 6b5f  om_s3,.    mock_
+00035570: 7772 6974 652c 0a20 2020 206d 6f63 6b5f  write,.    mock_
+00035580: 6465 6c65 7465 5f6c 6973 745f 6672 6f6d  delete_list_from
+00035590: 5f73 332c 0a20 2020 206d 6f63 6b5f 636f  _s3,.    mock_co
+000355a0: 6e63 6174 2c0a 2020 2020 6372 6564 656e  ncat,.    creden
+000355b0: 7469 616c 732c 0a20 2020 2064 6261 7069  tials,.    dbapi
+000355c0: 2c0a 293a 0a20 2020 2064 6566 2072 6573  ,.):.    def res
+000355d0: 6574 5f6d 6f63 6b73 2829 3a0a 2020 2020  et_mocks():.    
+000355e0: 2020 2020 6d6f 636b 5f73 6573 7369 6f6e      mock_session
+000355f0: 2e72 6573 6574 5f6d 6f63 6b28 290a 2020  .reset_mock().  
+00035600: 2020 2020 2020 6d6f 636b 5f67 656e 6572        mock_gener
+00035610: 6174 655f 756e 6c6f 6164 5f70 6174 682e  ate_unload_path.
+00035620: 7265 7365 745f 6d6f 636b 2829 0a20 2020  reset_mock().   
+00035630: 2020 2020 206d 6f63 6b5f 756e 6c6f 6164       mock_unload
+00035640: 5f67 656e 6572 6174 6564 5f66 696c 6573  _generated_files
+00035650: 2e72 6573 6574 5f6d 6f63 6b28 290a 2020  .reset_mock().  
+00035660: 2020 2020 2020 6d6f 636b 5f67 6574 5f63        mock_get_c
+00035670: 6f6c 5f6e 616d 6573 2e72 6573 6574 5f6d  ol_names.reset_m
+00035680: 6f63 6b28 290a 2020 2020 2020 2020 6d6f  ock().        mo
+00035690: 636b 5f77 7269 7465 2e72 6573 6574 5f6d  ck_write.reset_m
+000356a0: 6f63 6b28 290a 2020 2020 2020 2020 6d6f  ock().        mo
+000356b0: 636b 5f64 6f77 6e6c 6f61 645f 6c69 7374  ck_download_list
+000356c0: 5f66 726f 6d5f 7333 2e72 6573 6574 5f6d  _from_s3.reset_m
+000356d0: 6f63 6b28 290a 2020 2020 2020 2020 6d6f  ock().        mo
+000356e0: 636b 5f64 656c 6574 655f 6c69 7374 5f66  ck_delete_list_f
+000356f0: 726f 6d5f 7333 2e72 6573 6574 5f6d 6f63  rom_s3.reset_moc
+00035700: 6b28 290a 2020 2020 2020 2020 6d6f 636b  k().        mock
+00035710: 5f63 6f6e 6361 742e 7265 7365 745f 6d6f  _concat.reset_mo
+00035720: 636b 2829 0a0a 2020 2020 7769 7468 206d  ck()..    with m
+00035730: 6f63 6b2e 7061 7463 6828 6462 6170 692e  ock.patch(dbapi.
+00035740: 5f5f 6e61 6d65 5f5f 202b 2022 2e63 6f6e  __name__ + ".con
+00035750: 6e65 6374 2229 2061 7320 6d6f 636b 5f63  nect") as mock_c
+00035760: 6f6e 6e65 6374 3a0a 2020 2020 2020 2020  onnect:.        
+00035770: 7220 3d20 6c6f 636f 7079 2e52 6564 7368  r = locopy.Redsh
+00035780: 6966 7428 6462 6170 693d 6462 6170 692c  ift(dbapi=dbapi,
+00035790: 202a 2a63 7265 6465 6e74 6961 6c73 290a   **credentials).
+000357a0: 0a20 2020 2020 2020 2023 230a 2020 2020  .        ##.    
+000357b0: 2020 2020 2323 2054 6573 7420 313a 2063      ## Test 1: c
+000357c0: 6865 636b 2074 6861 7420 6261 7369 6320  heck that basic 
+000357d0: 6578 706f 7274 2070 6970 656c 696e 6520  export pipeline 
+000357e0: 6675 6e63 7469 6f6e 7320 6172 6520 6361  functions are ca
+000357f0: 6c6c 6564 0a20 2020 2020 2020 206d 6f63  lled.        moc
+00035800: 6b5f 756e 6c6f 6164 5f67 656e 6572 6174  k_unload_generat
+00035810: 6564 5f66 696c 6573 2e72 6574 7572 6e5f  ed_files.return_
+00035820: 7661 6c75 6520 3d20 5b22 6475 6d6d 795f  value = ["dummy_
+00035830: 6669 6c65 225d 0a20 2020 2020 2020 206d  file"].        m
+00035840: 6f63 6b5f 646f 776e 6c6f 6164 5f6c 6973  ock_download_lis
+00035850: 745f 6672 6f6d 5f73 332e 7265 7475 726e  t_from_s3.return
+00035860: 5f76 616c 7565 203d 205b 2273 332e 6669  _value = ["s3.fi
+00035870: 6c65 225d 0a20 2020 2020 2020 206d 6f63  le"].        moc
+00035880: 6b5f 6765 745f 636f 6c5f 6e61 6d65 732e  k_get_col_names.
+00035890: 7265 7475 726e 5f76 616c 7565 203d 205b  return_value = [
+000358a0: 2264 756d 6d79 5f63 6f6c 5f6e 616d 6522  "dummy_col_name"
+000358b0: 5d0a 2020 2020 2020 2020 6d6f 636b 5f67  ].        mock_g
+000358c0: 656e 6572 6174 655f 756e 6c6f 6164 5f70  enerate_unload_p
+000358d0: 6174 682e 7265 7475 726e 5f76 616c 7565  ath.return_value
+000358e0: 203d 2022 6475 6d6d 795f 7333 5f70 6174   = "dummy_s3_pat
+000358f0: 6822 0a0a 2020 2020 2020 2020 2323 2065  h"..        ## e
+00035900: 6e73 7572 6520 6e6f 7468 696e 6720 6973  nsure nothing is
+00035910: 2072 6574 7572 6e65 6420 7768 656e 2072   returned when r
+00035920: 6561 643d 4661 6c73 650a 2020 2020 2020  ead=False.      
+00035930: 2020 722e 756e 6c6f 6164 5f61 6e64 5f63    r.unload_and_c
+00035940: 6f70 7928 0a20 2020 2020 2020 2020 2020  opy(.           
+00035950: 2071 7565 7279 3d22 7175 6572 7922 2c0a   query="query",.
+00035960: 2020 2020 2020 2020 2020 2020 7333 5f62              s3_b
+00035970: 7563 6b65 743d 2273 335f 6275 636b 6574  ucket="s3_bucket
+00035980: 222c 0a20 2020 2020 2020 2020 2020 2073  ",.            s
+00035990: 335f 666f 6c64 6572 3d4e 6f6e 652c 0a20  3_folder=None,. 
+000359a0: 2020 2020 2020 2020 2020 2072 6177 5f75             raw_u
+000359b0: 6e6c 6f61 645f 7061 7468 3d4e 6f6e 652c  nload_path=None,
+000359c0: 0a20 2020 2020 2020 2020 2020 2065 7870  .            exp
+000359d0: 6f72 745f 7061 7468 3d46 616c 7365 2c0a  ort_path=False,.
+000359e0: 2020 2020 2020 2020 2020 2020 6465 6c69              deli
+000359f0: 6d3d 222c 222c 0a20 2020 2020 2020 2020  m=",",.         
+00035a00: 2020 2064 656c 6574 655f 7333 5f61 6674     delete_s3_aft
+00035a10: 6572 3d46 616c 7365 2c0a 2020 2020 2020  er=False,.      
+00035a20: 2020 2020 2020 7061 7261 6c6c 656c 5f6f        parallel_o
+00035a30: 6666 3d46 616c 7365 2c0a 2020 2020 2020  ff=False,.      
+00035a40: 2020 290a 0a20 2020 2020 2020 2061 7373    )..        ass
+00035a50: 6572 7420 6d6f 636b 5f75 6e6c 6f61 645f  ert mock_unload_
+00035a60: 6765 6e65 7261 7465 645f 6669 6c65 732e  generated_files.
+00035a70: 6361 6c6c 6564 0a20 2020 2020 2020 2061  called.        a
+00035a80: 7373 6572 7420 6e6f 7420 6d6f 636b 5f77  ssert not mock_w
+00035a90: 7269 7465 2e63 616c 6c65 642c 2022 7772  rite.called, "wr
+00035aa0: 6974 655f 6669 6c65 2073 686f 756c 6420  ite_file should 
+00035ab0: 6f6e 6c79 2062 6520 6361 6c6c 6564 2022  only be called "
+00035ac0: 2022 6966 2065 7870 6f72 745f 7061 7468   "if export_path
+00035ad0: 2021 3d20 4661 6c73 6522 0a20 2020 2020   != False".     
+00035ae0: 2020 206d 6f63 6b5f 6765 6e65 7261 7465     mock_generate
+00035af0: 5f75 6e6c 6f61 645f 7061 7468 2e61 7373  _unload_path.ass
+00035b00: 6572 745f 6361 6c6c 6564 5f77 6974 6828  ert_called_with(
+00035b10: 2273 335f 6275 636b 6574 222c 204e 6f6e  "s3_bucket", Non
+00035b20: 6529 0a20 2020 2020 2020 206d 6f63 6b5f  e).        mock_
+00035b30: 6765 745f 636f 6c5f 6e61 6d65 732e 6173  get_col_names.as
+00035b40: 7365 7274 5f63 616c 6c65 645f 7769 7468  sert_called_with
+00035b50: 2822 7175 6572 7922 290a 2020 2020 2020  ("query").      
+00035b60: 2020 6d6f 636b 5f75 6e6c 6f61 642e 6173    mock_unload.as
+00035b70: 7365 7274 5f63 616c 6c65 645f 7769 7468  sert_called_with
+00035b80: 280a 2020 2020 2020 2020 2020 2020 7175  (.            qu
+00035b90: 6572 793d 2271 7565 7279 222c 2073 3370  ery="query", s3p
+00035ba0: 6174 683d 2264 756d 6d79 5f73 335f 7061  ath="dummy_s3_pa
+00035bb0: 7468 222c 2075 6e6c 6f61 645f 6f70 7469  th", unload_opti
+00035bc0: 6f6e 733d 5b22 4445 4c49 4d49 5445 5220  ons=["DELIMITER 
+00035bd0: 272c 2722 5d0a 2020 2020 2020 2020 290a  ','"].        ).
+00035be0: 2020 2020 2020 2020 6173 7365 7274 206e          assert n
+00035bf0: 6f74 206d 6f63 6b5f 6465 6c65 7465 5f6c  ot mock_delete_l
+00035c00: 6973 745f 6672 6f6d 5f73 332e 6361 6c6c  ist_from_s3.call
+00035c10: 6564 0a0a 2020 2020 2020 2020 2323 0a20  ed..        ##. 
+00035c20: 2020 2020 2020 2023 2320 5465 7374 2032         ## Test 2
+00035c30: 3a20 6469 6666 6572 656e 7420 6465 6c69  : different deli
+00035c40: 6d69 7465 720a 2020 2020 2020 2020 7265  miter.        re
+00035c50: 7365 745f 6d6f 636b 7328 290a 2020 2020  set_mocks().    
+00035c60: 2020 2020 6d6f 636b 5f75 6e6c 6f61 645f      mock_unload_
+00035c70: 6765 6e65 7261 7465 645f 6669 6c65 732e  generated_files.
+00035c80: 7265 7475 726e 5f76 616c 7565 203d 205b  return_value = [
+00035c90: 2264 756d 6d79 5f66 696c 6522 5d0a 2020  "dummy_file"].  
+00035ca0: 2020 2020 2020 6d6f 636b 5f64 6f77 6e6c        mock_downl
+00035cb0: 6f61 645f 6c69 7374 5f66 726f 6d5f 7333  oad_list_from_s3
+00035cc0: 2e72 6574 7572 6e5f 7661 6c75 6520 3d20  .return_value = 
+00035cd0: 5b22 7333 2e66 696c 6522 5d0a 2020 2020  ["s3.file"].    
+00035ce0: 2020 2020 6d6f 636b 5f67 6574 5f63 6f6c      mock_get_col
+00035cf0: 5f6e 616d 6573 2e72 6574 7572 6e5f 7661  _names.return_va
+00035d00: 6c75 6520 3d20 5b22 6475 6d6d 795f 636f  lue = ["dummy_co
+00035d10: 6c5f 6e61 6d65 225d 0a20 2020 2020 2020  l_name"].       
+00035d20: 206d 6f63 6b5f 6765 6e65 7261 7465 5f75   mock_generate_u
+00035d30: 6e6c 6f61 645f 7061 7468 2e72 6574 7572  nload_path.retur
+00035d40: 6e5f 7661 6c75 6520 3d20 2264 756d 6d79  n_value = "dummy
+00035d50: 5f73 335f 7061 7468 220a 2020 2020 2020  _s3_path".      
+00035d60: 2020 722e 756e 6c6f 6164 5f61 6e64 5f63    r.unload_and_c
+00035d70: 6f70 7928 0a20 2020 2020 2020 2020 2020  opy(.           
+00035d80: 2071 7565 7279 3d22 7175 6572 7922 2c0a   query="query",.
+00035d90: 2020 2020 2020 2020 2020 2020 7333 5f62              s3_b
+00035da0: 7563 6b65 743d 2273 335f 6275 636b 6574  ucket="s3_bucket
+00035db0: 222c 0a20 2020 2020 2020 2020 2020 2073  ",.            s
+00035dc0: 335f 666f 6c64 6572 3d4e 6f6e 652c 0a20  3_folder=None,. 
+00035dd0: 2020 2020 2020 2020 2020 2072 6177 5f75             raw_u
+00035de0: 6e6c 6f61 645f 7061 7468 3d4e 6f6e 652c  nload_path=None,
+00035df0: 0a20 2020 2020 2020 2020 2020 2065 7870  .            exp
+00035e00: 6f72 745f 7061 7468 3d46 616c 7365 2c0a  ort_path=False,.
+00035e10: 2020 2020 2020 2020 2020 2020 6465 6c69              deli
+00035e20: 6d3d 227c 222c 0a20 2020 2020 2020 2020  m="|",.         
+00035e30: 2020 2064 656c 6574 655f 7333 5f61 6674     delete_s3_aft
+00035e40: 6572 3d46 616c 7365 2c0a 2020 2020 2020  er=False,.      
+00035e50: 2020 2020 2020 7061 7261 6c6c 656c 5f6f        parallel_o
+00035e60: 6666 3d54 7275 652c 0a20 2020 2020 2020  ff=True,.       
+00035e70: 2029 0a0a 2020 2020 2020 2020 2323 2063   )..        ## c
+00035e80: 6865 636b 2074 6861 7420 756e 6c6f 6164  heck that unload
+00035e90: 206f 7074 696f 6e73 2061 7265 206d 6f64   options are mod
+00035ea0: 6966 6965 6420 6261 7365 6420 6f6e 2073  ified based on s
+00035eb0: 7570 706c 6965 6420 6172 6773 0a20 2020  upplied args.   
+00035ec0: 2020 2020 206d 6f63 6b5f 756e 6c6f 6164       mock_unload
+00035ed0: 2e61 7373 6572 745f 6361 6c6c 6564 5f77  .assert_called_w
+00035ee0: 6974 6828 0a20 2020 2020 2020 2020 2020  ith(.           
+00035ef0: 2071 7565 7279 3d22 7175 6572 7922 2c20   query="query", 
+00035f00: 7333 7061 7468 3d22 6475 6d6d 795f 7333  s3path="dummy_s3
+00035f10: 5f70 6174 6822 2c20 756e 6c6f 6164 5f6f  _path", unload_o
+00035f20: 7074 696f 6e73 3d5b 2244 454c 494d 4954  ptions=["DELIMIT
+00035f30: 4552 2027 7c27 222c 2022 5041 5241 4c4c  ER '|'", "PARALL
+00035f40: 454c 204f 4646 225d 0a20 2020 2020 2020  EL OFF"].       
+00035f50: 2029 0a20 2020 2020 2020 2061 7373 6572   ).        asser
+00035f60: 7420 6e6f 7420 6d6f 636b 5f64 656c 6574  t not mock_delet
+00035f70: 655f 6c69 7374 5f66 726f 6d5f 7333 2e63  e_list_from_s3.c
+00035f80: 616c 6c65 640a 0a20 2020 2020 2020 2023  alled..        #
+00035f90: 230a 2020 2020 2020 2020 2323 2054 6573  #.        ## Tes
+00035fa0: 7420 322e 353a 2064 656c 696d 6974 6572  t 2.5: delimiter
+00035fb0: 2069 7320 6e6f 6e65 0a20 2020 2020 2020   is none.       
+00035fc0: 2072 6573 6574 5f6d 6f63 6b73 2829 0a20   reset_mocks(). 
+00035fd0: 2020 2020 2020 206d 6f63 6b5f 756e 6c6f         mock_unlo
+00035fe0: 6164 5f67 656e 6572 6174 6564 5f66 696c  ad_generated_fil
+00035ff0: 6573 2e72 6574 7572 6e5f 7661 6c75 6520  es.return_value 
+00036000: 3d20 5b22 6475 6d6d 795f 6669 6c65 225d  = ["dummy_file"]
+00036010: 0a20 2020 2020 2020 206d 6f63 6b5f 646f  .        mock_do
+00036020: 776e 6c6f 6164 5f6c 6973 745f 6672 6f6d  wnload_list_from
+00036030: 5f73 332e 7265 7475 726e 5f76 616c 7565  _s3.return_value
+00036040: 203d 205b 2273 332e 6669 6c65 225d 0a20   = ["s3.file"]. 
+00036050: 2020 2020 2020 206d 6f63 6b5f 6765 745f         mock_get_
+00036060: 636f 6c5f 6e61 6d65 732e 7265 7475 726e  col_names.return
+00036070: 5f76 616c 7565 203d 205b 2264 756d 6d79  _value = ["dummy
+00036080: 5f63 6f6c 5f6e 616d 6522 5d0a 2020 2020  _col_name"].    
+00036090: 2020 2020 6d6f 636b 5f67 656e 6572 6174      mock_generat
+000360a0: 655f 756e 6c6f 6164 5f70 6174 682e 7265  e_unload_path.re
+000360b0: 7475 726e 5f76 616c 7565 203d 2022 6475  turn_value = "du
+000360c0: 6d6d 795f 7333 5f70 6174 6822 0a20 2020  mmy_s3_path".   
+000360d0: 2020 2020 2072 2e75 6e6c 6f61 645f 616e       r.unload_an
+000360e0: 645f 636f 7079 280a 2020 2020 2020 2020  d_copy(.        
+000360f0: 2020 2020 7175 6572 793d 2271 7565 7279      query="query
+00036100: 222c 0a20 2020 2020 2020 2020 2020 2073  ",.            s
+00036110: 335f 6275 636b 6574 3d22 7333 5f62 7563  3_bucket="s3_buc
+00036120: 6b65 7422 2c0a 2020 2020 2020 2020 2020  ket",.          
+00036130: 2020 7333 5f66 6f6c 6465 723d 4e6f 6e65    s3_folder=None
+00036140: 2c0a 2020 2020 2020 2020 2020 2020 7261  ,.            ra
+00036150: 775f 756e 6c6f 6164 5f70 6174 683d 4e6f  w_unload_path=No
+00036160: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+00036170: 6578 706f 7274 5f70 6174 683d 4661 6c73  export_path=Fals
+00036180: 652c 0a20 2020 2020 2020 2020 2020 2064  e,.            d
+00036190: 656c 696d 3d4e 6f6e 652c 0a20 2020 2020  elim=None,.     
+000361a0: 2020 2020 2020 2064 656c 6574 655f 7333         delete_s3
+000361b0: 5f61 6674 6572 3d46 616c 7365 2c0a 2020  _after=False,.  
+000361c0: 2020 2020 2020 2020 2020 7061 7261 6c6c            parall
+000361d0: 656c 5f6f 6666 3d54 7275 652c 0a20 2020  el_off=True,.   
+000361e0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+000361f0: 2323 2063 6865 636b 2074 6861 7420 756e  ## check that un
+00036200: 6c6f 6164 206f 7074 696f 6e73 2061 7265  load options are
+00036210: 206d 6f64 6966 6965 6420 6261 7365 6420   modified based 
+00036220: 6f6e 2073 7570 706c 6965 6420 6172 6773  on supplied args
+00036230: 0a20 2020 2020 2020 206d 6f63 6b5f 756e  .        mock_un
+00036240: 6c6f 6164 2e61 7373 6572 745f 6361 6c6c  load.assert_call
+00036250: 6564 5f77 6974 6828 0a20 2020 2020 2020  ed_with(.       
+00036260: 2020 2020 2071 7565 7279 3d22 7175 6572       query="quer
+00036270: 7922 2c20 7333 7061 7468 3d22 6475 6d6d  y", s3path="dumm
+00036280: 795f 7333 5f70 6174 6822 2c20 756e 6c6f  y_s3_path", unlo
+00036290: 6164 5f6f 7074 696f 6e73 3d5b 2250 4152  ad_options=["PAR
+000362a0: 414c 4c45 4c20 4f46 4622 5d0a 2020 2020  ALLEL OFF"].    
+000362b0: 2020 2020 290a 2020 2020 2020 2020 6173      ).        as
+000362c0: 7365 7274 206e 6f74 206d 6f63 6b5f 6465  sert not mock_de
+000362d0: 6c65 7465 5f6c 6973 745f 6672 6f6d 5f73  lete_list_from_s
+000362e0: 332e 6361 6c6c 6564 0a0a 2020 2020 2020  3.called..      
+000362f0: 2020 2323 0a20 2020 2020 2020 2023 2320    ##.        ## 
+00036300: 5465 7374 2033 3a20 656e 7375 7265 2065  Test 3: ensure e
+00036310: 7863 6570 7469 6f6e 2069 7320 7261 6973  xception is rais
+00036320: 6564 2077 6865 6e20 6e6f 2063 6f6c 756d  ed when no colum
+00036330: 6e20 6e61 6d65 7320 6172 6520 7265 7472  n names are retr
+00036340: 6965 7665 640a 2020 2020 2020 2020 7265  ieved.        re
+00036350: 7365 745f 6d6f 636b 7328 290a 2020 2020  set_mocks().    
+00036360: 2020 2020 6d6f 636b 5f75 6e6c 6f61 645f      mock_unload_
+00036370: 6765 6e65 7261 7465 645f 6669 6c65 732e  generated_files.
+00036380: 7265 7475 726e 5f76 616c 7565 203d 205b  return_value = [
+00036390: 2264 756d 6d79 5f66 696c 6522 5d0a 2020  "dummy_file"].  
+000363a0: 2020 2020 2020 6d6f 636b 5f67 656e 6572        mock_gener
+000363b0: 6174 655f 756e 6c6f 6164 5f70 6174 682e  ate_unload_path.
+000363c0: 7265 7475 726e 5f76 616c 7565 203d 2022  return_value = "
+000363d0: 6475 6d6d 795f 7333 5f70 6174 6822 0a20  dummy_s3_path". 
+000363e0: 2020 2020 2020 206d 6f63 6b5f 6765 745f         mock_get_
+000363f0: 636f 6c5f 6e61 6d65 732e 7265 7475 726e  col_names.return
+00036400: 5f76 616c 7565 203d 204e 6f6e 650a 2020  _value = None.  
+00036410: 2020 2020 2020 7769 7468 2070 7974 6573        with pytes
+00036420: 742e 7261 6973 6573 2845 7863 6570 7469  t.raises(Excepti
+00036430: 6f6e 293a 0a20 2020 2020 2020 2020 2020  on):.           
+00036440: 2072 2e75 6e6c 6f61 645f 616e 645f 636f   r.unload_and_co
+00036450: 7079 2822 7175 6572 7922 2c20 2273 335f  py("query", "s3_
+00036460: 6275 636b 6574 222c 204e 6f6e 6529 0a0a  bucket", None)..
+00036470: 2020 2020 2020 2020 2323 0a20 2020 2020          ##.     
+00036480: 2020 2023 2320 5465 7374 2034 3a20 656e     ## Test 4: en
+00036490: 7375 7265 2065 7863 6570 7469 6f6e 2069  sure exception i
+000364a0: 7320 7261 6973 6564 2077 6865 6e20 6e6f  s raised when no
+000364b0: 2066 696c 6573 2061 7265 2072 6574 7572   files are retur
+000364c0: 6e65 640a 2020 2020 2020 2020 7265 7365  ned.        rese
+000364d0: 745f 6d6f 636b 7328 290a 2020 2020 2020  t_mocks().      
+000364e0: 2020 6d6f 636b 5f67 656e 6572 6174 655f    mock_generate_
+000364f0: 756e 6c6f 6164 5f70 6174 682e 7265 7475  unload_path.retu
+00036500: 726e 5f76 616c 7565 203d 2022 6475 6d6d  rn_value = "dumm
+00036510: 795f 7333 5f70 6174 6822 0a20 2020 2020  y_s3_path".     
+00036520: 2020 206d 6f63 6b5f 6765 745f 636f 6c5f     mock_get_col_
+00036530: 6e61 6d65 732e 7265 7475 726e 5f76 616c  names.return_val
+00036540: 7565 203d 205b 2264 756d 6d79 5f63 6f6c  ue = ["dummy_col
+00036550: 5f6e 616d 6522 5d0a 2020 2020 2020 2020  _name"].        
+00036560: 6d6f 636b 5f75 6e6c 6f61 645f 6765 6e65  mock_unload_gene
+00036570: 7261 7465 645f 6669 6c65 732e 7265 7475  rated_files.retu
+00036580: 726e 5f76 616c 7565 203d 204e 6f6e 650a  rn_value = None.
+00036590: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
+000365a0: 6573 742e 7261 6973 6573 2845 7863 6570  est.raises(Excep
+000365b0: 7469 6f6e 293a 0a20 2020 2020 2020 2020  tion):.         
+000365c0: 2020 2072 2e75 6e6c 6f61 645f 616e 645f     r.unload_and_
+000365d0: 636f 7079 2822 7175 6572 7922 2c20 2273  copy("query", "s
+000365e0: 335f 6275 636b 6574 222c 204e 6f6e 6529  3_bucket", None)
+000365f0: 0a0a 2020 2020 2020 2020 2323 0a20 2020  ..        ##.   
+00036600: 2020 2020 2023 2320 5465 7374 2035 3a20       ## Test 5: 
+00036610: 656e 7375 7265 2066 696c 6520 7772 6974  ensure file writ
+00036620: 696e 6720 6973 2069 6e69 7469 6174 6564  ing is initiated
+00036630: 2077 6865 6e20 6578 706f 7274 5f70 6174   when export_pat
+00036640: 6820 6973 2073 7570 706c 6965 640a 2020  h is supplied.  
+00036650: 2020 2020 2020 7265 7365 745f 6d6f 636b        reset_mock
+00036660: 7328 290a 2020 2020 2020 2020 6d6f 636b  s().        mock
+00036670: 5f67 6574 5f63 6f6c 5f6e 616d 6573 2e72  _get_col_names.r
+00036680: 6574 7572 6e5f 7661 6c75 6520 3d20 5b22  eturn_value = ["
+00036690: 6475 6d6d 795f 636f 6c5f 6e61 6d65 225d  dummy_col_name"]
+000366a0: 0a20 2020 2020 2020 206d 6f63 6b5f 646f  .        mock_do
+000366b0: 776e 6c6f 6164 5f6c 6973 745f 6672 6f6d  wnload_list_from
+000366c0: 5f73 332e 7265 7475 726e 5f76 616c 7565  _s3.return_value
+000366d0: 203d 205b 2273 332e 6669 6c65 225d 0a20   = ["s3.file"]. 
+000366e0: 2020 2020 2020 206d 6f63 6b5f 6765 6e65         mock_gene
+000366f0: 7261 7465 5f75 6e6c 6f61 645f 7061 7468  rate_unload_path
+00036700: 2e72 6574 7572 6e5f 7661 6c75 6520 3d20  .return_value = 
+00036710: 2264 756d 6d79 5f73 335f 7061 7468 220a  "dummy_s3_path".
+00036720: 2020 2020 2020 2020 6d6f 636b 5f75 6e6c          mock_unl
+00036730: 6f61 645f 6765 6e65 7261 7465 645f 6669  oad_generated_fi
+00036740: 6c65 732e 7265 7475 726e 5f76 616c 7565  les.return_value
+00036750: 203d 205b 222f 6475 6d6d 795f 6669 6c65   = ["/dummy_file
+00036760: 225d 0a20 2020 2020 2020 2072 2e75 6e6c  "].        r.unl
+00036770: 6f61 645f 616e 645f 636f 7079 280a 2020  oad_and_copy(.  
+00036780: 2020 2020 2020 2020 2020 7175 6572 793d            query=
+00036790: 2271 7565 7279 222c 0a20 2020 2020 2020  "query",.       
+000367a0: 2020 2020 2073 335f 6275 636b 6574 3d22       s3_bucket="
+000367b0: 7333 5f62 7563 6b65 7422 2c0a 2020 2020  s3_bucket",.    
+000367c0: 2020 2020 2020 2020 7333 5f66 6f6c 6465          s3_folde
+000367d0: 723d 4e6f 6e65 2c0a 2020 2020 2020 2020  r=None,.        
+000367e0: 2020 2020 7261 775f 756e 6c6f 6164 5f70      raw_unload_p
+000367f0: 6174 683d 4e6f 6e65 2c0a 2020 2020 2020  ath=None,.      
+00036800: 2020 2020 2020 6578 706f 7274 5f70 6174        export_pat
+00036810: 683d 226d 795f 6f75 7470 7574 2e63 7376  h="my_output.csv
+00036820: 222c 0a20 2020 2020 2020 2020 2020 2064  ",.            d
+00036830: 656c 696d 3d22 2c22 2c0a 2020 2020 2020  elim=",",.      
+00036840: 2020 2020 2020 6465 6c65 7465 5f73 335f        delete_s3_
+00036850: 6166 7465 723d 5472 7565 2c0a 2020 2020  after=True,.    
+00036860: 2020 2020 2020 2020 7061 7261 6c6c 656c          parallel
+00036870: 5f6f 6666 3d46 616c 7365 2c0a 2020 2020  _off=False,.    
+00036880: 2020 2020 290a 2020 2020 2020 2020 6d6f      ).        mo
+00036890: 636b 5f63 6f6e 6361 742e 6173 7365 7274  ck_concat.assert
+000368a0: 5f63 616c 6c65 645f 7769 7468 286d 6f63  _called_with(moc
+000368b0: 6b5f 646f 776e 6c6f 6164 5f6c 6973 745f  k_download_list_
+000368c0: 6672 6f6d 5f73 332e 7265 7475 726e 5f76  from_s3.return_v
+000368d0: 616c 7565 2c20 226d 795f 6f75 7470 7574  alue, "my_output
+000368e0: 2e63 7376 2229 0a20 2020 2020 2020 2061  .csv").        a
+000368f0: 7373 6572 7420 6d6f 636b 5f77 7269 7465  ssert mock_write
+00036900: 2e63 616c 6c65 640a 2020 2020 2020 2020  .called.        
+00036910: 6173 7365 7274 206d 6f63 6b5f 6465 6c65  assert mock_dele
+00036920: 7465 5f6c 6973 745f 6672 6f6d 5f73 332e  te_list_from_s3.
+00036930: 6361 6c6c 6564 5f77 6974 6828 2273 335f  called_with("s3_
+00036940: 6275 636b 6574 222c 2022 6d79 5f6f 7574  bucket", "my_out
+00036950: 7075 742e 6373 7622 290a 0a20 2020 2020  put.csv")..     
+00036960: 2020 2023 230a 2020 2020 2020 2020 2323     ##.        ##
+00036970: 2054 6573 7420 363a 2072 6177 5f75 6e6c   Test 6: raw_unl
+00036980: 6f61 645f 7061 7468 2063 6865 636b 0a20  oad_path check. 
+00036990: 2020 2020 2020 2072 6573 6574 5f6d 6f63         reset_moc
+000369a0: 6b73 2829 0a20 2020 2020 2020 206d 6f63  ks().        moc
+000369b0: 6b5f 6765 745f 636f 6c5f 6e61 6d65 732e  k_get_col_names.
+000369c0: 7265 7475 726e 5f76 616c 7565 203d 205b  return_value = [
+000369d0: 2264 756d 6d79 5f63 6f6c 5f6e 616d 6522  "dummy_col_name"
+000369e0: 5d0a 2020 2020 2020 2020 6d6f 636b 5f64  ].        mock_d
+000369f0: 6f77 6e6c 6f61 645f 6c69 7374 5f66 726f  ownload_list_fro
+00036a00: 6d5f 7333 2e72 6574 7572 6e5f 7661 6c75  m_s3.return_valu
+00036a10: 6520 3d20 5b22 7333 2e66 696c 6522 5d0a  e = ["s3.file"].
+00036a20: 2020 2020 2020 2020 6d6f 636b 5f67 656e          mock_gen
+00036a30: 6572 6174 655f 756e 6c6f 6164 5f70 6174  erate_unload_pat
+00036a40: 682e 7265 7475 726e 5f76 616c 7565 203d  h.return_value =
+00036a50: 2022 6475 6d6d 795f 7333 5f70 6174 6822   "dummy_s3_path"
+00036a60: 0a20 2020 2020 2020 206d 6f63 6b5f 756e  .        mock_un
+00036a70: 6c6f 6164 5f67 656e 6572 6174 6564 5f66  load_generated_f
+00036a80: 696c 6573 2e72 6574 7572 6e5f 7661 6c75  iles.return_valu
+00036a90: 6520 3d20 5b22 2f64 756d 6d79 5f66 696c  e = ["/dummy_fil
+00036aa0: 6522 5d0a 2020 2020 2020 2020 2323 2065  e"].        ## e
+00036ab0: 6e73 7572 6520 6e6f 7468 696e 6720 6973  nsure nothing is
+00036ac0: 2072 6574 7572 6e65 6420 7768 656e 2072   returned when r
+00036ad0: 6561 643d 4661 6c73 650a 2020 2020 2020  ead=False.      
+00036ae0: 2020 722e 756e 6c6f 6164 5f61 6e64 5f63    r.unload_and_c
+00036af0: 6f70 7928 0a20 2020 2020 2020 2020 2020  opy(.           
+00036b00: 2071 7565 7279 3d22 7175 6572 7922 2c0a   query="query",.
+00036b10: 2020 2020 2020 2020 2020 2020 7333 5f62              s3_b
+00036b20: 7563 6b65 743d 2273 335f 6275 636b 6574  ucket="s3_bucket
+00036b30: 222c 0a20 2020 2020 2020 2020 2020 2073  ",.            s
+00036b40: 335f 666f 6c64 6572 3d4e 6f6e 652c 0a20  3_folder=None,. 
+00036b50: 2020 2020 2020 2020 2020 2072 6177 5f75             raw_u
+00036b60: 6e6c 6f61 645f 7061 7468 3d22 2f73 6f6d  nload_path="/som
+00036b70: 6566 6f6c 6465 722f 222c 0a20 2020 2020  efolder/",.     
+00036b80: 2020 2020 2020 2065 7870 6f72 745f 7061         export_pa
+00036b90: 7468 3d46 616c 7365 2c0a 2020 2020 2020  th=False,.      
+00036ba0: 2020 2020 2020 6465 6c69 6d3d 222c 222c        delim=",",
+00036bb0: 0a20 2020 2020 2020 2020 2020 2064 656c  .            del
+00036bc0: 6574 655f 7333 5f61 6674 6572 3d46 616c  ete_s3_after=Fal
+00036bd0: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
+00036be0: 7061 7261 6c6c 656c 5f6f 6666 3d46 616c  parallel_off=Fal
+00036bf0: 7365 2c0a 2020 2020 2020 2020 290a 2020  se,.        ).  
+00036c00: 2020 2020 2020 6d6f 636b 5f64 6f77 6e6c        mock_downl
+00036c10: 6f61 645f 6c69 7374 5f66 726f 6d5f 7333  oad_list_from_s3
+00036c20: 2e61 7373 6572 745f 6361 6c6c 6564 5f77  .assert_called_w
+00036c30: 6974 6828 5b22 2f64 756d 6d79 5f66 696c  ith(["/dummy_fil
+00036c40: 6522 5d2c 2022 2f73 6f6d 6566 6f6c 6465  e"], "/somefolde
+00036c50: 722f 2229 0a0a 0a40 7079 7465 7374 2e6d  r/")...@pytest.m
+00036c60: 6172 6b2e 7061 7261 6d65 7472 697a 6528  ark.parametrize(
+00036c70: 2264 6261 7069 222c 2044 4241 5049 5329  "dbapi", DBAPIS)
+00036c80: 0a40 6d6f 636b 2e70 6174 6368 2822 6c6f  .@mock.patch("lo
+00036c90: 636f 7079 2e73 332e 5365 7373 696f 6e22  copy.s3.Session"
+00036ca0: 290a 6465 6620 7465 7374 5f75 6e6c 6f61  ).def test_unloa
+00036cb0: 645f 6765 6e65 7261 7465 645f 6669 6c65  d_generated_file
+00036cc0: 7328 6d6f 636b 5f73 6573 7369 6f6e 2c20  s(mock_session, 
+00036cd0: 6372 6564 656e 7469 616c 732c 2064 6261  credentials, dba
+00036ce0: 7069 293a 0a20 2020 2077 6974 6820 6d6f  pi):.    with mo
+00036cf0: 636b 2e70 6174 6368 2864 6261 7069 2e5f  ck.patch(dbapi._
+00036d00: 5f6e 616d 655f 5f20 2b20 222e 636f 6e6e  _name__ + ".conn
+00036d10: 6563 7422 2920 6173 206d 6f63 6b5f 636f  ect") as mock_co
+00036d20: 6e6e 6563 743a 0a20 2020 2020 2020 2072  nnect:.        r
+00036d30: 203d 206c 6f63 6f70 792e 5265 6473 6869   = locopy.Redshi
+00036d40: 6674 2864 6261 7069 3d64 6261 7069 2c20  ft(dbapi=dbapi, 
+00036d50: 2a2a 6372 6564 656e 7469 616c 7329 0a20  **credentials). 
+00036d60: 2020 2020 2020 2072 2e63 6f6e 6e65 6374         r.connect
+00036d70: 2829 0a20 2020 2020 2020 2072 2e5f 756e  ().        r._un
+00036d80: 6c6f 6164 5f67 656e 6572 6174 6564 5f66  load_generated_f
+00036d90: 696c 6573 2829 0a20 2020 2020 2020 2061  iles().        a
+00036da0: 7373 6572 7420 722e 5f75 6e6c 6f61 645f  ssert r._unload_
+00036db0: 6765 6e65 7261 7465 645f 6669 6c65 7328  generated_files(
+00036dc0: 2920 3d3d 204e 6f6e 650a 0a20 2020 2020  ) == None..     
+00036dd0: 2020 206d 6f63 6b5f 636f 6e6e 6563 742e     mock_connect.
+00036de0: 7265 7475 726e 5f76 616c 7565 2e63 7572  return_value.cur
+00036df0: 736f 722e 7265 7475 726e 5f76 616c 7565  sor.return_value
+00036e00: 2e66 6574 6368 616c 6c2e 7265 7475 726e  .fetchall.return
+00036e10: 5f76 616c 7565 203d 205b 0a20 2020 2020  _value = [.     
+00036e20: 2020 2020 2020 205b 2246 696c 6531 2022         ["File1 "
+00036e30: 5d2c 0a20 2020 2020 2020 2020 2020 205b  ],.            [
+00036e40: 2246 696c 6532 2022 5d2c 0a20 2020 2020  "File2 "],.     
+00036e50: 2020 205d 0a20 2020 2020 2020 2072 203d     ].        r =
+00036e60: 206c 6f63 6f70 792e 5265 6473 6869 6674   locopy.Redshift
+00036e70: 2864 6261 7069 3d64 6261 7069 2c20 2a2a  (dbapi=dbapi, **
+00036e80: 6372 6564 656e 7469 616c 7329 0a20 2020  credentials).   
+00036e90: 2020 2020 2072 2e63 6f6e 6e65 6374 2829       r.connect()
+00036ea0: 0a20 2020 2020 2020 2072 2e5f 756e 6c6f  .        r._unlo
+00036eb0: 6164 5f67 656e 6572 6174 6564 5f66 696c  ad_generated_fil
+00036ec0: 6573 2829 0a20 2020 2020 2020 2061 7373  es().        ass
+00036ed0: 6572 7420 722e 5f75 6e6c 6f61 645f 6765  ert r._unload_ge
+00036ee0: 6e65 7261 7465 645f 6669 6c65 7328 2920  nerated_files() 
+00036ef0: 3d3d 205b 2246 696c 6531 222c 2022 4669  == ["File1", "Fi
+00036f00: 6c65 3222 5d0a 0a20 2020 2020 2020 206d  le2"]..        m
+00036f10: 6f63 6b5f 636f 6e6e 6563 742e 7265 7475  ock_connect.retu
+00036f20: 726e 5f76 616c 7565 2e63 7572 736f 722e  rn_value.cursor.
+00036f30: 7265 7475 726e 5f76 616c 7565 2e65 7865  return_value.exe
+00036f40: 6375 7465 2e73 6964 655f 6566 6665 6374  cute.side_effect
+00036f50: 203d 2045 7863 6570 7469 6f6e 2829 0a20   = Exception(). 
+00036f60: 2020 2020 2020 2072 203d 206c 6f63 6f70         r = locop
+00036f70: 792e 5265 6473 6869 6674 2864 6261 7069  y.Redshift(dbapi
+00036f80: 3d64 6261 7069 2c20 2a2a 6372 6564 656e  =dbapi, **creden
+00036f90: 7469 616c 7329 0a20 2020 2020 2020 2072  tials).        r
+00036fa0: 2e63 6f6e 6e65 6374 2829 0a20 2020 2020  .connect().     
+00036fb0: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
+00036fc0: 6169 7365 7328 4578 6365 7074 696f 6e29  aises(Exception)
+00036fd0: 3a0a 2020 2020 2020 2020 2020 2020 722e  :.            r.
+00036fe0: 5f75 6e6c 6f61 645f 6765 6e65 7261 7465  _unload_generate
+00036ff0: 645f 6669 6c65 7328 290a 0a0a 4070 7974  d_files()...@pyt
+00037000: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
+00037010: 7269 7a65 2822 6462 6170 6922 2c20 4442  rize("dbapi", DB
+00037020: 4150 4953 290a 406d 6f63 6b2e 7061 7463  APIS).@mock.patc
+00037030: 6828 226c 6f63 6f70 792e 7333 2e53 6573  h("locopy.s3.Ses
+00037040: 7369 6f6e 2229 0a64 6566 2074 6573 745f  sion").def test_
+00037050: 6765 745f 636f 6c75 6d6e 5f6e 616d 6573  get_column_names
+00037060: 286d 6f63 6b5f 7365 7373 696f 6e2c 2063  (mock_session, c
+00037070: 7265 6465 6e74 6961 6c73 2c20 6462 6170  redentials, dbap
+00037080: 6929 3a0a 2020 2020 7769 7468 206d 6f63  i):.    with moc
+00037090: 6b2e 7061 7463 6828 6462 6170 692e 5f5f  k.patch(dbapi.__
+000370a0: 6e61 6d65 5f5f 202b 2022 2e63 6f6e 6e65  name__ + ".conne
+000370b0: 6374 2229 2061 7320 6d6f 636b 5f63 6f6e  ct") as mock_con
+000370c0: 6e65 6374 3a0a 2020 2020 2020 2020 7220  nect:.        r 
+000370d0: 3d20 6c6f 636f 7079 2e52 6564 7368 6966  = locopy.Redshif
+000370e0: 7428 6462 6170 693d 6462 6170 692c 202a  t(dbapi=dbapi, *
+000370f0: 2a63 7265 6465 6e74 6961 6c73 290a 2020  *credentials).  
+00037100: 2020 2020 2020 722e 636f 6e6e 6563 7428        r.connect(
+00037110: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00037120: 2072 2e5f 6765 745f 636f 6c75 6d6e 5f6e   r._get_column_n
+00037130: 616d 6573 2822 7175 6572 7922 2920 3d3d  ames("query") ==
+00037140: 204e 6f6e 650a 2020 2020 2020 2020 7371   None.        sq
+00037150: 6c20 3d20 2253 454c 4543 5420 2a20 4652  l = "SELECT * FR
+00037160: 4f4d 2028 7175 6572 7929 2057 4845 5245  OM (query) WHERE
+00037170: 2031 203d 2030 220a 2020 2020 2020 2020   1 = 0".        
+00037180: 6173 7365 7274 206d 6f63 6b5f 636f 6e6e  assert mock_conn
+00037190: 6563 742e 7265 7475 726e 5f76 616c 7565  ect.return_value
+000371a0: 2e63 7572 736f 722e 7265 7475 726e 5f76  .cursor.return_v
+000371b0: 616c 7565 2e65 7865 6375 7465 2e63 616c  alue.execute.cal
+000371c0: 6c65 645f 7769 7468 2873 716c 2c20 2829  led_with(sql, ()
+000371d0: 290a 0a20 2020 2020 2020 206d 6f63 6b5f  )..        mock_
+000371e0: 636f 6e6e 6563 742e 7265 7475 726e 5f76  connect.return_v
+000371f0: 616c 7565 2e63 7572 736f 722e 7265 7475  alue.cursor.retu
+00037200: 726e 5f76 616c 7565 2e64 6573 6372 6970  rn_value.descrip
+00037210: 7469 6f6e 203d 205b 5b22 434f 4c31 2022  tion = [["COL1 "
+00037220: 5d2c 205b 2243 4f4c 3220 225d 5d0a 2020  ], ["COL2 "]].  
+00037230: 2020 2020 2020 7220 3d20 6c6f 636f 7079        r = locopy
+00037240: 2e52 6564 7368 6966 7428 6462 6170 693d  .Redshift(dbapi=
+00037250: 6462 6170 692c 202a 2a63 7265 6465 6e74  dbapi, **credent
+00037260: 6961 6c73 290a 2020 2020 2020 2020 722e  ials).        r.
+00037270: 636f 6e6e 6563 7428 290a 2020 2020 2020  connect().      
+00037280: 2020 6173 7365 7274 2072 2e5f 6765 745f    assert r._get_
+00037290: 636f 6c75 6d6e 5f6e 616d 6573 2822 7175  column_names("qu
+000372a0: 6572 7922 2920 3d3d 205b 2243 4f4c 3122  ery") == ["COL1"
+000372b0: 2c20 2243 4f4c 3222 5d0a 0a20 2020 2020  , "COL2"]..     
+000372c0: 2020 206d 6f63 6b5f 636f 6e6e 6563 742e     mock_connect.
+000372d0: 7265 7475 726e 5f76 616c 7565 2e63 7572  return_value.cur
+000372e0: 736f 722e 7265 7475 726e 5f76 616c 7565  sor.return_value
+000372f0: 2e65 7865 6375 7465 2e73 6964 655f 6566  .execute.side_ef
+00037300: 6665 6374 203d 2045 7863 6570 7469 6f6e  fect = Exception
+00037310: 2829 0a20 2020 2020 2020 2072 203d 206c  ().        r = l
+00037320: 6f63 6f70 792e 5265 6473 6869 6674 2864  ocopy.Redshift(d
+00037330: 6261 7069 3d64 6261 7069 2c20 2a2a 6372  bapi=dbapi, **cr
+00037340: 6564 656e 7469 616c 7329 0a20 2020 2020  edentials).     
+00037350: 2020 2072 2e63 6f6e 6e65 6374 2829 0a20     r.connect(). 
+00037360: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
+00037370: 7374 2e72 6169 7365 7328 4578 6365 7074  st.raises(Except
+00037380: 696f 6e29 3a0a 2020 2020 2020 2020 2020  ion):.          
+00037390: 2020 722e 5f67 6574 5f63 6f6c 756d 6e5f    r._get_column_
+000373a0: 6e61 6d65 7328 2271 7565 7279 2229 0a0a  names("query")..
+000373b0: 0a40 7079 7465 7374 2e6d 6172 6b2e 7061  .@pytest.mark.pa
+000373c0: 7261 6d65 7472 697a 6528 2264 6261 7069  rametrize("dbapi
+000373d0: 222c 2044 4241 5049 5329 0a40 6d6f 636b  ", DBAPIS).@mock
+000373e0: 2e70 6174 6368 2822 6c6f 636f 7079 2e73  .patch("locopy.s
+000373f0: 332e 5365 7373 696f 6e22 290a 6465 6620  3.Session").def 
+00037400: 7465 7374 756e 6c6f 6164 286d 6f63 6b5f  testunload(mock_
+00037410: 7365 7373 696f 6e2c 2063 7265 6465 6e74  session, credent
+00037420: 6961 6c73 2c20 6462 6170 6929 3a0a 2020  ials, dbapi):.  
+00037430: 2020 7769 7468 206d 6f63 6b2e 7061 7463    with mock.patc
+00037440: 6828 6462 6170 692e 5f5f 6e61 6d65 5f5f  h(dbapi.__name__
+00037450: 202b 2022 2e63 6f6e 6e65 6374 2229 2061   + ".connect") a
+00037460: 7320 6d6f 636b 5f63 6f6e 6e65 6374 3a0a  s mock_connect:.
+00037470: 2020 2020 2020 2020 7220 3d20 6c6f 636f          r = loco
+00037480: 7079 2e52 6564 7368 6966 7428 6462 6170  py.Redshift(dbap
+00037490: 693d 6462 6170 692c 202a 2a63 7265 6465  i=dbapi, **crede
+000374a0: 6e74 6961 6c73 290a 2020 2020 2020 2020  ntials).        
+000374b0: 722e 636f 6e6e 6563 7428 290a 2020 2020  r.connect().    
+000374c0: 2020 2020 722e 756e 6c6f 6164 2822 7175      r.unload("qu
+000374d0: 6572 7922 2c20 2270 6174 6822 290a 2020  ery", "path").  
+000374e0: 2020 2020 2020 6173 7365 7274 206d 6f63        assert moc
+000374f0: 6b5f 636f 6e6e 6563 742e 7265 7475 726e  k_connect.return
+00037500: 5f76 616c 7565 2e63 7572 736f 722e 7265  _value.cursor.re
+00037510: 7475 726e 5f76 616c 7565 2e65 7865 6375  turn_value.execu
+00037520: 7465 2e63 616c 6c65 640a 0a0a 4070 7974  te.called...@pyt
+00037530: 6573 742e 6d61 726b 2e70 6172 616d 6574  est.mark.paramet
+00037540: 7269 7a65 2822 6462 6170 6922 2c20 4442  rize("dbapi", DB
+00037550: 4150 4953 290a 406d 6f63 6b2e 7061 7463  APIS).@mock.patc
+00037560: 6828 226c 6f63 6f70 792e 7333 2e53 6573  h("locopy.s3.Ses
+00037570: 7369 6f6e 2229 0a64 6566 2074 6573 7475  sion").def testu
+00037580: 6e6c 6f61 645f 6e6f 5f63 6f6e 6e65 6374  nload_no_connect
+00037590: 696f 6e28 6d6f 636b 5f73 6573 7369 6f6e  ion(mock_session
+000375a0: 2c20 6372 6564 656e 7469 616c 732c 2064  , credentials, d
+000375b0: 6261 7069 293a 0a20 2020 2077 6974 6820  bapi):.    with 
+000375c0: 6d6f 636b 2e70 6174 6368 2864 6261 7069  mock.patch(dbapi
+000375d0: 2e5f 5f6e 616d 655f 5f20 2b20 222e 636f  .__name__ + ".co
+000375e0: 6e6e 6563 7422 2920 6173 206d 6f63 6b5f  nnect") as mock_
+000375f0: 636f 6e6e 6563 743a 0a20 2020 2020 2020  connect:.       
+00037600: 2072 203d 206c 6f63 6f70 792e 5265 6473   r = locopy.Reds
+00037610: 6869 6674 2864 6261 7069 3d64 6261 7069  hift(dbapi=dbapi
+00037620: 2c20 2a2a 6372 6564 656e 7469 616c 7329  , **credentials)
+00037630: 0a20 2020 2020 2020 2077 6974 6820 7079  .        with py
+00037640: 7465 7374 2e72 6169 7365 7328 4578 6365  test.raises(Exce
+00037650: 7074 696f 6e29 3a0a 2020 2020 2020 2020  ption):.        
+00037660: 2020 2020 722e 756e 6c6f 6164 2822 7175      r.unload("qu
+00037670: 6572 7922 2c20 2270 6174 6822 290a 0a20  ery", "path").. 
+00037680: 2020 2020 2020 206d 6f63 6b5f 636f 6e6e         mock_conn
+00037690: 6563 742e 7265 7475 726e 5f76 616c 7565  ect.return_value
+000376a0: 2e63 7572 736f 722e 7265 7475 726e 5f76  .cursor.return_v
+000376b0: 616c 7565 2e65 7865 6375 7465 2e73 6964  alue.execute.sid
+000376c0: 655f 6566 6665 6374 203d 2045 7863 6570  e_effect = Excep
+000376d0: 7469 6f6e 2829 0a20 2020 2020 2020 2072  tion().        r
+000376e0: 203d 206c 6f63 6f70 792e 5265 6473 6869   = locopy.Redshi
+000376f0: 6674 2864 6261 7069 3d64 6261 7069 2c20  ft(dbapi=dbapi, 
+00037700: 2a2a 6372 6564 656e 7469 616c 7329 0a20  **credentials). 
+00037710: 2020 2020 2020 2072 2e63 6f6e 6e65 6374         r.connect
+00037720: 2829 0a20 2020 2020 2020 2077 6974 6820  ().        with 
+00037730: 7079 7465 7374 2e72 6169 7365 7328 4578  pytest.raises(Ex
+00037740: 6365 7074 696f 6e29 3a0a 2020 2020 2020  ception):.      
+00037750: 2020 2020 2020 722e 756e 6c6f 6164 2822        r.unload("
+00037760: 7175 6572 7922 2c20 2270 6174 6822 290a  query", "path").
+00037770: 0a0a 4070 7974 6573 742e 6d61 726b 2e70  ..@pytest.mark.p
+00037780: 6172 616d 6574 7269 7a65 2822 6462 6170  arametrize("dbap
+00037790: 6922 2c20 4442 4150 4953 290a 406d 6f63  i", DBAPIS).@moc
+000377a0: 6b2e 7061 7463 6828 226c 6f63 6f70 792e  k.patch("locopy.
+000377b0: 7333 2e53 6573 7369 6f6e 2229 0a64 6566  s3.Session").def
+000377c0: 2074 6573 7469 6e73 6572 745f 6461 7461   testinsert_data
+000377d0: 6672 616d 655f 746f 5f74 6162 6c65 286d  frame_to_table(m
+000377e0: 6f63 6b5f 7365 7373 696f 6e2c 2063 7265  ock_session, cre
+000377f0: 6465 6e74 6961 6c73 2c20 6462 6170 6929  dentials, dbapi)
+00037800: 3a0a 2020 2020 696d 706f 7274 2070 616e  :.    import pan
+00037810: 6461 7320 6173 2070 640a 0a20 2020 2074  das as pd..    t
+00037820: 6573 745f 6466 203d 2070 642e 7265 6164  est_df = pd.read
+00037830: 5f63 7376 286f 732e 7061 7468 2e6a 6f69  _csv(os.path.joi
+00037840: 6e28 4355 5252 5f44 4952 2c20 2264 6174  n(CURR_DIR, "dat
+00037850: 6122 2c20 226d 6f63 6b5f 6461 7461 6672  a", "mock_datafr
+00037860: 616d 652e 7478 7422 292c 2073 6570 3d22  ame.txt"), sep="
+00037870: 2c22 290a 2020 2020 7769 7468 206d 6f63  ,").    with moc
+00037880: 6b2e 7061 7463 6828 6462 6170 692e 5f5f  k.patch(dbapi.__
+00037890: 6e61 6d65 5f5f 202b 2022 2e63 6f6e 6e65  name__ + ".conne
+000378a0: 6374 2229 2061 7320 6d6f 636b 5f63 6f6e  ct") as mock_con
+000378b0: 6e65 6374 3a0a 2020 2020 2020 2020 7220  nect:.        r 
+000378c0: 3d20 6c6f 636f 7079 2e52 6564 7368 6966  = locopy.Redshif
+000378d0: 7428 6462 6170 693d 6462 6170 692c 202a  t(dbapi=dbapi, *
+000378e0: 2a63 7265 6465 6e74 6961 6c73 290a 2020  *credentials).  
+000378f0: 2020 2020 2020 722e 636f 6e6e 6563 7428        r.connect(
+00037900: 290a 2020 2020 2020 2020 722e 696e 7365  ).        r.inse
+00037910: 7274 5f64 6174 6166 7261 6d65 5f74 6f5f  rt_dataframe_to_
+00037920: 7461 626c 6528 7465 7374 5f64 662c 2022  table(test_df, "
+00037930: 6461 7461 6261 7365 2e73 6368 656d 612e  database.schema.
+00037940: 7465 7374 2229 0a20 2020 2020 2020 206d  test").        m
+00037950: 6f63 6b5f 636f 6e6e 6563 742e 7265 7475  ock_connect.retu
+00037960: 726e 5f76 616c 7565 2e63 7572 736f 722e  rn_value.cursor.
+00037970: 7265 7475 726e 5f76 616c 7565 2e65 7865  return_value.exe
+00037980: 6375 7465 2e61 7373 6572 745f 6361 6c6c  cute.assert_call
+00037990: 6564 5f77 6974 6828 0a20 2020 2020 2020  ed_with(.       
+000379a0: 2020 2020 2022 494e 5345 5254 2049 4e54       "INSERT INT
+000379b0: 4f20 6461 7461 6261 7365 2e73 6368 656d  O database.schem
+000379c0: 612e 7465 7374 2028 612c 622c 6329 2056  a.test (a,b,c) V
+000379d0: 414c 5545 5320 2827 3127 2c20 2778 272c  ALUES ('1', 'x',
+000379e0: 2027 3230 3131 2d30 312d 3031 2729 2c20   '2011-01-01'), 
+000379f0: 2827 3227 2c20 2779 272c 2027 3230 3031  ('2', 'y', '2001
+00037a00: 2d30 342d 3032 2729 222c 0a20 2020 2020  -04-02')",.     
+00037a10: 2020 2020 2020 2028 292c 0a20 2020 2020         (),.     
+00037a20: 2020 2029 0a0a 2020 2020 2020 2020 722e     )..        r.
+00037a30: 696e 7365 7274 5f64 6174 6166 7261 6d65  insert_dataframe
+00037a40: 5f74 6f5f 7461 626c 6528 7465 7374 5f64  _to_table(test_d
+00037a50: 662c 2022 6461 7461 6261 7365 2e73 6368  f, "database.sch
+00037a60: 656d 612e 7465 7374 222c 2063 7265 6174  ema.test", creat
+00037a70: 653d 5472 7565 290a 2020 2020 2020 2020  e=True).        
+00037a80: 6d6f 636b 5f63 6f6e 6e65 6374 2e72 6574  mock_connect.ret
+00037a90: 7572 6e5f 7661 6c75 652e 6375 7273 6f72  urn_value.cursor
+00037aa0: 2e72 6574 7572 6e5f 7661 6c75 652e 6578  .return_value.ex
+00037ab0: 6563 7574 652e 6173 7365 7274 5f61 6e79  ecute.assert_any
+00037ac0: 5f63 616c 6c28 0a20 2020 2020 2020 2020  _call(.         
+00037ad0: 2020 2022 4352 4541 5445 2054 4142 4c45     "CREATE TABLE
+00037ae0: 2064 6174 6162 6173 652e 7363 6865 6d61   database.schema
+00037af0: 2e74 6573 7420 2861 2069 6e74 2c62 2076  .test (a int,b v
+00037b00: 6172 6368 6172 2c63 2064 6174 6529 222c  archar,c date)",
+00037b10: 2028 290a 2020 2020 2020 2020 290a 2020   ().        ).  
+00037b20: 2020 2020 2020 6d6f 636b 5f63 6f6e 6e65        mock_conne
+00037b30: 6374 2e72 6574 7572 6e5f 7661 6c75 652e  ct.return_value.
+00037b40: 6375 7273 6f72 2e72 6574 7572 6e5f 7661  cursor.return_va
+00037b50: 6c75 652e 6578 6563 7574 652e 6173 7365  lue.execute.asse
+00037b60: 7274 5f63 616c 6c65 645f 7769 7468 280a  rt_called_with(.
+00037b70: 2020 2020 2020 2020 2020 2020 2249 4e53              "INS
+00037b80: 4552 5420 494e 544f 2064 6174 6162 6173  ERT INTO databas
+00037b90: 652e 7363 6865 6d61 2e74 6573 7420 2861  e.schema.test (a
+00037ba0: 2c62 2c63 2920 5641 4c55 4553 2028 2731  ,b,c) VALUES ('1
+00037bb0: 272c 2027 7827 2c20 2732 3031 312d 3031  ', 'x', '2011-01
+00037bc0: 2d30 3127 292c 2028 2732 272c 2027 7927  -01'), ('2', 'y'
+00037bd0: 2c20 2732 3030 312d 3034 2d30 3227 2922  , '2001-04-02')"
+00037be0: 2c0a 2020 2020 2020 2020 2020 2020 2829  ,.            ()
+00037bf0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+00037c00: 2020 2020 2072 2e69 6e73 6572 745f 6461       r.insert_da
+00037c10: 7461 6672 616d 655f 746f 5f74 6162 6c65  taframe_to_table
+00037c20: 2874 6573 745f 6466 2c20 2264 6174 6162  (test_df, "datab
+00037c30: 6173 652e 7363 6865 6d61 2e74 6573 7422  ase.schema.test"
+00037c40: 2c20 636f 6c75 6d6e 733d 5b22 6122 2c20  , columns=["a", 
+00037c50: 2262 225d 290a 0a20 2020 2020 2020 206d  "b"])..        m
+00037c60: 6f63 6b5f 636f 6e6e 6563 742e 7265 7475  ock_connect.retu
+00037c70: 726e 5f76 616c 7565 2e63 7572 736f 722e  rn_value.cursor.
+00037c80: 7265 7475 726e 5f76 616c 7565 2e65 7865  return_value.exe
+00037c90: 6375 7465 2e61 7373 6572 745f 6361 6c6c  cute.assert_call
+00037ca0: 6564 5f77 6974 6828 0a20 2020 2020 2020  ed_with(.       
+00037cb0: 2020 2020 2022 494e 5345 5254 2049 4e54       "INSERT INT
+00037cc0: 4f20 6461 7461 6261 7365 2e73 6368 656d  O database.schem
+00037cd0: 612e 7465 7374 2028 612c 6229 2056 414c  a.test (a,b) VAL
+00037ce0: 5545 5320 2827 3127 2c20 2778 2729 2c20  UES ('1', 'x'), 
+00037cf0: 2827 3227 2c20 2779 2729 222c 2028 290a  ('2', 'y')", ().
+00037d00: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00037d10: 2020 2072 2e69 6e73 6572 745f 6461 7461     r.insert_data
+00037d20: 6672 616d 655f 746f 5f74 6162 6c65 280a  frame_to_table(.
+00037d30: 2020 2020 2020 2020 2020 2020 7465 7374              test
+00037d40: 5f64 662c 0a20 2020 2020 2020 2020 2020  _df,.           
+00037d50: 2022 6461 7461 6261 7365 2e73 6368 656d   "database.schem
+00037d60: 612e 7465 7374 222c 0a20 2020 2020 2020  a.test",.       
+00037d70: 2020 2020 2063 7265 6174 653d 5472 7565       create=True
+00037d80: 2c0a 2020 2020 2020 2020 2020 2020 6d65  ,.            me
+00037d90: 7461 6461 7461 3d4f 7264 6572 6564 4469  tadata=OrderedDi
+00037da0: 6374 285b 2822 636f 6c31 222c 2022 696e  ct([("col1", "in
+00037db0: 7422 292c 2028 2263 6f6c 3222 2c20 2276  t"), ("col2", "v
+00037dc0: 6172 6368 6172 2229 2c20 2822 636f 6c33  archar"), ("col3
+00037dd0: 222c 2022 6461 7465 2229 5d29 2c0a 2020  ", "date")]),.  
+00037de0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00037df0: 206d 6f63 6b5f 636f 6e6e 6563 742e 7265   mock_connect.re
+00037e00: 7475 726e 5f76 616c 7565 2e63 7572 736f  turn_value.curso
+00037e10: 722e 7265 7475 726e 5f76 616c 7565 2e65  r.return_value.e
+00037e20: 7865 6375 7465 2e61 7373 6572 745f 616e  xecute.assert_an
+00037e30: 795f 6361 6c6c 280a 2020 2020 2020 2020  y_call(.        
+00037e40: 2020 2020 2243 5245 4154 4520 5441 424c      "CREATE TABL
+00037e50: 4520 6461 7461 6261 7365 2e73 6368 656d  E database.schem
+00037e60: 612e 7465 7374 2028 636f 6c31 2069 6e74  a.test (col1 int
+00037e70: 2c63 6f6c 3220 7661 7263 6861 722c 636f  ,col2 varchar,co
+00037e80: 6c33 2064 6174 6529 222c 2028 290a 2020  l3 date)", ().  
+00037e90: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00037ea0: 6d6f 636b 5f63 6f6e 6e65 6374 2e72 6574  mock_connect.ret
+00037eb0: 7572 6e5f 7661 6c75 652e 6375 7273 6f72  urn_value.cursor
+00037ec0: 2e72 6574 7572 6e5f 7661 6c75 652e 6578  .return_value.ex
+00037ed0: 6563 7574 652e 6173 7365 7274 5f63 616c  ecute.assert_cal
+00037ee0: 6c65 645f 7769 7468 280a 2020 2020 2020  led_with(.      
+00037ef0: 2020 2020 2020 2249 4e53 4552 5420 494e        "INSERT IN
+00037f00: 544f 2064 6174 6162 6173 652e 7363 6865  TO database.sche
+00037f10: 6d61 2e74 6573 7420 2863 6f6c 312c 636f  ma.test (col1,co
+00037f20: 6c32 2c63 6f6c 3329 2056 414c 5545 5320  l2,col3) VALUES 
+00037f30: 2827 3127 2c20 2778 272c 2027 3230 3131  ('1', 'x', '2011
+00037f40: 2d30 312d 3031 2729 2c20 2827 3227 2c20  -01-01'), ('2', 
+00037f50: 2779 272c 2027 3230 3031 2d30 342d 3032  'y', '2001-04-02
+00037f60: 2729 222c 0a20 2020 2020 2020 2020 2020  ')",.           
+00037f70: 2028 292c 0a20 2020 2020 2020 2029 0a0a   (),.        )..
+00037f80: 2020 2020 2020 2020 722e 696e 7365 7274          r.insert
+00037f90: 5f64 6174 6166 7261 6d65 5f74 6f5f 7461  _dataframe_to_ta
+00037fa0: 626c 6528 7465 7374 5f64 662c 2022 6461  ble(test_df, "da
+00037fb0: 7461 6261 7365 2e73 6368 656d 612e 7465  tabase.schema.te
+00037fc0: 7374 222c 2063 7265 6174 653d 4661 6c73  st", create=Fals
+00037fd0: 652c 2062 6174 6368 5f73 697a 653d 3129  e, batch_size=1)
+00037fe0: 0a0a 2020 2020 2020 2020 6d6f 636b 5f63  ..        mock_c
+00037ff0: 6f6e 6e65 6374 2e72 6574 7572 6e5f 7661  onnect.return_va
+00038000: 6c75 652e 6375 7273 6f72 2e72 6574 7572  lue.cursor.retur
+00038010: 6e5f 7661 6c75 652e 6578 6563 7574 652e  n_value.execute.
+00038020: 6173 7365 7274 5f61 6e79 5f63 616c 6c28  assert_any_call(
+00038030: 0a20 2020 2020 2020 2020 2020 2022 494e  .            "IN
+00038040: 5345 5254 2049 4e54 4f20 6461 7461 6261  SERT INTO databa
+00038050: 7365 2e73 6368 656d 612e 7465 7374 2028  se.schema.test (
+00038060: 612c 622c 6329 2056 414c 5545 5320 2827  a,b,c) VALUES ('
+00038070: 3127 2c20 2778 272c 2027 3230 3131 2d30  1', 'x', '2011-0
+00038080: 312d 3031 2729 222c 2028 290a 2020 2020  1-01')", ().    
+00038090: 2020 2020 290a 2020 2020 2020 2020 6d6f      ).        mo
+000380a0: 636b 5f63 6f6e 6e65 6374 2e72 6574 7572  ck_connect.retur
+000380b0: 6e5f 7661 6c75 652e 6375 7273 6f72 2e72  n_value.cursor.r
+000380c0: 6574 7572 6e5f 7661 6c75 652e 6578 6563  eturn_value.exec
+000380d0: 7574 652e 6173 7365 7274 5f61 6e79 5f63  ute.assert_any_c
+000380e0: 616c 6c28 0a20 2020 2020 2020 2020 2020  all(.           
+000380f0: 2022 494e 5345 5254 2049 4e54 4f20 6461   "INSERT INTO da
+00038100: 7461 6261 7365 2e73 6368 656d 612e 7465  tabase.schema.te
+00038110: 7374 2028 612c 622c 6329 2056 414c 5545  st (a,b,c) VALUE
+00038120: 5320 2827 3227 2c20 2779 272c 2027 3230  S ('2', 'y', '20
+00038130: 3031 2d30 342d 3032 2729 222c 2028 290a  01-04-02')", ().
+00038140: 2020 2020 2020 2020 290a 0000 0000 0000          ).......
+00038150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000381a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000381b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000381c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000381d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000381e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000381f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038200: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00038210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038260: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00038270: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00038280: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00038290: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+000382a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000382b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000382c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000382d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000382e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000382f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038300: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00038310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038340: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00038350: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00038360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000383a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000383b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000383c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000383d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000383e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000383f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038400: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+00038410: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
+00038420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000384a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000384b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000384c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000384d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000384e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000384f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000385a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000385b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000385c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000385d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000385e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000385f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038600: 6c6f 636f 7079 2d30 2e35 2e31 2f74 6573  locopy-0.5.1/tes
+00038610: 7473 2f74 6573 745f 7333 2e70 7900 0000  ts/test_s3.py...
+00038620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038660: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00038670: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00038680: 3030 3336 3532 3200 3030 3030 3030 3030  0036522.00000000
+00038690: 3030 3000 3031 3637 3334 0020 3000 0000  000.016734. 0...
+000386a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000386b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000386c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000386d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000386e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000386f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038700: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00038710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038720: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00038730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00038750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00038760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000387a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000387b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000387c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000387d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000387e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000387f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00038800: 2320 4d49 5420 4c69 6365 6e73 650a 230a  # MIT License.#.
+00038810: 2320 436f 7079 7269 6768 7420 2863 2920  # Copyright (c) 
+00038820: 3230 3138 2043 6170 6974 616c 204f 6e65  2018 Capital One
+00038830: 2053 6572 7669 6365 732c 204c 4c43 0a23   Services, LLC.#
+00038840: 0a23 2050 6572 6d69 7373 696f 6e20 6973  .# Permission is
+00038850: 2068 6572 6562 7920 6772 616e 7465 642c   hereby granted,
+00038860: 2066 7265 6520 6f66 2063 6861 7267 652c   free of charge,
+00038870: 2074 6f20 616e 7920 7065 7273 6f6e 206f   to any person o
+00038880: 6274 6169 6e69 6e67 2061 2063 6f70 790a  btaining a copy.
+00038890: 2320 6f66 2074 6869 7320 736f 6674 7761  # of this softwa
+000388a0: 7265 2061 6e64 2061 7373 6f63 6961 7465  re and associate
+000388b0: 6420 646f 6375 6d65 6e74 6174 696f 6e20  d documentation 
+000388c0: 6669 6c65 7320 2874 6865 2022 536f 6674  files (the "Soft
+000388d0: 7761 7265 2229 2c20 746f 2064 6561 6c0a  ware"), to deal.
+000388e0: 2320 696e 2074 6865 2053 6f66 7477 6172  # in the Softwar
+000388f0: 6520 7769 7468 6f75 7420 7265 7374 7269  e without restri
+00038900: 6374 696f 6e2c 2069 6e63 6c75 6469 6e67  ction, including
+00038910: 2077 6974 686f 7574 206c 696d 6974 6174   without limitat
+00038920: 696f 6e20 7468 6520 7269 6768 7473 0a23  ion the rights.#
+00038930: 2074 6f20 7573 652c 2063 6f70 792c 206d   to use, copy, m
+00038940: 6f64 6966 792c 206d 6572 6765 2c20 7075  odify, merge, pu
+00038950: 626c 6973 682c 2064 6973 7472 6962 7574  blish, distribut
+00038960: 652c 2073 7562 6c69 6365 6e73 652c 2061  e, sublicense, a
+00038970: 6e64 2f6f 7220 7365 6c6c 0a23 2063 6f70  nd/or sell.# cop
+00038980: 6965 7320 6f66 2074 6865 2053 6f66 7477  ies of the Softw
+00038990: 6172 652c 2061 6e64 2074 6f20 7065 726d  are, and to perm
+000389a0: 6974 2070 6572 736f 6e73 2074 6f20 7768  it persons to wh
+000389b0: 6f6d 2074 6865 2053 6f66 7477 6172 6520  om the Software 
+000389c0: 6973 0a23 2066 7572 6e69 7368 6564 2074  is.# furnished t
+000389d0: 6f20 646f 2073 6f2c 2073 7562 6a65 6374  o do so, subject
+000389e0: 2074 6f20 7468 6520 666f 6c6c 6f77 696e   to the followin
+000389f0: 6720 636f 6e64 6974 696f 6e73 3a0a 230a  g conditions:.#.
+00038a00: 2320 5468 6520 6162 6f76 6520 636f 7079  # The above copy
+00038a10: 7269 6768 7420 6e6f 7469 6365 2061 6e64  right notice and
+00038a20: 2074 6869 7320 7065 726d 6973 7369 6f6e   this permission
+00038a30: 206e 6f74 6963 6520 7368 616c 6c20 6265   notice shall be
+00038a40: 2069 6e63 6c75 6465 6420 696e 2061 6c6c   included in all
+00038a50: 0a23 2063 6f70 6965 7320 6f72 2073 7562  .# copies or sub
+00038a60: 7374 616e 7469 616c 2070 6f72 7469 6f6e  stantial portion
+00038a70: 7320 6f66 2074 6865 2053 6f66 7477 6172  s of the Softwar
+00038a80: 652e 0a23 0a23 2054 4845 2053 4f46 5457  e..#.# THE SOFTW
+00038a90: 4152 4520 4953 2050 524f 5649 4445 4420  ARE IS PROVIDED 
+00038aa0: 2241 5320 4953 222c 2057 4954 484f 5554  "AS IS", WITHOUT
+00038ab0: 2057 4152 5241 4e54 5920 4f46 2041 4e59   WARRANTY OF ANY
+00038ac0: 204b 494e 442c 2045 5850 5245 5353 204f   KIND, EXPRESS O
+00038ad0: 520a 2320 494d 504c 4945 442c 2049 4e43  R.# IMPLIED, INC
+00038ae0: 4c55 4449 4e47 2042 5554 204e 4f54 204c  LUDING BUT NOT L
+00038af0: 494d 4954 4544 2054 4f20 5448 4520 5741  IMITED TO THE WA
+00038b00: 5252 414e 5449 4553 204f 4620 4d45 5243  RRANTIES OF MERC
+00038b10: 4841 4e54 4142 494c 4954 592c 0a23 2046  HANTABILITY,.# F
+00038b20: 4954 4e45 5353 2046 4f52 2041 2050 4152  ITNESS FOR A PAR
+00038b30: 5449 4355 4c41 5220 5055 5250 4f53 4520  TICULAR PURPOSE 
+00038b40: 414e 4420 4e4f 4e49 4e46 5249 4e47 454d  AND NONINFRINGEM
+00038b50: 454e 542e 2049 4e20 4e4f 2045 5645 4e54  ENT. IN NO EVENT
+00038b60: 2053 4841 4c4c 2054 4845 0a23 2041 5554   SHALL THE.# AUT
+00038b70: 484f 5253 204f 5220 434f 5059 5249 4748  HORS OR COPYRIGH
+00038b80: 5420 484f 4c44 4552 5320 4245 204c 4941  T HOLDERS BE LIA
+00038b90: 424c 4520 464f 5220 414e 5920 434c 4149  BLE FOR ANY CLAI
+00038ba0: 4d2c 2044 414d 4147 4553 204f 5220 4f54  M, DAMAGES OR OT
+00038bb0: 4845 520a 2320 4c49 4142 494c 4954 592c  HER.# LIABILITY,
+00038bc0: 2057 4845 5448 4552 2049 4e20 414e 2041   WHETHER IN AN A
+00038bd0: 4354 494f 4e20 4f46 2043 4f4e 5452 4143  CTION OF CONTRAC
+00038be0: 542c 2054 4f52 5420 4f52 204f 5448 4552  T, TORT OR OTHER
+00038bf0: 5749 5345 2c20 4152 4953 494e 4720 4652  WISE, ARISING FR
+00038c00: 4f4d 2c0a 2320 4f55 5420 4f46 204f 5220  OM,.# OUT OF OR 
+00038c10: 494e 2043 4f4e 4e45 4354 494f 4e20 5749  IN CONNECTION WI
+00038c20: 5448 2054 4845 2053 4f46 5457 4152 4520  TH THE SOFTWARE 
+00038c30: 4f52 2054 4845 2055 5345 204f 5220 4f54  OR THE USE OR OT
+00038c40: 4845 5220 4445 414c 494e 4753 2049 4e20  HER DEALINGS IN 
+00038c50: 5448 450a 2320 534f 4654 5741 5245 2e0a  THE.# SOFTWARE..
+00038c60: 0a69 6d70 6f72 7420 6f73 0a69 6d70 6f72  .import os.impor
+00038c70: 7420 7465 6d70 6669 6c65 0a66 726f 6d20  t tempfile.from 
+00038c80: 756e 6974 7465 7374 2069 6d70 6f72 7420  unittest import 
+00038c90: 6d6f 636b 0a0a 696d 706f 7274 2068 7970  mock..import hyp
+00038ca0: 6f74 6865 7369 732e 7374 7261 7465 6769  othesis.strategi
+00038cb0: 6573 2061 7320 7374 0a69 6d70 6f72 7420  es as st.import 
+00038cc0: 7067 3830 3030 0a69 6d70 6f72 7420 7073  pg8000.import ps
+00038cd0: 7963 6f70 6732 0a69 6d70 6f72 7420 7079  ycopg2.import py
+00038ce0: 7465 7374 0a66 726f 6d20 6879 706f 7468  test.from hypoth
+00038cf0: 6573 6973 2069 6d70 6f72 7420 6769 7665  esis import give
+00038d00: 6e0a 0a69 6d70 6f72 7420 6c6f 636f 7079  n..import locopy
+00038d10: 0a66 726f 6d20 6c6f 636f 7079 2e65 7272  .from locopy.err
+00038d20: 6f72 7320 696d 706f 7274 2028 0a20 2020  ors import (.   
+00038d30: 2053 3343 7265 6465 6e74 6961 6c73 4572   S3CredentialsEr
+00038d40: 726f 722c 0a20 2020 2053 3344 656c 6574  ror,.    S3Delet
+00038d50: 696f 6e45 7272 6f72 2c0a 2020 2020 5333  ionError,.    S3
+00038d60: 446f 776e 6c6f 6164 4572 726f 722c 0a20  DownloadError,. 
+00038d70: 2020 2053 3345 7272 6f72 2c0a 2020 2020     S3Error,.    
+00038d80: 5333 496e 6974 6961 6c69 7a61 7469 6f6e  S3Initialization
+00038d90: 4572 726f 722c 0a20 2020 2053 3355 706c  Error,.    S3Upl
+00038da0: 6f61 6445 7272 6f72 2c0a 290a 0a50 524f  oadError,.)..PRO
+00038db0: 4649 4c45 203d 2022 7465 7374 220a 4241  FILE = "test".BA
+00038dc0: 445f 5052 4f46 494c 4520 3d20 226e 6f74  D_PROFILE = "not
+00038dd0: 2072 6561 6c22 0a53 335f 4445 4641 554c   real".S3_DEFAUL
+00038de0: 545f 4255 434b 4554 203d 2022 7465 7374  T_BUCKET = "test
+00038df0: 2062 7563 6b65 7422 0a4c 4f43 414c 5f54   bucket".LOCAL_T
+00038e00: 4553 545f 4649 4c45 203d 2022 7465 7374  EST_FILE = "test
+00038e10: 2066 696c 6522 0a43 5553 544f 4d5f 4b45   file".CUSTOM_KE
+00038e20: 5920 3d20 2263 7573 746f 6d20 6b65 7922  Y = "custom key"
+00038e30: 0a4b 4d53 5f4b 4559 203d 2022 6172 6e3a  .KMS_KEY = "arn:
+00038e40: 6177 733a 6b6d 733a 7573 2d65 6173 742d  aws:kms:us-east-
+00038e50: 313a 3939 3939 3939 393a 6b65 792f 3078  1:9999999:key/0x
+00038e60: 3078 3078 3078 3022 0a47 4f4f 445f 434f  0x0x0x0".GOOD_CO
+00038e70: 4e46 4947 5f59 414d 4c20 3d20 2222 2268  NFIG_YAML = """h
+00038e80: 6f73 743a 2068 6f73 740a 706f 7274 3a20  ost: host.port: 
+00038e90: 3132 3334 0a64 626e 616d 653a 2064 620a  1234.dbname: db.
+00038ea0: 7573 6572 3a20 7573 6572 6964 0a70 6173  user: userid.pas
+00038eb0: 7377 6f72 643a 2070 6173 7322 2222 0a0a  sword: pass"""..
+00038ec0: 4442 4150 4953 203d 205b 7067 3830 3030  DBAPIS = [pg8000
+00038ed0: 2c20 7073 7963 6f70 6732 5d0a 0a43 4841  , psycopg2]..CHA
+00038ee0: 525f 5354 5241 5445 4759 203d 2073 742e  R_STRATEGY = st.
+00038ef0: 6368 6172 6163 7465 7273 2829 0a0a 0a40  characters()...@
+00038f00: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
+00038f10: 6d65 7472 697a 6528 2264 6261 7069 222c  metrize("dbapi",
+00038f20: 2044 4241 5049 5329 0a40 6d6f 636b 2e70   DBAPIS).@mock.p
+00038f30: 6174 6368 2822 6c6f 636f 7079 2e73 332e  atch("locopy.s3.
+00038f40: 5365 7373 696f 6e22 290a 4067 6976 656e  Session").@given
+00038f50: 2870 726f 6669 6c65 3d43 4841 525f 5354  (profile=CHAR_ST
+00038f60: 5241 5445 4759 290a 6465 6620 7465 7374  RATEGY).def test
+00038f70: 5f6d 6f63 6b5f 7333 5f73 6573 7369 6f6e  _mock_s3_session
+00038f80: 5f70 726f 6669 6c65 5f77 6974 686f 7574  _profile_without
+00038f90: 5f6b 6d73 2870 726f 6669 6c65 2c20 6d6f  _kms(profile, mo
+00038fa0: 636b 5f73 6573 7369 6f6e 2c20 6462 6170  ck_session, dbap
+00038fb0: 6929 3a0a 2020 2020 7320 3d20 6c6f 636f  i):.    s = loco
+00038fc0: 7079 2e53 3328 7072 6f66 696c 653d 7072  py.S3(profile=pr
+00038fd0: 6f66 696c 6529 0a20 2020 206d 6f63 6b5f  ofile).    mock_
+00038fe0: 7365 7373 696f 6e2e 6173 7365 7274 5f63  session.assert_c
+00038ff0: 616c 6c65 645f 7769 7468 2870 726f 6669  alled_with(profi
+00039000: 6c65 5f6e 616d 653d 7072 6f66 696c 6529  le_name=profile)
+00039010: 0a20 2020 2061 7373 6572 7420 732e 6b6d  .    assert s.km
+00039020: 735f 6b65 7920 3d3d 204e 6f6e 650a 0a0a  s_key == None...
+00039030: 4070 7974 6573 742e 6d61 726b 2e70 6172  @pytest.mark.par
+00039040: 616d 6574 7269 7a65 2822 6462 6170 6922  ametrize("dbapi"
+00039050: 2c20 4442 4150 4953 290a 406d 6f63 6b2e  , DBAPIS).@mock.
+00039060: 7061 7463 6828 226c 6f63 6f70 792e 7333  patch("locopy.s3
+00039070: 2e53 6573 7369 6f6e 2229 0a40 6769 7665  .Session").@give
+00039080: 6e28 696e 7075 745f 6b6d 735f 6b65 793d  n(input_kms_key=
+00039090: 4348 4152 5f53 5452 4154 4547 592c 2070  CHAR_STRATEGY, p
+000390a0: 726f 6669 6c65 3d43 4841 525f 5354 5241  rofile=CHAR_STRA
+000390b0: 5445 4759 290a 6465 6620 7465 7374 5f6d  TEGY).def test_m
+000390c0: 6f63 6b5f 7333 5f73 6573 7369 6f6e 5f70  ock_s3_session_p
+000390d0: 726f 6669 6c65 5f77 6974 685f 6b6d 7328  rofile_with_kms(
+000390e0: 696e 7075 745f 6b6d 735f 6b65 792c 2070  input_kms_key, p
+000390f0: 726f 6669 6c65 2c20 6d6f 636b 5f73 6573  rofile, mock_ses
+00039100: 7369 6f6e 2c20 6462 6170 6929 3a0a 2020  sion, dbapi):.  
+00039110: 2020 7320 3d20 6c6f 636f 7079 2e53 3328    s = locopy.S3(
+00039120: 7072 6f66 696c 653d 7072 6f66 696c 652c  profile=profile,
+00039130: 206b 6d73 5f6b 6579 3d69 6e70 7574 5f6b   kms_key=input_k
+00039140: 6d73 5f6b 6579 290a 2020 2020 6d6f 636b  ms_key).    mock
+00039150: 5f73 6573 7369 6f6e 2e61 7373 6572 745f  _session.assert_
+00039160: 6361 6c6c 6564 5f77 6974 6828 7072 6f66  called_with(prof
+00039170: 696c 655f 6e61 6d65 3d70 726f 6669 6c65  ile_name=profile
+00039180: 290a 2020 2020 6173 7365 7274 2073 2e6b  ).    assert s.k
+00039190: 6d73 5f6b 6579 203d 3d20 696e 7075 745f  ms_key == input_
+000391a0: 6b6d 735f 6b65 790a 0a0a 4070 7974 6573  kms_key...@pytes
+000391b0: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
+000391c0: 7a65 2822 6462 6170 6922 2c20 4442 4150  ze("dbapi", DBAP
+000391d0: 4953 290a 406d 6f63 6b2e 7061 7463 6828  IS).@mock.patch(
+000391e0: 226c 6f63 6f70 792e 7333 2e53 6573 7369  "locopy.s3.Sessi
+000391f0: 6f6e 2229 0a64 6566 2074 6573 745f 6d6f  on").def test_mo
+00039200: 636b 5f73 335f 7365 7373 696f 6e5f 7072  ck_s3_session_pr
+00039210: 6f66 696c 655f 7769 7468 6f75 745f 616e  ofile_without_an
+00039220: 7928 6d6f 636b 5f73 6573 7369 6f6e 2c20  y(mock_session, 
+00039230: 6462 6170 6929 3a0a 2020 2020 7320 3d20  dbapi):.    s = 
+00039240: 6c6f 636f 7079 2e53 3328 290a 2020 2020  locopy.S3().    
+00039250: 6d6f 636b 5f73 6573 7369 6f6e 2e61 7373  mock_session.ass
+00039260: 6572 745f 6361 6c6c 6564 5f77 6974 6828  ert_called_with(
+00039270: 7072 6f66 696c 655f 6e61 6d65 3d4e 6f6e  profile_name=Non
+00039280: 6529 0a20 2020 2061 7373 6572 7420 732e  e).    assert s.
+00039290: 6b6d 735f 6b65 7920 3d3d 204e 6f6e 650a  kms_key == None.
+000392a0: 0a0a 4070 7974 6573 742e 6d61 726b 2e70  ..@pytest.mark.p
+000392b0: 6172 616d 6574 7269 7a65 2822 6462 6170  arametrize("dbap
+000392c0: 6922 2c20 4442 4150 4953 290a 406d 6f63  i", DBAPIS).@moc
+000392d0: 6b2e 7061 7463 6828 226c 6f63 6f70 792e  k.patch("locopy.
+000392e0: 7333 2e53 6573 7369 6f6e 2229 0a64 6566  s3.Session").def
+000392f0: 2074 6573 745f 6d6f 636b 5f73 335f 696e   test_mock_s3_in
+00039300: 6974 5f65 7863 6570 7469 6f6e 286d 6f63  it_exception(moc
+00039310: 6b5f 7365 7373 696f 6e2c 2064 6261 7069  k_session, dbapi
+00039320: 293a 0a20 2020 206d 6f63 6b5f 7365 7373  ):.    mock_sess
+00039330: 696f 6e2e 7369 6465 5f65 6666 6563 7420  ion.side_effect 
+00039340: 3d20 5333 4572 726f 7228 290a 2020 2020  = S3Error().    
+00039350: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
+00039360: 6573 2853 3345 7272 6f72 293a 0a20 2020  es(S3Error):.   
+00039370: 2020 2020 206c 6f63 6f70 792e 5333 2829       locopy.S3()
+00039380: 0a0a 2020 2020 6d6f 636b 5f73 6573 7369  ..    mock_sessi
+00039390: 6f6e 2e73 6964 655f 6566 6665 6374 203d  on.side_effect =
+000393a0: 204e 6f6e 650a 2020 2020 6d6f 636b 5f73   None.    mock_s
+000393b0: 6573 7369 6f6e 2e72 6574 7572 6e5f 7661  ession.return_va
+000393c0: 6c75 652e 6765 745f 6372 6564 656e 7469  lue.get_credenti
+000393d0: 616c 732e 7265 7475 726e 5f76 616c 7565  als.return_value
+000393e0: 203d 204e 6f6e 650a 2020 2020 7769 7468   = None.    with
+000393f0: 2070 7974 6573 742e 7261 6973 6573 2853   pytest.raises(S
+00039400: 3343 7265 6465 6e74 6961 6c73 4572 726f  3CredentialsErro
+00039410: 7229 3a0a 2020 2020 2020 2020 6c6f 636f  r):.        loco
+00039420: 7079 2e53 3328 290a 0a0a 4070 7974 6573  py.S3()...@pytes
+00039430: 742e 6d61 726b 2e70 6172 616d 6574 7269  t.mark.parametri
+00039440: 7a65 2822 6462 6170 6922 2c20 4442 4150  ze("dbapi", DBAP
+00039450: 4953 290a 406d 6f63 6b2e 7061 7463 6828  IS).@mock.patch(
+00039460: 226c 6f63 6f70 792e 7333 2e43 6f6e 6669  "locopy.s3.Confi
+00039470: 6722 290a 406d 6f63 6b2e 7061 7463 6828  g").@mock.patch(
+00039480: 226c 6f63 6f70 792e 7333 2e53 6573 7369  "locopy.s3.Sessi
+00039490: 6f6e 2229 0a64 6566 2074 6573 745f 6d6f  on").def test_mo
+000394a0: 636b 5f73 335f 7365 745f 636c 6965 6e74  ck_s3_set_client
+000394b0: 286d 6f63 6b5f 7365 7373 696f 6e2c 206d  (mock_session, m
+000394c0: 6f63 6b5f 636f 6e66 6967 2c20 6462 6170  ock_config, dbap
+000394d0: 6929 3a0a 2020 2020 7320 3d20 6c6f 636f  i):.    s = loco
+000394e0: 7079 2e53 3328 7072 6f66 696c 653d 5052  py.S3(profile=PR
+000394f0: 4f46 494c 4529 0a20 2020 206d 6f63 6b5f  OFILE).    mock_
+00039500: 636f 6e66 6967 2e61 7373 6572 745f 6361  config.assert_ca
+00039510: 6c6c 6564 5f77 6974 6828 7369 676e 6174  lled_with(signat
+00039520: 7572 655f 7665 7273 696f 6e3d 2273 3376  ure_version="s3v
+00039530: 3422 290a 0a20 2020 206d 6f63 6b5f 636f  4")..    mock_co
+00039540: 6e66 6967 2e73 6964 655f 6566 6665 6374  nfig.side_effect
+00039550: 203d 2045 7863 6570 7469 6f6e 2822 5f73   = Exception("_s
+00039560: 6574 5f63 6c69 656e 7420 4578 6365 7074  et_client Except
+00039570: 696f 6e22 290a 2020 2020 7769 7468 2070  ion").    with p
+00039580: 7974 6573 742e 7261 6973 6573 2853 3349  ytest.raises(S3I
+00039590: 6e69 7469 616c 697a 6174 696f 6e45 7272  nitializationErr
+000395a0: 6f72 293a 0a20 2020 2020 2020 206c 6f63  or):.        loc
+000395b0: 6f70 792e 5333 2870 726f 6669 6c65 3d50  opy.S3(profile=P
+000395c0: 524f 4649 4c45 290a 0a0a 406d 6f63 6b2e  ROFILE)...@mock.
+000395d0: 7061 7463 6828 226c 6f63 6f70 792e 7333  patch("locopy.s3
+000395e0: 2e53 6573 7369 6f6e 2e67 6574 5f63 7265  .Session.get_cre
+000395f0: 6465 6e74 6961 6c73 2229 0a64 6566 2074  dentials").def t
+00039600: 6573 745f 6765 745f 6372 6564 656e 7469  est_get_credenti
+00039610: 616c 7328 6d6f 636b 5f63 7265 642c 2061  als(mock_cred, a
+00039620: 7773 5f63 7265 6473 293a 0a20 2020 2073  ws_creds):.    s
+00039630: 203d 206c 6f63 6f70 792e 5333 2829 0a20   = locopy.S3(). 
+00039640: 2020 206d 6f63 6b5f 6372 6564 2e72 6574     mock_cred.ret
+00039650: 7572 6e5f 7661 6c75 6520 3d20 6177 735f  urn_value = aws_
+00039660: 6372 6564 730a 2020 2020 6372 6564 5f73  creds.    cred_s
+00039670: 7472 696e 6720 3d20 732e 5f63 7265 6465  tring = s._crede
+00039680: 6e74 6961 6c73 5f73 7472 696e 6728 290a  ntials_string().
+00039690: 2020 2020 6578 7065 6374 6564 203d 2022      expected = "
+000396a0: 6177 735f 6163 6365 7373 5f6b 6579 5f69  aws_access_key_i
+000396b0: 643d 6163 6365 7373 3b22 2022 6177 735f  d=access;" "aws_
+000396c0: 7365 6372 6574 5f61 6363 6573 735f 6b65  secret_access_ke
+000396d0: 793d 7365 6372 6574 3b22 2022 746f 6b65  y=secret;" "toke
+000396e0: 6e3d 746f 6b65 6e22 0a20 2020 2061 7373  n=token".    ass
+000396f0: 6572 7420 6372 6564 5f73 7472 696e 6720  ert cred_string 
+00039700: 3d3d 2065 7870 6563 7465 640a 0a20 2020  == expected..   
+00039710: 2061 7773 5f63 7265 6473 2e74 6f6b 656e   aws_creds.token
+00039720: 203d 204e 6f6e 650a 2020 2020 6d6f 636b   = None.    mock
+00039730: 5f63 7265 642e 7265 7475 726e 5f76 616c  _cred.return_val
+00039740: 7565 203d 2061 7773 5f63 7265 6473 0a20  ue = aws_creds. 
+00039750: 2020 2063 7265 645f 7374 7269 6e67 203d     cred_string =
+00039760: 2073 2e5f 6372 6564 656e 7469 616c 735f   s._credentials_
+00039770: 7374 7269 6e67 2829 0a20 2020 2065 7870  string().    exp
+00039780: 6563 7465 6420 3d20 2261 7773 5f61 6363  ected = "aws_acc
+00039790: 6573 735f 6b65 795f 6964 3d61 6363 6573  ess_key_id=acces
+000397a0: 733b 2220 2261 7773 5f73 6563 7265 745f  s;" "aws_secret_
+000397b0: 6163 6365 7373 5f6b 6579 3d73 6563 7265  access_key=secre
+000397c0: 7422 0a20 2020 2061 7373 6572 7420 6372  t".    assert cr
+000397d0: 6564 5f73 7472 696e 6720 3d3d 2065 7870  ed_string == exp
+000397e0: 6563 7465 640a 0a20 2020 206d 6f63 6b5f  ected..    mock_
+000397f0: 6372 6564 2e73 6964 655f 6566 6665 6374  cred.side_effect
+00039800: 203d 2045 7863 6570 7469 6f6e 2822 4578   = Exception("Ex
+00039810: 6365 7074 696f 6e22 290a 2020 2020 7769  ception").    wi
+00039820: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
+00039830: 2845 7863 6570 7469 6f6e 293a 0a20 2020  (Exception):.   
+00039840: 2020 2020 206c 6f63 6f70 792e 5333 2829       locopy.S3()
+00039850: 0a0a 0a40 6d6f 636b 2e70 6174 6368 2822  ...@mock.patch("
+00039860: 6c6f 636f 7079 2e73 332e 5365 7373 696f  locopy.s3.Sessio
+00039870: 6e22 290a 6465 6620 7465 7374 5f67 656e  n").def test_gen
+00039880: 6572 6174 655f 7333 5f70 6174 6828 6d6f  erate_s3_path(mo
+00039890: 636b 5f73 6573 7369 6f6e 293a 0a20 2020  ck_session):.   
+000398a0: 2073 203d 206c 6f63 6f70 792e 5333 2829   s = locopy.S3()
+000398b0: 0a20 2020 2061 7373 6572 7420 732e 5f67  .    assert s._g
+000398c0: 656e 6572 6174 655f 7333 5f70 6174 6828  enerate_s3_path(
+000398d0: 2254 4553 5422 2c20 224b 4559 2229 203d  "TEST", "KEY") =
+000398e0: 3d20 2273 333a 2f2f 5445 5354 2f4b 4559  = "s3://TEST/KEY
+000398f0: 220a 2020 2020 6173 7365 7274 2073 2e5f  ".    assert s._
+00039900: 6765 6e65 7261 7465 5f73 335f 7061 7468  generate_s3_path
+00039910: 2822 5445 5354 2053 5041 4345 222c 2022  ("TEST SPACE", "
+00039920: 4b45 5920 5350 4143 4522 2920 3d3d 2022  KEY SPACE") == "
+00039930: 7333 3a2f 2f54 4553 5420 5350 4143 452f  s3://TEST SPACE/
+00039940: 4b45 5920 5350 4143 4522 0a20 2020 2061  KEY SPACE".    a
+00039950: 7373 6572 7420 732e 5f67 656e 6572 6174  ssert s._generat
+00039960: 655f 7333 5f70 6174 6828 4e6f 6e65 2c20  e_s3_path(None, 
+00039970: 4e6f 6e65 2920 3d3d 2022 7333 3a2f 2f4e  None) == "s3://N
+00039980: 6f6e 652f 4e6f 6e65 220a 0a0a 406d 6f63  one/None"...@moc
+00039990: 6b2e 7061 7463 6828 226c 6f63 6f70 792e  k.patch("locopy.
+000399a0: 7333 2e53 6573 7369 6f6e 2229 0a64 6566  s3.Session").def
+000399b0: 2074 6573 745f 6765 6e65 7261 7465 5f75   test_generate_u
+000399c0: 6e6c 6f61 645f 7061 7468 286d 6f63 6b5f  nload_path(mock_
+000399d0: 7365 7373 696f 6e29 3a0a 2020 2020 7320  session):.    s 
+000399e0: 3d20 6c6f 636f 7079 2e53 3328 290a 2020  = locopy.S3().  
+000399f0: 2020 6173 7365 7274 2073 2e5f 6765 6e65    assert s._gene
+00039a00: 7261 7465 5f75 6e6c 6f61 645f 7061 7468  rate_unload_path
+00039a10: 2822 5445 5354 222c 2022 464f 4c44 4552  ("TEST", "FOLDER
+00039a20: 2f22 2920 3d3d 2022 7333 3a2f 2f54 4553  /") == "s3://TES
+00039a30: 542f 464f 4c44 4552 2f22 0a20 2020 2061  T/FOLDER/".    a
+00039a40: 7373 6572 7420 732e 5f67 656e 6572 6174  ssert s._generat
+00039a50: 655f 756e 6c6f 6164 5f70 6174 6828 2254  e_unload_path("T
+00039a60: 4553 5420 5350 4143 4522 2c20 2246 4f4c  EST SPACE", "FOL
+00039a70: 4445 5220 5350 4143 452f 2229 203d 3d20  DER SPACE/") == 
+00039a80: 2273 333a 2f2f 5445 5354 2053 5041 4345  "s3://TEST SPACE
+00039a90: 2f46 4f4c 4445 5220 5350 4143 452f 220a  /FOLDER SPACE/".
+00039aa0: 2020 2020 6173 7365 7274 2073 2e5f 6765      assert s._ge
+00039ab0: 6e65 7261 7465 5f75 6e6c 6f61 645f 7061  nerate_unload_pa
+00039ac0: 7468 2822 5445 5354 222c 2022 5052 4546  th("TEST", "PREF
+00039ad0: 4958 2229 203d 3d20 2273 333a 2f2f 5445  IX") == "s3://TE
+00039ae0: 5354 2f50 5245 4649 5822 0a20 2020 2061  ST/PREFIX".    a
+00039af0: 7373 6572 7420 732e 5f67 656e 6572 6174  ssert s._generat
+00039b00: 655f 756e 6c6f 6164 5f70 6174 6828 2254  e_unload_path("T
+00039b10: 4553 5422 2c20 4e6f 6e65 2920 3d3d 2022  EST", None) == "
+00039b20: 7333 3a2f 2f54 4553 5422 0a0a 0a40 6d6f  s3://TEST"...@mo
+00039b30: 636b 2e70 6174 6368 2822 6c6f 636f 7079  ck.patch("locopy
+00039b40: 2e73 332e 5072 6f67 7265 7373 5065 7263  .s3.ProgressPerc
+00039b50: 656e 7461 6765 2229 0a40 6d6f 636b 2e70  entage").@mock.p
+00039b60: 6174 6368 2822 6c6f 636f 7079 2e73 332e  atch("locopy.s3.
+00039b70: 5365 7373 696f 6e22 290a 6465 6620 7465  Session").def te
+00039b80: 7374 5f75 706c 6f61 645f 746f 5f73 3328  st_upload_to_s3(
+00039b90: 6d6f 636b 5f73 6573 7369 6f6e 2c20 6d6f  mock_session, mo
+00039ba0: 636b 5f70 726f 6772 6573 7329 3a0a 2020  ck_progress):.  
+00039bb0: 2020 6d6f 636b 5f70 726f 6772 6573 732e    mock_progress.
+00039bc0: 7265 7475 726e 5f76 616c 7565 203d 204e  return_value = N
+00039bd0: 6f6e 650a 2020 2020 7320 3d20 6c6f 636f  one.    s = loco
+00039be0: 7079 2e53 3328 290a 2020 2020 732e 7570  py.S3().    s.up
+00039bf0: 6c6f 6164 5f74 6f5f 7333 284c 4f43 414c  load_to_s3(LOCAL
+00039c00: 5f54 4553 545f 4649 4c45 2c20 5333 5f44  _TEST_FILE, S3_D
+00039c10: 4546 4155 4c54 5f42 5543 4b45 542c 204c  EFAULT_BUCKET, L
+00039c20: 4f43 414c 5f54 4553 545f 4649 4c45 290a  OCAL_TEST_FILE).
+00039c30: 2020 2020 6d6f 636b 5f70 726f 6772 6573      mock_progres
+00039c40: 732e 6173 7365 7274 5f63 616c 6c65 645f  s.assert_called_
+00039c50: 7769 7468 2822 7465 7374 2066 696c 6522  with("test file"
+00039c60: 290a 2020 2020 732e 7333 2e75 706c 6f61  ).    s.s3.uploa
+00039c70: 645f 6669 6c65 2e61 7373 6572 745f 6361  d_file.assert_ca
+00039c80: 6c6c 6564 5f77 6974 6828 0a20 2020 2020  lled_with(.     
+00039c90: 2020 204c 4f43 414c 5f54 4553 545f 4649     LOCAL_TEST_FI
+00039ca0: 4c45 2c0a 2020 2020 2020 2020 5333 5f44  LE,.        S3_D
+00039cb0: 4546 4155 4c54 5f42 5543 4b45 542c 0a20  EFAULT_BUCKET,. 
+00039cc0: 2020 2020 2020 206f 732e 7061 7468 2e62         os.path.b
+00039cd0: 6173 656e 616d 6528 4c4f 4341 4c5f 5445  asename(LOCAL_TE
+00039ce0: 5354 5f46 494c 4529 2c0a 2020 2020 2020  ST_FILE),.      
+00039cf0: 2020 4578 7472 6141 7267 733d 7b22 5365    ExtraArgs={"Se
+00039d00: 7276 6572 5369 6465 456e 6372 7970 7469  rverSideEncrypti
+00039d10: 6f6e 223a 2022 4145 5332 3536 227d 2c0a  on": "AES256"},.
+00039d20: 2020 2020 2020 2020 4361 6c6c 6261 636b          Callback
+00039d30: 3d4e 6f6e 652c 0a20 2020 2029 0a0a 2020  =None,.    )..  
+00039d40: 2020 7320 3d20 6c6f 636f 7079 2e53 3328    s = locopy.S3(
+00039d50: 6b6d 735f 6b65 793d 4b4d 535f 4b45 5929  kms_key=KMS_KEY)
+00039d60: 0a20 2020 2073 2e75 706c 6f61 645f 746f  .    s.upload_to
+00039d70: 5f73 3328 4c4f 4341 4c5f 5445 5354 5f46  _s3(LOCAL_TEST_F
+00039d80: 494c 452c 2053 335f 4445 4641 554c 545f  ILE, S3_DEFAULT_
+00039d90: 4255 434b 4554 2c20 4c4f 4341 4c5f 5445  BUCKET, LOCAL_TE
+00039da0: 5354 5f46 494c 4529 0a20 2020 2073 2e73  ST_FILE).    s.s
+00039db0: 332e 7570 6c6f 6164 5f66 696c 652e 6173  3.upload_file.as
+00039dc0: 7365 7274 5f63 616c 6c65 645f 7769 7468  sert_called_with
+00039dd0: 280a 2020 2020 2020 2020 4c4f 4341 4c5f  (.        LOCAL_
+00039de0: 5445 5354 5f46 494c 452c 0a20 2020 2020  TEST_FILE,.     
+00039df0: 2020 2053 335f 4445 4641 554c 545f 4255     S3_DEFAULT_BU
+00039e00: 434b 4554 2c0a 2020 2020 2020 2020 6f73  CKET,.        os
+00039e10: 2e70 6174 682e 6261 7365 6e61 6d65 284c  .path.basename(L
+00039e20: 4f43 414c 5f54 4553 545f 4649 4c45 292c  OCAL_TEST_FILE),
+00039e30: 0a20 2020 2020 2020 2045 7874 7261 4172  .        ExtraAr
+00039e40: 6773 3d7b 2253 5345 4b4d 534b 6579 4964  gs={"SSEKMSKeyId
+00039e50: 223a 204b 4d53 5f4b 4559 2c20 2253 6572  ": KMS_KEY, "Ser
+00039e60: 7665 7253 6964 6545 6e63 7279 7074 696f  verSideEncryptio
+00039e70: 6e22 3a20 2261 7773 3a6b 6d73 227d 2c0a  n": "aws:kms"},.
+00039e80: 2020 2020 2020 2020 4361 6c6c 6261 636b          Callback
+00039e90: 3d4e 6f6e 652c 0a20 2020 2029 0a0a 0a40  =None,.    )...@
+00039ea0: 6d6f 636b 2e70 6174 6368 2822 6c6f 636f  mock.patch("loco
+00039eb0: 7079 2e73 332e 5072 6f67 7265 7373 5065  py.s3.ProgressPe
+00039ec0: 7263 656e 7461 6765 2229 0a40 6d6f 636b  rcentage").@mock
+00039ed0: 2e70 6174 6368 2822 6c6f 636f 7079 2e73  .patch("locopy.s
+00039ee0: 332e 5365 7373 696f 6e22 290a 6465 6620  3.Session").def 
+00039ef0: 7465 7374 5f75 706c 6f61 645f 746f 5f73  test_upload_to_s
+00039f00: 335f 7769 7468 5f63 7573 746f 6d5f 6b65  3_with_custom_ke
+00039f10: 7928 6d6f 636b 5f73 6573 7369 6f6e 2c20  y(mock_session, 
+00039f20: 6d6f 636b 5f70 726f 6772 6573 7329 3a0a  mock_progress):.
+00039f30: 2020 2020 6d6f 636b 5f70 726f 6772 6573      mock_progres
+00039f40: 732e 7265 7475 726e 5f76 616c 7565 203d  s.return_value =
+00039f50: 204e 6f6e 650a 2020 2020 7320 3d20 6c6f   None.    s = lo
+00039f60: 636f 7079 2e53 3328 290a 2020 2020 732e  copy.S3().    s.
+00039f70: 7570 6c6f 6164 5f74 6f5f 7333 284c 4f43  upload_to_s3(LOC
+00039f80: 414c 5f54 4553 545f 4649 4c45 2c20 5333  AL_TEST_FILE, S3
+00039f90: 5f44 4546 4155 4c54 5f42 5543 4b45 542c  _DEFAULT_BUCKET,
+00039fa0: 2043 5553 544f 4d5f 4b45 5929 0a20 2020   CUSTOM_KEY).   
+00039fb0: 206d 6f63 6b5f 7072 6f67 7265 7373 2e61   mock_progress.a
+00039fc0: 7373 6572 745f 6361 6c6c 6564 5f77 6974  ssert_called_wit
+00039fd0: 6828 2274 6573 7420 6669 6c65 2229 0a20  h("test file"). 
+00039fe0: 2020 2073 2e73 332e 7570 6c6f 6164 5f66     s.s3.upload_f
+00039ff0: 696c 652e 6173 7365 7274 5f63 616c 6c65  ile.assert_calle
+0003a000: 645f 7769 7468 280a 2020 2020 2020 2020  d_with(.        
+0003a010: 4c4f 4341 4c5f 5445 5354 5f46 494c 452c  LOCAL_TEST_FILE,
+0003a020: 0a20 2020 2020 2020 2053 335f 4445 4641  .        S3_DEFA
+0003a030: 554c 545f 4255 434b 4554 2c0a 2020 2020  ULT_BUCKET,.    
+0003a040: 2020 2020 4355 5354 4f4d 5f4b 4559 2c0a      CUSTOM_KEY,.
+0003a050: 2020 2020 2020 2020 4578 7472 6141 7267          ExtraArg
+0003a060: 733d 7b22 5365 7276 6572 5369 6465 456e  s={"ServerSideEn
+0003a070: 6372 7970 7469 6f6e 223a 2022 4145 5332  cryption": "AES2
+0003a080: 3536 227d 2c0a 2020 2020 2020 2020 4361  56"},.        Ca
+0003a090: 6c6c 6261 636b 3d4e 6f6e 652c 0a20 2020  llback=None,.   
+0003a0a0: 2029 0a0a 2020 2020 7320 3d20 6c6f 636f   )..    s = loco
+0003a0b0: 7079 2e53 3328 6b6d 735f 6b65 793d 4b4d  py.S3(kms_key=KM
+0003a0c0: 535f 4b45 5929 0a20 2020 2073 2e75 706c  S_KEY).    s.upl
+0003a0d0: 6f61 645f 746f 5f73 3328 4c4f 4341 4c5f  oad_to_s3(LOCAL_
+0003a0e0: 5445 5354 5f46 494c 452c 2053 335f 4445  TEST_FILE, S3_DE
+0003a0f0: 4641 554c 545f 4255 434b 4554 2c20 4355  FAULT_BUCKET, CU
+0003a100: 5354 4f4d 5f4b 4559 290a 2020 2020 732e  STOM_KEY).    s.
+0003a110: 7333 2e75 706c 6f61 645f 6669 6c65 2e61  s3.upload_file.a
+0003a120: 7373 6572 745f 6361 6c6c 6564 5f77 6974  ssert_called_wit
+0003a130: 6828 0a20 2020 2020 2020 204c 4f43 414c  h(.        LOCAL
+0003a140: 5f54 4553 545f 4649 4c45 2c0a 2020 2020  _TEST_FILE,.    
+0003a150: 2020 2020 5333 5f44 4546 4155 4c54 5f42      S3_DEFAULT_B
+0003a160: 5543 4b45 542c 0a20 2020 2020 2020 2043  UCKET,.        C
+0003a170: 5553 544f 4d5f 4b45 592c 0a20 2020 2020  USTOM_KEY,.     
+0003a180: 2020 2045 7874 7261 4172 6773 3d7b 2253     ExtraArgs={"S
+0003a190: 5345 4b4d 534b 6579 4964 223a 204b 4d53  SEKMSKeyId": KMS
+0003a1a0: 5f4b 4559 2c20 2253 6572 7665 7253 6964  _KEY, "ServerSid
+0003a1b0: 6545 6e63 7279 7074 696f 6e22 3a20 2261  eEncryption": "a
+0003a1c0: 7773 3a6b 6d73 227d 2c0a 2020 2020 2020  ws:kms"},.      
+0003a1d0: 2020 4361 6c6c 6261 636b 3d4e 6f6e 652c    Callback=None,
+0003a1e0: 0a20 2020 2029 0a0a 0a40 6d6f 636b 2e70  .    )...@mock.p
+0003a1f0: 6174 6368 2822 6c6f 636f 7079 2e73 332e  atch("locopy.s3.
+0003a200: 5072 6f67 7265 7373 5065 7263 656e 7461  ProgressPercenta
+0003a210: 6765 2229 0a40 6d6f 636b 2e70 6174 6368  ge").@mock.patch
+0003a220: 2822 6c6f 636f 7079 2e73 332e 5365 7373  ("locopy.s3.Sess
+0003a230: 696f 6e22 290a 6465 6620 7465 7374 5f75  ion").def test_u
+0003a240: 706c 6f61 645f 746f 5f73 335f 6578 6365  pload_to_s3_exce
+0003a250: 7074 696f 6e28 6d6f 636b 5f73 6573 7369  ption(mock_sessi
+0003a260: 6f6e 2c20 6d6f 636b 5f70 726f 6772 6573  on, mock_progres
+0003a270: 7329 3a0a 2020 2020 6d6f 636b 5f70 726f  s):.    mock_pro
+0003a280: 6772 6573 732e 7265 7475 726e 5f76 616c  gress.return_val
+0003a290: 7565 203d 204e 6f6e 650a 2020 2020 7320  ue = None.    s 
+0003a2a0: 3d20 6c6f 636f 7079 2e53 3328 290a 2020  = locopy.S3().  
+0003a2b0: 2020 732e 7333 2e75 706c 6f61 645f 6669    s.s3.upload_fi
+0003a2c0: 6c65 2e73 6964 655f 6566 6665 6374 203d  le.side_effect =
+0003a2d0: 2045 7863 6570 7469 6f6e 2822 5570 6c6f   Exception("Uplo
+0003a2e0: 6164 2045 7863 6570 7469 6f6e 2229 0a20  ad Exception"). 
+0003a2f0: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
+0003a300: 6169 7365 7328 5333 5570 6c6f 6164 4572  aises(S3UploadEr
+0003a310: 726f 7229 3a0a 2020 2020 2020 2020 732e  ror):.        s.
+0003a320: 7570 6c6f 6164 5f74 6f5f 7333 284c 4f43  upload_to_s3(LOC
+0003a330: 414c 5f54 4553 545f 4649 4c45 2c20 5333  AL_TEST_FILE, S3
+0003a340: 5f44 4546 4155 4c54 5f42 5543 4b45 542c  _DEFAULT_BUCKET,
+0003a350: 2043 5553 544f 4d5f 4b45 5929 0a0a 0a40   CUSTOM_KEY)...@
+0003a360: 6d6f 636b 2e70 6174 6368 2822 6c6f 636f  mock.patch("loco
+0003a370: 7079 2e73 332e 5333 2e75 706c 6f61 645f  py.s3.S3.upload_
+0003a380: 746f 5f73 3322 290a 406d 6f63 6b2e 7061  to_s3").@mock.pa
+0003a390: 7463 6828 226c 6f63 6f70 792e 7333 2e53  tch("locopy.s3.S
+0003a3a0: 6573 7369 6f6e 2229 0a64 6566 2074 6573  ession").def tes
+0003a3b0: 745f 7570 6c6f 6164 5f6c 6973 745f 746f  t_upload_list_to
+0003a3c0: 5f73 335f 7369 6e67 6c65 5f77 6974 685f  _s3_single_with_
+0003a3d0: 666f 6c64 6572 286d 6f63 6b5f 7365 7373  folder(mock_sess
+0003a3e0: 696f 6e2c 206d 6f63 6b5f 7570 6c6f 6164  ion, mock_upload
+0003a3f0: 293a 0a20 2020 2063 616c 6c73 203d 205b  ):.    calls = [
+0003a400: 6d6f 636b 2e63 616c 6c28 2274 6573 742e  mock.call("test.
+0003a410: 3122 2c20 2274 6573 745f 6275 636b 6574  1", "test_bucket
+0003a420: 222c 2022 7465 7374 5f66 6f6c 6465 722f  ", "test_folder/
+0003a430: 7465 7374 2e31 2229 5d0a 2020 2020 7320  test.1")].    s 
+0003a440: 3d20 6c6f 636f 7079 2e53 3328 290a 2020  = locopy.S3().  
+0003a450: 2020 7265 7320 3d20 732e 7570 6c6f 6164    res = s.upload
+0003a460: 5f6c 6973 745f 746f 5f73 3328 5b22 7465  _list_to_s3(["te
+0003a470: 7374 2e31 225d 2c20 2274 6573 745f 6275  st.1"], "test_bu
+0003a480: 636b 6574 222c 2022 7465 7374 5f66 6f6c  cket", "test_fol
+0003a490: 6465 7222 290a 2020 2020 6173 7365 7274  der").    assert
+0003a4a0: 2072 6573 203d 3d20 5b22 7465 7374 5f62   res == ["test_b
+0003a4b0: 7563 6b65 742f 7465 7374 5f66 6f6c 6465  ucket/test_folde
+0003a4c0: 722f 7465 7374 2e31 225d 0a20 2020 206d  r/test.1"].    m
+0003a4d0: 6f63 6b5f 7570 6c6f 6164 2e61 7373 6572  ock_upload.asser
+0003a4e0: 745f 6861 735f 6361 6c6c 7328 6361 6c6c  t_has_calls(call
+0003a4f0: 7329 0a0a 0a40 6d6f 636b 2e70 6174 6368  s)...@mock.patch
+0003a500: 2822 6c6f 636f 7079 2e73 332e 5333 2e75  ("locopy.s3.S3.u
+0003a510: 706c 6f61 645f 746f 5f73 3322 290a 406d  pload_to_s3").@m
+0003a520: 6f63 6b2e 7061 7463 6828 226c 6f63 6f70  ock.patch("locop
+0003a530: 792e 7333 2e53 6573 7369 6f6e 2229 0a64  y.s3.Session").d
+0003a540: 6566 2074 6573 745f 7570 6c6f 6164 5f6c  ef test_upload_l
+0003a550: 6973 745f 746f 5f73 335f 7369 6e67 6c65  ist_to_s3_single
+0003a560: 5f77 6974 686f 7574 5f66 6f6c 6465 7228  _without_folder(
+0003a570: 6d6f 636b 5f73 6573 7369 6f6e 2c20 6d6f  mock_session, mo
+0003a580: 636b 5f75 706c 6f61 6429 3a0a 2020 2020  ck_upload):.    
+0003a590: 6361 6c6c 7320 3d20 5b6d 6f63 6b2e 6361  calls = [mock.ca
+0003a5a0: 6c6c 2822 7465 7374 2e31 222c 2022 7465  ll("test.1", "te
+0003a5b0: 7374 5f62 7563 6b65 7422 2c20 2274 6573  st_bucket", "tes
+0003a5c0: 742e 3122 295d 0a20 2020 2073 203d 206c  t.1")].    s = l
+0003a5d0: 6f63 6f70 792e 5333 2829 0a20 2020 2072  ocopy.S3().    r
+0003a5e0: 6573 203d 2073 2e75 706c 6f61 645f 6c69  es = s.upload_li
+0003a5f0: 7374 5f74 6f5f 7333 285b 2274 6573 742e  st_to_s3(["test.
+0003a600: 3122 5d2c 2022 7465 7374 5f62 7563 6b65  1"], "test_bucke
+0003a610: 7422 290a 2020 2020 6173 7365 7274 2072  t").    assert r
+0003a620: 6573 203d 3d20 5b22 7465 7374 5f62 7563  es == ["test_buc
+0003a630: 6b65 742f 7465 7374 2e31 225d 0a20 2020  ket/test.1"].   
+0003a640: 206d 6f63 6b5f 7570 6c6f 6164 2e61 7373   mock_upload.ass
+0003a650: 6572 745f 6861 735f 6361 6c6c 7328 6361  ert_has_calls(ca
+0003a660: 6c6c 7329 0a0a 0a40 6d6f 636b 2e70 6174  lls)...@mock.pat
+0003a670: 6368 2822 6c6f 636f 7079 2e73 332e 5333  ch("locopy.s3.S3
+0003a680: 2e75 706c 6f61 645f 746f 5f73 3322 290a  .upload_to_s3").
+0003a690: 406d 6f63 6b2e 7061 7463 6828 226c 6f63  @mock.patch("loc
+0003a6a0: 6f70 792e 7333 2e53 6573 7369 6f6e 2229  opy.s3.Session")
+0003a6b0: 0a64 6566 2074 6573 745f 7570 6c6f 6164  .def test_upload
+0003a6c0: 5f6c 6973 745f 746f 5f73 335f 6d75 6c74  _list_to_s3_mult
+0003a6d0: 6970 6c65 5f77 6974 685f 666f 6c64 6572  iple_with_folder
+0003a6e0: 286d 6f63 6b5f 7365 7373 696f 6e2c 206d  (mock_session, m
+0003a6f0: 6f63 6b5f 7570 6c6f 6164 293a 0a20 2020  ock_upload):.   
+0003a700: 2063 616c 6c73 203d 205b 0a20 2020 2020   calls = [.     
+0003a710: 2020 206d 6f63 6b2e 6361 6c6c 2822 7465     mock.call("te
+0003a720: 7374 2e31 222c 2022 7465 7374 5f62 7563  st.1", "test_buc
+0003a730: 6b65 7422 2c20 2274 6573 745f 666f 6c64  ket", "test_fold
+0003a740: 6572 2f74 6573 742e 3122 292c 0a20 2020  er/test.1"),.   
+0003a750: 2020 2020 206d 6f63 6b2e 6361 6c6c 2822       mock.call("
+0003a760: 7465 7374 2e32 222c 2022 7465 7374 5f62  test.2", "test_b
+0003a770: 7563 6b65 7422 2c20 2274 6573 745f 666f  ucket", "test_fo
+0003a780: 6c64 6572 2f74 6573 742e 3222 292c 0a20  lder/test.2"),. 
+0003a790: 2020 205d 0a20 2020 2073 203d 206c 6f63     ].    s = loc
+0003a7a0: 6f70 792e 5333 2829 0a20 2020 2072 6573  opy.S3().    res
+0003a7b0: 203d 2073 2e75 706c 6f61 645f 6c69 7374   = s.upload_list
+0003a7c0: 5f74 6f5f 7333 285b 2274 6573 742e 3122  _to_s3(["test.1"
+0003a7d0: 2c20 2274 6573 742e 3222 5d2c 2022 7465  , "test.2"], "te
+0003a7e0: 7374 5f62 7563 6b65 7422 2c20 2274 6573  st_bucket", "tes
+0003a7f0: 745f 666f 6c64 6572 2229 0a20 2020 2061  t_folder").    a
+0003a800: 7373 6572 7420 7265 7320 3d3d 205b 2274  ssert res == ["t
+0003a810: 6573 745f 6275 636b 6574 2f74 6573 745f  est_bucket/test_
+0003a820: 666f 6c64 6572 2f74 6573 742e 3122 2c20  folder/test.1", 
+0003a830: 2274 6573 745f 6275 636b 6574 2f74 6573  "test_bucket/tes
+0003a840: 745f 666f 6c64 6572 2f74 6573 742e 3222  t_folder/test.2"
+0003a850: 5d0a 2020 2020 6d6f 636b 5f75 706c 6f61  ].    mock_uploa
+0003a860: 642e 6173 7365 7274 5f68 6173 5f63 616c  d.assert_has_cal
+0003a870: 6c73 2863 616c 6c73 290a 0a0a 406d 6f63  ls(calls)...@moc
+0003a880: 6b2e 7061 7463 6828 226c 6f63 6f70 792e  k.patch("locopy.
+0003a890: 7333 2e53 332e 7570 6c6f 6164 5f74 6f5f  s3.S3.upload_to_
+0003a8a0: 7333 2229 0a40 6d6f 636b 2e70 6174 6368  s3").@mock.patch
+0003a8b0: 2822 6c6f 636f 7079 2e73 332e 5365 7373  ("locopy.s3.Sess
+0003a8c0: 696f 6e22 290a 6465 6620 7465 7374 5f75  ion").def test_u
+0003a8d0: 706c 6f61 645f 6c69 7374 5f74 6f5f 7333  pload_list_to_s3
+0003a8e0: 5f6d 756c 7469 706c 655f 7769 7468 6f75  _multiple_withou
+0003a8f0: 745f 666f 6c64 6572 286d 6f63 6b5f 7365  t_folder(mock_se
+0003a900: 7373 696f 6e2c 206d 6f63 6b5f 7570 6c6f  ssion, mock_uplo
+0003a910: 6164 293a 0a20 2020 2063 616c 6c73 203d  ad):.    calls =
+0003a920: 205b 0a20 2020 2020 2020 206d 6f63 6b2e   [.        mock.
+0003a930: 6361 6c6c 2822 7465 7374 2e31 222c 2022  call("test.1", "
+0003a940: 7465 7374 5f62 7563 6b65 7422 2c20 2274  test_bucket", "t
+0003a950: 6573 742e 3122 292c 0a20 2020 2020 2020  est.1"),.       
+0003a960: 206d 6f63 6b2e 6361 6c6c 2822 7465 7374   mock.call("test
+0003a970: 2e32 222c 2022 7465 7374 5f62 7563 6b65  .2", "test_bucke
+0003a980: 7422 2c20 2274 6573 742e 3222 292c 0a20  t", "test.2"),. 
+0003a990: 2020 205d 0a20 2020 2073 203d 206c 6f63     ].    s = loc
+0003a9a0: 6f70 792e 5333 2829 0a20 2020 2072 6573  opy.S3().    res
+0003a9b0: 203d 2073 2e75 706c 6f61 645f 6c69 7374   = s.upload_list
+0003a9c0: 5f74 6f5f 7333 285b 2274 6573 742e 3122  _to_s3(["test.1"
+0003a9d0: 2c20 2274 6573 742e 3222 5d2c 2022 7465  , "test.2"], "te
+0003a9e0: 7374 5f62 7563 6b65 7422 290a 2020 2020  st_bucket").    
+0003a9f0: 6173 7365 7274 2072 6573 203d 3d20 5b22  assert res == ["
+0003aa00: 7465 7374 5f62 7563 6b65 742f 7465 7374  test_bucket/test
+0003aa10: 2e31 222c 2022 7465 7374 5f62 7563 6b65  .1", "test_bucke
+0003aa20: 742f 7465 7374 2e32 225d 0a20 2020 206d  t/test.2"].    m
+0003aa30: 6f63 6b5f 7570 6c6f 6164 2e61 7373 6572  ock_upload.asser
+0003aa40: 745f 6861 735f 6361 6c6c 7328 6361 6c6c  t_has_calls(call
+0003aa50: 7329 0a0a 0a40 6d6f 636b 2e70 6174 6368  s)...@mock.patch
+0003aa60: 2822 6c6f 636f 7079 2e73 332e 5333 2e75  ("locopy.s3.S3.u
+0003aa70: 706c 6f61 645f 746f 5f73 3322 290a 406d  pload_to_s3").@m
+0003aa80: 6f63 6b2e 7061 7463 6828 226c 6f63 6f70  ock.patch("locop
+0003aa90: 792e 7333 2e53 6573 7369 6f6e 2229 0a64  y.s3.Session").d
+0003aaa0: 6566 2074 6573 745f 7570 6c6f 6164 5f6c  ef test_upload_l
+0003aab0: 6973 745f 746f 5f73 335f 6578 6365 7074  ist_to_s3_except
+0003aac0: 696f 6e28 6d6f 636b 5f73 6573 7369 6f6e  ion(mock_session
+0003aad0: 2c20 6d6f 636b 5f75 706c 6f61 6429 3a0a  , mock_upload):.
+0003aae0: 2020 2020 7320 3d20 6c6f 636f 7079 2e53      s = locopy.S
+0003aaf0: 3328 290a 2020 2020 6d6f 636b 5f75 706c  3().    mock_upl
+0003ab00: 6f61 642e 7369 6465 5f65 6666 6563 7420  oad.side_effect 
+0003ab10: 3d20 5333 5570 6c6f 6164 4572 726f 7228  = S3UploadError(
+0003ab20: 2255 706c 6f61 6420 4578 6365 7074 696f  "Upload Exceptio
+0003ab30: 6e22 290a 2020 2020 7769 7468 2070 7974  n").    with pyt
+0003ab40: 6573 742e 7261 6973 6573 2853 3355 706c  est.raises(S3Upl
+0003ab50: 6f61 6445 7272 6f72 293a 0a20 2020 2020  oadError):.     
+0003ab60: 2020 2073 2e75 706c 6f61 645f 6c69 7374     s.upload_list
+0003ab70: 5f74 6f5f 7333 285b 2274 6573 7431 222c  _to_s3(["test1",
+0003ab80: 2022 7465 7374 3222 5d2c 2022 7465 7374   "test2"], "test
+0003ab90: 5f62 7563 6b65 7422 2c20 2274 6573 745f  _bucket", "test_
+0003aba0: 666f 6c64 6572 2229 0a0a 0a40 6d6f 636b  folder")...@mock
+0003abb0: 2e70 6174 6368 2822 6c6f 636f 7079 2e73  .patch("locopy.s
+0003abc0: 332e 5472 616e 7366 6572 436f 6e66 6967  3.TransferConfig
+0003abd0: 2229 0a40 6d6f 636b 2e70 6174 6368 2822  ").@mock.patch("
+0003abe0: 6c6f 636f 7079 2e73 332e 5365 7373 696f  locopy.s3.Sessio
+0003abf0: 6e22 290a 6465 6620 7465 7374 5f64 6f77  n").def test_dow
+0003ac00: 6e6c 6f61 645f 6672 6f6d 5f73 3328 6d6f  nload_from_s3(mo
+0003ac10: 636b 5f73 6573 7369 6f6e 2c20 6d6f 636b  ck_session, mock
+0003ac20: 5f63 6f6e 6669 6729 3a0a 2020 2020 7320  _config):.    s 
+0003ac30: 3d20 6c6f 636f 7079 2e53 3328 290a 2020  = locopy.S3().  
+0003ac40: 2020 732e 646f 776e 6c6f 6164 5f66 726f    s.download_fro
+0003ac50: 6d5f 7333 2853 335f 4445 4641 554c 545f  m_s3(S3_DEFAULT_
+0003ac60: 4255 434b 4554 2c20 4c4f 4341 4c5f 5445  BUCKET, LOCAL_TE
+0003ac70: 5354 5f46 494c 452c 204c 4f43 414c 5f54  ST_FILE, LOCAL_T
+0003ac80: 4553 545f 4649 4c45 290a 2020 2020 732e  EST_FILE).    s.
+0003ac90: 7333 2e64 6f77 6e6c 6f61 645f 6669 6c65  s3.download_file
+0003aca0: 2e61 7373 6572 745f 6361 6c6c 6564 5f77  .assert_called_w
+0003acb0: 6974 6828 0a20 2020 2020 2020 2053 335f  ith(.        S3_
+0003acc0: 4445 4641 554c 545f 4255 434b 4554 2c20  DEFAULT_BUCKET, 
+0003acd0: 4c4f 4341 4c5f 5445 5354 5f46 494c 452c  LOCAL_TEST_FILE,
+0003ace0: 206f 732e 7061 7468 2e62 6173 656e 616d   os.path.basenam
+0003acf0: 6528 4c4f 4341 4c5f 5445 5354 5f46 494c  e(LOCAL_TEST_FIL
+0003ad00: 4529 2c20 436f 6e66 6967 3d6d 6f63 6b5f  E), Config=mock_
+0003ad10: 636f 6e66 6967 2829 0a20 2020 2029 0a0a  config().    )..
+0003ad20: 2020 2020 6d6f 636b 5f63 6f6e 6669 672e      mock_config.
+0003ad30: 7369 6465 5f65 6666 6563 7420 3d20 4578  side_effect = Ex
+0003ad40: 6365 7074 696f 6e28 290a 2020 2020 7769  ception().    wi
+0003ad50: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
+0003ad60: 2853 3344 6f77 6e6c 6f61 6445 7272 6f72  (S3DownloadError
+0003ad70: 293a 0a20 2020 2020 2020 2073 2e64 6f77  ):.        s.dow
+0003ad80: 6e6c 6f61 645f 6672 6f6d 5f73 3328 5333  nload_from_s3(S3
+0003ad90: 5f44 4546 4155 4c54 5f42 5543 4b45 542c  _DEFAULT_BUCKET,
+0003ada0: 204c 4f43 414c 5f54 4553 545f 4649 4c45   LOCAL_TEST_FILE
+0003adb0: 2c20 4c4f 4341 4c5f 5445 5354 5f46 494c  , LOCAL_TEST_FIL
+0003adc0: 4529 0a0a 0a40 6d6f 636b 2e70 6174 6368  E)...@mock.patch
+0003add0: 2822 6c6f 636f 7079 2e73 332e 5365 7373  ("locopy.s3.Sess
+0003ade0: 696f 6e22 290a 6465 6620 7465 7374 5f64  ion").def test_d
+0003adf0: 656c 6574 655f 6672 6f6d 5f73 3328 6d6f  elete_from_s3(mo
+0003ae00: 636b 5f73 6573 7369 6f6e 293a 0a20 2020  ck_session):.   
+0003ae10: 2073 203d 206c 6f63 6f70 792e 5333 2829   s = locopy.S3()
+0003ae20: 0a20 2020 2073 2e64 656c 6574 655f 6672  .    s.delete_fr
+0003ae30: 6f6d 5f73 3328 2254 4553 545f 4255 434b  om_s3("TEST_BUCK
+0003ae40: 4554 222c 2022 5445 5354 5f46 494c 4522  ET", "TEST_FILE"
+0003ae50: 290a 2020 2020 732e 7333 2e64 656c 6574  ).    s.s3.delet
+0003ae60: 655f 6f62 6a65 6374 2e61 7373 6572 745f  e_object.assert_
+0003ae70: 6361 6c6c 6564 5f77 6974 6828 4275 636b  called_with(Buck
+0003ae80: 6574 3d22 5445 5354 5f42 5543 4b45 5422  et="TEST_BUCKET"
+0003ae90: 2c20 4b65 793d 2254 4553 545f 4649 4c45  , Key="TEST_FILE
+0003aea0: 2229 0a0a 0a40 6d6f 636b 2e70 6174 6368  ")...@mock.patch
+0003aeb0: 2822 6c6f 636f 7079 2e73 332e 5365 7373  ("locopy.s3.Sess
+0003aec0: 696f 6e22 290a 6465 6620 7465 7374 5f64  ion").def test_d
+0003aed0: 656c 6574 655f 6672 6f6d 5f73 335f 6578  elete_from_s3_ex
+0003aee0: 6365 7074 696f 6e28 6d6f 636b 5f73 6573  ception(mock_ses
+0003aef0: 7369 6f6e 293a 0a20 2020 2073 203d 206c  sion):.    s = l
+0003af00: 6f63 6f70 792e 5333 2829 0a20 2020 2073  ocopy.S3().    s
+0003af10: 2e73 332e 6465 6c65 7465 5f6f 626a 6563  .s3.delete_objec
+0003af20: 742e 7369 6465 5f65 6666 6563 7420 3d20  t.side_effect = 
+0003af30: 4578 6365 7074 696f 6e28 2244 656c 6574  Exception("Delet
+0003af40: 6520 4578 6365 7074 696f 6e22 290a 2020  e Exception").  
+0003af50: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
+0003af60: 6973 6573 2853 3344 656c 6574 696f 6e45  ises(S3DeletionE
+0003af70: 7272 6f72 293a 0a20 2020 2020 2020 2073  rror):.        s
+0003af80: 2e64 656c 6574 655f 6672 6f6d 5f73 3328  .delete_from_s3(
+0003af90: 2254 4553 545f 4255 434b 4554 222c 2022  "TEST_BUCKET", "
+0003afa0: 5445 5354 5f46 494c 4522 290a 0a0a 406d  TEST_FILE")...@m
+0003afb0: 6f63 6b2e 7061 7463 6828 226c 6f63 6f70  ock.patch("locop
+0003afc0: 792e 7333 2e53 332e 6465 6c65 7465 5f66  y.s3.S3.delete_f
+0003afd0: 726f 6d5f 7333 2229 0a40 6d6f 636b 2e70  rom_s3").@mock.p
+0003afe0: 6174 6368 2822 6c6f 636f 7079 2e73 332e  atch("locopy.s3.
+0003aff0: 5365 7373 696f 6e22 290a 6465 6620 7465  Session").def te
+0003b000: 7374 5f64 656c 6574 655f 6c69 7374 5f66  st_delete_list_f
+0003b010: 726f 6d5f 7333 5f73 696e 676c 655f 7769  rom_s3_single_wi
+0003b020: 7468 5f66 6f6c 6465 7228 6d6f 636b 5f73  th_folder(mock_s
+0003b030: 6573 7369 6f6e 2c20 6d6f 636b 5f64 656c  ession, mock_del
+0003b040: 6574 6529 3a0a 2020 2020 6361 6c6c 7320  ete):.    calls 
+0003b050: 3d20 5b6d 6f63 6b2e 6361 6c6c 2822 7465  = [mock.call("te
+0003b060: 7374 5f62 7563 6b65 7422 2c20 2274 6573  st_bucket", "tes
+0003b070: 745f 666f 6c64 6572 2f74 6573 742e 3122  t_folder/test.1"
+0003b080: 295d 0a20 2020 2073 203d 206c 6f63 6f70  )].    s = locop
+0003b090: 792e 5333 2829 0a20 2020 2073 2e64 656c  y.S3().    s.del
+0003b0a0: 6574 655f 6c69 7374 5f66 726f 6d5f 7333  ete_list_from_s3
+0003b0b0: 285b 2274 6573 745f 6275 636b 6574 2f74  (["test_bucket/t
+0003b0c0: 6573 745f 666f 6c64 6572 2f74 6573 742e  est_folder/test.
+0003b0d0: 3122 5d29 0a20 2020 206d 6f63 6b5f 6465  1"]).    mock_de
+0003b0e0: 6c65 7465 2e61 7373 6572 745f 6861 735f  lete.assert_has_
+0003b0f0: 6361 6c6c 7328 6361 6c6c 7329 0a0a 0a40  calls(calls)...@
+0003b100: 6d6f 636b 2e70 6174 6368 2822 6c6f 636f  mock.patch("loco
+0003b110: 7079 2e73 332e 5333 2e64 656c 6574 655f  py.s3.S3.delete_
+0003b120: 6672 6f6d 5f73 3322 290a 406d 6f63 6b2e  from_s3").@mock.
+0003b130: 7061 7463 6828 226c 6f63 6f70 792e 7333  patch("locopy.s3
+0003b140: 2e53 6573 7369 6f6e 2229 0a64 6566 2074  .Session").def t
+0003b150: 6573 745f 6465 6c65 7465 5f6c 6973 745f  est_delete_list_
+0003b160: 6672 6f6d 5f73 335f 7369 6e67 6c65 5f77  from_s3_single_w
+0003b170: 6974 686f 7574 5f66 6f6c 6465 7228 6d6f  ithout_folder(mo
+0003b180: 636b 5f73 6573 7369 6f6e 2c20 6d6f 636b  ck_session, mock
+0003b190: 5f64 656c 6574 6529 3a0a 2020 2020 6361  _delete):.    ca
+0003b1a0: 6c6c 7320 3d20 5b6d 6f63 6b2e 6361 6c6c  lls = [mock.call
+0003b1b0: 2822 7465 7374 5f62 7563 6b65 7422 2c20  ("test_bucket", 
+0003b1c0: 2274 6573 742e 3122 295d 0a20 2020 2073  "test.1")].    s
+0003b1d0: 203d 206c 6f63 6f70 792e 5333 2829 0a20   = locopy.S3(). 
+0003b1e0: 2020 2073 2e64 656c 6574 655f 6c69 7374     s.delete_list
+0003b1f0: 5f66 726f 6d5f 7333 285b 2274 6573 745f  _from_s3(["test_
+0003b200: 6275 636b 6574 2f74 6573 742e 3122 5d29  bucket/test.1"])
+0003b210: 0a20 2020 206d 6f63 6b5f 6465 6c65 7465  .    mock_delete
+0003b220: 2e61 7373 6572 745f 6861 735f 6361 6c6c  .assert_has_call
+0003b230: 7328 6361 6c6c 7329 0a0a 0a40 6d6f 636b  s(calls)...@mock
+0003b240: 2e70 6174 6368 2822 6c6f 636f 7079 2e73  .patch("locopy.s
+0003b250: 332e 5333 2e64 656c 6574 655f 6672 6f6d  3.S3.delete_from
+0003b260: 5f73 3322 290a 406d 6f63 6b2e 7061 7463  _s3").@mock.patc
+0003b270: 6828 226c 6f63 6f70 792e 7333 2e53 6573  h("locopy.s3.Ses
+0003b280: 7369 6f6e 2229 0a64 6566 2074 6573 745f  sion").def test_
+0003b290: 6465 6c65 7465 5f6c 6973 745f 6672 6f6d  delete_list_from
+0003b2a0: 5f73 335f 6d75 6c74 6970 6c65 5f77 6974  _s3_multiple_wit
+0003b2b0: 685f 666f 6c64 6572 286d 6f63 6b5f 7365  h_folder(mock_se
+0003b2c0: 7373 696f 6e2c 206d 6f63 6b5f 6465 6c65  ssion, mock_dele
+0003b2d0: 7465 293a 0a20 2020 2063 616c 6c73 203d  te):.    calls =
+0003b2e0: 205b 0a20 2020 2020 2020 206d 6f63 6b2e   [.        mock.
+0003b2f0: 6361 6c6c 2822 7465 7374 5f62 7563 6b65  call("test_bucke
+0003b300: 7422 2c20 2274 6573 745f 666f 6c64 6572  t", "test_folder
+0003b310: 2f74 6573 742e 3122 292c 0a20 2020 2020  /test.1"),.     
+0003b320: 2020 206d 6f63 6b2e 6361 6c6c 2822 7465     mock.call("te
+0003b330: 7374 5f62 7563 6b65 7422 2c20 2274 6573  st_bucket", "tes
+0003b340: 745f 666f 6c64 6572 2f74 6573 742e 3222  t_folder/test.2"
+0003b350: 292c 0a20 2020 205d 0a20 2020 2073 203d  ),.    ].    s =
+0003b360: 206c 6f63 6f70 792e 5333 2829 0a20 2020   locopy.S3().   
+0003b370: 2073 2e64 656c 6574 655f 6c69 7374 5f66   s.delete_list_f
+0003b380: 726f 6d5f 7333 285b 2274 6573 745f 6275  rom_s3(["test_bu
+0003b390: 636b 6574 2f74 6573 745f 666f 6c64 6572  cket/test_folder
+0003b3a0: 2f74 6573 742e 3122 2c20 2274 6573 745f  /test.1", "test_
+0003b3b0: 6275 636b 6574 2f74 6573 745f 666f 6c64  bucket/test_fold
+0003b3c0: 6572 2f74 6573 742e 3222 5d29 0a20 2020  er/test.2"]).   
+0003b3d0: 206d 6f63 6b5f 6465 6c65 7465 2e61 7373   mock_delete.ass
+0003b3e0: 6572 745f 6861 735f 6361 6c6c 7328 6361  ert_has_calls(ca
+0003b3f0: 6c6c 7329 0a0a 0a40 6d6f 636b 2e70 6174  lls)...@mock.pat
+0003b400: 6368 2822 6c6f 636f 7079 2e73 332e 5333  ch("locopy.s3.S3
+0003b410: 2e64 656c 6574 655f 6672 6f6d 5f73 3322  .delete_from_s3"
+0003b420: 290a 406d 6f63 6b2e 7061 7463 6828 226c  ).@mock.patch("l
+0003b430: 6f63 6f70 792e 7333 2e53 6573 7369 6f6e  ocopy.s3.Session
+0003b440: 2229 0a64 6566 2074 6573 745f 6465 6c65  ").def test_dele
+0003b450: 7465 5f6c 6973 745f 6672 6f6d 5f73 335f  te_list_from_s3_
+0003b460: 6d75 6c74 6970 6c65 5f77 6974 686f 7574  multiple_without
+0003b470: 5f66 6f6c 6465 7228 6d6f 636b 5f73 6573  _folder(mock_ses
+0003b480: 7369 6f6e 2c20 6d6f 636b 5f64 656c 6574  sion, mock_delet
+0003b490: 6529 3a0a 2020 2020 6361 6c6c 7320 3d20  e):.    calls = 
+0003b4a0: 5b6d 6f63 6b2e 6361 6c6c 2822 7465 7374  [mock.call("test
+0003b4b0: 5f62 7563 6b65 7422 2c20 2274 6573 742e  _bucket", "test.
+0003b4c0: 3122 292c 206d 6f63 6b2e 6361 6c6c 2822  1"), mock.call("
+0003b4d0: 7465 7374 5f62 7563 6b65 7422 2c20 2274  test_bucket", "t
+0003b4e0: 6573 742e 3222 295d 0a20 2020 2073 203d  est.2")].    s =
+0003b4f0: 206c 6f63 6f70 792e 5333 2829 0a20 2020   locopy.S3().   
+0003b500: 2073 2e64 656c 6574 655f 6c69 7374 5f66   s.delete_list_f
+0003b510: 726f 6d5f 7333 285b 2274 6573 745f 6275  rom_s3(["test_bu
+0003b520: 636b 6574 2f74 6573 742e 3122 2c20 2274  cket/test.1", "t
+0003b530: 6573 745f 6275 636b 6574 2f74 6573 742e  est_bucket/test.
+0003b540: 3222 5d29 0a20 2020 206d 6f63 6b5f 6465  2"]).    mock_de
+0003b550: 6c65 7465 2e61 7373 6572 745f 6861 735f  lete.assert_has_
+0003b560: 6361 6c6c 7328 6361 6c6c 7329 0a0a 0a40  calls(calls)...@
+0003b570: 6d6f 636b 2e70 6174 6368 2822 6c6f 636f  mock.patch("loco
+0003b580: 7079 2e73 332e 5333 2e64 656c 6574 655f  py.s3.S3.delete_
+0003b590: 6672 6f6d 5f73 3322 290a 406d 6f63 6b2e  from_s3").@mock.
+0003b5a0: 7061 7463 6828 226c 6f63 6f70 792e 7333  patch("locopy.s3
+0003b5b0: 2e53 6573 7369 6f6e 2229 0a64 6566 2074  .Session").def t
+0003b5c0: 6573 745f 6465 6c65 7465 5f6c 6973 745f  est_delete_list_
+0003b5d0: 6672 6f6d 5f73 335f 7369 6e67 6c65 5f77  from_s3_single_w
+0003b5e0: 6974 685f 666f 6c64 6572 5f61 6e64 5f73  ith_folder_and_s
+0003b5f0: 7065 6369 616c 5f63 6861 7273 286d 6f63  pecial_chars(moc
+0003b600: 6b5f 7365 7373 696f 6e2c 206d 6f63 6b5f  k_session, mock_
+0003b610: 6465 6c65 7465 293a 0a20 2020 2063 616c  delete):.    cal
+0003b620: 6c73 203d 205b 6d6f 636b 2e63 616c 6c28  ls = [mock.call(
+0003b630: 2274 6573 745f 6275 636b 6574 222c 2072  "test_bucket", r
+0003b640: 2274 6573 745f 666f 6c64 6572 2f23 2423  "test_folder/#$#
+0003b650: 4024 4023 2464 6666 6b73 646f 6a66 7364  @$@#$dffksdojfsd
+0003b660: 665c 5c5c 5c5c 2f74 6573 742e 3122 295d  f\\\\\/test.1")]
+0003b670: 0a20 2020 2073 203d 206c 6f63 6f70 792e  .    s = locopy.
+0003b680: 5333 2829 0a20 2020 2073 2e64 656c 6574  S3().    s.delet
+0003b690: 655f 6c69 7374 5f66 726f 6d5f 7333 285b  e_list_from_s3([
+0003b6a0: 7222 7465 7374 5f62 7563 6b65 742f 7465  r"test_bucket/te
+0003b6b0: 7374 5f66 6f6c 6465 722f 2324 2340 2440  st_folder/#$#@$@
+0003b6c0: 2324 6466 666b 7364 6f6a 6673 6466 5c5c  #$dffksdojfsdf\\
+0003b6d0: 5c5c 5c2f 7465 7374 2e31 225d 290a 2020  \\\/test.1"]).  
+0003b6e0: 2020 6d6f 636b 5f64 656c 6574 652e 6173    mock_delete.as
+0003b6f0: 7365 7274 5f68 6173 5f63 616c 6c73 2863  sert_has_calls(c
+0003b700: 616c 6c73 290a 0a0a 406d 6f63 6b2e 7061  alls)...@mock.pa
+0003b710: 7463 6828 226c 6f63 6f70 792e 7333 2e53  tch("locopy.s3.S
+0003b720: 332e 6465 6c65 7465 5f66 726f 6d5f 7333  3.delete_from_s3
+0003b730: 2229 0a40 6d6f 636b 2e70 6174 6368 2822  ").@mock.patch("
+0003b740: 6c6f 636f 7079 2e73 332e 5365 7373 696f  locopy.s3.Sessio
+0003b750: 6e22 290a 6465 6620 7465 7374 5f64 656c  n").def test_del
+0003b760: 6574 655f 6c69 7374 5f66 726f 6d5f 7333  ete_list_from_s3
+0003b770: 5f65 7863 6570 7469 6f6e 286d 6f63 6b5f  _exception(mock_
+0003b780: 7365 7373 696f 6e2c 206d 6f63 6b5f 6465  session, mock_de
+0003b790: 6c65 7465 293a 0a20 2020 2073 203d 206c  lete):.    s = l
+0003b7a0: 6f63 6f70 792e 5333 2829 0a20 2020 206d  ocopy.S3().    m
+0003b7b0: 6f63 6b5f 6465 6c65 7465 2e73 6964 655f  ock_delete.side_
+0003b7c0: 6566 6665 6374 203d 2053 3355 706c 6f61  effect = S3Uploa
+0003b7d0: 6445 7272 6f72 2822 5570 6c6f 6164 2045  dError("Upload E
+0003b7e0: 7863 6570 7469 6f6e 2229 0a20 2020 2077  xception").    w
+0003b7f0: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+0003b800: 7328 5333 5570 6c6f 6164 4572 726f 7229  s(S3UploadError)
+0003b810: 3a0a 2020 2020 2020 2020 732e 6465 6c65  :.        s.dele
+0003b820: 7465 5f6c 6973 745f 6672 6f6d 5f73 3328  te_list_from_s3(
+0003b830: 5b22 7465 7374 5f62 7563 6b65 742f 7465  ["test_bucket/te
+0003b840: 7374 5f66 6f6c 6465 722f 7465 7374 2e31  st_folder/test.1
+0003b850: 222c 2022 7465 7374 5f62 7563 6b65 742f  ", "test_bucket/
+0003b860: 7465 7374 5f66 6f6c 6465 722f 7465 7374  test_folder/test
+0003b870: 2e32 225d 290a 0a0a 406d 6f63 6b2e 7061  .2"])...@mock.pa
+0003b880: 7463 6828 226c 6f63 6f70 792e 7333 2e53  tch("locopy.s3.S
+0003b890: 6573 7369 6f6e 2229 0a64 6566 2074 6573  ession").def tes
+0003b8a0: 745f 7061 7273 655f 7333 5f75 726c 286d  t_parse_s3_url(m
+0003b8b0: 6f63 6b5f 7365 7373 696f 6e29 3a0a 2020  ock_session):.  
+0003b8c0: 2020 7320 3d20 6c6f 636f 7079 2e53 3328    s = locopy.S3(
+0003b8d0: 290a 2020 2020 6173 7365 7274 2073 2e70  ).    assert s.p
+0003b8e0: 6172 7365 5f73 335f 7572 6c28 2273 333a  arse_s3_url("s3:
+0003b8f0: 2f2f 6275 636b 6574 2f66 6f6c 6465 722f  //bucket/folder/
+0003b900: 6669 6c65 2e74 7874 2229 203d 3d20 2822  file.txt") == ("
+0003b910: 6275 636b 6574 222c 2022 666f 6c64 6572  bucket", "folder
+0003b920: 2f66 696c 652e 7478 7422 290a 2020 2020  /file.txt").    
+0003b930: 6173 7365 7274 2073 2e70 6172 7365 5f73  assert s.parse_s
+0003b940: 335f 7572 6c28 2273 333a 2f2f 6275 636b  3_url("s3://buck
+0003b950: 6574 2f66 6f6c 6465 722f 2229 203d 3d20  et/folder/") == 
+0003b960: 2822 6275 636b 6574 222c 2022 666f 6c64  ("bucket", "fold
+0003b970: 6572 2f22 290a 2020 2020 6173 7365 7274  er/").    assert
+0003b980: 2073 2e70 6172 7365 5f73 335f 7572 6c28   s.parse_s3_url(
+0003b990: 2273 333a 2f2f 6275 636b 6574 2229 203d  "s3://bucket") =
+0003b9a0: 3d20 2822 6275 636b 6574 222c 2022 2229  = ("bucket", "")
+0003b9b0: 0a20 2020 2061 7373 6572 7420 732e 7061  .    assert s.pa
+0003b9c0: 7273 655f 7333 5f75 726c 2872 2273 333a  rse_s3_url(r"s3:
+0003b9d0: 2f2f 6275 636b 6574 2f21 4023 2425 5c5c  //bucket/!@#$%\\
+0003b9e0: 5c2f 6669 6c65 2e74 7874 2229 203d 3d20  \/file.txt") == 
+0003b9f0: 2822 6275 636b 6574 222c 2072 2221 4023  ("bucket", r"!@#
+0003ba00: 2425 5c5c 5c2f 6669 6c65 2e74 7874 2229  $%\\\/file.txt")
+0003ba10: 0a20 2020 2061 7373 6572 7420 732e 7061  .    assert s.pa
+0003ba20: 7273 655f 7333 5f75 726c 2822 7333 3a2f  rse_s3_url("s3:/
+0003ba30: 2f22 2920 3d3d 2028 2222 2c20 2222 290a  /") == ("", "").
+0003ba40: 0a20 2020 2061 7373 6572 7420 732e 7061  .    assert s.pa
+0003ba50: 7273 655f 7333 5f75 726c 2822 6275 636b  rse_s3_url("buck
+0003ba60: 6574 2f66 6f6c 6465 722f 6669 6c65 2e74  et/folder/file.t
+0003ba70: 7874 2229 203d 3d20 2822 6275 636b 6574  xt") == ("bucket
+0003ba80: 222c 2022 666f 6c64 6572 2f66 696c 652e  ", "folder/file.
+0003ba90: 7478 7422 290a 2020 2020 6173 7365 7274  txt").    assert
+0003baa0: 2073 2e70 6172 7365 5f73 335f 7572 6c28   s.parse_s3_url(
+0003bab0: 2262 7563 6b65 742f 666f 6c64 6572 2f22  "bucket/folder/"
+0003bac0: 2920 3d3d 2028 2262 7563 6b65 7422 2c20  ) == ("bucket", 
+0003bad0: 2266 6f6c 6465 722f 2229 0a20 2020 2061  "folder/").    a
+0003bae0: 7373 6572 7420 732e 7061 7273 655f 7333  ssert s.parse_s3
+0003baf0: 5f75 726c 2822 6275 636b 6574 2229 203d  _url("bucket") =
+0003bb00: 3d20 2822 6275 636b 6574 222c 2022 2229  = ("bucket", "")
+0003bb10: 0a20 2020 2061 7373 6572 7420 732e 7061  .    assert s.pa
+0003bb20: 7273 655f 7333 5f75 726c 2872 2262 7563  rse_s3_url(r"buc
+0003bb30: 6b65 742f 2140 2324 255c 5c5c 2f66 696c  ket/!@#$%\\\/fil
+0003bb40: 652e 7478 7422 2920 3d3d 2028 2262 7563  e.txt") == ("buc
+0003bb50: 6b65 7422 2c20 7222 2140 2324 255c 5c5c  ket", r"!@#$%\\\
+0003bb60: 2f66 696c 652e 7478 7422 290a 2020 2020  /file.txt").    
+0003bb70: 6173 7365 7274 2073 2e70 6172 7365 5f73  assert s.parse_s
+0003bb80: 335f 7572 6c28 2222 2920 3d3d 2028 2222  3_url("") == (""
+0003bb90: 2c20 2222 290a 0a0a 406d 6f63 6b2e 7061  , "")...@mock.pa
+0003bba0: 7463 6828 226c 6f63 6f70 792e 7333 2e53  tch("locopy.s3.S
+0003bbb0: 332e 646f 776e 6c6f 6164 5f66 726f 6d5f  3.download_from_
+0003bbc0: 7333 2229 0a40 6d6f 636b 2e70 6174 6368  s3").@mock.patch
+0003bbd0: 2822 6c6f 636f 7079 2e73 332e 5365 7373  ("locopy.s3.Sess
+0003bbe0: 696f 6e22 290a 6465 6620 7465 7374 5f64  ion").def test_d
+0003bbf0: 6f77 6e6c 6f61 645f 6c69 7374 5f66 726f  ownload_list_fro
+0003bc00: 6d5f 7333 5f73 696e 676c 6528 6d6f 636b  m_s3_single(mock
+0003bc10: 5f73 6573 7369 6f6e 2c20 6d6f 636b 5f64  _session, mock_d
+0003bc20: 6f77 6e6c 6f61 6429 3a0a 2020 2020 6361  ownload):.    ca
+0003bc30: 6c6c 7320 3d20 5b6d 6f63 6b2e 6361 6c6c  lls = [mock.call
+0003bc40: 2822 6275 636b 6574 222c 2022 7465 7374  ("bucket", "test
+0003bc50: 2e31 222c 206f 732e 7061 7468 2e6a 6f69  .1", os.path.joi
+0003bc60: 6e28 6f73 2e67 6574 6377 6428 292c 2022  n(os.getcwd(), "
+0003bc70: 7465 7374 2e31 2229 295d 0a20 2020 2073  test.1"))].    s
+0003bc80: 203d 206c 6f63 6f70 792e 5333 2829 0a20   = locopy.S3(). 
+0003bc90: 2020 2072 6573 203d 2073 2e64 6f77 6e6c     res = s.downl
+0003bca0: 6f61 645f 6c69 7374 5f66 726f 6d5f 7333  oad_list_from_s3
+0003bcb0: 285b 2273 333a 2f2f 6275 636b 6574 2f74  (["s3://bucket/t
+0003bcc0: 6573 742e 3122 5d29 0a20 2020 2061 7373  est.1"]).    ass
+0003bcd0: 6572 7420 7265 7320 3d3d 205b 6f73 2e70  ert res == [os.p
+0003bce0: 6174 682e 6a6f 696e 286f 732e 6765 7463  ath.join(os.getc
+0003bcf0: 7764 2829 2c20 2274 6573 742e 3122 295d  wd(), "test.1")]
+0003bd00: 0a20 2020 206d 6f63 6b5f 646f 776e 6c6f  .    mock_downlo
+0003bd10: 6164 2e61 7373 6572 745f 6861 735f 6361  ad.assert_has_ca
+0003bd20: 6c6c 7328 6361 6c6c 7329 0a0a 0a40 6d6f  lls(calls)...@mo
+0003bd30: 636b 2e70 6174 6368 2822 6c6f 636f 7079  ck.patch("locopy
+0003bd40: 2e73 332e 5333 2e64 6f77 6e6c 6f61 645f  .s3.S3.download_
+0003bd50: 6672 6f6d 5f73 3322 290a 406d 6f63 6b2e  from_s3").@mock.
+0003bd60: 7061 7463 6828 226c 6f63 6f70 792e 7333  patch("locopy.s3
+0003bd70: 2e53 6573 7369 6f6e 2229 0a64 6566 2074  .Session").def t
+0003bd80: 6573 745f 646f 776e 6c6f 6164 5f6c 6973  est_download_lis
+0003bd90: 745f 6672 6f6d 5f73 335f 7369 6e67 6c65  t_from_s3_single
+0003bda0: 5f77 6974 685f 6c6f 6361 6c70 6174 6828  _with_localpath(
+0003bdb0: 6d6f 636b 5f73 6573 7369 6f6e 2c20 6d6f  mock_session, mo
+0003bdc0: 636b 5f64 6f77 6e6c 6f61 6429 3a0a 2020  ck_download):.  
+0003bdd0: 2020 746d 705f 7061 7468 203d 2074 656d    tmp_path = tem
+0003bde0: 7066 696c 652e 5465 6d70 6f72 6172 7944  pfile.TemporaryD
+0003bdf0: 6972 6563 746f 7279 2829 0a20 2020 2063  irectory().    c
+0003be00: 616c 6c73 203d 205b 6d6f 636b 2e63 616c  alls = [mock.cal
+0003be10: 6c28 2262 7563 6b65 7422 2c20 2274 6573  l("bucket", "tes
+0003be20: 742e 3122 2c20 6f73 2e70 6174 682e 6a6f  t.1", os.path.jo
+0003be30: 696e 2874 6d70 5f70 6174 682e 6e61 6d65  in(tmp_path.name
+0003be40: 2c20 2274 6573 742e 3122 2929 5d0a 2020  , "test.1"))].  
+0003be50: 2020 7320 3d20 6c6f 636f 7079 2e53 3328    s = locopy.S3(
+0003be60: 290a 2020 2020 7265 7320 3d20 732e 646f  ).    res = s.do
+0003be70: 776e 6c6f 6164 5f6c 6973 745f 6672 6f6d  wnload_list_from
+0003be80: 5f73 3328 5b22 7333 3a2f 2f62 7563 6b65  _s3(["s3://bucke
+0003be90: 742f 7465 7374 2e31 225d 2c20 746d 705f  t/test.1"], tmp_
+0003bea0: 7061 7468 2e6e 616d 6529 0a20 2020 2061  path.name).    a
+0003beb0: 7373 6572 7420 7265 7320 3d3d 205b 6f73  ssert res == [os
+0003bec0: 2e70 6174 682e 6a6f 696e 2874 6d70 5f70  .path.join(tmp_p
+0003bed0: 6174 682e 6e61 6d65 2c20 2274 6573 742e  ath.name, "test.
+0003bee0: 3122 295d 0a20 2020 206d 6f63 6b5f 646f  1")].    mock_do
+0003bef0: 776e 6c6f 6164 2e61 7373 6572 745f 6861  wnload.assert_ha
+0003bf00: 735f 6361 6c6c 7328 6361 6c6c 7329 0a20  s_calls(calls). 
+0003bf10: 2020 2074 6d70 5f70 6174 682e 636c 6561     tmp_path.clea
+0003bf20: 6e75 7028 290a 0a0a 406d 6f63 6b2e 7061  nup()...@mock.pa
+0003bf30: 7463 6828 226c 6f63 6f70 792e 7333 2e53  tch("locopy.s3.S
+0003bf40: 332e 646f 776e 6c6f 6164 5f66 726f 6d5f  3.download_from_
+0003bf50: 7333 2229 0a40 6d6f 636b 2e70 6174 6368  s3").@mock.patch
+0003bf60: 2822 6c6f 636f 7079 2e73 332e 5365 7373  ("locopy.s3.Sess
+0003bf70: 696f 6e22 290a 6465 6620 7465 7374 5f64  ion").def test_d
+0003bf80: 6f77 6e6c 6f61 645f 6c69 7374 5f66 726f  ownload_list_fro
+0003bf90: 6d5f 7333 5f6d 756c 7469 706c 6528 6d6f  m_s3_multiple(mo
+0003bfa0: 636b 5f73 6573 7369 6f6e 2c20 6d6f 636b  ck_session, mock
+0003bfb0: 5f64 6f77 6e6c 6f61 6429 3a0a 2020 2020  _download):.    
+0003bfc0: 6361 6c6c 7320 3d20 5b0a 2020 2020 2020  calls = [.      
+0003bfd0: 2020 6d6f 636b 2e63 616c 6c28 2262 7563    mock.call("buc
+0003bfe0: 6b65 7422 2c20 2274 6573 742e 3122 2c20  ket", "test.1", 
+0003bff0: 6f73 2e70 6174 682e 6a6f 696e 286f 732e  os.path.join(os.
+0003c000: 6765 7463 7764 2829 2c20 2274 6573 742e  getcwd(), "test.
+0003c010: 3122 2929 2c0a 2020 2020 2020 2020 6d6f  1")),.        mo
+0003c020: 636b 2e63 616c 6c28 2262 7563 6b65 7422  ck.call("bucket"
+0003c030: 2c20 2274 6573 742e 3222 2c20 6f73 2e70  , "test.2", os.p
+0003c040: 6174 682e 6a6f 696e 286f 732e 6765 7463  ath.join(os.getc
+0003c050: 7764 2829 2c20 2274 6573 742e 3222 2929  wd(), "test.2"))
+0003c060: 2c0a 2020 2020 5d0a 2020 2020 7320 3d20  ,.    ].    s = 
+0003c070: 6c6f 636f 7079 2e53 3328 290a 2020 2020  locopy.S3().    
+0003c080: 7265 7320 3d20 732e 646f 776e 6c6f 6164  res = s.download
+0003c090: 5f6c 6973 745f 6672 6f6d 5f73 3328 5b22  _list_from_s3(["
+0003c0a0: 7333 3a2f 2f62 7563 6b65 742f 7465 7374  s3://bucket/test
+0003c0b0: 2e31 222c 2022 7333 3a2f 2f62 7563 6b65  .1", "s3://bucke
+0003c0c0: 742f 7465 7374 2e32 225d 290a 2020 2020  t/test.2"]).    
+0003c0d0: 6173 7365 7274 2072 6573 203d 3d20 5b6f  assert res == [o
+0003c0e0: 732e 7061 7468 2e6a 6f69 6e28 6f73 2e67  s.path.join(os.g
+0003c0f0: 6574 6377 6428 292c 2022 7465 7374 2e31  etcwd(), "test.1
+0003c100: 2229 2c20 6f73 2e70 6174 682e 6a6f 696e  "), os.path.join
+0003c110: 286f 732e 6765 7463 7764 2829 2c20 2274  (os.getcwd(), "t
+0003c120: 6573 742e 3222 295d 0a20 2020 206d 6f63  est.2")].    moc
+0003c130: 6b5f 646f 776e 6c6f 6164 2e61 7373 6572  k_download.asser
+0003c140: 745f 6861 735f 6361 6c6c 7328 6361 6c6c  t_has_calls(call
+0003c150: 7329 0a0a 0a40 6d6f 636b 2e70 6174 6368  s)...@mock.patch
+0003c160: 2822 6c6f 636f 7079 2e73 332e 5333 2e64  ("locopy.s3.S3.d
+0003c170: 6f77 6e6c 6f61 645f 6672 6f6d 5f73 3322  ownload_from_s3"
+0003c180: 290a 406d 6f63 6b2e 7061 7463 6828 226c  ).@mock.patch("l
+0003c190: 6f63 6f70 792e 7333 2e53 6573 7369 6f6e  ocopy.s3.Session
+0003c1a0: 2229 0a64 6566 2074 6573 745f 646f 776e  ").def test_down
+0003c1b0: 6c6f 6164 5f6c 6973 745f 6672 6f6d 5f73  load_list_from_s
+0003c1c0: 335f 6d75 6c74 6970 6c65 5f77 6974 685f  3_multiple_with_
+0003c1d0: 6c6f 6361 6c70 6174 6828 6d6f 636b 5f73  localpath(mock_s
+0003c1e0: 6573 7369 6f6e 2c20 6d6f 636b 5f64 6f77  ession, mock_dow
+0003c1f0: 6e6c 6f61 6429 3a0a 2020 2020 746d 705f  nload):.    tmp_
+0003c200: 7061 7468 203d 2074 656d 7066 696c 652e  path = tempfile.
+0003c210: 5465 6d70 6f72 6172 7944 6972 6563 746f  TemporaryDirecto
+0003c220: 7279 2829 0a20 2020 2063 616c 6c73 203d  ry().    calls =
+0003c230: 205b 0a20 2020 2020 2020 206d 6f63 6b2e   [.        mock.
+0003c240: 6361 6c6c 2822 6275 636b 6574 222c 2022  call("bucket", "
+0003c250: 7465 7374 2e31 222c 206f 732e 7061 7468  test.1", os.path
+0003c260: 2e6a 6f69 6e28 746d 705f 7061 7468 2e6e  .join(tmp_path.n
+0003c270: 616d 652c 2022 7465 7374 2e31 2229 292c  ame, "test.1")),
+0003c280: 0a20 2020 2020 2020 206d 6f63 6b2e 6361  .        mock.ca
+0003c290: 6c6c 2822 6275 636b 6574 222c 2022 7465  ll("bucket", "te
+0003c2a0: 7374 2e32 222c 206f 732e 7061 7468 2e6a  st.2", os.path.j
+0003c2b0: 6f69 6e28 746d 705f 7061 7468 2e6e 616d  oin(tmp_path.nam
+0003c2c0: 652c 2022 7465 7374 2e32 2229 292c 0a20  e, "test.2")),. 
+0003c2d0: 2020 205d 0a20 2020 2073 203d 206c 6f63     ].    s = loc
+0003c2e0: 6f70 792e 5333 2829 0a20 2020 2072 6573  opy.S3().    res
+0003c2f0: 203d 2073 2e64 6f77 6e6c 6f61 645f 6c69   = s.download_li
+0003c300: 7374 5f66 726f 6d5f 7333 285b 2273 333a  st_from_s3(["s3:
+0003c310: 2f2f 6275 636b 6574 2f74 6573 742e 3122  //bucket/test.1"
+0003c320: 2c20 2273 333a 2f2f 6275 636b 6574 2f74  , "s3://bucket/t
+0003c330: 6573 742e 3222 5d2c 2074 6d70 5f70 6174  est.2"], tmp_pat
+0003c340: 682e 6e61 6d65 290a 2020 2020 6173 7365  h.name).    asse
+0003c350: 7274 2072 6573 203d 3d20 5b6f 732e 7061  rt res == [os.pa
+0003c360: 7468 2e6a 6f69 6e28 746d 705f 7061 7468  th.join(tmp_path
+0003c370: 2e6e 616d 652c 2022 7465 7374 2e31 2229  .name, "test.1")
+0003c380: 2c20 6f73 2e70 6174 682e 6a6f 696e 2874  , os.path.join(t
+0003c390: 6d70 5f70 6174 682e 6e61 6d65 2c20 2274  mp_path.name, "t
+0003c3a0: 6573 742e 3222 295d 0a20 2020 206d 6f63  est.2")].    moc
+0003c3b0: 6b5f 646f 776e 6c6f 6164 2e61 7373 6572  k_download.asser
+0003c3c0: 745f 6861 735f 6361 6c6c 7328 6361 6c6c  t_has_calls(call
+0003c3d0: 7329 0a20 2020 2074 6d70 5f70 6174 682e  s).    tmp_path.
+0003c3e0: 636c 6561 6e75 7028 290a 0a0a 406d 6f63  cleanup()...@moc
+0003c3f0: 6b2e 7061 7463 6828 226c 6f63 6f70 792e  k.patch("locopy.
+0003c400: 7333 2e53 332e 646f 776e 6c6f 6164 5f66  s3.S3.download_f
+0003c410: 726f 6d5f 7333 2229 0a40 6d6f 636b 2e70  rom_s3").@mock.p
+0003c420: 6174 6368 2822 6c6f 636f 7079 2e73 332e  atch("locopy.s3.
+0003c430: 5365 7373 696f 6e22 290a 6465 6620 7465  Session").def te
+0003c440: 7374 5f64 6f77 6e6c 6f61 645f 6c69 7374  st_download_list
+0003c450: 5f66 726f 6d5f 7333 5f65 7863 6570 7469  _from_s3_excepti
+0003c460: 6f6e 286d 6f63 6b5f 7365 7373 696f 6e2c  on(mock_session,
+0003c470: 206d 6f63 6b5f 646f 776e 6c6f 6164 293a   mock_download):
+0003c480: 0a20 2020 2073 203d 206c 6f63 6f70 792e  .    s = locopy.
+0003c490: 5333 2829 0a20 2020 206d 6f63 6b5f 646f  S3().    mock_do
+0003c4a0: 776e 6c6f 6164 2e73 6964 655f 6566 6665  wnload.side_effe
+0003c4b0: 6374 203d 2053 3344 6f77 6e6c 6f61 6445  ct = S3DownloadE
+0003c4c0: 7272 6f72 2822 446f 776e 6c6f 6164 2045  rror("Download E
+0003c4d0: 7863 6570 7469 6f6e 2229 0a20 2020 2077  xception").    w
+0003c4e0: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+0003c4f0: 7328 5333 446f 776e 6c6f 6164 4572 726f  s(S3DownloadErro
+0003c500: 7229 3a0a 2020 2020 2020 2020 732e 646f  r):.        s.do
+0003c510: 776e 6c6f 6164 5f6c 6973 745f 6672 6f6d  wnload_list_from
+0003c520: 5f73 3328 5b22 7333 3a2f 2f62 7563 6b65  _s3(["s3://bucke
+0003c530: 742f 7465 7374 2e31 222c 2022 7333 3a2f  t/test.1", "s3:/
+0003c540: 2f62 7563 6b65 742f 7465 7374 2e32 225d  /bucket/test.2"]
+0003c550: 290a 0000 0000 0000 0000 0000 0000 0000  )...............
+0003c560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c5a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c5b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c5c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c5d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c5e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c5f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c600: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+0003c610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c660: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+0003c670: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+0003c680: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+0003c690: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+0003c6a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c6b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c6c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c6d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c6e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c6f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c700: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+0003c710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c740: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0003c750: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0003c760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c7a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c7b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c7c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c7d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c7e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c7f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c800: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+0003c810: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
+0003c820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c8a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c8b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c8c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c8d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c8e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c8f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c9a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c9b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c9c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c9d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c9e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003c9f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ca00: 6c6f 636f 7079 2d30 2e35 2e31 2f74 6573  locopy-0.5.1/tes
+0003ca10: 7473 2f74 6573 745f 736e 6f77 666c 616b  ts/test_snowflak
+0003ca20: 652e 7079 0000 0000 0000 0000 0000 0000  e.py............
+0003ca30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ca40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ca50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003ca60: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+0003ca70: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+0003ca80: 3030 3433 3332 3100 3030 3030 3030 3030  0043321.00000000
+0003ca90: 3030 3000 3032 3033 3733 0020 3000 0000  000.020373. 0...
+0003caa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003cab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003cac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003cad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003cae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003caf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003cb00: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+0003cb10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003cb20: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+0003cb30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003cb40: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+0003cb50: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+0003cb60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003cb70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003cb80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003cb90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003cba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003cbb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003cbc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003cbd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003cbe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003cbf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+0003cc00: 2320 4d49 5420 4c69 6365 6e73 650a 230a  # MIT License.#.
+0003cc10: 2320 436f 7079 7269 6768 7420 2863 2920  # Copyright (c) 
+0003cc20: 3230 3138 2043 6170 6974 616c 204f 6e65  2018 Capital One
+0003cc30: 2053 6572 7669 6365 732c 204c 4c43 0a23   Services, LLC.#
+0003cc40: 0a23 2050 6572 6d69 7373 696f 6e20 6973  .# Permission is
+0003cc50: 2068 6572 6562 7920 6772 616e 7465 642c   hereby granted,
+0003cc60: 2066 7265 6520 6f66 2063 6861 7267 652c   free of charge,
+0003cc70: 2074 6f20 616e 7920 7065 7273 6f6e 206f   to any person o
+0003cc80: 6274 6169 6e69 6e67 2061 2063 6f70 790a  btaining a copy.
+0003cc90: 2320 6f66 2074 6869 7320 736f 6674 7761  # of this softwa
+0003cca0: 7265 2061 6e64 2061 7373 6f63 6961 7465  re and associate
+0003ccb0: 6420 646f 6375 6d65 6e74 6174 696f 6e20  d documentation 
+0003ccc0: 6669 6c65 7320 2874 6865 2022 536f 6674  files (the "Soft
+0003ccd0: 7761 7265 2229 2c20 746f 2064 6561 6c0a  ware"), to deal.
+0003cce0: 2320 696e 2074 6865 2053 6f66 7477 6172  # in the Softwar
+0003ccf0: 6520 7769 7468 6f75 7420 7265 7374 7269  e without restri
+0003cd00: 6374 696f 6e2c 2069 6e63 6c75 6469 6e67  ction, including
+0003cd10: 2077 6974 686f 7574 206c 696d 6974 6174   without limitat
+0003cd20: 696f 6e20 7468 6520 7269 6768 7473 0a23  ion the rights.#
+0003cd30: 2074 6f20 7573 652c 2063 6f70 792c 206d   to use, copy, m
+0003cd40: 6f64 6966 792c 206d 6572 6765 2c20 7075  odify, merge, pu
+0003cd50: 626c 6973 682c 2064 6973 7472 6962 7574  blish, distribut
+0003cd60: 652c 2073 7562 6c69 6365 6e73 652c 2061  e, sublicense, a
+0003cd70: 6e64 2f6f 7220 7365 6c6c 0a23 2063 6f70  nd/or sell.# cop
+0003cd80: 6965 7320 6f66 2074 6865 2053 6f66 7477  ies of the Softw
+0003cd90: 6172 652c 2061 6e64 2074 6f20 7065 726d  are, and to perm
+0003cda0: 6974 2070 6572 736f 6e73 2074 6f20 7768  it persons to wh
+0003cdb0: 6f6d 2074 6865 2053 6f66 7477 6172 6520  om the Software 
+0003cdc0: 6973 0a23 2066 7572 6e69 7368 6564 2074  is.# furnished t
+0003cdd0: 6f20 646f 2073 6f2c 2073 7562 6a65 6374  o do so, subject
+0003cde0: 2074 6f20 7468 6520 666f 6c6c 6f77 696e   to the followin
+0003cdf0: 6720 636f 6e64 6974 696f 6e73 3a0a 230a  g conditions:.#.
+0003ce00: 2320 5468 6520 6162 6f76 6520 636f 7079  # The above copy
+0003ce10: 7269 6768 7420 6e6f 7469 6365 2061 6e64  right notice and
+0003ce20: 2074 6869 7320 7065 726d 6973 7369 6f6e   this permission
+0003ce30: 206e 6f74 6963 6520 7368 616c 6c20 6265   notice shall be
+0003ce40: 2069 6e63 6c75 6465 6420 696e 2061 6c6c   included in all
+0003ce50: 0a23 2063 6f70 6965 7320 6f72 2073 7562  .# copies or sub
+0003ce60: 7374 616e 7469 616c 2070 6f72 7469 6f6e  stantial portion
+0003ce70: 7320 6f66 2074 6865 2053 6f66 7477 6172  s of the Softwar
+0003ce80: 652e 0a23 0a23 2054 4845 2053 4f46 5457  e..#.# THE SOFTW
+0003ce90: 4152 4520 4953 2050 524f 5649 4445 4420  ARE IS PROVIDED 
+0003cea0: 2241 5320 4953 222c 2057 4954 484f 5554  "AS IS", WITHOUT
+0003ceb0: 2057 4152 5241 4e54 5920 4f46 2041 4e59   WARRANTY OF ANY
+0003cec0: 204b 494e 442c 2045 5850 5245 5353 204f   KIND, EXPRESS O
+0003ced0: 520a 2320 494d 504c 4945 442c 2049 4e43  R.# IMPLIED, INC
+0003cee0: 4c55 4449 4e47 2042 5554 204e 4f54 204c  LUDING BUT NOT L
+0003cef0: 494d 4954 4544 2054 4f20 5448 4520 5741  IMITED TO THE WA
+0003cf00: 5252 414e 5449 4553 204f 4620 4d45 5243  RRANTIES OF MERC
+0003cf10: 4841 4e54 4142 494c 4954 592c 0a23 2046  HANTABILITY,.# F
+0003cf20: 4954 4e45 5353 2046 4f52 2041 2050 4152  ITNESS FOR A PAR
+0003cf30: 5449 4355 4c41 5220 5055 5250 4f53 4520  TICULAR PURPOSE 
+0003cf40: 414e 4420 4e4f 4e49 4e46 5249 4e47 454d  AND NONINFRINGEM
+0003cf50: 454e 542e 2049 4e20 4e4f 2045 5645 4e54  ENT. IN NO EVENT
+0003cf60: 2053 4841 4c4c 2054 4845 0a23 2041 5554   SHALL THE.# AUT
+0003cf70: 484f 5253 204f 5220 434f 5059 5249 4748  HORS OR COPYRIGH
+0003cf80: 5420 484f 4c44 4552 5320 4245 204c 4941  T HOLDERS BE LIA
+0003cf90: 424c 4520 464f 5220 414e 5920 434c 4149  BLE FOR ANY CLAI
+0003cfa0: 4d2c 2044 414d 4147 4553 204f 5220 4f54  M, DAMAGES OR OT
+0003cfb0: 4845 520a 2320 4c49 4142 494c 4954 592c  HER.# LIABILITY,
+0003cfc0: 2057 4845 5448 4552 2049 4e20 414e 2041   WHETHER IN AN A
+0003cfd0: 4354 494f 4e20 4f46 2043 4f4e 5452 4143  CTION OF CONTRAC
+0003cfe0: 542c 2054 4f52 5420 4f52 204f 5448 4552  T, TORT OR OTHER
+0003cff0: 5749 5345 2c20 4152 4953 494e 4720 4652  WISE, ARISING FR
+0003d000: 4f4d 2c0a 2320 4f55 5420 4f46 204f 5220  OM,.# OUT OF OR 
+0003d010: 494e 2043 4f4e 4e45 4354 494f 4e20 5749  IN CONNECTION WI
+0003d020: 5448 2054 4845 2053 4f46 5457 4152 4520  TH THE SOFTWARE 
+0003d030: 4f52 2054 4845 2055 5345 204f 5220 4f54  OR THE USE OR OT
+0003d040: 4845 5220 4445 414c 494e 4753 2049 4e20  HER DEALINGS IN 
+0003d050: 5448 450a 2320 534f 4654 5741 5245 2e0a  THE.# SOFTWARE..
+0003d060: 0a0a 696d 706f 7274 206f 730a 6672 6f6d  ..import os.from
+0003d070: 2063 6f6c 6c65 6374 696f 6e73 2069 6d70   collections imp
+0003d080: 6f72 7420 4f72 6465 7265 6444 6963 740a  ort OrderedDict.
+0003d090: 6672 6f6d 2070 6174 686c 6962 2069 6d70  from pathlib imp
+0003d0a0: 6f72 7420 5075 7265 5769 6e64 6f77 7350  ort PureWindowsP
+0003d0b0: 6174 680a 6672 6f6d 2075 6e69 7474 6573  ath.from unittes
+0003d0c0: 7420 696d 706f 7274 206d 6f63 6b0a 0a69  t import mock..i
+0003d0d0: 6d70 6f72 7420 6879 706f 7468 6573 6973  mport hypothesis
+0003d0e0: 2e73 7472 6174 6567 6965 7320 6173 2073  .strategies as s
+0003d0f0: 0a69 6d70 6f72 7420 7079 7465 7374 0a69  .import pytest.i
+0003d100: 6d70 6f72 7420 736e 6f77 666c 616b 652e  mport snowflake.
+0003d110: 636f 6e6e 6563 746f 720a 6672 6f6d 2068  connector.from h
+0003d120: 7970 6f74 6865 7369 7320 696d 706f 7274  ypothesis import
+0003d130: 2048 6561 6c74 6843 6865 636b 2c20 6769   HealthCheck, gi
+0003d140: 7665 6e2c 2073 6574 7469 6e67 730a 0a69  ven, settings..i
+0003d150: 6d70 6f72 7420 6c6f 636f 7079 0a66 726f  mport locopy.fro
+0003d160: 6d20 6c6f 636f 7079 2069 6d70 6f72 7420  m locopy import 
+0003d170: 536e 6f77 666c 616b 650a 6672 6f6d 206c  Snowflake.from l
+0003d180: 6f63 6f70 792e 6572 726f 7273 2069 6d70  ocopy.errors imp
+0003d190: 6f72 7420 4372 6564 656e 7469 616c 7345  ort CredentialsE
+0003d1a0: 7272 6f72 2c20 4442 4572 726f 720a 0a50  rror, DBError..P
+0003d1b0: 524f 4649 4c45 203d 2022 7465 7374 220a  ROFILE = "test".
+0003d1c0: 4b4d 5320 3d20 226b 6d73 5f74 6573 7422  KMS = "kms_test"
+0003d1d0: 0a0a 474f 4f44 5f43 4f4e 4649 475f 5941  ..GOOD_CONFIG_YA
+0003d1e0: 4d4c 203d 2022 2222 0a61 6363 6f75 6e74  ML = """.account
+0003d1f0: 3a20 6163 636f 756e 740a 7761 7265 686f  : account.wareho
+0003d200: 7573 653a 2077 6172 6568 6f75 7365 0a64  use: warehouse.d
+0003d210: 6174 6162 6173 653a 2064 6174 6162 6173  atabase: databas
+0003d220: 650a 7573 6572 3a20 7573 6572 0a70 6173  e.user: user.pas
+0003d230: 7377 6f72 643a 2070 6173 7377 6f72 6422  sword: password"
+0003d240: 2222 0a0a 4442 4150 4953 203d 2073 6e6f  ""..DBAPIS = sno
+0003d250: 7766 6c61 6b65 2e63 6f6e 6e65 6374 6f72  wflake.connector
+0003d260: 0a0a 4c49 5354 5f53 5452 4154 4547 5920  ..LIST_STRATEGY 
+0003d270: 3d20 732e 6c69 7374 7328 732e 6368 6172  = s.lists(s.char
+0003d280: 6163 7465 7273 2862 6c61 636b 6c69 7374  acters(blacklist
+0003d290: 5f63 6861 7261 6374 6572 733d 2220 2229  _characters=" ")
+0003d2a0: 2c20 6d61 785f 7369 7a65 3d31 3029 0a43  , max_size=10).C
+0003d2b0: 4841 525f 5354 5241 5445 4759 203d 2073  HAR_STRATEGY = s
+0003d2c0: 2e63 6861 7261 6374 6572 7328 290a 0a0a  .characters()...
+0003d2d0: 4067 6976 656e 284c 4953 545f 5354 5241  @given(LIST_STRA
+0003d2e0: 5445 4759 290a 6465 6620 7465 7374 5f72  TEGY).def test_r
+0003d2f0: 616e 646f 6d5f 6c69 7374 5f63 6f6d 6269  andom_list_combi
+0003d300: 6e65 2869 6e70 7574 5f6c 6973 7429 3a0a  ne(input_list):.
+0003d310: 2020 2020 2222 2254 6869 7320 6675 6e63      """This func
+0003d320: 7469 6f6e 2074 6573 7473 2074 6865 2063  tion tests the c
+0003d330: 6f6d 6269 6e65 5f6f 7074 696f 6e73 2066  ombine_options f
+0003d340: 756e 6374 696f 6e20 7573 696e 6720 7261  unction using ra
+0003d350: 6e64 6f6d 206c 6973 7473 2222 220a 2020  ndom lists""".  
+0003d360: 2020 6f75 7470 7574 203d 206c 6f63 6f70    output = locop
+0003d370: 792e 736e 6f77 666c 616b 652e 636f 6d62  y.snowflake.comb
+0003d380: 696e 655f 6f70 7469 6f6e 7328 696e 7075  ine_options(inpu
+0003d390: 745f 6c69 7374 290a 2020 2020 6173 7365  t_list).    asse
+0003d3a0: 7274 2069 7369 6e73 7461 6e63 6528 6f75  rt isinstance(ou
+0003d3b0: 7470 7574 2c20 7374 7229 0a20 2020 2069  tput, str).    i
+0003d3c0: 6620 696e 7075 745f 6c69 7374 3a0a 2020  f input_list:.  
+0003d3d0: 2020 2020 2020 6173 7365 7274 206c 656e        assert len
+0003d3e0: 286f 7574 7075 742e 7370 6c69 7428 2220  (output.split(" 
+0003d3f0: 2229 2920 3d3d 206c 656e 2869 6e70 7574  ")) == len(input
+0003d400: 5f6c 6973 7429 0a0a 0a43 5552 525f 4449  _list)...CURR_DI
+0003d410: 5220 3d20 6f73 2e70 6174 682e 6469 726e  R = os.path.dirn
+0003d420: 616d 6528 6f73 2e70 6174 682e 6162 7370  ame(os.path.absp
+0003d430: 6174 6828 5f5f 6669 6c65 5f5f 2929 0a0a  ath(__file__))..
+0003d440: 0a64 6566 2074 6573 745f 636f 6d62 696e  .def test_combin
+0003d450: 655f 6f70 7469 6f6e 7328 293a 0a20 2020  e_options():.   
+0003d460: 2061 7373 6572 7420 6c6f 636f 7079 2e73   assert locopy.s
+0003d470: 6e6f 7766 6c61 6b65 2e63 6f6d 6269 6e65  nowflake.combine
+0003d480: 5f6f 7074 696f 6e73 284e 6f6e 6529 203d  _options(None) =
+0003d490: 3d20 2222 0a20 2020 2061 7373 6572 7420  = "".    assert 
+0003d4a0: 6c6f 636f 7079 2e73 6e6f 7766 6c61 6b65  locopy.snowflake
+0003d4b0: 2e63 6f6d 6269 6e65 5f6f 7074 696f 6e73  .combine_options
+0003d4c0: 285b 2261 222c 2022 6222 2c20 2263 225d  (["a", "b", "c"]
+0003d4d0: 2920 3d3d 2022 6120 6220 6322 0a20 2020  ) == "a b c".   
+0003d4e0: 2061 7373 6572 7420 6c6f 636f 7079 2e73   assert locopy.s
+0003d4f0: 6e6f 7766 6c61 6b65 2e63 6f6d 6269 6e65  nowflake.combine
+0003d500: 5f6f 7074 696f 6e73 285b 2261 3d31 222c  _options(["a=1",
+0003d510: 2022 623d 3222 2c20 2263 3d33 225d 2920   "b=2", "c=3"]) 
+0003d520: 3d3d 2022 613d 3120 623d 3220 633d 3322  == "a=1 b=2 c=3"
+0003d530: 0a20 2020 2061 7373 6572 7420 6c6f 636f  .    assert loco
+0003d540: 7079 2e73 6e6f 7766 6c61 6b65 2e63 6f6d  py.snowflake.com
+0003d550: 6269 6e65 5f6f 7074 696f 6e73 285b 2222  bine_options([""
+0003d560: 5d29 203d 3d20 2222 0a20 2020 2077 6974  ]) == "".    wit
+0003d570: 6820 7079 7465 7374 2e72 6169 7365 7328  h pytest.raises(
+0003d580: 5479 7065 4572 726f 7229 3a0a 2020 2020  TypeError):.    
+0003d590: 2020 2020 6173 7365 7274 206c 6f63 6f70      assert locop
+0003d5a0: 792e 736e 6f77 666c 616b 652e 636f 6d62  y.snowflake.comb
+0003d5b0: 696e 655f 6f70 7469 6f6e 7328 5b31 5d29  ine_options([1])
+0003d5c0: 0a0a 0a40 6d6f 636b 2e70 6174 6368 2822  ...@mock.patch("
+0003d5d0: 6c6f 636f 7079 2e73 332e 5365 7373 696f  locopy.s3.Sessio
+0003d5e0: 6e22 290a 4067 6976 656e 2869 6e70 7574  n").@given(input
+0003d5f0: 5f6b 6d73 5f6b 6579 3d43 4841 525f 5354  _kms_key=CHAR_ST
+0003d600: 5241 5445 4759 2c20 7072 6f66 696c 653d  RATEGY, profile=
+0003d610: 4348 4152 5f53 5452 4154 4547 5929 0a40  CHAR_STRATEGY).@
+0003d620: 7365 7474 696e 6773 2873 7570 7072 6573  settings(suppres
+0003d630: 735f 6865 616c 7468 5f63 6865 636b 3d5b  s_health_check=[
+0003d640: 4865 616c 7468 4368 6563 6b2e 6675 6e63  HealthCheck.func
+0003d650: 7469 6f6e 5f73 636f 7065 645f 6669 7874  tion_scoped_fixt
+0003d660: 7572 655d 290a 6465 6620 7465 7374 5f63  ure]).def test_c
+0003d670: 6f6e 7374 7275 6374 6f72 2869 6e70 7574  onstructor(input
+0003d680: 5f6b 6d73 5f6b 6579 2c20 7072 6f66 696c  _kms_key, profil
+0003d690: 652c 206d 6f63 6b5f 7365 7373 696f 6e2c  e, mock_session,
+0003d6a0: 2073 665f 6372 6564 656e 7469 616c 7329   sf_credentials)
+0003d6b0: 3a0a 2020 2020 7366 203d 2053 6e6f 7766  :.    sf = Snowf
+0003d6c0: 6c61 6b65 280a 2020 2020 2020 2020 7072  lake(.        pr
+0003d6d0: 6f66 696c 653d 7072 6f66 696c 652c 206b  ofile=profile, k
+0003d6e0: 6d73 5f6b 6579 3d69 6e70 7574 5f6b 6d73  ms_key=input_kms
+0003d6f0: 5f6b 6579 2c20 6462 6170 693d 4442 4150  _key, dbapi=DBAP
+0003d700: 4953 2c20 2a2a 7366 5f63 7265 6465 6e74  IS, **sf_credent
+0003d710: 6961 6c73 0a20 2020 2029 0a20 2020 206d  ials.    ).    m
+0003d720: 6f63 6b5f 7365 7373 696f 6e2e 6173 7365  ock_session.asse
+0003d730: 7274 5f63 616c 6c65 645f 7769 7468 2870  rt_called_with(p
+0003d740: 726f 6669 6c65 5f6e 616d 653d 7072 6f66  rofile_name=prof
+0003d750: 696c 6529 0a20 2020 2061 7373 6572 7420  ile).    assert 
+0003d760: 7366 2e70 726f 6669 6c65 203d 3d20 7072  sf.profile == pr
+0003d770: 6f66 696c 650a 2020 2020 6173 7365 7274  ofile.    assert
+0003d780: 2073 662e 6b6d 735f 6b65 7920 3d3d 2069   sf.kms_key == i
+0003d790: 6e70 7574 5f6b 6d73 5f6b 6579 0a20 2020  nput_kms_key.   
+0003d7a0: 2061 7373 6572 7420 7366 2e63 6f6e 6e65   assert sf.conne
+0003d7b0: 6374 696f 6e5b 2261 6363 6f75 6e74 225d  ction["account"]
+0003d7c0: 203d 3d20 2261 6363 6f75 6e74 220a 2020   == "account".  
+0003d7d0: 2020 6173 7365 7274 2073 662e 636f 6e6e    assert sf.conn
+0003d7e0: 6563 7469 6f6e 5b22 7761 7265 686f 7573  ection["warehous
+0003d7f0: 6522 5d20 3d3d 2022 7761 7265 686f 7573  e"] == "warehous
+0003d800: 6522 0a20 2020 2061 7373 6572 7420 7366  e".    assert sf
+0003d810: 2e63 6f6e 6e65 6374 696f 6e5b 2264 6174  .connection["dat
+0003d820: 6162 6173 6522 5d20 3d3d 2022 6461 7461  abase"] == "data
+0003d830: 6261 7365 220a 2020 2020 6173 7365 7274  base".    assert
+0003d840: 2073 662e 636f 6e6e 6563 7469 6f6e 5b22   sf.connection["
+0003d850: 7363 6865 6d61 225d 203d 3d20 2273 6368  schema"] == "sch
+0003d860: 656d 6122 0a20 2020 2061 7373 6572 7420  ema".    assert 
+0003d870: 7366 2e63 6f6e 6e65 6374 696f 6e5b 2275  sf.connection["u
+0003d880: 7365 7222 5d20 3d3d 2022 7573 6572 220a  ser"] == "user".
+0003d890: 2020 2020 6173 7365 7274 2073 662e 636f      assert sf.co
+0003d8a0: 6e6e 6563 7469 6f6e 5b22 7061 7373 776f  nnection["passwo
+0003d8b0: 7264 225d 203d 3d20 2270 6173 7377 6f72  rd"] == "passwor
+0003d8c0: 6422 0a0a 0a40 6d6f 636b 2e70 6174 6368  d"...@mock.patch
+0003d8d0: 2822 6c6f 636f 7079 2e75 7469 6c69 7479  ("locopy.utility
+0003d8e0: 2e6f 7065 6e22 2c20 6d6f 636b 2e6d 6f63  .open", mock.moc
+0003d8f0: 6b5f 6f70 656e 2872 6561 645f 6461 7461  k_open(read_data
+0003d900: 3d47 4f4f 445f 434f 4e46 4947 5f59 414d  =GOOD_CONFIG_YAM
+0003d910: 4c29 290a 406d 6f63 6b2e 7061 7463 6828  L)).@mock.patch(
+0003d920: 226c 6f63 6f70 792e 7333 2e53 6573 7369  "locopy.s3.Sessi
+0003d930: 6f6e 2229 0a40 6769 7665 6e28 696e 7075  on").@given(inpu
+0003d940: 745f 6b6d 735f 6b65 793d 4348 4152 5f53  t_kms_key=CHAR_S
+0003d950: 5452 4154 4547 592c 2070 726f 6669 6c65  TRATEGY, profile
+0003d960: 3d43 4841 525f 5354 5241 5445 4759 290a  =CHAR_STRATEGY).
+0003d970: 6465 6620 7465 7374 5f63 6f6e 7374 7275  def test_constru
+0003d980: 6374 6f72 5f79 616d 6c28 696e 7075 745f  ctor_yaml(input_
+0003d990: 6b6d 735f 6b65 792c 2070 726f 6669 6c65  kms_key, profile
+0003d9a0: 2c20 6d6f 636b 5f73 6573 7369 6f6e 293a  , mock_session):
+0003d9b0: 0a20 2020 2073 6620 3d20 536e 6f77 666c  .    sf = Snowfl
+0003d9c0: 616b 6528 0a20 2020 2020 2020 2070 726f  ake(.        pro
+0003d9d0: 6669 6c65 3d70 726f 6669 6c65 2c0a 2020  file=profile,.  
+0003d9e0: 2020 2020 2020 6b6d 735f 6b65 793d 696e        kms_key=in
+0003d9f0: 7075 745f 6b6d 735f 6b65 792c 0a20 2020  put_kms_key,.   
+0003da00: 2020 2020 2064 6261 7069 3d44 4241 5049       dbapi=DBAPI
+0003da10: 532c 0a20 2020 2020 2020 2063 6f6e 6669  S,.        confi
+0003da20: 675f 7961 6d6c 3d22 736f 6d65 5f63 6f6e  g_yaml="some_con
+0003da30: 6669 672e 796d 6c22 2c0a 2020 2020 290a  fig.yml",.    ).
+0003da40: 2020 2020 6d6f 636b 5f73 6573 7369 6f6e      mock_session
+0003da50: 2e61 7373 6572 745f 6361 6c6c 6564 5f77  .assert_called_w
+0003da60: 6974 6828 7072 6f66 696c 655f 6e61 6d65  ith(profile_name
+0003da70: 3d70 726f 6669 6c65 290a 2020 2020 6173  =profile).    as
+0003da80: 7365 7274 2073 662e 7072 6f66 696c 6520  sert sf.profile 
+0003da90: 3d3d 2070 726f 6669 6c65 0a20 2020 2061  == profile.    a
+0003daa0: 7373 6572 7420 7366 2e6b 6d73 5f6b 6579  ssert sf.kms_key
+0003dab0: 203d 3d20 696e 7075 745f 6b6d 735f 6b65   == input_kms_ke
+0003dac0: 790a 2020 2020 6173 7365 7274 2073 662e  y.    assert sf.
+0003dad0: 636f 6e6e 6563 7469 6f6e 5b22 6163 636f  connection["acco
+0003dae0: 756e 7422 5d20 3d3d 2022 6163 636f 756e  unt"] == "accoun
+0003daf0: 7422 0a20 2020 2061 7373 6572 7420 7366  t".    assert sf
+0003db00: 2e63 6f6e 6e65 6374 696f 6e5b 2277 6172  .connection["war
+0003db10: 6568 6f75 7365 225d 203d 3d20 2277 6172  ehouse"] == "war
+0003db20: 6568 6f75 7365 220a 2020 2020 6173 7365  ehouse".    asse
+0003db30: 7274 2073 662e 636f 6e6e 6563 7469 6f6e  rt sf.connection
+0003db40: 5b22 6461 7461 6261 7365 225d 203d 3d20  ["database"] == 
+0003db50: 2264 6174 6162 6173 6522 0a20 2020 2061  "database".    a
+0003db60: 7373 6572 7420 7366 2e63 6f6e 6e65 6374  ssert sf.connect
+0003db70: 696f 6e5b 2275 7365 7222 5d20 3d3d 2022  ion["user"] == "
+0003db80: 7573 6572 220a 2020 2020 6173 7365 7274  user".    assert
+0003db90: 2073 662e 636f 6e6e 6563 7469 6f6e 5b22   sf.connection["
+0003dba0: 7061 7373 776f 7264 225d 203d 3d20 2270  password"] == "p
+0003dbb0: 6173 7377 6f72 6422 0a0a 0a40 6d6f 636b  assword"...@mock
+0003dbc0: 2e70 6174 6368 2822 6c6f 636f 7079 2e73  .patch("locopy.s
+0003dbd0: 332e 5365 7373 696f 6e22 290a 6465 6620  3.Session").def 
+0003dbe0: 7465 7374 5f63 6f6e 6e65 6374 286d 6f63  test_connect(moc
+0003dbf0: 6b5f 7365 7373 696f 6e2c 2073 665f 6372  k_session, sf_cr
+0003dc00: 6564 656e 7469 616c 7329 3a0a 2020 2020  edentials):.    
+0003dc10: 7769 7468 206d 6f63 6b2e 7061 7463 6828  with mock.patch(
+0003dc20: 2273 6e6f 7766 6c61 6b65 2e63 6f6e 6e65  "snowflake.conne
+0003dc30: 6374 6f72 2e63 6f6e 6e65 6374 2229 2061  ctor.connect") a
+0003dc40: 7320 6d6f 636b 5f63 6f6e 6e65 6374 3a0a  s mock_connect:.
+0003dc50: 2020 2020 2020 2020 7366 203d 2053 6e6f          sf = Sno
+0003dc60: 7766 6c61 6b65 2870 726f 6669 6c65 3d50  wflake(profile=P
+0003dc70: 524f 4649 4c45 2c20 6462 6170 693d 4442  ROFILE, dbapi=DB
+0003dc80: 4150 4953 2c20 2a2a 7366 5f63 7265 6465  APIS, **sf_crede
+0003dc90: 6e74 6961 6c73 290a 2020 2020 2020 2020  ntials).        
+0003dca0: 7366 2e63 6f6e 6e65 6374 2829 0a0a 2020  sf.connect()..  
+0003dcb0: 2020 2020 2020 6d6f 636b 5f63 6f6e 6e65        mock_conne
+0003dcc0: 6374 2e61 7373 6572 745f 6361 6c6c 6564  ct.assert_called
+0003dcd0: 5f77 6974 6828 0a20 2020 2020 2020 2020  _with(.         
+0003dce0: 2020 2061 6363 6f75 6e74 3d22 6163 636f     account="acco
+0003dcf0: 756e 7422 2c0a 2020 2020 2020 2020 2020  unt",.          
+0003dd00: 2020 7573 6572 3d22 7573 6572 222c 0a20    user="user",. 
+0003dd10: 2020 2020 2020 2020 2020 2077 6172 6568             wareh
+0003dd20: 6f75 7365 3d22 7761 7265 686f 7573 6522  ouse="warehouse"
+0003dd30: 2c0a 2020 2020 2020 2020 2020 2020 7061  ,.            pa
+0003dd40: 7373 776f 7264 3d22 7061 7373 776f 7264  ssword="password
+0003dd50: 222c 0a20 2020 2020 2020 2020 2020 2064  ",.            d
+0003dd60: 6174 6162 6173 653d 2264 6174 6162 6173  atabase="databas
+0003dd70: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+0003dd80: 7363 6865 6d61 3d22 7363 6865 6d61 222c  schema="schema",
+0003dd90: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0003dda0: 2020 2073 662e 636f 6e6e 2e63 7572 736f     sf.conn.curso
+0003ddb0: 722e 6173 7365 7274 5f63 616c 6c65 645f  r.assert_called_
+0003ddc0: 7769 7468 2829 0a20 2020 2020 2020 2073  with().        s
+0003ddd0: 662e 636f 6e6e 2e63 7572 736f 722e 7265  f.conn.cursor.re
+0003dde0: 7475 726e 5f76 616c 7565 2e65 7865 6375  turn_value.execu
+0003ddf0: 7465 2e61 7373 6572 745f 616e 795f 6361  te.assert_any_ca
+0003de00: 6c6c 280a 2020 2020 2020 2020 2020 2020  ll(.            
+0003de10: 2255 5345 2057 4152 4548 4f55 5345 2077  "USE WAREHOUSE w
+0003de20: 6172 6568 6f75 7365 222c 2028 290a 2020  arehouse", ().  
+0003de30: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0003de40: 7366 2e63 6f6e 6e2e 6375 7273 6f72 2e72  sf.conn.cursor.r
+0003de50: 6574 7572 6e5f 7661 6c75 652e 6578 6563  eturn_value.exec
+0003de60: 7574 652e 6173 7365 7274 5f61 6e79 5f63  ute.assert_any_c
+0003de70: 616c 6c28 2255 5345 2044 4154 4142 4153  all("USE DATABAS
+0003de80: 4520 6461 7461 6261 7365 222c 2028 2929  E database", ())
+0003de90: 0a20 2020 2020 2020 2073 662e 636f 6e6e  .        sf.conn
+0003dea0: 2e63 7572 736f 722e 7265 7475 726e 5f76  .cursor.return_v
+0003deb0: 616c 7565 2e65 7865 6375 7465 2e61 7373  alue.execute.ass
+0003dec0: 6572 745f 616e 795f 6361 6c6c 2822 5553  ert_any_call("US
+0003ded0: 4520 5343 4845 4d41 2073 6368 656d 6122  E SCHEMA schema"
+0003dee0: 2c20 2829 290a 0a20 2020 2020 2020 2023  , ())..        #
+0003def0: 2073 6964 6520 6566 6665 6374 2065 7863   side effect exc
+0003df00: 6570 7469 6f6e 0a20 2020 2020 2020 206d  eption.        m
+0003df10: 6f63 6b5f 636f 6e6e 6563 742e 7369 6465  ock_connect.side
+0003df20: 5f65 6666 6563 7420 3d20 4578 6365 7074  _effect = Except
+0003df30: 696f 6e28 2243 6f6e 6e65 6374 2045 7863  ion("Connect Exc
+0003df40: 6570 7469 6f6e 2229 0a20 2020 2020 2020  eption").       
+0003df50: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
+0003df60: 7365 7328 4442 4572 726f 7229 3a0a 2020  ses(DBError):.  
+0003df70: 2020 2020 2020 2020 2020 7366 2e63 6f6e            sf.con
+0003df80: 6e65 6374 2829 0a0a 0a40 6d6f 636b 2e70  nect()...@mock.p
+0003df90: 6174 6368 2822 6c6f 636f 7079 2e73 332e  atch("locopy.s3.
+0003dfa0: 5365 7373 696f 6e22 290a 6465 6620 7465  Session").def te
+0003dfb0: 7374 5f77 6974 685f 636f 6e6e 6563 7428  st_with_connect(
+0003dfc0: 6d6f 636b 5f73 6573 7369 6f6e 2c20 7366  mock_session, sf
+0003dfd0: 5f63 7265 6465 6e74 6961 6c73 293a 0a20  _credentials):. 
+0003dfe0: 2020 2077 6974 6820 6d6f 636b 2e70 6174     with mock.pat
+0003dff0: 6368 2822 736e 6f77 666c 616b 652e 636f  ch("snowflake.co
+0003e000: 6e6e 6563 746f 722e 636f 6e6e 6563 7422  nnector.connect"
+0003e010: 2920 6173 206d 6f63 6b5f 636f 6e6e 6563  ) as mock_connec
+0003e020: 743a 0a20 2020 2020 2020 2077 6974 6820  t:.        with 
+0003e030: 536e 6f77 666c 616b 6528 7072 6f66 696c  Snowflake(profil
+0003e040: 653d 5052 4f46 494c 452c 2064 6261 7069  e=PROFILE, dbapi
+0003e050: 3d44 4241 5049 532c 202a 2a73 665f 6372  =DBAPIS, **sf_cr
+0003e060: 6564 656e 7469 616c 7329 2061 7320 7366  edentials) as sf
+0003e070: 3a0a 2020 2020 2020 2020 2020 2020 6d6f  :.            mo
+0003e080: 636b 5f63 6f6e 6e65 6374 2e61 7373 6572  ck_connect.asser
+0003e090: 745f 6361 6c6c 6564 5f77 6974 6828 0a20  t_called_with(. 
+0003e0a0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0003e0b0: 6363 6f75 6e74 3d22 6163 636f 756e 7422  ccount="account"
+0003e0c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003e0d0: 2020 7573 6572 3d22 7573 6572 222c 0a20    user="user",. 
+0003e0e0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+0003e0f0: 6172 6568 6f75 7365 3d22 7761 7265 686f  arehouse="wareho
+0003e100: 7573 6522 2c0a 2020 2020 2020 2020 2020  use",.          
+0003e110: 2020 2020 2020 7061 7373 776f 7264 3d22        password="
+0003e120: 7061 7373 776f 7264 222c 0a20 2020 2020  password",.     
+0003e130: 2020 2020 2020 2020 2020 2064 6174 6162             datab
+0003e140: 6173 653d 2264 6174 6162 6173 6522 2c0a  ase="database",.
+0003e150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e160: 7363 6865 6d61 3d22 7363 6865 6d61 222c  schema="schema",
+0003e170: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0003e180: 2020 2020 2020 2020 2020 2073 662e 636f             sf.co
+0003e190: 6e6e 2e63 7572 736f 722e 6173 7365 7274  nn.cursor.assert
+0003e1a0: 5f63 616c 6c65 645f 7769 7468 2829 0a20  _called_with(). 
+0003e1b0: 2020 2020 2020 2020 2020 2073 662e 636f             sf.co
+0003e1c0: 6e6e 2e63 7572 736f 722e 7265 7475 726e  nn.cursor.return
+0003e1d0: 5f76 616c 7565 2e65 7865 6375 7465 2e61  _value.execute.a
+0003e1e0: 7373 6572 745f 616e 795f 6361 6c6c 280a  ssert_any_call(.
+0003e1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e200: 2255 5345 2057 4152 4548 4f55 5345 2077  "USE WAREHOUSE w
+0003e210: 6172 6568 6f75 7365 222c 2028 290a 2020  arehouse", ().  
+0003e220: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0003e230: 2020 2020 2020 2020 7366 2e63 6f6e 6e2e          sf.conn.
+0003e240: 6375 7273 6f72 2e72 6574 7572 6e5f 7661  cursor.return_va
+0003e250: 6c75 652e 6578 6563 7574 652e 6173 7365  lue.execute.asse
+0003e260: 7274 5f61 6e79 5f63 616c 6c28 0a20 2020  rt_any_call(.   
+0003e270: 2020 2020 2020 2020 2020 2020 2022 5553               "US
+0003e280: 4520 4441 5441 4241 5345 2064 6174 6162  E DATABASE datab
+0003e290: 6173 6522 2c20 2829 0a20 2020 2020 2020  ase", ().       
+0003e2a0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0003e2b0: 2020 2073 662e 636f 6e6e 2e63 7572 736f     sf.conn.curso
+0003e2c0: 722e 7265 7475 726e 5f76 616c 7565 2e65  r.return_value.e
+0003e2d0: 7865 6375 7465 2e61 7373 6572 745f 616e  xecute.assert_an
+0003e2e0: 795f 6361 6c6c 2822 5553 4520 5343 4845  y_call("USE SCHE
+0003e2f0: 4d41 2073 6368 656d 6122 2c20 2829 290a  MA schema", ()).
+0003e300: 0a20 2020 2020 2020 206d 6f63 6b5f 636f  .        mock_co
+0003e310: 6e6e 6563 742e 7369 6465 5f65 6666 6563  nnect.side_effec
+0003e320: 7420 3d20 4578 6365 7074 696f 6e28 2243  t = Exception("C
+0003e330: 6f6e 6e65 6374 2045 7863 6570 7469 6f6e  onnect Exception
+0003e340: 2229 0a20 2020 2020 2020 2077 6974 6820  ").        with 
+0003e350: 7079 7465 7374 2e72 6169 7365 7328 4442  pytest.raises(DB
+0003e360: 4572 726f 7229 3a0a 2020 2020 2020 2020  Error):.        
+0003e370: 2020 2020 7769 7468 2053 6e6f 7766 6c61      with Snowfla
+0003e380: 6b65 2870 726f 6669 6c65 3d50 524f 4649  ke(profile=PROFI
+0003e390: 4c45 2c20 6462 6170 693d 4442 4150 4953  LE, dbapi=DBAPIS
+0003e3a0: 2c20 2a2a 7366 5f63 7265 6465 6e74 6961  , **sf_credentia
+0003e3b0: 6c73 2920 6173 2073 663a 0a20 2020 2020  ls) as sf:.     
+0003e3c0: 2020 2020 2020 2020 2020 2073 662e 6375             sf.cu
+0003e3d0: 7273 6f72 0a0a 0a40 6d6f 636b 2e70 6174  rsor...@mock.pat
+0003e3e0: 6368 2822 6c6f 636f 7079 2e73 332e 5365  ch("locopy.s3.Se
+0003e3f0: 7373 696f 6e22 290a 6465 6620 7465 7374  ssion").def test
+0003e400: 5f75 706c 6f61 645f 746f 5f69 6e74 6572  _upload_to_inter
+0003e410: 6e61 6c28 6d6f 636b 5f73 6573 7369 6f6e  nal(mock_session
+0003e420: 2c20 7366 5f63 7265 6465 6e74 6961 6c73  , sf_credentials
+0003e430: 293a 0a20 2020 2077 6974 6820 6d6f 636b  ):.    with mock
+0003e440: 2e70 6174 6368 2822 736e 6f77 666c 616b  .patch("snowflak
+0003e450: 652e 636f 6e6e 6563 746f 722e 636f 6e6e  e.connector.conn
+0003e460: 6563 7422 2920 6173 206d 6f63 6b5f 636f  ect") as mock_co
+0003e470: 6e6e 6563 743a 0a20 2020 2020 2020 2077  nnect:.        w
+0003e480: 6974 6820 536e 6f77 666c 616b 6528 7072  ith Snowflake(pr
+0003e490: 6f66 696c 653d 5052 4f46 494c 452c 2064  ofile=PROFILE, d
+0003e4a0: 6261 7069 3d44 4241 5049 532c 202a 2a73  bapi=DBAPIS, **s
+0003e4b0: 665f 6372 6564 656e 7469 616c 7329 2061  f_credentials) a
+0003e4c0: 7320 7366 3a0a 2020 2020 2020 2020 2020  s sf:.          
+0003e4d0: 2020 7366 2e75 706c 6f61 645f 746f 5f69    sf.upload_to_i
+0003e4e0: 6e74 6572 6e61 6c28 222f 736f 6d65 2f66  nternal("/some/f
+0003e4f0: 696c 6522 2c20 2240 7e2f 696e 7465 726e  ile", "@~/intern
+0003e500: 616c 2229 0a20 2020 2020 2020 2020 2020  al").           
+0003e510: 2073 662e 636f 6e6e 2e63 7572 736f 722e   sf.conn.cursor.
+0003e520: 7265 7475 726e 5f76 616c 7565 2e65 7865  return_value.exe
+0003e530: 6375 7465 2e61 7373 6572 745f 6361 6c6c  cute.assert_call
+0003e540: 6564 5f77 6974 6828 0a20 2020 2020 2020  ed_with(.       
+0003e550: 2020 2020 2020 2020 2022 5055 5420 2766           "PUT 'f
+0003e560: 696c 653a 2f2f 2f73 6f6d 652f 6669 6c65  ile:///some/file
+0003e570: 2720 407e 2f69 6e74 6572 6e61 6c20 5041  ' @~/internal PA
+0003e580: 5241 4c4c 454c 3d34 2041 5554 4f5f 434f  RALLEL=4 AUTO_CO
+0003e590: 4d50 5245 5353 3d54 7275 6520 4f56 4552  MPRESS=True OVER
+0003e5a0: 5752 4954 453d 5472 7565 222c 0a20 2020  WRITE=True",.   
+0003e5b0: 2020 2020 2020 2020 2020 2020 2028 292c               (),
+0003e5c0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+0003e5d0: 2020 2020 2020 2020 2020 2020 7366 2e75              sf.u
+0003e5e0: 706c 6f61 645f 746f 5f69 6e74 6572 6e61  pload_to_interna
+0003e5f0: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
+0003e600: 2020 2022 2f73 6f6d 652f 6669 6c65 222c     "/some/file",
+0003e610: 2022 407e 2f69 6e74 6572 6e61 6c22 2c20   "@~/internal", 
+0003e620: 7061 7261 6c6c 656c 3d39 392c 2061 7574  parallel=99, aut
+0003e630: 6f5f 636f 6d70 7265 7373 3d46 616c 7365  o_compress=False
+0003e640: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0003e650: 2020 2020 2020 2020 2020 2073 662e 636f             sf.co
+0003e660: 6e6e 2e63 7572 736f 722e 7265 7475 726e  nn.cursor.return
+0003e670: 5f76 616c 7565 2e65 7865 6375 7465 2e61  _value.execute.a
+0003e680: 7373 6572 745f 6361 6c6c 6564 5f77 6974  ssert_called_wit
+0003e690: 6828 0a20 2020 2020 2020 2020 2020 2020  h(.             
+0003e6a0: 2020 2022 5055 5420 2766 696c 653a 2f2f     "PUT 'file://
+0003e6b0: 2f73 6f6d 652f 6669 6c65 2720 407e 2f69  /some/file' @~/i
+0003e6c0: 6e74 6572 6e61 6c20 5041 5241 4c4c 454c  nternal PARALLEL
+0003e6d0: 3d39 3920 4155 544f 5f43 4f4d 5052 4553  =99 AUTO_COMPRES
+0003e6e0: 533d 4661 6c73 6520 4f56 4552 5752 4954  S=False OVERWRIT
+0003e6f0: 453d 5472 7565 222c 0a20 2020 2020 2020  E=True",.       
+0003e700: 2020 2020 2020 2020 2028 292c 0a20 2020           (),.   
+0003e710: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0003e720: 2020 2020 2020 2020 7366 2e75 706c 6f61          sf.uploa
+0003e730: 645f 746f 5f69 6e74 6572 6e61 6c28 222f  d_to_internal("/
+0003e740: 736f 6d65 2f66 696c 6522 2c20 2240 7e2f  some/file", "@~/
+0003e750: 696e 7465 726e 616c 222c 206f 7665 7277  internal", overw
+0003e760: 7269 7465 3d46 616c 7365 290a 2020 2020  rite=False).    
+0003e770: 2020 2020 2020 2020 7366 2e63 6f6e 6e2e          sf.conn.
+0003e780: 6375 7273 6f72 2e72 6574 7572 6e5f 7661  cursor.return_va
+0003e790: 6c75 652e 6578 6563 7574 652e 6173 7365  lue.execute.asse
+0003e7a0: 7274 5f63 616c 6c65 645f 7769 7468 280a  rt_called_with(.
+0003e7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e7c0: 2250 5554 2027 6669 6c65 3a2f 2f2f 736f  "PUT 'file:///so
+0003e7d0: 6d65 2f66 696c 6527 2040 7e2f 696e 7465  me/file' @~/inte
+0003e7e0: 726e 616c 2050 4152 414c 4c45 4c3d 3420  rnal PARALLEL=4 
+0003e7f0: 4155 544f 5f43 4f4d 5052 4553 533d 5472  AUTO_COMPRESS=Tr
+0003e800: 7565 204f 5645 5257 5249 5445 3d46 616c  ue OVERWRITE=Fal
+0003e810: 7365 222c 0a20 2020 2020 2020 2020 2020  se",.           
+0003e820: 2020 2020 2028 292c 0a20 2020 2020 2020       (),.       
+0003e830: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0003e840: 2020 2020 2320 6578 6365 7074 696f 6e0a      # exception.
+0003e850: 2020 2020 2020 2020 2020 2020 7366 2e63              sf.c
+0003e860: 6f6e 6e2e 6375 7273 6f72 2e72 6574 7572  onn.cursor.retur
+0003e870: 6e5f 7661 6c75 652e 6578 6563 7574 652e  n_value.execute.
+0003e880: 7369 6465 5f65 6666 6563 7420 3d20 4578  side_effect = Ex
+0003e890: 6365 7074 696f 6e28 2250 5554 2045 7863  ception("PUT Exc
+0003e8a0: 6570 7469 6f6e 2229 0a20 2020 2020 2020  eption").       
+0003e8b0: 2020 2020 2077 6974 6820 7079 7465 7374       with pytest
+0003e8c0: 2e72 6169 7365 7328 4442 4572 726f 7229  .raises(DBError)
+0003e8d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0003e8e0: 2020 7366 2e75 706c 6f61 645f 746f 5f69    sf.upload_to_i
+0003e8f0: 6e74 6572 6e61 6c28 222f 736f 6d65 2f66  nternal("/some/f
+0003e900: 696c 6522 2c20 2240 7e2f 696e 7465 726e  ile", "@~/intern
+0003e910: 616c 2229 0a0a 0a40 6d6f 636b 2e70 6174  al")...@mock.pat
+0003e920: 6368 2822 6c6f 636f 7079 2e73 6e6f 7766  ch("locopy.snowf
+0003e930: 6c61 6b65 2e50 7572 6550 6174 6822 2c20  lake.PurePath", 
+0003e940: 6e65 773d 5075 7265 5769 6e64 6f77 7350  new=PureWindowsP
+0003e950: 6174 6829 0a40 6d6f 636b 2e70 6174 6368  ath).@mock.patch
+0003e960: 2822 6c6f 636f 7079 2e73 332e 5365 7373  ("locopy.s3.Sess
+0003e970: 696f 6e22 290a 6465 6620 7465 7374 5f75  ion").def test_u
+0003e980: 706c 6f61 645f 746f 5f69 6e74 6572 6e61  pload_to_interna
+0003e990: 6c5f 7769 6e64 6f77 7328 6d6f 636b 5f73  l_windows(mock_s
+0003e9a0: 6573 7369 6f6e 2c20 7366 5f63 7265 6465  ession, sf_crede
+0003e9b0: 6e74 6961 6c73 293a 0a20 2020 2077 6974  ntials):.    wit
+0003e9c0: 6820 6d6f 636b 2e70 6174 6368 2822 736e  h mock.patch("sn
+0003e9d0: 6f77 666c 616b 652e 636f 6e6e 6563 746f  owflake.connecto
+0003e9e0: 722e 636f 6e6e 6563 7422 2920 6173 206d  r.connect") as m
+0003e9f0: 6f63 6b5f 636f 6e6e 6563 743a 0a20 2020  ock_connect:.   
+0003ea00: 2020 2020 2077 6974 6820 536e 6f77 666c       with Snowfl
+0003ea10: 616b 6528 7072 6f66 696c 653d 5052 4f46  ake(profile=PROF
+0003ea20: 494c 452c 2064 6261 7069 3d44 4241 5049  ILE, dbapi=DBAPI
+0003ea30: 532c 202a 2a73 665f 6372 6564 656e 7469  S, **sf_credenti
+0003ea40: 616c 7329 2061 7320 7366 3a0a 0a20 2020  als) as sf:..   
+0003ea50: 2020 2020 2020 2020 2073 662e 7570 6c6f           sf.uplo
+0003ea60: 6164 5f74 6f5f 696e 7465 726e 616c 2872  ad_to_internal(r
+0003ea70: 2243 3a5c 736f 6d65 5c66 696c 6522 2c20  "C:\some\file", 
+0003ea80: 2240 7e2f 696e 7465 726e 616c 2229 0a20  "@~/internal"). 
+0003ea90: 2020 2020 2020 2020 2020 2073 662e 636f             sf.co
+0003eaa0: 6e6e 2e63 7572 736f 722e 7265 7475 726e  nn.cursor.return
+0003eab0: 5f76 616c 7565 2e65 7865 6375 7465 2e61  _value.execute.a
+0003eac0: 7373 6572 745f 6361 6c6c 6564 5f77 6974  ssert_called_wit
+0003ead0: 6828 0a20 2020 2020 2020 2020 2020 2020  h(.             
+0003eae0: 2020 2022 5055 5420 2766 696c 653a 2f2f     "PUT 'file://
+0003eaf0: 433a 2f73 6f6d 652f 6669 6c65 2720 407e  C:/some/file' @~
+0003eb00: 2f69 6e74 6572 6e61 6c20 5041 5241 4c4c  /internal PARALL
+0003eb10: 454c 3d34 2041 5554 4f5f 434f 4d50 5245  EL=4 AUTO_COMPRE
+0003eb20: 5353 3d54 7275 6520 4f56 4552 5752 4954  SS=True OVERWRIT
+0003eb30: 453d 5472 7565 222c 0a20 2020 2020 2020  E=True",.       
+0003eb40: 2020 2020 2020 2020 2028 292c 0a20 2020           (),.   
+0003eb50: 2020 2020 2020 2020 2029 0a0a 0a40 6d6f           )...@mo
+0003eb60: 636b 2e70 6174 6368 2822 6c6f 636f 7079  ck.patch("locopy
+0003eb70: 2e73 332e 5365 7373 696f 6e22 290a 6465  .s3.Session").de
+0003eb80: 6620 7465 7374 5f64 6f77 6e6c 6f61 645f  f test_download_
+0003eb90: 6672 6f6d 5f69 6e74 6572 6e61 6c28 6d6f  from_internal(mo
+0003eba0: 636b 5f73 6573 7369 6f6e 2c20 7366 5f63  ck_session, sf_c
+0003ebb0: 7265 6465 6e74 6961 6c73 293a 0a20 2020  redentials):.   
+0003ebc0: 2077 6974 6820 6d6f 636b 2e70 6174 6368   with mock.patch
+0003ebd0: 2822 736e 6f77 666c 616b 652e 636f 6e6e  ("snowflake.conn
+0003ebe0: 6563 746f 722e 636f 6e6e 6563 7422 2920  ector.connect") 
+0003ebf0: 6173 206d 6f63 6b5f 636f 6e6e 6563 743a  as mock_connect:
+0003ec00: 0a20 2020 2020 2020 2077 6974 6820 536e  .        with Sn
+0003ec10: 6f77 666c 616b 6528 7072 6f66 696c 653d  owflake(profile=
+0003ec20: 5052 4f46 494c 452c 2064 6261 7069 3d44  PROFILE, dbapi=D
+0003ec30: 4241 5049 532c 202a 2a73 665f 6372 6564  BAPIS, **sf_cred
+0003ec40: 656e 7469 616c 7329 2061 7320 7366 3a0a  entials) as sf:.
+0003ec50: 2020 2020 2020 2020 2020 2020 7366 2e64              sf.d
+0003ec60: 6f77 6e6c 6f61 645f 6672 6f6d 5f69 6e74  ownload_from_int
+0003ec70: 6572 6e61 6c28 2240 7e2f 696e 7465 726e  ernal("@~/intern
+0003ec80: 616c 222c 2022 2f73 6f6d 652f 6669 6c65  al", "/some/file
+0003ec90: 2229 0a20 2020 2020 2020 2020 2020 2073  ").            s
+0003eca0: 662e 636f 6e6e 2e63 7572 736f 722e 7265  f.conn.cursor.re
+0003ecb0: 7475 726e 5f76 616c 7565 2e65 7865 6375  turn_value.execu
+0003ecc0: 7465 2e61 7373 6572 745f 6361 6c6c 6564  te.assert_called
+0003ecd0: 5f77 6974 6828 0a20 2020 2020 2020 2020  _with(.         
+0003ece0: 2020 2020 2020 2022 4745 5420 407e 2f69         "GET @~/i
+0003ecf0: 6e74 6572 6e61 6c20 2766 696c 653a 2f2f  nternal 'file://
+0003ed00: 2f73 6f6d 652f 6669 6c65 2720 5041 5241  /some/file' PARA
+0003ed10: 4c4c 454c 3d31 3022 2c20 2829 0a20 2020  LLEL=10", ().   
+0003ed20: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0003ed30: 2020 2020 2020 2020 7366 2e64 6f77 6e6c          sf.downl
+0003ed40: 6f61 645f 6672 6f6d 5f69 6e74 6572 6e61  oad_from_interna
+0003ed50: 6c28 2240 7e2f 696e 7465 726e 616c 222c  l("@~/internal",
+0003ed60: 2022 2f73 6f6d 652f 6669 6c65 222c 2070   "/some/file", p
+0003ed70: 6172 616c 6c65 6c3d 3939 290a 2020 2020  arallel=99).    
+0003ed80: 2020 2020 2020 2020 7366 2e63 6f6e 6e2e          sf.conn.
+0003ed90: 6375 7273 6f72 2e72 6574 7572 6e5f 7661  cursor.return_va
+0003eda0: 6c75 652e 6578 6563 7574 652e 6173 7365  lue.execute.asse
+0003edb0: 7274 5f63 616c 6c65 645f 7769 7468 280a  rt_called_with(.
+0003edc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003edd0: 2247 4554 2040 7e2f 696e 7465 726e 616c  "GET @~/internal
+0003ede0: 2027 6669 6c65 3a2f 2f2f 736f 6d65 2f66   'file:///some/f
+0003edf0: 696c 6527 2050 4152 414c 4c45 4c3d 3939  ile' PARALLEL=99
+0003ee00: 222c 2028 290a 2020 2020 2020 2020 2020  ", ().          
+0003ee10: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+0003ee20: 2023 2065 7863 6570 7469 6f6e 0a20 2020   # exception.   
+0003ee30: 2020 2020 2020 2020 2073 662e 636f 6e6e           sf.conn
+0003ee40: 2e63 7572 736f 722e 7265 7475 726e 5f76  .cursor.return_v
+0003ee50: 616c 7565 2e65 7865 6375 7465 2e73 6964  alue.execute.sid
+0003ee60: 655f 6566 6665 6374 203d 2045 7863 6570  e_effect = Excep
+0003ee70: 7469 6f6e 2822 4745 5420 4578 6365 7074  tion("GET Except
+0003ee80: 696f 6e22 290a 2020 2020 2020 2020 2020  ion").          
+0003ee90: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
+0003eea0: 6973 6573 2844 4245 7272 6f72 293a 0a20  ises(DBError):. 
+0003eeb0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0003eec0: 662e 646f 776e 6c6f 6164 5f66 726f 6d5f  f.download_from_
+0003eed0: 696e 7465 726e 616c 2822 407e 2f69 6e74  internal("@~/int
+0003eee0: 6572 6e61 6c22 2c20 222f 736f 6d65 2f66  ernal", "/some/f
+0003eef0: 696c 6522 290a 0a0a 406d 6f63 6b2e 7061  ile")...@mock.pa
+0003ef00: 7463 6828 226c 6f63 6f70 792e 736e 6f77  tch("locopy.snow
+0003ef10: 666c 616b 652e 5075 7265 5061 7468 222c  flake.PurePath",
+0003ef20: 206e 6577 3d50 7572 6557 696e 646f 7773   new=PureWindows
+0003ef30: 5061 7468 290a 406d 6f63 6b2e 7061 7463  Path).@mock.patc
+0003ef40: 6828 226c 6f63 6f70 792e 7333 2e53 6573  h("locopy.s3.Ses
+0003ef50: 7369 6f6e 2229 0a64 6566 2074 6573 745f  sion").def test_
+0003ef60: 646f 776e 6c6f 6164 5f66 726f 6d5f 696e  download_from_in
+0003ef70: 7465 726e 616c 5f77 696e 646f 7773 286d  ternal_windows(m
+0003ef80: 6f63 6b5f 7365 7373 696f 6e2c 2073 665f  ock_session, sf_
+0003ef90: 6372 6564 656e 7469 616c 7329 3a0a 2020  credentials):.  
+0003efa0: 2020 7769 7468 206d 6f63 6b2e 7061 7463    with mock.patc
+0003efb0: 6828 2273 6e6f 7766 6c61 6b65 2e63 6f6e  h("snowflake.con
+0003efc0: 6e65 6374 6f72 2e63 6f6e 6e65 6374 2229  nector.connect")
+0003efd0: 2061 7320 6d6f 636b 5f63 6f6e 6e65 6374   as mock_connect
+0003efe0: 3a0a 2020 2020 2020 2020 7769 7468 2053  :.        with S
+0003eff0: 6e6f 7766 6c61 6b65 2870 726f 6669 6c65  nowflake(profile
+0003f000: 3d50 524f 4649 4c45 2c20 6462 6170 693d  =PROFILE, dbapi=
+0003f010: 4442 4150 4953 2c20 2a2a 7366 5f63 7265  DBAPIS, **sf_cre
+0003f020: 6465 6e74 6961 6c73 2920 6173 2073 663a  dentials) as sf:
+0003f030: 0a0a 2020 2020 2020 2020 2020 2020 7366  ..            sf
+0003f040: 2e64 6f77 6e6c 6f61 645f 6672 6f6d 5f69  .download_from_i
+0003f050: 6e74 6572 6e61 6c28 2240 7e2f 696e 7465  nternal("@~/inte
+0003f060: 726e 616c 222c 2072 2243 3a5c 736f 6d65  rnal", r"C:\some
+0003f070: 5c66 696c 6522 290a 2020 2020 2020 2020  \file").        
+0003f080: 2020 2020 7366 2e63 6f6e 6e2e 6375 7273      sf.conn.curs
+0003f090: 6f72 2e72 6574 7572 6e5f 7661 6c75 652e  or.return_value.
+0003f0a0: 6578 6563 7574 652e 6173 7365 7274 5f63  execute.assert_c
+0003f0b0: 616c 6c65 645f 7769 7468 280a 2020 2020  alled_with(.    
+0003f0c0: 2020 2020 2020 2020 2020 2020 2247 4554              "GET
+0003f0d0: 2040 7e2f 696e 7465 726e 616c 2027 6669   @~/internal 'fi
+0003f0e0: 6c65 3a2f 2f43 3a2f 736f 6d65 2f66 696c  le://C:/some/fil
+0003f0f0: 6527 2050 4152 414c 4c45 4c3d 3130 222c  e' PARALLEL=10",
+0003f100: 2028 290a 2020 2020 2020 2020 2020 2020   ().            
+0003f110: 290a 0a0a 4070 7974 6573 742e 6d61 726b  )...@pytest.mark
+0003f120: 2e70 6172 616d 6574 7269 7a65 280a 2020  .parametrize(.  
+0003f130: 2020 2266 696c 655f 7479 7065 2c20 666f    "file_type, fo
+0003f140: 726d 6174 5f6f 7074 696f 6e73 2c20 636f  rmat_options, co
+0003f150: 7079 5f6f 7074 696f 6e73 2c20 6578 7065  py_options, expe
+0003f160: 6374 6564 222c 0a20 2020 205b 0a20 2020  cted",.    [.   
+0003f170: 2020 2020 2028 2263 7376 222c 204e 6f6e       ("csv", Non
+0003f180: 652c 204e 6f6e 652c 2022 2854 5950 453d  e, None, "(TYPE=
+0003f190: 2763 7376 2720 4649 454c 445f 4445 4c49  'csv' FIELD_DELI
+0003f1a0: 4d49 5445 523d 277c 2720 534b 4950 5f48  MITER='|' SKIP_H
+0003f1b0: 4541 4445 523d 3029 2022 292c 0a20 2020  EADER=0) "),.   
+0003f1c0: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
+0003f1d0: 2020 2022 6373 7622 2c0a 2020 2020 2020     "csv",.      
+0003f1e0: 2020 2020 2020 5b22 4649 454c 445f 4445        ["FIELD_DE
+0003f1f0: 4c49 4d49 5445 523d 272c 2722 2c20 2253  LIMITER=','", "S
+0003f200: 4b49 505f 4845 4144 4552 3d31 225d 2c0a  KIP_HEADER=1"],.
+0003f210: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
+0003f220: 2c0a 2020 2020 2020 2020 2020 2020 2228  ,.            "(
+0003f230: 5459 5045 3d27 6373 7627 2046 4945 4c44  TYPE='csv' FIELD
+0003f240: 5f44 454c 494d 4954 4552 3d27 2c27 2053  _DELIMITER=',' S
+0003f250: 4b49 505f 4845 4144 4552 3d31 2920 222c  KIP_HEADER=1) ",
+0003f260: 0a20 2020 2020 2020 2029 2c0a 2020 2020  .        ),.    
+0003f270: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
+0003f280: 2020 2263 7376 222c 0a20 2020 2020 2020    "csv",.       
+0003f290: 2020 2020 205b 2246 4945 4c44 5f44 454c       ["FIELD_DEL
+0003f2a0: 494d 4954 4552 3d27 7c27 222c 2022 534b  IMITER='|'", "SK
+0003f2b0: 4950 5f48 4541 4445 523d 3022 2c20 2261  IP_HEADER=0", "a
+0003f2c0: 3d31 222c 2022 623d 3222 5d2c 0a20 2020  =1", "b=2"],.   
+0003f2d0: 2020 2020 2020 2020 205b 2263 3d33 222c           ["c=3",
+0003f2e0: 2022 643d 3422 5d2c 0a20 2020 2020 2020   "d=4"],.       
+0003f2f0: 2020 2020 2022 2854 5950 453d 2763 7376       "(TYPE='csv
+0003f300: 2720 4649 454c 445f 4445 4c49 4d49 5445  ' FIELD_DELIMITE
+0003f310: 523d 277c 2720 534b 4950 5f48 4541 4445  R='|' SKIP_HEADE
+0003f320: 523d 3020 613d 3120 623d 3229 2063 3d33  R=0 a=1 b=2) c=3
+0003f330: 2064 3d34 222c 0a20 2020 2020 2020 2029   d=4",.        )
+0003f340: 2c0a 2020 2020 2020 2020 2822 7061 7271  ,.        ("parq
+0003f350: 7565 7422 2c20 4e6f 6e65 2c20 4e6f 6e65  uet", None, None
+0003f360: 2c20 2228 5459 5045 3d27 7061 7271 7565  , "(TYPE='parque
+0003f370: 7427 2029 2022 292c 0a20 2020 2020 2020  t' ) "),.       
+0003f380: 2028 0a20 2020 2020 2020 2020 2020 2022   (.            "
+0003f390: 7061 7271 7565 7422 2c0a 2020 2020 2020  parquet",.      
+0003f3a0: 2020 2020 2020 5b22 4249 4e41 5259 5f41        ["BINARY_A
+0003f3b0: 535f 5445 5854 3d46 414c 5345 225d 2c0a  S_TEXT=FALSE"],.
+0003f3c0: 2020 2020 2020 2020 2020 2020 5b22 633d              ["c=
+0003f3d0: 3322 2c20 2264 3d34 225d 2c0a 2020 2020  3", "d=4"],.    
+0003f3e0: 2020 2020 2020 2020 2228 5459 5045 3d27          "(TYPE='
+0003f3f0: 7061 7271 7565 7427 2042 494e 4152 595f  parquet' BINARY_
+0003f400: 4153 5f54 4558 543d 4641 4c53 4529 2063  AS_TEXT=FALSE) c
+0003f410: 3d33 2064 3d34 222c 0a20 2020 2020 2020  =3 d=4",.       
+0003f420: 2029 2c0a 2020 2020 2020 2020 2822 6a73   ),.        ("js
+0003f430: 6f6e 222c 204e 6f6e 652c 204e 6f6e 652c  on", None, None,
+0003f440: 2022 2854 5950 453d 276a 736f 6e27 2029   "(TYPE='json' )
+0003f450: 2022 292c 0a20 2020 2020 2020 2028 0a20   "),.        (. 
+0003f460: 2020 2020 2020 2020 2020 2022 6a73 6f6e             "json
+0003f470: 222c 0a20 2020 2020 2020 2020 2020 205b  ",.            [
+0003f480: 2243 4f4d 5052 4553 5349 4f4e 3d47 5a49  "COMPRESSION=GZI
+0003f490: 5022 5d2c 0a20 2020 2020 2020 2020 2020  P"],.           
+0003f4a0: 205b 2263 3d33 222c 2022 643d 3422 5d2c   ["c=3", "d=4"],
+0003f4b0: 0a20 2020 2020 2020 2020 2020 2022 2854  .            "(T
+0003f4c0: 5950 453d 276a 736f 6e27 2043 4f4d 5052  YPE='json' COMPR
+0003f4d0: 4553 5349 4f4e 3d47 5a49 5029 2063 3d33  ESSION=GZIP) c=3
+0003f4e0: 2064 3d34 222c 0a20 2020 2020 2020 2029   d=4",.        )
+0003f4f0: 2c0a 2020 2020 5d2c 0a29 0a40 6d6f 636b  ,.    ],.).@mock
+0003f500: 2e70 6174 6368 2822 6c6f 636f 7079 2e73  .patch("locopy.s
+0003f510: 332e 5365 7373 696f 6e22 290a 6465 6620  3.Session").def 
+0003f520: 7465 7374 5f63 6f70 7928 0a20 2020 206d  test_copy(.    m
+0003f530: 6f63 6b5f 7365 7373 696f 6e2c 2066 696c  ock_session, fil
+0003f540: 655f 7479 7065 2c20 666f 726d 6174 5f6f  e_type, format_o
+0003f550: 7074 696f 6e73 2c20 636f 7079 5f6f 7074  ptions, copy_opt
+0003f560: 696f 6e73 2c20 6578 7065 6374 6564 2c20  ions, expected, 
+0003f570: 7366 5f63 7265 6465 6e74 6961 6c73 0a29  sf_credentials.)
+0003f580: 3a0a 2020 2020 7769 7468 206d 6f63 6b2e  :.    with mock.
+0003f590: 7061 7463 6828 2273 6e6f 7766 6c61 6b65  patch("snowflake
+0003f5a0: 2e63 6f6e 6e65 6374 6f72 2e63 6f6e 6e65  .connector.conne
+0003f5b0: 6374 2229 2061 7320 6d6f 636b 5f63 6f6e  ct") as mock_con
+0003f5c0: 6e65 6374 3a0a 2020 2020 2020 2020 7769  nect:.        wi
+0003f5d0: 7468 2053 6e6f 7766 6c61 6b65 2870 726f  th Snowflake(pro
+0003f5e0: 6669 6c65 3d50 524f 4649 4c45 2c20 6462  file=PROFILE, db
+0003f5f0: 6170 693d 4442 4150 4953 2c20 2a2a 7366  api=DBAPIS, **sf
+0003f600: 5f63 7265 6465 6e74 6961 6c73 2920 6173  _credentials) as
+0003f610: 2073 663a 0a0a 2020 2020 2020 2020 2020   sf:..          
+0003f620: 2020 7366 2e63 6f70 7928 0a20 2020 2020    sf.copy(.     
+0003f630: 2020 2020 2020 2020 2020 2022 7461 626c             "tabl
+0003f640: 655f 6e61 6d65 222c 0a20 2020 2020 2020  e_name",.       
+0003f650: 2020 2020 2020 2020 2022 407e 2f73 7461           "@~/sta
+0003f660: 6765 222c 0a20 2020 2020 2020 2020 2020  ge",.           
+0003f670: 2020 2020 2066 696c 655f 7479 7065 3d66       file_type=f
+0003f680: 696c 655f 7479 7065 2c0a 2020 2020 2020  ile_type,.      
+0003f690: 2020 2020 2020 2020 2020 666f 726d 6174            format
+0003f6a0: 5f6f 7074 696f 6e73 3d66 6f72 6d61 745f  _options=format_
+0003f6b0: 6f70 7469 6f6e 732c 0a20 2020 2020 2020  options,.       
+0003f6c0: 2020 2020 2020 2020 2063 6f70 795f 6f70           copy_op
+0003f6d0: 7469 6f6e 733d 636f 7079 5f6f 7074 696f  tions=copy_optio
+0003f6e0: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
+0003f6f0: 290a 2020 2020 2020 2020 2020 2020 7366  ).            sf
+0003f700: 2e63 6f6e 6e2e 6375 7273 6f72 2e72 6574  .conn.cursor.ret
+0003f710: 7572 6e5f 7661 6c75 652e 6578 6563 7574  urn_value.execut
+0003f720: 652e 6173 7365 7274 5f63 616c 6c65 645f  e.assert_called_
+0003f730: 7769 7468 280a 2020 2020 2020 2020 2020  with(.          
+0003f740: 2020 2020 2020 2243 4f50 5920 494e 544f        "COPY INTO
+0003f750: 2074 6162 6c65 5f6e 616d 6520 4652 4f4d   table_name FROM
+0003f760: 2027 407e 2f73 7461 6765 2720 4649 4c45   '@~/stage' FILE
+0003f770: 5f46 4f52 4d41 5420 3d20 7b30 7d22 2e66  _FORMAT = {0}".f
+0003f780: 6f72 6d61 7428 0a20 2020 2020 2020 2020  ormat(.         
+0003f790: 2020 2020 2020 2020 2020 2065 7870 6563             expec
+0003f7a0: 7465 640a 2020 2020 2020 2020 2020 2020  ted.            
+0003f7b0: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
+0003f7c0: 2020 2020 2020 2028 292c 0a20 2020 2020         (),.     
+0003f7d0: 2020 2020 2020 2029 0a0a 0a40 6d6f 636b         )...@mock
+0003f7e0: 2e70 6174 6368 2822 6c6f 636f 7079 2e73  .patch("locopy.s
+0003f7f0: 332e 5365 7373 696f 6e22 290a 6465 6620  3.Session").def 
+0003f800: 7465 7374 5f63 6f70 795f 6578 6365 7074  test_copy_except
+0003f810: 696f 6e28 6d6f 636b 5f73 6573 7369 6f6e  ion(mock_session
+0003f820: 2c20 7366 5f63 7265 6465 6e74 6961 6c73  , sf_credentials
+0003f830: 293a 0a20 2020 2077 6974 6820 6d6f 636b  ):.    with mock
+0003f840: 2e70 6174 6368 2822 736e 6f77 666c 616b  .patch("snowflak
+0003f850: 652e 636f 6e6e 6563 746f 722e 636f 6e6e  e.connector.conn
+0003f860: 6563 7422 2920 6173 206d 6f63 6b5f 636f  ect") as mock_co
+0003f870: 6e6e 6563 743a 0a20 2020 2020 2020 2077  nnect:.        w
+0003f880: 6974 6820 536e 6f77 666c 616b 6528 7072  ith Snowflake(pr
+0003f890: 6f66 696c 653d 5052 4f46 494c 452c 2064  ofile=PROFILE, d
+0003f8a0: 6261 7069 3d44 4241 5049 532c 202a 2a73  bapi=DBAPIS, **s
+0003f8b0: 665f 6372 6564 656e 7469 616c 7329 2061  f_credentials) a
+0003f8c0: 7320 7366 3a0a 0a20 2020 2020 2020 2020  s sf:..         
+0003f8d0: 2020 2077 6974 6820 7079 7465 7374 2e72     with pytest.r
+0003f8e0: 6169 7365 7328 5661 6c75 6545 7272 6f72  aises(ValueError
+0003f8f0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0003f900: 2020 2073 662e 636f 7079 2822 7461 626c     sf.copy("tabl
+0003f910: 655f 6e61 6d65 222c 2022 407e 2f73 7461  e_name", "@~/sta
+0003f920: 6765 222c 2066 696c 655f 7479 7065 3d22  ge", file_type="
+0003f930: 756e 6b6e 6f77 6e22 290a 0a20 2020 2020  unknown")..     
+0003f940: 2020 2020 2020 2023 2065 7863 6570 7469         # excepti
+0003f950: 6f6e 0a20 2020 2020 2020 2020 2020 2073  on.            s
+0003f960: 662e 636f 6e6e 2e63 7572 736f 722e 7265  f.conn.cursor.re
+0003f970: 7475 726e 5f76 616c 7565 2e65 7865 6375  turn_value.execu
+0003f980: 7465 2e73 6964 655f 6566 6665 6374 203d  te.side_effect =
+0003f990: 2045 7863 6570 7469 6f6e 280a 2020 2020   Exception(.    
+0003f9a0: 2020 2020 2020 2020 2020 2020 2243 4f50              "COP
+0003f9b0: 5920 4578 6365 7074 696f 6e22 0a20 2020  Y Exception".   
+0003f9c0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0003f9d0: 2020 2020 2020 2077 6974 6820 7079 7465         with pyte
+0003f9e0: 7374 2e72 6169 7365 7328 4442 4572 726f  st.raises(DBErro
+0003f9f0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
+0003fa00: 2020 2020 7366 2e63 6f70 7928 2274 6162      sf.copy("tab
+0003fa10: 6c65 5f6e 616d 6522 2c20 2240 7e2f 7374  le_name", "@~/st
+0003fa20: 6167 6522 290a 0a20 2020 2020 2020 2020  age")..         
+0003fa30: 2020 2073 662e 636f 6e6e 203d 204e 6f6e     sf.conn = Non
+0003fa40: 650a 2020 2020 2020 2020 2020 2020 7769  e.            wi
+0003fa50: 7468 2070 7974 6573 742e 7261 6973 6573  th pytest.raises
+0003fa60: 2844 4245 7272 6f72 293a 0a20 2020 2020  (DBError):.     
+0003fa70: 2020 2020 2020 2020 2020 2073 662e 636f             sf.co
+0003fa80: 7079 2822 7461 626c 655f 6e61 6d65 222c  py("table_name",
+0003fa90: 2022 407e 2f73 7461 6765 2229 0a0a 0a40   "@~/stage")...@
+0003faa0: 7079 7465 7374 2e6d 6172 6b2e 7061 7261  pytest.mark.para
+0003fab0: 6d65 7472 697a 6528 0a20 2020 2022 6669  metrize(.    "fi
+0003fac0: 6c65 5f74 7970 652c 2066 6f72 6d61 745f  le_type, format_
+0003fad0: 6f70 7469 6f6e 732c 2068 6561 6465 722c  options, header,
+0003fae0: 2063 6f70 795f 6f70 7469 6f6e 732c 2065   copy_options, e
+0003faf0: 7870 6563 7465 6422 2c0a 2020 2020 5b0a  xpected",.    [.
+0003fb00: 2020 2020 2020 2020 2822 6373 7622 2c20          ("csv", 
+0003fb10: 4e6f 6e65 2c20 4661 6c73 652c 204e 6f6e  None, False, Non
+0003fb20: 652c 2022 2854 5950 453d 2763 7376 2720  e, "(TYPE='csv' 
+0003fb30: 4649 454c 445f 4445 4c49 4d49 5445 523d  FIELD_DELIMITER=
+0003fb40: 277c 2729 2048 4541 4445 523d 4661 6c73  '|') HEADER=Fals
+0003fb50: 6520 2229 2c0a 2020 2020 2020 2020 280a  e "),.        (.
+0003fb60: 2020 2020 2020 2020 2020 2020 2263 7376              "csv
+0003fb70: 222c 0a20 2020 2020 2020 2020 2020 205b  ",.            [
+0003fb80: 2246 4945 4c44 5f44 454c 494d 4954 4552  "FIELD_DELIMITER
+0003fb90: 3d27 2c27 225d 2c0a 2020 2020 2020 2020  =','"],.        
+0003fba0: 2020 2020 5472 7565 2c0a 2020 2020 2020      True,.      
+0003fbb0: 2020 2020 2020 4e6f 6e65 2c0a 2020 2020        None,.    
+0003fbc0: 2020 2020 2020 2020 2228 5459 5045 3d27          "(TYPE='
+0003fbd0: 6373 7627 2046 4945 4c44 5f44 454c 494d  csv' FIELD_DELIM
+0003fbe0: 4954 4552 3d27 2c27 2920 4845 4144 4552  ITER=',') HEADER
+0003fbf0: 3d54 7275 6520 222c 0a20 2020 2020 2020  =True ",.       
+0003fc00: 2029 2c0a 2020 2020 2020 2020 280a 2020   ),.        (.  
+0003fc10: 2020 2020 2020 2020 2020 2263 7376 222c            "csv",
+0003fc20: 0a20 2020 2020 2020 2020 2020 205b 2246  .            ["F
+0003fc30: 4945 4c44 5f44 454c 494d 4954 4552 3d27  IELD_DELIMITER='
+0003fc40: 2c27 222c 2022 613d 3122 2c20 2262 3d32  ,'", "a=1", "b=2
+0003fc50: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
+0003fc60: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+0003fc70: 2020 5b22 633d 3322 2c20 2264 3d34 225d    ["c=3", "d=4"]
+0003fc80: 2c0a 2020 2020 2020 2020 2020 2020 2228  ,.            "(
+0003fc90: 5459 5045 3d27 6373 7627 2046 4945 4c44  TYPE='csv' FIELD
+0003fca0: 5f44 454c 494d 4954 4552 3d27 2c27 2061  _DELIMITER=',' a
+0003fcb0: 3d31 2062 3d32 2920 4845 4144 4552 3d54  =1 b=2) HEADER=T
+0003fcc0: 7275 6520 633d 3320 643d 3422 2c0a 2020  rue c=3 d=4",.  
+0003fcd0: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
+0003fce0: 2028 2270 6172 7175 6574 222c 204e 6f6e   ("parquet", Non
+0003fcf0: 652c 2046 616c 7365 2c20 4e6f 6e65 2c20  e, False, None, 
+0003fd00: 2228 5459 5045 3d27 7061 7271 7565 7427  "(TYPE='parquet'
+0003fd10: 2029 2048 4541 4445 523d 4661 6c73 6520   ) HEADER=False 
+0003fd20: 2229 2c0a 2020 2020 2020 2020 280a 2020  "),.        (.  
+0003fd30: 2020 2020 2020 2020 2020 2270 6172 7175            "parqu
+0003fd40: 6574 222c 0a20 2020 2020 2020 2020 2020  et",.           
+0003fd50: 205b 2253 4e41 5050 595f 434f 4d50 5245   ["SNAPPY_COMPRE
+0003fd60: 5353 494f 4e3d 4641 4c53 4522 5d2c 0a20  SSION=FALSE"],. 
+0003fd70: 2020 2020 2020 2020 2020 2046 616c 7365             False
+0003fd80: 2c0a 2020 2020 2020 2020 2020 2020 5b22  ,.            ["
+0003fd90: 633d 3322 2c20 2264 3d34 225d 2c0a 2020  c=3", "d=4"],.  
+0003fda0: 2020 2020 2020 2020 2020 2228 5459 5045            "(TYPE
+0003fdb0: 3d27 7061 7271 7565 7427 2053 4e41 5050  ='parquet' SNAPP
+0003fdc0: 595f 434f 4d50 5245 5353 494f 4e3d 4641  Y_COMPRESSION=FA
+0003fdd0: 4c53 4529 2048 4541 4445 523d 4661 6c73  LSE) HEADER=Fals
+0003fde0: 6520 633d 3320 643d 3422 2c0a 2020 2020  e c=3 d=4",.    
+0003fdf0: 2020 2020 292c 0a20 2020 2020 2020 2028      ),.        (
+0003fe00: 226a 736f 6e22 2c20 4e6f 6e65 2c20 4661  "json", None, Fa
+0003fe10: 6c73 652c 204e 6f6e 652c 2022 2854 5950  lse, None, "(TYP
+0003fe20: 453d 276a 736f 6e27 2029 2048 4541 4445  E='json' ) HEADE
+0003fe30: 523d 4661 6c73 6520 2229 2c0a 2020 2020  R=False "),.    
+0003fe40: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
+0003fe50: 2020 226a 736f 6e22 2c0a 2020 2020 2020    "json",.      
+0003fe60: 2020 2020 2020 5b22 434f 4d50 5245 5353        ["COMPRESS
+0003fe70: 494f 4e3d 475a 4950 225d 2c0a 2020 2020  ION=GZIP"],.    
+0003fe80: 2020 2020 2020 2020 4661 6c73 652c 0a20          False,. 
+0003fe90: 2020 2020 2020 2020 2020 205b 2263 3d33             ["c=3
+0003fea0: 222c 2022 643d 3422 5d2c 0a20 2020 2020  ", "d=4"],.     
+0003feb0: 2020 2020 2020 2022 2854 5950 453d 276a         "(TYPE='j
+0003fec0: 736f 6e27 2043 4f4d 5052 4553 5349 4f4e  son' COMPRESSION
+0003fed0: 3d47 5a49 5029 2048 4541 4445 523d 4661  =GZIP) HEADER=Fa
+0003fee0: 6c73 6520 633d 3320 643d 3422 2c0a 2020  lse c=3 d=4",.  
+0003fef0: 2020 2020 2020 292c 0a20 2020 205d 2c0a        ),.    ],.
+0003ff00: 290a 406d 6f63 6b2e 7061 7463 6828 226c  ).@mock.patch("l
+0003ff10: 6f63 6f70 792e 7333 2e53 6573 7369 6f6e  ocopy.s3.Session
+0003ff20: 2229 0a64 6566 2074 6573 745f 756e 6c6f  ").def test_unlo
+0003ff30: 6164 280a 2020 2020 6d6f 636b 5f73 6573  ad(.    mock_ses
+0003ff40: 7369 6f6e 2c0a 2020 2020 6669 6c65 5f74  sion,.    file_t
+0003ff50: 7970 652c 0a20 2020 2066 6f72 6d61 745f  ype,.    format_
+0003ff60: 6f70 7469 6f6e 732c 0a20 2020 2068 6561  options,.    hea
+0003ff70: 6465 722c 0a20 2020 2063 6f70 795f 6f70  der,.    copy_op
+0003ff80: 7469 6f6e 732c 0a20 2020 2065 7870 6563  tions,.    expec
+0003ff90: 7465 642c 0a20 2020 2073 665f 6372 6564  ted,.    sf_cred
+0003ffa0: 656e 7469 616c 732c 0a29 3a0a 2020 2020  entials,.):.    
+0003ffb0: 7769 7468 206d 6f63 6b2e 7061 7463 6828  with mock.patch(
+0003ffc0: 2273 6e6f 7766 6c61 6b65 2e63 6f6e 6e65  "snowflake.conne
+0003ffd0: 6374 6f72 2e63 6f6e 6e65 6374 2229 2061  ctor.connect") a
+0003ffe0: 7320 6d6f 636b 5f63 6f6e 6e65 6374 3a0a  s mock_connect:.
+0003fff0: 2020 2020 2020 2020 7769 7468 2053 6e6f          with Sno
+00040000: 7766 6c61 6b65 2870 726f 6669 6c65 3d50  wflake(profile=P
+00040010: 524f 4649 4c45 2c20 6462 6170 693d 4442  ROFILE, dbapi=DB
+00040020: 4150 4953 2c20 2a2a 7366 5f63 7265 6465  APIS, **sf_crede
+00040030: 6e74 6961 6c73 2920 6173 2073 663a 0a0a  ntials) as sf:..
+00040040: 2020 2020 2020 2020 2020 2020 7366 2e75              sf.u
+00040050: 6e6c 6f61 6428 0a20 2020 2020 2020 2020  nload(.         
+00040060: 2020 2020 2020 2022 407e 2f73 7461 6765         "@~/stage
+00040070: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00040080: 2020 2022 7461 626c 655f 6e61 6d65 222c     "table_name",
+00040090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000400a0: 2066 696c 655f 7479 7065 3d66 696c 655f   file_type=file_
+000400b0: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+000400c0: 2020 2020 2020 666f 726d 6174 5f6f 7074        format_opt
+000400d0: 696f 6e73 3d66 6f72 6d61 745f 6f70 7469  ions=format_opti
+000400e0: 6f6e 732c 0a20 2020 2020 2020 2020 2020  ons,.           
+000400f0: 2020 2020 2068 6561 6465 723d 6865 6164       header=head
+00040100: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+00040110: 2020 2020 636f 7079 5f6f 7074 696f 6e73      copy_options
+00040120: 3d63 6f70 795f 6f70 7469 6f6e 732c 0a20  =copy_options,. 
+00040130: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00040140: 2020 2020 2020 2020 2073 662e 636f 6e6e           sf.conn
+00040150: 2e63 7572 736f 722e 7265 7475 726e 5f76  .cursor.return_v
+00040160: 616c 7565 2e65 7865 6375 7465 2e61 7373  alue.execute.ass
+00040170: 6572 745f 6361 6c6c 6564 5f77 6974 6828  ert_called_with(
+00040180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040190: 2022 434f 5059 2049 4e54 4f20 407e 2f73   "COPY INTO @~/s
+000401a0: 7461 6765 2046 524f 4d20 7461 626c 655f  tage FROM table_
+000401b0: 6e61 6d65 2046 494c 455f 464f 524d 4154  name FILE_FORMAT
+000401c0: 203d 207b 307d 222e 666f 726d 6174 2865   = {0}".format(e
+000401d0: 7870 6563 7465 6429 2c0a 2020 2020 2020  xpected),.      
+000401e0: 2020 2020 2020 2020 2020 2829 2c0a 2020            (),.  
+000401f0: 2020 2020 2020 2020 2020 290a 0a0a 406d            )...@m
+00040200: 6f63 6b2e 7061 7463 6828 226c 6f63 6f70  ock.patch("locop
+00040210: 792e 7333 2e53 6573 7369 6f6e 2229 0a64  y.s3.Session").d
+00040220: 6566 2074 6573 745f 756e 6c6f 6164 5f65  ef test_unload_e
+00040230: 7863 6570 7469 6f6e 286d 6f63 6b5f 7365  xception(mock_se
+00040240: 7373 696f 6e2c 2073 665f 6372 6564 656e  ssion, sf_creden
+00040250: 7469 616c 7329 3a0a 2020 2020 7769 7468  tials):.    with
+00040260: 206d 6f63 6b2e 7061 7463 6828 2273 6e6f   mock.patch("sno
+00040270: 7766 6c61 6b65 2e63 6f6e 6e65 6374 6f72  wflake.connector
+00040280: 2e63 6f6e 6e65 6374 2229 2061 7320 6d6f  .connect") as mo
+00040290: 636b 5f63 6f6e 6e65 6374 3a0a 2020 2020  ck_connect:.    
+000402a0: 2020 2020 7769 7468 2053 6e6f 7766 6c61      with Snowfla
+000402b0: 6b65 2870 726f 6669 6c65 3d50 524f 4649  ke(profile=PROFI
+000402c0: 4c45 2c20 6462 6170 693d 4442 4150 4953  LE, dbapi=DBAPIS
+000402d0: 2c20 2a2a 7366 5f63 7265 6465 6e74 6961  , **sf_credentia
+000402e0: 6c73 2920 6173 2073 663a 0a0a 2020 2020  ls) as sf:..    
+000402f0: 2020 2020 2020 2020 7769 7468 2070 7974          with pyt
+00040300: 6573 742e 7261 6973 6573 2856 616c 7565  est.raises(Value
+00040310: 4572 726f 7229 3a0a 2020 2020 2020 2020  Error):.        
+00040320: 2020 2020 2020 2020 7366 2e75 6e6c 6f61          sf.unloa
+00040330: 6428 2274 6162 6c65 5f6e 616d 6522 2c20  d("table_name", 
+00040340: 2240 7e2f 7374 6167 6522 2c20 6669 6c65  "@~/stage", file
+00040350: 5f74 7970 653d 2275 6e6b 6e6f 776e 2229  _type="unknown")
+00040360: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00040370: 6578 6365 7074 696f 6e0a 2020 2020 2020  exception.      
+00040380: 2020 2020 2020 7366 2e63 6f6e 6e2e 6375        sf.conn.cu
+00040390: 7273 6f72 2e72 6574 7572 6e5f 7661 6c75  rsor.return_valu
+000403a0: 652e 6578 6563 7574 652e 7369 6465 5f65  e.execute.side_e
+000403b0: 6666 6563 7420 3d20 4578 6365 7074 696f  ffect = Exceptio
+000403c0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+000403d0: 2020 2022 554e 4c4f 4144 2045 7863 6570     "UNLOAD Excep
+000403e0: 7469 6f6e 220a 2020 2020 2020 2020 2020  tion".          
+000403f0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00040400: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
+00040410: 6573 2844 4245 7272 6f72 293a 0a20 2020  es(DBError):.   
+00040420: 2020 2020 2020 2020 2020 2020 2073 662e               sf.
+00040430: 756e 6c6f 6164 2822 407e 2f73 7461 6765  unload("@~/stage
+00040440: 222c 2022 7461 626c 655f 6e61 6d65 2229  ", "table_name")
+00040450: 0a0a 2020 2020 2020 2020 2020 2020 7366  ..            sf
+00040460: 2e63 6f6e 6e20 3d20 4e6f 6e65 0a20 2020  .conn = None.   
+00040470: 2020 2020 2020 2020 2077 6974 6820 7079           with py
+00040480: 7465 7374 2e72 6169 7365 7328 4442 4572  test.raises(DBEr
+00040490: 726f 7229 3a0a 2020 2020 2020 2020 2020  ror):.          
+000404a0: 2020 2020 2020 7366 2e75 6e6c 6f61 6428        sf.unload(
+000404b0: 2240 7e2f 7374 6167 6522 2c20 2274 6162  "@~/stage", "tab
+000404c0: 6c65 5f6e 616d 6522 290a 0a0a 406d 6f63  le_name")...@moc
+000404d0: 6b2e 7061 7463 6828 226c 6f63 6f70 792e  k.patch("locopy.
+000404e0: 7333 2e53 6573 7369 6f6e 2229 0a64 6566  s3.Session").def
+000404f0: 2074 6573 745f 746f 5f70 616e 6461 7328   test_to_pandas(
+00040500: 6d6f 636b 5f73 6573 7369 6f6e 2c20 7366  mock_session, sf
+00040510: 5f63 7265 6465 6e74 6961 6c73 293a 0a20  _credentials):. 
+00040520: 2020 2069 6d70 6f72 7420 7061 6e64 6173     import pandas
+00040530: 2061 7320 7064 0a0a 2020 2020 7465 7374   as pd..    test
+00040540: 5f64 6620 3d20 7064 2e72 6561 645f 6373  _df = pd.read_cs
+00040550: 7628 6f73 2e70 6174 682e 6a6f 696e 2843  v(os.path.join(C
+00040560: 5552 525f 4449 522c 2022 6461 7461 222c  URR_DIR, "data",
+00040570: 2022 6d6f 636b 5f64 6174 6166 7261 6d65   "mock_dataframe
+00040580: 2e74 7874 2229 2c20 7365 703d 222c 2229  .txt"), sep=",")
+00040590: 0a20 2020 2077 6974 6820 6d6f 636b 2e70  .    with mock.p
+000405a0: 6174 6368 2822 736e 6f77 666c 616b 652e  atch("snowflake.
+000405b0: 636f 6e6e 6563 746f 722e 636f 6e6e 6563  connector.connec
+000405c0: 7422 2920 6173 206d 6f63 6b5f 636f 6e6e  t") as mock_conn
+000405d0: 6563 743a 0a20 2020 2020 2020 2077 6974  ect:.        wit
+000405e0: 6820 536e 6f77 666c 616b 6528 7072 6f66  h Snowflake(prof
+000405f0: 696c 653d 5052 4f46 494c 452c 2064 6261  ile=PROFILE, dba
+00040600: 7069 3d44 4241 5049 532c 202a 2a73 665f  pi=DBAPIS, **sf_
+00040610: 6372 6564 656e 7469 616c 7329 2061 7320  credentials) as 
+00040620: 7366 3a0a 2020 2020 2020 2020 2020 2020  sf:.            
+00040630: 7366 2e63 7572 736f 722e 5f71 7565 7279  sf.cursor._query
+00040640: 5f72 6573 756c 745f 666f 726d 6174 203d  _result_format =
+00040650: 2022 6172 726f 7722 0a20 2020 2020 2020   "arrow".       
+00040660: 2020 2020 2073 662e 746f 5f64 6174 6166       sf.to_dataf
+00040670: 7261 6d65 2829 0a20 2020 2020 2020 2020  rame().         
+00040680: 2020 2073 662e 636f 6e6e 2e63 7572 736f     sf.conn.curso
+00040690: 722e 7265 7475 726e 5f76 616c 7565 2e66  r.return_value.f
+000406a0: 6574 6368 5f70 616e 6461 735f 616c 6c2e  etch_pandas_all.
+000406b0: 6173 7365 7274 5f63 616c 6c65 645f 7769  assert_called_wi
+000406c0: 7468 2829 0a0a 2020 2020 2020 2020 2020  th()..          
+000406d0: 2020 7366 2e63 7572 736f 722e 5f71 7565    sf.cursor._que
+000406e0: 7279 5f72 6573 756c 745f 666f 726d 6174  ry_result_format
+000406f0: 203d 2022 6a73 6f6e 220a 2020 2020 2020   = "json".      
+00040700: 2020 2020 2020 7366 2e74 6f5f 6461 7461        sf.to_data
+00040710: 6672 616d 6528 290a 2020 2020 2020 2020  frame().        
+00040720: 2020 2020 7366 2e63 6f6e 6e2e 6375 7273      sf.conn.curs
+00040730: 6f72 2e72 6574 7572 6e5f 7661 6c75 652e  or.return_value.
+00040740: 6665 7463 6861 6c6c 2e61 7373 6572 745f  fetchall.assert_
+00040750: 6361 6c6c 6564 5f77 6974 6828 290a 0a20  called_with().. 
+00040760: 2020 2020 2020 2020 2020 2073 662e 746f             sf.to
+00040770: 5f64 6174 6166 7261 6d65 2835 290a 2020  _dataframe(5).  
+00040780: 2020 2020 2020 2020 2020 7366 2e63 6f6e            sf.con
+00040790: 6e2e 6375 7273 6f72 2e72 6574 7572 6e5f  n.cursor.return_
+000407a0: 7661 6c75 652e 6665 7463 686d 616e 792e  value.fetchmany.
+000407b0: 6173 7365 7274 5f63 616c 6c65 645f 7769  assert_called_wi
+000407c0: 7468 2835 290a 0a0a 406d 6f63 6b2e 7061  th(5)...@mock.pa
+000407d0: 7463 6828 226c 6f63 6f70 792e 7333 2e53  tch("locopy.s3.S
+000407e0: 6573 7369 6f6e 2229 0a64 6566 2074 6573  ession").def tes
+000407f0: 745f 696e 7365 7274 5f64 6174 6166 7261  t_insert_datafra
+00040800: 6d65 5f74 6f5f 7461 626c 6528 6d6f 636b  me_to_table(mock
+00040810: 5f73 6573 7369 6f6e 2c20 7366 5f63 7265  _session, sf_cre
+00040820: 6465 6e74 6961 6c73 293a 0a20 2020 2069  dentials):.    i
+00040830: 6d70 6f72 7420 7061 6e64 6173 2061 7320  mport pandas as 
+00040840: 7064 0a0a 2020 2020 7465 7374 5f64 6620  pd..    test_df 
+00040850: 3d20 7064 2e72 6561 645f 6373 7628 6f73  = pd.read_csv(os
+00040860: 2e70 6174 682e 6a6f 696e 2843 5552 525f  .path.join(CURR_
+00040870: 4449 522c 2022 6461 7461 222c 2022 6d6f  DIR, "data", "mo
+00040880: 636b 5f64 6174 6166 7261 6d65 2e74 7874  ck_dataframe.txt
+00040890: 2229 2c20 7365 703d 222c 2229 0a20 2020  "), sep=",").   
+000408a0: 2077 6974 6820 6d6f 636b 2e70 6174 6368   with mock.patch
+000408b0: 2822 736e 6f77 666c 616b 652e 636f 6e6e  ("snowflake.conn
+000408c0: 6563 746f 722e 636f 6e6e 6563 7422 2920  ector.connect") 
+000408d0: 6173 206d 6f63 6b5f 636f 6e6e 6563 743a  as mock_connect:
+000408e0: 0a20 2020 2020 2020 2077 6974 6820 536e  .        with Sn
+000408f0: 6f77 666c 616b 6528 7072 6f66 696c 653d  owflake(profile=
+00040900: 5052 4f46 494c 452c 2064 6261 7069 3d44  PROFILE, dbapi=D
+00040910: 4241 5049 532c 202a 2a73 665f 6372 6564  BAPIS, **sf_cred
+00040920: 656e 7469 616c 7329 2061 7320 7366 3a0a  entials) as sf:.
+00040930: 2020 2020 2020 2020 2020 2020 7366 2e69              sf.i
+00040940: 6e73 6572 745f 6461 7461 6672 616d 655f  nsert_dataframe_
+00040950: 746f 5f74 6162 6c65 2874 6573 745f 6466  to_table(test_df
+00040960: 2c20 2264 6174 6162 6173 652e 7363 6865  , "database.sche
+00040970: 6d61 2e74 6573 7422 290a 2020 2020 2020  ma.test").      
+00040980: 2020 2020 2020 7366 2e63 6f6e 6e2e 6375        sf.conn.cu
+00040990: 7273 6f72 2e72 6574 7572 6e5f 7661 6c75  rsor.return_valu
+000409a0: 652e 6578 6563 7574 656d 616e 792e 6173  e.executemany.as
+000409b0: 7365 7274 5f63 616c 6c65 645f 7769 7468  sert_called_with
+000409c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000409d0: 2020 2249 4e53 4552 5420 494e 544f 2064    "INSERT INTO d
+000409e0: 6174 6162 6173 652e 7363 6865 6d61 2e74  atabase.schema.t
+000409f0: 6573 7420 2861 2c62 2c63 2920 5641 4c55  est (a,b,c) VALU
+00040a00: 4553 2028 2573 2c25 732c 2573 2922 2c0a  ES (%s,%s,%s)",.
+00040a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040a20: 5b28 2231 222c 2022 7822 2c20 2232 3031  [("1", "x", "201
+00040a30: 312d 3031 2d30 3122 292c 2028 2232 222c  1-01-01"), ("2",
+00040a40: 2022 7922 2c20 2232 3030 312d 3034 2d30   "y", "2001-04-0
+00040a50: 3222 295d 2c0a 2020 2020 2020 2020 2020  2")],.          
+00040a60: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+00040a70: 2073 662e 696e 7365 7274 5f64 6174 6166   sf.insert_dataf
+00040a80: 7261 6d65 5f74 6f5f 7461 626c 6528 7465  rame_to_table(te
+00040a90: 7374 5f64 662c 2022 6461 7461 6261 7365  st_df, "database
+00040aa0: 2e73 6368 656d 612e 7465 7374 222c 2063  .schema.test", c
+00040ab0: 7265 6174 653d 5472 7565 290a 2020 2020  reate=True).    
+00040ac0: 2020 2020 2020 2020 7366 2e63 6f6e 6e2e          sf.conn.
+00040ad0: 6375 7273 6f72 2e72 6574 7572 6e5f 7661  cursor.return_va
+00040ae0: 6c75 652e 6578 6563 7574 652e 6173 7365  lue.execute.asse
+00040af0: 7274 5f61 6e79 5f63 616c 6c28 0a20 2020  rt_any_call(.   
+00040b00: 2020 2020 2020 2020 2020 2020 2022 4352               "CR
+00040b10: 4541 5445 2054 4142 4c45 2064 6174 6162  EATE TABLE datab
+00040b20: 6173 652e 7363 6865 6d61 2e74 6573 7420  ase.schema.test 
+00040b30: 2861 2069 6e74 2c62 2076 6172 6368 6172  (a int,b varchar
+00040b40: 2c63 2064 6174 6529 222c 2028 290a 2020  ,c date)", ().  
+00040b50: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00040b60: 2020 2020 2020 2020 7366 2e63 6f6e 6e2e          sf.conn.
+00040b70: 6375 7273 6f72 2e72 6574 7572 6e5f 7661  cursor.return_va
+00040b80: 6c75 652e 6578 6563 7574 656d 616e 792e  lue.executemany.
+00040b90: 6173 7365 7274 5f63 616c 6c65 645f 7769  assert_called_wi
+00040ba0: 7468 280a 2020 2020 2020 2020 2020 2020  th(.            
+00040bb0: 2020 2020 2249 4e53 4552 5420 494e 544f      "INSERT INTO
+00040bc0: 2064 6174 6162 6173 652e 7363 6865 6d61   database.schema
+00040bd0: 2e74 6573 7420 2861 2c62 2c63 2920 5641  .test (a,b,c) VA
+00040be0: 4c55 4553 2028 2573 2c25 732c 2573 2922  LUES (%s,%s,%s)"
+00040bf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00040c00: 2020 5b28 2231 222c 2022 7822 2c20 2232    [("1", "x", "2
+00040c10: 3031 312d 3031 2d30 3122 292c 2028 2232  011-01-01"), ("2
+00040c20: 222c 2022 7922 2c20 2232 3030 312d 3034  ", "y", "2001-04
+00040c30: 2d30 3222 295d 2c0a 2020 2020 2020 2020  -02")],.        
+00040c40: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+00040c50: 2020 2073 662e 696e 7365 7274 5f64 6174     sf.insert_dat
+00040c60: 6166 7261 6d65 5f74 6f5f 7461 626c 6528  aframe_to_table(
+00040c70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040c80: 2074 6573 745f 6466 2c20 2264 6174 6162   test_df, "datab
+00040c90: 6173 652e 7363 6865 6d61 2e74 6573 7422  ase.schema.test"
+00040ca0: 2c20 636f 6c75 6d6e 733d 5b22 6122 2c20  , columns=["a", 
+00040cb0: 2262 225d 0a20 2020 2020 2020 2020 2020  "b"].           
+00040cc0: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
+00040cd0: 7366 2e63 6f6e 6e2e 6375 7273 6f72 2e72  sf.conn.cursor.r
+00040ce0: 6574 7572 6e5f 7661 6c75 652e 6578 6563  eturn_value.exec
+00040cf0: 7574 656d 616e 792e 6173 7365 7274 5f63  utemany.assert_c
+00040d00: 616c 6c65 645f 7769 7468 280a 2020 2020  alled_with(.    
+00040d10: 2020 2020 2020 2020 2020 2020 2249 4e53              "INS
+00040d20: 4552 5420 494e 544f 2064 6174 6162 6173  ERT INTO databas
+00040d30: 652e 7363 6865 6d61 2e74 6573 7420 2861  e.schema.test (a
+00040d40: 2c62 2920 5641 4c55 4553 2028 2573 2c25  ,b) VALUES (%s,%
+00040d50: 7329 222c 0a20 2020 2020 2020 2020 2020  s)",.           
+00040d60: 2020 2020 205b 2822 3122 2c20 2278 2229       [("1", "x")
+00040d70: 2c20 2822 3222 2c20 2279 2229 5d2c 0a20  , ("2", "y")],. 
+00040d80: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00040d90: 2020 2020 2020 2020 2020 7366 2e69 6e73            sf.ins
+00040da0: 6572 745f 6461 7461 6672 616d 655f 746f  ert_dataframe_to
+00040db0: 5f74 6162 6c65 280a 2020 2020 2020 2020  _table(.        
+00040dc0: 2020 2020 2020 2020 7465 7374 5f64 662c          test_df,
+00040dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040de0: 2022 6461 7461 6261 7365 2e73 6368 656d   "database.schem
+00040df0: 612e 7465 7374 222c 0a20 2020 2020 2020  a.test",.       
+00040e00: 2020 2020 2020 2020 2063 7265 6174 653d           create=
+00040e10: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
+00040e20: 2020 2020 2020 6d65 7461 6461 7461 3d4f        metadata=O
+00040e30: 7264 6572 6564 4469 6374 280a 2020 2020  rderedDict(.    
+00040e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040e50: 5b28 2263 6f6c 3122 2c20 2269 6e74 2229  [("col1", "int")
+00040e60: 2c20 2822 636f 6c32 222c 2022 7661 7263  , ("col2", "varc
+00040e70: 6861 7222 292c 2028 2263 6f6c 3322 2c20  har"), ("col3", 
+00040e80: 2264 6174 6522 295d 0a20 2020 2020 2020  "date")].       
+00040e90: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
+00040ea0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00040eb0: 2020 2020 2020 2073 662e 636f 6e6e 2e63         sf.conn.c
+00040ec0: 7572 736f 722e 7265 7475 726e 5f76 616c  ursor.return_val
+00040ed0: 7565 2e65 7865 6375 7465 2e61 7373 6572  ue.execute.asser
+00040ee0: 745f 616e 795f 6361 6c6c 280a 2020 2020  t_any_call(.    
+00040ef0: 2020 2020 2020 2020 2020 2020 2243 5245              "CRE
+00040f00: 4154 4520 5441 424c 4520 6461 7461 6261  ATE TABLE databa
+00040f10: 7365 2e73 6368 656d 612e 7465 7374 2028  se.schema.test (
+00040f20: 636f 6c31 2069 6e74 2c63 6f6c 3220 7661  col1 int,col2 va
+00040f30: 7263 6861 722c 636f 6c33 2064 6174 6529  rchar,col3 date)
+00040f40: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00040f50: 2020 2028 292c 0a20 2020 2020 2020 2020     (),.         
+00040f60: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00040f70: 2073 662e 636f 6e6e 2e63 7572 736f 722e   sf.conn.cursor.
+00040f80: 7265 7475 726e 5f76 616c 7565 2e65 7865  return_value.exe
+00040f90: 6375 7465 6d61 6e79 2e61 7373 6572 745f  cutemany.assert_
+00040fa0: 6361 6c6c 6564 5f77 6974 6828 0a20 2020  called_with(.   
+00040fb0: 2020 2020 2020 2020 2020 2020 2022 494e               "IN
+00040fc0: 5345 5254 2049 4e54 4f20 6461 7461 6261  SERT INTO databa
+00040fd0: 7365 2e73 6368 656d 612e 7465 7374 2028  se.schema.test (
+00040fe0: 636f 6c31 2c63 6f6c 322c 636f 6c33 2920  col1,col2,col3) 
+00040ff0: 5641 4c55 4553 2028 2573 2c25 732c 2573  VALUES (%s,%s,%s
+00041000: 2922 2c0a 2020 2020 2020 2020 2020 2020  )",.            
+00041010: 2020 2020 5b28 2231 222c 2022 7822 2c20      [("1", "x", 
+00041020: 2232 3031 312d 3031 2d30 3122 292c 2028  "2011-01-01"), (
+00041030: 2232 222c 2022 7922 2c20 2232 3030 312d  "2", "y", "2001-
+00041040: 3034 2d30 3222 295d 2c0a 2020 2020 2020  04-02")],.      
+00041050: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00041060: 2020 2020 2073 662e 696e 7365 7274 5f64       sf.insert_d
+00041070: 6174 6166 7261 6d65 5f74 6f5f 7461 626c  ataframe_to_tabl
+00041080: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+00041090: 2020 2074 6573 745f 6466 2c0a 2020 2020     test_df,.    
+000410a0: 2020 2020 2020 2020 2020 2020 2264 6174              "dat
+000410b0: 6162 6173 652e 7363 6865 6d61 2e74 6573  abase.schema.tes
+000410c0: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
+000410d0: 2020 2020 6372 6561 7465 3d46 616c 7365      create=False
+000410e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000410f0: 2020 6d65 7461 6461 7461 3d4f 7264 6572    metadata=Order
+00041100: 6564 4469 6374 280a 2020 2020 2020 2020  edDict(.        
+00041110: 2020 2020 2020 2020 2020 2020 5b28 2263              [("c
+00041120: 6f6c 3122 2c20 2269 6e74 2229 2c20 2822  ol1", "int"), ("
+00041130: 636f 6c32 222c 2022 7661 7263 6861 7222  col2", "varchar"
+00041140: 292c 2028 2263 6f6c 3322 2c20 2264 6174  ), ("col3", "dat
+00041150: 6522 295d 0a20 2020 2020 2020 2020 2020  e")].           
+00041160: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+00041170: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+00041180: 2020 2023 206d 6f63 6b5f 7365 7373 696f     # mock_sessio
+00041190: 6e2e 7761 726e 2e61 7373 6572 745f 6361  n.warn.assert_ca
+000411a0: 6c6c 6564 5f77 6974 6828 274d 6574 6164  lled_with('Metad
+000411b0: 6174 6120 7769 6c6c 206e 6f74 2062 6520  ata will not be 
+000411c0: 7573 6564 2062 6563 6175 7365 2063 7265  used because cre
+000411d0: 6174 6520 6973 2073 6574 2074 6f20 4661  ate is set to Fa
+000411e0: 6c73 652e 2729 0a20 2020 2020 2020 2020  lse.').         
+000411f0: 2020 2073 662e 636f 6e6e 2e63 7572 736f     sf.conn.curso
+00041200: 722e 7265 7475 726e 5f76 616c 7565 2e65  r.return_value.e
+00041210: 7865 6375 7465 6d61 6e79 2e61 7373 6572  xecutemany.asser
+00041220: 745f 6361 6c6c 6564 5f77 6974 6828 0a20  t_called_with(. 
+00041230: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00041240: 494e 5345 5254 2049 4e54 4f20 6461 7461  INSERT INTO data
+00041250: 6261 7365 2e73 6368 656d 612e 7465 7374  base.schema.test
+00041260: 2028 612c 622c 6329 2056 414c 5545 5320   (a,b,c) VALUES 
+00041270: 2825 732c 2573 2c25 7329 222c 0a20 2020  (%s,%s,%s)",.   
+00041280: 2020 2020 2020 2020 2020 2020 205b 2822               [("
+00041290: 3122 2c20 2278 222c 2022 3230 3131 2d30  1", "x", "2011-0
+000412a0: 312d 3031 2229 2c20 2822 3222 2c20 2279  1-01"), ("2", "y
+000412b0: 222c 2022 3230 3031 2d30 342d 3032 2229  ", "2001-04-02")
+000412c0: 5d2c 0a20 2020 2020 2020 2020 2020 2029  ],.            )
+000412d0: 0a00 0000 0000 0000 0000 0000 0000 0000  ................
+000412e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000412f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000413a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000413b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000413c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000413d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000413e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000413f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041400: 2e2f 2e2f 4050 6178 4865 6164 6572 0000  ././@PaxHeader..
+00041410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041460: 0000 0000 3030 3030 3030 3000 3030 3030  ....0000000.0000
+00041470: 3030 3000 3030 3030 3030 3000 3030 3030  000.0000000.0000
+00041480: 3030 3030 3032 3600 3030 3030 3030 3030  0000026.00000000
+00041490: 3030 3000 3031 3134 3533 0020 7800 0000  000.011453. x...
+000414a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000414b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000414c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000414d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000414e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000414f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041500: 0075 7374 6172 0030 3000 0000 0000 0000  .ustar.00.......
+00041510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041540: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00041550: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00041560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000415a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000415b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000415c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000415d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000415e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000415f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041600: 3232 206d 7469 6d65 3d31 3638 3134 3134  22 mtime=1681414
+00041610: 3934 382e 300a 0000 0000 0000 0000 0000  948.0...........
+00041620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000416a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000416b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000416c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000416d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000416e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000416f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000417a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000417b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000417c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000417d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000417e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000417f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041800: 6c6f 636f 7079 2d30 2e35 2e31 2f74 6573  locopy-0.5.1/tes
+00041810: 7473 2f74 6573 745f 7574 696c 6974 792e  ts/test_utility.
+00041820: 7079 0000 0000 0000 0000 0000 0000 0000  py..............
+00041830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041860: 0000 0000 3030 3030 3634 3400 3030 3031  ....0000644.0001
+00041870: 3735 3100 3030 3030 3137 3300 3030 3030  751.0000173.0000
+00041880: 3030 3331 3533 3000 3030 3030 3030 3030  0031530.00000000
+00041890: 3030 3000 3032 3031 3034 0020 3000 0000  000.020104. 0...
+000418a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000418b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000418c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000418d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000418e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000418f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041900: 0075 7374 6172 0030 3072 756e 6e65 7200  .ustar.00runner.
+00041910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041920: 0000 0000 0000 0000 0064 6f63 6b65 7200  .........docker.
+00041930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041940: 0000 0000 0000 0000 0030 3030 3030 3030  .........0000000
+00041950: 0030 3030 3030 3030 0000 0000 0000 0000  .0000000........
+00041960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000419a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000419b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000419c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000419d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000419e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000419f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00041a00: 2320 4d49 5420 4c69 6365 6e73 650a 230a  # MIT License.#.
+00041a10: 2320 436f 7079 7269 6768 7420 2863 2920  # Copyright (c) 
+00041a20: 3230 3138 2043 6170 6974 616c 204f 6e65  2018 Capital One
+00041a30: 2053 6572 7669 6365 732c 204c 4c43 0a23   Services, LLC.#
+00041a40: 0a23 2050 6572 6d69 7373 696f 6e20 6973  .# Permission is
+00041a50: 2068 6572 6562 7920 6772 616e 7465 642c   hereby granted,
+00041a60: 2066 7265 6520 6f66 2063 6861 7267 652c   free of charge,
+00041a70: 2074 6f20 616e 7920 7065 7273 6f6e 206f   to any person o
+00041a80: 6274 6169 6e69 6e67 2061 2063 6f70 790a  btaining a copy.
+00041a90: 2320 6f66 2074 6869 7320 736f 6674 7761  # of this softwa
+00041aa0: 7265 2061 6e64 2061 7373 6f63 6961 7465  re and associate
+00041ab0: 6420 646f 6375 6d65 6e74 6174 696f 6e20  d documentation 
+00041ac0: 6669 6c65 7320 2874 6865 2022 536f 6674  files (the "Soft
+00041ad0: 7761 7265 2229 2c20 746f 2064 6561 6c0a  ware"), to deal.
+00041ae0: 2320 696e 2074 6865 2053 6f66 7477 6172  # in the Softwar
+00041af0: 6520 7769 7468 6f75 7420 7265 7374 7269  e without restri
+00041b00: 6374 696f 6e2c 2069 6e63 6c75 6469 6e67  ction, including
+00041b10: 2077 6974 686f 7574 206c 696d 6974 6174   without limitat
+00041b20: 696f 6e20 7468 6520 7269 6768 7473 0a23  ion the rights.#
+00041b30: 2074 6f20 7573 652c 2063 6f70 792c 206d   to use, copy, m
+00041b40: 6f64 6966 792c 206d 6572 6765 2c20 7075  odify, merge, pu
+00041b50: 626c 6973 682c 2064 6973 7472 6962 7574  blish, distribut
+00041b60: 652c 2073 7562 6c69 6365 6e73 652c 2061  e, sublicense, a
+00041b70: 6e64 2f6f 7220 7365 6c6c 0a23 2063 6f70  nd/or sell.# cop
+00041b80: 6965 7320 6f66 2074 6865 2053 6f66 7477  ies of the Softw
+00041b90: 6172 652c 2061 6e64 2074 6f20 7065 726d  are, and to perm
+00041ba0: 6974 2070 6572 736f 6e73 2074 6f20 7768  it persons to wh
+00041bb0: 6f6d 2074 6865 2053 6f66 7477 6172 6520  om the Software 
+00041bc0: 6973 0a23 2066 7572 6e69 7368 6564 2074  is.# furnished t
+00041bd0: 6f20 646f 2073 6f2c 2073 7562 6a65 6374  o do so, subject
+00041be0: 2074 6f20 7468 6520 666f 6c6c 6f77 696e   to the followin
+00041bf0: 6720 636f 6e64 6974 696f 6e73 3a0a 230a  g conditions:.#.
+00041c00: 2320 5468 6520 6162 6f76 6520 636f 7079  # The above copy
+00041c10: 7269 6768 7420 6e6f 7469 6365 2061 6e64  right notice and
+00041c20: 2074 6869 7320 7065 726d 6973 7369 6f6e   this permission
+00041c30: 206e 6f74 6963 6520 7368 616c 6c20 6265   notice shall be
+00041c40: 2069 6e63 6c75 6465 6420 696e 2061 6c6c   included in all
+00041c50: 0a23 2063 6f70 6965 7320 6f72 2073 7562  .# copies or sub
+00041c60: 7374 616e 7469 616c 2070 6f72 7469 6f6e  stantial portion
+00041c70: 7320 6f66 2074 6865 2053 6f66 7477 6172  s of the Softwar
+00041c80: 652e 0a23 0a23 2054 4845 2053 4f46 5457  e..#.# THE SOFTW
+00041c90: 4152 4520 4953 2050 524f 5649 4445 4420  ARE IS PROVIDED 
+00041ca0: 2241 5320 4953 222c 2057 4954 484f 5554  "AS IS", WITHOUT
+00041cb0: 2057 4152 5241 4e54 5920 4f46 2041 4e59   WARRANTY OF ANY
+00041cc0: 204b 494e 442c 2045 5850 5245 5353 204f   KIND, EXPRESS O
+00041cd0: 520a 2320 494d 504c 4945 442c 2049 4e43  R.# IMPLIED, INC
+00041ce0: 4c55 4449 4e47 2042 5554 204e 4f54 204c  LUDING BUT NOT L
+00041cf0: 494d 4954 4544 2054 4f20 5448 4520 5741  IMITED TO THE WA
+00041d00: 5252 414e 5449 4553 204f 4620 4d45 5243  RRANTIES OF MERC
+00041d10: 4841 4e54 4142 494c 4954 592c 0a23 2046  HANTABILITY,.# F
+00041d20: 4954 4e45 5353 2046 4f52 2041 2050 4152  ITNESS FOR A PAR
+00041d30: 5449 4355 4c41 5220 5055 5250 4f53 4520  TICULAR PURPOSE 
+00041d40: 414e 4420 4e4f 4e49 4e46 5249 4e47 454d  AND NONINFRINGEM
+00041d50: 454e 542e 2049 4e20 4e4f 2045 5645 4e54  ENT. IN NO EVENT
+00041d60: 2053 4841 4c4c 2054 4845 0a23 2041 5554   SHALL THE.# AUT
+00041d70: 484f 5253 204f 5220 434f 5059 5249 4748  HORS OR COPYRIGH
+00041d80: 5420 484f 4c44 4552 5320 4245 204c 4941  T HOLDERS BE LIA
+00041d90: 424c 4520 464f 5220 414e 5920 434c 4149  BLE FOR ANY CLAI
+00041da0: 4d2c 2044 414d 4147 4553 204f 5220 4f54  M, DAMAGES OR OT
+00041db0: 4845 520a 2320 4c49 4142 494c 4954 592c  HER.# LIABILITY,
+00041dc0: 2057 4845 5448 4552 2049 4e20 414e 2041   WHETHER IN AN A
+00041dd0: 4354 494f 4e20 4f46 2043 4f4e 5452 4143  CTION OF CONTRAC
+00041de0: 542c 2054 4f52 5420 4f52 204f 5448 4552  T, TORT OR OTHER
+00041df0: 5749 5345 2c20 4152 4953 494e 4720 4652  WISE, ARISING FR
+00041e00: 4f4d 2c0a 2320 4f55 5420 4f46 204f 5220  OM,.# OUT OF OR 
+00041e10: 494e 2043 4f4e 4e45 4354 494f 4e20 5749  IN CONNECTION WI
+00041e20: 5448 2054 4845 2053 4f46 5457 4152 4520  TH THE SOFTWARE 
+00041e30: 4f52 2054 4845 2055 5345 204f 5220 4f54  OR THE USE OR OT
+00041e40: 4845 5220 4445 414c 494e 4753 2049 4e20  HER DEALINGS IN 
+00041e50: 5448 450a 2320 534f 4654 5741 5245 2e0a  THE.# SOFTWARE..
+00041e60: 0a69 6d70 6f72 7420 6f73 0a69 6d70 6f72  .import os.impor
+00041e70: 7420 7379 730a 6672 6f6d 2069 6f20 696d  t sys.from io im
+00041e80: 706f 7274 2053 7472 696e 6749 4f0a 6672  port StringIO.fr
+00041e90: 6f6d 2069 7465 7274 6f6f 6c73 2069 6d70  om itertools imp
+00041ea0: 6f72 7420 6379 636c 650a 6672 6f6d 2075  ort cycle.from u
+00041eb0: 6e69 7474 6573 7420 696d 706f 7274 206d  nittest import m
+00041ec0: 6f63 6b0a 6672 6f6d 2070 6174 686c 6962  ock.from pathlib
+00041ed0: 2069 6d70 6f72 7420 5061 7468 0a0a 696d   import Path..im
+00041ee0: 706f 7274 2070 7974 6573 740a 0a69 6d70  port pytest..imp
+00041ef0: 6f72 7420 6c6f 636f 7079 2e75 7469 6c69  ort locopy.utili
+00041f00: 7479 2061 7320 7574 696c 0a66 726f 6d20  ty as util.from 
+00041f10: 6c6f 636f 7079 2e65 7272 6f72 7320 696d  locopy.errors im
+00041f20: 706f 7274 2028 0a20 2020 2043 6f6d 7072  port (.    Compr
+00041f30: 6573 7369 6f6e 4572 726f 722c 0a20 2020  essionError,.   
+00041f40: 2043 7265 6465 6e74 6961 6c73 4572 726f   CredentialsErro
+00041f50: 722c 0a20 2020 204c 6f63 6f70 7943 6f6e  r,.    LocopyCon
+00041f60: 6361 7445 7272 6f72 2c0a 2020 2020 4c6f  catError,.    Lo
+00041f70: 636f 7079 4967 6e6f 7265 4865 6164 6572  copyIgnoreHeader
+00041f80: 4572 726f 722c 0a20 2020 204c 6f63 6f70  Error,.    Locop
+00041f90: 7953 706c 6974 4572 726f 722c 0a29 0a66  ySplitError,.).f
+00041fa0: 726f 6d20 6c6f 636f 7079 2e75 7469 6c69  rom locopy.utili
+00041fb0: 7479 2069 6d70 6f72 7420 280a 2020 2020  ty import (.    
+00041fc0: 636f 6d70 7265 7373 5f66 696c 652c 0a20  compress_file,. 
+00041fd0: 2020 2063 6f6d 7072 6573 735f 6669 6c65     compress_file
+00041fe0: 5f6c 6973 742c 0a20 2020 2063 6f6e 6361  _list,.    conca
+00041ff0: 7465 6e61 7465 5f66 696c 6573 2c0a 2020  tenate_files,.  
+00042000: 2020 6669 6e64 5f63 6f6c 756d 6e5f 7479    find_column_ty
+00042010: 7065 2c0a 2020 2020 6765 745f 6967 6e6f  pe,.    get_igno
+00042020: 7265 6865 6164 6572 5f6e 756d 6265 722c  reheader_number,
+00042030: 0a20 2020 2073 706c 6974 5f66 696c 652c  .    split_file,
+00042040: 0a29 0a0a 474f 4f44 5f43 4f4e 4649 475f  .)..GOOD_CONFIG_
+00042050: 5941 4d4c 203d 2075 2222 2268 6f73 743a  YAML = u"""host:
+00042060: 206d 792e 7265 6473 6869 6674 2e63 6c75   my.redshift.clu
+00042070: 7374 6572 2e63 6f6d 0a70 6f72 743a 2031  ster.com.port: 1
+00042080: 3233 340a 6461 7461 6261 7365 3a20 6462  234.database: db
+00042090: 0a75 7365 723a 2075 7365 7269 640a 7061  .user: userid.pa
+000420a0: 7373 776f 7264 3a20 7061 7373 2222 220a  ssword: pass""".
+000420b0: 0a42 4144 5f43 4f4e 4649 475f 5941 4d4c  .BAD_CONFIG_YAML
+000420c0: 203d 2022 2222 706f 7274 3a20 3132 3334   = """port: 1234
+000420d0: 0a64 6174 6162 6173 653a 2064 620a 7573  .database: db.us
+000420e0: 6572 3a20 7573 6572 6964 0a70 6173 7377  er: userid.passw
+000420f0: 6f72 643a 2070 6173 7322 2222 0a0a 0a64  ord: pass"""...d
+00042100: 6566 2063 6c65 616e 7570 2873 706c 6974  ef cleanup(split
+00042110: 7329 3a0a 2020 2020 666f 7220 6669 6c65  s):.    for file
+00042120: 2069 6e20 7370 6c69 7473 3a0a 2020 2020   in splits:.    
+00042130: 2020 2020 6f73 2e72 656d 6f76 6528 6669      os.remove(fi
+00042140: 6c65 290a 0a0a 6465 6620 636f 6d70 6172  le)...def compar
+00042150: 655f 6669 6c65 5f63 6f6e 7465 6e74 7328  e_file_contents(
+00042160: 6261 7365 5f66 696c 652c 2063 6865 636b  base_file, check
+00042170: 5f66 696c 6573 293a 0a20 2020 2063 6865  _files):.    che
+00042180: 636b 5f66 696c 6573 203d 2063 7963 6c65  ck_files = cycle
+00042190: 285b 6f70 656e 2878 2c20 2272 6222 2920  ([open(x, "rb") 
+000421a0: 666f 7220 7820 696e 2063 6865 636b 5f66  for x in check_f
+000421b0: 696c 6573 5d29 0a20 2020 2077 6974 6820  iles]).    with 
+000421c0: 6f70 656e 2862 6173 655f 6669 6c65 2c20  open(base_file, 
+000421d0: 2272 6222 2920 6173 2062 6173 653a 0a20  "rb") as base:. 
+000421e0: 2020 2020 2020 2066 6f72 206c 696e 6520         for line 
+000421f0: 696e 2062 6173 653a 0a20 2020 2020 2020  in base:.       
+00042200: 2020 2020 2063 6669 6c65 203d 206e 6578       cfile = nex
+00042210: 7428 6368 6563 6b5f 6669 6c65 7329 0a20  t(check_files). 
+00042220: 2020 2020 2020 2020 2020 2063 6f6d 7061             compa
+00042230: 7265 5f6c 696e 6520 3d20 6366 696c 652e  re_line = cfile.
+00042240: 7265 6164 6c69 6e65 2829 0a20 2020 2020  readline().     
+00042250: 2020 2020 2020 2069 6620 636f 6d70 6172         if compar
+00042260: 655f 6c69 6e65 2021 3d20 6c69 6e65 3a0a  e_line != line:.
+00042270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042280: 7265 7475 726e 2046 616c 7365 0a20 2020  return False.   
+00042290: 2072 6574 7572 6e20 5472 7565 0a0a 0a40   return True...@
+000422a0: 6d6f 636b 2e70 6174 6368 2822 6c6f 636f  mock.patch("loco
+000422b0: 7079 2e75 7469 6c69 7479 2e6f 7065 6e22  py.utility.open"
+000422c0: 290a 406d 6f63 6b2e 7061 7463 6828 226c  ).@mock.patch("l
+000422d0: 6f63 6f70 792e 7574 696c 6974 792e 677a  ocopy.utility.gz
+000422e0: 6970 2e6f 7065 6e22 290a 406d 6f63 6b2e  ip.open").@mock.
+000422f0: 7061 7463 6828 226c 6f63 6f70 792e 7574  patch("locopy.ut
+00042300: 696c 6974 792e 7368 7574 696c 2e63 6f70  ility.shutil.cop
+00042310: 7966 696c 656f 626a 2229 0a64 6566 2074  yfileobj").def t
+00042320: 6573 745f 636f 6d70 7265 7373 5f66 696c  est_compress_fil
+00042330: 6528 6d6f 636b 5f73 6875 7469 6c2c 206d  e(mock_shutil, m
+00042340: 6f63 6b5f 677a 6970 5f6f 7065 6e2c 206d  ock_gzip_open, m
+00042350: 6f63 6b5f 6f70 656e 293a 0a20 2020 2063  ock_open):.    c
+00042360: 6f6d 7072 6573 735f 6669 6c65 2822 696e  ompress_file("in
+00042370: 7075 7422 2c20 226f 7574 7075 7422 290a  put", "output").
+00042380: 2020 2020 6d6f 636b 5f6f 7065 6e2e 6173      mock_open.as
+00042390: 7365 7274 5f63 616c 6c65 645f 7769 7468  sert_called_with
+000423a0: 2822 696e 7075 7422 2c20 2272 6222 290a  ("input", "rb").
+000423b0: 2020 2020 6d6f 636b 5f67 7a69 705f 6f70      mock_gzip_op
+000423c0: 656e 2e61 7373 6572 745f 6361 6c6c 6564  en.assert_called
+000423d0: 5f77 6974 6828 226f 7574 7075 7422 2c20  _with("output", 
+000423e0: 2277 6222 290a 2020 2020 6d6f 636b 5f73  "wb").    mock_s
+000423f0: 6875 7469 6c2e 6173 7365 7274 5f63 616c  hutil.assert_cal
+00042400: 6c65 645f 7769 7468 286d 6f63 6b5f 6f70  led_with(mock_op
+00042410: 656e 2829 2e5f 5f65 6e74 6572 5f5f 2829  en().__enter__()
+00042420: 2c20 6d6f 636b 5f67 7a69 705f 6f70 656e  , mock_gzip_open
+00042430: 2829 2e5f 5f65 6e74 6572 5f5f 2829 290a  ().__enter__()).
+00042440: 0a0a 406d 6f63 6b2e 7061 7463 6828 226c  ..@mock.patch("l
+00042450: 6f63 6f70 792e 7574 696c 6974 792e 6f70  ocopy.utility.op
+00042460: 656e 2229 0a40 6d6f 636b 2e70 6174 6368  en").@mock.patch
+00042470: 2822 6c6f 636f 7079 2e75 7469 6c69 7479  ("locopy.utility
+00042480: 2e67 7a69 702e 6f70 656e 2229 0a40 6d6f  .gzip.open").@mo
+00042490: 636b 2e70 6174 6368 2822 6c6f 636f 7079  ck.patch("locopy
+000424a0: 2e75 7469 6c69 7479 2e73 6875 7469 6c2e  .utility.shutil.
+000424b0: 636f 7079 6669 6c65 6f62 6a22 290a 6465  copyfileobj").de
+000424c0: 6620 7465 7374 5f63 6f6d 7072 6573 735f  f test_compress_
+000424d0: 6669 6c65 5f65 7863 6570 7469 6f6e 286d  file_exception(m
+000424e0: 6f63 6b5f 7368 7574 696c 2c20 6d6f 636b  ock_shutil, mock
+000424f0: 5f67 7a69 705f 6f70 656e 2c20 6d6f 636b  _gzip_open, mock
+00042500: 5f6f 7065 6e29 3a0a 2020 2020 6d6f 636b  _open):.    mock
+00042510: 5f73 6875 7469 6c2e 7369 6465 5f65 6666  _shutil.side_eff
+00042520: 6563 7420 3d20 4578 6365 7074 696f 6e28  ect = Exception(
+00042530: 2253 6f6d 6545 7863 6570 7469 6f6e 2229  "SomeException")
+00042540: 0a20 2020 2077 6974 6820 7079 7465 7374  .    with pytest
+00042550: 2e72 6169 7365 7328 436f 6d70 7265 7373  .raises(Compress
+00042560: 696f 6e45 7272 6f72 293a 0a20 2020 2020  ionError):.     
+00042570: 2020 2063 6f6d 7072 6573 735f 6669 6c65     compress_file
+00042580: 2822 696e 7075 7422 2c20 226f 7574 7075  ("input", "outpu
+00042590: 7422 290a 0a0a 406d 6f63 6b2e 7061 7463  t")...@mock.patc
+000425a0: 6828 226c 6f63 6f70 792e 7574 696c 6974  h("locopy.utilit
+000425b0: 792e 6f73 2e72 656d 6f76 6522 290a 406d  y.os.remove").@m
+000425c0: 6f63 6b2e 7061 7463 6828 226c 6f63 6f70  ock.patch("locop
+000425d0: 792e 7574 696c 6974 792e 6f70 656e 2229  y.utility.open")
+000425e0: 0a40 6d6f 636b 2e70 6174 6368 2822 6c6f  .@mock.patch("lo
+000425f0: 636f 7079 2e75 7469 6c69 7479 2e67 7a69  copy.utility.gzi
+00042600: 702e 6f70 656e 2229 0a40 6d6f 636b 2e70  p.open").@mock.p
+00042610: 6174 6368 2822 6c6f 636f 7079 2e75 7469  atch("locopy.uti
+00042620: 6c69 7479 2e73 6875 7469 6c2e 636f 7079  lity.shutil.copy
+00042630: 6669 6c65 6f62 6a22 290a 6465 6620 7465  fileobj").def te
+00042640: 7374 5f63 6f6d 7072 6573 735f 6669 6c65  st_compress_file
+00042650: 5f6c 6973 7428 6d6f 636b 5f73 6875 7469  _list(mock_shuti
+00042660: 6c2c 206d 6f63 6b5f 677a 6970 5f6f 7065  l, mock_gzip_ope
+00042670: 6e2c 206d 6f63 6b5f 6f70 656e 2c20 6d6f  n, mock_open, mo
+00042680: 636b 5f72 656d 6f76 6529 3a0a 2020 2020  ck_remove):.    
+00042690: 7265 7320 3d20 636f 6d70 7265 7373 5f66  res = compress_f
+000426a0: 696c 655f 6c69 7374 285b 5d29 0a20 2020  ile_list([]).   
+000426b0: 2061 7373 6572 7420 7265 7320 3d3d 205b   assert res == [
+000426c0: 5d0a 2020 2020 7265 7320 3d20 636f 6d70  ].    res = comp
+000426d0: 7265 7373 5f66 696c 655f 6c69 7374 285b  ress_file_list([
+000426e0: 2269 6e70 7574 3122 5d29 0a20 2020 2061  "input1"]).    a
+000426f0: 7373 6572 7420 7265 7320 3d3d 205b 2269  ssert res == ["i
+00042700: 6e70 7574 312e 677a 225d 0a20 2020 2072  nput1.gz"].    r
+00042710: 6573 203d 2063 6f6d 7072 6573 735f 6669  es = compress_fi
+00042720: 6c65 5f6c 6973 7428 5b22 696e 7075 7431  le_list(["input1
+00042730: 222c 2022 696e 7075 7432 225d 290a 2020  ", "input2"]).  
+00042740: 2020 6173 7365 7274 2072 6573 203d 3d20    assert res == 
+00042750: 5b22 696e 7075 7431 2e67 7a22 2c20 2269  ["input1.gz", "i
+00042760: 6e70 7574 322e 677a 225d 0a0a 0a40 6d6f  nput2.gz"]...@mo
+00042770: 636b 2e70 6174 6368 2822 6c6f 636f 7079  ck.patch("locopy
+00042780: 2e75 7469 6c69 7479 2e6f 732e 7265 6d6f  .utility.os.remo
+00042790: 7665 2229 0a40 6d6f 636b 2e70 6174 6368  ve").@mock.patch
+000427a0: 2822 6c6f 636f 7079 2e75 7469 6c69 7479  ("locopy.utility
+000427b0: 2e6f 7065 6e22 290a 406d 6f63 6b2e 7061  .open").@mock.pa
+000427c0: 7463 6828 226c 6f63 6f70 792e 7574 696c  tch("locopy.util
+000427d0: 6974 792e 677a 6970 2e6f 7065 6e22 290a  ity.gzip.open").
+000427e0: 406d 6f63 6b2e 7061 7463 6828 226c 6f63  @mock.patch("loc
+000427f0: 6f70 792e 7574 696c 6974 792e 7368 7574  opy.utility.shut
+00042800: 696c 2e63 6f70 7966 696c 656f 626a 2229  il.copyfileobj")
+00042810: 0a64 6566 2074 6573 745f 636f 6d70 7265  .def test_compre
+00042820: 7373 5f66 696c 655f 6c69 7374 5f65 7863  ss_file_list_exc
+00042830: 6570 7469 6f6e 286d 6f63 6b5f 7368 7574  eption(mock_shut
+00042840: 696c 2c20 6d6f 636b 5f67 7a69 705f 6f70  il, mock_gzip_op
+00042850: 656e 2c20 6d6f 636b 5f6f 7065 6e2c 206d  en, mock_open, m
+00042860: 6f63 6b5f 7265 6d6f 7665 293a 0a20 2020  ock_remove):.   
+00042870: 206d 6f63 6b5f 7368 7574 696c 2e73 6964   mock_shutil.sid
+00042880: 655f 6566 6665 6374 203d 2045 7863 6570  e_effect = Excep
+00042890: 7469 6f6e 2822 536f 6d65 4578 6365 7074  tion("SomeExcept
+000428a0: 696f 6e22 290a 2020 2020 7769 7468 2070  ion").    with p
+000428b0: 7974 6573 742e 7261 6973 6573 2843 6f6d  ytest.raises(Com
+000428c0: 7072 6573 7369 6f6e 4572 726f 7229 3a0a  pressionError):.
+000428d0: 2020 2020 2020 2020 636f 6d70 7265 7373          compress
+000428e0: 5f66 696c 655f 6c69 7374 285b 2269 6e70  _file_list(["inp
+000428f0: 7574 3122 2c20 2269 6e70 7574 3222 5d29  ut1", "input2"])
+00042900: 0a0a 0a64 6566 2074 6573 745f 7370 6c69  ...def test_spli
+00042910: 745f 6669 6c65 2829 3a0a 2020 2020 696e  t_file():.    in
+00042920: 7075 745f 6669 6c65 203d 2022 7465 7374  put_file = "test
+00042930: 732f 6461 7461 2f6d 6f63 6b5f 6669 6c65  s/data/mock_file
+00042940: 2e74 7874 220a 2020 2020 6f75 7470 7574  .txt".    output
+00042950: 5f66 696c 6520 3d20 2274 6573 7473 2f64  _file = "tests/d
+00042960: 6174 612f 6d6f 636b 5f6f 7574 7075 745f  ata/mock_output_
+00042970: 6669 6c65 2e74 7874 220a 0a20 2020 2073  file.txt"..    s
+00042980: 706c 6974 7320 3d20 7370 6c69 745f 6669  plits = split_fi
+00042990: 6c65 2869 6e70 7574 5f66 696c 652c 206f  le(input_file, o
+000429a0: 7574 7075 745f 6669 6c65 290a 2020 2020  utput_file).    
+000429b0: 6173 7365 7274 2073 706c 6974 7320 3d3d  assert splits ==
+000429c0: 205b 696e 7075 745f 6669 6c65 5d0a 0a20   [input_file].. 
+000429d0: 2020 2065 7870 6563 7465 6420 3d20 5b22     expected = ["
+000429e0: 7465 7374 732f 6461 7461 2f6d 6f63 6b5f  tests/data/mock_
+000429f0: 6f75 7470 7574 5f66 696c 652e 7478 742e  output_file.txt.
+00042a00: 3022 2c20 2274 6573 7473 2f64 6174 612f  0", "tests/data/
+00042a10: 6d6f 636b 5f6f 7574 7075 745f 6669 6c65  mock_output_file
+00042a20: 2e74 7874 2e31 225d 0a20 2020 2073 706c  .txt.1"].    spl
+00042a30: 6974 7320 3d20 7370 6c69 745f 6669 6c65  its = split_file
+00042a40: 2869 6e70 7574 5f66 696c 652c 206f 7574  (input_file, out
+00042a50: 7075 745f 6669 6c65 2c20 3229 0a20 2020  put_file, 2).   
+00042a60: 2061 7373 6572 7420 7370 6c69 7473 203d   assert splits =
+00042a70: 3d20 6578 7065 6374 6564 0a20 2020 2061  = expected.    a
+00042a80: 7373 6572 7420 636f 6d70 6172 655f 6669  ssert compare_fi
+00042a90: 6c65 5f63 6f6e 7465 6e74 7328 696e 7075  le_contents(inpu
+00042aa0: 745f 6669 6c65 2c20 6578 7065 6374 6564  t_file, expected
+00042ab0: 290a 2020 2020 636c 6561 6e75 7028 7370  ).    cleanup(sp
+00042ac0: 6c69 7473 290a 0a20 2020 2065 7870 6563  lits)..    expec
+00042ad0: 7465 6420 3d20 5b0a 2020 2020 2020 2020  ted = [.        
+00042ae0: 2274 6573 7473 2f64 6174 612f 6d6f 636b  "tests/data/mock
+00042af0: 5f6f 7574 7075 745f 6669 6c65 2e74 7874  _output_file.txt
+00042b00: 2e30 222c 0a20 2020 2020 2020 2022 7465  .0",.        "te
+00042b10: 7374 732f 6461 7461 2f6d 6f63 6b5f 6f75  sts/data/mock_ou
+00042b20: 7470 7574 5f66 696c 652e 7478 742e 3122  tput_file.txt.1"
+00042b30: 2c0a 2020 2020 2020 2020 2274 6573 7473  ,.        "tests
+00042b40: 2f64 6174 612f 6d6f 636b 5f6f 7574 7075  /data/mock_outpu
+00042b50: 745f 6669 6c65 2e74 7874 2e32 222c 0a20  t_file.txt.2",. 
+00042b60: 2020 205d 0a20 2020 2073 706c 6974 7320     ].    splits 
+00042b70: 3d20 7370 6c69 745f 6669 6c65 2869 6e70  = split_file(inp
+00042b80: 7574 5f66 696c 652c 206f 7574 7075 745f  ut_file, output_
+00042b90: 6669 6c65 2c20 3329 0a20 2020 2061 7373  file, 3).    ass
+00042ba0: 6572 7420 7370 6c69 7473 203d 3d20 6578  ert splits == ex
+00042bb0: 7065 6374 6564 0a20 2020 2061 7373 6572  pected.    asser
+00042bc0: 7420 636f 6d70 6172 655f 6669 6c65 5f63  t compare_file_c
+00042bd0: 6f6e 7465 6e74 7328 696e 7075 745f 6669  ontents(input_fi
+00042be0: 6c65 2c20 6578 7065 6374 6564 290a 2020  le, expected).  
+00042bf0: 2020 636c 6561 6e75 7028 7370 6c69 7473    cleanup(splits
+00042c00: 290a 0a20 2020 2065 7870 6563 7465 6420  )..    expected 
+00042c10: 3d20 5b0a 2020 2020 2020 2020 2274 6573  = [.        "tes
+00042c20: 7473 2f64 6174 612f 6d6f 636b 5f6f 7574  ts/data/mock_out
+00042c30: 7075 745f 6669 6c65 2e74 7874 2e30 222c  put_file.txt.0",
+00042c40: 0a20 2020 2020 2020 2022 7465 7374 732f  .        "tests/
+00042c50: 6461 7461 2f6d 6f63 6b5f 6f75 7470 7574  data/mock_output
+00042c60: 5f66 696c 652e 7478 742e 3122 2c0a 2020  _file.txt.1",.  
+00042c70: 2020 2020 2020 2274 6573 7473 2f64 6174        "tests/dat
+00042c80: 612f 6d6f 636b 5f6f 7574 7075 745f 6669  a/mock_output_fi
+00042c90: 6c65 2e74 7874 2e32 222c 0a20 2020 2020  le.txt.2",.     
+00042ca0: 2020 2022 7465 7374 732f 6461 7461 2f6d     "tests/data/m
+00042cb0: 6f63 6b5f 6f75 7470 7574 5f66 696c 652e  ock_output_file.
+00042cc0: 7478 742e 3322 2c0a 2020 2020 2020 2020  txt.3",.        
+00042cd0: 2274 6573 7473 2f64 6174 612f 6d6f 636b  "tests/data/mock
+00042ce0: 5f6f 7574 7075 745f 6669 6c65 2e74 7874  _output_file.txt
+00042cf0: 2e34 222c 0a20 2020 205d 0a20 2020 2073  .4",.    ].    s
+00042d00: 706c 6974 7320 3d20 7370 6c69 745f 6669  plits = split_fi
+00042d10: 6c65 2869 6e70 7574 5f66 696c 652c 206f  le(input_file, o
+00042d20: 7574 7075 745f 6669 6c65 2c20 3529 0a20  utput_file, 5). 
+00042d30: 2020 2061 7373 6572 7420 7370 6c69 7473     assert splits
+00042d40: 203d 3d20 6578 7065 6374 6564 0a20 2020   == expected.   
+00042d50: 2061 7373 6572 7420 636f 6d70 6172 655f   assert compare_
+00042d60: 6669 6c65 5f63 6f6e 7465 6e74 7328 696e  file_contents(in
+00042d70: 7075 745f 6669 6c65 2c20 6578 7065 6374  put_file, expect
+00042d80: 6564 290a 2020 2020 636c 6561 6e75 7028  ed).    cleanup(
+00042d90: 7370 6c69 7473 290a 0a0a 6465 6620 7465  splits)...def te
+00042da0: 7374 5f73 706c 6974 5f66 696c 655f 6865  st_split_file_he
+00042db0: 6164 6572 2829 3a0a 2020 2020 696e 7075  ader():.    inpu
+00042dc0: 745f 6669 6c65 203d 2022 7465 7374 732f  t_file = "tests/
+00042dd0: 6461 7461 2f6d 6f63 6b5f 6669 6c65 5f68  data/mock_file_h
+00042de0: 6561 6465 722e 7478 7422 0a20 2020 2069  eader.txt".    i
+00042df0: 6e70 7574 5f66 696c 655f 6e6f 5f68 6561  nput_file_no_hea
+00042e00: 6465 7220 3d20 2274 6573 7473 2f64 6174  der = "tests/dat
+00042e10: 612f 6d6f 636b 5f66 696c 652e 7478 7422  a/mock_file.txt"
+00042e20: 0a20 2020 206f 7574 7075 745f 6669 6c65  .    output_file
+00042e30: 203d 2022 7465 7374 732f 6461 7461 2f6d   = "tests/data/m
+00042e40: 6f63 6b5f 6f75 7470 7574 5f66 696c 655f  ock_output_file_
+00042e50: 6865 6164 6572 2e74 7874 220a 0a20 2020  header.txt"..   
+00042e60: 2073 706c 6974 7320 3d20 7370 6c69 745f   splits = split_
+00042e70: 6669 6c65 2869 6e70 7574 5f66 696c 652c  file(input_file,
+00042e80: 206f 7574 7075 745f 6669 6c65 2c20 6967   output_file, ig
+00042e90: 6e6f 7265 5f68 6561 6465 723d 3129 0a20  nore_header=1). 
+00042ea0: 2020 2061 7373 6572 7420 7370 6c69 7473     assert splits
+00042eb0: 203d 3d20 5b69 6e70 7574 5f66 696c 655d   == [input_file]
+00042ec0: 0a0a 2020 2020 6578 7065 6374 6564 203d  ..    expected =
+00042ed0: 205b 0a20 2020 2020 2020 2022 7465 7374   [.        "test
+00042ee0: 732f 6461 7461 2f6d 6f63 6b5f 6f75 7470  s/data/mock_outp
+00042ef0: 7574 5f66 696c 655f 6865 6164 6572 2e74  ut_file_header.t
+00042f00: 7874 2e30 222c 0a20 2020 2020 2020 2022  xt.0",.        "
+00042f10: 7465 7374 732f 6461 7461 2f6d 6f63 6b5f  tests/data/mock_
+00042f20: 6f75 7470 7574 5f66 696c 655f 6865 6164  output_file_head
+00042f30: 6572 2e74 7874 2e31 222c 0a20 2020 205d  er.txt.1",.    ]
+00042f40: 0a20 2020 2073 706c 6974 7320 3d20 7370  .    splits = sp
+00042f50: 6c69 745f 6669 6c65 2869 6e70 7574 5f66  lit_file(input_f
+00042f60: 696c 652c 206f 7574 7075 745f 6669 6c65  ile, output_file
+00042f70: 2c20 322c 2069 676e 6f72 655f 6865 6164  , 2, ignore_head
+00042f80: 6572 3d31 290a 2020 2020 6173 7365 7274  er=1).    assert
+00042f90: 2073 706c 6974 7320 3d3d 2065 7870 6563   splits == expec
+00042fa0: 7465 640a 2020 2020 6173 7365 7274 2063  ted.    assert c
+00042fb0: 6f6d 7061 7265 5f66 696c 655f 636f 6e74  ompare_file_cont
+00042fc0: 656e 7473 2869 6e70 7574 5f66 696c 655f  ents(input_file_
+00042fd0: 6e6f 5f68 6561 6465 722c 2065 7870 6563  no_header, expec
+00042fe0: 7465 6429 0a20 2020 2063 6c65 616e 7570  ted).    cleanup
+00042ff0: 2873 706c 6974 7329 0a0a 2020 2020 6578  (splits)..    ex
+00043000: 7065 6374 6564 203d 205b 0a20 2020 2020  pected = [.     
+00043010: 2020 2022 7465 7374 732f 6461 7461 2f6d     "tests/data/m
+00043020: 6f63 6b5f 6f75 7470 7574 5f66 696c 655f  ock_output_file_
+00043030: 6865 6164 6572 2e74 7874 2e30 222c 0a20  header.txt.0",. 
+00043040: 2020 2020 2020 2022 7465 7374 732f 6461         "tests/da
+00043050: 7461 2f6d 6f63 6b5f 6f75 7470 7574 5f66  ta/mock_output_f
+00043060: 696c 655f 6865 6164 6572 2e74 7874 2e31  ile_header.txt.1
+00043070: 222c 0a20 2020 2020 2020 2022 7465 7374  ",.        "test
+00043080: 732f 6461 7461 2f6d 6f63 6b5f 6f75 7470  s/data/mock_outp
+00043090: 7574 5f66 696c 655f 6865 6164 6572 2e74  ut_file_header.t
+000430a0: 7874 2e32 222c 0a20 2020 205d 0a20 2020  xt.2",.    ].   
+000430b0: 2073 706c 6974 7320 3d20 7370 6c69 745f   splits = split_
+000430c0: 6669 6c65 2869 6e70 7574 5f66 696c 652c  file(input_file,
+000430d0: 206f 7574 7075 745f 6669 6c65 2c20 332c   output_file, 3,
+000430e0: 2069 676e 6f72 655f 6865 6164 6572 3d31   ignore_header=1
+000430f0: 290a 2020 2020 6173 7365 7274 2073 706c  ).    assert spl
+00043100: 6974 7320 3d3d 2065 7870 6563 7465 640a  its == expected.
+00043110: 2020 2020 6173 7365 7274 2063 6f6d 7061      assert compa
+00043120: 7265 5f66 696c 655f 636f 6e74 656e 7473  re_file_contents
+00043130: 2869 6e70 7574 5f66 696c 655f 6e6f 5f68  (input_file_no_h
+00043140: 6561 6465 722c 2065 7870 6563 7465 6429  eader, expected)
+00043150: 0a20 2020 2063 6c65 616e 7570 2873 706c  .    cleanup(spl
+00043160: 6974 7329 0a0a 2020 2020 6578 7065 6374  its)..    expect
+00043170: 6564 203d 205b 0a20 2020 2020 2020 2022  ed = [.        "
+00043180: 7465 7374 732f 6461 7461 2f6d 6f63 6b5f  tests/data/mock_
+00043190: 6f75 7470 7574 5f66 696c 655f 6865 6164  output_file_head
+000431a0: 6572 2e74 7874 2e30 222c 0a20 2020 2020  er.txt.0",.     
+000431b0: 2020 2022 7465 7374 732f 6461 7461 2f6d     "tests/data/m
+000431c0: 6f63 6b5f 6f75 7470 7574 5f66 696c 655f  ock_output_file_
+000431d0: 6865 6164 6572 2e74 7874 2e31 222c 0a20  header.txt.1",. 
+000431e0: 2020 2020 2020 2022 7465 7374 732f 6461         "tests/da
+000431f0: 7461 2f6d 6f63 6b5f 6f75 7470 7574 5f66  ta/mock_output_f
+00043200: 696c 655f 6865 6164 6572 2e74 7874 2e32  ile_header.txt.2
+00043210: 222c 0a20 2020 2020 2020 2022 7465 7374  ",.        "test
+00043220: 732f 6461 7461 2f6d 6f63 6b5f 6f75 7470  s/data/mock_outp
+00043230: 7574 5f66 696c 655f 6865 6164 6572 2e74  ut_file_header.t
+00043240: 7874 2e33 222c 0a20 2020 2020 2020 2022  xt.3",.        "
+00043250: 7465 7374 732f 6461 7461 2f6d 6f63 6b5f  tests/data/mock_
+00043260: 6f75 7470 7574 5f66 696c 655f 6865 6164  output_file_head
+00043270: 6572 2e74 7874 2e34 222c 0a20 2020 205d  er.txt.4",.    ]
+00043280: 0a20 2020 2073 706c 6974 7320 3d20 7370  .    splits = sp
+00043290: 6c69 745f 6669 6c65 2869 6e70 7574 5f66  lit_file(input_f
+000432a0: 696c 652c 206f 7574 7075 745f 6669 6c65  ile, output_file
+000432b0: 2c20 352c 2069 676e 6f72 655f 6865 6164  , 5, ignore_head
+000432c0: 6572 3d31 290a 2020 2020 6173 7365 7274  er=1).    assert
+000432d0: 2073 706c 6974 7320 3d3d 2065 7870 6563   splits == expec
+000432e0: 7465 640a 2020 2020 6173 7365 7274 2063  ted.    assert c
+000432f0: 6f6d 7061 7265 5f66 696c 655f 636f 6e74  ompare_file_cont
+00043300: 656e 7473 2869 6e70 7574 5f66 696c 655f  ents(input_file_
+00043310: 6e6f 5f68 6561 6465 722c 2065 7870 6563  no_header, expec
+00043320: 7465 6429 0a20 2020 2063 6c65 616e 7570  ted).    cleanup
+00043330: 2873 706c 6974 7329 0a0a 0a64 6566 2074  (splits)...def t
+00043340: 6573 745f 7370 6c69 745f 6669 6c65 5f65  est_split_file_e
+00043350: 7863 6570 7469 6f6e 2829 3a0a 2020 2020  xception():.    
+00043360: 696e 7075 745f 6669 6c65 203d 2022 7465  input_file = "te
+00043370: 7374 732f 6461 7461 2f6d 6f63 6b5f 6669  sts/data/mock_fi
+00043380: 6c65 2e74 7874 220a 2020 2020 6f75 7470  le.txt".    outp
+00043390: 7574 5f66 696c 6520 3d20 2274 6573 7473  ut_file = "tests
+000433a0: 2f64 6174 612f 6d6f 636b 5f6f 7574 7075  /data/mock_outpu
+000433b0: 745f 6669 6c65 2e74 7874 220a 0a20 2020  t_file.txt"..   
+000433c0: 2069 6620 7379 732e 7665 7273 696f 6e5f   if sys.version_
+000433d0: 696e 666f 2e6d 616a 6f72 203d 3d20 333a  info.major == 3:
+000433e0: 0a20 2020 2020 2020 2062 7569 6c74 696e  .        builtin
+000433f0: 5f6d 6f64 756c 655f 6e61 6d65 203d 2022  _module_name = "
+00043400: 6275 696c 7469 6e73 220a 2020 2020 656c  builtins".    el
+00043410: 7365 3a0a 2020 2020 2020 2020 6275 696c  se:.        buil
+00043420: 7469 6e5f 6d6f 6475 6c65 5f6e 616d 6520  tin_module_name 
+00043430: 3d20 225f 5f62 7569 6c74 696e 5f5f 220a  = "__builtin__".
+00043440: 0a20 2020 2077 6974 6820 7079 7465 7374  .    with pytest
+00043450: 2e72 6169 7365 7328 4c6f 636f 7079 5370  .raises(LocopySp
+00043460: 6c69 7445 7272 6f72 293a 0a20 2020 2020  litError):.     
+00043470: 2020 2073 706c 6974 5f66 696c 6528 696e     split_file(in
+00043480: 7075 745f 6669 6c65 2c20 6f75 7470 7574  put_file, output
+00043490: 5f66 696c 652c 202d 3129 0a20 2020 2077  _file, -1).    w
+000434a0: 6974 6820 7079 7465 7374 2e72 6169 7365  ith pytest.raise
+000434b0: 7328 4c6f 636f 7079 5370 6c69 7445 7272  s(LocopySplitErr
+000434c0: 6f72 293a 0a20 2020 2020 2020 2073 706c  or):.        spl
+000434d0: 6974 5f66 696c 6528 696e 7075 745f 6669  it_file(input_fi
+000434e0: 6c65 2c20 6f75 7470 7574 5f66 696c 652c  le, output_file,
+000434f0: 2030 290a 2020 2020 7769 7468 2070 7974   0).    with pyt
+00043500: 6573 742e 7261 6973 6573 284c 6f63 6f70  est.raises(Locop
+00043510: 7953 706c 6974 4572 726f 7229 3a0a 2020  ySplitError):.  
+00043520: 2020 2020 2020 7370 6c69 745f 6669 6c65        split_file
+00043530: 2869 6e70 7574 5f66 696c 652c 206f 7574  (input_file, out
+00043540: 7075 745f 6669 6c65 2c20 352e 3635 290a  put_file, 5.65).
+00043550: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
+00043560: 7261 6973 6573 284c 6f63 6f70 7953 706c  raises(LocopySpl
+00043570: 6974 4572 726f 7229 3a0a 2020 2020 2020  itError):.      
+00043580: 2020 7370 6c69 745f 6669 6c65 2869 6e70    split_file(inp
+00043590: 7574 5f66 696c 652c 206f 7574 7075 745f  ut_file, output_
+000435a0: 6669 6c65 2c20 2231 3233 2229 0a20 2020  file, "123").   
+000435b0: 2077 6974 6820 7079 7465 7374 2e72 6169   with pytest.rai
+000435c0: 7365 7328 4c6f 636f 7079 5370 6c69 7445  ses(LocopySplitE
+000435d0: 7272 6f72 293a 0a20 2020 2020 2020 2073  rror):.        s
+000435e0: 706c 6974 5f66 696c 6528 696e 7075 745f  plit_file(input_
+000435f0: 6669 6c65 2c20 6f75 7470 7574 5f66 696c  file, output_fil
+00043600: 652c 2022 5465 7374 2229 0a0a 2020 2020  e, "Test")..    
+00043610: 7769 7468 206d 6f63 6b2e 7061 7463 6828  with mock.patch(
+00043620: 227b 307d 2e6e 6578 7422 2e66 6f72 6d61  "{0}.next".forma
+00043630: 7428 6275 696c 7469 6e5f 6d6f 6475 6c65  t(builtin_module
+00043640: 5f6e 616d 6529 2920 6173 206d 6f63 6b5f  _name)) as mock_
+00043650: 6e65 7874 3a0a 2020 2020 2020 2020 2020  next:.          
+00043660: 2020 6d6f 636b 5f6e 6578 742e 7369 6465    mock_next.side
+00043670: 5f65 6666 6563 7420 3d20 4578 6365 7074  _effect = Except
+00043680: 696f 6e28 2253 6f6d 6545 7863 6570 7469  ion("SomeExcepti
+00043690: 6f6e 2229 0a0a 2020 2020 2020 2020 2020  on")..          
+000436a0: 2020 7769 7468 2070 7974 6573 742e 7261    with pytest.ra
+000436b0: 6973 6573 284c 6f63 6f70 7953 706c 6974  ises(LocopySplit
+000436c0: 4572 726f 7229 3a0a 2020 2020 2020 2020  Error):.        
+000436d0: 2020 2020 2020 2020 7370 6c69 745f 6669          split_fi
+000436e0: 6c65 2869 6e70 7574 5f66 696c 652c 206f  le(input_file, o
+000436f0: 7574 7075 745f 6669 6c65 2c20 3229 0a20  utput_file, 2). 
+00043700: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+00043710: 7420 6e6f 7420 5061 7468 2822 7465 7374  t not Path("test
+00043720: 732f 6461 7461 2f6d 6f63 6b5f 6f75 7470  s/data/mock_outp
+00043730: 7574 5f66 696c 652e 7478 742e 3022 292e  ut_file.txt.0").
+00043740: 6578 6973 7473 2829 0a20 2020 2020 2020  exists().       
+00043750: 2020 2020 2061 7373 6572 7420 6e6f 7420       assert not 
+00043760: 5061 7468 2822 7465 7374 732f 6461 7461  Path("tests/data
+00043770: 2f6d 6f63 6b5f 6f75 7470 7574 5f66 696c  /mock_output_fil
+00043780: 652e 7478 742e 3122 292e 6578 6973 7473  e.txt.1").exists
+00043790: 2829 0a0a 2020 2020 2020 2020 2020 2020  ()..            
+000437a0: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
+000437b0: 6573 284c 6f63 6f70 7953 706c 6974 4572  es(LocopySplitEr
+000437c0: 726f 7229 3a0a 2020 2020 2020 2020 2020  ror):.          
+000437d0: 2020 2020 2020 7370 6c69 745f 6669 6c65        split_file
+000437e0: 2869 6e70 7574 5f66 696c 652c 206f 7574  (input_file, out
+000437f0: 7075 745f 6669 6c65 2c20 3329 0a20 2020  put_file, 3).   
+00043800: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
+00043810: 6e6f 7420 5061 7468 2822 7465 7374 732f  not Path("tests/
+00043820: 6461 7461 2f6d 6f63 6b5f 6f75 7470 7574  data/mock_output
+00043830: 5f66 696c 652e 7478 742e 3022 292e 6578  _file.txt.0").ex
+00043840: 6973 7473 2829 0a20 2020 2020 2020 2020  ists().         
+00043850: 2020 2061 7373 6572 7420 6e6f 7420 5061     assert not Pa
+00043860: 7468 2822 7465 7374 732f 6461 7461 2f6d  th("tests/data/m
+00043870: 6f63 6b5f 6f75 7470 7574 5f66 696c 652e  ock_output_file.
+00043880: 7478 742e 3122 292e 6578 6973 7473 2829  txt.1").exists()
+00043890: 0a20 2020 2020 2020 2020 2020 2061 7373  .            ass
+000438a0: 6572 7420 6e6f 7420 5061 7468 2822 7465  ert not Path("te
+000438b0: 7374 732f 6461 7461 2f6d 6f63 6b5f 6f75  sts/data/mock_ou
+000438c0: 7470 7574 5f66 696c 652e 7478 742e 3222  tput_file.txt.2"
+000438d0: 292e 6578 6973 7473 2829 0a0a 0a40 6d6f  ).exists()...@mo
+000438e0: 636b 2e70 6174 6368 2822 6c6f 636f 7079  ck.patch("locopy
+000438f0: 2e75 7469 6c69 7479 2e6f 7065 6e22 2c20  .utility.open", 
+00043900: 6d6f 636b 2e6d 6f63 6b5f 6f70 656e 2872  mock.mock_open(r
+00043910: 6561 645f 6461 7461 3d47 4f4f 445f 434f  ead_data=GOOD_CO
+00043920: 4e46 4947 5f59 414d 4c29 290a 6465 6620  NFIG_YAML)).def 
+00043930: 7465 7374 5f72 6561 645f 636f 6e66 6967  test_read_config
+00043940: 5f79 616d 6c5f 676f 6f64 2829 3a0a 2020  _yaml_good():.  
+00043950: 2020 6163 7475 616c 203d 2075 7469 6c2e    actual = util.
+00043960: 7265 6164 5f63 6f6e 6669 675f 7961 6d6c  read_config_yaml
+00043970: 2822 6669 6c65 6e61 6d65 2e79 6d6c 2229  ("filename.yml")
+00043980: 0a20 2020 2061 7373 6572 7420 7365 7428  .    assert set(
+00043990: 6163 7475 616c 2e6b 6579 7328 2929 203d  actual.keys()) =
+000439a0: 3d20 7365 7428 5b22 686f 7374 222c 2022  = set(["host", "
+000439b0: 706f 7274 222c 2022 6461 7461 6261 7365  port", "database
+000439c0: 222c 2022 7573 6572 222c 2022 7061 7373  ", "user", "pass
+000439d0: 776f 7264 225d 290a 2020 2020 6173 7365  word"]).    asse
+000439e0: 7274 2061 6374 7561 6c5b 2268 6f73 7422  rt actual["host"
+000439f0: 5d20 3d3d 2022 6d79 2e72 6564 7368 6966  ] == "my.redshif
+00043a00: 742e 636c 7573 7465 722e 636f 6d22 0a20  t.cluster.com". 
+00043a10: 2020 2061 7373 6572 7420 6163 7475 616c     assert actual
+00043a20: 5b22 706f 7274 225d 203d 3d20 3132 3334  ["port"] == 1234
+00043a30: 0a20 2020 2061 7373 6572 7420 6163 7475  .    assert actu
+00043a40: 616c 5b22 6461 7461 6261 7365 225d 203d  al["database"] =
+00043a50: 3d20 2264 6222 0a20 2020 2061 7373 6572  = "db".    asser
+00043a60: 7420 6163 7475 616c 5b22 7573 6572 225d  t actual["user"]
+00043a70: 203d 3d20 2275 7365 7269 6422 0a20 2020   == "userid".   
+00043a80: 2061 7373 6572 7420 6163 7475 616c 5b22   assert actual["
+00043a90: 7061 7373 776f 7264 225d 203d 3d20 2270  password"] == "p
+00043aa0: 6173 7322 0a0a 0a64 6566 2074 6573 745f  ass"...def test_
+00043ab0: 7265 6164 5f63 6f6e 6669 675f 7961 6d6c  read_config_yaml
+00043ac0: 5f69 6f28 293a 0a20 2020 2061 6374 7561  _io():.    actua
+00043ad0: 6c20 3d20 7574 696c 2e72 6561 645f 636f  l = util.read_co
+00043ae0: 6e66 6967 5f79 616d 6c28 5374 7269 6e67  nfig_yaml(String
+00043af0: 494f 2847 4f4f 445f 434f 4e46 4947 5f59  IO(GOOD_CONFIG_Y
+00043b00: 414d 4c29 290a 2020 2020 6173 7365 7274  AML)).    assert
+00043b10: 2073 6574 2861 6374 7561 6c2e 6b65 7973   set(actual.keys
+00043b20: 2829 2920 3d3d 2073 6574 285b 2268 6f73  ()) == set(["hos
+00043b30: 7422 2c20 2270 6f72 7422 2c20 2264 6174  t", "port", "dat
+00043b40: 6162 6173 6522 2c20 2275 7365 7222 2c20  abase", "user", 
+00043b50: 2270 6173 7377 6f72 6422 5d29 0a20 2020  "password"]).   
+00043b60: 2061 7373 6572 7420 6163 7475 616c 5b22   assert actual["
+00043b70: 686f 7374 225d 203d 3d20 226d 792e 7265  host"] == "my.re
+00043b80: 6473 6869 6674 2e63 6c75 7374 6572 2e63  dshift.cluster.c
+00043b90: 6f6d 220a 2020 2020 6173 7365 7274 2061  om".    assert a
+00043ba0: 6374 7561 6c5b 2270 6f72 7422 5d20 3d3d  ctual["port"] ==
+00043bb0: 2031 3233 340a 2020 2020 6173 7365 7274   1234.    assert
+00043bc0: 2061 6374 7561 6c5b 2264 6174 6162 6173   actual["databas
+00043bd0: 6522 5d20 3d3d 2022 6462 220a 2020 2020  e"] == "db".    
+00043be0: 6173 7365 7274 2061 6374 7561 6c5b 2275  assert actual["u
+00043bf0: 7365 7222 5d20 3d3d 2022 7573 6572 6964  ser"] == "userid
+00043c00: 220a 2020 2020 6173 7365 7274 2061 6374  ".    assert act
+00043c10: 7561 6c5b 2270 6173 7377 6f72 6422 5d20  ual["password"] 
+00043c20: 3d3d 2022 7061 7373 220a 0a0a 6465 6620  == "pass"...def 
+00043c30: 7465 7374 5f72 6561 645f 636f 6e66 6967  test_read_config
+00043c40: 5f79 616d 6c5f 6e6f 5f66 696c 6528 293a  _yaml_no_file():
+00043c50: 0a20 2020 2077 6974 6820 7079 7465 7374  .    with pytest
+00043c60: 2e72 6169 7365 7328 4372 6564 656e 7469  .raises(Credenti
+00043c70: 616c 7345 7272 6f72 293a 0a20 2020 2020  alsError):.     
+00043c80: 2020 2075 7469 6c2e 7265 6164 5f63 6f6e     util.read_con
+00043c90: 6669 675f 7961 6d6c 2822 6669 6c65 5f74  fig_yaml("file_t
+00043ca0: 6861 745f 646f 6573 5f6e 6f74 5f65 7869  hat_does_not_exi
+00043cb0: 7374 2e79 6d6c 2229 0a0a 0a64 6566 2074  st.yml")...def t
+00043cc0: 6573 745f 636f 6e63 6174 656e 6174 655f  est_concatenate_
+00043cd0: 6669 6c65 7328 293a 0a20 2020 2069 6e70  files():.    inp
+00043ce0: 7574 7320 3d20 5b22 7465 7374 732f 6461  uts = ["tests/da
+00043cf0: 7461 2f63 6174 5f31 2e74 7874 222c 2022  ta/cat_1.txt", "
+00043d00: 7465 7374 732f 6461 7461 2f63 6174 5f32  tests/data/cat_2
+00043d10: 2e74 7874 222c 2022 7465 7374 732f 6461  .txt", "tests/da
+00043d20: 7461 2f63 6174 5f33 2e74 7874 225d 0a20  ta/cat_3.txt"]. 
+00043d30: 2020 206f 7574 7075 7420 3d20 2274 6573     output = "tes
+00043d40: 7473 2f64 6174 612f 6361 745f 6f75 7470  ts/data/cat_outp
+00043d50: 7574 2e74 7874 220a 2020 2020 7769 7468  ut.txt".    with
+00043d60: 206d 6f63 6b2e 7061 7463 6828 226c 6f63   mock.patch("loc
+00043d70: 6f70 792e 7574 696c 6974 792e 6f73 2e72  opy.utility.os.r
+00043d80: 656d 6f76 6522 2920 6173 206d 6f63 6b5f  emove") as mock_
+00043d90: 7265 6d6f 7665 3a0a 2020 2020 2020 2020  remove:.        
+00043da0: 636f 6e63 6174 656e 6174 655f 6669 6c65  concatenate_file
+00043db0: 7328 696e 7075 7473 2c20 6f75 7470 7574  s(inputs, output
+00043dc0: 290a 2020 2020 2020 2020 6173 7365 7274  ).        assert
+00043dd0: 206d 6f63 6b5f 7265 6d6f 7665 2e63 616c   mock_remove.cal
+00043de0: 6c5f 636f 756e 7420 3d3d 2033 0a20 2020  l_count == 3.   
+00043df0: 2020 2020 2061 7373 6572 7420 5b69 6e74       assert [int
+00043e00: 286c 696e 652e 7273 7472 6970 2822 5c6e  (line.rstrip("\n
+00043e10: 2229 2920 666f 7220 6c69 6e65 2069 6e20  ")) for line in 
+00043e20: 6f70 656e 286f 7574 7075 7429 5d20 3d3d  open(output)] ==
+00043e30: 206c 6973 7428 7261 6e67 6528 312c 2031   list(range(1, 1
+00043e40: 3629 290a 2020 2020 6f73 2e72 656d 6f76  6)).    os.remov
+00043e50: 6528 6f75 7470 7574 290a 0a0a 6465 6620  e(output)...def 
+00043e60: 7465 7374 5f63 6f6e 6361 7465 6e61 7465  test_concatenate
+00043e70: 5f66 696c 6573 5f65 7863 6570 7469 6f6e  _files_exception
+00043e80: 2829 3a0a 2020 2020 696e 7075 7473 203d  ():.    inputs =
+00043e90: 205b 2274 6573 7473 2f64 6174 612f 6361   ["tests/data/ca
+00043ea0: 745f 312e 7478 7422 2c20 2274 6573 7473  t_1.txt", "tests
+00043eb0: 2f64 6174 612f 6361 745f 322e 7478 7422  /data/cat_2.txt"
+00043ec0: 2c20 2274 6573 7473 2f64 6174 612f 6361  , "tests/data/ca
+00043ed0: 745f 332e 7478 7422 5d0a 2020 2020 6f75  t_3.txt"].    ou
+00043ee0: 7470 7574 203d 2022 7465 7374 732f 6461  tput = "tests/da
+00043ef0: 7461 2f63 6174 5f6f 7574 7075 742e 7478  ta/cat_output.tx
+00043f00: 7422 0a20 2020 2077 6974 6820 7079 7465  t".    with pyte
+00043f10: 7374 2e72 6169 7365 7328 4c6f 636f 7079  st.raises(Locopy
+00043f20: 436f 6e63 6174 4572 726f 7229 3a0a 2020  ConcatError):.  
+00043f30: 2020 2020 2020 636f 6e63 6174 656e 6174        concatenat
+00043f40: 655f 6669 6c65 7328 5b5d 2c20 6f75 7470  e_files([], outp
+00043f50: 7574 2c20 7265 6d6f 7665 3d46 616c 7365  ut, remove=False
+00043f60: 290a 0a20 2020 2077 6974 6820 6d6f 636b  )..    with mock
+00043f70: 2e70 6174 6368 2822 6c6f 636f 7079 2e75  .patch("locopy.u
+00043f80: 7469 6c69 7479 2e6f 7065 6e22 2920 6173  tility.open") as
+00043f90: 206d 6f63 6b5f 6f70 656e 3a0a 2020 2020   mock_open:.    
+00043fa0: 2020 2020 6d6f 636b 5f6f 7065 6e2e 7369      mock_open.si
+00043fb0: 6465 5f65 6666 6563 7420 3d20 4578 6365  de_effect = Exce
+00043fc0: 7074 696f 6e28 290a 2020 2020 2020 2020  ption().        
+00043fd0: 7769 7468 2070 7974 6573 742e 7261 6973  with pytest.rais
+00043fe0: 6573 284c 6f63 6f70 7943 6f6e 6361 7445  es(LocopyConcatE
+00043ff0: 7272 6f72 293a 0a20 2020 2020 2020 2020  rror):.         
+00044000: 2020 2063 6f6e 6361 7465 6e61 7465 5f66     concatenate_f
+00044010: 696c 6573 2869 6e70 7574 732c 206f 7574  iles(inputs, out
+00044020: 7075 742c 2072 656d 6f76 653d 4661 6c73  put, remove=Fals
+00044030: 6529 0a0a 0a64 6566 2074 6573 745f 6669  e)...def test_fi
+00044040: 6e64 5f63 6f6c 756d 6e5f 7479 7065 2829  nd_column_type()
+00044050: 3a0a 0a20 2020 2069 6d70 6f72 7420 7061  :..    import pa
+00044060: 6e64 6173 2061 7320 7064 0a20 2020 2066  ndas as pd.    f
+00044070: 726f 6d20 6465 6369 6d61 6c20 696d 706f  rom decimal impo
+00044080: 7274 2044 6563 696d 616c 0a0a 2020 2020  rt Decimal..    
+00044090: 2320 6164 6420 7469 6d65 7374 616d 700a  # add timestamp.
+000440a0: 2020 2020 696e 7075 745f 7465 7874 203d      input_text =
+000440b0: 2070 642e 4461 7461 4672 616d 652e 6672   pd.DataFrame.fr
+000440c0: 6f6d 5f64 6963 7428 0a20 2020 2020 2020  om_dict(.       
+000440d0: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+000440e0: 6122 3a20 5b31 2c20 322c 2033 5d2c 0a20  a": [1, 2, 3],. 
+000440f0: 2020 2020 2020 2020 2020 2022 6222 3a20             "b": 
+00044100: 5b22 7822 2c20 2279 222c 2022 7a22 5d2c  ["x", "y", "z"],
+00044110: 0a20 2020 2020 2020 2020 2020 2022 6322  .            "c"
+00044120: 3a20 5b22 3230 3139 2d39 312d 3031 222c  : ["2019-91-01",
+00044130: 2022 3230 3131 2d30 312d 3031 222c 2022   "2011-01-01", "
+00044140: 3230 3131 2d31 302d 3031 225d 2c0a 2020  2011-10-01"],.  
+00044150: 2020 2020 2020 2020 2020 2264 223a 205b            "d": [
+00044160: 2232 3031 312d 3031 2d30 3122 2c20 2232  "2011-01-01", "2
+00044170: 3030 312d 3034 2d30 3222 2c20 2232 3031  001-04-02", "201
+00044180: 392d 3034 2d32 3322 5d2c 0a20 2020 2020  9-04-23"],.     
+00044190: 2020 2020 2020 2022 6522 3a20 5b31 2e32         "e": [1.2
+000441a0: 2c20 322e 3434 2c20 342e 3233 5d2c 0a20  , 2.44, 4.23],. 
+000441b0: 2020 2020 2020 2020 2020 2022 6622 3a20             "f": 
+000441c0: 5b31 312c 2031 342c 204e 6f6e 655d 2c0a  [11, 14, None],.
+000441d0: 2020 2020 2020 2020 2020 2020 2267 223a              "g":
+000441e0: 205b 4e6f 6e65 2c20 4e6f 6e65 2c20 4e6f   [None, None, No
+000441f0: 6e65 5d2c 0a20 2020 2020 2020 2020 2020  ne],.           
+00044200: 2022 6822 3a20 5b0a 2020 2020 2020 2020   "h": [.        
+00044210: 2020 2020 2020 2020 7064 2e74 6f5f 6461          pd.to_da
+00044220: 7465 7469 6d65 2822 3230 3139 2d30 312d  tetime("2019-01-
+00044230: 3031 2229 2c0a 2020 2020 2020 2020 2020  01"),.          
+00044240: 2020 2020 2020 7064 2e74 6f5f 6461 7465        pd.to_date
+00044250: 7469 6d65 2822 3230 3139 2d30 332d 3031  time("2019-03-01
+00044260: 2229 2c0a 2020 2020 2020 2020 2020 2020  "),.            
+00044270: 2020 2020 7064 2e74 6f5f 6461 7465 7469      pd.to_dateti
+00044280: 6d65 2822 3230 3139 2d30 342d 3031 2229  me("2019-04-01")
+00044290: 2c0a 2020 2020 2020 2020 2020 2020 5d2c  ,.            ],
+000442a0: 0a20 2020 2020 2020 2020 2020 2022 6922  .            "i"
+000442b0: 3a20 5b4e 6f6e 652c 2022 3230 3131 2d30  : [None, "2011-0
+000442c0: 342d 3032 222c 2022 3230 3032 2d30 342d  4-02", "2002-04-
+000442d0: 3233 225d 2c0a 2020 2020 2020 2020 2020  23"],.          
+000442e0: 2020 226a 223a 205b 4e6f 6e65 2c20 2232    "j": [None, "2
+000442f0: 3031 312d 3031 2d30 3120 3132 3a31 313a  011-01-01 12:11:
+00044300: 3032 222c 2022 3230 3232 2d30 332d 3032  02", "2022-03-02
+00044310: 2032 333a 3539 3a35 3922 5d2c 0a20 2020   23:59:59"],.   
+00044320: 2020 2020 2020 2020 2022 6b22 3a20 5b44           "k": [D
+00044330: 6563 696d 616c 2833 2e33 292c 2044 6563  ecimal(3.3), Dec
+00044340: 696d 616c 2831 3030 292c 204e 6f6e 655d  imal(100), None]
+00044350: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
+00044360: 223a 2070 642e 5365 7269 6573 285b 312c  ": pd.Series([1,
+00044370: 2032 2c20 335d 2c20 6474 7970 653d 2263   2, 3], dtype="c
+00044380: 6174 6567 6f72 7922 292c 0a20 2020 2020  ategory"),.     
+00044390: 2020 207d 0a20 2020 2029 0a20 2020 206f     }.    ).    o
+000443a0: 7574 7075 745f 7465 7874 203d 207b 0a20  utput_text = {. 
+000443b0: 2020 2020 2020 2022 6122 3a20 2269 6e74         "a": "int
+000443c0: 222c 0a20 2020 2020 2020 2022 6222 3a20  ",.        "b": 
+000443d0: 2276 6172 6368 6172 222c 0a20 2020 2020  "varchar",.     
+000443e0: 2020 2022 6322 3a20 2276 6172 6368 6172     "c": "varchar
+000443f0: 222c 0a20 2020 2020 2020 2022 6422 3a20  ",.        "d": 
+00044400: 2264 6174 6522 2c0a 2020 2020 2020 2020  "date",.        
+00044410: 2265 223a 2022 666c 6f61 7422 2c0a 2020  "e": "float",.  
+00044420: 2020 2020 2020 2266 223a 2022 666c 6f61        "f": "floa
+00044430: 7422 2c0a 2020 2020 2020 2020 2267 223a  t",.        "g":
+00044440: 2022 7661 7263 6861 7222 2c0a 2020 2020   "varchar",.    
+00044450: 2020 2020 2268 223a 2022 7469 6d65 7374      "h": "timest
+00044460: 616d 7022 2c0a 2020 2020 2020 2020 2269  amp",.        "i
+00044470: 223a 2022 6461 7465 222c 0a20 2020 2020  ": "date",.     
+00044480: 2020 2022 6a22 3a20 2274 696d 6573 7461     "j": "timesta
+00044490: 6d70 222c 0a20 2020 2020 2020 2022 6b22  mp",.        "k"
+000444a0: 3a20 2266 6c6f 6174 222c 0a20 2020 2020  : "float",.     
+000444b0: 2020 2022 6c22 3a20 2276 6172 6368 6172     "l": "varchar
+000444c0: 222c 0a20 2020 207d 0a20 2020 2061 7373  ",.    }.    ass
+000444d0: 6572 7420 6669 6e64 5f63 6f6c 756d 6e5f  ert find_column_
+000444e0: 7479 7065 2869 6e70 7574 5f74 6578 7429  type(input_text)
+000444f0: 203d 3d20 6f75 7470 7574 5f74 6578 740a   == output_text.
+00044500: 0a0a 6465 6620 7465 7374 5f67 6574 5f69  ..def test_get_i
+00044510: 676e 6f72 6568 6561 6465 725f 6e75 6d62  gnoreheader_numb
+00044520: 6572 2829 3a0a 2020 2020 6173 7365 7274  er():.    assert
+00044530: 2028 0a20 2020 2020 2020 2067 6574 5f69   (.        get_i
+00044540: 676e 6f72 6568 6561 6465 725f 6e75 6d62  gnoreheader_numb
+00044550: 6572 280a 2020 2020 2020 2020 2020 2020  er(.            
+00044560: 5b22 4441 5445 464f 524d 4154 2027 6175  ["DATEFORMAT 'au
+00044570: 746f 2722 2c20 2243 4f4d 5055 5044 4154  to'", "COMPUPDAT
+00044580: 4520 4f4e 222c 2022 5452 554e 4341 5445  E ON", "TRUNCATE
+00044590: 434f 4c55 4d4e 5322 2c20 2249 474e 4f52  COLUMNS", "IGNOR
+000445a0: 4548 4541 4445 5220 6173 2031 225d 0a20  EHEADER as 1"]. 
+000445b0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000445c0: 203d 3d20 310a 2020 2020 290a 2020 2020   == 1.    ).    
+000445d0: 6173 7365 7274 2028 0a20 2020 2020 2020  assert (.       
+000445e0: 2067 6574 5f69 676e 6f72 6568 6561 6465   get_ignoreheade
+000445f0: 725f 6e75 6d62 6572 280a 2020 2020 2020  r_number(.      
+00044600: 2020 2020 2020 5b22 4441 5445 464f 524d        ["DATEFORM
+00044610: 4154 2027 6175 746f 2722 2c20 2243 4f4d  AT 'auto'", "COM
+00044620: 5055 5044 4154 4520 4f4e 222c 2022 5452  PUPDATE ON", "TR
+00044630: 554e 4341 5445 434f 4c55 4d4e 5322 2c20  UNCATECOLUMNS", 
+00044640: 2249 474e 4f52 4548 4541 4445 5220 6173  "IGNOREHEADER as
+00044650: 2032 225d 0a20 2020 2020 2020 2029 0a20   2"].        ). 
+00044660: 2020 2020 2020 203d 3d20 320a 2020 2020         == 2.    
+00044670: 290a 2020 2020 6173 7365 7274 2028 0a20  ).    assert (. 
+00044680: 2020 2020 2020 2067 6574 5f69 676e 6f72         get_ignor
+00044690: 6568 6561 6465 725f 6e75 6d62 6572 280a  eheader_number(.
+000446a0: 2020 2020 2020 2020 2020 2020 5b22 4441              ["DA
+000446b0: 5445 464f 524d 4154 2027 6175 746f 2722  TEFORMAT 'auto'"
+000446c0: 2c20 2243 4f4d 5055 5044 4154 4520 4f4e  , "COMPUPDATE ON
+000446d0: 222c 2022 5452 554e 4341 5445 434f 4c55  ", "TRUNCATECOLU
+000446e0: 4d4e 5322 2c20 2249 474e 4f52 4548 4541  MNS", "IGNOREHEA
+000446f0: 4445 5220 6173 2039 3922 5d0a 2020 2020  DER as 99"].    
+00044700: 2020 2020 290a 2020 2020 2020 2020 3d3d      ).        ==
+00044710: 2039 390a 2020 2020 290a 0a20 2020 2061   99.    )..    a
+00044720: 7373 6572 7420 280a 2020 2020 2020 2020  ssert (.        
+00044730: 6765 745f 6967 6e6f 7265 6865 6164 6572  get_ignoreheader
+00044740: 5f6e 756d 6265 7228 0a20 2020 2020 2020  _number(.       
+00044750: 2020 2020 205b 2244 4154 4546 4f52 4d41       ["DATEFORMA
+00044760: 5420 2761 7574 6f27 222c 2022 434f 4d50  T 'auto'", "COMP
+00044770: 5550 4441 5445 204f 4e22 2c20 2254 5255  UPDATE ON", "TRU
+00044780: 4e43 4154 4543 4f4c 554d 4e53 222c 2022  NCATECOLUMNS", "
+00044790: 4947 4e4f 5245 4845 4144 4552 2031 225d  IGNOREHEADER 1"]
+000447a0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+000447b0: 2020 203d 3d20 310a 2020 2020 290a 2020     == 1.    ).  
+000447c0: 2020 6173 7365 7274 2028 0a20 2020 2020    assert (.     
+000447d0: 2020 2067 6574 5f69 676e 6f72 6568 6561     get_ignorehea
+000447e0: 6465 725f 6e75 6d62 6572 280a 2020 2020  der_number(.    
+000447f0: 2020 2020 2020 2020 5b22 4441 5445 464f          ["DATEFO
+00044800: 524d 4154 2027 6175 746f 2722 2c20 2243  RMAT 'auto'", "C
+00044810: 4f4d 5055 5044 4154 4520 4f4e 222c 2022  OMPUPDATE ON", "
+00044820: 5452 554e 4341 5445 434f 4c55 4d4e 5322  TRUNCATECOLUMNS"
+00044830: 2c20 2249 474e 4f52 4548 4541 4445 5220  , "IGNOREHEADER 
+00044840: 3222 5d0a 2020 2020 2020 2020 290a 2020  2"].        ).  
+00044850: 2020 2020 2020 3d3d 2032 0a20 2020 2029        == 2.    )
+00044860: 0a20 2020 2061 7373 6572 7420 280a 2020  .    assert (.  
+00044870: 2020 2020 2020 6765 745f 6967 6e6f 7265        get_ignore
+00044880: 6865 6164 6572 5f6e 756d 6265 7228 0a20  header_number(. 
+00044890: 2020 2020 2020 2020 2020 205b 2244 4154             ["DAT
+000448a0: 4546 4f52 4d41 5420 2761 7574 6f27 222c  EFORMAT 'auto'",
+000448b0: 2022 434f 4d50 5550 4441 5445 204f 4e22   "COMPUPDATE ON"
+000448c0: 2c20 2254 5255 4e43 4154 4543 4f4c 554d  , "TRUNCATECOLUM
+000448d0: 4e53 222c 2022 4947 4e4f 5245 4845 4144  NS", "IGNOREHEAD
+000448e0: 4552 2039 3922 5d0a 2020 2020 2020 2020  ER 99"].        
+000448f0: 290a 2020 2020 2020 2020 3d3d 2039 390a  ).        == 99.
+00044900: 2020 2020 290a 0a20 2020 2061 7373 6572      )..    asser
+00044910: 7420 280a 2020 2020 2020 2020 6765 745f  t (.        get_
+00044920: 6967 6e6f 7265 6865 6164 6572 5f6e 756d  ignoreheader_num
+00044930: 6265 7228 0a20 2020 2020 2020 2020 2020  ber(.           
+00044940: 205b 2244 4154 4546 4f52 4d41 5420 2761   ["DATEFORMAT 'a
+00044950: 7574 6f27 222c 2022 434f 4d50 5550 4441  uto'", "COMPUPDA
+00044960: 5445 204f 4e22 2c20 2254 5255 4e43 4154  TE ON", "TRUNCAT
+00044970: 4543 4f4c 554d 4e53 222c 2022 4947 4e4f  ECOLUMNS", "IGNO
+00044980: 5245 4845 4144 4552 2069 7320 3122 5d0a  REHEADER is 1"].
+00044990: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000449a0: 2020 3d3d 2031 0a20 2020 2029 0a20 2020    == 1.    ).   
+000449b0: 2061 7373 6572 7420 280a 2020 2020 2020   assert (.      
+000449c0: 2020 6765 745f 6967 6e6f 7265 6865 6164    get_ignorehead
+000449d0: 6572 5f6e 756d 6265 7228 0a20 2020 2020  er_number(.     
+000449e0: 2020 2020 2020 205b 2244 4154 4546 4f52         ["DATEFOR
+000449f0: 4d41 5420 2761 7574 6f27 222c 2022 434f  MAT 'auto'", "CO
+00044a00: 4d50 5550 4441 5445 204f 4e22 2c20 2254  MPUPDATE ON", "T
+00044a10: 5255 4e43 4154 4543 4f4c 554d 4e53 222c  RUNCATECOLUMNS",
+00044a20: 2022 4947 4e4f 5245 4845 4144 4552 2069   "IGNOREHEADER i
+00044a30: 7320 3222 5d0a 2020 2020 2020 2020 290a  s 2"].        ).
+00044a40: 2020 2020 2020 2020 3d3d 2032 0a20 2020          == 2.   
+00044a50: 2029 0a20 2020 2061 7373 6572 7420 280a   ).    assert (.
+00044a60: 2020 2020 2020 2020 6765 745f 6967 6e6f          get_igno
+00044a70: 7265 6865 6164 6572 5f6e 756d 6265 7228  reheader_number(
+00044a80: 0a20 2020 2020 2020 2020 2020 205b 2244  .            ["D
+00044a90: 4154 4546 4f52 4d41 5420 2761 7574 6f27  ATEFORMAT 'auto'
+00044aa0: 222c 2022 434f 4d50 5550 4441 5445 204f  ", "COMPUPDATE O
+00044ab0: 4e22 2c20 2254 5255 4e43 4154 4543 4f4c  N", "TRUNCATECOL
+00044ac0: 554d 4e53 222c 2022 4947 4e4f 5245 4845  UMNS", "IGNOREHE
+00044ad0: 4144 4552 2069 7320 3939 225d 0a20 2020  ADER is 99"].   
+00044ae0: 2020 2020 2029 0a20 2020 2020 2020 203d       ).        =
+00044af0: 3d20 3939 0a20 2020 2029 0a0a 2020 2020  = 99.    )..    
+00044b00: 6173 7365 7274 2067 6574 5f69 676e 6f72  assert get_ignor
+00044b10: 6568 6561 6465 725f 6e75 6d62 6572 285b  eheader_number([
+00044b20: 2244 4154 4546 4f52 4d41 5420 2761 7574  "DATEFORMAT 'aut
+00044b30: 6f27 222c 2022 434f 4d50 5550 4441 5445  o'", "COMPUPDATE
+00044b40: 204f 4e22 2c20 2254 5255 4e43 4154 4543   ON", "TRUNCATEC
+00044b50: 4f4c 554d 4e53 225d 2920 3d3d 2030 0a20  OLUMNS"]) == 0. 
+00044b60: 2020 2061 7373 6572 7420 280a 2020 2020     assert (.    
+00044b70: 2020 2020 6765 745f 6967 6e6f 7265 6865      get_ignorehe
+00044b80: 6164 6572 5f6e 756d 6265 7228 0a20 2020  ader_number(.   
+00044b90: 2020 2020 2020 2020 205b 2244 4154 4546           ["DATEF
+00044ba0: 4f52 4d41 5420 2761 7574 6f27 222c 2022  ORMAT 'auto'", "
+00044bb0: 434f 4d50 5550 4441 5445 204f 4e22 2c20  COMPUPDATE ON", 
+00044bc0: 2254 5255 4e43 4154 4543 4f4c 554d 4e53  "TRUNCATECOLUMNS
+00044bd0: 222c 2022 4947 4e4f 5245 4845 4144 4552  ", "IGNOREHEADER
+00044be0: 4153 2032 225d 0a20 2020 2020 2020 2029  AS 2"].        )
+00044bf0: 0a20 2020 2020 2020 203d 3d20 300a 2020  .        == 0.  
+00044c00: 2020 290a 2020 2020 6173 7365 7274 2028    ).    assert (
+00044c10: 0a20 2020 2020 2020 2067 6574 5f69 676e  .        get_ign
+00044c20: 6f72 6568 6561 6465 725f 6e75 6d62 6572  oreheader_number
+00044c30: 280a 2020 2020 2020 2020 2020 2020 5b22  (.            ["
+00044c40: 4441 5445 464f 524d 4154 2027 6175 746f  DATEFORMAT 'auto
+00044c50: 2722 2c20 2243 4f4d 5055 5044 4154 4520  '", "COMPUPDATE 
+00044c60: 4f4e 222c 2022 5452 554e 4341 5445 434f  ON", "TRUNCATECO
+00044c70: 4c55 4d4e 5322 2c20 2253 4f4d 4554 4849  LUMNS", "SOMETHI
+00044c80: 4e47 4947 4e4f 5245 4845 4144 4552 2041  NGIGNOREHEADER A
+00044c90: 5320 3222 5d0a 2020 2020 2020 2020 290a  S 2"].        ).
+00044ca0: 2020 2020 2020 2020 3d3d 2030 0a20 2020          == 0.   
+00044cb0: 2029 0a20 2020 2061 7373 6572 7420 6765   ).    assert ge
+00044cc0: 745f 6967 6e6f 7265 6865 6164 6572 5f6e  t_ignoreheader_n
+00044cd0: 756d 6265 7228 5b5d 2920 3d3d 2030 0a0a  umber([]) == 0..
+00044ce0: 2020 2020 7769 7468 2070 7974 6573 742e      with pytest.
+00044cf0: 7261 6973 6573 284c 6f63 6f70 7949 676e  raises(LocopyIgn
+00044d00: 6f72 6548 6561 6465 7245 7272 6f72 293a  oreHeaderError):
+00044d10: 0a20 2020 2020 2020 2067 6574 5f69 676e  .        get_ign
+00044d20: 6f72 6568 6561 6465 725f 6e75 6d62 6572  oreheader_number
+00044d30: 285b 2249 474e 4f52 4548 4541 4445 5220  (["IGNOREHEADER 
+00044d40: 3122 2c20 2249 474e 4f52 4548 4541 4445  1", "IGNOREHEADE
+00044d50: 5220 3939 225d 290a 0000 0000 0000 0000  R 99"]).........
+00044d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044e00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00044ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045000: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045040: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045050: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045060: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045080: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045090: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000450a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000450b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000450c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000450d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000450e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000450f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045100: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045110: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045120: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045130: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045140: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045150: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045160: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045170: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045180: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045190: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000451a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000451b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000451c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000451d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000451e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000451f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045200: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045210: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045220: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045230: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045240: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045250: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045260: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045270: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045280: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045290: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000452a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000452b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000452c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000452d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000452e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000452f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045300: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045310: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045320: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045330: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045340: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045350: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045360: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045370: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045380: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045390: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000453a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000453b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000453c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000453d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000453e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000453f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045400: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045410: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045420: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045430: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045440: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045450: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045460: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045470: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045480: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045490: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000454a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000454b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000454c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000454d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000454e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000454f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045500: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045510: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045520: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045530: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045540: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045550: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045560: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045570: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045580: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045590: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000455a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000455b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000455c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000455d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000455e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000455f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045600: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045610: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045620: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045630: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045640: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045650: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045660: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045670: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045680: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045690: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000456a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000456b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000456c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000456d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000456e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000456f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045700: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045710: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045720: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045730: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045740: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045750: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045760: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045770: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045780: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045790: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000457a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000457b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000457c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000457d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000457e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000457f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045800: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045810: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045820: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045830: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045840: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045850: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045860: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045870: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045880: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045890: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000458a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000458b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000458c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000458d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000458e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000458f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045900: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045910: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045920: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045930: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045940: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045950: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045960: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045970: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045980: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045990: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000459a0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000459b0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000459c0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000459d0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000459e0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+000459f0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045a00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045a10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045a20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045a30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045a40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045a50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045a60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045a70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045a80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045a90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045aa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045ab0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045ac0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045ad0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045ae0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045af0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045b00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045b10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045b20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045b30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045b40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045b50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045b60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045b70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045b80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045b90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045ba0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045bb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045bc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045bd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045be0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045bf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045c00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045c10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045c20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045c30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045c40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045c50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045c60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045c70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045c80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045c90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045ca0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045cb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045cc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045cd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045ce0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045cf0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045d00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045d10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045d20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045d30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045d40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045d50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045d60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045d70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045d80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045d90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045da0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045db0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045dc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045dd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045de0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045df0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045e00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045e10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045e20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045e30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045e40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045e50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045e60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045e70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045e80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045e90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045ea0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045eb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045ec0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045ed0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045ee0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045ef0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045f00: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045f10: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045f20: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045f30: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045f40: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045f50: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045f60: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045f70: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045f80: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045f90: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045fa0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045fb0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045fc0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045fd0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045fe0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
+00045ff0: 0000 0000 0000 0000 0000 0000 0000 0000  ................
```

