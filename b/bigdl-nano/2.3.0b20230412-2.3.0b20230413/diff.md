# Comparing `tmp/bigdl_nano-2.3.0b20230412-py3-none-win_amd64.whl.zip` & `tmp/bigdl_nano-2.3.0b20230413-py3-none-win_amd64.whl.zip`

## zipinfo {}

```diff
@@ -1,8 +1,8 @@
-Zip file size: 2986577 bytes, number of entries: 224
+Zip file size: 2987100 bytes, number of entries: 224
 -rw-r--r--  2.0 unx      956 b- defN 22-Oct-25 01:39 bigdl/__init__.py
 -rw-r--r--  2.0 unx     1554 b- defN 23-Feb-09 11:06 bigdl/nano/__init__.py
 -rw-r--r--  2.0 unx      684 b- defN 22-Oct-25 01:39 bigdl/nano/openvino.py
 -rw-r--r--  2.0 unx      734 b- defN 22-Oct-25 01:39 bigdl/nano/automl/__init__.py
 -rw-r--r--  2.0 unx      633 b- defN 22-Oct-25 01:39 bigdl/nano/automl/hpo/__init__.py
 -rw-r--r--  2.0 unx     1888 b- defN 22-Oct-25 01:39 bigdl/nano/automl/hpo/backend.py
 -rw-r--r--  2.0 unx     8486 b- defN 23-Feb-09 11:06 bigdl/nano/automl/hpo/callgraph.py
@@ -40,15 +40,15 @@
 -rw-r--r--  2.0 unx     8275 b- defN 23-Apr-07 11:07 bigdl/nano/deps/ipex/ipex_api.py
 -rw-r--r--  2.0 unx     8121 b- defN 23-Mar-30 11:07 bigdl/nano/deps/ipex/ipex_inference_bf16_model.py
 -rw-r--r--  2.0 unx    15262 b- defN 23-Mar-30 11:07 bigdl/nano/deps/ipex/ipex_inference_model.py
 -rw-r--r--  2.0 unx     4444 b- defN 23-Apr-07 11:07 bigdl/nano/deps/ipex/ipex_inference_xpu_model.py
 -rw-r--r--  2.0 unx     7512 b- defN 23-Feb-21 06:40 bigdl/nano/deps/ipex/ipex_quantization_model.py
 -rw-r--r--  2.0 unx      586 b- defN 22-Oct-25 01:39 bigdl/nano/deps/neural_compressor/__init__.py
 -rw-r--r--  2.0 unx     3907 b- defN 23-Mar-09 11:07 bigdl/nano/deps/neural_compressor/inc_api.py
--rw-r--r--  2.0 unx     9938 b- defN 23-Apr-11 11:07 bigdl/nano/deps/neural_compressor/inc_api_2.py
+-rw-r--r--  2.0 unx     9975 b- defN 23-Apr-13 11:07 bigdl/nano/deps/neural_compressor/inc_api_2.py
 -rw-r--r--  2.0 unx     1013 b- defN 23-Feb-09 11:06 bigdl/nano/deps/neural_compressor/core/__init__.py
 -rw-r--r--  2.0 unx     1856 b- defN 23-Feb-09 11:06 bigdl/nano/deps/neural_compressor/core/base_metric.py
 -rw-r--r--  2.0 unx    10631 b- defN 23-Feb-09 11:06 bigdl/nano/deps/neural_compressor/core/quantization.py
 -rw-r--r--  2.0 unx     1036 b- defN 23-Feb-09 11:06 bigdl/nano/deps/neural_compressor/onnx/__init__.py
 -rw-r--r--  2.0 unx     1039 b- defN 22-Oct-25 01:39 bigdl/nano/deps/neural_compressor/onnx/metric.py
 -rw-r--r--  2.0 unx     1101 b- defN 22-Oct-25 01:39 bigdl/nano/deps/neural_compressor/onnx/quantization.py
 -rw-r--r--  2.0 unx      586 b- defN 22-Oct-25 01:39 bigdl/nano/deps/neural_compressor/onnx/pytorch/__init__.py
@@ -66,52 +66,52 @@
 -rw-r--r--  2.0 unx     1088 b- defN 23-Feb-01 11:07 bigdl/nano/deps/neural_compressor/tensorflow/metric.py
 -rw-r--r--  2.0 unx     4219 b- defN 23-Mar-13 11:07 bigdl/nano/deps/neural_compressor/tensorflow/model.py
 -rw-r--r--  2.0 unx     3007 b- defN 23-Mar-09 11:07 bigdl/nano/deps/neural_compressor/tensorflow/quantization.py
 -rw-r--r--  2.0 unx      729 b- defN 22-Oct-25 01:39 bigdl/nano/deps/neural_compressor/tensorflow/utils.py
 -rw-r--r--  2.0 unx      586 b- defN 22-Oct-25 01:39 bigdl/nano/deps/onnxruntime/__init__.py
 -rw-r--r--  2.0 unx     4990 b- defN 23-Mar-07 11:07 bigdl/nano/deps/onnxruntime/onnxruntime_api.py
 -rw-r--r--  2.0 unx      932 b- defN 23-Feb-09 11:06 bigdl/nano/deps/onnxruntime/core/__init__.py
--rw-r--r--  2.0 unx     3514 b- defN 23-Apr-12 06:44 bigdl/nano/deps/onnxruntime/core/onnxruntime_model.py
+-rw-r--r--  2.0 unx     3655 b- defN 23-Apr-13 11:07 bigdl/nano/deps/onnxruntime/core/onnxruntime_model.py
 -rw-r--r--  2.0 unx      586 b- defN 22-Oct-25 01:39 bigdl/nano/deps/onnxruntime/pytorch/__init__.py
--rw-r--r--  2.0 unx     7733 b- defN 23-Mar-01 11:07 bigdl/nano/deps/onnxruntime/pytorch/pytorch_onnxruntime_model.py
+-rw-r--r--  2.0 unx     7854 b- defN 23-Apr-13 11:07 bigdl/nano/deps/onnxruntime/pytorch/pytorch_onnxruntime_model.py
 -rw-r--r--  2.0 unx      586 b- defN 22-Oct-25 01:39 bigdl/nano/deps/onnxruntime/tensorflow/__init__.py
 -rw-r--r--  2.0 unx     7852 b- defN 23-Mar-13 11:07 bigdl/nano/deps/onnxruntime/tensorflow/model.py
 -rw-r--r--  2.0 unx      586 b- defN 22-Oct-25 12:02 bigdl/nano/deps/onnxsim/__init__.py
 -rw-r--r--  2.0 unx     1105 b- defN 22-Oct-25 12:02 bigdl/nano/deps/onnxsim/onnxsim_api.py
 -rw-r--r--  2.0 unx      586 b- defN 22-Oct-25 01:39 bigdl/nano/deps/openvino/__init__.py
 -rw-r--r--  2.0 unx     6365 b- defN 23-Mar-09 11:07 bigdl/nano/deps/openvino/openvino_api.py
 -rw-r--r--  2.0 unx      872 b- defN 23-Feb-09 11:06 bigdl/nano/deps/openvino/core/__init__.py
 -rw-r--r--  2.0 unx     2129 b- defN 22-Dec-29 11:06 bigdl/nano/deps/openvino/core/metric.py
--rw-r--r--  2.0 unx     9819 b- defN 23-Apr-12 06:44 bigdl/nano/deps/openvino/core/model.py
+-rw-r--r--  2.0 unx    10572 b- defN 23-Apr-13 11:07 bigdl/nano/deps/openvino/core/model.py
 -rw-r--r--  2.0 unx     4075 b- defN 23-Feb-09 11:06 bigdl/nano/deps/openvino/core/utils.py
 -rw-r--r--  2.0 unx      586 b- defN 22-Oct-25 01:39 bigdl/nano/deps/openvino/pytorch/__init__.py
 -rw-r--r--  2.0 unx     1519 b- defN 23-Feb-09 11:06 bigdl/nano/deps/openvino/pytorch/dataloader.py
 -rw-r--r--  2.0 unx     1668 b- defN 23-Mar-03 11:07 bigdl/nano/deps/openvino/pytorch/metric.py
--rw-r--r--  2.0 unx    12176 b- defN 23-Mar-14 11:07 bigdl/nano/deps/openvino/pytorch/model.py
+-rw-r--r--  2.0 unx    12317 b- defN 23-Apr-13 11:07 bigdl/nano/deps/openvino/pytorch/model.py
 -rw-r--r--  2.0 unx     2616 b- defN 23-Feb-09 11:06 bigdl/nano/deps/openvino/pytorch/utils.py
 -rw-r--r--  2.0 unx      586 b- defN 22-Oct-25 01:39 bigdl/nano/deps/openvino/tf/__init__.py
 -rw-r--r--  2.0 unx     1845 b- defN 23-Feb-09 11:06 bigdl/nano/deps/openvino/tf/dataloader.py
 -rw-r--r--  2.0 unx     1499 b- defN 23-Feb-09 11:06 bigdl/nano/deps/openvino/tf/metric.py
 -rw-r--r--  2.0 unx     9735 b- defN 23-Mar-13 11:07 bigdl/nano/deps/openvino/tf/model.py
 -rw-r--r--  2.0 unx     1676 b- defN 23-Jan-06 02:27 bigdl/nano/deps/openvino/tf/utils.py
 -rw-r--r--  2.0 unx      586 b- defN 22-Oct-25 01:39 bigdl/nano/deps/ray/__init__.py
 -rw-r--r--  2.0 unx     1265 b- defN 23-Feb-09 11:06 bigdl/nano/deps/ray/ray_api.py
 -rw-r--r--  2.0 unx     1530 b- defN 23-Feb-09 11:06 bigdl/nano/deps/ray/ray_backend.py
 -rw-r--r--  2.0 unx    18650 b- defN 23-Mar-01 03:16 bigdl/nano/deps/ray/ray_distributed.py
 -rw-r--r--  2.0 unx     3705 b- defN 22-Oct-25 01:39 bigdl/nano/deps/ray/ray_envbase.py
 -rw-r--r--  2.0 unx      618 b- defN 22-Oct-25 01:39 bigdl/nano/k8s/__init__.py
 -rw-r--r--  2.0 unx    13183 b- defN 23-Feb-09 11:06 bigdl/nano/k8s/bigdl_submit.py
--rwxr--r--  2.0 unx  5460184 b- defN 23-Apr-12 12:17 bigdl/nano/libs/libjemalloc.so
--rwxr--r--  2.0 unx  1432624 b- defN 23-Apr-12 12:17 bigdl/nano/libs/libtcmalloc.so
--rwxr--r--  2.0 unx   918296 b- defN 23-Apr-12 12:17 bigdl/nano/libs/libturbojpeg.so.0.2.0
+-rwxr--r--  2.0 unx  5460184 b- defN 23-Apr-13 12:02 bigdl/nano/libs/libjemalloc.so
+-rwxr--r--  2.0 unx  1432624 b- defN 23-Apr-13 12:02 bigdl/nano/libs/libtcmalloc.so
+-rwxr--r--  2.0 unx   918296 b- defN 23-Apr-13 12:02 bigdl/nano/libs/libturbojpeg.so.0.2.0
 -rw-r--r--  2.0 unx     2113 b- defN 23-Mar-09 11:07 bigdl/nano/pytorch/__init__.py
 -rw-r--r--  2.0 unx     5657 b- defN 23-Apr-07 11:07 bigdl/nano/pytorch/context_manager.py
 -rw-r--r--  2.0 unx     3245 b- defN 22-Dec-16 11:06 bigdl/nano/pytorch/dispatcher.py
 -rw-r--r--  2.0 unx     5818 b- defN 23-Feb-09 11:06 bigdl/nano/pytorch/lightning.py
--rw-r--r--  2.0 unx     2400 b- defN 23-Feb-09 11:06 bigdl/nano/pytorch/model.py
+-rw-r--r--  2.0 unx     3063 b- defN 23-Apr-13 11:07 bigdl/nano/pytorch/model.py
 -rw-r--r--  2.0 unx    18937 b- defN 23-Mar-01 07:03 bigdl/nano/pytorch/torch_nano.py
 -rw-r--r--  2.0 unx      706 b- defN 22-Oct-25 01:39 bigdl/nano/pytorch/algorithms/__init__.py
 -rw-r--r--  2.0 unx     1235 b- defN 22-Oct-25 01:39 bigdl/nano/pytorch/algorithms/selective_backprop/__init__.py
 -rw-r--r--  2.0 unx    12005 b- defN 23-Feb-15 11:07 bigdl/nano/pytorch/algorithms/selective_backprop/selective_backprop.py
 -rw-r--r--  2.0 unx      609 b- defN 22-Oct-25 01:39 bigdl/nano/pytorch/amp/__init__.py
 -rw-r--r--  2.0 unx      805 b- defN 22-Nov-22 07:23 bigdl/nano/pytorch/amp/amp_api.py
 -rw-r--r--  2.0 unx     9569 b- defN 23-Mar-14 11:07 bigdl/nano/pytorch/amp/bfloat16.py
@@ -210,17 +210,17 @@
 -rw-r--r--  2.0 unx     1057 b- defN 23-Mar-09 11:07 bigdl/nano/utils/tf/__init__.py
 -rw-r--r--  2.0 unx     4300 b- defN 23-Feb-19 03:08 bigdl/nano/utils/tf/attributes.py
 -rw-r--r--  2.0 unx     2816 b- defN 23-Apr-04 11:07 bigdl/nano/utils/tf/backend.py
 -rw-r--r--  2.0 unx     7421 b- defN 23-Mar-13 11:07 bigdl/nano/utils/tf/data.py
 -rw-r--r--  2.0 unx     2582 b- defN 23-Mar-09 11:07 bigdl/nano/utils/tf/preprocess.py
 -rw-r--r--  2.0 unx     1347 b- defN 23-Apr-04 11:07 bigdl/nano/utils/tf/subprocess_worker.py
 -rw-r--r--  2.0 unx      823 b- defN 23-Feb-19 03:08 bigdl/nano/utils/tf/version.py
--rwxr-xr-x  2.0 unx    12068 b- defN 23-Apr-07 11:07 bigdl_nano-2.3.0b20230412.data/scripts/bigdl-nano-init
--rwxr-xr-x  2.0 unx      909 b- defN 22-Dec-29 11:06 bigdl_nano-2.3.0b20230412.data/scripts/bigdl-nano-init.ps1
--rwxr-xr-x  2.0 unx      214 b- defN 23-Feb-02 11:06 bigdl_nano-2.3.0b20230412.data/scripts/bigdl-nano-unset-env
--rwxr-xr-x  2.0 unx      127 b- defN 22-Dec-29 11:06 bigdl_nano-2.3.0b20230412.data/scripts/bigdl-nano-unset-env.ps1
--rw-r--r--  2.0 unx    10112 b- defN 23-Apr-12 12:17 bigdl_nano-2.3.0b20230412.dist-info/METADATA
--rw-r--r--  2.0 unx       98 b- defN 23-Apr-12 12:17 bigdl_nano-2.3.0b20230412.dist-info/WHEEL
--rw-r--r--  2.0 unx       54 b- defN 23-Apr-12 12:17 bigdl_nano-2.3.0b20230412.dist-info/entry_points.txt
--rw-r--r--  2.0 unx        6 b- defN 23-Apr-12 12:17 bigdl_nano-2.3.0b20230412.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx    21775 b- defN 23-Apr-12 12:17 bigdl_nano-2.3.0b20230412.dist-info/RECORD
-224 files, 8808154 bytes uncompressed, 2951331 bytes compressed:  66.5%
+-rwxr-xr-x  2.0 unx    12068 b- defN 23-Apr-07 11:07 bigdl_nano-2.3.0b20230413.data/scripts/bigdl-nano-init
+-rwxr-xr-x  2.0 unx      909 b- defN 22-Dec-29 11:06 bigdl_nano-2.3.0b20230413.data/scripts/bigdl-nano-init.ps1
+-rwxr-xr-x  2.0 unx      214 b- defN 23-Feb-02 11:06 bigdl_nano-2.3.0b20230413.data/scripts/bigdl-nano-unset-env
+-rwxr-xr-x  2.0 unx      127 b- defN 22-Dec-29 11:06 bigdl_nano-2.3.0b20230413.data/scripts/bigdl-nano-unset-env.ps1
+-rw-r--r--  2.0 unx    10112 b- defN 23-Apr-13 12:02 bigdl_nano-2.3.0b20230413.dist-info/METADATA
+-rw-r--r--  2.0 unx       98 b- defN 23-Apr-13 12:02 bigdl_nano-2.3.0b20230413.dist-info/WHEEL
+-rw-r--r--  2.0 unx       54 b- defN 23-Apr-13 12:02 bigdl_nano-2.3.0b20230413.dist-info/entry_points.txt
+-rw-r--r--  2.0 unx        6 b- defN 23-Apr-13 12:02 bigdl_nano-2.3.0b20230413.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx    21776 b- defN 23-Apr-13 12:02 bigdl_nano-2.3.0b20230413.dist-info/RECORD
+224 files, 8810011 bytes uncompressed, 2951854 bytes compressed:  66.5%
```

## zipnote {}

```diff
@@ -639,35 +639,35 @@
 
 Filename: bigdl/nano/utils/tf/subprocess_worker.py
 Comment: 
 
 Filename: bigdl/nano/utils/tf/version.py
 Comment: 
 
-Filename: bigdl_nano-2.3.0b20230412.data/scripts/bigdl-nano-init
+Filename: bigdl_nano-2.3.0b20230413.data/scripts/bigdl-nano-init
 Comment: 
 
-Filename: bigdl_nano-2.3.0b20230412.data/scripts/bigdl-nano-init.ps1
+Filename: bigdl_nano-2.3.0b20230413.data/scripts/bigdl-nano-init.ps1
 Comment: 
 
-Filename: bigdl_nano-2.3.0b20230412.data/scripts/bigdl-nano-unset-env
+Filename: bigdl_nano-2.3.0b20230413.data/scripts/bigdl-nano-unset-env
 Comment: 
 
-Filename: bigdl_nano-2.3.0b20230412.data/scripts/bigdl-nano-unset-env.ps1
+Filename: bigdl_nano-2.3.0b20230413.data/scripts/bigdl-nano-unset-env.ps1
 Comment: 
 
-Filename: bigdl_nano-2.3.0b20230412.dist-info/METADATA
+Filename: bigdl_nano-2.3.0b20230413.dist-info/METADATA
 Comment: 
 
-Filename: bigdl_nano-2.3.0b20230412.dist-info/WHEEL
+Filename: bigdl_nano-2.3.0b20230413.dist-info/WHEEL
 Comment: 
 
-Filename: bigdl_nano-2.3.0b20230412.dist-info/entry_points.txt
+Filename: bigdl_nano-2.3.0b20230413.dist-info/entry_points.txt
 Comment: 
 
-Filename: bigdl_nano-2.3.0b20230412.dist-info/top_level.txt
+Filename: bigdl_nano-2.3.0b20230413.dist-info/top_level.txt
 Comment: 
 
-Filename: bigdl_nano-2.3.0b20230412.dist-info/RECORD
+Filename: bigdl_nano-2.3.0b20230413.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## bigdl/nano/deps/neural_compressor/inc_api_2.py

```diff
@@ -109,15 +109,16 @@
         if hasattr(dataloader, "batch_size"):
             # `dataloader` is pytorch DataLoader
             # we should convert pytorch tensor to numpy ndarray
             import torch
 
             def wrap_collate_fn(func):
                 def new_collate_fn(batch):
-                    return [x.numpy() if isinstance(x, torch.Tensor) else x for x in func(batch)]
+                    return [x.detach().numpy() if isinstance(x, torch.Tensor) else x
+                            for x in func(batch)]
                 return new_collate_fn
 
             dataloader = DataLoader(framework, dataloader.dataset,
                                     collate_fn=wrap_collate_fn(dataloader.collate_fn))
         else:
             # `dataloader` is tensorflow (x,y)
             # we should construct a INC DataLoader from tf.Dataset or numpy ndarray
```

## bigdl/nano/deps/onnxruntime/core/onnxruntime_model.py

```diff
@@ -24,29 +24,32 @@
     def __init__(self, onnx_filepath, session_options=None):
         self.onnx_filepath = onnx_filepath  # onnx filepath
         self.onnx_model = None  # onnx model
         self.ortsess = None  # onnxruntime session
         self.session_options = session_options
         self._build_ortsess(session_options)
 
-    def forward_step(self, *inputs):
+    def forward_step(self, *inputs, **kwargs):
         '''
         This function run through the onnxruntime forwarding step
         '''
         flattened_inputs = []
         _flatten(inputs, flattened_inputs)
-        if len(self._forward_args) != len(flattened_inputs):
+        zipped_inputs = dict(zip(self.forward_args, flattened_inputs))
+        if kwargs is not None and len(kwargs) > 0:
+            zipped_inputs.update(kwargs)
+        # TODO: kwargs has tuple or dict?
+        if len(self._forward_args) != len(zipped_inputs):
             # formatting a Tensor will cost much time,
             # so we put it in this `if` statement
             invalidInputError(False,
                               "The length of inputs is "
                               "inconsistent with the length of ONNX Runtime session's inputs, "
                               f"got model_forward_args: {self._forward_args}, "
                               f"and flattened inputs: {flattened_inputs}")
-        zipped_inputs = dict(zip(self.forward_args, flattened_inputs))
         ort_outs = self.ortsess.run(None, zipped_inputs)
         return ort_outs
 
     @property
     def forward_args(self):
         return self._forward_args
```

## bigdl/nano/deps/onnxruntime/pytorch/pytorch_onnxruntime_model.py

```diff
@@ -101,14 +101,18 @@
     def on_forward_start(self, inputs):
         if self.ortsess is None:
             invalidInputError(False,
                               "Please create an instance by PytorchONNXRuntimeModel()")
         inputs = self.tensors_to_numpy(inputs)
         return inputs
 
+    def on_forward_start_kwargs(self, **kwargs):
+        self.cope_with_keyword_arguments(kwargs)
+        return kwargs
+
     def on_forward_end(self, outputs):
         if self.output_tensors:
             outputs = self.numpy_to_tensors(outputs)
         elif len(outputs) == 1:
             outputs = outputs[0]
         return outputs
```

## bigdl/nano/deps/openvino/core/model.py

```diff
@@ -36,34 +36,47 @@
         self.additional_config = config
         self.ie_network = ie_network
 
     def on_forward_start(self, inputs):
         self._model_exists_or_err()
         return inputs
 
-    def forward_step(self, *inputs):
+    def forward_step(self, *inputs, **kwargs):
         flattened_inputs = []
         _flatten(inputs, flattened_inputs)
+        args_length = len(inputs)
+        if kwargs is not None and len(kwargs) > 0:
+            # check kwargs first, to avoid user call model(t1, t2, b=t3, c=t4)
+            # when the signature is def forward(a, b, c)
+            for arg in kwargs:
+                if arg in self.forward_args[:args_length]:
+                    invalidInputError(False,
+                                      f"You shouldn't pass arguement {arg} as it has "
+                                      "been passed as a positional arguement.")
+            # add inputs based on original order
+            for arg in self.forward_args[args_length:]:
+                if arg in kwargs:
+                    flattened_inputs.append(kwargs[arg])
         if len(self._forward_args) != len(flattened_inputs):
             # formatting a Tensor will cost much time,
             # so we put it in this `if` statement
             invalidInputError(False,
                               "The length of inputs is "
                               "inconsistent with the length of OpenVINO's inputs, "
                               f"got model_forward_args: {self._forward_args}, "
-                              f"and flattened inputs: {flattened_inputs}")
+                              f"and flattened inputs's length: {len(flattened_inputs)}")
         return self._infer_request.infer(list(flattened_inputs))
 
     def on_forward_end(self, outputs):
         arrays = tuple(outputs.values())
         if len(arrays) == 1:
             arrays = arrays[0]
         return arrays
 
-    def forward(self, *inputs):
+    def forward(self, *inputs, **kwargs):
         inputs = self.on_forward_start(inputs)
         outputs = self.forward_step(*inputs)
         return self.on_forward_end(outputs)
 
     def __call__(self, *inputs):
         return self.forward(*inputs)
```

## bigdl/nano/deps/openvino/pytorch/model.py

```diff
@@ -101,16 +101,20 @@
         self.output_tensors = output_tensors
 
     def on_forward_start(self, inputs):
         self.ov_model._model_exists_or_err()
         inputs = self.tensors_to_numpy(inputs)
         return inputs
 
-    def forward_step(self, *inputs):
-        return self.ov_model.forward_step(*inputs)
+    def forward_step(self, *inputs, **kwargs):
+        return self.ov_model.forward_step(*inputs, **kwargs)
+
+    def on_forward_start_kwargs(self, **kwargs):
+        self.cope_with_keyword_arguments(kwargs)
+        return kwargs
 
     def on_forward_end(self, outputs):
         outputs = list(outputs.values())
         if self.output_tensors:
             outputs = self.numpy_to_tensors(outputs)
         elif len(outputs) == 1:
             outputs = outputs[0]
```

## bigdl/nano/pytorch/model.py

```diff
@@ -24,48 +24,64 @@
 
 class AcceleratedLightningModule(AcceleratedModel, LightningModule):
     def __init__(self, model):
         super().__init__(model)
         self.model = model
         self.train(False)
 
-    def forward(self, *inputs):
+    def forward(self, *inputs, **kwargs):
         inputs = self.on_forward_start(inputs)
-        outputs = self.forward_step(*inputs)
+        kwargs = self.on_forward_start_kwargs(**kwargs)
+        outputs = self.forward_step(*inputs, **kwargs)
         return self.on_forward_end(outputs)
 
     def on_train_start(self) -> None:
         invalidInputError(False, errMsg="This model is not trainable!")
 
     def train(self, mode=False):
         if mode:
             invalidInputError(False, "This model is not trainable!")
         super().train(mode)
 
-    def forward_step(self, *inputs):
-        return self.model(*inputs)
+    def forward_step(self, *inputs, **kwargs):
+        return self.model(*inputs, **kwargs)
+
+    def on_forward_start_kwargs(self, **kwargs):
+        return kwargs
 
     @staticmethod
     def tensors_to_numpy(tensors):
         # TODO: add more type transformation here
         def to_numpy(ts):
             result = []
             for x in ts:
                 if isinstance(x, torch.Tensor):
-                    result.append(x.cpu().numpy())
+                    result.append(x.cpu().detach().numpy())
                 elif isinstance(x, np.ndarray):
                     result.append(x)
                 elif np.isscalar(x):
-                    result.append(x)
+                    # convert scalar to numpy
+                    result.append(np.array(x))
                 elif isinstance(x, Sequence):
                     result.append(to_numpy(x))
                 else:
                     invalidInputError(False, f"Unexpected Type: {x}")
             return tuple(result)
         return to_numpy(tensors)
 
     @staticmethod
     def numpy_to_tensors(np_arrays):
         tensors = tuple(map(lambda x: torch.from_numpy(x), np_arrays))
         if len(tensors) == 1:
             tensors = tensors[0]
         return tensors
+
+    @staticmethod
+    def cope_with_keyword_arguments(kwargs):
+        # inplace convert kwargs
+        for k in kwargs.keys():
+            if isinstance(kwargs[k], tuple):
+                kwargs[k] = numpy_to_tensors(kwargs[k])
+            if isinstance(kwargs[k], torch.Tensor):
+                kwargs[k] = kwargs[k].cpu().detach().numpy()
+            if np.isscalar(kwargs[k]):
+                kwargs[k] = np.array(kwargs[k])
```

## Comparing `bigdl_nano-2.3.0b20230412.data/scripts/bigdl-nano-init` & `bigdl_nano-2.3.0b20230413.data/scripts/bigdl-nano-init`

 * *Files identical despite different names*

## Comparing `bigdl_nano-2.3.0b20230412.data/scripts/bigdl-nano-init.ps1` & `bigdl_nano-2.3.0b20230413.data/scripts/bigdl-nano-init.ps1`

 * *Files identical despite different names*

## Comparing `bigdl_nano-2.3.0b20230412.dist-info/METADATA` & `bigdl_nano-2.3.0b20230413.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: bigdl-nano
-Version: 2.3.0b20230412
+Version: 2.3.0b20230413
 Summary: High-performance scalable acceleration components for intel.
 Home-page: https://github.com/intel-analytics/BigDL
 Author: BigDL Authors
 Author-email: bigdl-user-group@googlegroups.com
 License: UNKNOWN
 Platform: UNKNOWN
 Description-Content-Type: text/markdown
```

## Comparing `bigdl_nano-2.3.0b20230412.dist-info/RECORD` & `bigdl_nano-2.3.0b20230413.dist-info/RECORD`

 * *Files 2% similar despite different names*

```diff
@@ -39,15 +39,15 @@
 bigdl/nano/deps/ipex/ipex_api.py,sha256=vGDiNV9Bg-IqJEQF7rIjXvbWO1Pw5L7wnI4-XeowyaY,8275
 bigdl/nano/deps/ipex/ipex_inference_bf16_model.py,sha256=9TE6T83plRwu2oDthU_m1gdG8lMhDGfoxzRVDrBE0Y4,8121
 bigdl/nano/deps/ipex/ipex_inference_model.py,sha256=tgHq5Q5ShAAXfapJP2njCZggPMbPTppUPG1I8MK8vJU,15262
 bigdl/nano/deps/ipex/ipex_inference_xpu_model.py,sha256=kI0-5pCtOKxE-9moZvEv_ZX75ZrOus7hsoLSKc5LKEU,4444
 bigdl/nano/deps/ipex/ipex_quantization_model.py,sha256=zFGqqnja4_eXHZr8FPFKoQCsMgcglQajQVmulDH-jH0,7512
 bigdl/nano/deps/neural_compressor/__init__.py,sha256=b2IXvVqQ5cItki021h8s3ymW12RPu8QNPprq4Mn3bDM,586
 bigdl/nano/deps/neural_compressor/inc_api.py,sha256=dV79vfNV4oxXZxlJbTsEojZanuO6ji296xTpCm5UaP8,3907
-bigdl/nano/deps/neural_compressor/inc_api_2.py,sha256=TvvvTk2q7J8Vj15qFFcnu-jfXPQV2KqHpepVGXpLqIw,9938
+bigdl/nano/deps/neural_compressor/inc_api_2.py,sha256=Rs5XGKuX2rF_vo0tMxIFyDTf_4AYEBB-NVVHxwJpXWg,9975
 bigdl/nano/deps/neural_compressor/core/__init__.py,sha256=x-EqdMB3cq0-KGFPSfUq2CpFzBYoGbNFSBXKfoRkc4w,1013
 bigdl/nano/deps/neural_compressor/core/base_metric.py,sha256=qaMc4sZzffzBvagXHgOMWxLCDY0PaABKRZkBnc32kAQ,1856
 bigdl/nano/deps/neural_compressor/core/quantization.py,sha256=sNqYHv7iL0LJc0CMcA4wsVWVQQvM425UrUui1gfSfok,10631
 bigdl/nano/deps/neural_compressor/onnx/__init__.py,sha256=OTLYPpPF1-_8Dx1CENZVd_e6HG2ypQnee6P2fgMs7lU,1036
 bigdl/nano/deps/neural_compressor/onnx/metric.py,sha256=OStmlepjx-2-azJ3PHHQ_gVnevYTXF7wOA3JE8SkuUI,1039
 bigdl/nano/deps/neural_compressor/onnx/quantization.py,sha256=JPKWT3fnZqBQmnHlzTXV_hw1Momh3G8Q41x_e2gaJoQ,1101
 bigdl/nano/deps/neural_compressor/onnx/pytorch/__init__.py,sha256=b2IXvVqQ5cItki021h8s3ymW12RPu8QNPprq4Mn3bDM,586
@@ -65,31 +65,31 @@
 bigdl/nano/deps/neural_compressor/tensorflow/metric.py,sha256=KsJJlRpuFMVybOig-DgmbVvO5t8_-G8NQksAX9QR9ts,1088
 bigdl/nano/deps/neural_compressor/tensorflow/model.py,sha256=EMk5MkrxnjX-w29H2eGUA1EzQlVjMpz1gMb8Grmu8rg,4219
 bigdl/nano/deps/neural_compressor/tensorflow/quantization.py,sha256=R8QB0iZ5QTWK21qj6ig4JVPPkF_QPO-eQoQhRZRFRxU,3007
 bigdl/nano/deps/neural_compressor/tensorflow/utils.py,sha256=lqMDYKCe2pa2gv1nrAl4jEafmH-Ulhguq0mue_c35e4,729
 bigdl/nano/deps/onnxruntime/__init__.py,sha256=b2IXvVqQ5cItki021h8s3ymW12RPu8QNPprq4Mn3bDM,586
 bigdl/nano/deps/onnxruntime/onnxruntime_api.py,sha256=E5zNSDBg8dV6-b-4iRjT4xLzxjLFla0ofOe990fpVy0,4990
 bigdl/nano/deps/onnxruntime/core/__init__.py,sha256=9o3a7HDOY3zh5Ow2ggOMD3A2vmZXHOT6ZvZXCjKktBI,932
-bigdl/nano/deps/onnxruntime/core/onnxruntime_model.py,sha256=lP_aM1QswZqQ3hDTqme-n3AQt0cnEm9Cp3VyKJO64KI,3514
+bigdl/nano/deps/onnxruntime/core/onnxruntime_model.py,sha256=EO7OaXambGRpkavx_CjixBWqzUn8w-mPn5Gu6yOMihw,3655
 bigdl/nano/deps/onnxruntime/pytorch/__init__.py,sha256=b2IXvVqQ5cItki021h8s3ymW12RPu8QNPprq4Mn3bDM,586
-bigdl/nano/deps/onnxruntime/pytorch/pytorch_onnxruntime_model.py,sha256=cqobJCqKA51ve0onfo8bd-mvVj6OE0iwuT5mEq4Nxtw,7733
+bigdl/nano/deps/onnxruntime/pytorch/pytorch_onnxruntime_model.py,sha256=PHoQMZsvg-kPlXPnBYDoLxk55WhHh3yBrNpWGTka_0o,7854
 bigdl/nano/deps/onnxruntime/tensorflow/__init__.py,sha256=b2IXvVqQ5cItki021h8s3ymW12RPu8QNPprq4Mn3bDM,586
 bigdl/nano/deps/onnxruntime/tensorflow/model.py,sha256=Cv0C3B18T9Sj1GWnHgnxOIU9_YhudrTwYZsbAuyXZH8,7852
 bigdl/nano/deps/onnxsim/__init__.py,sha256=b2IXvVqQ5cItki021h8s3ymW12RPu8QNPprq4Mn3bDM,586
 bigdl/nano/deps/onnxsim/onnxsim_api.py,sha256=wywKDXPEO7bi_MY12UkoncEADvnhztqoqyJp8xo5ubc,1105
 bigdl/nano/deps/openvino/__init__.py,sha256=b2IXvVqQ5cItki021h8s3ymW12RPu8QNPprq4Mn3bDM,586
 bigdl/nano/deps/openvino/openvino_api.py,sha256=TNLXmDBJIYybwneqzOcP7b69vfOGMW6yK1fB_y0fIX8,6365
 bigdl/nano/deps/openvino/core/__init__.py,sha256=kSQ0UT3QO1LNOONyFMu6MjG7MVx_Cf_131OBy2e_jhw,872
 bigdl/nano/deps/openvino/core/metric.py,sha256=KCEAgwrKm_QFNrQvM51lsKZt7k1njT-jtyJlqgTEZ6I,2129
-bigdl/nano/deps/openvino/core/model.py,sha256=ivjyMrsTPeceUwD_HyF_FDFGG4dcg5ckY-8QBcbJbL8,9819
+bigdl/nano/deps/openvino/core/model.py,sha256=lbKANq1lt9rbgEhYs6D_HBKMT8COVG-yQqDX4cRBN4k,10572
 bigdl/nano/deps/openvino/core/utils.py,sha256=kelcmlkhHp8m3NYme6ZD5YCgL9i1iguR2tphy2eCv8U,4075
 bigdl/nano/deps/openvino/pytorch/__init__.py,sha256=b2IXvVqQ5cItki021h8s3ymW12RPu8QNPprq4Mn3bDM,586
 bigdl/nano/deps/openvino/pytorch/dataloader.py,sha256=7DNz7QvQSySrVwowGizzyNfJqXOXoh1UsL0VOiM8yR0,1519
 bigdl/nano/deps/openvino/pytorch/metric.py,sha256=hM3nhIeeK0rOABk3s3mzQa3q4xrqeVX_CK0Aq2be5Gw,1668
-bigdl/nano/deps/openvino/pytorch/model.py,sha256=3DStD7c4mqtUi60ceNJaU_DSqfd1Sf5nCGm7srVR4KQ,12176
+bigdl/nano/deps/openvino/pytorch/model.py,sha256=7ll5r4_LbzoYvvW2bxZE9wXKN9c_MR_ftNV6rur8Huo,12317
 bigdl/nano/deps/openvino/pytorch/utils.py,sha256=B_bX2uGKVwNaJEY6i55tR7j2vI0yHsD75bw0HLxA_lk,2616
 bigdl/nano/deps/openvino/tf/__init__.py,sha256=b2IXvVqQ5cItki021h8s3ymW12RPu8QNPprq4Mn3bDM,586
 bigdl/nano/deps/openvino/tf/dataloader.py,sha256=G9Ti71qinxqqMjO7BdhBHe8kBSKydIBd54PfzTa0IqI,1845
 bigdl/nano/deps/openvino/tf/metric.py,sha256=ey7xQUSOQtAv5k_45JB4FUrKWbckaomxmqUx5OwkmuM,1499
 bigdl/nano/deps/openvino/tf/model.py,sha256=ugB-I2RinXc43TrMF2MfqdDqR77chQy3JfwMjV-hVpo,9735
 bigdl/nano/deps/openvino/tf/utils.py,sha256=AqtLgumFpX4LHYEACWrw4ZLi8-Pujmjj2F93efzeSnw,1676
 bigdl/nano/deps/ray/__init__.py,sha256=b2IXvVqQ5cItki021h8s3ymW12RPu8QNPprq4Mn3bDM,586
@@ -102,15 +102,15 @@
 bigdl/nano/libs/libjemalloc.so,sha256=gBgVkr0vI-5w7KdT38ez485J6RvRlZE1-Xe3JnLe4h8,5460184
 bigdl/nano/libs/libtcmalloc.so,sha256=Sp90dC_iafGh3bAdjrvkJt7o_8rAmP4uHkafIBQjFsU,1432624
 bigdl/nano/libs/libturbojpeg.so.0.2.0,sha256=HnDPKkiSZXWUjTbKkGGZIG-p_16OXsNvPHPHL2kEZng,918296
 bigdl/nano/pytorch/__init__.py,sha256=n7XTQzUJUobba0FvyblZgDThnPmQgIoyOSPV_ccxOc0,2113
 bigdl/nano/pytorch/context_manager.py,sha256=Qbs8DZdTHATUBjLe7uIshpsy1Dbny5rsJ1PlcrxvHwo,5657
 bigdl/nano/pytorch/dispatcher.py,sha256=Mf0W83D1XcwVyRBp_PwIbd11DMsOtLrWsEeoOysSnag,3245
 bigdl/nano/pytorch/lightning.py,sha256=Qly7-YaqQQSvssUPv23pRa4H4qx-cmNwWqzZ-XdTZeA,5818
-bigdl/nano/pytorch/model.py,sha256=VnUVWlOg2h7asPF0hnN0a91x9OTmvFJ74j2SeuN5P7s,2400
+bigdl/nano/pytorch/model.py,sha256=AFPJnDw1S5Mwhy3OmCzAZ1GItlV9aQUAN8LPIp0711E,3063
 bigdl/nano/pytorch/torch_nano.py,sha256=s4l-xyuw92S7CkiSxORcp0hp7TPiZyUU4mXD3ckJAUA,18937
 bigdl/nano/pytorch/algorithms/__init__.py,sha256=Xugd2uc-waymnAZMtret72KnHHZa3SauFUBRHy7QYuo,706
 bigdl/nano/pytorch/algorithms/selective_backprop/__init__.py,sha256=70KqiUKOyuHFUPlmxE8lsUTN4ewmhXPCKwU_R3CqYrc,1235
 bigdl/nano/pytorch/algorithms/selective_backprop/selective_backprop.py,sha256=Myrp4t53gYDZRuVGGym7Tz_5uYOah4I_d73ld6dX_io,12005
 bigdl/nano/pytorch/amp/__init__.py,sha256=5T_pNFHbS-EdK7nlbJJqb4JlCvUnPQpO-sxVZuaP6Ys,609
 bigdl/nano/pytorch/amp/amp_api.py,sha256=RSZda43RuQZJB3sfvMR58WIHrj_RyHQHn3NOc0O_HSQ,805
 bigdl/nano/pytorch/amp/bfloat16.py,sha256=Qw9ZXUxDeIgBFfPNedS9PwSi7FPl1bG-9HrloKyz_lw,9569
@@ -209,16 +209,16 @@
 bigdl/nano/utils/tf/__init__.py,sha256=wxh1M-4H8NwLSNhiipdZcXs8gtycV3Cs2DcVPRUnuAE,1057
 bigdl/nano/utils/tf/attributes.py,sha256=AkRSYw0bmdpLwnWZjRXsaIVrDW9H2TJpBB3Tq-RVoGg,4300
 bigdl/nano/utils/tf/backend.py,sha256=CfI_33A-2Na8R462k592F0FlAkwu0lTKzedf_SXyUgQ,2816
 bigdl/nano/utils/tf/data.py,sha256=HyrSXuDeSC-b2X8yP7RBTTKgvLDhV5OqXf7eFOte6nc,7421
 bigdl/nano/utils/tf/preprocess.py,sha256=DHukkdJUa-3z0jK63okaJ0vhbRAJipAoBUpsyS4P93k,2582
 bigdl/nano/utils/tf/subprocess_worker.py,sha256=LitCgfBQdnMqOmGuio4y58Mh9xCoxvn3JVS0INek5mE,1347
 bigdl/nano/utils/tf/version.py,sha256=IN7ZGJJPKSUAJN2LmiJgO_C6cZM8d9023DjcwZ0x9sg,823
-bigdl_nano-2.3.0b20230412.data/scripts/bigdl-nano-init,sha256=A-cN-f_uxGLK3UX7AkwdCpcaMij9SE-rbySsCZRPAPY,12068
-bigdl_nano-2.3.0b20230412.data/scripts/bigdl-nano-init.ps1,sha256=kX83Ue2ZJgibvddidAHzQ5zhbGlHntKlTcK5lvNmkV4,909
-bigdl_nano-2.3.0b20230412.data/scripts/bigdl-nano-unset-env,sha256=rWzU73m1pflJazC6ulhItByaoudgSa8XlUAJVj3W02c,214
-bigdl_nano-2.3.0b20230412.data/scripts/bigdl-nano-unset-env.ps1,sha256=amIge9q2-1oumygXfW00qeYejEdVMESNUferj5B7txU,127
-bigdl_nano-2.3.0b20230412.dist-info/METADATA,sha256=A35TWkPbML6vUck__bwRjgIDJSjHHPAFa1L_foyjLU8,10112
-bigdl_nano-2.3.0b20230412.dist-info/WHEEL,sha256=i9qQj8KaD8_YEW0Vc2oS56fKju23RkQ-FVz-QmzVakQ,98
-bigdl_nano-2.3.0b20230412.dist-info/entry_points.txt,sha256=NJqjgi9adpmsUUYPXsd7LzSBdoN1nYjeOyFi9Wih_oU,54
-bigdl_nano-2.3.0b20230412.dist-info/top_level.txt,sha256=iGuLfZARD_qANcIMfy0tbbrC3EtCg6BSiH8icc3dLWs,6
-bigdl_nano-2.3.0b20230412.dist-info/RECORD,,
+bigdl_nano-2.3.0b20230413.data/scripts/bigdl-nano-init,sha256=A-cN-f_uxGLK3UX7AkwdCpcaMij9SE-rbySsCZRPAPY,12068
+bigdl_nano-2.3.0b20230413.data/scripts/bigdl-nano-init.ps1,sha256=kX83Ue2ZJgibvddidAHzQ5zhbGlHntKlTcK5lvNmkV4,909
+bigdl_nano-2.3.0b20230413.data/scripts/bigdl-nano-unset-env,sha256=rWzU73m1pflJazC6ulhItByaoudgSa8XlUAJVj3W02c,214
+bigdl_nano-2.3.0b20230413.data/scripts/bigdl-nano-unset-env.ps1,sha256=amIge9q2-1oumygXfW00qeYejEdVMESNUferj5B7txU,127
+bigdl_nano-2.3.0b20230413.dist-info/METADATA,sha256=CGTv92lzFDeY4madWtySS5Qfnzaxua5G79h_SakOo5w,10112
+bigdl_nano-2.3.0b20230413.dist-info/WHEEL,sha256=i9qQj8KaD8_YEW0Vc2oS56fKju23RkQ-FVz-QmzVakQ,98
+bigdl_nano-2.3.0b20230413.dist-info/entry_points.txt,sha256=NJqjgi9adpmsUUYPXsd7LzSBdoN1nYjeOyFi9Wih_oU,54
+bigdl_nano-2.3.0b20230413.dist-info/top_level.txt,sha256=iGuLfZARD_qANcIMfy0tbbrC3EtCg6BSiH8icc3dLWs,6
+bigdl_nano-2.3.0b20230413.dist-info/RECORD,,
```

