# Comparing `tmp/XlsxWriter-3.0.9.tar.gz` & `tmp/XlsxWriter-3.1.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "dist/XlsxWriter-3.0.9.tar", last modified: Fri Mar 10 21:41:41 2023, max compression
+gzip compressed data, was "dist/XlsxWriter-3.1.0.tar", last modified: Thu Apr 13 16:13:54 2023, max compression
```

## Comparing `XlsxWriter-3.0.9.tar` & `XlsxWriter-3.1.0.tar`

### file list

```diff
@@ -1,161 +1,161 @@
-drwxr-xr-x   0 John       (501) staff       (20)        0 2023-03-10 21:41:41.775702 XlsxWriter-3.0.9/
--rw-r--r--   0 John       (501) staff       (20)    42113 2023-03-10 20:58:52.000000 XlsxWriter-3.0.9/Changes
--rw-r--r--   0 John       (501) staff       (20)     1349 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/LICENSE.txt
--rw-r--r--   0 John       (501) staff       (20)      205 2020-03-07 17:49:14.000000 XlsxWriter-3.0.9/MANIFEST.in
--rw-r--r--   0 John       (501) staff       (20)     3036 2023-03-10 21:41:41.775906 XlsxWriter-3.0.9/PKG-INFO
--rw-r--r--   0 John       (501) staff       (20)     1710 2023-03-06 00:56:37.000000 XlsxWriter-3.0.9/README.rst
-drwxr-xr-x   0 John       (501) staff       (20)        0 2023-03-10 21:41:41.700100 XlsxWriter-3.0.9/XlsxWriter.egg-info/
--rw-r--r--   0 John       (501) staff       (20)     3036 2023-03-10 21:41:41.000000 XlsxWriter-3.0.9/XlsxWriter.egg-info/PKG-INFO
--rw-r--r--   0 John       (501) staff       (20)     3831 2023-03-10 21:41:41.000000 XlsxWriter-3.0.9/XlsxWriter.egg-info/SOURCES.txt
--rw-r--r--   0 John       (501) staff       (20)        1 2023-03-10 21:41:41.000000 XlsxWriter-3.0.9/XlsxWriter.egg-info/dependency_links.txt
--rw-r--r--   0 John       (501) staff       (20)       11 2023-03-10 21:41:41.000000 XlsxWriter-3.0.9/XlsxWriter.egg-info/top_level.txt
-drwxr-xr-x   0 John       (501) staff       (20)        0 2023-03-10 21:41:41.700335 XlsxWriter-3.0.9/docs/
-drwxr-xr-x   0 John       (501) staff       (20)        0 2023-03-10 21:41:41.703810 XlsxWriter-3.0.9/docs/_static/
--rw-r--r--   0 John       (501) staff       (20)     8522 2020-03-07 17:49:14.000000 XlsxWriter-3.0.9/docs/_static/basic.css
--rw-r--r--   0 John       (501) staff       (20)     4173 2020-03-07 17:49:14.000000 XlsxWriter-3.0.9/docs/_static/default.css
--rw-r--r--   0 John       (501) staff       (20)    63966 2020-03-07 17:49:14.000000 XlsxWriter-3.0.9/docs/_static/hello01.png
--rw-r--r--   0 John       (501) staff       (20)     6802 2020-03-07 17:49:14.000000 XlsxWriter-3.0.9/docs/_static/logo.png
--rw-r--r--   0 John       (501) staff       (20)     3801 2020-03-07 17:49:14.000000 XlsxWriter-3.0.9/docs/_static/pygments.css
--rw-r--r--   0 John       (501) staff       (20)     6053 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/docs/readme.html
-drwxr-xr-x   0 John       (501) staff       (20)        0 2023-03-10 21:41:41.757015 XlsxWriter-3.0.9/examples/
--rw-r--r--   0 John       (501) staff       (20)     1056 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/array_formula.py
--rw-r--r--   0 John       (501) staff       (20)     7123 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/autofilter.py
--rw-r--r--   0 John       (501) staff       (20)     1907 2020-03-07 17:49:14.000000 XlsxWriter-3.0.9/examples/autofilter_data.txt
--rw-r--r--   0 John       (501) staff       (20)      887 2023-02-13 15:54:03.000000 XlsxWriter-3.0.9/examples/autofit.py
--rw-r--r--   0 John       (501) staff       (20)      511 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/background.py
--rw-r--r--   0 John       (501) staff       (20)      674 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/cell_indentation.py
--rw-r--r--   0 John       (501) staff       (20)      974 2023-03-01 12:26:34.000000 XlsxWriter-3.0.9/examples/chart.py
--rw-r--r--   0 John       (501) staff       (20)     3441 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chart_area.py
--rw-r--r--   0 John       (501) staff       (20)     3432 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chart_bar.py
--rw-r--r--   0 John       (501) staff       (20)     1799 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chart_clustered.py
--rw-r--r--   0 John       (501) staff       (20)     3450 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chart_column.py
--rw-r--r--   0 John       (501) staff       (20)     3387 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chart_combined.py
--rw-r--r--   0 John       (501) staff       (20)     8625 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chart_data_labels.py
--rw-r--r--   0 John       (501) staff       (20)     2769 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chart_data_table.py
--rw-r--r--   0 John       (501) staff       (20)     5180 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chart_data_tools.py
--rw-r--r--   0 John       (501) staff       (20)     1534 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chart_date_axis.py
--rw-r--r--   0 John       (501) staff       (20)     4084 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chart_doughnut.py
--rw-r--r--   0 John       (501) staff       (20)     2171 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chart_gauge.py
--rw-r--r--   0 John       (501) staff       (20)     1725 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chart_gradient.py
--rw-r--r--   0 John       (501) staff       (20)     3441 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chart_line.py
--rw-r--r--   0 John       (501) staff       (20)     2168 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chart_pareto.py
--rw-r--r--   0 John       (501) staff       (20)     1629 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chart_pattern.py
--rw-r--r--   0 John       (501) staff       (20)     3075 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chart_pie.py
--rw-r--r--   0 John       (501) staff       (20)     3115 2023-02-19 14:11:11.000000 XlsxWriter-3.0.9/examples/chart_radar.py
--rw-r--r--   0 John       (501) staff       (20)     5456 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chart_scatter.py
--rw-r--r--   0 John       (501) staff       (20)     1477 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chart_secondary_axis.py
--rw-r--r--   0 John       (501) staff       (20)     1758 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chart_stock.py
--rw-r--r--   0 John       (501) staff       (20)     1413 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chart_styles.py
--rw-r--r--   0 John       (501) staff       (20)     1814 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/chartsheet.py
--rw-r--r--   0 John       (501) staff       (20)      960 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/check_close.py
--rw-r--r--   0 John       (501) staff       (20)      529 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/comments1.py
--rw-r--r--   0 John       (501) staff       (20)     7572 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/comments2.py
--rw-r--r--   0 John       (501) staff       (20)    10956 2023-02-26 15:19:11.000000 XlsxWriter-3.0.9/examples/conditional_format.py
--rw-r--r--   0 John       (501) staff       (20)      472 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/context_manager.py
--rw-r--r--   0 John       (501) staff       (20)     7102 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/data_validate.py
--rw-r--r--   0 John       (501) staff       (20)     1847 2023-01-23 12:38:31.000000 XlsxWriter-3.0.9/examples/datetimes.py
--rw-r--r--   0 John       (501) staff       (20)     1209 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/defined_name.py
--rw-r--r--   0 John       (501) staff       (20)      888 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/demo.py
--rw-r--r--   0 John       (501) staff       (20)      813 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/diagonal_border.py
--rw-r--r--   0 John       (501) staff       (20)     1818 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/django_simple.py
--rw-r--r--   0 John       (501) staff       (20)      874 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/doc_properties.py
--rw-r--r--   0 John       (501) staff       (20)     7916 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/dynamic_arrays.py
--rw-r--r--   0 John       (501) staff       (20)     4087 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/headers_footers.py
--rw-r--r--   0 John       (501) staff       (20)      409 2023-02-13 15:54:03.000000 XlsxWriter-3.0.9/examples/hello_world.py
--rw-r--r--   0 John       (501) staff       (20)      994 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/hide_row_col.py
--rw-r--r--   0 John       (501) staff       (20)     1023 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/hide_sheet.py
--rw-r--r--   0 John       (501) staff       (20)     2009 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/http_server.py
--rw-r--r--   0 John       (501) staff       (20)     1127 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/hyperlink.py
--rw-r--r--   0 John       (501) staff       (20)     1092 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/ignore_errors.py
--rw-r--r--   0 John       (501) staff       (20)      973 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/images.py
--rw-r--r--   0 John       (501) staff       (20)     1311 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/images_bytesio.py
--rw-r--r--   0 John       (501) staff       (20)     1766 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/inheritance1.py
--rw-r--r--   0 John       (501) staff       (20)     3943 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/inheritance2.py
--rw-r--r--   0 John       (501) staff       (20)     1282 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/lambda.py
--rw-r--r--   0 John       (501) staff       (20)     1082 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/macros.py
--rw-r--r--   0 John       (501) staff       (20)      970 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/merge1.py
--rw-r--r--   0 John       (501) staff       (20)     1261 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/merge_rich_string.py
--rw-r--r--   0 John       (501) staff       (20)     6780 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/outline.py
--rw-r--r--   0 John       (501) staff       (20)     7762 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/outline_collapsed.py
--rw-r--r--   0 John       (501) staff       (20)     1649 2023-02-13 15:54:03.000000 XlsxWriter-3.0.9/examples/pandas_autofilter.py
--rw-r--r--   0 John       (501) staff       (20)     1169 2023-03-05 00:55:17.000000 XlsxWriter-3.0.9/examples/pandas_chart.py
--rw-r--r--   0 John       (501) staff       (20)     2031 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/pandas_chart_columns.py
--rw-r--r--   0 John       (501) staff       (20)     1828 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/pandas_chart_line.py
--rw-r--r--   0 John       (501) staff       (20)     1392 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/pandas_column_formats.py
--rw-r--r--   0 John       (501) staff       (20)     1095 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/pandas_conditional_format.py
--rw-r--r--   0 John       (501) staff       (20)     1927 2023-01-31 00:44:52.000000 XlsxWriter-3.0.9/examples/pandas_datetime.py
--rw-r--r--   0 John       (501) staff       (20)     1372 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/pandas_header_format.py
--rw-r--r--   0 John       (501) staff       (20)      867 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/pandas_multiple.py
--rw-r--r--   0 John       (501) staff       (20)     1278 2023-03-04 13:59:55.000000 XlsxWriter-3.0.9/examples/pandas_percentage.py
--rw-r--r--   0 John       (501) staff       (20)     1144 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/pandas_positioning.py
--rw-r--r--   0 John       (501) staff       (20)      709 2023-02-05 01:39:48.000000 XlsxWriter-3.0.9/examples/pandas_simple.py
--rw-r--r--   0 John       (501) staff       (20)     1767 2023-01-15 12:37:38.000000 XlsxWriter-3.0.9/examples/pandas_table.py
--rw-r--r--   0 John       (501) staff       (20)     3218 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/panes.py
--rw-r--r--   0 John       (501) staff       (20)     1063 2023-03-10 20:52:52.000000 XlsxWriter-3.0.9/examples/polars_chart.py
--rw-r--r--   0 John       (501) staff       (20)      468 2023-03-10 20:52:52.000000 XlsxWriter-3.0.9/examples/polars_conditional_format.py
--rw-r--r--   0 John       (501) staff       (20)     1100 2023-03-10 20:52:52.000000 XlsxWriter-3.0.9/examples/polars_format_custom.py
--rw-r--r--   0 John       (501) staff       (20)      700 2023-03-10 20:52:52.000000 XlsxWriter-3.0.9/examples/polars_format_default.py
--rw-r--r--   0 John       (501) staff       (20)      680 2023-03-10 20:52:52.000000 XlsxWriter-3.0.9/examples/polars_multiple.py
--rw-r--r--   0 John       (501) staff       (20)     1146 2023-03-10 20:52:52.000000 XlsxWriter-3.0.9/examples/polars_positioning.py
--rw-r--r--   0 John       (501) staff       (20)      495 2023-03-10 20:52:52.000000 XlsxWriter-3.0.9/examples/polars_simple.py
--rw-r--r--   0 John       (501) staff       (20)     1426 2023-03-10 20:52:52.000000 XlsxWriter-3.0.9/examples/polars_sparklines.py
--rw-r--r--   0 John       (501) staff       (20)      796 2023-03-10 20:52:52.000000 XlsxWriter-3.0.9/examples/polars_xlsxwriter.py
--rw-r--r--   0 John       (501) staff       (20)     1794 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/rich_strings.py
--rw-r--r--   0 John       (501) staff       (20)     1507 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/right_to_left.py
--rw-r--r--   0 John       (501) staff       (20)     1391 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/sparklines1.py
--rw-r--r--   0 John       (501) staff       (20)     8377 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/sparklines2.py
--rw-r--r--   0 John       (501) staff       (20)      707 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/tab_colors.py
--rw-r--r--   0 John       (501) staff       (20)    11505 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/tables.py
--rw-r--r--   0 John       (501) staff       (20)      668 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/text_indent.py
--rw-r--r--   0 John       (501) staff       (20)     4697 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/textbox.py
--rw-r--r--   0 John       (501) staff       (20)     1032 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/tutorial1.py
--rw-r--r--   0 John       (501) staff       (20)     1324 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/tutorial2.py
--rw-r--r--   0 John       (501) staff       (20)     1757 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/tutorial3.py
--rw-r--r--   0 John       (501) staff       (20)      568 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/unicode.py
--rw-r--r--   0 John       (501) staff       (20)     1101 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/unicode_polish_utf8.py
--rw-r--r--   0 John       (501) staff       (20)      802 2018-11-10 14:43:15.000000 XlsxWriter-3.0.9/examples/unicode_polish_utf8.txt
--rw-r--r--   0 John       (501) staff       (20)     1108 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/unicode_shift_jis.py
--rw-r--r--   0 John       (501) staff       (20)      437 2018-11-10 14:43:15.000000 XlsxWriter-3.0.9/examples/unicode_shift_jis.txt
--rw-r--r--   0 John       (501) staff       (20)     1251 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/user_types1.py
--rw-r--r--   0 John       (501) staff       (20)     1327 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/user_types2.py
--rw-r--r--   0 John       (501) staff       (20)     1548 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/user_types3.py
--rw-r--r--   0 John       (501) staff       (20)    15872 2020-03-07 17:49:14.000000 XlsxWriter-3.0.9/examples/vbaProject.bin
--rw-r--r--   0 John       (501) staff       (20)     1843 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/vba_extract.py
--rw-r--r--   0 John       (501) staff       (20)      765 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/watermark.py
--rw-r--r--   0 John       (501) staff       (20)     1100 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/examples/worksheet_protection.py
--rw-r--r--   0 John       (501) staff       (20)       61 2023-03-10 21:41:41.776595 XlsxWriter-3.0.9/setup.cfg
--rw-r--r--   0 John       (501) staff       (20)     1514 2023-03-10 21:00:31.000000 XlsxWriter-3.0.9/setup.py
-drwxr-xr-x   0 John       (501) staff       (20)        0 2023-03-10 21:41:41.775302 XlsxWriter-3.0.9/xlsxwriter/
--rw-r--r--   0 John       (501) staff       (20)      180 2023-03-10 21:00:31.000000 XlsxWriter-3.0.9/xlsxwriter/__init__.py
--rw-r--r--   0 John       (501) staff       (20)     5823 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/app.py
--rw-r--r--   0 John       (501) staff       (20)   127050 2023-03-01 12:27:30.000000 XlsxWriter-3.0.9/xlsxwriter/chart.py
--rw-r--r--   0 John       (501) staff       (20)     2676 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/chart_area.py
--rw-r--r--   0 John       (501) staff       (20)     4834 2023-02-14 10:43:14.000000 XlsxWriter-3.0.9/xlsxwriter/chart_bar.py
--rw-r--r--   0 John       (501) staff       (20)     3585 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/chart_column.py
--rw-r--r--   0 John       (501) staff       (20)     2707 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/chart_doughnut.py
--rw-r--r--   0 John       (501) staff       (20)     3747 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/chart_line.py
--rw-r--r--   0 John       (501) staff       (20)     7055 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/chart_pie.py
--rw-r--r--   0 John       (501) staff       (20)     2739 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/chart_radar.py
--rw-r--r--   0 John       (501) staff       (20)     9654 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/chart_scatter.py
--rw-r--r--   0 John       (501) staff       (20)     3590 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/chart_stock.py
--rw-r--r--   0 John       (501) staff       (20)     5602 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/chartsheet.py
--rw-r--r--   0 John       (501) staff       (20)     5598 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/comments.py
--rw-r--r--   0 John       (501) staff       (20)     7354 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/contenttypes.py
--rw-r--r--   0 John       (501) staff       (20)     5506 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/core.py
--rw-r--r--   0 John       (501) staff       (20)     3829 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/custom.py
--rw-r--r--   0 John       (501) staff       (20)    35659 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/drawing.py
--rw-r--r--   0 John       (501) staff       (20)     1394 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/exceptions.py
--rw-r--r--   0 John       (501) staff       (20)    26330 2023-01-09 20:19:55.000000 XlsxWriter-3.0.9/xlsxwriter/format.py
--rw-r--r--   0 John       (501) staff       (20)     4522 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/metadata.py
--rw-r--r--   0 John       (501) staff       (20)    24145 2023-03-06 20:01:22.000000 XlsxWriter-3.0.9/xlsxwriter/packager.py
--rw-r--r--   0 John       (501) staff       (20)     3462 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/relationships.py
--rw-r--r--   0 John       (501) staff       (20)    12895 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/shape.py
--rw-r--r--   0 John       (501) staff       (20)     4786 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/sharedstrings.py
--rw-r--r--   0 John       (501) staff       (20)    23162 2023-03-06 20:05:41.000000 XlsxWriter-3.0.9/xlsxwriter/styles.py
--rw-r--r--   0 John       (501) staff       (20)     5390 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/table.py
--rw-r--r--   0 John       (501) staff       (20)     8836 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/theme.py
--rw-r--r--   0 John       (501) staff       (20)    27923 2023-01-15 17:31:45.000000 XlsxWriter-3.0.9/xlsxwriter/utility.py
--rw-r--r--   0 John       (501) staff       (20)    19597 2022-12-31 20:01:53.000000 XlsxWriter-3.0.9/xlsxwriter/vml.py
--rw-r--r--   0 John       (501) staff       (20)    63847 2023-03-06 20:34:28.000000 XlsxWriter-3.0.9/xlsxwriter/workbook.py
--rw-r--r--   0 John       (501) staff       (20)   282714 2023-03-10 20:52:44.000000 XlsxWriter-3.0.9/xlsxwriter/worksheet.py
--rw-r--r--   0 John       (501) staff       (20)     6847 2023-03-10 20:52:44.000000 XlsxWriter-3.0.9/xlsxwriter/xmlwriter.py
+drwxr-xr-x   0 John       (501) staff       (20)        0 2023-04-13 16:13:54.755927 XlsxWriter-3.1.0/
+-rw-r--r--   0 John       (501) staff       (20)    42210 2023-04-13 15:54:45.000000 XlsxWriter-3.1.0/Changes
+-rw-r--r--   0 John       (501) staff       (20)     1349 2022-12-31 20:01:53.000000 XlsxWriter-3.1.0/LICENSE.txt
+-rw-r--r--   0 John       (501) staff       (20)      205 2020-03-07 17:49:14.000000 XlsxWriter-3.1.0/MANIFEST.in
+-rw-r--r--   0 John       (501) staff       (20)     3036 2023-04-13 16:13:54.756054 XlsxWriter-3.1.0/PKG-INFO
+-rw-r--r--   0 John       (501) staff       (20)     1710 2023-03-06 00:56:37.000000 XlsxWriter-3.1.0/README.rst
+drwxr-xr-x   0 John       (501) staff       (20)        0 2023-04-13 16:13:54.716136 XlsxWriter-3.1.0/XlsxWriter.egg-info/
+-rw-r--r--   0 John       (501) staff       (20)     3036 2023-04-13 16:13:54.000000 XlsxWriter-3.1.0/XlsxWriter.egg-info/PKG-INFO
+-rw-r--r--   0 John       (501) staff       (20)     3831 2023-04-13 16:13:54.000000 XlsxWriter-3.1.0/XlsxWriter.egg-info/SOURCES.txt
+-rw-r--r--   0 John       (501) staff       (20)        1 2023-04-13 16:13:54.000000 XlsxWriter-3.1.0/XlsxWriter.egg-info/dependency_links.txt
+-rw-r--r--   0 John       (501) staff       (20)       11 2023-04-13 16:13:54.000000 XlsxWriter-3.1.0/XlsxWriter.egg-info/top_level.txt
+drwxr-xr-x   0 John       (501) staff       (20)        0 2023-04-13 16:13:54.716502 XlsxWriter-3.1.0/docs/
+drwxr-xr-x   0 John       (501) staff       (20)        0 2023-04-13 16:13:54.719539 XlsxWriter-3.1.0/docs/_static/
+-rw-r--r--   0 John       (501) staff       (20)     8522 2020-03-07 17:49:14.000000 XlsxWriter-3.1.0/docs/_static/basic.css
+-rw-r--r--   0 John       (501) staff       (20)     4173 2020-03-07 17:49:14.000000 XlsxWriter-3.1.0/docs/_static/default.css
+-rw-r--r--   0 John       (501) staff       (20)    63966 2020-03-07 17:49:14.000000 XlsxWriter-3.1.0/docs/_static/hello01.png
+-rw-r--r--   0 John       (501) staff       (20)     6802 2020-03-07 17:49:14.000000 XlsxWriter-3.1.0/docs/_static/logo.png
+-rw-r--r--   0 John       (501) staff       (20)     3801 2020-03-07 17:49:14.000000 XlsxWriter-3.1.0/docs/_static/pygments.css
+-rw-r--r--   0 John       (501) staff       (20)     6053 2022-12-31 20:01:53.000000 XlsxWriter-3.1.0/docs/readme.html
+drwxr-xr-x   0 John       (501) staff       (20)        0 2023-04-13 16:13:54.747503 XlsxWriter-3.1.0/examples/
+-rw-r--r--   0 John       (501) staff       (20)     1056 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/array_formula.py
+-rw-r--r--   0 John       (501) staff       (20)     7107 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/autofilter.py
+-rw-r--r--   0 John       (501) staff       (20)     1907 2020-03-07 17:49:14.000000 XlsxWriter-3.1.0/examples/autofilter_data.txt
+-rw-r--r--   0 John       (501) staff       (20)      887 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/autofit.py
+-rw-r--r--   0 John       (501) staff       (20)      511 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/background.py
+-rw-r--r--   0 John       (501) staff       (20)      674 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/cell_indentation.py
+-rw-r--r--   0 John       (501) staff       (20)      974 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart.py
+-rw-r--r--   0 John       (501) staff       (20)     3510 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_area.py
+-rw-r--r--   0 John       (501) staff       (20)     3501 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_bar.py
+-rw-r--r--   0 John       (501) staff       (20)     1769 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_clustered.py
+-rw-r--r--   0 John       (501) staff       (20)     3519 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_column.py
+-rw-r--r--   0 John       (501) staff       (20)     3430 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_combined.py
+-rw-r--r--   0 John       (501) staff       (20)     8743 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_data_labels.py
+-rw-r--r--   0 John       (501) staff       (20)     2817 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_data_table.py
+-rw-r--r--   0 John       (501) staff       (20)     5384 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_data_tools.py
+-rw-r--r--   0 John       (501) staff       (20)     1536 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_date_axis.py
+-rw-r--r--   0 John       (501) staff       (20)     4190 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_doughnut.py
+-rw-r--r--   0 John       (501) staff       (20)     2281 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_gauge.py
+-rw-r--r--   0 John       (501) staff       (20)     1749 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_gradient.py
+-rw-r--r--   0 John       (501) staff       (20)     3510 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_line.py
+-rw-r--r--   0 John       (501) staff       (20)     2188 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_pareto.py
+-rw-r--r--   0 John       (501) staff       (20)     1657 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_pattern.py
+-rw-r--r--   0 John       (501) staff       (20)     3143 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_pie.py
+-rw-r--r--   0 John       (501) staff       (20)     3184 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_radar.py
+-rw-r--r--   0 John       (501) staff       (20)     5465 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_scatter.py
+-rw-r--r--   0 John       (501) staff       (20)     1532 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_secondary_axis.py
+-rw-r--r--   0 John       (501) staff       (20)     1807 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_stock.py
+-rw-r--r--   0 John       (501) staff       (20)     1409 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chart_styles.py
+-rw-r--r--   0 John       (501) staff       (20)     1836 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/chartsheet.py
+-rw-r--r--   0 John       (501) staff       (20)      956 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/check_close.py
+-rw-r--r--   0 John       (501) staff       (20)      529 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/comments1.py
+-rw-r--r--   0 John       (501) staff       (20)     7515 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/comments2.py
+-rw-r--r--   0 John       (501) staff       (20)     9081 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/conditional_format.py
+-rw-r--r--   0 John       (501) staff       (20)      472 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/context_manager.py
+-rw-r--r--   0 John       (501) staff       (20)     5993 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/data_validate.py
+-rw-r--r--   0 John       (501) staff       (20)     1778 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/datetimes.py
+-rw-r--r--   0 John       (501) staff       (20)     1209 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/defined_name.py
+-rw-r--r--   0 John       (501) staff       (20)      888 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/demo.py
+-rw-r--r--   0 John       (501) staff       (20)      835 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/diagonal_border.py
+-rw-r--r--   0 John       (501) staff       (20)     1793 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/django_simple.py
+-rw-r--r--   0 John       (501) staff       (20)      910 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/doc_properties.py
+-rw-r--r--   0 John       (501) staff       (20)     7866 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/dynamic_arrays.py
+-rw-r--r--   0 John       (501) staff       (20)     4087 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/headers_footers.py
+-rw-r--r--   0 John       (501) staff       (20)      409 2023-03-23 09:21:36.000000 XlsxWriter-3.1.0/examples/hello_world.py
+-rw-r--r--   0 John       (501) staff       (20)      994 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/hide_row_col.py
+-rw-r--r--   0 John       (501) staff       (20)     1023 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/hide_sheet.py
+-rw-r--r--   0 John       (501) staff       (20)     2018 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/http_server.py
+-rw-r--r--   0 John       (501) staff       (20)     1145 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/hyperlink.py
+-rw-r--r--   0 John       (501) staff       (20)     1092 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/ignore_errors.py
+-rw-r--r--   0 John       (501) staff       (20)      973 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/images.py
+-rw-r--r--   0 John       (501) staff       (20)     1312 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/images_bytesio.py
+-rw-r--r--   0 John       (501) staff       (20)     1765 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/inheritance1.py
+-rw-r--r--   0 John       (501) staff       (20)     3890 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/inheritance2.py
+-rw-r--r--   0 John       (501) staff       (20)     1261 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/lambda.py
+-rw-r--r--   0 John       (501) staff       (20)      995 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/macros.py
+-rw-r--r--   0 John       (501) staff       (20)     1002 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/merge1.py
+-rw-r--r--   0 John       (501) staff       (20)     1057 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/merge_rich_string.py
+-rw-r--r--   0 John       (501) staff       (20)     6824 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/outline.py
+-rw-r--r--   0 John       (501) staff       (20)     7694 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/outline_collapsed.py
+-rw-r--r--   0 John       (501) staff       (20)     1645 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/pandas_autofilter.py
+-rw-r--r--   0 John       (501) staff       (20)     1168 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/pandas_chart.py
+-rw-r--r--   0 John       (501) staff       (20)     2041 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/pandas_chart_columns.py
+-rw-r--r--   0 John       (501) staff       (20)     1826 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/pandas_chart_line.py
+-rw-r--r--   0 John       (501) staff       (20)     1393 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/pandas_column_formats.py
+-rw-r--r--   0 John       (501) staff       (20)     1065 2023-03-23 09:21:36.000000 XlsxWriter-3.1.0/examples/pandas_conditional_format.py
+-rw-r--r--   0 John       (501) staff       (20)     1700 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/pandas_datetime.py
+-rw-r--r--   0 John       (501) staff       (20)     1383 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/pandas_header_format.py
+-rw-r--r--   0 John       (501) staff       (20)      867 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/pandas_multiple.py
+-rw-r--r--   0 John       (501) staff       (20)     1257 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/pandas_percentage.py
+-rw-r--r--   0 John       (501) staff       (20)     1137 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/pandas_positioning.py
+-rw-r--r--   0 John       (501) staff       (20)      709 2023-03-11 13:44:58.000000 XlsxWriter-3.1.0/examples/pandas_simple.py
+-rw-r--r--   0 John       (501) staff       (20)     1738 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/pandas_table.py
+-rw-r--r--   0 John       (501) staff       (20)     3123 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/panes.py
+-rw-r--r--   0 John       (501) staff       (20)     1063 2023-03-15 20:12:25.000000 XlsxWriter-3.1.0/examples/polars_chart.py
+-rw-r--r--   0 John       (501) staff       (20)      468 2023-03-15 20:12:31.000000 XlsxWriter-3.1.0/examples/polars_conditional_format.py
+-rw-r--r--   0 John       (501) staff       (20)     1100 2023-03-10 20:52:52.000000 XlsxWriter-3.1.0/examples/polars_format_custom.py
+-rw-r--r--   0 John       (501) staff       (20)      700 2023-03-10 20:52:52.000000 XlsxWriter-3.1.0/examples/polars_format_default.py
+-rw-r--r--   0 John       (501) staff       (20)      680 2023-03-10 20:52:52.000000 XlsxWriter-3.1.0/examples/polars_multiple.py
+-rw-r--r--   0 John       (501) staff       (20)     1146 2023-03-10 20:52:52.000000 XlsxWriter-3.1.0/examples/polars_positioning.py
+-rw-r--r--   0 John       (501) staff       (20)      495 2023-03-10 20:52:52.000000 XlsxWriter-3.1.0/examples/polars_simple.py
+-rw-r--r--   0 John       (501) staff       (20)     1426 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/polars_sparklines.py
+-rw-r--r--   0 John       (501) staff       (20)      796 2023-03-15 20:12:38.000000 XlsxWriter-3.1.0/examples/polars_xlsxwriter.py
+-rw-r--r--   0 John       (501) staff       (20)     1352 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/rich_strings.py
+-rw-r--r--   0 John       (501) staff       (20)     1507 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/right_to_left.py
+-rw-r--r--   0 John       (501) staff       (20)     1242 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/sparklines1.py
+-rw-r--r--   0 John       (501) staff       (20)     7255 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/sparklines2.py
+-rw-r--r--   0 John       (501) staff       (20)      707 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/tab_colors.py
+-rw-r--r--   0 John       (501) staff       (20)    10250 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/tables.py
+-rw-r--r--   0 John       (501) staff       (20)      668 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/text_indent.py
+-rw-r--r--   0 John       (501) staff       (20)     4499 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/textbox.py
+-rw-r--r--   0 John       (501) staff       (20)     1030 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/tutorial1.py
+-rw-r--r--   0 John       (501) staff       (20)     1322 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/tutorial2.py
+-rw-r--r--   0 John       (501) staff       (20)     1755 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/tutorial3.py
+-rw-r--r--   0 John       (501) staff       (20)      568 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/unicode.py
+-rw-r--r--   0 John       (501) staff       (20)     1101 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/unicode_polish_utf8.py
+-rw-r--r--   0 John       (501) staff       (20)      802 2018-11-10 14:43:15.000000 XlsxWriter-3.1.0/examples/unicode_polish_utf8.txt
+-rw-r--r--   0 John       (501) staff       (20)     1108 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/unicode_shift_jis.py
+-rw-r--r--   0 John       (501) staff       (20)      437 2018-11-10 14:43:15.000000 XlsxWriter-3.1.0/examples/unicode_shift_jis.txt
+-rw-r--r--   0 John       (501) staff       (20)     1253 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/user_types1.py
+-rw-r--r--   0 John       (501) staff       (20)     1329 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/user_types2.py
+-rw-r--r--   0 John       (501) staff       (20)     1529 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/user_types3.py
+-rw-r--r--   0 John       (501) staff       (20)    15872 2020-03-07 17:49:14.000000 XlsxWriter-3.1.0/examples/vbaProject.bin
+-rw-r--r--   0 John       (501) staff       (20)     1847 2023-03-15 20:11:46.000000 XlsxWriter-3.1.0/examples/vba_extract.py
+-rw-r--r--   0 John       (501) staff       (20)      744 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/watermark.py
+-rw-r--r--   0 John       (501) staff       (20)     1100 2023-03-11 13:44:59.000000 XlsxWriter-3.1.0/examples/worksheet_protection.py
+-rw-r--r--   0 John       (501) staff       (20)       61 2023-04-13 16:13:54.756406 XlsxWriter-3.1.0/setup.cfg
+-rw-r--r--   0 John       (501) staff       (20)     1514 2023-04-13 15:55:01.000000 XlsxWriter-3.1.0/setup.py
+drwxr-xr-x   0 John       (501) staff       (20)        0 2023-04-13 16:13:54.755726 XlsxWriter-3.1.0/xlsxwriter/
+-rw-r--r--   0 John       (501) staff       (20)      188 2023-04-13 15:55:01.000000 XlsxWriter-3.1.0/xlsxwriter/__init__.py
+-rw-r--r--   0 John       (501) staff       (20)     5823 2023-03-11 13:44:26.000000 XlsxWriter-3.1.0/xlsxwriter/app.py
+-rw-r--r--   0 John       (501) staff       (20)   125618 2023-03-26 18:58:03.000000 XlsxWriter-3.1.0/xlsxwriter/chart.py
+-rw-r--r--   0 John       (501) staff       (20)     2676 2023-03-11 13:44:26.000000 XlsxWriter-3.1.0/xlsxwriter/chart_area.py
+-rw-r--r--   0 John       (501) staff       (20)     4844 2023-03-11 13:44:26.000000 XlsxWriter-3.1.0/xlsxwriter/chart_bar.py
+-rw-r--r--   0 John       (501) staff       (20)     3595 2023-03-11 13:44:26.000000 XlsxWriter-3.1.0/xlsxwriter/chart_column.py
+-rw-r--r--   0 John       (501) staff       (20)     2690 2023-03-11 13:44:26.000000 XlsxWriter-3.1.0/xlsxwriter/chart_doughnut.py
+-rw-r--r--   0 John       (501) staff       (20)     3757 2023-03-11 13:44:26.000000 XlsxWriter-3.1.0/xlsxwriter/chart_line.py
+-rw-r--r--   0 John       (501) staff       (20)     7060 2023-03-11 13:44:26.000000 XlsxWriter-3.1.0/xlsxwriter/chart_pie.py
+-rw-r--r--   0 John       (501) staff       (20)     2739 2023-03-11 13:44:26.000000 XlsxWriter-3.1.0/xlsxwriter/chart_radar.py
+-rw-r--r--   0 John       (501) staff       (20)     9546 2023-03-11 13:44:27.000000 XlsxWriter-3.1.0/xlsxwriter/chart_scatter.py
+-rw-r--r--   0 John       (501) staff       (20)     3524 2023-03-11 13:44:26.000000 XlsxWriter-3.1.0/xlsxwriter/chart_stock.py
+-rw-r--r--   0 John       (501) staff       (20)     5382 2023-03-11 13:44:26.000000 XlsxWriter-3.1.0/xlsxwriter/chartsheet.py
+-rw-r--r--   0 John       (501) staff       (20)     5598 2023-03-11 13:44:26.000000 XlsxWriter-3.1.0/xlsxwriter/comments.py
+-rw-r--r--   0 John       (501) staff       (20)     7286 2023-03-11 13:44:27.000000 XlsxWriter-3.1.0/xlsxwriter/contenttypes.py
+-rw-r--r--   0 John       (501) staff       (20)     5656 2023-03-11 13:44:26.000000 XlsxWriter-3.1.0/xlsxwriter/core.py
+-rw-r--r--   0 John       (501) staff       (20)     3829 2023-03-11 13:44:26.000000 XlsxWriter-3.1.0/xlsxwriter/custom.py
+-rw-r--r--   0 John       (501) staff       (20)    35194 2023-03-11 13:44:29.000000 XlsxWriter-3.1.0/xlsxwriter/drawing.py
+-rw-r--r--   0 John       (501) staff       (20)     1394 2022-12-31 20:01:53.000000 XlsxWriter-3.1.0/xlsxwriter/exceptions.py
+-rw-r--r--   0 John       (501) staff       (20)    26767 2023-04-08 20:11:28.000000 XlsxWriter-3.1.0/xlsxwriter/format.py
+-rw-r--r--   0 John       (501) staff       (20)     4522 2023-03-11 13:44:27.000000 XlsxWriter-3.1.0/xlsxwriter/metadata.py
+-rw-r--r--   0 John       (501) staff       (20)    23444 2023-03-11 13:44:28.000000 XlsxWriter-3.1.0/xlsxwriter/packager.py
+-rw-r--r--   0 John       (501) staff       (20)     3530 2023-03-11 13:44:27.000000 XlsxWriter-3.1.0/xlsxwriter/relationships.py
+-rw-r--r--   0 John       (501) staff       (20)    12877 2023-03-11 13:44:27.000000 XlsxWriter-3.1.0/xlsxwriter/shape.py
+-rw-r--r--   0 John       (501) staff       (20)     4731 2023-03-11 13:44:27.000000 XlsxWriter-3.1.0/xlsxwriter/sharedstrings.py
+-rw-r--r--   0 John       (501) staff       (20)    23162 2023-04-09 19:26:22.000000 XlsxWriter-3.1.0/xlsxwriter/styles.py
+-rw-r--r--   0 John       (501) staff       (20)     5427 2023-03-11 13:44:27.000000 XlsxWriter-3.1.0/xlsxwriter/table.py
+-rw-r--r--   0 John       (501) staff       (20)     8844 2023-03-11 13:44:37.000000 XlsxWriter-3.1.0/xlsxwriter/theme.py
+-rw-r--r--   0 John       (501) staff       (20)    28523 2023-03-11 13:44:39.000000 XlsxWriter-3.1.0/xlsxwriter/utility.py
+-rw-r--r--   0 John       (501) staff       (20)    19651 2023-03-11 13:44:38.000000 XlsxWriter-3.1.0/xlsxwriter/vml.py
+-rw-r--r--   0 John       (501) staff       (20)    64867 2023-03-11 13:44:39.000000 XlsxWriter-3.1.0/xlsxwriter/workbook.py
+-rw-r--r--   0 John       (501) staff       (20)   281588 2023-03-11 13:44:45.000000 XlsxWriter-3.1.0/xlsxwriter/worksheet.py
+-rw-r--r--   0 John       (501) staff       (20)     6723 2023-03-11 13:44:38.000000 XlsxWriter-3.1.0/xlsxwriter/xmlwriter.py
```

### Comparing `XlsxWriter-3.0.9/Changes` & `XlsxWriter-3.1.0/Changes`

 * *Files 0% similar despite different names*

```diff
@@ -1,8 +1,14 @@
 
+Release 3.1.0 - April 13 2023
+-----------------------------
+
+* Minor fix for cell color issue.
+
+
 Release 3.0.9 - March 10 2023
 -----------------------------
 
 * Add documentation and examples on :ref:`ewx_polars` to demonstrate new `Polars
   <https://www.pola.rs>`_ integration of XlsxWriter in `write_excel()`_.
 
 .. _write_excel(): https://pola-rs.github.io/polars/py-polars/html/reference/api/polars.DataFrame.write_excel.html#polars.DataFrame.write_excel
```

### Comparing `XlsxWriter-3.0.9/LICENSE.txt` & `XlsxWriter-3.1.0/LICENSE.txt`

 * *Files identical despite different names*

### Comparing `XlsxWriter-3.0.9/PKG-INFO` & `XlsxWriter-3.1.0/PKG-INFO`

 * *Files 4% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 1.2
 Name: XlsxWriter
-Version: 3.0.9
+Version: 3.1.0
 Summary: A Python module for creating Excel XLSX files.
 Home-page: https://github.com/jmcnamara/XlsxWriter
 Author: John McNamara
 Author-email: jmcnamara@cpan.org
 License: BSD-2-Clause
 Description: XlsxWriter
         ==========
```

### Comparing `XlsxWriter-3.0.9/README.rst` & `XlsxWriter-3.1.0/README.rst`

 * *Files identical despite different names*

### Comparing `XlsxWriter-3.0.9/XlsxWriter.egg-info/PKG-INFO` & `XlsxWriter-3.1.0/XlsxWriter.egg-info/PKG-INFO`

 * *Files 4% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 1.2
 Name: XlsxWriter
-Version: 3.0.9
+Version: 3.1.0
 Summary: A Python module for creating Excel XLSX files.
 Home-page: https://github.com/jmcnamara/XlsxWriter
 Author: John McNamara
 Author-email: jmcnamara@cpan.org
 License: BSD-2-Clause
 Description: XlsxWriter
         ==========
```

### Comparing `XlsxWriter-3.0.9/XlsxWriter.egg-info/SOURCES.txt` & `XlsxWriter-3.1.0/XlsxWriter.egg-info/SOURCES.txt`

 * *Files identical despite different names*

### Comparing `XlsxWriter-3.0.9/docs/_static/basic.css` & `XlsxWriter-3.1.0/docs/_static/basic.css`

 * *Files identical despite different names*

### Comparing `XlsxWriter-3.0.9/docs/_static/default.css` & `XlsxWriter-3.1.0/docs/_static/default.css`

 * *Files identical despite different names*

### Comparing `XlsxWriter-3.0.9/docs/_static/hello01.png` & `XlsxWriter-3.1.0/docs/_static/hello01.png`

 * *Files identical despite different names*

### Comparing `XlsxWriter-3.0.9/docs/_static/logo.png` & `XlsxWriter-3.1.0/docs/_static/logo.png`

 * *Files identical despite different names*

### Comparing `XlsxWriter-3.0.9/docs/_static/pygments.css` & `XlsxWriter-3.1.0/docs/_static/pygments.css`

 * *Files identical despite different names*

### Comparing `XlsxWriter-3.0.9/docs/readme.html` & `XlsxWriter-3.1.0/docs/readme.html`

 * *Files identical despite different names*

### Comparing `XlsxWriter-3.0.9/examples/autofilter.py` & `XlsxWriter-3.1.0/examples/autofilter.py`

 * *Files 12% similar despite different names*

```diff
@@ -7,30 +7,30 @@
 # simple criteria so that some data is shown and some is hidden.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('autofilter.xlsx')
+workbook = xlsxwriter.Workbook("autofilter.xlsx")
 
 # Add a worksheet for each autofilter example.
 worksheet1 = workbook.add_worksheet()
 worksheet2 = workbook.add_worksheet()
 worksheet3 = workbook.add_worksheet()
 worksheet4 = workbook.add_worksheet()
 worksheet5 = workbook.add_worksheet()
 worksheet6 = workbook.add_worksheet()
 worksheet7 = workbook.add_worksheet()
 
 # Add a bold format for the headers.
-bold = workbook.add_format({'bold': 1})
+bold = workbook.add_format({"bold": 1})
 
 # Open a text file with autofilter example data.
-textfile = open('autofilter_data.txt')
+textfile = open("autofilter_data.txt")
 
 # Read the headers from the first line of the input file.
 headers = textfile.readline().strip("\n").split()
 
 
 # Read the text file and store the field data.
 data = []
@@ -45,33 +45,33 @@
         except ValueError:
             pass
 
     data.append(row_data)
 
 
 # Set up several sheets with the same data.
-for worksheet in (workbook.worksheets()):
+for worksheet in workbook.worksheets():
     # Make the columns wider.
-    worksheet.set_column('A:D', 12)
+    worksheet.set_column("A:D", 12)
     # Make the header row larger.
     worksheet.set_row(0, 20, bold)
     # Make the headers bold.
-    worksheet.write_row('A1', headers)
+    worksheet.write_row("A1", headers)
 
 
 ###############################################################################
 #
 # Example 1. Autofilter without conditions.
 #
 
 # Set the autofilter.
-worksheet1.autofilter('A1:D51')
+worksheet1.autofilter("A1:D51")
 
 row = 1
-for row_data in (data):
+for row_data in data:
     worksheet1.write_row(row, 0, row_data)
 
     # Move on to the next worksheet row.
     row += 1
 
 
 ###############################################################################
@@ -81,123 +81,123 @@
 #
 
 # Autofilter range using Row-Column notation.
 worksheet2.autofilter(0, 0, 50, 3)
 
 # Add filter criteria. The placeholder "Region" in the filter is
 # ignored and can be any string that adds clarity to the expression.
-worksheet2.filter_column(0, 'Region == East')
+worksheet2.filter_column(0, "Region == East")
 
 # Hide the rows that don't match the filter criteria.
 row = 1
-for row_data in (data):
+for row_data in data:
     region = row_data[0]
 
     # Check for rows that match the filter.
-    if region == 'East':
+    if region == "East":
         # Row matches the filter, no further action required.
         pass
     else:
         # We need to hide rows that don't match the filter.
-        worksheet2.set_row(row, options={'hidden': True})
+        worksheet2.set_row(row, options={"hidden": True})
 
     worksheet2.write_row(row, 0, row_data)
 
     # Move on to the next worksheet row.
     row += 1
 
 
 ###############################################################################
 #
 #
 # Example 3. Autofilter with a dual filter condition in one of the columns.
 #
 
 # Set the autofilter.
-worksheet3.autofilter('A1:D51')
+worksheet3.autofilter("A1:D51")
 
 # Add filter criteria.
-worksheet3.filter_column('A', 'x == East or x == South')
+worksheet3.filter_column("A", "x == East or x == South")
 
 # Hide the rows that don't match the filter criteria.
 row = 1
-for row_data in (data):
+for row_data in data:
     region = row_data[0]
 
     # Check for rows that match the filter.
-    if region == 'East' or region == 'South':
+    if region == "East" or region == "South":
         # Row matches the filter, no further action required.
         pass
     else:
         # We need to hide rows that don't match the filter.
-        worksheet3.set_row(row, options={'hidden': True})
+        worksheet3.set_row(row, options={"hidden": True})
 
     worksheet3.write_row(row, 0, row_data)
 
     # Move on to the next worksheet row.
     row += 1
 
 
 ###############################################################################
 #
 #
 # Example 4. Autofilter with filter conditions in two columns.
 #
 
 # Set the autofilter.
-worksheet4.autofilter('A1:D51')
+worksheet4.autofilter("A1:D51")
 
 # Add filter criteria.
-worksheet4.filter_column('A', 'x == East')
-worksheet4.filter_column('C', 'x > 3000 and x < 8000')
+worksheet4.filter_column("A", "x == East")
+worksheet4.filter_column("C", "x > 3000 and x < 8000")
 
 # Hide the rows that don't match the filter criteria.
 row = 1
-for row_data in (data):
+for row_data in data:
     region = row_data[0]
     volume = int(row_data[2])
 
     # Check for rows that match the filter.
-    if region == 'East' and volume > 3000 and volume < 8000:
+    if region == "East" and volume > 3000 and volume < 8000:
         # Row matches the filter, no further action required.
         pass
     else:
         # We need to hide rows that don't match the filter.
-        worksheet4.set_row(row, options={'hidden': True})
+        worksheet4.set_row(row, options={"hidden": True})
 
     worksheet4.write_row(row, 0, row_data)
 
     # Move on to the next worksheet row.
     row += 1
 
 
 ###############################################################################
 #
 #
 # Example 5. Autofilter with a filter list condition in one of the columns.
 #
 
 # Set the autofilter.
-worksheet5.autofilter('A1:D51')
+worksheet5.autofilter("A1:D51")
 
 # Add filter criteria.
-worksheet5.filter_column_list('A', ['East', 'North', 'South'])
+worksheet5.filter_column_list("A", ["East", "North", "South"])
 
 # Hide the rows that don't match the filter criteria.
 row = 1
-for row_data in (data):
+for row_data in data:
     region = row_data[0]
 
     # Check for rows that match the filter.
-    if region == 'East' or region == 'North' or region == 'South':
+    if region == "East" or region == "North" or region == "South":
         # Row matches the filter, no further action required.
         pass
     else:
         # We need to hide rows that don't match the filter.
-        worksheet5.set_row(row, options={'hidden': True})
+        worksheet5.set_row(row, options={"hidden": True})
 
     worksheet5.write_row(row, 0, row_data)
 
     # Move on to the next worksheet row.
     row += 1
 
 
@@ -205,65 +205,65 @@
 #
 #
 # Example 6. Autofilter with filter for blanks.
 #
 # Create a blank cell in our test data.
 
 # Set the autofilter.
-worksheet6.autofilter('A1:D51')
+worksheet6.autofilter("A1:D51")
 
 # Add filter criteria.
-worksheet6.filter_column('A', 'x == Blanks')
+worksheet6.filter_column("A", "x == Blanks")
 
 # Simulate a blank cell in the data.
-data[5][0] = ''
+data[5][0] = ""
 
 # Hide the rows that don't match the filter criteria.
 row = 1
-for row_data in (data):
+for row_data in data:
     region = row_data[0]
 
     # Check for rows that match the filter.
-    if region == '':
+    if region == "":
         # Row matches the filter, no further action required.
         pass
     else:
         # We need to hide rows that don't match the filter.
-        worksheet6.set_row(row, options={'hidden': True})
+        worksheet6.set_row(row, options={"hidden": True})
 
     worksheet6.write_row(row, 0, row_data)
 
     # Move on to the next worksheet row.
     row += 1
 
 
 ###############################################################################
 #
 #
 # Example 7. Autofilter with filter for non-blanks.
 #
 
 # Set the autofilter.
-worksheet7.autofilter('A1:D51')
+worksheet7.autofilter("A1:D51")
 
 # Add filter criteria.
-worksheet7.filter_column('A', 'x == NonBlanks')
+worksheet7.filter_column("A", "x == NonBlanks")
 
 # Hide the rows that don't match the filter criteria.
 row = 1
-for row_data in (data):
+for row_data in data:
     region = row_data[0]
 
     # Check for rows that match the filter.
-    if region != '':
+    if region != "":
         # Row matches the filter, no further action required.
         pass
     else:
         # We need to hide rows that don't match the filter.
-        worksheet7.set_row(row, options={'hidden': True})
+        worksheet7.set_row(row, options={"hidden": True})
 
     worksheet7.write_row(row, 0, row_data)
 
     # Move on to the next worksheet row.
     row += 1
```

### Comparing `XlsxWriter-3.0.9/examples/autofilter_data.txt` & `XlsxWriter-3.1.0/examples/autofilter_data.txt`

 * *Files identical despite different names*

### Comparing `XlsxWriter-3.0.9/examples/autofit.py` & `XlsxWriter-3.1.0/examples/autofit.py`

 * *Files 12% similar despite different names*

```diff
@@ -4,15 +4,15 @@
 # worksheet columns based on the data in the cells.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 from xlsxwriter.workbook import Workbook
 
-workbook = Workbook('autofit.xlsx')
+workbook = Workbook("autofit.xlsx")
 worksheet = workbook.add_worksheet()
 
 # Write some worksheet data to demonstrate autofitting.
 worksheet.write(0, 0, "Foo")
 worksheet.write(1, 0, "Food")
 worksheet.write(2, 0, "Foody")
 worksheet.write(3, 0, "Froody")
```

### Comparing `XlsxWriter-3.0.9/examples/cell_indentation.py` & `XlsxWriter-3.1.0/examples/cell_indentation.py`

 * *Files 22% similar despite different names*

```diff
@@ -5,20 +5,20 @@
 # This program demonstrates the indentation cell format.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('cell_indentation.xlsx')
+workbook = xlsxwriter.Workbook("cell_indentation.xlsx")
 
 worksheet = workbook.add_worksheet()
 
-indent1 = workbook.add_format({'indent': 1})
-indent2 = workbook.add_format({'indent': 2})
+indent1 = workbook.add_format({"indent": 1})
+indent2 = workbook.add_format({"indent": 2})
 
-worksheet.set_column('A:A', 40)
+worksheet.set_column("A:A", 40)
 
-worksheet.write('A1', "This text is indented 1 level", indent1)
-worksheet.write('A2', "This text is indented 2 levels", indent2)
+worksheet.write("A1", "This text is indented 1 level", indent1)
+worksheet.write("A2", "This text is indented 2 levels", indent2)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/chart_area.py` & `XlsxWriter-3.1.0/examples/chart_combined.py`

 * *Files 26% similar despite different names*

```diff
@@ -1,120 +1,116 @@
 #######################################################################
 #
-# An example of creating Excel Area charts with Python and XlsxWriter.
+# An example of a Combined chart in XlsxWriter.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
-import xlsxwriter
+from xlsxwriter.workbook import Workbook
 
-workbook = xlsxwriter.Workbook('chart_area.xlsx')
+workbook = Workbook("chart_combined.xlsx")
 worksheet = workbook.add_worksheet()
-bold = workbook.add_format({'bold': 1})
+
+# Add a format for the headings.
+bold = workbook.add_format({"bold": True})
 
 # Add the worksheet data that the charts will refer to.
-headings = ['Number', 'Batch 1', 'Batch 2']
+headings = ["Number", "Batch 1", "Batch 2"]
 data = [
     [2, 3, 4, 5, 6, 7],
-    [40, 40, 50, 30, 25, 50],
-    [30, 25, 30, 10, 5, 10],
+    [10, 40, 50, 20, 10, 50],
+    [30, 60, 70, 50, 40, 30],
 ]
 
-worksheet.write_row('A1', headings, bold)
-worksheet.write_column('A2', data[0])
-worksheet.write_column('B2', data[1])
-worksheet.write_column('C2', data[2])
-
-#######################################################################
-#
-# Create an area chart.
-#
-chart1 = workbook.add_chart({'type': 'area'})
-
-# Configure the first series.
-chart1.add_series({
-    'name':       '=Sheet1!$B$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
-
-# Configure a second series. Note use of alternative syntax to define ranges.
-chart1.add_series({
-    'name':       ['Sheet1', 0, 2],
-    'categories': ['Sheet1', 1, 0, 6, 0],
-    'values':     ['Sheet1', 1, 2, 6, 2],
-})
-
-# Add a chart title and some axis labels.
-chart1.set_title ({'name': 'Results of sample analysis'})
-chart1.set_x_axis({'name': 'Test number'})
-chart1.set_y_axis({'name': 'Sample length (mm)'})
-
-# Set an Excel chart style.
-chart1.set_style(11)
-
-# Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D2', chart1, {'x_offset': 25, 'y_offset': 10})
-
-#######################################################################
-#
-# Create a stacked area chart sub-type.
-#
-chart2 = workbook.add_chart({'type': 'area', 'subtype': 'stacked'})
-
-# Configure the first series.
-chart2.add_series({
-    'name':       '=Sheet1!$B$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
-
-# Configure second series.
-chart2.add_series({
-    'name':       '=Sheet1!$C$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$C$2:$C$7',
-})
-
-# Add a chart title and some axis labels.
-chart2.set_title ({'name': 'Stacked Chart'})
-chart2.set_x_axis({'name': 'Test number'})
-chart2.set_y_axis({'name': 'Sample length (mm)'})
-
-# Set an Excel chart style.
-chart2.set_style(12)
-
-# Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D18', chart2, {'x_offset': 25, 'y_offset': 10})
-
-#######################################################################
-#
-# Create a percent stacked area chart sub-type.
-#
-chart3 = workbook.add_chart({'type': 'area', 'subtype': 'percent_stacked'})
+worksheet.write_row("A1", headings, bold)
+worksheet.write_column("A2", data[0])
+worksheet.write_column("B2", data[1])
+worksheet.write_column("C2", data[2])
+
+#
+# In the first example we will create a combined column and line chart.
+# They will share the same X and Y axes.
+#
+
+# Create a new column chart. This will use this as the primary chart.
+column_chart1 = workbook.add_chart({"type": "column"})
+
+# Configure the data series for the primary chart.
+column_chart1.add_series(
+    {
+        "name": "=Sheet1!$B$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
+
+# Create a new column chart. This will use this as the secondary chart.
+line_chart1 = workbook.add_chart({"type": "line"})
+
+# Configure the data series for the secondary chart.
+line_chart1.add_series(
+    {
+        "name": "=Sheet1!$C$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+    }
+)
+
+# Combine the charts.
+column_chart1.combine(line_chart1)
+
+# Add a chart title and some axis labels. Note, this is done via the
+# primary chart.
+column_chart1.set_title({"name": "Combined chart - same Y axis"})
+column_chart1.set_x_axis({"name": "Test number"})
+column_chart1.set_y_axis({"name": "Sample length (mm)"})
+
+# Insert the chart into the worksheet
+worksheet.insert_chart("E2", column_chart1)
+
+#
+# In the second example we will create a similar combined column and line
+# chart except that the secondary chart will have a secondary Y axis.
+#
+
+# Create a new column chart. This will use this as the primary chart.
+column_chart2 = workbook.add_chart({"type": "column"})
+
+# Configure the data series for the primary chart.
+column_chart2.add_series(
+    {
+        "name": "=Sheet1!$B$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
+
+# Create a new column chart. This will use this as the secondary chart.
+line_chart2 = workbook.add_chart({"type": "line"})
+
+# Configure the data series for the secondary chart. We also set a
+# secondary Y axis via (y2_axis). This is the only difference between
+# this and the first example, apart from the axis label below.
+line_chart2.add_series(
+    {
+        "name": "=Sheet1!$C$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+        "y2_axis": True,
+    }
+)
 
-# Configure the first series.
-chart3.add_series({
-    'name':       '=Sheet1!$B$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
-
-# Configure second series.
-chart3.add_series({
-    'name':       '=Sheet1!$C$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$C$2:$C$7',
-})
+# Combine the charts.
+column_chart2.combine(line_chart2)
 
 # Add a chart title and some axis labels.
-chart3.set_title ({'name': 'Percent Stacked Chart'})
-chart3.set_x_axis({'name': 'Test number'})
-chart3.set_y_axis({'name': 'Sample length (mm)'})
+column_chart2.set_title({"name": "Combine chart - secondary Y axis"})
+column_chart2.set_x_axis({"name": "Test number"})
+column_chart2.set_y_axis({"name": "Sample length (mm)"})
 
-# Set an Excel chart style.
-chart3.set_style(13)
+# Note: the y2 properties are on the secondary chart.
+line_chart2.set_y2_axis({"name": "Target length (mm)"})
 
-# Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D34', chart3, {'x_offset': 25, 'y_offset': 10})
+# Insert the chart into the worksheet
+worksheet.insert_chart("E18", column_chart2)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/chart_bar.py` & `XlsxWriter-3.1.0/examples/chart_radar.py`

 * *Files 27% similar despite different names*

```diff
@@ -1,120 +1,126 @@
 #######################################################################
 #
-# An example of creating Excel Bar charts with Python and XlsxWriter.
+# An example of creating Excel Radar charts with Python and XlsxWriter.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('chart_bar.xlsx')
+workbook = xlsxwriter.Workbook("chart_radar.xlsx")
 worksheet = workbook.add_worksheet()
-bold = workbook.add_format({'bold': 1})
+bold = workbook.add_format({"bold": 1})
 
 # Add the worksheet data that the charts will refer to.
-headings = ['Number', 'Batch 1', 'Batch 2']
+headings = ["Number", "Batch 1", "Batch 2"]
 data = [
     [2, 3, 4, 5, 6, 7],
-    [10, 40, 50, 20, 10, 50],
     [30, 60, 70, 50, 40, 30],
+    [25, 40, 50, 30, 50, 40],
 ]
 
-worksheet.write_row('A1', headings, bold)
-worksheet.write_column('A2', data[0])
-worksheet.write_column('B2', data[1])
-worksheet.write_column('C2', data[2])
+worksheet.write_row("A1", headings, bold)
+worksheet.write_column("A2", data[0])
+worksheet.write_column("B2", data[1])
+worksheet.write_column("C2", data[2])
 
 #######################################################################
 #
-# Create a new bar chart.
+# Create a new radar chart.
 #
-chart1 = workbook.add_chart({'type': 'bar'})
+chart1 = workbook.add_chart({"type": "radar"})
 
 # Configure the first series.
-chart1.add_series({
-    'name':       '=Sheet1!$B$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
-
-# Configure a second series. Note use of alternative syntax to define ranges.
-chart1.add_series({
-    'name':       ['Sheet1', 0, 2],
-    'categories': ['Sheet1', 1, 0, 6, 0],
-    'values':     ['Sheet1', 1, 2, 6, 2],
-})
-
-# Add a chart title and some axis labels.
-chart1.set_title ({'name': 'Results of sample analysis'})
-chart1.set_x_axis({'name': 'Test number'})
-chart1.set_y_axis({'name': 'Sample length (mm)'})
+chart1.add_series(
+    {
+        "name": "=Sheet1!$B$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
+
+# Configure second series. Note use of alternative syntax to define ranges.
+chart1.add_series(
+    {
+        "name": ["Sheet1", 0, 2],
+        "categories": ["Sheet1", 1, 0, 6, 0],
+        "values": ["Sheet1", 1, 2, 6, 2],
+    }
+)
+
+# Add a chart title.
+chart1.set_title({"name": "Results of sample analysis"})
 
 # Set an Excel chart style.
 chart1.set_style(11)
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D2', chart1, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D2", chart1, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
-# Create a stacked chart sub-type.
+# Create a radar chart with markers chart sub-type.
 #
-chart2 = workbook.add_chart({'type': 'bar', 'subtype': 'stacked'})
+chart2 = workbook.add_chart({"type": "radar", "subtype": "with_markers"})
 
 # Configure the first series.
-chart2.add_series({
-    'name':       '=Sheet1!$B$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
+chart2.add_series(
+    {
+        "name": "=Sheet1!$B$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
 
 # Configure second series.
-chart2.add_series({
-    'name':       '=Sheet1!$C$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$C$2:$C$7',
-})
-
-# Add a chart title and some axis labels.
-chart2.set_title ({'name': 'Stacked Chart'})
-chart2.set_x_axis({'name': 'Test number'})
-chart2.set_y_axis({'name': 'Sample length (mm)'})
+chart2.add_series(
+    {
+        "name": "=Sheet1!$C$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+    }
+)
+
+# Add a chart title.
+chart2.set_title({"name": "Radar Chart With Markers"})
 
 # Set an Excel chart style.
 chart2.set_style(12)
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D18', chart2, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D18", chart2, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
-# Create a percentage stacked chart sub-type.
+# Create a filled radar chart sub-type.
 #
-chart3 = workbook.add_chart({'type': 'bar', 'subtype': 'percent_stacked'})
+chart3 = workbook.add_chart({"type": "radar", "subtype": "filled"})
 
 # Configure the first series.
-chart3.add_series({
-    'name':       '=Sheet1!$B$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
+chart3.add_series(
+    {
+        "name": "=Sheet1!$B$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
 
 # Configure second series.
-chart3.add_series({
-    'name':       '=Sheet1!$C$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$C$2:$C$7',
-})
-
-# Add a chart title and some axis labels.
-chart3.set_title ({'name': 'Percent Stacked Chart'})
-chart3.set_x_axis({'name': 'Test number'})
-chart3.set_y_axis({'name': 'Sample length (mm)'})
+chart3.add_series(
+    {
+        "name": "=Sheet1!$C$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+    }
+)
+
+# Add a chart title.
+chart3.set_title({"name": "Filled Radar Chart"})
 
 # Set an Excel chart style.
 chart3.set_style(13)
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D34', chart3, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D34", chart3, {"x_offset": 25, "y_offset": 10})
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/chart_clustered.py` & `XlsxWriter-3.1.0/examples/chart_clustered.py`

 * *Files 19% similar despite different names*

```diff
@@ -3,57 +3,63 @@
 # A demo of a clustered category chart in XlsxWriter.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 from xlsxwriter.workbook import Workbook
 
-workbook = Workbook('chart_clustered.xlsx')
+workbook = Workbook("chart_clustered.xlsx")
 worksheet = workbook.add_worksheet()
-bold = workbook.add_format({'bold': 1})
+bold = workbook.add_format({"bold": 1})
 
 # Add the worksheet data that the charts will refer to.
-headings = ['Types', 'Sub Type', 'Value 1', 'Value 2', 'Value 3']
+headings = ["Types", "Sub Type", "Value 1", "Value 2", "Value 3"]
 data = [
-    ['Type 1', 'Sub Type A', 5000,      8000,      6000],
-    ['',       'Sub Type B', 2000,      3000,      4000],
-    ['',       'Sub Type C', 250,       1000,      2000],
-    ['Type 2', 'Sub Type D', 6000,      6000,      6500],
-    ['',       'Sub Type E', 500,       300,        200],
+    ["Type 1", "Sub Type A", 5000, 8000, 6000],
+    ["", "Sub Type B", 2000, 3000, 4000],
+    ["", "Sub Type C", 250, 1000, 2000],
+    ["Type 2", "Sub Type D", 6000, 6000, 6500],
+    ["", "Sub Type E", 500, 300, 200],
 ]
 
-worksheet.write_row('A1', headings, bold)
+worksheet.write_row("A1", headings, bold)
 
 for row_num, row_data in enumerate(data):
     worksheet.write_row(row_num + 1, 0, row_data)
 
 # Create a new chart object. In this case an embedded chart.
-chart = workbook.add_chart({'type': 'column'})
+chart = workbook.add_chart({"type": "column"})
 
 # Configure the series. Note, that the categories are 2D ranges (from column A
 # to column B). This creates the clusters. The series are shown as formula
 # strings for clarity but you can also use the list syntax. See the docs.
-chart.add_series({
-    'categories': '=Sheet1!$A$2:$B$6',
-    'values':     '=Sheet1!$C$2:$C$6',
-})
-
-chart.add_series({
-    'categories': '=Sheet1!$A$2:$B$6',
-    'values':     '=Sheet1!$D$2:$D$6',
-})
-
-chart.add_series({
-    'categories': '=Sheet1!$A$2:$B$6',
-    'values':     '=Sheet1!$E$2:$E$6',
-})
+chart.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$B$6",
+        "values": "=Sheet1!$C$2:$C$6",
+    }
+)
+
+chart.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$B$6",
+        "values": "=Sheet1!$D$2:$D$6",
+    }
+)
+
+chart.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$B$6",
+        "values": "=Sheet1!$E$2:$E$6",
+    }
+)
 
 # Set the Excel chart style.
 chart.set_style(37)
 
 # Turn off the legend.
-chart.set_legend({'position': 'none'})
+chart.set_legend({"position": "none"})
 
 # Insert the chart into the worksheet.
-worksheet.insert_chart('G3', chart)
+worksheet.insert_chart("G3", chart)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/chart_column.py` & `XlsxWriter-3.1.0/examples/chart_column.py`

 * *Files 22% similar despite different names*

```diff
@@ -3,118 +3,130 @@
 # An example of creating Excel Column charts with Python and XlsxWriter.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('chart_column.xlsx')
+workbook = xlsxwriter.Workbook("chart_column.xlsx")
 worksheet = workbook.add_worksheet()
-bold = workbook.add_format({'bold': 1})
+bold = workbook.add_format({"bold": 1})
 
 # Add the worksheet data that the charts will refer to.
-headings = ['Number', 'Batch 1', 'Batch 2']
+headings = ["Number", "Batch 1", "Batch 2"]
 data = [
     [2, 3, 4, 5, 6, 7],
     [10, 40, 50, 20, 10, 50],
     [30, 60, 70, 50, 40, 30],
 ]
 
-worksheet.write_row('A1', headings, bold)
-worksheet.write_column('A2', data[0])
-worksheet.write_column('B2', data[1])
-worksheet.write_column('C2', data[2])
+worksheet.write_row("A1", headings, bold)
+worksheet.write_column("A2", data[0])
+worksheet.write_column("B2", data[1])
+worksheet.write_column("C2", data[2])
 
 #######################################################################
 #
 # Create a new column chart.
 #
-chart1 = workbook.add_chart({'type': 'column'})
+chart1 = workbook.add_chart({"type": "column"})
 
 # Configure the first series.
-chart1.add_series({
-    'name':       '=Sheet1!$B$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
+chart1.add_series(
+    {
+        "name": "=Sheet1!$B$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
 
 # Configure a second series. Note use of alternative syntax to define ranges.
-chart1.add_series({
-    'name':       ['Sheet1', 0, 2],
-    'categories': ['Sheet1', 1, 0, 6, 0],
-    'values':     ['Sheet1', 1, 2, 6, 2],
-})
+chart1.add_series(
+    {
+        "name": ["Sheet1", 0, 2],
+        "categories": ["Sheet1", 1, 0, 6, 0],
+        "values": ["Sheet1", 1, 2, 6, 2],
+    }
+)
 
 # Add a chart title and some axis labels.
-chart1.set_title ({'name': 'Results of sample analysis'})
-chart1.set_x_axis({'name': 'Test number'})
-chart1.set_y_axis({'name': 'Sample length (mm)'})
+chart1.set_title({"name": "Results of sample analysis"})
+chart1.set_x_axis({"name": "Test number"})
+chart1.set_y_axis({"name": "Sample length (mm)"})
 
 # Set an Excel chart style.
 chart1.set_style(11)
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D2', chart1, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D2", chart1, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Create a stacked chart sub-type.
 #
-chart2 = workbook.add_chart({'type': 'column', 'subtype': 'stacked'})
+chart2 = workbook.add_chart({"type": "column", "subtype": "stacked"})
 
 # Configure the first series.
-chart2.add_series({
-    'name':       '=Sheet1!$B$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
+chart2.add_series(
+    {
+        "name": "=Sheet1!$B$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
 
 # Configure second series.
-chart2.add_series({
-    'name':       '=Sheet1!$C$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$C$2:$C$7',
-})
+chart2.add_series(
+    {
+        "name": "=Sheet1!$C$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+    }
+)
 
 # Add a chart title and some axis labels.
-chart2.set_title ({'name': 'Stacked Chart'})
-chart2.set_x_axis({'name': 'Test number'})
-chart2.set_y_axis({'name': 'Sample length (mm)'})
+chart2.set_title({"name": "Stacked Chart"})
+chart2.set_x_axis({"name": "Test number"})
+chart2.set_y_axis({"name": "Sample length (mm)"})
 
 # Set an Excel chart style.
 chart2.set_style(12)
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D18', chart2, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D18", chart2, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Create a percentage stacked chart sub-type.
 #
-chart3 = workbook.add_chart({'type': 'column', 'subtype': 'percent_stacked'})
+chart3 = workbook.add_chart({"type": "column", "subtype": "percent_stacked"})
 
 # Configure the first series.
-chart3.add_series({
-    'name':       '=Sheet1!$B$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
+chart3.add_series(
+    {
+        "name": "=Sheet1!$B$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
 
 # Configure second series.
-chart3.add_series({
-    'name':       '=Sheet1!$C$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$C$2:$C$7',
-})
+chart3.add_series(
+    {
+        "name": "=Sheet1!$C$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+    }
+)
 
 # Add a chart title and some axis labels.
-chart3.set_title ({'name': 'Percent Stacked Chart'})
-chart3.set_x_axis({'name': 'Test number'})
-chart3.set_y_axis({'name': 'Sample length (mm)'})
+chart3.set_title({"name": "Percent Stacked Chart"})
+chart3.set_x_axis({"name": "Test number"})
+chart3.set_y_axis({"name": "Sample length (mm)"})
 
 # Set an Excel chart style.
 chart3.set_style(13)
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D34', chart3, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D34", chart3, {"x_offset": 25, "y_offset": 10})
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/chart_combined.py` & `XlsxWriter-3.1.0/examples/chart_data_table.py`

 * *Files 24% similar despite different names*

```diff
@@ -1,108 +1,102 @@
 #######################################################################
 #
-# An example of a Combined chart in XlsxWriter.
+# An example of creating Excel Column charts with data tables using
+# Python and XlsxWriter.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
-from xlsxwriter.workbook import Workbook
+import xlsxwriter
 
-workbook  = Workbook('chart_combined.xlsx')
+workbook = xlsxwriter.Workbook("chart_data_table.xlsx")
 worksheet = workbook.add_worksheet()
-
-# Add a format for the headings.
-bold = workbook.add_format({'bold': True})
+bold = workbook.add_format({"bold": 1})
 
 # Add the worksheet data that the charts will refer to.
-headings = ['Number', 'Batch 1', 'Batch 2']
+headings = ["Number", "Batch 1", "Batch 2"]
 data = [
     [2, 3, 4, 5, 6, 7],
     [10, 40, 50, 20, 10, 50],
     [30, 60, 70, 50, 40, 30],
 ]
 
-worksheet.write_row('A1', headings, bold)
-worksheet.write_column('A2', data[0])
-worksheet.write_column('B2', data[1])
-worksheet.write_column('C2', data[2])
-
-#
-# In the first example we will create a combined column and line chart.
-# They will share the same X and Y axes.
-#
-
-# Create a new column chart. This will use this as the primary chart.
-column_chart1 = workbook.add_chart({'type': 'column'})
-
-# Configure the data series for the primary chart.
-column_chart1.add_series({
-    'name':       '=Sheet1!$B$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
-
-# Create a new column chart. This will use this as the secondary chart.
-line_chart1 = workbook.add_chart({'type': 'line'})
-
-# Configure the data series for the secondary chart.
-line_chart1.add_series({
-    'name':       '=Sheet1!$C$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$C$2:$C$7',
-})
-
-# Combine the charts.
-column_chart1.combine(line_chart1)
-
-# Add a chart title and some axis labels. Note, this is done via the
-# primary chart.
-column_chart1.set_title({ 'name': 'Combined chart - same Y axis'})
-column_chart1.set_x_axis({'name': 'Test number'})
-column_chart1.set_y_axis({'name': 'Sample length (mm)'})
-
-# Insert the chart into the worksheet
-worksheet.insert_chart('E2', column_chart1)
-
-#
-# In the second example we will create a similar combined column and line
-# chart except that the secondary chart will have a secondary Y axis.
-#
-
-# Create a new column chart. This will use this as the primary chart.
-column_chart2 = workbook.add_chart({'type': 'column'})
-
-# Configure the data series for the primary chart.
-column_chart2.add_series({
-    'name':       '=Sheet1!$B$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
-
-# Create a new column chart. This will use this as the secondary chart.
-line_chart2 = workbook.add_chart({'type': 'line'})
-
-# Configure the data series for the secondary chart. We also set a
-# secondary Y axis via (y2_axis). This is the only difference between
-# this and the first example, apart from the axis label below.
-line_chart2.add_series({
-    'name':       '=Sheet1!$C$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$C$2:$C$7',
-    'y2_axis':    True,
-})
+worksheet.write_row("A1", headings, bold)
+worksheet.write_column("A2", data[0])
+worksheet.write_column("B2", data[1])
+worksheet.write_column("C2", data[2])
+
+
+#######################################################################
+#
+# Create a column chart with a data table.
+#
+chart1 = workbook.add_chart({"type": "column"})
+
+# Configure the first series.
+chart1.add_series(
+    {
+        "name": "=Sheet1!$B$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
+
+# Configure second series. Note use of alternative syntax to define ranges.
+chart1.add_series(
+    {
+        "name": ["Sheet1", 0, 2],
+        "categories": ["Sheet1", 1, 0, 6, 0],
+        "values": ["Sheet1", 1, 2, 6, 2],
+    }
+)
+
+# Add a chart title and some axis labels.
+chart1.set_title({"name": "Chart with Data Table"})
+chart1.set_x_axis({"name": "Test number"})
+chart1.set_y_axis({"name": "Sample length (mm)"})
+
+# Set a default data table on the X-Axis.
+chart1.set_table()
+
+# Insert the chart into the worksheet (with an offset).
+worksheet.insert_chart("D2", chart1, {"x_offset": 25, "y_offset": 10})
+
+#######################################################################
+#
+# Create a column chart with a data table and legend keys.
+#
+chart2 = workbook.add_chart({"type": "column"})
 
-# Combine the charts.
-column_chart2.combine(line_chart2)
+# Configure the first series.
+chart2.add_series(
+    {
+        "name": "=Sheet1!$B$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
+
+# Configure second series.
+chart2.add_series(
+    {
+        "name": "=Sheet1!$C$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+    }
+)
 
 # Add a chart title and some axis labels.
-column_chart2.set_title({  'name': 'Combine chart - secondary Y axis'})
-column_chart2.set_x_axis({ 'name': 'Test number'})
-column_chart2.set_y_axis({ 'name': 'Sample length (mm)'})
+chart2.set_title({"name": "Data Table with legend keys"})
+chart2.set_x_axis({"name": "Test number"})
+chart2.set_y_axis({"name": "Sample length (mm)"})
+
+# Set a data table on the X-Axis with the legend keys shown.
+chart2.set_table({"show_keys": True})
 
-# Note: the y2 properties are on the secondary chart.
-line_chart2.set_y2_axis({'name': 'Target length (mm)'})
+# Hide the chart legend since the keys are shown on the data table.
+chart2.set_legend({"position": "none"})
 
-# Insert the chart into the worksheet
-worksheet.insert_chart('E18', column_chart2)
+# Insert the chart into the worksheet (with an offset).
+worksheet.insert_chart("D18", chart2, {"x_offset": 25, "y_offset": 10})
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/chart_data_labels.py` & `XlsxWriter-3.1.0/examples/chart_data_labels.py`

 * *Files 16% similar despite different names*

```diff
@@ -4,303 +4,324 @@
 # via an XlsxWriter chart.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('chart_data_labels.xlsx')
+workbook = xlsxwriter.Workbook("chart_data_labels.xlsx")
 worksheet = workbook.add_worksheet()
-bold = workbook.add_format({'bold': 1})
+bold = workbook.add_format({"bold": 1})
 
 # Add the worksheet data that the charts will refer to.
-headings = ['Number', 'Data', 'Text']
+headings = ["Number", "Data", "Text"]
 
 data = [
     [2, 3, 4, 5, 6, 7],
     [20, 10, 20, 30, 40, 30],
-    ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
+    ["Jan", "Feb", "Mar", "Apr", "May", "Jun"],
 ]
 
-worksheet.write_row('A1', headings, bold)
-worksheet.write_column('A2', data[0])
-worksheet.write_column('B2', data[1])
-worksheet.write_column('C2', data[2])
+worksheet.write_row("A1", headings, bold)
+worksheet.write_column("A2", data[0])
+worksheet.write_column("B2", data[1])
+worksheet.write_column("C2", data[2])
 
 #######################################################################
 #
 # Example with standard data labels.
 #
 
 # Create a Column chart.
-chart1 = workbook.add_chart({'type': 'column'})
+chart1 = workbook.add_chart({"type": "column"})
 
 # Configure the data series and add the data labels.
-chart1.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-    'data_labels': {'value': True},
-})
+chart1.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+        "data_labels": {"value": True},
+    }
+)
 
 # Add a chart title.
-chart1.set_title({'name': 'Chart with standard data labels'})
+chart1.set_title({"name": "Chart with standard data labels"})
 
 # Turn off the chart legend.
-chart1.set_legend({'none': True})
+chart1.set_legend({"none": True})
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D2', chart1, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D2", chart1, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Example with value and category data labels.
 #
 
 # Create a Column chart.
-chart2 = workbook.add_chart({'type': 'column'})
+chart2 = workbook.add_chart({"type": "column"})
 
 # Configure the data series and add the data labels.
-chart2.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-    'data_labels': {'value': True, 'category': True},
-})
+chart2.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+        "data_labels": {"value": True, "category": True},
+    }
+)
 
 # Add a chart title.
-chart2.set_title({'name': 'Category and Value data labels'})
+chart2.set_title({"name": "Category and Value data labels"})
 
 # Turn off the chart legend.
-chart2.set_legend({'none': True})
+chart2.set_legend({"none": True})
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D18', chart2, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D18", chart2, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Example with standard data labels with different font.
 #
 
 # Create a Column chart.
-chart3 = workbook.add_chart({'type': 'column'})
+chart3 = workbook.add_chart({"type": "column"})
 
 # Configure the data series and add the data labels.
-chart3.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-    'data_labels': {'value': True,
-                    'font': {'bold': True,
-                             'color': 'red',
-                             'rotation': -30}},
-})
+chart3.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+        "data_labels": {
+            "value": True,
+            "font": {"bold": True, "color": "red", "rotation": -30},
+        },
+    }
+)
 
 # Add a chart title.
-chart3.set_title({'name': 'Data labels with user defined font'})
+chart3.set_title({"name": "Data labels with user defined font"})
 
 # Turn off the chart legend.
-chart3.set_legend({'none': True})
+chart3.set_legend({"none": True})
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D34', chart3, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D34", chart3, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Example with standard data labels and formatting.
 #
 
 # Create a Column chart.
-chart4 = workbook.add_chart({'type': 'column'})
+chart4 = workbook.add_chart({"type": "column"})
 
 # Configure the data series and add the data labels.
-chart4.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-    'data_labels': {'value': True,
-                    'border': {'color': 'red'},
-                    'fill':   {'color': 'yellow'}},
-})
+chart4.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+        "data_labels": {
+            "value": True,
+            "border": {"color": "red"},
+            "fill": {"color": "yellow"},
+        },
+    }
+)
 
 # Add a chart title.
-chart4.set_title({'name': 'Data labels with formatting'})
+chart4.set_title({"name": "Data labels with formatting"})
 
 # Turn off the chart legend.
-chart4.set_legend({'none': True})
+chart4.set_legend({"none": True})
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D50', chart4, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D50", chart4, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Example with custom string data labels.
 #
 
 # Create a Column chart.
-chart5 = workbook.add_chart({'type': 'column'})
+chart5 = workbook.add_chart({"type": "column"})
 
 # Some custom labels.
 custom_labels = [
-    {'value': 'Amy'},
-    {'value': 'Bea'},
-    {'value': 'Eva'},
-    {'value': 'Fay'},
-    {'value': 'Liv'},
-    {'value': 'Una'},
+    {"value": "Amy"},
+    {"value": "Bea"},
+    {"value": "Eva"},
+    {"value": "Fay"},
+    {"value": "Liv"},
+    {"value": "Una"},
 ]
 
 # Configure the data series and add the data labels.
-chart5.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-    'data_labels': {'value': True, 'custom': custom_labels},
-})
+chart5.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+        "data_labels": {"value": True, "custom": custom_labels},
+    }
+)
 
 # Add a chart title.
-chart5.set_title({'name': 'Chart with custom string data labels'})
+chart5.set_title({"name": "Chart with custom string data labels"})
 
 # Turn off the chart legend.
-chart5.set_legend({'none': True})
+chart5.set_legend({"none": True})
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D66', chart5, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D66", chart5, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Example with custom data labels from cells.
 #
 
 # Create a Column chart.
-chart6 = workbook.add_chart({'type': 'column'})
+chart6 = workbook.add_chart({"type": "column"})
 
 # Some custom labels.
 custom_labels = [
-    {'value': '=Sheet1!$C$2'},
-    {'value': '=Sheet1!$C$3'},
-    {'value': '=Sheet1!$C$4'},
-    {'value': '=Sheet1!$C$5'},
-    {'value': '=Sheet1!$C$6'},
-    {'value': '=Sheet1!$C$7'},
+    {"value": "=Sheet1!$C$2"},
+    {"value": "=Sheet1!$C$3"},
+    {"value": "=Sheet1!$C$4"},
+    {"value": "=Sheet1!$C$5"},
+    {"value": "=Sheet1!$C$6"},
+    {"value": "=Sheet1!$C$7"},
 ]
 
 # Configure the data series and add the data labels.
-chart6.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-    'data_labels': {'value': True, 'custom': custom_labels},
-})
+chart6.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+        "data_labels": {"value": True, "custom": custom_labels},
+    }
+)
 
 # Add a chart title.
-chart6.set_title({'name': 'Chart with custom data labels from cells'})
+chart6.set_title({"name": "Chart with custom data labels from cells"})
 
 # Turn off the chart legend.
-chart6.set_legend({'none': True})
+chart6.set_legend({"none": True})
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D82', chart6, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D82", chart6, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Example with custom and default data labels.
 #
 
 # Create a Column chart.
-chart7 = workbook.add_chart({'type': 'column'})
+chart7 = workbook.add_chart({"type": "column"})
 
 # The following is used to get a mix of default and custom labels. The 'None'
 # items will get the default value. We also set a font for the custom items
 # as an extra example.
 custom_labels = [
-    {'value': '=Sheet1!$C$2', 'font': {'color': 'red'}},
+    {"value": "=Sheet1!$C$2", "font": {"color": "red"}},
     None,
-    {'value': '=Sheet1!$C$4', 'font': {'color': 'red'}},
-    {'value': '=Sheet1!$C$5', 'font': {'color': 'red'}},
+    {"value": "=Sheet1!$C$4", "font": {"color": "red"}},
+    {"value": "=Sheet1!$C$5", "font": {"color": "red"}},
 ]
 
 # Configure the data series and add the data labels.
-chart7.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-    'data_labels': {'value': True, 'custom': custom_labels},
-})
+chart7.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+        "data_labels": {"value": True, "custom": custom_labels},
+    }
+)
 
 # Add a chart title.
-chart7.set_title({'name': 'Mixed custom and default data labels'})
+chart7.set_title({"name": "Mixed custom and default data labels"})
 
 # Turn off the chart legend.
-chart7.set_legend({'none': True})
+chart7.set_legend({"none": True})
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D98', chart7, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D98", chart7, {"x_offset": 25, "y_offset": 10})
 
 
 #######################################################################
 #
 # Example with deleted custom data labels.
 #
 
 # Create a Column chart.
-chart8 = workbook.add_chart({'type': 'column'})
+chart8 = workbook.add_chart({"type": "column"})
 
 # Some deleted custom labels and defaults (set with None values). This allows
 # us to highlight certain values such as the minimum and maximum.
 custom_labels = [
-    {'delete': True},
+    {"delete": True},
     None,
-    {'delete': True},
-    {'delete': True},
+    {"delete": True},
+    {"delete": True},
     None,
-    {'delete': True},
+    {"delete": True},
 ]
 
 # Configure the data series and add the data labels.
-chart8.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-    'data_labels': {'value': True, 'custom': custom_labels},
-})
+chart8.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+        "data_labels": {"value": True, "custom": custom_labels},
+    }
+)
 
 # Add a chart title.
-chart8.set_title({'name': 'Chart with deleted data labels'})
+chart8.set_title({"name": "Chart with deleted data labels"})
 
 # Turn off the chart legend.
-chart8.set_legend({'none': True})
+chart8.set_legend({"none": True})
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D114', chart8, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D114", chart8, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Example with custom string data labels and formatting.
 #
 
 # Create a Column chart.
-chart9 = workbook.add_chart({'type': 'column'})
+chart9 = workbook.add_chart({"type": "column"})
 
 # Some custom labels.
 custom_labels = [
-    {'value': 'Amy', 'border': {'color': 'blue'}},
-    {'value': 'Bea'},
-    {'value': 'Eva'},
-    {'value': 'Fay'},
-    {'value': 'Liv'},
-    {'value': 'Una', 'fill':   {'color': 'green'}},
+    {"value": "Amy", "border": {"color": "blue"}},
+    {"value": "Bea"},
+    {"value": "Eva"},
+    {"value": "Fay"},
+    {"value": "Liv"},
+    {"value": "Una", "fill": {"color": "green"}},
 ]
 
 # Configure the data series and add the data labels.
-chart9.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-    'data_labels': {'value': True,
-                    'custom': custom_labels,
-                    'border': {'color': 'red'},
-                    'fill':   {'color': 'yellow'}},
-
-})
+chart9.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+        "data_labels": {
+            "value": True,
+            "custom": custom_labels,
+            "border": {"color": "red"},
+            "fill": {"color": "yellow"},
+        },
+    }
+)
 
 # Add a chart title.
-chart9.set_title({'name': 'Chart with custom labels and formatting'})
+chart9.set_title({"name": "Chart with custom labels and formatting"})
 
 # Turn off the chart legend.
-chart9.set_legend({'none': True})
+chart9.set_legend({"none": True})
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D130', chart9, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D130", chart9, {"x_offset": 25, "y_offset": 10})
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/chart_data_tools.py` & `XlsxWriter-3.1.0/examples/chart_data_tools.py`

 * *Files 15% similar despite different names*

```diff
@@ -7,193 +7,217 @@
 # High-Low Lines and Up-Down Bars.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('chart_data_tools.xlsx')
+workbook = xlsxwriter.Workbook("chart_data_tools.xlsx")
 worksheet = workbook.add_worksheet()
-bold = workbook.add_format({'bold': 1})
+bold = workbook.add_format({"bold": 1})
 
 # Add the worksheet data that the charts will refer to.
-headings = ['Number', 'Data 1', 'Data 2']
+headings = ["Number", "Data 1", "Data 2"]
 data = [
     [2, 3, 4, 5, 6, 7],
     [10, 40, 50, 20, 10, 50],
     [30, 60, 70, 50, 40, 30],
 ]
 
-worksheet.write_row('A1', headings, bold)
-worksheet.write_column('A2', data[0])
-worksheet.write_column('B2', data[1])
-worksheet.write_column('C2', data[2])
+worksheet.write_row("A1", headings, bold)
+worksheet.write_column("A2", data[0])
+worksheet.write_column("B2", data[1])
+worksheet.write_column("C2", data[2])
 
 
 #######################################################################
 #
 # Trendline example.
 #
 # Create a Line chart.
-chart1 = workbook.add_chart({'type': 'line'})
+chart1 = workbook.add_chart({"type": "line"})
 
 # Configure the first series with a polynomial trendline.
-chart1.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-    'trendline': {
-        'type': 'polynomial',
-        'order': 3,
-    },
-})
+chart1.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+        "trendline": {
+            "type": "polynomial",
+            "order": 3,
+        },
+    }
+)
 
 # Configure the second series with a moving average trendline.
-chart1.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$C$2:$C$7',
-    'trendline': {'type': 'linear'},
-})
+chart1.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+        "trendline": {"type": "linear"},
+    }
+)
 
 # Add a chart title.
-chart1.set_title({'name': 'Chart with Trendlines'})
+chart1.set_title({"name": "Chart with Trendlines"})
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D2', chart1, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D2", chart1, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Data Labels and Markers example.
 #
 # Create a Line chart.
-chart2 = workbook.add_chart({'type': 'line'})
+chart2 = workbook.add_chart({"type": "line"})
 
 # Configure the first series.
-chart2.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-    'data_labels': {'value': 1},
-    'marker': {'type': 'automatic'},
-})
+chart2.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+        "data_labels": {"value": 1},
+        "marker": {"type": "automatic"},
+    }
+)
 
 # Configure the second series.
-chart2.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$C$2:$C$7',
-})
+chart2.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+    }
+)
 
 # Add a chart title.
-chart2.set_title({'name': 'Chart with Data Labels and Markers'})
+chart2.set_title({"name": "Chart with Data Labels and Markers"})
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D18', chart2, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D18", chart2, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Error Bars example.
 #
 # Create a Line chart.
-chart3 = workbook.add_chart({'type': 'line'})
+chart3 = workbook.add_chart({"type": "line"})
 
 # Configure the first series.
-chart3.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-    'y_error_bars': {'type': 'standard_error'},
-})
+chart3.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+        "y_error_bars": {"type": "standard_error"},
+    }
+)
 
 # Configure the second series.
-chart3.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values': '=Sheet1!$C$2:$C$7',
-})
+chart3.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+    }
+)
 
 # Add a chart title.
-chart3.set_title({'name': 'Chart with Error Bars'})
+chart3.set_title({"name": "Chart with Error Bars"})
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D34', chart3, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D34", chart3, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Up-Down Bars example.
 #
 # Create a Line chart.
-chart4 = workbook.add_chart({'type': 'line'})
+chart4 = workbook.add_chart({"type": "line"})
 
 # Add the Up-Down Bars.
 chart4.set_up_down_bars()
 
 # Configure the first series.
-chart4.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
+chart4.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
 
 # Configure the second series.
-chart4.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$C$2:$C$7',
-})
+chart4.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+    }
+)
 
 # Add a chart title.
-chart4.set_title({'name': 'Chart with Up-Down Bars'})
+chart4.set_title({"name": "Chart with Up-Down Bars"})
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D50', chart4, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D50", chart4, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # High-Low Lines example.
 #
 # Create a Line chart.
-chart5 = workbook.add_chart({'type': 'line'})
+chart5 = workbook.add_chart({"type": "line"})
 
 # Add the High-Low lines.
 chart5.set_high_low_lines()
 
 # Configure the first series.
-chart5.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
+chart5.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
 
 # Configure the second series.
-chart5.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$C$2:$C$7',
-})
+chart5.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+    }
+)
 
 # Add a chart title.
-chart5.set_title({'name': 'Chart with High-Low Lines'})
+chart5.set_title({"name": "Chart with High-Low Lines"})
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D66', chart5, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D66", chart5, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Drop Lines example.
 #
 # Create a Line chart.
-chart6 = workbook.add_chart({'type': 'line'})
+chart6 = workbook.add_chart({"type": "line"})
 
 # Add Drop Lines.
 chart6.set_drop_lines()
 
 # Configure the first series.
-chart6.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
+chart6.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
 
 # Configure the second series.
-chart6.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$C$2:$C$7',
-})
+chart6.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+    }
+)
 
 # Add a chart title.
-chart6.set_title({'name': 'Chart with Drop Lines'})
+chart6.set_title({"name": "Chart with Drop Lines"})
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D82', chart6, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D82", chart6, {"x_offset": 25, "y_offset": 10})
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/chart_date_axis.py` & `XlsxWriter-3.1.0/examples/chart_date_axis.py`

 * *Files 7% similar despite different names*

```diff
@@ -6,54 +6,60 @@
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 
 from datetime import date
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('chart_date_axis.xlsx')
+workbook = xlsxwriter.Workbook("chart_date_axis.xlsx")
 
 worksheet = workbook.add_worksheet()
-chart = workbook.add_chart({'type': 'line'})
-date_format = workbook.add_format({'num_format': 'dd/mm/yyyy'})
+chart = workbook.add_chart({"type": "line"})
+date_format = workbook.add_format({"num_format": "dd/mm/yyyy"})
 
 # Widen the first column to display the dates.
-worksheet.set_column('A:A', 12)
+worksheet.set_column("A:A", 12)
 
 # Some data to be plotted in the worksheet.
-dates = [date(2013, 1, 1),
-         date(2013, 1, 2),
-         date(2013, 1, 3),
-         date(2013, 1, 4),
-         date(2013, 1, 5),
-         date(2013, 1, 6),
-         date(2013, 1, 7),
-         date(2013, 1, 8),
-         date(2013, 1, 9),
-         date(2013, 1, 10)]
+dates = [
+    date(2013, 1, 1),
+    date(2013, 1, 2),
+    date(2013, 1, 3),
+    date(2013, 1, 4),
+    date(2013, 1, 5),
+    date(2013, 1, 6),
+    date(2013, 1, 7),
+    date(2013, 1, 8),
+    date(2013, 1, 9),
+    date(2013, 1, 10),
+]
 
 values = [10, 30, 20, 40, 20, 60, 50, 40, 30, 30]
 
 # Write the date to the worksheet.
-worksheet.write_column('A1', dates, date_format)
-worksheet.write_column('B1', values)
+worksheet.write_column("A1", dates, date_format)
+worksheet.write_column("B1", values)
 
 # Add a series to the chart.
-chart.add_series({
-    'categories': '=Sheet1!$A$1:$A$10',
-    'values': '=Sheet1!$B$1:$B$10',
-})
+chart.add_series(
+    {
+        "categories": "=Sheet1!$A$1:$A$10",
+        "values": "=Sheet1!$B$1:$B$10",
+    }
+)
 
 # Configure the X axis as a Date axis and set the max and min limits.
-chart.set_x_axis({
-    'date_axis': True,
-    'min': date(2013, 1, 2),
-    'max': date(2013, 1, 9),
-})
+chart.set_x_axis(
+    {
+        "date_axis": True,
+        "min": date(2013, 1, 2),
+        "max": date(2013, 1, 9),
+    }
+)
 
 # Turn off the legend.
-chart.set_legend({'none': True})
+chart.set_legend({"none": True})
 
 # Insert the chart into the worksheet.
-worksheet.insert_chart('D2', chart)
+worksheet.insert_chart("D2", chart)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/chart_doughnut.py` & `XlsxWriter-3.1.0/examples/chart_doughnut.py`

 * *Files 20% similar despite different names*

```diff
@@ -9,133 +9,141 @@
 # assign formatting to each point in the series.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('chart_doughnut.xlsx')
+workbook = xlsxwriter.Workbook("chart_doughnut.xlsx")
 
 worksheet = workbook.add_worksheet()
-bold = workbook.add_format({'bold': 1})
+bold = workbook.add_format({"bold": 1})
 
 # Add the worksheet data that the charts will refer to.
-headings = ['Category', 'Values']
+headings = ["Category", "Values"]
 data = [
-    ['Glazed', 'Chocolate', 'Cream'],
+    ["Glazed", "Chocolate", "Cream"],
     [50, 35, 15],
 ]
 
-worksheet.write_row('A1', headings, bold)
-worksheet.write_column('A2', data[0])
-worksheet.write_column('B2', data[1])
+worksheet.write_row("A1", headings, bold)
+worksheet.write_column("A2", data[0])
+worksheet.write_column("B2", data[1])
 
 #######################################################################
 #
 # Create a new chart object.
 #
-chart1 = workbook.add_chart({'type': 'doughnut'})
+chart1 = workbook.add_chart({"type": "doughnut"})
 
 # Configure the series. Note the use of the list syntax to define ranges:
-chart1.add_series({
-    'name':       'Doughnut sales data',
-    'categories': ['Sheet1', 1, 0, 3, 0],
-    'values':     ['Sheet1', 1, 1, 3, 1],
-})
+chart1.add_series(
+    {
+        "name": "Doughnut sales data",
+        "categories": ["Sheet1", 1, 0, 3, 0],
+        "values": ["Sheet1", 1, 1, 3, 1],
+    }
+)
 
 # Add a title.
-chart1.set_title({'name': 'Popular Doughnut Types'})
+chart1.set_title({"name": "Popular Doughnut Types"})
 
 # Set an Excel chart style. Colors with white outline and shadow.
 chart1.set_style(10)
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('C2', chart1, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("C2", chart1, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Create a Doughnut chart with user defined segment colors.
 #
 
 # Create an example Doughnut chart like above.
-chart2 = workbook.add_chart({'type': 'doughnut'})
+chart2 = workbook.add_chart({"type": "doughnut"})
 
 # Configure the series and add user defined segment colors.
-chart2.add_series({
-    'name': 'Doughnut sales data',
-    'categories': '=Sheet1!$A$2:$A$4',
-    'values':     '=Sheet1!$B$2:$B$4',
-    'points': [
-        {'fill': {'color': '#FA58D0'}},
-        {'fill': {'color': '#61210B'}},
-        {'fill': {'color': '#F5F6CE'}},
-    ],
-})
+chart2.add_series(
+    {
+        "name": "Doughnut sales data",
+        "categories": "=Sheet1!$A$2:$A$4",
+        "values": "=Sheet1!$B$2:$B$4",
+        "points": [
+            {"fill": {"color": "#FA58D0"}},
+            {"fill": {"color": "#61210B"}},
+            {"fill": {"color": "#F5F6CE"}},
+        ],
+    }
+)
 
 # Add a title.
-chart2.set_title({'name': 'Doughnut Chart with user defined colors'})
+chart2.set_title({"name": "Doughnut Chart with user defined colors"})
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('C18', chart2, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("C18", chart2, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Create a Doughnut chart with rotation of the segments.
 #
 
 # Create an example Doughnut chart like above.
-chart3 = workbook.add_chart({'type': 'doughnut'})
+chart3 = workbook.add_chart({"type": "doughnut"})
 
 # Configure the series.
-chart3.add_series({
-    'name': 'Doughnut sales data',
-    'categories': '=Sheet1!$A$2:$A$4',
-    'values':     '=Sheet1!$B$2:$B$4',
-})
+chart3.add_series(
+    {
+        "name": "Doughnut sales data",
+        "categories": "=Sheet1!$A$2:$A$4",
+        "values": "=Sheet1!$B$2:$B$4",
+    }
+)
 
 # Add a title.
-chart3.set_title({'name': 'Doughnut Chart with segment rotation'})
+chart3.set_title({"name": "Doughnut Chart with segment rotation"})
 
 # Change the angle/rotation of the first segment.
 chart3.set_rotation(90)
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('C34', chart3, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("C34", chart3, {"x_offset": 25, "y_offset": 10})
 
 
 #######################################################################
 #
 # Create a Doughnut chart with user defined hole size and other options.
 #
 
 # Create an example Doughnut chart like above.
-chart4 = workbook.add_chart({'type': 'doughnut'})
+chart4 = workbook.add_chart({"type": "doughnut"})
 
 # Configure the series.
-chart4.add_series({
-    'name': 'Doughnut sales data',
-    'categories': '=Sheet1!$A$2:$A$4',
-    'values':     '=Sheet1!$B$2:$B$4',
-    'points': [
-        {'fill': {'color': '#FA58D0'}},
-        {'fill': {'color': '#61210B'}},
-        {'fill': {'color': '#F5F6CE'}},
-    ],
-})
+chart4.add_series(
+    {
+        "name": "Doughnut sales data",
+        "categories": "=Sheet1!$A$2:$A$4",
+        "values": "=Sheet1!$B$2:$B$4",
+        "points": [
+            {"fill": {"color": "#FA58D0"}},
+            {"fill": {"color": "#61210B"}},
+            {"fill": {"color": "#F5F6CE"}},
+        ],
+    }
+)
 
 # Set a 3D style.
 chart4.set_style(26)
 
 # Add a title.
-chart4.set_title({'name': 'Doughnut Chart with options applied'})
+chart4.set_title({"name": "Doughnut Chart with options applied"})
 
 # Change the angle/rotation of the first segment.
 chart4.set_rotation(28)
 
 # Change the hole size.
 chart4.set_hole_size(33)
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('C50', chart4, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("C50", chart4, {"x_offset": 25, "y_offset": 10})
 
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/chart_gauge.py` & `XlsxWriter-3.1.0/examples/chart_gauge.py`

 * *Files 16% similar despite different names*

```diff
@@ -8,61 +8,69 @@
 # a Gauge Chart in Excel: https://www.excel-easy.com/examples/gauge-chart.html
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('chart_gauge.xlsx')
+workbook = xlsxwriter.Workbook("chart_gauge.xlsx")
 worksheet = workbook.add_worksheet()
 
-chart_doughnut = workbook.add_chart({'type': 'doughnut'})
-chart_pie = workbook.add_chart({'type': 'pie'})
+chart_doughnut = workbook.add_chart({"type": "doughnut"})
+chart_pie = workbook.add_chart({"type": "pie"})
 
 # Add some data for the Doughnut and Pie charts. This is set up so the
 # gauge goes from 0-100. It is initially set at 75%.
-worksheet.write_column('H2', ['Donut', 25, 50, 25, 100])
-worksheet.write_column('I2', ['Pie', 75, 1, '=200-I4-I3'])
+worksheet.write_column("H2", ["Donut", 25, 50, 25, 100])
+worksheet.write_column("I2", ["Pie", 75, 1, "=200-I4-I3"])
 
 # Configure the doughnut chart as the background for the gauge.
-chart_doughnut.add_series({
-    'name': '=Sheet1!$H$2',
-    'values': '=Sheet1!$H$3:$H$6',
-    'points': [
-        {'fill': {'color': 'green'}},
-        {'fill': {'color': 'yellow'}},
-        {'fill': {'color': 'red'}},
-        {'fill': {'none': True}}],
-})
+chart_doughnut.add_series(
+    {
+        "name": "=Sheet1!$H$2",
+        "values": "=Sheet1!$H$3:$H$6",
+        "points": [
+            {"fill": {"color": "green"}},
+            {"fill": {"color": "yellow"}},
+            {"fill": {"color": "red"}},
+            {"fill": {"none": True}},
+        ],
+    }
+)
 
 # Rotate chart so the gauge parts are above the horizontal.
 chart_doughnut.set_rotation(270)
 
 # Turn off the chart legend.
-chart_doughnut.set_legend({'none': True})
+chart_doughnut.set_legend({"none": True})
 
 # Turn off the chart fill and border.
-chart_doughnut.set_chartarea({
-    'border': {'none': True},
-    'fill': {'none': True},
-})
+chart_doughnut.set_chartarea(
+    {
+        "border": {"none": True},
+        "fill": {"none": True},
+    }
+)
 
 # Configure the pie chart as the needle for the gauge.
-chart_pie.add_series({
-    'name': '=Sheet1!$I$2',
-    'values': '=Sheet1!$I$3:$I$6',
-    'points': [
-        {'fill': {'none': True}},
-        {'fill': {'color': 'black'}},
-        {'fill': {'none': True}}],
-})
+chart_pie.add_series(
+    {
+        "name": "=Sheet1!$I$2",
+        "values": "=Sheet1!$I$3:$I$6",
+        "points": [
+            {"fill": {"none": True}},
+            {"fill": {"color": "black"}},
+            {"fill": {"none": True}},
+        ],
+    }
+)
 
 # Rotate the pie chart/needle to align with the doughnut/gauge.
 chart_pie.set_rotation(270)
 
 # Combine the pie and doughnut charts.
 chart_doughnut.combine(chart_pie)
 
 # Insert the chart into the worksheet.
-worksheet.insert_chart('A1', chart_doughnut)
+worksheet.insert_chart("A1", chart_doughnut)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/chart_line.py` & `XlsxWriter-3.1.0/examples/chart_bar.py`

 * *Files 23% similar despite different names*

```diff
@@ -1,117 +1,132 @@
 #######################################################################
 #
-# An example of creating Excel Line charts with Python and XlsxWriter.
+# An example of creating Excel Bar charts with Python and XlsxWriter.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('chart_line.xlsx')
+workbook = xlsxwriter.Workbook("chart_bar.xlsx")
 worksheet = workbook.add_worksheet()
-bold = workbook.add_format({'bold': 1})
+bold = workbook.add_format({"bold": 1})
 
 # Add the worksheet data that the charts will refer to.
-headings = ['Number', 'Batch 1', 'Batch 2']
+headings = ["Number", "Batch 1", "Batch 2"]
 data = [
     [2, 3, 4, 5, 6, 7],
     [10, 40, 50, 20, 10, 50],
     [30, 60, 70, 50, 40, 30],
 ]
 
-worksheet.write_row('A1', headings, bold)
-worksheet.write_column('A2', data[0])
-worksheet.write_column('B2', data[1])
-worksheet.write_column('C2', data[2])
+worksheet.write_row("A1", headings, bold)
+worksheet.write_column("A2", data[0])
+worksheet.write_column("B2", data[1])
+worksheet.write_column("C2", data[2])
 
-# Create a new chart object. In this case an embedded chart.
-chart1 = workbook.add_chart({'type': 'line'})
+#######################################################################
+#
+# Create a new bar chart.
+#
+chart1 = workbook.add_chart({"type": "bar"})
 
 # Configure the first series.
-chart1.add_series({
-    'name':       '=Sheet1!$B$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
+chart1.add_series(
+    {
+        "name": "=Sheet1!$B$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
 
 # Configure a second series. Note use of alternative syntax to define ranges.
-chart1.add_series({
-    'name':       ['Sheet1', 0, 2],
-    'categories': ['Sheet1', 1, 0, 6, 0],
-    'values':     ['Sheet1', 1, 2, 6, 2],
-})
+chart1.add_series(
+    {
+        "name": ["Sheet1", 0, 2],
+        "categories": ["Sheet1", 1, 0, 6, 0],
+        "values": ["Sheet1", 1, 2, 6, 2],
+    }
+)
 
 # Add a chart title and some axis labels.
-chart1.set_title ({'name': 'Results of sample analysis'})
-chart1.set_x_axis({'name': 'Test number'})
-chart1.set_y_axis({'name': 'Sample length (mm)'})
+chart1.set_title({"name": "Results of sample analysis"})
+chart1.set_x_axis({"name": "Test number"})
+chart1.set_y_axis({"name": "Sample length (mm)"})
 
-# Set an Excel chart style. Colors with white outline and shadow.
-chart1.set_style(10)
+# Set an Excel chart style.
+chart1.set_style(11)
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D2', chart1, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D2", chart1, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
-# Create a stacked line chart sub-type.
+# Create a stacked chart sub-type.
 #
-chart2 = workbook.add_chart({'type': 'line', 'subtype': 'stacked'})
+chart2 = workbook.add_chart({"type": "bar", "subtype": "stacked"})
 
 # Configure the first series.
-chart2.add_series({
-    'name':       '=Sheet1!$B$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
+chart2.add_series(
+    {
+        "name": "=Sheet1!$B$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
 
 # Configure second series.
-chart2.add_series({
-    'name':       '=Sheet1!$C$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$C$2:$C$7',
-})
+chart2.add_series(
+    {
+        "name": "=Sheet1!$C$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+    }
+)
 
 # Add a chart title and some axis labels.
-chart2.set_title ({'name': 'Stacked Chart'})
-chart2.set_x_axis({'name': 'Test number'})
-chart2.set_y_axis({'name': 'Sample length (mm)'})
+chart2.set_title({"name": "Stacked Chart"})
+chart2.set_x_axis({"name": "Test number"})
+chart2.set_y_axis({"name": "Sample length (mm)"})
 
 # Set an Excel chart style.
 chart2.set_style(12)
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D18', chart2, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D18", chart2, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
-# Create a percent stacked line chart sub-type.
+# Create a percentage stacked chart sub-type.
 #
-chart3 = workbook.add_chart({'type': 'line', 'subtype': 'percent_stacked'})
+chart3 = workbook.add_chart({"type": "bar", "subtype": "percent_stacked"})
 
 # Configure the first series.
-chart3.add_series({
-    'name':       '=Sheet1!$B$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
+chart3.add_series(
+    {
+        "name": "=Sheet1!$B$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
 
 # Configure second series.
-chart3.add_series({
-    'name':       '=Sheet1!$C$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$C$2:$C$7',
-})
+chart3.add_series(
+    {
+        "name": "=Sheet1!$C$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+    }
+)
 
 # Add a chart title and some axis labels.
-chart3.set_title ({'name': 'Percent Stacked Chart'})
-chart3.set_x_axis({'name': 'Test number'})
-chart3.set_y_axis({'name': 'Sample length (mm)'})
+chart3.set_title({"name": "Percent Stacked Chart"})
+chart3.set_x_axis({"name": "Test number"})
+chart3.set_y_axis({"name": "Sample length (mm)"})
 
 # Set an Excel chart style.
 chart3.set_style(13)
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D34', chart3, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D34", chart3, {"x_offset": 25, "y_offset": 10})
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/chart_pareto.py` & `XlsxWriter-3.1.0/examples/chart_pareto.py`

 * *Files 21% similar despite different names*

```diff
@@ -3,77 +3,81 @@
 # An example of creating of a Pareto chart with Python and XlsxWriter.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('chart_pareto.xlsx')
+workbook = xlsxwriter.Workbook("chart_pareto.xlsx")
 worksheet = workbook.add_worksheet()
 
 # Formats used in the workbook.
-bold = workbook.add_format({'bold': True})
-percent_format = workbook.add_format({'num_format': '0.0%'})
+bold = workbook.add_format({"bold": True})
+percent_format = workbook.add_format({"num_format": "0.0%"})
 
 # Widen the columns for visibility.
-worksheet.set_column('A:A', 15)
-worksheet.set_column('B:C', 10)
+worksheet.set_column("A:A", 15)
+worksheet.set_column("B:C", 10)
 
 # Add the worksheet data that the charts will refer to.
-headings = ['Reason', 'Number', 'Percentage']
+headings = ["Reason", "Number", "Percentage"]
 
 reasons = [
-    'Traffic', 'Child care', 'Public Transport', 'Weather',
-    'Overslept', 'Emergency',
+    "Traffic",
+    "Child care",
+    "Public Transport",
+    "Weather",
+    "Overslept",
+    "Emergency",
 ]
 
-numbers  = [60,   40,    20,  15,  10,    5]
+numbers = [60, 40, 20, 15, 10, 5]
 percents = [0.44, 0.667, 0.8, 0.9, 0.967, 1]
 
-worksheet.write_row('A1', headings, bold)
-worksheet.write_column('A2', reasons)
-worksheet.write_column('B2', numbers)
-worksheet.write_column('C2', percents, percent_format)
+worksheet.write_row("A1", headings, bold)
+worksheet.write_column("A2", reasons)
+worksheet.write_column("B2", numbers)
+worksheet.write_column("C2", percents, percent_format)
 
 
 # Create a new column chart. This will be the primary chart.
-column_chart = workbook.add_chart({'type': 'column'})
+column_chart = workbook.add_chart({"type": "column"})
 
 # Add a series.
-column_chart.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
+column_chart.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
 
 # Add a chart title.
-column_chart.set_title({'name': 'Reasons for lateness'})
+column_chart.set_title({"name": "Reasons for lateness"})
 
 # Turn off the chart legend.
-column_chart.set_legend({'position': 'none'})
+column_chart.set_legend({"position": "none"})
 
 # Set the title and scale of the Y axes. Note, the secondary axis is set from
 # the primary chart.
-column_chart.set_y_axis({
-    'name': 'Respondents (number)',
-    'min': 0,
-    'max': 120
-})
-column_chart.set_y2_axis({'max': 1})
+column_chart.set_y_axis({"name": "Respondents (number)", "min": 0, "max": 120})
+column_chart.set_y2_axis({"max": 1})
 
 # Create a new line chart. This will be the secondary chart.
-line_chart = workbook.add_chart({'type': 'line'})
+line_chart = workbook.add_chart({"type": "line"})
 
 # Add a series, on the secondary axis.
-line_chart.add_series({
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$C$2:$C$7',
-    'marker':     {'type': 'automatic'},
-    'y2_axis':    1,
-})
+line_chart.add_series(
+    {
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+        "marker": {"type": "automatic"},
+        "y2_axis": 1,
+    }
+)
 
 # Combine the charts.
 column_chart.combine(line_chart)
 
 # Insert the chart into the worksheet.
-worksheet.insert_chart('F2', column_chart)
+worksheet.insert_chart("F2", column_chart)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/chart_pie.py` & `XlsxWriter-3.1.0/examples/chart_pie.py`

 * *Files 23% similar despite different names*

```diff
@@ -9,96 +9,102 @@
 # assign formatting to each point in the series.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('chart_pie.xlsx')
+workbook = xlsxwriter.Workbook("chart_pie.xlsx")
 
 worksheet = workbook.add_worksheet()
-bold = workbook.add_format({'bold': 1})
+bold = workbook.add_format({"bold": 1})
 
 # Add the worksheet data that the charts will refer to.
-headings = ['Category', 'Values']
+headings = ["Category", "Values"]
 data = [
-    ['Apple', 'Cherry', 'Pecan'],
+    ["Apple", "Cherry", "Pecan"],
     [60, 30, 10],
 ]
 
-worksheet.write_row('A1', headings, bold)
-worksheet.write_column('A2', data[0])
-worksheet.write_column('B2', data[1])
+worksheet.write_row("A1", headings, bold)
+worksheet.write_column("A2", data[0])
+worksheet.write_column("B2", data[1])
 
 #######################################################################
 #
 # Create a new chart object.
 #
-chart1 = workbook.add_chart({'type': 'pie'})
+chart1 = workbook.add_chart({"type": "pie"})
 
 # Configure the series. Note the use of the list syntax to define ranges:
-chart1.add_series({
-    'name':       'Pie sales data',
-    'categories': ['Sheet1', 1, 0, 3, 0],
-    'values':     ['Sheet1', 1, 1, 3, 1],
-})
+chart1.add_series(
+    {
+        "name": "Pie sales data",
+        "categories": ["Sheet1", 1, 0, 3, 0],
+        "values": ["Sheet1", 1, 1, 3, 1],
+    }
+)
 
 # Add a title.
-chart1.set_title({'name': 'Popular Pie Types'})
+chart1.set_title({"name": "Popular Pie Types"})
 
 # Set an Excel chart style. Colors with white outline and shadow.
 chart1.set_style(10)
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('C2', chart1, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("C2", chart1, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Create a Pie chart with user defined segment colors.
 #
 
 # Create an example Pie chart like above.
-chart2 = workbook.add_chart({'type': 'pie'})
+chart2 = workbook.add_chart({"type": "pie"})
 
 # Configure the series and add user defined segment colors.
-chart2.add_series({
-    'name': 'Pie sales data',
-    'categories': '=Sheet1!$A$2:$A$4',
-    'values':     '=Sheet1!$B$2:$B$4',
-    'points': [
-        {'fill': {'color': '#5ABA10'}},
-        {'fill': {'color': '#FE110E'}},
-        {'fill': {'color': '#CA5C05'}},
-    ],
-})
+chart2.add_series(
+    {
+        "name": "Pie sales data",
+        "categories": "=Sheet1!$A$2:$A$4",
+        "values": "=Sheet1!$B$2:$B$4",
+        "points": [
+            {"fill": {"color": "#5ABA10"}},
+            {"fill": {"color": "#FE110E"}},
+            {"fill": {"color": "#CA5C05"}},
+        ],
+    }
+)
 
 # Add a title.
-chart2.set_title({'name': 'Pie Chart with user defined colors'})
+chart2.set_title({"name": "Pie Chart with user defined colors"})
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('C18', chart2, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("C18", chart2, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Create a Pie chart with rotation of the segments.
 #
 
 # Create an example Pie chart like above.
-chart3 = workbook.add_chart({'type': 'pie'})
+chart3 = workbook.add_chart({"type": "pie"})
 
 # Configure the series.
-chart3.add_series({
-    'name': 'Pie sales data',
-    'categories': '=Sheet1!$A$2:$A$4',
-    'values':     '=Sheet1!$B$2:$B$4',
-})
+chart3.add_series(
+    {
+        "name": "Pie sales data",
+        "categories": "=Sheet1!$A$2:$A$4",
+        "values": "=Sheet1!$B$2:$B$4",
+    }
+)
 
 # Add a title.
-chart3.set_title({'name': 'Pie Chart with segment rotation'})
+chart3.set_title({"name": "Pie Chart with segment rotation"})
 
 # Change the angle/rotation of the first segment.
 chart3.set_rotation(90)
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('C34', chart3, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("C34", chart3, {"x_offset": 25, "y_offset": 10})
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/chart_scatter.py` & `XlsxWriter-3.1.0/examples/chart_scatter.py`

 * *Files 16% similar despite different names*

```diff
@@ -3,185 +3,201 @@
 # An example of creating Excel Scatter charts with Python and XlsxWriter.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('chart_scatter.xlsx')
+workbook = xlsxwriter.Workbook("chart_scatter.xlsx")
 worksheet = workbook.add_worksheet()
-bold = workbook.add_format({'bold': 1})
+bold = workbook.add_format({"bold": 1})
 
 # Add the worksheet data that the charts will refer to.
-headings = ['Number', 'Batch 1', 'Batch 2']
+headings = ["Number", "Batch 1", "Batch 2"]
 data = [
     [2, 3, 4, 5, 6, 7],
     [10, 40, 50, 20, 10, 50],
     [30, 60, 70, 50, 40, 30],
 ]
 
-worksheet.write_row('A1', headings, bold)
-worksheet.write_column('A2', data[0])
-worksheet.write_column('B2', data[1])
-worksheet.write_column('C2', data[2])
+worksheet.write_row("A1", headings, bold)
+worksheet.write_column("A2", data[0])
+worksheet.write_column("B2", data[1])
+worksheet.write_column("C2", data[2])
 
 
 #######################################################################
 #
 # Create a new scatter chart.
 #
-chart1 = workbook.add_chart({'type': 'scatter'})
+chart1 = workbook.add_chart({"type": "scatter"})
 
 # Configure the first series.
-chart1.add_series({
-    'name': '=Sheet1!$B$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values': '=Sheet1!$B$2:$B$7',
-})
+chart1.add_series(
+    {
+        "name": "=Sheet1!$B$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
 
 # Configure second series. Note use of alternative syntax to define ranges.
-chart1.add_series({
-    'name':       ['Sheet1', 0, 2],
-    'categories': ['Sheet1', 1, 0, 6, 0],
-    'values':     ['Sheet1', 1, 2, 6, 2],
-})
+chart1.add_series(
+    {
+        "name": ["Sheet1", 0, 2],
+        "categories": ["Sheet1", 1, 0, 6, 0],
+        "values": ["Sheet1", 1, 2, 6, 2],
+    }
+)
 
 # Add a chart title and some axis labels.
-chart1.set_title ({'name': 'Results of sample analysis'})
-chart1.set_x_axis({'name': 'Test number'})
-chart1.set_y_axis({'name': 'Sample length (mm)'})
+chart1.set_title({"name": "Results of sample analysis"})
+chart1.set_x_axis({"name": "Test number"})
+chart1.set_y_axis({"name": "Sample length (mm)"})
 
 # Set an Excel chart style.
 chart1.set_style(11)
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D2', chart1, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D2", chart1, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Create a scatter chart sub-type with straight lines and markers.
 #
-chart2 = workbook.add_chart({'type': 'scatter',
-                             'subtype': 'straight_with_markers'})
+chart2 = workbook.add_chart({"type": "scatter", "subtype": "straight_with_markers"})
 
 # Configure the first series.
-chart2.add_series({
-    'name':       '=Sheet1!$B$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
+chart2.add_series(
+    {
+        "name": "=Sheet1!$B$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
 
 # Configure second series.
-chart2.add_series({
-    'name':       '=Sheet1!$C$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$C$2:$C$7',
-})
+chart2.add_series(
+    {
+        "name": "=Sheet1!$C$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+    }
+)
 
 # Add a chart title and some axis labels.
-chart2.set_title ({'name': 'Straight line with markers'})
-chart2.set_x_axis({'name': 'Test number'})
-chart2.set_y_axis({'name': 'Sample length (mm)'})
+chart2.set_title({"name": "Straight line with markers"})
+chart2.set_x_axis({"name": "Test number"})
+chart2.set_y_axis({"name": "Sample length (mm)"})
 
 # Set an Excel chart style.
 chart2.set_style(12)
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D18', chart2, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D18", chart2, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Create a scatter chart sub-type with straight lines and no markers.
 #
-chart3 = workbook.add_chart({'type': 'scatter',
-                             'subtype': 'straight'})
+chart3 = workbook.add_chart({"type": "scatter", "subtype": "straight"})
 
 # Configure the first series.
-chart3.add_series({
-    'name':       '=Sheet1!$B$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
+chart3.add_series(
+    {
+        "name": "=Sheet1!$B$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
 
 # Configure second series.
-chart3.add_series({
-    'name':       '=Sheet1!$C$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$C$2:$C$7',
-})
+chart3.add_series(
+    {
+        "name": "=Sheet1!$C$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+    }
+)
 
 # Add a chart title and some axis labels.
-chart3.set_title ({'name': 'Straight line'})
-chart3.set_x_axis({'name': 'Test number'})
-chart3.set_y_axis({'name': 'Sample length (mm)'})
+chart3.set_title({"name": "Straight line"})
+chart3.set_x_axis({"name": "Test number"})
+chart3.set_y_axis({"name": "Sample length (mm)"})
 
 # Set an Excel chart style.
 chart3.set_style(13)
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D34', chart3, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D34", chart3, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Create a scatter chart sub-type with smooth lines and markers.
 #
-chart4 = workbook.add_chart({'type': 'scatter',
-                             'subtype': 'smooth_with_markers'})
+chart4 = workbook.add_chart({"type": "scatter", "subtype": "smooth_with_markers"})
 
 # Configure the first series.
-chart4.add_series({
-    'name':       '=Sheet1!$B$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
+chart4.add_series(
+    {
+        "name": "=Sheet1!$B$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
 
 # Configure second series.
-chart4.add_series({
-    'name':       '=Sheet1!$C$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$C$2:$C$7',
-})
+chart4.add_series(
+    {
+        "name": "=Sheet1!$C$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+    }
+)
 
 # Add a chart title and some axis labels.
-chart4.set_title ({'name': 'Smooth line with markers'})
-chart4.set_x_axis({'name': 'Test number'})
-chart4.set_y_axis({'name': 'Sample length (mm)'})
+chart4.set_title({"name": "Smooth line with markers"})
+chart4.set_x_axis({"name": "Test number"})
+chart4.set_y_axis({"name": "Sample length (mm)"})
 
 # Set an Excel chart style.
 chart4.set_style(14)
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D50', chart4, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D50", chart4, {"x_offset": 25, "y_offset": 10})
 
 #######################################################################
 #
 # Create a scatter chart sub-type with smooth lines and no markers.
 #
-chart5 = workbook.add_chart({'type': 'scatter',
-                             'subtype': 'smooth'})
+chart5 = workbook.add_chart({"type": "scatter", "subtype": "smooth"})
 
 # Configure the first series.
-chart5.add_series({
-    'name':       '=Sheet1!$B$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
+chart5.add_series(
+    {
+        "name": "=Sheet1!$B$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
 
 # Configure second series.
-chart5.add_series({
-    'name':       '=Sheet1!$C$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$C$2:$C$7',
-})
+chart5.add_series(
+    {
+        "name": "=Sheet1!$C$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+    }
+)
 
 # Add a chart title and some axis labels.
-chart5.set_title ({'name': 'Smooth line'})
-chart5.set_x_axis({'name': 'Test number'})
-chart5.set_y_axis({'name': 'Sample length (mm)'})
+chart5.set_title({"name": "Smooth line"})
+chart5.set_x_axis({"name": "Test number"})
+chart5.set_y_axis({"name": "Sample length (mm)"})
 
 # Set an Excel chart style.
 chart5.set_style(15)
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D66', chart5, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D66", chart5, {"x_offset": 25, "y_offset": 10})
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/chart_secondary_axis.py` & `XlsxWriter-3.1.0/examples/chart_secondary_axis.py`

 * *Files 23% similar despite different names*

```diff
@@ -4,50 +4,58 @@
 # using Python and XlsxWriter.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('chart_secondary_axis.xlsx')
+workbook = xlsxwriter.Workbook("chart_secondary_axis.xlsx")
 worksheet = workbook.add_worksheet()
-bold = workbook.add_format({'bold': 1})
+bold = workbook.add_format({"bold": 1})
 
 # Add the worksheet data that the charts will refer to.
-headings = ['Aliens', 'Humans']
+headings = ["Aliens", "Humans"]
 data = [
     [2, 3, 4, 5, 6, 7],
     [10, 40, 50, 20, 10, 50],
 ]
 
-worksheet.write_row('A1', headings, bold)
-worksheet.write_column('A2', data[0])
-worksheet.write_column('B2', data[1])
+worksheet.write_row("A1", headings, bold)
+worksheet.write_column("A2", data[0])
+worksheet.write_column("B2", data[1])
 
 
 # Create a new chart object. In this case an embedded chart.
-chart = workbook.add_chart({'type': 'line'})
+chart = workbook.add_chart({"type": "line"})
 
 # Configure a series with a secondary axis
-chart.add_series({
-    'name':   '=Sheet1!$A$1',
-    'values': '=Sheet1!$A$2:$A$7',
-    'y2_axis': 1,
-})
-
-chart.add_series({
-    'name':   '=Sheet1!$B$1',
-    'values': '=Sheet1!$B$2:$B$7',
-})
+chart.add_series(
+    {
+        "name": "=Sheet1!$A$1",
+        "values": "=Sheet1!$A$2:$A$7",
+        "y2_axis": 1,
+    }
+)
+
+chart.add_series(
+    {
+        "name": "=Sheet1!$B$1",
+        "values": "=Sheet1!$B$2:$B$7",
+    }
+)
 
-chart.set_legend({'position': 'right'})
+chart.set_legend({"position": "right"})
 
 # Add a chart title and some axis labels.
-chart.set_title({'name': 'Survey results'})
-chart.set_x_axis({'name': 'Days', })
-chart.set_y_axis({'name': 'Population', 'major_gridlines': {'visible': 0}})
-chart.set_y2_axis({'name': 'Laser wounds'})
+chart.set_title({"name": "Survey results"})
+chart.set_x_axis(
+    {
+        "name": "Days",
+    }
+)
+chart.set_y_axis({"name": "Population", "major_gridlines": {"visible": 0}})
+chart.set_y2_axis({"name": "Laser wounds"})
 
 # Insert the chart into the worksheet (with an offset).
-worksheet.insert_chart('D2', chart, {'x_offset': 25, 'y_offset': 10})
+worksheet.insert_chart("D2", chart, {"x_offset": 25, "y_offset": 10})
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/chartsheet.py` & `XlsxWriter-3.1.0/examples/chart_gradient.py`

 * *Files 26% similar despite different names*

```diff
@@ -1,67 +1,66 @@
 #######################################################################
 #
-# An example of creating an Excel chart in a chartsheet with Python
-# and XlsxWriter.
+# An example of creating an Excel charts with gradient fills using
+# Python and XlsxWriter.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('chartsheet.xlsx')
-
-# Add a worksheet to hold the data.
+workbook = xlsxwriter.Workbook("chart_gradient.xlsx")
 worksheet = workbook.add_worksheet()
-
-# Add a chartsheet. A worksheet that only holds a chart.
-chartsheet = workbook.add_chartsheet()
-
-# Add a format for the headings.
-bold = workbook.add_format({'bold': 1})
+bold = workbook.add_format({"bold": 1})
 
 # Add the worksheet data that the charts will refer to.
-headings = ['Number', 'Batch 1', 'Batch 2']
+headings = ["Number", "Batch 1", "Batch 2"]
 data = [
     [2, 3, 4, 5, 6, 7],
     [10, 40, 50, 20, 10, 50],
     [30, 60, 70, 50, 40, 30],
 ]
 
-worksheet.write_row('A1', headings, bold)
-worksheet.write_column('A2', data[0])
-worksheet.write_column('B2', data[1])
-worksheet.write_column('C2', data[2])
-
-
-# Create a new bar chart.
-chart1 = workbook.add_chart({'type': 'bar'})
-
-# Configure the first series.
-chart1.add_series({
-    'name':       '=Sheet1!$B$1',
-    'categories': '=Sheet1!$A$2:$A$7',
-    'values':     '=Sheet1!$B$2:$B$7',
-})
-
-# Configure a second series. Note use of alternative syntax to define ranges.
-chart1.add_series({
-    'name':       ['Sheet1', 0, 2],
-    'categories': ['Sheet1', 1, 0, 6, 0],
-    'values':     ['Sheet1', 1, 2, 6, 2],
-})
-
-# Add a chart title and some axis labels.
-chart1.set_title ({'name': 'Results of sample analysis'})
-chart1.set_x_axis({'name': 'Test number'})
-chart1.set_y_axis({'name': 'Sample length (mm)'})
-
-# Set an Excel chart style.
-chart1.set_style(11)
+worksheet.write_row("A1", headings, bold)
+worksheet.write_column("A2", data[0])
+worksheet.write_column("B2", data[1])
+worksheet.write_column("C2", data[2])
+
+
+# Create a new column chart.
+chart = workbook.add_chart({"type": "column"})
+
+# Configure the first series, including a gradient.
+chart.add_series(
+    {
+        "name": "=Sheet1!$B$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$B$2:$B$7",
+        "gradient": {"colors": ["#963735", "#F1DCDB"]},
+    }
+)
+
+# Configure the second series, including a gradient.
+chart.add_series(
+    {
+        "name": "=Sheet1!$C$1",
+        "categories": "=Sheet1!$A$2:$A$7",
+        "values": "=Sheet1!$C$2:$C$7",
+        "gradient": {"colors": ["#E36C0A", "#FCEADA"]},
+    }
+)
+
+# Set a gradient for the plotarea.
+chart.set_plotarea({"gradient": {"colors": ["#FFEFD1", "#F0EBD5", "#B69F66"]}})
+
+
+# Add some axis labels.
+chart.set_x_axis({"name": "Test number"})
+chart.set_y_axis({"name": "Sample length (mm)"})
 
-# Add the chart to the chartsheet.
-chartsheet.set_chart(chart1)
+# Turn off the chart legend.
+chart.set_legend({"none": True})
 
-# Display the chartsheet as the active sheet when the workbook is opened.
-chartsheet.activate();
+# Insert the chart into the worksheet.
+worksheet.insert_chart("E2", chart)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/check_close.py` & `XlsxWriter-3.1.0/examples/check_close.py`

 * *Files 18% similar despite different names*

```diff
@@ -3,26 +3,28 @@
 # A simple program demonstrating a check for exceptions when closing the file.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('check_close.xlsx')
+workbook = xlsxwriter.Workbook("check_close.xlsx")
 worksheet = workbook.add_worksheet()
 
-worksheet.write('A1', 'Hello world')
+worksheet.write("A1", "Hello world")
 
 # Try to close() the file in a loop so that if there is an exception, such as
 # if the file is open in Excel, we can ask the user to close the file, and
 # try again to overwrite it.
 while True:
     try:
         workbook.close()
     except xlsxwriter.exceptions.FileCreateError as e:
-        decision = input("Exception caught in workbook.close(): %s\n"
-                         "Please close the file if it is open in Excel.\n"
-                         "Try to write file again? [Y/n]: " % e)
-        if decision != 'n':
+        decision = input(
+            "Exception caught in workbook.close(): %s\n"
+            "Please close the file if it is open in Excel.\n"
+            "Try to write file again? [Y/n]: " % e
+        )
+        if decision != "n":
             continue
 
     break
```

### Comparing `XlsxWriter-3.0.9/examples/comments1.py` & `XlsxWriter-3.1.0/examples/comments1.py`

 * *Files 26% similar despite different names*

```diff
@@ -6,14 +6,14 @@
 # For more advanced comment options see comments2.py.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('comments1.xlsx')
+workbook = xlsxwriter.Workbook("comments1.xlsx")
 worksheet = workbook.add_worksheet()
 
-worksheet.write('A1', 'Hello')
-worksheet.write_comment('A1', 'This is a comment')
+worksheet.write("A1", "Hello")
+worksheet.write_comment("A1", "This is a comment")
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/comments2.py` & `XlsxWriter-3.1.0/examples/comments2.py`

 * *Files 16% similar despite different names*

```diff
@@ -6,256 +6,264 @@
 # Each of the worksheets demonstrates different features of cell comments.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('comments.xlsx')
+workbook = xlsxwriter.Workbook("comments.xlsx")
 
 worksheet1 = workbook.add_worksheet()
 worksheet2 = workbook.add_worksheet()
 worksheet3 = workbook.add_worksheet()
 worksheet4 = workbook.add_worksheet()
 worksheet5 = workbook.add_worksheet()
 worksheet6 = workbook.add_worksheet()
 worksheet7 = workbook.add_worksheet()
 worksheet8 = workbook.add_worksheet()
 
-text_wrap = workbook.add_format({'text_wrap': 1, 'valign': 'top'})
+text_wrap = workbook.add_format({"text_wrap": 1, "valign": "top"})
 
 
 ###############################################################################
 #
 # Example 1. Demonstrates a simple cell comments without formatting.
 #
 
 # Set up some formatting.
-worksheet1.set_column('C:C', 25)
+worksheet1.set_column("C:C", 25)
 worksheet1.set_row(2, 50)
 
 # Simple ASCII string.
-cell_text = 'Hold the mouse over this cell to see the comment.'
+cell_text = "Hold the mouse over this cell to see the comment."
 
-comment = 'This is a comment.'
+comment = "This is a comment."
 
-worksheet1.write('C3', cell_text, text_wrap)
-worksheet1.write_comment('C3', comment)
+worksheet1.write("C3", cell_text, text_wrap)
+worksheet1.write_comment("C3", comment)
 
 
 ###############################################################################
 #
 # Example 2. Demonstrates visible and hidden comments.
 #
 
 # Set up some formatting.
-worksheet2.set_column('C:C', 25)
+worksheet2.set_column("C:C", 25)
 worksheet2.set_row(2, 50)
 worksheet2.set_row(5, 50)
 
-cell_text = 'This cell comment is visible.'
-comment = 'Hello.'
+cell_text = "This cell comment is visible."
+comment = "Hello."
 
-worksheet2.write('C3', cell_text, text_wrap)
-worksheet2.write_comment('C3', comment, {'visible': True})
+worksheet2.write("C3", cell_text, text_wrap)
+worksheet2.write_comment("C3", comment, {"visible": True})
 
 cell_text = "This cell comment isn't visible (the default)."
 
-worksheet2.write('C6', cell_text, text_wrap)
-worksheet2.write_comment('C6', comment)
+worksheet2.write("C6", cell_text, text_wrap)
+worksheet2.write_comment("C6", comment)
 
 
 ###############################################################################
 #
 # Example 3. Demonstrates visible and hidden comments set at the worksheet
 #            level.
 #
 
 # Set up some formatting.
-worksheet3.set_column('C:C', 25)
+worksheet3.set_column("C:C", 25)
 worksheet3.set_row(2, 50)
 worksheet3.set_row(5, 50)
 worksheet3.set_row(8, 50)
 
 # Make all comments on the worksheet visible.
 worksheet3.show_comments()
 
-cell_text = 'This cell comment is visible, explicitly.'
-comment = 'Hello.'
+cell_text = "This cell comment is visible, explicitly."
+comment = "Hello."
 
-worksheet3.write('C3', cell_text, text_wrap)
-worksheet3.write_comment('C3', comment, {'visible': True})
+worksheet3.write("C3", cell_text, text_wrap)
+worksheet3.write_comment("C3", comment, {"visible": True})
 
-cell_text = 'This cell comment is also visible because of show_comments().'
+cell_text = "This cell comment is also visible because of show_comments()."
 
-worksheet3.write('C6', cell_text, text_wrap)
-worksheet3.write_comment('C6', comment)
+worksheet3.write("C6", cell_text, text_wrap)
+worksheet3.write_comment("C6", comment)
 
-cell_text = 'However, we can still override it locally.'
+cell_text = "However, we can still override it locally."
 
-worksheet3.write('C9', cell_text, text_wrap)
-worksheet3.write_comment('C9', comment, {'visible': False})
+worksheet3.write("C9", cell_text, text_wrap)
+worksheet3.write_comment("C9", comment, {"visible": False})
 
 
 ###############################################################################
 #
 # Example 4. Demonstrates changes to the comment box dimensions.
 #
 
 # Set up some formatting.
-worksheet4.set_column('C:C', 25)
+worksheet4.set_column("C:C", 25)
 worksheet4.set_row(2, 50)
 worksheet4.set_row(5, 50)
 worksheet4.set_row(8, 50)
 worksheet4.set_row(15, 50)
 worksheet4.set_row(18, 50)
 
 worksheet4.show_comments()
 
-cell_text = 'This cell comment is default size.'
-comment = 'Hello.'
+cell_text = "This cell comment is default size."
+comment = "Hello."
 
-worksheet4.write('C3', cell_text, text_wrap)
-worksheet4.write_comment('C3', comment)
+worksheet4.write("C3", cell_text, text_wrap)
+worksheet4.write_comment("C3", comment)
 
-cell_text = 'This cell comment is twice as wide.'
+cell_text = "This cell comment is twice as wide."
 
-worksheet4.write('C6', cell_text, text_wrap)
-worksheet4.write_comment('C6', comment, {'x_scale': 2})
+worksheet4.write("C6", cell_text, text_wrap)
+worksheet4.write_comment("C6", comment, {"x_scale": 2})
 
-cell_text = 'This cell comment is twice as high.'
+cell_text = "This cell comment is twice as high."
 
-worksheet4.write('C9', cell_text, text_wrap)
-worksheet4.write_comment('C9', comment, {'y_scale': 2})
+worksheet4.write("C9", cell_text, text_wrap)
+worksheet4.write_comment("C9", comment, {"y_scale": 2})
 
-cell_text = 'This cell comment is scaled in both directions.'
+cell_text = "This cell comment is scaled in both directions."
 
-worksheet4.write('C16', cell_text, text_wrap)
-worksheet4.write_comment('C16', comment, {'x_scale': 1.2, 'y_scale': 0.5})
+worksheet4.write("C16", cell_text, text_wrap)
+worksheet4.write_comment("C16", comment, {"x_scale": 1.2, "y_scale": 0.5})
 
-cell_text = 'This cell comment has width and height specified in pixels.'
+cell_text = "This cell comment has width and height specified in pixels."
 
-worksheet4.write('C19', cell_text, text_wrap)
-worksheet4.write_comment('C19', comment, {'width': 200, 'height': 50})
+worksheet4.write("C19", cell_text, text_wrap)
+worksheet4.write_comment("C19", comment, {"width": 200, "height": 50})
 
 
 ###############################################################################
 #
 # Example 5. Demonstrates changes to the cell comment position.
 #
-worksheet5.set_column('C:C', 25)
+worksheet5.set_column("C:C", 25)
 worksheet5.set_row(2, 50)
 worksheet5.set_row(5, 50)
 worksheet5.set_row(8, 50)
 worksheet5.set_row(11, 50)
 
 worksheet5.show_comments()
 
-cell_text = 'This cell comment is in the default position.'
-comment = 'Hello.'
+cell_text = "This cell comment is in the default position."
+comment = "Hello."
 
-worksheet5.write('C3', cell_text, text_wrap)
-worksheet5.write_comment('C3', comment)
+worksheet5.write("C3", cell_text, text_wrap)
+worksheet5.write_comment("C3", comment)
 
-cell_text = 'This cell comment has been moved to another cell.'
+cell_text = "This cell comment has been moved to another cell."
 
-worksheet5.write('C6', cell_text, text_wrap)
-worksheet5.write_comment('C6', comment, {'start_cell': 'E4'})
+worksheet5.write("C6", cell_text, text_wrap)
+worksheet5.write_comment("C6", comment, {"start_cell": "E4"})
 
-cell_text = 'This cell comment has been moved to another cell.'
+cell_text = "This cell comment has been moved to another cell."
 
-worksheet5.write('C9', cell_text, text_wrap)
-worksheet5.write_comment('C9', comment, {'start_row': 8, 'start_col': 4})
+worksheet5.write("C9", cell_text, text_wrap)
+worksheet5.write_comment("C9", comment, {"start_row": 8, "start_col": 4})
 
-cell_text = 'This cell comment has been shifted within its default cell.'
+cell_text = "This cell comment has been shifted within its default cell."
 
-worksheet5.write('C12', cell_text, text_wrap)
-worksheet5.write_comment('C12', comment, {'x_offset': 30, 'y_offset': 12})
+worksheet5.write("C12", cell_text, text_wrap)
+worksheet5.write_comment("C12", comment, {"x_offset": 30, "y_offset": 12})
 
 
 ###############################################################################
 #
 # Example 6. Demonstrates changes to the comment background color.
 #
-worksheet6.set_column('C:C', 25)
+worksheet6.set_column("C:C", 25)
 worksheet6.set_row(2, 50)
 worksheet6.set_row(5, 50)
 worksheet6.set_row(8, 50)
 
 worksheet6.show_comments()
 
-cell_text = 'This cell comment has a different color.'
-comment = 'Hello.'
+cell_text = "This cell comment has a different color."
+comment = "Hello."
 
-worksheet6.write('C3', cell_text, text_wrap)
-worksheet6.write_comment('C3', comment, {'color': 'green'})
+worksheet6.write("C3", cell_text, text_wrap)
+worksheet6.write_comment("C3", comment, {"color": "green"})
 
-cell_text = 'This cell comment has the default color.'
+cell_text = "This cell comment has the default color."
 
-worksheet6.write('C6', cell_text, text_wrap)
-worksheet6.write_comment('C6', comment)
+worksheet6.write("C6", cell_text, text_wrap)
+worksheet6.write_comment("C6", comment)
 
-cell_text = 'This cell comment has a different color.'
+cell_text = "This cell comment has a different color."
 
-worksheet6.write('C9', cell_text, text_wrap)
-worksheet6.write_comment('C9', comment, {'color': '#CCFFCC'})
+worksheet6.write("C9", cell_text, text_wrap)
+worksheet6.write_comment("C9", comment, {"color": "#CCFFCC"})
 
 
 ###############################################################################
 #
 # Example 7. Demonstrates how to set the cell comment author.
 #
-worksheet7.set_column('C:C', 30)
+worksheet7.set_column("C:C", 30)
 worksheet7.set_row(2, 50)
 worksheet7.set_row(5, 50)
 
-author = ''
-cell = 'C3'
+author = ""
+cell = "C3"
 
-cell_text = ("Move the mouse over this cell and you will see 'Cell commented "
-             "by (blank)' in the status bar at the bottom")
+cell_text = (
+    "Move the mouse over this cell and you will see 'Cell commented "
+    "by (blank)' in the status bar at the bottom"
+)
 
-comment = 'Hello.'
+comment = "Hello."
 
 worksheet7.write(cell, cell_text, text_wrap)
 worksheet7.write_comment(cell, comment)
 
-author = 'Python'
-cell = 'C6'
-cell_text = ("Move the mouse over this cell and you will see 'Cell commented "
-             "by Python' in the status bar at the bottom")
+author = "Python"
+cell = "C6"
+cell_text = (
+    "Move the mouse over this cell and you will see 'Cell commented "
+    "by Python' in the status bar at the bottom"
+)
 
 worksheet7.write(cell, cell_text, text_wrap)
-worksheet7.write_comment(cell, comment, {'author': author})
+worksheet7.write_comment(cell, comment, {"author": author})
 
 
 ###############################################################################
 #
 # Example 8. Demonstrates the need to explicitly set the row height.
 #
 
 # Set up some formatting.
-worksheet8.set_column('C:C', 25)
+worksheet8.set_column("C:C", 25)
 worksheet8.set_row(2, 80)
 
 worksheet8.show_comments()
 
-cell_text = ('The height of this row has been adjusted explicitly using '
-             'set_row(). The size of the comment box is adjusted '
-             'accordingly by XlsxWriter.')
-
-comment = 'Hello.'
-
-worksheet8.write('C3', cell_text, text_wrap)
-worksheet8.write_comment('C3', comment)
-
-cell_text = ('The height of this row has been adjusted by Excel due to the '
-             'text wrap property being set. Unfortunately this means that '
-             'the height of the row is unknown to XlsxWriter at run time '
-             "and thus the comment box is stretched as well.\n\n"
-             'Use set_row() to specify the row height explicitly to avoid '
-             'this problem.')
+cell_text = (
+    "The height of this row has been adjusted explicitly using "
+    "set_row(). The size of the comment box is adjusted "
+    "accordingly by XlsxWriter."
+)
+
+comment = "Hello."
+
+worksheet8.write("C3", cell_text, text_wrap)
+worksheet8.write_comment("C3", comment)
+
+cell_text = (
+    "The height of this row has been adjusted by Excel due to the "
+    "text wrap property being set. Unfortunately this means that "
+    "the height of the row is unknown to XlsxWriter at run time "
+    "and thus the comment box is stretched as well.\n\n"
+    "Use set_row() to specify the row height explicitly to avoid "
+    "this problem."
+)
 
-worksheet8.write('C6', cell_text, text_wrap)
-worksheet8.write_comment('C6', comment)
+worksheet8.write("C6", cell_text, text_wrap)
+worksheet8.write_comment("C6", comment)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/datetimes.py` & `XlsxWriter-3.1.0/examples/datetimes.py`

 * *Files 14% similar despite different names*

```diff
@@ -6,58 +6,55 @@
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 from datetime import datetime
 import xlsxwriter
 
 # Create a workbook and add a worksheet.
-workbook = xlsxwriter.Workbook('datetimes.xlsx')
+workbook = xlsxwriter.Workbook("datetimes.xlsx")
 worksheet = workbook.add_worksheet()
-bold = workbook.add_format({'bold': True})
+bold = workbook.add_format({"bold": True})
 
 # Expand the first columns so that the dates are visible.
-worksheet.set_column('A:B', 30)
+worksheet.set_column("A:B", 30)
 
 # Write the column headers.
-worksheet.write('A1', 'Formatted date', bold)
-worksheet.write('B1', 'Format', bold)
+worksheet.write("A1", "Formatted date", bold)
+worksheet.write("B1", "Format", bold)
 
 # Create a datetime object to use in the examples.
 
-date_time = datetime.strptime('2013-01-23 12:30:05.123',
-                              '%Y-%m-%d %H:%M:%S.%f')
+date_time = datetime.strptime("2013-01-23 12:30:05.123", "%Y-%m-%d %H:%M:%S.%f")
 
 # Examples date and time formats. In the output file compare how changing
 # the format codes change the appearance of the date.
 date_formats = (
-    'dd/mm/yy',
-    'mm/dd/yy',
-    'dd m yy',
-    'd mm yy',
-    'd mmm yy',
-    'd mmmm yy',
-    'd mmmm yyy',
-    'd mmmm yyyy',
-    'dd/mm/yy hh:mm',
-    'dd/mm/yy hh:mm:ss',
-    'dd/mm/yy hh:mm:ss.000',
-    'hh:mm',
-    'hh:mm:ss',
-    'hh:mm:ss.000',
+    "dd/mm/yy",
+    "mm/dd/yy",
+    "dd m yy",
+    "d mm yy",
+    "d mmm yy",
+    "d mmmm yy",
+    "d mmmm yyy",
+    "d mmmm yyyy",
+    "dd/mm/yy hh:mm",
+    "dd/mm/yy hh:mm:ss",
+    "dd/mm/yy hh:mm:ss.000",
+    "hh:mm",
+    "hh:mm:ss",
+    "hh:mm:ss.000",
 )
 
 # Start from first row after headers.
 row = 1
 
 # Write the same date and time using each of the above formats.
 for date_format_str in date_formats:
-
     # Create a format for the date or time.
-    date_format = workbook.add_format({'num_format': date_format_str,
-                                      'align': 'left'})
+    date_format = workbook.add_format({"num_format": date_format_str, "align": "left"})
 
     # Write the same date using different formats.
     worksheet.write_datetime(row, 0, date_time, date_format)
 
     # Also write the format string for comparison.
     worksheet.write_string(row, 1, date_format_str)
```

### Comparing `XlsxWriter-3.0.9/examples/defined_name.py` & `XlsxWriter-3.1.0/examples/defined_name.py`

 * *Files 13% similar despite different names*

```diff
@@ -7,28 +7,28 @@
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
 
-workbook = xlsxwriter.Workbook('defined_name.xlsx')
+workbook = xlsxwriter.Workbook("defined_name.xlsx")
 worksheet1 = workbook.add_worksheet()
 worksheet2 = workbook.add_worksheet()
 
 # Define some global/workbook names.
-workbook.define_name('Exchange_rate', '=0.96')
-workbook.define_name('Sales', '=Sheet1!$G$1:$H$10')
+workbook.define_name("Exchange_rate", "=0.96")
+workbook.define_name("Sales", "=Sheet1!$G$1:$H$10")
 
 # Define a local/worksheet name. Over-rides the "Sales" name above.
-workbook.define_name('Sheet2!Sales', '=Sheet2!$G$1:$G$10')
+workbook.define_name("Sheet2!Sales", "=Sheet2!$G$1:$G$10")
 
 # Write some text in the file and one of the defined names in a formula.
 for worksheet in workbook.worksheets():
-    worksheet.set_column('A:A', 45)
-    worksheet.write('A1', 'This worksheet contains some defined names.')
-    worksheet.write('A2', 'See Formulas -> Name Manager above.')
-    worksheet.write('A3', 'Example formula in cell B3 ->')
+    worksheet.set_column("A:A", 45)
+    worksheet.write("A1", "This worksheet contains some defined names.")
+    worksheet.write("A2", "See Formulas -> Name Manager above.")
+    worksheet.write("A3", "Example formula in cell B3 ->")
 
-    worksheet.write('B3', '=Exchange_rate')
+    worksheet.write("B3", "=Exchange_rate")
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/demo.py` & `XlsxWriter-3.1.0/examples/demo.py`

 * *Files 7% similar despite different names*

```diff
@@ -5,30 +5,30 @@
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
 
 # Create an new Excel file and add a worksheet.
-workbook = xlsxwriter.Workbook('demo.xlsx')
+workbook = xlsxwriter.Workbook("demo.xlsx")
 worksheet = workbook.add_worksheet()
 
 # Widen the first column to make the text clearer.
-worksheet.set_column('A:A', 20)
+worksheet.set_column("A:A", 20)
 
 # Add a bold format to use to highlight cells.
-bold = workbook.add_format({'bold': True})
+bold = workbook.add_format({"bold": True})
 
 # Write some simple text.
-worksheet.write('A1', 'Hello')
+worksheet.write("A1", "Hello")
 
 # Text with formatting.
-worksheet.write('A2', 'World', bold)
+worksheet.write("A2", "World", bold)
 
 # Write some numbers, with row/column notation.
 worksheet.write(2, 0, 123)
 worksheet.write(3, 0, 123.456)
 
 # Insert an image.
-worksheet.insert_image('B5', 'logo.png')
+worksheet.insert_image("B5", "logo.png")
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/diagonal_border.py` & `XlsxWriter-3.1.0/examples/worksheet_protection.py`

 * *Files 27% similar despite different names*

```diff
@@ -1,29 +1,33 @@
-##############################################################################
+########################################################################
 #
-# A simple formatting example that demonstrates how to add diagonal cell
-# borders with XlsxWriter.
+# Example of cell locking and formula hiding in an Excel worksheet
+# using Python and the XlsxWriter module.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('diag_border.xlsx')
+workbook = xlsxwriter.Workbook("protection.xlsx")
 worksheet = workbook.add_worksheet()
 
-format1 = workbook.add_format({'diag_type': 1})
-format2 = workbook.add_format({'diag_type': 2})
-format3 = workbook.add_format({'diag_type': 3})
-
-format4 = workbook.add_format({
-    'diag_type': 3,
-    'diag_border': 7,
-    'diag_color': 'red',
-})
-
-worksheet.write('B3', 'Text', format1)
-worksheet.write('B6', 'Text', format2)
-worksheet.write('B9', 'Text', format3)
-worksheet.write('B12', 'Text', format4)
+# Create some cell formats with protection properties.
+unlocked = workbook.add_format({"locked": False})
+hidden = workbook.add_format({"hidden": True})
+
+# Format the columns to make the text more visible.
+worksheet.set_column("A:A", 40)
+
+# Turn worksheet protection on.
+worksheet.protect()
+
+# Write a locked, unlocked and hidden cell.
+worksheet.write("A1", "Cell B1 is locked. It cannot be edited.")
+worksheet.write("A2", "Cell B2 is unlocked. It can be edited.")
+worksheet.write("A3", "Cell B3 is hidden. The formula isn't visible.")
+
+worksheet.write_formula("B1", "=1+2")  # Locked by default.
+worksheet.write_formula("B2", "=1+2", unlocked)
+worksheet.write_formula("B3", "=1+2", hidden)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/django_simple.py` & `XlsxWriter-3.1.0/examples/django_simple.py`

 * *Files 8% similar despite different names*

```diff
@@ -10,23 +10,19 @@
 from django.http import HttpResponse
 from django.views.generic import View
 import xlsxwriter
 
 
 def get_simple_table_data():
     # Simulate a more complex table read.
-    return [[1, 2, 3],
-            [4, 5, 6],
-            [7, 8, 9]]
+    return [[1, 2, 3], [4, 5, 6], [7, 8, 9]]
 
 
 class MyView(View):
-
     def get(self, request):
-
         # Create an in-memory output file for the new workbook.
         output = io.BytesIO()
 
         # Even though the final file will be in memory the module uses temp
         # files during assembly for efficiency. To avoid this on servers that
         # don't allow temp files, for example the Google APP Engine, set the
         # 'in_memory' Workbook() constructor option as shown in the docs.
@@ -44,15 +40,15 @@
         # Close the workbook before sending the data.
         workbook.close()
 
         # Rewind the buffer.
         output.seek(0)
 
         # Set up the Http response.
-        filename = 'django_simple.xlsx'
+        filename = "django_simple.xlsx"
         response = HttpResponse(
             output,
-            content_type='application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
+            content_type="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
         )
-        response['Content-Disposition'] = 'attachment; filename=%s' % filename
+        response["Content-Disposition"] = "attachment; filename=%s" % filename
 
         return response
```

### Comparing `XlsxWriter-3.0.9/examples/doc_properties.py` & `XlsxWriter-3.1.0/examples/doc_properties.py`

 * *Files 25% similar despite different names*

```diff
@@ -3,26 +3,28 @@
 # An example of adding document properties to a XlsxWriter file.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('doc_properties.xlsx')
+workbook = xlsxwriter.Workbook("doc_properties.xlsx")
 worksheet = workbook.add_worksheet()
 
-workbook.set_properties({
-    'title':    'This is an example spreadsheet',
-    'subject':  'With document properties',
-    'author':   'John McNamara',
-    'manager':  'Dr. Heinz Doofenshmirtz',
-    'company':  'of Wolves',
-    'category': 'Example spreadsheets',
-    'keywords': 'Sample, Example, Properties',
-    'comments': 'Created with Python and XlsxWriter',
-    'status':   'Quo',
-})
+workbook.set_properties(
+    {
+        "title": "This is an example spreadsheet",
+        "subject": "With document properties",
+        "author": "John McNamara",
+        "manager": "Dr. Heinz Doofenshmirtz",
+        "company": "of Wolves",
+        "category": "Example spreadsheets",
+        "keywords": "Sample, Example, Properties",
+        "comments": "Created with Python and XlsxWriter",
+        "status": "Quo",
+    }
+)
 
-worksheet.set_column('A:A', 70)
-worksheet.write('A1', "Select 'Workbook Properties' to see properties.")
+worksheet.set_column("A:A", 70)
+worksheet.write("A1", "Select 'Workbook Properties' to see properties.")
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/headers_footers.py` & `XlsxWriter-3.1.0/examples/headers_footers.py`

 * *Files 11% similar despite different names*

```diff
@@ -34,96 +34,96 @@
 # See the main XlsxWriter documentation for more information.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('headers_footers.xlsx')
-preview = 'Select Print Preview to see the header and footer'
+workbook = xlsxwriter.Workbook("headers_footers.xlsx")
+preview = "Select Print Preview to see the header and footer"
 
 ######################################################################
 #
 # A simple example to start
 #
-worksheet1 = workbook.add_worksheet('Simple')
-header1 = '&CHere is some centered text.'
-footer1 = '&LHere is some left aligned text.'
+worksheet1 = workbook.add_worksheet("Simple")
+header1 = "&CHere is some centered text."
+footer1 = "&LHere is some left aligned text."
 
 worksheet1.set_header(header1)
 worksheet1.set_footer(footer1)
 
-worksheet1.set_column('A:A', 50)
-worksheet1.write('A1', preview)
+worksheet1.set_column("A:A", 50)
+worksheet1.write("A1", preview)
 
 
 ######################################################################
 #
 # Insert a header image.
 #
-worksheet2 = workbook.add_worksheet('Image')
-header2 = '&L&G'
+worksheet2 = workbook.add_worksheet("Image")
+header2 = "&L&G"
 
 # Adjust the page top margin to allow space for the header image.
 worksheet2.set_margins(top=1.3)
 
-worksheet2.set_header(header2, {'image_left': 'python-200x80.png'})
+worksheet2.set_header(header2, {"image_left": "python-200x80.png"})
 
-worksheet2.set_column('A:A', 50)
-worksheet2.write('A1', preview)
+worksheet2.set_column("A:A", 50)
+worksheet2.write("A1", preview)
 
 
 ######################################################################
 #
 # This is an example of some of the header/footer variables.
 #
-worksheet3 = workbook.add_worksheet('Variables')
-header3 = '&LPage &P of &N' + '&CFilename: &F' + '&RSheetname: &A'
-footer3 = '&LCurrent date: &D' + '&RCurrent time: &T'
+worksheet3 = workbook.add_worksheet("Variables")
+header3 = "&LPage &P of &N" + "&CFilename: &F" + "&RSheetname: &A"
+footer3 = "&LCurrent date: &D" + "&RCurrent time: &T"
 
 worksheet3.set_header(header3)
 worksheet3.set_footer(footer3)
 
-worksheet3.set_column('A:A', 50)
-worksheet3.write('A1', preview)
-worksheet3.write('A21', 'Next sheet')
+worksheet3.set_column("A:A", 50)
+worksheet3.write("A1", preview)
+worksheet3.write("A21", "Next sheet")
 worksheet3.set_h_pagebreaks([20])
 
 ######################################################################
 #
 # This example shows how to use more than one font
 #
-worksheet4 = workbook.add_worksheet('Mixed fonts')
+worksheet4 = workbook.add_worksheet("Mixed fonts")
 header4 = '&C&"Courier New,Bold"Hello &"Arial,Italic"World'
 footer4 = '&C&"Symbol"e&"Arial" = mc&X2'
 
 worksheet4.set_header(header4)
 worksheet4.set_footer(footer4)
 
-worksheet4.set_column('A:A', 50)
-worksheet4.write('A1', preview)
+worksheet4.set_column("A:A", 50)
+worksheet4.write("A1", preview)
 
 ######################################################################
 #
 # Example of line wrapping
 #
-worksheet5 = workbook.add_worksheet('Word wrap')
+worksheet5 = workbook.add_worksheet("Word wrap")
 header5 = "&CHeading 1\nHeading 2"
 
 worksheet5.set_header(header5)
 
-worksheet5.set_column('A:A', 50)
-worksheet5.write('A1', preview)
+worksheet5.set_column("A:A", 50)
+worksheet5.write("A1", preview)
 
 ######################################################################
 #
 # Example of inserting a literal ampersand &
 #
-worksheet6 = workbook.add_worksheet('Ampersand')
-header6 = '&CCuriouser && Curiouser - Attorneys at Law'
+worksheet6 = workbook.add_worksheet("Ampersand")
+header6 = "&CCuriouser && Curiouser - Attorneys at Law"
 
 worksheet6.set_header(header6)
 
-worksheet6.set_column('A:A', 50)
-worksheet6.write('A1', preview)
+worksheet6.set_column("A:A", 50)
+worksheet6.write("A1", preview)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/hide_row_col.py` & `XlsxWriter-3.1.0/examples/hide_row_col.py`

 * *Files 16% similar despite different names*

```diff
@@ -5,26 +5,26 @@
 # Excel uses an optimizations to hide all rows that don't have data.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('hide_row_col.xlsx')
+workbook = xlsxwriter.Workbook("hide_row_col.xlsx")
 worksheet = workbook.add_worksheet()
 
 # Write some data.
-worksheet.write('D1', 'Some hidden columns.')
-worksheet.write('A8', 'Some hidden rows.')
+worksheet.write("D1", "Some hidden columns.")
+worksheet.write("A8", "Some hidden rows.")
 
 # Hide all rows without data.
 worksheet.set_default_row(hide_unused_rows=True)
 
 # Set the height of empty rows that we do want to display even if it is
 # the default height.
 for row in range(1, 7):
     worksheet.set_row(row, 15)
 
 # Columns can be hidden explicitly. This doesn't increase the file size..
-worksheet.set_column('G:XFD', None, None, {'hidden': True})
+worksheet.set_column("G:XFD", None, None, {"hidden": True})
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/hide_sheet.py` & `XlsxWriter-3.1.0/examples/hide_sheet.py`

 * *Files 7% similar despite different names*

```diff
@@ -3,29 +3,29 @@
 # Example of how to hide a worksheet with XlsxWriter.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('hide_sheet.xlsx')
+workbook = xlsxwriter.Workbook("hide_sheet.xlsx")
 worksheet1 = workbook.add_worksheet()
 worksheet2 = workbook.add_worksheet()
 worksheet3 = workbook.add_worksheet()
 
-worksheet1.set_column('A:A', 30)
-worksheet2.set_column('A:A', 30)
-worksheet3.set_column('A:A', 30)
+worksheet1.set_column("A:A", 30)
+worksheet2.set_column("A:A", 30)
+worksheet3.set_column("A:A", 30)
 
 # Hide Sheet2. It won't be visible until it is unhidden in Excel.
 worksheet2.hide()
 
-worksheet1.write('A1', 'Sheet2 is hidden')
-worksheet2.write('A1', "Now it's my turn to find you!")
-worksheet3.write('A1', 'Sheet2 is hidden')
+worksheet1.write("A1", "Sheet2 is hidden")
+worksheet2.write("A1", "Now it's my turn to find you!")
+worksheet3.write("A1", "Sheet2 is hidden")
 
 # Note, you can't hide the "active" worksheet, which generally is the
 # first worksheet, since this would cause an Excel error. So, in order to hide
 # the first sheet you will need to activate another worksheet:
 #
 #    worksheet2.activate()
 #    worksheet1.hide()
```

### Comparing `XlsxWriter-3.0.9/examples/http_server.py` & `XlsxWriter-3.1.0/examples/http_server.py`

 * *Files 6% similar despite different names*

```diff
@@ -12,47 +12,48 @@
 import socketserver
 import io
 
 import xlsxwriter
 
 
 class Handler(http.server.SimpleHTTPRequestHandler):
-
     def do_GET(self):
         # Create an in-memory output file for the new workbook.
         output = io.BytesIO()
 
         # Even though the final file will be in memory the module uses temp
         # files during assembly for efficiency. To avoid this on servers that
         # don't allow temp files set the 'in_memory' constructor option to True.
         #
         # Note: The Python 3 Runtime Environment in Google App Engine supports
         # a filesystem with read/write access to /tmp which means that the
         # 'in_memory' option isn't required there and can be omitted. See:
         #
         # https://cloud.google.com/appengine/docs/standard/python3/runtime#filesystem
         #
-        workbook = xlsxwriter.Workbook(output, {'in_memory': True})
+        workbook = xlsxwriter.Workbook(output, {"in_memory": True})
         worksheet = workbook.add_worksheet()
 
         # Write some test data.
-        worksheet.write(0, 0, 'Hello, world!')
+        worksheet.write(0, 0, "Hello, world!")
 
         # Close the workbook before streaming the data.
         workbook.close()
 
         # Rewind the buffer.
         output.seek(0)
 
         # Construct a server response.
         self.send_response(200)
-        self.send_header('Content-Disposition', 'attachment; filename=test.xlsx')
-        self.send_header('Content-type',
-                         'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')
+        self.send_header("Content-Disposition", "attachment; filename=test.xlsx")
+        self.send_header(
+            "Content-type",
+            "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
+        )
         self.end_headers()
         self.wfile.write(output.read())
         return
 
 
-print('Server listening on port 8000...')
-httpd = socketserver.TCPServer(('', 8000), Handler)
+print("Server listening on port 8000...")
+httpd = socketserver.TCPServer(("", 8000), Handler)
 httpd.serve_forever()
```

### Comparing `XlsxWriter-3.0.9/examples/images.py` & `XlsxWriter-3.1.0/examples/images.py`

 * *Files 16% similar despite different names*

```diff
@@ -6,26 +6,26 @@
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
 
 # Create an new Excel file and add a worksheet.
-workbook = xlsxwriter.Workbook('images.xlsx')
+workbook = xlsxwriter.Workbook("images.xlsx")
 worksheet = workbook.add_worksheet()
 
 # Widen the first column to make the text clearer.
-worksheet.set_column('A:A', 30)
+worksheet.set_column("A:A", 30)
 
 # Insert an image.
-worksheet.write('A2', 'Insert an image in a cell:')
-worksheet.insert_image('B2', 'python.png')
+worksheet.write("A2", "Insert an image in a cell:")
+worksheet.insert_image("B2", "python.png")
 
 # Insert an image offset in the cell.
-worksheet.write('A12', 'Insert an image with an offset:')
-worksheet.insert_image('B12', 'python.png', {'x_offset': 15, 'y_offset': 10})
+worksheet.write("A12", "Insert an image with an offset:")
+worksheet.insert_image("B12", "python.png", {"x_offset": 15, "y_offset": 10})
 
 # Insert an image with scaling.
-worksheet.write('A23', 'Insert a scaled image:')
-worksheet.insert_image('B23', 'python.png', {'x_scale': 0.5, 'y_scale': 0.5})
+worksheet.write("A23", "Insert a scaled image:")
+worksheet.insert_image("B23", "python.png", {"x_scale": 0.5, "y_scale": 0.5})
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/images_bytesio.py` & `XlsxWriter-3.1.0/examples/images_bytesio.py`

 * *Files 24% similar despite different names*

```diff
@@ -10,36 +10,38 @@
 from io import BytesIO
 from urllib.request import urlopen
 
 
 import xlsxwriter
 
 # Create the workbook and add a worksheet.
-workbook  = xlsxwriter.Workbook('images_bytesio.xlsx')
+workbook = xlsxwriter.Workbook("images_bytesio.xlsx")
 worksheet = workbook.add_worksheet()
 
 
 # Read an image from a remote url.
-url = 'https://raw.githubusercontent.com/jmcnamara/XlsxWriter/' + \
-      'master/examples/logo.png'
+url = (
+    "https://raw.githubusercontent.com/jmcnamara/XlsxWriter/"
+    + "master/examples/logo.png"
+)
 
 image_data = BytesIO(urlopen(url).read())
 
 # Write the byte stream image to a cell. Note, the filename must be
 # specified. In this case it will be read from url string.
-worksheet.insert_image('B2', url, {'image_data': image_data})
+worksheet.insert_image("B2", url, {"image_data": image_data})
 
 
 # Read a local image file into a a byte stream. Note, the insert_image()
 # method can do this directly. This is for illustration purposes only.
-filename   = 'python.png'
+filename = "python.png"
 
-image_file = open(filename, 'rb')
+image_file = open(filename, "rb")
 image_data = BytesIO(image_file.read())
 image_file.close()
 
 
 # Write the byte stream image to a cell. The filename must  be specified.
-worksheet.insert_image('B8', filename, {'image_data': image_data})
+worksheet.insert_image("B8", filename, {"image_data": image_data})
 
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/inheritance1.py` & `XlsxWriter-3.1.0/examples/inheritance1.py`

 * *Files 5% similar despite different names*

```diff
@@ -16,15 +16,14 @@
     Subclass of the XlsxWriter Worksheet class to override the default
     write() method.
 
     """
 
     @convert_cell_args
     def write(self, row, col, *args):
-
         data = args[0]
 
         # Reverse strings to demonstrate the overridden method.
         if isinstance(data, str):
             data = data[::-1]
             return self.write_string(row, col, data)
         else:
@@ -43,19 +42,19 @@
         # Overwrite add_worksheet() to create a MyWorksheet object.
         worksheet = super(MyWorkbook, self).add_worksheet(name, MyWorksheet)
 
         return worksheet
 
 
 # Create a new MyWorkbook object.
-workbook = MyWorkbook('inheritance1.xlsx')
+workbook = MyWorkbook("inheritance1.xlsx")
 
 # The code from now on will be the same as a normal "Workbook" program.
 worksheet = workbook.add_worksheet()
 
 # Write some data to test the subclassing.
-worksheet.write('A1', 'Hello')
-worksheet.write('A2', 'World')
-worksheet.write('A3', 123)
-worksheet.write('A4', 345)
+worksheet.write("A1", "Hello")
+worksheet.write("A2", "World")
+worksheet.write("A3", 123)
+worksheet.write("A4", 345)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/inheritance2.py` & `XlsxWriter-3.1.0/examples/inheritance2.py`

 * *Files 8% similar despite different names*

```diff
@@ -59,16 +59,15 @@
         string_width = excel_string_width(string)
         if string_width > min_width:
             max_width = self.max_column_widths.get(col, min_width)
             if string_width > max_width:
                 self.max_column_widths[col] = string_width
 
         # Now call the parent version of write_string() as usual.
-        return super(MyWorksheet, self).write_string(row, col, string,
-                                                     cell_format)
+        return super(MyWorksheet, self).write_string(row, col, string, cell_format)
 
 
 class MyWorkbook(Workbook):
     """
     Subclass of the XlsxWriter Workbook class to override the default
     Worksheet class with our custom class.
 
@@ -91,31 +90,31 @@
             for column, width in worksheet.max_column_widths.items():
                 worksheet.set_column(column, column, width)
 
         return super(MyWorkbook, self).close()
 
 
 # Create a new MyWorkbook object.
-workbook = MyWorkbook('inheritance2.xlsx')
+workbook = MyWorkbook("inheritance2.xlsx")
 
 # The code from now on will be the same as a normal "Workbook" program.
 worksheet = workbook.add_worksheet()
 
 # Write some data to test column fitting.
-worksheet.write('A1', 'F')
+worksheet.write("A1", "F")
 
-worksheet.write('B3', 'Foo')
+worksheet.write("B3", "Foo")
 
-worksheet.write('C1', 'F')
-worksheet.write('C2', 'Fo')
-worksheet.write('C3', 'Foo')
-worksheet.write('C4', 'Food')
+worksheet.write("C1", "F")
+worksheet.write("C2", "Fo")
+worksheet.write("C3", "Foo")
+worksheet.write("C4", "Food")
 
-worksheet.write('D1', 'This is a longer string')
+worksheet.write("D1", "This is a longer string")
 
 # Write a string in row-col notation.
-worksheet.write(0, 4, 'Hello World')
+worksheet.write(0, 4, "Hello World")
 
 # Write a number.
 worksheet.write(0, 5, 123456)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/lambda.py` & `XlsxWriter-3.1.0/examples/lambda.py`

 * *Files 8% similar despite different names*

```diff
@@ -4,32 +4,31 @@
 # module.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 from xlsxwriter.workbook import Workbook
 
-workbook = Workbook('lambda.xlsx')
+workbook = Workbook("lambda.xlsx")
 worksheet = workbook.add_worksheet()
 
 
 # Write a Lambda function to convert Fahrenheit to Celsius to a cell.
 #
 # Note that the lambda function parameters must be prefixed with
 # "_xlpm.". These prefixes won't show up in Excel.
-worksheet.write('A1', '=LAMBDA(_xlpm.temp, (5/9) * (_xlpm.temp-32))(32)')
+worksheet.write("A1", "=LAMBDA(_xlpm.temp, (5/9) * (_xlpm.temp-32))(32)")
 
 # Create the same formula (without an argument) as a defined name and use that
 # to calculate a value.
 #
 # Note that the formula name is prefixed with "_xlfn." (this is normally
 # converted automatically by write_formula() but isn't for defined names)
 # and note that the lambda function parameters are prefixed with
 # "_xlpm.". These prefixes won't show up in Excel.
-workbook.define_name('ToCelsius',
-                     '=_xlfn.LAMBDA(_xlpm.temp, (5/9) * (_xlpm.temp-32))')
+workbook.define_name("ToCelsius", "=_xlfn.LAMBDA(_xlpm.temp, (5/9) * (_xlpm.temp-32))")
 
 # The user defined name needs to be written explicitly as a dynamic array
 # formula.
-worksheet.write_dynamic_array_formula('A2', '=ToCelsius(212)')
+worksheet.write_dynamic_array_formula("A2", "=ToCelsius(212)")
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/macros.py` & `XlsxWriter-3.1.0/examples/macros.py`

 * *Files 16% similar despite different names*

```diff
@@ -10,25 +10,24 @@
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
 # Note the file extension should be .xlsm.
-workbook = xlsxwriter.Workbook('macros.xlsm')
+workbook = xlsxwriter.Workbook("macros.xlsm")
 worksheet = workbook.add_worksheet()
 
-worksheet.set_column('A:A', 30)
+worksheet.set_column("A:A", 30)
 
 # Add the VBA project binary.
-workbook.add_vba_project('./vbaProject.bin')
+workbook.add_vba_project("./vbaProject.bin")
 
 # Show text for the end user.
-worksheet.write('A3', 'Press the button to say hello.')
+worksheet.write("A3", "Press the button to say hello.")
 
 # Add a button tied to a macro in the VBA project.
-worksheet.insert_button('B3', {'macro': 'say_hello',
-                               'caption': 'Press Me',
-                               'width': 80,
-                               'height': 30})
+worksheet.insert_button(
+    "B3", {"macro": "say_hello", "caption": "Press Me", "width": 80, "height": 30}
+)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/merge1.py` & `XlsxWriter-3.1.0/examples/merge1.py`

 * *Files 23% similar despite different names*

```diff
@@ -5,34 +5,37 @@
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
 
 # Create an new Excel file and add a worksheet.
-workbook = xlsxwriter.Workbook('merge1.xlsx')
+workbook = xlsxwriter.Workbook("merge1.xlsx")
 worksheet = workbook.add_worksheet()
 
 # Increase the cell size of the merged cells to highlight the formatting.
-worksheet.set_column('B:D', 12)
+worksheet.set_column("B:D", 12)
 worksheet.set_row(3, 30)
 worksheet.set_row(6, 30)
 worksheet.set_row(7, 30)
 
 
 # Create a format to use in the merged range.
-merge_format = workbook.add_format({
-    'bold': 1,
-    'border': 1,
-    'align': 'center',
-    'valign': 'vcenter',
-    'fg_color': 'yellow'})
+merge_format = workbook.add_format(
+    {
+        "bold": 1,
+        "border": 1,
+        "align": "center",
+        "valign": "vcenter",
+        "fg_color": "yellow",
+    }
+)
 
 
 # Merge 3 cells.
-worksheet.merge_range('B4:D4', 'Merged Range', merge_format)
+worksheet.merge_range("B4:D4", "Merged Range", merge_format)
 
 # Merge 3 cells over two rows.
-worksheet.merge_range('B7:D8', 'Merged Range', merge_format)
+worksheet.merge_range("B7:D8", "Merged Range", merge_format)
 
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/merge_rich_string.py` & `XlsxWriter-3.1.0/examples/merge_rich_string.py`

 * *Files 19% similar despite different names*

```diff
@@ -6,30 +6,25 @@
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
 
 # Create an new Excel file and add a worksheet.
-workbook = xlsxwriter.Workbook('merge_rich_string.xlsx')
+workbook = xlsxwriter.Workbook("merge_rich_string.xlsx")
 worksheet = workbook.add_worksheet()
 
 # Set up some formats to use.
-red = workbook.add_format({'color': 'red'})
-blue = workbook.add_format({'color': 'blue'})
-cell_format = workbook.add_format({'align': 'center',
-                                   'valign': 'vcenter',
-                                   'border': 1})
+red = workbook.add_format({"color": "red"})
+blue = workbook.add_format({"color": "blue"})
+cell_format = workbook.add_format({"align": "center", "valign": "vcenter", "border": 1})
 
 # We can only write simple types to merged ranges so we write a blank string.
-worksheet.merge_range('B2:E5', "", cell_format)
+worksheet.merge_range("B2:E5", "", cell_format)
 
 # We then overwrite the first merged cell with a rich string. Note that we
 # must also pass the cell format used in the merged cells format at the end.
-worksheet.write_rich_string('B2',
-                            'This is ',
-                            red, 'red',
-                            ' and this is ',
-                            blue, 'blue',
-                            cell_format)
+worksheet.write_rich_string(
+    "B2", "This is ", red, "red", " and this is ", blue, "blue", cell_format
+)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/pandas_autofilter.py` & `XlsxWriter-3.1.0/examples/pandas_autofilter.py`

 * *Files 14% similar despite different names*

```diff
@@ -6,40 +6,40 @@
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 
 import pandas as pd
 
 # Create a Pandas dataframe by reading some data from a space-separated file.
-df = pd.read_csv('autofilter_data.txt', sep=r'\s+')
+df = pd.read_csv("autofilter_data.txt", sep=r"\s+")
 
 # Create a Pandas Excel writer using XlsxWriter as the engine.
-writer = pd.ExcelWriter('pandas_autofilter.xlsx', engine='xlsxwriter')
+writer = pd.ExcelWriter("pandas_autofilter.xlsx", engine="xlsxwriter")
 
 # Convert the dataframe to an XlsxWriter Excel object. We also turn off the
 # index column at the left of the output dataframe.
-df.to_excel(writer, sheet_name='Sheet1', index=False)
+df.to_excel(writer, sheet_name="Sheet1", index=False)
 
 # Get the xlsxwriter workbook and worksheet objects.
-workbook  = writer.book
-worksheet = writer.sheets['Sheet1']
+workbook = writer.book
+worksheet = writer.sheets["Sheet1"]
 
 # Get the dimensions of the dataframe.
 (max_row, max_col) = df.shape
 
 # Make the columns wider for clarity.
-worksheet.set_column(0,  max_col - 1, 12)
+worksheet.set_column(0, max_col - 1, 12)
 
 # Set the autofilter.
 worksheet.autofilter(0, 0, max_row, max_col - 1)
 
 # Add an optional filter criteria. The placeholder "Region" in the filter
 # is ignored and can be any string that adds clarity to the expression.
-worksheet.filter_column(0, 'Region == East')
+worksheet.filter_column(0, "Region == East")
 
 # It isn't enough to just apply the criteria. The rows that don't match
 # must also be hidden. We use Pandas to figure our which rows to hide.
-for row_num in (df.index[(df['Region'] != 'East')].tolist()):
-    worksheet.set_row(row_num + 1, options={'hidden': True})
+for row_num in df.index[(df["Region"] != "East")].tolist():
+    worksheet.set_row(row_num + 1, options={"hidden": True})
 
 # Close the Pandas Excel writer and output the Excel file.
 writer.close()
```

### Comparing `XlsxWriter-3.0.9/examples/pandas_chart.py` & `XlsxWriter-3.1.0/examples/pandas_conditional_format.py`

 * *Files 13% similar despite different names*

```diff
@@ -1,39 +1,33 @@
 ##############################################################################
 #
-# An example of converting a Pandas dataframe to an xlsx file with a chart
-# using Pandas and XlsxWriter.
+# An example of converting a Pandas dataframe to an xlsx file with a
+# conditional formatting using Pandas and XlsxWriter.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 
 import pandas as pd
 
 
 # Create a Pandas dataframe from some data.
-df = pd.DataFrame({'Data': [10, 20, 30, 20, 15, 30, 45]})
+df = pd.DataFrame({"Data": [10, 20, 30, 20, 15, 30, 45]})
 
 # Create a Pandas Excel writer using XlsxWriter as the engine.
-writer = pd.ExcelWriter('pandas_chart.xlsx', engine='xlsxwriter')
+writer = pd.ExcelWriter("pandas_conditional.xlsx", engine="xlsxwriter")
 
 # Convert the dataframe to an XlsxWriter Excel object.
-df.to_excel(writer, sheet_name='Sheet1')
+df.to_excel(writer, sheet_name="Sheet1")
 
 # Get the xlsxwriter workbook and worksheet objects.
-workbook  = writer.book
-worksheet = writer.sheets['Sheet1']
-
-# Create a chart object.
-chart = workbook.add_chart({'type': 'column'})
+workbook = writer.book
+worksheet = writer.sheets["Sheet1"]
 
 # Get the dimensions of the dataframe.
 (max_row, max_col) = df.shape
 
-# Configure the series of the chart from the dataframe data.
-chart.add_series({'values': ['Sheet1', 1, 1, max_row, 1]})
-
-# Insert the chart into the worksheet.
-worksheet.insert_chart(1, 3, chart)
+# Apply a conditional format to the required cell range.
+worksheet.conditional_format(1, max_col, max_row, max_col, {"type": "3_color_scale"})
 
 # Close the Pandas Excel writer and output the Excel file.
 writer.close()
```

### Comparing `XlsxWriter-3.0.9/examples/pandas_chart_columns.py` & `XlsxWriter-3.1.0/examples/pandas_chart_columns.py`

 * *Files 19% similar despite different names*

```diff
@@ -6,52 +6,54 @@
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 
 import pandas as pd
 
 # Some sample data to plot.
-farm_1 = {'Apples': 10, 'Berries': 32, 'Squash': 21, 'Melons': 13, 'Corn': 18}
-farm_2 = {'Apples': 15, 'Berries': 43, 'Squash': 17, 'Melons': 10, 'Corn': 22}
-farm_3 = {'Apples': 6,  'Berries': 24, 'Squash': 22, 'Melons': 16, 'Corn': 30}
-farm_4 = {'Apples': 12, 'Berries': 30, 'Squash': 15, 'Melons': 9,  'Corn': 15}
+farm_1 = {"Apples": 10, "Berries": 32, "Squash": 21, "Melons": 13, "Corn": 18}
+farm_2 = {"Apples": 15, "Berries": 43, "Squash": 17, "Melons": 10, "Corn": 22}
+farm_3 = {"Apples": 6, "Berries": 24, "Squash": 22, "Melons": 16, "Corn": 30}
+farm_4 = {"Apples": 12, "Berries": 30, "Squash": 15, "Melons": 9, "Corn": 15}
 
-data  = [farm_1, farm_2, farm_3, farm_4]
-index = ['Farm 1', 'Farm 2', 'Farm 3', 'Farm 4']
+data = [farm_1, farm_2, farm_3, farm_4]
+index = ["Farm 1", "Farm 2", "Farm 3", "Farm 4"]
 
 # Create a Pandas dataframe from the data.
 df = pd.DataFrame(data, index=index)
 
 # Create a Pandas Excel writer using XlsxWriter as the engine.
-sheet_name = 'Sheet1'
-writer     = pd.ExcelWriter('pandas_chart_columns.xlsx', engine='xlsxwriter')
+sheet_name = "Sheet1"
+writer = pd.ExcelWriter("pandas_chart_columns.xlsx", engine="xlsxwriter")
 df.to_excel(writer, sheet_name=sheet_name)
 
 # Access the XlsxWriter workbook and worksheet objects from the dataframe.
-workbook  = writer.book
+workbook = writer.book
 worksheet = writer.sheets[sheet_name]
 
 # Create a chart object.
-chart = workbook.add_chart({'type': 'column'})
+chart = workbook.add_chart({"type": "column"})
 
 # Some alternative colors for the chart.
-colors = ['#E41A1C', '#377EB8', '#4DAF4A', '#984EA3', '#FF7F00']
+colors = ["#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00"]
 
 # Configure the series of the chart from the dataframe data.
 for col_num in range(1, len(farm_1) + 1):
-    chart.add_series({
-        'name':       ['Sheet1', 0, col_num],
-        'categories': ['Sheet1', 1, 0, 4, 0],
-        'values':     ['Sheet1', 1, col_num, 4, col_num],
-        'fill':       {'color':  colors[col_num - 1]},
-        'overlap':    -10,
-    })
+    chart.add_series(
+        {
+            "name": ["Sheet1", 0, col_num],
+            "categories": ["Sheet1", 1, 0, 4, 0],
+            "values": ["Sheet1", 1, col_num, 4, col_num],
+            "fill": {"color": colors[col_num - 1]},
+            "overlap": -10,
+        }
+    )
 
 # Configure the chart axes.
-chart.set_x_axis({'name': 'Total Produce'})
-chart.set_y_axis({'name': 'Farms', 'major_gridlines': {'visible': False}})
+chart.set_x_axis({"name": "Total Produce"})
+chart.set_y_axis({"name": "Farms", "major_gridlines": {"visible": False}})
 
 # Insert the chart into the worksheet.
 worksheet.insert_chart(1, 5, chart)
 
 # Close the Pandas Excel writer and output the Excel file.
 writer.close()
```

### Comparing `XlsxWriter-3.0.9/examples/pandas_chart_line.py` & `XlsxWriter-3.1.0/examples/pandas_chart_line.py`

 * *Files 14% similar despite different names*

```diff
@@ -7,52 +7,54 @@
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 
 import pandas as pd
 import random
 
 # Create some sample data to plot.
-categories  = ['Node 1', 'Node 2', 'Node 3', 'Node 4']
-index_1     = range(0, 21, 1)
-multi_iter1 = {'index': index_1}
+categories = ["Node 1", "Node 2", "Node 3", "Node 4"]
+index_1 = range(0, 21, 1)
+multi_iter1 = {"index": index_1}
 
 for category in categories:
     multi_iter1[category] = [random.randint(10, 100) for x in index_1]
 
 # Create a Pandas dataframe from the data.
-index_2 = multi_iter1.pop('index')
-df      = pd.DataFrame(multi_iter1, index=index_2)
-df      = df.reindex(columns=sorted(df.columns))
+index_2 = multi_iter1.pop("index")
+df = pd.DataFrame(multi_iter1, index=index_2)
+df = df.reindex(columns=sorted(df.columns))
 
 # Create a Pandas Excel writer using XlsxWriter as the engine.
-sheet_name = 'Sheet1'
-writer     = pd.ExcelWriter('pandas_chart_line.xlsx', engine='xlsxwriter')
+sheet_name = "Sheet1"
+writer = pd.ExcelWriter("pandas_chart_line.xlsx", engine="xlsxwriter")
 df.to_excel(writer, sheet_name=sheet_name)
 
 # Access the XlsxWriter workbook and worksheet objects from the dataframe.
-workbook  = writer.book
+workbook = writer.book
 worksheet = writer.sheets[sheet_name]
 
 # Get the dimensions of the dataframe.
 (max_row, max_col) = df.shape
 
 # Create a chart object.
-chart = workbook.add_chart({'type': 'line'})
+chart = workbook.add_chart({"type": "line"})
 
 # Configure the series of the chart from the dataframe data.
 for i in range(len(categories)):
     col = i + 1
-    chart.add_series({
-        'name':       ['Sheet1', 0, col],
-        'categories': ['Sheet1', 1, 0,   max_row, 0],
-        'values':     ['Sheet1', 1, col, max_row, col],
-    })
+    chart.add_series(
+        {
+            "name": ["Sheet1", 0, col],
+            "categories": ["Sheet1", 1, 0, max_row, 0],
+            "values": ["Sheet1", 1, col, max_row, col],
+        }
+    )
 
 # Configure the chart axes.
-chart.set_x_axis({'name': 'Index'})
-chart.set_y_axis({'name': 'Value', 'major_gridlines': {'visible': False}})
+chart.set_x_axis({"name": "Index"})
+chart.set_y_axis({"name": "Value", "major_gridlines": {"visible": False}})
 
 # Insert the chart into the worksheet.
 worksheet.insert_chart(1, 6, chart)
 
 # Close the Pandas Excel writer and output the Excel file.
 writer.close()
```

### Comparing `XlsxWriter-3.0.9/examples/pandas_column_formats.py` & `XlsxWriter-3.1.0/examples/pandas_column_formats.py`

 * *Files 8% similar despite different names*

```diff
@@ -6,31 +6,34 @@
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 
 import pandas as pd
 
 # Create a Pandas dataframe from some data.
-df = pd.DataFrame({'Numbers':    [1010, 2020, 3030, 2020, 1515, 3030, 4545],
-                   'Percentage': [.1,   .2,   .33,  .25,  .5,   .75,  .45 ],
-})
+df = pd.DataFrame(
+    {
+        "Numbers": [1010, 2020, 3030, 2020, 1515, 3030, 4545],
+        "Percentage": [0.1, 0.2, 0.33, 0.25, 0.5, 0.75, 0.45],
+    }
+)
 
 # Create a Pandas Excel writer using XlsxWriter as the engine.
-writer = pd.ExcelWriter("pandas_column_formats.xlsx", engine='xlsxwriter')
+writer = pd.ExcelWriter("pandas_column_formats.xlsx", engine="xlsxwriter")
 
 # Convert the dataframe to an XlsxWriter Excel object.
-df.to_excel(writer, sheet_name='Sheet1')
+df.to_excel(writer, sheet_name="Sheet1")
 
 # Get the xlsxwriter workbook and worksheet objects.
-workbook  = writer.book
-worksheet = writer.sheets['Sheet1']
+workbook = writer.book
+worksheet = writer.sheets["Sheet1"]
 
 # Add some cell formats.
-format1 = workbook.add_format({'num_format': '#,##0.00'})
-format2 = workbook.add_format({'num_format': '0%'})
+format1 = workbook.add_format({"num_format": "#,##0.00"})
+format2 = workbook.add_format({"num_format": "0%"})
 
 # Note: It isn't possible to format any cells that already have a format such
 # as the index or headers or any cells that contain dates or datetimes.
 
 # Set the column width and format.
 worksheet.set_column(1, 1, 18, format1)
```

### Comparing `XlsxWriter-3.0.9/examples/pandas_conditional_format.py` & `XlsxWriter-3.1.0/examples/pandas_positioning.py`

 * *Files 21% similar despite different names*

```diff
@@ -1,34 +1,33 @@
 ##############################################################################
 #
-# An example of converting a Pandas dataframe to an xlsx file with a
-# conditional formatting using Pandas and XlsxWriter.
+# An example of positioning dataframes in a worksheet using Pandas and
+# XlsxWriter.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 
 import pandas as pd
 
 
-# Create a Pandas dataframe from some data.
-df = pd.DataFrame({'Data': [10, 20, 30, 20, 15, 30, 45]})
+# Create some Pandas dataframes from some data.
+df1 = pd.DataFrame({"Data": [11, 12, 13, 14]})
+df2 = pd.DataFrame({"Data": [21, 22, 23, 24]})
+df3 = pd.DataFrame({"Data": [31, 32, 33, 34]})
+df4 = pd.DataFrame({"Data": [41, 42, 43, 44]})
 
 # Create a Pandas Excel writer using XlsxWriter as the engine.
-writer = pd.ExcelWriter('pandas_conditional.xlsx', engine='xlsxwriter')
+writer = pd.ExcelWriter("pandas_positioning.xlsx", engine="xlsxwriter")
 
-# Convert the dataframe to an XlsxWriter Excel object.
-df.to_excel(writer, sheet_name='Sheet1')
-
-# Get the xlsxwriter workbook and worksheet objects.
-workbook  = writer.book
-worksheet = writer.sheets['Sheet1']
-
-# Get the dimensions of the dataframe.
-(max_row, max_col) = df.shape
-
-# Apply a conditional format to the required cell range.
-worksheet.conditional_format(1, max_col, max_row, max_col,
-                             {'type': '3_color_scale'})
+# Position the dataframes in the worksheet.
+df1.to_excel(writer, sheet_name="Sheet1")  # Default position, cell A1.
+df2.to_excel(writer, sheet_name="Sheet1", startcol=3)
+df3.to_excel(writer, sheet_name="Sheet1", startrow=6)
+
+# It is also possible to write the dataframe without the header and index.
+df4.to_excel(
+    writer, sheet_name="Sheet1", startrow=7, startcol=4, header=False, index=False
+)
 
 # Close the Pandas Excel writer and output the Excel file.
 writer.close()
```

### Comparing `XlsxWriter-3.0.9/examples/pandas_datetime.py` & `XlsxWriter-3.1.0/examples/pandas_datetime.py`

 * *Files 8% similar despite different names*

```diff
@@ -7,40 +7,49 @@
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 
 import pandas as pd
 from datetime import datetime, date
 
 # Create a Pandas dataframe from some datetime data.
-df = pd.DataFrame({'Date and time': [datetime(2015, 1, 1, 11, 30, 55),
-                                     datetime(2015, 1, 2, 1,  20, 33),
-                                     datetime(2015, 1, 3, 11, 10    ),
-                                     datetime(2015, 1, 4, 16, 45, 35),
-                                     datetime(2015, 1, 5, 12, 10, 15)],
-                   'Dates only':    [date(2015, 2, 1),
-                                     date(2015, 2, 2),
-                                     date(2015, 2, 3),
-                                     date(2015, 2, 4),
-                                     date(2015, 2, 5)],
-                   })
+df = pd.DataFrame(
+    {
+        "Date and time": [
+            datetime(2015, 1, 1, 11, 30, 55),
+            datetime(2015, 1, 2, 1, 20, 33),
+            datetime(2015, 1, 3, 11, 10),
+            datetime(2015, 1, 4, 16, 45, 35),
+            datetime(2015, 1, 5, 12, 10, 15),
+        ],
+        "Dates only": [
+            date(2015, 2, 1),
+            date(2015, 2, 2),
+            date(2015, 2, 3),
+            date(2015, 2, 4),
+            date(2015, 2, 5),
+        ],
+    }
+)
 
 # Create a Pandas Excel writer using XlsxWriter as the engine.
 # Also set the default datetime and date formats.
-writer = pd.ExcelWriter("pandas_datetime.xlsx",
-                        engine='xlsxwriter',
-                        datetime_format='mmm d yyyy hh:mm:ss',
-                        date_format='mmmm dd yyyy')
+writer = pd.ExcelWriter(
+    "pandas_datetime.xlsx",
+    engine="xlsxwriter",
+    datetime_format="mmm d yyyy hh:mm:ss",
+    date_format="mmmm dd yyyy",
+)
 
 # Convert the dataframe to an XlsxWriter Excel object.
-df.to_excel(writer, sheet_name='Sheet1')
+df.to_excel(writer, sheet_name="Sheet1")
 
 # Get the xlsxwriter workbook and worksheet objects. in order to set the column
 # widths, to make the dates clearer.
-workbook  = writer.book
-worksheet = writer.sheets['Sheet1']
+workbook = writer.book
+worksheet = writer.sheets["Sheet1"]
 
 # Get the dimensions of the dataframe.
 (max_row, max_col) = df.shape
 
 # Set the column widths, to make the dates clearer.
 worksheet.set_column(1, max_col, 20)
```

### Comparing `XlsxWriter-3.0.9/examples/pandas_header_format.py` & `XlsxWriter-3.1.0/examples/pandas_header_format.py`

 * *Files 14% similar despite different names*

```diff
@@ -7,36 +7,38 @@
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 
 import pandas as pd
 
 # Create a Pandas dataframe from some data.
 data = [10, 20, 30, 40, 50, 60]
-df = pd.DataFrame({'Heading': data,
-                   'Longer heading that should be wrapped' : data})
+df = pd.DataFrame({"Heading": data, "Longer heading that should be wrapped": data})
 
 # Create a Pandas Excel writer using XlsxWriter as the engine.
-writer = pd.ExcelWriter("pandas_header_format.xlsx", engine='xlsxwriter')
+writer = pd.ExcelWriter("pandas_header_format.xlsx", engine="xlsxwriter")
 
 # Convert the dataframe to an XlsxWriter Excel object. Note that we turn off
 # the default header and skip one row to allow us to insert a user defined
 # header.
-df.to_excel(writer, sheet_name='Sheet1', startrow=1, header=False)
+df.to_excel(writer, sheet_name="Sheet1", startrow=1, header=False)
 
 # Get the xlsxwriter workbook and worksheet objects.
-workbook  = writer.book
-worksheet = writer.sheets['Sheet1']
+workbook = writer.book
+worksheet = writer.sheets["Sheet1"]
 
 # Add a header format.
-header_format = workbook.add_format({
-    'bold': True,
-    'text_wrap': True,
-    'valign': 'top',
-    'fg_color': '#D7E4BC',
-    'border': 1})
+header_format = workbook.add_format(
+    {
+        "bold": True,
+        "text_wrap": True,
+        "valign": "top",
+        "fg_color": "#D7E4BC",
+        "border": 1,
+    }
+)
 
 # Write the column headers with the defined format.
 for col_num, value in enumerate(df.columns.values):
     worksheet.write(0, col_num + 1, value, header_format)
 
 # Close the Pandas Excel writer and output the Excel file.
 writer.close()
```

### Comparing `XlsxWriter-3.0.9/examples/pandas_multiple.py` & `XlsxWriter-3.1.0/examples/pandas_multiple.py`

 * *Files 18% similar despite different names*

```diff
@@ -7,21 +7,21 @@
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 
 import pandas as pd
 
 
 # Create some Pandas dataframes from some data.
-df1 = pd.DataFrame({'Data': [11, 12, 13, 14]})
-df2 = pd.DataFrame({'Data': [21, 22, 23, 24]})
-df3 = pd.DataFrame({'Data': [31, 32, 33, 34]})
+df1 = pd.DataFrame({"Data": [11, 12, 13, 14]})
+df2 = pd.DataFrame({"Data": [21, 22, 23, 24]})
+df3 = pd.DataFrame({"Data": [31, 32, 33, 34]})
 
 # Create a Pandas Excel writer using XlsxWriter as the engine.
-writer = pd.ExcelWriter('pandas_multiple.xlsx', engine='xlsxwriter')
+writer = pd.ExcelWriter("pandas_multiple.xlsx", engine="xlsxwriter")
 
 # Write each dataframe to a different worksheet.
-df1.to_excel(writer, sheet_name='Sheet1')
-df2.to_excel(writer, sheet_name='Sheet2')
-df3.to_excel(writer, sheet_name='Sheet3')
+df1.to_excel(writer, sheet_name="Sheet1")
+df2.to_excel(writer, sheet_name="Sheet2")
+df3.to_excel(writer, sheet_name="Sheet3")
 
 # Close the Pandas Excel writer and output the Excel file.
 writer.close()
```

### Comparing `XlsxWriter-3.0.9/examples/pandas_percentage.py` & `XlsxWriter-3.1.0/examples/pandas_percentage.py`

 * *Files 13% similar despite different names*

```diff
@@ -7,33 +7,32 @@
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 
 import pandas as pd
 
 
 # Create a Pandas dataframe from some data.
-df = pd.DataFrame({'Names': ['Anna', 'Arek', 'Arun'],
-                   'Grade': ['100%', '70%',  '85%']})
+df = pd.DataFrame({"Names": ["Anna", "Arek", "Arun"], "Grade": ["100%", "70%", "85%"]})
 
 # Convert the percentage strings to percentage numbers.
-df['Grade'] = df['Grade'].str.replace('%', '')
-df['Grade'] = df['Grade'].astype(float)
-df['Grade'] = df['Grade'].div(100)
+df["Grade"] = df["Grade"].str.replace("%", "")
+df["Grade"] = df["Grade"].astype(float)
+df["Grade"] = df["Grade"].div(100)
 
 # Create a Pandas Excel writer using XlsxWriter as the engine.
-writer = pd.ExcelWriter('pandas_percent.xlsx', engine='xlsxwriter')
+writer = pd.ExcelWriter("pandas_percent.xlsx", engine="xlsxwriter")
 
 # Convert the dataframe to an XlsxWriter Excel object.
-df.to_excel(writer, sheet_name='Sheet1')
+df.to_excel(writer, sheet_name="Sheet1")
 
 # Get the xlsxwriter workbook and worksheet objects.
-workbook  = writer.book
-worksheet = writer.sheets['Sheet1']
+workbook = writer.book
+worksheet = writer.sheets["Sheet1"]
 
 # Add a percent number format.
-percent_format = workbook.add_format({'num_format': '0%'})
+percent_format = workbook.add_format({"num_format": "0%"})
 
 # Apply the number format to Grade column.
 worksheet.set_column(2, 2, None, percent_format)
 
 # Close the Pandas Excel writer and output the Excel file.
 writer.close()
```

### Comparing `XlsxWriter-3.0.9/examples/pandas_positioning.py` & `XlsxWriter-3.1.0/examples/pandas_chart.py`

 * *Files 26% similar despite different names*

```diff
@@ -1,32 +1,39 @@
 ##############################################################################
 #
-# An example of positioning dataframes in a worksheet using Pandas and
-# XlsxWriter.
+# An example of converting a Pandas dataframe to an xlsx file with a chart
+# using Pandas and XlsxWriter.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 
 import pandas as pd
 
 
-# Create some Pandas dataframes from some data.
-df1 = pd.DataFrame({'Data': [11, 12, 13, 14]})
-df2 = pd.DataFrame({'Data': [21, 22, 23, 24]})
-df3 = pd.DataFrame({'Data': [31, 32, 33, 34]})
-df4 = pd.DataFrame({'Data': [41, 42, 43, 44]})
+# Create a Pandas dataframe from some data.
+df = pd.DataFrame({"Data": [10, 20, 30, 20, 15, 30, 45]})
 
 # Create a Pandas Excel writer using XlsxWriter as the engine.
-writer = pd.ExcelWriter('pandas_positioning.xlsx', engine='xlsxwriter')
+writer = pd.ExcelWriter("pandas_chart.xlsx", engine="xlsxwriter")
 
-# Position the dataframes in the worksheet.
-df1.to_excel(writer, sheet_name='Sheet1')  # Default position, cell A1.
-df2.to_excel(writer, sheet_name='Sheet1', startcol=3)
-df3.to_excel(writer, sheet_name='Sheet1', startrow=6)
-
-# It is also possible to write the dataframe without the header and index.
-df4.to_excel(writer, sheet_name='Sheet1',
-             startrow=7, startcol=4, header=False, index=False)
+# Convert the dataframe to an XlsxWriter Excel object.
+df.to_excel(writer, sheet_name="Sheet1")
+
+# Get the xlsxwriter workbook and worksheet objects.
+workbook = writer.book
+worksheet = writer.sheets["Sheet1"]
+
+# Create a chart object.
+chart = workbook.add_chart({"type": "column"})
+
+# Get the dimensions of the dataframe.
+(max_row, max_col) = df.shape
+
+# Configure the series of the chart from the dataframe data.
+chart.add_series({"values": ["Sheet1", 1, 1, max_row, 1]})
+
+# Insert the chart into the worksheet.
+worksheet.insert_chart(1, 3, chart)
 
 # Close the Pandas Excel writer and output the Excel file.
 writer.close()
```

### Comparing `XlsxWriter-3.0.9/examples/pandas_simple.py` & `XlsxWriter-3.1.0/examples/pandas_simple.py`

 * *Files 15% similar despite different names*

```diff
@@ -7,17 +7,17 @@
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 
 import pandas as pd
 
 
 # Create a Pandas dataframe from some data.
-df = pd.DataFrame({'Data': [10, 20, 30, 20, 15, 30, 45]})
+df = pd.DataFrame({"Data": [10, 20, 30, 20, 15, 30, 45]})
 
 # Create a Pandas Excel writer using XlsxWriter as the engine.
-writer = pd.ExcelWriter('pandas_simple.xlsx', engine='xlsxwriter')
+writer = pd.ExcelWriter("pandas_simple.xlsx", engine="xlsxwriter")
 
 # Convert the dataframe to an XlsxWriter Excel object.
-df.to_excel(writer, sheet_name='Sheet1')
+df.to_excel(writer, sheet_name="Sheet1")
 
 # Close the Pandas Excel writer and output the Excel file.
 writer.close()
```

### Comparing `XlsxWriter-3.0.9/examples/pandas_table.py` & `XlsxWriter-3.1.0/examples/pandas_table.py`

 * *Files 16% similar despite different names*

```diff
@@ -9,40 +9,43 @@
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 
 import pandas as pd
 
 # Create a Pandas dataframe from some data.
-df = pd.DataFrame({
-    'Country':    ['China',    'India',    'United States', 'Indonesia'],
-    'Population': [1404338840, 1366938189, 330267887,       269603400],
-    'Rank':       [1,          2,          3,               4]})
+df = pd.DataFrame(
+    {
+        "Country": ["China", "India", "United States", "Indonesia"],
+        "Population": [1404338840, 1366938189, 330267887, 269603400],
+        "Rank": [1, 2, 3, 4],
+    }
+)
 
 # Order the columns if necessary.
-df = df[['Rank', 'Country', 'Population']]
+df = df[["Rank", "Country", "Population"]]
 
 # Create a Pandas Excel writer using XlsxWriter as the engine.
-writer = pd.ExcelWriter('pandas_table.xlsx', engine='xlsxwriter')
+writer = pd.ExcelWriter("pandas_table.xlsx", engine="xlsxwriter")
 
 # Write the dataframe data to XlsxWriter. Turn off the default header and
 # index and skip one row to allow us to insert a user defined header.
-df.to_excel(writer, sheet_name='Sheet1', startrow=1, header=False, index=False)
+df.to_excel(writer, sheet_name="Sheet1", startrow=1, header=False, index=False)
 
 # Get the xlsxwriter workbook and worksheet objects.
 workbook = writer.book
-worksheet = writer.sheets['Sheet1']
+worksheet = writer.sheets["Sheet1"]
 
 # Get the dimensions of the dataframe.
 (max_row, max_col) = df.shape
 
 # Create a list of column headers, to use in add_table().
-column_settings = [{'header': column} for column in df.columns]
+column_settings = [{"header": column} for column in df.columns]
 
 # Add the Excel table structure. Pandas will add the data.
-worksheet.add_table(0, 0, max_row, max_col - 1, {'columns': column_settings})
+worksheet.add_table(0, 0, max_row, max_col - 1, {"columns": column_settings})
 
 # Make the columns wider for clarity.
 worksheet.set_column(0, max_col - 1, 12)
 
 # Close the Pandas Excel writer and output the Excel file.
 writer.close()
```

### Comparing `XlsxWriter-3.0.9/examples/panes.py` & `XlsxWriter-3.1.0/examples/panes.py`

 * *Files 12% similar despite different names*

```diff
@@ -4,109 +4,113 @@
 # worksheet panes.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('panes.xlsx')
+workbook = xlsxwriter.Workbook("panes.xlsx")
 
-worksheet1 = workbook.add_worksheet('Panes 1')
-worksheet2 = workbook.add_worksheet('Panes 2')
-worksheet3 = workbook.add_worksheet('Panes 3')
-worksheet4 = workbook.add_worksheet('Panes 4')
+worksheet1 = workbook.add_worksheet("Panes 1")
+worksheet2 = workbook.add_worksheet("Panes 2")
+worksheet3 = workbook.add_worksheet("Panes 3")
+worksheet4 = workbook.add_worksheet("Panes 4")
 
 #######################################################################
 #
 # Set up some formatting and text to highlight the panes.
 #
-header_format = workbook.add_format({'bold': True,
-                                     'align': 'center',
-                                     'valign': 'vcenter',
-                                     'fg_color': '#D7E4BC',
-                                     'border': 1})
+header_format = workbook.add_format(
+    {
+        "bold": True,
+        "align": "center",
+        "valign": "vcenter",
+        "fg_color": "#D7E4BC",
+        "border": 1,
+    }
+)
 
-center_format = workbook.add_format({'align': 'center'})
+center_format = workbook.add_format({"align": "center"})
 
 
 #######################################################################
 #
 # Example 1. Freeze pane on the top row.
 #
 worksheet1.freeze_panes(1, 0)
 
 # Other sheet formatting.
-worksheet1.set_column('A:I', 16)
+worksheet1.set_column("A:I", 16)
 worksheet1.set_row(0, 20)
-worksheet1.set_selection('C3')
+worksheet1.set_selection("C3")
 
 
 # Some text to demonstrate scrolling.
 for col in range(0, 9):
-    worksheet1.write(0, col, 'Scroll down', header_format)
+    worksheet1.write(0, col, "Scroll down", header_format)
 
 for row in range(1, 100):
     for col in range(0, 9):
         worksheet1.write(row, col, row + 1, center_format)
 
 
 #######################################################################
 #
 # Example 2. Freeze pane on the left column.
 #
 worksheet2.freeze_panes(0, 1)
 
 # Other sheet formatting.
-worksheet2.set_column('A:A', 16)
-worksheet2.set_selection('C3')
+worksheet2.set_column("A:A", 16)
+worksheet2.set_selection("C3")
 
 # Some text to demonstrate scrolling.
 for row in range(0, 50):
-    worksheet2.write(row, 0, 'Scroll right', header_format)
+    worksheet2.write(row, 0, "Scroll right", header_format)
     for col in range(1, 26):
         worksheet2.write(row, col, col, center_format)
 
 
 #######################################################################
 #
 # Example 3. Freeze pane on the top row and left column.
 #
 worksheet3.freeze_panes(1, 1)
 
 # Other sheet formatting.
-worksheet3.set_column('A:Z', 16)
+worksheet3.set_column("A:Z", 16)
 worksheet3.set_row(0, 20)
-worksheet3.set_selection('C3')
-worksheet3.write(0, 0, '', header_format)
+worksheet3.set_selection("C3")
+worksheet3.write(0, 0, "", header_format)
 
 # Some text to demonstrate scrolling.
 for col in range(1, 26):
-    worksheet3.write(0, col, 'Scroll down', header_format)
+    worksheet3.write(0, col, "Scroll down", header_format)
 
 for row in range(1, 50):
-    worksheet3.write(row, 0, 'Scroll right', header_format)
+    worksheet3.write(row, 0, "Scroll right", header_format)
     for col in range(1, 26):
         worksheet3.write(row, col, col, center_format)
 
 
 #######################################################################
 #
 # Example 4. Split pane on the top row and left column.
 #
 # The divisions must be specified in terms of row and column dimensions.
 # The default row height is 15 and the default column width is 8.43
 #
 worksheet4.split_panes(15, 8.43)
 
 # Other sheet formatting.
-worksheet4.set_selection('C3')
+worksheet4.set_selection("C3")
 
 # Some text to demonstrate scrolling.
 for col in range(1, 26):
-    worksheet4.write(0, col, 'Scroll', center_format)
+    worksheet4.write(0, col, "Scroll", center_format)
 
 for row in range(1, 50):
-    worksheet4.write(row, 0, 'Scroll', center_format)
+    worksheet4.write(row, 0, "Scroll", center_format)
     for col in range(1, 26):
         worksheet4.write(row, col, col, center_format)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/polars_chart.py` & `XlsxWriter-3.1.0/examples/polars_chart.py`

 * *Files 8% similar despite different names*

```diff
@@ -1,14 +1,14 @@
 ##############################################################################
 #
 # An example of adding a Polars dataframe to a worksheet created by XlsxWriter
 # and then adding a chart of the data.
 #
-# SPDX-License-Identifier: BSD-2-Clause Copyright 2013-2023, John McNamara,
-# jmcnamara@cpan.org
+# SPDX-License-Identifier: BSD-2-Clause
+# Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 
 import xlsxwriter
 import polars as pl
 
 df = pl.DataFrame({"Data": [10, 20, 30, 20, 15, 30, 45]})
```

### Comparing `XlsxWriter-3.0.9/examples/polars_format_custom.py` & `XlsxWriter-3.1.0/examples/polars_format_custom.py`

 * *Files identical despite different names*

### Comparing `XlsxWriter-3.0.9/examples/polars_format_default.py` & `XlsxWriter-3.1.0/examples/polars_format_default.py`

 * *Files identical despite different names*

### Comparing `XlsxWriter-3.0.9/examples/polars_multiple.py` & `XlsxWriter-3.1.0/examples/polars_multiple.py`

 * *Files identical despite different names*

### Comparing `XlsxWriter-3.0.9/examples/polars_positioning.py` & `XlsxWriter-3.1.0/examples/polars_positioning.py`

 * *Files identical despite different names*

### Comparing `XlsxWriter-3.0.9/examples/polars_sparklines.py` & `XlsxWriter-3.1.0/examples/polars_sparklines.py`

 * *Files identical despite different names*

### Comparing `XlsxWriter-3.0.9/examples/polars_xlsxwriter.py` & `XlsxWriter-3.1.0/examples/polars_xlsxwriter.py`

 * *Files 22% similar despite different names*

```diff
@@ -1,13 +1,13 @@
 ##############################################################################
 #
 # An example of adding a Polars dataframe to a worksheet created by XlsxWriter.
 #
-# SPDX-License-Identifier: BSD-2-Clause Copyright 2013-2023, John McNamara,
-# jmcnamara@cpan.org
+# SPDX-License-Identifier: BSD-2-Clause
+# Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 
 import xlsxwriter
 import polars as pl
 
 with xlsxwriter.Workbook("polars_xlsxwriter.xlsx") as workbook:
     # Create a new worksheet.
```

### Comparing `XlsxWriter-3.0.9/examples/rich_strings.py` & `XlsxWriter-3.1.0/examples/rich_strings.py`

 * *Files 18% similar despite different names*

```diff
@@ -4,50 +4,36 @@
 # i.e., strings with multiple formats.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('rich_strings.xlsx')
+workbook = xlsxwriter.Workbook("rich_strings.xlsx")
 worksheet = workbook.add_worksheet()
 
-worksheet.set_column('A:A', 30)
+worksheet.set_column("A:A", 30)
 
 # Set up some formats to use.
-bold = workbook.add_format({'bold': True})
-italic = workbook.add_format({'italic': True})
-red = workbook.add_format({'color': 'red'})
-blue = workbook.add_format({'color': 'blue'})
-center = workbook.add_format({'align': 'center'})
-superscript = workbook.add_format({'font_script': 1})
+bold = workbook.add_format({"bold": True})
+italic = workbook.add_format({"italic": True})
+red = workbook.add_format({"color": "red"})
+blue = workbook.add_format({"color": "blue"})
+center = workbook.add_format({"align": "center"})
+superscript = workbook.add_format({"font_script": 1})
 
 # Write some strings with multiple formats.
-worksheet.write_rich_string('A1',
-                            'This is ',
-                            bold, 'bold',
-                            ' and this is ',
-                            italic, 'italic')
-
-worksheet.write_rich_string('A3',
-                            'This is ',
-                            red, 'red',
-                            ' and this is ',
-                            blue, 'blue')
-
-worksheet.write_rich_string('A5',
-                            'Some ',
-                            bold, 'bold text',
-                            ' centered',
-                            center)
-
-worksheet.write_rich_string('A7',
-                            italic,
-                            'j = k',
-                            superscript, '(n-1)',
-                            center)
+worksheet.write_rich_string(
+    "A1", "This is ", bold, "bold", " and this is ", italic, "italic"
+)
+
+worksheet.write_rich_string("A3", "This is ", red, "red", " and this is ", blue, "blue")
+
+worksheet.write_rich_string("A5", "Some ", bold, "bold text", " centered", center)
+
+worksheet.write_rich_string("A7", italic, "j = k", superscript, "(n-1)", center)
 
 # If you have formats and segments in a list you can add them like this:
-segments = ['This is ', bold, 'bold', ' and this is ', blue, 'blue']
-worksheet.write_rich_string('A9', *segments)
+segments = ["This is ", bold, "bold", " and this is ", blue, "blue"]
+worksheet.write_rich_string("A9", *segments)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/right_to_left.py` & `XlsxWriter-3.1.0/examples/right_to_left.py`

 * *Files 15% similar despite different names*

```diff
@@ -5,37 +5,37 @@
 # required by some middle eastern versions of Excel.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('right_to_left.xlsx')
+workbook = xlsxwriter.Workbook("right_to_left.xlsx")
 
 # Add two worksheets.
 worksheet1 = workbook.add_worksheet()
 worksheet2 = workbook.add_worksheet()
 
 # Add the cell formats.
-format_left_to_right = workbook.add_format({'reading_order': 1})
-format_right_to_left = workbook.add_format({'reading_order': 2})
+format_left_to_right = workbook.add_format({"reading_order": 1})
+format_right_to_left = workbook.add_format({"reading_order": 2})
 
 # Make the columns wider for clarity.
-worksheet1.set_column('A:A', 25)
-worksheet2.set_column('A:A', 25)
+worksheet1.set_column("A:A", 25)
+worksheet2.set_column("A:A", 25)
 
 # Change the direction for worksheet2.
 worksheet2.right_to_left()
 
 # Write some data to show the difference.
 
 # Standard direction:         | A1 | B1 | C1 | ...
-worksheet1.write('A1', 'نص عربي / English text')  # Default direction.
-worksheet1.write('A2', 'نص عربي / English text', format_left_to_right)
-worksheet1.write('A3', 'نص عربي / English text', format_right_to_left)
+worksheet1.write("A1", "نص عربي / English text")  # Default direction.
+worksheet1.write("A2", "نص عربي / English text", format_left_to_right)
+worksheet1.write("A3", "نص عربي / English text", format_right_to_left)
 
 # Right to left direction:    ... | C1 | B1 | A1 |
-worksheet2.write('A1', 'نص عربي / English text')  # Default direction.
-worksheet2.write('A2', 'نص عربي / English text', format_left_to_right)
-worksheet2.write('A3', 'نص عربي / English text', format_right_to_left)
+worksheet2.write("A1", "نص عربي / English text")  # Default direction.
+worksheet2.write("A2", "نص عربي / English text", format_left_to_right)
+worksheet2.write("A3", "نص عربي / English text", format_right_to_left)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/sparklines1.py` & `XlsxWriter-3.1.0/examples/sparklines1.py`

 * *Files 18% similar despite different names*

```diff
@@ -8,41 +8,38 @@
 # See sparklines2.py for examples of more complex sparkline formatting.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('sparklines1.xlsx')
+workbook = xlsxwriter.Workbook("sparklines1.xlsx")
 worksheet = workbook.add_worksheet()
 
 # Some sample data to plot.
 data = [
     [-2, 2, 3, -1, 0],
     [30, 20, 33, 20, 15],
     [1, -1, -1, 1, -1],
 ]
 
 
 # Write the sample data to the worksheet.
-worksheet.write_row('A1', data[0])
-worksheet.write_row('A2', data[1])
-worksheet.write_row('A3', data[2])
+worksheet.write_row("A1", data[0])
+worksheet.write_row("A2", data[1])
+worksheet.write_row("A3", data[2])
 
 
 # Add a line sparkline (the default) with markers.
-worksheet.add_sparkline('F1', {'range': 'Sheet1!A1:E1',
-                               'markers': True})
+worksheet.add_sparkline("F1", {"range": "Sheet1!A1:E1", "markers": True})
 
 
 # Add a column sparkline with non-default style.
-worksheet.add_sparkline('F2', {'range': 'Sheet1!A2:E2',
-                               'type': 'column',
-                               'style': 12})
+worksheet.add_sparkline("F2", {"range": "Sheet1!A2:E2", "type": "column", "style": 12})
 
 
 # Add a win/loss sparkline with negative values highlighted.
-worksheet.add_sparkline('F3', {'range': 'Sheet1!A3:E3',
-                               'type': 'win_loss',
-                               'negative_points': True})
+worksheet.add_sparkline(
+    "F3", {"range": "Sheet1!A3:E3", "type": "win_loss", "negative_points": True}
+)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/tab_colors.py` & `XlsxWriter-3.1.0/examples/tab_colors.py`

 * *Files 13% similar despite different names*

```diff
@@ -4,23 +4,23 @@
 # and the XlsxWriter module.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('tab_colors.xlsx')
+workbook = xlsxwriter.Workbook("tab_colors.xlsx")
 
 # Set up some worksheets.
 worksheet1 = workbook.add_worksheet()
 worksheet2 = workbook.add_worksheet()
 worksheet3 = workbook.add_worksheet()
 worksheet4 = workbook.add_worksheet()
 
 # Set tab colors
-worksheet1.set_tab_color('red')
-worksheet2.set_tab_color('green')
-worksheet3.set_tab_color('#FF9900')  # Orange
+worksheet1.set_tab_color("red")
+worksheet2.set_tab_color("green")
+worksheet3.set_tab_color("#FF9900")  # Orange
 
 # worksheet4 will have the default color.
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/tables.py` & `XlsxWriter-3.1.0/examples/tables.py`

 * *Files 25% similar despite different names*

```diff
@@ -6,369 +6,403 @@
 # structure that can be referenced in a formula or formatted collectively.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('tables.xlsx')
+workbook = xlsxwriter.Workbook("tables.xlsx")
 worksheet1 = workbook.add_worksheet()
 worksheet2 = workbook.add_worksheet()
 worksheet3 = workbook.add_worksheet()
 worksheet4 = workbook.add_worksheet()
 worksheet5 = workbook.add_worksheet()
 worksheet6 = workbook.add_worksheet()
 worksheet7 = workbook.add_worksheet()
 worksheet8 = workbook.add_worksheet()
 worksheet9 = workbook.add_worksheet()
 worksheet10 = workbook.add_worksheet()
 worksheet11 = workbook.add_worksheet()
 worksheet12 = workbook.add_worksheet()
 worksheet13 = workbook.add_worksheet()
 
-currency_format = workbook.add_format({'num_format': '$#,##0'})
+currency_format = workbook.add_format({"num_format": "$#,##0"})
 
 # Some sample data for the table.
 data = [
-    ['Apples', 10000, 5000, 8000, 6000],
-    ['Pears', 2000, 3000, 4000, 5000],
-    ['Bananas', 6000, 6000, 6500, 6000],
-    ['Oranges', 500, 300, 200, 700],
-
+    ["Apples", 10000, 5000, 8000, 6000],
+    ["Pears", 2000, 3000, 4000, 5000],
+    ["Bananas", 6000, 6000, 6500, 6000],
+    ["Oranges", 500, 300, 200, 700],
 ]
 
 
 ###############################################################################
 #
 # Example 1.
 #
-caption = 'Default table with no data.'
+caption = "Default table with no data."
 
 # Set the columns widths.
-worksheet1.set_column('B:G', 12)
+worksheet1.set_column("B:G", 12)
 
 # Write the caption.
-worksheet1.write('B1', caption)
+worksheet1.write("B1", caption)
 
 # Add a table to the worksheet.
-worksheet1.add_table('B3:F7')
+worksheet1.add_table("B3:F7")
 
 
 ###############################################################################
 #
 # Example 2.
 #
-caption = 'Default table with data.'
+caption = "Default table with data."
 
 # Set the columns widths.
-worksheet2.set_column('B:G', 12)
+worksheet2.set_column("B:G", 12)
 
 # Write the caption.
-worksheet2.write('B1', caption)
+worksheet2.write("B1", caption)
 
 # Add a table to the worksheet.
-worksheet2.add_table('B3:F7', {'data': data})
+worksheet2.add_table("B3:F7", {"data": data})
 
 
 ###############################################################################
 #
 # Example 3.
 #
-caption = 'Table without default autofilter.'
+caption = "Table without default autofilter."
 
 # Set the columns widths.
-worksheet3.set_column('B:G', 12)
+worksheet3.set_column("B:G", 12)
 
 # Write the caption.
-worksheet3.write('B1', caption)
+worksheet3.write("B1", caption)
 
 # Add a table to the worksheet.
-worksheet3.add_table('B3:F7', {'autofilter': 0})
+worksheet3.add_table("B3:F7", {"autofilter": 0})
 
 # Table data can also be written separately, as an array or individual cells.
-worksheet3.write_row('B4', data[0])
-worksheet3.write_row('B5', data[1])
-worksheet3.write_row('B6', data[2])
-worksheet3.write_row('B7', data[3])
+worksheet3.write_row("B4", data[0])
+worksheet3.write_row("B5", data[1])
+worksheet3.write_row("B6", data[2])
+worksheet3.write_row("B7", data[3])
 
 
 ###############################################################################
 #
 # Example 4.
 #
-caption = 'Table without default header row.'
+caption = "Table without default header row."
 
 # Set the columns widths.
-worksheet4.set_column('B:G', 12)
+worksheet4.set_column("B:G", 12)
 
 # Write the caption.
-worksheet4.write('B1', caption)
+worksheet4.write("B1", caption)
 
 # Add a table to the worksheet.
-worksheet4.add_table('B4:F7', {'header_row': 0})
+worksheet4.add_table("B4:F7", {"header_row": 0})
 
 # Table data can also be written separately, as an array or individual cells.
-worksheet4.write_row('B4', data[0])
-worksheet4.write_row('B5', data[1])
-worksheet4.write_row('B6', data[2])
-worksheet4.write_row('B7', data[3])
+worksheet4.write_row("B4", data[0])
+worksheet4.write_row("B5", data[1])
+worksheet4.write_row("B6", data[2])
+worksheet4.write_row("B7", data[3])
 
 
 ###############################################################################
 #
 # Example 5.
 #
 caption = 'Default table with "First Column" and "Last Column" options.'
 
 # Set the columns widths.
-worksheet5.set_column('B:G', 12)
+worksheet5.set_column("B:G", 12)
 
 # Write the caption.
-worksheet5.write('B1', caption)
+worksheet5.write("B1", caption)
 
 # Add a table to the worksheet.
-worksheet5.add_table('B3:F7', {'first_column': 1, 'last_column': 1})
+worksheet5.add_table("B3:F7", {"first_column": 1, "last_column": 1})
 
 # Table data can also be written separately, as an array or individual cells.
-worksheet5.write_row('B4', data[0])
-worksheet5.write_row('B5', data[1])
-worksheet5.write_row('B6', data[2])
-worksheet5.write_row('B7', data[3])
+worksheet5.write_row("B4", data[0])
+worksheet5.write_row("B5", data[1])
+worksheet5.write_row("B6", data[2])
+worksheet5.write_row("B7", data[3])
 
 
 ###############################################################################
 #
 # Example 6.
 #
-caption = 'Table with banded columns but without default banded rows.'
+caption = "Table with banded columns but without default banded rows."
 
 # Set the columns widths.
-worksheet6.set_column('B:G', 12)
+worksheet6.set_column("B:G", 12)
 
 # Write the caption.
-worksheet6.write('B1', caption)
+worksheet6.write("B1", caption)
 
 # Add a table to the worksheet.
-worksheet6.add_table('B3:F7', {'banded_rows': 0, 'banded_columns': 1})
+worksheet6.add_table("B3:F7", {"banded_rows": 0, "banded_columns": 1})
 
 # Table data can also be written separately, as an array or individual cells.
-worksheet6.write_row('B4', data[0])
-worksheet6.write_row('B5', data[1])
-worksheet6.write_row('B6', data[2])
-worksheet6.write_row('B7', data[3])
+worksheet6.write_row("B4", data[0])
+worksheet6.write_row("B5", data[1])
+worksheet6.write_row("B6", data[2])
+worksheet6.write_row("B7", data[3])
 
 
 ###############################################################################
 #
 # Example 7.
 #
-caption = 'Table with user defined column headers.'
+caption = "Table with user defined column headers."
 
 # Set the columns widths.
-worksheet7.set_column('B:G', 12)
+worksheet7.set_column("B:G", 12)
 
 # Write the caption.
-worksheet7.write('B1', caption)
+worksheet7.write("B1", caption)
 
 # Add a table to the worksheet.
-worksheet7.add_table('B3:F7', {'data': data,
-                               'columns': [{'header': 'Product'},
-                                           {'header': 'Quarter 1'},
-                                           {'header': 'Quarter 2'},
-                                           {'header': 'Quarter 3'},
-                                           {'header': 'Quarter 4'},
-                                           ]})
+worksheet7.add_table(
+    "B3:F7",
+    {
+        "data": data,
+        "columns": [
+            {"header": "Product"},
+            {"header": "Quarter 1"},
+            {"header": "Quarter 2"},
+            {"header": "Quarter 3"},
+            {"header": "Quarter 4"},
+        ],
+    },
+)
 
 
 ###############################################################################
 #
 # Example 8.
 #
-caption = 'Table with user defined column headers.'
+caption = "Table with user defined column headers."
 
 # Set the columns widths.
-worksheet8.set_column('B:G', 12)
+worksheet8.set_column("B:G", 12)
 
 # Write the caption.
-worksheet8.write('B1', caption)
+worksheet8.write("B1", caption)
 
 # Formula to use in the table.
-formula = '=SUM(Table8[@[Quarter 1]:[Quarter 4]])'
+formula = "=SUM(Table8[@[Quarter 1]:[Quarter 4]])"
 
 # Add a table to the worksheet.
-worksheet8.add_table('B3:G7', {'data': data,
-                               'columns': [{'header': 'Product'},
-                                           {'header': 'Quarter 1'},
-                                           {'header': 'Quarter 2'},
-                                           {'header': 'Quarter 3'},
-                                           {'header': 'Quarter 4'},
-                                           {'header': 'Year',
-                                            'formula': formula},
-                                           ]})
+worksheet8.add_table(
+    "B3:G7",
+    {
+        "data": data,
+        "columns": [
+            {"header": "Product"},
+            {"header": "Quarter 1"},
+            {"header": "Quarter 2"},
+            {"header": "Quarter 3"},
+            {"header": "Quarter 4"},
+            {"header": "Year", "formula": formula},
+        ],
+    },
+)
 
 
 ###############################################################################
 #
 # Example 9.
 #
-caption = 'Table with totals row (but no caption or totals).'
+caption = "Table with totals row (but no caption or totals)."
 
 # Set the columns widths.
-worksheet9.set_column('B:G', 12)
+worksheet9.set_column("B:G", 12)
 
 # Write the caption.
-worksheet9.write('B1', caption)
+worksheet9.write("B1", caption)
 
 # Formula to use in the table.
-formula = '=SUM(Table9[@[Quarter 1]:[Quarter 4]])'
+formula = "=SUM(Table9[@[Quarter 1]:[Quarter 4]])"
 
 # Add a table to the worksheet.
-worksheet9.add_table('B3:G8', {'data': data,
-                               'total_row': 1,
-                               'columns': [{'header': 'Product'},
-                                           {'header': 'Quarter 1'},
-                                           {'header': 'Quarter 2'},
-                                           {'header': 'Quarter 3'},
-                                           {'header': 'Quarter 4'},
-                                           {'header': 'Year',
-                                            'formula': formula
-                                            },
-                                           ]})
+worksheet9.add_table(
+    "B3:G8",
+    {
+        "data": data,
+        "total_row": 1,
+        "columns": [
+            {"header": "Product"},
+            {"header": "Quarter 1"},
+            {"header": "Quarter 2"},
+            {"header": "Quarter 3"},
+            {"header": "Quarter 4"},
+            {"header": "Year", "formula": formula},
+        ],
+    },
+)
 
 
 ###############################################################################
 #
 # Example 10.
 #
-caption = 'Table with totals row with user captions and functions.'
+caption = "Table with totals row with user captions and functions."
 
 # Set the columns widths.
-worksheet10.set_column('B:G', 12)
+worksheet10.set_column("B:G", 12)
 
 # Write the caption.
-worksheet10.write('B1', caption)
+worksheet10.write("B1", caption)
 
 # Options to use in the table.
-options = {'data': data,
-           'total_row': 1,
-           'columns': [{'header': 'Product', 'total_string': 'Totals'},
-                       {'header': 'Quarter 1', 'total_function': 'sum'},
-                       {'header': 'Quarter 2', 'total_function': 'sum'},
-                       {'header': 'Quarter 3', 'total_function': 'sum'},
-                       {'header': 'Quarter 4', 'total_function': 'sum'},
-                       {'header': 'Year',
-                        'formula': '=SUM(Table10[@[Quarter 1]:[Quarter 4]])',
-                        'total_function': 'sum'
-                        },
-                       ]}
+options = {
+    "data": data,
+    "total_row": 1,
+    "columns": [
+        {"header": "Product", "total_string": "Totals"},
+        {"header": "Quarter 1", "total_function": "sum"},
+        {"header": "Quarter 2", "total_function": "sum"},
+        {"header": "Quarter 3", "total_function": "sum"},
+        {"header": "Quarter 4", "total_function": "sum"},
+        {
+            "header": "Year",
+            "formula": "=SUM(Table10[@[Quarter 1]:[Quarter 4]])",
+            "total_function": "sum",
+        },
+    ],
+}
 
 # Add a table to the worksheet.
-worksheet10.add_table('B3:G8', options)
+worksheet10.add_table("B3:G8", options)
 
 
 ###############################################################################
 #
 # Example 11.
 #
-caption = 'Table with alternative Excel style.'
+caption = "Table with alternative Excel style."
 
 # Set the columns widths.
-worksheet11.set_column('B:G', 12)
+worksheet11.set_column("B:G", 12)
 
 # Write the caption.
-worksheet11.write('B1', caption)
+worksheet11.write("B1", caption)
 
 # Options to use in the table.
-options = {'data': data,
-           'style': 'Table Style Light 11',
-           'total_row': 1,
-           'columns': [{'header': 'Product', 'total_string': 'Totals'},
-                       {'header': 'Quarter 1', 'total_function': 'sum'},
-                       {'header': 'Quarter 2', 'total_function': 'sum'},
-                       {'header': 'Quarter 3', 'total_function': 'sum'},
-                       {'header': 'Quarter 4', 'total_function': 'sum'},
-                       {'header': 'Year',
-                        'formula': '=SUM(Table11[@[Quarter 1]:[Quarter 4]])',
-                        'total_function': 'sum'
-                        },
-                       ]}
+options = {
+    "data": data,
+    "style": "Table Style Light 11",
+    "total_row": 1,
+    "columns": [
+        {"header": "Product", "total_string": "Totals"},
+        {"header": "Quarter 1", "total_function": "sum"},
+        {"header": "Quarter 2", "total_function": "sum"},
+        {"header": "Quarter 3", "total_function": "sum"},
+        {"header": "Quarter 4", "total_function": "sum"},
+        {
+            "header": "Year",
+            "formula": "=SUM(Table11[@[Quarter 1]:[Quarter 4]])",
+            "total_function": "sum",
+        },
+    ],
+}
 
 
 # Add a table to the worksheet.
-worksheet11.add_table('B3:G8', options)
+worksheet11.add_table("B3:G8", options)
 
 
 ###############################################################################
 #
 # Example 12.
 #
-caption = 'Table with Excel style removed.'
+caption = "Table with Excel style removed."
 
 # Set the columns widths.
-worksheet12.set_column('B:G', 12)
+worksheet12.set_column("B:G", 12)
 
 # Write the caption.
-worksheet12.write('B1', caption)
+worksheet12.write("B1", caption)
 
 # Options to use in the table.
-options = {'data': data,
-           'style': None,
-           'total_row': 1,
-           'columns': [{'header': 'Product', 'total_string': 'Totals'},
-                       {'header': 'Quarter 1', 'total_function': 'sum'},
-                       {'header': 'Quarter 2', 'total_function': 'sum'},
-                       {'header': 'Quarter 3', 'total_function': 'sum'},
-                       {'header': 'Quarter 4', 'total_function': 'sum'},
-                       {'header': 'Year',
-                        'formula': '=SUM(Table12[@[Quarter 1]:[Quarter 4]])',
-                        'total_function': 'sum'
-                        },
-                       ]}
+options = {
+    "data": data,
+    "style": None,
+    "total_row": 1,
+    "columns": [
+        {"header": "Product", "total_string": "Totals"},
+        {"header": "Quarter 1", "total_function": "sum"},
+        {"header": "Quarter 2", "total_function": "sum"},
+        {"header": "Quarter 3", "total_function": "sum"},
+        {"header": "Quarter 4", "total_function": "sum"},
+        {
+            "header": "Year",
+            "formula": "=SUM(Table12[@[Quarter 1]:[Quarter 4]])",
+            "total_function": "sum",
+        },
+    ],
+}
 
 
 # Add a table to the worksheet.
-worksheet12.add_table('B3:G8', options)
+worksheet12.add_table("B3:G8", options)
 
 
 ###############################################################################
 #
 # Example 13.
 #
-caption = 'Table with column formats.'
+caption = "Table with column formats."
 
 # Set the columns widths.
-worksheet13.set_column('B:G', 12)
+worksheet13.set_column("B:G", 12)
 
 # Write the caption.
-worksheet13.write('B1', caption)
+worksheet13.write("B1", caption)
 
 # Options to use in the table.
-options = {'data': data,
-           'total_row': 1,
-           'columns': [{'header': 'Product', 'total_string': 'Totals'},
-                       {'header': 'Quarter 1',
-                        'total_function': 'sum',
-                        'format': currency_format,
-                        },
-                       {'header': 'Quarter 2',
-                        'total_function': 'sum',
-                        'format': currency_format,
-                        },
-                       {'header': 'Quarter 3',
-                        'total_function': 'sum',
-                        'format': currency_format,
-                        },
-                       {'header': 'Quarter 4',
-                        'total_function': 'sum',
-                        'format': currency_format,
-                        },
-                       {'header': 'Year',
-                        'formula': '=SUM(Table13[@[Quarter 1]:[Quarter 4]])',
-                        'total_function': 'sum',
-                        'format': currency_format,
-                        },
-                       ]}
+options = {
+    "data": data,
+    "total_row": 1,
+    "columns": [
+        {"header": "Product", "total_string": "Totals"},
+        {
+            "header": "Quarter 1",
+            "total_function": "sum",
+            "format": currency_format,
+        },
+        {
+            "header": "Quarter 2",
+            "total_function": "sum",
+            "format": currency_format,
+        },
+        {
+            "header": "Quarter 3",
+            "total_function": "sum",
+            "format": currency_format,
+        },
+        {
+            "header": "Quarter 4",
+            "total_function": "sum",
+            "format": currency_format,
+        },
+        {
+            "header": "Year",
+            "formula": "=SUM(Table13[@[Quarter 1]:[Quarter 4]])",
+            "total_function": "sum",
+            "format": currency_format,
+        },
+    ],
+}
 
 # Add a table to the worksheet.
-worksheet13.add_table('B3:G8', options)
+worksheet13.add_table("B3:G8", options)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/text_indent.py` & `XlsxWriter-3.1.0/examples/text_indent.py`

 * *Files 20% similar despite different names*

```diff
@@ -5,19 +5,19 @@
 # This program demonstrates the indentation cell format.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('text_indent.xlsx')
+workbook = xlsxwriter.Workbook("text_indent.xlsx")
 
 worksheet = workbook.add_worksheet()
-indent1 = workbook.add_format({'indent': 1})
-indent2 = workbook.add_format({'indent': 2})
+indent1 = workbook.add_format({"indent": 1})
+indent2 = workbook.add_format({"indent": 2})
 
-worksheet.set_column('A:A', 40)
+worksheet.set_column("A:A", 40)
 
-worksheet.write('A1', "This text is indented 1 level", indent1)
-worksheet.write('A2', "This text is indented 2 levels", indent2)
+worksheet.write("A1", "This text is indented 1 level", indent1)
+worksheet.write("A2", "This text is indented 2 levels", indent2)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/textbox.py` & `XlsxWriter-3.1.0/examples/textbox.py`

 * *Files 26% similar despite different names*

```diff
@@ -4,218 +4,202 @@
 # Python and XlsxWriter.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('textbox.xlsx')
+workbook = xlsxwriter.Workbook("textbox.xlsx")
 worksheet = workbook.add_worksheet()
 row = 4
 col = 1
 
 # The examples below show different textbox options and formatting. In each
 # example the text describes the formatting.
 
 
 # Example
-text = 'A simple textbox with some text'
+text = "A simple textbox with some text"
 worksheet.insert_textbox(row, col, text)
 row += 10
 
 # Example
-text = 'A textbox with changed dimensions'
+text = "A textbox with changed dimensions"
 options = {
-    'width': 256,
-    'height': 100,
+    "width": 256,
+    "height": 100,
 }
 worksheet.insert_textbox(row, col, text, options)
 row += 10
 
 # Example
-text = 'A textbox with an offset in the cell'
+text = "A textbox with an offset in the cell"
 options = {
-    'x_offset': 10,
-    'y_offset': 10,
+    "x_offset": 10,
+    "y_offset": 10,
 }
 worksheet.insert_textbox(row, col, text, options)
 row += 10
 
 # Example
-text = 'A textbox with scaling'
+text = "A textbox with scaling"
 options = {
-    'x_scale': 1.5,
-    'y_scale': 0.8,
+    "x_scale": 1.5,
+    "y_scale": 0.8,
 }
 worksheet.insert_textbox(row, col, text, options)
 row += 10
 
 # Example
-text = 'A textbox with some long text that wraps around onto several lines'
+text = "A textbox with some long text that wraps around onto several lines"
 worksheet.insert_textbox(row, col, text)
 row += 10
 
 # Example
-text = 'A textbox\nwith some\nnewlines\n\nand paragraphs'
+text = "A textbox\nwith some\nnewlines\n\nand paragraphs"
 worksheet.insert_textbox(row, col, text)
 row += 10
 
 # Example
-text = 'A textbox with a solid fill background'
+text = "A textbox with a solid fill background"
 options = {
-    'fill': {'color': 'red'},
+    "fill": {"color": "red"},
 }
 worksheet.insert_textbox(row, col, text, options)
 row += 10
 
 # Example
-text = 'A textbox with a no fill background'
+text = "A textbox with a no fill background"
 options = {
-    'fill': {'none': True},
+    "fill": {"none": True},
 }
 worksheet.insert_textbox(row, col, text, options)
 row += 10
 
 # Example
-text = 'A textbox with a gradient fill background'
+text = "A textbox with a gradient fill background"
 options = {
-    'gradient': {'colors': ['#DDEBCF',
-                            '#9CB86E',
-                            '#156B13']},
+    "gradient": {"colors": ["#DDEBCF", "#9CB86E", "#156B13"]},
 }
 worksheet.insert_textbox(row, col, text, options)
 row += 10
 
 # Example
-text = 'A textbox with a user defined border line'
+text = "A textbox with a user defined border line"
 options = {
-    'border': {'color': 'red',
-               'width': 3,
-               'dash_type': 'round_dot'},
+    "border": {"color": "red", "width": 3, "dash_type": "round_dot"},
 }
 worksheet.insert_textbox(row, col, text, options)
 row += 10
 
 # Example
-text = 'A textbox with no border line'
+text = "A textbox with no border line"
 options = {
-    'border': {'none': True},
+    "border": {"none": True},
 }
 worksheet.insert_textbox(row, col, text, options)
 row += 10
 
 # Example
-text = 'Default alignment: top - left'
+text = "Default alignment: top - left"
 worksheet.insert_textbox(row, col, text)
 row += 10
 
 # Example
-text = 'Alignment: top - center'
+text = "Alignment: top - center"
 options = {
-    'align': {'horizontal': 'center'},
+    "align": {"horizontal": "center"},
 }
 worksheet.insert_textbox(row, col, text, options)
 row += 10
 
 # Example
-text = 'Alignment: middle - center'
+text = "Alignment: middle - center"
 options = {
-    'align': {'vertical': 'middle',
-               'horizontal': 'center'},
+    "align": {"vertical": "middle", "horizontal": "center"},
 }
 worksheet.insert_textbox(row, col, text, options)
 row += 10
 
 # Example
-text = 'Alignment: long text line that wraps and is centered'
+text = "Alignment: long text line that wraps and is centered"
 options = {
-    'align': {'vertical': 'middle',
-               'horizontal': 'center',
-               'text': 'center'},
+    "align": {"vertical": "middle", "horizontal": "center", "text": "center"},
 }
 worksheet.insert_textbox(row, col, text, options)
 row += 10
 
 # Example
-text = 'Font properties: bold'
+text = "Font properties: bold"
 options = {
-    'font': {'bold': True},
+    "font": {"bold": True},
 }
 worksheet.insert_textbox(row, col, text, options)
 row += 10
 
 # Example
-text = 'Font properties: various'
+text = "Font properties: various"
 options = {
-    'font': {'bold': True},
+    "font": {"bold": True},
 }
 worksheet.insert_textbox(row, col, text, options)
 row += 10
 
 # Example
-text = 'Font properties: various'
+text = "Font properties: various"
 options = {
-    'font': {'bold': True,
-             'italic': True,
-             'underline': True,
-             'name': 'Arial',
-             'color': 'red',
-             'size': 12}
+    "font": {
+        "bold": True,
+        "italic": True,
+        "underline": True,
+        "name": "Arial",
+        "color": "red",
+        "size": 12,
+    }
 }
 worksheet.insert_textbox(row, col, text, options)
 row += 10
 
 # Example
-text = 'Some text in a textbox with formatting'
+text = "Some text in a textbox with formatting"
 options = {
-    'font': {'color': 'white'},
-    'align': {'vertical': 'middle',
-              'horizontal': 'center'
-              },
-    'gradient': {'colors': ['red', 'blue']},
+    "font": {"color": "white"},
+    "align": {"vertical": "middle", "horizontal": "center"},
+    "gradient": {"colors": ["red", "blue"]},
 }
 worksheet.insert_textbox(row, col, text, options)
 row += 10
 
 # Example
-text = ''
+text = ""
 options = {
-    'textlink': '=$F$185',
+    "textlink": "=$F$185",
 }
-worksheet.write('F185', 'Text in a cell')
+worksheet.write("F185", "Text in a cell")
 worksheet.insert_textbox(row, col, text, options)
 row += 10
 
 # Example
-text = 'Text rotated up'
-options = {
-    'text_rotation': 90
-}
+text = "Text rotated up"
+options = {"text_rotation": 90}
 worksheet.insert_textbox(row, col, text, options)
 row += 10
 
 # Example
-text = 'Text rotated down'
-options = {
-    'text_rotation': -90
-}
+text = "Text rotated down"
+options = {"text_rotation": -90}
 worksheet.insert_textbox(row, col, text, options)
 row += 10
 
 # Example
-text = 'Text rotated vertically'
-options = {
-    'text_rotation': 270
-}
+text = "Text rotated vertically"
+options = {"text_rotation": 270}
 worksheet.insert_textbox(row, col, text, options)
 row += 10
 
 # Example
-text = 'Textbox with hyperlink'
-options = {
-    'url': 'https://github.com/jmcnamara',
-    'tip': 'GitHub'
-}
+text = "Textbox with hyperlink"
+options = {"url": "https://github.com/jmcnamara", "tip": "GitHub"}
 worksheet.insert_textbox(row, col, text, options)
 row += 10
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/tutorial1.py` & `XlsxWriter-3.1.0/examples/tutorial1.py`

 * *Files 15% similar despite different names*

```diff
@@ -8,33 +8,33 @@
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
 # Create a workbook and add a worksheet.
-workbook = xlsxwriter.Workbook('Expenses01.xlsx')
+workbook = xlsxwriter.Workbook("Expenses01.xlsx")
 worksheet = workbook.add_worksheet()
 
 # Some data we want to write to the worksheet.
 expenses = (
-    ['Rent', 1000],
-    ['Gas', 100],
-    ['Food', 300],
-    ['Gym', 50],
+    ["Rent", 1000],
+    ["Gas", 100],
+    ["Food", 300],
+    ["Gym", 50],
 )
 
 # Start from the first cell. Rows and columns are zero indexed.
 row = 0
 col = 0
 
 # Iterate over the data and write it out row by row.
-for item, cost in (expenses):
+for item, cost in expenses:
     worksheet.write(row, col, item)
     worksheet.write(row, col + 1, cost)
     row += 1
 
 # Write a total using a formula.
-worksheet.write(row, 0, 'Total')
-worksheet.write(row, 1, '=SUM(B1:B4)')
+worksheet.write(row, 0, "Total")
+worksheet.write(row, 1, "=SUM(B1:B4)")
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/tutorial2.py` & `XlsxWriter-3.1.0/examples/tutorial2.py`

 * *Files 16% similar despite different names*

```diff
@@ -8,43 +8,43 @@
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
 # Create a workbook and add a worksheet.
-workbook = xlsxwriter.Workbook('Expenses02.xlsx')
+workbook = xlsxwriter.Workbook("Expenses02.xlsx")
 worksheet = workbook.add_worksheet()
 
 # Add a bold format to use to highlight cells.
-bold = workbook.add_format({'bold': True})
+bold = workbook.add_format({"bold": True})
 
 # Add a number format for cells with money.
-money = workbook.add_format({'num_format': '$#,##0'})
+money = workbook.add_format({"num_format": "$#,##0"})
 
 # Write some data header.
-worksheet.write('A1', 'Item', bold)
-worksheet.write('B1', 'Cost', bold)
+worksheet.write("A1", "Item", bold)
+worksheet.write("B1", "Cost", bold)
 
 # Some data we want to write to the worksheet.
 expenses = (
-    ['Rent', 1000],
-    ['Gas', 100],
-    ['Food', 300],
-    ['Gym', 50],
+    ["Rent", 1000],
+    ["Gas", 100],
+    ["Food", 300],
+    ["Gym", 50],
 )
 
 # Start from the first cell below the headers.
 row = 1
 col = 0
 
 # Iterate over the data and write it out row by row.
-for item, cost in (expenses):
+for item, cost in expenses:
     worksheet.write(row, col, item)
     worksheet.write(row, col + 1, cost, money)
     row += 1
 
 # Write a total using a formula.
-worksheet.write(row, 0, 'Total', bold)
-worksheet.write(row, 1, '=SUM(B2:B5)', money)
+worksheet.write(row, 0, "Total", bold)
+worksheet.write(row, 1, "=SUM(B2:B5)", money)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/tutorial3.py` & `XlsxWriter-3.1.0/examples/tutorial3.py`

 * *Files 9% similar despite different names*

```diff
@@ -9,53 +9,53 @@
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 from datetime import datetime
 import xlsxwriter
 
 # Create a workbook and add a worksheet.
-workbook = xlsxwriter.Workbook('Expenses03.xlsx')
+workbook = xlsxwriter.Workbook("Expenses03.xlsx")
 worksheet = workbook.add_worksheet()
 
 # Add a bold format to use to highlight cells.
-bold = workbook.add_format({'bold': 1})
+bold = workbook.add_format({"bold": 1})
 
 # Add a number format for cells with money.
-money_format = workbook.add_format({'num_format': '$#,##0'})
+money_format = workbook.add_format({"num_format": "$#,##0"})
 
 # Add an Excel date format.
-date_format = workbook.add_format({'num_format': 'mmmm d yyyy'})
+date_format = workbook.add_format({"num_format": "mmmm d yyyy"})
 
 # Adjust the column width.
 worksheet.set_column(1, 1, 15)
 
 # Write some data headers.
-worksheet.write('A1', 'Item', bold)
-worksheet.write('B1', 'Date', bold)
-worksheet.write('C1', 'Cost', bold)
+worksheet.write("A1", "Item", bold)
+worksheet.write("B1", "Date", bold)
+worksheet.write("C1", "Cost", bold)
 
 # Some data we want to write to the worksheet.
 expenses = (
-    ['Rent', '2013-01-13', 1000],
-    ['Gas', '2013-01-14', 100],
-    ['Food', '2013-01-16', 300],
-    ['Gym', '2013-01-20', 50],
+    ["Rent", "2013-01-13", 1000],
+    ["Gas", "2013-01-14", 100],
+    ["Food", "2013-01-16", 300],
+    ["Gym", "2013-01-20", 50],
 )
 
 # Start from the first cell below the headers.
 row = 1
 col = 0
 
-for item, date_str, cost in (expenses):
+for item, date_str, cost in expenses:
     # Convert the date string into a datetime object.
     date = datetime.strptime(date_str, "%Y-%m-%d")
 
     worksheet.write_string(row, col, item)
     worksheet.write_datetime(row, col + 1, date, date_format)
     worksheet.write_number(row, col + 2, cost, money_format)
     row += 1
 
 # Write a total using a formula.
-worksheet.write(row, 0, 'Total', bold)
-worksheet.write(row, 2, '=SUM(C2:C5)', money_format)
+worksheet.write(row, 0, "Total", bold)
+worksheet.write(row, 2, "=SUM(C2:C5)", money_format)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/unicode.py` & `XlsxWriter-3.1.0/examples/unicode.py`

 * *Files 5% similar despite different names*

```diff
@@ -6,13 +6,13 @@
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 
 # To write Unicode text in UTF-8 to a xlsxwriter file in Python 3 you just
 # need to encode the file as UTF-8.
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('unicode_python3.xlsx')
+workbook = xlsxwriter.Workbook("unicode_python3.xlsx")
 worksheet = workbook.add_worksheet()
 
-worksheet.write('B3', 'Это фраза на русском!')
+worksheet.write("B3", "Это фраза на русском!")
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/unicode_polish_utf8.py` & `XlsxWriter-3.1.0/examples/unicode_polish_utf8.py`

 * *Files 4% similar despite different names*

```diff
@@ -8,31 +8,31 @@
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
 # Open the input file with the correct encoding.
-textfile = open('unicode_polish_utf8.txt', mode='r', encoding='utf-8')
+textfile = open("unicode_polish_utf8.txt", mode="r", encoding="utf-8")
 
 # Create an new Excel file and convert the text data.
-workbook = xlsxwriter.Workbook('unicode_polish_utf8.xlsx')
+workbook = xlsxwriter.Workbook("unicode_polish_utf8.xlsx")
 worksheet = workbook.add_worksheet()
 
 # Widen the first column to make the text clearer.
-worksheet.set_column('A:A', 50)
+worksheet.set_column("A:A", 50)
 
 # Start from the first cell.
 row = 0
 col = 0
 
 # Read the text file and write it to the worksheet.
 for line in textfile:
     # Ignore the comments in the text file.
-    if line.startswith('#'):
+    if line.startswith("#"):
         continue
 
     # Write any other lines to the worksheet.
     worksheet.write(row, col, line.rstrip("\n"))
     row += 1
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/unicode_polish_utf8.txt` & `XlsxWriter-3.1.0/examples/unicode_polish_utf8.txt`

 * *Files identical despite different names*

### Comparing `XlsxWriter-3.0.9/examples/unicode_shift_jis.py` & `XlsxWriter-3.1.0/examples/unicode_shift_jis.py`

 * *Files 19% similar despite different names*

```diff
@@ -8,31 +8,31 @@
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
 # Open the input file with the correct encoding.
-textfile = open('unicode_shift_jis.txt', mode='r', encoding='shift_jis')
+textfile = open("unicode_shift_jis.txt", mode="r", encoding="shift_jis")
 
 # Create an new Excel file and convert the text data.
-workbook = xlsxwriter.Workbook('unicode_shift_jis.xlsx')
+workbook = xlsxwriter.Workbook("unicode_shift_jis.xlsx")
 worksheet = workbook.add_worksheet()
 
 # Widen the first column to make the text clearer.
-worksheet.set_column('A:A', 50)
+worksheet.set_column("A:A", 50)
 
 # Start from the first cell.
 row = 0
 col = 0
 
 # Read the text file and write it to the worksheet.
 for line in textfile:
     # Ignore the comments in the text file.
-    if line.startswith('#'):
+    if line.startswith("#"):
         continue
 
     # Write any other lines to the worksheet.
     worksheet.write(row, col, line.rstrip("\n"))
     row += 1
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/user_types1.py` & `XlsxWriter-3.1.0/examples/user_types1.py`

 * *Files 9% similar despite different names*

```diff
@@ -5,34 +5,36 @@
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 import uuid
 
+
 # Create a function that will behave like a worksheet write() method.
 #
 # This function takes a UUID and writes it as as string. It should take the
 # parameters shown below and return the return value from the called worksheet
 # write_*() method. In this case it changes the UUID to a string and calls
 # write_string() to write it.
 #
 def write_uuid(worksheet, row, col, token, format=None):
     return worksheet.write_string(row, col, str(token), format)
 
+
 # Set up the workbook as usual.
-workbook = xlsxwriter.Workbook('user_types1.xlsx')
+workbook = xlsxwriter.Workbook("user_types1.xlsx")
 worksheet = workbook.add_worksheet()
 
 # Make the first column wider for clarity.
-worksheet.set_column('A:A', 40)
+worksheet.set_column("A:A", 40)
 
 # Add the write() handler/callback to the worksheet.
 worksheet.add_write_handler(uuid.UUID, write_uuid)
 
 # Create a UUID.
-my_uuid = uuid.uuid3(uuid.NAMESPACE_DNS, 'python.org')
+my_uuid = uuid.uuid3(uuid.NAMESPACE_DNS, "python.org")
 
 # Write the UUID. This would raise a TypeError without the handler.
-worksheet.write('A1', my_uuid)
+worksheet.write("A1", my_uuid)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/user_types2.py` & `XlsxWriter-3.1.0/examples/user_types2.py`

 * *Files 9% similar despite different names*

```diff
@@ -5,36 +5,38 @@
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 import math
 
+
 # Create a function that will behave like a worksheet write() method.
 #
 # This function takes a float and if it is NaN then it writes a blank cell
 # instead. It should take the parameters shown below and return the return
 # value from the called worksheet write_*() method.
 #
 def ignore_nan(worksheet, row, col, number, format=None):
     if math.isnan(number):
         return worksheet.write_blank(row, col, None, format)
     else:
         # Return control to the calling write() method for any other number.
         return None
 
+
 # Set up the workbook as usual.
-workbook = xlsxwriter.Workbook('user_types2.xlsx')
+workbook = xlsxwriter.Workbook("user_types2.xlsx")
 worksheet = workbook.add_worksheet()
 
 
 # Add the write() handler/callback to the worksheet.
 worksheet.add_write_handler(float, ignore_nan)
 
 # Create some data to write.
-my_data = [1, 2, float('nan'), 4, 5]
+my_data = [1, 2, float("nan"), 4, 5]
 
 # Write the data. Note that write_row() calls write() so this will work as
 # expected. Writing NaN values would raise a TypeError without the handler.
-worksheet.write_row('A1', my_data)
+worksheet.write_row("A1", my_data)
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/user_types3.py` & `XlsxWriter-3.1.0/examples/user_types3.py`

 * *Files 14% similar despite different names*

```diff
@@ -4,42 +4,44 @@
 # method.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
+
 # Create a function that changes the worksheet write() method so that it
 # hides/replaces user passwords when writing string data. The password data,
 # based on the sample data structure, will be data in the second column, apart
 # from the header row.
 def hide_password(worksheet, row, col, string, format=None):
     if col == 1 and row > 0:
-        return worksheet.write_string(row, col, '****', format)
+        return worksheet.write_string(row, col, "****", format)
     else:
         return worksheet.write_string(row, col, string, format)
 
+
 # Set up the workbook as usual.
-workbook = xlsxwriter.Workbook('user_types3.xlsx')
+workbook = xlsxwriter.Workbook("user_types3.xlsx")
 worksheet = workbook.add_worksheet()
 
 # Make the headings in the first row bold.
-bold = workbook.add_format({'bold': True})
+bold = workbook.add_format({"bold": True})
 worksheet.set_row(0, None, bold)
 
 # Add the write() handler/callback to the worksheet.
 worksheet.add_write_handler(str, hide_password)
 
 # Create some data to write.
 my_data = [
-    ['Name',    'Password',  'City'],
-    ['Sara',    '$5%^6&',    'Rome'],
-    ['Michele', '123abc',    'Milano'],
-    ['Maria',   'juvexme',   'Torino'],
-    ['Paolo',   'qwerty',    'Fano']
+    ["Name", "Password", "City"],
+    ["Sara", "$5%^6&", "Rome"],
+    ["Michele", "123abc", "Milano"],
+    ["Maria", "juvexme", "Torino"],
+    ["Paolo", "qwerty", "Fano"],
 ]
 
 # Write the data. Note that write_row() calls write() so this will work as
 # expected.
 for row_num, row_data in enumerate(my_data):
     worksheet.write_row(row_num, 0, row_data)
```

### Comparing `XlsxWriter-3.0.9/examples/vbaProject.bin` & `XlsxWriter-3.1.0/examples/vbaProject.bin`

 * *Files identical despite different names*

### Comparing `XlsxWriter-3.0.9/examples/vba_extract.py` & `XlsxWriter-3.1.0/examples/vba_extract.py`

 * *Files 6% similar despite different names*

```diff
@@ -6,37 +6,39 @@
 # Excel 2007+ xlsm file for insertion into an XlsxWriter file.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import sys
 from zipfile import ZipFile
-from zipfile import BadZipfile
+from zipfile import BadZipFile
 
 # The VBA project file we want to extract.
-vba_filename = 'vbaProject.bin'
+vba_filename = "vbaProject.bin"
 
 # Get the xlsm file name from the commandline.
 if len(sys.argv) > 1:
     xlsm_file = sys.argv[1]
 else:
-    print("\nUtility to extract a vbaProject.bin binary from an Excel 2007+ "
-          "xlsm macro file for insertion into an XlsxWriter file."
-          "\n"
-          "See: https://xlsxwriter.readthedocs.io/working_with_macros.html\n"
-          "\n"
-          "Usage: vba_extract file.xlsm\n")
+    print(
+        "\nUtility to extract a vbaProject.bin binary from an Excel 2007+ "
+        "xlsm macro file for insertion into an XlsxWriter file."
+        "\n"
+        "See: https://xlsxwriter.readthedocs.io/working_with_macros.html\n"
+        "\n"
+        "Usage: vba_extract file.xlsm\n"
+    )
     exit()
 
 try:
     # Open the Excel xlsm file as a zip file.
-    xlsm_zip = ZipFile(xlsm_file, 'r')
+    xlsm_zip = ZipFile(xlsm_file, "r")
 
     # Read the xl/vbaProject.bin file.
-    vba_data = xlsm_zip.read('xl/' + vba_filename)
+    vba_data = xlsm_zip.read("xl/" + vba_filename)
 
     # Write the vba data to a local file.
     vba_file = open(vba_filename, "wb")
     vba_file.write(vba_data)
     vba_file.close()
 
 except IOError as e:
@@ -45,15 +47,15 @@
 
 except KeyError as e:
     # Usually when there isn't a xl/vbaProject.bin member in the file.
     print("File error: %s" % str(e))
     print("File may not be an Excel xlsm macro file: '%s'" % xlsm_file)
     exit()
 
-except BadZipfile as e:
+except BadZipFile as e:
     # Usually if the file is an xls file and not an xlsm file.
     print("File error: %s: '%s'" % (str(e), xlsm_file))
     print("File may not be an Excel xlsm macro file.")
     exit()
 
 except Exception as e:
     # Catch any other exceptions.
```

### Comparing `XlsxWriter-3.0.9/examples/watermark.py` & `XlsxWriter-3.1.0/examples/watermark.py`

 * *Files 22% similar despite different names*

```diff
@@ -6,15 +6,14 @@
 # https://support.microsoft.com/en-us/office/add-a-watermark-in-excel-a372182a-d733-484e-825c-18ddf3edf009
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('watermark.xlsx')
+workbook = xlsxwriter.Workbook("watermark.xlsx")
 worksheet = workbook.add_worksheet()
 
 # Set a worksheet header with the watermark image.
-worksheet.set_header('&C&[Picture]',
-                     {'image_center': 'watermark.png'})
+worksheet.set_header("&C&[Picture]", {"image_center": "watermark.png"})
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/examples/worksheet_protection.py` & `XlsxWriter-3.1.0/examples/ignore_errors.py`

 * *Files 26% similar despite different names*

```diff
@@ -1,33 +1,32 @@
-########################################################################
+##############################################################################
 #
-# Example of cell locking and formula hiding in an Excel worksheet
-# using Python and the XlsxWriter module.
+# An example of turning off worksheet cells errors/warnings using the
+# XlsxWriter Python module.
 #
 # SPDX-License-Identifier: BSD-2-Clause
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 import xlsxwriter
 
-workbook = xlsxwriter.Workbook('protection.xlsx')
+workbook = xlsxwriter.Workbook("ignore_errors.xlsx")
 worksheet = workbook.add_worksheet()
 
-# Create some cell formats with protection properties.
-unlocked = workbook.add_format({'locked': False})
-hidden = workbook.add_format({'hidden': True})
-
-# Format the columns to make the text more visible.
-worksheet.set_column('A:A', 40)
-
-# Turn worksheet protection on.
-worksheet.protect()
-
-# Write a locked, unlocked and hidden cell.
-worksheet.write('A1', 'Cell B1 is locked. It cannot be edited.')
-worksheet.write('A2', 'Cell B2 is unlocked. It can be edited.')
-worksheet.write('A3', "Cell B3 is hidden. The formula isn't visible.")
-
-worksheet.write_formula('B1', '=1+2')  # Locked by default.
-worksheet.write_formula('B2', '=1+2', unlocked)
-worksheet.write_formula('B3', '=1+2', hidden)
+# Write strings that looks like numbers. This will cause an Excel warning.
+worksheet.write_string("C2", "123")
+worksheet.write_string("C3", "123")
+
+# Write a divide by zero formula. This will also cause an Excel warning.
+worksheet.write_formula("C5", "=1/0")
+worksheet.write_formula("C6", "=1/0")
+
+# Turn off some of the warnings:
+worksheet.ignore_errors({"number_stored_as_text": "C3", "eval_error": "C6"})
+
+# Write some descriptions for the cells and make the column wider for clarity.
+worksheet.set_column("B:B", 16, None)
+worksheet.write("B2", "Warning:")
+worksheet.write("B3", "Warning turned off:")
+worksheet.write("B5", "Warning:")
+worksheet.write("B6", "Warning turned off:")
 
 workbook.close()
```

### Comparing `XlsxWriter-3.0.9/setup.py` & `XlsxWriter-3.1.0/setup.py`

 * *Files 4% similar despite different names*

```diff
@@ -24,15 +24,15 @@
 
     def run(self):
         errno = subprocess.call(['python',  '-m', 'unittest', 'discover'])
         raise SystemExit(errno)
 
 setup(
     name='XlsxWriter',
-    version='3.0.9',
+    version='3.1.0',
     author='John McNamara',
     author_email='jmcnamara@cpan.org',
     url='https://github.com/jmcnamara/XlsxWriter',
     packages=['xlsxwriter'],
     scripts=['examples/vba_extract.py'],
     cmdclass={'test': PyTest},
     license='BSD-2-Clause',
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/app.py` & `XlsxWriter-3.1.0/xlsxwriter/app.py`

 * *Files 6% similar despite different names*

```diff
@@ -44,16 +44,16 @@
         # Add the name of a workbook Heading Pair such as 'Worksheets',
         # 'Charts' or 'Named Ranges'.
 
         # Ignore empty pairs such as chartsheets.
         if not heading_pair[1]:
             return
 
-        self.heading_pairs.append(('lpstr', heading_pair[0]))
-        self.heading_pairs.append(('i4', heading_pair[1]))
+        self.heading_pairs.append(("lpstr", heading_pair[0]))
+        self.heading_pairs.append(("i4", heading_pair[1]))
 
     def _set_properties(self, properties):
         # Set the document properties.
         self.properties = properties
 
     ###########################################################################
     #
@@ -77,122 +77,122 @@
         self._write_company()
         self._write_links_up_to_date()
         self._write_shared_doc()
         self._write_hyperlink_base()
         self._write_hyperlinks_changed()
         self._write_app_version()
 
-        self._xml_end_tag('Properties')
+        self._xml_end_tag("Properties")
 
         # Close the file.
         self._xml_close()
 
     ###########################################################################
     #
     # XML methods.
     #
     ###########################################################################
 
     def _write_properties(self):
         # Write the <Properties> element.
-        schema = 'http://schemas.openxmlformats.org/officeDocument/2006/'
-        xmlns = schema + 'extended-properties'
-        xmlns_vt = schema + 'docPropsVTypes'
+        schema = "http://schemas.openxmlformats.org/officeDocument/2006/"
+        xmlns = schema + "extended-properties"
+        xmlns_vt = schema + "docPropsVTypes"
 
         attributes = [
-            ('xmlns', xmlns),
-            ('xmlns:vt', xmlns_vt),
+            ("xmlns", xmlns),
+            ("xmlns:vt", xmlns_vt),
         ]
 
-        self._xml_start_tag('Properties', attributes)
+        self._xml_start_tag("Properties", attributes)
 
     def _write_application(self):
         # Write the <Application> element.
-        self._xml_data_element('Application', 'Microsoft Excel')
+        self._xml_data_element("Application", "Microsoft Excel")
 
     def _write_doc_security(self):
         # Write the <DocSecurity> element.
-        self._xml_data_element('DocSecurity', self.doc_security)
+        self._xml_data_element("DocSecurity", self.doc_security)
 
     def _write_scale_crop(self):
         # Write the <ScaleCrop> element.
-        self._xml_data_element('ScaleCrop', 'false')
+        self._xml_data_element("ScaleCrop", "false")
 
     def _write_heading_pairs(self):
         # Write the <HeadingPairs> element.
-        self._xml_start_tag('HeadingPairs')
-        self._write_vt_vector('variant', self.heading_pairs)
-        self._xml_end_tag('HeadingPairs')
+        self._xml_start_tag("HeadingPairs")
+        self._write_vt_vector("variant", self.heading_pairs)
+        self._xml_end_tag("HeadingPairs")
 
     def _write_titles_of_parts(self):
         # Write the <TitlesOfParts> element.
         parts_data = []
 
-        self._xml_start_tag('TitlesOfParts')
+        self._xml_start_tag("TitlesOfParts")
 
         for part_name in self.part_names:
-            parts_data.append(('lpstr', part_name))
+            parts_data.append(("lpstr", part_name))
 
-        self._write_vt_vector('lpstr', parts_data)
+        self._write_vt_vector("lpstr", parts_data)
 
-        self._xml_end_tag('TitlesOfParts')
+        self._xml_end_tag("TitlesOfParts")
 
     def _write_vt_vector(self, base_type, vector_data):
         # Write the <vt:vector> element.
         attributes = [
-            ('size', len(vector_data)),
-            ('baseType', base_type),
+            ("size", len(vector_data)),
+            ("baseType", base_type),
         ]
 
-        self._xml_start_tag('vt:vector', attributes)
+        self._xml_start_tag("vt:vector", attributes)
 
         for vt_data in vector_data:
-            if base_type == 'variant':
-                self._xml_start_tag('vt:variant')
+            if base_type == "variant":
+                self._xml_start_tag("vt:variant")
 
             self._write_vt_data(vt_data)
 
-            if base_type == 'variant':
-                self._xml_end_tag('vt:variant')
+            if base_type == "variant":
+                self._xml_end_tag("vt:variant")
 
-        self._xml_end_tag('vt:vector')
+        self._xml_end_tag("vt:vector")
 
     def _write_vt_data(self, vt_data):
         # Write the <vt:*> elements such as <vt:lpstr> and <vt:if>.
         self._xml_data_element("vt:%s" % vt_data[0], vt_data[1])
 
     def _write_company(self):
-        company = self.properties.get('company', '')
+        company = self.properties.get("company", "")
 
-        self._xml_data_element('Company', company)
+        self._xml_data_element("Company", company)
 
     def _write_manager(self):
         # Write the <Manager> element.
-        if 'manager' not in self.properties:
+        if "manager" not in self.properties:
             return
 
-        self._xml_data_element('Manager', self.properties['manager'])
+        self._xml_data_element("Manager", self.properties["manager"])
 
     def _write_links_up_to_date(self):
         # Write the <LinksUpToDate> element.
-        self._xml_data_element('LinksUpToDate', 'false')
+        self._xml_data_element("LinksUpToDate", "false")
 
     def _write_shared_doc(self):
         # Write the <SharedDoc> element.
-        self._xml_data_element('SharedDoc', 'false')
+        self._xml_data_element("SharedDoc", "false")
 
     def _write_hyperlink_base(self):
         # Write the <HyperlinkBase> element.
-        hyperlink_base = self.properties.get('hyperlink_base')
+        hyperlink_base = self.properties.get("hyperlink_base")
 
         if hyperlink_base is None:
             return
 
-        self._xml_data_element('HyperlinkBase', hyperlink_base)
+        self._xml_data_element("HyperlinkBase", hyperlink_base)
 
     def _write_hyperlinks_changed(self):
         # Write the <HyperlinksChanged> element.
-        self._xml_data_element('HyperlinksChanged', 'false')
+        self._xml_data_element("HyperlinksChanged", "false")
 
     def _write_app_version(self):
         # Write the <AppVersion> element.
-        self._xml_data_element('AppVersion', '12.0000')
+        self._xml_data_element("AppVersion", "12.0000")
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/chart.py` & `XlsxWriter-3.1.0/xlsxwriter/chart.py`

 * *Files 9% similar despite different names*

```diff
@@ -49,39 +49,39 @@
         self.series_index = 0
         self.style_id = 2
         self.axis_ids = []
         self.axis2_ids = []
         self.cat_has_num_fmt = 0
         self.requires_category = False
         self.legend = {}
-        self.cat_axis_position = 'b'
-        self.val_axis_position = 'l'
+        self.cat_axis_position = "b"
+        self.val_axis_position = "l"
         self.formula_ids = {}
         self.formula_data = []
         self.horiz_cat_axis = 0
         self.horiz_val_axis = 1
         self.protection = 0
         self.chartarea = {}
         self.plotarea = {}
         self.x_axis = {}
         self.y_axis = {}
         self.y2_axis = {}
         self.x2_axis = {}
-        self.chart_name = ''
-        self.show_blanks = 'gap'
+        self.chart_name = ""
+        self.show_blanks = "gap"
         self.show_hidden = 0
         self.show_crosses = 1
         self.width = 480
         self.height = 288
         self.x_scale = 1
         self.y_scale = 1
         self.x_offset = 0
         self.y_offset = 0
         self.table = None
-        self.cross_between = 'between'
+        self.cross_between = "between"
         self.default_marker = None
         self.series_gap_1 = None
         self.series_gap_2 = None
         self.series_overlap_1 = None
         self.series_overlap_2 = None
         self.drop_lines = None
         self.hi_low_lines = None
@@ -94,15 +94,15 @@
         self.title_layout = None
         self.title_overlay = None
         self.title_none = False
         self.date_category = False
         self.date_1904 = False
         self.remove_timezone = False
         self.label_positions = {}
-        self.label_position_default = ''
+        self.label_position_default = ""
         self.already_inserted = False
         self.combined = None
         self.is_secondary = False
         self.warn_sheetname = True
         self._set_default_properties()
 
     def add_series(self, options=None):
@@ -117,135 +117,136 @@
 
         """
         # Add a series and it's properties to a chart.
         if options is None:
             options = {}
 
         # Check that the required input has been specified.
-        if 'values' not in options:
+        if "values" not in options:
             warn("Must specify 'values' in add_series()")
             return
 
-        if self.requires_category and 'categories' not in options:
-            warn("Must specify 'categories' in add_series() "
-                 "for this chart type")
+        if self.requires_category and "categories" not in options:
+            warn("Must specify 'categories' in add_series() " "for this chart type")
             return
 
         if len(self.series) == 255:
-            warn("The maximum number of series that can be added to an "
-                 "Excel Chart is 255")
+            warn(
+                "The maximum number of series that can be added to an "
+                "Excel Chart is 255"
+            )
             return
 
         # Convert list into a formula string.
-        values = self._list_to_formula(options.get('values'))
-        categories = self._list_to_formula(options.get('categories'))
+        values = self._list_to_formula(options.get("values"))
+        categories = self._list_to_formula(options.get("categories"))
 
         # Switch name and name_formula parameters if required.
-        name, name_formula = self._process_names(options.get('name'),
-                                                 options.get('name_formula'))
+        name, name_formula = self._process_names(
+            options.get("name"), options.get("name_formula")
+        )
 
         # Get an id for the data equivalent to the range formula.
-        cat_id = self._get_data_id(categories, options.get('categories_data'))
-        val_id = self._get_data_id(values, options.get('values_data'))
-        name_id = self._get_data_id(name_formula, options.get('name_data'))
+        cat_id = self._get_data_id(categories, options.get("categories_data"))
+        val_id = self._get_data_id(values, options.get("values_data"))
+        name_id = self._get_data_id(name_formula, options.get("name_data"))
 
         # Set the line properties for the series.
-        line = Shape._get_line_properties(options.get('line'))
+        line = Shape._get_line_properties(options.get("line"))
 
         # Allow 'border' as a synonym for 'line' in bar/column style charts.
-        if options.get('border'):
-            line = Shape._get_line_properties(options['border'])
+        if options.get("border"):
+            line = Shape._get_line_properties(options["border"])
 
         # Set the fill properties for the series.
-        fill = Shape._get_fill_properties(options.get('fill'))
+        fill = Shape._get_fill_properties(options.get("fill"))
 
         # Set the pattern fill properties for the series.
-        pattern = Shape._get_pattern_properties(options.get('pattern'))
+        pattern = Shape._get_pattern_properties(options.get("pattern"))
 
         # Set the gradient fill properties for the series.
-        gradient = Shape._get_gradient_properties(options.get('gradient'))
+        gradient = Shape._get_gradient_properties(options.get("gradient"))
 
         # Pattern fill overrides solid fill.
         if pattern:
             self.fill = None
 
         # Gradient fill overrides the solid and pattern fill.
         if gradient:
             pattern = None
             fill = None
 
         # Set the marker properties for the series.
-        marker = self._get_marker_properties(options.get('marker'))
+        marker = self._get_marker_properties(options.get("marker"))
 
         # Set the trendline properties for the series.
-        trendline = self._get_trendline_properties(options.get('trendline'))
+        trendline = self._get_trendline_properties(options.get("trendline"))
 
         # Set the line smooth property for the series.
-        smooth = options.get('smooth')
+        smooth = options.get("smooth")
 
         # Set the error bars properties for the series.
-        y_error_bars = self._get_error_bars_props(options.get('y_error_bars'))
-        x_error_bars = self._get_error_bars_props(options.get('x_error_bars'))
+        y_error_bars = self._get_error_bars_props(options.get("y_error_bars"))
+        x_error_bars = self._get_error_bars_props(options.get("x_error_bars"))
 
-        error_bars = {'x_error_bars': x_error_bars,
-                      'y_error_bars': y_error_bars}
+        error_bars = {"x_error_bars": x_error_bars, "y_error_bars": y_error_bars}
 
         # Set the point properties for the series.
-        points = self._get_points_properties(options.get('points'))
+        points = self._get_points_properties(options.get("points"))
 
         # Set the labels properties for the series.
-        labels = self._get_labels_properties(options.get('data_labels'))
+        labels = self._get_labels_properties(options.get("data_labels"))
 
         # Set the "invert if negative" fill property.
-        invert_if_neg = options.get('invert_if_negative', False)
+        invert_if_neg = options.get("invert_if_negative", False)
 
         # Set the secondary axis properties.
-        x2_axis = options.get('x2_axis')
-        y2_axis = options.get('y2_axis')
+        x2_axis = options.get("x2_axis")
+        y2_axis = options.get("y2_axis")
 
         # Store secondary status for combined charts.
         if x2_axis or y2_axis:
             self.is_secondary = True
 
         # Set the gap for Bar/Column charts.
-        if options.get('gap') is not None:
+        if options.get("gap") is not None:
             if y2_axis:
-                self.series_gap_2 = options['gap']
+                self.series_gap_2 = options["gap"]
             else:
-                self.series_gap_1 = options['gap']
+                self.series_gap_1 = options["gap"]
 
         # Set the overlap for Bar/Column charts.
-        if options.get('overlap'):
+        if options.get("overlap"):
             if y2_axis:
-                self.series_overlap_2 = options['overlap']
+                self.series_overlap_2 = options["overlap"]
             else:
-                self.series_overlap_1 = options['overlap']
+                self.series_overlap_1 = options["overlap"]
 
         # Add the user supplied data to the internal structures.
         series = {
-            'values': values,
-            'categories': categories,
-            'name': name,
-            'name_formula': name_formula,
-            'name_id': name_id,
-            'val_data_id': val_id,
-            'cat_data_id': cat_id,
-            'line': line,
-            'fill': fill,
-            'pattern': pattern,
-            'gradient': gradient,
-            'marker': marker,
-            'trendline': trendline,
-            'labels': labels,
-            'invert_if_neg': invert_if_neg,
-            'x2_axis': x2_axis,
-            'y2_axis': y2_axis,
-            'points': points,
-            'error_bars': error_bars,
-            'smooth': smooth
+            "values": values,
+            "categories": categories,
+            "name": name,
+            "name_formula": name_formula,
+            "name_id": name_id,
+            "val_data_id": val_id,
+            "cat_data_id": cat_id,
+            "line": line,
+            "fill": fill,
+            "pattern": pattern,
+            "gradient": gradient,
+            "marker": marker,
+            "trendline": trendline,
+            "labels": labels,
+            "invert_if_neg": invert_if_neg,
+            "x2_axis": x2_axis,
+            "y2_axis": y2_axis,
+            "points": points,
+            "error_bars": error_bars,
+            "smooth": smooth,
         }
 
         self.series.append(series)
 
     def set_x_axis(self, options):
         """
         Set the chart X axis options.
@@ -316,34 +317,34 @@
         Returns:
             Nothing.
 
         """
         if options is None:
             options = {}
 
-        name, name_formula = self._process_names(options.get('name'),
-                                                 options.get('name_formula'))
+        name, name_formula = self._process_names(
+            options.get("name"), options.get("name_formula")
+        )
 
-        data_id = self._get_data_id(name_formula, options.get('data'))
+        data_id = self._get_data_id(name_formula, options.get("data"))
 
         self.title_name = name
         self.title_formula = name_formula
         self.title_data_id = data_id
 
         # Set the font properties if present.
-        self.title_font = self._convert_font_args(options.get('name_font'))
+        self.title_font = self._convert_font_args(options.get("name_font"))
 
         # Set the axis name layout.
-        self.title_layout = self._get_layout_properties(options.get('layout'),
-                                                        True)
+        self.title_layout = self._get_layout_properties(options.get("layout"), True)
         # Set the title overlay option.
-        self.title_overlay = options.get('overlay')
+        self.title_overlay = options.get("overlay")
 
         # Set the automatic title option.
-        self.title_none = options.get('none')
+        self.title_none = options.get("none")
 
     def set_legend(self, options):
         """
         Set the chart legend options.
 
         Args:
             options: A dictionary of chart legend options.
@@ -409,17 +410,17 @@
         Returns:
             Nothing.
         """
         if not option:
             return
 
         valid_options = {
-            'gap': 1,
-            'zero': 1,
-            'span': 1,
+            "gap": 1,
+            "zero": 1,
+            "span": 1,
         }
 
         if option not in valid_options:
             warn("Unknown show_blanks_as() option '%s'" % option)
             return
 
         self.show_blanks = option
@@ -446,20 +447,20 @@
         Returns:
             Nothing.
         """
         if options is None:
             options = {}
 
         # Set dimensions or scale for the chart.
-        self.width = options.get('width', self.width)
-        self.height = options.get('height', self.height)
-        self.x_scale = options.get('x_scale', 1)
-        self.y_scale = options.get('y_scale', 1)
-        self.x_offset = options.get('x_offset', 0)
-        self.y_offset = options.get('y_offset', 0)
+        self.width = options.get("width", self.width)
+        self.height = options.get("height", self.height)
+        self.x_scale = options.get("x_scale", 1)
+        self.y_scale = options.get("y_scale", 1)
+        self.x_offset = options.get("x_offset", 0)
+        self.y_offset = options.get("y_offset", 0)
 
     def set_table(self, options=None):
         """
         Set properties for an axis data table.
 
         Args:
             options: A dictionary of axis table options.
@@ -469,19 +470,19 @@
 
         """
         if options is None:
             options = {}
 
         table = {}
 
-        table['horizontal'] = options.get('horizontal', 1)
-        table['vertical'] = options.get('vertical', 1)
-        table['outline'] = options.get('outline', 1)
-        table['show_keys'] = options.get('show_keys', 0)
-        table['font'] = self._convert_font_args(options.get('font'))
+        table["horizontal"] = options.get("horizontal", 1)
+        table["vertical"] = options.get("vertical", 1)
+        table["outline"] = options.get("outline", 1)
+        table["show_keys"] = options.get("show_keys", 0)
+        table["font"] = self._convert_font_args(options.get("font"))
 
         self.table = table
 
     def set_up_down_bars(self, options=None):
         """
         Set properties for the chart up-down bars.
 
@@ -498,45 +499,47 @@
         # Defaults.
         up_line = None
         up_fill = None
         down_line = None
         down_fill = None
 
         # Set properties for 'up' bar.
-        if options.get('up'):
-            if 'border' in options['up']:
+        if options.get("up"):
+            if "border" in options["up"]:
                 # Map border to line.
-                up_line = Shape._get_line_properties(options['up']['border'])
+                up_line = Shape._get_line_properties(options["up"]["border"])
 
-            if 'line' in options['up']:
-                up_line = Shape._get_line_properties(options['up']['line'])
+            if "line" in options["up"]:
+                up_line = Shape._get_line_properties(options["up"]["line"])
 
-            if 'fill' in options['up']:
-                up_fill = Shape._get_fill_properties(options['up']['fill'])
+            if "fill" in options["up"]:
+                up_fill = Shape._get_fill_properties(options["up"]["fill"])
 
         # Set properties for 'down' bar.
-        if options.get('down'):
-            if 'border' in options['down']:
+        if options.get("down"):
+            if "border" in options["down"]:
                 # Map border to line.
-                down_line = \
-                    Shape._get_line_properties(options['down']['border'])
+                down_line = Shape._get_line_properties(options["down"]["border"])
 
-            if 'line' in options['down']:
-                down_line = Shape._get_line_properties(options['down']['line'])
+            if "line" in options["down"]:
+                down_line = Shape._get_line_properties(options["down"]["line"])
 
-            if 'fill' in options['down']:
-                down_fill = Shape._get_fill_properties(options['down']['fill'])
+            if "fill" in options["down"]:
+                down_fill = Shape._get_fill_properties(options["down"]["fill"])
 
-        self.up_down_bars = {'up': {'line': up_line,
-                                    'fill': up_fill,
-                                    },
-                             'down': {'line': down_line,
-                                      'fill': down_fill,
-                                      },
-                             }
+        self.up_down_bars = {
+            "up": {
+                "line": up_line,
+                "fill": up_fill,
+            },
+            "down": {
+                "line": down_line,
+                "fill": down_fill,
+            },
+        }
 
     def set_drop_lines(self, options=None):
         """
         Set properties for the chart drop lines.
 
         Args:
             options: A dictionary of options.
@@ -544,36 +547,38 @@
         Returns:
             Nothing.
 
         """
         if options is None:
             options = {}
 
-        line = Shape._get_line_properties(options.get('line'))
-        fill = Shape._get_fill_properties(options.get('fill'))
+        line = Shape._get_line_properties(options.get("line"))
+        fill = Shape._get_fill_properties(options.get("fill"))
 
         # Set the pattern fill properties for the series.
-        pattern = Shape._get_pattern_properties(options.get('pattern'))
+        pattern = Shape._get_pattern_properties(options.get("pattern"))
 
         # Set the gradient fill properties for the series.
-        gradient = Shape._get_gradient_properties(options.get('gradient'))
+        gradient = Shape._get_gradient_properties(options.get("gradient"))
 
         # Pattern fill overrides solid fill.
         if pattern:
             self.fill = None
 
         # Gradient fill overrides the solid and pattern fill.
         if gradient:
             pattern = None
             fill = None
 
-        self.drop_lines = {'line': line,
-                           'fill': fill,
-                           'pattern': pattern,
-                           'gradient': gradient}
+        self.drop_lines = {
+            "line": line,
+            "fill": fill,
+            "pattern": pattern,
+            "gradient": gradient,
+        }
 
     def set_high_low_lines(self, options=None):
         """
         Set properties for the chart high-low lines.
 
         Args:
             options: A dictionary of options.
@@ -581,36 +586,38 @@
         Returns:
             Nothing.
 
         """
         if options is None:
             options = {}
 
-        line = Shape._get_line_properties(options.get('line'))
-        fill = Shape._get_fill_properties(options.get('fill'))
+        line = Shape._get_line_properties(options.get("line"))
+        fill = Shape._get_fill_properties(options.get("fill"))
 
         # Set the pattern fill properties for the series.
-        pattern = Shape._get_pattern_properties(options.get('pattern'))
+        pattern = Shape._get_pattern_properties(options.get("pattern"))
 
         # Set the gradient fill properties for the series.
-        gradient = Shape._get_gradient_properties(options.get('gradient'))
+        gradient = Shape._get_gradient_properties(options.get("gradient"))
 
         # Pattern fill overrides solid fill.
         if pattern:
             self.fill = None
 
         # Gradient fill overrides the solid and pattern fill.
         if gradient:
             pattern = None
             fill = None
 
-        self.hi_low_lines = {'line': line,
-                             'fill': fill,
-                             'pattern': pattern,
-                             'gradient': gradient}
+        self.hi_low_lines = {
+            "line": line,
+            "fill": fill,
+            "pattern": pattern,
+            "gradient": gradient,
+        }
 
     def combine(self, chart=None):
         """
         Create a combination chart with a secondary chart.
 
         Args:
             chart: The secondary chart to combine with the primary chart.
@@ -655,257 +662,256 @@
         self._write_sp_pr(self.chartarea)
 
         # Write the c:printSettings element.
         if self.embedded:
             self._write_print_settings()
 
         # Close the worksheet tag.
-        self._xml_end_tag('c:chartSpace')
+        self._xml_end_tag("c:chartSpace")
         # Close the file.
         self._xml_close()
 
     def _convert_axis_args(self, axis, user_options):
         # Convert user defined axis values into private hash values.
-        options = axis['defaults'].copy()
+        options = axis["defaults"].copy()
         options.update(user_options)
 
-        name, name_formula = self._process_names(options.get('name'),
-                                                 options.get('name_formula'))
+        name, name_formula = self._process_names(
+            options.get("name"), options.get("name_formula")
+        )
 
-        data_id = self._get_data_id(name_formula, options.get('data'))
+        data_id = self._get_data_id(name_formula, options.get("data"))
 
         axis = {
-            'defaults': axis['defaults'],
-            'name': name,
-            'formula': name_formula,
-            'data_id': data_id,
-            'reverse': options.get('reverse'),
-            'min': options.get('min'),
-            'max': options.get('max'),
-            'minor_unit': options.get('minor_unit'),
-            'major_unit': options.get('major_unit'),
-            'minor_unit_type': options.get('minor_unit_type'),
-            'major_unit_type': options.get('major_unit_type'),
-            'display_units': options.get('display_units'),
-            'log_base': options.get('log_base'),
-            'crossing': options.get('crossing'),
-            'position_axis': options.get('position_axis'),
-            'position': options.get('position'),
-            'label_position': options.get('label_position'),
-            'label_align': options.get('label_align'),
-            'num_format': options.get('num_format'),
-            'num_format_linked': options.get('num_format_linked'),
-            'interval_unit': options.get('interval_unit'),
-            'interval_tick': options.get('interval_tick'),
-            'text_axis': False,
+            "defaults": axis["defaults"],
+            "name": name,
+            "formula": name_formula,
+            "data_id": data_id,
+            "reverse": options.get("reverse"),
+            "min": options.get("min"),
+            "max": options.get("max"),
+            "minor_unit": options.get("minor_unit"),
+            "major_unit": options.get("major_unit"),
+            "minor_unit_type": options.get("minor_unit_type"),
+            "major_unit_type": options.get("major_unit_type"),
+            "display_units": options.get("display_units"),
+            "log_base": options.get("log_base"),
+            "crossing": options.get("crossing"),
+            "position_axis": options.get("position_axis"),
+            "position": options.get("position"),
+            "label_position": options.get("label_position"),
+            "label_align": options.get("label_align"),
+            "num_format": options.get("num_format"),
+            "num_format_linked": options.get("num_format_linked"),
+            "interval_unit": options.get("interval_unit"),
+            "interval_tick": options.get("interval_tick"),
+            "text_axis": False,
         }
 
-        if 'visible' in options:
-            axis['visible'] = options.get('visible')
+        if "visible" in options:
+            axis["visible"] = options.get("visible")
         else:
-            axis['visible'] = 1
+            axis["visible"] = 1
 
         # Convert the display units.
-        axis['display_units'] = self._get_display_units(axis['display_units'])
-        axis['display_units_visible'] = \
-            options.get('display_units_visible', True)
+        axis["display_units"] = self._get_display_units(axis["display_units"])
+        axis["display_units_visible"] = options.get("display_units_visible", True)
 
         # Map major_gridlines properties.
-        if (options.get('major_gridlines')
-                and options['major_gridlines']['visible']):
-            axis['major_gridlines'] = \
-                self._get_gridline_properties(options['major_gridlines'])
+        if options.get("major_gridlines") and options["major_gridlines"]["visible"]:
+            axis["major_gridlines"] = self._get_gridline_properties(
+                options["major_gridlines"]
+            )
 
         # Map minor_gridlines properties.
-        if (options.get('minor_gridlines')
-                and options['minor_gridlines']['visible']):
-            axis['minor_gridlines'] = \
-                self._get_gridline_properties(options['minor_gridlines'])
+        if options.get("minor_gridlines") and options["minor_gridlines"]["visible"]:
+            axis["minor_gridlines"] = self._get_gridline_properties(
+                options["minor_gridlines"]
+            )
 
         # Only use the first letter of bottom, top, left or right.
-        if axis.get('position'):
-            axis['position'] = axis['position'].lower()[0]
+        if axis.get("position"):
+            axis["position"] = axis["position"].lower()[0]
 
         # Set the position for a category axis on or between the tick marks.
-        if axis.get('position_axis'):
-            if axis['position_axis'] == 'on_tick':
-                axis['position_axis'] = 'midCat'
-            elif axis['position_axis'] == 'between':
+        if axis.get("position_axis"):
+            if axis["position_axis"] == "on_tick":
+                axis["position_axis"] = "midCat"
+            elif axis["position_axis"] == "between":
                 # Doesn't need to be modified.
                 pass
             else:
                 # Otherwise use the default value.
-                axis['position_axis'] = None
+                axis["position_axis"] = None
 
         # Set the category axis as a date axis.
-        if options.get('date_axis'):
+        if options.get("date_axis"):
             self.date_category = True
 
         # Set the category axis as a text axis.
-        if options.get('text_axis'):
+        if options.get("text_axis"):
             self.date_category = False
-            axis['text_axis'] = True
+            axis["text_axis"] = True
 
         # Convert datetime args if required.
-        if axis.get('min') and supported_datetime(axis['min']):
-            axis['min'] = datetime_to_excel_datetime(axis['min'],
-                                                     self.date_1904,
-                                                     self.remove_timezone)
-        if axis.get('max') and supported_datetime(axis['max']):
-            axis['max'] = datetime_to_excel_datetime(axis['max'],
-                                                     self.date_1904,
-                                                     self.remove_timezone)
-        if axis.get('crossing') and supported_datetime(axis['crossing']):
-            axis['crossing'] = datetime_to_excel_datetime(axis['crossing'],
-                                                          self.date_1904,
-                                                          self.remove_timezone)
+        if axis.get("min") and supported_datetime(axis["min"]):
+            axis["min"] = datetime_to_excel_datetime(
+                axis["min"], self.date_1904, self.remove_timezone
+            )
+        if axis.get("max") and supported_datetime(axis["max"]):
+            axis["max"] = datetime_to_excel_datetime(
+                axis["max"], self.date_1904, self.remove_timezone
+            )
+        if axis.get("crossing") and supported_datetime(axis["crossing"]):
+            axis["crossing"] = datetime_to_excel_datetime(
+                axis["crossing"], self.date_1904, self.remove_timezone
+            )
 
         # Set the font properties if present.
-        axis['num_font'] = self._convert_font_args(options.get('num_font'))
-        axis['name_font'] = self._convert_font_args(options.get('name_font'))
+        axis["num_font"] = self._convert_font_args(options.get("num_font"))
+        axis["name_font"] = self._convert_font_args(options.get("name_font"))
 
         # Set the axis name layout.
-        axis['name_layout'] = \
-            self._get_layout_properties(options.get('name_layout'), True)
+        axis["name_layout"] = self._get_layout_properties(
+            options.get("name_layout"), True
+        )
 
         # Set the line properties for the axis.
-        axis['line'] = Shape._get_line_properties(options.get('line'))
+        axis["line"] = Shape._get_line_properties(options.get("line"))
 
         # Set the fill properties for the axis.
-        axis['fill'] = Shape._get_fill_properties(options.get('fill'))
+        axis["fill"] = Shape._get_fill_properties(options.get("fill"))
 
         # Set the pattern fill properties for the series.
-        axis['pattern'] = Shape._get_pattern_properties(options.get('pattern'))
+        axis["pattern"] = Shape._get_pattern_properties(options.get("pattern"))
 
         # Set the gradient fill properties for the series.
-        axis['gradient'] = \
-            Shape._get_gradient_properties(options.get('gradient'))
+        axis["gradient"] = Shape._get_gradient_properties(options.get("gradient"))
 
         # Pattern fill overrides solid fill.
-        if axis.get('pattern'):
-            axis['fill'] = None
+        if axis.get("pattern"):
+            axis["fill"] = None
 
         # Gradient fill overrides the solid and pattern fill.
-        if axis.get('gradient'):
-            axis['pattern'] = None
-            axis['fill'] = None
+        if axis.get("gradient"):
+            axis["pattern"] = None
+            axis["fill"] = None
 
         # Set the tick marker types.
-        axis['minor_tick_mark'] = \
-            self._get_tick_type(options.get('minor_tick_mark'))
-        axis['major_tick_mark'] = \
-            self._get_tick_type(options.get('major_tick_mark'))
+        axis["minor_tick_mark"] = self._get_tick_type(options.get("minor_tick_mark"))
+        axis["major_tick_mark"] = self._get_tick_type(options.get("major_tick_mark"))
 
         return axis
 
     def _convert_font_args(self, options):
         # Convert user defined font values into private dict values.
         if not options:
             return
 
         font = {
-            'name': options.get('name'),
-            'color': options.get('color'),
-            'size': options.get('size'),
-            'bold': options.get('bold'),
-            'italic': options.get('italic'),
-            'underline': options.get('underline'),
-            'pitch_family': options.get('pitch_family'),
-            'charset': options.get('charset'),
-            'baseline': options.get('baseline', 0),
-            'rotation': options.get('rotation'),
+            "name": options.get("name"),
+            "color": options.get("color"),
+            "size": options.get("size"),
+            "bold": options.get("bold"),
+            "italic": options.get("italic"),
+            "underline": options.get("underline"),
+            "pitch_family": options.get("pitch_family"),
+            "charset": options.get("charset"),
+            "baseline": options.get("baseline", 0),
+            "rotation": options.get("rotation"),
         }
 
         # Convert font size units.
-        if font['size']:
-            font['size'] = int(font['size'] * 100)
+        if font["size"]:
+            font["size"] = int(font["size"] * 100)
 
         # Convert rotation into 60,000ths of a degree.
-        if font['rotation']:
-            font['rotation'] = 60000 * int(font['rotation'])
+        if font["rotation"]:
+            font["rotation"] = 60000 * int(font["rotation"])
 
         return font
 
     def _list_to_formula(self, data):
         # Convert and list of row col values to a range formula.
 
         # If it isn't an array ref it is probably a formula already.
         if type(data) is not list:
             # Check for unquoted sheetnames.
-            if (data and ' ' in data and "'" not in data
-                    and self.warn_sheetname):
-                warn("Sheetname in '%s' contains spaces but isn't quoted. "
-                     "This may cause errors in Excel." % data)
+            if data and " " in data and "'" not in data and self.warn_sheetname:
+                warn(
+                    "Sheetname in '%s' contains spaces but isn't quoted. "
+                    "This may cause errors in Excel." % data
+                )
             return data
 
         formula = xl_range_formula(*data)
 
         return formula
 
     def _process_names(self, name, name_formula):
         # Switch name and name_formula parameters if required.
 
         if name is not None:
             if isinstance(name, list):
                 # Convert a list of values into a name formula.
                 cell = xl_rowcol_to_cell(name[1], name[2], True, True)
-                name_formula = quote_sheetname(name[0]) + '!' + cell
-                name = ''
-            elif re.match(r'^=?[^!]+!\$?[A-Z]+\$?[0-9]+', name):
+                name_formula = quote_sheetname(name[0]) + "!" + cell
+                name = ""
+            elif re.match(r"^=?[^!]+!\$?[A-Z]+\$?[0-9]+", name):
                 # Name looks like a formula, use it to set name_formula.
                 name_formula = name
-                name = ''
+                name = ""
 
         return name, name_formula
 
     def _get_data_type(self, data):
         # Find the overall type of the data associated with a series.
 
         # Check for no data in the series.
         if data is None or len(data) == 0:
-            return 'none'
+            return "none"
 
         if isinstance(data[0], list):
-            return 'multi_str'
+            return "multi_str"
 
         # Determine if data is numeric or strings.
         for token in data:
             if token is None:
                 continue
 
             # Check for strings that would evaluate to float like
             # '1.1_1' of ' 1'.
-            if type(token) == str and re.search('[_ ]', token):
+            if type(token) == str and re.search("[_ ]", token):
                 # Assume entire data series is string data.
-                return 'str'
+                return "str"
 
             try:
                 float(token)
             except ValueError:
                 # Not a number. Assume entire data series is string data.
-                return 'str'
+                return "str"
 
         # The series data was all numeric.
-        return 'num'
+        return "num"
 
     def _get_data_id(self, formula, data):
         # Assign an id to a each unique series formula or title/axis formula.
         # Repeated formulas such as for categories get the same id. If the
         # series or title has user specified data associated with it then
         # that is also stored. This data is used to populate cached Excel
         # data when creating a chart. If there is no user defined data then
         # it will be populated by the parent Workbook._add_chart_data().
 
         # Ignore series without a range formula.
         if not formula:
             return
 
         # Strip the leading '=' from the formula.
-        if formula.startswith('='):
-            formula = formula.lstrip('=')
+        if formula.startswith("="):
+            formula = formula.lstrip("=")
 
         # Store the data id in a hash keyed by the formula and store the data
         # in a separate array with the same id.
         if formula not in self.formula_ids:
             # Haven't seen this formula before.
             formula_id = len(self.formula_data)
 
@@ -927,458 +933,449 @@
         if not marker:
             return
 
         # Copy the user defined properties since they will be modified.
         marker = copy.deepcopy(marker)
 
         types = {
-            'automatic': 'automatic',
-            'none': 'none',
-            'square': 'square',
-            'diamond': 'diamond',
-            'triangle': 'triangle',
-            'x': 'x',
-            'star': 'star',
-            'dot': 'dot',
-            'short_dash': 'dot',
-            'dash': 'dash',
-            'long_dash': 'dash',
-            'circle': 'circle',
-            'plus': 'plus',
-            'picture': 'picture',
+            "automatic": "automatic",
+            "none": "none",
+            "square": "square",
+            "diamond": "diamond",
+            "triangle": "triangle",
+            "x": "x",
+            "star": "star",
+            "dot": "dot",
+            "short_dash": "dot",
+            "dash": "dash",
+            "long_dash": "dash",
+            "circle": "circle",
+            "plus": "plus",
+            "picture": "picture",
         }
 
         # Check for valid types.
-        marker_type = marker.get('type')
+        marker_type = marker.get("type")
 
         if marker_type is not None:
-
             if marker_type in types:
-                marker['type'] = types[marker_type]
+                marker["type"] = types[marker_type]
             else:
                 warn("Unknown marker type '%s" % marker_type)
                 return
 
         # Set the line properties for the marker.
-        line = Shape._get_line_properties(marker.get('line'))
+        line = Shape._get_line_properties(marker.get("line"))
 
         # Allow 'border' as a synonym for 'line'.
-        if 'border' in marker:
-            line = Shape._get_line_properties(marker['border'])
+        if "border" in marker:
+            line = Shape._get_line_properties(marker["border"])
 
         # Set the fill properties for the marker.
-        fill = Shape._get_fill_properties(marker.get('fill'))
+        fill = Shape._get_fill_properties(marker.get("fill"))
 
         # Set the pattern fill properties for the series.
-        pattern = Shape._get_pattern_properties(marker.get('pattern'))
+        pattern = Shape._get_pattern_properties(marker.get("pattern"))
 
         # Set the gradient fill properties for the series.
-        gradient = Shape._get_gradient_properties(marker.get('gradient'))
+        gradient = Shape._get_gradient_properties(marker.get("gradient"))
 
         # Pattern fill overrides solid fill.
         if pattern:
             self.fill = None
 
         # Gradient fill overrides the solid and pattern fill.
         if gradient:
             pattern = None
             fill = None
 
-        marker['line'] = line
-        marker['fill'] = fill
-        marker['pattern'] = pattern
-        marker['gradient'] = gradient
+        marker["line"] = line
+        marker["fill"] = fill
+        marker["pattern"] = pattern
+        marker["gradient"] = gradient
 
         return marker
 
     def _get_trendline_properties(self, trendline):
         # Convert user trendline properties to structure required internally.
 
         if not trendline:
             return
 
         # Copy the user defined properties since they will be modified.
         trendline = copy.deepcopy(trendline)
 
         types = {
-            'exponential': 'exp',
-            'linear': 'linear',
-            'log': 'log',
-            'moving_average': 'movingAvg',
-            'polynomial': 'poly',
-            'power': 'power',
+            "exponential": "exp",
+            "linear": "linear",
+            "log": "log",
+            "moving_average": "movingAvg",
+            "polynomial": "poly",
+            "power": "power",
         }
 
         # Check the trendline type.
-        trend_type = trendline.get('type')
+        trend_type = trendline.get("type")
 
         if trend_type in types:
-            trendline['type'] = types[trend_type]
+            trendline["type"] = types[trend_type]
         else:
             warn("Unknown trendline type '%s'" % trend_type)
             return
 
         # Set the line properties for the trendline.
-        line = Shape._get_line_properties(trendline.get('line'))
+        line = Shape._get_line_properties(trendline.get("line"))
 
         # Allow 'border' as a synonym for 'line'.
-        if 'border' in trendline:
-            line = Shape._get_line_properties(trendline['border'])
+        if "border" in trendline:
+            line = Shape._get_line_properties(trendline["border"])
 
         # Set the fill properties for the trendline.
-        fill = Shape._get_fill_properties(trendline.get('fill'))
+        fill = Shape._get_fill_properties(trendline.get("fill"))
 
         # Set the pattern fill properties for the series.
-        pattern = Shape._get_pattern_properties(trendline.get('pattern'))
+        pattern = Shape._get_pattern_properties(trendline.get("pattern"))
 
         # Set the gradient fill properties for the series.
-        gradient = Shape._get_gradient_properties(trendline.get('gradient'))
+        gradient = Shape._get_gradient_properties(trendline.get("gradient"))
 
         # Pattern fill overrides solid fill.
         if pattern:
             self.fill = None
 
         # Gradient fill overrides the solid and pattern fill.
         if gradient:
             pattern = None
             fill = None
 
-        trendline['line'] = line
-        trendline['fill'] = fill
-        trendline['pattern'] = pattern
-        trendline['gradient'] = gradient
+        trendline["line"] = line
+        trendline["fill"] = fill
+        trendline["pattern"] = pattern
+        trendline["gradient"] = gradient
 
         return trendline
 
     def _get_error_bars_props(self, options):
         # Convert user error bars properties to structure required internally.
         if not options:
             return
 
         # Default values.
-        error_bars = {
-            'type': 'fixedVal',
-            'value': 1,
-            'endcap': 1,
-            'direction': 'both'
-        }
+        error_bars = {"type": "fixedVal", "value": 1, "endcap": 1, "direction": "both"}
 
         types = {
-            'fixed': 'fixedVal',
-            'percentage': 'percentage',
-            'standard_deviation': 'stdDev',
-            'standard_error': 'stdErr',
-            'custom': 'cust',
+            "fixed": "fixedVal",
+            "percentage": "percentage",
+            "standard_deviation": "stdDev",
+            "standard_error": "stdErr",
+            "custom": "cust",
         }
 
         # Check the error bars type.
-        error_type = options['type']
+        error_type = options["type"]
 
         if error_type in types:
-            error_bars['type'] = types[error_type]
+            error_bars["type"] = types[error_type]
         else:
             warn("Unknown error bars type '%s" % error_type)
             return
 
         # Set the value for error types that require it.
-        if 'value' in options:
-            error_bars['value'] = options['value']
+        if "value" in options:
+            error_bars["value"] = options["value"]
 
         # Set the end-cap style.
-        if 'end_style' in options:
-            error_bars['endcap'] = options['end_style']
+        if "end_style" in options:
+            error_bars["endcap"] = options["end_style"]
 
         # Set the error bar direction.
-        if 'direction' in options:
-            if options['direction'] == 'minus':
-                error_bars['direction'] = 'minus'
-            elif options['direction'] == 'plus':
-                error_bars['direction'] = 'plus'
+        if "direction" in options:
+            if options["direction"] == "minus":
+                error_bars["direction"] = "minus"
+            elif options["direction"] == "plus":
+                error_bars["direction"] = "plus"
             else:
                 # Default to 'both'.
                 pass
 
         # Set any custom values.
-        error_bars['plus_values'] = options.get('plus_values')
-        error_bars['minus_values'] = options.get('minus_values')
-        error_bars['plus_data'] = options.get('plus_data')
-        error_bars['minus_data'] = options.get('minus_data')
+        error_bars["plus_values"] = options.get("plus_values")
+        error_bars["minus_values"] = options.get("minus_values")
+        error_bars["plus_data"] = options.get("plus_data")
+        error_bars["minus_data"] = options.get("minus_data")
 
         # Set the line properties for the error bars.
-        error_bars['line'] = Shape._get_line_properties(options.get('line'))
+        error_bars["line"] = Shape._get_line_properties(options.get("line"))
 
         return error_bars
 
     def _get_gridline_properties(self, options):
         # Convert user gridline properties to structure required internally.
 
         # Set the visible property for the gridline.
-        gridline = {'visible': options.get('visible')}
+        gridline = {"visible": options.get("visible")}
 
         # Set the line properties for the gridline.
-        gridline['line'] = Shape._get_line_properties(options.get('line'))
+        gridline["line"] = Shape._get_line_properties(options.get("line"))
 
         return gridline
 
     def _get_labels_properties(self, labels):
         # Convert user labels properties to the structure required internally.
 
         if not labels:
             return None
 
         # Copy the user defined properties since they will be modified.
         labels = copy.deepcopy(labels)
 
         # Map user defined label positions to Excel positions.
-        position = labels.get('position')
+        position = labels.get("position")
 
         if position:
             if position in self.label_positions:
                 if position == self.label_position_default:
-                    labels['position'] = None
+                    labels["position"] = None
                 else:
-                    labels['position'] = self.label_positions[position]
+                    labels["position"] = self.label_positions[position]
             else:
-                warn("Unsupported label position '%s' for this chart type"
-                     % position)
+                warn("Unsupported label position '%s' for this chart type" % position)
                 return
 
         # Map the user defined label separator to the Excel separator.
-        separator = labels.get('separator')
+        separator = labels.get("separator")
         separators = {
-            ',': ', ',
-            ';': '; ',
-            '.': '. ',
+            ",": ", ",
+            ";": "; ",
+            ".": ". ",
             "\n": "\n",
-            ' ': ' ',
+            " ": " ",
         }
 
         if separator:
             if separator in separators:
-                labels['separator'] = separators[separator]
+                labels["separator"] = separators[separator]
             else:
                 warn("Unsupported label separator")
                 return
 
         # Set the font properties if present.
-        labels['font'] = self._convert_font_args(labels.get('font'))
+        labels["font"] = self._convert_font_args(labels.get("font"))
 
         # Set the line properties for the labels.
-        line = Shape._get_line_properties(labels.get('line'))
+        line = Shape._get_line_properties(labels.get("line"))
 
         # Allow 'border' as a synonym for 'line'.
-        if 'border' in labels:
-            line = Shape._get_line_properties(labels['border'])
+        if "border" in labels:
+            line = Shape._get_line_properties(labels["border"])
 
         # Set the fill properties for the labels.
-        fill = Shape._get_fill_properties(labels.get('fill'))
+        fill = Shape._get_fill_properties(labels.get("fill"))
 
         # Set the pattern fill properties for the labels.
-        pattern = Shape._get_pattern_properties(labels.get('pattern'))
+        pattern = Shape._get_pattern_properties(labels.get("pattern"))
 
         # Set the gradient fill properties for the labels.
-        gradient = Shape._get_gradient_properties(labels.get('gradient'))
+        gradient = Shape._get_gradient_properties(labels.get("gradient"))
 
         # Pattern fill overrides solid fill.
         if pattern:
             self.fill = None
 
         # Gradient fill overrides the solid and pattern fill.
         if gradient:
             pattern = None
             fill = None
 
-        labels['line'] = line
-        labels['fill'] = fill
-        labels['pattern'] = pattern
-        labels['gradient'] = gradient
-
-        if labels.get('custom'):
+        labels["line"] = line
+        labels["fill"] = fill
+        labels["pattern"] = pattern
+        labels["gradient"] = gradient
 
-            for label in labels['custom']:
+        if labels.get("custom"):
+            for label in labels["custom"]:
                 if label is None:
                     continue
 
-                value = label.get('value')
-                if value and re.match(r'^=?[^!]+!\$?[A-Z]+\$?[0-9]+',
-                                      str(value)):
-                    label['formula'] = value
-
-                formula = label.get('formula')
-                if formula and formula.startswith('='):
-                    label['formula'] = formula.lstrip('=')
+                value = label.get("value")
+                if value and re.match(r"^=?[^!]+!\$?[A-Z]+\$?[0-9]+", str(value)):
+                    label["formula"] = value
+
+                formula = label.get("formula")
+                if formula and formula.startswith("="):
+                    label["formula"] = formula.lstrip("=")
 
-                data_id = self._get_data_id(formula, label.get('data'))
-                label['data_id'] = data_id
+                data_id = self._get_data_id(formula, label.get("data"))
+                label["data_id"] = data_id
 
-                label['font'] = self._convert_font_args(label.get('font'))
+                label["font"] = self._convert_font_args(label.get("font"))
 
                 # Set the line properties for the label.
-                line = Shape._get_line_properties(label.get('line'))
+                line = Shape._get_line_properties(label.get("line"))
 
                 # Allow 'border' as a synonym for 'line'.
-                if 'border' in label:
-                    line = Shape._get_line_properties(label['border'])
+                if "border" in label:
+                    line = Shape._get_line_properties(label["border"])
 
                 # Set the fill properties for the label.
-                fill = Shape._get_fill_properties(label.get('fill'))
+                fill = Shape._get_fill_properties(label.get("fill"))
 
                 # Set the pattern fill properties for the label.
-                pattern = Shape._get_pattern_properties(label.get('pattern'))
+                pattern = Shape._get_pattern_properties(label.get("pattern"))
 
                 # Set the gradient fill properties for the label.
-                gradient = Shape._get_gradient_properties(
-                    label.get('gradient'))
+                gradient = Shape._get_gradient_properties(label.get("gradient"))
 
                 # Pattern fill overrides solid fill.
                 if pattern:
                     self.fill = None
 
                 # Gradient fill overrides the solid and pattern fill.
                 if gradient:
                     pattern = None
                     fill = None
 
-                label['line'] = line
-                label['fill'] = fill
-                label['pattern'] = pattern
-                label['gradient'] = gradient
+                label["line"] = line
+                label["fill"] = fill
+                label["pattern"] = pattern
+                label["gradient"] = gradient
 
         return labels
 
     def _get_area_properties(self, options):
         # Convert user area properties to the structure required internally.
         area = {}
 
         # Set the line properties for the chartarea.
-        line = Shape._get_line_properties(options.get('line'))
+        line = Shape._get_line_properties(options.get("line"))
 
         # Allow 'border' as a synonym for 'line'.
-        if options.get('border'):
-            line = Shape._get_line_properties(options['border'])
+        if options.get("border"):
+            line = Shape._get_line_properties(options["border"])
 
         # Set the fill properties for the chartarea.
-        fill = Shape._get_fill_properties(options.get('fill'))
+        fill = Shape._get_fill_properties(options.get("fill"))
 
         # Set the pattern fill properties for the series.
-        pattern = Shape._get_pattern_properties(options.get('pattern'))
+        pattern = Shape._get_pattern_properties(options.get("pattern"))
 
         # Set the gradient fill properties for the series.
-        gradient = Shape._get_gradient_properties(options.get('gradient'))
+        gradient = Shape._get_gradient_properties(options.get("gradient"))
 
         # Pattern fill overrides solid fill.
         if pattern:
             self.fill = None
 
         # Gradient fill overrides the solid and pattern fill.
         if gradient:
             pattern = None
             fill = None
 
         # Set the plotarea layout.
-        layout = self._get_layout_properties(options.get('layout'), False)
+        layout = self._get_layout_properties(options.get("layout"), False)
 
-        area['line'] = line
-        area['fill'] = fill
-        area['pattern'] = pattern
-        area['layout'] = layout
-        area['gradient'] = gradient
+        area["line"] = line
+        area["fill"] = fill
+        area["pattern"] = pattern
+        area["layout"] = layout
+        area["gradient"] = gradient
 
         return area
 
     def _get_legend_properties(self, options=None):
         # Convert user legend properties to the structure required internally.
         legend = {}
 
         if options is None:
             options = {}
 
-        legend['position'] = options.get('position', 'right')
-        legend['delete_series'] = options.get('delete_series')
-        legend['font'] = self._convert_font_args(options.get('font'))
-        legend['layout'] = self._get_layout_properties(options.get('layout'),
-                                                       False)
+        legend["position"] = options.get("position", "right")
+        legend["delete_series"] = options.get("delete_series")
+        legend["font"] = self._convert_font_args(options.get("font"))
+        legend["layout"] = self._get_layout_properties(options.get("layout"), False)
 
         # Turn off the legend.
-        if options.get('none'):
-            legend['position'] = 'none'
+        if options.get("none"):
+            legend["position"] = "none"
 
         # Set the line properties for the legend.
-        line = Shape._get_line_properties(options.get('line'))
+        line = Shape._get_line_properties(options.get("line"))
 
         # Allow 'border' as a synonym for 'line'.
-        if options.get('border'):
-            line = Shape._get_line_properties(options['border'])
+        if options.get("border"):
+            line = Shape._get_line_properties(options["border"])
 
         # Set the fill properties for the legend.
-        fill = Shape._get_fill_properties(options.get('fill'))
+        fill = Shape._get_fill_properties(options.get("fill"))
 
         # Set the pattern fill properties for the series.
-        pattern = Shape._get_pattern_properties(options.get('pattern'))
+        pattern = Shape._get_pattern_properties(options.get("pattern"))
 
         # Set the gradient fill properties for the series.
-        gradient = Shape._get_gradient_properties(options.get('gradient'))
+        gradient = Shape._get_gradient_properties(options.get("gradient"))
 
         # Pattern fill overrides solid fill.
         if pattern:
             self.fill = None
 
         # Gradient fill overrides the solid and pattern fill.
         if gradient:
             pattern = None
             fill = None
 
         # Set the legend layout.
-        layout = self._get_layout_properties(options.get('layout'), False)
+        layout = self._get_layout_properties(options.get("layout"), False)
 
-        legend['line'] = line
-        legend['fill'] = fill
-        legend['pattern'] = pattern
-        legend['layout'] = layout
-        legend['gradient'] = gradient
+        legend["line"] = line
+        legend["fill"] = fill
+        legend["pattern"] = pattern
+        legend["layout"] = layout
+        legend["gradient"] = gradient
 
         return legend
 
     def _get_layout_properties(self, args, is_text):
         # Convert user defined layout properties to format used internally.
         layout = {}
 
         if not args:
             return
 
         if is_text:
-            properties = ('x', 'y')
+            properties = ("x", "y")
         else:
-            properties = ('x', 'y', 'width', 'height')
+            properties = ("x", "y", "width", "height")
 
         # Check for valid properties.
         for key in args.keys():
             if key not in properties:
                 warn("Property '%s' allowed not in layout options" % key)
                 return
 
         # Set the layout properties.
         for prop in properties:
             if prop not in args.keys():
-                warn("Property '%s' must be specified in layout options"
-                     % prop)
+                warn("Property '%s' must be specified in layout options" % prop)
                 return
 
             value = args[prop]
 
             try:
                 float(value)
             except ValueError:
-                warn("Property '%s' value '%s' must be numeric in layout" %
-                     (prop, value))
+                warn(
+                    "Property '%s' value '%s' must be numeric in layout" % (prop, value)
+                )
                 return
 
             if value < 0 or value > 1:
-                warn("Property '%s' value '%s' must be in range "
-                     "0 < x <= 1 in layout options" % (prop, value))
+                warn(
+                    "Property '%s' value '%s' must be in range "
+                    "0 < x <= 1 in layout options" % (prop, value)
+                )
                 return
 
             # Convert to the format used by Excel for easier testing
             layout[prop] = "%.17g" % value
 
         return layout
 
@@ -1389,85 +1386,81 @@
         if not user_points:
             return
 
         for user_point in user_points:
             point = {}
 
             if user_point is not None:
-
                 # Set the line properties for the point.
-                line = Shape._get_line_properties(user_point.get('line'))
+                line = Shape._get_line_properties(user_point.get("line"))
 
                 # Allow 'border' as a synonym for 'line'.
-                if 'border' in user_point:
-                    line = Shape._get_line_properties(user_point['border'])
+                if "border" in user_point:
+                    line = Shape._get_line_properties(user_point["border"])
 
                 # Set the fill properties for the chartarea.
-                fill = Shape._get_fill_properties(user_point.get('fill'))
+                fill = Shape._get_fill_properties(user_point.get("fill"))
 
                 # Set the pattern fill properties for the series.
-                pattern = \
-                    Shape._get_pattern_properties(user_point.get('pattern'))
+                pattern = Shape._get_pattern_properties(user_point.get("pattern"))
 
                 # Set the gradient fill properties for the series.
-                gradient = \
-                    Shape._get_gradient_properties(user_point.get('gradient'))
+                gradient = Shape._get_gradient_properties(user_point.get("gradient"))
 
                 # Pattern fill overrides solid fill.
                 if pattern:
                     self.fill = None
 
                 # Gradient fill overrides the solid and pattern fill.
                 if gradient:
                     pattern = None
                     fill = None
 
-                point['line'] = line
-                point['fill'] = fill
-                point['pattern'] = pattern
-                point['gradient'] = gradient
+                point["line"] = line
+                point["fill"] = fill
+                point["pattern"] = pattern
+                point["gradient"] = gradient
 
             points.append(point)
 
         return points
 
     def _has_fill_formatting(self, element):
         # Check if a chart element has line, fill or gradient formatting.
         has_fill = False
         has_line = False
-        has_pattern = element.get('pattern')
-        has_gradient = element.get('gradient')
+        has_pattern = element.get("pattern")
+        has_gradient = element.get("gradient")
 
-        if element.get('fill') and element['fill']['defined']:
+        if element.get("fill") and element["fill"]["defined"]:
             has_fill = True
 
-        if element.get('line') and element['line']['defined']:
+        if element.get("line") and element["line"]["defined"]:
             has_line = True
 
-        if (not has_fill and not has_line and not has_pattern
-                and not has_gradient):
+        if not has_fill and not has_line and not has_pattern and not has_gradient:
             return False
         else:
             return True
 
     def _get_display_units(self, display_units):
         # Convert user defined display units to internal units.
         if not display_units:
             return
 
         types = {
-            'hundreds': 'hundreds',
-            'thousands': 'thousands',
-            'ten_thousands': 'tenThousands',
-            'hundred_thousands': 'hundredThousands',
-            'millions': 'millions',
-            'ten_millions': 'tenMillions',
-            'hundred_millions': 'hundredMillions',
-            'billions': 'billions',
-            'trillions': 'trillions',
+            "hundreds": "hundreds",
+            "thousands": "thousands",
+            "ten_thousands": "tenThousands",
+            "hundred_thousands": "hundredThousands",
+            "millions": "millions",
+            "ten_millions": "tenMillions",
+            "hundred_millions": "hundredMillions",
+            "billions": "billions",
+            "trillions": "trillions",
         }
 
         if display_units in types:
             display_units = types[display_units]
         else:
             warn("Unknown display_units type '%s'" % display_units)
             return
@@ -1476,18 +1469,18 @@
 
     def _get_tick_type(self, tick_type):
         # Convert user defined display units to internal units.
         if not tick_type:
             return
 
         types = {
-            'outside': 'out',
-            'inside': 'in',
-            'none': 'none',
-            'cross': 'cross',
+            "outside": "out",
+            "inside": "in",
+            "none": "none",
+            "cross": "cross",
         }
 
         if tick_type in types:
             tick_type = types[tick_type]
         else:
             warn("Unknown tick_type  '%s'" % tick_type)
             return
@@ -1495,70 +1488,70 @@
         return tick_type
 
     def _get_primary_axes_series(self):
         # Returns series which use the primary axes.
         primary_axes_series = []
 
         for series in self.series:
-            if not series['y2_axis']:
+            if not series["y2_axis"]:
                 primary_axes_series.append(series)
 
         return primary_axes_series
 
     def _get_secondary_axes_series(self):
         # Returns series which use the secondary axes.
         secondary_axes_series = []
 
         for series in self.series:
-            if series['y2_axis']:
+            if series["y2_axis"]:
                 secondary_axes_series.append(series)
 
         return secondary_axes_series
 
     def _add_axis_ids(self, args):
         # Add unique ids for primary or secondary axes
         chart_id = 5001 + int(self.id)
         axis_count = 1 + len(self.axis2_ids) + len(self.axis_ids)
 
-        id1 = '%04d%04d' % (chart_id, axis_count)
-        id2 = '%04d%04d' % (chart_id, axis_count + 1)
+        id1 = "%04d%04d" % (chart_id, axis_count)
+        id2 = "%04d%04d" % (chart_id, axis_count + 1)
 
-        if args['primary_axes']:
+        if args["primary_axes"]:
             self.axis_ids.append(id1)
             self.axis_ids.append(id2)
 
-        if not args['primary_axes']:
+        if not args["primary_axes"]:
             self.axis2_ids.append(id1)
             self.axis2_ids.append(id2)
 
     def _set_default_properties(self):
         # Setup the default properties for a chart.
 
-        self.x_axis['defaults'] = {
-            'num_format': 'General',
-            'major_gridlines': {'visible': 0}
+        self.x_axis["defaults"] = {
+            "num_format": "General",
+            "major_gridlines": {"visible": 0},
         }
 
-        self.y_axis['defaults'] = {
-            'num_format': 'General',
-            'major_gridlines': {'visible': 1}
+        self.y_axis["defaults"] = {
+            "num_format": "General",
+            "major_gridlines": {"visible": 1},
         }
 
-        self.x2_axis['defaults'] = {
-            'num_format': 'General',
-            'label_position': 'none',
-            'crossing': 'max',
-            'visible': 0
+        self.x2_axis["defaults"] = {
+            "num_format": "General",
+            "label_position": "none",
+            "crossing": "max",
+            "visible": 0,
         }
 
-        self.y2_axis['defaults'] = {
-            'num_format': 'General',
-            'major_gridlines': {'visible': 0},
-            'position': 'right',
-            'visible': 1
+        self.y2_axis["defaults"] = {
+            "num_format": "General",
+            "major_gridlines": {"visible": 0},
+            "position": "right",
+            "visible": 1,
         }
 
         self.set_x_axis({})
         self.set_y_axis({})
 
         self.set_x2_axis({})
         self.set_y2_axis({})
@@ -1567,106 +1560,110 @@
     #
     # XML methods.
     #
     ###########################################################################
 
     def _write_chart_space(self):
         # Write the <c:chartSpace> element.
-        schema = 'http://schemas.openxmlformats.org/'
-        xmlns_c = schema + 'drawingml/2006/chart'
-        xmlns_a = schema + 'drawingml/2006/main'
-        xmlns_r = schema + 'officeDocument/2006/relationships'
+        schema = "http://schemas.openxmlformats.org/"
+        xmlns_c = schema + "drawingml/2006/chart"
+        xmlns_a = schema + "drawingml/2006/main"
+        xmlns_r = schema + "officeDocument/2006/relationships"
 
         attributes = [
-            ('xmlns:c', xmlns_c),
-            ('xmlns:a', xmlns_a),
-            ('xmlns:r', xmlns_r),
+            ("xmlns:c", xmlns_c),
+            ("xmlns:a", xmlns_a),
+            ("xmlns:r", xmlns_r),
         ]
 
-        self._xml_start_tag('c:chartSpace', attributes)
+        self._xml_start_tag("c:chartSpace", attributes)
 
     def _write_lang(self):
         # Write the <c:lang> element.
-        val = 'en-US'
+        val = "en-US"
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:lang', attributes)
+        self._xml_empty_tag("c:lang", attributes)
 
     def _write_style(self):
         # Write the <c:style> element.
         style_id = self.style_id
 
         # Don't write an element for the default style, 2.
         if style_id == 2:
             return
 
-        attributes = [('val', style_id)]
+        attributes = [("val", style_id)]
 
-        self._xml_empty_tag('c:style', attributes)
+        self._xml_empty_tag("c:style", attributes)
 
     def _write_chart(self):
         # Write the <c:chart> element.
-        self._xml_start_tag('c:chart')
+        self._xml_start_tag("c:chart")
 
         if self.title_none:
             # Turn off the title.
             self._write_c_auto_title_deleted()
         else:
             # Write the chart title elements.
             if self.title_formula is not None:
-                self._write_title_formula(self.title_formula,
-                                          self.title_data_id,
-                                          None,
-                                          self.title_font,
-                                          self.title_layout,
-                                          self.title_overlay)
+                self._write_title_formula(
+                    self.title_formula,
+                    self.title_data_id,
+                    None,
+                    self.title_font,
+                    self.title_layout,
+                    self.title_overlay,
+                )
             elif self.title_name is not None:
-                self._write_title_rich(self.title_name,
-                                       None,
-                                       self.title_font,
-                                       self.title_layout,
-                                       self.title_overlay)
+                self._write_title_rich(
+                    self.title_name,
+                    None,
+                    self.title_font,
+                    self.title_layout,
+                    self.title_overlay,
+                )
 
         # Write the c:plotArea element.
         self._write_plot_area()
 
         # Write the c:legend element.
         self._write_legend()
 
         # Write the c:plotVisOnly element.
         self._write_plot_vis_only()
 
         # Write the c:dispBlanksAs element.
         self._write_disp_blanks_as()
 
-        self._xml_end_tag('c:chart')
+        self._xml_end_tag("c:chart")
 
     def _write_disp_blanks_as(self):
         # Write the <c:dispBlanksAs> element.
         val = self.show_blanks
 
         # Ignore the default value.
-        if val == 'gap':
+        if val == "gap":
             return
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:dispBlanksAs', attributes)
+        self._xml_empty_tag("c:dispBlanksAs", attributes)
 
     def _write_plot_area(self):
         # Write the <c:plotArea> element.
-        self._xml_start_tag('c:plotArea')
+        self._xml_start_tag("c:plotArea")
 
         # Write the c:layout element.
-        self._write_layout(self.plotarea.get('layout'), 'plot')
+        self._write_layout(self.plotarea.get("layout"), "plot")
 
         # Write  subclass chart type elements for primary and secondary axes.
-        self._write_chart_type({'primary_axes': True})
-        self._write_chart_type({'primary_axes': False})
+        self._write_chart_type({"primary_axes": True})
+        self._write_chart_type({"primary_axes": False})
 
         # Configure a combined chart if present.
         second_chart = self.combined
         if second_chart:
             # Secondary axis has unique id otherwise use same as primary.
             if second_chart.is_secondary:
                 second_chart.id = 1000 + self.id
@@ -1676,1816 +1673,1826 @@
             # Share the same filehandle for writing.
             second_chart.fh = self.fh
 
             # Share series index with primary chart.
             second_chart.series_index = self.series_index
 
             # Write the subclass chart type elements for combined chart.
-            second_chart._write_chart_type({'primary_axes': True})
-            second_chart._write_chart_type({'primary_axes': False})
+            second_chart._write_chart_type({"primary_axes": True})
+            second_chart._write_chart_type({"primary_axes": False})
 
         # Write the category and value elements for the primary axes.
-        args = {'x_axis': self.x_axis,
-                'y_axis': self.y_axis,
-                'axis_ids': self.axis_ids}
+        args = {"x_axis": self.x_axis, "y_axis": self.y_axis, "axis_ids": self.axis_ids}
 
         if self.date_category:
             self._write_date_axis(args)
         else:
             self._write_cat_axis(args)
 
         self._write_val_axis(args)
 
         # Write the category and value elements for the secondary axes.
-        args = {'x_axis': self.x2_axis,
-                'y_axis': self.y2_axis,
-                'axis_ids': self.axis2_ids}
+        args = {
+            "x_axis": self.x2_axis,
+            "y_axis": self.y2_axis,
+            "axis_ids": self.axis2_ids,
+        }
 
         self._write_val_axis(args)
 
         # Write the secondary axis for the secondary chart.
         if second_chart and second_chart.is_secondary:
-            args = {'x_axis': second_chart.x2_axis,
-                    'y_axis': second_chart.y2_axis,
-                    'axis_ids': second_chart.axis2_ids}
+            args = {
+                "x_axis": second_chart.x2_axis,
+                "y_axis": second_chart.y2_axis,
+                "axis_ids": second_chart.axis2_ids,
+            }
 
             second_chart._write_val_axis(args)
 
         if self.date_category:
             self._write_date_axis(args)
         else:
             self._write_cat_axis(args)
 
         # Write the c:dTable element.
         self._write_d_table()
 
         # Write the c:spPr element for the plotarea formatting.
         self._write_sp_pr(self.plotarea)
 
-        self._xml_end_tag('c:plotArea')
+        self._xml_end_tag("c:plotArea")
 
     def _write_layout(self, layout, layout_type):
         # Write the <c:layout> element.
 
         if not layout:
             # Automatic layout.
-            self._xml_empty_tag('c:layout')
+            self._xml_empty_tag("c:layout")
         else:
             # User defined manual layout.
-            self._xml_start_tag('c:layout')
+            self._xml_start_tag("c:layout")
             self._write_manual_layout(layout, layout_type)
-            self._xml_end_tag('c:layout')
+            self._xml_end_tag("c:layout")
 
     def _write_manual_layout(self, layout, layout_type):
         # Write the <c:manualLayout> element.
-        self._xml_start_tag('c:manualLayout')
+        self._xml_start_tag("c:manualLayout")
 
         # Plotarea has a layoutTarget element.
-        if layout_type == 'plot':
-            self._xml_empty_tag('c:layoutTarget', [('val', 'inner')])
+        if layout_type == "plot":
+            self._xml_empty_tag("c:layoutTarget", [("val", "inner")])
 
         # Set the x, y positions.
-        self._xml_empty_tag('c:xMode', [('val', 'edge')])
-        self._xml_empty_tag('c:yMode', [('val', 'edge')])
-        self._xml_empty_tag('c:x', [('val', layout['x'])])
-        self._xml_empty_tag('c:y', [('val', layout['y'])])
+        self._xml_empty_tag("c:xMode", [("val", "edge")])
+        self._xml_empty_tag("c:yMode", [("val", "edge")])
+        self._xml_empty_tag("c:x", [("val", layout["x"])])
+        self._xml_empty_tag("c:y", [("val", layout["y"])])
 
         # For plotarea and legend set the width and height.
-        if layout_type != 'text':
-            self._xml_empty_tag('c:w', [('val', layout['width'])])
-            self._xml_empty_tag('c:h', [('val', layout['height'])])
+        if layout_type != "text":
+            self._xml_empty_tag("c:w", [("val", layout["width"])])
+            self._xml_empty_tag("c:h", [("val", layout["height"])])
 
-        self._xml_end_tag('c:manualLayout')
+        self._xml_end_tag("c:manualLayout")
 
     def _write_chart_type(self, options):
         # Write the chart type element. This method should be overridden
         # by the subclasses.
         return
 
     def _write_grouping(self, val):
         # Write the <c:grouping> element.
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:grouping', attributes)
+        self._xml_empty_tag("c:grouping", attributes)
 
     def _write_series(self, series):
         # Write the series elements.
         self._write_ser(series)
 
     def _write_ser(self, series):
         # Write the <c:ser> element.
         index = self.series_index
         self.series_index += 1
 
-        self._xml_start_tag('c:ser')
+        self._xml_start_tag("c:ser")
 
         # Write the c:idx element.
         self._write_idx(index)
 
         # Write the c:order element.
         self._write_order(index)
 
         # Write the series name.
         self._write_series_name(series)
 
         # Write the c:spPr element.
         self._write_sp_pr(series)
 
         # Write the c:marker element.
-        self._write_marker(series['marker'])
+        self._write_marker(series["marker"])
 
         # Write the c:invertIfNegative element.
-        self._write_c_invert_if_negative(series['invert_if_neg'])
+        self._write_c_invert_if_negative(series["invert_if_neg"])
 
         # Write the c:dPt element.
-        self._write_d_pt(series['points'])
+        self._write_d_pt(series["points"])
 
         # Write the c:dLbls element.
-        self._write_d_lbls(series['labels'])
+        self._write_d_lbls(series["labels"])
 
         # Write the c:trendline element.
-        self._write_trendline(series['trendline'])
+        self._write_trendline(series["trendline"])
 
         # Write the c:errBars element.
-        self._write_error_bars(series['error_bars'])
+        self._write_error_bars(series["error_bars"])
 
         # Write the c:cat element.
         self._write_cat(series)
 
         # Write the c:val element.
         self._write_val(series)
 
         # Write the c:smooth element.
         if self.smooth_allowed:
-            self._write_c_smooth(series['smooth'])
+            self._write_c_smooth(series["smooth"])
 
-        self._xml_end_tag('c:ser')
+        self._xml_end_tag("c:ser")
 
     def _write_idx(self, val):
         # Write the <c:idx> element.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:idx', attributes)
+        self._xml_empty_tag("c:idx", attributes)
 
     def _write_order(self, val):
         # Write the <c:order> element.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:order', attributes)
+        self._xml_empty_tag("c:order", attributes)
 
     def _write_series_name(self, series):
         # Write the series name.
 
-        if series['name_formula'] is not None:
-            self._write_tx_formula(series['name_formula'], series['name_id'])
-        elif series['name'] is not None:
-            self._write_tx_value(series['name'])
+        if series["name_formula"] is not None:
+            self._write_tx_formula(series["name_formula"], series["name_id"])
+        elif series["name"] is not None:
+            self._write_tx_value(series["name"])
 
     def _write_c_smooth(self, smooth):
         # Write the <c:smooth> element.
 
         if smooth:
-            self._xml_empty_tag('c:smooth', [('val', '1')])
+            self._xml_empty_tag("c:smooth", [("val", "1")])
 
     def _write_cat(self, series):
         # Write the <c:cat> element.
-        formula = series['categories']
-        data_id = series['cat_data_id']
+        formula = series["categories"]
+        data_id = series["cat_data_id"]
         data = None
 
         if data_id is not None:
             data = self.formula_data[data_id]
 
         # Ignore <c:cat> elements for charts without category values.
         if not formula:
             return
 
-        self._xml_start_tag('c:cat')
+        self._xml_start_tag("c:cat")
 
         # Check the type of cached data.
         cat_type = self._get_data_type(data)
 
-        if cat_type == 'str':
+        if cat_type == "str":
             self.cat_has_num_fmt = 0
             # Write the c:numRef element.
             self._write_str_ref(formula, data, cat_type)
 
-        elif cat_type == 'multi_str':
+        elif cat_type == "multi_str":
             self.cat_has_num_fmt = 0
             # Write the c:numRef element.
             self._write_multi_lvl_str_ref(formula, data)
 
         else:
             self.cat_has_num_fmt = 1
             # Write the c:numRef element.
             self._write_num_ref(formula, data, cat_type)
 
-        self._xml_end_tag('c:cat')
+        self._xml_end_tag("c:cat")
 
     def _write_val(self, series):
         # Write the <c:val> element.
-        formula = series['values']
-        data_id = series['val_data_id']
+        formula = series["values"]
+        data_id = series["val_data_id"]
         data = self.formula_data[data_id]
 
-        self._xml_start_tag('c:val')
+        self._xml_start_tag("c:val")
 
         # Unlike Cat axes data should only be numeric.
         # Write the c:numRef element.
-        self._write_num_ref(formula, data, 'num')
+        self._write_num_ref(formula, data, "num")
 
-        self._xml_end_tag('c:val')
+        self._xml_end_tag("c:val")
 
     def _write_num_ref(self, formula, data, ref_type):
         # Write the <c:numRef> element.
-        self._xml_start_tag('c:numRef')
+        self._xml_start_tag("c:numRef")
 
         # Write the c:f element.
         self._write_series_formula(formula)
 
-        if ref_type == 'num':
+        if ref_type == "num":
             # Write the c:numCache element.
             self._write_num_cache(data)
-        elif ref_type == 'str':
+        elif ref_type == "str":
             # Write the c:strCache element.
             self._write_str_cache(data)
 
-        self._xml_end_tag('c:numRef')
+        self._xml_end_tag("c:numRef")
 
     def _write_str_ref(self, formula, data, ref_type):
         # Write the <c:strRef> element.
 
-        self._xml_start_tag('c:strRef')
+        self._xml_start_tag("c:strRef")
 
         # Write the c:f element.
         self._write_series_formula(formula)
 
-        if ref_type == 'num':
+        if ref_type == "num":
             # Write the c:numCache element.
             self._write_num_cache(data)
-        elif ref_type == 'str':
+        elif ref_type == "str":
             # Write the c:strCache element.
             self._write_str_cache(data)
 
-        self._xml_end_tag('c:strRef')
+        self._xml_end_tag("c:strRef")
 
     def _write_multi_lvl_str_ref(self, formula, data):
         # Write the <c:multiLvlStrRef> element.
 
         if not data:
             return
 
-        self._xml_start_tag('c:multiLvlStrRef')
+        self._xml_start_tag("c:multiLvlStrRef")
 
         # Write the c:f element.
         self._write_series_formula(formula)
 
-        self._xml_start_tag('c:multiLvlStrCache')
+        self._xml_start_tag("c:multiLvlStrCache")
 
         # Write the c:ptCount element.
         count = len(data[-1])
         self._write_pt_count(count)
 
         for cat_data in reversed(data):
-
-            self._xml_start_tag('c:lvl')
+            self._xml_start_tag("c:lvl")
 
             for i, point in enumerate(cat_data):
                 # Write the c:pt element.
                 self._write_pt(i, cat_data[i])
 
-            self._xml_end_tag('c:lvl')
+            self._xml_end_tag("c:lvl")
 
-        self._xml_end_tag('c:multiLvlStrCache')
-        self._xml_end_tag('c:multiLvlStrRef')
+        self._xml_end_tag("c:multiLvlStrCache")
+        self._xml_end_tag("c:multiLvlStrRef")
 
     def _write_series_formula(self, formula):
         # Write the <c:f> element.
 
         # Strip the leading '=' from the formula.
-        if formula.startswith('='):
-            formula = formula.lstrip('=')
+        if formula.startswith("="):
+            formula = formula.lstrip("=")
 
-        self._xml_data_element('c:f', formula)
+        self._xml_data_element("c:f", formula)
 
     def _write_axis_ids(self, args):
         # Write the <c:axId> elements for the primary or secondary axes.
 
         # Generate the axis ids.
         self._add_axis_ids(args)
 
-        if args['primary_axes']:
+        if args["primary_axes"]:
             # Write the axis ids for the primary axes.
             self._write_axis_id(self.axis_ids[0])
             self._write_axis_id(self.axis_ids[1])
         else:
             # Write the axis ids for the secondary axes.
             self._write_axis_id(self.axis2_ids[0])
             self._write_axis_id(self.axis2_ids[1])
 
     def _write_axis_id(self, val):
         # Write the <c:axId> element.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:axId', attributes)
+        self._xml_empty_tag("c:axId", attributes)
 
     def _write_cat_axis(self, args):
         # Write the <c:catAx> element. Usually the X axis.
-        x_axis = args['x_axis']
-        y_axis = args['y_axis']
-        axis_ids = args['axis_ids']
+        x_axis = args["x_axis"]
+        y_axis = args["y_axis"]
+        axis_ids = args["axis_ids"]
 
         # If there are no axis_ids then we don't need to write this element.
         if axis_ids is None or not len(axis_ids):
             return
 
         position = self.cat_axis_position
         is_y_axis = self.horiz_cat_axis
 
         # Overwrite the default axis position with a user supplied value.
-        if x_axis.get('position'):
-            position = x_axis['position']
+        if x_axis.get("position"):
+            position = x_axis["position"]
 
-        self._xml_start_tag('c:catAx')
+        self._xml_start_tag("c:catAx")
 
         self._write_axis_id(axis_ids[0])
 
         # Write the c:scaling element.
-        self._write_scaling(x_axis.get('reverse'),
-                            None,
-                            None,
-                            None)
+        self._write_scaling(x_axis.get("reverse"), None, None, None)
 
-        if not x_axis.get('visible'):
+        if not x_axis.get("visible"):
             self._write_delete(1)
 
         # Write the c:axPos element.
-        self._write_axis_pos(position, y_axis.get('reverse'))
+        self._write_axis_pos(position, y_axis.get("reverse"))
 
         # Write the c:majorGridlines element.
-        self._write_major_gridlines(x_axis.get('major_gridlines'))
+        self._write_major_gridlines(x_axis.get("major_gridlines"))
 
         # Write the c:minorGridlines element.
-        self._write_minor_gridlines(x_axis.get('minor_gridlines'))
+        self._write_minor_gridlines(x_axis.get("minor_gridlines"))
 
         # Write the axis title elements.
-        if x_axis['formula'] is not None:
-            self._write_title_formula(x_axis['formula'],
-                                      x_axis['data_id'],
-                                      is_y_axis,
-                                      x_axis['name_font'],
-                                      x_axis['name_layout'])
-        elif x_axis['name'] is not None:
-            self._write_title_rich(x_axis['name'],
-                                   is_y_axis,
-                                   x_axis['name_font'],
-                                   x_axis['name_layout'])
+        if x_axis["formula"] is not None:
+            self._write_title_formula(
+                x_axis["formula"],
+                x_axis["data_id"],
+                is_y_axis,
+                x_axis["name_font"],
+                x_axis["name_layout"],
+            )
+        elif x_axis["name"] is not None:
+            self._write_title_rich(
+                x_axis["name"], is_y_axis, x_axis["name_font"], x_axis["name_layout"]
+            )
 
         # Write the c:numFmt element.
         self._write_cat_number_format(x_axis)
 
         # Write the c:majorTickMark element.
-        self._write_major_tick_mark(x_axis.get('major_tick_mark'))
+        self._write_major_tick_mark(x_axis.get("major_tick_mark"))
 
         # Write the c:minorTickMark element.
-        self._write_minor_tick_mark(x_axis.get('minor_tick_mark'))
+        self._write_minor_tick_mark(x_axis.get("minor_tick_mark"))
 
         # Write the c:tickLblPos element.
-        self._write_tick_label_pos(x_axis.get('label_position'))
+        self._write_tick_label_pos(x_axis.get("label_position"))
 
         # Write the c:spPr element for the axis line.
         self._write_sp_pr(x_axis)
 
         # Write the axis font elements.
-        self._write_axis_font(x_axis.get('num_font'))
+        self._write_axis_font(x_axis.get("num_font"))
 
         # Write the c:crossAx element.
         self._write_cross_axis(axis_ids[1])
 
-        if self.show_crosses or x_axis.get('visible'):
-
+        if self.show_crosses or x_axis.get("visible"):
             # Note, the category crossing comes from the value axis.
-            if (y_axis.get('crossing') is None
-                    or y_axis.get('crossing') == 'max'
-                    or y_axis['crossing'] == 'min'):
-
+            if (
+                y_axis.get("crossing") is None
+                or y_axis.get("crossing") == "max"
+                or y_axis["crossing"] == "min"
+            ):
                 # Write the c:crosses element.
-                self._write_crosses(y_axis.get('crossing'))
+                self._write_crosses(y_axis.get("crossing"))
             else:
-
                 # Write the c:crossesAt element.
-                self._write_c_crosses_at(y_axis.get('crossing'))
+                self._write_c_crosses_at(y_axis.get("crossing"))
 
         # Write the c:auto element.
-        if not x_axis.get('text_axis'):
+        if not x_axis.get("text_axis"):
             self._write_auto(1)
 
         # Write the c:labelAlign element.
-        self._write_label_align(x_axis.get('label_align'))
+        self._write_label_align(x_axis.get("label_align"))
 
         # Write the c:labelOffset element.
         self._write_label_offset(100)
 
         # Write the c:tickLblSkip element.
-        self._write_c_tick_lbl_skip(x_axis.get('interval_unit'))
+        self._write_c_tick_lbl_skip(x_axis.get("interval_unit"))
 
         # Write the c:tickMarkSkip element.
-        self._write_c_tick_mark_skip(x_axis.get('interval_tick'))
+        self._write_c_tick_mark_skip(x_axis.get("interval_tick"))
 
-        self._xml_end_tag('c:catAx')
+        self._xml_end_tag("c:catAx")
 
     def _write_val_axis(self, args):
         # Write the <c:valAx> element. Usually the Y axis.
-        x_axis = args['x_axis']
-        y_axis = args['y_axis']
-        axis_ids = args['axis_ids']
-        position = args.get('position', self.val_axis_position)
+        x_axis = args["x_axis"]
+        y_axis = args["y_axis"]
+        axis_ids = args["axis_ids"]
+        position = args.get("position", self.val_axis_position)
         is_y_axis = self.horiz_val_axis
 
         # If there are no axis_ids then we don't need to write this element.
         if axis_ids is None or not len(axis_ids):
             return
 
         # Overwrite the default axis position with a user supplied value.
-        position = y_axis.get('position') or position
+        position = y_axis.get("position") or position
 
-        self._xml_start_tag('c:valAx')
+        self._xml_start_tag("c:valAx")
 
         self._write_axis_id(axis_ids[1])
 
         # Write the c:scaling element.
-        self._write_scaling(y_axis.get('reverse'),
-                            y_axis.get('min'),
-                            y_axis.get('max'),
-                            y_axis.get('log_base'))
+        self._write_scaling(
+            y_axis.get("reverse"),
+            y_axis.get("min"),
+            y_axis.get("max"),
+            y_axis.get("log_base"),
+        )
 
-        if not y_axis.get('visible'):
+        if not y_axis.get("visible"):
             self._write_delete(1)
 
         # Write the c:axPos element.
-        self._write_axis_pos(position, x_axis.get('reverse'))
+        self._write_axis_pos(position, x_axis.get("reverse"))
 
         # Write the c:majorGridlines element.
-        self._write_major_gridlines(y_axis.get('major_gridlines'))
+        self._write_major_gridlines(y_axis.get("major_gridlines"))
 
         # Write the c:minorGridlines element.
-        self._write_minor_gridlines(y_axis.get('minor_gridlines'))
+        self._write_minor_gridlines(y_axis.get("minor_gridlines"))
 
         # Write the axis title elements.
-        if y_axis['formula'] is not None:
-            self._write_title_formula(y_axis['formula'],
-                                      y_axis['data_id'],
-                                      is_y_axis,
-                                      y_axis['name_font'],
-                                      y_axis['name_layout'])
-        elif y_axis['name'] is not None:
-            self._write_title_rich(y_axis['name'],
-                                   is_y_axis,
-                                   y_axis.get('name_font'),
-                                   y_axis.get('name_layout'))
+        if y_axis["formula"] is not None:
+            self._write_title_formula(
+                y_axis["formula"],
+                y_axis["data_id"],
+                is_y_axis,
+                y_axis["name_font"],
+                y_axis["name_layout"],
+            )
+        elif y_axis["name"] is not None:
+            self._write_title_rich(
+                y_axis["name"],
+                is_y_axis,
+                y_axis.get("name_font"),
+                y_axis.get("name_layout"),
+            )
 
         # Write the c:numberFormat element.
         self._write_number_format(y_axis)
 
         # Write the c:majorTickMark element.
-        self._write_major_tick_mark(y_axis.get('major_tick_mark'))
+        self._write_major_tick_mark(y_axis.get("major_tick_mark"))
 
         # Write the c:minorTickMark element.
-        self._write_minor_tick_mark(y_axis.get('minor_tick_mark'))
+        self._write_minor_tick_mark(y_axis.get("minor_tick_mark"))
 
         # Write the c:tickLblPos element.
-        self._write_tick_label_pos(y_axis.get('label_position'))
+        self._write_tick_label_pos(y_axis.get("label_position"))
 
         # Write the c:spPr element for the axis line.
         self._write_sp_pr(y_axis)
 
         # Write the axis font elements.
-        self._write_axis_font(y_axis.get('num_font'))
+        self._write_axis_font(y_axis.get("num_font"))
 
         # Write the c:crossAx element.
         self._write_cross_axis(axis_ids[0])
 
         # Note, the category crossing comes from the value axis.
-        if (x_axis.get('crossing') is None
-                or x_axis['crossing'] == 'max'
-                or x_axis['crossing'] == 'min'):
-
+        if (
+            x_axis.get("crossing") is None
+            or x_axis["crossing"] == "max"
+            or x_axis["crossing"] == "min"
+        ):
             # Write the c:crosses element.
-            self._write_crosses(x_axis.get('crossing'))
+            self._write_crosses(x_axis.get("crossing"))
         else:
-
             # Write the c:crossesAt element.
-            self._write_c_crosses_at(x_axis.get('crossing'))
+            self._write_c_crosses_at(x_axis.get("crossing"))
 
         # Write the c:crossBetween element.
-        self._write_cross_between(x_axis.get('position_axis'))
+        self._write_cross_between(x_axis.get("position_axis"))
 
         # Write the c:majorUnit element.
-        self._write_c_major_unit(y_axis.get('major_unit'))
+        self._write_c_major_unit(y_axis.get("major_unit"))
 
         # Write the c:minorUnit element.
-        self._write_c_minor_unit(y_axis.get('minor_unit'))
+        self._write_c_minor_unit(y_axis.get("minor_unit"))
 
         # Write the c:dispUnits element.
-        self._write_disp_units(y_axis.get('display_units'),
-                               y_axis.get('display_units_visible'))
+        self._write_disp_units(
+            y_axis.get("display_units"), y_axis.get("display_units_visible")
+        )
 
-        self._xml_end_tag('c:valAx')
+        self._xml_end_tag("c:valAx")
 
     def _write_cat_val_axis(self, args):
         # Write the <c:valAx> element. This is for the second valAx
         # in scatter plots. Usually the X axis.
-        x_axis = args['x_axis']
-        y_axis = args['y_axis']
-        axis_ids = args['axis_ids']
-        position = args['position'] or self.val_axis_position
+        x_axis = args["x_axis"]
+        y_axis = args["y_axis"]
+        axis_ids = args["axis_ids"]
+        position = args["position"] or self.val_axis_position
         is_y_axis = self.horiz_val_axis
 
         # If there are no axis_ids then we don't need to write this element.
         if axis_ids is None or not len(axis_ids):
             return
 
         # Overwrite the default axis position with a user supplied value.
-        position = x_axis.get('position') or position
+        position = x_axis.get("position") or position
 
-        self._xml_start_tag('c:valAx')
+        self._xml_start_tag("c:valAx")
 
         self._write_axis_id(axis_ids[0])
 
         # Write the c:scaling element.
-        self._write_scaling(x_axis.get('reverse'),
-                            x_axis.get('min'),
-                            x_axis.get('max'),
-                            x_axis.get('log_base'))
+        self._write_scaling(
+            x_axis.get("reverse"),
+            x_axis.get("min"),
+            x_axis.get("max"),
+            x_axis.get("log_base"),
+        )
 
-        if not x_axis.get('visible'):
+        if not x_axis.get("visible"):
             self._write_delete(1)
 
         # Write the c:axPos element.
-        self._write_axis_pos(position, y_axis.get('reverse'))
+        self._write_axis_pos(position, y_axis.get("reverse"))
 
         # Write the c:majorGridlines element.
-        self._write_major_gridlines(x_axis.get('major_gridlines'))
+        self._write_major_gridlines(x_axis.get("major_gridlines"))
 
         # Write the c:minorGridlines element.
-        self._write_minor_gridlines(x_axis.get('minor_gridlines'))
+        self._write_minor_gridlines(x_axis.get("minor_gridlines"))
 
         # Write the axis title elements.
-        if x_axis['formula'] is not None:
-            self._write_title_formula(x_axis['formula'],
-                                      x_axis['data_id'],
-                                      is_y_axis,
-                                      x_axis['name_font'],
-                                      x_axis['name_layout'])
-        elif x_axis['name'] is not None:
-            self._write_title_rich(x_axis['name'],
-                                   is_y_axis,
-                                   x_axis['name_font'],
-                                   x_axis['name_layout'])
+        if x_axis["formula"] is not None:
+            self._write_title_formula(
+                x_axis["formula"],
+                x_axis["data_id"],
+                is_y_axis,
+                x_axis["name_font"],
+                x_axis["name_layout"],
+            )
+        elif x_axis["name"] is not None:
+            self._write_title_rich(
+                x_axis["name"], is_y_axis, x_axis["name_font"], x_axis["name_layout"]
+            )
 
         # Write the c:numberFormat element.
         self._write_number_format(x_axis)
 
         # Write the c:majorTickMark element.
-        self._write_major_tick_mark(x_axis.get('major_tick_mark'))
+        self._write_major_tick_mark(x_axis.get("major_tick_mark"))
 
         # Write the c:minorTickMark element.
-        self._write_minor_tick_mark(x_axis.get('minor_tick_mark'))
+        self._write_minor_tick_mark(x_axis.get("minor_tick_mark"))
 
         # Write the c:tickLblPos element.
-        self._write_tick_label_pos(x_axis.get('label_position'))
+        self._write_tick_label_pos(x_axis.get("label_position"))
 
         # Write the c:spPr element for the axis line.
         self._write_sp_pr(x_axis)
 
         # Write the axis font elements.
-        self._write_axis_font(x_axis.get('num_font'))
+        self._write_axis_font(x_axis.get("num_font"))
 
         # Write the c:crossAx element.
         self._write_cross_axis(axis_ids[1])
 
         # Note, the category crossing comes from the value axis.
-        if (y_axis.get('crossing') is None
-                or y_axis['crossing'] == 'max'
-                or y_axis['crossing'] == 'min'):
-
+        if (
+            y_axis.get("crossing") is None
+            or y_axis["crossing"] == "max"
+            or y_axis["crossing"] == "min"
+        ):
             # Write the c:crosses element.
-            self._write_crosses(y_axis.get('crossing'))
+            self._write_crosses(y_axis.get("crossing"))
         else:
-
             # Write the c:crossesAt element.
-            self._write_c_crosses_at(y_axis.get('crossing'))
+            self._write_c_crosses_at(y_axis.get("crossing"))
 
         # Write the c:crossBetween element.
-        self._write_cross_between(y_axis.get('position_axis'))
+        self._write_cross_between(y_axis.get("position_axis"))
 
         # Write the c:majorUnit element.
-        self._write_c_major_unit(x_axis.get('major_unit'))
+        self._write_c_major_unit(x_axis.get("major_unit"))
 
         # Write the c:minorUnit element.
-        self._write_c_minor_unit(x_axis.get('minor_unit'))
+        self._write_c_minor_unit(x_axis.get("minor_unit"))
 
         # Write the c:dispUnits element.
-        self._write_disp_units(x_axis.get('display_units'),
-                               x_axis.get('display_units_visible'))
+        self._write_disp_units(
+            x_axis.get("display_units"), x_axis.get("display_units_visible")
+        )
 
-        self._xml_end_tag('c:valAx')
+        self._xml_end_tag("c:valAx")
 
     def _write_date_axis(self, args):
         # Write the <c:dateAx> element. Usually the X axis.
-        x_axis = args['x_axis']
-        y_axis = args['y_axis']
-        axis_ids = args['axis_ids']
+        x_axis = args["x_axis"]
+        y_axis = args["y_axis"]
+        axis_ids = args["axis_ids"]
 
         # If there are no axis_ids then we don't need to write this element.
         if axis_ids is None or not len(axis_ids):
             return
 
         position = self.cat_axis_position
 
         # Overwrite the default axis position with a user supplied value.
-        position = x_axis.get('position') or position
+        position = x_axis.get("position") or position
 
-        self._xml_start_tag('c:dateAx')
+        self._xml_start_tag("c:dateAx")
 
         self._write_axis_id(axis_ids[0])
 
         # Write the c:scaling element.
-        self._write_scaling(x_axis.get('reverse'),
-                            x_axis.get('min'),
-                            x_axis.get('max'),
-                            x_axis.get('log_base'))
+        self._write_scaling(
+            x_axis.get("reverse"),
+            x_axis.get("min"),
+            x_axis.get("max"),
+            x_axis.get("log_base"),
+        )
 
-        if not x_axis.get('visible'):
+        if not x_axis.get("visible"):
             self._write_delete(1)
 
         # Write the c:axPos element.
-        self._write_axis_pos(position, y_axis.get('reverse'))
+        self._write_axis_pos(position, y_axis.get("reverse"))
 
         # Write the c:majorGridlines element.
-        self._write_major_gridlines(x_axis.get('major_gridlines'))
+        self._write_major_gridlines(x_axis.get("major_gridlines"))
 
         # Write the c:minorGridlines element.
-        self._write_minor_gridlines(x_axis.get('minor_gridlines'))
+        self._write_minor_gridlines(x_axis.get("minor_gridlines"))
 
         # Write the axis title elements.
-        if x_axis['formula'] is not None:
-            self._write_title_formula(x_axis['formula'],
-                                      x_axis['data_id'],
-                                      None,
-                                      x_axis['name_font'],
-                                      x_axis['name_layout'])
-        elif x_axis['name'] is not None:
-            self._write_title_rich(x_axis['name'],
-                                   None,
-                                   x_axis['name_font'],
-                                   x_axis['name_layout'])
+        if x_axis["formula"] is not None:
+            self._write_title_formula(
+                x_axis["formula"],
+                x_axis["data_id"],
+                None,
+                x_axis["name_font"],
+                x_axis["name_layout"],
+            )
+        elif x_axis["name"] is not None:
+            self._write_title_rich(
+                x_axis["name"], None, x_axis["name_font"], x_axis["name_layout"]
+            )
 
         # Write the c:numFmt element.
         self._write_number_format(x_axis)
 
         # Write the c:majorTickMark element.
-        self._write_major_tick_mark(x_axis.get('major_tick_mark'))
+        self._write_major_tick_mark(x_axis.get("major_tick_mark"))
 
         # Write the c:minorTickMark element.
-        self._write_minor_tick_mark(x_axis.get('minor_tick_mark'))
+        self._write_minor_tick_mark(x_axis.get("minor_tick_mark"))
 
         # Write the c:tickLblPos element.
-        self._write_tick_label_pos(x_axis.get('label_position'))
+        self._write_tick_label_pos(x_axis.get("label_position"))
 
         # Write the c:spPr element for the axis line.
         self._write_sp_pr(x_axis)
 
         # Write the axis font elements.
-        self._write_axis_font(x_axis.get('num_font'))
+        self._write_axis_font(x_axis.get("num_font"))
 
         # Write the c:crossAx element.
         self._write_cross_axis(axis_ids[1])
 
-        if self.show_crosses or x_axis.get('visible'):
-
+        if self.show_crosses or x_axis.get("visible"):
             # Note, the category crossing comes from the value axis.
-            if (y_axis.get('crossing') is None
-                    or y_axis.get('crossing') == 'max'
-                    or y_axis['crossing'] == 'min'):
-
+            if (
+                y_axis.get("crossing") is None
+                or y_axis.get("crossing") == "max"
+                or y_axis["crossing"] == "min"
+            ):
                 # Write the c:crosses element.
-                self._write_crosses(y_axis.get('crossing'))
+                self._write_crosses(y_axis.get("crossing"))
             else:
-
                 # Write the c:crossesAt element.
-                self._write_c_crosses_at(y_axis.get('crossing'))
+                self._write_c_crosses_at(y_axis.get("crossing"))
 
         # Write the c:auto element.
         self._write_auto(1)
 
         # Write the c:labelOffset element.
         self._write_label_offset(100)
 
         # Write the c:tickLblSkip element.
-        self._write_c_tick_lbl_skip(x_axis.get('interval_unit'))
+        self._write_c_tick_lbl_skip(x_axis.get("interval_unit"))
 
         # Write the c:tickMarkSkip element.
-        self._write_c_tick_mark_skip(x_axis.get('interval_tick'))
+        self._write_c_tick_mark_skip(x_axis.get("interval_tick"))
 
         # Write the c:majorUnit element.
-        self._write_c_major_unit(x_axis.get('major_unit'))
+        self._write_c_major_unit(x_axis.get("major_unit"))
 
         # Write the c:majorTimeUnit element.
-        if x_axis.get('major_unit'):
-            self._write_c_major_time_unit(x_axis['major_unit_type'])
+        if x_axis.get("major_unit"):
+            self._write_c_major_time_unit(x_axis["major_unit_type"])
 
         # Write the c:minorUnit element.
-        self._write_c_minor_unit(x_axis.get('minor_unit'))
+        self._write_c_minor_unit(x_axis.get("minor_unit"))
 
         # Write the c:minorTimeUnit element.
-        if x_axis.get('minor_unit'):
-            self._write_c_minor_time_unit(x_axis['minor_unit_type'])
+        if x_axis.get("minor_unit"):
+            self._write_c_minor_time_unit(x_axis["minor_unit_type"])
 
-        self._xml_end_tag('c:dateAx')
+        self._xml_end_tag("c:dateAx")
 
     def _write_scaling(self, reverse, min_val, max_val, log_base):
         # Write the <c:scaling> element.
 
-        self._xml_start_tag('c:scaling')
+        self._xml_start_tag("c:scaling")
 
         # Write the c:logBase element.
         self._write_c_log_base(log_base)
 
         # Write the c:orientation element.
         self._write_orientation(reverse)
 
         # Write the c:max element.
         self._write_c_max(max_val)
 
         # Write the c:min element.
         self._write_c_min(min_val)
 
-        self._xml_end_tag('c:scaling')
+        self._xml_end_tag("c:scaling")
 
     def _write_c_log_base(self, val):
         # Write the <c:logBase> element.
 
         if not val:
             return
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:logBase', attributes)
+        self._xml_empty_tag("c:logBase", attributes)
 
     def _write_orientation(self, reverse):
         # Write the <c:orientation> element.
-        val = 'minMax'
+        val = "minMax"
 
         if reverse:
-            val = 'maxMin'
+            val = "maxMin"
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:orientation', attributes)
+        self._xml_empty_tag("c:orientation", attributes)
 
     def _write_c_max(self, max_val):
         # Write the <c:max> element.
 
         if max_val is None:
             return
 
-        attributes = [('val', max_val)]
+        attributes = [("val", max_val)]
 
-        self._xml_empty_tag('c:max', attributes)
+        self._xml_empty_tag("c:max", attributes)
 
     def _write_c_min(self, min_val):
         # Write the <c:min> element.
 
         if min_val is None:
             return
 
-        attributes = [('val', min_val)]
+        attributes = [("val", min_val)]
 
-        self._xml_empty_tag('c:min', attributes)
+        self._xml_empty_tag("c:min", attributes)
 
     def _write_axis_pos(self, val, reverse):
         # Write the <c:axPos> element.
 
         if reverse:
-            if val == 'l':
-                val = 'r'
-            if val == 'b':
-                val = 't'
+            if val == "l":
+                val = "r"
+            if val == "b":
+                val = "t"
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:axPos', attributes)
+        self._xml_empty_tag("c:axPos", attributes)
 
     def _write_number_format(self, axis):
         # Write the <c:numberFormat> element. Note: It is assumed that if
         # a user defined number format is supplied (i.e., non-default) then
         # the sourceLinked attribute is 0.
         # The user can override this if required.
-        format_code = axis.get('num_format')
+        format_code = axis.get("num_format")
         source_linked = 1
 
         # Check if a user defined number format has been set.
-        if (format_code is not None
-                and format_code != axis['defaults']['num_format']):
+        if format_code is not None and format_code != axis["defaults"]["num_format"]:
             source_linked = 0
 
         # User override of sourceLinked.
-        if axis.get('num_format_linked'):
+        if axis.get("num_format_linked"):
             source_linked = 1
 
         attributes = [
-            ('formatCode', format_code),
-            ('sourceLinked', source_linked),
+            ("formatCode", format_code),
+            ("sourceLinked", source_linked),
         ]
 
-        self._xml_empty_tag('c:numFmt', attributes)
+        self._xml_empty_tag("c:numFmt", attributes)
 
     def _write_cat_number_format(self, axis):
         # Write the <c:numFmt> element. Special case handler for category
         # axes which don't always have a number format.
-        format_code = axis.get('num_format')
+        format_code = axis.get("num_format")
         source_linked = 1
         default_format = 1
 
         # Check if a user defined number format has been set.
-        if (format_code is not None
-                and format_code != axis['defaults']['num_format']):
+        if format_code is not None and format_code != axis["defaults"]["num_format"]:
             source_linked = 0
             default_format = 0
 
         # User override of sourceLinked.
-        if axis.get('num_format_linked'):
+        if axis.get("num_format_linked"):
             source_linked = 1
 
         # Skip if cat doesn't have a num format (unless it is non-default).
         if not self.cat_has_num_fmt and default_format:
             return
 
         attributes = [
-            ('formatCode', format_code),
-            ('sourceLinked', source_linked),
+            ("formatCode", format_code),
+            ("sourceLinked", source_linked),
         ]
 
-        self._xml_empty_tag('c:numFmt', attributes)
+        self._xml_empty_tag("c:numFmt", attributes)
 
     def _write_data_label_number_format(self, format_code):
         # Write the <c:numberFormat> element for data labels.
         source_linked = 0
 
         attributes = [
-            ('formatCode', format_code),
-            ('sourceLinked', source_linked),
+            ("formatCode", format_code),
+            ("sourceLinked", source_linked),
         ]
 
-        self._xml_empty_tag('c:numFmt', attributes)
+        self._xml_empty_tag("c:numFmt", attributes)
 
     def _write_major_tick_mark(self, val):
         # Write the <c:majorTickMark> element.
 
         if not val:
             return
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:majorTickMark', attributes)
+        self._xml_empty_tag("c:majorTickMark", attributes)
 
     def _write_minor_tick_mark(self, val):
         # Write the <c:minorTickMark> element.
 
         if not val:
             return
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:minorTickMark', attributes)
+        self._xml_empty_tag("c:minorTickMark", attributes)
 
     def _write_tick_label_pos(self, val=None):
         # Write the <c:tickLblPos> element.
-        if val is None or val == 'next_to':
-            val = 'nextTo'
+        if val is None or val == "next_to":
+            val = "nextTo"
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:tickLblPos', attributes)
+        self._xml_empty_tag("c:tickLblPos", attributes)
 
     def _write_cross_axis(self, val):
         # Write the <c:crossAx> element.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:crossAx', attributes)
+        self._xml_empty_tag("c:crossAx", attributes)
 
     def _write_crosses(self, val=None):
         # Write the <c:crosses> element.
         if val is None:
-            val = 'autoZero'
+            val = "autoZero"
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:crosses', attributes)
+        self._xml_empty_tag("c:crosses", attributes)
 
     def _write_c_crosses_at(self, val):
         # Write the <c:crossesAt> element.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:crossesAt', attributes)
+        self._xml_empty_tag("c:crossesAt", attributes)
 
     def _write_auto(self, val):
         # Write the <c:auto> element.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:auto', attributes)
+        self._xml_empty_tag("c:auto", attributes)
 
     def _write_label_align(self, val=None):
         # Write the <c:labelAlign> element.
 
         if val is None:
-            val = 'ctr'
+            val = "ctr"
 
-        if val == 'right':
-            val = 'r'
+        if val == "right":
+            val = "r"
 
-        if val == 'left':
-            val = 'l'
+        if val == "left":
+            val = "l"
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:lblAlgn', attributes)
+        self._xml_empty_tag("c:lblAlgn", attributes)
 
     def _write_label_offset(self, val):
         # Write the <c:labelOffset> element.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:lblOffset', attributes)
+        self._xml_empty_tag("c:lblOffset", attributes)
 
     def _write_c_tick_lbl_skip(self, val):
         # Write the <c:tickLblSkip> element.
         if val is None:
             return
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:tickLblSkip', attributes)
+        self._xml_empty_tag("c:tickLblSkip", attributes)
 
     def _write_c_tick_mark_skip(self, val):
         # Write the <c:tickMarkSkip> element.
         if val is None:
             return
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:tickMarkSkip', attributes)
+        self._xml_empty_tag("c:tickMarkSkip", attributes)
 
     def _write_major_gridlines(self, gridlines):
         # Write the <c:majorGridlines> element.
 
         if not gridlines:
             return
 
-        if not gridlines['visible']:
+        if not gridlines["visible"]:
             return
 
-        if gridlines['line']['defined']:
-            self._xml_start_tag('c:majorGridlines')
+        if gridlines["line"]["defined"]:
+            self._xml_start_tag("c:majorGridlines")
 
             # Write the c:spPr element.
             self._write_sp_pr(gridlines)
 
-            self._xml_end_tag('c:majorGridlines')
+            self._xml_end_tag("c:majorGridlines")
         else:
-            self._xml_empty_tag('c:majorGridlines')
+            self._xml_empty_tag("c:majorGridlines")
 
     def _write_minor_gridlines(self, gridlines):
         # Write the <c:minorGridlines> element.
 
         if not gridlines:
             return
 
-        if not gridlines['visible']:
+        if not gridlines["visible"]:
             return
 
-        if gridlines['line']['defined']:
-            self._xml_start_tag('c:minorGridlines')
+        if gridlines["line"]["defined"]:
+            self._xml_start_tag("c:minorGridlines")
 
             # Write the c:spPr element.
             self._write_sp_pr(gridlines)
 
-            self._xml_end_tag('c:minorGridlines')
+            self._xml_end_tag("c:minorGridlines")
         else:
-            self._xml_empty_tag('c:minorGridlines')
+            self._xml_empty_tag("c:minorGridlines")
 
     def _write_cross_between(self, val):
         # Write the <c:crossBetween> element.
         if val is None:
             val = self.cross_between
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:crossBetween', attributes)
+        self._xml_empty_tag("c:crossBetween", attributes)
 
     def _write_c_major_unit(self, val):
         # Write the <c:majorUnit> element.
 
         if not val:
             return
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:majorUnit', attributes)
+        self._xml_empty_tag("c:majorUnit", attributes)
 
     def _write_c_minor_unit(self, val):
         # Write the <c:minorUnit> element.
 
         if not val:
             return
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:minorUnit', attributes)
+        self._xml_empty_tag("c:minorUnit", attributes)
 
     def _write_c_major_time_unit(self, val=None):
         # Write the <c:majorTimeUnit> element.
         if val is None:
-            val = 'days'
+            val = "days"
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:majorTimeUnit', attributes)
+        self._xml_empty_tag("c:majorTimeUnit", attributes)
 
     def _write_c_minor_time_unit(self, val=None):
         # Write the <c:minorTimeUnit> element.
         if val is None:
-            val = 'days'
+            val = "days"
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:minorTimeUnit', attributes)
+        self._xml_empty_tag("c:minorTimeUnit", attributes)
 
     def _write_legend(self):
         # Write the <c:legend> element.
         legend = self.legend
-        position = legend.get('position', 'right')
-        font = legend.get('font')
+        position = legend.get("position", "right")
+        font = legend.get("font")
         delete_series = []
         overlay = 0
 
-        if (legend.get('delete_series')
-                and type(legend['delete_series']) is list):
-            delete_series = legend['delete_series']
+        if legend.get("delete_series") and type(legend["delete_series"]) is list:
+            delete_series = legend["delete_series"]
 
-        if position.startswith('overlay_'):
-            position = position.replace('overlay_', '')
+        if position.startswith("overlay_"):
+            position = position.replace("overlay_", "")
             overlay = 1
 
         allowed = {
-            'right': 'r',
-            'left': 'l',
-            'top': 't',
-            'bottom': 'b',
-            'top_right': 'tr',
+            "right": "r",
+            "left": "l",
+            "top": "t",
+            "bottom": "b",
+            "top_right": "tr",
         }
 
-        if position == 'none':
+        if position == "none":
             return
 
         if position not in allowed:
             return
 
         position = allowed[position]
 
-        self._xml_start_tag('c:legend')
+        self._xml_start_tag("c:legend")
 
         # Write the c:legendPos element.
         self._write_legend_pos(position)
 
         # Remove series labels from the legend.
         for index in delete_series:
             # Write the c:legendEntry element.
             self._write_legend_entry(index)
 
         # Write the c:layout element.
-        self._write_layout(legend.get('layout'), 'legend')
+        self._write_layout(legend.get("layout"), "legend")
 
         # Write the c:overlay element.
         if overlay:
             self._write_overlay()
 
         if font:
             self._write_tx_pr(font)
 
         # Write the c:spPr element.
         self._write_sp_pr(legend)
 
-        self._xml_end_tag('c:legend')
+        self._xml_end_tag("c:legend")
 
     def _write_legend_pos(self, val):
         # Write the <c:legendPos> element.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:legendPos', attributes)
+        self._xml_empty_tag("c:legendPos", attributes)
 
     def _write_legend_entry(self, index):
         # Write the <c:legendEntry> element.
 
-        self._xml_start_tag('c:legendEntry')
+        self._xml_start_tag("c:legendEntry")
 
         # Write the c:idx element.
         self._write_idx(index)
 
         # Write the c:delete element.
         self._write_delete(1)
 
-        self._xml_end_tag('c:legendEntry')
+        self._xml_end_tag("c:legendEntry")
 
     def _write_overlay(self):
         # Write the <c:overlay> element.
         val = 1
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:overlay', attributes)
+        self._xml_empty_tag("c:overlay", attributes)
 
     def _write_plot_vis_only(self):
         # Write the <c:plotVisOnly> element.
         val = 1
 
         # Ignore this element if we are plotting hidden data.
         if self.show_hidden:
             return
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:plotVisOnly', attributes)
+        self._xml_empty_tag("c:plotVisOnly", attributes)
 
     def _write_print_settings(self):
         # Write the <c:printSettings> element.
-        self._xml_start_tag('c:printSettings')
+        self._xml_start_tag("c:printSettings")
 
         # Write the c:headerFooter element.
         self._write_header_footer()
 
         # Write the c:pageMargins element.
         self._write_page_margins()
 
         # Write the c:pageSetup element.
         self._write_page_setup()
 
-        self._xml_end_tag('c:printSettings')
+        self._xml_end_tag("c:printSettings")
 
     def _write_header_footer(self):
         # Write the <c:headerFooter> element.
-        self._xml_empty_tag('c:headerFooter')
+        self._xml_empty_tag("c:headerFooter")
 
     def _write_page_margins(self):
         # Write the <c:pageMargins> element.
         bottom = 0.75
         left = 0.7
         right = 0.7
         top = 0.75
         header = 0.3
         footer = 0.3
 
         attributes = [
-            ('b', bottom),
-            ('l', left),
-            ('r', right),
-            ('t', top),
-            ('header', header),
-            ('footer', footer),
+            ("b", bottom),
+            ("l", left),
+            ("r", right),
+            ("t", top),
+            ("header", header),
+            ("footer", footer),
         ]
 
-        self._xml_empty_tag('c:pageMargins', attributes)
+        self._xml_empty_tag("c:pageMargins", attributes)
 
     def _write_page_setup(self):
         # Write the <c:pageSetup> element.
-        self._xml_empty_tag('c:pageSetup')
+        self._xml_empty_tag("c:pageSetup")
 
     def _write_c_auto_title_deleted(self):
         # Write the <c:autoTitleDeleted> element.
-        self._xml_empty_tag('c:autoTitleDeleted', [('val', 1)])
+        self._xml_empty_tag("c:autoTitleDeleted", [("val", 1)])
 
     def _write_title_rich(self, title, is_y_axis, font, layout, overlay=False):
         # Write the <c:title> element for a rich string.
 
-        self._xml_start_tag('c:title')
+        self._xml_start_tag("c:title")
 
         # Write the c:tx element.
         self._write_tx_rich(title, is_y_axis, font)
 
         # Write the c:layout element.
-        self._write_layout(layout, 'text')
+        self._write_layout(layout, "text")
 
         # Write the c:overlay element.
         if overlay:
             self._write_overlay()
 
-        self._xml_end_tag('c:title')
+        self._xml_end_tag("c:title")
 
-    def _write_title_formula(self, title, data_id, is_y_axis, font, layout,
-                             overlay=False):
+    def _write_title_formula(
+        self, title, data_id, is_y_axis, font, layout, overlay=False
+    ):
         # Write the <c:title> element for a rich string.
 
-        self._xml_start_tag('c:title')
+        self._xml_start_tag("c:title")
 
         # Write the c:tx element.
         self._write_tx_formula(title, data_id)
 
         # Write the c:layout element.
-        self._write_layout(layout, 'text')
+        self._write_layout(layout, "text")
 
         # Write the c:overlay element.
         if overlay:
             self._write_overlay()
 
         # Write the c:txPr element.
         self._write_tx_pr(font, is_y_axis)
 
-        self._xml_end_tag('c:title')
+        self._xml_end_tag("c:title")
 
     def _write_tx_rich(self, title, is_y_axis, font):
         # Write the <c:tx> element.
 
-        self._xml_start_tag('c:tx')
+        self._xml_start_tag("c:tx")
 
         # Write the c:rich element.
         self._write_rich(title, font, is_y_axis, ignore_rich_pr=False)
 
-        self._xml_end_tag('c:tx')
+        self._xml_end_tag("c:tx")
 
     def _write_tx_value(self, title):
         # Write the <c:tx> element with a value such as for series names.
 
-        self._xml_start_tag('c:tx')
+        self._xml_start_tag("c:tx")
 
         # Write the c:v element.
         self._write_v(title)
 
-        self._xml_end_tag('c:tx')
+        self._xml_end_tag("c:tx")
 
     def _write_tx_formula(self, title, data_id):
         # Write the <c:tx> element.
         data = None
 
         if data_id is not None:
             data = self.formula_data[data_id]
 
-        self._xml_start_tag('c:tx')
+        self._xml_start_tag("c:tx")
 
         # Write the c:strRef element.
-        self._write_str_ref(title, data, 'str')
+        self._write_str_ref(title, data, "str")
 
-        self._xml_end_tag('c:tx')
+        self._xml_end_tag("c:tx")
 
     def _write_rich(self, title, font, is_y_axis, ignore_rich_pr):
         # Write the <c:rich> element.
 
-        if font and font.get('rotation') is not None:
-            rotation = font['rotation']
+        if font and font.get("rotation") is not None:
+            rotation = font["rotation"]
         else:
             rotation = None
 
-        self._xml_start_tag('c:rich')
+        self._xml_start_tag("c:rich")
 
         # Write the a:bodyPr element.
         self._write_a_body_pr(rotation, is_y_axis)
 
         # Write the a:lstStyle element.
         self._write_a_lst_style()
 
         # Write the a:p element.
         self._write_a_p_rich(title, font, ignore_rich_pr)
 
-        self._xml_end_tag('c:rich')
+        self._xml_end_tag("c:rich")
 
     def _write_a_body_pr(self, rotation, is_y_axis):
         # Write the <a:bodyPr> element.
         attributes = []
 
         if rotation is None and is_y_axis:
             rotation = -5400000
 
         if rotation is not None:
             if rotation == 16200000:
                 # 270 deg/stacked angle.
-                attributes.append(('rot', 0))
-                attributes.append(('vert', 'wordArtVert'))
+                attributes.append(("rot", 0))
+                attributes.append(("vert", "wordArtVert"))
             elif rotation == 16260000:
                 # 271 deg/East Asian vertical.
-                attributes.append(('rot', 0))
-                attributes.append(('vert', 'eaVert'))
+                attributes.append(("rot", 0))
+                attributes.append(("vert", "eaVert"))
             else:
-                attributes.append(('rot', rotation))
-                attributes.append(('vert', 'horz'))
+                attributes.append(("rot", rotation))
+                attributes.append(("vert", "horz"))
 
-        self._xml_empty_tag('a:bodyPr', attributes)
+        self._xml_empty_tag("a:bodyPr", attributes)
 
     def _write_a_lst_style(self):
         # Write the <a:lstStyle> element.
-        self._xml_empty_tag('a:lstStyle')
+        self._xml_empty_tag("a:lstStyle")
 
     def _write_a_p_rich(self, title, font, ignore_rich_pr):
         # Write the <a:p> element for rich string titles.
 
-        self._xml_start_tag('a:p')
+        self._xml_start_tag("a:p")
 
         # Write the a:pPr element.
         if not ignore_rich_pr:
             self._write_a_p_pr_rich(font)
 
         # Write the a:r element.
         self._write_a_r(title, font)
 
-        self._xml_end_tag('a:p')
+        self._xml_end_tag("a:p")
 
     def _write_a_p_formula(self, font):
         # Write the <a:p> element for formula titles.
 
-        self._xml_start_tag('a:p')
+        self._xml_start_tag("a:p")
 
         # Write the a:pPr element.
         self._write_a_p_pr_formula(font)
 
         # Write the a:endParaRPr element.
         self._write_a_end_para_rpr()
 
-        self._xml_end_tag('a:p')
+        self._xml_end_tag("a:p")
 
     def _write_a_p_pr_rich(self, font):
         # Write the <a:pPr> element for rich string titles.
 
-        self._xml_start_tag('a:pPr')
+        self._xml_start_tag("a:pPr")
 
         # Write the a:defRPr element.
         self._write_a_def_rpr(font)
 
-        self._xml_end_tag('a:pPr')
+        self._xml_end_tag("a:pPr")
 
     def _write_a_p_pr_formula(self, font):
         # Write the <a:pPr> element for formula titles.
 
-        self._xml_start_tag('a:pPr')
+        self._xml_start_tag("a:pPr")
 
         # Write the a:defRPr element.
         self._write_a_def_rpr(font)
 
-        self._xml_end_tag('a:pPr')
+        self._xml_end_tag("a:pPr")
 
     def _write_a_def_rpr(self, font):
         # Write the <a:defRPr> element.
         has_color = 0
 
         style_attributes = Shape._get_font_style_attributes(font)
         latin_attributes = Shape._get_font_latin_attributes(font)
 
-        if font and font.get('color') is not None:
+        if font and font.get("color") is not None:
             has_color = 1
 
         if latin_attributes or has_color:
-            self._xml_start_tag('a:defRPr', style_attributes)
+            self._xml_start_tag("a:defRPr", style_attributes)
 
             if has_color:
-                self._write_a_solid_fill({'color': font['color']})
+                self._write_a_solid_fill({"color": font["color"]})
 
             if latin_attributes:
                 self._write_a_latin(latin_attributes)
 
-            self._xml_end_tag('a:defRPr')
+            self._xml_end_tag("a:defRPr")
         else:
-            self._xml_empty_tag('a:defRPr', style_attributes)
+            self._xml_empty_tag("a:defRPr", style_attributes)
 
     def _write_a_end_para_rpr(self):
         # Write the <a:endParaRPr> element.
-        lang = 'en-US'
+        lang = "en-US"
 
-        attributes = [('lang', lang)]
+        attributes = [("lang", lang)]
 
-        self._xml_empty_tag('a:endParaRPr', attributes)
+        self._xml_empty_tag("a:endParaRPr", attributes)
 
     def _write_a_r(self, title, font):
         # Write the <a:r> element.
 
-        self._xml_start_tag('a:r')
+        self._xml_start_tag("a:r")
 
         # Write the a:rPr element.
         self._write_a_r_pr(font)
 
         # Write the a:t element.
         self._write_a_t(title)
 
-        self._xml_end_tag('a:r')
+        self._xml_end_tag("a:r")
 
     def _write_a_r_pr(self, font):
         # Write the <a:rPr> element.
         has_color = 0
-        lang = 'en-US'
+        lang = "en-US"
 
         style_attributes = Shape._get_font_style_attributes(font)
         latin_attributes = Shape._get_font_latin_attributes(font)
 
-        if font and font['color'] is not None:
+        if font and font["color"] is not None:
             has_color = 1
 
         # Add the lang type to the attributes.
-        style_attributes.insert(0, ('lang', lang))
+        style_attributes.insert(0, ("lang", lang))
 
         if latin_attributes or has_color:
-            self._xml_start_tag('a:rPr', style_attributes)
+            self._xml_start_tag("a:rPr", style_attributes)
 
             if has_color:
-                self._write_a_solid_fill({'color': font['color']})
+                self._write_a_solid_fill({"color": font["color"]})
 
             if latin_attributes:
                 self._write_a_latin(latin_attributes)
 
-            self._xml_end_tag('a:rPr')
+            self._xml_end_tag("a:rPr")
         else:
-            self._xml_empty_tag('a:rPr', style_attributes)
+            self._xml_empty_tag("a:rPr", style_attributes)
 
     def _write_a_t(self, title):
         # Write the <a:t> element.
 
-        self._xml_data_element('a:t', title)
+        self._xml_data_element("a:t", title)
 
     def _write_tx_pr(self, font, is_y_axis=False):
         # Write the <c:txPr> element.
 
-        if font and font.get('rotation') is not None:
-            rotation = font['rotation']
+        if font and font.get("rotation") is not None:
+            rotation = font["rotation"]
         else:
             rotation = None
 
-        self._xml_start_tag('c:txPr')
+        self._xml_start_tag("c:txPr")
 
         # Write the a:bodyPr element.
         self._write_a_body_pr(rotation, is_y_axis)
 
         # Write the a:lstStyle element.
         self._write_a_lst_style()
 
         # Write the a:p element.
         self._write_a_p_formula(font)
 
-        self._xml_end_tag('c:txPr')
+        self._xml_end_tag("c:txPr")
 
     def _write_marker(self, marker):
         # Write the <c:marker> element.
         if marker is None:
             marker = self.default_marker
 
         if not marker:
             return
 
-        if marker['type'] == 'automatic':
+        if marker["type"] == "automatic":
             return
 
-        self._xml_start_tag('c:marker')
+        self._xml_start_tag("c:marker")
 
         # Write the c:symbol element.
-        self._write_symbol(marker['type'])
+        self._write_symbol(marker["type"])
 
         # Write the c:size element.
-        if marker.get('size'):
-            self._write_marker_size(marker['size'])
+        if marker.get("size"):
+            self._write_marker_size(marker["size"])
 
         # Write the c:spPr element.
         self._write_sp_pr(marker)
 
-        self._xml_end_tag('c:marker')
+        self._xml_end_tag("c:marker")
 
     def _write_marker_size(self, val):
         # Write the <c:size> element.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:size', attributes)
+        self._xml_empty_tag("c:size", attributes)
 
     def _write_symbol(self, val):
         # Write the <c:symbol> element.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:symbol', attributes)
+        self._xml_empty_tag("c:symbol", attributes)
 
     def _write_sp_pr(self, series):
         # Write the <c:spPr> element.
 
         if not self._has_fill_formatting(series):
             return
 
-        self._xml_start_tag('c:spPr')
+        self._xml_start_tag("c:spPr")
 
         # Write the fill elements for solid charts such as pie and bar.
-        if series.get('fill') and series['fill']['defined']:
-            if 'none' in series['fill']:
+        if series.get("fill") and series["fill"]["defined"]:
+            if "none" in series["fill"]:
                 # Write the a:noFill element.
                 self._write_a_no_fill()
             else:
                 # Write the a:solidFill element.
-                self._write_a_solid_fill(series['fill'])
+                self._write_a_solid_fill(series["fill"])
 
-        if series.get('pattern'):
+        if series.get("pattern"):
             # Write the a:gradFill element.
-            self._write_a_patt_fill(series['pattern'])
+            self._write_a_patt_fill(series["pattern"])
 
-        if series.get('gradient'):
+        if series.get("gradient"):
             # Write the a:gradFill element.
-            self._write_a_grad_fill(series['gradient'])
+            self._write_a_grad_fill(series["gradient"])
 
         # Write the a:ln element.
-        if series.get('line') and series['line']['defined']:
-            self._write_a_ln(series['line'])
+        if series.get("line") and series["line"]["defined"]:
+            self._write_a_ln(series["line"])
 
-        self._xml_end_tag('c:spPr')
+        self._xml_end_tag("c:spPr")
 
     def _write_a_ln(self, line):
         # Write the <a:ln> element.
         attributes = []
 
         # Add the line width as an attribute.
-        width = line.get('width')
+        width = line.get("width")
 
-        if width:
+        if width is not None:
             # Round width to nearest 0.25, like Excel.
             width = int((width + 0.125) * 4) / 4.0
 
             # Convert to internal units.
             width = int(0.5 + (12700 * width))
 
-            attributes = [('w', width)]
+            attributes = [("w", width)]
 
-        self._xml_start_tag('a:ln', attributes)
+        if line.get("none") or line.get("color") or line.get("dash_type"):
+            self._xml_start_tag("a:ln", attributes)
 
-        # Write the line fill.
-        if 'none' in line:
-            # Write the a:noFill element.
-            self._write_a_no_fill()
-        elif 'color' in line:
-            # Write the a:solidFill element.
-            self._write_a_solid_fill(line)
-
-        # Write the line/dash type.
-        line_type = line.get('dash_type')
-        if line_type:
-            # Write the a:prstDash element.
-            self._write_a_prst_dash(line_type)
+            # Write the line fill.
+            if "none" in line:
+                # Write the a:noFill element.
+                self._write_a_no_fill()
+            elif "color" in line:
+                # Write the a:solidFill element.
+                self._write_a_solid_fill(line)
+
+            # Write the line/dash type.
+            line_type = line.get("dash_type")
+            if line_type:
+                # Write the a:prstDash element.
+                self._write_a_prst_dash(line_type)
 
-        self._xml_end_tag('a:ln')
+            self._xml_end_tag("a:ln")
+        else:
+            self._xml_empty_tag("a:ln", attributes)
 
     def _write_a_no_fill(self):
         # Write the <a:noFill> element.
-        self._xml_empty_tag('a:noFill')
+        self._xml_empty_tag("a:noFill")
 
     def _write_a_solid_fill(self, fill):
         # Write the <a:solidFill> element.
 
-        self._xml_start_tag('a:solidFill')
+        self._xml_start_tag("a:solidFill")
 
-        if 'color' in fill:
-            color = get_rgb_color(fill['color'])
-            transparency = fill.get('transparency')
+        if "color" in fill:
+            color = get_rgb_color(fill["color"])
+            transparency = fill.get("transparency")
             # Write the a:srgbClr element.
             self._write_a_srgb_clr(color, transparency)
 
-        self._xml_end_tag('a:solidFill')
+        self._xml_end_tag("a:solidFill")
 
     def _write_a_srgb_clr(self, val, transparency=None):
         # Write the <a:srgbClr> element.
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
         if transparency:
-            self._xml_start_tag('a:srgbClr', attributes)
+            self._xml_start_tag("a:srgbClr", attributes)
 
             # Write the a:alpha element.
             self._write_a_alpha(transparency)
 
-            self._xml_end_tag('a:srgbClr')
+            self._xml_end_tag("a:srgbClr")
         else:
-            self._xml_empty_tag('a:srgbClr', attributes)
+            self._xml_empty_tag("a:srgbClr", attributes)
 
     def _write_a_alpha(self, val):
         # Write the <a:alpha> element.
 
         val = int((100 - int(val)) * 1000)
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('a:alpha', attributes)
+        self._xml_empty_tag("a:alpha", attributes)
 
     def _write_a_prst_dash(self, val):
         # Write the <a:prstDash> element.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('a:prstDash', attributes)
+        self._xml_empty_tag("a:prstDash", attributes)
 
     def _write_trendline(self, trendline):
         # Write the <c:trendline> element.
 
         if not trendline:
             return
 
-        self._xml_start_tag('c:trendline')
+        self._xml_start_tag("c:trendline")
 
         # Write the c:name element.
-        self._write_name(trendline.get('name'))
+        self._write_name(trendline.get("name"))
 
         # Write the c:spPr element.
         self._write_sp_pr(trendline)
 
         # Write the c:trendlineType element.
-        self._write_trendline_type(trendline['type'])
+        self._write_trendline_type(trendline["type"])
 
         # Write the c:order element for polynomial trendlines.
-        if trendline['type'] == 'poly':
-            self._write_trendline_order(trendline.get('order'))
+        if trendline["type"] == "poly":
+            self._write_trendline_order(trendline.get("order"))
 
         # Write the c:period element for moving average trendlines.
-        if trendline['type'] == 'movingAvg':
-            self._write_period(trendline.get('period'))
+        if trendline["type"] == "movingAvg":
+            self._write_period(trendline.get("period"))
 
         # Write the c:forward element.
-        self._write_forward(trendline.get('forward'))
+        self._write_forward(trendline.get("forward"))
 
         # Write the c:backward element.
-        self._write_backward(trendline.get('backward'))
+        self._write_backward(trendline.get("backward"))
 
-        if 'intercept' in trendline:
+        if "intercept" in trendline:
             # Write the c:intercept element.
-            self._write_c_intercept(trendline['intercept'])
+            self._write_c_intercept(trendline["intercept"])
 
-        if trendline.get('display_r_squared'):
+        if trendline.get("display_r_squared"):
             # Write the c:dispRSqr element.
             self._write_c_disp_rsqr()
 
-        if trendline.get('display_equation'):
+        if trendline.get("display_equation"):
             # Write the c:dispEq element.
             self._write_c_disp_eq()
 
             # Write the c:trendlineLbl element.
             self._write_c_trendline_lbl()
 
-        self._xml_end_tag('c:trendline')
+        self._xml_end_tag("c:trendline")
 
     def _write_trendline_type(self, val):
         # Write the <c:trendlineType> element.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:trendlineType', attributes)
+        self._xml_empty_tag("c:trendlineType", attributes)
 
     def _write_name(self, data):
         # Write the <c:name> element.
 
         if data is None:
             return
 
-        self._xml_data_element('c:name', data)
+        self._xml_data_element("c:name", data)
 
     def _write_trendline_order(self, val):
         # Write the <c:order> element.
         if val < 2:
             val = 2
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:order', attributes)
+        self._xml_empty_tag("c:order", attributes)
 
     def _write_period(self, val):
         # Write the <c:period> element.
         if val < 2:
             val = 2
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:period', attributes)
+        self._xml_empty_tag("c:period", attributes)
 
     def _write_forward(self, val):
         # Write the <c:forward> element.
 
         if not val:
             return
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:forward', attributes)
+        self._xml_empty_tag("c:forward", attributes)
 
     def _write_backward(self, val):
         # Write the <c:backward> element.
 
         if not val:
             return
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:backward', attributes)
+        self._xml_empty_tag("c:backward", attributes)
 
     def _write_c_intercept(self, val):
         # Write the <c:intercept> element.
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:intercept', attributes)
+        self._xml_empty_tag("c:intercept", attributes)
 
     def _write_c_disp_eq(self):
         # Write the <c:dispEq> element.
-        attributes = [('val', 1)]
+        attributes = [("val", 1)]
 
-        self._xml_empty_tag('c:dispEq', attributes)
+        self._xml_empty_tag("c:dispEq", attributes)
 
     def _write_c_disp_rsqr(self):
         # Write the <c:dispRSqr> element.
-        attributes = [('val', 1)]
+        attributes = [("val", 1)]
 
-        self._xml_empty_tag('c:dispRSqr', attributes)
+        self._xml_empty_tag("c:dispRSqr", attributes)
 
     def _write_c_trendline_lbl(self):
         # Write the <c:trendlineLbl> element.
-        self._xml_start_tag('c:trendlineLbl')
+        self._xml_start_tag("c:trendlineLbl")
 
         # Write the c:layout element.
         self._write_layout(None, None)
 
         # Write the c:numFmt element.
         self._write_trendline_num_fmt()
 
-        self._xml_end_tag('c:trendlineLbl')
+        self._xml_end_tag("c:trendlineLbl")
 
     def _write_trendline_num_fmt(self):
         # Write the <c:numFmt> element.
         attributes = [
-            ('formatCode', 'General'),
-            ('sourceLinked', 0),
+            ("formatCode", "General"),
+            ("sourceLinked", 0),
         ]
 
-        self._xml_empty_tag('c:numFmt', attributes)
+        self._xml_empty_tag("c:numFmt", attributes)
 
     def _write_hi_low_lines(self):
         # Write the <c:hiLowLines> element.
         hi_low_lines = self.hi_low_lines
 
         if hi_low_lines is None:
             return
 
-        if 'line' in hi_low_lines and hi_low_lines['line']['defined']:
-
-            self._xml_start_tag('c:hiLowLines')
+        if "line" in hi_low_lines and hi_low_lines["line"]["defined"]:
+            self._xml_start_tag("c:hiLowLines")
 
             # Write the c:spPr element.
             self._write_sp_pr(hi_low_lines)
 
-            self._xml_end_tag('c:hiLowLines')
+            self._xml_end_tag("c:hiLowLines")
         else:
-            self._xml_empty_tag('c:hiLowLines')
+            self._xml_empty_tag("c:hiLowLines")
 
     def _write_drop_lines(self):
         # Write the <c:dropLines> element.
         drop_lines = self.drop_lines
 
         if drop_lines is None:
             return
 
-        if drop_lines['line']['defined']:
-
-            self._xml_start_tag('c:dropLines')
+        if drop_lines["line"]["defined"]:
+            self._xml_start_tag("c:dropLines")
 
             # Write the c:spPr element.
             self._write_sp_pr(drop_lines)
 
-            self._xml_end_tag('c:dropLines')
+            self._xml_end_tag("c:dropLines")
         else:
-            self._xml_empty_tag('c:dropLines')
+            self._xml_empty_tag("c:dropLines")
 
     def _write_overlap(self, val):
         # Write the <c:overlap> element.
 
         if val is None:
             return
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:overlap', attributes)
+        self._xml_empty_tag("c:overlap", attributes)
 
     def _write_num_cache(self, data):
         # Write the <c:numCache> element.
         if data:
             count = len(data)
         else:
             count = 0
 
-        self._xml_start_tag('c:numCache')
+        self._xml_start_tag("c:numCache")
 
         # Write the c:formatCode element.
-        self._write_format_code('General')
+        self._write_format_code("General")
 
         # Write the c:ptCount element.
         self._write_pt_count(count)
 
         for i in range(count):
             token = data[i]
 
@@ -3497,69 +3504,69 @@
             except ValueError:
                 # Write non-numeric data as 0.
                 token = 0
 
             # Write the c:pt element.
             self._write_pt(i, token)
 
-        self._xml_end_tag('c:numCache')
+        self._xml_end_tag("c:numCache")
 
     def _write_str_cache(self, data):
         # Write the <c:strCache> element.
         count = len(data)
 
-        self._xml_start_tag('c:strCache')
+        self._xml_start_tag("c:strCache")
 
         # Write the c:ptCount element.
         self._write_pt_count(count)
 
         for i in range(count):
             # Write the c:pt element.
             self._write_pt(i, data[i])
 
-        self._xml_end_tag('c:strCache')
+        self._xml_end_tag("c:strCache")
 
     def _write_format_code(self, data):
         # Write the <c:formatCode> element.
 
-        self._xml_data_element('c:formatCode', data)
+        self._xml_data_element("c:formatCode", data)
 
     def _write_pt_count(self, val):
         # Write the <c:ptCount> element.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:ptCount', attributes)
+        self._xml_empty_tag("c:ptCount", attributes)
 
     def _write_pt(self, idx, value):
         # Write the <c:pt> element.
 
         if value is None:
             return
 
-        attributes = [('idx', idx)]
+        attributes = [("idx", idx)]
 
-        self._xml_start_tag('c:pt', attributes)
+        self._xml_start_tag("c:pt", attributes)
 
         # Write the c:v element.
         self._write_v(value)
 
-        self._xml_end_tag('c:pt')
+        self._xml_end_tag("c:pt")
 
     def _write_v(self, data):
         # Write the <c:v> element.
 
-        self._xml_data_element('c:v', data)
+        self._xml_data_element("c:v", data)
 
     def _write_protection(self):
         # Write the <c:protection> element.
         if not self.protection:
             return
 
-        self._xml_empty_tag('c:protection')
+        self._xml_empty_tag("c:protection")
 
     def _write_d_pt(self, points):
         # Write the <c:dPt> elements.
         index = -1
 
         if not points:
             return
@@ -3570,455 +3577,455 @@
                 continue
 
             self._write_d_pt_point(index, point)
 
     def _write_d_pt_point(self, index, point):
         # Write an individual <c:dPt> element.
 
-        self._xml_start_tag('c:dPt')
+        self._xml_start_tag("c:dPt")
 
         # Write the c:idx element.
         self._write_idx(index)
 
         # Write the c:spPr element.
         self._write_sp_pr(point)
 
-        self._xml_end_tag('c:dPt')
+        self._xml_end_tag("c:dPt")
 
     def _write_d_lbls(self, labels):
         # Write the <c:dLbls> element.
 
         if not labels:
             return
 
-        self._xml_start_tag('c:dLbls')
+        self._xml_start_tag("c:dLbls")
 
         # Write the custom c:dLbl elements.
-        if labels.get('custom'):
-            self._write_custom_labels(labels, labels['custom'])
+        if labels.get("custom"):
+            self._write_custom_labels(labels, labels["custom"])
 
         # Write the c:numFmt element.
-        if labels.get('num_format'):
-            self._write_data_label_number_format(labels['num_format'])
+        if labels.get("num_format"):
+            self._write_data_label_number_format(labels["num_format"])
 
         # Write the c:spPr element for the plotarea formatting.
         self._write_sp_pr(labels)
 
         # Write the data label font elements.
-        if labels.get('font'):
-            self._write_axis_font(labels['font'])
+        if labels.get("font"):
+            self._write_axis_font(labels["font"])
 
         # Write the c:dLblPos element.
-        if labels.get('position'):
-            self._write_d_lbl_pos(labels['position'])
+        if labels.get("position"):
+            self._write_d_lbl_pos(labels["position"])
 
         # Write the c:showLegendKey element.
-        if labels.get('legend_key'):
+        if labels.get("legend_key"):
             self._write_show_legend_key()
 
         # Write the c:showVal element.
-        if labels.get('value'):
+        if labels.get("value"):
             self._write_show_val()
 
         # Write the c:showCatName element.
-        if labels.get('category'):
+        if labels.get("category"):
             self._write_show_cat_name()
 
         # Write the c:showSerName element.
-        if labels.get('series_name'):
+        if labels.get("series_name"):
             self._write_show_ser_name()
 
         # Write the c:showPercent element.
-        if labels.get('percentage'):
+        if labels.get("percentage"):
             self._write_show_percent()
 
         # Write the c:separator element.
-        if labels.get('separator'):
-            self._write_separator(labels['separator'])
+        if labels.get("separator"):
+            self._write_separator(labels["separator"])
 
         # Write the c:showLeaderLines element.
-        if labels.get('leader_lines'):
+        if labels.get("leader_lines"):
             self._write_show_leader_lines()
 
-        self._xml_end_tag('c:dLbls')
+        self._xml_end_tag("c:dLbls")
 
     def _write_custom_labels(self, parent, labels):
         # Write the <c:showLegendKey> element.
         index = 0
 
         for label in labels:
             index += 1
 
             if label is None:
                 continue
 
-            self._xml_start_tag('c:dLbl')
+            self._xml_start_tag("c:dLbl")
 
             # Write the c:idx element.
             self._write_idx(index - 1)
 
-            delete_label = label.get('delete')
+            delete_label = label.get("delete")
 
             if delete_label:
                 self._write_delete(1)
 
-            elif label.get('formula'):
+            elif label.get("formula"):
                 self._write_custom_label_formula(label)
 
-                if parent.get('position'):
-                    self._write_d_lbl_pos(parent['position'])
+                if parent.get("position"):
+                    self._write_d_lbl_pos(parent["position"])
 
-                if parent.get('value'):
+                if parent.get("value"):
                     self._write_show_val()
-                if parent.get('category'):
+                if parent.get("category"):
                     self._write_show_cat_name()
-                if parent.get('series_name'):
+                if parent.get("series_name"):
                     self._write_show_ser_name()
 
-            elif label.get('value'):
+            elif label.get("value"):
                 self._write_custom_label_str(label)
 
-                if parent.get('position'):
-                    self._write_d_lbl_pos(parent['position'])
+                if parent.get("position"):
+                    self._write_d_lbl_pos(parent["position"])
 
-                if parent.get('value'):
+                if parent.get("value"):
                     self._write_show_val()
-                if parent.get('category'):
+                if parent.get("category"):
                     self._write_show_cat_name()
-                if parent.get('series_name'):
+                if parent.get("series_name"):
                     self._write_show_ser_name()
             else:
                 self._write_custom_label_format_only(label)
 
-            self._xml_end_tag('c:dLbl')
+            self._xml_end_tag("c:dLbl")
 
     def _write_custom_label_str(self, label):
         # Write parts of the <c:dLbl> element for strings.
-        title = label.get('value')
-        font = label.get('font')
+        title = label.get("value")
+        font = label.get("font")
         has_formatting = self._has_fill_formatting(label)
 
         # Write the c:layout element.
         self._write_layout(None, None)
 
-        self._xml_start_tag('c:tx')
+        self._xml_start_tag("c:tx")
 
         # Write the c:rich element.
         self._write_rich(title, font, False, not has_formatting)
 
-        self._xml_end_tag('c:tx')
+        self._xml_end_tag("c:tx")
 
         # Write the c:spPr element.
         self._write_sp_pr(label)
 
     def _write_custom_label_formula(self, label):
         # Write parts of the <c:dLbl> element for formulas.
-        formula = label.get('formula')
-        data_id = label.get('data_id')
+        formula = label.get("formula")
+        data_id = label.get("data_id")
         data = None
 
         if data_id is not None:
             data = self.formula_data[data_id]
 
         # Write the c:layout element.
         self._write_layout(None, None)
 
-        self._xml_start_tag('c:tx')
+        self._xml_start_tag("c:tx")
 
         # Write the c:strRef element.
-        self._write_str_ref(formula, data, 'str')
+        self._write_str_ref(formula, data, "str")
 
-        self._xml_end_tag('c:tx')
+        self._xml_end_tag("c:tx")
 
         # Write the data label formatting, if any.
         self._write_custom_label_format_only(label)
 
     def _write_custom_label_format_only(self, label):
         # Write parts of the <c:dLbl> labels with changed formatting.
-        font = label.get('font')
+        font = label.get("font")
         has_formatting = self._has_fill_formatting(label)
 
         if has_formatting:
             self._write_sp_pr(label)
             self._write_tx_pr(font)
         elif font:
-            self._xml_empty_tag('c:spPr')
+            self._xml_empty_tag("c:spPr")
             self._write_tx_pr(font)
 
     def _write_show_legend_key(self):
         # Write the <c:showLegendKey> element.
-        val = '1'
+        val = "1"
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:showLegendKey', attributes)
+        self._xml_empty_tag("c:showLegendKey", attributes)
 
     def _write_show_val(self):
         # Write the <c:showVal> element.
         val = 1
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:showVal', attributes)
+        self._xml_empty_tag("c:showVal", attributes)
 
     def _write_show_cat_name(self):
         # Write the <c:showCatName> element.
         val = 1
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:showCatName', attributes)
+        self._xml_empty_tag("c:showCatName", attributes)
 
     def _write_show_ser_name(self):
         # Write the <c:showSerName> element.
         val = 1
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:showSerName', attributes)
+        self._xml_empty_tag("c:showSerName", attributes)
 
     def _write_show_percent(self):
         # Write the <c:showPercent> element.
         val = 1
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:showPercent', attributes)
+        self._xml_empty_tag("c:showPercent", attributes)
 
     def _write_separator(self, data):
         # Write the <c:separator> element.
-        self._xml_data_element('c:separator', data)
+        self._xml_data_element("c:separator", data)
 
     def _write_show_leader_lines(self):
         # Write the <c:showLeaderLines> element.
         val = 1
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:showLeaderLines', attributes)
+        self._xml_empty_tag("c:showLeaderLines", attributes)
 
     def _write_d_lbl_pos(self, val):
         # Write the <c:dLblPos> element.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:dLblPos', attributes)
+        self._xml_empty_tag("c:dLblPos", attributes)
 
     def _write_delete(self, val):
         # Write the <c:delete> element.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:delete', attributes)
+        self._xml_empty_tag("c:delete", attributes)
 
     def _write_c_invert_if_negative(self, invert):
         # Write the <c:invertIfNegative> element.
         val = 1
 
         if not invert:
             return
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:invertIfNegative', attributes)
+        self._xml_empty_tag("c:invertIfNegative", attributes)
 
     def _write_axis_font(self, font):
         # Write the axis font elements.
 
         if not font:
             return
 
-        self._xml_start_tag('c:txPr')
-        self._write_a_body_pr(font.get('rotation'), None)
+        self._xml_start_tag("c:txPr")
+        self._write_a_body_pr(font.get("rotation"), None)
         self._write_a_lst_style()
-        self._xml_start_tag('a:p')
+        self._xml_start_tag("a:p")
 
         self._write_a_p_pr_rich(font)
 
         self._write_a_end_para_rpr()
-        self._xml_end_tag('a:p')
-        self._xml_end_tag('c:txPr')
+        self._xml_end_tag("a:p")
+        self._xml_end_tag("c:txPr")
 
     def _write_a_latin(self, attributes):
         # Write the <a:latin> element.
-        self._xml_empty_tag('a:latin', attributes)
+        self._xml_empty_tag("a:latin", attributes)
 
     def _write_d_table(self):
         # Write the <c:dTable> element.
         table = self.table
 
         if not table:
             return
 
-        self._xml_start_tag('c:dTable')
+        self._xml_start_tag("c:dTable")
 
-        if table['horizontal']:
+        if table["horizontal"]:
             # Write the c:showHorzBorder element.
             self._write_show_horz_border()
 
-        if table['vertical']:
+        if table["vertical"]:
             # Write the c:showVertBorder element.
             self._write_show_vert_border()
 
-        if table['outline']:
+        if table["outline"]:
             # Write the c:showOutline element.
             self._write_show_outline()
 
-        if table['show_keys']:
+        if table["show_keys"]:
             # Write the c:showKeys element.
             self._write_show_keys()
 
-        if table['font']:
+        if table["font"]:
             # Write the table font.
-            self._write_tx_pr(table['font'])
+            self._write_tx_pr(table["font"])
 
-        self._xml_end_tag('c:dTable')
+        self._xml_end_tag("c:dTable")
 
     def _write_show_horz_border(self):
         # Write the <c:showHorzBorder> element.
-        attributes = [('val', 1)]
+        attributes = [("val", 1)]
 
-        self._xml_empty_tag('c:showHorzBorder', attributes)
+        self._xml_empty_tag("c:showHorzBorder", attributes)
 
     def _write_show_vert_border(self):
         # Write the <c:showVertBorder> element.
-        attributes = [('val', 1)]
+        attributes = [("val", 1)]
 
-        self._xml_empty_tag('c:showVertBorder', attributes)
+        self._xml_empty_tag("c:showVertBorder", attributes)
 
     def _write_show_outline(self):
         # Write the <c:showOutline> element.
-        attributes = [('val', 1)]
+        attributes = [("val", 1)]
 
-        self._xml_empty_tag('c:showOutline', attributes)
+        self._xml_empty_tag("c:showOutline", attributes)
 
     def _write_show_keys(self):
         # Write the <c:showKeys> element.
-        attributes = [('val', 1)]
+        attributes = [("val", 1)]
 
-        self._xml_empty_tag('c:showKeys', attributes)
+        self._xml_empty_tag("c:showKeys", attributes)
 
     def _write_error_bars(self, error_bars):
         # Write the X and Y error bars.
 
         if not error_bars:
             return
 
-        if error_bars['x_error_bars']:
-            self._write_err_bars('x', error_bars['x_error_bars'])
+        if error_bars["x_error_bars"]:
+            self._write_err_bars("x", error_bars["x_error_bars"])
 
-        if error_bars['y_error_bars']:
-            self._write_err_bars('y', error_bars['y_error_bars'])
+        if error_bars["y_error_bars"]:
+            self._write_err_bars("y", error_bars["y_error_bars"])
 
     def _write_err_bars(self, direction, error_bars):
         # Write the <c:errBars> element.
 
         if not error_bars:
             return
 
-        self._xml_start_tag('c:errBars')
+        self._xml_start_tag("c:errBars")
 
         # Write the c:errDir element.
         self._write_err_dir(direction)
 
         # Write the c:errBarType element.
-        self._write_err_bar_type(error_bars['direction'])
+        self._write_err_bar_type(error_bars["direction"])
 
         # Write the c:errValType element.
-        self._write_err_val_type(error_bars['type'])
+        self._write_err_val_type(error_bars["type"])
 
-        if not error_bars['endcap']:
+        if not error_bars["endcap"]:
             # Write the c:noEndCap element.
             self._write_no_end_cap()
 
-        if error_bars['type'] == 'stdErr':
+        if error_bars["type"] == "stdErr":
             # Don't need to write a c:errValType tag.
             pass
-        elif error_bars['type'] == 'cust':
+        elif error_bars["type"] == "cust":
             # Write the custom error tags.
             self._write_custom_error(error_bars)
         else:
             # Write the c:val element.
-            self._write_error_val(error_bars['value'])
+            self._write_error_val(error_bars["value"])
 
         # Write the c:spPr element.
         self._write_sp_pr(error_bars)
 
-        self._xml_end_tag('c:errBars')
+        self._xml_end_tag("c:errBars")
 
     def _write_err_dir(self, val):
         # Write the <c:errDir> element.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:errDir', attributes)
+        self._xml_empty_tag("c:errDir", attributes)
 
     def _write_err_bar_type(self, val):
         # Write the <c:errBarType> element.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:errBarType', attributes)
+        self._xml_empty_tag("c:errBarType", attributes)
 
     def _write_err_val_type(self, val):
         # Write the <c:errValType> element.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:errValType', attributes)
+        self._xml_empty_tag("c:errValType", attributes)
 
     def _write_no_end_cap(self):
         # Write the <c:noEndCap> element.
-        attributes = [('val', 1)]
+        attributes = [("val", 1)]
 
-        self._xml_empty_tag('c:noEndCap', attributes)
+        self._xml_empty_tag("c:noEndCap", attributes)
 
     def _write_error_val(self, val):
         # Write the <c:val> element for error bars.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:val', attributes)
+        self._xml_empty_tag("c:val", attributes)
 
     def _write_custom_error(self, error_bars):
         # Write the custom error bars tags.
 
-        if error_bars['plus_values']:
+        if error_bars["plus_values"]:
             # Write the c:plus element.
-            self._xml_start_tag('c:plus')
+            self._xml_start_tag("c:plus")
 
-            if isinstance(error_bars['plus_values'], list):
-                self._write_num_lit(error_bars['plus_values'])
+            if isinstance(error_bars["plus_values"], list):
+                self._write_num_lit(error_bars["plus_values"])
             else:
-                self._write_num_ref(error_bars['plus_values'],
-                                    error_bars['plus_data'],
-                                    'num')
-            self._xml_end_tag('c:plus')
+                self._write_num_ref(
+                    error_bars["plus_values"], error_bars["plus_data"], "num"
+                )
+            self._xml_end_tag("c:plus")
 
-        if error_bars['minus_values']:
+        if error_bars["minus_values"]:
             # Write the c:minus element.
-            self._xml_start_tag('c:minus')
+            self._xml_start_tag("c:minus")
 
-            if isinstance(error_bars['minus_values'], list):
-                self._write_num_lit(error_bars['minus_values'])
+            if isinstance(error_bars["minus_values"], list):
+                self._write_num_lit(error_bars["minus_values"])
             else:
-                self._write_num_ref(error_bars['minus_values'],
-                                    error_bars['minus_data'],
-                                    'num')
-            self._xml_end_tag('c:minus')
+                self._write_num_ref(
+                    error_bars["minus_values"], error_bars["minus_data"], "num"
+                )
+            self._xml_end_tag("c:minus")
 
     def _write_num_lit(self, data):
         # Write the <c:numLit> element for literal number list elements.
         count = len(data)
 
         # Write the c:numLit element.
-        self._xml_start_tag('c:numLit')
+        self._xml_start_tag("c:numLit")
 
         # Write the c:formatCode element.
-        self._write_format_code('General')
+        self._write_format_code("General")
 
         # Write the c:ptCount element.
         self._write_pt_count(count)
 
         for i in range(count):
             token = data[i]
 
@@ -4030,222 +4037,222 @@
             except ValueError:
                 # Write non-numeric data as 0.
                 token = 0
 
             # Write the c:pt element.
             self._write_pt(i, token)
 
-        self._xml_end_tag('c:numLit')
+        self._xml_end_tag("c:numLit")
 
     def _write_up_down_bars(self):
         # Write the <c:upDownBars> element.
         up_down_bars = self.up_down_bars
 
         if up_down_bars is None:
             return
 
-        self._xml_start_tag('c:upDownBars')
+        self._xml_start_tag("c:upDownBars")
 
         # Write the c:gapWidth element.
         self._write_gap_width(150)
 
         # Write the c:upBars element.
-        self._write_up_bars(up_down_bars.get('up'))
+        self._write_up_bars(up_down_bars.get("up"))
 
         # Write the c:downBars element.
-        self._write_down_bars(up_down_bars.get('down'))
+        self._write_down_bars(up_down_bars.get("down"))
 
-        self._xml_end_tag('c:upDownBars')
+        self._xml_end_tag("c:upDownBars")
 
     def _write_gap_width(self, val):
         # Write the <c:gapWidth> element.
 
         if val is None:
             return
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:gapWidth', attributes)
+        self._xml_empty_tag("c:gapWidth", attributes)
 
     def _write_up_bars(self, bar_format):
         # Write the <c:upBars> element.
 
-        if bar_format['line'] and bar_format['line']['defined']:
-            self._xml_start_tag('c:upBars')
+        if bar_format["line"] and bar_format["line"]["defined"]:
+            self._xml_start_tag("c:upBars")
 
             # Write the c:spPr element.
             self._write_sp_pr(bar_format)
 
-            self._xml_end_tag('c:upBars')
+            self._xml_end_tag("c:upBars")
         else:
-            self._xml_empty_tag('c:upBars')
+            self._xml_empty_tag("c:upBars")
 
     def _write_down_bars(self, bar_format):
         # Write the <c:downBars> element.
 
-        if bar_format['line'] and bar_format['line']['defined']:
-            self._xml_start_tag('c:downBars')
+        if bar_format["line"] and bar_format["line"]["defined"]:
+            self._xml_start_tag("c:downBars")
 
             # Write the c:spPr element.
             self._write_sp_pr(bar_format)
 
-            self._xml_end_tag('c:downBars')
+            self._xml_end_tag("c:downBars")
         else:
-            self._xml_empty_tag('c:downBars')
+            self._xml_empty_tag("c:downBars")
 
     def _write_disp_units(self, units, display):
         # Write the <c:dispUnits> element.
 
         if not units:
             return
 
-        attributes = [('val', units)]
+        attributes = [("val", units)]
 
-        self._xml_start_tag('c:dispUnits')
-        self._xml_empty_tag('c:builtInUnit', attributes)
+        self._xml_start_tag("c:dispUnits")
+        self._xml_empty_tag("c:builtInUnit", attributes)
 
         if display:
-            self._xml_start_tag('c:dispUnitsLbl')
-            self._xml_empty_tag('c:layout')
-            self._xml_end_tag('c:dispUnitsLbl')
+            self._xml_start_tag("c:dispUnitsLbl")
+            self._xml_empty_tag("c:layout")
+            self._xml_end_tag("c:dispUnitsLbl")
 
-        self._xml_end_tag('c:dispUnits')
+        self._xml_end_tag("c:dispUnits")
 
     def _write_a_grad_fill(self, gradient):
         # Write the <a:gradFill> element.
 
-        attributes = [('flip', 'none'), ('rotWithShape', '1')]
+        attributes = [("flip", "none"), ("rotWithShape", "1")]
 
-        if gradient['type'] == 'linear':
+        if gradient["type"] == "linear":
             attributes = []
 
-        self._xml_start_tag('a:gradFill', attributes)
+        self._xml_start_tag("a:gradFill", attributes)
 
         # Write the a:gsLst element.
         self._write_a_gs_lst(gradient)
 
-        if gradient['type'] == 'linear':
+        if gradient["type"] == "linear":
             # Write the a:lin element.
-            self._write_a_lin(gradient['angle'])
+            self._write_a_lin(gradient["angle"])
         else:
             # Write the a:path element.
-            self._write_a_path(gradient['type'])
+            self._write_a_path(gradient["type"])
 
             # Write the a:tileRect element.
-            self._write_a_tile_rect(gradient['type'])
+            self._write_a_tile_rect(gradient["type"])
 
-        self._xml_end_tag('a:gradFill')
+        self._xml_end_tag("a:gradFill")
 
     def _write_a_gs_lst(self, gradient):
         # Write the <a:gsLst> element.
-        positions = gradient['positions']
-        colors = gradient['colors']
+        positions = gradient["positions"]
+        colors = gradient["colors"]
 
-        self._xml_start_tag('a:gsLst')
+        self._xml_start_tag("a:gsLst")
 
         for i in range(len(colors)):
             pos = int(positions[i] * 1000)
-            attributes = [('pos', pos)]
-            self._xml_start_tag('a:gs', attributes)
+            attributes = [("pos", pos)]
+            self._xml_start_tag("a:gs", attributes)
 
             # Write the a:srgbClr element.
             # TODO: Wait for a feature request to support transparency.
             color = get_rgb_color(colors[i])
             self._write_a_srgb_clr(color)
 
-            self._xml_end_tag('a:gs')
+            self._xml_end_tag("a:gs")
 
-        self._xml_end_tag('a:gsLst')
+        self._xml_end_tag("a:gsLst")
 
     def _write_a_lin(self, angle):
         # Write the <a:lin> element.
 
         angle = int(60000 * angle)
 
         attributes = [
-            ('ang', angle),
-            ('scaled', '0'),
+            ("ang", angle),
+            ("scaled", "0"),
         ]
 
-        self._xml_empty_tag('a:lin', attributes)
+        self._xml_empty_tag("a:lin", attributes)
 
     def _write_a_path(self, gradient_type):
         # Write the <a:path> element.
 
-        attributes = [('path', gradient_type)]
+        attributes = [("path", gradient_type)]
 
-        self._xml_start_tag('a:path', attributes)
+        self._xml_start_tag("a:path", attributes)
 
         # Write the a:fillToRect element.
         self._write_a_fill_to_rect(gradient_type)
 
-        self._xml_end_tag('a:path')
+        self._xml_end_tag("a:path")
 
     def _write_a_fill_to_rect(self, gradient_type):
         # Write the <a:fillToRect> element.
 
-        if gradient_type == 'shape':
+        if gradient_type == "shape":
             attributes = [
-                ('l', '50000'),
-                ('t', '50000'),
-                ('r', '50000'),
-                ('b', '50000'),
+                ("l", "50000"),
+                ("t", "50000"),
+                ("r", "50000"),
+                ("b", "50000"),
             ]
         else:
             attributes = [
-                ('l', '100000'),
-                ('t', '100000'),
+                ("l", "100000"),
+                ("t", "100000"),
             ]
 
-        self._xml_empty_tag('a:fillToRect', attributes)
+        self._xml_empty_tag("a:fillToRect", attributes)
 
     def _write_a_tile_rect(self, gradient_type):
         # Write the <a:tileRect> element.
 
-        if gradient_type == 'shape':
+        if gradient_type == "shape":
             attributes = []
         else:
             attributes = [
-                ('r', '-100000'),
-                ('b', '-100000'),
+                ("r", "-100000"),
+                ("b", "-100000"),
             ]
 
-        self._xml_empty_tag('a:tileRect', attributes)
+        self._xml_empty_tag("a:tileRect", attributes)
 
     def _write_a_patt_fill(self, pattern):
         # Write the <a:pattFill> element.
 
-        attributes = [('prst', pattern['pattern'])]
+        attributes = [("prst", pattern["pattern"])]
 
-        self._xml_start_tag('a:pattFill', attributes)
+        self._xml_start_tag("a:pattFill", attributes)
 
         # Write the a:fgClr element.
-        self._write_a_fg_clr(pattern['fg_color'])
+        self._write_a_fg_clr(pattern["fg_color"])
 
         # Write the a:bgClr element.
-        self._write_a_bg_clr(pattern['bg_color'])
+        self._write_a_bg_clr(pattern["bg_color"])
 
-        self._xml_end_tag('a:pattFill')
+        self._xml_end_tag("a:pattFill")
 
     def _write_a_fg_clr(self, color):
         # Write the <a:fgClr> element.
 
         color = get_rgb_color(color)
 
-        self._xml_start_tag('a:fgClr')
+        self._xml_start_tag("a:fgClr")
 
         # Write the a:srgbClr element.
         self._write_a_srgb_clr(color)
 
-        self._xml_end_tag('a:fgClr')
+        self._xml_end_tag("a:fgClr")
 
     def _write_a_bg_clr(self, color):
         # Write the <a:bgClr> element.
 
         color = get_rgb_color(color)
 
-        self._xml_start_tag('a:bgClr')
+        self._xml_start_tag("a:bgClr")
 
         # Write the a:srgbClr element.
         self._write_a_srgb_clr(color)
 
-        self._xml_end_tag('a:bgClr')
+        self._xml_end_tag("a:bgClr")
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/chart_area.py` & `XlsxWriter-3.1.0/xlsxwriter/chart_area.py`

 * *Files 10% similar despite different names*

```diff
@@ -28,29 +28,29 @@
 
         """
         super(ChartArea, self).__init__()
 
         if options is None:
             options = {}
 
-        self.subtype = options.get('subtype')
+        self.subtype = options.get("subtype")
 
         if not self.subtype:
-            self.subtype = 'standard'
+            self.subtype = "standard"
 
-        self.cross_between = 'midCat'
+        self.cross_between = "midCat"
         self.show_crosses = 0
 
         # Override and reset the default axis values.
-        if self.subtype == 'percent_stacked':
-            self.y_axis['defaults']['num_format'] = '0%'
+        if self.subtype == "percent_stacked":
+            self.y_axis["defaults"]["num_format"] = "0%"
 
         # Set the available data label positions for this chart type.
-        self.label_position_default = 'center'
-        self.label_positions = {'center': 'ctr'}
+        self.label_position_default = "center"
+        self.label_positions = {"center": "ctr"}
 
         self.set_y_axis({})
 
     ###########################################################################
     #
     # Private API.
     #
@@ -66,36 +66,36 @@
     # XML methods.
     #
     ###########################################################################
     #
     def _write_area_chart(self, args):
         # Write the <c:areaChart> element.
 
-        if args['primary_axes']:
+        if args["primary_axes"]:
             series = self._get_primary_axes_series()
         else:
             series = self._get_secondary_axes_series()
 
         if not len(series):
             return
 
         subtype = self.subtype
 
-        if subtype == 'percent_stacked':
-            subtype = 'percentStacked'
+        if subtype == "percent_stacked":
+            subtype = "percentStacked"
 
-        self._xml_start_tag('c:areaChart')
+        self._xml_start_tag("c:areaChart")
 
         # Write the c:grouping element.
         self._write_grouping(subtype)
 
         # Write the series elements.
         for data in series:
             self._write_ser(data)
 
         # Write the c:dropLines element.
         self._write_drop_lines()
 
         # Write the c:axId elements
         self._write_axis_ids(args)
 
-        self._xml_end_tag('c:areaChart')
+        self._xml_end_tag("c:areaChart")
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/chart_bar.py` & `XlsxWriter-3.1.0/xlsxwriter/chart_bar.py`

 * *Files 12% similar despite different names*

```diff
@@ -29,39 +29,40 @@
 
         """
         super(ChartBar, self).__init__()
 
         if options is None:
             options = {}
 
-        self.subtype = options.get('subtype')
+        self.subtype = options.get("subtype")
 
         if not self.subtype:
-            self.subtype = 'clustered'
+            self.subtype = "clustered"
 
-        self.cat_axis_position = 'l'
-        self.val_axis_position = 'b'
+        self.cat_axis_position = "l"
+        self.val_axis_position = "b"
         self.horiz_val_axis = 0
         self.horiz_cat_axis = 1
         self.show_crosses = 0
 
         # Override and reset the default axis values.
-        self.x_axis['defaults']['major_gridlines'] = {'visible': 1}
-        self.y_axis['defaults']['major_gridlines'] = {'visible': 0}
+        self.x_axis["defaults"]["major_gridlines"] = {"visible": 1}
+        self.y_axis["defaults"]["major_gridlines"] = {"visible": 0}
 
-        if self.subtype == 'percent_stacked':
-            self.x_axis['defaults']['num_format'] = '0%'
+        if self.subtype == "percent_stacked":
+            self.x_axis["defaults"]["num_format"] = "0%"
 
         # Set the available data label positions for this chart type.
-        self.label_position_default = 'outside_end'
+        self.label_position_default = "outside_end"
         self.label_positions = {
-            'center': 'ctr',
-            'inside_base': 'inBase',
-            'inside_end': 'inEnd',
-            'outside_end': 'outEnd'}
+            "center": "ctr",
+            "inside_base": "inBase",
+            "inside_end": "inEnd",
+            "outside_end": "outEnd",
+        }
 
         self.set_x_axis({})
         self.set_y_axis({})
 
     def combine(self, chart=None):
         """
         Create a combination chart with a secondary chart.
@@ -77,97 +78,97 @@
             Nothing.
 
         """
         if chart is None:
             return
 
         if not chart.is_secondary:
-            warn('Charts combined with Bar charts must be on a secondary axis')
+            warn("Charts combined with Bar charts must be on a secondary axis")
 
         self.combined = chart
 
     ###########################################################################
     #
     # Private API.
     #
     ###########################################################################
 
     def _write_chart_type(self, args):
         # Override the virtual superclass method with a chart specific method.
-        if args['primary_axes']:
+        if args["primary_axes"]:
             # Reverse X and Y axes for Bar charts.
             tmp = self.y_axis
             self.y_axis = self.x_axis
             self.x_axis = tmp
 
-            if self.y2_axis['position'] == 'r':
-                self.y2_axis['position'] = 't'
+            if self.y2_axis["position"] == "r":
+                self.y2_axis["position"] = "t"
 
         # Write the c:barChart element.
         self._write_bar_chart(args)
 
     def _write_bar_chart(self, args):
         # Write the <c:barChart> element.
 
-        if args['primary_axes']:
+        if args["primary_axes"]:
             series = self._get_primary_axes_series()
         else:
             series = self._get_secondary_axes_series()
 
         if not len(series):
             return
 
         subtype = self.subtype
-        if subtype == 'percent_stacked':
-            subtype = 'percentStacked'
+        if subtype == "percent_stacked":
+            subtype = "percentStacked"
 
         # Set a default overlap for stacked charts.
-        if 'stacked' in self.subtype:
+        if "stacked" in self.subtype:
             if self.series_overlap_1 is None:
                 self.series_overlap_1 = 100
 
-        self._xml_start_tag('c:barChart')
+        self._xml_start_tag("c:barChart")
 
         # Write the c:barDir element.
         self._write_bar_dir()
 
         # Write the c:grouping element.
         self._write_grouping(subtype)
 
         # Write the c:ser elements.
         for data in series:
             self._write_ser(data)
 
         # Write the c:gapWidth element.
-        if args['primary_axes']:
+        if args["primary_axes"]:
             self._write_gap_width(self.series_gap_1)
         else:
             self._write_gap_width(self.series_gap_2)
 
         # Write the c:overlap element.
-        if args['primary_axes']:
+        if args["primary_axes"]:
             self._write_overlap(self.series_overlap_1)
         else:
             self._write_overlap(self.series_overlap_2)
 
         # Write the c:axId elements
         self._write_axis_ids(args)
 
-        self._xml_end_tag('c:barChart')
+        self._xml_end_tag("c:barChart")
 
     ###########################################################################
     #
     # XML methods.
     #
     ###########################################################################
 
     def _write_bar_dir(self):
         # Write the <c:barDir> element.
-        val = 'bar'
+        val = "bar"
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:barDir', attributes)
+        self._xml_empty_tag("c:barDir", attributes)
 
     def _write_err_dir(self, val):
         # Overridden from Chart class since it is not used in Bar charts.
         pass
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/chart_column.py` & `XlsxWriter-3.1.0/xlsxwriter/chart_column.py`

 * *Files 6% similar despite different names*

```diff
@@ -28,31 +28,32 @@
 
         """
         super(ChartColumn, self).__init__()
 
         if options is None:
             options = {}
 
-        self.subtype = options.get('subtype')
+        self.subtype = options.get("subtype")
 
         if not self.subtype:
-            self.subtype = 'clustered'
+            self.subtype = "clustered"
 
         self.horiz_val_axis = 0
 
-        if self.subtype == 'percent_stacked':
-            self.y_axis['defaults']['num_format'] = '0%'
+        if self.subtype == "percent_stacked":
+            self.y_axis["defaults"]["num_format"] = "0%"
 
         # Set the available data label positions for this chart type.
-        self.label_position_default = 'outside_end'
+        self.label_position_default = "outside_end"
         self.label_positions = {
-            'center': 'ctr',
-            'inside_base': 'inBase',
-            'inside_end': 'inEnd',
-            'outside_end': 'outEnd'}
+            "center": "ctr",
+            "inside_base": "inBase",
+            "inside_end": "inEnd",
+            "outside_end": "outEnd",
+        }
 
         self.set_y_axis({})
 
     ###########################################################################
     #
     # Private API.
     #
@@ -63,70 +64,70 @@
 
         # Write the c:barChart element.
         self._write_bar_chart(args)
 
     def _write_bar_chart(self, args):
         # Write the <c:barChart> element.
 
-        if args['primary_axes']:
+        if args["primary_axes"]:
             series = self._get_primary_axes_series()
         else:
             series = self._get_secondary_axes_series()
 
         if not len(series):
             return
 
         subtype = self.subtype
-        if subtype == 'percent_stacked':
-            subtype = 'percentStacked'
+        if subtype == "percent_stacked":
+            subtype = "percentStacked"
 
         # Set a default overlap for stacked charts.
-        if 'stacked' in self.subtype:
+        if "stacked" in self.subtype:
             if self.series_overlap_1 is None:
                 self.series_overlap_1 = 100
 
-        self._xml_start_tag('c:barChart')
+        self._xml_start_tag("c:barChart")
 
         # Write the c:barDir element.
         self._write_bar_dir()
 
         # Write the c:grouping element.
         self._write_grouping(subtype)
 
         # Write the c:ser elements.
         for data in series:
             self._write_ser(data)
 
         # Write the c:gapWidth element.
-        if args['primary_axes']:
+        if args["primary_axes"]:
             self._write_gap_width(self.series_gap_1)
         else:
             self._write_gap_width(self.series_gap_2)
 
         # Write the c:overlap element.
-        if args['primary_axes']:
+        if args["primary_axes"]:
             self._write_overlap(self.series_overlap_1)
         else:
             self._write_overlap(self.series_overlap_2)
 
         # Write the c:axId elements
         self._write_axis_ids(args)
 
-        self._xml_end_tag('c:barChart')
+        self._xml_end_tag("c:barChart")
 
     ###########################################################################
     #
     # XML methods.
     #
     ###########################################################################
 
     def _write_bar_dir(self):
         # Write the <c:barDir> element.
-        val = 'col'
+        val = "col"
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:barDir', attributes)
+        self._xml_empty_tag("c:barDir", attributes)
 
     def _write_err_dir(self, val):
         # Overridden from Chart class since it is not used in Column charts.
         pass
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/chart_doughnut.py` & `XlsxWriter-3.1.0/xlsxwriter/chart_doughnut.py`

 * *Files 6% similar despite different names*

```diff
@@ -46,16 +46,15 @@
 
         """
         if size is None:
             return
 
         # Ensure the size is in Excel's range.
         if size < 10 or size > 90:
-            warn("Chart hole size %d outside Excel range: 10 <= size <= 90"
-                 % size)
+            warn("Chart hole size %d outside Excel range: 10 <= size <= 90" % size)
             return
 
         self.hole_size = int(size)
 
     ###########################################################################
     #
     # Private API.
@@ -72,29 +71,29 @@
     # XML methods.
     #
     ###########################################################################
 
     def _write_doughnut_chart(self, args):
         # Write the <c:doughnutChart> element.  Over-ridden method to remove
         # axis_id code since Doughnut charts don't require val and cat axes.
-        self._xml_start_tag('c:doughnutChart')
+        self._xml_start_tag("c:doughnutChart")
 
         # Write the c:varyColors element.
         self._write_vary_colors()
 
         # Write the series elements.
         for data in self.series:
             self._write_ser(data)
 
         # Write the c:firstSliceAng element.
         self._write_first_slice_ang()
 
         # Write the c:holeSize element.
         self._write_c_hole_size()
 
-        self._xml_end_tag('c:doughnutChart')
+        self._xml_end_tag("c:doughnutChart")
 
     def _write_c_hole_size(self):
         # Write the <c:holeSize> element.
-        attributes = [('val', self.hole_size)]
+        attributes = [("val", self.hole_size)]
 
-        self._xml_empty_tag('c:holeSize', attributes)
+        self._xml_empty_tag("c:holeSize", attributes)
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/chart_line.py` & `XlsxWriter-3.1.0/xlsxwriter/chart_line.py`

 * *Files 14% similar despite different names*

```diff
@@ -28,37 +28,38 @@
 
         """
         super(ChartLine, self).__init__()
 
         if options is None:
             options = {}
 
-        self.subtype = options.get('subtype')
+        self.subtype = options.get("subtype")
 
         if not self.subtype:
-            self.subtype = 'standard'
+            self.subtype = "standard"
 
-        self.default_marker = {'type': 'none'}
+        self.default_marker = {"type": "none"}
         self.smooth_allowed = True
 
         # Override and reset the default axis values.
-        if self.subtype == 'percent_stacked':
-            self.y_axis['defaults']['num_format'] = '0%'
+        if self.subtype == "percent_stacked":
+            self.y_axis["defaults"]["num_format"] = "0%"
 
         # Set the available data label positions for this chart type.
-        self.label_position_default = 'right'
+        self.label_position_default = "right"
         self.label_positions = {
-            'center': 'ctr',
-            'right': 'r',
-            'left': 'l',
-            'above': 't',
-            'below': 'b',
+            "center": "ctr",
+            "right": "r",
+            "left": "l",
+            "above": "t",
+            "below": "b",
             # For backward compatibility.
-            'top': 't',
-            'bottom': 'b'}
+            "top": "t",
+            "bottom": "b",
+        }
 
         self.set_y_axis({})
 
     ###########################################################################
     #
     # Private API.
     #
@@ -74,28 +75,28 @@
     # XML methods.
     #
     ###########################################################################
 
     def _write_line_chart(self, args):
         # Write the <c:lineChart> element.
 
-        if args['primary_axes']:
+        if args["primary_axes"]:
             series = self._get_primary_axes_series()
         else:
             series = self._get_secondary_axes_series()
 
         if not len(series):
             return
 
         subtype = self.subtype
 
-        if subtype == 'percent_stacked':
-            subtype = 'percentStacked'
+        if subtype == "percent_stacked":
+            subtype = "percentStacked"
 
-        self._xml_start_tag('c:lineChart')
+        self._xml_start_tag("c:lineChart")
 
         # Write the c:grouping element.
         self._write_grouping(subtype)
 
         # Write the series elements.
         for data in series:
             self._write_ser(data)
@@ -111,32 +112,32 @@
 
         # Write the c:marker element.
         self._write_marker_value()
 
         # Write the c:axId elements
         self._write_axis_ids(args)
 
-        self._xml_end_tag('c:lineChart')
+        self._xml_end_tag("c:lineChart")
 
     def _write_d_pt_point(self, index, point):
         # Write an individual <c:dPt> element. Override the parent method to
         # add markers.
 
-        self._xml_start_tag('c:dPt')
+        self._xml_start_tag("c:dPt")
 
         # Write the c:idx element.
         self._write_idx(index)
 
-        self._xml_start_tag('c:marker')
+        self._xml_start_tag("c:marker")
 
         # Write the c:spPr element.
         self._write_sp_pr(point)
 
-        self._xml_end_tag('c:marker')
+        self._xml_end_tag("c:marker")
 
-        self._xml_end_tag('c:dPt')
+        self._xml_end_tag("c:dPt")
 
     def _write_marker_value(self):
         # Write the <c:marker> element without a sub-element.
-        attributes = [('val', 1)]
+        attributes = [("val", 1)]
 
-        self._xml_empty_tag('c:marker', attributes)
+        self._xml_empty_tag("c:marker", attributes)
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/chart_pie.py` & `XlsxWriter-3.1.0/xlsxwriter/chart_pie.py`

 * *Files 6% similar despite different names*

```diff
@@ -30,20 +30,21 @@
         """
         super(ChartPie, self).__init__()
 
         self.vary_data_color = 1
         self.rotation = 0
 
         # Set the available data label positions for this chart type.
-        self.label_position_default = 'best_fit'
+        self.label_position_default = "best_fit"
         self.label_positions = {
-            'center': 'ctr',
-            'inside_end': 'inEnd',
-            'outside_end': 'outEnd',
-            'best_fit': 'bestFit'}
+            "center": "ctr",
+            "inside_end": "inEnd",
+            "outside_end": "outEnd",
+            "best_fit": "bestFit",
+        }
 
     def set_rotation(self, rotation):
         """
         Set the Pie/Doughnut chart rotation: the angle of the first slice.
 
         Args:
             rotation: First segment angle: 0 <= rotation <= 360.
@@ -53,16 +54,17 @@
 
         """
         if rotation is None:
             return
 
         # Ensure the rotation is in Excel's range.
         if rotation < 0 or rotation > 360:
-            warn("Chart rotation %d outside Excel range: 0 <= rotation <= 360"
-                 % rotation)
+            warn(
+                "Chart rotation %d outside Excel range: 0 <= rotation <= 360" % rotation
+            )
             return
 
         self.rotation = int(rotation)
 
     ###########################################################################
     #
     # Private API.
@@ -79,38 +81,38 @@
     # XML methods.
     #
     ###########################################################################
 
     def _write_pie_chart(self, args):
         # Write the <c:pieChart> element.  Over-ridden method to remove
         # axis_id code since Pie charts don't require val and cat axes.
-        self._xml_start_tag('c:pieChart')
+        self._xml_start_tag("c:pieChart")
 
         # Write the c:varyColors element.
         self._write_vary_colors()
 
         # Write the series elements.
         for data in self.series:
             self._write_ser(data)
 
         # Write the c:firstSliceAng element.
         self._write_first_slice_ang()
 
-        self._xml_end_tag('c:pieChart')
+        self._xml_end_tag("c:pieChart")
 
     def _write_plot_area(self):
         # Over-ridden method to remove the cat_axis() and val_axis() code
         # since Pie charts don't require those axes.
         #
         # Write the <c:plotArea> element.
 
-        self._xml_start_tag('c:plotArea')
+        self._xml_start_tag("c:plotArea")
 
         # Write the c:layout element.
-        self._write_layout(self.plotarea.get('layout'), 'plot')
+        self._write_layout(self.plotarea.get("layout"), "plot")
 
         # Write the subclass chart type element.
         self._write_chart_type(None)
         # Configure a combined chart if present.
         second_chart = self.combined
 
         if second_chart:
@@ -128,123 +130,122 @@
 
             # Write the subclass chart type elements for combined chart.
             second_chart._write_chart_type(None)
 
         # Write the c:spPr element for the plotarea formatting.
         self._write_sp_pr(self.plotarea)
 
-        self._xml_end_tag('c:plotArea')
+        self._xml_end_tag("c:plotArea")
 
     def _write_legend(self):
         # Over-ridden method to add <c:txPr> to legend.
         # Write the <c:legend> element.
         legend = self.legend
-        position = legend.get('position', 'right')
-        font = legend.get('font')
+        position = legend.get("position", "right")
+        font = legend.get("font")
         delete_series = []
         overlay = 0
 
-        if (legend.get('delete_series')
-                and type(legend['delete_series']) is list):
-            delete_series = legend['delete_series']
+        if legend.get("delete_series") and type(legend["delete_series"]) is list:
+            delete_series = legend["delete_series"]
 
-        if position.startswith('overlay_'):
-            position = position.replace('overlay_', '')
+        if position.startswith("overlay_"):
+            position = position.replace("overlay_", "")
             overlay = 1
 
         allowed = {
-            'right': 'r',
-            'left': 'l',
-            'top': 't',
-            'bottom': 'b',
-            'top_right': 'tr',
+            "right": "r",
+            "left": "l",
+            "top": "t",
+            "bottom": "b",
+            "top_right": "tr",
         }
 
-        if position == 'none':
+        if position == "none":
             return
 
         if position not in allowed:
             return
 
         position = allowed[position]
 
-        self._xml_start_tag('c:legend')
+        self._xml_start_tag("c:legend")
 
         # Write the c:legendPos element.
         self._write_legend_pos(position)
 
         # Remove series labels from the legend.
         for index in delete_series:
             # Write the c:legendEntry element.
             self._write_legend_entry(index)
 
         # Write the c:layout element.
-        self._write_layout(legend.get('layout'), 'legend')
+        self._write_layout(legend.get("layout"), "legend")
 
         # Write the c:overlay element.
         if overlay:
             self._write_overlay()
 
         # Write the c:spPr element.
         self._write_sp_pr(legend)
 
         # Write the c:txPr element. Over-ridden.
         self._write_tx_pr_legend(None, font)
 
-        self._xml_end_tag('c:legend')
+        self._xml_end_tag("c:legend")
 
     def _write_tx_pr_legend(self, horiz, font):
         # Write the <c:txPr> element for legends.
 
-        if font and font.get('rotation'):
-            rotation = font['rotation']
+        if font and font.get("rotation"):
+            rotation = font["rotation"]
         else:
             rotation = None
 
-        self._xml_start_tag('c:txPr')
+        self._xml_start_tag("c:txPr")
 
         # Write the a:bodyPr element.
         self._write_a_body_pr(rotation, horiz)
 
         # Write the a:lstStyle element.
         self._write_a_lst_style()
 
         # Write the a:p element.
         self._write_a_p_legend(font)
 
-        self._xml_end_tag('c:txPr')
+        self._xml_end_tag("c:txPr")
 
     def _write_a_p_legend(self, font):
         # Write the <a:p> element for legends.
 
-        self._xml_start_tag('a:p')
+        self._xml_start_tag("a:p")
 
         # Write the a:pPr element.
         self._write_a_p_pr_legend(font)
 
         # Write the a:endParaRPr element.
         self._write_a_end_para_rpr()
 
-        self._xml_end_tag('a:p')
+        self._xml_end_tag("a:p")
 
     def _write_a_p_pr_legend(self, font):
         # Write the <a:pPr> element for legends.
-        attributes = [('rtl', 0)]
+        attributes = [("rtl", 0)]
 
-        self._xml_start_tag('a:pPr', attributes)
+        self._xml_start_tag("a:pPr", attributes)
 
         # Write the a:defRPr element.
         self._write_a_def_rpr(font)
 
-        self._xml_end_tag('a:pPr')
+        self._xml_end_tag("a:pPr")
 
     def _write_vary_colors(self):
         # Write the <c:varyColors> element.
-        attributes = [('val', 1)]
+        attributes = [("val", 1)]
 
-        self._xml_empty_tag('c:varyColors', attributes)
+        self._xml_empty_tag("c:varyColors", attributes)
 
     def _write_first_slice_ang(self):
         # Write the <c:firstSliceAng> element.
-        attributes = [('val', self.rotation)]
+        attributes = [("val", self.rotation)]
 
-        self._xml_empty_tag('c:firstSliceAng', attributes)
+        self._xml_empty_tag("c:firstSliceAng", attributes)
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/chart_radar.py` & `XlsxWriter-3.1.0/xlsxwriter/chart_radar.py`

 * *Files 14% similar despite different names*

```diff
@@ -28,30 +28,30 @@
 
         """
         super(ChartRadar, self).__init__()
 
         if options is None:
             options = {}
 
-        self.subtype = options.get('subtype')
+        self.subtype = options.get("subtype")
 
         if not self.subtype:
-            self.subtype = 'marker'
-            self.default_marker = {'type': 'none'}
+            self.subtype = "marker"
+            self.default_marker = {"type": "none"}
 
         # Override and reset the default axis values.
-        self.x_axis['defaults']['major_gridlines'] = {'visible': 1}
+        self.x_axis["defaults"]["major_gridlines"] = {"visible": 1}
         self.set_x_axis({})
 
         # Set the available data label positions for this chart type.
-        self.label_position_default = 'center'
-        self.label_positions = {'center': 'ctr'}
+        self.label_position_default = "center"
+        self.label_positions = {"center": "ctr"}
 
         # Hardcode major_tick_mark for now until there is an accessor.
-        self.y_axis['major_tick_mark'] = 'cross'
+        self.y_axis["major_tick_mark"] = "cross"
 
     ###########################################################################
     #
     # Private API.
     #
     ###########################################################################
 
@@ -64,39 +64,39 @@
     # XML methods.
     #
     ###########################################################################
 
     def _write_radar_chart(self, args):
         # Write the <c:radarChart> element.
 
-        if args['primary_axes']:
+        if args["primary_axes"]:
             series = self._get_primary_axes_series()
         else:
             series = self._get_secondary_axes_series()
 
         if not len(series):
             return
 
-        self._xml_start_tag('c:radarChart')
+        self._xml_start_tag("c:radarChart")
 
         # Write the c:radarStyle element.
         self._write_radar_style()
 
         # Write the series elements.
         for data in series:
             self._write_ser(data)
 
         # Write the c:axId elements
         self._write_axis_ids(args)
 
-        self._xml_end_tag('c:radarChart')
+        self._xml_end_tag("c:radarChart")
 
     def _write_radar_style(self):
         # Write the <c:radarStyle> element.
-        val = 'marker'
+        val = "marker"
 
-        if self.subtype == 'filled':
-            val = 'filled'
+        if self.subtype == "filled":
+            val = "filled"
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:radarStyle', attributes)
+        self._xml_empty_tag("c:radarStyle", attributes)
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/chart_scatter.py` & `XlsxWriter-3.1.0/xlsxwriter/chart_scatter.py`

 * *Files 8% similar despite different names*

```diff
@@ -29,36 +29,37 @@
 
         """
         super(ChartScatter, self).__init__()
 
         if options is None:
             options = {}
 
-        self.subtype = options.get('subtype')
+        self.subtype = options.get("subtype")
 
         if not self.subtype:
-            self.subtype = 'marker_only'
+            self.subtype = "marker_only"
 
-        self.cross_between = 'midCat'
+        self.cross_between = "midCat"
         self.horiz_val_axis = 0
-        self.val_axis_position = 'b'
+        self.val_axis_position = "b"
         self.smooth_allowed = True
         self.requires_category = True
 
         # Set the available data label positions for this chart type.
-        self.label_position_default = 'right'
+        self.label_position_default = "right"
         self.label_positions = {
-            'center': 'ctr',
-            'right': 'r',
-            'left': 'l',
-            'above': 't',
-            'below': 'b',
+            "center": "ctr",
+            "right": "r",
+            "left": "l",
+            "above": "t",
+            "below": "b",
             # For backward compatibility.
-            'top': 't',
-            'bottom': 'b'}
+            "top": "t",
+            "bottom": "b",
+        }
 
     def combine(self, chart=None):
         """
         Create a combination chart with a secondary chart.
 
         Note: Override parent method to add a warning.
 
@@ -68,16 +69,18 @@
         Returns:
             Nothing.
 
         """
         if chart is None:
             return
 
-        warn('Combined chart not currently supported with scatter chart '
-             'as the primary chart')
+        warn(
+            "Combined chart not currently supported with scatter chart "
+            "as the primary chart"
+        )
 
     ###########################################################################
     #
     # Private API.
     #
     ###########################################################################
 
@@ -91,230 +94,241 @@
     # XML methods.
     #
     ###########################################################################
 
     def _write_scatter_chart(self, args):
         # Write the <c:scatterChart> element.
 
-        if args['primary_axes']:
+        if args["primary_axes"]:
             series = self._get_primary_axes_series()
         else:
             series = self._get_secondary_axes_series()
 
         if not len(series):
             return
 
-        style = 'lineMarker'
+        style = "lineMarker"
         subtype = self.subtype
 
         # Set the user defined chart subtype.
-        if subtype == 'marker_only':
-            style = 'lineMarker'
+        if subtype == "marker_only":
+            style = "lineMarker"
 
-        if subtype == 'straight_with_markers':
-            style = 'lineMarker'
+        if subtype == "straight_with_markers":
+            style = "lineMarker"
 
-        if subtype == 'straight':
-            style = 'lineMarker'
-            self.default_marker = {'type': 'none'}
-
-        if subtype == 'smooth_with_markers':
-            style = 'smoothMarker'
-
-        if subtype == 'smooth':
-            style = 'smoothMarker'
-            self.default_marker = {'type': 'none'}
+        if subtype == "straight":
+            style = "lineMarker"
+            self.default_marker = {"type": "none"}
+
+        if subtype == "smooth_with_markers":
+            style = "smoothMarker"
+
+        if subtype == "smooth":
+            style = "smoothMarker"
+            self.default_marker = {"type": "none"}
 
         # Add default formatting to the series data.
         self._modify_series_formatting()
 
-        self._xml_start_tag('c:scatterChart')
+        self._xml_start_tag("c:scatterChart")
 
         # Write the c:scatterStyle element.
         self._write_scatter_style(style)
 
         # Write the series elements.
         for data in series:
             self._write_ser(data)
 
         # Write the c:axId elements
         self._write_axis_ids(args)
 
-        self._xml_end_tag('c:scatterChart')
+        self._xml_end_tag("c:scatterChart")
 
     def _write_ser(self, series):
         # Over-ridden to write c:xVal/c:yVal instead of c:cat/c:val elements.
         # Write the <c:ser> element.
 
         index = self.series_index
         self.series_index += 1
 
-        self._xml_start_tag('c:ser')
+        self._xml_start_tag("c:ser")
 
         # Write the c:idx element.
         self._write_idx(index)
 
         # Write the c:order element.
         self._write_order(index)
 
         # Write the series name.
         self._write_series_name(series)
 
         # Write the c:spPr element.
         self._write_sp_pr(series)
 
         # Write the c:marker element.
-        self._write_marker(series.get('marker'))
+        self._write_marker(series.get("marker"))
 
         # Write the c:dPt element.
-        self._write_d_pt(series.get('points'))
+        self._write_d_pt(series.get("points"))
 
         # Write the c:dLbls element.
-        self._write_d_lbls(series.get('labels'))
+        self._write_d_lbls(series.get("labels"))
 
         # Write the c:trendline element.
-        self._write_trendline(series.get('trendline'))
+        self._write_trendline(series.get("trendline"))
 
         # Write the c:errBars element.
-        self._write_error_bars(series.get('error_bars'))
+        self._write_error_bars(series.get("error_bars"))
 
         # Write the c:xVal element.
         self._write_x_val(series)
 
         # Write the c:yVal element.
         self._write_y_val(series)
 
         # Write the c:smooth element.
-        if 'smooth' in self.subtype and series['smooth'] is None:
+        if "smooth" in self.subtype and series["smooth"] is None:
             # Default is on for smooth scatter charts.
             self._write_c_smooth(True)
         else:
-            self._write_c_smooth(series['smooth'])
+            self._write_c_smooth(series["smooth"])
 
-        self._xml_end_tag('c:ser')
+        self._xml_end_tag("c:ser")
 
     def _write_plot_area(self):
         # Over-ridden to have 2 valAx elements for scatter charts instead
         # of catAx/valAx.
         #
         # Write the <c:plotArea> element.
-        self._xml_start_tag('c:plotArea')
+        self._xml_start_tag("c:plotArea")
 
         # Write the c:layout element.
-        self._write_layout(self.plotarea.get('layout'), 'plot')
+        self._write_layout(self.plotarea.get("layout"), "plot")
 
         # Write the subclass chart elements for primary and secondary axes.
-        self._write_chart_type({'primary_axes': 1})
-        self._write_chart_type({'primary_axes': 0})
+        self._write_chart_type({"primary_axes": 1})
+        self._write_chart_type({"primary_axes": 0})
 
         # Write c:catAx and c:valAx elements for series using primary axes.
-        self._write_cat_val_axis({'x_axis': self.x_axis,
-                                  'y_axis': self.y_axis,
-                                  'axis_ids': self.axis_ids,
-                                  'position': 'b',
-                                  })
+        self._write_cat_val_axis(
+            {
+                "x_axis": self.x_axis,
+                "y_axis": self.y_axis,
+                "axis_ids": self.axis_ids,
+                "position": "b",
+            }
+        )
 
         tmp = self.horiz_val_axis
         self.horiz_val_axis = 1
 
-        self._write_val_axis({'x_axis': self.x_axis,
-                              'y_axis': self.y_axis,
-                              'axis_ids': self.axis_ids,
-                              'position': 'l',
-                              })
+        self._write_val_axis(
+            {
+                "x_axis": self.x_axis,
+                "y_axis": self.y_axis,
+                "axis_ids": self.axis_ids,
+                "position": "l",
+            }
+        )
 
         self.horiz_val_axis = tmp
 
         # Write c:valAx and c:catAx elements for series using secondary axes
-        self._write_cat_val_axis({'x_axis': self.x2_axis,
-                                  'y_axis': self.y2_axis,
-                                  'axis_ids': self.axis2_ids,
-                                  'position': 'b',
-                                  })
+        self._write_cat_val_axis(
+            {
+                "x_axis": self.x2_axis,
+                "y_axis": self.y2_axis,
+                "axis_ids": self.axis2_ids,
+                "position": "b",
+            }
+        )
         self.horiz_val_axis = 1
-        self._write_val_axis({'x_axis': self.x2_axis,
-                              'y_axis': self.y2_axis,
-                              'axis_ids': self.axis2_ids,
-                              'position': 'l',
-                              })
+        self._write_val_axis(
+            {
+                "x_axis": self.x2_axis,
+                "y_axis": self.y2_axis,
+                "axis_ids": self.axis2_ids,
+                "position": "l",
+            }
+        )
 
         # Write the c:spPr element for the plotarea formatting.
         self._write_sp_pr(self.plotarea)
 
-        self._xml_end_tag('c:plotArea')
+        self._xml_end_tag("c:plotArea")
 
     def _write_x_val(self, series):
         # Write the <c:xVal> element.
-        formula = series.get('categories')
-        data_id = series.get('cat_data_id')
+        formula = series.get("categories")
+        data_id = series.get("cat_data_id")
         data = self.formula_data[data_id]
 
-        self._xml_start_tag('c:xVal')
+        self._xml_start_tag("c:xVal")
 
         # Check the type of cached data.
         data_type = self._get_data_type(data)
 
         # TODO. Can a scatter plot have non-numeric data.
-        if data_type == 'str':
+        if data_type == "str":
             # Write the c:numRef element.
             self._write_str_ref(formula, data, data_type)
         else:
             # Write the c:numRef element.
             self._write_num_ref(formula, data, data_type)
 
-        self._xml_end_tag('c:xVal')
+        self._xml_end_tag("c:xVal")
 
     def _write_y_val(self, series):
         # Write the <c:yVal> element.
-        formula = series.get('values')
-        data_id = series.get('val_data_id')
+        formula = series.get("values")
+        data_id = series.get("val_data_id")
         data = self.formula_data[data_id]
 
-        self._xml_start_tag('c:yVal')
+        self._xml_start_tag("c:yVal")
 
         # Unlike Cat axes data should only be numeric.
         # Write the c:numRef element.
-        self._write_num_ref(formula, data, 'num')
+        self._write_num_ref(formula, data, "num")
 
-        self._xml_end_tag('c:yVal')
+        self._xml_end_tag("c:yVal")
 
     def _write_scatter_style(self, val):
         # Write the <c:scatterStyle> element.
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('c:scatterStyle', attributes)
+        self._xml_empty_tag("c:scatterStyle", attributes)
 
     def _modify_series_formatting(self):
         # Add default formatting to the series data unless it has already been
         # specified by the user.
         subtype = self.subtype
 
         # The default scatter style "markers only" requires a line type.
-        if subtype == 'marker_only':
-
+        if subtype == "marker_only":
             # Go through each series and define default values.
             for series in self.series:
-
                 # Set a line type unless there is already a user defined type.
-                if not series['line']['defined']:
-                    series['line'] = {'width': 2.25,
-                                      'none': 1,
-                                      'defined': 1,
-                                      }
+                if not series["line"]["defined"]:
+                    series["line"] = {
+                        "width": 2.25,
+                        "none": 1,
+                        "defined": 1,
+                    }
 
     def _write_d_pt_point(self, index, point):
         # Write an individual <c:dPt> element. Override the parent method to
         # add markers.
 
-        self._xml_start_tag('c:dPt')
+        self._xml_start_tag("c:dPt")
 
         # Write the c:idx element.
         self._write_idx(index)
 
-        self._xml_start_tag('c:marker')
+        self._xml_start_tag("c:marker")
 
         # Write the c:spPr element.
         self._write_sp_pr(point)
 
-        self._xml_end_tag('c:marker')
+        self._xml_end_tag("c:marker")
 
-        self._xml_end_tag('c:dPt')
+        self._xml_end_tag("c:dPt")
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/chart_stock.py` & `XlsxWriter-3.1.0/xlsxwriter/chart_stock.py`

 * *Files 16% similar despite different names*

```diff
@@ -29,28 +29,29 @@
         super(ChartStock, self).__init__()
 
         self.show_crosses = 0
         self.hi_low_lines = {}
         self.date_category = True
 
         # Override and reset the default axis values.
-        self.x_axis['defaults']['num_format'] = 'dd/mm/yyyy'
-        self.x2_axis['defaults']['num_format'] = 'dd/mm/yyyy'
+        self.x_axis["defaults"]["num_format"] = "dd/mm/yyyy"
+        self.x2_axis["defaults"]["num_format"] = "dd/mm/yyyy"
 
         # Set the available data label positions for this chart type.
-        self.label_position_default = 'right'
+        self.label_position_default = "right"
         self.label_positions = {
-            'center': 'ctr',
-            'right': 'r',
-            'left': 'l',
-            'above': 't',
-            'below': 'b',
+            "center": "ctr",
+            "right": "r",
+            "left": "l",
+            "above": "t",
+            "below": "b",
             # For backward compatibility.
-            'top': 't',
-            'bottom': 'b'}
+            "top": "t",
+            "bottom": "b",
+        }
 
         self.set_x_axis({})
         self.set_x2_axis({})
 
     ###########################################################################
     #
     # Private API.
@@ -68,58 +69,56 @@
     #
     ###########################################################################
 
     def _write_stock_chart(self, args):
         # Write the <c:stockChart> element.
         # Overridden to add hi_low_lines().
 
-        if args['primary_axes']:
+        if args["primary_axes"]:
             series = self._get_primary_axes_series()
         else:
             series = self._get_secondary_axes_series()
 
         if not len(series):
             return
 
         # Add default formatting to the series data.
         self._modify_series_formatting()
 
-        self._xml_start_tag('c:stockChart')
+        self._xml_start_tag("c:stockChart")
 
         # Write the series elements.
         for data in series:
             self._write_ser(data)
 
         # Write the c:dropLines element.
         self._write_drop_lines()
 
         # Write the c:hiLowLines element.
-        if args.get('primary_axes'):
+        if args.get("primary_axes"):
             self._write_hi_low_lines()
 
         # Write the c:upDownBars element.
         self._write_up_down_bars()
 
         # Write the c:axId elements
         self._write_axis_ids(args)
 
-        self._xml_end_tag('c:stockChart')
+        self._xml_end_tag("c:stockChart")
 
     def _modify_series_formatting(self):
         # Add default formatting to the series data.
 
         index = 0
 
         for series in self.series:
             if index % 4 != 3:
-                if not series['line']['defined']:
-                    series['line'] = {'width': 2.25,
-                                      'none': 1,
-                                      'defined': 1}
+                if not series["line"]["defined"]:
+                    series["line"] = {"width": 2.25, "none": 1, "defined": 1}
 
-                if series['marker'] is None:
+                if series["marker"] is None:
                     if index % 4 == 2:
-                        series['marker'] = {'type': 'dot', 'size': 3}
+                        series["marker"] = {"type": "dot", "size": 3}
                     else:
-                        series['marker'] = {'type': 'none'}
+                        series["marker"] = {"type": "none"}
 
             index += 1
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/chartsheet.py` & `XlsxWriter-3.1.0/xlsxwriter/chartsheet.py`

 * *Files 11% similar despite different names*

```diff
@@ -49,15 +49,15 @@
         """
         chart.embedded = False
         chart.protection = self.protection
         self.chart = chart
         self.charts.append([0, 0, chart, 0, 0, 1, 1])
         return chart
 
-    def protect(self, password='', options=None):
+    def protect(self, password="", options=None):
         """
         Set the password and protection options of the worksheet.
 
         Args:
             password: An optional password string.
             options:  A dictionary of worksheet objects to protect.
 
@@ -69,31 +69,31 @@
 
         # Chartsheets only allow a reduced set of protect options.
         copy = {}
 
         if not options:
             options = {}
 
-        if options.get('objects') is None:
-            copy['objects'] = False
+        if options.get("objects") is None:
+            copy["objects"] = False
         else:
             # Objects are default on for chartsheets, so reverse state.
-            copy['objects'] = not options['objects']
+            copy["objects"] = not options["objects"]
 
-        if options.get('content') is None:
-            copy['content'] = True
+        if options.get("content") is None:
+            copy["content"] = True
         else:
-            copy['content'] = options['content']
+            copy["content"] = options["content"]
 
-        copy['sheet'] = False
-        copy['scenarios'] = True
+        copy["sheet"] = False
+        copy["scenarios"] = True
 
         # If objects and content are both off then the chartsheet isn't
         # protected, unless it has a password.
-        if password == '' and copy['objects'] and not copy['content']:
+        if password == "" and copy["objects"] and not copy["content"]:
             return
 
         if self.chart:
             self.chart.protection = True
         else:
             self.protection = True
 
@@ -135,63 +135,59 @@
         # Write the headerFooter element.
         self._write_header_footer()
 
         # Write the drawing element.
         self._write_drawings()
 
         # Close the worksheet tag.
-        self._xml_end_tag('chartsheet')
+        self._xml_end_tag("chartsheet")
 
         # Close the file.
         self._xml_close()
 
     def _prepare_chart(self, index, chart_id, drawing_id):
         # Set up chart/drawings.
 
         self.chart.id = chart_id - 1
 
         self.drawing = Drawing()
         self.drawing.orientation = self.orientation
 
-        self.external_drawing_links.append(['/drawing',
-                                            '../drawings/drawing'
-                                            + str(drawing_id)
-                                            + '.xml'])
-
-        self.drawing_links.append(['/chart',
-                                   '../charts/chart'
-                                   + str(chart_id)
-                                   + '.xml'])
+        self.external_drawing_links.append(
+            ["/drawing", "../drawings/drawing" + str(drawing_id) + ".xml"]
+        )
+
+        self.drawing_links.append(
+            ["/chart", "../charts/chart" + str(chart_id) + ".xml"]
+        )
 
     ###########################################################################
     #
     # XML methods.
     #
     ###########################################################################
 
     def _write_chartsheet(self):
         # Write the <worksheet> element. This is the root element.
 
-        schema = 'http://schemas.openxmlformats.org/'
-        xmlns = schema + 'spreadsheetml/2006/main'
-        xmlns_r = schema + 'officeDocument/2006/relationships'
-
-        attributes = [
-            ('xmlns', xmlns),
-            ('xmlns:r', xmlns_r)]
+        schema = "http://schemas.openxmlformats.org/"
+        xmlns = schema + "spreadsheetml/2006/main"
+        xmlns_r = schema + "officeDocument/2006/relationships"
 
-        self._xml_start_tag('chartsheet', attributes)
+        attributes = [("xmlns", xmlns), ("xmlns:r", xmlns_r)]
+
+        self._xml_start_tag("chartsheet", attributes)
 
     def _write_sheet_pr(self):
         # Write the <sheetPr> element for Sheet level properties.
         attributes = []
 
         if self.filter_on:
-            attributes.append(('filterMode', 1))
+            attributes.append(("filterMode", 1))
 
-        if (self.fit_page or self.tab_color):
-            self._xml_start_tag('sheetPr', attributes)
+        if self.fit_page or self.tab_color:
+            self._xml_start_tag("sheetPr", attributes)
             self._write_tab_color()
             self._write_page_set_up_pr()
-            self._xml_end_tag('sheetPr')
+            self._xml_end_tag("sheetPr")
         else:
-            self._xml_empty_tag('sheetPr', attributes)
+            self._xml_empty_tag("sheetPr", attributes)
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/comments.py` & `XlsxWriter-3.1.0/xlsxwriter/comments.py`

 * *Files 8% similar despite different names*

```diff
@@ -50,59 +50,59 @@
 
         # Write the authors element.
         self._write_authors(comments_data)
 
         # Write the commentList element.
         self._write_comment_list(comments_data)
 
-        self._xml_end_tag('comments')
+        self._xml_end_tag("comments")
 
         # Close the file.
         self._xml_close()
 
     ###########################################################################
     #
     # XML methods.
     #
     ###########################################################################
 
     def _write_comments(self):
         # Write the <comments> element.
-        xmlns = 'http://schemas.openxmlformats.org/spreadsheetml/2006/main'
+        xmlns = "http://schemas.openxmlformats.org/spreadsheetml/2006/main"
 
-        attributes = [('xmlns', xmlns)]
+        attributes = [("xmlns", xmlns)]
 
-        self._xml_start_tag('comments', attributes)
+        self._xml_start_tag("comments", attributes)
 
     def _write_authors(self, comment_data):
         # Write the <authors> element.
         author_count = 0
 
-        self._xml_start_tag('authors')
+        self._xml_start_tag("authors")
 
         for comment in comment_data:
             author = comment[3]
 
             if author is not None and author not in self.author_ids:
                 # Store the author id.
                 self.author_ids[author] = author_count
                 author_count += 1
 
                 # Write the author element.
                 self._write_author(author)
 
-        self._xml_end_tag('authors')
+        self._xml_end_tag("authors")
 
     def _write_author(self, data):
         # Write the <author> element.
-        self._xml_data_element('author', data)
+        self._xml_data_element("author", data)
 
     def _write_comment_list(self, comment_data):
         # Write the <commentList> element.
-        self._xml_start_tag('commentList')
+        self._xml_start_tag("commentList")
 
         for comment in comment_data:
             row = comment[0]
             col = comment[1]
             text = comment[2]
             author = comment[3]
             font_name = comment[6]
@@ -114,96 +114,96 @@
             if author is not None:
                 author_id = self.author_ids[author]
 
             # Write the comment element.
             font = (font_name, font_size, font_family)
             self._write_comment(row, col, text, author_id, font)
 
-        self._xml_end_tag('commentList')
+        self._xml_end_tag("commentList")
 
     def _write_comment(self, row, col, text, author_id, font):
         # Write the <comment> element.
         ref = xl_rowcol_to_cell(row, col)
 
-        attributes = [('ref', ref)]
+        attributes = [("ref", ref)]
 
         if author_id is not None:
-            attributes.append(('authorId', author_id))
+            attributes.append(("authorId", author_id))
 
-        self._xml_start_tag('comment', attributes)
+        self._xml_start_tag("comment", attributes)
 
         # Write the text element.
         self._write_text(text, font)
 
-        self._xml_end_tag('comment')
+        self._xml_end_tag("comment")
 
     def _write_text(self, text, font):
         # Write the <text> element.
-        self._xml_start_tag('text')
+        self._xml_start_tag("text")
 
         # Write the text r element.
         self._write_text_r(text, font)
 
-        self._xml_end_tag('text')
+        self._xml_end_tag("text")
 
     def _write_text_r(self, text, font):
         # Write the <r> element.
-        self._xml_start_tag('r')
+        self._xml_start_tag("r")
 
         # Write the rPr element.
         self._write_r_pr(font)
 
         # Write the text r element.
         self._write_text_t(text)
 
-        self._xml_end_tag('r')
+        self._xml_end_tag("r")
 
     def _write_text_t(self, text):
         # Write the text <t> element.
         attributes = []
 
         if preserve_whitespace(text):
-            attributes.append(('xml:space', 'preserve'))
+            attributes.append(("xml:space", "preserve"))
 
-        self._xml_data_element('t', text, attributes)
+        self._xml_data_element("t", text, attributes)
 
     def _write_r_pr(self, font):
         # Write the <rPr> element.
-        self._xml_start_tag('rPr')
+        self._xml_start_tag("rPr")
 
         # Write the sz element.
         self._write_sz(font[1])
 
         # Write the color element.
         self._write_color()
 
         # Write the rFont element.
         self._write_r_font(font[0])
 
         # Write the family element.
         self._write_family(font[2])
 
-        self._xml_end_tag('rPr')
+        self._xml_end_tag("rPr")
 
     def _write_sz(self, font_size):
         # Write the <sz> element.
-        attributes = [('val', font_size)]
+        attributes = [("val", font_size)]
 
-        self._xml_empty_tag('sz', attributes)
+        self._xml_empty_tag("sz", attributes)
 
     def _write_color(self):
         # Write the <color> element.
-        attributes = [('indexed', 81)]
+        attributes = [("indexed", 81)]
 
-        self._xml_empty_tag('color', attributes)
+        self._xml_empty_tag("color", attributes)
 
     def _write_r_font(self, font_name):
         # Write the <rFont> element.
-        attributes = [('val', font_name)]
+        attributes = [("val", font_name)]
 
-        self._xml_empty_tag('rFont', attributes)
+        self._xml_empty_tag("rFont", attributes)
 
     def _write_family(self, font_family):
         # Write the <family> element.
-        attributes = [('val', font_family)]
+        attributes = [("val", font_family)]
 
-        self._xml_empty_tag('family', attributes)
+        self._xml_empty_tag("family", attributes)
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/contenttypes.py` & `XlsxWriter-3.1.0/xlsxwriter/contenttypes.py`

 * *Files 13% similar despite different names*

```diff
@@ -6,28 +6,28 @@
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 
 import copy
 from . import xmlwriter
 
 # Long namespace strings used in the class.
-app_package = 'application/vnd.openxmlformats-package.'
-app_document = 'application/vnd.openxmlformats-officedocument.'
+app_package = "application/vnd.openxmlformats-package."
+app_document = "application/vnd.openxmlformats-officedocument."
 
 defaults = [
-    ['rels', app_package + 'relationships+xml'],
-    ['xml', 'application/xml'],
+    ["rels", app_package + "relationships+xml"],
+    ["xml", "application/xml"],
 ]
 
 overrides = [
-    ['/docProps/app.xml', app_document + 'extended-properties+xml'],
-    ['/docProps/core.xml', app_package + 'core-properties+xml'],
-    ['/xl/styles.xml', app_document + 'spreadsheetml.styles+xml'],
-    ['/xl/theme/theme1.xml', app_document + 'theme+xml'],
-    ['/xl/workbook.xml', app_document + 'spreadsheetml.sheet.main+xml'],
+    ["/docProps/app.xml", app_document + "extended-properties+xml"],
+    ["/docProps/core.xml", app_package + "core-properties+xml"],
+    ["/xl/styles.xml", app_document + "spreadsheetml.styles+xml"],
+    ["/xl/theme/theme1.xml", app_document + "theme+xml"],
+    ["/xl/workbook.xml", app_document + "spreadsheetml.sheet.main+xml"],
 ]
 
 
 class ContentTypes(xmlwriter.XMLwriter):
     """
     A class for writing the Excel XLSX ContentTypes file.
 
@@ -64,15 +64,15 @@
         # Write the XML declaration.
         self._xml_declaration()
 
         self._write_types()
         self._write_defaults()
         self._write_overrides()
 
-        self._xml_end_tag('Types')
+        self._xml_end_tag("Types")
 
         # Close the file.
         self._xml_close()
 
     def _add_default(self, default):
         # Add elements to the ContentTypes defaults.
         self.defaults.append(default)
@@ -81,133 +81,143 @@
         # Add elements to the ContentTypes overrides.
         self.overrides.append(override)
 
     def _add_worksheet_name(self, worksheet_name):
         # Add the name of a worksheet to the ContentTypes overrides.
         worksheet_name = "/xl/worksheets/" + worksheet_name + ".xml"
 
-        self._add_override((worksheet_name,
-                           app_document + 'spreadsheetml.worksheet+xml'))
+        self._add_override(
+            (worksheet_name, app_document + "spreadsheetml.worksheet+xml")
+        )
 
     def _add_chartsheet_name(self, chartsheet_name):
         # Add the name of a chartsheet to the ContentTypes overrides.
         chartsheet_name = "/xl/chartsheets/" + chartsheet_name + ".xml"
 
-        self._add_override((chartsheet_name,
-                           app_document + 'spreadsheetml.chartsheet+xml'))
+        self._add_override(
+            (chartsheet_name, app_document + "spreadsheetml.chartsheet+xml")
+        )
 
     def _add_chart_name(self, chart_name):
         # Add the name of a chart to the ContentTypes overrides.
         chart_name = "/xl/charts/" + chart_name + ".xml"
 
-        self._add_override((chart_name, app_document + 'drawingml.chart+xml'))
+        self._add_override((chart_name, app_document + "drawingml.chart+xml"))
 
     def _add_drawing_name(self, drawing_name):
         # Add the name of a drawing to the ContentTypes overrides.
         drawing_name = "/xl/drawings/" + drawing_name + ".xml"
 
-        self._add_override((drawing_name, app_document + 'drawing+xml'))
+        self._add_override((drawing_name, app_document + "drawing+xml"))
 
     def _add_vml_name(self):
         # Add the name of a VML drawing to the ContentTypes defaults.
-        self._add_default(('vml', app_document + 'vmlDrawing'))
+        self._add_default(("vml", app_document + "vmlDrawing"))
 
     def _add_comment_name(self, comment_name):
         # Add the name of a comment to the ContentTypes overrides.
         comment_name = "/xl/" + comment_name + ".xml"
 
-        self._add_override((comment_name,
-                           app_document + 'spreadsheetml.comments+xml'))
+        self._add_override((comment_name, app_document + "spreadsheetml.comments+xml"))
 
     def _add_shared_strings(self):
         # Add the sharedStrings link to the ContentTypes overrides.
-        self._add_override(('/xl/sharedStrings.xml',
-                           app_document + 'spreadsheetml.sharedStrings+xml'))
+        self._add_override(
+            ("/xl/sharedStrings.xml", app_document + "spreadsheetml.sharedStrings+xml")
+        )
 
     def _add_calc_chain(self):
         # Add the calcChain link to the ContentTypes overrides.
-        self._add_override(('/xl/calcChain.xml',
-                           app_document + 'spreadsheetml.calcChain+xml'))
+        self._add_override(
+            ("/xl/calcChain.xml", app_document + "spreadsheetml.calcChain+xml")
+        )
 
     def _add_image_types(self, image_types):
         # Add the image default types.
         for image_type in image_types:
             extension = image_type
 
-            if image_type in ('wmf', 'emf'):
-                image_type = 'x-' + image_type
+            if image_type in ("wmf", "emf"):
+                image_type = "x-" + image_type
 
-            self._add_default((extension, 'image/' + image_type))
+            self._add_default((extension, "image/" + image_type))
 
     def _add_table_name(self, table_name):
         # Add the name of a table to the ContentTypes overrides.
         table_name = "/xl/tables/" + table_name + ".xml"
 
-        self._add_override((table_name,
-                           app_document + 'spreadsheetml.table+xml'))
+        self._add_override((table_name, app_document + "spreadsheetml.table+xml"))
 
     def _add_vba_project(self):
         # Add a vbaProject to the ContentTypes defaults.
 
         # Change the workbook.xml content-type from xlsx to xlsm.
         for i, override in enumerate(self.overrides):
-            if override[0] == '/xl/workbook.xml':
-                self.overrides[i][1] = 'application/vnd.ms-excel.' \
-                    'sheet.macroEnabled.main+xml'
+            if override[0] == "/xl/workbook.xml":
+                self.overrides[i][1] = (
+                    "application/vnd.ms-excel." "sheet.macroEnabled.main+xml"
+                )
 
-        self._add_default(('bin', 'application/vnd.ms-office.vbaProject'))
+        self._add_default(("bin", "application/vnd.ms-office.vbaProject"))
 
     def _add_custom_properties(self):
         # Add the custom properties to the ContentTypes overrides.
-        self._add_override(('/docProps/custom.xml',
-                           app_document + 'custom-properties+xml'))
+        self._add_override(
+            ("/docProps/custom.xml", app_document + "custom-properties+xml")
+        )
 
     def _add_metadata(self):
         # Add the metadata file to the ContentTypes overrides.
-        self._add_override(('/xl/metadata.xml',
-                           app_document + 'spreadsheetml.sheetMetadata+xml'))
+        self._add_override(
+            ("/xl/metadata.xml", app_document + "spreadsheetml.sheetMetadata+xml")
+        )
 
     ###########################################################################
     #
     # XML methods.
     #
     ###########################################################################
 
     def _write_defaults(self):
         # Write out all of the <Default> types.
 
         for extension, content_type in self.defaults:
-            self._xml_empty_tag('Default',
-                                [('Extension', extension),
-                                 ('ContentType', content_type)])
+            self._xml_empty_tag(
+                "Default", [("Extension", extension), ("ContentType", content_type)]
+            )
 
     def _write_overrides(self):
         # Write out all of the <Override> types.
         for part_name, content_type in self.overrides:
-            self._xml_empty_tag('Override',
-                                [('PartName', part_name),
-                                 ('ContentType', content_type)])
+            self._xml_empty_tag(
+                "Override", [("PartName", part_name), ("ContentType", content_type)]
+            )
 
     def _write_types(self):
         # Write the <Types> element.
-        xmlns = 'http://schemas.openxmlformats.org/package/2006/content-types'
+        xmlns = "http://schemas.openxmlformats.org/package/2006/content-types"
 
-        attributes = [('xmlns', xmlns,)]
-        self._xml_start_tag('Types', attributes)
+        attributes = [
+            (
+                "xmlns",
+                xmlns,
+            )
+        ]
+        self._xml_start_tag("Types", attributes)
 
     def _write_default(self, extension, content_type):
         # Write the <Default> element.
         attributes = [
-            ('Extension', extension),
-            ('ContentType', content_type),
+            ("Extension", extension),
+            ("ContentType", content_type),
         ]
 
-        self._xml_empty_tag('Default', attributes)
+        self._xml_empty_tag("Default", attributes)
 
     def _write_override(self, part_name, content_type):
         # Write the <Override> element.
         attributes = [
-            ('PartName', part_name),
-            ('ContentType', content_type),
+            ("PartName", part_name),
+            ("ContentType", content_type),
         ]
 
-        self._xml_empty_tag('Override', attributes)
+        self._xml_empty_tag("Override", attributes)
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/core.py` & `XlsxWriter-3.1.0/xlsxwriter/core.py`

 * *Files 8% similar despite different names*

```diff
@@ -56,15 +56,15 @@
         self._write_dc_description()
         self._write_cp_last_modified_by()
         self._write_dcterms_created()
         self._write_dcterms_modified()
         self._write_cp_category()
         self._write_cp_content_status()
 
-        self._xml_end_tag('cp:coreProperties')
+        self._xml_end_tag("cp:coreProperties")
 
         # Close the file.
         self._xml_close()
 
     def _set_properties(self, properties):
         # Set the document properties.
         self.properties = properties
@@ -81,113 +81,125 @@
     # XML methods.
     #
     ###########################################################################
 
     def _write_cp_core_properties(self):
         # Write the <cp:coreProperties> element.
 
-        xmlns_cp = ('http://schemas.openxmlformats.org/package/2006/' +
-                    'metadata/core-properties')
-        xmlns_dc = 'http://purl.org/dc/elements/1.1/'
-        xmlns_dcterms = 'http://purl.org/dc/terms/'
-        xmlns_dcmitype = 'http://purl.org/dc/dcmitype/'
-        xmlns_xsi = 'http://www.w3.org/2001/XMLSchema-instance'
+        xmlns_cp = (
+            "http://schemas.openxmlformats.org/package/2006/"
+            + "metadata/core-properties"
+        )
+        xmlns_dc = "http://purl.org/dc/elements/1.1/"
+        xmlns_dcterms = "http://purl.org/dc/terms/"
+        xmlns_dcmitype = "http://purl.org/dc/dcmitype/"
+        xmlns_xsi = "http://www.w3.org/2001/XMLSchema-instance"
 
         attributes = [
-            ('xmlns:cp', xmlns_cp),
-            ('xmlns:dc', xmlns_dc),
-            ('xmlns:dcterms', xmlns_dcterms),
-            ('xmlns:dcmitype', xmlns_dcmitype),
-            ('xmlns:xsi', xmlns_xsi),
+            ("xmlns:cp", xmlns_cp),
+            ("xmlns:dc", xmlns_dc),
+            ("xmlns:dcterms", xmlns_dcterms),
+            ("xmlns:dcmitype", xmlns_dcmitype),
+            ("xmlns:xsi", xmlns_xsi),
         ]
 
-        self._xml_start_tag('cp:coreProperties', attributes)
+        self._xml_start_tag("cp:coreProperties", attributes)
 
     def _write_dc_creator(self):
         # Write the <dc:creator> element.
-        data = self.properties.get('author', '')
+        data = self.properties.get("author", "")
 
-        self._xml_data_element('dc:creator', data)
+        self._xml_data_element("dc:creator", data)
 
     def _write_cp_last_modified_by(self):
         # Write the <cp:lastModifiedBy> element.
-        data = self.properties.get('author', '')
+        data = self.properties.get("author", "")
 
-        self._xml_data_element('cp:lastModifiedBy', data)
+        self._xml_data_element("cp:lastModifiedBy", data)
 
     def _write_dcterms_created(self):
         # Write the <dcterms:created> element.
-        date = self.properties.get('created', datetime.utcnow())
+        date = self.properties.get("created", datetime.utcnow())
 
-        xsi_type = 'dcterms:W3CDTF'
+        xsi_type = "dcterms:W3CDTF"
 
         date = self._datetime_to_iso8601_date(date)
 
-        attributes = [('xsi:type', xsi_type,)]
+        attributes = [
+            (
+                "xsi:type",
+                xsi_type,
+            )
+        ]
 
-        self._xml_data_element('dcterms:created', date, attributes)
+        self._xml_data_element("dcterms:created", date, attributes)
 
     def _write_dcterms_modified(self):
         # Write the <dcterms:modified> element.
-        date = self.properties.get('created', datetime.utcnow())
+        date = self.properties.get("created", datetime.utcnow())
 
-        xsi_type = 'dcterms:W3CDTF'
+        xsi_type = "dcterms:W3CDTF"
 
         date = self._datetime_to_iso8601_date(date)
 
-        attributes = [('xsi:type', xsi_type,)]
+        attributes = [
+            (
+                "xsi:type",
+                xsi_type,
+            )
+        ]
 
-        self._xml_data_element('dcterms:modified', date, attributes)
+        self._xml_data_element("dcterms:modified", date, attributes)
 
     def _write_dc_title(self):
         # Write the <dc:title> element.
-        if 'title' in self.properties:
-            data = self.properties['title']
+        if "title" in self.properties:
+            data = self.properties["title"]
         else:
             return
 
-        self._xml_data_element('dc:title', data)
+        self._xml_data_element("dc:title", data)
 
     def _write_dc_subject(self):
         # Write the <dc:subject> element.
-        if 'subject' in self.properties:
-            data = self.properties['subject']
+        if "subject" in self.properties:
+            data = self.properties["subject"]
         else:
             return
 
-        self._xml_data_element('dc:subject', data)
+        self._xml_data_element("dc:subject", data)
 
     def _write_cp_keywords(self):
         # Write the <cp:keywords> element.
-        if 'keywords' in self.properties:
-            data = self.properties['keywords']
+        if "keywords" in self.properties:
+            data = self.properties["keywords"]
         else:
             return
 
-        self._xml_data_element('cp:keywords', data)
+        self._xml_data_element("cp:keywords", data)
 
     def _write_dc_description(self):
         # Write the <dc:description> element.
-        if 'comments' in self.properties:
-            data = self.properties['comments']
+        if "comments" in self.properties:
+            data = self.properties["comments"]
         else:
             return
 
-        self._xml_data_element('dc:description', data)
+        self._xml_data_element("dc:description", data)
 
     def _write_cp_category(self):
         # Write the <cp:category> element.
-        if 'category' in self.properties:
-            data = self.properties['category']
+        if "category" in self.properties:
+            data = self.properties["category"]
         else:
             return
 
-        self._xml_data_element('cp:category', data)
+        self._xml_data_element("cp:category", data)
 
     def _write_cp_content_status(self):
         # Write the <cp:contentStatus> element.
-        if 'status' in self.properties:
-            data = self.properties['status']
+        if "status" in self.properties:
+            data = self.properties["status"]
         else:
             return
 
-        self._xml_data_element('cp:contentStatus', data)
+        self._xml_data_element("cp:contentStatus", data)
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/custom.py` & `XlsxWriter-3.1.0/xlsxwriter/custom.py`

 * *Files 11% similar despite different names*

```diff
@@ -48,94 +48,94 @@
         # Assemble and write the XML file.
 
         # Write the XML declaration.
         self._xml_declaration()
 
         self._write_properties()
 
-        self._xml_end_tag('Properties')
+        self._xml_end_tag("Properties")
 
         # Close the file.
         self._xml_close()
 
     ###########################################################################
     #
     # XML methods.
     #
     ###########################################################################
 
     def _write_properties(self):
         # Write the <Properties> element.
-        schema = 'http://schemas.openxmlformats.org/officeDocument/2006/'
-        xmlns = schema + 'custom-properties'
-        xmlns_vt = schema + 'docPropsVTypes'
+        schema = "http://schemas.openxmlformats.org/officeDocument/2006/"
+        xmlns = schema + "custom-properties"
+        xmlns_vt = schema + "docPropsVTypes"
 
         attributes = [
-            ('xmlns', xmlns),
-            ('xmlns:vt', xmlns_vt),
+            ("xmlns", xmlns),
+            ("xmlns:vt", xmlns_vt),
         ]
 
-        self._xml_start_tag('Properties', attributes)
+        self._xml_start_tag("Properties", attributes)
 
         for custom_property in self.properties:
             # Write the property element.
             self._write_property(custom_property)
 
     def _write_property(self, custom_property):
         # Write the <property> element.
 
-        fmtid = '{D5CDD505-2E9C-101B-9397-08002B2CF9AE}'
+        fmtid = "{D5CDD505-2E9C-101B-9397-08002B2CF9AE}"
 
         name, value, property_type = custom_property
         self.pid += 1
 
         attributes = [
-            ('fmtid', fmtid),
-            ('pid', self.pid),
-            ('name', name),
+            ("fmtid", fmtid),
+            ("pid", self.pid),
+            ("name", name),
         ]
 
-        self._xml_start_tag('property', attributes)
+        self._xml_start_tag("property", attributes)
 
-        if property_type == 'number_int':
+        if property_type == "number_int":
             # Write the vt:i4 element.
             self._write_vt_i4(value)
-        elif property_type == 'number':
+        elif property_type == "number":
             # Write the vt:r8 element.
             self._write_vt_r8(value)
-        elif property_type == 'date':
+        elif property_type == "date":
             # Write the vt:filetime element.
             self._write_vt_filetime(value)
-        elif property_type == 'bool':
+        elif property_type == "bool":
             # Write the vt:bool element.
             self._write_vt_bool(value)
         else:
             # Write the vt:lpwstr element.
             self._write_vt_lpwstr(value)
 
-        self._xml_end_tag('property')
+        self._xml_end_tag("property")
 
     def _write_vt_lpwstr(self, value):
         # Write the <vt:lpwstr> element.
-        self._xml_data_element('vt:lpwstr', value)
+        self._xml_data_element("vt:lpwstr", value)
 
     def _write_vt_filetime(self, value):
         # Write the <vt:filetime> element.
-        self._xml_data_element('vt:filetime', value)
+        self._xml_data_element("vt:filetime", value)
 
     def _write_vt_i4(self, value):
         # Write the <vt:i4> element.
-        self._xml_data_element('vt:i4', value)
+        self._xml_data_element("vt:i4", value)
 
     def _write_vt_r8(self, value):
         # Write the <vt:r8> element.
-        self._xml_data_element('vt:r8', value)
+        self._xml_data_element("vt:r8", value)
 
     def _write_vt_bool(self, value):
         # Write the <vt:bool> element.
 
         if value:
-            value = 'true'
+            value = "true"
         else:
-            value = 'false'
+            value = "false"
 
-        self._xml_data_element('vt:bool', value)
+        self._xml_data_element("vt:bool", value)
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/drawing.py` & `XlsxWriter-3.1.0/xlsxwriter/drawing.py`

 * *Files 7% similar despite different names*

```diff
@@ -58,151 +58,146 @@
                 index += 1
                 self._write_two_cell_anchor(index, drawing_properties)
 
         else:
             # Write the xdr:absoluteAnchor element.
             self._write_absolute_anchor(1)
 
-        self._xml_end_tag('xdr:wsDr')
+        self._xml_end_tag("xdr:wsDr")
 
         # Close the file.
         self._xml_close()
 
     def _add_drawing_object(self):
         # Add a chart, image or shape sub object to the drawing.
 
         drawing_object = {
-            'anchor_type': None,
-            'dimensions': [],
-            'width': 0,
-            'height': 0,
-            'shape': None,
-            'anchor': None,
-            'rel_index': 0,
-            'url_rel_index': 0,
-            'tip': None,
-            'name': None,
-            'description': None,
-            'decorative': False
+            "anchor_type": None,
+            "dimensions": [],
+            "width": 0,
+            "height": 0,
+            "shape": None,
+            "anchor": None,
+            "rel_index": 0,
+            "url_rel_index": 0,
+            "tip": None,
+            "name": None,
+            "description": None,
+            "decorative": False,
         }
 
         self.drawings.append(drawing_object)
 
         return drawing_object
 
     ###########################################################################
     #
     # XML methods.
     #
     ###########################################################################
 
     def _write_drawing_workspace(self):
         # Write the <xdr:wsDr> element.
-        schema = 'http://schemas.openxmlformats.org/drawingml/'
-        xmlns_xdr = schema + '2006/spreadsheetDrawing'
-        xmlns_a = schema + '2006/main'
+        schema = "http://schemas.openxmlformats.org/drawingml/"
+        xmlns_xdr = schema + "2006/spreadsheetDrawing"
+        xmlns_a = schema + "2006/main"
 
         attributes = [
-            ('xmlns:xdr', xmlns_xdr),
-            ('xmlns:a', xmlns_a),
+            ("xmlns:xdr", xmlns_xdr),
+            ("xmlns:a", xmlns_a),
         ]
 
-        self._xml_start_tag('xdr:wsDr', attributes)
+        self._xml_start_tag("xdr:wsDr", attributes)
 
     def _write_two_cell_anchor(self, index, drawing_properties):
         # Write the <xdr:twoCellAnchor> element.
-        anchor_type = drawing_properties['type']
-        dimensions = drawing_properties['dimensions']
+        anchor_type = drawing_properties["type"]
+        dimensions = drawing_properties["dimensions"]
         col_from = dimensions[0]
         row_from = dimensions[1]
         col_from_offset = dimensions[2]
         row_from_offset = dimensions[3]
         col_to = dimensions[4]
         row_to = dimensions[5]
         col_to_offset = dimensions[6]
         row_to_offset = dimensions[7]
         col_absolute = dimensions[8]
         row_absolute = dimensions[9]
-        width = drawing_properties['width']
-        height = drawing_properties['height']
-        shape = drawing_properties['shape']
-        anchor = drawing_properties['anchor']
-        rel_index = drawing_properties['rel_index']
-        url_rel_index = drawing_properties['url_rel_index']
-        tip = drawing_properties['tip']
-        name = drawing_properties['name']
-        description = drawing_properties['description']
-        decorative = drawing_properties['decorative']
+        width = drawing_properties["width"]
+        height = drawing_properties["height"]
+        shape = drawing_properties["shape"]
+        anchor = drawing_properties["anchor"]
+        rel_index = drawing_properties["rel_index"]
+        url_rel_index = drawing_properties["url_rel_index"]
+        tip = drawing_properties["tip"]
+        name = drawing_properties["name"]
+        description = drawing_properties["description"]
+        decorative = drawing_properties["decorative"]
 
         attributes = []
 
         # Add attribute for positioning.
         if anchor == 2:
-            attributes.append(('editAs', 'oneCell'))
+            attributes.append(("editAs", "oneCell"))
         elif anchor == 3:
-            attributes.append(('editAs', 'absolute'))
+            attributes.append(("editAs", "absolute"))
 
         # Add editAs attribute for shapes.
         if shape and shape.edit_as:
-            attributes.append(('editAs', shape.edit_as))
+            attributes.append(("editAs", shape.edit_as))
 
-        self._xml_start_tag('xdr:twoCellAnchor', attributes)
+        self._xml_start_tag("xdr:twoCellAnchor", attributes)
 
         # Write the xdr:from element.
-        self._write_from(
-            col_from,
-            row_from,
-            col_from_offset,
-            row_from_offset)
+        self._write_from(col_from, row_from, col_from_offset, row_from_offset)
 
         # Write the xdr:from element.
-        self._write_to(
-            col_to,
-            row_to,
-            col_to_offset,
-            row_to_offset)
+        self._write_to(col_to, row_to, col_to_offset, row_to_offset)
 
         if anchor_type == 1:
             # Graphic frame.
             # Write the xdr:graphicFrame element for charts.
-            self._write_graphic_frame(index, rel_index, name,
-                                      description, decorative)
+            self._write_graphic_frame(index, rel_index, name, description, decorative)
         elif anchor_type == 2:
             # Write the xdr:pic element.
-            self._write_pic(index,
-                            rel_index,
-                            col_absolute,
-                            row_absolute,
-                            width,
-                            height,
-                            shape,
-                            description,
-                            url_rel_index,
-                            tip,
-                            decorative)
+            self._write_pic(
+                index,
+                rel_index,
+                col_absolute,
+                row_absolute,
+                width,
+                height,
+                shape,
+                description,
+                url_rel_index,
+                tip,
+                decorative,
+            )
         else:
             # Write the xdr:sp element for shapes.
-            self._write_sp(index,
-                           col_absolute,
-                           row_absolute,
-                           width,
-                           height,
-                           shape,
-                           description,
-                           url_rel_index,
-                           tip,
-                           decorative)
+            self._write_sp(
+                index,
+                col_absolute,
+                row_absolute,
+                width,
+                height,
+                shape,
+                description,
+                url_rel_index,
+                tip,
+                decorative,
+            )
 
         # Write the xdr:clientData element.
         self._write_client_data()
 
-        self._xml_end_tag('xdr:twoCellAnchor')
+        self._xml_end_tag("xdr:twoCellAnchor")
 
     def _write_absolute_anchor(self, frame_index):
-        self._xml_start_tag('xdr:absoluteAnchor')
+        self._xml_start_tag("xdr:absoluteAnchor")
         # Write the <xdr:absoluteAnchor> element.
 
         # Different coordinates for horizontal (= 0) and vertical (= 1).
         if self.orientation == 0:
             # Write the xdr:pos element.
             self._write_pos(0, 0)
 
@@ -218,975 +213,997 @@
 
         # Write the xdr:graphicFrame element.
         self._write_graphic_frame(frame_index, frame_index)
 
         # Write the xdr:clientData element.
         self._write_client_data()
 
-        self._xml_end_tag('xdr:absoluteAnchor')
+        self._xml_end_tag("xdr:absoluteAnchor")
 
     def _write_from(self, col, row, col_offset, row_offset):
         # Write the <xdr:from> element.
-        self._xml_start_tag('xdr:from')
+        self._xml_start_tag("xdr:from")
 
         # Write the xdr:col element.
         self._write_col(col)
 
         # Write the xdr:colOff element.
         self._write_col_off(col_offset)
 
         # Write the xdr:row element.
         self._write_row(row)
 
         # Write the xdr:rowOff element.
         self._write_row_off(row_offset)
 
-        self._xml_end_tag('xdr:from')
+        self._xml_end_tag("xdr:from")
 
     def _write_to(self, col, row, col_offset, row_offset):
         # Write the <xdr:to> element.
-        self._xml_start_tag('xdr:to')
+        self._xml_start_tag("xdr:to")
 
         # Write the xdr:col element.
         self._write_col(col)
 
         # Write the xdr:colOff element.
         self._write_col_off(col_offset)
 
         # Write the xdr:row element.
         self._write_row(row)
 
         # Write the xdr:rowOff element.
         self._write_row_off(row_offset)
 
-        self._xml_end_tag('xdr:to')
+        self._xml_end_tag("xdr:to")
 
     def _write_col(self, data):
         # Write the <xdr:col> element.
-        self._xml_data_element('xdr:col', data)
+        self._xml_data_element("xdr:col", data)
 
     def _write_col_off(self, data):
         # Write the <xdr:colOff> element.
-        self._xml_data_element('xdr:colOff', data)
+        self._xml_data_element("xdr:colOff", data)
 
     def _write_row(self, data):
         # Write the <xdr:row> element.
-        self._xml_data_element('xdr:row', data)
+        self._xml_data_element("xdr:row", data)
 
     def _write_row_off(self, data):
         # Write the <xdr:rowOff> element.
-        self._xml_data_element('xdr:rowOff', data)
+        self._xml_data_element("xdr:rowOff", data)
 
     def _write_pos(self, x, y):
         # Write the <xdr:pos> element.
 
-        attributes = [('x', x), ('y', y)]
+        attributes = [("x", x), ("y", y)]
 
-        self._xml_empty_tag('xdr:pos', attributes)
+        self._xml_empty_tag("xdr:pos", attributes)
 
     def _write_xdr_ext(self, cx, cy):
         # Write the <xdr:ext> element.
 
-        attributes = [('cx', cx), ('cy', cy)]
+        attributes = [("cx", cx), ("cy", cy)]
 
-        self._xml_empty_tag('xdr:ext', attributes)
+        self._xml_empty_tag("xdr:ext", attributes)
 
-    def _write_graphic_frame(self, index, rel_index, name=None,
-                             description=None, decorative=None):
+    def _write_graphic_frame(
+        self, index, rel_index, name=None, description=None, decorative=None
+    ):
         # Write the <xdr:graphicFrame> element.
-        attributes = [('macro', '')]
+        attributes = [("macro", "")]
 
-        self._xml_start_tag('xdr:graphicFrame', attributes)
+        self._xml_start_tag("xdr:graphicFrame", attributes)
 
         # Write the xdr:nvGraphicFramePr element.
         self._write_nv_graphic_frame_pr(index, name, description, decorative)
 
         # Write the xdr:xfrm element.
         self._write_xfrm()
 
         # Write the a:graphic element.
         self._write_atag_graphic(rel_index)
 
-        self._xml_end_tag('xdr:graphicFrame')
+        self._xml_end_tag("xdr:graphicFrame")
 
     def _write_nv_graphic_frame_pr(self, index, name, description, decorative):
         # Write the <xdr:nvGraphicFramePr> element.
 
         if not name:
-            name = 'Chart ' + str(index)
+            name = "Chart " + str(index)
 
-        self._xml_start_tag('xdr:nvGraphicFramePr')
+        self._xml_start_tag("xdr:nvGraphicFramePr")
 
         # Write the xdr:cNvPr element.
-        self._write_c_nv_pr(index + 1, name, description,
-                            None, None, decorative)
+        self._write_c_nv_pr(index + 1, name, description, None, None, decorative)
 
         # Write the xdr:cNvGraphicFramePr element.
         self._write_c_nv_graphic_frame_pr()
 
-        self._xml_end_tag('xdr:nvGraphicFramePr')
+        self._xml_end_tag("xdr:nvGraphicFramePr")
 
-    def _write_c_nv_pr(self, index, name, description, url_rel_index,
-                       tip, decorative):
+    def _write_c_nv_pr(self, index, name, description, url_rel_index, tip, decorative):
         # Write the <xdr:cNvPr> element.
-        attributes = [('id', index), ('name', name)]
+        attributes = [("id", index), ("name", name)]
 
         # Add description attribute for images.
         if description and not decorative:
-            attributes.append(('descr', description))
+            attributes.append(("descr", description))
 
         if url_rel_index or decorative:
-            self._xml_start_tag('xdr:cNvPr', attributes)
+            self._xml_start_tag("xdr:cNvPr", attributes)
 
             if url_rel_index:
                 self._write_a_hlink_click(url_rel_index, tip)
 
             if decorative:
                 self._write_decorative()
 
-            self._xml_end_tag('xdr:cNvPr')
+            self._xml_end_tag("xdr:cNvPr")
         else:
-            self._xml_empty_tag('xdr:cNvPr', attributes)
+            self._xml_empty_tag("xdr:cNvPr", attributes)
 
     def _write_decorative(self):
+        self._xml_start_tag("a:extLst")
 
-        self._xml_start_tag('a:extLst')
-
-        self._write_uri_ext('{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}')
+        self._write_uri_ext("{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}")
         self._write_a16_creation_id()
-        self._xml_end_tag('a:ext')
+        self._xml_end_tag("a:ext")
 
-        self._write_uri_ext('{C183D7F6-B498-43B3-948B-1728B52AA6E4}')
+        self._write_uri_ext("{C183D7F6-B498-43B3-948B-1728B52AA6E4}")
         self._write_adec_decorative()
-        self._xml_end_tag('a:ext')
+        self._xml_end_tag("a:ext")
 
-        self._xml_end_tag('a:extLst')
+        self._xml_end_tag("a:extLst")
 
     def _write_uri_ext(self, uri):
         # Write the <a:ext> element.
-        attributes = [('uri', uri)]
+        attributes = [("uri", uri)]
 
-        self._xml_start_tag('a:ext', attributes)
+        self._xml_start_tag("a:ext", attributes)
 
     def _write_adec_decorative(self):
         # Write the <adec:decorative> element.
-        xmlns = 'http://schemas.microsoft.com/office/drawing/2017/decorative'
-        val = '1'
+        xmlns = "http://schemas.microsoft.com/office/drawing/2017/decorative"
+        val = "1"
 
         attributes = [
-            ('xmlns:adec', xmlns),
-            ('val', val),
+            ("xmlns:adec", xmlns),
+            ("val", val),
         ]
 
-        self._xml_empty_tag('adec:decorative', attributes)
+        self._xml_empty_tag("adec:decorative", attributes)
 
     def _write_a16_creation_id(self):
         # Write the <a16:creationId> element.
 
-        xmlns_a_16 = 'http://schemas.microsoft.com/office/drawing/2014/main'
-        id = '{00000000-0008-0000-0000-000002000000}'
+        xmlns_a_16 = "http://schemas.microsoft.com/office/drawing/2014/main"
+        id = "{00000000-0008-0000-0000-000002000000}"
 
         attributes = [
-            ('xmlns:a16', xmlns_a_16),
-            ('id', id),
+            ("xmlns:a16", xmlns_a_16),
+            ("id", id),
         ]
 
-        self._xml_empty_tag('a16:creationId', attributes)
+        self._xml_empty_tag("a16:creationId", attributes)
 
     def _write_a_hlink_click(self, rel_index, tip):
         # Write the <a:hlinkClick> element.
-        schema = 'http://schemas.openxmlformats.org/officeDocument/'
-        xmlns_r = schema + '2006/relationships'
+        schema = "http://schemas.openxmlformats.org/officeDocument/"
+        xmlns_r = schema + "2006/relationships"
 
         attributes = [
-            ('xmlns:r', xmlns_r),
-            ('r:id', 'rId' + str(rel_index)),
+            ("xmlns:r", xmlns_r),
+            ("r:id", "rId" + str(rel_index)),
         ]
 
         if tip:
-            attributes.append(('tooltip', tip))
+            attributes.append(("tooltip", tip))
 
-        self._xml_empty_tag('a:hlinkClick', attributes)
+        self._xml_empty_tag("a:hlinkClick", attributes)
 
     def _write_c_nv_graphic_frame_pr(self):
         # Write the <xdr:cNvGraphicFramePr> element.
         if self.embedded:
-            self._xml_empty_tag('xdr:cNvGraphicFramePr')
+            self._xml_empty_tag("xdr:cNvGraphicFramePr")
         else:
-            self._xml_start_tag('xdr:cNvGraphicFramePr')
+            self._xml_start_tag("xdr:cNvGraphicFramePr")
 
             # Write the a:graphicFrameLocks element.
             self._write_a_graphic_frame_locks()
 
-            self._xml_end_tag('xdr:cNvGraphicFramePr')
+            self._xml_end_tag("xdr:cNvGraphicFramePr")
 
     def _write_a_graphic_frame_locks(self):
         # Write the <a:graphicFrameLocks> element.
-        attributes = [('noGrp', 1)]
+        attributes = [("noGrp", 1)]
 
-        self._xml_empty_tag('a:graphicFrameLocks', attributes)
+        self._xml_empty_tag("a:graphicFrameLocks", attributes)
 
     def _write_xfrm(self):
         # Write the <xdr:xfrm> element.
-        self._xml_start_tag('xdr:xfrm')
+        self._xml_start_tag("xdr:xfrm")
 
         # Write the xfrmOffset element.
         self._write_xfrm_offset()
 
         # Write the xfrmOffset element.
         self._write_xfrm_extension()
 
-        self._xml_end_tag('xdr:xfrm')
+        self._xml_end_tag("xdr:xfrm")
 
     def _write_xfrm_offset(self):
         # Write the <a:off> xfrm sub-element.
 
         attributes = [
-            ('x', 0),
-            ('y', 0),
+            ("x", 0),
+            ("y", 0),
         ]
 
-        self._xml_empty_tag('a:off', attributes)
+        self._xml_empty_tag("a:off", attributes)
 
     def _write_xfrm_extension(self):
         # Write the <a:ext> xfrm sub-element.
 
         attributes = [
-            ('cx', 0),
-            ('cy', 0),
+            ("cx", 0),
+            ("cy", 0),
         ]
 
-        self._xml_empty_tag('a:ext', attributes)
+        self._xml_empty_tag("a:ext", attributes)
 
     def _write_atag_graphic(self, index):
         # Write the <a:graphic> element.
-        self._xml_start_tag('a:graphic')
+        self._xml_start_tag("a:graphic")
 
         # Write the a:graphicData element.
         self._write_atag_graphic_data(index)
 
-        self._xml_end_tag('a:graphic')
+        self._xml_end_tag("a:graphic")
 
     def _write_atag_graphic_data(self, index):
         # Write the <a:graphicData> element.
-        uri = 'http://schemas.openxmlformats.org/drawingml/2006/chart'
+        uri = "http://schemas.openxmlformats.org/drawingml/2006/chart"
 
-        attributes = [('uri', uri,)]
+        attributes = [
+            (
+                "uri",
+                uri,
+            )
+        ]
 
-        self._xml_start_tag('a:graphicData', attributes)
+        self._xml_start_tag("a:graphicData", attributes)
 
         # Write the c:chart element.
-        self._write_c_chart('rId' + str(index))
+        self._write_c_chart("rId" + str(index))
 
-        self._xml_end_tag('a:graphicData')
+        self._xml_end_tag("a:graphicData")
 
     def _write_c_chart(self, r_id):
         # Write the <c:chart> element.
 
-        schema = 'http://schemas.openxmlformats.org/'
-        xmlns_c = schema + 'drawingml/2006/chart'
-        xmlns_r = schema + 'officeDocument/2006/relationships'
+        schema = "http://schemas.openxmlformats.org/"
+        xmlns_c = schema + "drawingml/2006/chart"
+        xmlns_r = schema + "officeDocument/2006/relationships"
 
         attributes = [
-            ('xmlns:c', xmlns_c),
-            ('xmlns:r', xmlns_r),
-            ('r:id', r_id),
+            ("xmlns:c", xmlns_c),
+            ("xmlns:r", xmlns_r),
+            ("r:id", r_id),
         ]
 
-        self._xml_empty_tag('c:chart', attributes)
+        self._xml_empty_tag("c:chart", attributes)
 
     def _write_client_data(self):
         # Write the <xdr:clientData> element.
-        self._xml_empty_tag('xdr:clientData')
+        self._xml_empty_tag("xdr:clientData")
 
-    def _write_sp(self, index, col_absolute, row_absolute,
-                  width, height, shape, description,
-                  url_rel_index, tip, decorative):
+    def _write_sp(
+        self,
+        index,
+        col_absolute,
+        row_absolute,
+        width,
+        height,
+        shape,
+        description,
+        url_rel_index,
+        tip,
+        decorative,
+    ):
         # Write the <xdr:sp> element.
 
         if shape and shape.connect:
-            attributes = [('macro', '')]
-            self._xml_start_tag('xdr:cxnSp', attributes)
+            attributes = [("macro", "")]
+            self._xml_start_tag("xdr:cxnSp", attributes)
 
             # Write the xdr:nvCxnSpPr element.
             self._write_nv_cxn_sp_pr(index, shape)
 
             # Write the xdr:spPr element.
-            self._write_xdr_sp_pr(index, col_absolute, row_absolute, width,
-                                  height, shape)
+            self._write_xdr_sp_pr(
+                index, col_absolute, row_absolute, width, height, shape
+            )
 
-            self._xml_end_tag('xdr:cxnSp')
+            self._xml_end_tag("xdr:cxnSp")
         else:
             # Add attribute for shapes.
-            attributes = [('macro', ''),
-                          ('textlink', shape.textlink)]
+            attributes = [("macro", ""), ("textlink", shape.textlink)]
 
-            self._xml_start_tag('xdr:sp', attributes)
+            self._xml_start_tag("xdr:sp", attributes)
 
             # Write the xdr:nvSpPr element.
-            self._write_nv_sp_pr(index, shape, url_rel_index, tip,
-                                 description, decorative)
+            self._write_nv_sp_pr(
+                index, shape, url_rel_index, tip, description, decorative
+            )
 
             # Write the xdr:spPr element.
-            self._write_xdr_sp_pr(index, col_absolute, row_absolute, width,
-                                  height, shape)
+            self._write_xdr_sp_pr(
+                index, col_absolute, row_absolute, width, height, shape
+            )
 
             # Write the xdr:style element.
             self._write_style()
 
             # Write the xdr:txBody element.
             if shape.text is not None:
-                self._write_tx_body(col_absolute, row_absolute, width, height,
-                                    shape)
+                self._write_tx_body(col_absolute, row_absolute, width, height, shape)
 
-            self._xml_end_tag('xdr:sp')
+            self._xml_end_tag("xdr:sp")
 
     def _write_nv_cxn_sp_pr(self, index, shape):
         # Write the <xdr:nvCxnSpPr> element.
-        self._xml_start_tag('xdr:nvCxnSpPr')
+        self._xml_start_tag("xdr:nvCxnSpPr")
 
-        name = shape.name + ' ' + str(index)
+        name = shape.name + " " + str(index)
         if name is not None:
             self._write_c_nv_pr(index, name, None, None, None, None)
 
-        self._xml_start_tag('xdr:cNvCxnSpPr')
+        self._xml_start_tag("xdr:cNvCxnSpPr")
 
-        attributes = [('noChangeShapeType', '1')]
-        self._xml_empty_tag('a:cxnSpLocks', attributes)
+        attributes = [("noChangeShapeType", "1")]
+        self._xml_empty_tag("a:cxnSpLocks", attributes)
 
         if shape.start:
-            attributes = [('id', shape.start), ('idx', shape.start_index)]
-            self._xml_empty_tag('a:stCxn', attributes)
+            attributes = [("id", shape.start), ("idx", shape.start_index)]
+            self._xml_empty_tag("a:stCxn", attributes)
 
         if shape.end:
-            attributes = [('id', shape.end), ('idx', shape.end_index)]
-            self._xml_empty_tag('a:endCxn', attributes)
+            attributes = [("id", shape.end), ("idx", shape.end_index)]
+            self._xml_empty_tag("a:endCxn", attributes)
 
-        self._xml_end_tag('xdr:cNvCxnSpPr')
-        self._xml_end_tag('xdr:nvCxnSpPr')
+        self._xml_end_tag("xdr:cNvCxnSpPr")
+        self._xml_end_tag("xdr:nvCxnSpPr")
 
-    def _write_nv_sp_pr(self, index, shape, url_rel_index, tip,
-                        description, decorative):
+    def _write_nv_sp_pr(
+        self, index, shape, url_rel_index, tip, description, decorative
+    ):
         # Write the <xdr:NvSpPr> element.
         attributes = []
 
-        self._xml_start_tag('xdr:nvSpPr')
-
-        name = shape.name + ' ' + str(index)
-
-        self._write_c_nv_pr(index + 1, name, description,
-                            url_rel_index, tip, decorative)
-
-        if shape.name == 'TextBox':
-            attributes = [('txBox', 1)]
-
-        self._xml_empty_tag('xdr:cNvSpPr', attributes)
+        self._xml_start_tag("xdr:nvSpPr")
 
-        self._xml_end_tag('xdr:nvSpPr')
+        name = shape.name + " " + str(index)
 
-    def _write_pic(self, index, rel_index, col_absolute, row_absolute,
-                   width, height, shape, description, url_rel_index,
-                   tip, decorative):
+        self._write_c_nv_pr(
+            index + 1, name, description, url_rel_index, tip, decorative
+        )
+
+        if shape.name == "TextBox":
+            attributes = [("txBox", 1)]
+
+        self._xml_empty_tag("xdr:cNvSpPr", attributes)
+
+        self._xml_end_tag("xdr:nvSpPr")
+
+    def _write_pic(
+        self,
+        index,
+        rel_index,
+        col_absolute,
+        row_absolute,
+        width,
+        height,
+        shape,
+        description,
+        url_rel_index,
+        tip,
+        decorative,
+    ):
         # Write the <xdr:pic> element.
-        self._xml_start_tag('xdr:pic')
+        self._xml_start_tag("xdr:pic")
 
         # Write the xdr:nvPicPr element.
-        self._write_nv_pic_pr(index, rel_index, description,
-                              url_rel_index, tip, decorative)
+        self._write_nv_pic_pr(
+            index, rel_index, description, url_rel_index, tip, decorative
+        )
         # Write the xdr:blipFill element.
         self._write_blip_fill(rel_index)
 
         # Write the xdr:spPr element.
-        self._write_sp_pr(col_absolute, row_absolute, width, height,
-                          shape)
+        self._write_sp_pr(col_absolute, row_absolute, width, height, shape)
 
-        self._xml_end_tag('xdr:pic')
+        self._xml_end_tag("xdr:pic")
 
-    def _write_nv_pic_pr(self, index, rel_index, description,
-                         url_rel_index, tip, decorative):
+    def _write_nv_pic_pr(
+        self, index, rel_index, description, url_rel_index, tip, decorative
+    ):
         # Write the <xdr:nvPicPr> element.
-        self._xml_start_tag('xdr:nvPicPr')
+        self._xml_start_tag("xdr:nvPicPr")
 
         # Write the xdr:cNvPr element.
-        self._write_c_nv_pr(index + 1, 'Picture ' + str(index), description,
-                            url_rel_index, tip, decorative)
+        self._write_c_nv_pr(
+            index + 1,
+            "Picture " + str(index),
+            description,
+            url_rel_index,
+            tip,
+            decorative,
+        )
 
         # Write the xdr:cNvPicPr element.
         self._write_c_nv_pic_pr()
 
-        self._xml_end_tag('xdr:nvPicPr')
+        self._xml_end_tag("xdr:nvPicPr")
 
     def _write_c_nv_pic_pr(self):
         # Write the <xdr:cNvPicPr> element.
-        self._xml_start_tag('xdr:cNvPicPr')
+        self._xml_start_tag("xdr:cNvPicPr")
 
         # Write the a:picLocks element.
         self._write_a_pic_locks()
 
-        self._xml_end_tag('xdr:cNvPicPr')
+        self._xml_end_tag("xdr:cNvPicPr")
 
     def _write_a_pic_locks(self):
         # Write the <a:picLocks> element.
-        attributes = [('noChangeAspect', 1)]
+        attributes = [("noChangeAspect", 1)]
 
-        self._xml_empty_tag('a:picLocks', attributes)
+        self._xml_empty_tag("a:picLocks", attributes)
 
     def _write_blip_fill(self, index):
         # Write the <xdr:blipFill> element.
-        self._xml_start_tag('xdr:blipFill')
+        self._xml_start_tag("xdr:blipFill")
 
         # Write the a:blip element.
         self._write_a_blip(index)
 
         # Write the a:stretch element.
         self._write_a_stretch()
 
-        self._xml_end_tag('xdr:blipFill')
+        self._xml_end_tag("xdr:blipFill")
 
     def _write_a_blip(self, index):
         # Write the <a:blip> element.
-        schema = 'http://schemas.openxmlformats.org/officeDocument/'
-        xmlns_r = schema + '2006/relationships'
-        r_embed = 'rId' + str(index)
+        schema = "http://schemas.openxmlformats.org/officeDocument/"
+        xmlns_r = schema + "2006/relationships"
+        r_embed = "rId" + str(index)
 
-        attributes = [
-            ('xmlns:r', xmlns_r),
-            ('r:embed', r_embed)]
+        attributes = [("xmlns:r", xmlns_r), ("r:embed", r_embed)]
 
-        self._xml_empty_tag('a:blip', attributes)
+        self._xml_empty_tag("a:blip", attributes)
 
     def _write_a_stretch(self):
         # Write the <a:stretch> element.
-        self._xml_start_tag('a:stretch')
+        self._xml_start_tag("a:stretch")
 
         # Write the a:fillRect element.
         self._write_a_fill_rect()
 
-        self._xml_end_tag('a:stretch')
+        self._xml_end_tag("a:stretch")
 
     def _write_a_fill_rect(self):
         # Write the <a:fillRect> element.
-        self._xml_empty_tag('a:fillRect')
+        self._xml_empty_tag("a:fillRect")
 
-    def _write_sp_pr(self, col_absolute, row_absolute, width, height,
-                     shape=None):
+    def _write_sp_pr(self, col_absolute, row_absolute, width, height, shape=None):
         # Write the <xdr:spPr> element, for charts.
 
-        self._xml_start_tag('xdr:spPr')
+        self._xml_start_tag("xdr:spPr")
 
         # Write the a:xfrm element.
         self._write_a_xfrm(col_absolute, row_absolute, width, height)
 
         # Write the a:prstGeom element.
         self._write_a_prst_geom(shape)
 
-        self._xml_end_tag('xdr:spPr')
+        self._xml_end_tag("xdr:spPr")
 
-    def _write_xdr_sp_pr(self, index, col_absolute, row_absolute, width,
-                         height, shape):
+    def _write_xdr_sp_pr(self, index, col_absolute, row_absolute, width, height, shape):
         # Write the <xdr:spPr> element for shapes.
 
         attributes = []
         # attributes = [('bwMode', 'auto')]
 
-        self._xml_start_tag('xdr:spPr', attributes)
+        self._xml_start_tag("xdr:spPr", attributes)
 
         # Write the a:xfrm element.
         self._write_a_xfrm(col_absolute, row_absolute, width, height, shape)
 
         # Write the a:prstGeom element.
         self._write_a_prst_geom(shape)
 
         if shape.fill:
-            if not shape.fill['defined']:
+            if not shape.fill["defined"]:
                 # Write the a:solidFill element.
-                self._write_a_solid_fill_scheme('lt1')
-            elif 'none' in shape.fill:
+                self._write_a_solid_fill_scheme("lt1")
+            elif "none" in shape.fill:
                 # Write the a:noFill element.
-                self._xml_empty_tag('a:noFill')
-            elif 'color' in shape.fill:
+                self._xml_empty_tag("a:noFill")
+            elif "color" in shape.fill:
                 # Write the a:solidFill element.
-                self._write_a_solid_fill(get_rgb_color(shape.fill['color']))
+                self._write_a_solid_fill(get_rgb_color(shape.fill["color"]))
 
         if shape.gradient:
             # Write the a:gradFill element.
             self._write_a_grad_fill(shape.gradient)
 
         # Write the a:ln element.
         self._write_a_ln(shape.line)
 
-        self._xml_end_tag('xdr:spPr')
+        self._xml_end_tag("xdr:spPr")
 
-    def _write_a_xfrm(self, col_absolute, row_absolute, width, height,
-                      shape=None):
+    def _write_a_xfrm(self, col_absolute, row_absolute, width, height, shape=None):
         # Write the <a:xfrm> element.
         attributes = []
 
         if shape:
             if shape.rotation:
                 rotation = shape.rotation
                 rotation *= 60000
-                attributes.append(('rot', rotation))
+                attributes.append(("rot", rotation))
 
             if shape.flip_h:
-                attributes.append(('flipH', 1))
+                attributes.append(("flipH", 1))
             if shape.flip_v:
-                attributes.append(('flipV', 1))
+                attributes.append(("flipV", 1))
 
-        self._xml_start_tag('a:xfrm', attributes)
+        self._xml_start_tag("a:xfrm", attributes)
 
         # Write the a:off element.
         self._write_a_off(col_absolute, row_absolute)
 
         # Write the a:ext element.
         self._write_a_ext(width, height)
 
-        self._xml_end_tag('a:xfrm')
+        self._xml_end_tag("a:xfrm")
 
     def _write_a_off(self, x, y):
         # Write the <a:off> element.
         attributes = [
-            ('x', x),
-            ('y', y),
+            ("x", x),
+            ("y", y),
         ]
 
-        self._xml_empty_tag('a:off', attributes)
+        self._xml_empty_tag("a:off", attributes)
 
     def _write_a_ext(self, cx, cy):
         # Write the <a:ext> element.
         attributes = [
-            ('cx', cx),
-            ('cy', cy),
+            ("cx", cx),
+            ("cy", cy),
         ]
 
-        self._xml_empty_tag('a:ext', attributes)
+        self._xml_empty_tag("a:ext", attributes)
 
     def _write_a_prst_geom(self, shape=None):
         # Write the <a:prstGeom> element.
-        attributes = [('prst', 'rect')]
+        attributes = [("prst", "rect")]
 
-        self._xml_start_tag('a:prstGeom', attributes)
+        self._xml_start_tag("a:prstGeom", attributes)
 
         # Write the a:avLst element.
         self._write_a_av_lst(shape)
 
-        self._xml_end_tag('a:prstGeom')
+        self._xml_end_tag("a:prstGeom")
 
     def _write_a_av_lst(self, shape=None):
         # Write the <a:avLst> element.
         adjustments = []
 
         if shape and shape.adjustments:
             adjustments = shape.adjustments
 
         if adjustments:
-            self._xml_start_tag('a:avLst')
+            self._xml_start_tag("a:avLst")
 
             i = 0
             for adj in adjustments:
                 i += 1
                 # Only connectors have multiple adjustments.
                 if shape.connect:
                     suffix = i
                 else:
-                    suffix = ''
+                    suffix = ""
 
                 # Scale Adjustments: 100,000 = 100%.
                 adj_int = str(int(adj * 1000))
 
-                attributes = [('name', 'adj' + suffix),
-                              ('fmla', 'val' + adj_int)]
+                attributes = [("name", "adj" + suffix), ("fmla", "val" + adj_int)]
 
-                self._xml_empty_tag('a:gd', attributes)
+                self._xml_empty_tag("a:gd", attributes)
 
-            self._xml_end_tag('a:avLst')
+            self._xml_end_tag("a:avLst")
         else:
-            self._xml_empty_tag('a:avLst')
+            self._xml_empty_tag("a:avLst")
 
     def _write_a_solid_fill(self, rgb):
         # Write the <a:solidFill> element.
         if rgb is None:
-            rgb = 'FFFFFF'
+            rgb = "FFFFFF"
 
-        self._xml_start_tag('a:solidFill')
+        self._xml_start_tag("a:solidFill")
 
         # Write the a:srgbClr element.
         self._write_a_srgb_clr(rgb)
 
-        self._xml_end_tag('a:solidFill')
+        self._xml_end_tag("a:solidFill")
 
     def _write_a_solid_fill_scheme(self, color, shade=None):
+        attributes = [("val", color)]
 
-        attributes = [('val', color)]
-
-        self._xml_start_tag('a:solidFill')
+        self._xml_start_tag("a:solidFill")
 
         if shade:
-            self._xml_start_tag('a:schemeClr', attributes)
+            self._xml_start_tag("a:schemeClr", attributes)
             self._write_a_shade(shade)
-            self._xml_end_tag('a:schemeClr')
+            self._xml_end_tag("a:schemeClr")
         else:
-            self._xml_empty_tag('a:schemeClr', attributes)
+            self._xml_empty_tag("a:schemeClr", attributes)
 
-        self._xml_end_tag('a:solidFill')
+        self._xml_end_tag("a:solidFill")
 
     def _write_a_ln(self, line):
         # Write the <a:ln> element.
-        width = line.get('width', 0.75)
+        width = line.get("width", 0.75)
 
         # Round width to nearest 0.25, like Excel.
         width = int((width + 0.125) * 4) / 4.0
 
         # Convert to internal units.
         width = int(0.5 + (12700 * width))
 
-        attributes = [
-            ('w', width),
-            ('cmpd', 'sng')
-        ]
+        attributes = [("w", width), ("cmpd", "sng")]
 
-        self._xml_start_tag('a:ln', attributes)
+        self._xml_start_tag("a:ln", attributes)
 
-        if 'none' in line:
+        if "none" in line:
             # Write the a:noFill element.
-            self._xml_empty_tag('a:noFill')
+            self._xml_empty_tag("a:noFill")
 
-        elif 'color' in line:
+        elif "color" in line:
             # Write the a:solidFill element.
-            self._write_a_solid_fill(get_rgb_color(line['color']))
+            self._write_a_solid_fill(get_rgb_color(line["color"]))
 
         else:
             # Write the a:solidFill element.
-            self._write_a_solid_fill_scheme('lt1', '50000')
+            self._write_a_solid_fill_scheme("lt1", "50000")
 
         # Write the line/dash type.
-        line_type = line.get('dash_type')
+        line_type = line.get("dash_type")
         if line_type:
             # Write the a:prstDash element.
             self._write_a_prst_dash(line_type)
 
-        self._xml_end_tag('a:ln')
+        self._xml_end_tag("a:ln")
 
     def _write_tx_body(self, col_absolute, row_absolute, width, height, shape):
         # Write the <xdr:txBody> element.
         attributes = []
 
         if shape.text_rotation != 0:
             if shape.text_rotation == 90:
-                attributes.append(('vert', 'vert270'))
+                attributes.append(("vert", "vert270"))
             if shape.text_rotation == -90:
-                attributes.append(('vert', 'vert'))
+                attributes.append(("vert", "vert"))
             if shape.text_rotation == 270:
-                attributes.append(('vert', 'wordArtVert'))
+                attributes.append(("vert", "wordArtVert"))
             if shape.text_rotation == 271:
-                attributes.append(('vert', 'eaVert'))
+                attributes.append(("vert", "eaVert"))
 
-        attributes.append(('wrap', 'square'))
-        attributes.append(('rtlCol', "0"))
+        attributes.append(("wrap", "square"))
+        attributes.append(("rtlCol", "0"))
 
-        if not shape.align['defined']:
-            attributes.append(('anchor', 't'))
+        if not shape.align["defined"]:
+            attributes.append(("anchor", "t"))
         else:
-
-            if 'vertical' in shape.align:
-                align = shape.align['vertical']
-                if align == 'top':
-                    attributes.append(('anchor', 't'))
-                elif align == 'middle':
-                    attributes.append(('anchor', 'ctr'))
-                elif align == 'bottom':
-                    attributes.append(('anchor', 'b'))
+            if "vertical" in shape.align:
+                align = shape.align["vertical"]
+                if align == "top":
+                    attributes.append(("anchor", "t"))
+                elif align == "middle":
+                    attributes.append(("anchor", "ctr"))
+                elif align == "bottom":
+                    attributes.append(("anchor", "b"))
             else:
-                attributes.append(('anchor', 't'))
+                attributes.append(("anchor", "t"))
 
-            if 'horizontal' in shape.align:
-                align = shape.align['horizontal']
-                if align == 'center':
-                    attributes.append(('anchorCtr', '1'))
+            if "horizontal" in shape.align:
+                align = shape.align["horizontal"]
+                if align == "center":
+                    attributes.append(("anchorCtr", "1"))
             else:
-                attributes.append(('anchorCtr', '0'))
+                attributes.append(("anchorCtr", "0"))
 
-        self._xml_start_tag('xdr:txBody')
-        self._xml_empty_tag('a:bodyPr', attributes)
-        self._xml_empty_tag('a:lstStyle')
+        self._xml_start_tag("xdr:txBody")
+        self._xml_empty_tag("a:bodyPr", attributes)
+        self._xml_empty_tag("a:lstStyle")
 
-        lines = shape.text.split('\n')
+        lines = shape.text.split("\n")
 
         # Set the font attributes.
         font = shape.font
         style_attrs = Shape._get_font_style_attributes(font)
         latin_attrs = Shape._get_font_latin_attributes(font)
-        style_attrs.insert(0, ('lang', font['lang']))
+        style_attrs.insert(0, ("lang", font["lang"]))
 
-        if shape.textlink != '':
+        if shape.textlink != "":
             attributes = [
-                ('id', '{B8ADDEFE-BF52-4FD4-8C5D-6B85EF6FF707}'),
-                ('type', 'TxLink')]
+                ("id", "{B8ADDEFE-BF52-4FD4-8C5D-6B85EF6FF707}"),
+                ("type", "TxLink"),
+            ]
 
-            self._xml_start_tag('a:p')
-            self._xml_start_tag('a:fld', attributes)
+            self._xml_start_tag("a:p")
+            self._xml_start_tag("a:fld", attributes)
 
-            self._write_font_run(font, style_attrs, latin_attrs, 'a:rPr')
+            self._write_font_run(font, style_attrs, latin_attrs, "a:rPr")
 
-            self._xml_data_element('a:t', shape.text)
-            self._xml_end_tag('a:fld')
+            self._xml_data_element("a:t", shape.text)
+            self._xml_end_tag("a:fld")
 
-            self._write_font_run(font, style_attrs, latin_attrs,
-                                 'a:endParaRPr')
+            self._write_font_run(font, style_attrs, latin_attrs, "a:endParaRPr")
 
-            self._xml_end_tag('a:p')
+            self._xml_end_tag("a:p")
         else:
             for line in lines:
-                self._xml_start_tag('a:p')
+                self._xml_start_tag("a:p")
 
-                if line == '':
-                    self._write_font_run(font, style_attrs, latin_attrs,
-                                         'a:endParaRPr')
-                    self._xml_end_tag('a:p')
+                if line == "":
+                    self._write_font_run(font, style_attrs, latin_attrs, "a:endParaRPr")
+                    self._xml_end_tag("a:p")
                     continue
-                elif 'text' in shape.align:
-                    if shape.align['text'] == 'left':
-                        self._xml_empty_tag('a:pPr', [('algn', 'l')])
-                    if shape.align['text'] == 'center':
-                        self._xml_empty_tag('a:pPr', [('algn', 'ctr')])
-                    if shape.align['text'] == 'right':
-                        self._xml_empty_tag('a:pPr', [('algn', 'r')])
+                elif "text" in shape.align:
+                    if shape.align["text"] == "left":
+                        self._xml_empty_tag("a:pPr", [("algn", "l")])
+                    if shape.align["text"] == "center":
+                        self._xml_empty_tag("a:pPr", [("algn", "ctr")])
+                    if shape.align["text"] == "right":
+                        self._xml_empty_tag("a:pPr", [("algn", "r")])
 
-                self._xml_start_tag('a:r')
+                self._xml_start_tag("a:r")
 
-                self._write_font_run(font, style_attrs, latin_attrs, 'a:rPr')
+                self._write_font_run(font, style_attrs, latin_attrs, "a:rPr")
 
-                self._xml_data_element('a:t', line)
+                self._xml_data_element("a:t", line)
 
-                self._xml_end_tag('a:r')
-                self._xml_end_tag('a:p')
+                self._xml_end_tag("a:r")
+                self._xml_end_tag("a:p")
 
-        self._xml_end_tag('xdr:txBody')
+        self._xml_end_tag("xdr:txBody")
 
     def _write_font_run(self, font, style_attrs, latin_attrs, run_type):
         # Write a:rPr or a:endParaRPr.
-        if font.get('color') is not None:
+        if font.get("color") is not None:
             has_color = True
         else:
             has_color = False
 
         if latin_attrs or has_color:
             self._xml_start_tag(run_type, style_attrs)
 
             if has_color:
-                self._write_a_solid_fill(get_rgb_color(font['color']))
+                self._write_a_solid_fill(get_rgb_color(font["color"]))
 
             if latin_attrs:
                 self._write_a_latin(latin_attrs)
                 self._write_a_cs(latin_attrs)
 
             self._xml_end_tag(run_type)
         else:
             self._xml_empty_tag(run_type, style_attrs)
 
     def _write_style(self):
         # Write the <xdr:style> element.
-        self._xml_start_tag('xdr:style')
+        self._xml_start_tag("xdr:style")
 
         # Write the a:lnRef element.
         self._write_a_ln_ref()
 
         # Write the a:fillRef element.
         self._write_a_fill_ref()
 
         # Write the a:effectRef element.
         self._write_a_effect_ref()
 
         # Write the a:fontRef element.
         self._write_a_font_ref()
 
-        self._xml_end_tag('xdr:style')
+        self._xml_end_tag("xdr:style")
 
     def _write_a_ln_ref(self):
         # Write the <a:lnRef> element.
-        attributes = [('idx', '0')]
+        attributes = [("idx", "0")]
 
-        self._xml_start_tag('a:lnRef', attributes)
+        self._xml_start_tag("a:lnRef", attributes)
 
         # Write the a:scrgbClr element.
         self._write_a_scrgb_clr()
 
-        self._xml_end_tag('a:lnRef')
+        self._xml_end_tag("a:lnRef")
 
     def _write_a_fill_ref(self):
         # Write the <a:fillRef> element.
-        attributes = [('idx', '0')]
+        attributes = [("idx", "0")]
 
-        self._xml_start_tag('a:fillRef', attributes)
+        self._xml_start_tag("a:fillRef", attributes)
 
         # Write the a:scrgbClr element.
         self._write_a_scrgb_clr()
 
-        self._xml_end_tag('a:fillRef')
+        self._xml_end_tag("a:fillRef")
 
     def _write_a_effect_ref(self):
         # Write the <a:effectRef> element.
-        attributes = [('idx', '0')]
+        attributes = [("idx", "0")]
 
-        self._xml_start_tag('a:effectRef', attributes)
+        self._xml_start_tag("a:effectRef", attributes)
 
         # Write the a:scrgbClr element.
         self._write_a_scrgb_clr()
 
-        self._xml_end_tag('a:effectRef')
+        self._xml_end_tag("a:effectRef")
 
     def _write_a_scrgb_clr(self):
         # Write the <a:scrgbClr> element.
 
         attributes = [
-            ('r', '0'),
-            ('g', '0'),
-            ('b', '0'),
+            ("r", "0"),
+            ("g", "0"),
+            ("b", "0"),
         ]
 
-        self._xml_empty_tag('a:scrgbClr', attributes)
+        self._xml_empty_tag("a:scrgbClr", attributes)
 
     def _write_a_font_ref(self):
         # Write the <a:fontRef> element.
-        attributes = [('idx', 'minor')]
+        attributes = [("idx", "minor")]
 
-        self._xml_start_tag('a:fontRef', attributes)
+        self._xml_start_tag("a:fontRef", attributes)
 
         # Write the a:schemeClr element.
-        self._write_a_scheme_clr('dk1')
+        self._write_a_scheme_clr("dk1")
 
-        self._xml_end_tag('a:fontRef')
+        self._xml_end_tag("a:fontRef")
 
     def _write_a_scheme_clr(self, val):
         # Write the <a:schemeClr> element.
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('a:schemeClr', attributes)
+        self._xml_empty_tag("a:schemeClr", attributes)
 
     def _write_a_shade(self, shade):
         # Write the <a:shade> element.
-        attributes = [('val', shade)]
+        attributes = [("val", shade)]
 
-        self._xml_empty_tag('a:shade', attributes)
+        self._xml_empty_tag("a:shade", attributes)
 
     def _write_a_prst_dash(self, val):
         # Write the <a:prstDash> element.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('a:prstDash', attributes)
+        self._xml_empty_tag("a:prstDash", attributes)
 
     def _write_a_grad_fill(self, gradient):
         # Write the <a:gradFill> element.
 
-        attributes = [('flip', 'none'), ('rotWithShape', '1')]
+        attributes = [("flip", "none"), ("rotWithShape", "1")]
 
-        if gradient['type'] == 'linear':
+        if gradient["type"] == "linear":
             attributes = []
 
-        self._xml_start_tag('a:gradFill', attributes)
+        self._xml_start_tag("a:gradFill", attributes)
 
         # Write the a:gsLst element.
         self._write_a_gs_lst(gradient)
 
-        if gradient['type'] == 'linear':
+        if gradient["type"] == "linear":
             # Write the a:lin element.
-            self._write_a_lin(gradient['angle'])
+            self._write_a_lin(gradient["angle"])
         else:
             # Write the a:path element.
-            self._write_a_path(gradient['type'])
+            self._write_a_path(gradient["type"])
 
             # Write the a:tileRect element.
-            self._write_a_tile_rect(gradient['type'])
+            self._write_a_tile_rect(gradient["type"])
 
-        self._xml_end_tag('a:gradFill')
+        self._xml_end_tag("a:gradFill")
 
     def _write_a_gs_lst(self, gradient):
         # Write the <a:gsLst> element.
-        positions = gradient['positions']
-        colors = gradient['colors']
+        positions = gradient["positions"]
+        colors = gradient["colors"]
 
-        self._xml_start_tag('a:gsLst')
+        self._xml_start_tag("a:gsLst")
 
         for i in range(len(colors)):
             pos = int(positions[i] * 1000)
-            attributes = [('pos', pos)]
-            self._xml_start_tag('a:gs', attributes)
+            attributes = [("pos", pos)]
+            self._xml_start_tag("a:gs", attributes)
 
             # Write the a:srgbClr element.
             # TODO: Wait for a feature request to support transparency.
             color = get_rgb_color(colors[i])
             self._write_a_srgb_clr(color)
 
-            self._xml_end_tag('a:gs')
+            self._xml_end_tag("a:gs")
 
-        self._xml_end_tag('a:gsLst')
+        self._xml_end_tag("a:gsLst")
 
     def _write_a_lin(self, angle):
         # Write the <a:lin> element.
 
         angle = int(60000 * angle)
 
         attributes = [
-            ('ang', angle),
-            ('scaled', '0'),
+            ("ang", angle),
+            ("scaled", "0"),
         ]
 
-        self._xml_empty_tag('a:lin', attributes)
+        self._xml_empty_tag("a:lin", attributes)
 
     def _write_a_path(self, gradient_type):
         # Write the <a:path> element.
 
-        attributes = [('path', gradient_type)]
+        attributes = [("path", gradient_type)]
 
-        self._xml_start_tag('a:path', attributes)
+        self._xml_start_tag("a:path", attributes)
 
         # Write the a:fillToRect element.
         self._write_a_fill_to_rect(gradient_type)
 
-        self._xml_end_tag('a:path')
+        self._xml_end_tag("a:path")
 
     def _write_a_fill_to_rect(self, gradient_type):
         # Write the <a:fillToRect> element.
 
-        if gradient_type == 'shape':
+        if gradient_type == "shape":
             attributes = [
-                ('l', '50000'),
-                ('t', '50000'),
-                ('r', '50000'),
-                ('b', '50000'),
+                ("l", "50000"),
+                ("t", "50000"),
+                ("r", "50000"),
+                ("b", "50000"),
             ]
         else:
             attributes = [
-                ('l', '100000'),
-                ('t', '100000'),
+                ("l", "100000"),
+                ("t", "100000"),
             ]
 
-        self._xml_empty_tag('a:fillToRect', attributes)
+        self._xml_empty_tag("a:fillToRect", attributes)
 
     def _write_a_tile_rect(self, gradient_type):
         # Write the <a:tileRect> element.
 
-        if gradient_type == 'shape':
+        if gradient_type == "shape":
             attributes = []
         else:
             attributes = [
-                ('r', '-100000'),
-                ('b', '-100000'),
+                ("r", "-100000"),
+                ("b", "-100000"),
             ]
 
-        self._xml_empty_tag('a:tileRect', attributes)
+        self._xml_empty_tag("a:tileRect", attributes)
 
     def _write_a_srgb_clr(self, val):
         # Write the <a:srgbClr> element.
 
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('a:srgbClr', attributes)
+        self._xml_empty_tag("a:srgbClr", attributes)
 
     def _write_a_latin(self, attributes):
         # Write the <a:latin> element.
-        self._xml_empty_tag('a:latin', attributes)
+        self._xml_empty_tag("a:latin", attributes)
 
     def _write_a_cs(self, attributes):
         # Write the <a:latin> element.
-        self._xml_empty_tag('a:cs', attributes)
+        self._xml_empty_tag("a:cs", attributes)
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/exceptions.py` & `XlsxWriter-3.1.0/xlsxwriter/exceptions.py`

 * *Files identical despite different names*

### Comparing `XlsxWriter-3.0.9/xlsxwriter/format.py` & `XlsxWriter-3.1.0/xlsxwriter/format.py`

 * *Files 4% similar despite different names*

```diff
@@ -35,33 +35,33 @@
         super(Format, self).__init__()
 
         self.xf_format_indices = xf_indices
         self.dxf_format_indices = dxf_indices
         self.xf_index = None
         self.dxf_index = None
 
-        self.num_format = 'General'
+        self.num_format = "General"
         self.num_format_index = 0
         self.font_index = 0
         self.has_font = 0
         self.has_dxf_font = 0
 
         self.bold = 0
         self.underline = 0
         self.italic = 0
-        self.font_name = 'Calibri'
+        self.font_name = "Calibri"
         self.font_size = 11
         self.font_color = 0x0
         self.font_strikeout = 0
         self.font_outline = 0
         self.font_shadow = 0
         self.font_script = 0
         self.font_family = 2
         self.font_charset = 0
-        self.font_scheme = 'minor'
+        self.font_scheme = "minor"
         self.font_condense = 0
         self.font_extend = 0
         self.theme = 0
         self.hyperlink = False
         self.xf_id = 0
 
         self.hidden = 0
@@ -106,15 +106,15 @@
         self.color_indexed = 0
         self.font_only = 0
 
         self.quote_prefix = False
 
         # Convert properties in the constructor to method calls.
         for key, value in properties.items():
-            getattr(self, 'set_' + key)(value)
+            getattr(self, "set_" + key)(value)
 
         self._format_key = None
 
     ###########################################################################
     #
     # Format properties.
     #
@@ -299,50 +299,50 @@
 
         Returns:
             Nothing.
         """
         alignment = alignment.lower()
 
         # Set horizontal alignment properties.
-        if alignment == 'left':
+        if alignment == "left":
             self.set_text_h_align(1)
-        if alignment == 'centre':
+        if alignment == "centre":
             self.set_text_h_align(2)
-        if alignment == 'center':
+        if alignment == "center":
             self.set_text_h_align(2)
-        if alignment == 'right':
+        if alignment == "right":
             self.set_text_h_align(3)
-        if alignment == 'fill':
+        if alignment == "fill":
             self.set_text_h_align(4)
-        if alignment == 'justify':
+        if alignment == "justify":
             self.set_text_h_align(5)
-        if alignment == 'center_across':
+        if alignment == "center_across":
             self.set_text_h_align(6)
-        if alignment == 'centre_across':
+        if alignment == "centre_across":
             self.set_text_h_align(6)
-        if alignment == 'distributed':
+        if alignment == "distributed":
             self.set_text_h_align(7)
-        if alignment == 'justify_distributed':
+        if alignment == "justify_distributed":
             self.set_text_h_align(7)
 
-        if alignment == 'justify_distributed':
+        if alignment == "justify_distributed":
             self.just_distrib = 1
 
         # Set vertical alignment properties.
-        if alignment == 'top':
+        if alignment == "top":
             self.set_text_v_align(1)
-        if alignment == 'vcentre':
+        if alignment == "vcentre":
             self.set_text_v_align(2)
-        if alignment == 'vcenter':
+        if alignment == "vcenter":
             self.set_text_v_align(2)
-        if alignment == 'bottom':
+        if alignment == "bottom":
             self.set_text_v_align(3)
-        if alignment == 'vjustify':
+        if alignment == "vjustify":
             self.set_text_v_align(4)
-        if alignment == 'vdistributed':
+        if alignment == "vdistributed":
             self.set_text_v_align(5)
 
     def set_center_across(self, align_type=None):
         """
         Set the Format center_across property.
 
         Returns:
@@ -767,28 +767,36 @@
 
     def _get_align_properties(self):
         # Return properties for an Style xf <alignment> sub-element.
         changed = 0
         align = []
 
         # Check if any alignment options in the format have been changed.
-        if (self.text_h_align or self.text_v_align or self.indent
-                or self.rotation or self.text_wrap or self.shrink
-                or self.reading_order):
+        if (
+            self.text_h_align
+            or self.text_v_align
+            or self.indent
+            or self.rotation
+            or self.text_wrap
+            or self.shrink
+            or self.reading_order
+        ):
             changed = 1
         else:
             return changed, align
 
         # Indent is only allowed for horizontal left, right and distributed.
         # If it is defined for any other alignment or no alignment has
         # been set then default to left alignment.
-        if (self.indent
-                and self.text_h_align != 1
-                and self.text_h_align != 3
-                and self.text_h_align != 7):
+        if (
+            self.indent
+            and self.text_h_align != 1
+            and self.text_h_align != 3
+            and self.text_h_align != 7
+        ):
             self.text_h_align = 1
 
         # Check for properties that are mutually exclusive.
         if self.text_wrap:
             self.shrink = 0
         if self.text_h_align == 4:
             self.shrink = 0
@@ -797,144 +805,157 @@
         if self.text_h_align == 7:
             self.shrink = 0
         if self.text_h_align != 7:
             self.just_distrib = 0
         if self.indent:
             self.just_distrib = 0
 
-        continuous = 'centerContinuous'
+        continuous = "centerContinuous"
 
         if self.text_h_align == 1:
-            align.append(('horizontal', 'left'))
+            align.append(("horizontal", "left"))
         if self.text_h_align == 2:
-            align.append(('horizontal', 'center'))
+            align.append(("horizontal", "center"))
         if self.text_h_align == 3:
-            align.append(('horizontal', 'right'))
+            align.append(("horizontal", "right"))
         if self.text_h_align == 4:
-            align.append(('horizontal', 'fill'))
+            align.append(("horizontal", "fill"))
         if self.text_h_align == 5:
-            align.append(('horizontal', 'justify'))
+            align.append(("horizontal", "justify"))
         if self.text_h_align == 6:
-            align.append(('horizontal', continuous))
+            align.append(("horizontal", continuous))
         if self.text_h_align == 7:
-            align.append(('horizontal', 'distributed'))
+            align.append(("horizontal", "distributed"))
 
         if self.just_distrib:
-            align.append(('justifyLastLine', 1))
+            align.append(("justifyLastLine", 1))
 
         # Property 'vertical' => 'bottom' is a default. It sets applyAlignment
         # without an alignment sub-element.
         if self.text_v_align == 1:
-            align.append(('vertical', 'top'))
+            align.append(("vertical", "top"))
         if self.text_v_align == 2:
-            align.append(('vertical', 'center'))
+            align.append(("vertical", "center"))
         if self.text_v_align == 4:
-            align.append(('vertical', 'justify'))
+            align.append(("vertical", "justify"))
         if self.text_v_align == 5:
-            align.append(('vertical', 'distributed'))
+            align.append(("vertical", "distributed"))
 
         if self.indent:
-            align.append(('indent', self.indent))
+            align.append(("indent", self.indent))
         if self.rotation:
-            align.append(('textRotation', self.rotation))
+            align.append(("textRotation", self.rotation))
 
         if self.text_wrap:
-            align.append(('wrapText', 1))
+            align.append(("wrapText", 1))
         if self.shrink:
-            align.append(('shrinkToFit', 1))
+            align.append(("shrinkToFit", 1))
 
         if self.reading_order == 1:
-            align.append(('readingOrder', 1))
+            align.append(("readingOrder", 1))
         if self.reading_order == 2:
-            align.append(('readingOrder', 2))
+            align.append(("readingOrder", 2))
 
         return changed, align
 
     def _get_protection_properties(self):
         # Return properties for an Excel XML <Protection> element.
         attribs = []
 
         if not self.locked:
-            attribs.append(('locked', 0))
+            attribs.append(("locked", 0))
         if self.hidden:
-            attribs.append(('hidden', 1))
+            attribs.append(("hidden", 1))
 
         return attribs
 
     def _get_format_key(self):
         # Returns a unique hash key for a format. Used by Workbook.
         if self._format_key is None:
-            self._format_key = ':'.join(str(x) for x in (
-                self._get_font_key(),
-                self._get_border_key(),
-                self._get_fill_key(),
-                self._get_alignment_key(),
-                self.num_format,
-                self.locked,
-                self.quote_prefix,
-                self.hidden))
+            self._format_key = ":".join(
+                str(x)
+                for x in (
+                    self._get_font_key(),
+                    self._get_border_key(),
+                    self._get_fill_key(),
+                    self._get_alignment_key(),
+                    self.num_format,
+                    self.locked,
+                    self.quote_prefix,
+                    self.hidden,
+                )
+            )
 
         return self._format_key
 
     def _get_font_key(self):
         # Returns a unique hash key for a font. Used by Workbook.
-        key = ':'.join(str(x) for x in (
-            self.bold,
-            self.font_color,
-            self.font_charset,
-            self.font_family,
-            self.font_outline,
-            self.font_script,
-            self.font_shadow,
-            self.font_strikeout,
-            self.font_name,
-            self.italic,
-            self.font_size,
-            self.underline,
-            self.theme))
+        key = ":".join(
+            str(x)
+            for x in (
+                self.bold,
+                self.font_color,
+                self.font_charset,
+                self.font_family,
+                self.font_outline,
+                self.font_script,
+                self.font_shadow,
+                self.font_strikeout,
+                self.font_name,
+                self.italic,
+                self.font_size,
+                self.underline,
+                self.theme,
+            )
+        )
 
         return key
 
     def _get_border_key(self):
         # Returns a unique hash key for a border style. Used by Workbook.
-        key = ':'.join(str(x) for x in (
-            self.bottom,
-            self.bottom_color,
-            self.diag_border,
-            self.diag_color,
-            self.diag_type,
-            self.left,
-            self.left_color,
-            self.right,
-            self.right_color,
-            self.top,
-            self.top_color))
+        key = ":".join(
+            str(x)
+            for x in (
+                self.bottom,
+                self.bottom_color,
+                self.diag_border,
+                self.diag_color,
+                self.diag_type,
+                self.left,
+                self.left_color,
+                self.right,
+                self.right_color,
+                self.top,
+                self.top_color,
+            )
+        )
 
         return key
 
     def _get_fill_key(self):
         # Returns a unique hash key for a fill style. Used by Workbook.
-        key = ':'.join(str(x) for x in (
-            self.pattern,
-            self.bg_color,
-            self.fg_color))
+        key = ":".join(str(x) for x in (self.pattern, self.bg_color, self.fg_color))
 
         return key
 
     def _get_alignment_key(self):
         # Returns a unique hash key for alignment formats.
 
-        key = ':'.join(str(x) for x in (
-            self.text_h_align,
-            self.text_v_align,
-            self.indent,
-            self.rotation,
-            self.text_wrap,
-            self.shrink,
-            self.reading_order))
+        key = ":".join(
+            str(x)
+            for x in (
+                self.text_h_align,
+                self.text_v_align,
+                self.indent,
+                self.rotation,
+                self.text_wrap,
+                self.shrink,
+                self.reading_order,
+            )
+        )
 
         return key
 
     def _get_xf_index(self):
         # Returns the XF index number used by Excel to identify a format.
         if self.xf_index is not None:
             # Format already has an index number so return it.
@@ -974,30 +995,31 @@
                 return index
 
     def _get_color(self, color):
         # Used in conjunction with the set_xxx_color methods to convert a
         # color name into an RGB formatted string. These colors are for
         # backward compatibility with older versions of Excel.
         named_colors = {
-            'black': '#000000',
-            'blue': '#0000FF',
-            'brown': '#800000',
-            'cyan': '#00FFFF',
-            'gray': '#808080',
-            'green': '#008000',
-            'lime': '#00FF00',
-            'magenta': '#FF00FF',
-            'navy': '#000080',
-            'orange': '#FF6600',
-            'pink': '#FF00FF',
-            'purple': '#800080',
-            'red': '#FF0000',
-            'silver': '#C0C0C0',
-            'white': '#FFFFFF',
-            'yellow': '#FFFF00',
+            "black": "#000000",
+            "blue": "#0000FF",
+            "brown": "#800000",
+            "cyan": "#00FFFF",
+            "gray": "#808080",
+            "green": "#008000",
+            "lime": "#00FF00",
+            "magenta": "#FF00FF",
+            "navy": "#000080",
+            "orange": "#FF6600",
+            "pink": "#FF00FF",
+            "purple": "#800080",
+            "red": "#FF0000",
+            "silver": "#C0C0C0",
+            "white": "#FFFFFF",
+            "yellow": "#FFFF00",
+            "automatic": "Automatic",
         }
 
         if color in named_colors:
             color = named_colors[color]
 
         return color
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/metadata.py` & `XlsxWriter-3.1.0/xlsxwriter/metadata.py`

 * *Files 20% similar despite different names*

```diff
@@ -50,121 +50,121 @@
 
         # Write the futureMetadata element.
         self._write_future_metadata()
 
         # Write the cellMetadata element.
         self._write_cell_metadata()
 
-        self._xml_end_tag('metadata')
+        self._xml_end_tag("metadata")
 
         # Close the file.
         self._xml_close()
 
     ###########################################################################
     #
     # XML methods.
     #
     ###########################################################################
 
     def _write_metadata(self):
         # Write the <metadata> element.
-        xmlns = 'http://schemas.openxmlformats.org/spreadsheetml/2006/main'
-        schema = 'http://schemas.microsoft.com/office'
-        xmlns_xda = schema + '/spreadsheetml/2017/dynamicarray'
+        xmlns = "http://schemas.openxmlformats.org/spreadsheetml/2006/main"
+        schema = "http://schemas.microsoft.com/office"
+        xmlns_xda = schema + "/spreadsheetml/2017/dynamicarray"
 
         attributes = [
-            ('xmlns', xmlns),
-            ('xmlns:xda', xmlns_xda),
+            ("xmlns", xmlns),
+            ("xmlns:xda", xmlns_xda),
         ]
 
-        self._xml_start_tag('metadata', attributes)
+        self._xml_start_tag("metadata", attributes)
 
     def _write_metadata_types(self):
         # Write the <metadataTypes> element.
-        attributes = [('count', 1)]
+        attributes = [("count", 1)]
 
-        self._xml_start_tag('metadataTypes', attributes)
+        self._xml_start_tag("metadataTypes", attributes)
 
         # Write the metadataType element.
         self._write_metadata_type()
 
-        self._xml_end_tag('metadataTypes')
+        self._xml_end_tag("metadataTypes")
 
     def _write_metadata_type(self):
         # Write the <metadataType> element.
         attributes = [
-            ('name', 'XLDAPR'),
-            ('minSupportedVersion', 120000),
-            ('copy', 1),
-            ('pasteAll', 1),
-            ('pasteValues', 1),
-            ('merge', 1),
-            ('splitFirst', 1),
-            ('rowColShift', 1),
-            ('clearFormats', 1),
-            ('clearComments', 1),
-            ('assign', 1),
-            ('coerce', 1),
-            ('cellMeta', 1),
+            ("name", "XLDAPR"),
+            ("minSupportedVersion", 120000),
+            ("copy", 1),
+            ("pasteAll", 1),
+            ("pasteValues", 1),
+            ("merge", 1),
+            ("splitFirst", 1),
+            ("rowColShift", 1),
+            ("clearFormats", 1),
+            ("clearComments", 1),
+            ("assign", 1),
+            ("coerce", 1),
+            ("cellMeta", 1),
         ]
 
-        self._xml_empty_tag('metadataType', attributes)
+        self._xml_empty_tag("metadataType", attributes)
 
     def _write_future_metadata(self):
         # Write the <futureMetadata> element.
         attributes = [
-            ('name', 'XLDAPR'),
-            ('count', 1),
+            ("name", "XLDAPR"),
+            ("count", 1),
         ]
 
-        self._xml_start_tag('futureMetadata', attributes)
-        self._xml_start_tag('bk')
-        self._xml_start_tag('extLst')
+        self._xml_start_tag("futureMetadata", attributes)
+        self._xml_start_tag("bk")
+        self._xml_start_tag("extLst")
 
         # Write the ext element.
         self._write_ext()
 
-        self._xml_end_tag('extLst')
-        self._xml_end_tag('bk')
-        self._xml_end_tag('futureMetadata')
+        self._xml_end_tag("extLst")
+        self._xml_end_tag("bk")
+        self._xml_end_tag("futureMetadata")
 
     def _write_ext(self):
         # Write the <ext> element.
-        attributes = [('uri', '{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}')]
+        attributes = [("uri", "{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}")]
 
-        self._xml_start_tag('ext', attributes)
+        self._xml_start_tag("ext", attributes)
 
         # Write the xda:dynamicArrayProperties element.
         self._write_xda_dynamic_array_properties()
 
-        self._xml_end_tag('ext')
+        self._xml_end_tag("ext")
 
     def _write_xda_dynamic_array_properties(self):
         # Write the <xda:dynamicArrayProperties> element.
         attributes = [
-            ('fDynamic', 1),
-            ('fCollapsed', 0),
+            ("fDynamic", 1),
+            ("fCollapsed", 0),
         ]
 
-        self._xml_empty_tag('xda:dynamicArrayProperties', attributes)
+        self._xml_empty_tag("xda:dynamicArrayProperties", attributes)
 
     def _write_cell_metadata(self):
         # Write the <cellMetadata> element.
-        attributes = [('count', 1)]
+        attributes = [("count", 1)]
 
-        self._xml_start_tag('cellMetadata', attributes)
-        self._xml_start_tag('bk')
+        self._xml_start_tag("cellMetadata", attributes)
+        self._xml_start_tag("bk")
 
         # Write the rc element.
         self._write_rc()
 
-        self._xml_end_tag('bk')
-        self._xml_end_tag('cellMetadata')
+        self._xml_end_tag("bk")
+        self._xml_end_tag("cellMetadata")
 
     def _write_rc(self):
         # Write the <rc> element.
         attributes = [
-            ('t', 1),
-            ('v', 0),
+            ("t", 1),
+            ("v", 0),
         ]
 
-        self._xml_empty_tag('rc', attributes)
+        self._xml_empty_tag("rc", attributes)
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/packager.py` & `XlsxWriter-3.1.0/xlsxwriter/packager.py`

 * *Files 11% similar despite different names*

```diff
@@ -83,15 +83,15 @@
         """
         Constructor.
 
         """
 
         super(Packager, self).__init__()
 
-        self.tmpdir = ''
+        self.tmpdir = ""
         self.in_memory = False
         self.workbook = None
         self.worksheet_count = 0
         self.chartsheet_count = 0
         self.chart_count = 0
         self.drawing_count = 0
         self.table_count = 0
@@ -170,139 +170,149 @@
 
         return os_filename
 
     def _write_workbook_file(self):
         # Write the workbook.xml file.
         workbook = self.workbook
 
-        workbook._set_xml_writer(self._filename('xl/workbook.xml'))
+        workbook._set_xml_writer(self._filename("xl/workbook.xml"))
         workbook._assemble_xml_file()
 
     def _write_worksheet_files(self):
         # Write the worksheet files.
         index = 1
         for worksheet in self.workbook.worksheets():
             if worksheet.is_chartsheet:
                 continue
 
             if worksheet.constant_memory:
                 worksheet._opt_reopen()
                 worksheet._write_single_row()
 
-            worksheet._set_xml_writer(self._filename('xl/worksheets/sheet'
-                                                     + str(index) + '.xml'))
+            worksheet._set_xml_writer(
+                self._filename("xl/worksheets/sheet" + str(index) + ".xml")
+            )
             worksheet._assemble_xml_file()
             index += 1
 
     def _write_chartsheet_files(self):
         # Write the chartsheet files.
         index = 1
         for worksheet in self.workbook.worksheets():
             if not worksheet.is_chartsheet:
                 continue
 
-            worksheet._set_xml_writer(self._filename('xl/chartsheets/sheet'
-                                                     + str(index) + '.xml'))
+            worksheet._set_xml_writer(
+                self._filename("xl/chartsheets/sheet" + str(index) + ".xml")
+            )
             worksheet._assemble_xml_file()
             index += 1
 
     def _write_chart_files(self):
         # Write the chart files.
         if not self.workbook.charts:
             return
 
         index = 1
         for chart in self.workbook.charts:
             # Check that the chart has at least one data series.
             if not chart.series:
-                raise EmptyChartSeries("Chart%d must contain at least one "
-                                       "data series. See chart.add_series()."
-                                       % index)
-
-            chart._set_xml_writer(self._filename('xl/charts/chart'
-                                                 + str(index) + '.xml'))
+                raise EmptyChartSeries(
+                    "Chart%d must contain at least one "
+                    "data series. See chart.add_series()." % index
+                )
+
+            chart._set_xml_writer(
+                self._filename("xl/charts/chart" + str(index) + ".xml")
+            )
             chart._assemble_xml_file()
             index += 1
 
     def _write_drawing_files(self):
         # Write the drawing files.
         if not self.drawing_count:
             return
 
         index = 1
         for drawing in self.workbook.drawings:
-            drawing._set_xml_writer(self._filename('xl/drawings/drawing'
-                                                   + str(index) + '.xml'))
+            drawing._set_xml_writer(
+                self._filename("xl/drawings/drawing" + str(index) + ".xml")
+            )
             drawing._assemble_xml_file()
             index += 1
 
     def _write_vml_files(self):
         # Write the comment VML files.
         index = 1
         for worksheet in self.workbook.worksheets():
             if not worksheet.has_vml and not worksheet.has_header_vml:
                 continue
             if worksheet.has_vml:
                 vml = Vml()
-                vml._set_xml_writer(self._filename('xl/drawings/vmlDrawing'
-                                                   + str(index) + '.vml'))
-                vml._assemble_xml_file(worksheet.vml_data_id,
-                                       worksheet.vml_shape_id,
-                                       worksheet.comments_list,
-                                       worksheet.buttons_list)
+                vml._set_xml_writer(
+                    self._filename("xl/drawings/vmlDrawing" + str(index) + ".vml")
+                )
+                vml._assemble_xml_file(
+                    worksheet.vml_data_id,
+                    worksheet.vml_shape_id,
+                    worksheet.comments_list,
+                    worksheet.buttons_list,
+                )
                 index += 1
 
             if worksheet.has_header_vml:
                 vml = Vml()
 
-                vml._set_xml_writer(self._filename('xl/drawings/vmlDrawing'
-                                                   + str(index) + '.vml'))
-                vml._assemble_xml_file(worksheet.vml_header_id,
-                                       worksheet.vml_header_id * 1024,
-                                       None,
-                                       None,
-                                       worksheet.header_images_list)
+                vml._set_xml_writer(
+                    self._filename("xl/drawings/vmlDrawing" + str(index) + ".vml")
+                )
+                vml._assemble_xml_file(
+                    worksheet.vml_header_id,
+                    worksheet.vml_header_id * 1024,
+                    None,
+                    None,
+                    worksheet.header_images_list,
+                )
 
                 self._write_vml_drawing_rels_file(worksheet, index)
                 index += 1
 
     def _write_comment_files(self):
         # Write the comment files.
         index = 1
         for worksheet in self.workbook.worksheets():
             if not worksheet.has_comments:
                 continue
 
             comment = Comments()
-            comment._set_xml_writer(self._filename('xl/comments'
-                                                   + str(index) + '.xml'))
+            comment._set_xml_writer(self._filename("xl/comments" + str(index) + ".xml"))
             comment._assemble_xml_file(worksheet.comments_list)
             index += 1
 
     def _write_shared_strings_file(self):
         # Write the sharedStrings.xml file.
         sst = SharedStrings()
         sst.string_table = self.workbook.str_table
 
         if not self.workbook.str_table.count:
             return
 
-        sst._set_xml_writer(self._filename('xl/sharedStrings.xml'))
+        sst._set_xml_writer(self._filename("xl/sharedStrings.xml"))
         sst._assemble_xml_file()
 
     def _write_app_file(self):
         # Write the app.xml file.
         properties = self.workbook.doc_properties
         app = App()
 
         # Add the Worksheet heading pairs.
-        app._add_heading_pair(['Worksheets', self.worksheet_count])
+        app._add_heading_pair(["Worksheets", self.worksheet_count])
 
         # Add the Chartsheet heading pairs.
-        app._add_heading_pair(['Charts', self.chartsheet_count])
+        app._add_heading_pair(["Charts", self.chartsheet_count])
 
         # Add the Worksheet parts.
         for worksheet in self.workbook.worksheets():
             if worksheet.is_chartsheet:
                 continue
             app._add_part_name(worksheet.name)
 
@@ -310,87 +320,87 @@
         for worksheet in self.workbook.worksheets():
             if not worksheet.is_chartsheet:
                 continue
             app._add_part_name(worksheet.name)
 
         # Add the Named Range heading pairs.
         if self.named_ranges:
-            app._add_heading_pair(['Named Ranges', len(self.named_ranges)])
+            app._add_heading_pair(["Named Ranges", len(self.named_ranges)])
 
         # Add the Named Ranges parts.
         for named_range in self.named_ranges:
             app._add_part_name(named_range)
 
         app._set_properties(properties)
         app.doc_security = self.workbook.read_only
 
-        app._set_xml_writer(self._filename('docProps/app.xml'))
+        app._set_xml_writer(self._filename("docProps/app.xml"))
         app._assemble_xml_file()
 
     def _write_core_file(self):
         # Write the core.xml file.
         properties = self.workbook.doc_properties
         core = Core()
 
         core._set_properties(properties)
-        core._set_xml_writer(self._filename('docProps/core.xml'))
+        core._set_xml_writer(self._filename("docProps/core.xml"))
         core._assemble_xml_file()
 
     def _write_metadata_file(self):
         # Write the metadata.xml file.
         if not self.workbook.has_metadata:
             return
 
         metadata = Metadata()
-        metadata._set_xml_writer(self._filename('xl/metadata.xml'))
+        metadata._set_xml_writer(self._filename("xl/metadata.xml"))
         metadata._assemble_xml_file()
 
     def _write_custom_file(self):
         # Write the custom.xml file.
         properties = self.workbook.custom_properties
         custom = Custom()
 
         if not len(properties):
             return
 
         custom._set_properties(properties)
-        custom._set_xml_writer(self._filename('docProps/custom.xml'))
+        custom._set_xml_writer(self._filename("docProps/custom.xml"))
         custom._assemble_xml_file()
 
     def _write_content_types_file(self):
         # Write the ContentTypes.xml file.
         content = ContentTypes()
         content._add_image_types(self.workbook.image_types)
 
         self._get_table_count()
 
         worksheet_index = 1
         chartsheet_index = 1
         for worksheet in self.workbook.worksheets():
             if worksheet.is_chartsheet:
-                content._add_chartsheet_name('sheet' + str(chartsheet_index))
+                content._add_chartsheet_name("sheet" + str(chartsheet_index))
                 chartsheet_index += 1
             else:
-                content._add_worksheet_name('sheet' + str(worksheet_index))
+                content._add_worksheet_name("sheet" + str(worksheet_index))
                 worksheet_index += 1
 
         for i in range(1, self.chart_count + 1):
-            content._add_chart_name('chart' + str(i))
+            content._add_chart_name("chart" + str(i))
 
         for i in range(1, self.drawing_count + 1):
-            content._add_drawing_name('drawing' + str(i))
+            content._add_drawing_name("drawing" + str(i))
 
         if self.num_vml_files:
             content._add_vml_name()
 
         for i in range(1, self.table_count + 1):
-            content._add_table_name('table' + str(i))
+            content._add_table_name("table" + str(i))
 
         for i in range(1, self.num_comment_files + 1):
-            content._add_comment_name('comments' + str(i))
+            content._add_comment_name("comments" + str(i))
 
         # Add the sharedString rel if there is string data in the workbook.
         if self.workbook.str_table.count:
             content._add_shared_strings()
 
         # Add vbaProject if present.
         if self.workbook.vba_project:
@@ -400,15 +410,15 @@
         if self.workbook.custom_properties:
             content._add_custom_properties()
 
         # Add the metadata file if present.
         if self.workbook.has_metadata:
             content._add_metadata()
 
-        content._set_xml_writer(self._filename('[Content_Types].xml'))
+        content._set_xml_writer(self._filename("[Content_Types].xml"))
         content._assemble_xml_file()
 
     def _write_styles_file(self):
         # Write the style xml file.
         xf_formats = self.workbook.xf_formats
         palette = self.workbook.palette
         font_count = self.workbook.font_count
@@ -416,154 +426,153 @@
         border_count = self.workbook.border_count
         fill_count = self.workbook.fill_count
         custom_colors = self.workbook.custom_colors
         dxf_formats = self.workbook.dxf_formats
         has_comments = self.workbook.has_comments
 
         styles = Styles()
-        styles._set_style_properties([
-            xf_formats,
-            palette,
-            font_count,
-            num_formats,
-            border_count,
-            fill_count,
-            custom_colors,
-            dxf_formats,
-            has_comments])
+        styles._set_style_properties(
+            [
+                xf_formats,
+                palette,
+                font_count,
+                num_formats,
+                border_count,
+                fill_count,
+                custom_colors,
+                dxf_formats,
+                has_comments,
+            ]
+        )
 
-        styles._set_xml_writer(self._filename('xl/styles.xml'))
+        styles._set_xml_writer(self._filename("xl/styles.xml"))
         styles._assemble_xml_file()
 
     def _write_theme_file(self):
         # Write the theme xml file.
         theme = Theme()
 
-        theme._set_xml_writer(self._filename('xl/theme/theme1.xml'))
+        theme._set_xml_writer(self._filename("xl/theme/theme1.xml"))
         theme._assemble_xml_file()
 
     def _write_table_files(self):
         # Write the table files.
         index = 1
         for worksheet in self.workbook.worksheets():
             table_props = worksheet.tables
 
             if not table_props:
                 continue
 
             for table_props in table_props:
                 table = Table()
-                table._set_xml_writer(self._filename('xl/tables/table'
-                                                     + str(index) + '.xml'))
+                table._set_xml_writer(
+                    self._filename("xl/tables/table" + str(index) + ".xml")
+                )
                 table._set_properties(table_props)
                 table._assemble_xml_file()
                 index += 1
 
     def _get_table_count(self):
         # Count the table files. Required for the [Content_Types] file.
         for worksheet in self.workbook.worksheets():
             for table_props in worksheet.tables:
                 self.table_count += 1
 
     def _write_root_rels_file(self):
         # Write the _rels/.rels xml file.
         rels = Relationships()
 
-        rels._add_document_relationship('/officeDocument', 'xl/workbook.xml')
+        rels._add_document_relationship("/officeDocument", "xl/workbook.xml")
 
-        rels._add_package_relationship('/metadata/core-properties',
-                                       'docProps/core.xml')
+        rels._add_package_relationship("/metadata/core-properties", "docProps/core.xml")
 
-        rels._add_document_relationship('/extended-properties',
-                                        'docProps/app.xml')
+        rels._add_document_relationship("/extended-properties", "docProps/app.xml")
 
         if self.workbook.custom_properties:
-            rels._add_document_relationship('/custom-properties',
-                                            'docProps/custom.xml')
+            rels._add_document_relationship("/custom-properties", "docProps/custom.xml")
 
-        rels._set_xml_writer(self._filename('_rels/.rels'))
+        rels._set_xml_writer(self._filename("_rels/.rels"))
 
         rels._assemble_xml_file()
 
     def _write_workbook_rels_file(self):
         # Write the _rels/.rels xml file.
         rels = Relationships()
 
         worksheet_index = 1
         chartsheet_index = 1
 
         for worksheet in self.workbook.worksheets():
             if worksheet.is_chartsheet:
-                rels._add_document_relationship('/chartsheet',
-                                                'chartsheets/sheet'
-                                                + str(chartsheet_index)
-                                                + '.xml')
+                rels._add_document_relationship(
+                    "/chartsheet", "chartsheets/sheet" + str(chartsheet_index) + ".xml"
+                )
                 chartsheet_index += 1
             else:
-                rels._add_document_relationship('/worksheet',
-                                                'worksheets/sheet'
-                                                + str(worksheet_index)
-                                                + '.xml')
+                rels._add_document_relationship(
+                    "/worksheet", "worksheets/sheet" + str(worksheet_index) + ".xml"
+                )
                 worksheet_index += 1
 
-        rels._add_document_relationship('/theme', 'theme/theme1.xml')
-        rels._add_document_relationship('/styles', 'styles.xml')
+        rels._add_document_relationship("/theme", "theme/theme1.xml")
+        rels._add_document_relationship("/styles", "styles.xml")
 
         # Add the sharedString rel if there is string data in the workbook.
         if self.workbook.str_table.count:
-            rels._add_document_relationship('/sharedStrings',
-                                            'sharedStrings.xml')
+            rels._add_document_relationship("/sharedStrings", "sharedStrings.xml")
 
         # Add vbaProject if present.
         if self.workbook.vba_project:
-            rels._add_ms_package_relationship('/vbaProject', 'vbaProject.bin')
+            rels._add_ms_package_relationship("/vbaProject", "vbaProject.bin")
 
         # Add the metadata file if required.
         if self.workbook.has_metadata:
-            rels._add_document_relationship('/sheetMetadata', 'metadata.xml')
+            rels._add_document_relationship("/sheetMetadata", "metadata.xml")
 
-        rels._set_xml_writer(self._filename('xl/_rels/workbook.xml.rels'))
+        rels._set_xml_writer(self._filename("xl/_rels/workbook.xml.rels"))
         rels._assemble_xml_file()
 
     def _write_worksheet_rels_files(self):
         # Write data such as hyperlinks or drawings.
         index = 0
         for worksheet in self.workbook.worksheets():
-
             if worksheet.is_chartsheet:
                 continue
 
             index += 1
 
-            external_links = (worksheet.external_hyper_links +
-                              worksheet.external_drawing_links +
-                              worksheet.external_vml_links +
-                              worksheet.external_background_links +
-                              worksheet.external_table_links +
-                              worksheet.external_comment_links)
+            external_links = (
+                worksheet.external_hyper_links
+                + worksheet.external_drawing_links
+                + worksheet.external_vml_links
+                + worksheet.external_background_links
+                + worksheet.external_table_links
+                + worksheet.external_comment_links
+            )
 
             if not external_links:
                 continue
 
             # Create the worksheet .rels dirs.
             rels = Relationships()
 
             for link_data in external_links:
                 rels._add_worksheet_relationship(*link_data)
 
             # Create .rels file such as /xl/worksheets/_rels/sheet1.xml.rels.
-            rels._set_xml_writer(self._filename('xl/worksheets/_rels/sheet'
-                                                + str(index) + '.xml.rels'))
+            rels._set_xml_writer(
+                self._filename("xl/worksheets/_rels/sheet" + str(index) + ".xml.rels")
+            )
             rels._assemble_xml_file()
 
     def _write_chartsheet_rels_files(self):
         # Write the chartsheet .rels files for links to drawing files.
         index = 0
         for worksheet in self.workbook.worksheets():
-
             if not worksheet.is_chartsheet:
                 continue
 
             index += 1
 
             external_links = worksheet.external_drawing_links
 
@@ -573,16 +582,17 @@
             # Create the chartsheet .rels xlsx_dir.
             rels = Relationships()
 
             for link_data in external_links:
                 rels._add_worksheet_relationship(*link_data)
 
             # Create .rels file such as /xl/chartsheets/_rels/sheet1.xml.rels.
-            rels._set_xml_writer(self._filename('xl/chartsheets/_rels/sheet'
-                                                + str(index) + '.xml.rels'))
+            rels._set_xml_writer(
+                self._filename("xl/chartsheets/_rels/sheet" + str(index) + ".xml.rels")
+            )
             rels._assemble_xml_file()
 
     def _write_drawing_rels_files(self):
         # Write the drawing .rels files for worksheets with charts or drawings.
         index = 0
         for worksheet in self.workbook.worksheets():
             if worksheet.drawing:
@@ -594,71 +604,73 @@
             # Create the drawing .rels xlsx_dir.
             rels = Relationships()
 
             for drawing_data in worksheet.drawing_links:
                 rels._add_document_relationship(*drawing_data)
 
             # Create .rels file such as /xl/drawings/_rels/sheet1.xml.rels.
-            rels._set_xml_writer(self._filename('xl/drawings/_rels/drawing'
-                                                + str(index) + '.xml.rels'))
+            rels._set_xml_writer(
+                self._filename("xl/drawings/_rels/drawing" + str(index) + ".xml.rels")
+            )
             rels._assemble_xml_file()
 
     def _write_vml_drawing_rels_file(self, worksheet, index):
         # Write the vmlDdrawing .rels files for worksheets with images in
         # headers or footers.
 
         # Create the drawing .rels dir.
         rels = Relationships()
 
         for drawing_data in worksheet.vml_drawing_links:
             rels._add_document_relationship(*drawing_data)
 
         # Create .rels file such as /xl/drawings/_rels/vmlDrawing1.vml.rels.
-        rels._set_xml_writer(self._filename('xl/drawings/_rels/vmlDrawing'
-                                            + str(index)
-                                            + '.vml.rels'))
+        rels._set_xml_writer(
+            self._filename("xl/drawings/_rels/vmlDrawing" + str(index) + ".vml.rels")
+        )
         rels._assemble_xml_file()
 
     def _add_image_files(self):
         # Write the /xl/media/image?.xml files.
         workbook = self.workbook
         index = 1
 
         for image in workbook.images:
             filename = image[0]
-            ext = '.' + image[1]
+            ext = "." + image[1]
             image_data = image[2]
 
-            xml_image_name = 'xl/media/image' + str(index) + ext
+            xml_image_name = "xl/media/image" + str(index) + ext
 
             if not self.in_memory:
                 # In file mode we just write or copy the image file.
                 os_filename = self._filename(xml_image_name)
 
                 if image_data:
                     # The data is in a byte stream. Write it to the target.
-                    os_file = open(os_filename, mode='wb')
+                    os_file = open(os_filename, mode="wb")
                     os_file.write(image_data.getvalue())
                     os_file.close()
                 else:
                     copy(filename, os_filename)
 
                     # Allow copies of Windows read-only images to be deleted.
                     try:
-                        os.chmod(os_filename,
-                                 os.stat(os_filename).st_mode | stat.S_IWRITE)
+                        os.chmod(
+                            os_filename, os.stat(os_filename).st_mode | stat.S_IWRITE
+                        )
                     except OSError:
                         pass
             else:
                 # For in-memory mode we read the image into a stream.
                 if image_data:
                     # The data is already in a byte stream.
                     os_filename = image_data
                 else:
-                    image_file = open(filename, mode='rb')
+                    image_file = open(filename, mode="rb")
                     image_data = image_file.read()
                     os_filename = BytesIO(image_data)
                     image_file.close()
 
                 self.filenames.append((os_filename, xml_image_name, True))
 
             index += 1
@@ -667,33 +679,33 @@
         # Copy in a vbaProject.bin file.
         vba_project = self.workbook.vba_project
         vba_is_stream = self.workbook.vba_is_stream
 
         if not vba_project:
             return
 
-        xml_vba_name = 'xl/vbaProject.bin'
+        xml_vba_name = "xl/vbaProject.bin"
 
         if not self.in_memory:
             # In file mode we just write or copy the VBA file.
             os_filename = self._filename(xml_vba_name)
 
             if vba_is_stream:
                 # The data is in a byte stream. Write it to the target.
-                os_file = open(os_filename, mode='wb')
+                os_file = open(os_filename, mode="wb")
                 os_file.write(vba_project.getvalue())
                 os_file.close()
             else:
                 copy(vba_project, os_filename)
 
         else:
             # For in-memory mode we read the vba into a stream.
             if vba_is_stream:
                 # The data is already in a byte stream.
                 os_filename = vba_project
             else:
-                vba_file = open(vba_project, mode='rb')
+                vba_file = open(vba_project, mode="rb")
                 vba_data = vba_file.read()
                 os_filename = BytesIO(vba_data)
                 vba_file.close()
 
             self.filenames.append((os_filename, xml_vba_name, True))
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/relationships.py` & `XlsxWriter-3.1.0/xlsxwriter/relationships.py`

 * *Files 16% similar despite different names*

```diff
@@ -6,17 +6,17 @@
 # Copyright 2013-2023, John McNamara, jmcnamara@cpan.org
 #
 
 # Package imports.
 from . import xmlwriter
 
 # Long namespace strings used in the class.
-schema_root = 'http://schemas.openxmlformats.org'
-package_schema = schema_root + '/package/2006/relationships'
-document_schema = schema_root + '/officeDocument/2006/relationships'
+schema_root = "http://schemas.openxmlformats.org"
+package_schema = schema_root + "/package/2006/relationships"
+document_schema = schema_root + "/officeDocument/2006/relationships"
 
 
 class Relationships(xmlwriter.XMLwriter):
     """
     A class for writing the Excel XLSX Relationships file.
 
 
@@ -66,15 +66,15 @@
         # Add container relationship to XLSX .rels xml files.
         rel_type = package_schema + rel_type
 
         self.relationships.append((rel_type, target, None))
 
     def _add_ms_package_relationship(self, rel_type, target):
         # Add container relationship to XLSX .rels xml files. Uses MS schema.
-        schema = 'http://schemas.microsoft.com/office/2006/relationships'
+        schema = "http://schemas.microsoft.com/office/2006/relationships"
         rel_type = schema + rel_type
 
         self.relationships.append((rel_type, target, None))
 
     def _add_worksheet_relationship(self, rel_type, target, target_mode=None):
         # Add worksheet relationship to sheet.rels xml files.
         rel_type = document_schema + rel_type
@@ -85,32 +85,37 @@
     #
     # XML methods.
     #
     ###########################################################################
 
     def _write_relationships(self):
         # Write the <Relationships> element.
-        attributes = [('xmlns', package_schema,)]
+        attributes = [
+            (
+                "xmlns",
+                package_schema,
+            )
+        ]
 
-        self._xml_start_tag('Relationships', attributes)
+        self._xml_start_tag("Relationships", attributes)
 
         for relationship in self.relationships:
             self._write_relationship(relationship)
 
-        self._xml_end_tag('Relationships')
+        self._xml_end_tag("Relationships")
 
     def _write_relationship(self, relationship):
         # Write the <Relationship> element.
         rel_type, target, target_mode = relationship
 
         attributes = [
-            ('Id', 'rId' + str(self.id)),
-            ('Type', rel_type),
-            ('Target', target),
+            ("Id", "rId" + str(self.id)),
+            ("Type", rel_type),
+            ("Target", target),
         ]
 
         self.id += 1
 
         if target_mode:
-            attributes.append(('TargetMode', target_mode))
+            attributes.append(("TargetMode", target_mode))
 
-        self._xml_empty_tag('Relationship', attributes)
+        self._xml_empty_tag("Relationship", attributes)
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/shape.py` & `XlsxWriter-3.1.0/xlsxwriter/shape.py`

 * *Files 14% similar despite different names*

```diff
@@ -28,27 +28,27 @@
 
         """
         super(Shape, self).__init__()
         self.name = name
         self.shape_type = shape_type
         self.connect = 0
         self.drawing = 0
-        self.edit_as = ''
+        self.edit_as = ""
         self.id = 0
-        self.text = ''
-        self.textlink = ''
+        self.text = ""
+        self.textlink = ""
         self.stencil = 1
         self.element = -1
         self.start = None
         self.start_index = None
         self.end = None
         self.end_index = None
         self.adjustments = []
-        self.start_side = ''
-        self.end_side = ''
+        self.start_side = ""
+        self.end_side = ""
         self.flip_h = 0
         self.flip_v = 0
         self.rotation = 0
         self.text_rotation = 0
         self.textbox = False
 
         self.align = None
@@ -64,29 +64,28 @@
     ###########################################################################
     #
     # Private API.
     #
     ###########################################################################
 
     def _set_options(self, options):
+        self.align = self._get_align_properties(options.get("align"))
+        self.fill = self._get_fill_properties(options.get("fill"))
+        self.font = self._get_font_properties(options.get("font"))
+        self.gradient = self._get_gradient_properties(options.get("gradient"))
+        self.line = self._get_line_properties(options.get("line"))
+
+        self.text_rotation = options.get("text_rotation", 0)
+
+        self.textlink = options.get("textlink", "")
+        if self.textlink.startswith("="):
+            self.textlink = self.textlink.lstrip("=")
 
-        self.align = self._get_align_properties(options.get('align'))
-        self.fill = self._get_fill_properties(options.get('fill'))
-        self.font = self._get_font_properties(options.get('font'))
-        self.gradient = self._get_gradient_properties(options.get('gradient'))
-        self.line = self._get_line_properties(options.get('line'))
-
-        self.text_rotation = options.get('text_rotation', 0)
-
-        self.textlink = options.get('textlink', '')
-        if self.textlink.startswith('='):
-            self.textlink = self.textlink.lstrip('=')
-
-        if options.get('border'):
-            self.line = self._get_line_properties(options['border'])
+        if options.get("border"):
+            self.line = self._get_line_properties(options["border"])
 
         # Gradient fill overrides solid fill.
         if self.gradient:
             self.fill = None
 
     ###########################################################################
     #
@@ -95,325 +94,323 @@
     ###########################################################################
 
     @staticmethod
     def _get_line_properties(line):
         # Convert user line properties to the structure required internally.
 
         if not line:
-            return {'defined': False}
+            return {"defined": False}
 
         # Copy the user defined properties since they will be modified.
         line = copy.deepcopy(line)
 
         dash_types = {
-            'solid': 'solid',
-            'round_dot': 'sysDot',
-            'square_dot': 'sysDash',
-            'dash': 'dash',
-            'dash_dot': 'dashDot',
-            'long_dash': 'lgDash',
-            'long_dash_dot': 'lgDashDot',
-            'long_dash_dot_dot': 'lgDashDotDot',
-            'dot': 'dot',
-            'system_dash_dot': 'sysDashDot',
-            'system_dash_dot_dot': 'sysDashDotDot',
+            "solid": "solid",
+            "round_dot": "sysDot",
+            "square_dot": "sysDash",
+            "dash": "dash",
+            "dash_dot": "dashDot",
+            "long_dash": "lgDash",
+            "long_dash_dot": "lgDashDot",
+            "long_dash_dot_dot": "lgDashDotDot",
+            "dot": "dot",
+            "system_dash_dot": "sysDashDot",
+            "system_dash_dot_dot": "sysDashDotDot",
         }
 
         # Check the dash type.
-        dash_type = line.get('dash_type')
+        dash_type = line.get("dash_type")
 
         if dash_type is not None:
             if dash_type in dash_types:
-                line['dash_type'] = dash_types[dash_type]
+                line["dash_type"] = dash_types[dash_type]
             else:
                 warn("Unknown dash type '%s'" % dash_type)
                 return
 
-        line['defined'] = True
+        line["defined"] = True
 
         return line
 
     @staticmethod
     def _get_fill_properties(fill):
         # Convert user fill properties to the structure required internally.
 
         if not fill:
-            return {'defined': False}
+            return {"defined": False}
 
         # Copy the user defined properties since they will be modified.
         fill = copy.deepcopy(fill)
 
-        fill['defined'] = True
+        fill["defined"] = True
 
         return fill
 
     @staticmethod
     def _get_pattern_properties(pattern):
         # Convert user defined pattern to the structure required internally.
 
         if not pattern:
             return
 
         # Copy the user defined properties since they will be modified.
         pattern = copy.deepcopy(pattern)
 
-        if not pattern.get('pattern'):
+        if not pattern.get("pattern"):
             warn("Pattern must include 'pattern'")
             return
 
-        if not pattern.get('fg_color'):
+        if not pattern.get("fg_color"):
             warn("Pattern must include 'fg_color'")
             return
 
         types = {
-            'percent_5': 'pct5',
-            'percent_10': 'pct10',
-            'percent_20': 'pct20',
-            'percent_25': 'pct25',
-            'percent_30': 'pct30',
-            'percent_40': 'pct40',
-            'percent_50': 'pct50',
-            'percent_60': 'pct60',
-            'percent_70': 'pct70',
-            'percent_75': 'pct75',
-            'percent_80': 'pct80',
-            'percent_90': 'pct90',
-            'light_downward_diagonal': 'ltDnDiag',
-            'light_upward_diagonal': 'ltUpDiag',
-            'dark_downward_diagonal': 'dkDnDiag',
-            'dark_upward_diagonal': 'dkUpDiag',
-            'wide_downward_diagonal': 'wdDnDiag',
-            'wide_upward_diagonal': 'wdUpDiag',
-            'light_vertical': 'ltVert',
-            'light_horizontal': 'ltHorz',
-            'narrow_vertical': 'narVert',
-            'narrow_horizontal': 'narHorz',
-            'dark_vertical': 'dkVert',
-            'dark_horizontal': 'dkHorz',
-            'dashed_downward_diagonal': 'dashDnDiag',
-            'dashed_upward_diagonal': 'dashUpDiag',
-            'dashed_horizontal': 'dashHorz',
-            'dashed_vertical': 'dashVert',
-            'small_confetti': 'smConfetti',
-            'large_confetti': 'lgConfetti',
-            'zigzag': 'zigZag',
-            'wave': 'wave',
-            'diagonal_brick': 'diagBrick',
-            'horizontal_brick': 'horzBrick',
-            'weave': 'weave',
-            'plaid': 'plaid',
-            'divot': 'divot',
-            'dotted_grid': 'dotGrid',
-            'dotted_diamond': 'dotDmnd',
-            'shingle': 'shingle',
-            'trellis': 'trellis',
-            'sphere': 'sphere',
-            'small_grid': 'smGrid',
-            'large_grid': 'lgGrid',
-            'small_check': 'smCheck',
-            'large_check': 'lgCheck',
-            'outlined_diamond': 'openDmnd',
-            'solid_diamond': 'solidDmnd',
+            "percent_5": "pct5",
+            "percent_10": "pct10",
+            "percent_20": "pct20",
+            "percent_25": "pct25",
+            "percent_30": "pct30",
+            "percent_40": "pct40",
+            "percent_50": "pct50",
+            "percent_60": "pct60",
+            "percent_70": "pct70",
+            "percent_75": "pct75",
+            "percent_80": "pct80",
+            "percent_90": "pct90",
+            "light_downward_diagonal": "ltDnDiag",
+            "light_upward_diagonal": "ltUpDiag",
+            "dark_downward_diagonal": "dkDnDiag",
+            "dark_upward_diagonal": "dkUpDiag",
+            "wide_downward_diagonal": "wdDnDiag",
+            "wide_upward_diagonal": "wdUpDiag",
+            "light_vertical": "ltVert",
+            "light_horizontal": "ltHorz",
+            "narrow_vertical": "narVert",
+            "narrow_horizontal": "narHorz",
+            "dark_vertical": "dkVert",
+            "dark_horizontal": "dkHorz",
+            "dashed_downward_diagonal": "dashDnDiag",
+            "dashed_upward_diagonal": "dashUpDiag",
+            "dashed_horizontal": "dashHorz",
+            "dashed_vertical": "dashVert",
+            "small_confetti": "smConfetti",
+            "large_confetti": "lgConfetti",
+            "zigzag": "zigZag",
+            "wave": "wave",
+            "diagonal_brick": "diagBrick",
+            "horizontal_brick": "horzBrick",
+            "weave": "weave",
+            "plaid": "plaid",
+            "divot": "divot",
+            "dotted_grid": "dotGrid",
+            "dotted_diamond": "dotDmnd",
+            "shingle": "shingle",
+            "trellis": "trellis",
+            "sphere": "sphere",
+            "small_grid": "smGrid",
+            "large_grid": "lgGrid",
+            "small_check": "smCheck",
+            "large_check": "lgCheck",
+            "outlined_diamond": "openDmnd",
+            "solid_diamond": "solidDmnd",
         }
 
         # Check for valid types.
-        if not pattern['pattern'] in types:
-            warn("unknown pattern type '%s'" % pattern['pattern'])
+        if pattern["pattern"] not in types:
+            warn("unknown pattern type '%s'" % pattern["pattern"])
             return
         else:
-            pattern['pattern'] = types[pattern['pattern']]
+            pattern["pattern"] = types[pattern["pattern"]]
 
         # Specify a default background color.
-        pattern['bg_color'] = pattern.get('bg_color', '#FFFFFF')
+        pattern["bg_color"] = pattern.get("bg_color", "#FFFFFF")
 
         return pattern
 
     @staticmethod
     def _get_gradient_properties(gradient):
         # Convert user defined gradient to the structure required internally.
 
         if not gradient:
             return
 
         # Copy the user defined properties since they will be modified.
         gradient = copy.deepcopy(gradient)
 
         types = {
-            'linear': 'linear',
-            'radial': 'circle',
-            'rectangular': 'rect',
-            'path': 'shape'
+            "linear": "linear",
+            "radial": "circle",
+            "rectangular": "rect",
+            "path": "shape",
         }
 
         # Check the colors array exists and is valid.
-        if 'colors' not in gradient or type(gradient['colors']) != list:
+        if "colors" not in gradient or type(gradient["colors"]) != list:
             warn("Gradient must include colors list")
             return
 
         # Check the colors array has the required number of entries.
-        if not 2 <= len(gradient['colors']) <= 10:
-            warn("Gradient colors list must at least 2 values "
-                 "and not more than 10")
+        if not 2 <= len(gradient["colors"]) <= 10:
+            warn("Gradient colors list must at least 2 values " "and not more than 10")
             return
 
-        if 'positions' in gradient:
+        if "positions" in gradient:
             # Check the positions array has the right number of entries.
-            if len(gradient['positions']) != len(gradient['colors']):
+            if len(gradient["positions"]) != len(gradient["colors"]):
                 warn("Gradient positions not equal to number of colors")
                 return
 
             # Check the positions are in the correct range.
-            for pos in gradient['positions']:
+            for pos in gradient["positions"]:
                 if not 0 <= pos <= 100:
-                    warn("Gradient position must be in the range "
-                         "0 <= position <= 100")
+                    warn(
+                        "Gradient position must be in the range " "0 <= position <= 100"
+                    )
                     return
         else:
             # Use the default gradient positions.
-            if len(gradient['colors']) == 2:
-                gradient['positions'] = [0, 100]
+            if len(gradient["colors"]) == 2:
+                gradient["positions"] = [0, 100]
 
-            elif len(gradient['colors']) == 3:
-                gradient['positions'] = [0, 50, 100]
+            elif len(gradient["colors"]) == 3:
+                gradient["positions"] = [0, 50, 100]
 
-            elif len(gradient['colors']) == 4:
-                gradient['positions'] = [0, 33, 66, 100]
+            elif len(gradient["colors"]) == 4:
+                gradient["positions"] = [0, 33, 66, 100]
 
             else:
                 warn("Must specify gradient positions")
                 return
 
-        angle = gradient.get('angle')
+        angle = gradient.get("angle")
         if angle:
             if not 0 <= angle < 360:
-                warn("Gradient angle must be in the range "
-                     "0 <= angle < 360")
+                warn("Gradient angle must be in the range " "0 <= angle < 360")
                 return
         else:
-            gradient['angle'] = 90
+            gradient["angle"] = 90
 
         # Check for valid types.
-        gradient_type = gradient.get('type')
+        gradient_type = gradient.get("type")
 
         if gradient_type is not None:
-
             if gradient_type in types:
-                gradient['type'] = types[gradient_type]
+                gradient["type"] = types[gradient_type]
             else:
                 warn("Unknown gradient type '%s" % gradient_type)
                 return
         else:
-            gradient['type'] = 'linear'
+            gradient["type"] = "linear"
 
         return gradient
 
     @staticmethod
     def _get_font_properties(options):
         # Convert user defined font values into private dict values.
         if options is None:
             options = {}
 
         font = {
-            'name': options.get('name'),
-            'color': options.get('color'),
-            'size': options.get('size', 11),
-            'bold': options.get('bold'),
-            'italic': options.get('italic'),
-            'underline': options.get('underline'),
-            'pitch_family': options.get('pitch_family'),
-            'charset': options.get('charset'),
-            'baseline': options.get('baseline', -1),
-            'lang': options.get('lang', 'en-US'),
+            "name": options.get("name"),
+            "color": options.get("color"),
+            "size": options.get("size", 11),
+            "bold": options.get("bold"),
+            "italic": options.get("italic"),
+            "underline": options.get("underline"),
+            "pitch_family": options.get("pitch_family"),
+            "charset": options.get("charset"),
+            "baseline": options.get("baseline", -1),
+            "lang": options.get("lang", "en-US"),
         }
 
         # Convert font size units.
-        if font['size']:
-            font['size'] = int(font['size'] * 100)
+        if font["size"]:
+            font["size"] = int(font["size"] * 100)
 
         return font
 
     @staticmethod
     def _get_font_style_attributes(font):
         # _get_font_style_attributes.
         attributes = []
 
         if not font:
             return attributes
 
-        if font.get('size'):
-            attributes.append(('sz', font['size']))
+        if font.get("size"):
+            attributes.append(("sz", font["size"]))
 
-        if font.get('bold') is not None:
-            attributes.append(('b', 0 + font['bold']))
+        if font.get("bold") is not None:
+            attributes.append(("b", 0 + font["bold"]))
 
-        if font.get('italic') is not None:
-            attributes.append(('i', 0 + font['italic']))
+        if font.get("italic") is not None:
+            attributes.append(("i", 0 + font["italic"]))
 
-        if font.get('underline') is not None:
-            attributes.append(('u', 'sng'))
+        if font.get("underline") is not None:
+            attributes.append(("u", "sng"))
 
-        if font.get('baseline') != -1:
-            attributes.append(('baseline', font['baseline']))
+        if font.get("baseline") != -1:
+            attributes.append(("baseline", font["baseline"]))
 
         return attributes
 
     @staticmethod
     def _get_font_latin_attributes(font):
         # _get_font_latin_attributes.
         attributes = []
 
         if not font:
             return attributes
 
-        if font['name'] is not None:
-            attributes.append(('typeface', font['name']))
+        if font["name"] is not None:
+            attributes.append(("typeface", font["name"]))
 
-        if font['pitch_family'] is not None:
-            attributes.append(('pitchFamily', font['pitch_family']))
+        if font["pitch_family"] is not None:
+            attributes.append(("pitchFamily", font["pitch_family"]))
 
-        if font['charset'] is not None:
-            attributes.append(('charset', font['charset']))
+        if font["charset"] is not None:
+            attributes.append(("charset", font["charset"]))
 
         return attributes
 
     @staticmethod
     def _get_align_properties(align):
         # Convert user defined align to the structure required internally.
         if not align:
-            return {'defined': False}
+            return {"defined": False}
 
         # Copy the user defined properties since they will be modified.
         align = copy.deepcopy(align)
 
-        if 'vertical' in align:
-            align_type = align['vertical']
+        if "vertical" in align:
+            align_type = align["vertical"]
 
             align_types = {
-                'top': 'top',
-                'middle': 'middle',
-                'bottom': 'bottom',
+                "top": "top",
+                "middle": "middle",
+                "bottom": "bottom",
             }
 
             if align_type in align_types:
-                align['vertical'] = align_types[align_type]
+                align["vertical"] = align_types[align_type]
             else:
                 warn("Unknown alignment type '%s'" % align_type)
-                return {'defined': False}
+                return {"defined": False}
 
-        if 'horizontal' in align:
-            align_type = align['horizontal']
+        if "horizontal" in align:
+            align_type = align["horizontal"]
 
             align_types = {
-                'left': 'left',
-                'center': 'center',
-                'right': 'right',
+                "left": "left",
+                "center": "center",
+                "right": "right",
             }
 
             if align_type in align_types:
-                align['horizontal'] = align_types[align_type]
+                align["horizontal"] = align_types[align_type]
             else:
                 warn("Unknown alignment type '%s'" % align_type)
-                return {'defined': False}
+                return {"defined": False}
 
-        align['defined'] = True
+        align["defined"] = True
 
         return align
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/sharedstrings.py` & `XlsxWriter-3.1.0/xlsxwriter/sharedstrings.py`

 * *Files 4% similar despite different names*

```diff
@@ -10,16 +10,16 @@
 import re
 
 # Package imports.
 from . import xmlwriter
 from .utility import preserve_whitespace
 
 # Compile performance critical regular expressions.
-re_control_chars_1 = re.compile('(_x[0-9a-fA-F]{4}_)')
-re_control_chars_2 = re.compile(r'([\x00-\x08\x0b-\x1f])')
+re_control_chars_1 = re.compile("(_x[0-9a-fA-F]{4}_)")
+re_control_chars_2 = re.compile(r"([\x00-\x08\x0b-\x1f])")
 
 
 class SharedStrings(xmlwriter.XMLwriter):
     """
     A class for writing the Excel XLSX sharedStrings file.
 
     """
@@ -55,69 +55,70 @@
         # Write the sst element.
         self._write_sst()
 
         # Write the sst strings.
         self._write_sst_strings()
 
         # Close the sst tag.
-        self._xml_end_tag('sst')
+        self._xml_end_tag("sst")
 
         # Close the file.
         self._xml_close()
 
     ###########################################################################
     #
     # XML methods.
     #
     ###########################################################################
 
     def _write_sst(self):
         # Write the <sst> element.
-        xmlns = 'http://schemas.openxmlformats.org/spreadsheetml/2006/main'
+        xmlns = "http://schemas.openxmlformats.org/spreadsheetml/2006/main"
 
         attributes = [
-            ('xmlns', xmlns),
-            ('count', self.string_table.count),
-            ('uniqueCount', self.string_table.unique_count),
+            ("xmlns", xmlns),
+            ("count", self.string_table.count),
+            ("uniqueCount", self.string_table.unique_count),
         ]
 
-        self._xml_start_tag('sst', attributes)
+        self._xml_start_tag("sst", attributes)
 
     def _write_sst_strings(self):
         # Write the sst string elements.
 
-        for string in (self.string_table.string_array):
+        for string in self.string_table.string_array:
             self._write_si(string)
 
     def _write_si(self, string):
         # Write the <si> element.
         attributes = []
 
         # Excel escapes control characters with _xHHHH_ and also escapes any
         # literal strings of that type by encoding the leading underscore.
         # So "\0" -> _x0000_ and "_x0000_" -> _x005F_x0000_.
         # The following substitutions deal with those cases.
 
         # Escape the escape.
-        string = re_control_chars_1.sub(r'_x005F\1', string)
+        string = re_control_chars_1.sub(r"_x005F\1", string)
 
         # Convert control character to the _xHHHH_ escape.
-        string = re_control_chars_2.sub(lambda match: "_x%04X_" %
-                                        ord(match.group(1)), string)
+        string = re_control_chars_2.sub(
+            lambda match: "_x%04X_" % ord(match.group(1)), string
+        )
 
         # Escapes non characters in strings.
-        string = string.replace('\uFFFE', '_xFFFE_')
-        string = string.replace('\uFFFF', '_xFFFF_')
+        string = string.replace("\uFFFE", "_xFFFE_")
+        string = string.replace("\uFFFF", "_xFFFF_")
 
         # Add attribute to preserve leading or trailing whitespace.
         if preserve_whitespace(string):
-            attributes.append(('xml:space', 'preserve'))
+            attributes.append(("xml:space", "preserve"))
 
         # Write any rich strings without further tags.
-        if string.startswith('<r>') and string.endswith('</r>'):
+        if string.startswith("<r>") and string.endswith("</r>"):
             self._xml_rich_si_element(string)
         else:
             self._xml_si_element(string, attributes)
 
 
 # A metadata class to store Excel strings between worksheets.
 class SharedStringTable(object):
@@ -129,30 +130,29 @@
     def __init__(self):
         self.count = 0
         self.unique_count = 0
         self.string_table = {}
         self.string_array = []
 
     def _get_shared_string_index(self, string):
-        """" Get the index of the string in the Shared String table. """
+        """ " Get the index of the string in the Shared String table."""
         if string not in self.string_table:
             # String isn't already stored in the table so add it.
             index = self.unique_count
             self.string_table[string] = index
             self.count += 1
             self.unique_count += 1
             return index
         else:
             # String exists in the table.
             index = self.string_table[string]
             self.count += 1
             return index
 
     def _get_shared_string(self, index):
-        """" Get a shared string from the index. """
+        """ " Get a shared string from the index."""
         return self.string_array[index]
 
     def _sort_string_data(self):
-        """" Sort the shared string data and convert from dict to list. """
-        self.string_array = sorted(self.string_table,
-                                   key=self.string_table.__getitem__)
+        """ " Sort the shared string data and convert from dict to list."""
+        self.string_array = sorted(self.string_table, key=self.string_table.__getitem__)
         self.string_table = {}
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/styles.py` & `XlsxWriter-3.1.0/xlsxwriter/styles.py`

 * *Files 18% similar despite different names*

```diff
@@ -85,15 +85,15 @@
         # Write the tableStyles element.
         self._write_table_styles()
 
         # Write the colors element.
         self._write_colors()
 
         # Close the style sheet tag.
-        self._xml_end_tag('styleSheet')
+        self._xml_end_tag("styleSheet")
 
         # Close the file.
         self._xml_close()
 
     def _set_style_properties(self, properties):
         # Pass in the Format objects and other properties used in the styles.
 
@@ -104,255 +104,258 @@
         self.border_count = properties[4]
         self.fill_count = properties[5]
         self.custom_colors = properties[6]
         self.dxf_formats = properties[7]
         self.has_comments = properties[8]
 
     def _get_palette_color(self, color):
+        # Special handling for automatic color.
+        if color == "Automatic":
+            return color
+
         # Convert the RGB color.
-        if color[0] == '#':
+        if color[0] == "#":
             color = color[1:]
 
         return "FF" + color.upper()
 
     ###########################################################################
     #
     # XML methods.
     #
     ###########################################################################
 
     def _write_style_sheet(self):
         # Write the <styleSheet> element.
-        xmlns = 'http://schemas.openxmlformats.org/spreadsheetml/2006/main'
+        xmlns = "http://schemas.openxmlformats.org/spreadsheetml/2006/main"
 
-        attributes = [('xmlns', xmlns)]
-        self._xml_start_tag('styleSheet', attributes)
+        attributes = [("xmlns", xmlns)]
+        self._xml_start_tag("styleSheet", attributes)
 
     def _write_num_fmts(self):
         # Write the <numFmts> element.
         if not self.num_formats:
             return
 
-        attributes = [('count', len(self.num_formats))]
-        self._xml_start_tag('numFmts', attributes)
+        attributes = [("count", len(self.num_formats))]
+        self._xml_start_tag("numFmts", attributes)
 
         # Write the numFmts elements.
         for index, num_format in enumerate(self.num_formats, 164):
             self._write_num_fmt(index, num_format)
 
-        self._xml_end_tag('numFmts')
+        self._xml_end_tag("numFmts")
 
     def _write_num_fmt(self, num_fmt_id, format_code):
         # Write the <numFmt> element.
         format_codes = {
-            0: 'General',
-            1: '0',
-            2: '0.00',
-            3: '#,##0',
-            4: '#,##0.00',
-            5: '($#,##0_);($#,##0)',
-            6: '($#,##0_);[Red]($#,##0)',
-            7: '($#,##0.00_);($#,##0.00)',
-            8: '($#,##0.00_);[Red]($#,##0.00)',
-            9: '0%',
-            10: '0.00%',
-            11: '0.00E+00',
-            12: '# ?/?',
-            13: '# ??/??',
-            14: 'm/d/yy',
-            15: 'd-mmm-yy',
-            16: 'd-mmm',
-            17: 'mmm-yy',
-            18: 'h:mm AM/PM',
-            19: 'h:mm:ss AM/PM',
-            20: 'h:mm',
-            21: 'h:mm:ss',
-            22: 'm/d/yy h:mm',
-            37: '(#,##0_);(#,##0)',
-            38: '(#,##0_);[Red](#,##0)',
-            39: '(#,##0.00_);(#,##0.00)',
-            40: '(#,##0.00_);[Red](#,##0.00)',
+            0: "General",
+            1: "0",
+            2: "0.00",
+            3: "#,##0",
+            4: "#,##0.00",
+            5: "($#,##0_);($#,##0)",
+            6: "($#,##0_);[Red]($#,##0)",
+            7: "($#,##0.00_);($#,##0.00)",
+            8: "($#,##0.00_);[Red]($#,##0.00)",
+            9: "0%",
+            10: "0.00%",
+            11: "0.00E+00",
+            12: "# ?/?",
+            13: "# ??/??",
+            14: "m/d/yy",
+            15: "d-mmm-yy",
+            16: "d-mmm",
+            17: "mmm-yy",
+            18: "h:mm AM/PM",
+            19: "h:mm:ss AM/PM",
+            20: "h:mm",
+            21: "h:mm:ss",
+            22: "m/d/yy h:mm",
+            37: "(#,##0_);(#,##0)",
+            38: "(#,##0_);[Red](#,##0)",
+            39: "(#,##0.00_);(#,##0.00)",
+            40: "(#,##0.00_);[Red](#,##0.00)",
             41: '_(* #,##0_);_(* (#,##0);_(* "-"_);_(_)',
             42: '_($* #,##0_);_($* (#,##0);_($* "-"_);_(_)',
             43: '_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(_)',
             44: '_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(_)',
-            45: 'mm:ss',
-            46: '[h]:mm:ss',
-            47: 'mm:ss.0',
-            48: '##0.0E+0',
-            49: '@'}
+            45: "mm:ss",
+            46: "[h]:mm:ss",
+            47: "mm:ss.0",
+            48: "##0.0E+0",
+            49: "@",
+        }
 
         # Set the format code for built-in number formats.
         if num_fmt_id < 164:
             if num_fmt_id in format_codes:
                 format_code = format_codes[num_fmt_id]
             else:
-                format_code = 'General'
+                format_code = "General"
 
         attributes = [
-            ('numFmtId', num_fmt_id),
-            ('formatCode', format_code),
+            ("numFmtId", num_fmt_id),
+            ("formatCode", format_code),
         ]
 
-        self._xml_empty_tag('numFmt', attributes)
+        self._xml_empty_tag("numFmt", attributes)
 
     def _write_fonts(self):
         # Write the <fonts> element.
         if self.has_comments:
             # Add extra font for comments.
-            attributes = [('count', self.font_count + 1)]
+            attributes = [("count", self.font_count + 1)]
         else:
-            attributes = [('count', self.font_count)]
+            attributes = [("count", self.font_count)]
 
-        self._xml_start_tag('fonts', attributes)
+        self._xml_start_tag("fonts", attributes)
 
         # Write the font elements for xf_format objects that have them.
         for xf_format in self.xf_formats:
             if xf_format.has_font:
                 self._write_font(xf_format)
 
         if self.has_comments:
             self._write_comment_font()
 
-        self._xml_end_tag('fonts')
+        self._xml_end_tag("fonts")
 
     def _write_font(self, xf_format, is_dxf_format=False):
         # Write the <font> element.
-        self._xml_start_tag('font')
+        self._xml_start_tag("font")
 
         # The condense and extend elements are mainly used in dxf formats.
         if xf_format.font_condense:
             self._write_condense()
 
         if xf_format.font_extend:
             self._write_extend()
 
         if xf_format.bold:
-            self._xml_empty_tag('b')
+            self._xml_empty_tag("b")
 
         if xf_format.italic:
-            self._xml_empty_tag('i')
+            self._xml_empty_tag("i")
 
         if xf_format.font_strikeout:
-            self._xml_empty_tag('strike')
+            self._xml_empty_tag("strike")
 
         if xf_format.font_outline:
-            self._xml_empty_tag('outline')
+            self._xml_empty_tag("outline")
 
         if xf_format.font_shadow:
-            self._xml_empty_tag('shadow')
+            self._xml_empty_tag("shadow")
 
         # Handle the underline variants.
         if xf_format.underline:
             self._write_underline(xf_format.underline)
 
         if xf_format.font_script == 1:
-            self._write_vert_align('superscript')
+            self._write_vert_align("superscript")
 
         if xf_format.font_script == 2:
-            self._write_vert_align('subscript')
+            self._write_vert_align("subscript")
 
         if not is_dxf_format:
-            self._xml_empty_tag('sz', [('val', xf_format.font_size)])
+            self._xml_empty_tag("sz", [("val", xf_format.font_size)])
 
         if xf_format.theme == -1:
             # Ignore for excel2003_style.
             pass
         elif xf_format.theme:
-            self._write_color('theme', xf_format.theme)
+            self._write_color("theme", xf_format.theme)
         elif xf_format.color_indexed:
-            self._write_color('indexed', xf_format.color_indexed)
+            self._write_color("indexed", xf_format.color_indexed)
         elif xf_format.font_color:
             color = self._get_palette_color(xf_format.font_color)
-            self._write_color('rgb', color)
+            if color != "Automatic":
+                self._write_color("rgb", color)
         elif not is_dxf_format:
-            self._write_color('theme', 1)
+            self._write_color("theme", 1)
 
         if not is_dxf_format:
-            self._xml_empty_tag('name', [('val', xf_format.font_name)])
+            self._xml_empty_tag("name", [("val", xf_format.font_name)])
 
             if xf_format.font_family:
-                self._xml_empty_tag('family', [('val', xf_format.font_family)])
+                self._xml_empty_tag("family", [("val", xf_format.font_family)])
 
             if xf_format.font_charset:
-                self._xml_empty_tag('charset',
-                                    [('val', xf_format.font_charset)])
+                self._xml_empty_tag("charset", [("val", xf_format.font_charset)])
 
-            if xf_format.font_name == 'Calibri' and not xf_format.hyperlink:
-                self._xml_empty_tag(
-                    'scheme',
-                    [('val', xf_format.font_scheme)])
+            if xf_format.font_name == "Calibri" and not xf_format.hyperlink:
+                self._xml_empty_tag("scheme", [("val", xf_format.font_scheme)])
 
             if xf_format.hyperlink:
                 self.has_hyperlink = True
                 if self.hyperlink_font_id == 0:
                     self.hyperlink_font_id = xf_format.font_index
 
-        self._xml_end_tag('font')
+        self._xml_end_tag("font")
 
     def _write_comment_font(self):
         # Write the <font> element for comments.
-        self._xml_start_tag('font')
+        self._xml_start_tag("font")
 
-        self._xml_empty_tag('sz', [('val', 8)])
-        self._write_color('indexed', 81)
-        self._xml_empty_tag('name', [('val', 'Tahoma')])
-        self._xml_empty_tag('family', [('val', 2)])
+        self._xml_empty_tag("sz", [("val", 8)])
+        self._write_color("indexed", 81)
+        self._xml_empty_tag("name", [("val", "Tahoma")])
+        self._xml_empty_tag("family", [("val", 2)])
 
-        self._xml_end_tag('font')
+        self._xml_end_tag("font")
 
     def _write_underline(self, underline):
         # Write the underline font element.
 
         if underline == 2:
-            attributes = [('val', 'double')]
+            attributes = [("val", "double")]
         elif underline == 33:
-            attributes = [('val', 'singleAccounting')]
+            attributes = [("val", "singleAccounting")]
         elif underline == 34:
-            attributes = [('val', 'doubleAccounting')]
+            attributes = [("val", "doubleAccounting")]
         else:
             # Default to single underline.
             attributes = []
 
-        self._xml_empty_tag('u', attributes)
+        self._xml_empty_tag("u", attributes)
 
     def _write_vert_align(self, val):
         # Write the <vertAlign> font sub-element.
-        attributes = [('val', val)]
+        attributes = [("val", val)]
 
-        self._xml_empty_tag('vertAlign', attributes)
+        self._xml_empty_tag("vertAlign", attributes)
 
     def _write_color(self, name, value):
         # Write the <color> element.
         attributes = [(name, value)]
 
-        self._xml_empty_tag('color', attributes)
+        self._xml_empty_tag("color", attributes)
 
     def _write_fills(self):
         # Write the <fills> element.
-        attributes = [('count', self.fill_count)]
+        attributes = [("count", self.fill_count)]
 
-        self._xml_start_tag('fills', attributes)
+        self._xml_start_tag("fills", attributes)
 
         # Write the default fill element.
-        self._write_default_fill('none')
-        self._write_default_fill('gray125')
+        self._write_default_fill("none")
+        self._write_default_fill("gray125")
 
         # Write the fill elements for xf_format objects that have them.
         for xf_format in self.xf_formats:
             if xf_format.has_fill:
                 self._write_fill(xf_format)
 
-        self._xml_end_tag('fills')
+        self._xml_end_tag("fills")
 
     def _write_default_fill(self, pattern_type):
         # Write the <fill> element for the default fills.
-        self._xml_start_tag('fill')
-        self._xml_empty_tag('patternFill', [('patternType', pattern_type)])
-        self._xml_end_tag('fill')
+        self._xml_start_tag("fill")
+        self._xml_empty_tag("patternFill", [("patternType", pattern_type)])
+        self._xml_end_tag("fill")
 
     def _write_fill(self, xf_format, is_dxf_format=False):
         # Write the <fill> element.
         pattern = xf_format.pattern
         bg_color = xf_format.bg_color
         fg_color = xf_format.fg_color
 
@@ -360,404 +363,392 @@
         # since the normal xf_format reverses the meaning of BG and FG for
         # solid fills.
         if is_dxf_format:
             bg_color = xf_format.dxf_bg_color
             fg_color = xf_format.dxf_fg_color
 
         patterns = (
-            'none',
-            'solid',
-            'mediumGray',
-            'darkGray',
-            'lightGray',
-            'darkHorizontal',
-            'darkVertical',
-            'darkDown',
-            'darkUp',
-            'darkGrid',
-            'darkTrellis',
-            'lightHorizontal',
-            'lightVertical',
-            'lightDown',
-            'lightUp',
-            'lightGrid',
-            'lightTrellis',
-            'gray125',
-            'gray0625',
+            "none",
+            "solid",
+            "mediumGray",
+            "darkGray",
+            "lightGray",
+            "darkHorizontal",
+            "darkVertical",
+            "darkDown",
+            "darkUp",
+            "darkGrid",
+            "darkTrellis",
+            "lightHorizontal",
+            "lightVertical",
+            "lightDown",
+            "lightUp",
+            "lightGrid",
+            "lightTrellis",
+            "gray125",
+            "gray0625",
         )
 
         # Special handling for pattern only case.
         if not fg_color and not bg_color and patterns[pattern]:
             self._write_default_fill(patterns[pattern])
             return
 
-        self._xml_start_tag('fill')
+        self._xml_start_tag("fill")
 
         # The "none" pattern is handled differently for dxf formats.
         if is_dxf_format and pattern <= 1:
-            self._xml_start_tag('patternFill')
+            self._xml_start_tag("patternFill")
         else:
-            self._xml_start_tag(
-                'patternFill',
-                [('patternType', patterns[pattern])])
+            self._xml_start_tag("patternFill", [("patternType", patterns[pattern])])
 
         if fg_color:
             fg_color = self._get_palette_color(fg_color)
-            self._xml_empty_tag('fgColor', [('rgb', fg_color)])
+            if fg_color != "Automatic":
+                self._xml_empty_tag("fgColor", [("rgb", fg_color)])
 
         if bg_color:
             bg_color = self._get_palette_color(bg_color)
-            self._xml_empty_tag('bgColor', [('rgb', bg_color)])
+            if bg_color != "Automatic":
+                self._xml_empty_tag("bgColor", [("rgb", bg_color)])
         else:
             if not is_dxf_format and pattern <= 1:
-                self._xml_empty_tag('bgColor', [('indexed', 64)])
+                self._xml_empty_tag("bgColor", [("indexed", 64)])
 
-        self._xml_end_tag('patternFill')
-        self._xml_end_tag('fill')
+        self._xml_end_tag("patternFill")
+        self._xml_end_tag("fill")
 
     def _write_borders(self):
         # Write the <borders> element.
-        attributes = [('count', self.border_count)]
+        attributes = [("count", self.border_count)]
 
-        self._xml_start_tag('borders', attributes)
+        self._xml_start_tag("borders", attributes)
 
         # Write the border elements for xf_format objects that have them.
         for xf_format in self.xf_formats:
             if xf_format.has_border:
                 self._write_border(xf_format)
 
-        self._xml_end_tag('borders')
+        self._xml_end_tag("borders")
 
     def _write_border(self, xf_format, is_dxf_format=False):
         # Write the <border> element.
         attributes = []
 
         # Diagonal borders add attributes to the <border> element.
         if xf_format.diag_type == 1:
-            attributes.append(('diagonalUp', 1))
+            attributes.append(("diagonalUp", 1))
         elif xf_format.diag_type == 2:
-            attributes.append(('diagonalDown', 1))
+            attributes.append(("diagonalDown", 1))
         elif xf_format.diag_type == 3:
-            attributes.append(('diagonalUp', 1))
-            attributes.append(('diagonalDown', 1))
+            attributes.append(("diagonalUp", 1))
+            attributes.append(("diagonalDown", 1))
 
         # Ensure that a default diag border is set if the diag type is set.
         if xf_format.diag_type and not xf_format.diag_border:
             xf_format.diag_border = 1
 
         # Write the start border tag.
-        self._xml_start_tag('border', attributes)
+        self._xml_start_tag("border", attributes)
 
         # Write the <border> sub elements.
-        self._write_sub_border(
-            'left',
-            xf_format.left,
-            xf_format.left_color)
-
-        self._write_sub_border(
-            'right',
-            xf_format.right,
-            xf_format.right_color)
-
-        self._write_sub_border(
-            'top',
-            xf_format.top,
-            xf_format.top_color)
-
-        self._write_sub_border(
-            'bottom',
-            xf_format.bottom,
-            xf_format.bottom_color)
+        self._write_sub_border("left", xf_format.left, xf_format.left_color)
+
+        self._write_sub_border("right", xf_format.right, xf_format.right_color)
+
+        self._write_sub_border("top", xf_format.top, xf_format.top_color)
+
+        self._write_sub_border("bottom", xf_format.bottom, xf_format.bottom_color)
 
         # Condition DXF formats don't allow diagonal borders.
         if not is_dxf_format:
             self._write_sub_border(
-                'diagonal',
-                xf_format.diag_border,
-                xf_format.diag_color)
+                "diagonal", xf_format.diag_border, xf_format.diag_color
+            )
 
         if is_dxf_format:
-            self._write_sub_border('vertical', None, None)
-            self._write_sub_border('horizontal', None, None)
+            self._write_sub_border("vertical", None, None)
+            self._write_sub_border("horizontal", None, None)
 
-        self._xml_end_tag('border')
+        self._xml_end_tag("border")
 
     def _write_sub_border(self, border_type, style, color):
         # Write the <border> sub elements such as <right>, <top>, etc.
         attributes = []
 
         if not style:
             self._xml_empty_tag(border_type)
             return
 
         border_styles = (
-            'none',
-            'thin',
-            'medium',
-            'dashed',
-            'dotted',
-            'thick',
-            'double',
-            'hair',
-            'mediumDashed',
-            'dashDot',
-            'mediumDashDot',
-            'dashDotDot',
-            'mediumDashDotDot',
-            'slantDashDot',
+            "none",
+            "thin",
+            "medium",
+            "dashed",
+            "dotted",
+            "thick",
+            "double",
+            "hair",
+            "mediumDashed",
+            "dashDot",
+            "mediumDashDot",
+            "dashDotDot",
+            "mediumDashDotDot",
+            "slantDashDot",
         )
 
-        attributes.append(('style', border_styles[style]))
+        attributes.append(("style", border_styles[style]))
 
         self._xml_start_tag(border_type, attributes)
 
-        if color:
+        if color and color != "Automatic":
             color = self._get_palette_color(color)
-            self._xml_empty_tag('color', [('rgb', color)])
+            self._xml_empty_tag("color", [("rgb", color)])
         else:
-            self._xml_empty_tag('color', [('auto', 1)])
+            self._xml_empty_tag("color", [("auto", 1)])
 
         self._xml_end_tag(border_type)
 
     def _write_cell_style_xfs(self):
         # Write the <cellStyleXfs> element.
         count = 1
 
         if self.has_hyperlink:
             count = 2
 
-        attributes = [('count', count)]
+        attributes = [("count", count)]
 
-        self._xml_start_tag('cellStyleXfs', attributes)
+        self._xml_start_tag("cellStyleXfs", attributes)
         self._write_style_xf()
 
         if self.has_hyperlink:
             self._write_style_xf(True, self.hyperlink_font_id)
 
-        self._xml_end_tag('cellStyleXfs')
+        self._xml_end_tag("cellStyleXfs")
 
     def _write_cell_xfs(self):
         # Write the <cellXfs> element.
         formats = self.xf_formats
 
         # Workaround for when the last xf_format is used for the comment font
         # and shouldn't be used for cellXfs.
         last_format = formats[-1]
         if last_format.font_only:
             formats.pop()
 
-        attributes = [('count', len(formats))]
-        self._xml_start_tag('cellXfs', attributes)
+        attributes = [("count", len(formats))]
+        self._xml_start_tag("cellXfs", attributes)
 
         # Write the xf elements.
         for xf_format in formats:
             self._write_xf(xf_format)
 
-        self._xml_end_tag('cellXfs')
+        self._xml_end_tag("cellXfs")
 
     def _write_style_xf(self, has_hyperlink=False, font_id=0):
         # Write the style <xf> element.
         num_fmt_id = 0
         fill_id = 0
         border_id = 0
 
         attributes = [
-            ('numFmtId', num_fmt_id),
-            ('fontId', font_id),
-            ('fillId', fill_id),
-            ('borderId', border_id),
+            ("numFmtId", num_fmt_id),
+            ("fontId", font_id),
+            ("fillId", fill_id),
+            ("borderId", border_id),
         ]
 
         if has_hyperlink:
-            attributes.append(('applyNumberFormat', 0))
-            attributes.append(('applyFill', 0))
-            attributes.append(('applyBorder', 0))
-            attributes.append(('applyAlignment', 0))
-            attributes.append(('applyProtection', 0))
-
-            self._xml_start_tag('xf', attributes)
-            self._xml_empty_tag('alignment', [('vertical', 'top')])
-            self._xml_empty_tag('protection', [('locked', 0)])
-            self._xml_end_tag('xf')
+            attributes.append(("applyNumberFormat", 0))
+            attributes.append(("applyFill", 0))
+            attributes.append(("applyBorder", 0))
+            attributes.append(("applyAlignment", 0))
+            attributes.append(("applyProtection", 0))
+
+            self._xml_start_tag("xf", attributes)
+            self._xml_empty_tag("alignment", [("vertical", "top")])
+            self._xml_empty_tag("protection", [("locked", 0)])
+            self._xml_end_tag("xf")
 
         else:
-            self._xml_empty_tag('xf', attributes)
+            self._xml_empty_tag("xf", attributes)
 
     def _write_xf(self, xf_format):
         # Write the <xf> element.
         num_fmt_id = xf_format.num_format_index
         font_id = xf_format.font_index
         fill_id = xf_format.fill_index
         border_id = xf_format.border_index
         xf_id = xf_format.xf_id
         has_align = 0
         has_protect = 0
 
         attributes = [
-            ('numFmtId', num_fmt_id),
-            ('fontId', font_id),
-            ('fillId', fill_id),
-            ('borderId', border_id),
-            ('xfId', xf_id),
+            ("numFmtId", num_fmt_id),
+            ("fontId", font_id),
+            ("fillId", fill_id),
+            ("borderId", border_id),
+            ("xfId", xf_id),
         ]
 
         if xf_format.quote_prefix:
-            attributes.append(('quotePrefix', 1))
+            attributes.append(("quotePrefix", 1))
 
         if xf_format.num_format_index > 0:
-            attributes.append(('applyNumberFormat', 1))
+            attributes.append(("applyNumberFormat", 1))
 
         # Add applyFont attribute if XF format uses a font element.
         if xf_format.font_index > 0 and not xf_format.hyperlink:
-            attributes.append(('applyFont', 1))
+            attributes.append(("applyFont", 1))
 
         # Add applyFill attribute if XF format uses a fill element.
         if xf_format.fill_index > 0:
-            attributes.append(('applyFill', 1))
+            attributes.append(("applyFill", 1))
 
         # Add applyBorder attribute if XF format uses a border element.
         if xf_format.border_index > 0:
-            attributes.append(('applyBorder', 1))
+            attributes.append(("applyBorder", 1))
 
         # Check if XF format has alignment properties set.
         (apply_align, align) = xf_format._get_align_properties()
 
         # Check if an alignment sub-element should be written.
         if apply_align and align:
             has_align = 1
 
         # We can also have applyAlignment without a sub-element.
         if apply_align or xf_format.hyperlink:
-            attributes.append(('applyAlignment', 1))
+            attributes.append(("applyAlignment", 1))
 
         # Check for cell protection properties.
         protection = xf_format._get_protection_properties()
 
         if protection or xf_format.hyperlink:
-            attributes.append(('applyProtection', 1))
+            attributes.append(("applyProtection", 1))
 
             if not xf_format.hyperlink:
                 has_protect = 1
 
         # Write XF with sub-elements if required.
         if has_align or has_protect:
-            self._xml_start_tag('xf', attributes)
+            self._xml_start_tag("xf", attributes)
             if has_align:
-                self._xml_empty_tag('alignment', align)
+                self._xml_empty_tag("alignment", align)
             if has_protect:
-                self._xml_empty_tag('protection', protection)
-            self._xml_end_tag('xf')
+                self._xml_empty_tag("protection", protection)
+            self._xml_end_tag("xf")
         else:
-            self._xml_empty_tag('xf', attributes)
+            self._xml_empty_tag("xf", attributes)
 
     def _write_cell_styles(self):
         # Write the <cellStyles> element.
         count = 1
 
         if self.has_hyperlink:
             count = 2
 
-        attributes = [('count', count)]
+        attributes = [("count", count)]
 
-        self._xml_start_tag('cellStyles', attributes)
+        self._xml_start_tag("cellStyles", attributes)
 
         if self.has_hyperlink:
-            self._write_cell_style('Hyperlink', 1, 8)
+            self._write_cell_style("Hyperlink", 1, 8)
 
         self._write_cell_style()
 
-        self._xml_end_tag('cellStyles')
+        self._xml_end_tag("cellStyles")
 
-    def _write_cell_style(self, name='Normal', xf_id=0, builtin_id=0):
+    def _write_cell_style(self, name="Normal", xf_id=0, builtin_id=0):
         # Write the <cellStyle> element.
         attributes = [
-            ('name', name),
-            ('xfId', xf_id),
-            ('builtinId', builtin_id),
+            ("name", name),
+            ("xfId", xf_id),
+            ("builtinId", builtin_id),
         ]
 
-        self._xml_empty_tag('cellStyle', attributes)
+        self._xml_empty_tag("cellStyle", attributes)
 
     def _write_dxfs(self):
         # Write the <dxfs> element.
         formats = self.dxf_formats
         count = len(formats)
 
-        attributes = [('count', len(formats))]
+        attributes = [("count", len(formats))]
 
         if count:
-            self._xml_start_tag('dxfs', attributes)
+            self._xml_start_tag("dxfs", attributes)
 
             # Write the font elements for xf_format objects that have them.
             for xf_format in self.dxf_formats:
-                self._xml_start_tag('dxf')
+                self._xml_start_tag("dxf")
                 if xf_format.has_dxf_font:
                     self._write_font(xf_format, True)
 
                 if xf_format.num_format_index:
-                    self._write_num_fmt(xf_format.num_format_index,
-                                        xf_format.num_format)
+                    self._write_num_fmt(
+                        xf_format.num_format_index, xf_format.num_format
+                    )
 
                 if xf_format.has_dxf_fill:
                     self._write_fill(xf_format, True)
                 if xf_format.has_dxf_border:
                     self._write_border(xf_format, True)
-                self._xml_end_tag('dxf')
+                self._xml_end_tag("dxf")
 
-            self._xml_end_tag('dxfs')
+            self._xml_end_tag("dxfs")
         else:
-            self._xml_empty_tag('dxfs', attributes)
+            self._xml_empty_tag("dxfs", attributes)
 
     def _write_table_styles(self):
         # Write the <tableStyles> element.
         count = 0
-        default_table_style = 'TableStyleMedium9'
-        default_pivot_style = 'PivotStyleLight16'
+        default_table_style = "TableStyleMedium9"
+        default_pivot_style = "PivotStyleLight16"
 
         attributes = [
-            ('count', count),
-            ('defaultTableStyle', default_table_style),
-            ('defaultPivotStyle', default_pivot_style),
+            ("count", count),
+            ("defaultTableStyle", default_table_style),
+            ("defaultPivotStyle", default_pivot_style),
         ]
 
-        self._xml_empty_tag('tableStyles', attributes)
+        self._xml_empty_tag("tableStyles", attributes)
 
     def _write_colors(self):
         # Write the <colors> element.
         custom_colors = self.custom_colors
 
         if not custom_colors:
             return
 
-        self._xml_start_tag('colors')
+        self._xml_start_tag("colors")
         self._write_mru_colors(custom_colors)
-        self._xml_end_tag('colors')
+        self._xml_end_tag("colors")
 
     def _write_mru_colors(self, custom_colors):
         # Write the <mruColors> element for the most recently used colors.
 
         # Write the custom custom_colors in reverse order.
         custom_colors.reverse()
 
         # Limit the mruColors to the last 10.
         if len(custom_colors) > 10:
             custom_colors = custom_colors[0:10]
 
-        self._xml_start_tag('mruColors')
+        self._xml_start_tag("mruColors")
 
         # Write the custom custom_colors in reverse order.
         for color in custom_colors:
-            self._write_color('rgb', color)
+            self._write_color("rgb", color)
 
-        self._xml_end_tag('mruColors')
+        self._xml_end_tag("mruColors")
 
     def _write_condense(self):
         # Write the <condense> element.
-        attributes = [('val', 0)]
+        attributes = [("val", 0)]
 
-        self._xml_empty_tag('condense', attributes)
+        self._xml_empty_tag("condense", attributes)
 
     def _write_extend(self):
         # Write the <extend> element.
-        attributes = [('val', 0)]
+        attributes = [("val", 0)]
 
-        self._xml_empty_tag('extend', attributes)
+        self._xml_empty_tag("extend", attributes)
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/table.py` & `XlsxWriter-3.1.0/xlsxwriter/table.py`

 * *Files 9% similar despite different names*

```diff
@@ -53,15 +53,15 @@
         # Write the tableColumns element.
         self._write_table_columns()
 
         # Write the tableStyleInfo element.
         self._write_table_style_info()
 
         # Close the table tag.
-        self._xml_end_tag('table')
+        self._xml_end_tag("table")
 
         # Close the file.
         self._xml_close()
 
     def _set_properties(self, properties):
         # Set the document properties.
         self.properties = properties
@@ -70,111 +70,115 @@
     #
     # XML methods.
     #
     ###########################################################################
 
     def _write_table(self):
         # Write the <table> element.
-        schema = 'http://schemas.openxmlformats.org/'
-        xmlns = schema + 'spreadsheetml/2006/main'
-        table_id = self.properties['id']
-        name = self.properties['name']
-        display_name = self.properties['name']
-        ref = self.properties['range']
-        totals_row_shown = self.properties['totals_row_shown']
-        header_row_count = self.properties['header_row_count']
+        schema = "http://schemas.openxmlformats.org/"
+        xmlns = schema + "spreadsheetml/2006/main"
+        table_id = self.properties["id"]
+        name = self.properties["name"]
+        display_name = self.properties["name"]
+        ref = self.properties["range"]
+        totals_row_shown = self.properties["totals_row_shown"]
+        header_row_count = self.properties["header_row_count"]
 
         attributes = [
-            ('xmlns', xmlns),
-            ('id', table_id),
-            ('name', name),
-            ('displayName', display_name),
-            ('ref', ref),
+            ("xmlns", xmlns),
+            ("id", table_id),
+            ("name", name),
+            ("displayName", display_name),
+            ("ref", ref),
         ]
 
         if not header_row_count:
-            attributes.append(('headerRowCount', 0))
+            attributes.append(("headerRowCount", 0))
 
         if totals_row_shown:
-            attributes.append(('totalsRowCount', 1))
+            attributes.append(("totalsRowCount", 1))
         else:
-            attributes.append(('totalsRowShown', 0))
+            attributes.append(("totalsRowShown", 0))
 
-        self._xml_start_tag('table', attributes)
+        self._xml_start_tag("table", attributes)
 
     def _write_auto_filter(self):
         # Write the <autoFilter> element.
-        autofilter = self.properties.get('autofilter', 0)
+        autofilter = self.properties.get("autofilter", 0)
 
         if not autofilter:
             return
 
-        attributes = [('ref', autofilter,)]
+        attributes = [
+            (
+                "ref",
+                autofilter,
+            )
+        ]
 
-        self._xml_empty_tag('autoFilter', attributes)
+        self._xml_empty_tag("autoFilter", attributes)
 
     def _write_table_columns(self):
         # Write the <tableColumns> element.
-        columns = self.properties['columns']
+        columns = self.properties["columns"]
 
         count = len(columns)
 
-        attributes = [('count', count)]
+        attributes = [("count", count)]
 
-        self._xml_start_tag('tableColumns', attributes)
+        self._xml_start_tag("tableColumns", attributes)
 
         for col_data in columns:
             # Write the tableColumn element.
             self._write_table_column(col_data)
 
-        self._xml_end_tag('tableColumns')
+        self._xml_end_tag("tableColumns")
 
     def _write_table_column(self, col_data):
         # Write the <tableColumn> element.
         attributes = [
-            ('id', col_data['id']),
-            ('name', col_data['name']),
+            ("id", col_data["id"]),
+            ("name", col_data["name"]),
         ]
 
-        if col_data.get('total_string'):
-            attributes.append(('totalsRowLabel', col_data['total_string']))
-        elif col_data.get('total_function'):
-            attributes.append(('totalsRowFunction',
-                               col_data['total_function']))
+        if col_data.get("total_string"):
+            attributes.append(("totalsRowLabel", col_data["total_string"]))
+        elif col_data.get("total_function"):
+            attributes.append(("totalsRowFunction", col_data["total_function"]))
 
-        if 'format' in col_data and col_data['format'] is not None:
-            attributes.append(('dataDxfId', col_data['format']))
+        if "format" in col_data and col_data["format"] is not None:
+            attributes.append(("dataDxfId", col_data["format"]))
 
-        if col_data.get('formula'):
-            self._xml_start_tag('tableColumn', attributes)
+        if col_data.get("formula"):
+            self._xml_start_tag("tableColumn", attributes)
 
             # Write the calculatedColumnFormula element.
-            self._write_calculated_column_formula(col_data['formula'])
+            self._write_calculated_column_formula(col_data["formula"])
 
-            self._xml_end_tag('tableColumn')
+            self._xml_end_tag("tableColumn")
         else:
-            self._xml_empty_tag('tableColumn', attributes)
+            self._xml_empty_tag("tableColumn", attributes)
 
     def _write_table_style_info(self):
         # Write the <tableStyleInfo> element.
         props = self.properties
         attributes = []
 
-        name = props['style']
-        show_first_column = 0 + props['show_first_col']
-        show_last_column = 0 + props['show_last_col']
-        show_row_stripes = 0 + props['show_row_stripes']
-        show_column_stripes = 0 + props['show_col_stripes']
-
-        if name is not None and name != '' and name != 'None':
-            attributes.append(('name', name))
-
-        attributes.append(('showFirstColumn', show_first_column))
-        attributes.append(('showLastColumn', show_last_column))
-        attributes.append(('showRowStripes', show_row_stripes))
-        attributes.append(('showColumnStripes', show_column_stripes))
+        name = props["style"]
+        show_first_column = 0 + props["show_first_col"]
+        show_last_column = 0 + props["show_last_col"]
+        show_row_stripes = 0 + props["show_row_stripes"]
+        show_column_stripes = 0 + props["show_col_stripes"]
+
+        if name is not None and name != "" and name != "None":
+            attributes.append(("name", name))
+
+        attributes.append(("showFirstColumn", show_first_column))
+        attributes.append(("showLastColumn", show_last_column))
+        attributes.append(("showRowStripes", show_row_stripes))
+        attributes.append(("showColumnStripes", show_column_stripes))
 
-        self._xml_empty_tag('tableStyleInfo', attributes)
+        self._xml_empty_tag("tableStyleInfo", attributes)
 
     def _write_calculated_column_formula(self, formula):
         # Write the <calculatedColumnFormula> element.
-        self._xml_data_element('calculatedColumnFormula', formula)
+        self._xml_data_element("calculatedColumnFormula", formula)
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/theme.py` & `XlsxWriter-3.1.0/xlsxwriter/theme.py`

 * *Files 1% similar despite different names*

```diff
@@ -46,21 +46,21 @@
     def _set_xml_writer(self, filename):
         # Set the XML writer filehandle for the object.
         if isinstance(filename, StringIO):
             self.internal_fh = False
             self.fh = filename
         else:
             self.internal_fh = True
-            self.fh = open(filename, mode='w', encoding='utf-8')
+            self.fh = open(filename, mode="w", encoding="utf-8")
 
     ###########################################################################
     #
     # XML methods.
     #
     ###########################################################################
 
     def _write_theme_file(self):
         # Write a default theme.xml file.
 
-        default_theme = """<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"><a:themeElements><a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1><a:dk2><a:srgbClr val="1F497D"/></a:dk2><a:lt2><a:srgbClr val="EEECE1"/></a:lt2><a:accent1><a:srgbClr val="4F81BD"/></a:accent1><a:accent2><a:srgbClr val="C0504D"/></a:accent2><a:accent3><a:srgbClr val="9BBB59"/></a:accent3><a:accent4><a:srgbClr val="8064A2"/></a:accent4><a:accent5><a:srgbClr val="4BACC6"/></a:accent5><a:accent6><a:srgbClr val="F79646"/></a:accent6><a:hlink><a:srgbClr val="0000FF"/></a:hlink><a:folHlink><a:srgbClr val="800080"/></a:folHlink></a:clrScheme><a:fontScheme name="Office"><a:majorFont><a:latin typeface="Cambria"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/><a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/><a:font script="Hans" typeface="\u5b8b\u4f53"/><a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/><a:font script="Arab" typeface="Times New Roman"/><a:font script="Hebr" typeface="Times New Roman"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="MoolBoran"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Times New Roman"/><a:font script="Uigh" typeface="Microsoft Uighur"/></a:majorFont><a:minorFont><a:latin typeface="Calibri"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/><a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/><a:font script="Hans" typeface="\u5b8b\u4f53"/><a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/><a:font script="Arab" typeface="Arial"/><a:font script="Hebr" typeface="Arial"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="DaunPenh"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Arial"/><a:font script="Uigh" typeface="Microsoft Uighur"/></a:minorFont></a:fontScheme><a:fmtScheme name="Office"><a:fillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="1"/></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:shade val="51000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="80000"><a:schemeClr val="phClr"><a:shade val="93000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="94000"/><a:satMod val="135000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="0"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/></a:theme>"""
+        default_theme = """<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"><a:themeElements><a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1><a:dk2><a:srgbClr val="1F497D"/></a:dk2><a:lt2><a:srgbClr val="EEECE1"/></a:lt2><a:accent1><a:srgbClr val="4F81BD"/></a:accent1><a:accent2><a:srgbClr val="C0504D"/></a:accent2><a:accent3><a:srgbClr val="9BBB59"/></a:accent3><a:accent4><a:srgbClr val="8064A2"/></a:accent4><a:accent5><a:srgbClr val="4BACC6"/></a:accent5><a:accent6><a:srgbClr val="F79646"/></a:accent6><a:hlink><a:srgbClr val="0000FF"/></a:hlink><a:folHlink><a:srgbClr val="800080"/></a:folHlink></a:clrScheme><a:fontScheme name="Office"><a:majorFont><a:latin typeface="Cambria"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/><a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/><a:font script="Hans" typeface="\u5b8b\u4f53"/><a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/><a:font script="Arab" typeface="Times New Roman"/><a:font script="Hebr" typeface="Times New Roman"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="MoolBoran"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Times New Roman"/><a:font script="Uigh" typeface="Microsoft Uighur"/></a:majorFont><a:minorFont><a:latin typeface="Calibri"/><a:ea typeface=""/><a:cs typeface=""/><a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/><a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/><a:font script="Hans" typeface="\u5b8b\u4f53"/><a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/><a:font script="Arab" typeface="Arial"/><a:font script="Hebr" typeface="Arial"/><a:font script="Thai" typeface="Tahoma"/><a:font script="Ethi" typeface="Nyala"/><a:font script="Beng" typeface="Vrinda"/><a:font script="Gujr" typeface="Shruti"/><a:font script="Khmr" typeface="DaunPenh"/><a:font script="Knda" typeface="Tunga"/><a:font script="Guru" typeface="Raavi"/><a:font script="Cans" typeface="Euphemia"/><a:font script="Cher" typeface="Plantagenet Cherokee"/><a:font script="Yiii" typeface="Microsoft Yi Baiti"/><a:font script="Tibt" typeface="Microsoft Himalaya"/><a:font script="Thaa" typeface="MV Boli"/><a:font script="Deva" typeface="Mangal"/><a:font script="Telu" typeface="Gautami"/><a:font script="Taml" typeface="Latha"/><a:font script="Syrc" typeface="Estrangelo Edessa"/><a:font script="Orya" typeface="Kalinga"/><a:font script="Mlym" typeface="Kartika"/><a:font script="Laoo" typeface="DokChampa"/><a:font script="Sinh" typeface="Iskoola Pota"/><a:font script="Mong" typeface="Mongolian Baiti"/><a:font script="Viet" typeface="Arial"/><a:font script="Uigh" typeface="Microsoft Uighur"/></a:minorFont></a:fontScheme><a:fmtScheme name="Office"><a:fillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="1"/></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:shade val="51000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="80000"><a:schemeClr val="phClr"><a:shade val="93000"/><a:satMod val="130000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="94000"/><a:satMod val="135000"/></a:schemeClr></a:gs></a:gsLst><a:lin ang="16200000" scaled="0"/></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln><a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw></a:effectLst><a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d><a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs></a:gsLst><a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path></a:gradFill></a:bgFillStyleLst></a:fmtScheme></a:themeElements><a:objectDefaults/><a:extraClrSchemeLst/></a:theme>"""  # noqa
 
         self.fh.write(default_theme)
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/utility.py` & `XlsxWriter-3.1.0/xlsxwriter/utility.py`

 * *Files 24% similar despite different names*

```diff
@@ -8,32 +8,115 @@
 import re
 import datetime
 from warnings import warn
 
 COL_NAMES = {}
 
 CHAR_WIDTHS = {
-    " ": 3,  "!": 5,  '"': 6, "#": 7, "$": 7,  "%": 11, "&": 10, "'": 3,
-    "(": 5,  ")": 5,  "*": 7, "+": 7, ",": 4,  "-": 5,  ".": 4,  "/": 6,
-    "0": 7,  "1": 7,  "2": 7, "3": 7, "4": 7,  "5": 7,  "6": 7,  "7": 7,
-    "8": 7,  "9": 7,  ":": 4, ";": 4, "<": 7,  "=": 7,  ">": 7,  "?": 7,
-    "@": 13, "A": 9,  "B": 8, "C": 8, "D": 9,  "E": 7,  "F": 7,  "G": 9,
-    "H": 9,  "I": 4,  "J": 5, "K": 8, "L": 6,  "M": 12, "N": 10, "O": 10,
-    "P": 8,  "Q": 10, "R": 8, "S": 7, "T": 7,  "U": 9,  "V": 9,  "W": 13,
-    "X": 8,  "Y": 7,  "Z": 7, "[": 5, "\\": 6, "]": 5,  "^": 7,  "_": 7,
-    "`": 4,  "a": 7,  "b": 8, "c": 6, "d": 8,  "e": 8,  "f": 5,  "g": 7,
-    "h": 8,  "i": 4,  "j": 4, "k": 7, "l": 4,  "m": 12, "n": 8,  "o": 8,
-    "p": 8,  "q": 8,  "r": 5, "s": 6, "t": 5,  "u": 8,  "v": 7,  "w": 11,
-    "x": 7,  "y": 7,  "z": 6, "{": 5, "|": 7,  "}": 5,  "~": 7,
+    " ": 3,
+    "!": 5,
+    '"': 6,
+    "#": 7,
+    "$": 7,
+    "%": 11,
+    "&": 10,
+    "'": 3,
+    "(": 5,
+    ")": 5,
+    "*": 7,
+    "+": 7,
+    ",": 4,
+    "-": 5,
+    ".": 4,
+    "/": 6,
+    "0": 7,
+    "1": 7,
+    "2": 7,
+    "3": 7,
+    "4": 7,
+    "5": 7,
+    "6": 7,
+    "7": 7,
+    "8": 7,
+    "9": 7,
+    ":": 4,
+    ";": 4,
+    "<": 7,
+    "=": 7,
+    ">": 7,
+    "?": 7,
+    "@": 13,
+    "A": 9,
+    "B": 8,
+    "C": 8,
+    "D": 9,
+    "E": 7,
+    "F": 7,
+    "G": 9,
+    "H": 9,
+    "I": 4,
+    "J": 5,
+    "K": 8,
+    "L": 6,
+    "M": 12,
+    "N": 10,
+    "O": 10,
+    "P": 8,
+    "Q": 10,
+    "R": 8,
+    "S": 7,
+    "T": 7,
+    "U": 9,
+    "V": 9,
+    "W": 13,
+    "X": 8,
+    "Y": 7,
+    "Z": 7,
+    "[": 5,
+    "\\": 6,
+    "]": 5,
+    "^": 7,
+    "_": 7,
+    "`": 4,
+    "a": 7,
+    "b": 8,
+    "c": 6,
+    "d": 8,
+    "e": 8,
+    "f": 5,
+    "g": 7,
+    "h": 8,
+    "i": 4,
+    "j": 4,
+    "k": 7,
+    "l": 4,
+    "m": 12,
+    "n": 8,
+    "o": 8,
+    "p": 8,
+    "q": 8,
+    "r": 5,
+    "s": 6,
+    "t": 5,
+    "u": 8,
+    "v": 7,
+    "w": 11,
+    "x": 7,
+    "y": 7,
+    "z": 6,
+    "{": 5,
+    "|": 7,
+    "}": 5,
+    "~": 7,
 }
 
 # Compile performance critical regular expressions.
-re_leading = re.compile(r'^\s')
-re_trailing = re.compile(r'\s$')
-re_range_parts = re.compile(r'(\$?)([A-Z]{1,3})(\$?)(\d+)')
+re_leading = re.compile(r"^\s")
+re_trailing = re.compile(r"\s$")
+re_range_parts = re.compile(r"(\$?)([A-Z]{1,3})(\$?)(\d+)")
 
 
 def xl_rowcol_to_cell(row, col, row_abs=False, col_abs=False):
     """
     Convert a zero indexed row and column cell reference to a A1 style string.
 
     Args:
@@ -51,15 +134,15 @@
         return None
 
     if col < 0:
         warn("Col number %d must be >= 0" % col)
         return None
 
     row += 1  # Change to 1-index.
-    row_abs = '$' if row_abs else ''
+    row_abs = "$" if row_abs else ""
 
     col_str = xl_col_to_name(col, col_abs)
 
     return col_str + row_abs + str(row)
 
 
 def xl_rowcol_to_cell_fast(row, col):
@@ -97,26 +180,26 @@
     """
     col_num = col
     if col_num < 0:
         warn("Col number %d must be >= 0" % col_num)
         return None
 
     col_num += 1  # Change to 1-index.
-    col_str = ''
-    col_abs = '$' if col_abs else ''
+    col_str = ""
+    col_abs = "$" if col_abs else ""
 
     while col_num:
         # Set remainder from 1 .. 26
         remainder = col_num % 26
 
         if remainder == 0:
             remainder = 26
 
         # Convert the remainder to a character.
-        col_letter = chr(ord('A') + remainder - 1)
+        col_letter = chr(ord("A") + remainder - 1)
 
         # Accumulate the column letters, right to left.
         col_str = col_letter + col_str
 
         # Get the next order of magnitude.
         col_num = int((col_num - 1) / 26)
 
@@ -141,15 +224,15 @@
     col_str = match.group(2)
     row_str = match.group(4)
 
     # Convert base26 column string to number.
     expn = 0
     col = 0
     for char in reversed(col_str):
-        col += (ord(char) - ord('A') + 1) * (26 ** expn)
+        col += (ord(char) - ord("A") + 1) * (26**expn)
         expn += 1
 
     # Convert 1-index to zero-index
     row = int(row_str) - 1
     col -= 1
 
     return row, col
@@ -187,15 +270,15 @@
     else:
         row_abs = False
 
     # Convert base26 column string to number.
     expn = 0
     col = 0
     for char in reversed(col_str):
-        col += (ord(char) - ord('A') + 1) * (26 ** expn)
+        col += (ord(char) - ord("A") + 1) * (26**expn)
         expn += 1
 
     # Convert 1-index to zero-index
     row = int(row_str) - 1
     col -= 1
 
     return row, col, row_abs, col_abs
@@ -221,15 +304,15 @@
     if range1 is None or range2 is None:
         warn("Row and column numbers must be >= 0")
         return None
 
     if range1 == range2:
         return range1
     else:
-        return range1 + ':' + range2
+        return range1 + ":" + range2
 
 
 def xl_range_abs(first_row, first_col, last_row, last_col):
     """
     Convert zero indexed row and col cell references to a $A$1:$B$1 absolute
     range string.
 
@@ -249,15 +332,15 @@
     if range1 is None or range2 is None:
         warn("Row and column numbers must be >= 0")
         return None
 
     if range1 == range2:
         return range1
     else:
-        return range1 + ':' + range2
+        return range1 + ":" + range2
 
 
 def xl_range_formula(sheetname, first_row, first_col, last_row, last_col):
     """
     Convert worksheet name and zero indexed row and col cell references to
     a Sheet1!A1:B1 range formula string.
 
@@ -271,15 +354,15 @@
     Returns:
         A1:B1 style range string.
 
     """
     cell_range = xl_range_abs(first_row, first_col, last_row, last_col)
     sheetname = quote_sheetname(sheetname)
 
-    return sheetname + '!' + cell_range
+    return sheetname + "!" + cell_range
 
 
 def quote_sheetname(sheetname):
     """
     Convert a worksheet name to a quoted  name if it contains spaces or
     special characters.
 
@@ -324,375 +407,412 @@
 
 
 def xl_color(color):
     # Used in conjunction with the XlsxWriter *color() methods to convert
     # a color name into an RGB formatted string. These colors are for
     # backward compatibility with older versions of Excel.
     named_colors = {
-        'black': '#000000',
-        'blue': '#0000FF',
-        'brown': '#800000',
-        'cyan': '#00FFFF',
-        'gray': '#808080',
-        'green': '#008000',
-        'lime': '#00FF00',
-        'magenta': '#FF00FF',
-        'navy': '#000080',
-        'orange': '#FF6600',
-        'pink': '#FF00FF',
-        'purple': '#800080',
-        'red': '#FF0000',
-        'silver': '#C0C0C0',
-        'white': '#FFFFFF',
-        'yellow': '#FFFF00',
+        "black": "#000000",
+        "blue": "#0000FF",
+        "brown": "#800000",
+        "cyan": "#00FFFF",
+        "gray": "#808080",
+        "green": "#008000",
+        "lime": "#00FF00",
+        "magenta": "#FF00FF",
+        "navy": "#000080",
+        "orange": "#FF6600",
+        "pink": "#FF00FF",
+        "purple": "#800080",
+        "red": "#FF0000",
+        "silver": "#C0C0C0",
+        "white": "#FFFFFF",
+        "yellow": "#FFFF00",
     }
 
     if color in named_colors:
         color = named_colors[color]
 
-    if not re.match('#[0-9a-fA-F]{6}', color):
+    if not re.match("#[0-9a-fA-F]{6}", color):
         warn("Color '%s' isn't a valid Excel color" % color)
 
     # Convert the RGB color to the Excel ARGB format.
-    return "FF" + color.lstrip('#').upper()
+    return "FF" + color.lstrip("#").upper()
 
 
 def get_rgb_color(color):
     # Convert the user specified color to an RGB color.
     rgb_color = xl_color(color)
 
     # Remove leading FF from RGB color for charts.
-    rgb_color = re.sub(r'^FF', '', rgb_color)
+    rgb_color = re.sub(r"^FF", "", rgb_color)
 
     return rgb_color
 
 
 def get_sparkline_style(style_id):
     styles = [
-        {'series':   {'theme': "4", 'tint': "-0.499984740745262"},
-         'negative': {'theme': "5"},
-         'markers':  {'theme': "4", 'tint': "-0.499984740745262"},
-         'first':    {'theme': "4", 'tint': "0.39997558519241921"},
-         'last':     {'theme': "4", 'tint': "0.39997558519241921"},
-         'high':     {'theme': "4"},
-         'low':      {'theme': "4"},
-         },  # 0
-        {'series':   {'theme': "4", 'tint': "-0.499984740745262"},
-         'negative': {'theme': "5"},
-         'markers':  {'theme': "4", 'tint': "-0.499984740745262"},
-         'first':    {'theme': "4", 'tint': "0.39997558519241921"},
-         'last':     {'theme': "4", 'tint': "0.39997558519241921"},
-         'high':     {'theme': "4"},
-         'low':      {'theme': "4"},
-         },  # 1
-        {'series':   {'theme': "5", 'tint': "-0.499984740745262"},
-         'negative': {'theme': "6"},
-         'markers':  {'theme': "5", 'tint': "-0.499984740745262"},
-         'first':    {'theme': "5", 'tint': "0.39997558519241921"},
-         'last':     {'theme': "5", 'tint': "0.39997558519241921"},
-         'high':     {'theme': "5"},
-         'low':      {'theme': "5"},
-         },  # 2
-        {'series':   {'theme': "6", 'tint': "-0.499984740745262"},
-         'negative': {'theme': "7"},
-         'markers':  {'theme': "6", 'tint': "-0.499984740745262"},
-         'first':    {'theme': "6", 'tint': "0.39997558519241921"},
-         'last':     {'theme': "6", 'tint': "0.39997558519241921"},
-         'high':     {'theme': "6"},
-         'low':      {'theme': "6"},
-         },  # 3
-        {'series':   {'theme': "7", 'tint': "-0.499984740745262"},
-         'negative': {'theme': "8"},
-         'markers':  {'theme': "7", 'tint': "-0.499984740745262"},
-         'first':    {'theme': "7", 'tint': "0.39997558519241921"},
-         'last':     {'theme': "7", 'tint': "0.39997558519241921"},
-         'high':     {'theme': "7"},
-         'low':      {'theme': "7"},
-         },  # 4
-        {'series':   {'theme': "8", 'tint': "-0.499984740745262"},
-         'negative': {'theme': "9"},
-         'markers':  {'theme': "8", 'tint': "-0.499984740745262"},
-         'first':    {'theme': "8", 'tint': "0.39997558519241921"},
-         'last':     {'theme': "8", 'tint': "0.39997558519241921"},
-         'high':     {'theme': "8"},
-         'low':      {'theme': "8"},
-         },  # 5
-        {'series':   {'theme': "9", 'tint': "-0.499984740745262"},
-         'negative': {'theme': "4"},
-         'markers':  {'theme': "9", 'tint': "-0.499984740745262"},
-         'first':    {'theme': "9", 'tint': "0.39997558519241921"},
-         'last':     {'theme': "9", 'tint': "0.39997558519241921"},
-         'high':     {'theme': "9"},
-         'low':      {'theme': "9"},
-         },  # 6
-        {'series':   {'theme': "4", 'tint': "-0.249977111117893"},
-         'negative': {'theme': "5"},
-         'markers':  {'theme': "5", 'tint': "-0.249977111117893"},
-         'first':    {'theme': "5", 'tint': "-0.249977111117893"},
-         'last':     {'theme': "5", 'tint': "-0.249977111117893"},
-         'high':     {'theme': "5", 'tint': "-0.249977111117893"},
-         'low':      {'theme': "5", 'tint': "-0.249977111117893"},
-         },  # 7
-        {'series':   {'theme': "5", 'tint': "-0.249977111117893"},
-         'negative': {'theme': "6"},
-         'markers':  {'theme': "6", 'tint': "-0.249977111117893"},
-         'first':    {'theme': "6", 'tint': "-0.249977111117893"},
-         'last':     {'theme': "6", 'tint': "-0.249977111117893"},
-         'high':     {'theme': "6", 'tint': "-0.249977111117893"},
-         'low':      {'theme': "6", 'tint': "-0.249977111117893"},
-         },  # 8
-        {'series':   {'theme': "6", 'tint': "-0.249977111117893"},
-         'negative': {'theme': "7"},
-         'markers':  {'theme': "7", 'tint': "-0.249977111117893"},
-         'first':    {'theme': "7", 'tint': "-0.249977111117893"},
-         'last':     {'theme': "7", 'tint': "-0.249977111117893"},
-         'high':     {'theme': "7", 'tint': "-0.249977111117893"},
-         'low':      {'theme': "7", 'tint': "-0.249977111117893"},
-         },  # 9
-        {'series':   {'theme': "7", 'tint': "-0.249977111117893"},
-         'negative': {'theme': "8"},
-         'markers':  {'theme': "8", 'tint': "-0.249977111117893"},
-         'first':    {'theme': "8", 'tint': "-0.249977111117893"},
-         'last':     {'theme': "8", 'tint': "-0.249977111117893"},
-         'high':     {'theme': "8", 'tint': "-0.249977111117893"},
-         'low':      {'theme': "8", 'tint': "-0.249977111117893"},
-         },  # 10
-        {'series':   {'theme': "8", 'tint': "-0.249977111117893"},
-         'negative': {'theme': "9"},
-         'markers':  {'theme': "9", 'tint': "-0.249977111117893"},
-         'first':    {'theme': "9", 'tint': "-0.249977111117893"},
-         'last':     {'theme': "9", 'tint': "-0.249977111117893"},
-         'high':     {'theme': "9", 'tint': "-0.249977111117893"},
-         'low':      {'theme': "9", 'tint': "-0.249977111117893"},
-         },  # 11
-        {'series':   {'theme': "9", 'tint': "-0.249977111117893"},
-         'negative': {'theme': "4"},
-         'markers':  {'theme': "4", 'tint': "-0.249977111117893"},
-         'first':    {'theme': "4", 'tint': "-0.249977111117893"},
-         'last':     {'theme': "4", 'tint': "-0.249977111117893"},
-         'high':     {'theme': "4", 'tint': "-0.249977111117893"},
-         'low':      {'theme': "4", 'tint': "-0.249977111117893"},
-         },  # 12
-        {'series':   {'theme': "4"},
-         'negative': {'theme': "5"},
-         'markers':  {'theme': "4", 'tint': "-0.249977111117893"},
-         'first':    {'theme': "4", 'tint': "-0.249977111117893"},
-         'last':     {'theme': "4", 'tint': "-0.249977111117893"},
-         'high':     {'theme': "4", 'tint': "-0.249977111117893"},
-         'low':      {'theme': "4", 'tint': "-0.249977111117893"},
-         },  # 13
-        {'series':   {'theme': "5"},
-         'negative': {'theme': "6"},
-         'markers':  {'theme': "5", 'tint': "-0.249977111117893"},
-         'first':    {'theme': "5", 'tint': "-0.249977111117893"},
-         'last':     {'theme': "5", 'tint': "-0.249977111117893"},
-         'high':     {'theme': "5", 'tint': "-0.249977111117893"},
-         'low':      {'theme': "5", 'tint': "-0.249977111117893"},
-         },  # 14
-        {'series':   {'theme': "6"},
-         'negative': {'theme': "7"},
-         'markers':  {'theme': "6", 'tint': "-0.249977111117893"},
-         'first':    {'theme': "6", 'tint': "-0.249977111117893"},
-         'last':     {'theme': "6", 'tint': "-0.249977111117893"},
-         'high':     {'theme': "6", 'tint': "-0.249977111117893"},
-         'low':      {'theme': "6", 'tint': "-0.249977111117893"},
-         },  # 15
-        {'series':   {'theme': "7"},
-         'negative': {'theme': "8"},
-         'markers':  {'theme': "7", 'tint': "-0.249977111117893"},
-         'first':    {'theme': "7", 'tint': "-0.249977111117893"},
-         'last':     {'theme': "7", 'tint': "-0.249977111117893"},
-         'high':     {'theme': "7", 'tint': "-0.249977111117893"},
-         'low':      {'theme': "7", 'tint': "-0.249977111117893"},
-         },  # 16
-        {'series':   {'theme': "8"},
-         'negative': {'theme': "9"},
-         'markers':  {'theme': "8", 'tint': "-0.249977111117893"},
-         'first':    {'theme': "8", 'tint': "-0.249977111117893"},
-         'last':     {'theme': "8", 'tint': "-0.249977111117893"},
-         'high':     {'theme': "8", 'tint': "-0.249977111117893"},
-         'low':      {'theme': "8", 'tint': "-0.249977111117893"},
-         },  # 17
-        {'series':   {'theme': "9"},
-         'negative': {'theme': "4"},
-         'markers':  {'theme': "9", 'tint': "-0.249977111117893"},
-         'first':    {'theme': "9", 'tint': "-0.249977111117893"},
-         'last':     {'theme': "9", 'tint': "-0.249977111117893"},
-         'high':     {'theme': "9", 'tint': "-0.249977111117893"},
-         'low':      {'theme': "9", 'tint': "-0.249977111117893"},
-         },  # 18
-        {'series':   {'theme': "4", 'tint': "0.39997558519241921"},
-         'negative': {'theme': "0", 'tint': "-0.499984740745262"},
-         'markers':  {'theme': "4", 'tint': "0.79998168889431442"},
-         'first':    {'theme': "4", 'tint': "-0.249977111117893"},
-         'last':     {'theme': "4", 'tint': "-0.249977111117893"},
-         'high':     {'theme': "4", 'tint': "-0.499984740745262"},
-         'low':      {'theme': "4", 'tint': "-0.499984740745262"},
-         },  # 19
-        {'series':   {'theme': "5", 'tint': "0.39997558519241921"},
-         'negative': {'theme': "0", 'tint': "-0.499984740745262"},
-         'markers':  {'theme': "5", 'tint': "0.79998168889431442"},
-         'first':    {'theme': "5", 'tint': "-0.249977111117893"},
-         'last':     {'theme': "5", 'tint': "-0.249977111117893"},
-         'high':     {'theme': "5", 'tint': "-0.499984740745262"},
-         'low':      {'theme': "5", 'tint': "-0.499984740745262"},
-         },  # 20
-        {'series':   {'theme': "6", 'tint': "0.39997558519241921"},
-         'negative': {'theme': "0", 'tint': "-0.499984740745262"},
-         'markers':  {'theme': "6", 'tint': "0.79998168889431442"},
-         'first':    {'theme': "6", 'tint': "-0.249977111117893"},
-         'last':     {'theme': "6", 'tint': "-0.249977111117893"},
-         'high':     {'theme': "6", 'tint': "-0.499984740745262"},
-         'low':      {'theme': "6", 'tint': "-0.499984740745262"},
-         },  # 21
-        {'series':   {'theme': "7", 'tint': "0.39997558519241921"},
-         'negative': {'theme': "0", 'tint': "-0.499984740745262"},
-         'markers':  {'theme': "7", 'tint': "0.79998168889431442"},
-         'first':    {'theme': "7", 'tint': "-0.249977111117893"},
-         'last':     {'theme': "7", 'tint': "-0.249977111117893"},
-         'high':     {'theme': "7", 'tint': "-0.499984740745262"},
-         'low':      {'theme': "7", 'tint': "-0.499984740745262"},
-         },  # 22
-        {'series':   {'theme': "8", 'tint': "0.39997558519241921"},
-         'negative': {'theme': "0", 'tint': "-0.499984740745262"},
-         'markers':  {'theme': "8", 'tint': "0.79998168889431442"},
-         'first':    {'theme': "8", 'tint': "-0.249977111117893"},
-         'last':     {'theme': "8", 'tint': "-0.249977111117893"},
-         'high':     {'theme': "8", 'tint': "-0.499984740745262"},
-         'low':      {'theme': "8", 'tint': "-0.499984740745262"},
-         },  # 23
-        {'series':   {'theme': "9", 'tint': "0.39997558519241921"},
-         'negative': {'theme': "0", 'tint': "-0.499984740745262"},
-         'markers':  {'theme': "9", 'tint': "0.79998168889431442"},
-         'first':    {'theme': "9", 'tint': "-0.249977111117893"},
-         'last':     {'theme': "9", 'tint': "-0.249977111117893"},
-         'high':     {'theme': "9", 'tint': "-0.499984740745262"},
-         'low':      {'theme': "9", 'tint': "-0.499984740745262"},
-         },  # 24
-        {'series':   {'theme': "1", 'tint': "0.499984740745262"},
-         'negative': {'theme': "1", 'tint': "0.249977111117893"},
-         'markers':  {'theme': "1", 'tint': "0.249977111117893"},
-         'first':    {'theme': "1", 'tint': "0.249977111117893"},
-         'last':     {'theme': "1", 'tint': "0.249977111117893"},
-         'high':     {'theme': "1", 'tint': "0.249977111117893"},
-         'low':      {'theme': "1", 'tint': "0.249977111117893"},
-         },  # 25
-        {'series':   {'theme': "1", 'tint': "0.34998626667073579"},
-         'negative': {'theme': "0", 'tint': "-0.249977111117893"},
-         'markers':  {'theme': "0", 'tint': "-0.249977111117893"},
-         'first':    {'theme': "0", 'tint': "-0.249977111117893"},
-         'last':     {'theme': "0", 'tint': "-0.249977111117893"},
-         'high':     {'theme': "0", 'tint': "-0.249977111117893"},
-         'low':      {'theme': "0", 'tint': "-0.249977111117893"},
-         },  # 26
-        {'series':   {'rgb': "FF323232"},
-         'negative': {'rgb': "FFD00000"},
-         'markers':  {'rgb': "FFD00000"},
-         'first':    {'rgb': "FFD00000"},
-         'last':     {'rgb': "FFD00000"},
-         'high':     {'rgb': "FFD00000"},
-         'low':      {'rgb': "FFD00000"},
-         },  # 27
-        {'series':   {'rgb': "FF000000"},
-         'negative': {'rgb': "FF0070C0"},
-         'markers':  {'rgb': "FF0070C0"},
-         'first':    {'rgb': "FF0070C0"},
-         'last':     {'rgb': "FF0070C0"},
-         'high':     {'rgb': "FF0070C0"},
-         'low':      {'rgb': "FF0070C0"},
-         },  # 28
-        {'series':   {'rgb': "FF376092"},
-         'negative': {'rgb': "FFD00000"},
-         'markers':  {'rgb': "FFD00000"},
-         'first':    {'rgb': "FFD00000"},
-         'last':     {'rgb': "FFD00000"},
-         'high':     {'rgb': "FFD00000"},
-         'low':      {'rgb': "FFD00000"},
-         },  # 29
-        {'series':   {'rgb': "FF0070C0"},
-         'negative': {'rgb': "FF000000"},
-         'markers':  {'rgb': "FF000000"},
-         'first':    {'rgb': "FF000000"},
-         'last':     {'rgb': "FF000000"},
-         'high':     {'rgb': "FF000000"},
-         'low':      {'rgb': "FF000000"},
-         },  # 30
-        {'series':   {'rgb': "FF5F5F5F"},
-         'negative': {'rgb': "FFFFB620"},
-         'markers':  {'rgb': "FFD70077"},
-         'first':    {'rgb': "FF5687C2"},
-         'last':     {'rgb': "FF359CEB"},
-         'high':     {'rgb': "FF56BE79"},
-         'low':      {'rgb': "FFFF5055"},
-         },  # 31
-        {'series':   {'rgb': "FF5687C2"},
-         'negative': {'rgb': "FFFFB620"},
-         'markers':  {'rgb': "FFD70077"},
-         'first':    {'rgb': "FF777777"},
-         'last':     {'rgb': "FF359CEB"},
-         'high':     {'rgb': "FF56BE79"},
-         'low':      {'rgb': "FFFF5055"},
-         },  # 32
-        {'series':   {'rgb': "FFC6EFCE"},
-         'negative': {'rgb': "FFFFC7CE"},
-         'markers':  {'rgb': "FF8CADD6"},
-         'first':    {'rgb': "FFFFDC47"},
-         'last':     {'rgb': "FFFFEB9C"},
-         'high':     {'rgb': "FF60D276"},
-         'low':      {'rgb': "FFFF5367"},
-         },  # 33
-        {'series':   {'rgb': "FF00B050"},
-         'negative': {'rgb': "FFFF0000"},
-         'markers':  {'rgb': "FF0070C0"},
-         'first':    {'rgb': "FFFFC000"},
-         'last':     {'rgb': "FFFFC000"},
-         'high':     {'rgb': "FF00B050"},
-         'low':      {'rgb': "FFFF0000"},
-         },  # 34
-        {'series':   {'theme': "3"},
-         'negative': {'theme': "9"},
-         'markers':  {'theme': "8"},
-         'first':    {'theme': "4"},
-         'last':     {'theme': "5"},
-         'high':     {'theme': "6"},
-         'low':      {'theme': "7"},
-         },  # 35
-        {'series':   {'theme': "1"},
-         'negative': {'theme': "9"},
-         'markers':  {'theme': "8"},
-         'first':    {'theme': "4"},
-         'last':     {'theme': "5"},
-         'high':     {'theme': "6"},
-         'low':      {'theme': "7"},
-         },  # 36
+        {
+            "series": {"theme": "4", "tint": "-0.499984740745262"},
+            "negative": {"theme": "5"},
+            "markers": {"theme": "4", "tint": "-0.499984740745262"},
+            "first": {"theme": "4", "tint": "0.39997558519241921"},
+            "last": {"theme": "4", "tint": "0.39997558519241921"},
+            "high": {"theme": "4"},
+            "low": {"theme": "4"},
+        },  # 0
+        {
+            "series": {"theme": "4", "tint": "-0.499984740745262"},
+            "negative": {"theme": "5"},
+            "markers": {"theme": "4", "tint": "-0.499984740745262"},
+            "first": {"theme": "4", "tint": "0.39997558519241921"},
+            "last": {"theme": "4", "tint": "0.39997558519241921"},
+            "high": {"theme": "4"},
+            "low": {"theme": "4"},
+        },  # 1
+        {
+            "series": {"theme": "5", "tint": "-0.499984740745262"},
+            "negative": {"theme": "6"},
+            "markers": {"theme": "5", "tint": "-0.499984740745262"},
+            "first": {"theme": "5", "tint": "0.39997558519241921"},
+            "last": {"theme": "5", "tint": "0.39997558519241921"},
+            "high": {"theme": "5"},
+            "low": {"theme": "5"},
+        },  # 2
+        {
+            "series": {"theme": "6", "tint": "-0.499984740745262"},
+            "negative": {"theme": "7"},
+            "markers": {"theme": "6", "tint": "-0.499984740745262"},
+            "first": {"theme": "6", "tint": "0.39997558519241921"},
+            "last": {"theme": "6", "tint": "0.39997558519241921"},
+            "high": {"theme": "6"},
+            "low": {"theme": "6"},
+        },  # 3
+        {
+            "series": {"theme": "7", "tint": "-0.499984740745262"},
+            "negative": {"theme": "8"},
+            "markers": {"theme": "7", "tint": "-0.499984740745262"},
+            "first": {"theme": "7", "tint": "0.39997558519241921"},
+            "last": {"theme": "7", "tint": "0.39997558519241921"},
+            "high": {"theme": "7"},
+            "low": {"theme": "7"},
+        },  # 4
+        {
+            "series": {"theme": "8", "tint": "-0.499984740745262"},
+            "negative": {"theme": "9"},
+            "markers": {"theme": "8", "tint": "-0.499984740745262"},
+            "first": {"theme": "8", "tint": "0.39997558519241921"},
+            "last": {"theme": "8", "tint": "0.39997558519241921"},
+            "high": {"theme": "8"},
+            "low": {"theme": "8"},
+        },  # 5
+        {
+            "series": {"theme": "9", "tint": "-0.499984740745262"},
+            "negative": {"theme": "4"},
+            "markers": {"theme": "9", "tint": "-0.499984740745262"},
+            "first": {"theme": "9", "tint": "0.39997558519241921"},
+            "last": {"theme": "9", "tint": "0.39997558519241921"},
+            "high": {"theme": "9"},
+            "low": {"theme": "9"},
+        },  # 6
+        {
+            "series": {"theme": "4", "tint": "-0.249977111117893"},
+            "negative": {"theme": "5"},
+            "markers": {"theme": "5", "tint": "-0.249977111117893"},
+            "first": {"theme": "5", "tint": "-0.249977111117893"},
+            "last": {"theme": "5", "tint": "-0.249977111117893"},
+            "high": {"theme": "5", "tint": "-0.249977111117893"},
+            "low": {"theme": "5", "tint": "-0.249977111117893"},
+        },  # 7
+        {
+            "series": {"theme": "5", "tint": "-0.249977111117893"},
+            "negative": {"theme": "6"},
+            "markers": {"theme": "6", "tint": "-0.249977111117893"},
+            "first": {"theme": "6", "tint": "-0.249977111117893"},
+            "last": {"theme": "6", "tint": "-0.249977111117893"},
+            "high": {"theme": "6", "tint": "-0.249977111117893"},
+            "low": {"theme": "6", "tint": "-0.249977111117893"},
+        },  # 8
+        {
+            "series": {"theme": "6", "tint": "-0.249977111117893"},
+            "negative": {"theme": "7"},
+            "markers": {"theme": "7", "tint": "-0.249977111117893"},
+            "first": {"theme": "7", "tint": "-0.249977111117893"},
+            "last": {"theme": "7", "tint": "-0.249977111117893"},
+            "high": {"theme": "7", "tint": "-0.249977111117893"},
+            "low": {"theme": "7", "tint": "-0.249977111117893"},
+        },  # 9
+        {
+            "series": {"theme": "7", "tint": "-0.249977111117893"},
+            "negative": {"theme": "8"},
+            "markers": {"theme": "8", "tint": "-0.249977111117893"},
+            "first": {"theme": "8", "tint": "-0.249977111117893"},
+            "last": {"theme": "8", "tint": "-0.249977111117893"},
+            "high": {"theme": "8", "tint": "-0.249977111117893"},
+            "low": {"theme": "8", "tint": "-0.249977111117893"},
+        },  # 10
+        {
+            "series": {"theme": "8", "tint": "-0.249977111117893"},
+            "negative": {"theme": "9"},
+            "markers": {"theme": "9", "tint": "-0.249977111117893"},
+            "first": {"theme": "9", "tint": "-0.249977111117893"},
+            "last": {"theme": "9", "tint": "-0.249977111117893"},
+            "high": {"theme": "9", "tint": "-0.249977111117893"},
+            "low": {"theme": "9", "tint": "-0.249977111117893"},
+        },  # 11
+        {
+            "series": {"theme": "9", "tint": "-0.249977111117893"},
+            "negative": {"theme": "4"},
+            "markers": {"theme": "4", "tint": "-0.249977111117893"},
+            "first": {"theme": "4", "tint": "-0.249977111117893"},
+            "last": {"theme": "4", "tint": "-0.249977111117893"},
+            "high": {"theme": "4", "tint": "-0.249977111117893"},
+            "low": {"theme": "4", "tint": "-0.249977111117893"},
+        },  # 12
+        {
+            "series": {"theme": "4"},
+            "negative": {"theme": "5"},
+            "markers": {"theme": "4", "tint": "-0.249977111117893"},
+            "first": {"theme": "4", "tint": "-0.249977111117893"},
+            "last": {"theme": "4", "tint": "-0.249977111117893"},
+            "high": {"theme": "4", "tint": "-0.249977111117893"},
+            "low": {"theme": "4", "tint": "-0.249977111117893"},
+        },  # 13
+        {
+            "series": {"theme": "5"},
+            "negative": {"theme": "6"},
+            "markers": {"theme": "5", "tint": "-0.249977111117893"},
+            "first": {"theme": "5", "tint": "-0.249977111117893"},
+            "last": {"theme": "5", "tint": "-0.249977111117893"},
+            "high": {"theme": "5", "tint": "-0.249977111117893"},
+            "low": {"theme": "5", "tint": "-0.249977111117893"},
+        },  # 14
+        {
+            "series": {"theme": "6"},
+            "negative": {"theme": "7"},
+            "markers": {"theme": "6", "tint": "-0.249977111117893"},
+            "first": {"theme": "6", "tint": "-0.249977111117893"},
+            "last": {"theme": "6", "tint": "-0.249977111117893"},
+            "high": {"theme": "6", "tint": "-0.249977111117893"},
+            "low": {"theme": "6", "tint": "-0.249977111117893"},
+        },  # 15
+        {
+            "series": {"theme": "7"},
+            "negative": {"theme": "8"},
+            "markers": {"theme": "7", "tint": "-0.249977111117893"},
+            "first": {"theme": "7", "tint": "-0.249977111117893"},
+            "last": {"theme": "7", "tint": "-0.249977111117893"},
+            "high": {"theme": "7", "tint": "-0.249977111117893"},
+            "low": {"theme": "7", "tint": "-0.249977111117893"},
+        },  # 16
+        {
+            "series": {"theme": "8"},
+            "negative": {"theme": "9"},
+            "markers": {"theme": "8", "tint": "-0.249977111117893"},
+            "first": {"theme": "8", "tint": "-0.249977111117893"},
+            "last": {"theme": "8", "tint": "-0.249977111117893"},
+            "high": {"theme": "8", "tint": "-0.249977111117893"},
+            "low": {"theme": "8", "tint": "-0.249977111117893"},
+        },  # 17
+        {
+            "series": {"theme": "9"},
+            "negative": {"theme": "4"},
+            "markers": {"theme": "9", "tint": "-0.249977111117893"},
+            "first": {"theme": "9", "tint": "-0.249977111117893"},
+            "last": {"theme": "9", "tint": "-0.249977111117893"},
+            "high": {"theme": "9", "tint": "-0.249977111117893"},
+            "low": {"theme": "9", "tint": "-0.249977111117893"},
+        },  # 18
+        {
+            "series": {"theme": "4", "tint": "0.39997558519241921"},
+            "negative": {"theme": "0", "tint": "-0.499984740745262"},
+            "markers": {"theme": "4", "tint": "0.79998168889431442"},
+            "first": {"theme": "4", "tint": "-0.249977111117893"},
+            "last": {"theme": "4", "tint": "-0.249977111117893"},
+            "high": {"theme": "4", "tint": "-0.499984740745262"},
+            "low": {"theme": "4", "tint": "-0.499984740745262"},
+        },  # 19
+        {
+            "series": {"theme": "5", "tint": "0.39997558519241921"},
+            "negative": {"theme": "0", "tint": "-0.499984740745262"},
+            "markers": {"theme": "5", "tint": "0.79998168889431442"},
+            "first": {"theme": "5", "tint": "-0.249977111117893"},
+            "last": {"theme": "5", "tint": "-0.249977111117893"},
+            "high": {"theme": "5", "tint": "-0.499984740745262"},
+            "low": {"theme": "5", "tint": "-0.499984740745262"},
+        },  # 20
+        {
+            "series": {"theme": "6", "tint": "0.39997558519241921"},
+            "negative": {"theme": "0", "tint": "-0.499984740745262"},
+            "markers": {"theme": "6", "tint": "0.79998168889431442"},
+            "first": {"theme": "6", "tint": "-0.249977111117893"},
+            "last": {"theme": "6", "tint": "-0.249977111117893"},
+            "high": {"theme": "6", "tint": "-0.499984740745262"},
+            "low": {"theme": "6", "tint": "-0.499984740745262"},
+        },  # 21
+        {
+            "series": {"theme": "7", "tint": "0.39997558519241921"},
+            "negative": {"theme": "0", "tint": "-0.499984740745262"},
+            "markers": {"theme": "7", "tint": "0.79998168889431442"},
+            "first": {"theme": "7", "tint": "-0.249977111117893"},
+            "last": {"theme": "7", "tint": "-0.249977111117893"},
+            "high": {"theme": "7", "tint": "-0.499984740745262"},
+            "low": {"theme": "7", "tint": "-0.499984740745262"},
+        },  # 22
+        {
+            "series": {"theme": "8", "tint": "0.39997558519241921"},
+            "negative": {"theme": "0", "tint": "-0.499984740745262"},
+            "markers": {"theme": "8", "tint": "0.79998168889431442"},
+            "first": {"theme": "8", "tint": "-0.249977111117893"},
+            "last": {"theme": "8", "tint": "-0.249977111117893"},
+            "high": {"theme": "8", "tint": "-0.499984740745262"},
+            "low": {"theme": "8", "tint": "-0.499984740745262"},
+        },  # 23
+        {
+            "series": {"theme": "9", "tint": "0.39997558519241921"},
+            "negative": {"theme": "0", "tint": "-0.499984740745262"},
+            "markers": {"theme": "9", "tint": "0.79998168889431442"},
+            "first": {"theme": "9", "tint": "-0.249977111117893"},
+            "last": {"theme": "9", "tint": "-0.249977111117893"},
+            "high": {"theme": "9", "tint": "-0.499984740745262"},
+            "low": {"theme": "9", "tint": "-0.499984740745262"},
+        },  # 24
+        {
+            "series": {"theme": "1", "tint": "0.499984740745262"},
+            "negative": {"theme": "1", "tint": "0.249977111117893"},
+            "markers": {"theme": "1", "tint": "0.249977111117893"},
+            "first": {"theme": "1", "tint": "0.249977111117893"},
+            "last": {"theme": "1", "tint": "0.249977111117893"},
+            "high": {"theme": "1", "tint": "0.249977111117893"},
+            "low": {"theme": "1", "tint": "0.249977111117893"},
+        },  # 25
+        {
+            "series": {"theme": "1", "tint": "0.34998626667073579"},
+            "negative": {"theme": "0", "tint": "-0.249977111117893"},
+            "markers": {"theme": "0", "tint": "-0.249977111117893"},
+            "first": {"theme": "0", "tint": "-0.249977111117893"},
+            "last": {"theme": "0", "tint": "-0.249977111117893"},
+            "high": {"theme": "0", "tint": "-0.249977111117893"},
+            "low": {"theme": "0", "tint": "-0.249977111117893"},
+        },  # 26
+        {
+            "series": {"rgb": "FF323232"},
+            "negative": {"rgb": "FFD00000"},
+            "markers": {"rgb": "FFD00000"},
+            "first": {"rgb": "FFD00000"},
+            "last": {"rgb": "FFD00000"},
+            "high": {"rgb": "FFD00000"},
+            "low": {"rgb": "FFD00000"},
+        },  # 27
+        {
+            "series": {"rgb": "FF000000"},
+            "negative": {"rgb": "FF0070C0"},
+            "markers": {"rgb": "FF0070C0"},
+            "first": {"rgb": "FF0070C0"},
+            "last": {"rgb": "FF0070C0"},
+            "high": {"rgb": "FF0070C0"},
+            "low": {"rgb": "FF0070C0"},
+        },  # 28
+        {
+            "series": {"rgb": "FF376092"},
+            "negative": {"rgb": "FFD00000"},
+            "markers": {"rgb": "FFD00000"},
+            "first": {"rgb": "FFD00000"},
+            "last": {"rgb": "FFD00000"},
+            "high": {"rgb": "FFD00000"},
+            "low": {"rgb": "FFD00000"},
+        },  # 29
+        {
+            "series": {"rgb": "FF0070C0"},
+            "negative": {"rgb": "FF000000"},
+            "markers": {"rgb": "FF000000"},
+            "first": {"rgb": "FF000000"},
+            "last": {"rgb": "FF000000"},
+            "high": {"rgb": "FF000000"},
+            "low": {"rgb": "FF000000"},
+        },  # 30
+        {
+            "series": {"rgb": "FF5F5F5F"},
+            "negative": {"rgb": "FFFFB620"},
+            "markers": {"rgb": "FFD70077"},
+            "first": {"rgb": "FF5687C2"},
+            "last": {"rgb": "FF359CEB"},
+            "high": {"rgb": "FF56BE79"},
+            "low": {"rgb": "FFFF5055"},
+        },  # 31
+        {
+            "series": {"rgb": "FF5687C2"},
+            "negative": {"rgb": "FFFFB620"},
+            "markers": {"rgb": "FFD70077"},
+            "first": {"rgb": "FF777777"},
+            "last": {"rgb": "FF359CEB"},
+            "high": {"rgb": "FF56BE79"},
+            "low": {"rgb": "FFFF5055"},
+        },  # 32
+        {
+            "series": {"rgb": "FFC6EFCE"},
+            "negative": {"rgb": "FFFFC7CE"},
+            "markers": {"rgb": "FF8CADD6"},
+            "first": {"rgb": "FFFFDC47"},
+            "last": {"rgb": "FFFFEB9C"},
+            "high": {"rgb": "FF60D276"},
+            "low": {"rgb": "FFFF5367"},
+        },  # 33
+        {
+            "series": {"rgb": "FF00B050"},
+            "negative": {"rgb": "FFFF0000"},
+            "markers": {"rgb": "FF0070C0"},
+            "first": {"rgb": "FFFFC000"},
+            "last": {"rgb": "FFFFC000"},
+            "high": {"rgb": "FF00B050"},
+            "low": {"rgb": "FFFF0000"},
+        },  # 34
+        {
+            "series": {"theme": "3"},
+            "negative": {"theme": "9"},
+            "markers": {"theme": "8"},
+            "first": {"theme": "4"},
+            "last": {"theme": "5"},
+            "high": {"theme": "6"},
+            "low": {"theme": "7"},
+        },  # 35
+        {
+            "series": {"theme": "1"},
+            "negative": {"theme": "9"},
+            "markers": {"theme": "8"},
+            "first": {"theme": "4"},
+            "last": {"theme": "5"},
+            "high": {"theme": "6"},
+            "low": {"theme": "7"},
+        },  # 36
     ]
 
     return styles[style_id]
 
 
 def supported_datetime(dt):
     # Determine is an argument is a supported datetime object.
-    return isinstance(dt, (datetime.datetime,
-                           datetime.date,
-                           datetime.time,
-                           datetime.timedelta))
+    return isinstance(
+        dt, (datetime.datetime, datetime.date, datetime.time, datetime.timedelta)
+    )
 
 
 def remove_datetime_timezone(dt_obj, remove_timezone):
     # Excel doesn't support timezones in datetimes/times so we remove the
     # tzinfo from the object if the user has specified that option in the
     # constructor.
     if remove_timezone:
         dt_obj = dt_obj.replace(tzinfo=None)
     else:
         if dt_obj.tzinfo:
             raise TypeError(
                 "Excel doesn't support timezones in datetimes. "
                 "Set the tzinfo in the datetime/time object to None or "
-                "use the 'remove_timezone' Workbook() option")
+                "use the 'remove_timezone' Workbook() option"
+            )
 
     return dt_obj
 
 
 def datetime_to_excel_datetime(dt_obj, date_1904, remove_timezone):
     # Convert a datetime object to an Excel serial date and time. The integer
     # part of the number stores the number of days since the epoch and the
@@ -722,33 +842,35 @@
     elif isinstance(dt_obj, datetime.timedelta):
         is_timedelta = True
         delta = dt_obj
     else:
         raise TypeError("Unknown or unsupported datetime type")
 
     # Convert a Python datetime.datetime value to an Excel date number.
-    excel_time = (delta.days
-                  + (float(delta.seconds)
-                     + float(delta.microseconds) / 1E6)
-                  / (60 * 60 * 24))
+    excel_time = delta.days + (
+        float(delta.seconds) + float(delta.microseconds) / 1e6
+    ) / (60 * 60 * 24)
 
     # The following is a workaround for the fact that in Excel a time only
     # value is represented as 1899-12-31+time whereas in datetime.datetime()
     # it is 1900-1-1+time so we need to subtract the 1 day difference.
-    if (isinstance(date_type, datetime.datetime)
-            and dt_obj.isocalendar() == (1900, 1, 1)):
+    if isinstance(date_type, datetime.datetime) and dt_obj.isocalendar() == (
+        1900,
+        1,
+        1,
+    ):
         excel_time -= 1
 
     # Account for Excel erroneously treating 1900 as a leap year.
     if not date_1904 and not is_timedelta and excel_time > 59:
         excel_time += 1
 
     return excel_time
 
 
 def preserve_whitespace(string):
     # Check if a string has leading or trailing whitespace that requires a
     # "preserve" attribute.
-    if (re_leading.search(string) or re_trailing.search(string)):
+    if re_leading.search(string) or re_trailing.search(string):
         return True
     else:
         return False
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/vml.py` & `XlsxWriter-3.1.0/xlsxwriter/vml.py`

 * *Files 12% similar despite different names*

```diff
@@ -32,16 +32,22 @@
         super(Vml, self).__init__()
 
     ###########################################################################
     #
     # Private API.
     #
     ###########################################################################
-    def _assemble_xml_file(self, data_id, vml_shape_id, comments_data=None,
-                           buttons_data=None, header_images_data=None):
+    def _assemble_xml_file(
+        self,
+        data_id,
+        vml_shape_id,
+        comments_data=None,
+        buttons_data=None,
+        header_images_data=None,
+    ):
         # Assemble and write the XML file.
         z_index = 1
 
         self._write_xml_namespace()
 
         # Write the o:shapelayout element.
         self._write_shapelayout(data_id)
@@ -63,26 +69,25 @@
             for comment in comments_data:
                 # Write the v:shape element.
                 vml_shape_id += 1
                 self._write_comment_shape(vml_shape_id, z_index, comment)
                 z_index += 1
 
         if header_images_data:
-
             # Write the v:shapetype element.
             self._write_image_shapetype()
 
             index = 1
             for image in header_images_data:
                 # Write the v:shape element.
                 vml_shape_id += 1
                 self._write_image_shape(vml_shape_id, index, image)
                 index += 1
 
-        self._xml_end_tag('xml')
+        self._xml_end_tag("xml")
 
         # Close the XML writer filehandle.
         self._xml_close()
 
     def _pixels_to_points(self, vertices):
         # Convert comment vertices from pixels to points.
 
@@ -99,338 +104,340 @@
     ###########################################################################
     #
     # XML methods.
     #
     ###########################################################################
     def _write_xml_namespace(self):
         # Write the <xml> element. This is the root element of VML.
-        schema = 'urn:schemas-microsoft-com:'
-        xmlns = schema + 'vml'
-        xmlns_o = schema + 'office:office'
-        xmlns_x = schema + 'office:excel'
+        schema = "urn:schemas-microsoft-com:"
+        xmlns = schema + "vml"
+        xmlns_o = schema + "office:office"
+        xmlns_x = schema + "office:excel"
 
         attributes = [
-            ('xmlns:v', xmlns),
-            ('xmlns:o', xmlns_o),
-            ('xmlns:x', xmlns_x),
+            ("xmlns:v", xmlns),
+            ("xmlns:o", xmlns_o),
+            ("xmlns:x", xmlns_x),
         ]
 
-        self._xml_start_tag('xml', attributes)
+        self._xml_start_tag("xml", attributes)
 
     def _write_shapelayout(self, data_id):
         # Write the <o:shapelayout> element.
-        attributes = [('v:ext', 'edit')]
+        attributes = [("v:ext", "edit")]
 
-        self._xml_start_tag('o:shapelayout', attributes)
+        self._xml_start_tag("o:shapelayout", attributes)
 
         # Write the o:idmap element.
         self._write_idmap(data_id)
 
-        self._xml_end_tag('o:shapelayout')
+        self._xml_end_tag("o:shapelayout")
 
     def _write_idmap(self, data_id):
         # Write the <o:idmap> element.
         attributes = [
-            ('v:ext', 'edit'),
-            ('data', data_id),
+            ("v:ext", "edit"),
+            ("data", data_id),
         ]
 
-        self._xml_empty_tag('o:idmap', attributes)
+        self._xml_empty_tag("o:idmap", attributes)
 
     def _write_comment_shapetype(self):
         # Write the <v:shapetype> element.
-        shape_id = '_x0000_t202'
-        coordsize = '21600,21600'
+        shape_id = "_x0000_t202"
+        coordsize = "21600,21600"
         spt = 202
-        path = 'm,l,21600r21600,l21600,xe'
+        path = "m,l,21600r21600,l21600,xe"
 
         attributes = [
-            ('id', shape_id),
-            ('coordsize', coordsize),
-            ('o:spt', spt),
-            ('path', path),
+            ("id", shape_id),
+            ("coordsize", coordsize),
+            ("o:spt", spt),
+            ("path", path),
         ]
 
-        self._xml_start_tag('v:shapetype', attributes)
+        self._xml_start_tag("v:shapetype", attributes)
 
         # Write the v:stroke element.
         self._write_stroke()
 
         # Write the v:path element.
-        self._write_comment_path('t', 'rect')
+        self._write_comment_path("t", "rect")
 
-        self._xml_end_tag('v:shapetype')
+        self._xml_end_tag("v:shapetype")
 
     def _write_button_shapetype(self):
         # Write the <v:shapetype> element.
-        shape_id = '_x0000_t201'
-        coordsize = '21600,21600'
+        shape_id = "_x0000_t201"
+        coordsize = "21600,21600"
         spt = 201
-        path = 'm,l,21600r21600,l21600,xe'
+        path = "m,l,21600r21600,l21600,xe"
 
         attributes = [
-            ('id', shape_id),
-            ('coordsize', coordsize),
-            ('o:spt', spt),
-            ('path', path),
+            ("id", shape_id),
+            ("coordsize", coordsize),
+            ("o:spt", spt),
+            ("path", path),
         ]
 
-        self._xml_start_tag('v:shapetype', attributes)
+        self._xml_start_tag("v:shapetype", attributes)
 
         # Write the v:stroke element.
         self._write_stroke()
 
         # Write the v:path element.
         self._write_button_path()
 
         # Write the o:lock element.
         self._write_shapetype_lock()
 
-        self._xml_end_tag('v:shapetype')
+        self._xml_end_tag("v:shapetype")
 
     def _write_image_shapetype(self):
         # Write the <v:shapetype> element.
-        shape_id = '_x0000_t75'
-        coordsize = '21600,21600'
+        shape_id = "_x0000_t75"
+        coordsize = "21600,21600"
         spt = 75
-        o_preferrelative = 't'
-        path = 'm@4@5l@4@11@9@11@9@5xe'
-        filled = 'f'
-        stroked = 'f'
-
-        attributes = [
-            ('id', shape_id),
-            ('coordsize', coordsize),
-            ('o:spt', spt),
-            ('o:preferrelative', o_preferrelative),
-            ('path', path),
-            ('filled', filled),
-            ('stroked', stroked),
+        o_preferrelative = "t"
+        path = "m@4@5l@4@11@9@11@9@5xe"
+        filled = "f"
+        stroked = "f"
+
+        attributes = [
+            ("id", shape_id),
+            ("coordsize", coordsize),
+            ("o:spt", spt),
+            ("o:preferrelative", o_preferrelative),
+            ("path", path),
+            ("filled", filled),
+            ("stroked", stroked),
         ]
 
-        self._xml_start_tag('v:shapetype', attributes)
+        self._xml_start_tag("v:shapetype", attributes)
 
         # Write the v:stroke element.
         self._write_stroke()
 
         # Write the v:formulas element.
         self._write_formulas()
 
         # Write the v:path element.
         self._write_image_path()
 
         # Write the o:lock element.
         self._write_aspect_ratio_lock()
 
-        self._xml_end_tag('v:shapetype')
+        self._xml_end_tag("v:shapetype")
 
     def _write_stroke(self):
         # Write the <v:stroke> element.
-        joinstyle = 'miter'
+        joinstyle = "miter"
 
-        attributes = [('joinstyle', joinstyle)]
+        attributes = [("joinstyle", joinstyle)]
 
-        self._xml_empty_tag('v:stroke', attributes)
+        self._xml_empty_tag("v:stroke", attributes)
 
     def _write_comment_path(self, gradientshapeok, connecttype):
         # Write the <v:path> element.
         attributes = []
 
         if gradientshapeok:
-            attributes.append(('gradientshapeok', 't'))
+            attributes.append(("gradientshapeok", "t"))
 
-        attributes.append(('o:connecttype', connecttype))
+        attributes.append(("o:connecttype", connecttype))
 
-        self._xml_empty_tag('v:path', attributes)
+        self._xml_empty_tag("v:path", attributes)
 
     def _write_button_path(self):
         # Write the <v:path> element.
-        shadowok = 'f'
-        extrusionok = 'f'
-        strokeok = 'f'
-        fillok = 'f'
-        connecttype = 'rect'
+        shadowok = "f"
+        extrusionok = "f"
+        strokeok = "f"
+        fillok = "f"
+        connecttype = "rect"
 
         attributes = [
-            ('shadowok', shadowok),
-            ('o:extrusionok', extrusionok),
-            ('strokeok', strokeok),
-            ('fillok', fillok),
-            ('o:connecttype', connecttype),
+            ("shadowok", shadowok),
+            ("o:extrusionok", extrusionok),
+            ("strokeok", strokeok),
+            ("fillok", fillok),
+            ("o:connecttype", connecttype),
         ]
 
-        self._xml_empty_tag('v:path', attributes)
+        self._xml_empty_tag("v:path", attributes)
 
     def _write_image_path(self):
         # Write the <v:path> element.
-        extrusionok = 'f'
-        gradientshapeok = 't'
-        connecttype = 'rect'
+        extrusionok = "f"
+        gradientshapeok = "t"
+        connecttype = "rect"
 
         attributes = [
-            ('o:extrusionok', extrusionok),
-            ('gradientshapeok', gradientshapeok),
-            ('o:connecttype', connecttype),
+            ("o:extrusionok", extrusionok),
+            ("gradientshapeok", gradientshapeok),
+            ("o:connecttype", connecttype),
         ]
 
-        self._xml_empty_tag('v:path', attributes)
+        self._xml_empty_tag("v:path", attributes)
 
     def _write_shapetype_lock(self):
         # Write the <o:lock> element.
-        ext = 'edit'
-        shapetype = 't'
+        ext = "edit"
+        shapetype = "t"
 
         attributes = [
-            ('v:ext', ext),
-            ('shapetype', shapetype),
+            ("v:ext", ext),
+            ("shapetype", shapetype),
         ]
 
-        self._xml_empty_tag('o:lock', attributes)
+        self._xml_empty_tag("o:lock", attributes)
 
     def _write_rotation_lock(self):
         # Write the <o:lock> element.
-        ext = 'edit'
-        rotation = 't'
+        ext = "edit"
+        rotation = "t"
 
         attributes = [
-            ('v:ext', ext),
-            ('rotation', rotation),
+            ("v:ext", ext),
+            ("rotation", rotation),
         ]
 
-        self._xml_empty_tag('o:lock', attributes)
+        self._xml_empty_tag("o:lock", attributes)
 
     def _write_aspect_ratio_lock(self):
         # Write the <o:lock> element.
-        ext = 'edit'
-        aspectratio = 't'
+        ext = "edit"
+        aspectratio = "t"
 
         attributes = [
-            ('v:ext', ext),
-            ('aspectratio', aspectratio),
+            ("v:ext", ext),
+            ("aspectratio", aspectratio),
         ]
 
-        self._xml_empty_tag('o:lock', attributes)
+        self._xml_empty_tag("o:lock", attributes)
 
     def _write_comment_shape(self, shape_id, z_index, comment):
         # Write the <v:shape> element.
-        shape_type = '#_x0000_t202'
-        insetmode = 'auto'
-        visibility = 'hidden'
+        shape_type = "#_x0000_t202"
+        insetmode = "auto"
+        visibility = "hidden"
 
         # Set the shape index.
-        shape_id = '_x0000_s' + str(shape_id)
+        shape_id = "_x0000_s" + str(shape_id)
 
         # Get the comment parameters
         row = comment[0]
         col = comment[1]
         visible = comment[4]
         fillcolor = comment[5]
         vertices = comment[9]
 
         (left, top, width, height) = self._pixels_to_points(vertices)
 
         # Set the visibility.
         if visible:
-            visibility = 'visible'
+            visibility = "visible"
 
         style = (
-            'position:absolute;'
-            'margin-left:%.15gpt;'
-            'margin-top:%.15gpt;'
-            'width:%.15gpt;'
-            'height:%.15gpt;'
-            'z-index:%d;'
-            'visibility:%s' % (left, top, width, height, z_index, visibility))
-
-        attributes = [
-            ('id', shape_id),
-            ('type', shape_type),
-            ('style', style),
-            ('fillcolor', fillcolor),
-            ('o:insetmode', insetmode),
+            "position:absolute;"
+            "margin-left:%.15gpt;"
+            "margin-top:%.15gpt;"
+            "width:%.15gpt;"
+            "height:%.15gpt;"
+            "z-index:%d;"
+            "visibility:%s" % (left, top, width, height, z_index, visibility)
+        )
+
+        attributes = [
+            ("id", shape_id),
+            ("type", shape_type),
+            ("style", style),
+            ("fillcolor", fillcolor),
+            ("o:insetmode", insetmode),
         ]
 
-        self._xml_start_tag('v:shape', attributes)
+        self._xml_start_tag("v:shape", attributes)
 
         # Write the v:fill element.
         self._write_comment_fill()
 
         # Write the v:shadow element.
         self._write_shadow()
 
         # Write the v:path element.
-        self._write_comment_path(None, 'none')
+        self._write_comment_path(None, "none")
 
         # Write the v:textbox element.
         self._write_comment_textbox()
 
         # Write the x:ClientData element.
         self._write_comment_client_data(row, col, visible, vertices)
 
-        self._xml_end_tag('v:shape')
+        self._xml_end_tag("v:shape")
 
     def _write_button_shape(self, shape_id, z_index, button):
         # Write the <v:shape> element.
-        shape_type = '#_x0000_t201'
+        shape_type = "#_x0000_t201"
 
         # Set the shape index.
-        shape_id = '_x0000_s' + str(shape_id)
+        shape_id = "_x0000_s" + str(shape_id)
 
         # Get the button parameters.
         # row = button["_row"]
         # col = button["_col"]
         vertices = button["vertices"]
 
         (left, top, width, height) = self._pixels_to_points(vertices)
 
         style = (
-            'position:absolute;'
-            'margin-left:%.15gpt;'
-            'margin-top:%.15gpt;'
-            'width:%.15gpt;'
-            'height:%.15gpt;'
-            'z-index:%d;'
-            'mso-wrap-style:tight' % (left, top, width, height, z_index))
-
-        attributes = [
-            ('id', shape_id),
-            ('type', shape_type),
-        ]
+            "position:absolute;"
+            "margin-left:%.15gpt;"
+            "margin-top:%.15gpt;"
+            "width:%.15gpt;"
+            "height:%.15gpt;"
+            "z-index:%d;"
+            "mso-wrap-style:tight" % (left, top, width, height, z_index)
+        )
+
+        attributes = [
+            ("id", shape_id),
+            ("type", shape_type),
+        ]
+
+        if button.get("description"):
+            attributes.append(("alt", button["description"]))
+
+        attributes.append(("style", style))
+        attributes.append(("o:button", "t"))
+        attributes.append(("fillcolor", "buttonFace [67]"))
+        attributes.append(("strokecolor", "windowText [64]"))
+        attributes.append(("o:insetmode", "auto"))
 
-        if button.get('description'):
-            attributes.append(('alt', button['description']))
-
-        attributes.append(('style', style))
-        attributes.append(('o:button', 't'))
-        attributes.append(('fillcolor', 'buttonFace [67]'))
-        attributes.append(('strokecolor', 'windowText [64]'))
-        attributes.append(('o:insetmode', 'auto'))
-
-        self._xml_start_tag('v:shape', attributes)
+        self._xml_start_tag("v:shape", attributes)
 
         # Write the v:fill element.
         self._write_button_fill()
 
         # Write the o:lock element.
         self._write_rotation_lock()
 
         # Write the v:textbox element.
         self._write_button_textbox(button["font"])
 
         # Write the x:ClientData element.
         self._write_button_client_data(button)
 
-        self._xml_end_tag('v:shape')
+        self._xml_end_tag("v:shape")
 
     def _write_image_shape(self, shape_id, z_index, image_data):
         # Write the <v:shape> element.
-        shape_type = '#_x0000_t75'
+        shape_type = "#_x0000_t75"
 
         # Set the shape index.
-        shape_id = '_x0000_s' + str(shape_id)
+        shape_id = "_x0000_s" + str(shape_id)
 
         # Get the image parameters
         width = image_data[0]
         height = image_data[1]
         name = image_data[2]
         position = image_data[3]
         x_dpi = image_data[4]
@@ -442,135 +449,136 @@
         height = height * 72.0 / y_dpi
 
         # Excel uses a rounding based around 72 and 96 dpi.
         width = 72.0 / 96 * int(width * 96.0 / 72 + 0.25)
         height = 72.0 / 96 * int(height * 96.0 / 72 + 0.25)
 
         style = (
-            'position:absolute;'
-            'margin-left:0;'
-            'margin-top:0;'
-            'width:%.15gpt;'
-            'height:%.15gpt;'
-            'z-index:%d' % (width, height, z_index))
-
-        attributes = [
-            ('id', position),
-            ('o:spid', shape_id),
-            ('type', shape_type),
-            ('style', style),
+            "position:absolute;"
+            "margin-left:0;"
+            "margin-top:0;"
+            "width:%.15gpt;"
+            "height:%.15gpt;"
+            "z-index:%d" % (width, height, z_index)
+        )
+
+        attributes = [
+            ("id", position),
+            ("o:spid", shape_id),
+            ("type", shape_type),
+            ("style", style),
         ]
 
-        self._xml_start_tag('v:shape', attributes)
+        self._xml_start_tag("v:shape", attributes)
 
         # Write the v:imagedata element.
         self._write_imagedata(ref_id, name)
 
         # Write the o:lock element.
         self._write_rotation_lock()
 
-        self._xml_end_tag('v:shape')
+        self._xml_end_tag("v:shape")
 
     def _write_comment_fill(self):
         # Write the <v:fill> element.
-        color_2 = '#ffffe1'
+        color_2 = "#ffffe1"
 
-        attributes = [('color2', color_2)]
+        attributes = [("color2", color_2)]
 
-        self._xml_empty_tag('v:fill', attributes)
+        self._xml_empty_tag("v:fill", attributes)
 
     def _write_button_fill(self):
         # Write the <v:fill> element.
-        color_2 = 'buttonFace [67]'
-        detectmouseclick = 't'
+        color_2 = "buttonFace [67]"
+        detectmouseclick = "t"
 
         attributes = [
-            ('color2', color_2),
-            ('o:detectmouseclick', detectmouseclick),
+            ("color2", color_2),
+            ("o:detectmouseclick", detectmouseclick),
         ]
 
-        self._xml_empty_tag('v:fill', attributes)
+        self._xml_empty_tag("v:fill", attributes)
 
     def _write_shadow(self):
         # Write the <v:shadow> element.
-        on = 't'
-        color = 'black'
-        obscured = 't'
+        on = "t"
+        color = "black"
+        obscured = "t"
 
         attributes = [
-            ('on', on),
-            ('color', color),
-            ('obscured', obscured),
+            ("on", on),
+            ("color", color),
+            ("obscured", obscured),
         ]
 
-        self._xml_empty_tag('v:shadow', attributes)
+        self._xml_empty_tag("v:shadow", attributes)
 
     def _write_comment_textbox(self):
         # Write the <v:textbox> element.
-        style = 'mso-direction-alt:auto'
+        style = "mso-direction-alt:auto"
 
-        attributes = [('style', style)]
+        attributes = [("style", style)]
 
-        self._xml_start_tag('v:textbox', attributes)
+        self._xml_start_tag("v:textbox", attributes)
 
         # Write the div element.
-        self._write_div('left')
+        self._write_div("left")
 
-        self._xml_end_tag('v:textbox')
+        self._xml_end_tag("v:textbox")
 
     def _write_button_textbox(self, font):
         # Write the <v:textbox> element.
-        style = 'mso-direction-alt:auto'
+        style = "mso-direction-alt:auto"
 
-        attributes = [('style', style), ('o:singleclick', 'f')]
+        attributes = [("style", style), ("o:singleclick", "f")]
 
-        self._xml_start_tag('v:textbox', attributes)
+        self._xml_start_tag("v:textbox", attributes)
 
         # Write the div element.
-        self._write_div('center', font)
+        self._write_div("center", font)
 
-        self._xml_end_tag('v:textbox')
+        self._xml_end_tag("v:textbox")
 
     def _write_div(self, align, font=None):
         # Write the <div> element.
 
-        style = 'text-align:' + align
+        style = "text-align:" + align
 
-        attributes = [('style', style)]
+        attributes = [("style", style)]
 
-        self._xml_start_tag('div', attributes)
+        self._xml_start_tag("div", attributes)
 
         if font:
             # Write the font element.
             self._write_font(font)
 
-        self._xml_end_tag('div')
+        self._xml_end_tag("div")
 
     def _write_font(self, font):
         # Write the <font> element.
         caption = font["caption"]
-        face = 'Calibri'
+        face = "Calibri"
         size = 220
-        color = '#000000'
+        color = "#000000"
 
         attributes = [
-            ('face', face),
-            ('size', size),
-            ('color', color),
+            ("face", face),
+            ("size", size),
+            ("color", color),
         ]
 
-        self._xml_data_element('font', caption, attributes)
+        self._xml_data_element("font", caption, attributes)
 
     def _write_comment_client_data(self, row, col, visible, vertices):
         # Write the <x:ClientData> element.
-        object_type = 'Note'
+        object_type = "Note"
 
-        attributes = [('ObjectType', object_type)]
+        attributes = [("ObjectType", object_type)]
 
-        self._xml_start_tag('x:ClientData', attributes)
+        self._xml_start_tag("x:ClientData", attributes)
 
         # Write the x:MoveWithCells element.
         self._write_move_with_cells()
 
         # Write the x:SizeWithCells element.
         self._write_size_with_cells()
 
@@ -586,26 +594,26 @@
         # Write the x:Column element.
         self._write_column(col)
 
         # Write the x:Visible element.
         if visible:
             self._write_visible()
 
-        self._xml_end_tag('x:ClientData')
+        self._xml_end_tag("x:ClientData")
 
     def _write_button_client_data(self, button):
         # Write the <x:ClientData> element.
         macro = button["macro"]
         vertices = button["vertices"]
 
-        object_type = 'Button'
+        object_type = "Button"
 
-        attributes = [('ObjectType', object_type)]
+        attributes = [("ObjectType", object_type)]
 
-        self._xml_start_tag('x:ClientData', attributes)
+        self._xml_start_tag("x:ClientData", attributes)
 
         # Write the x:Anchor element.
         self._write_anchor(vertices)
 
         # Write the x:PrintObject element.
         self._write_print_object()
 
@@ -617,96 +625,96 @@
 
         # Write the x:TextHAlign element.
         self._write_text_halign()
 
         # Write the x:TextVAlign element.
         self._write_text_valign()
 
-        self._xml_end_tag('x:ClientData')
+        self._xml_end_tag("x:ClientData")
 
     def _write_move_with_cells(self):
         # Write the <x:MoveWithCells> element.
-        self._xml_empty_tag('x:MoveWithCells')
+        self._xml_empty_tag("x:MoveWithCells")
 
     def _write_size_with_cells(self):
         # Write the <x:SizeWithCells> element.
-        self._xml_empty_tag('x:SizeWithCells')
+        self._xml_empty_tag("x:SizeWithCells")
 
     def _write_visible(self):
         # Write the <x:Visible> element.
-        self._xml_empty_tag('x:Visible')
+        self._xml_empty_tag("x:Visible")
 
     def _write_anchor(self, vertices):
         # Write the <x:Anchor> element.
         (col_start, row_start, x1, y1, col_end, row_end, x2, y2) = vertices[:8]
 
         strings = [col_start, x1, row_start, y1, col_end, x2, row_end, y2]
         strings = [str(i) for i in strings]
 
         data = ", ".join(strings)
 
-        self._xml_data_element('x:Anchor', data)
+        self._xml_data_element("x:Anchor", data)
 
     def _write_auto_fill(self):
         # Write the <x:AutoFill> element.
-        data = 'False'
+        data = "False"
 
-        self._xml_data_element('x:AutoFill', data)
+        self._xml_data_element("x:AutoFill", data)
 
     def _write_row(self, data):
         # Write the <x:Row> element.
-        self._xml_data_element('x:Row', data)
+        self._xml_data_element("x:Row", data)
 
     def _write_column(self, data):
         # Write the <x:Column> element.
-        self._xml_data_element('x:Column', data)
+        self._xml_data_element("x:Column", data)
 
     def _write_print_object(self):
         # Write the <x:PrintObject> element.
-        self._xml_data_element('x:PrintObject', 'False')
+        self._xml_data_element("x:PrintObject", "False")
 
     def _write_text_halign(self):
         # Write the <x:TextHAlign> element.
-        self._xml_data_element('x:TextHAlign', 'Center')
+        self._xml_data_element("x:TextHAlign", "Center")
 
     def _write_text_valign(self):
         # Write the <x:TextVAlign> element.
-        self._xml_data_element('x:TextVAlign', 'Center')
+        self._xml_data_element("x:TextVAlign", "Center")
 
     def _write_fmla_macro(self, data):
         # Write the <x:FmlaMacro> element.
-        self._xml_data_element('x:FmlaMacro', data)
+        self._xml_data_element("x:FmlaMacro", data)
 
     def _write_imagedata(self, ref_id, o_title):
         # Write the <v:imagedata> element.
         attributes = [
-            ('o:relid', 'rId' + str(ref_id)),
-            ('o:title', o_title),
+            ("o:relid", "rId" + str(ref_id)),
+            ("o:title", o_title),
         ]
 
-        self._xml_empty_tag('v:imagedata', attributes)
+        self._xml_empty_tag("v:imagedata", attributes)
 
     def _write_formulas(self):
         # Write the <v:formulas> element.
-        self._xml_start_tag('v:formulas')
+        self._xml_start_tag("v:formulas")
 
         # Write the v:f elements.
-        self._write_formula('if lineDrawn pixelLineWidth 0')
-        self._write_formula('sum @0 1 0')
-        self._write_formula('sum 0 0 @1')
-        self._write_formula('prod @2 1 2')
-        self._write_formula('prod @3 21600 pixelWidth')
-        self._write_formula('prod @3 21600 pixelHeight')
-        self._write_formula('sum @0 0 1')
-        self._write_formula('prod @6 1 2')
-        self._write_formula('prod @7 21600 pixelWidth')
-        self._write_formula('sum @8 21600 0')
-        self._write_formula('prod @7 21600 pixelHeight')
-        self._write_formula('sum @10 21600 0')
+        self._write_formula("if lineDrawn pixelLineWidth 0")
+        self._write_formula("sum @0 1 0")
+        self._write_formula("sum 0 0 @1")
+        self._write_formula("prod @2 1 2")
+        self._write_formula("prod @3 21600 pixelWidth")
+        self._write_formula("prod @3 21600 pixelHeight")
+        self._write_formula("sum @0 0 1")
+        self._write_formula("prod @6 1 2")
+        self._write_formula("prod @7 21600 pixelWidth")
+        self._write_formula("sum @8 21600 0")
+        self._write_formula("prod @7 21600 pixelHeight")
+        self._write_formula("sum @10 21600 0")
 
-        self._xml_end_tag('v:formulas')
+        self._xml_end_tag("v:formulas")
 
     def _write_formula(self, eqn):
         # Write the <v:f> element.
-        attributes = [('eqn', eqn)]
+        attributes = [("eqn", eqn)]
 
-        self._xml_empty_tag('v:f', attributes)
+        self._xml_empty_tag("v:f", attributes)
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/workbook.py` & `XlsxWriter-3.1.0/xlsxwriter/workbook.py`

 * *Files 6% similar despite different names*

```diff
@@ -68,45 +68,44 @@
         if options is None:
             options = {}
 
         super(Workbook, self).__init__()
 
         self.filename = filename
 
-        self.tmpdir = options.get('tmpdir', None)
-        self.date_1904 = options.get('date_1904', False)
-        self.strings_to_numbers = options.get('strings_to_numbers', False)
-        self.strings_to_formulas = options.get('strings_to_formulas', True)
-        self.strings_to_urls = options.get('strings_to_urls', True)
-        self.nan_inf_to_errors = options.get('nan_inf_to_errors', False)
-        self.default_date_format = options.get('default_date_format', None)
-        self.constant_memory = options.get('constant_memory', False)
-        self.in_memory = options.get('in_memory', False)
-        self.excel2003_style = options.get('excel2003_style', False)
-        self.remove_timezone = options.get('remove_timezone', False)
-        self.use_future_functions = options.get('use_future_functions', False)
-        self.default_format_properties = \
-            options.get('default_format_properties', {})
+        self.tmpdir = options.get("tmpdir", None)
+        self.date_1904 = options.get("date_1904", False)
+        self.strings_to_numbers = options.get("strings_to_numbers", False)
+        self.strings_to_formulas = options.get("strings_to_formulas", True)
+        self.strings_to_urls = options.get("strings_to_urls", True)
+        self.nan_inf_to_errors = options.get("nan_inf_to_errors", False)
+        self.default_date_format = options.get("default_date_format", None)
+        self.constant_memory = options.get("constant_memory", False)
+        self.in_memory = options.get("in_memory", False)
+        self.excel2003_style = options.get("excel2003_style", False)
+        self.remove_timezone = options.get("remove_timezone", False)
+        self.use_future_functions = options.get("use_future_functions", False)
+        self.default_format_properties = options.get("default_format_properties", {})
 
-        self.max_url_length = options.get('max_url_length', 2079)
+        self.max_url_length = options.get("max_url_length", 2079)
         if self.max_url_length < 255:
             self.max_url_length = 2079
 
-        if options.get('use_zip64'):
+        if options.get("use_zip64"):
             self.allow_zip64 = True
         else:
             self.allow_zip64 = False
 
         self.worksheet_meta = WorksheetMeta()
         self.selected = 0
         self.fileclosed = 0
         self.filehandle = None
         self.internal_fh = 0
-        self.sheet_name = 'Sheet'
-        self.chart_name = 'Chart'
+        self.sheet_name = "Sheet"
+        self.chart_name = "Chart"
         self.sheetname_count = 0
         self.chartname_count = 0
         self.worksheets_objs = []
         self.charts = []
         self.drawings = []
         self.sheetnames = {}
         self.formats = []
@@ -148,25 +147,26 @@
 
         # We can't do 'constant_memory' mode while doing 'in_memory' mode.
         if self.in_memory:
             self.constant_memory = False
 
         # Add the default cell format.
         if self.excel2003_style:
-            self.add_format({'xf_index': 0, 'font_family': 0})
+            self.add_format({"xf_index": 0, "font_family": 0})
         else:
-            self.add_format({'xf_index': 0})
+            self.add_format({"xf_index": 0})
 
         # Add a default URL format.
-        self.default_url_format = self.add_format({'hyperlink': True})
+        self.default_url_format = self.add_format({"hyperlink": True})
 
         # Add the default date format.
         if self.default_date_format is not None:
-            self.default_date_format = \
-                self.add_format({'num_format': self.default_date_format})
+            self.default_date_format = self.add_format(
+                {"num_format": self.default_date_format}
+            )
 
     def __enter__(self):
         """Return self object to use with "with" statement."""
         return self
 
     def __exit__(self, type, value, traceback):
         """Close workbook when exiting "with" statement."""
@@ -214,23 +214,22 @@
         Returns:
             Reference to a Format object.
 
         """
         format_properties = self.default_format_properties.copy()
 
         if self.excel2003_style:
-            format_properties = {'font_name': 'Arial', 'font_size': 10,
-                                 'theme': 1 * -1}
+            format_properties = {"font_name": "Arial", "font_size": 10, "theme": 1 * -1}
 
         if properties:
             format_properties.update(properties)
 
-        xf_format = Format(format_properties,
-                           self.xf_format_indices,
-                           self.dxf_format_indices)
+        xf_format = Format(
+            format_properties, self.xf_format_indices, self.dxf_format_indices
+        )
 
         # Store the format reference.
         self.formats.append(xf_format)
 
         return xf_format
 
     def add_chart(self, options):
@@ -242,44 +241,44 @@
 
         Returns:
             Reference to a Chart object.
 
         """
 
         # Type must be specified so we can create the required chart instance.
-        chart_type = options.get('type')
+        chart_type = options.get("type")
         if chart_type is None:
             warn("Chart type must be defined in add_chart()")
             return
 
-        if chart_type == 'area':
+        if chart_type == "area":
             chart = ChartArea(options)
-        elif chart_type == 'bar':
+        elif chart_type == "bar":
             chart = ChartBar(options)
-        elif chart_type == 'column':
+        elif chart_type == "column":
             chart = ChartColumn(options)
-        elif chart_type == 'doughnut':
+        elif chart_type == "doughnut":
             chart = ChartDoughnut(options)
-        elif chart_type == 'line':
+        elif chart_type == "line":
             chart = ChartLine(options)
-        elif chart_type == 'pie':
+        elif chart_type == "pie":
             chart = ChartPie(options)
-        elif chart_type == 'radar':
+        elif chart_type == "radar":
             chart = ChartRadar(options)
-        elif chart_type == 'scatter':
+        elif chart_type == "scatter":
             chart = ChartScatter(options)
-        elif chart_type == 'stock':
+        elif chart_type == "stock":
             chart = ChartStock(options)
         else:
             warn("Unknown chart type '%s' in add_chart()" % chart_type)
             return
 
         # Set the embedded chart name if present.
-        if 'name' in options:
-            chart.chart_name = options['name']
+        if "name" in options:
+            chart.chart_name = options["name"]
 
         chart.embedded = True
         chart.date_1904 = self.date_1904
         chart.remove_timezone = self.remove_timezone
 
         self.charts.append(chart)
 
@@ -298,15 +297,15 @@
 
         """
         if not is_stream and not os.path.exists(vba_project):
             warn("VBA project binary file '%s' not found." % vba_project)
             return -1
 
         if self.vba_codename is None:
-            self.vba_codename = 'ThisWorkbook'
+            self.vba_codename = "ThisWorkbook"
 
         self.vba_project = vba_project
         self.vba_is_stream = is_stream
 
     def close(self):
         """
         Call finalization code and close file.
@@ -315,22 +314,23 @@
             None.
 
         Returns:
             Nothing.
 
         """
         if not self.fileclosed:
-
             try:
                 self._store_workbook()
             except IOError as e:
                 raise FileCreateError(e)
             except LargeZipFile:
-                raise FileSizeError("Filesize would require ZIP64 extensions. "
-                                    "Use workbook.use_zip64().")
+                raise FileSizeError(
+                    "Filesize would require ZIP64 extensions. "
+                    "Use workbook.use_zip64()."
+                )
 
             self.fileclosed = True
 
             # Ensure all constant_memory temp files are closed.
             if self.constant_memory:
                 for worksheet in self.worksheets():
                     worksheet._opt_close()
@@ -403,41 +403,47 @@
             property_type: The type of the custom property. Optional.
 
         Returns:
             Nothing.
 
         """
         if name is None or value is None:
-            warn("The name and value parameters must be non-None in "
-                 "set_custom_property()")
+            warn(
+                "The name and value parameters must be non-None in "
+                "set_custom_property()"
+            )
             return -1
 
         if property_type is None:
             # Determine the property type from the Python type.
             if isinstance(value, bool):
-                property_type = 'bool'
+                property_type = "bool"
             elif isinstance(value, datetime):
-                property_type = 'date'
+                property_type = "date"
             elif isinstance(value, int):
-                property_type = 'number_int'
+                property_type = "number_int"
             elif isinstance(value, (float, int, Decimal, Fraction)):
-                property_type = 'number'
+                property_type = "number"
             else:
-                property_type = 'text'
+                property_type = "text"
 
-        if property_type == 'date':
+        if property_type == "date":
             value = value.strftime("%Y-%m-%dT%H:%M:%SZ")
 
-        if property_type == 'text' and len(value) > 255:
-            warn("Length of 'value' parameter exceeds Excel's limit of 255 "
-                 "characters in set_custom_property(): '%s'" % value)
+        if property_type == "text" and len(value) > 255:
+            warn(
+                "Length of 'value' parameter exceeds Excel's limit of 255 "
+                "characters in set_custom_property(): '%s'" % value
+            )
 
         if len(name) > 255:
-            warn("Length of 'name' parameter exceeds Excel's limit of 255 "
-                 "characters in set_custom_property(): '%s'" % name)
+            warn(
+                "Length of 'name' parameter exceeds Excel's limit of 255 "
+                "characters in set_custom_property(): '%s'" % name
+            )
 
         self.custom_properties.append((name, value, property_type))
 
     def set_calc_mode(self, mode, calc_id=None):
         """
         Set the Excel calculation mode for the workbook.
 
@@ -449,18 +455,18 @@
 
         Returns:
             Nothing.
 
         """
         self.calc_mode = mode
 
-        if mode == 'manual':
+        if mode == "manual":
             self.calc_on_load = False
-        elif mode == 'auto_except_tables':
-            self.calc_mode = 'autoNoTable'
+        elif mode == "auto_except_tables":
+            self.calc_mode = "autoNoTable"
 
         # Leave undocumented for now. Rarely required.
         if calc_id:
             self.calc_id = calc_id
 
     def define_name(self, name, formula):
         # Create a defined name in Excel. We handle global/workbook level
@@ -473,22 +479,22 @@
             formula: The cell or range that the defined name refers to.
 
         Returns:
             Nothing.
 
         """
         sheet_index = None
-        sheetname = ''
+        sheetname = ""
 
         # Remove the = sign from the formula if it exists.
-        if formula.startswith('='):
-            formula = formula.lstrip('=')
+        if formula.startswith("="):
+            formula = formula.lstrip("=")
 
         # Local defined names are formatted like "Sheet1!name".
-        sheet_parts = re.compile(r'^(.*)!(.*)$')
+        sheet_parts = re.compile(r"^(.*)!(.*)$")
         match = sheet_parts.match(name)
 
         if match:
             sheetname = match.group(1)
             name = match.group(2)
             sheet_index = self._get_sheet_index(sheetname)
 
@@ -497,29 +503,28 @@
                 warn("Unknown sheet name '%s' in defined_name()" % sheetname)
                 return -1
         else:
             # Use -1 to indicate global names.
             sheet_index = -1
 
         # Warn if the defined name contains invalid chars as defined by Excel.
-        if (not re.match(r'^[\w\\][\w\\.]*$', name, re.UNICODE)
-                or re.match(r'^\d', name)):
+        if not re.match(r"^[\w\\][\w\\.]*$", name, re.UNICODE) or re.match(
+            r"^\d", name
+        ):
             warn("Invalid Excel characters in defined_name(): '%s'" % name)
             return -1
 
         # Warn if the defined name looks like a cell name.
-        if re.match(r'^[a-zA-Z][a-zA-Z]?[a-dA-D]?[0-9]+$', name):
+        if re.match(r"^[a-zA-Z][a-zA-Z]?[a-dA-D]?[0-9]+$", name):
             warn("Name looks like a cell name in defined_name(): '%s'" % name)
             return -1
 
         # Warn if the name looks like a R1C1 cell reference.
-        if (re.match(r'^[rcRC]$', name)
-                or re.match(r'^[rcRC]\d+[rcRC]\d+$', name)):
-            warn("Invalid name '%s' like a RC cell ref in defined_name()"
-                 % name)
+        if re.match(r"^[rcRC]$", name) or re.match(r"^[rcRC]\d+[rcRC]\d+$", name):
+            warn("Invalid name '%s' like a RC cell ref in defined_name()" % name)
             return -1
 
         self.defined_names.append([name, sheet_index, formula, False])
 
     def worksheets(self):
         """
         Return a list of the worksheet objects in the workbook.
@@ -585,15 +590,15 @@
         Returns:
             Nothing.
 
         """
         if name is not None:
             self.vba_codename = name
         else:
-            self.vba_codename = 'ThisWorkbook'
+            self.vba_codename = "ThisWorkbook"
 
     def read_only_recommended(self):
         """
         Set the Excel "Read-only recommended" option when saving a file.
 
         Args:
             None.
@@ -640,25 +645,28 @@
         # Write the workbook defined names.
         self._write_defined_names()
 
         # Write the calcPr element.
         self._write_calc_pr()
 
         # Close the workbook tag.
-        self._xml_end_tag('workbook')
+        self._xml_end_tag("workbook")
 
         # Close the file.
         self._xml_close()
 
     def _store_workbook(self):
-
         # Create the xlsx/zip file.
         try:
-            xlsx_file = ZipFile(self.filename, "w", compression=ZIP_DEFLATED,
-                                allowZip64=self.allow_zip64)
+            xlsx_file = ZipFile(
+                self.filename,
+                "w",
+                compression=ZIP_DEFLATED,
+                allowZip64=self.allow_zip64,
+            )
         except IOError as e:
             raise e
 
         # Assemble worksheets into a workbook.
         packager = self._get_packager()
 
         # Add a default worksheet if non have been added.
@@ -712,40 +720,38 @@
         packager = None
 
         # Add XML sub-files to the Zip file with their Excel filename.
         for file_id, file_data in enumerate(xml_files):
             os_filename, xml_filename, is_binary = file_data
 
             if self.in_memory:
-
                 # Set sub-file timestamp to Excel's timestamp of 1/1/1980.
                 zipinfo = ZipInfo(xml_filename, (1980, 1, 1, 0, 0, 0))
 
                 # Copy compression type from parent ZipFile.
                 zipinfo.compress_type = xlsx_file.compression
 
                 if is_binary:
                     xlsx_file.writestr(zipinfo, os_filename.getvalue())
                 else:
-                    xlsx_file.writestr(zipinfo,
-                                       os_filename.getvalue().encode('utf-8'))
+                    xlsx_file.writestr(zipinfo, os_filename.getvalue().encode("utf-8"))
             else:
                 # The sub-files are tempfiles on disk, i.e, not in memory.
 
                 # Set sub-file timestamp to 31/1/1980 due to portability
                 # issues setting it to Excel's timestamp of 1/1/1980.
                 timestamp = time.mktime((1980, 1, 31, 0, 0, 0, 0, 0, -1))
                 os.utime(os_filename, (timestamp, timestamp))
 
                 try:
                     xlsx_file.write(os_filename, xml_filename)
                     os.remove(os_filename)
                 except LargeZipFile as e:
                     # Close open temp files on zipfile.LargeZipFile exception.
-                    for i in range(file_id, len(xml_files)-1):
+                    for i in range(file_id, len(xml_files) - 1):
                         os.remove(xml_files[i][0])
                     raise e
 
         xlsx_file.close()
 
     def _add_sheet(self, name, worksheet_class=None):
         # Utility for shared code in add_worksheet() and add_chartsheet().
@@ -756,83 +762,83 @@
             worksheet = self.worksheet_class()
 
         sheet_index = len(self.worksheets_objs)
         name = self._check_sheetname(name, isinstance(worksheet, Chartsheet))
 
         # Initialization data to pass to the worksheet.
         init_data = {
-            'name': name,
-            'index': sheet_index,
-            'str_table': self.str_table,
-            'worksheet_meta': self.worksheet_meta,
-            'constant_memory': self.constant_memory,
-            'tmpdir': self.tmpdir,
-            'date_1904': self.date_1904,
-            'strings_to_numbers': self.strings_to_numbers,
-            'strings_to_formulas': self.strings_to_formulas,
-            'strings_to_urls': self.strings_to_urls,
-            'nan_inf_to_errors': self.nan_inf_to_errors,
-            'default_date_format': self.default_date_format,
-            'default_url_format': self.default_url_format,
-            'excel2003_style': self.excel2003_style,
-            'remove_timezone': self.remove_timezone,
-            'max_url_length': self.max_url_length,
-            'use_future_functions': self.use_future_functions,
+            "name": name,
+            "index": sheet_index,
+            "str_table": self.str_table,
+            "worksheet_meta": self.worksheet_meta,
+            "constant_memory": self.constant_memory,
+            "tmpdir": self.tmpdir,
+            "date_1904": self.date_1904,
+            "strings_to_numbers": self.strings_to_numbers,
+            "strings_to_formulas": self.strings_to_formulas,
+            "strings_to_urls": self.strings_to_urls,
+            "nan_inf_to_errors": self.nan_inf_to_errors,
+            "default_date_format": self.default_date_format,
+            "default_url_format": self.default_url_format,
+            "excel2003_style": self.excel2003_style,
+            "remove_timezone": self.remove_timezone,
+            "max_url_length": self.max_url_length,
+            "use_future_functions": self.use_future_functions,
         }
 
         worksheet._initialize(init_data)
 
         self.worksheets_objs.append(worksheet)
         self.sheetnames[name] = worksheet
 
         return worksheet
 
     def _check_sheetname(self, sheetname, is_chartsheet=False):
         # Check for valid worksheet names. We check the length, if it contains
         # any invalid chars and if the sheetname is unique in the workbook.
-        invalid_char = re.compile(r'[\[\]:*?/\\]')
+        invalid_char = re.compile(r"[\[\]:*?/\\]")
 
         # Increment the Sheet/Chart number used for default sheet names below.
         if is_chartsheet:
             self.chartname_count += 1
         else:
             self.sheetname_count += 1
 
         # Supply default Sheet/Chart sheetname if none has been defined.
-        if sheetname is None or sheetname == '':
+        if sheetname is None or sheetname == "":
             if is_chartsheet:
                 sheetname = self.chart_name + str(self.chartname_count)
             else:
                 sheetname = self.sheet_name + str(self.sheetname_count)
 
         # Check that sheet sheetname is <= 31. Excel limit.
         if len(sheetname) > 31:
             raise InvalidWorksheetName(
-                "Excel worksheet name '%s' must be <= 31 chars." %
-                sheetname)
+                "Excel worksheet name '%s' must be <= 31 chars." % sheetname
+            )
 
         # Check that sheetname doesn't contain any invalid characters.
         if invalid_char.search(sheetname):
             raise InvalidWorksheetName(
-                "Invalid Excel character '[]:*?/\\' in sheetname '%s'." %
-                sheetname)
+                "Invalid Excel character '[]:*?/\\' in sheetname '%s'." % sheetname
+            )
 
         # Check that sheetname doesn't start or end with an apostrophe.
         if sheetname.startswith("'") or sheetname.endswith("'"):
             raise InvalidWorksheetName(
-                "Sheet name cannot start or end with an apostrophe \"%s\"." %
-                sheetname)
+                'Sheet name cannot start or end with an apostrophe "%s".' % sheetname
+            )
 
         # Check that the worksheet name doesn't already exist since this is a
         # fatal Excel error. The check must be case insensitive like Excel.
         for worksheet in self.worksheets():
             if sheetname.lower() == worksheet.name.lower():
                 raise DuplicateWorksheetName(
-                    "Sheetname '%s', with case ignored, is already in use." %
-                    sheetname)
+                    "Sheetname '%s', with case ignored, is already in use." % sheetname
+                )
 
         return sheetname
 
     def _prepare_format_properties(self):
         # Prepare all Format properties prior to passing them to styles.py.
 
         # Separate format objects into XF and DXF formats.
@@ -915,43 +921,48 @@
 
         self.font_count = index
 
         # For DXF formats we only need to check if the properties have changed.
         for xf_format in self.dxf_formats:
             # The only font properties that can change for a DXF format are:
             # color, bold, italic, underline and strikethrough.
-            if (xf_format.font_color or xf_format.bold or xf_format.italic
-                    or xf_format.underline or xf_format.font_strikeout):
+            if (
+                xf_format.font_color
+                or xf_format.bold
+                or xf_format.italic
+                or xf_format.underline
+                or xf_format.font_strikeout
+            ):
                 xf_format.has_dxf_font = 1
 
     def _prepare_num_formats(self):
         # User defined records in Excel start from index 0xA4.
         unique_num_formats = {}
         num_formats = []
         index = 164
         num_format_count = 0
 
-        for xf_format in (self.xf_formats + self.dxf_formats):
+        for xf_format in self.xf_formats + self.dxf_formats:
             num_format = xf_format.num_format
 
             # Check if num_format is an index to a built-in number format.
             if not isinstance(num_format, str):
                 num_format = int(num_format)
 
                 # Number format '0' is indexed as 1 in Excel.
                 if num_format == 0:
                     num_format = 1
 
                 xf_format.num_format_index = num_format
                 continue
-            elif num_format == '0':
+            elif num_format == "0":
                 # Number format '0' is indexed as 1 in Excel.
                 xf_format.num_format_index = 1
                 continue
-            elif num_format == 'General':
+            elif num_format == "General":
                 # The 'General' format has an number format index of 0.
                 xf_format.num_format_index = 0
                 continue
 
             if num_format in unique_num_formats:
                 # Number xf_format has already been used.
                 xf_format.num_format_index = unique_num_formats[num_format]
@@ -987,15 +998,15 @@
                 xf_format.border_index = index
                 xf_format.has_border = 1
                 index += 1
 
         self.border_count = index
 
         # For DXF formats we only need to check if the properties have changed.
-        has_border = re.compile(r'[^0:]')
+        has_border = re.compile(r"[^0:]")
 
         for xf_format in self.dxf_formats:
             key = xf_format._get_border_key()
 
             if has_border.search(key):
                 xf_format.has_dxf_border = 1
 
@@ -1004,16 +1015,16 @@
         # non-default fill elements.
         # The user defined fill properties start from 2 since there are 2
         # default fills: patternType="none" and patternType="gray125".
         fills = {}
         index = 2  # Start from 2. See above.
 
         # Add the default fills.
-        fills['0:0:0'] = 0
-        fills['17:0:0'] = 1
+        fills["0:0:0"] = 0
+        fills["17:0:0"] = 1
 
         # Store the DXF colors separately since them may be reversed below.
         for xf_format in self.dxf_formats:
             if xf_format.pattern or xf_format.bg_color or xf_format.fg_color:
                 xf_format.has_dxf_fill = 1
                 xf_format.dxf_bg_color = xf_format.bg_color
                 xf_format.dxf_fg_color = xf_format.fg_color
@@ -1022,28 +1033,37 @@
             # The following logical statements jointly take care of special
             # cases in relation to cell colors and patterns:
             # 1. For a solid fill (_pattern == 1) Excel reverses the role of
             # foreground and background colors, and
             # 2. If the user specifies a foreground or background color
             # without a pattern they probably wanted a solid fill, so we fill
             # in the defaults.
-            if (xf_format.pattern == 1 and xf_format.bg_color != 0
-                    and xf_format.fg_color != 0):
+            if (
+                xf_format.pattern == 1
+                and xf_format.bg_color != 0
+                and xf_format.fg_color != 0
+            ):
                 tmp = xf_format.fg_color
                 xf_format.fg_color = xf_format.bg_color
                 xf_format.bg_color = tmp
 
-            if (xf_format.pattern <= 1 and xf_format.bg_color != 0
-                    and xf_format.fg_color == 0):
+            if (
+                xf_format.pattern <= 1
+                and xf_format.bg_color != 0
+                and xf_format.fg_color == 0
+            ):
                 xf_format.fg_color = xf_format.bg_color
                 xf_format.bg_color = 0
                 xf_format.pattern = 1
 
-            if (xf_format.pattern <= 1 and xf_format.bg_color == 0
-                    and xf_format.fg_color != 0):
+            if (
+                xf_format.pattern <= 1
+                and xf_format.bg_color == 0
+                and xf_format.fg_color != 0
+            ):
                 xf_format.pattern = 1
 
             key = xf_format._get_fill_key()
 
             if key in fills:
                 # Fill has already been used.
                 xf_format.fill_index = fills[key]
@@ -1065,38 +1085,39 @@
 
         for sheet in self.worksheets():
             # Check for Print Area settings.
             if sheet.autofilter_area:
                 hidden = 1
                 sheet_range = sheet.autofilter_area
                 # Store the defined names.
-                defined_names.append(['_xlnm._FilterDatabase',
-                                      sheet.index, sheet_range, hidden])
+                defined_names.append(
+                    ["_xlnm._FilterDatabase", sheet.index, sheet_range, hidden]
+                )
 
             # Check for Print Area settings.
             if sheet.print_area_range:
                 hidden = 0
                 sheet_range = sheet.print_area_range
                 # Store the defined names.
-                defined_names.append(['_xlnm.Print_Area',
-                                      sheet.index, sheet_range, hidden])
+                defined_names.append(
+                    ["_xlnm.Print_Area", sheet.index, sheet_range, hidden]
+                )
 
             # Check for repeat rows/cols referred to as Print Titles.
             if sheet.repeat_col_range or sheet.repeat_row_range:
                 hidden = 0
-                sheet_range = ''
+                sheet_range = ""
                 if sheet.repeat_col_range and sheet.repeat_row_range:
-                    sheet_range = (sheet.repeat_col_range + ',' +
-                                   sheet.repeat_row_range)
+                    sheet_range = sheet.repeat_col_range + "," + sheet.repeat_row_range
                 else:
-                    sheet_range = (sheet.repeat_col_range +
-                                   sheet.repeat_row_range)
+                    sheet_range = sheet.repeat_col_range + sheet.repeat_row_range
                 # Store the defined names.
-                defined_names.append(['_xlnm.Print_Titles',
-                                      sheet.index, sheet_range, hidden])
+                defined_names.append(
+                    ["_xlnm.Print_Titles", sheet.index, sheet_range, hidden]
+                )
 
         defined_names = self._sort_defined_names(defined_names)
         self.defined_names = defined_names
         self.named_ranges = self._extract_named_ranges(defined_names)
 
     def _sort_defined_names(self, names):
         # Sort the list of list of internal and user defined names in
@@ -1104,15 +1125,15 @@
 
         # Add a normalize name string to each list for sorting.
         for name_list in names:
             (defined_name, _, sheet_name, _) = name_list
 
             # Normalize the defined name by removing any leading '_xmln.'
             # from internal names and lowercasing the string.
-            defined_name = defined_name.replace('_xlnm.', '').lower()
+            defined_name = defined_name.replace("_xlnm.", "").lower()
 
             # Normalize the sheetname by removing the leading quote and
             # lowercasing the string.
             sheet_name = sheet_name.lstrip("'").lower()
 
             name_list.append(defined_name + "::" + sheet_name)
 
@@ -1141,35 +1162,47 @@
             shape_count = len(sheet.shapes)
 
             header_image_count = len(sheet.header_images)
             footer_image_count = len(sheet.footer_images)
             has_background = sheet.background_image
             has_drawing = False
 
-            if not (chart_count or image_count or shape_count
-                    or header_image_count or footer_image_count
-                    or has_background):
+            if not (
+                chart_count
+                or image_count
+                or shape_count
+                or header_image_count
+                or footer_image_count
+                or has_background
+            ):
                 continue
 
             # Don't increase the drawing_id header/footer images.
             if chart_count or image_count or shape_count:
                 drawing_id += 1
                 has_drawing = True
 
             # Prepare the background images.
             if sheet.background_image:
                 if sheet.background_bytes:
-                    filename = ''
+                    filename = ""
                     image_data = sheet.background_image
                 else:
                     filename = sheet.background_image
                     image_data = None
 
-                (image_type, width, height, name, x_dpi, y_dpi, digest) = \
-                    self._get_image_properties(filename, image_data)
+                (
+                    image_type,
+                    width,
+                    height,
+                    name,
+                    x_dpi,
+                    y_dpi,
+                    digest,
+                ) = self._get_image_properties(filename, image_data)
 
                 if digest in background_ids:
                     ref_id = background_ids[digest]
                 else:
                     image_ref_id += 1
                     ref_id = image_ref_id
                     background_ids[digest] = image_ref_id
@@ -1177,80 +1210,125 @@
 
                 sheet._prepare_background(ref_id, image_type)
 
             # Prepare the worksheet images.
             for index in range(image_count):
                 filename = sheet.images[index][2]
                 image_data = sheet.images[index][10]
-                (image_type, width, height, name, x_dpi, y_dpi, digest) = \
-                    self._get_image_properties(filename, image_data)
+                (
+                    image_type,
+                    width,
+                    height,
+                    name,
+                    x_dpi,
+                    y_dpi,
+                    digest,
+                ) = self._get_image_properties(filename, image_data)
 
                 if digest in image_ids:
                     ref_id = image_ids[digest]
                 else:
                     image_ref_id += 1
                     ref_id = image_ref_id
                     image_ids[digest] = image_ref_id
                     self.images.append([filename, image_type, image_data])
 
-                sheet._prepare_image(index, ref_id, drawing_id, width, height,
-                                     name, image_type, x_dpi, y_dpi, digest)
+                sheet._prepare_image(
+                    index,
+                    ref_id,
+                    drawing_id,
+                    width,
+                    height,
+                    name,
+                    image_type,
+                    x_dpi,
+                    y_dpi,
+                    digest,
+                )
 
             # Prepare the worksheet charts.
             for index in range(chart_count):
                 chart_ref_id += 1
                 sheet._prepare_chart(index, chart_ref_id, drawing_id)
 
             # Prepare the worksheet shapes.
             for index in range(shape_count):
                 sheet._prepare_shape(index, drawing_id)
 
             # Prepare the header images.
             for index in range(header_image_count):
-
                 filename = sheet.header_images[index][0]
                 image_data = sheet.header_images[index][1]
                 position = sheet.header_images[index][2]
 
-                (image_type, width, height, name, x_dpi, y_dpi, digest) = \
-                    self._get_image_properties(filename, image_data)
+                (
+                    image_type,
+                    width,
+                    height,
+                    name,
+                    x_dpi,
+                    y_dpi,
+                    digest,
+                ) = self._get_image_properties(filename, image_data)
 
                 if digest in header_image_ids:
                     ref_id = header_image_ids[digest]
                 else:
                     image_ref_id += 1
                     ref_id = image_ref_id
                     header_image_ids[digest] = image_ref_id
                     self.images.append([filename, image_type, image_data])
 
-                sheet._prepare_header_image(ref_id, width, height,
-                                            name, image_type, position,
-                                            x_dpi, y_dpi, digest)
+                sheet._prepare_header_image(
+                    ref_id,
+                    width,
+                    height,
+                    name,
+                    image_type,
+                    position,
+                    x_dpi,
+                    y_dpi,
+                    digest,
+                )
 
             # Prepare the footer images.
             for index in range(footer_image_count):
-
                 filename = sheet.footer_images[index][0]
                 image_data = sheet.footer_images[index][1]
                 position = sheet.footer_images[index][2]
 
-                (image_type, width, height, name, x_dpi, y_dpi, digest) = \
-                    self._get_image_properties(filename, image_data)
+                (
+                    image_type,
+                    width,
+                    height,
+                    name,
+                    x_dpi,
+                    y_dpi,
+                    digest,
+                ) = self._get_image_properties(filename, image_data)
 
                 if digest in header_image_ids:
                     ref_id = header_image_ids[digest]
                 else:
                     image_ref_id += 1
                     ref_id = image_ref_id
                     header_image_ids[digest] = image_ref_id
                     self.images.append([filename, image_type, image_data])
 
-                sheet._prepare_header_image(image_ref_id, width, height,
-                                            name, image_type, position,
-                                            x_dpi, y_dpi, digest)
+                sheet._prepare_header_image(
+                    image_ref_id,
+                    width,
+                    height,
+                    name,
+                    image_type,
+                    position,
+                    x_dpi,
+                    y_dpi,
+                    digest,
+                )
 
             if has_drawing:
                 drawing = sheet.drawing
                 self.drawings.append(drawing)
 
         # Remove charts that were created but not inserted into worksheets.
         for chart in self.charts[:]:
@@ -1280,58 +1358,58 @@
 
         digest = hashlib.sha256(data).hexdigest()
 
         # Get the image filename without the path.
         image_name = os.path.basename(filename)
 
         # Look for some common image file markers.
-        marker1 = unpack('3s', data[1:4])[0]
-        marker2 = unpack('>H', data[:2])[0]
-        marker3 = unpack('2s', data[:2])[0]
-        marker4 = unpack('<L', data[:4])[0]
-        marker5 = (unpack('4s', data[40:44]))[0]
-        marker6 = unpack('4s', data[:4])[0]
-
-        png_marker = b'PNG'
-        bmp_marker = b'BM'
-        emf_marker = b' EMF'
-        gif_marker = b'GIF8'
+        marker1 = unpack("3s", data[1:4])[0]
+        marker2 = unpack(">H", data[:2])[0]
+        marker3 = unpack("2s", data[:2])[0]
+        marker4 = unpack("<L", data[:4])[0]
+        marker5 = (unpack("4s", data[40:44]))[0]
+        marker6 = unpack("4s", data[:4])[0]
+
+        png_marker = b"PNG"
+        bmp_marker = b"BM"
+        emf_marker = b" EMF"
+        gif_marker = b"GIF8"
 
         if marker1 == png_marker:
-            self.image_types['png'] = True
+            self.image_types["png"] = True
             (image_type, width, height, x_dpi, y_dpi) = self._process_png(data)
 
         elif marker2 == 0xFFD8:
-            self.image_types['jpeg'] = True
+            self.image_types["jpeg"] = True
             (image_type, width, height, x_dpi, y_dpi) = self._process_jpg(data)
 
         elif marker3 == bmp_marker:
-            self.image_types['bmp'] = True
+            self.image_types["bmp"] = True
             (image_type, width, height) = self._process_bmp(data)
 
         elif marker4 == 0x9AC6CDD7:
-            self.image_types['wmf'] = True
+            self.image_types["wmf"] = True
             (image_type, width, height, x_dpi, y_dpi) = self._process_wmf(data)
 
         elif marker4 == 1 and marker5 == emf_marker:
-            self.image_types['emf'] = True
+            self.image_types["emf"] = True
             (image_type, width, height, x_dpi, y_dpi) = self._process_emf(data)
 
         elif marker6 == gif_marker:
-            self.image_types['gif'] = True
+            self.image_types["gif"] = True
             (image_type, width, height, x_dpi, y_dpi) = self._process_gif(data)
 
         else:
             raise UnsupportedImageFormat(
-                "%s: Unknown or unsupported image file format." % filename)
+                "%s: Unknown or unsupported image file format." % filename
+            )
 
         # Check that we found the required data.
         if not height or not width:
-            raise UndefinedImageSize(
-                "%s: no size data found in image file." % filename)
+            raise UndefinedImageSize("%s: no size data found in image file." % filename)
 
         if not image_data:
             fh.close()
 
         # Set a default dpi for images with 0 dpi.
         if x_dpi == 0:
             x_dpi = 96
@@ -1349,71 +1427,71 @@
         height = 0
         x_dpi = 96
         y_dpi = 96
 
         # Search through the image data to read the height and width in the
         # IHDR element. Also read the DPI in the pHYs element.
         while not end_marker and offset < data_length:
-
-            length = unpack('>I', data[offset + 0:offset + 4])[0]
-            marker = unpack('4s', data[offset + 4:offset + 8])[0]
+            length = unpack(">I", data[offset + 0 : offset + 4])[0]
+            marker = unpack("4s", data[offset + 4 : offset + 8])[0]
 
             # Read the image dimensions.
-            if marker == b'IHDR':
-                width = unpack('>I', data[offset + 8:offset + 12])[0]
-                height = unpack('>I', data[offset + 12:offset + 16])[0]
+            if marker == b"IHDR":
+                width = unpack(">I", data[offset + 8 : offset + 12])[0]
+                height = unpack(">I", data[offset + 12 : offset + 16])[0]
 
             # Read the image DPI.
-            if marker == b'pHYs':
-                x_density = unpack('>I', data[offset + 8:offset + 12])[0]
-                y_density = unpack('>I', data[offset + 12:offset + 16])[0]
-                units = unpack('b', data[offset + 16:offset + 17])[0]
+            if marker == b"pHYs":
+                x_density = unpack(">I", data[offset + 8 : offset + 12])[0]
+                y_density = unpack(">I", data[offset + 12 : offset + 16])[0]
+                units = unpack("b", data[offset + 16 : offset + 17])[0]
 
                 if units == 1:
                     x_dpi = x_density * 0.0254
                     y_dpi = y_density * 0.0254
 
-            if marker == b'IEND':
+            if marker == b"IEND":
                 end_marker = True
                 continue
 
             offset = offset + length + 12
 
-        return 'png', width, height, x_dpi, y_dpi
+        return "png", width, height, x_dpi, y_dpi
 
     def _process_jpg(self, data):
         # Extract width and height information from a JPEG file.
         offset = 2
         data_length = len(data)
         end_marker = False
         width = 0
         height = 0
         x_dpi = 96
         y_dpi = 96
 
         # Search through the image data to read the JPEG markers.
         while not end_marker and offset < data_length:
-
-            marker = unpack('>H', data[offset + 0:offset + 2])[0]
-            length = unpack('>H', data[offset + 2:offset + 4])[0]
+            marker = unpack(">H", data[offset + 0 : offset + 2])[0]
+            length = unpack(">H", data[offset + 2 : offset + 4])[0]
 
             # Read the height and width in the 0xFFCn elements (except C4, C8
             # and CC which aren't SOF markers).
-            if ((marker & 0xFFF0) == 0xFFC0
-                    and marker != 0xFFC4
-                    and marker != 0xFFC8
-                    and marker != 0xFFCC):
-                height = unpack('>H', data[offset + 5:offset + 7])[0]
-                width = unpack('>H', data[offset + 7:offset + 9])[0]
+            if (
+                (marker & 0xFFF0) == 0xFFC0
+                and marker != 0xFFC4
+                and marker != 0xFFC8
+                and marker != 0xFFCC
+            ):
+                height = unpack(">H", data[offset + 5 : offset + 7])[0]
+                width = unpack(">H", data[offset + 7 : offset + 9])[0]
 
             # Read the DPI in the 0xFFE0 element.
             if marker == 0xFFE0:
-                units = unpack('b', data[offset + 11:offset + 12])[0]
-                x_density = unpack('>H', data[offset + 12:offset + 14])[0]
-                y_density = unpack('>H', data[offset + 14:offset + 16])[0]
+                units = unpack("b", data[offset + 11 : offset + 12])[0]
+                x_density = unpack(">H", data[offset + 12 : offset + 14])[0]
+                y_density = unpack(">H", data[offset + 14 : offset + 16])[0]
 
                 if units == 1:
                     x_dpi = x_density
                     y_dpi = y_density
 
                 if units == 2:
                     x_dpi = x_density * 2.54
@@ -1427,31 +1505,31 @@
 
             if marker == 0xFFDA:
                 end_marker = True
                 continue
 
             offset = offset + length + 2
 
-        return 'jpeg', width, height, x_dpi, y_dpi
+        return "jpeg", width, height, x_dpi, y_dpi
 
     def _process_gif(self, data):
         # Extract width and height information from a GIF file.
         x_dpi = 96
         y_dpi = 96
 
-        width = unpack('<h', data[6:8])[0]
-        height = unpack('<h', data[8:10])[0]
+        width = unpack("<h", data[6:8])[0]
+        height = unpack("<h", data[8:10])[0]
 
-        return 'gif', width, height, x_dpi, y_dpi
+        return "gif", width, height, x_dpi, y_dpi
 
     def _process_bmp(self, data):
         # Extract width and height information from a BMP file.
-        width = unpack('<L', data[18:22])[0]
-        height = unpack('<L', data[22:26])[0]
-        return 'bmp', width, height
+        width = unpack("<L", data[18:22])[0]
+        height = unpack("<L", data[22:26])[0]
+        return "bmp", width, height
 
     def _process_wmf(self, data):
         # Extract width and height information from a WMF file.
         x_dpi = 96
         y_dpi = 96
 
         # Read the bounding box, measured in logical units.
@@ -1463,15 +1541,15 @@
         # Read the number of logical units per inch. Used to scale the image.
         inch = unpack("<H", data[14:16])[0]
 
         # Convert to rendered height and width.
         width = float((x2 - x1) * x_dpi) / inch
         height = float((y2 - y1) * y_dpi) / inch
 
-        return 'wmf', width, height, x_dpi, y_dpi
+        return "wmf", width, height, x_dpi, y_dpi
 
     def _process_emf(self, data):
         # Extract width and height information from a EMF file.
 
         # Read the bounding box, measured in logical units.
         bound_x1 = unpack("<l", data[8:12])[0]
         bound_y1 = unpack("<l", data[12:16])[0]
@@ -1497,41 +1575,40 @@
         y_dpi = height * 25.4 / height_mm
 
         # This is to match Excel's calculation. It is probably to account for
         # the fact that the bounding box is inclusive-inclusive. Or a bug.
         width += 1
         height += 1
 
-        return 'emf', width, height, x_dpi, y_dpi
+        return "emf", width, height, x_dpi, y_dpi
 
     def _extract_named_ranges(self, defined_names):
         # Extract the named ranges from the sorted list of defined names.
         # These are used in the App.xml file.
         named_ranges = []
 
         for defined_name in defined_names:
-
             name = defined_name[0]
             index = defined_name[1]
             sheet_range = defined_name[2]
 
             # Skip autoFilter ranges.
-            if name == '_xlnm._FilterDatabase':
+            if name == "_xlnm._FilterDatabase":
                 continue
 
             # We are only interested in defined names with ranges.
-            if '!' in sheet_range:
-                sheet_name, _ = sheet_range.split('!', 1)
+            if "!" in sheet_range:
+                sheet_name, _ = sheet_range.split("!", 1)
 
                 # Match Print_Area and Print_Titles xlnm types.
-                if name.startswith('_xlnm.'):
-                    xlnm_type = name.replace('_xlnm.', '')
-                    name = sheet_name + '!' + xlnm_type
+                if name.startswith("_xlnm."):
+                    xlnm_type = name.replace("_xlnm.", "")
+                    name = sheet_name + "!" + xlnm_type
                 elif index != -1:
-                    name = sheet_name + '!' + name
+                    name = sheet_name + "!" + name
 
                 named_ranges.append(name)
 
         return named_ranges
 
     def _get_sheet_index(self, sheetname):
         # Convert a sheet name to its index. Return None otherwise.
@@ -1562,28 +1639,26 @@
                 if sheet.has_comments:
                     comment_files += 1
                     comment_id += 1
                     self.has_comments = True
 
                 vml_drawing_id += 1
 
-                count = sheet._prepare_vml_objects(vml_data_id,
-                                                   vml_shape_id,
-                                                   vml_drawing_id,
-                                                   comment_id)
+                count = sheet._prepare_vml_objects(
+                    vml_data_id, vml_shape_id, vml_drawing_id, comment_id
+                )
 
                 # Each VML should start with a shape id incremented by 1024.
                 vml_data_id += 1 * int((1024 + count) / 1024)
                 vml_shape_id += 1024 * int((1024 + count) / 1024)
 
             if sheet.has_header_vml:
                 vml_header_id += 1
                 vml_drawing_id += 1
-                sheet._prepare_header_vml_objects(vml_header_id,
-                                                  vml_drawing_id)
+                sheet._prepare_header_vml_objects(vml_header_id, vml_drawing_id)
 
             self.num_vml_files = vml_files
             self.num_comment_files = comment_files
 
     def _prepare_tables(self):
         # Set the table ids for the worksheet tables.
         table_id = 0
@@ -1618,22 +1693,20 @@
         # Build a list of the worksheet charts including any combined charts.
         for chart in self.charts:
             charts.append(chart)
             if chart.combined:
                 charts.append(chart.combined)
 
         for chart in charts:
-
             for c_range in chart.formula_ids.keys():
                 r_id = chart.formula_ids[c_range]
 
                 # Skip if the series has user defined data.
                 if chart.formula_data[r_id] is not None:
-                    if (c_range not in seen_ranges
-                            or seen_ranges[c_range] is None):
+                    if c_range not in seen_ranges or seen_ranges[c_range] is None:
                         data = chart.formula_data[r_id]
                         seen_ranges[c_range] = data
                     continue
 
                 # Check to see if the data is already cached locally.
                 if c_range in seen_ranges:
                     chart.formula_data[r_id] = seen_ranges[c_range]
@@ -1645,24 +1718,26 @@
                 # Skip if we couldn't parse the formula.
                 if sheetname is None:
                     continue
 
                 # Handle non-contiguous ranges like:
                 #     (Sheet1!$A$1:$A$2,Sheet1!$A$4:$A$5).
                 # We don't try to parse them. We just return an empty list.
-                if sheetname.startswith('('):
+                if sheetname.startswith("("):
                     chart.formula_data[r_id] = []
                     seen_ranges[c_range] = []
                     continue
 
                 # Warn if the name is unknown since it indicates a user error
                 # in a chart series formula.
                 if sheetname not in worksheets:
-                    warn("Unknown worksheet reference '%s' in range "
-                         "'%s' passed to add_series()" % (sheetname, c_range))
+                    warn(
+                        "Unknown worksheet reference '%s' in range "
+                        "'%s' passed to add_series()" % (sheetname, c_range)
+                    )
                     chart.formula_data[r_id] = []
                     seen_ranges[c_range] = []
                     continue
 
                 # Find the worksheet object based on the sheet name.
                 worksheet = worksheets[sheetname]
 
@@ -1678,24 +1753,24 @@
                 seen_ranges[c_range] = data
 
     def _get_chart_range(self, c_range):
         # Convert a range formula such as Sheet1!$B$1:$B$5 into a sheet name
         # and cell range such as ( 'Sheet1', 0, 1, 4, 1 ).
 
         # Split the range formula into sheetname and cells at the last '!'.
-        pos = c_range.rfind('!')
+        pos = c_range.rfind("!")
         if pos > 0:
             sheetname = c_range[:pos]
-            cells = c_range[pos + 1:]
+            cells = c_range[pos + 1 :]
         else:
             return None, None
 
         # Split the cell range into 2 cells or else use single cell for both.
-        if cells.find(':') > 0:
-            (cell_1, cell_2) = cells.split(':', 1)
+        if cells.find(":") > 0:
+            (cell_1, cell_2) = cells.split(":", 1)
         else:
             (cell_1, cell_2) = (cells, cells)
 
         # Remove leading/trailing quotes and convert escaped quotes to single.
         sheetname = sheetname.strip("'")
         sheetname = sheetname.replace("''", "'")
 
@@ -1727,166 +1802,165 @@
     # XML methods.
     #
     ###########################################################################
 
     def _write_workbook(self):
         # Write <workbook> element.
 
-        schema = 'http://schemas.openxmlformats.org'
-        xmlns = schema + '/spreadsheetml/2006/main'
-        xmlns_r = schema + '/officeDocument/2006/relationships'
+        schema = "http://schemas.openxmlformats.org"
+        xmlns = schema + "/spreadsheetml/2006/main"
+        xmlns_r = schema + "/officeDocument/2006/relationships"
 
         attributes = [
-            ('xmlns', xmlns),
-            ('xmlns:r', xmlns_r),
+            ("xmlns", xmlns),
+            ("xmlns:r", xmlns_r),
         ]
 
-        self._xml_start_tag('workbook', attributes)
+        self._xml_start_tag("workbook", attributes)
 
     def _write_file_version(self):
         # Write the <fileVersion> element.
 
-        app_name = 'xl'
+        app_name = "xl"
         last_edited = 4
         lowest_edited = 4
         rup_build = 4505
 
         attributes = [
-            ('appName', app_name),
-            ('lastEdited', last_edited),
-            ('lowestEdited', lowest_edited),
-            ('rupBuild', rup_build),
+            ("appName", app_name),
+            ("lastEdited", last_edited),
+            ("lowestEdited", lowest_edited),
+            ("rupBuild", rup_build),
         ]
 
         if self.vba_project:
-            attributes.append(
-                ('codeName', '{37E998C4-C9E5-D4B9-71C8-EB1FF731991C}'))
+            attributes.append(("codeName", "{37E998C4-C9E5-D4B9-71C8-EB1FF731991C}"))
 
-        self._xml_empty_tag('fileVersion', attributes)
+        self._xml_empty_tag("fileVersion", attributes)
 
     def _write_file_sharing(self):
         # Write the <fileSharing> element.
         if self.read_only == 0:
             return
 
-        attributes = [('readOnlyRecommended', 1)]
+        attributes = [("readOnlyRecommended", 1)]
 
-        self._xml_empty_tag('fileSharing', attributes)
+        self._xml_empty_tag("fileSharing", attributes)
 
     def _write_workbook_pr(self):
         # Write <workbookPr> element.
         default_theme_version = 124226
         attributes = []
 
         if self.vba_codename:
-            attributes.append(('codeName', self.vba_codename))
+            attributes.append(("codeName", self.vba_codename))
         if self.date_1904:
-            attributes.append(('date1904', 1))
+            attributes.append(("date1904", 1))
 
-        attributes.append(('defaultThemeVersion', default_theme_version))
+        attributes.append(("defaultThemeVersion", default_theme_version))
 
-        self._xml_empty_tag('workbookPr', attributes)
+        self._xml_empty_tag("workbookPr", attributes)
 
     def _write_book_views(self):
         # Write <bookViews> element.
-        self._xml_start_tag('bookViews')
+        self._xml_start_tag("bookViews")
         self._write_workbook_view()
-        self._xml_end_tag('bookViews')
+        self._xml_end_tag("bookViews")
 
     def _write_workbook_view(self):
         # Write <workbookView> element.
         attributes = [
-            ('xWindow', self.x_window),
-            ('yWindow', self.y_window),
-            ('windowWidth', self.window_width),
-            ('windowHeight', self.window_height),
+            ("xWindow", self.x_window),
+            ("yWindow", self.y_window),
+            ("windowWidth", self.window_width),
+            ("windowHeight", self.window_height),
         ]
 
         # Store the tabRatio attribute when it isn't the default.
         if self.tab_ratio != 600:
-            attributes.append(('tabRatio', self.tab_ratio))
+            attributes.append(("tabRatio", self.tab_ratio))
 
         # Store the firstSheet attribute when it isn't the default.
         if self.worksheet_meta.firstsheet > 0:
             firstsheet = self.worksheet_meta.firstsheet + 1
-            attributes.append(('firstSheet', firstsheet))
+            attributes.append(("firstSheet", firstsheet))
 
         # Store the activeTab attribute when it isn't the first sheet.
         if self.worksheet_meta.activesheet > 0:
-            attributes.append(('activeTab', self.worksheet_meta.activesheet))
+            attributes.append(("activeTab", self.worksheet_meta.activesheet))
 
-        self._xml_empty_tag('workbookView', attributes)
+        self._xml_empty_tag("workbookView", attributes)
 
     def _write_sheets(self):
         # Write <sheets> element.
-        self._xml_start_tag('sheets')
+        self._xml_start_tag("sheets")
 
         id_num = 1
         for worksheet in self.worksheets():
             self._write_sheet(worksheet.name, id_num, worksheet.hidden)
             id_num += 1
 
-        self._xml_end_tag('sheets')
+        self._xml_end_tag("sheets")
 
     def _write_sheet(self, name, sheet_id, hidden):
         # Write <sheet> element.
         attributes = [
-            ('name', name),
-            ('sheetId', sheet_id),
+            ("name", name),
+            ("sheetId", sheet_id),
         ]
 
         if hidden:
-            attributes.append(('state', 'hidden'))
+            attributes.append(("state", "hidden"))
 
-        attributes.append(('r:id', 'rId' + str(sheet_id)))
+        attributes.append(("r:id", "rId" + str(sheet_id)))
 
-        self._xml_empty_tag('sheet', attributes)
+        self._xml_empty_tag("sheet", attributes)
 
     def _write_calc_pr(self):
         # Write the <calcPr> element.
-        attributes = [('calcId', self.calc_id)]
+        attributes = [("calcId", self.calc_id)]
 
-        if self.calc_mode == 'manual':
-            attributes.append(('calcMode', self.calc_mode))
-            attributes.append(('calcOnSave', "0"))
-        elif self.calc_mode == 'autoNoTable':
-            attributes.append(('calcMode', self.calc_mode))
+        if self.calc_mode == "manual":
+            attributes.append(("calcMode", self.calc_mode))
+            attributes.append(("calcOnSave", "0"))
+        elif self.calc_mode == "autoNoTable":
+            attributes.append(("calcMode", self.calc_mode))
 
         if self.calc_on_load:
-            attributes.append(('fullCalcOnLoad', '1'))
+            attributes.append(("fullCalcOnLoad", "1"))
 
-        self._xml_empty_tag('calcPr', attributes)
+        self._xml_empty_tag("calcPr", attributes)
 
     def _write_defined_names(self):
         # Write the <definedNames> element.
         if not self.defined_names:
             return
 
-        self._xml_start_tag('definedNames')
+        self._xml_start_tag("definedNames")
 
         for defined_name in self.defined_names:
             self._write_defined_name(defined_name)
 
-        self._xml_end_tag('definedNames')
+        self._xml_end_tag("definedNames")
 
     def _write_defined_name(self, defined_name):
         # Write the <definedName> element.
         name = defined_name[0]
         sheet_id = defined_name[1]
         sheet_range = defined_name[2]
         hidden = defined_name[3]
 
-        attributes = [('name', name)]
+        attributes = [("name", name)]
 
         if sheet_id != -1:
-            attributes.append(('localSheetId', sheet_id))
+            attributes.append(("localSheetId", sheet_id))
         if hidden:
-            attributes.append(('hidden', 1))
+            attributes.append(("hidden", 1))
 
-        self._xml_data_element('definedName', sheet_range, attributes)
+        self._xml_data_element("definedName", sheet_range, attributes)
 
 
 # A metadata class to share data between worksheets.
 class WorksheetMeta(object):
     """
     A class to track worksheets data such as the active sheet and the
     first sheet.
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/worksheet.py` & `XlsxWriter-3.1.0/xlsxwriter/worksheet.py`

 * *Files 9% similar despite different names*

```diff
@@ -80,17591 +80,17521 @@
 000004f0: 6f6e 7320 696d 706f 7274 204f 7665 726c  ons import Overl
 00000500: 6170 7069 6e67 5261 6e67 650a 0a23 2043  appingRange..# C
 00000510: 6f6d 7069 6c65 2070 6572 666f 726d 616e  ompile performan
 00000520: 6365 2063 7269 7469 6361 6c20 7265 6775  ce critical regu
 00000530: 6c61 7220 6578 7072 6573 7369 6f6e 732e  lar expressions.
 00000540: 0a72 655f 636f 6e74 726f 6c5f 6368 6172  .re_control_char
 00000550: 735f 3120 3d20 7265 2e63 6f6d 7069 6c65  s_1 = re.compile
-00000560: 2827 285f 785b 302d 3961 2d66 412d 465d  ('(_x[0-9a-fA-F]
-00000570: 7b34 7d5f 2927 290a 7265 5f63 6f6e 7472  {4}_)').re_contr
+00000560: 2822 285f 785b 302d 3961 2d66 412d 465d  ("(_x[0-9a-fA-F]
+00000570: 7b34 7d5f 2922 290a 7265 5f63 6f6e 7472  {4}_)").re_contr
 00000580: 6f6c 5f63 6861 7273 5f32 203d 2072 652e  ol_chars_2 = re.
-00000590: 636f 6d70 696c 6528 7227 285b 5c78 3030  compile(r'([\x00
+00000590: 636f 6d70 696c 6528 7222 285b 5c78 3030  compile(r"([\x00
 000005a0: 2d5c 7830 385c 7830 622d 5c78 3166 5d29  -\x08\x0b-\x1f])
-000005b0: 2729 0a0a 7265 5f64 796e 616d 6963 5f66  ')..re_dynamic_f
+000005b0: 2229 0a0a 7265 5f64 796e 616d 6963 5f66  ")..re_dynamic_f
 000005c0: 756e 6374 696f 6e20 3d20 7265 2e63 6f6d  unction = re.com
-000005d0: 7069 6c65 2872 2222 220a 2020 2020 5c62  pile(r""".    \b
-000005e0: 534f 5254 5c28 2020 2020 2020 207c 0a20  SORT\(       |. 
-000005f0: 2020 205c 624c 4554 5c28 2020 2020 2020     \bLET\(      
-00000600: 2020 7c0a 2020 2020 5c62 4c41 4d42 4441    |.    \bLAMBDA
-00000610: 5c28 2020 2020 207c 0a20 2020 205c 6253  \(     |.    \bS
-00000620: 494e 474c 455c 2820 2020 2020 7c0a 2020  INGLE\(     |.  
-00000630: 2020 5c62 534f 5254 4259 5c28 2020 2020    \bSORTBY\(    
-00000640: 207c 0a20 2020 205c 6255 4e49 5155 455c   |.    \bUNIQUE\
-00000650: 2820 2020 2020 7c0a 2020 2020 5c62 584d  (     |.    \bXM
-00000660: 4154 4348 5c28 2020 2020 207c 0a20 2020  ATCH\(     |.   
-00000670: 205c 6246 494c 5445 525c 2820 2020 2020   \bFILTER\(     
-00000680: 7c0a 2020 2020 5c62 584c 4f4f 4b55 505c  |.    \bXLOOKUP\
-00000690: 2820 2020 207c 0a20 2020 205c 6253 4551  (    |.    \bSEQ
-000006a0: 5545 4e43 455c 2820 2020 7c0a 2020 2020  UENCE\(   |.    
-000006b0: 5c62 5241 4e44 4152 5241 595c 2820 207c  \bRANDARRAY\(  |
-000006c0: 0a20 2020 205c 6241 4e43 484f 5241 5252  .    \bANCHORARR
-000006d0: 4159 5c28 2222 222c 2072 652e 5645 5242  AY\(""", re.VERB
-000006e0: 4f53 4529 0a0a 0a23 2323 2323 2323 2323  OSE)...#########
-000006f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000005d0: 7069 6c65 280a 2020 2020 7222 2222 0a20  pile(.    r""". 
+000005e0: 2020 205c 6253 4f52 545c 2820 2020 2020     \bSORT\(     
+000005f0: 2020 7c0a 2020 2020 5c62 4c45 545c 2820    |.    \bLET\( 
+00000600: 2020 2020 2020 207c 0a20 2020 205c 624c         |.    \bL
+00000610: 414d 4244 415c 2820 2020 2020 7c0a 2020  AMBDA\(     |.  
+00000620: 2020 5c62 5349 4e47 4c45 5c28 2020 2020    \bSINGLE\(    
+00000630: 207c 0a20 2020 205c 6253 4f52 5442 595c   |.    \bSORTBY\
+00000640: 2820 2020 2020 7c0a 2020 2020 5c62 554e  (     |.    \bUN
+00000650: 4951 5545 5c28 2020 2020 207c 0a20 2020  IQUE\(     |.   
+00000660: 205c 6258 4d41 5443 485c 2820 2020 2020   \bXMATCH\(     
+00000670: 7c0a 2020 2020 5c62 4649 4c54 4552 5c28  |.    \bFILTER\(
+00000680: 2020 2020 207c 0a20 2020 205c 6258 4c4f       |.    \bXLO
+00000690: 4f4b 5550 5c28 2020 2020 7c0a 2020 2020  OKUP\(    |.    
+000006a0: 5c62 5345 5155 454e 4345 5c28 2020 207c  \bSEQUENCE\(   |
+000006b0: 0a20 2020 205c 6252 414e 4441 5252 4159  .    \bRANDARRAY
+000006c0: 5c28 2020 7c0a 2020 2020 5c62 414e 4348  \(  |.    \bANCH
+000006d0: 4f52 4152 5241 595c 2822 2222 2c0a 2020  ORARRAY\(""",.  
+000006e0: 2020 7265 2e56 4552 424f 5345 2c0a 290a    re.VERBOSE,.).
+000006f0: 0a0a 2323 2323 2323 2323 2323 2323 2323  ..##############
 00000700: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00000710: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00000720: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00000730: 2323 2323 2323 0a23 0a23 2044 6563 6f72  ######.#.# Decor
-00000740: 6174 6f72 2066 756e 6374 696f 6e73 2e0a  ator functions..
-00000750: 230a 2323 2323 2323 2323 2323 2323 2323  #.##############
+00000730: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00000740: 230a 230a 2320 4465 636f 7261 746f 7220  #.#.# Decorator 
+00000750: 6675 6e63 7469 6f6e 732e 0a23 0a23 2323  functions..#.###
 00000760: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00000770: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00000780: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00000790: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000007a0: 230a 6465 6620 636f 6e76 6572 745f 6365  #.def convert_ce
-000007b0: 6c6c 5f61 7267 7328 6d65 7468 6f64 293a  ll_args(method):
-000007c0: 0a20 2020 2022 2222 0a20 2020 2044 6563  .    """.    Dec
-000007d0: 6f72 6174 6f72 2066 756e 6374 696f 6e20  orator function 
-000007e0: 746f 2063 6f6e 7665 7274 2041 3120 6e6f  to convert A1 no
-000007f0: 7461 7469 6f6e 2069 6e20 6365 6c6c 206d  tation in cell m
-00000800: 6574 686f 6420 6361 6c6c 730a 2020 2020  ethod calls.    
-00000810: 746f 2074 6865 2064 6566 6175 6c74 2072  to the default r
-00000820: 6f77 2f63 6f6c 206e 6f74 6174 696f 6e2e  ow/col notation.
-00000830: 0a0a 2020 2020 2222 220a 2020 2020 4077  ..    """.    @w
-00000840: 7261 7073 286d 6574 686f 6429 0a20 2020  raps(method).   
-00000850: 2064 6566 2063 656c 6c5f 7772 6170 7065   def cell_wrappe
-00000860: 7228 7365 6c66 2c20 2a61 7267 732c 202a  r(self, *args, *
-00000870: 2a6b 7761 7267 7329 3a0a 0a20 2020 2020  *kwargs):..     
-00000880: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-00000890: 2020 2020 2320 4669 7273 7420 6172 6720      # First arg 
-000008a0: 6973 2061 6e20 696e 742c 2064 6566 6175  is an int, defau
-000008b0: 6c74 2074 6f20 726f 772f 636f 6c20 6e6f  lt to row/col no
-000008c0: 7461 7469 6f6e 2e0a 2020 2020 2020 2020  tation..        
-000008d0: 2020 2020 6966 2061 7267 733a 0a20 2020      if args:.   
-000008e0: 2020 2020 2020 2020 2020 2020 2066 6972               fir
-000008f0: 7374 5f61 7267 203d 2061 7267 735b 305d  st_arg = args[0]
-00000900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000910: 2069 6e74 2866 6972 7374 5f61 7267 290a   int(first_arg).
-00000920: 2020 2020 2020 2020 6578 6365 7074 2056          except V
-00000930: 616c 7565 4572 726f 723a 0a20 2020 2020  alueError:.     
-00000940: 2020 2020 2020 2023 2046 6972 7374 2061         # First a
-00000950: 7267 2069 736e 2774 2061 6e20 696e 742c  rg isn't an int,
-00000960: 2063 6f6e 7665 7274 2074 6f20 4131 206e   convert to A1 n
-00000970: 6f74 6174 696f 6e2e 0a20 2020 2020 2020  otation..       
-00000980: 2020 2020 206e 6577 5f61 7267 7320 3d20       new_args = 
-00000990: 786c 5f63 656c 6c5f 746f 5f72 6f77 636f  xl_cell_to_rowco
-000009a0: 6c28 6669 7273 745f 6172 6729 0a20 2020  l(first_arg).   
-000009b0: 2020 2020 2020 2020 2061 7267 7320 3d20           args = 
-000009c0: 6e65 775f 6172 6773 202b 2061 7267 735b  new_args + args[
-000009d0: 313a 5d0a 0a20 2020 2020 2020 2072 6574  1:]..        ret
-000009e0: 7572 6e20 6d65 7468 6f64 2873 656c 662c  urn method(self,
-000009f0: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-00000a00: 290a 0a20 2020 2072 6574 7572 6e20 6365  )..    return ce
-00000a10: 6c6c 5f77 7261 7070 6572 0a0a 0a64 6566  ll_wrapper...def
-00000a20: 2063 6f6e 7665 7274 5f72 616e 6765 5f61   convert_range_a
-00000a30: 7267 7328 6d65 7468 6f64 293a 0a20 2020  rgs(method):.   
-00000a40: 2022 2222 0a20 2020 2044 6563 6f72 6174   """.    Decorat
-00000a50: 6f72 2066 756e 6374 696f 6e20 746f 2063  or function to c
-00000a60: 6f6e 7665 7274 2041 3120 6e6f 7461 7469  onvert A1 notati
-00000a70: 6f6e 2069 6e20 7261 6e67 6520 6d65 7468  on in range meth
-00000a80: 6f64 2063 616c 6c73 0a20 2020 2074 6f20  od calls.    to 
-00000a90: 7468 6520 6465 6661 756c 7420 726f 772f  the default row/
-00000aa0: 636f 6c20 6e6f 7461 7469 6f6e 2e0a 0a20  col notation... 
-00000ab0: 2020 2022 2222 0a20 2020 2040 7772 6170     """.    @wrap
-00000ac0: 7328 6d65 7468 6f64 290a 2020 2020 6465  s(method).    de
-00000ad0: 6620 6365 6c6c 5f77 7261 7070 6572 2873  f cell_wrapper(s
-00000ae0: 656c 662c 202a 6172 6773 2c20 2a2a 6b77  elf, *args, **kw
-00000af0: 6172 6773 293a 0a0a 2020 2020 2020 2020  args):..        
-00000b00: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-00000b10: 2023 2046 6972 7374 2061 7267 2069 7320   # First arg is 
-00000b20: 616e 2069 6e74 2c20 6465 6661 756c 7420  an int, default 
-00000b30: 746f 2072 6f77 2f63 6f6c 206e 6f74 6174  to row/col notat
-00000b40: 696f 6e2e 0a20 2020 2020 2020 2020 2020  ion..           
-00000b50: 2069 6620 6172 6773 3a0a 2020 2020 2020   if args:.      
-00000b60: 2020 2020 2020 2020 2020 696e 7428 6172            int(ar
-00000b70: 6773 5b30 5d29 0a20 2020 2020 2020 2065  gs[0]).        e
-00000b80: 7863 6570 7420 5661 6c75 6545 7272 6f72  xcept ValueError
-00000b90: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-00000ba0: 4669 7273 7420 6172 6720 6973 6e27 7420  First arg isn't 
-00000bb0: 616e 2069 6e74 2c20 636f 6e76 6572 7420  an int, convert 
-00000bc0: 746f 2041 3120 6e6f 7461 7469 6f6e 2e0a  to A1 notation..
-00000bd0: 2020 2020 2020 2020 2020 2020 6966 2027              if '
-00000be0: 3a27 2069 6e20 6172 6773 5b30 5d3a 0a20  :' in args[0]:. 
-00000bf0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00000c00: 656c 6c5f 312c 2063 656c 6c5f 3220 3d20  ell_1, cell_2 = 
-00000c10: 6172 6773 5b30 5d2e 7370 6c69 7428 273a  args[0].split(':
-00000c20: 2729 0a20 2020 2020 2020 2020 2020 2020  ').             
-00000c30: 2020 2072 6f77 5f31 2c20 636f 6c5f 3120     row_1, col_1 
-00000c40: 3d20 786c 5f63 656c 6c5f 746f 5f72 6f77  = xl_cell_to_row
-00000c50: 636f 6c28 6365 6c6c 5f31 290a 2020 2020  col(cell_1).    
-00000c60: 2020 2020 2020 2020 2020 2020 726f 775f              row_
-00000c70: 322c 2063 6f6c 5f32 203d 2078 6c5f 6365  2, col_2 = xl_ce
-00000c80: 6c6c 5f74 6f5f 726f 7763 6f6c 2863 656c  ll_to_rowcol(cel
-00000c90: 6c5f 3229 0a20 2020 2020 2020 2020 2020  l_2).           
-00000ca0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00000cb0: 2020 2020 2020 2072 6f77 5f31 2c20 636f         row_1, co
-00000cc0: 6c5f 3120 3d20 786c 5f63 656c 6c5f 746f  l_1 = xl_cell_to
-00000cd0: 5f72 6f77 636f 6c28 6172 6773 5b30 5d29  _rowcol(args[0])
-00000ce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00000cf0: 2072 6f77 5f32 2c20 636f 6c5f 3220 3d20   row_2, col_2 = 
-00000d00: 726f 775f 312c 2063 6f6c 5f31 0a0a 2020  row_1, col_1..  
-00000d10: 2020 2020 2020 2020 2020 6e65 775f 6172            new_ar
-00000d20: 6773 203d 205b 726f 775f 312c 2063 6f6c  gs = [row_1, col
-00000d30: 5f31 2c20 726f 775f 322c 2063 6f6c 5f32  _1, row_2, col_2
-00000d40: 5d0a 2020 2020 2020 2020 2020 2020 6e65  ].            ne
-00000d50: 775f 6172 6773 2e65 7874 656e 6428 6172  w_args.extend(ar
-00000d60: 6773 5b31 3a5d 290a 2020 2020 2020 2020  gs[1:]).        
-00000d70: 2020 2020 6172 6773 203d 206e 6577 5f61      args = new_a
-00000d80: 7267 730a 0a20 2020 2020 2020 2072 6574  rgs..        ret
-00000d90: 7572 6e20 6d65 7468 6f64 2873 656c 662c  urn method(self,
-00000da0: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
-00000db0: 290a 0a20 2020 2072 6574 7572 6e20 6365  )..    return ce
-00000dc0: 6c6c 5f77 7261 7070 6572 0a0a 0a64 6566  ll_wrapper...def
-00000dd0: 2063 6f6e 7665 7274 5f63 6f6c 756d 6e5f   convert_column_
-00000de0: 6172 6773 286d 6574 686f 6429 3a0a 2020  args(method):.  
-00000df0: 2020 2222 220a 2020 2020 4465 636f 7261    """.    Decora
-00000e00: 746f 7220 6675 6e63 7469 6f6e 2074 6f20  tor function to 
-00000e10: 636f 6e76 6572 7420 4131 206e 6f74 6174  convert A1 notat
-00000e20: 696f 6e20 696e 2063 6f6c 756d 6e73 206d  ion in columns m
-00000e30: 6574 686f 6420 6361 6c6c 730a 2020 2020  ethod calls.    
-00000e40: 746f 2074 6865 2064 6566 6175 6c74 2072  to the default r
-00000e50: 6f77 2f63 6f6c 206e 6f74 6174 696f 6e2e  ow/col notation.
-00000e60: 0a0a 2020 2020 2222 220a 2020 2020 4077  ..    """.    @w
-00000e70: 7261 7073 286d 6574 686f 6429 0a20 2020  raps(method).   
-00000e80: 2064 6566 2063 6f6c 756d 6e5f 7772 6170   def column_wrap
-00000e90: 7065 7228 7365 6c66 2c20 2a61 7267 732c  per(self, *args,
-00000ea0: 202a 2a6b 7761 7267 7329 3a0a 0a20 2020   **kwargs):..   
-00000eb0: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-00000ec0: 2020 2020 2020 2320 4669 7273 7420 6172        # First ar
-00000ed0: 6720 6973 2061 6e20 696e 742c 2064 6566  g is an int, def
-00000ee0: 6175 6c74 2074 6f20 726f 772f 636f 6c20  ault to row/col 
-00000ef0: 6e6f 7461 7469 6f6e 2e0a 2020 2020 2020  notation..      
-00000f00: 2020 2020 2020 6966 2061 7267 733a 0a20        if args:. 
-00000f10: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00000f20: 6e74 2861 7267 735b 305d 290a 2020 2020  nt(args[0]).    
-00000f30: 2020 2020 6578 6365 7074 2056 616c 7565      except Value
-00000f40: 4572 726f 723a 0a20 2020 2020 2020 2020  Error:.         
-00000f50: 2020 2023 2046 6972 7374 2061 7267 2069     # First arg i
-00000f60: 736e 2774 2061 6e20 696e 742c 2063 6f6e  sn't an int, con
-00000f70: 7665 7274 2074 6f20 4131 206e 6f74 6174  vert to A1 notat
-00000f80: 696f 6e2e 0a20 2020 2020 2020 2020 2020  ion..           
-00000f90: 2063 656c 6c5f 312c 2063 656c 6c5f 3220   cell_1, cell_2 
-00000fa0: 3d20 5b63 6f6c 202b 2027 3127 2066 6f72  = [col + '1' for
-00000fb0: 2063 6f6c 2069 6e20 6172 6773 5b30 5d2e   col in args[0].
-00000fc0: 7370 6c69 7428 273a 2729 5d0a 2020 2020  split(':')].    
-00000fd0: 2020 2020 2020 2020 5f2c 2063 6f6c 5f31          _, col_1
-00000fe0: 203d 2078 6c5f 6365 6c6c 5f74 6f5f 726f   = xl_cell_to_ro
-00000ff0: 7763 6f6c 2863 656c 6c5f 3129 0a20 2020  wcol(cell_1).   
-00001000: 2020 2020 2020 2020 205f 2c20 636f 6c5f           _, col_
-00001010: 3220 3d20 786c 5f63 656c 6c5f 746f 5f72  2 = xl_cell_to_r
-00001020: 6f77 636f 6c28 6365 6c6c 5f32 290a 2020  owcol(cell_2).  
-00001030: 2020 2020 2020 2020 2020 6e65 775f 6172            new_ar
-00001040: 6773 203d 205b 636f 6c5f 312c 2063 6f6c  gs = [col_1, col
-00001050: 5f32 5d0a 2020 2020 2020 2020 2020 2020  _2].            
-00001060: 6e65 775f 6172 6773 2e65 7874 656e 6428  new_args.extend(
-00001070: 6172 6773 5b31 3a5d 290a 2020 2020 2020  args[1:]).      
-00001080: 2020 2020 2020 6172 6773 203d 206e 6577        args = new
-00001090: 5f61 7267 730a 0a20 2020 2020 2020 2072  _args..        r
-000010a0: 6574 7572 6e20 6d65 7468 6f64 2873 656c  eturn method(sel
-000010b0: 662c 202a 6172 6773 2c20 2a2a 6b77 6172  f, *args, **kwar
-000010c0: 6773 290a 0a20 2020 2072 6574 7572 6e20  gs)..    return 
-000010d0: 636f 6c75 6d6e 5f77 7261 7070 6572 0a0a  column_wrapper..
-000010e0: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
+000007a0: 2323 2323 2323 2323 2323 2323 0a64 6566  ############.def
+000007b0: 2063 6f6e 7665 7274 5f63 656c 6c5f 6172   convert_cell_ar
+000007c0: 6773 286d 6574 686f 6429 3a0a 2020 2020  gs(method):.    
+000007d0: 2222 220a 2020 2020 4465 636f 7261 746f  """.    Decorato
+000007e0: 7220 6675 6e63 7469 6f6e 2074 6f20 636f  r function to co
+000007f0: 6e76 6572 7420 4131 206e 6f74 6174 696f  nvert A1 notatio
+00000800: 6e20 696e 2063 656c 6c20 6d65 7468 6f64  n in cell method
+00000810: 2063 616c 6c73 0a20 2020 2074 6f20 7468   calls.    to th
+00000820: 6520 6465 6661 756c 7420 726f 772f 636f  e default row/co
+00000830: 6c20 6e6f 7461 7469 6f6e 2e0a 0a20 2020  l notation...   
+00000840: 2022 2222 0a0a 2020 2020 4077 7261 7073   """..    @wraps
+00000850: 286d 6574 686f 6429 0a20 2020 2064 6566  (method).    def
+00000860: 2063 656c 6c5f 7772 6170 7065 7228 7365   cell_wrapper(se
+00000870: 6c66 2c20 2a61 7267 732c 202a 2a6b 7761  lf, *args, **kwa
+00000880: 7267 7329 3a0a 2020 2020 2020 2020 7472  rgs):.        tr
+00000890: 793a 0a20 2020 2020 2020 2020 2020 2023  y:.            #
+000008a0: 2046 6972 7374 2061 7267 2069 7320 616e   First arg is an
+000008b0: 2069 6e74 2c20 6465 6661 756c 7420 746f   int, default to
+000008c0: 2072 6f77 2f63 6f6c 206e 6f74 6174 696f   row/col notatio
+000008d0: 6e2e 0a20 2020 2020 2020 2020 2020 2069  n..            i
+000008e0: 6620 6172 6773 3a0a 2020 2020 2020 2020  f args:.        
+000008f0: 2020 2020 2020 2020 6669 7273 745f 6172          first_ar
+00000900: 6720 3d20 6172 6773 5b30 5d0a 2020 2020  g = args[0].    
+00000910: 2020 2020 2020 2020 2020 2020 696e 7428              int(
+00000920: 6669 7273 745f 6172 6729 0a20 2020 2020  first_arg).     
+00000930: 2020 2065 7863 6570 7420 5661 6c75 6545     except ValueE
+00000940: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
+00000950: 2020 2320 4669 7273 7420 6172 6720 6973    # First arg is
+00000960: 6e27 7420 616e 2069 6e74 2c20 636f 6e76  n't an int, conv
+00000970: 6572 7420 746f 2041 3120 6e6f 7461 7469  ert to A1 notati
+00000980: 6f6e 2e0a 2020 2020 2020 2020 2020 2020  on..            
+00000990: 6e65 775f 6172 6773 203d 2078 6c5f 6365  new_args = xl_ce
+000009a0: 6c6c 5f74 6f5f 726f 7763 6f6c 2866 6972  ll_to_rowcol(fir
+000009b0: 7374 5f61 7267 290a 2020 2020 2020 2020  st_arg).        
+000009c0: 2020 2020 6172 6773 203d 206e 6577 5f61      args = new_a
+000009d0: 7267 7320 2b20 6172 6773 5b31 3a5d 0a0a  rgs + args[1:]..
+000009e0: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+000009f0: 6574 686f 6428 7365 6c66 2c20 2a61 7267  ethod(self, *arg
+00000a00: 732c 202a 2a6b 7761 7267 7329 0a0a 2020  s, **kwargs)..  
+00000a10: 2020 7265 7475 726e 2063 656c 6c5f 7772    return cell_wr
+00000a20: 6170 7065 720a 0a0a 6465 6620 636f 6e76  apper...def conv
+00000a30: 6572 745f 7261 6e67 655f 6172 6773 286d  ert_range_args(m
+00000a40: 6574 686f 6429 3a0a 2020 2020 2222 220a  ethod):.    """.
+00000a50: 2020 2020 4465 636f 7261 746f 7220 6675      Decorator fu
+00000a60: 6e63 7469 6f6e 2074 6f20 636f 6e76 6572  nction to conver
+00000a70: 7420 4131 206e 6f74 6174 696f 6e20 696e  t A1 notation in
+00000a80: 2072 616e 6765 206d 6574 686f 6420 6361   range method ca
+00000a90: 6c6c 730a 2020 2020 746f 2074 6865 2064  lls.    to the d
+00000aa0: 6566 6175 6c74 2072 6f77 2f63 6f6c 206e  efault row/col n
+00000ab0: 6f74 6174 696f 6e2e 0a0a 2020 2020 2222  otation...    ""
+00000ac0: 220a 0a20 2020 2040 7772 6170 7328 6d65  "..    @wraps(me
+00000ad0: 7468 6f64 290a 2020 2020 6465 6620 6365  thod).    def ce
+00000ae0: 6c6c 5f77 7261 7070 6572 2873 656c 662c  ll_wrapper(self,
+00000af0: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
+00000b00: 293a 0a20 2020 2020 2020 2074 7279 3a0a  ):.        try:.
+00000b10: 2020 2020 2020 2020 2020 2020 2320 4669              # Fi
+00000b20: 7273 7420 6172 6720 6973 2061 6e20 696e  rst arg is an in
+00000b30: 742c 2064 6566 6175 6c74 2074 6f20 726f  t, default to ro
+00000b40: 772f 636f 6c20 6e6f 7461 7469 6f6e 2e0a  w/col notation..
+00000b50: 2020 2020 2020 2020 2020 2020 6966 2061              if a
+00000b60: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
+00000b70: 2020 2020 2069 6e74 2861 7267 735b 305d       int(args[0]
+00000b80: 290a 2020 2020 2020 2020 6578 6365 7074  ).        except
+00000b90: 2056 616c 7565 4572 726f 723a 0a20 2020   ValueError:.   
+00000ba0: 2020 2020 2020 2020 2023 2046 6972 7374           # First
+00000bb0: 2061 7267 2069 736e 2774 2061 6e20 696e   arg isn't an in
+00000bc0: 742c 2063 6f6e 7665 7274 2074 6f20 4131  t, convert to A1
+00000bd0: 206e 6f74 6174 696f 6e2e 0a20 2020 2020   notation..     
+00000be0: 2020 2020 2020 2069 6620 223a 2220 696e         if ":" in
+00000bf0: 2061 7267 735b 305d 3a0a 2020 2020 2020   args[0]:.      
+00000c00: 2020 2020 2020 2020 2020 6365 6c6c 5f31            cell_1
+00000c10: 2c20 6365 6c6c 5f32 203d 2061 7267 735b  , cell_2 = args[
+00000c20: 305d 2e73 706c 6974 2822 3a22 290a 2020  0].split(":").  
+00000c30: 2020 2020 2020 2020 2020 2020 2020 726f                ro
+00000c40: 775f 312c 2063 6f6c 5f31 203d 2078 6c5f  w_1, col_1 = xl_
+00000c50: 6365 6c6c 5f74 6f5f 726f 7763 6f6c 2863  cell_to_rowcol(c
+00000c60: 656c 6c5f 3129 0a20 2020 2020 2020 2020  ell_1).         
+00000c70: 2020 2020 2020 2072 6f77 5f32 2c20 636f         row_2, co
+00000c80: 6c5f 3220 3d20 786c 5f63 656c 6c5f 746f  l_2 = xl_cell_to
+00000c90: 5f72 6f77 636f 6c28 6365 6c6c 5f32 290a  _rowcol(cell_2).
+00000ca0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00000cb0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00000cc0: 2020 726f 775f 312c 2063 6f6c 5f31 203d    row_1, col_1 =
+00000cd0: 2078 6c5f 6365 6c6c 5f74 6f5f 726f 7763   xl_cell_to_rowc
+00000ce0: 6f6c 2861 7267 735b 305d 290a 2020 2020  ol(args[0]).    
+00000cf0: 2020 2020 2020 2020 2020 2020 726f 775f              row_
+00000d00: 322c 2063 6f6c 5f32 203d 2072 6f77 5f31  2, col_2 = row_1
+00000d10: 2c20 636f 6c5f 310a 0a20 2020 2020 2020  , col_1..       
+00000d20: 2020 2020 206e 6577 5f61 7267 7320 3d20       new_args = 
+00000d30: 5b72 6f77 5f31 2c20 636f 6c5f 312c 2072  [row_1, col_1, r
+00000d40: 6f77 5f32 2c20 636f 6c5f 325d 0a20 2020  ow_2, col_2].   
+00000d50: 2020 2020 2020 2020 206e 6577 5f61 7267           new_arg
+00000d60: 732e 6578 7465 6e64 2861 7267 735b 313a  s.extend(args[1:
+00000d70: 5d29 0a20 2020 2020 2020 2020 2020 2061  ]).            a
+00000d80: 7267 7320 3d20 6e65 775f 6172 6773 0a0a  rgs = new_args..
+00000d90: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+00000da0: 6574 686f 6428 7365 6c66 2c20 2a61 7267  ethod(self, *arg
+00000db0: 732c 202a 2a6b 7761 7267 7329 0a0a 2020  s, **kwargs)..  
+00000dc0: 2020 7265 7475 726e 2063 656c 6c5f 7772    return cell_wr
+00000dd0: 6170 7065 720a 0a0a 6465 6620 636f 6e76  apper...def conv
+00000de0: 6572 745f 636f 6c75 6d6e 5f61 7267 7328  ert_column_args(
+00000df0: 6d65 7468 6f64 293a 0a20 2020 2022 2222  method):.    """
+00000e00: 0a20 2020 2044 6563 6f72 6174 6f72 2066  .    Decorator f
+00000e10: 756e 6374 696f 6e20 746f 2063 6f6e 7665  unction to conve
+00000e20: 7274 2041 3120 6e6f 7461 7469 6f6e 2069  rt A1 notation i
+00000e30: 6e20 636f 6c75 6d6e 7320 6d65 7468 6f64  n columns method
+00000e40: 2063 616c 6c73 0a20 2020 2074 6f20 7468   calls.    to th
+00000e50: 6520 6465 6661 756c 7420 726f 772f 636f  e default row/co
+00000e60: 6c20 6e6f 7461 7469 6f6e 2e0a 0a20 2020  l notation...   
+00000e70: 2022 2222 0a0a 2020 2020 4077 7261 7073   """..    @wraps
+00000e80: 286d 6574 686f 6429 0a20 2020 2064 6566  (method).    def
+00000e90: 2063 6f6c 756d 6e5f 7772 6170 7065 7228   column_wrapper(
+00000ea0: 7365 6c66 2c20 2a61 7267 732c 202a 2a6b  self, *args, **k
+00000eb0: 7761 7267 7329 3a0a 2020 2020 2020 2020  wargs):.        
+00000ec0: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+00000ed0: 2023 2046 6972 7374 2061 7267 2069 7320   # First arg is 
+00000ee0: 616e 2069 6e74 2c20 6465 6661 756c 7420  an int, default 
+00000ef0: 746f 2072 6f77 2f63 6f6c 206e 6f74 6174  to row/col notat
+00000f00: 696f 6e2e 0a20 2020 2020 2020 2020 2020  ion..           
+00000f10: 2069 6620 6172 6773 3a0a 2020 2020 2020   if args:.      
+00000f20: 2020 2020 2020 2020 2020 696e 7428 6172            int(ar
+00000f30: 6773 5b30 5d29 0a20 2020 2020 2020 2065  gs[0]).        e
+00000f40: 7863 6570 7420 5661 6c75 6545 7272 6f72  xcept ValueError
+00000f50: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00000f60: 4669 7273 7420 6172 6720 6973 6e27 7420  First arg isn't 
+00000f70: 616e 2069 6e74 2c20 636f 6e76 6572 7420  an int, convert 
+00000f80: 746f 2041 3120 6e6f 7461 7469 6f6e 2e0a  to A1 notation..
+00000f90: 2020 2020 2020 2020 2020 2020 6365 6c6c              cell
+00000fa0: 5f31 2c20 6365 6c6c 5f32 203d 205b 636f  _1, cell_2 = [co
+00000fb0: 6c20 2b20 2231 2220 666f 7220 636f 6c20  l + "1" for col 
+00000fc0: 696e 2061 7267 735b 305d 2e73 706c 6974  in args[0].split
+00000fd0: 2822 3a22 295d 0a20 2020 2020 2020 2020  (":")].         
+00000fe0: 2020 205f 2c20 636f 6c5f 3120 3d20 786c     _, col_1 = xl
+00000ff0: 5f63 656c 6c5f 746f 5f72 6f77 636f 6c28  _cell_to_rowcol(
+00001000: 6365 6c6c 5f31 290a 2020 2020 2020 2020  cell_1).        
+00001010: 2020 2020 5f2c 2063 6f6c 5f32 203d 2078      _, col_2 = x
+00001020: 6c5f 6365 6c6c 5f74 6f5f 726f 7763 6f6c  l_cell_to_rowcol
+00001030: 2863 656c 6c5f 3229 0a20 2020 2020 2020  (cell_2).       
+00001040: 2020 2020 206e 6577 5f61 7267 7320 3d20       new_args = 
+00001050: 5b63 6f6c 5f31 2c20 636f 6c5f 325d 0a20  [col_1, col_2]. 
+00001060: 2020 2020 2020 2020 2020 206e 6577 5f61             new_a
+00001070: 7267 732e 6578 7465 6e64 2861 7267 735b  rgs.extend(args[
+00001080: 313a 5d29 0a20 2020 2020 2020 2020 2020  1:]).           
+00001090: 2061 7267 7320 3d20 6e65 775f 6172 6773   args = new_args
+000010a0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+000010b0: 206d 6574 686f 6428 7365 6c66 2c20 2a61   method(self, *a
+000010c0: 7267 732c 202a 2a6b 7761 7267 7329 0a0a  rgs, **kwargs)..
+000010d0: 2020 2020 7265 7475 726e 2063 6f6c 756d      return colum
+000010e0: 6e5f 7772 6170 7065 720a 0a0a 2323 2323  n_wrapper...####
 000010f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00001100: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00001110: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00001120: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00001130: 0a23 0a23 204e 616d 6564 2074 7570 6c65  .#.# Named tuple
-00001140: 7320 7573 6564 2066 6f72 2063 656c 6c20  s used for cell 
-00001150: 7479 7065 732e 0a23 0a23 2323 2323 2323  types..#.#######
-00001160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00001130: 2323 2323 2323 2323 2323 230a 230a 2320  ###########.#.# 
+00001140: 4e61 6d65 6420 7475 706c 6573 2075 7365  Named tuples use
+00001150: 6420 666f 7220 6365 6c6c 2074 7970 6573  d for cell types
+00001160: 2e0a 230a 2323 2323 2323 2323 2323 2323  ..#.############
 00001170: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00001180: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00001190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000011a0: 2323 2323 2323 2323 0a63 656c 6c5f 7374  ########.cell_st
-000011b0: 7269 6e67 5f74 7570 6c65 203d 206e 616d  ring_tuple = nam
-000011c0: 6564 7475 706c 6528 2753 7472 696e 6727  edtuple('String'
-000011d0: 2c20 2773 7472 696e 672c 2066 6f72 6d61  , 'string, forma
-000011e0: 7427 290a 6365 6c6c 5f6e 756d 6265 725f  t').cell_number_
-000011f0: 7475 706c 6520 3d20 6e61 6d65 6474 7570  tuple = namedtup
-00001200: 6c65 2827 4e75 6d62 6572 272c 2027 6e75  le('Number', 'nu
-00001210: 6d62 6572 2c20 666f 726d 6174 2729 0a63  mber, format').c
-00001220: 656c 6c5f 626c 616e 6b5f 7475 706c 6520  ell_blank_tuple 
-00001230: 3d20 6e61 6d65 6474 7570 6c65 2827 426c  = namedtuple('Bl
-00001240: 616e 6b27 2c20 2766 6f72 6d61 7427 290a  ank', 'format').
-00001250: 6365 6c6c 5f62 6f6f 6c65 616e 5f74 7570  cell_boolean_tup
-00001260: 6c65 203d 206e 616d 6564 7475 706c 6528  le = namedtuple(
-00001270: 2742 6f6f 6c65 616e 272c 2027 626f 6f6c  'Boolean', 'bool
-00001280: 6561 6e2c 2066 6f72 6d61 7427 290a 6365  ean, format').ce
-00001290: 6c6c 5f66 6f72 6d75 6c61 5f74 7570 6c65  ll_formula_tuple
-000012a0: 203d 206e 616d 6564 7475 706c 6528 2746   = namedtuple('F
-000012b0: 6f72 6d75 6c61 272c 2027 666f 726d 756c  ormula', 'formul
-000012c0: 612c 2066 6f72 6d61 742c 2076 616c 7565  a, format, value
-000012d0: 2729 0a63 656c 6c5f 6461 7465 7469 6d65  ').cell_datetime
-000012e0: 5f74 7570 6c65 203d 206e 616d 6564 7475  _tuple = namedtu
-000012f0: 706c 6528 2744 6174 6574 696d 6527 2c20  ple('Datetime', 
-00001300: 276e 756d 6265 722c 2066 6f72 6d61 7427  'number, format'
-00001310: 290a 6365 6c6c 5f61 7266 6f72 6d75 6c61  ).cell_arformula
-00001320: 5f74 7570 6c65 203d 206e 616d 6564 7475  _tuple = namedtu
-00001330: 706c 6528 2741 7272 6179 466f 726d 756c  ple('ArrayFormul
-00001340: 6127 2c0a 2020 2020 2020 2020 2020 2020  a',.            
-00001350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001360: 2020 2020 2020 2766 6f72 6d75 6c61 2c20        'formula, 
-00001370: 666f 726d 6174 2c20 7661 6c75 652c 2072  format, value, r
-00001380: 616e 6765 2c20 6174 7970 6527 290a 6365  ange, atype').ce
-00001390: 6c6c 5f72 6963 685f 7374 7269 6e67 5f74  ll_rich_string_t
-000013a0: 7570 6c65 203d 206e 616d 6564 7475 706c  uple = namedtupl
-000013b0: 6528 2752 6963 6853 7472 696e 6727 2c20  e('RichString', 
-000013c0: 2773 7472 696e 672c 2066 6f72 6d61 742c  'string, format,
-000013d0: 2072 6177 5f73 7472 696e 6727 290a 0a0a   raw_string')...
+000011a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000011b0: 2323 230a 6365 6c6c 5f73 7472 696e 675f  ###.cell_string_
+000011c0: 7475 706c 6520 3d20 6e61 6d65 6474 7570  tuple = namedtup
+000011d0: 6c65 2822 5374 7269 6e67 222c 2022 7374  le("String", "st
+000011e0: 7269 6e67 2c20 666f 726d 6174 2229 0a63  ring, format").c
+000011f0: 656c 6c5f 6e75 6d62 6572 5f74 7570 6c65  ell_number_tuple
+00001200: 203d 206e 616d 6564 7475 706c 6528 224e   = namedtuple("N
+00001210: 756d 6265 7222 2c20 226e 756d 6265 722c  umber", "number,
+00001220: 2066 6f72 6d61 7422 290a 6365 6c6c 5f62   format").cell_b
+00001230: 6c61 6e6b 5f74 7570 6c65 203d 206e 616d  lank_tuple = nam
+00001240: 6564 7475 706c 6528 2242 6c61 6e6b 222c  edtuple("Blank",
+00001250: 2022 666f 726d 6174 2229 0a63 656c 6c5f   "format").cell_
+00001260: 626f 6f6c 6561 6e5f 7475 706c 6520 3d20  boolean_tuple = 
+00001270: 6e61 6d65 6474 7570 6c65 2822 426f 6f6c  namedtuple("Bool
+00001280: 6561 6e22 2c20 2262 6f6f 6c65 616e 2c20  ean", "boolean, 
+00001290: 666f 726d 6174 2229 0a63 656c 6c5f 666f  format").cell_fo
+000012a0: 726d 756c 615f 7475 706c 6520 3d20 6e61  rmula_tuple = na
+000012b0: 6d65 6474 7570 6c65 2822 466f 726d 756c  medtuple("Formul
+000012c0: 6122 2c20 2266 6f72 6d75 6c61 2c20 666f  a", "formula, fo
+000012d0: 726d 6174 2c20 7661 6c75 6522 290a 6365  rmat, value").ce
+000012e0: 6c6c 5f64 6174 6574 696d 655f 7475 706c  ll_datetime_tupl
+000012f0: 6520 3d20 6e61 6d65 6474 7570 6c65 2822  e = namedtuple("
+00001300: 4461 7465 7469 6d65 222c 2022 6e75 6d62  Datetime", "numb
+00001310: 6572 2c20 666f 726d 6174 2229 0a63 656c  er, format").cel
+00001320: 6c5f 6172 666f 726d 756c 615f 7475 706c  l_arformula_tupl
+00001330: 6520 3d20 6e61 6d65 6474 7570 6c65 280a  e = namedtuple(.
+00001340: 2020 2020 2241 7272 6179 466f 726d 756c      "ArrayFormul
+00001350: 6122 2c20 2266 6f72 6d75 6c61 2c20 666f  a", "formula, fo
+00001360: 726d 6174 2c20 7661 6c75 652c 2072 616e  rmat, value, ran
+00001370: 6765 2c20 6174 7970 6522 0a29 0a63 656c  ge, atype".).cel
+00001380: 6c5f 7269 6368 5f73 7472 696e 675f 7475  l_rich_string_tu
+00001390: 706c 6520 3d20 6e61 6d65 6474 7570 6c65  ple = namedtuple
+000013a0: 2822 5269 6368 5374 7269 6e67 222c 2022  ("RichString", "
+000013b0: 7374 7269 6e67 2c20 666f 726d 6174 2c20  string, format, 
+000013c0: 7261 775f 7374 7269 6e67 2229 0a0a 0a23  raw_string")...#
+000013d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000013e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000013f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00001400: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00001410: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00001420: 2323 2323 2323 2323 2323 2323 2323 230a  ###############.
-00001430: 230a 2320 576f 726b 7368 6565 7420 436c  #.# Worksheet Cl
-00001440: 6173 7320 6465 6669 6e69 7469 6f6e 2e0a  ass definition..
-00001450: 230a 2323 2323 2323 2323 2323 2323 2323  #.##############
+00001410: 2323 2323 2323 2323 2323 2323 2323 0a23  ##############.#
+00001420: 0a23 2057 6f72 6b73 6865 6574 2043 6c61  .# Worksheet Cla
+00001430: 7373 2064 6566 696e 6974 696f 6e2e 0a23  ss definition..#
+00001440: 0a23 2323 2323 2323 2323 2323 2323 2323  .###############
+00001450: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00001460: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00001470: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00001480: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00001490: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000014a0: 230a 636c 6173 7320 576f 726b 7368 6565  #.class Workshee
-000014b0: 7428 786d 6c77 7269 7465 722e 584d 4c77  t(xmlwriter.XMLw
-000014c0: 7269 7465 7229 3a0a 2020 2020 2222 220a  riter):.    """.
-000014d0: 2020 2020 4120 636c 6173 7320 666f 7220      A class for 
-000014e0: 7772 6974 696e 6720 7468 6520 4578 6365  writing the Exce
-000014f0: 6c20 584c 5358 2057 6f72 6b73 6865 6574  l XLSX Worksheet
-00001500: 2066 696c 652e 0a0a 2020 2020 2222 220a   file...    """.
-00001510: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
+00001490: 0a63 6c61 7373 2057 6f72 6b73 6865 6574  .class Worksheet
+000014a0: 2878 6d6c 7772 6974 6572 2e58 4d4c 7772  (xmlwriter.XMLwr
+000014b0: 6974 6572 293a 0a20 2020 2022 2222 0a20  iter):.    """. 
+000014c0: 2020 2041 2063 6c61 7373 2066 6f72 2077     A class for w
+000014d0: 7269 7469 6e67 2074 6865 2045 7863 656c  riting the Excel
+000014e0: 2058 4c53 5820 576f 726b 7368 6565 7420   XLSX Worksheet 
+000014f0: 6669 6c65 2e0a 0a20 2020 2022 2222 0a0a  file...    """..
+00001500: 2020 2020 2323 2323 2323 2323 2323 2323      ############
+00001510: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00001520: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00001530: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00001540: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00001550: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00001560: 0a20 2020 2023 0a20 2020 2023 2050 7562  .    #.    # Pub
-00001570: 6c69 6320 4150 492e 0a20 2020 2023 0a20  lic API..    #. 
-00001580: 2020 2023 2323 2323 2323 2323 2323 2323     #############
+00001540: 2323 2323 2323 2323 2323 2323 2323 230a  ###############.
+00001550: 2020 2020 230a 2020 2020 2320 5075 626c      #.    # Publ
+00001560: 6963 2041 5049 2e0a 2020 2020 230a 2020  ic API..    #.  
+00001570: 2020 2323 2323 2323 2323 2323 2323 2323    ##############
+00001580: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 00001590: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 000015a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000015b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000015c0: 2323 2323 2323 2323 2323 2323 2323 0a0a  ##############..
-000015d0: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
-000015e0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000015f0: 2222 220a 2020 2020 2020 2020 436f 6e73  """.        Cons
-00001600: 7472 7563 746f 722e 0a0a 2020 2020 2020  tructor...      
-00001610: 2020 2222 220a 0a20 2020 2020 2020 2073    """..        s
-00001620: 7570 6572 2857 6f72 6b73 6865 6574 2c20  uper(Worksheet, 
-00001630: 7365 6c66 292e 5f5f 696e 6974 5f5f 2829  self).__init__()
-00001640: 0a0a 2020 2020 2020 2020 7365 6c66 2e6e  ..        self.n
-00001650: 616d 6520 3d20 4e6f 6e65 0a20 2020 2020  ame = None.     
-00001660: 2020 2073 656c 662e 696e 6465 7820 3d20     self.index = 
-00001670: 4e6f 6e65 0a20 2020 2020 2020 2073 656c  None.        sel
-00001680: 662e 7374 725f 7461 626c 6520 3d20 4e6f  f.str_table = No
-00001690: 6e65 0a20 2020 2020 2020 2073 656c 662e  ne.        self.
-000016a0: 7061 6c65 7474 6520 3d20 4e6f 6e65 0a20  palette = None. 
-000016b0: 2020 2020 2020 2073 656c 662e 636f 6e73         self.cons
-000016c0: 7461 6e74 5f6d 656d 6f72 7920 3d20 300a  tant_memory = 0.
-000016d0: 2020 2020 2020 2020 7365 6c66 2e74 6d70          self.tmp
-000016e0: 6469 7220 3d20 4e6f 6e65 0a20 2020 2020  dir = None.     
-000016f0: 2020 2073 656c 662e 6973 5f63 6861 7274     self.is_chart
-00001700: 7368 6565 7420 3d20 4661 6c73 650a 0a20  sheet = False.. 
-00001710: 2020 2020 2020 2073 656c 662e 6578 745f         self.ext_
-00001720: 7368 6565 7473 203d 205b 5d0a 2020 2020  sheets = [].    
-00001730: 2020 2020 7365 6c66 2e66 696c 6563 6c6f      self.fileclo
-00001740: 7365 6420 3d20 300a 2020 2020 2020 2020  sed = 0.        
-00001750: 7365 6c66 2e65 7863 656c 5f76 6572 7369  self.excel_versi
-00001760: 6f6e 203d 2032 3030 370a 2020 2020 2020  on = 2007.      
-00001770: 2020 7365 6c66 2e65 7863 656c 3230 3033    self.excel2003
-00001780: 5f73 7479 6c65 203d 2046 616c 7365 0a0a  _style = False..
-00001790: 2020 2020 2020 2020 7365 6c66 2e78 6c73          self.xls
-000017a0: 5f72 6f77 6d61 7820 3d20 3130 3438 3537  _rowmax = 104857
-000017b0: 360a 2020 2020 2020 2020 7365 6c66 2e78  6.        self.x
-000017c0: 6c73 5f63 6f6c 6d61 7820 3d20 3136 3338  ls_colmax = 1638
-000017d0: 340a 2020 2020 2020 2020 7365 6c66 2e78  4.        self.x
-000017e0: 6c73 5f73 7472 6d61 7820 3d20 3332 3736  ls_strmax = 3276
-000017f0: 370a 2020 2020 2020 2020 7365 6c66 2e64  7.        self.d
-00001800: 696d 5f72 6f77 6d69 6e20 3d20 4e6f 6e65  im_rowmin = None
-00001810: 0a20 2020 2020 2020 2073 656c 662e 6469  .        self.di
-00001820: 6d5f 726f 776d 6178 203d 204e 6f6e 650a  m_rowmax = None.
-00001830: 2020 2020 2020 2020 7365 6c66 2e64 696d          self.dim
-00001840: 5f63 6f6c 6d69 6e20 3d20 4e6f 6e65 0a20  _colmin = None. 
-00001850: 2020 2020 2020 2073 656c 662e 6469 6d5f         self.dim_
-00001860: 636f 6c6d 6178 203d 204e 6f6e 650a 0a20  colmax = None.. 
-00001870: 2020 2020 2020 2073 656c 662e 636f 6c5f         self.col_
-00001880: 696e 666f 203d 207b 7d0a 2020 2020 2020  info = {}.      
-00001890: 2020 7365 6c66 2e73 656c 6563 7469 6f6e    self.selection
-000018a0: 7320 3d20 5b5d 0a20 2020 2020 2020 2073  s = [].        s
-000018b0: 656c 662e 6869 6464 656e 203d 2030 0a20  elf.hidden = 0. 
-000018c0: 2020 2020 2020 2073 656c 662e 6163 7469         self.acti
-000018d0: 7665 203d 2030 0a20 2020 2020 2020 2073  ve = 0.        s
-000018e0: 656c 662e 7461 625f 636f 6c6f 7220 3d20  elf.tab_color = 
-000018f0: 300a 2020 2020 2020 2020 7365 6c66 2e74  0.        self.t
-00001900: 6f70 5f6c 6566 745f 6365 6c6c 203d 2027  op_left_cell = '
-00001910: 270a 0a20 2020 2020 2020 2073 656c 662e  '..        self.
-00001920: 7061 6e65 7320 3d20 5b5d 0a20 2020 2020  panes = [].     
-00001930: 2020 2073 656c 662e 6163 7469 7665 5f70     self.active_p
-00001940: 616e 6520 3d20 330a 2020 2020 2020 2020  ane = 3.        
-00001950: 7365 6c66 2e73 656c 6563 7465 6420 3d20  self.selected = 
-00001960: 300a 0a20 2020 2020 2020 2073 656c 662e  0..        self.
-00001970: 7061 6765 5f73 6574 7570 5f63 6861 6e67  page_setup_chang
-00001980: 6564 203d 2046 616c 7365 0a20 2020 2020  ed = False.     
-00001990: 2020 2073 656c 662e 7061 7065 725f 7369     self.paper_si
-000019a0: 7a65 203d 2030 0a20 2020 2020 2020 2073  ze = 0.        s
-000019b0: 656c 662e 6f72 6965 6e74 6174 696f 6e20  elf.orientation 
-000019c0: 3d20 310a 0a20 2020 2020 2020 2073 656c  = 1..        sel
-000019d0: 662e 7072 696e 745f 6f70 7469 6f6e 735f  f.print_options_
-000019e0: 6368 616e 6765 6420 3d20 4661 6c73 650a  changed = False.
-000019f0: 2020 2020 2020 2020 7365 6c66 2e68 6365          self.hce
-00001a00: 6e74 6572 203d 2046 616c 7365 0a20 2020  nter = False.   
-00001a10: 2020 2020 2073 656c 662e 7663 656e 7465       self.vcente
-00001a20: 7220 3d20 4661 6c73 650a 2020 2020 2020  r = False.      
-00001a30: 2020 7365 6c66 2e70 7269 6e74 5f67 7269    self.print_gri
-00001a40: 646c 696e 6573 203d 2046 616c 7365 0a20  dlines = False. 
-00001a50: 2020 2020 2020 2073 656c 662e 7363 7265         self.scre
-00001a60: 656e 5f67 7269 646c 696e 6573 203d 2054  en_gridlines = T
-00001a70: 7275 650a 2020 2020 2020 2020 7365 6c66  rue.        self
-00001a80: 2e70 7269 6e74 5f68 6561 6465 7273 203d  .print_headers =
-00001a90: 2046 616c 7365 0a20 2020 2020 2020 2073   False.        s
-00001aa0: 656c 662e 726f 775f 636f 6c5f 6865 6164  elf.row_col_head
-00001ab0: 6572 7320 3d20 4661 6c73 650a 0a20 2020  ers = False..   
-00001ac0: 2020 2020 2073 656c 662e 6865 6164 6572       self.header
-00001ad0: 5f66 6f6f 7465 725f 6368 616e 6765 6420  _footer_changed 
-00001ae0: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
-00001af0: 7365 6c66 2e68 6561 6465 7220 3d20 2727  self.header = ''
-00001b00: 0a20 2020 2020 2020 2073 656c 662e 666f  .        self.fo
-00001b10: 6f74 6572 203d 2027 270a 2020 2020 2020  oter = ''.      
-00001b20: 2020 7365 6c66 2e68 6561 6465 725f 666f    self.header_fo
-00001b30: 6f74 6572 5f61 6c69 676e 7320 3d20 5472  oter_aligns = Tr
-00001b40: 7565 0a20 2020 2020 2020 2073 656c 662e  ue.        self.
-00001b50: 6865 6164 6572 5f66 6f6f 7465 725f 7363  header_footer_sc
-00001b60: 616c 6573 203d 2054 7275 650a 2020 2020  ales = True.    
-00001b70: 2020 2020 7365 6c66 2e68 6561 6465 725f      self.header_
-00001b80: 696d 6167 6573 203d 205b 5d0a 2020 2020  images = [].    
-00001b90: 2020 2020 7365 6c66 2e66 6f6f 7465 725f      self.footer_
-00001ba0: 696d 6167 6573 203d 205b 5d0a 2020 2020  images = [].    
-00001bb0: 2020 2020 7365 6c66 2e68 6561 6465 725f      self.header_
-00001bc0: 696d 6167 6573 5f6c 6973 7420 3d20 5b5d  images_list = []
-00001bd0: 0a0a 2020 2020 2020 2020 7365 6c66 2e6d  ..        self.m
-00001be0: 6172 6769 6e5f 6c65 6674 203d 2030 2e37  argin_left = 0.7
-00001bf0: 0a20 2020 2020 2020 2073 656c 662e 6d61  .        self.ma
-00001c00: 7267 696e 5f72 6967 6874 203d 2030 2e37  rgin_right = 0.7
-00001c10: 0a20 2020 2020 2020 2073 656c 662e 6d61  .        self.ma
-00001c20: 7267 696e 5f74 6f70 203d 2030 2e37 350a  rgin_top = 0.75.
-00001c30: 2020 2020 2020 2020 7365 6c66 2e6d 6172          self.mar
-00001c40: 6769 6e5f 626f 7474 6f6d 203d 2030 2e37  gin_bottom = 0.7
-00001c50: 350a 2020 2020 2020 2020 7365 6c66 2e6d  5.        self.m
-00001c60: 6172 6769 6e5f 6865 6164 6572 203d 2030  argin_header = 0
-00001c70: 2e33 0a20 2020 2020 2020 2073 656c 662e  .3.        self.
-00001c80: 6d61 7267 696e 5f66 6f6f 7465 7220 3d20  margin_footer = 
-00001c90: 302e 330a 0a20 2020 2020 2020 2073 656c  0.3..        sel
-00001ca0: 662e 7265 7065 6174 5f72 6f77 5f72 616e  f.repeat_row_ran
-00001cb0: 6765 203d 2027 270a 2020 2020 2020 2020  ge = ''.        
-00001cc0: 7365 6c66 2e72 6570 6561 745f 636f 6c5f  self.repeat_col_
-00001cd0: 7261 6e67 6520 3d20 2727 0a20 2020 2020  range = ''.     
-00001ce0: 2020 2073 656c 662e 7072 696e 745f 6172     self.print_ar
-00001cf0: 6561 5f72 616e 6765 203d 2027 270a 0a20  ea_range = ''.. 
-00001d00: 2020 2020 2020 2073 656c 662e 7061 6765         self.page
-00001d10: 5f6f 7264 6572 203d 2030 0a20 2020 2020  _order = 0.     
-00001d20: 2020 2073 656c 662e 626c 6163 6b5f 7768     self.black_wh
-00001d30: 6974 6520 3d20 300a 2020 2020 2020 2020  ite = 0.        
-00001d40: 7365 6c66 2e64 7261 6674 5f71 7561 6c69  self.draft_quali
-00001d50: 7479 203d 2030 0a20 2020 2020 2020 2073  ty = 0.        s
-00001d60: 656c 662e 7072 696e 745f 636f 6d6d 656e  elf.print_commen
-00001d70: 7473 203d 2030 0a20 2020 2020 2020 2073  ts = 0.        s
-00001d80: 656c 662e 7061 6765 5f73 7461 7274 203d  elf.page_start =
-00001d90: 2030 0a0a 2020 2020 2020 2020 7365 6c66   0..        self
-00001da0: 2e66 6974 5f70 6167 6520 3d20 300a 2020  .fit_page = 0.  
-00001db0: 2020 2020 2020 7365 6c66 2e66 6974 5f77        self.fit_w
-00001dc0: 6964 7468 203d 2030 0a20 2020 2020 2020  idth = 0.       
-00001dd0: 2073 656c 662e 6669 745f 6865 6967 6874   self.fit_height
-00001de0: 203d 2030 0a0a 2020 2020 2020 2020 7365   = 0..        se
-00001df0: 6c66 2e68 6272 6561 6b73 203d 205b 5d0a  lf.hbreaks = [].
-00001e00: 2020 2020 2020 2020 7365 6c66 2e76 6272          self.vbr
-00001e10: 6561 6b73 203d 205b 5d0a 0a20 2020 2020  eaks = []..     
-00001e20: 2020 2073 656c 662e 7072 6f74 6563 745f     self.protect_
-00001e30: 6f70 7469 6f6e 7320 3d20 7b7d 0a20 2020  options = {}.   
-00001e40: 2020 2020 2073 656c 662e 7072 6f74 6563       self.protec
-00001e50: 7465 645f 7261 6e67 6573 203d 205b 5d0a  ted_ranges = [].
-00001e60: 2020 2020 2020 2020 7365 6c66 2e6e 756d          self.num
-00001e70: 5f70 726f 7465 6374 6564 5f72 616e 6765  _protected_range
-00001e80: 7320 3d20 300a 2020 2020 2020 2020 7365  s = 0.        se
-00001e90: 6c66 2e73 6574 5f63 6f6c 7320 3d20 7b7d  lf.set_cols = {}
-00001ea0: 0a20 2020 2020 2020 2073 656c 662e 7365  .        self.se
-00001eb0: 745f 726f 7773 203d 2064 6566 6175 6c74  t_rows = default
-00001ec0: 6469 6374 2864 6963 7429 0a0a 2020 2020  dict(dict)..    
-00001ed0: 2020 2020 7365 6c66 2e7a 6f6f 6d20 3d20      self.zoom = 
-00001ee0: 3130 300a 2020 2020 2020 2020 7365 6c66  100.        self
-00001ef0: 2e7a 6f6f 6d5f 7363 616c 655f 6e6f 726d  .zoom_scale_norm
-00001f00: 616c 203d 2031 0a20 2020 2020 2020 2073  al = 1.        s
-00001f10: 656c 662e 7072 696e 745f 7363 616c 6520  elf.print_scale 
-00001f20: 3d20 3130 300a 2020 2020 2020 2020 7365  = 100.        se
-00001f30: 6c66 2e69 735f 7269 6768 745f 746f 5f6c  lf.is_right_to_l
-00001f40: 6566 7420 3d20 300a 2020 2020 2020 2020  eft = 0.        
-00001f50: 7365 6c66 2e73 686f 775f 7a65 726f 7320  self.show_zeros 
-00001f60: 3d20 310a 2020 2020 2020 2020 7365 6c66  = 1.        self
-00001f70: 2e6c 6561 6469 6e67 5f7a 6572 6f73 203d  .leading_zeros =
-00001f80: 2030 0a0a 2020 2020 2020 2020 7365 6c66   0..        self
-00001f90: 2e6f 7574 6c69 6e65 5f72 6f77 5f6c 6576  .outline_row_lev
-00001fa0: 656c 203d 2030 0a20 2020 2020 2020 2073  el = 0.        s
-00001fb0: 656c 662e 6f75 746c 696e 655f 636f 6c5f  elf.outline_col_
-00001fc0: 6c65 7665 6c20 3d20 300a 2020 2020 2020  level = 0.      
-00001fd0: 2020 7365 6c66 2e6f 7574 6c69 6e65 5f73    self.outline_s
-00001fe0: 7479 6c65 203d 2030 0a20 2020 2020 2020  tyle = 0.       
-00001ff0: 2073 656c 662e 6f75 746c 696e 655f 6265   self.outline_be
-00002000: 6c6f 7720 3d20 310a 2020 2020 2020 2020  low = 1.        
-00002010: 7365 6c66 2e6f 7574 6c69 6e65 5f72 6967  self.outline_rig
-00002020: 6874 203d 2031 0a20 2020 2020 2020 2073  ht = 1.        s
-00002030: 656c 662e 6f75 746c 696e 655f 6f6e 203d  elf.outline_on =
-00002040: 2031 0a20 2020 2020 2020 2073 656c 662e   1.        self.
-00002050: 6f75 746c 696e 655f 6368 616e 6765 6420  outline_changed 
-00002060: 3d20 4661 6c73 650a 0a20 2020 2020 2020  = False..       
-00002070: 2073 656c 662e 6f72 6967 696e 616c 5f72   self.original_r
-00002080: 6f77 5f68 6569 6768 7420 3d20 3135 0a20  ow_height = 15. 
-00002090: 2020 2020 2020 2073 656c 662e 6465 6661         self.defa
-000020a0: 756c 745f 726f 775f 6865 6967 6874 203d  ult_row_height =
-000020b0: 2031 350a 2020 2020 2020 2020 7365 6c66   15.        self
-000020c0: 2e64 6566 6175 6c74 5f72 6f77 5f70 6978  .default_row_pix
-000020d0: 656c 7320 3d20 3230 0a20 2020 2020 2020  els = 20.       
-000020e0: 2073 656c 662e 6465 6661 756c 745f 636f   self.default_co
-000020f0: 6c5f 7769 6474 6820 3d20 382e 3433 0a20  l_width = 8.43. 
-00002100: 2020 2020 2020 2073 656c 662e 6465 6661         self.defa
-00002110: 756c 745f 636f 6c5f 7069 7865 6c73 203d  ult_col_pixels =
-00002120: 2036 340a 2020 2020 2020 2020 7365 6c66   64.        self
-00002130: 2e64 6566 6175 6c74 5f64 6174 655f 7069  .default_date_pi
-00002140: 7865 6c73 203d 2036 380a 2020 2020 2020  xels = 68.      
-00002150: 2020 7365 6c66 2e64 6566 6175 6c74 5f72    self.default_r
-00002160: 6f77 5f7a 6572 6f65 6420 3d20 300a 0a20  ow_zeroed = 0.. 
-00002170: 2020 2020 2020 2073 656c 662e 6e61 6d65         self.name
-00002180: 7320 3d20 7b7d 0a20 2020 2020 2020 2073  s = {}.        s
-00002190: 656c 662e 7772 6974 655f 6d61 7463 6820  elf.write_match 
-000021a0: 3d20 5b5d 0a20 2020 2020 2020 2073 656c  = [].        sel
-000021b0: 662e 7461 626c 6520 3d20 6465 6661 756c  f.table = defaul
-000021c0: 7464 6963 7428 6469 6374 290a 2020 2020  tdict(dict).    
-000021d0: 2020 2020 7365 6c66 2e6d 6572 6765 203d      self.merge =
-000021e0: 205b 5d0a 2020 2020 2020 2020 7365 6c66   [].        self
-000021f0: 2e6d 6572 6765 645f 6365 6c6c 7320 3d20  .merged_cells = 
-00002200: 7b7d 0a20 2020 2020 2020 2073 656c 662e  {}.        self.
-00002210: 7461 626c 655f 6365 6c6c 7320 3d20 7b7d  table_cells = {}
-00002220: 0a20 2020 2020 2020 2073 656c 662e 726f  .        self.ro
-00002230: 775f 7370 616e 7320 3d20 7b7d 0a0a 2020  w_spans = {}..  
-00002240: 2020 2020 2020 7365 6c66 2e68 6173 5f76        self.has_v
-00002250: 6d6c 203d 2046 616c 7365 0a20 2020 2020  ml = False.     
-00002260: 2020 2073 656c 662e 6861 735f 6865 6164     self.has_head
-00002270: 6572 5f76 6d6c 203d 2046 616c 7365 0a20  er_vml = False. 
-00002280: 2020 2020 2020 2073 656c 662e 6861 735f         self.has_
-00002290: 636f 6d6d 656e 7473 203d 2046 616c 7365  comments = False
-000022a0: 0a20 2020 2020 2020 2073 656c 662e 636f  .        self.co
-000022b0: 6d6d 656e 7473 203d 2064 6566 6175 6c74  mments = default
-000022c0: 6469 6374 2864 6963 7429 0a20 2020 2020  dict(dict).     
-000022d0: 2020 2073 656c 662e 636f 6d6d 656e 7473     self.comments
-000022e0: 5f6c 6973 7420 3d20 5b5d 0a20 2020 2020  _list = [].     
-000022f0: 2020 2073 656c 662e 636f 6d6d 656e 7473     self.comments
-00002300: 5f61 7574 686f 7220 3d20 2727 0a20 2020  _author = ''.   
-00002310: 2020 2020 2073 656c 662e 636f 6d6d 656e       self.commen
-00002320: 7473 5f76 6973 6962 6c65 203d 2030 0a20  ts_visible = 0. 
-00002330: 2020 2020 2020 2073 656c 662e 766d 6c5f         self.vml_
-00002340: 7368 6170 655f 6964 203d 2031 3032 340a  shape_id = 1024.
-00002350: 2020 2020 2020 2020 7365 6c66 2e62 7574          self.but
-00002360: 746f 6e73 5f6c 6973 7420 3d20 5b5d 0a20  tons_list = []. 
-00002370: 2020 2020 2020 2073 656c 662e 766d 6c5f         self.vml_
-00002380: 6865 6164 6572 5f69 6420 3d20 300a 0a20  header_id = 0.. 
-00002390: 2020 2020 2020 2073 656c 662e 6175 746f         self.auto
-000023a0: 6669 6c74 6572 5f61 7265 6120 3d20 2727  filter_area = ''
-000023b0: 0a20 2020 2020 2020 2073 656c 662e 6175  .        self.au
-000023c0: 746f 6669 6c74 6572 5f72 6566 203d 204e  tofilter_ref = N
-000023d0: 6f6e 650a 2020 2020 2020 2020 7365 6c66  one.        self
-000023e0: 2e66 696c 7465 725f 7261 6e67 6520 3d20  .filter_range = 
-000023f0: 5b5d 0a20 2020 2020 2020 2073 656c 662e  [].        self.
-00002400: 6669 6c74 6572 5f6f 6e20 3d20 300a 2020  filter_on = 0.  
-00002410: 2020 2020 2020 7365 6c66 2e66 696c 7465        self.filte
-00002420: 725f 636f 6c73 203d 207b 7d0a 2020 2020  r_cols = {}.    
-00002430: 2020 2020 7365 6c66 2e66 696c 7465 725f      self.filter_
-00002440: 7479 7065 203d 207b 7d0a 2020 2020 2020  type = {}.      
-00002450: 2020 7365 6c66 2e66 696c 7465 725f 6365    self.filter_ce
-00002460: 6c6c 7320 3d20 7b7d 0a0a 2020 2020 2020  lls = {}..      
-00002470: 2020 7365 6c66 2e72 6f77 5f73 697a 6573    self.row_sizes
-00002480: 203d 207b 7d0a 2020 2020 2020 2020 7365   = {}.        se
-00002490: 6c66 2e63 6f6c 5f73 697a 655f 6368 616e  lf.col_size_chan
-000024a0: 6765 6420 3d20 4661 6c73 650a 2020 2020  ged = False.    
-000024b0: 2020 2020 7365 6c66 2e72 6f77 5f73 697a      self.row_siz
-000024c0: 655f 6368 616e 6765 6420 3d20 4661 6c73  e_changed = Fals
-000024d0: 650a 0a20 2020 2020 2020 2073 656c 662e  e..        self.
-000024e0: 6c61 7374 5f73 6861 7065 5f69 6420 3d20  last_shape_id = 
-000024f0: 310a 2020 2020 2020 2020 7365 6c66 2e72  1.        self.r
-00002500: 656c 5f63 6f75 6e74 203d 2030 0a20 2020  el_count = 0.   
-00002510: 2020 2020 2073 656c 662e 686c 696e 6b5f       self.hlink_
-00002520: 636f 756e 7420 3d20 300a 2020 2020 2020  count = 0.      
-00002530: 2020 7365 6c66 2e68 6c69 6e6b 5f72 6566    self.hlink_ref
-00002540: 7320 3d20 5b5d 0a20 2020 2020 2020 2073  s = [].        s
-00002550: 656c 662e 6578 7465 726e 616c 5f68 7970  elf.external_hyp
-00002560: 6572 5f6c 696e 6b73 203d 205b 5d0a 2020  er_links = [].  
-00002570: 2020 2020 2020 7365 6c66 2e65 7874 6572        self.exter
-00002580: 6e61 6c5f 6472 6177 696e 675f 6c69 6e6b  nal_drawing_link
-00002590: 7320 3d20 5b5d 0a20 2020 2020 2020 2073  s = [].        s
-000025a0: 656c 662e 6578 7465 726e 616c 5f63 6f6d  elf.external_com
-000025b0: 6d65 6e74 5f6c 696e 6b73 203d 205b 5d0a  ment_links = [].
-000025c0: 2020 2020 2020 2020 7365 6c66 2e65 7874          self.ext
-000025d0: 6572 6e61 6c5f 766d 6c5f 6c69 6e6b 7320  ernal_vml_links 
-000025e0: 3d20 5b5d 0a20 2020 2020 2020 2073 656c  = [].        sel
-000025f0: 662e 6578 7465 726e 616c 5f74 6162 6c65  f.external_table
-00002600: 5f6c 696e 6b73 203d 205b 5d0a 2020 2020  _links = [].    
-00002610: 2020 2020 7365 6c66 2e65 7874 6572 6e61      self.externa
-00002620: 6c5f 6261 636b 6772 6f75 6e64 5f6c 696e  l_background_lin
-00002630: 6b73 203d 205b 5d0a 2020 2020 2020 2020  ks = [].        
-00002640: 7365 6c66 2e64 7261 7769 6e67 5f6c 696e  self.drawing_lin
-00002650: 6b73 203d 205b 5d0a 2020 2020 2020 2020  ks = [].        
-00002660: 7365 6c66 2e76 6d6c 5f64 7261 7769 6e67  self.vml_drawing
-00002670: 5f6c 696e 6b73 203d 205b 5d0a 2020 2020  _links = [].    
-00002680: 2020 2020 7365 6c66 2e63 6861 7274 7320      self.charts 
-00002690: 3d20 5b5d 0a20 2020 2020 2020 2073 656c  = [].        sel
-000026a0: 662e 696d 6167 6573 203d 205b 5d0a 2020  f.images = [].  
-000026b0: 2020 2020 2020 7365 6c66 2e74 6162 6c65        self.table
-000026c0: 7320 3d20 5b5d 0a20 2020 2020 2020 2073  s = [].        s
-000026d0: 656c 662e 7370 6172 6b6c 696e 6573 203d  elf.sparklines =
-000026e0: 205b 5d0a 2020 2020 2020 2020 7365 6c66   [].        self
-000026f0: 2e73 6861 7065 7320 3d20 5b5d 0a20 2020  .shapes = [].   
-00002700: 2020 2020 2073 656c 662e 7368 6170 655f       self.shape_
-00002710: 6861 7368 203d 207b 7d0a 2020 2020 2020  hash = {}.      
-00002720: 2020 7365 6c66 2e64 7261 7769 6e67 203d    self.drawing =
-00002730: 2030 0a20 2020 2020 2020 2073 656c 662e   0.        self.
-00002740: 6472 6177 696e 675f 7265 6c73 203d 207b  drawing_rels = {
-00002750: 7d0a 2020 2020 2020 2020 7365 6c66 2e64  }.        self.d
-00002760: 7261 7769 6e67 5f72 656c 735f 6964 203d  rawing_rels_id =
-00002770: 2030 0a20 2020 2020 2020 2073 656c 662e   0.        self.
-00002780: 766d 6c5f 6472 6177 696e 675f 7265 6c73  vml_drawing_rels
-00002790: 203d 207b 7d0a 2020 2020 2020 2020 7365   = {}.        se
-000027a0: 6c66 2e76 6d6c 5f64 7261 7769 6e67 5f72  lf.vml_drawing_r
-000027b0: 656c 735f 6964 203d 2030 0a20 2020 2020  els_id = 0.     
-000027c0: 2020 2073 656c 662e 6261 636b 6772 6f75     self.backgrou
-000027d0: 6e64 5f69 6d61 6765 203d 204e 6f6e 650a  nd_image = None.
-000027e0: 2020 2020 2020 2020 7365 6c66 2e62 6163          self.bac
-000027f0: 6b67 726f 756e 645f 6279 7465 7320 3d20  kground_bytes = 
-00002800: 4661 6c73 650a 0a20 2020 2020 2020 2073  False..        s
-00002810: 656c 662e 7273 7472 696e 6720 3d20 2727  elf.rstring = ''
-00002820: 0a20 2020 2020 2020 2073 656c 662e 7072  .        self.pr
-00002830: 6576 696f 7573 5f72 6f77 203d 2030 0a0a  evious_row = 0..
-00002840: 2020 2020 2020 2020 7365 6c66 2e76 616c          self.val
-00002850: 6964 6174 696f 6e73 203d 205b 5d0a 2020  idations = [].  
-00002860: 2020 2020 2020 7365 6c66 2e63 6f6e 645f        self.cond_
-00002870: 666f 726d 6174 7320 3d20 7b7d 0a20 2020  formats = {}.   
-00002880: 2020 2020 2073 656c 662e 6461 7461 5f62       self.data_b
-00002890: 6172 735f 3230 3130 203d 205b 5d0a 2020  ars_2010 = [].  
-000028a0: 2020 2020 2020 7365 6c66 2e75 7365 5f64        self.use_d
-000028b0: 6174 615f 6261 7273 5f32 3031 3020 3d20  ata_bars_2010 = 
-000028c0: 4661 6c73 650a 2020 2020 2020 2020 7365  False.        se
-000028d0: 6c66 2e64 7866 5f70 7269 6f72 6974 7920  lf.dxf_priority 
-000028e0: 3d20 310a 2020 2020 2020 2020 7365 6c66  = 1.        self
-000028f0: 2e70 6167 655f 7669 6577 203d 2030 0a0a  .page_view = 0..
-00002900: 2020 2020 2020 2020 7365 6c66 2e76 6261          self.vba
-00002910: 5f63 6f64 656e 616d 6520 3d20 4e6f 6e65  _codename = None
-00002920: 0a0a 2020 2020 2020 2020 7365 6c66 2e64  ..        self.d
-00002930: 6174 655f 3139 3034 203d 2046 616c 7365  ate_1904 = False
-00002940: 0a20 2020 2020 2020 2073 656c 662e 6879  .        self.hy
-00002950: 7065 726c 696e 6b73 203d 2064 6566 6175  perlinks = defau
-00002960: 6c74 6469 6374 2864 6963 7429 0a0a 2020  ltdict(dict)..  
-00002970: 2020 2020 2020 7365 6c66 2e73 7472 696e        self.strin
-00002980: 6773 5f74 6f5f 6e75 6d62 6572 7320 3d20  gs_to_numbers = 
-00002990: 4661 6c73 650a 2020 2020 2020 2020 7365  False.        se
-000029a0: 6c66 2e73 7472 696e 6773 5f74 6f5f 7572  lf.strings_to_ur
-000029b0: 6c73 203d 2054 7275 650a 2020 2020 2020  ls = True.      
-000029c0: 2020 7365 6c66 2e6e 616e 5f69 6e66 5f74    self.nan_inf_t
-000029d0: 6f5f 6572 726f 7273 203d 2046 616c 7365  o_errors = False
-000029e0: 0a20 2020 2020 2020 2073 656c 662e 7374  .        self.st
-000029f0: 7269 6e67 735f 746f 5f66 6f72 6d75 6c61  rings_to_formula
-00002a00: 7320 3d20 5472 7565 0a0a 2020 2020 2020  s = True..      
-00002a10: 2020 7365 6c66 2e64 6566 6175 6c74 5f64    self.default_d
-00002a20: 6174 655f 666f 726d 6174 203d 204e 6f6e  ate_format = Non
-00002a30: 650a 2020 2020 2020 2020 7365 6c66 2e64  e.        self.d
-00002a40: 6566 6175 6c74 5f75 726c 5f66 6f72 6d61  efault_url_forma
-00002a50: 7420 3d20 4e6f 6e65 0a20 2020 2020 2020  t = None.       
-00002a60: 2073 656c 662e 7265 6d6f 7665 5f74 696d   self.remove_tim
-00002a70: 657a 6f6e 6520 3d20 4661 6c73 650a 2020  ezone = False.  
-00002a80: 2020 2020 2020 7365 6c66 2e6d 6178 5f75        self.max_u
-00002a90: 726c 5f6c 656e 6774 6820 3d20 3230 3739  rl_length = 2079
-00002aa0: 0a0a 2020 2020 2020 2020 7365 6c66 2e72  ..        self.r
-00002ab0: 6f77 5f64 6174 615f 6669 6c65 6e61 6d65  ow_data_filename
-00002ac0: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-00002ad0: 7365 6c66 2e72 6f77 5f64 6174 615f 6668  self.row_data_fh
-00002ae0: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-00002af0: 7365 6c66 2e77 6f72 6b73 6865 6574 5f6d  self.worksheet_m
-00002b00: 6574 6120 3d20 4e6f 6e65 0a20 2020 2020  eta = None.     
-00002b10: 2020 2073 656c 662e 766d 6c5f 6461 7461     self.vml_data
-00002b20: 5f69 6420 3d20 4e6f 6e65 0a20 2020 2020  _id = None.     
-00002b30: 2020 2073 656c 662e 766d 6c5f 7368 6170     self.vml_shap
-00002b40: 655f 6964 203d 204e 6f6e 650a 0a20 2020  e_id = None..   
-00002b50: 2020 2020 2073 656c 662e 726f 775f 6461       self.row_da
-00002b60: 7461 5f66 696c 656e 616d 6520 3d20 4e6f  ta_filename = No
-00002b70: 6e65 0a20 2020 2020 2020 2073 656c 662e  ne.        self.
-00002b80: 726f 775f 6461 7461 5f66 6820 3d20 4e6f  row_data_fh = No
-00002b90: 6e65 0a20 2020 2020 2020 2073 656c 662e  ne.        self.
-00002ba0: 726f 775f 6461 7461 5f66 685f 636c 6f73  row_data_fh_clos
-00002bb0: 6564 203d 2046 616c 7365 0a0a 2020 2020  ed = False..    
-00002bc0: 2020 2020 7365 6c66 2e76 6572 7469 6361      self.vertica
-00002bd0: 6c5f 6470 6920 3d20 300a 2020 2020 2020  l_dpi = 0.      
-00002be0: 2020 7365 6c66 2e68 6f72 697a 6f6e 7461    self.horizonta
-00002bf0: 6c5f 6470 6920 3d20 300a 0a20 2020 2020  l_dpi = 0..     
-00002c00: 2020 2073 656c 662e 7772 6974 655f 6861     self.write_ha
-00002c10: 6e64 6c65 7273 203d 207b 7d0a 0a20 2020  ndlers = {}..   
-00002c20: 2020 2020 2073 656c 662e 6967 6e6f 7265       self.ignore
-00002c30: 645f 6572 726f 7273 203d 204e 6f6e 650a  d_errors = None.
-00002c40: 0a20 2020 2020 2020 2073 656c 662e 6861  .        self.ha
-00002c50: 735f 6479 6e61 6d69 635f 6172 7261 7973  s_dynamic_arrays
-00002c60: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
-00002c70: 2073 656c 662e 7573 655f 6675 7475 7265   self.use_future
-00002c80: 5f66 756e 6374 696f 6e73 203d 2046 616c  _functions = Fal
-00002c90: 7365 0a0a 2020 2020 2320 5574 696c 6974  se..    # Utilit
-00002ca0: 7920 6675 6e63 7469 6f6e 2066 6f72 2077  y function for w
-00002cb0: 7269 7469 6e67 2064 6966 6665 7265 6e74  riting different
-00002cc0: 2074 7970 6573 206f 6620 7374 7269 6e67   types of string
-00002cd0: 732e 0a20 2020 2064 6566 205f 7772 6974  s..    def _writ
-00002ce0: 655f 746f 6b65 6e5f 6173 5f73 7472 696e  e_token_as_strin
-00002cf0: 6728 7365 6c66 2c20 746f 6b65 6e2c 2072  g(self, token, r
-00002d00: 6f77 2c20 636f 6c2c 202a 6172 6773 293a  ow, col, *args):
-00002d10: 0a20 2020 2020 2020 2023 204d 6170 2074  .        # Map t
-00002d20: 6865 2064 6174 6120 746f 2074 6865 2061  he data to the a
-00002d30: 7070 726f 7072 6961 7465 2077 7269 7465  ppropriate write
-00002d40: 5f2a 2829 206d 6574 686f 642e 0a20 2020  _*() method..   
-00002d50: 2020 2020 2069 6620 746f 6b65 6e20 3d3d       if token ==
-00002d60: 2027 273a 0a20 2020 2020 2020 2020 2020   '':.           
-00002d70: 2072 6574 7572 6e20 7365 6c66 2e5f 7772   return self._wr
-00002d80: 6974 655f 626c 616e 6b28 726f 772c 2063  ite_blank(row, c
-00002d90: 6f6c 2c20 2a61 7267 7329 0a0a 2020 2020  ol, *args)..    
-00002da0: 2020 2020 6966 2073 656c 662e 7374 7269      if self.stri
-00002db0: 6e67 735f 746f 5f66 6f72 6d75 6c61 7320  ngs_to_formulas 
-00002dc0: 616e 6420 746f 6b65 6e2e 7374 6172 7473  and token.starts
-00002dd0: 7769 7468 2827 3d27 293a 0a20 2020 2020  with('='):.     
-00002de0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00002df0: 6c66 2e5f 7772 6974 655f 666f 726d 756c  lf._write_formul
-00002e00: 6128 726f 772c 2063 6f6c 2c20 2a61 7267  a(row, col, *arg
-00002e10: 7329 0a0a 2020 2020 2020 2020 6966 2074  s)..        if t
-00002e20: 6f6b 656e 2e73 7461 7274 7377 6974 6828  oken.startswith(
-00002e30: 277b 3d27 2920 616e 6420 746f 6b65 6e2e  '{=') and token.
-00002e40: 656e 6473 7769 7468 2827 7d27 293a 0a20  endswith('}'):. 
-00002e50: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00002e60: 6e20 7365 6c66 2e5f 7772 6974 655f 666f  n self._write_fo
-00002e70: 726d 756c 6128 726f 772c 2063 6f6c 2c20  rmula(row, col, 
-00002e80: 2a61 7267 7329 0a0a 2020 2020 2020 2020  *args)..        
-00002e90: 6966 2027 3a27 2069 6e20 746f 6b65 6e3a  if ':' in token:
-00002ea0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00002eb0: 7365 6c66 2e73 7472 696e 6773 5f74 6f5f  self.strings_to_
-00002ec0: 7572 6c73 2061 6e64 2072 652e 6d61 7463  urls and re.matc
-00002ed0: 6828 2728 6674 707c 6874 7470 2973 3f3a  h('(ftp|http)s?:
-00002ee0: 2f2f 272c 2074 6f6b 656e 293a 0a20 2020  //', token):.   
-00002ef0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00002f00: 7572 6e20 7365 6c66 2e5f 7772 6974 655f  urn self._write_
-00002f10: 7572 6c28 726f 772c 2063 6f6c 2c20 2a61  url(row, col, *a
-00002f20: 7267 7329 0a20 2020 2020 2020 2020 2020  rgs).           
-00002f30: 2065 6c69 6620 7365 6c66 2e73 7472 696e   elif self.strin
-00002f40: 6773 5f74 6f5f 7572 6c73 2061 6e64 2072  gs_to_urls and r
-00002f50: 652e 6d61 7463 6828 276d 6169 6c74 6f3a  e.match('mailto:
-00002f60: 272c 2074 6f6b 656e 293a 0a20 2020 2020  ', token):.     
-00002f70: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00002f80: 6e20 7365 6c66 2e5f 7772 6974 655f 7572  n self._write_ur
-00002f90: 6c28 726f 772c 2063 6f6c 2c20 2a61 7267  l(row, col, *arg
-00002fa0: 7329 0a20 2020 2020 2020 2020 2020 2065  s).            e
-00002fb0: 6c69 6620 7365 6c66 2e73 7472 696e 6773  lif self.strings
-00002fc0: 5f74 6f5f 7572 6c73 2061 6e64 2072 652e  _to_urls and re.
-00002fd0: 6d61 7463 6828 2728 696e 7c65 7829 7465  match('(in|ex)te
-00002fe0: 726e 616c 3a27 2c20 746f 6b65 6e29 3a0a  rnal:', token):.
-00002ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003000: 7265 7475 726e 2073 656c 662e 5f77 7269  return self._wri
-00003010: 7465 5f75 726c 2872 6f77 2c20 636f 6c2c  te_url(row, col,
-00003020: 202a 6172 6773 290a 0a20 2020 2020 2020   *args)..       
-00003030: 2069 6620 7365 6c66 2e73 7472 696e 6773   if self.strings
-00003040: 5f74 6f5f 6e75 6d62 6572 733a 0a20 2020  _to_numbers:.   
-00003050: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
-00003060: 2020 2020 2020 2020 2020 2020 2020 6620                f 
-00003070: 3d20 666c 6f61 7428 746f 6b65 6e29 0a20  = float(token). 
-00003080: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00003090: 6620 2873 656c 662e 6e61 6e5f 696e 665f  f (self.nan_inf_
-000030a0: 746f 5f65 7272 6f72 7320 6f72 0a20 2020  to_errors or.   
-000030b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000030c0: 2020 2020 2028 6e6f 7420 6973 6e61 6e28       (not isnan(
-000030d0: 6629 2061 6e64 206e 6f74 2069 7369 6e66  f) and not isinf
-000030e0: 2866 2929 293a 0a20 2020 2020 2020 2020  (f))):.         
-000030f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00003100: 6e20 7365 6c66 2e5f 7772 6974 655f 6e75  n self._write_nu
-00003110: 6d62 6572 2872 6f77 2c20 636f 6c2c 2066  mber(row, col, f
-00003120: 2c20 2a61 7267 735b 313a 5d29 0a20 2020  , *args[1:]).   
-00003130: 2020 2020 2020 2020 2065 7863 6570 7420           except 
-00003140: 5661 6c75 6545 7272 6f72 3a0a 2020 2020  ValueError:.    
-00003150: 2020 2020 2020 2020 2020 2020 2320 4e6f              # No
-00003160: 7420 6120 6e75 6d62 6572 2c20 7772 6974  t a number, writ
-00003170: 6520 6173 2061 2073 7472 696e 672e 0a20  e as a string.. 
-00003180: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00003190: 6173 730a 0a20 2020 2020 2020 2020 2020  ass..           
-000031a0: 2072 6574 7572 6e20 7365 6c66 2e5f 7772   return self._wr
-000031b0: 6974 655f 7374 7269 6e67 2872 6f77 2c20  ite_string(row, 
-000031c0: 636f 6c2c 202a 6172 6773 290a 0a20 2020  col, *args)..   
-000031d0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000031e0: 2020 2020 2020 2023 2057 6520 6861 7665         # We have
-000031f0: 2061 2070 6c61 696e 2073 7472 696e 672e   a plain string.
-00003200: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00003210: 7572 6e20 7365 6c66 2e5f 7772 6974 655f  urn self._write_
-00003220: 7374 7269 6e67 2872 6f77 2c20 636f 6c2c  string(row, col,
-00003230: 202a 6172 6773 290a 0a20 2020 2040 636f   *args)..    @co
-00003240: 6e76 6572 745f 6365 6c6c 5f61 7267 730a  nvert_cell_args.
-00003250: 2020 2020 6465 6620 7772 6974 6528 7365      def write(se
-00003260: 6c66 2c20 726f 772c 2063 6f6c 2c20 2a61  lf, row, col, *a
-00003270: 7267 7329 3a0a 2020 2020 2020 2020 2222  rgs):.        ""
-00003280: 220a 2020 2020 2020 2020 5772 6974 6520  ".        Write 
-00003290: 6461 7461 2074 6f20 6120 776f 726b 7368  data to a worksh
-000032a0: 6565 7420 6365 6c6c 2062 7920 6361 6c6c  eet cell by call
-000032b0: 696e 6720 7468 6520 6170 7072 6f70 7269  ing the appropri
-000032c0: 6174 6520 7772 6974 655f 2a28 290a 2020  ate write_*().  
-000032d0: 2020 2020 2020 6d65 7468 6f64 2062 6173        method bas
-000032e0: 6564 206f 6e20 7468 6520 7479 7065 206f  ed on the type o
-000032f0: 6620 6461 7461 2062 6569 6e67 2070 6173  f data being pas
-00003300: 7365 642e 0a0a 2020 2020 2020 2020 4172  sed...        Ar
-00003310: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
-00003320: 726f 773a 2020 2054 6865 2063 656c 6c20  row:   The cell 
-00003330: 726f 7720 287a 6572 6f20 696e 6465 7865  row (zero indexe
-00003340: 6429 2e0a 2020 2020 2020 2020 2020 2020  d)..            
-00003350: 636f 6c3a 2020 2054 6865 2063 656c 6c20  col:   The cell 
-00003360: 636f 6c75 6d6e 2028 7a65 726f 2069 6e64  column (zero ind
-00003370: 6578 6564 292e 0a20 2020 2020 2020 2020  exed)..         
-00003380: 2020 202a 6172 6773 3a20 4172 6773 2074     *args: Args t
-00003390: 6f20 7061 7373 2074 6f20 7375 6220 6675  o pass to sub fu
-000033a0: 6e63 7469 6f6e 732e 0a0a 2020 2020 2020  nctions...      
-000033b0: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
-000033c0: 2020 2020 2020 2020 303a 2020 2020 5375          0:    Su
-000033d0: 6363 6573 732e 0a20 2020 2020 2020 2020  ccess..         
-000033e0: 2020 202d 313a 2020 2020 526f 7720 6f72     -1:    Row or
-000033f0: 2063 6f6c 756d 6e20 6973 206f 7574 206f   column is out o
-00003400: 6620 776f 726b 7368 6565 7420 626f 756e  f worksheet boun
-00003410: 6473 2e0a 2020 2020 2020 2020 2020 2020  ds..            
-00003420: 6f74 6865 723a 2052 6574 7572 6e20 7661  other: Return va
-00003430: 6c75 6520 6f66 2063 616c 6c65 6420 6d65  lue of called me
-00003440: 7468 6f64 2e0a 0a20 2020 2020 2020 2022  thod...        "
-00003450: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00003460: 6e20 7365 6c66 2e5f 7772 6974 6528 726f  n self._write(ro
-00003470: 772c 2063 6f6c 2c20 2a61 7267 7329 0a0a  w, col, *args)..
-00003480: 2020 2020 2320 556e 6465 636f 7261 7465      # Undecorate
-00003490: 6420 7665 7273 696f 6e20 6f66 2077 7269  d version of wri
-000034a0: 7465 2829 2e0a 2020 2020 6465 6620 5f77  te()..    def _w
-000034b0: 7269 7465 2873 656c 662c 2072 6f77 2c20  rite(self, row, 
-000034c0: 636f 6c2c 202a 6172 6773 293a 0a20 2020  col, *args):.   
-000034d0: 2020 2020 2023 2043 6865 636b 2074 6865       # Check the
-000034e0: 206e 756d 6265 7220 6f66 2061 7267 7320   number of args 
-000034f0: 7061 7373 6564 2e0a 2020 2020 2020 2020  passed..        
-00003500: 6966 206e 6f74 2061 7267 733a 0a20 2020  if not args:.   
-00003510: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-00003520: 7970 6545 7272 6f72 2822 7772 6974 6528  ypeError("write(
-00003530: 2920 7461 6b65 7320 6174 206c 6561 7374  ) takes at least
-00003540: 2034 2061 7267 756d 656e 7473 2028 3320   4 arguments (3 
-00003550: 6769 7665 6e29 2229 0a0a 2020 2020 2020  given)")..      
-00003560: 2020 2320 5468 6520 6669 7273 7420 6172    # The first ar
-00003570: 6720 7368 6f75 6c64 2062 6520 7468 6520  g should be the 
-00003580: 746f 6b65 6e20 666f 7220 616c 6c20 7772  token for all wr
-00003590: 6974 6520 6361 6c6c 732e 0a20 2020 2020  ite calls..     
-000035a0: 2020 2074 6f6b 656e 203d 2061 7267 735b     token = args[
-000035b0: 305d 0a0a 2020 2020 2020 2020 2320 4176  0]..        # Av
-000035c0: 6f69 6420 6973 696e 7374 616e 6365 2829  oid isinstance()
-000035d0: 2066 6f72 2062 6574 7465 7220 7065 7266   for better perf
-000035e0: 6f72 6d61 6e63 652e 0a20 2020 2020 2020  ormance..       
-000035f0: 2074 6f6b 656e 5f74 7970 6520 3d20 746f   token_type = to
-00003600: 6b65 6e2e 5f5f 636c 6173 735f 5f0a 0a20  ken.__class__.. 
-00003610: 2020 2020 2020 2023 2043 6865 636b 2066         # Check f
-00003620: 6f72 2061 6e79 2075 7365 7220 6465 6669  or any user defi
-00003630: 6e65 6420 7479 7065 2068 616e 646c 6572  ned type handler
-00003640: 7320 7769 7468 2063 616c 6c62 6163 6b20  s with callback 
-00003650: 6675 6e63 7469 6f6e 732e 0a20 2020 2020  functions..     
-00003660: 2020 2069 6620 746f 6b65 6e5f 7479 7065     if token_type
-00003670: 2069 6e20 7365 6c66 2e77 7269 7465 5f68   in self.write_h
-00003680: 616e 646c 6572 733a 0a20 2020 2020 2020  andlers:.       
-00003690: 2020 2020 2077 7269 7465 5f68 616e 646c       write_handl
-000036a0: 6572 203d 2073 656c 662e 7772 6974 655f  er = self.write_
-000036b0: 6861 6e64 6c65 7273 5b74 6f6b 656e 5f74  handlers[token_t
-000036c0: 7970 655d 0a20 2020 2020 2020 2020 2020  ype].           
-000036d0: 2066 756e 6374 696f 6e5f 7265 7475 726e   function_return
-000036e0: 203d 2077 7269 7465 5f68 616e 646c 6572   = write_handler
-000036f0: 2873 656c 662c 2072 6f77 2c20 636f 6c2c  (self, row, col,
-00003700: 202a 6172 6773 290a 0a20 2020 2020 2020   *args)..       
-00003710: 2020 2020 2023 2049 6620 7468 6520 7265       # If the re
-00003720: 7475 726e 2076 616c 7565 2069 7320 4e6f  turn value is No
-00003730: 6e65 2074 6865 6e20 7468 6520 6361 6c6c  ne then the call
-00003740: 6261 636b 2068 6173 2072 6574 7572 6e65  back has returne
-00003750: 640a 2020 2020 2020 2020 2020 2020 2320  d.            # 
-00003760: 636f 6e74 726f 6c20 746f 2074 6869 7320  control to this 
-00003770: 6675 6e63 7469 6f6e 2061 6e64 2077 6520  function and we 
-00003780: 7368 6f75 6c64 2063 6f6e 7469 6e75 6520  should continue 
-00003790: 6173 0a20 2020 2020 2020 2020 2020 2023  as.            #
-000037a0: 206e 6f72 6d61 6c2e 204f 7468 6572 7769   normal. Otherwi
-000037b0: 7365 2077 6520 7265 7475 726e 2074 6865  se we return the
-000037c0: 2076 616c 7565 2074 6f20 7468 6520 6361   value to the ca
-000037d0: 6c6c 6572 2061 6e64 2065 7869 742e 0a20  ller and exit.. 
-000037e0: 2020 2020 2020 2020 2020 2069 6620 6675             if fu
-000037f0: 6e63 7469 6f6e 5f72 6574 7572 6e20 6973  nction_return is
-00003800: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00003810: 2020 2020 2020 2070 6173 730a 2020 2020         pass.    
-00003820: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00003830: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00003840: 7475 726e 2066 756e 6374 696f 6e5f 7265  turn function_re
-00003850: 7475 726e 0a0a 2020 2020 2020 2020 2320  turn..        # 
-00003860: 5772 6974 6520 4e6f 6e65 2061 7320 6120  Write None as a 
-00003870: 626c 616e 6b20 6365 6c6c 2e0a 2020 2020  blank cell..    
-00003880: 2020 2020 6966 2074 6f6b 656e 2069 7320      if token is 
-00003890: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-000038a0: 2020 7265 7475 726e 2073 656c 662e 5f77    return self._w
-000038b0: 7269 7465 5f62 6c61 6e6b 2872 6f77 2c20  rite_blank(row, 
-000038c0: 636f 6c2c 202a 6172 6773 290a 0a20 2020  col, *args)..   
-000038d0: 2020 2020 2023 2043 6865 636b 2066 6f72       # Check for
-000038e0: 2073 7461 6e64 6172 6420 5079 7468 6f6e   standard Python
-000038f0: 2074 7970 6573 2e0a 2020 2020 2020 2020   types..        
-00003900: 6966 2074 6f6b 656e 5f74 7970 6520 6973  if token_type is
-00003910: 2062 6f6f 6c3a 0a20 2020 2020 2020 2020   bool:.         
-00003920: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-00003930: 7772 6974 655f 626f 6f6c 6561 6e28 726f  write_boolean(ro
-00003940: 772c 2063 6f6c 2c20 2a61 7267 7329 0a0a  w, col, *args)..
-00003950: 2020 2020 2020 2020 6966 2074 6f6b 656e          if token
-00003960: 5f74 7970 6520 696e 2028 666c 6f61 742c  _type in (float,
-00003970: 2069 6e74 2c20 4465 6369 6d61 6c2c 2046   int, Decimal, F
-00003980: 7261 6374 696f 6e29 3a0a 2020 2020 2020  raction):.      
-00003990: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000039a0: 662e 5f77 7269 7465 5f6e 756d 6265 7228  f._write_number(
-000039b0: 726f 772c 2063 6f6c 2c20 2a61 7267 7329  row, col, *args)
-000039c0: 0a0a 2020 2020 2020 2020 6966 2074 6f6b  ..        if tok
-000039d0: 656e 5f74 7970 6520 6973 2073 7472 3a0a  en_type is str:.
-000039e0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000039f0: 726e 2073 656c 662e 5f77 7269 7465 5f74  rn self._write_t
-00003a00: 6f6b 656e 5f61 735f 7374 7269 6e67 2874  oken_as_string(t
-00003a10: 6f6b 656e 2c20 726f 772c 2063 6f6c 2c20  oken, row, col, 
-00003a20: 2a61 7267 7329 0a0a 2020 2020 2020 2020  *args)..        
-00003a30: 6966 2074 6f6b 656e 5f74 7970 6520 696e  if token_type in
-00003a40: 2028 6461 7465 7469 6d65 2e64 6174 6574   (datetime.datet
-00003a50: 696d 652c 0a20 2020 2020 2020 2020 2020  ime,.           
-00003a60: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00003a70: 6174 6574 696d 652e 6461 7465 2c0a 2020  atetime.date,.  
-00003a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003a90: 2020 2020 2020 2020 6461 7465 7469 6d65          datetime
-00003aa0: 2e74 696d 652c 0a20 2020 2020 2020 2020  .time,.         
-00003ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003ac0: 2064 6174 6574 696d 652e 7469 6d65 6465   datetime.timede
-00003ad0: 6c74 6129 3a0a 2020 2020 2020 2020 2020  lta):.          
-00003ae0: 2020 7265 7475 726e 2073 656c 662e 5f77    return self._w
-00003af0: 7269 7465 5f64 6174 6574 696d 6528 726f  rite_datetime(ro
-00003b00: 772c 2063 6f6c 2c20 2a61 7267 7329 0a0a  w, col, *args)..
-00003b10: 2020 2020 2020 2020 2320 5265 736f 7274          # Resort
-00003b20: 2074 6f20 6973 696e 7374 616e 6365 2829   to isinstance()
-00003b30: 2066 6f72 2073 7562 636c 6173 7365 6420   for subclassed 
-00003b40: 7072 696d 6974 6976 6573 2e0a 0a20 2020  primitives...   
-00003b50: 2020 2020 2023 2057 7269 7465 206e 756d       # Write num
-00003b60: 6265 7220 7479 7065 732e 0a20 2020 2020  ber types..     
-00003b70: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00003b80: 2874 6f6b 656e 2c20 2866 6c6f 6174 2c20  (token, (float, 
-00003b90: 696e 742c 2044 6563 696d 616c 2c20 4672  int, Decimal, Fr
-00003ba0: 6163 7469 6f6e 2929 3a0a 2020 2020 2020  action)):.      
-00003bb0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00003bc0: 662e 5f77 7269 7465 5f6e 756d 6265 7228  f._write_number(
-00003bd0: 726f 772c 2063 6f6c 2c20 2a61 7267 7329  row, col, *args)
-00003be0: 0a0a 2020 2020 2020 2020 2320 5772 6974  ..        # Writ
-00003bf0: 6520 7374 7269 6e67 2074 7970 6573 2e0a  e string types..
-00003c00: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00003c10: 7461 6e63 6528 746f 6b65 6e2c 2073 7472  tance(token, str
-00003c20: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00003c30: 6574 7572 6e20 7365 6c66 2e5f 7772 6974  eturn self._writ
-00003c40: 655f 746f 6b65 6e5f 6173 5f73 7472 696e  e_token_as_strin
-00003c50: 6728 746f 6b65 6e2c 2072 6f77 2c20 636f  g(token, row, co
-00003c60: 6c2c 202a 6172 6773 290a 0a20 2020 2020  l, *args)..     
-00003c70: 2020 2023 2057 7269 7465 2062 6f6f 6c65     # Write boole
-00003c80: 616e 2074 7970 6573 2e0a 2020 2020 2020  an types..      
-00003c90: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00003ca0: 746f 6b65 6e2c 2062 6f6f 6c29 3a0a 2020  token, bool):.  
-00003cb0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00003cc0: 2073 656c 662e 5f77 7269 7465 5f62 6f6f   self._write_boo
-00003cd0: 6c65 616e 2872 6f77 2c20 636f 6c2c 202a  lean(row, col, *
-00003ce0: 6172 6773 290a 0a20 2020 2020 2020 2023  args)..        #
-00003cf0: 2057 7269 7465 2064 6174 6574 696d 6520   Write datetime 
-00003d00: 6f62 6a65 6374 732e 0a20 2020 2020 2020  objects..       
-00003d10: 2069 6620 7375 7070 6f72 7465 645f 6461   if supported_da
-00003d20: 7465 7469 6d65 2874 6f6b 656e 293a 0a20  tetime(token):. 
-00003d30: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00003d40: 6e20 7365 6c66 2e5f 7772 6974 655f 6461  n self._write_da
-00003d50: 7465 7469 6d65 2872 6f77 2c20 636f 6c2c  tetime(row, col,
-00003d60: 202a 6172 6773 290a 0a20 2020 2020 2020   *args)..       
-00003d70: 2023 2057 6520 6861 7665 6e27 7420 6d61   # We haven't ma
-00003d80: 7463 6865 6420 6120 7375 7070 6f72 7465  tched a supporte
-00003d90: 6420 7479 7065 2e20 5472 7920 666c 6f61  d type. Try floa
-00003da0: 742e 0a20 2020 2020 2020 2074 7279 3a0a  t..        try:.
-00003db0: 2020 2020 2020 2020 2020 2020 6620 3d20              f = 
-00003dc0: 666c 6f61 7428 746f 6b65 6e29 0a20 2020  float(token).   
-00003dd0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00003de0: 7365 6c66 2e5f 7772 6974 655f 6e75 6d62  self._write_numb
-00003df0: 6572 2872 6f77 2c20 636f 6c2c 2066 2c20  er(row, col, f, 
-00003e00: 2a61 7267 735b 313a 5d29 0a20 2020 2020  *args[1:]).     
-00003e10: 2020 2065 7863 6570 7420 5661 6c75 6545     except ValueE
-00003e20: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
-00003e30: 2020 7061 7373 0a20 2020 2020 2020 2065    pass.        e
-00003e40: 7863 6570 7420 5479 7065 4572 726f 723a  xcept TypeError:
-00003e50: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00003e60: 7365 2054 7970 6545 7272 6f72 2822 556e  se TypeError("Un
-00003e70: 7375 7070 6f72 7465 6420 7479 7065 2025  supported type %
-00003e80: 7320 696e 2077 7269 7465 2829 2220 2520  s in write()" % 
-00003e90: 7479 7065 2874 6f6b 656e 2929 0a0a 2020  type(token))..  
-00003ea0: 2020 2020 2020 2320 4669 6e61 6c6c 7920        # Finally 
-00003eb0: 7472 7920 7374 7269 6e67 2e0a 2020 2020  try string..    
-00003ec0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-00003ed0: 2020 2020 2073 7472 2874 6f6b 656e 290a       str(token).
-00003ee0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00003ef0: 726e 2073 656c 662e 5f77 7269 7465 5f73  rn self._write_s
-00003f00: 7472 696e 6728 726f 772c 2063 6f6c 2c20  tring(row, col, 
-00003f10: 2a61 7267 7329 0a20 2020 2020 2020 2065  *args).        e
-00003f20: 7863 6570 7420 5661 6c75 6545 7272 6f72  xcept ValueError
-00003f30: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00003f40: 6973 6520 5479 7065 4572 726f 7228 2255  ise TypeError("U
-00003f50: 6e73 7570 706f 7274 6564 2074 7970 6520  nsupported type 
-00003f60: 2573 2069 6e20 7772 6974 6528 2922 2025  %s in write()" %
-00003f70: 2074 7970 6528 746f 6b65 6e29 290a 0a20   type(token)).. 
-00003f80: 2020 2040 636f 6e76 6572 745f 6365 6c6c     @convert_cell
-00003f90: 5f61 7267 730a 2020 2020 6465 6620 7772  _args.    def wr
-00003fa0: 6974 655f 7374 7269 6e67 2873 656c 662c  ite_string(self,
-00003fb0: 2072 6f77 2c20 636f 6c2c 2073 7472 696e   row, col, strin
-00003fc0: 672c 2063 656c 6c5f 666f 726d 6174 3d4e  g, cell_format=N
-00003fd0: 6f6e 6529 3a0a 2020 2020 2020 2020 2222  one):.        ""
-00003fe0: 220a 2020 2020 2020 2020 5772 6974 6520  ".        Write 
-00003ff0: 6120 7374 7269 6e67 2074 6f20 6120 776f  a string to a wo
-00004000: 726b 7368 6565 7420 6365 6c6c 2e0a 0a20  rksheet cell... 
-00004010: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
-00004020: 2020 2020 2020 2020 2072 6f77 3a20 2020           row:   
-00004030: 2054 6865 2063 656c 6c20 726f 7720 287a   The cell row (z
-00004040: 6572 6f20 696e 6465 7865 6429 2e0a 2020  ero indexed)..  
-00004050: 2020 2020 2020 2020 2020 636f 6c3a 2020            col:  
-00004060: 2020 5468 6520 6365 6c6c 2063 6f6c 756d    The cell colum
-00004070: 6e20 287a 6572 6f20 696e 6465 7865 6429  n (zero indexed)
-00004080: 2e0a 2020 2020 2020 2020 2020 2020 7374  ..            st
-00004090: 7269 6e67 3a20 4365 6c6c 2064 6174 612e  ring: Cell data.
-000040a0: 2053 7472 2e0a 2020 2020 2020 2020 2020   Str..          
-000040b0: 2020 666f 726d 6174 3a20 416e 206f 7074    format: An opt
-000040c0: 696f 6e61 6c20 6365 6c6c 2046 6f72 6d61  ional cell Forma
-000040d0: 7420 6f62 6a65 6374 2e0a 0a20 2020 2020  t object...     
-000040e0: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
-000040f0: 2020 2020 2020 2020 303a 2020 5375 6363          0:  Succ
-00004100: 6573 732e 0a20 2020 2020 2020 2020 2020  ess..           
-00004110: 202d 313a 2052 6f77 206f 7220 636f 6c75   -1: Row or colu
-00004120: 6d6e 2069 7320 6f75 7420 6f66 2077 6f72  mn is out of wor
-00004130: 6b73 6865 6574 2062 6f75 6e64 732e 0a20  ksheet bounds.. 
-00004140: 2020 2020 2020 2020 2020 202d 323a 2053             -2: S
-00004150: 7472 696e 6720 7472 756e 6361 7465 6420  tring truncated 
-00004160: 746f 2033 326b 2063 6861 7261 6374 6572  to 32k character
-00004170: 732e 0a0a 2020 2020 2020 2020 2222 220a  s...        """.
-00004180: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00004190: 656c 662e 5f77 7269 7465 5f73 7472 696e  elf._write_strin
-000041a0: 6728 726f 772c 2063 6f6c 2c20 7374 7269  g(row, col, stri
-000041b0: 6e67 2c20 6365 6c6c 5f66 6f72 6d61 7429  ng, cell_format)
-000041c0: 0a0a 2020 2020 2320 556e 6465 636f 7261  ..    # Undecora
-000041d0: 7465 6420 7665 7273 696f 6e20 6f66 2077  ted version of w
-000041e0: 7269 7465 5f73 7472 696e 6728 292e 0a20  rite_string().. 
-000041f0: 2020 2064 6566 205f 7772 6974 655f 7374     def _write_st
-00004200: 7269 6e67 2873 656c 662c 2072 6f77 2c20  ring(self, row, 
-00004210: 636f 6c2c 2073 7472 696e 672c 2063 656c  col, string, cel
-00004220: 6c5f 666f 726d 6174 3d4e 6f6e 6529 3a0a  l_format=None):.
-00004230: 0a20 2020 2020 2020 2073 7472 5f65 7272  .        str_err
-00004240: 6f72 203d 2030 0a0a 2020 2020 2020 2020  or = 0..        
-00004250: 2320 4368 6563 6b20 7468 6174 2072 6f77  # Check that row
-00004260: 2061 6e64 2063 6f6c 2061 7265 2076 616c   and col are val
-00004270: 6964 2061 6e64 2073 746f 7265 206d 6178  id and store max
-00004280: 2061 6e64 206d 696e 2076 616c 7565 732e   and min values.
-00004290: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-000042a0: 2e5f 6368 6563 6b5f 6469 6d65 6e73 696f  ._check_dimensio
-000042b0: 6e73 2872 6f77 2c20 636f 6c29 3a0a 2020  ns(row, col):.  
-000042c0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000042d0: 202d 310a 0a20 2020 2020 2020 2023 2043   -1..        # C
-000042e0: 6865 636b 2074 6861 7420 7468 6520 7374  heck that the st
-000042f0: 7269 6e67 2069 7320 3c20 3332 3736 3720  ring is < 32767 
-00004300: 6368 6172 732e 0a20 2020 2020 2020 2069  chars..        i
-00004310: 6620 6c65 6e28 7374 7269 6e67 2920 3e20  f len(string) > 
-00004320: 7365 6c66 2e78 6c73 5f73 7472 6d61 783a  self.xls_strmax:
-00004330: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
-00004340: 696e 6720 3d20 7374 7269 6e67 5b3a 7365  ing = string[:se
-00004350: 6c66 2e78 6c73 5f73 7472 6d61 785d 0a20  lf.xls_strmax]. 
-00004360: 2020 2020 2020 2020 2020 2073 7472 5f65             str_e
-00004370: 7272 6f72 203d 202d 320a 0a20 2020 2020  rror = -2..     
-00004380: 2020 2023 2057 7269 7465 2061 2073 6861     # Write a sha
-00004390: 7265 6420 7374 7269 6e67 206f 7220 616e  red string or an
-000043a0: 2069 6e2d 6c69 6e65 2073 7472 696e 6720   in-line string 
-000043b0: 696e 2063 6f6e 7374 616e 745f 6d65 6d6f  in constant_memo
-000043c0: 7279 206d 6f64 652e 0a20 2020 2020 2020  ry mode..       
-000043d0: 2069 6620 6e6f 7420 7365 6c66 2e63 6f6e   if not self.con
-000043e0: 7374 616e 745f 6d65 6d6f 7279 3a0a 2020  stant_memory:.  
-000043f0: 2020 2020 2020 2020 2020 7374 7269 6e67            string
-00004400: 5f69 6e64 6578 203d 2073 656c 662e 7374  _index = self.st
-00004410: 725f 7461 626c 652e 5f67 6574 5f73 6861  r_table._get_sha
-00004420: 7265 645f 7374 7269 6e67 5f69 6e64 6578  red_string_index
-00004430: 2873 7472 696e 6729 0a20 2020 2020 2020  (string).       
-00004440: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00004450: 2020 2073 7472 696e 675f 696e 6465 7820     string_index 
-00004460: 3d20 7374 7269 6e67 0a0a 2020 2020 2020  = string..      
-00004470: 2020 2320 5772 6974 6520 7072 6576 696f    # Write previo
-00004480: 7573 2072 6f77 2069 6620 696e 2069 6e2d  us row if in in-
-00004490: 6c69 6e65 2073 7472 696e 6720 636f 6e73  line string cons
-000044a0: 7461 6e74 5f6d 656d 6f72 7920 6d6f 6465  tant_memory mode
-000044b0: 2e0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-000044c0: 662e 636f 6e73 7461 6e74 5f6d 656d 6f72  f.constant_memor
-000044d0: 7920 616e 6420 726f 7720 3e20 7365 6c66  y and row > self
-000044e0: 2e70 7265 7669 6f75 735f 726f 773a 0a20  .previous_row:. 
-000044f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00004500: 5f77 7269 7465 5f73 696e 676c 655f 726f  _write_single_ro
-00004510: 7728 726f 7729 0a0a 2020 2020 2020 2020  w(row)..        
-00004520: 2320 5374 6f72 6520 7468 6520 6365 6c6c  # Store the cell
-00004530: 2064 6174 6120 696e 2074 6865 2077 6f72   data in the wor
-00004540: 6b73 6865 6574 2064 6174 6120 7461 626c  ksheet data tabl
-00004550: 652e 0a20 2020 2020 2020 2073 656c 662e  e..        self.
-00004560: 7461 626c 655b 726f 775d 5b63 6f6c 5d20  table[row][col] 
-00004570: 3d20 6365 6c6c 5f73 7472 696e 675f 7475  = cell_string_tu
-00004580: 706c 6528 7374 7269 6e67 5f69 6e64 6578  ple(string_index
-00004590: 2c20 6365 6c6c 5f66 6f72 6d61 7429 0a0a  , cell_format)..
-000045a0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000045b0: 7472 5f65 7272 6f72 0a0a 2020 2020 4063  tr_error..    @c
-000045c0: 6f6e 7665 7274 5f63 656c 6c5f 6172 6773  onvert_cell_args
-000045d0: 0a20 2020 2064 6566 2077 7269 7465 5f6e  .    def write_n
-000045e0: 756d 6265 7228 7365 6c66 2c20 726f 772c  umber(self, row,
-000045f0: 2063 6f6c 2c20 6e75 6d62 6572 2c20 6365   col, number, ce
-00004600: 6c6c 5f66 6f72 6d61 743d 4e6f 6e65 293a  ll_format=None):
-00004610: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00004620: 2020 2020 2057 7269 7465 2061 206e 756d       Write a num
-00004630: 6265 7220 746f 2061 2077 6f72 6b73 6865  ber to a workshe
-00004640: 6574 2063 656c 6c2e 0a0a 2020 2020 2020  et cell...      
-00004650: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
-00004660: 2020 2020 726f 773a 2020 2020 2020 2020      row:        
-00004670: 2054 6865 2063 656c 6c20 726f 7720 287a   The cell row (z
-00004680: 6572 6f20 696e 6465 7865 6429 2e0a 2020  ero indexed)..  
-00004690: 2020 2020 2020 2020 2020 636f 6c3a 2020            col:  
-000046a0: 2020 2020 2020 2054 6865 2063 656c 6c20         The cell 
-000046b0: 636f 6c75 6d6e 2028 7a65 726f 2069 6e64  column (zero ind
-000046c0: 6578 6564 292e 0a20 2020 2020 2020 2020  exed)..         
-000046d0: 2020 206e 756d 6265 723a 2020 2020 2020     number:      
-000046e0: 4365 6c6c 2064 6174 612e 2049 6e74 206f  Cell data. Int o
-000046f0: 7220 666c 6f61 742e 0a20 2020 2020 2020  r float..       
-00004700: 2020 2020 2063 656c 6c5f 666f 726d 6174       cell_format
-00004710: 3a20 416e 206f 7074 696f 6e61 6c20 6365  : An optional ce
-00004720: 6c6c 2046 6f72 6d61 7420 6f62 6a65 6374  ll Format object
-00004730: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-00004740: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
-00004750: 303a 2020 5375 6363 6573 732e 0a20 2020  0:  Success..   
-00004760: 2020 2020 2020 2020 202d 313a 2052 6f77           -1: Row
-00004770: 206f 7220 636f 6c75 6d6e 2069 7320 6f75   or column is ou
-00004780: 7420 6f66 2077 6f72 6b73 6865 6574 2062  t of worksheet b
-00004790: 6f75 6e64 732e 0a0a 2020 2020 2020 2020  ounds...        
-000047a0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-000047b0: 726e 2073 656c 662e 5f77 7269 7465 5f6e  rn self._write_n
-000047c0: 756d 6265 7228 726f 772c 2063 6f6c 2c20  umber(row, col, 
-000047d0: 6e75 6d62 6572 2c20 6365 6c6c 5f66 6f72  number, cell_for
-000047e0: 6d61 7429 0a0a 2020 2020 2320 556e 6465  mat)..    # Unde
-000047f0: 636f 7261 7465 6420 7665 7273 696f 6e20  corated version 
-00004800: 6f66 2077 7269 7465 5f6e 756d 6265 7228  of write_number(
-00004810: 292e 0a20 2020 2064 6566 205f 7772 6974  )..    def _writ
-00004820: 655f 6e75 6d62 6572 2873 656c 662c 2072  e_number(self, r
-00004830: 6f77 2c20 636f 6c2c 206e 756d 6265 722c  ow, col, number,
-00004840: 2063 656c 6c5f 666f 726d 6174 3d4e 6f6e   cell_format=Non
-00004850: 6529 3a0a 0a20 2020 2020 2020 2069 6620  e):..        if 
-00004860: 6973 6e61 6e28 6e75 6d62 6572 2920 6f72  isnan(number) or
-00004870: 2069 7369 6e66 286e 756d 6265 7229 3a0a   isinf(number):.
-00004880: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00004890: 656c 662e 6e61 6e5f 696e 665f 746f 5f65  elf.nan_inf_to_e
-000048a0: 7272 6f72 733a 0a20 2020 2020 2020 2020  rrors:.         
-000048b0: 2020 2020 2020 2069 6620 6973 6e61 6e28         if isnan(
-000048c0: 6e75 6d62 6572 293a 0a20 2020 2020 2020  number):.       
-000048d0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-000048e0: 7572 6e20 7365 6c66 2e5f 7772 6974 655f  urn self._write_
-000048f0: 666f 726d 756c 6128 726f 772c 2063 6f6c  formula(row, col
-00004900: 2c20 2723 4e55 4d21 272c 2063 656c 6c5f  , '#NUM!', cell_
-00004910: 666f 726d 6174 2c0a 2020 2020 2020 2020  format,.        
-00004920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004940: 2020 2020 2020 2027 234e 554d 2127 290a         '#NUM!').
-00004950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004960: 656c 6966 206e 756d 6265 7220 3d3d 206d  elif number == m
-00004970: 6174 682e 696e 663a 0a20 2020 2020 2020  ath.inf:.       
-00004980: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00004990: 7572 6e20 7365 6c66 2e5f 7772 6974 655f  urn self._write_
-000049a0: 666f 726d 756c 6128 726f 772c 2063 6f6c  formula(row, col
-000049b0: 2c20 2731 2f30 272c 2063 656c 6c5f 666f  , '1/0', cell_fo
-000049c0: 726d 6174 2c0a 2020 2020 2020 2020 2020  rmat,.          
-000049d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000049e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000049f0: 2020 2020 2027 2344 4956 2f30 2127 290a       '#DIV/0!').
-00004a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004a10: 656c 6966 206e 756d 6265 7220 3d3d 202d  elif number == -
-00004a20: 6d61 7468 2e69 6e66 3a0a 2020 2020 2020  math.inf:.      
-00004a30: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00004a40: 7475 726e 2073 656c 662e 5f77 7269 7465  turn self._write
-00004a50: 5f66 6f72 6d75 6c61 2872 6f77 2c20 636f  _formula(row, co
-00004a60: 6c2c 2027 2d31 2f30 272c 2063 656c 6c5f  l, '-1/0', cell_
-00004a70: 666f 726d 6174 2c0a 2020 2020 2020 2020  format,.        
-00004a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004aa0: 2020 2020 2020 2027 2344 4956 2f30 2127         '#DIV/0!'
-00004ab0: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-00004ac0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00004ad0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-00004ae0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00004af0: 2020 2020 2020 2020 2022 4e41 4e2f 494e           "NAN/IN
-00004b00: 4620 6e6f 7420 7375 7070 6f72 7465 6420  F not supported 
-00004b10: 696e 2077 7269 7465 5f6e 756d 6265 7228  in write_number(
-00004b20: 2920 220a 2020 2020 2020 2020 2020 2020  ) ".            
-00004b30: 2020 2020 2020 2020 2277 6974 686f 7574          "without
-00004b40: 2027 6e61 6e5f 696e 665f 746f 5f65 7272   'nan_inf_to_err
-00004b50: 6f72 7327 2057 6f72 6b62 6f6f 6b28 2920  ors' Workbook() 
-00004b60: 6f70 7469 6f6e 2229 0a0a 2020 2020 2020  option")..      
-00004b70: 2020 2320 4368 6563 6b20 7468 6174 2072    # Check that r
-00004b80: 6f77 2061 6e64 2063 6f6c 2061 7265 2076  ow and col are v
-00004b90: 616c 6964 2061 6e64 2073 746f 7265 206d  alid and store m
-00004ba0: 6178 2061 6e64 206d 696e 2076 616c 7565  ax and min value
-00004bb0: 732e 0a20 2020 2020 2020 2069 6620 7365  s..        if se
-00004bc0: 6c66 2e5f 6368 6563 6b5f 6469 6d65 6e73  lf._check_dimens
-00004bd0: 696f 6e73 2872 6f77 2c20 636f 6c29 3a0a  ions(row, col):.
-00004be0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00004bf0: 726e 202d 310a 0a20 2020 2020 2020 2023  rn -1..        #
-00004c00: 2057 7269 7465 2070 7265 7669 6f75 7320   Write previous 
-00004c10: 726f 7720 6966 2069 6e20 696e 2d6c 696e  row if in in-lin
-00004c20: 6520 7374 7269 6e67 2063 6f6e 7374 616e  e string constan
-00004c30: 745f 6d65 6d6f 7279 206d 6f64 652e 0a20  t_memory mode.. 
-00004c40: 2020 2020 2020 2069 6620 7365 6c66 2e63         if self.c
-00004c50: 6f6e 7374 616e 745f 6d65 6d6f 7279 2061  onstant_memory a
-00004c60: 6e64 2072 6f77 203e 2073 656c 662e 7072  nd row > self.pr
-00004c70: 6576 696f 7573 5f72 6f77 3a0a 2020 2020  evious_row:.    
-00004c80: 2020 2020 2020 2020 7365 6c66 2e5f 7772          self._wr
-00004c90: 6974 655f 7369 6e67 6c65 5f72 6f77 2872  ite_single_row(r
-00004ca0: 6f77 290a 0a20 2020 2020 2020 2023 2053  ow)..        # S
-00004cb0: 746f 7265 2074 6865 2063 656c 6c20 6461  tore the cell da
-00004cc0: 7461 2069 6e20 7468 6520 776f 726b 7368  ta in the worksh
-00004cd0: 6565 7420 6461 7461 2074 6162 6c65 2e0a  eet data table..
-00004ce0: 2020 2020 2020 2020 7365 6c66 2e74 6162          self.tab
-00004cf0: 6c65 5b72 6f77 5d5b 636f 6c5d 203d 2063  le[row][col] = c
-00004d00: 656c 6c5f 6e75 6d62 6572 5f74 7570 6c65  ell_number_tuple
-00004d10: 286e 756d 6265 722c 2063 656c 6c5f 666f  (number, cell_fo
-00004d20: 726d 6174 290a 0a20 2020 2020 2020 2072  rmat)..        r
-00004d30: 6574 7572 6e20 300a 0a20 2020 2040 636f  eturn 0..    @co
-00004d40: 6e76 6572 745f 6365 6c6c 5f61 7267 730a  nvert_cell_args.
-00004d50: 2020 2020 6465 6620 7772 6974 655f 626c      def write_bl
-00004d60: 616e 6b28 7365 6c66 2c20 726f 772c 2063  ank(self, row, c
-00004d70: 6f6c 2c20 626c 616e 6b2c 2063 656c 6c5f  ol, blank, cell_
-00004d80: 666f 726d 6174 3d4e 6f6e 6529 3a0a 2020  format=None):.  
-00004d90: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00004da0: 2020 5772 6974 6520 6120 626c 616e 6b20    Write a blank 
-00004db0: 6365 6c6c 2077 6974 6820 666f 726d 6174  cell with format
-00004dc0: 7469 6e67 2074 6f20 6120 776f 726b 7368  ting to a worksh
-00004dd0: 6565 7420 6365 6c6c 2e20 5468 6520 626c  eet cell. The bl
-00004de0: 616e 6b0a 2020 2020 2020 2020 746f 6b65  ank.        toke
-00004df0: 6e20 6973 2069 676e 6f72 6564 2061 6e64  n is ignored and
-00004e00: 2074 6865 2066 6f72 6d61 7420 6f6e 6c79   the format only
-00004e10: 2069 7320 7772 6974 7465 6e20 746f 2074   is written to t
-00004e20: 6865 2063 656c 6c2e 0a0a 2020 2020 2020  he cell...      
-00004e30: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
-00004e40: 2020 2020 726f 773a 2020 2020 2020 2020      row:        
-00004e50: 2054 6865 2063 656c 6c20 726f 7720 287a   The cell row (z
-00004e60: 6572 6f20 696e 6465 7865 6429 2e0a 2020  ero indexed)..  
-00004e70: 2020 2020 2020 2020 2020 636f 6c3a 2020            col:  
-00004e80: 2020 2020 2020 2054 6865 2063 656c 6c20         The cell 
-00004e90: 636f 6c75 6d6e 2028 7a65 726f 2069 6e64  column (zero ind
-00004ea0: 6578 6564 292e 0a20 2020 2020 2020 2020  exed)..         
-00004eb0: 2020 2062 6c61 6e6b 3a20 2020 2020 2020     blank:       
-00004ec0: 416e 7920 7661 6c75 652e 2049 7420 6973  Any value. It is
-00004ed0: 2069 676e 6f72 6564 2e0a 2020 2020 2020   ignored..      
-00004ee0: 2020 2020 2020 6365 6c6c 5f66 6f72 6d61        cell_forma
-00004ef0: 743a 2041 6e20 6f70 7469 6f6e 616c 2063  t: An optional c
-00004f00: 656c 6c20 466f 726d 6174 206f 626a 6563  ell Format objec
-00004f10: 742e 0a0a 2020 2020 2020 2020 5265 7475  t...        Retu
-00004f20: 726e 733a 0a20 2020 2020 2020 2020 2020  rns:.           
-00004f30: 2030 3a20 2053 7563 6365 7373 2e0a 2020   0:  Success..  
-00004f40: 2020 2020 2020 2020 2020 2d31 3a20 526f            -1: Ro
-00004f50: 7720 6f72 2063 6f6c 756d 6e20 6973 206f  w or column is o
-00004f60: 7574 206f 6620 776f 726b 7368 6565 7420  ut of worksheet 
-00004f70: 626f 756e 6473 2e0a 0a20 2020 2020 2020  bounds...       
-00004f80: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-00004f90: 7572 6e20 7365 6c66 2e5f 7772 6974 655f  urn self._write_
-00004fa0: 626c 616e 6b28 726f 772c 2063 6f6c 2c20  blank(row, col, 
-00004fb0: 626c 616e 6b2c 2063 656c 6c5f 666f 726d  blank, cell_form
-00004fc0: 6174 290a 0a20 2020 2023 2055 6e64 6563  at)..    # Undec
-00004fd0: 6f72 6174 6564 2076 6572 7369 6f6e 206f  orated version o
-00004fe0: 6620 7772 6974 655f 626c 616e 6b28 292e  f write_blank().
-00004ff0: 0a20 2020 2064 6566 205f 7772 6974 655f  .    def _write_
-00005000: 626c 616e 6b28 7365 6c66 2c20 726f 772c  blank(self, row,
-00005010: 2063 6f6c 2c20 626c 616e 6b2c 2063 656c   col, blank, cel
-00005020: 6c5f 666f 726d 6174 3d4e 6f6e 6529 3a0a  l_format=None):.
-00005030: 2020 2020 2020 2020 2320 446f 6e27 7420          # Don't 
-00005040: 7772 6974 6520 6120 626c 616e 6b20 6365  write a blank ce
-00005050: 6c6c 2075 6e6c 6573 7320 6974 2068 6173  ll unless it has
-00005060: 2061 2066 6f72 6d61 742e 0a20 2020 2020   a format..     
-00005070: 2020 2069 6620 6365 6c6c 5f66 6f72 6d61     if cell_forma
-00005080: 7420 6973 204e 6f6e 653a 0a20 2020 2020  t is None:.     
-00005090: 2020 2020 2020 2072 6574 7572 6e20 300a         return 0.
-000050a0: 0a20 2020 2020 2020 2023 2043 6865 636b  .        # Check
-000050b0: 2074 6861 7420 726f 7720 616e 6420 636f   that row and co
-000050c0: 6c20 6172 6520 7661 6c69 6420 616e 6420  l are valid and 
-000050d0: 7374 6f72 6520 6d61 7820 616e 6420 6d69  store max and mi
-000050e0: 6e20 7661 6c75 6573 2e0a 2020 2020 2020  n values..      
-000050f0: 2020 6966 2073 656c 662e 5f63 6865 636b    if self._check
-00005100: 5f64 696d 656e 7369 6f6e 7328 726f 772c  _dimensions(row,
-00005110: 2063 6f6c 293a 0a20 2020 2020 2020 2020   col):.         
-00005120: 2020 2072 6574 7572 6e20 2d31 0a0a 2020     return -1..  
-00005130: 2020 2020 2020 2320 5772 6974 6520 7072        # Write pr
-00005140: 6576 696f 7573 2072 6f77 2069 6620 696e  evious row if in
-00005150: 2069 6e2d 6c69 6e65 2073 7472 696e 6720   in-line string 
-00005160: 636f 6e73 7461 6e74 5f6d 656d 6f72 7920  constant_memory 
-00005170: 6d6f 6465 2e0a 2020 2020 2020 2020 6966  mode..        if
-00005180: 2073 656c 662e 636f 6e73 7461 6e74 5f6d   self.constant_m
-00005190: 656d 6f72 7920 616e 6420 726f 7720 3e20  emory and row > 
-000051a0: 7365 6c66 2e70 7265 7669 6f75 735f 726f  self.previous_ro
-000051b0: 773a 0a20 2020 2020 2020 2020 2020 2073  w:.            s
-000051c0: 656c 662e 5f77 7269 7465 5f73 696e 676c  elf._write_singl
-000051d0: 655f 726f 7728 726f 7729 0a0a 2020 2020  e_row(row)..    
-000051e0: 2020 2020 2320 5374 6f72 6520 7468 6520      # Store the 
-000051f0: 6365 6c6c 2064 6174 6120 696e 2074 6865  cell data in the
-00005200: 2077 6f72 6b73 6865 6574 2064 6174 6120   worksheet data 
-00005210: 7461 626c 652e 0a20 2020 2020 2020 2073  table..        s
-00005220: 656c 662e 7461 626c 655b 726f 775d 5b63  elf.table[row][c
-00005230: 6f6c 5d20 3d20 6365 6c6c 5f62 6c61 6e6b  ol] = cell_blank
-00005240: 5f74 7570 6c65 2863 656c 6c5f 666f 726d  _tuple(cell_form
-00005250: 6174 290a 0a20 2020 2020 2020 2072 6574  at)..        ret
-00005260: 7572 6e20 300a 0a20 2020 2040 636f 6e76  urn 0..    @conv
-00005270: 6572 745f 6365 6c6c 5f61 7267 730a 2020  ert_cell_args.  
-00005280: 2020 6465 6620 7772 6974 655f 666f 726d    def write_form
-00005290: 756c 6128 7365 6c66 2c20 726f 772c 2063  ula(self, row, c
-000052a0: 6f6c 2c20 666f 726d 756c 612c 2063 656c  ol, formula, cel
-000052b0: 6c5f 666f 726d 6174 3d4e 6f6e 652c 2076  l_format=None, v
-000052c0: 616c 7565 3d30 293a 0a20 2020 2020 2020  alue=0):.       
-000052d0: 2022 2222 0a20 2020 2020 2020 2057 7269   """.        Wri
-000052e0: 7465 2061 2066 6f72 6d75 6c61 2074 6f20  te a formula to 
-000052f0: 6120 776f 726b 7368 6565 7420 6365 6c6c  a worksheet cell
-00005300: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
-00005310: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
-00005320: 3a20 2020 2020 2020 2020 5468 6520 6365  :         The ce
-00005330: 6c6c 2072 6f77 2028 7a65 726f 2069 6e64  ll row (zero ind
-00005340: 6578 6564 292e 0a20 2020 2020 2020 2020  exed)..         
-00005350: 2020 2063 6f6c 3a20 2020 2020 2020 2020     col:         
-00005360: 5468 6520 6365 6c6c 2063 6f6c 756d 6e20  The cell column 
-00005370: 287a 6572 6f20 696e 6465 7865 6429 2e0a  (zero indexed)..
-00005380: 2020 2020 2020 2020 2020 2020 666f 726d              form
-00005390: 756c 613a 2020 2020 2043 656c 6c20 666f  ula:     Cell fo
-000053a0: 726d 756c 612e 0a20 2020 2020 2020 2020  rmula..         
-000053b0: 2020 2063 656c 6c5f 666f 726d 6174 3a20     cell_format: 
-000053c0: 416e 206f 7074 696f 6e61 6c20 6365 6c6c  An optional cell
-000053d0: 2046 6f72 6d61 7420 6f62 6a65 6374 2e0a   Format object..
-000053e0: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
-000053f0: 653a 2020 2020 2020 2041 6e20 6f70 7469  e:       An opti
-00005400: 6f6e 616c 2076 616c 7565 2066 6f72 2074  onal value for t
-00005410: 6865 2066 6f72 6d75 6c61 2e20 4465 6661  he formula. Defa
-00005420: 756c 7420 6973 2030 2e0a 0a20 2020 2020  ult is 0...     
-00005430: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
-00005440: 2020 2020 2020 2020 303a 2020 5375 6363          0:  Succ
-00005450: 6573 732e 0a20 2020 2020 2020 2020 2020  ess..           
-00005460: 202d 313a 2052 6f77 206f 7220 636f 6c75   -1: Row or colu
-00005470: 6d6e 2069 7320 6f75 7420 6f66 2077 6f72  mn is out of wor
-00005480: 6b73 6865 6574 2062 6f75 6e64 732e 0a20  ksheet bounds.. 
-00005490: 2020 2020 2020 2020 2020 202d 323a 2046             -2: F
-000054a0: 6f72 6d75 6c61 2063 616e 2774 2062 6520  ormula can't be 
-000054b0: 4e6f 6e65 206f 7220 656d 7074 792e 0a0a  None or empty...
-000054c0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000054d0: 2020 2020 2320 4368 6563 6b20 7468 6174      # Check that
-000054e0: 2072 6f77 2061 6e64 2063 6f6c 2061 7265   row and col are
-000054f0: 2076 616c 6964 2061 6e64 2073 746f 7265   valid and store
-00005500: 206d 6178 2061 6e64 206d 696e 2076 616c   max and min val
-00005510: 7565 732e 0a20 2020 2020 2020 2072 6574  ues..        ret
-00005520: 7572 6e20 7365 6c66 2e5f 7772 6974 655f  urn self._write_
-00005530: 666f 726d 756c 6128 726f 772c 2063 6f6c  formula(row, col
-00005540: 2c20 666f 726d 756c 612c 2063 656c 6c5f  , formula, cell_
-00005550: 666f 726d 6174 2c20 7661 6c75 6529 0a0a  format, value)..
-00005560: 2020 2020 2320 556e 6465 636f 7261 7465      # Undecorate
-00005570: 6420 7665 7273 696f 6e20 6f66 2077 7269  d version of wri
-00005580: 7465 5f66 6f72 6d75 6c61 2829 2e0a 2020  te_formula()..  
-00005590: 2020 6465 6620 5f77 7269 7465 5f66 6f72    def _write_for
-000055a0: 6d75 6c61 2873 656c 662c 2072 6f77 2c20  mula(self, row, 
-000055b0: 636f 6c2c 2066 6f72 6d75 6c61 2c20 6365  col, formula, ce
-000055c0: 6c6c 5f66 6f72 6d61 743d 4e6f 6e65 2c20  ll_format=None, 
-000055d0: 7661 6c75 653d 3029 3a0a 2020 2020 2020  value=0):.      
-000055e0: 2020 6966 2073 656c 662e 5f63 6865 636b    if self._check
-000055f0: 5f64 696d 656e 7369 6f6e 7328 726f 772c  _dimensions(row,
-00005600: 2063 6f6c 293a 0a20 2020 2020 2020 2020   col):.         
-00005610: 2020 2072 6574 7572 6e20 2d31 0a0a 2020     return -1..  
-00005620: 2020 2020 2020 6966 2066 6f72 6d75 6c61        if formula
-00005630: 2069 7320 4e6f 6e65 206f 7220 666f 726d   is None or form
-00005640: 756c 6120 3d3d 2027 273a 0a20 2020 2020  ula == '':.     
-00005650: 2020 2020 2020 2077 6172 6e28 2246 6f72         warn("For
-00005660: 6d75 6c61 2063 616e 2774 2062 6520 4e6f  mula can't be No
-00005670: 6e65 206f 7220 656d 7074 7922 290a 2020  ne or empty").  
-00005680: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00005690: 202d 310a 0a20 2020 2020 2020 2023 2043   -1..        # C
-000056a0: 6865 636b 2066 6f72 2064 796e 616d 6963  heck for dynamic
-000056b0: 2061 7272 6179 2066 756e 6374 696f 6e73   array functions
-000056c0: 2e0a 2020 2020 2020 2020 6966 2028 7265  ..        if (re
-000056d0: 5f64 796e 616d 6963 5f66 756e 6374 696f  _dynamic_functio
-000056e0: 6e2e 7365 6172 6368 2866 6f72 6d75 6c61  n.search(formula
-000056f0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-00005700: 7265 7475 726e 2073 656c 662e 7772 6974  return self.writ
-00005710: 655f 6479 6e61 6d69 635f 6172 7261 795f  e_dynamic_array_
-00005720: 666f 726d 756c 6128 726f 772c 2063 6f6c  formula(row, col
-00005730: 2c20 726f 772c 2063 6f6c 2c0a 2020 2020  , row, col,.    
-00005740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005770: 666f 726d 756c 612c 2063 656c 6c5f 666f  formula, cell_fo
-00005780: 726d 6174 2c0a 2020 2020 2020 2020 2020  rmat,.          
-00005790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000057a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000057b0: 2020 2020 2020 2020 2020 7661 6c75 6529            value)
-000057c0: 0a0a 2020 2020 2020 2020 2320 4861 6e64  ..        # Hand
-000057d0: 206f 6666 2061 7272 6179 2066 6f72 6d75   off array formu
-000057e0: 6c61 732e 0a20 2020 2020 2020 2069 6620  las..        if 
-000057f0: 666f 726d 756c 612e 7374 6172 7473 7769  formula.startswi
-00005800: 7468 2827 7b27 2920 616e 6420 666f 726d  th('{') and form
-00005810: 756c 612e 656e 6473 7769 7468 2827 7d27  ula.endswith('}'
-00005820: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00005830: 6574 7572 6e20 7365 6c66 2e5f 7772 6974  eturn self._writ
-00005840: 655f 6172 7261 795f 666f 726d 756c 6128  e_array_formula(
-00005850: 726f 772c 2063 6f6c 2c20 726f 772c 2063  row, col, row, c
-00005860: 6f6c 2c20 666f 726d 756c 612c 0a20 2020  ol, formula,.   
-00005870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005890: 2020 2020 2020 2020 2020 6365 6c6c 5f66            cell_f
-000058a0: 6f72 6d61 742c 2076 616c 7565 290a 0a20  ormat, value).. 
-000058b0: 2020 2020 2020 2023 204d 6f64 6966 7920         # Modify 
-000058c0: 7468 6520 666f 726d 756c 6120 7374 7269  the formula stri
-000058d0: 6e67 2c20 6173 206e 6565 6465 642e 0a20  ng, as needed.. 
-000058e0: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
-000058f0: 2073 656c 662e 5f70 7265 7061 7265 5f66   self._prepare_f
-00005900: 6f72 6d75 6c61 2866 6f72 6d75 6c61 290a  ormula(formula).
-00005910: 0a20 2020 2020 2020 2023 2057 7269 7465  .        # Write
-00005920: 2070 7265 7669 6f75 7320 726f 7720 6966   previous row if
-00005930: 2069 6e20 696e 2d6c 696e 6520 7374 7269   in in-line stri
-00005940: 6e67 2063 6f6e 7374 616e 745f 6d65 6d6f  ng constant_memo
-00005950: 7279 206d 6f64 652e 0a20 2020 2020 2020  ry mode..       
-00005960: 2069 6620 7365 6c66 2e63 6f6e 7374 616e   if self.constan
-00005970: 745f 6d65 6d6f 7279 2061 6e64 2072 6f77  t_memory and row
-00005980: 203e 2073 656c 662e 7072 6576 696f 7573   > self.previous
-00005990: 5f72 6f77 3a0a 2020 2020 2020 2020 2020  _row:.          
-000059a0: 2020 7365 6c66 2e5f 7772 6974 655f 7369    self._write_si
-000059b0: 6e67 6c65 5f72 6f77 2872 6f77 290a 0a20  ngle_row(row).. 
-000059c0: 2020 2020 2020 2023 2053 746f 7265 2074         # Store t
-000059d0: 6865 2063 656c 6c20 6461 7461 2069 6e20  he cell data in 
-000059e0: 7468 6520 776f 726b 7368 6565 7420 6461  the worksheet da
-000059f0: 7461 2074 6162 6c65 2e0a 2020 2020 2020  ta table..      
-00005a00: 2020 7365 6c66 2e74 6162 6c65 5b72 6f77    self.table[row
-00005a10: 5d5b 636f 6c5d 203d 2063 656c 6c5f 666f  ][col] = cell_fo
-00005a20: 726d 756c 615f 7475 706c 6528 666f 726d  rmula_tuple(form
-00005a30: 756c 612c 2063 656c 6c5f 666f 726d 6174  ula, cell_format
-00005a40: 2c20 7661 6c75 6529 0a0a 2020 2020 2020  , value)..      
-00005a50: 2020 7265 7475 726e 2030 0a0a 2020 2020    return 0..    
-00005a60: 4063 6f6e 7665 7274 5f72 616e 6765 5f61  @convert_range_a
-00005a70: 7267 730a 2020 2020 6465 6620 7772 6974  rgs.    def writ
-00005a80: 655f 6172 7261 795f 666f 726d 756c 6128  e_array_formula(
-00005a90: 7365 6c66 2c20 6669 7273 745f 726f 772c  self, first_row,
-00005aa0: 2066 6972 7374 5f63 6f6c 2c20 6c61 7374   first_col, last
-00005ab0: 5f72 6f77 2c20 6c61 7374 5f63 6f6c 2c0a  _row, last_col,.
-00005ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005ad0: 2020 2020 2020 2020 2020 2020 666f 726d              form
-00005ae0: 756c 612c 2063 656c 6c5f 666f 726d 6174  ula, cell_format
-00005af0: 3d4e 6f6e 652c 2076 616c 7565 3d30 293a  =None, value=0):
-00005b00: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00005b10: 2020 2020 2057 7269 7465 2061 2066 6f72       Write a for
-00005b20: 6d75 6c61 2074 6f20 6120 776f 726b 7368  mula to a worksh
-00005b30: 6565 7420 6365 6c6c 2f72 616e 6765 2e0a  eet cell/range..
-00005b40: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
-00005b50: 2020 2020 2020 2020 2020 2066 6972 7374             first
-00005b60: 5f72 6f77 3a20 2020 2054 6865 2066 6972  _row:    The fir
-00005b70: 7374 2072 6f77 206f 6620 7468 6520 6365  st row of the ce
-00005b80: 6c6c 2072 616e 6765 2e20 287a 6572 6f20  ll range. (zero 
-00005b90: 696e 6465 7865 6429 2e0a 2020 2020 2020  indexed)..      
-00005ba0: 2020 2020 2020 6669 7273 745f 636f 6c3a        first_col:
-00005bb0: 2020 2020 5468 6520 6669 7273 7420 636f      The first co
-00005bc0: 6c75 6d6e 206f 6620 7468 6520 6365 6c6c  lumn of the cell
-00005bd0: 2072 616e 6765 2e0a 2020 2020 2020 2020   range..        
-00005be0: 2020 2020 6c61 7374 5f72 6f77 3a20 2020      last_row:   
-00005bf0: 2020 5468 6520 6c61 7374 2072 6f77 206f    The last row o
-00005c00: 6620 7468 6520 6365 6c6c 2072 616e 6765  f the cell range
-00005c10: 2e20 287a 6572 6f20 696e 6465 7865 6429  . (zero indexed)
-00005c20: 2e0a 2020 2020 2020 2020 2020 2020 6c61  ..            la
-00005c30: 7374 5f63 6f6c 3a20 2020 2020 5468 6520  st_col:     The 
-00005c40: 6c61 7374 2063 6f6c 756d 6e20 6f66 2074  last column of t
-00005c50: 6865 2063 656c 6c20 7261 6e67 652e 0a20  he cell range.. 
-00005c60: 2020 2020 2020 2020 2020 2066 6f72 6d75             formu
-00005c70: 6c61 3a20 2020 2020 2043 656c 6c20 666f  la:      Cell fo
-00005c80: 726d 756c 612e 0a20 2020 2020 2020 2020  rmula..         
-00005c90: 2020 2063 656c 6c5f 666f 726d 6174 3a20     cell_format: 
-00005ca0: 2041 6e20 6f70 7469 6f6e 616c 2063 656c   An optional cel
-00005cb0: 6c20 466f 726d 6174 206f 626a 6563 742e  l Format object.
-00005cc0: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
-00005cd0: 7565 3a20 2020 2020 2020 2041 6e20 6f70  ue:        An op
-00005ce0: 7469 6f6e 616c 2076 616c 7565 2066 6f72  tional value for
-00005cf0: 2074 6865 2066 6f72 6d75 6c61 2e20 4465   the formula. De
-00005d00: 6661 756c 7420 6973 2030 2e0a 0a20 2020  fault is 0...   
-00005d10: 2020 2020 2052 6574 7572 6e73 3a0a 2020       Returns:.  
-00005d20: 2020 2020 2020 2020 2020 303a 2020 5375            0:  Su
-00005d30: 6363 6573 732e 0a20 2020 2020 2020 2020  ccess..         
-00005d40: 2020 202d 313a 2052 6f77 206f 7220 636f     -1: Row or co
-00005d50: 6c75 6d6e 2069 7320 6f75 7420 6f66 2077  lumn is out of w
-00005d60: 6f72 6b73 6865 6574 2062 6f75 6e64 732e  orksheet bounds.
-00005d70: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00005d80: 2020 2020 2020 2320 4368 6563 6b20 666f        # Check fo
-00005d90: 7220 6479 6e61 6d69 6320 6172 7261 7920  r dynamic array 
-00005da0: 6675 6e63 7469 6f6e 732e 0a20 2020 2020  functions..     
-00005db0: 2020 2069 6620 2872 655f 6479 6e61 6d69     if (re_dynami
-00005dc0: 635f 6675 6e63 7469 6f6e 2e73 6561 7263  c_function.searc
-00005dd0: 6828 666f 726d 756c 6129 293a 0a20 2020  h(formula)):.   
-00005de0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00005df0: 7365 6c66 2e77 7269 7465 5f64 796e 616d  self.write_dynam
-00005e00: 6963 5f61 7272 6179 5f66 6f72 6d75 6c61  ic_array_formula
-00005e10: 2866 6972 7374 5f72 6f77 2c20 6669 7273  (first_row, firs
-00005e20: 745f 636f 6c2c 0a20 2020 2020 2020 2020  t_col,.         
-00005e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005e50: 2020 2020 2020 2020 2020 206c 6173 745f             last_
-00005e60: 726f 772c 206c 6173 745f 636f 6c2c 0a20  row, last_col,. 
-00005e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005ea0: 2020 2066 6f72 6d75 6c61 2c20 6365 6c6c     formula, cell
-00005eb0: 5f66 6f72 6d61 742c 0a20 2020 2020 2020  _format,.       
-00005ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005ee0: 2020 2020 2020 2020 2020 2020 2076 616c               val
-00005ef0: 7565 290a 0a20 2020 2020 2020 2072 6574  ue)..        ret
-00005f00: 7572 6e20 7365 6c66 2e5f 7772 6974 655f  urn self._write_
-00005f10: 6172 7261 795f 666f 726d 756c 6128 6669  array_formula(fi
-00005f20: 7273 745f 726f 772c 2066 6972 7374 5f63  rst_row, first_c
-00005f30: 6f6c 2c20 6c61 7374 5f72 6f77 2c0a 2020  ol, last_row,.  
-00005f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005f60: 2020 2020 2020 206c 6173 745f 636f 6c2c         last_col,
-00005f70: 2066 6f72 6d75 6c61 2c20 6365 6c6c 5f66   formula, cell_f
-00005f80: 6f72 6d61 742c 0a20 2020 2020 2020 2020  ormat,.         
-00005f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005fb0: 7661 6c75 652c 2027 7374 6174 6963 2729  value, 'static')
-00005fc0: 0a0a 2020 2020 4063 6f6e 7665 7274 5f72  ..    @convert_r
-00005fd0: 616e 6765 5f61 7267 730a 2020 2020 6465  ange_args.    de
-00005fe0: 6620 7772 6974 655f 6479 6e61 6d69 635f  f write_dynamic_
-00005ff0: 6172 7261 795f 666f 726d 756c 6128 7365  array_formula(se
-00006000: 6c66 2c20 6669 7273 745f 726f 772c 2066  lf, first_row, f
-00006010: 6972 7374 5f63 6f6c 2c0a 2020 2020 2020  irst_col,.      
-00006020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006030: 2020 2020 2020 2020 2020 2020 2020 6c61                la
-00006040: 7374 5f72 6f77 2c20 6c61 7374 5f63 6f6c  st_row, last_col
-00006050: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00006060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006070: 2020 2020 2020 666f 726d 756c 612c 2063        formula, c
-00006080: 656c 6c5f 666f 726d 6174 3d4e 6f6e 652c  ell_format=None,
-00006090: 2076 616c 7565 3d30 293a 0a20 2020 2020   value=0):.     
-000060a0: 2020 2022 2222 0a20 2020 2020 2020 2057     """.        W
-000060b0: 7269 7465 2061 2064 796e 616d 6963 2061  rite a dynamic a
-000060c0: 7272 6179 2066 6f72 6d75 6c61 2074 6f20  rray formula to 
-000060d0: 6120 776f 726b 7368 6565 7420 6365 6c6c  a worksheet cell
-000060e0: 2f72 616e 6765 2e0a 0a20 2020 2020 2020  /range...       
-000060f0: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
-00006100: 2020 2066 6972 7374 5f72 6f77 3a20 2020     first_row:   
-00006110: 2054 6865 2066 6972 7374 2072 6f77 206f   The first row o
-00006120: 6620 7468 6520 6365 6c6c 2072 616e 6765  f the cell range
-00006130: 2e20 287a 6572 6f20 696e 6465 7865 6429  . (zero indexed)
-00006140: 2e0a 2020 2020 2020 2020 2020 2020 6669  ..            fi
-00006150: 7273 745f 636f 6c3a 2020 2020 5468 6520  rst_col:    The 
-00006160: 6669 7273 7420 636f 6c75 6d6e 206f 6620  first column of 
-00006170: 7468 6520 6365 6c6c 2072 616e 6765 2e0a  the cell range..
-00006180: 2020 2020 2020 2020 2020 2020 6c61 7374              last
-00006190: 5f72 6f77 3a20 2020 2020 5468 6520 6c61  _row:     The la
-000061a0: 7374 2072 6f77 206f 6620 7468 6520 6365  st row of the ce
-000061b0: 6c6c 2072 616e 6765 2e20 287a 6572 6f20  ll range. (zero 
-000061c0: 696e 6465 7865 6429 2e0a 2020 2020 2020  indexed)..      
-000061d0: 2020 2020 2020 6c61 7374 5f63 6f6c 3a20        last_col: 
-000061e0: 2020 2020 5468 6520 6c61 7374 2063 6f6c      The last col
-000061f0: 756d 6e20 6f66 2074 6865 2063 656c 6c20  umn of the cell 
-00006200: 7261 6e67 652e 0a20 2020 2020 2020 2020  range..         
-00006210: 2020 2066 6f72 6d75 6c61 3a20 2020 2020     formula:     
-00006220: 2043 656c 6c20 666f 726d 756c 612e 0a20   Cell formula.. 
-00006230: 2020 2020 2020 2020 2020 2063 656c 6c5f             cell_
-00006240: 666f 726d 6174 3a20 2041 6e20 6f70 7469  format:  An opti
-00006250: 6f6e 616c 2063 656c 6c20 466f 726d 6174  onal cell Format
-00006260: 206f 626a 6563 742e 0a20 2020 2020 2020   object..       
-00006270: 2020 2020 2076 616c 7565 3a20 2020 2020       value:     
-00006280: 2020 2041 6e20 6f70 7469 6f6e 616c 2076     An optional v
-00006290: 616c 7565 2066 6f72 2074 6865 2066 6f72  alue for the for
-000062a0: 6d75 6c61 2e20 4465 6661 756c 7420 6973  mula. Default is
-000062b0: 2030 2e0a 0a20 2020 2020 2020 2052 6574   0...        Ret
-000062c0: 7572 6e73 3a0a 2020 2020 2020 2020 2020  urns:.          
-000062d0: 2020 303a 2020 5375 6363 6573 732e 0a20    0:  Success.. 
-000062e0: 2020 2020 2020 2020 2020 202d 313a 2052             -1: R
-000062f0: 6f77 206f 7220 636f 6c75 6d6e 2069 7320  ow or column is 
-00006300: 6f75 7420 6f66 2077 6f72 6b73 6865 6574  out of worksheet
-00006310: 2062 6f75 6e64 732e 0a0a 2020 2020 2020   bounds...      
-00006320: 2020 2222 220a 2020 2020 2020 2020 6572    """.        er
-00006330: 726f 7220 3d20 7365 6c66 2e5f 7772 6974  ror = self._writ
-00006340: 655f 6172 7261 795f 666f 726d 756c 6128  e_array_formula(
-00006350: 6669 7273 745f 726f 772c 2066 6972 7374  first_row, first
-00006360: 5f63 6f6c 2c20 6c61 7374 5f72 6f77 2c0a  _col, last_row,.
-00006370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006390: 2020 2020 2020 2020 2020 6c61 7374 5f63            last_c
-000063a0: 6f6c 2c20 666f 726d 756c 612c 2063 656c  ol, formula, cel
-000063b0: 6c5f 666f 726d 6174 2c0a 2020 2020 2020  l_format,.      
-000063c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000063d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000063e0: 2020 2020 7661 6c75 652c 2027 6479 6e61      value, 'dyna
-000063f0: 6d69 6327 290a 0a20 2020 2020 2020 2069  mic')..        i
-00006400: 6620 6572 726f 7220 3d3d 2030 3a0a 2020  f error == 0:.  
-00006410: 2020 2020 2020 2020 2020 7365 6c66 2e68            self.h
-00006420: 6173 5f64 796e 616d 6963 5f61 7272 6179  as_dynamic_array
-00006430: 7320 3d20 5472 7565 0a0a 2020 2020 2020  s = True..      
-00006440: 2020 7265 7475 726e 2065 7272 6f72 0a0a    return error..
-00006450: 2020 2020 2320 5574 696c 6974 7920 6d65      # Utility me
-00006460: 7468 6f64 2074 6f20 7374 7269 7020 6571  thod to strip eq
-00006470: 7561 6c20 7369 676e 2061 6e64 2061 7272  ual sign and arr
-00006480: 6179 2062 7261 6365 7320 6672 6f6d 2061  ay braces from a
-00006490: 2066 6f72 6d75 6c61 2061 6e64 0a20 2020   formula and.   
-000064a0: 2023 2061 6c73 6f20 6578 7061 6e64 206f   # also expand o
-000064b0: 7574 2066 7574 7572 6520 616e 6420 6479  ut future and dy
-000064c0: 6e61 6d69 6320 6172 7261 7920 666f 726d  namic array form
-000064d0: 756c 6173 2e0a 2020 2020 6465 6620 5f70  ulas..    def _p
-000064e0: 7265 7061 7265 5f66 6f72 6d75 6c61 2873  repare_formula(s
-000064f0: 656c 662c 2066 6f72 6d75 6c61 293a 0a0a  elf, formula):..
-00006500: 2020 2020 2020 2020 2320 5265 6d6f 7665          # Remove
-00006510: 2061 7272 6179 2066 6f72 6d75 6c61 2062   array formula b
-00006520: 7261 6365 7320 616e 6420 7468 6520 6c65  races and the le
-00006530: 6164 696e 6720 3d2e 0a20 2020 2020 2020  ading =..       
-00006540: 2069 6620 666f 726d 756c 612e 7374 6172   if formula.star
-00006550: 7473 7769 7468 2827 7b27 293a 0a20 2020  tswith('{'):.   
-00006560: 2020 2020 2020 2020 2066 6f72 6d75 6c61           formula
-00006570: 203d 2066 6f72 6d75 6c61 5b31 3a5d 0a20   = formula[1:]. 
-00006580: 2020 2020 2020 2069 6620 666f 726d 756c         if formul
-00006590: 612e 7374 6172 7473 7769 7468 2827 3d27  a.startswith('='
-000065a0: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
-000065b0: 6f72 6d75 6c61 203d 2066 6f72 6d75 6c61  ormula = formula
-000065c0: 5b31 3a5d 0a20 2020 2020 2020 2069 6620  [1:].        if 
-000065d0: 666f 726d 756c 612e 656e 6473 7769 7468  formula.endswith
-000065e0: 2827 7d27 293a 0a20 2020 2020 2020 2020  ('}'):.         
-000065f0: 2020 2066 6f72 6d75 6c61 203d 2066 6f72     formula = for
-00006600: 6d75 6c61 5b3a 2d31 5d0a 0a20 2020 2020  mula[:-1]..     
-00006610: 2020 2023 2043 6865 636b 2069 6620 666f     # Check if fo
-00006620: 726d 756c 6120 6973 2061 6c72 6561 6479  rmula is already
-00006630: 2065 7870 616e 6465 6420 6279 2074 6865   expanded by the
-00006640: 2075 7365 722e 0a20 2020 2020 2020 2069   user..        i
-00006650: 6620 275f 786c 666e 2e27 2069 6e20 666f  f '_xlfn.' in fo
-00006660: 726d 756c 613a 0a20 2020 2020 2020 2020  rmula:.         
-00006670: 2020 2072 6574 7572 6e20 666f 726d 756c     return formul
-00006680: 610a 0a20 2020 2020 2020 2023 2045 7870  a..        # Exp
-00006690: 616e 6420 6479 6e61 6d69 6320 666f 726d  and dynamic form
-000066a0: 756c 6173 2e0a 2020 2020 2020 2020 666f  ulas..        fo
-000066b0: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
-000066c0: 275c 624c 4554 5c28 272c 2027 5f78 6c66  '\bLET\(', '_xlf
-000066d0: 6e2e 4c45 5428 272c 2066 6f72 6d75 6c61  n.LET(', formula
-000066e0: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
-000066f0: 6120 3d20 7265 2e73 7562 2872 275c 624c  a = re.sub(r'\bL
-00006700: 414d 4244 415c 2827 2c20 275f 786c 666e  AMBDA\(', '_xlfn
-00006710: 2e4c 414d 4244 4128 272c 2066 6f72 6d75  .LAMBDA(', formu
-00006720: 6c61 290a 2020 2020 2020 2020 666f 726d  la).        form
-00006730: 756c 6120 3d20 7265 2e73 7562 2872 275c  ula = re.sub(r'\
-00006740: 6253 494e 474c 455c 2827 2c20 275f 786c  bSINGLE\(', '_xl
-00006750: 666e 2e53 494e 474c 4528 272c 2066 6f72  fn.SINGLE(', for
-00006760: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
-00006770: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
-00006780: 275c 6253 4f52 5442 595c 2827 2c20 275f  '\bSORTBY\(', '_
-00006790: 786c 666e 2e53 4f52 5442 5928 272c 2066  xlfn.SORTBY(', f
-000067a0: 6f72 6d75 6c61 290a 2020 2020 2020 2020  ormula).        
-000067b0: 666f 726d 756c 6120 3d20 7265 2e73 7562  formula = re.sub
-000067c0: 2872 275c 6255 4e49 5155 455c 2827 2c20  (r'\bUNIQUE\(', 
-000067d0: 275f 786c 666e 2e55 4e49 5155 4528 272c  '_xlfn.UNIQUE(',
-000067e0: 2066 6f72 6d75 6c61 290a 2020 2020 2020   formula).      
-000067f0: 2020 666f 726d 756c 6120 3d20 7265 2e73    formula = re.s
-00006800: 7562 2872 275c 6258 4d41 5443 485c 2827  ub(r'\bXMATCH\('
-00006810: 2c20 275f 786c 666e 2e58 4d41 5443 4828  , '_xlfn.XMATCH(
-00006820: 272c 2066 6f72 6d75 6c61 290a 2020 2020  ', formula).    
-00006830: 2020 2020 666f 726d 756c 6120 3d20 7265      formula = re
-00006840: 2e73 7562 2872 275c 6253 4f52 545c 2827  .sub(r'\bSORT\('
-00006850: 2c20 275f 786c 666e 2e5f 786c 7773 2e53  , '_xlfn._xlws.S
-00006860: 4f52 5428 272c 2066 6f72 6d75 6c61 290a  ORT(', formula).
-00006870: 2020 2020 2020 2020 666f 726d 756c 6120          formula 
-00006880: 3d20 7265 2e73 7562 2872 275c 6258 4c4f  = re.sub(r'\bXLO
-00006890: 4f4b 5550 5c28 272c 2027 5f78 6c66 6e2e  OKUP\(', '_xlfn.
-000068a0: 584c 4f4f 4b55 5028 272c 2066 6f72 6d75  XLOOKUP(', formu
-000068b0: 6c61 290a 2020 2020 2020 2020 666f 726d  la).        form
-000068c0: 756c 6120 3d20 7265 2e73 7562 2872 275c  ula = re.sub(r'\
-000068d0: 6253 4551 5545 4e43 455c 2827 2c20 275f  bSEQUENCE\(', '_
-000068e0: 786c 666e 2e53 4551 5545 4e43 4528 272c  xlfn.SEQUENCE(',
-000068f0: 2066 6f72 6d75 6c61 290a 2020 2020 2020   formula).      
-00006900: 2020 666f 726d 756c 6120 3d20 7265 2e73    formula = re.s
-00006910: 7562 2872 275c 6246 494c 5445 525c 2827  ub(r'\bFILTER\('
-00006920: 2c20 275f 786c 666e 2e5f 786c 7773 2e46  , '_xlfn._xlws.F
-00006930: 494c 5445 5228 272c 2066 6f72 6d75 6c61  ILTER(', formula
-00006940: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
-00006950: 6120 3d20 7265 2e73 7562 2872 275c 6252  a = re.sub(r'\bR
-00006960: 414e 4441 5252 4159 5c28 272c 2027 5f78  ANDARRAY\(', '_x
-00006970: 6c66 6e2e 5241 4e44 4152 5241 5928 272c  lfn.RANDARRAY(',
-00006980: 2066 6f72 6d75 6c61 290a 2020 2020 2020   formula).      
-00006990: 2020 666f 726d 756c 6120 3d20 7265 2e73    formula = re.s
-000069a0: 7562 2872 275c 6241 4e43 484f 5241 5252  ub(r'\bANCHORARR
-000069b0: 4159 5c28 272c 2027 5f78 6c66 6e2e 414e  AY\(', '_xlfn.AN
-000069c0: 4348 4f52 4152 5241 5928 272c 2066 6f72  CHORARRAY(', for
-000069d0: 6d75 6c61 290a 0a20 2020 2020 2020 2069  mula)..        i
-000069e0: 6620 6e6f 7420 7365 6c66 2e75 7365 5f66  f not self.use_f
-000069f0: 7574 7572 655f 6675 6e63 7469 6f6e 733a  uture_functions:
-00006a00: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00006a10: 7572 6e20 666f 726d 756c 610a 0a20 2020  urn formula..   
-00006a20: 2020 2020 2066 6f72 6d75 6c61 203d 2072       formula = r
-00006a30: 652e 7375 6228 7227 5c62 434f 545c 2827  e.sub(r'\bCOT\('
-00006a40: 2c20 275f 786c 666e 2e43 4f54 2827 2c20  , '_xlfn.COT(', 
-00006a50: 666f 726d 756c 6129 0a20 2020 2020 2020  formula).       
-00006a60: 2066 6f72 6d75 6c61 203d 2072 652e 7375   formula = re.su
-00006a70: 6228 7227 5c62 4353 435c 2827 2c20 275f  b(r'\bCSC\(', '_
-00006a80: 786c 666e 2e43 5343 2827 2c20 666f 726d  xlfn.CSC(', form
-00006a90: 756c 6129 0a20 2020 2020 2020 2066 6f72  ula).        for
-00006aa0: 6d75 6c61 203d 2072 652e 7375 6228 7227  mula = re.sub(r'
-00006ab0: 5c62 4946 535c 2827 2c20 275f 786c 666e  \bIFS\(', '_xlfn
-00006ac0: 2e49 4653 2827 2c20 666f 726d 756c 6129  .IFS(', formula)
-00006ad0: 0a20 2020 2020 2020 2066 6f72 6d75 6c61  .        formula
-00006ae0: 203d 2072 652e 7375 6228 7227 5c62 5048   = re.sub(r'\bPH
-00006af0: 495c 2827 2c20 275f 786c 666e 2e50 4849  I\(', '_xlfn.PHI
-00006b00: 2827 2c20 666f 726d 756c 6129 0a20 2020  (', formula).   
-00006b10: 2020 2020 2066 6f72 6d75 6c61 203d 2072       formula = r
-00006b20: 652e 7375 6228 7227 5c62 5252 495c 2827  e.sub(r'\bRRI\('
-00006b30: 2c20 275f 786c 666e 2e52 5249 2827 2c20  , '_xlfn.RRI(', 
-00006b40: 666f 726d 756c 6129 0a20 2020 2020 2020  formula).       
-00006b50: 2066 6f72 6d75 6c61 203d 2072 652e 7375   formula = re.su
-00006b60: 6228 7227 5c62 5345 435c 2827 2c20 275f  b(r'\bSEC\(', '_
-00006b70: 786c 666e 2e53 4543 2827 2c20 666f 726d  xlfn.SEC(', form
-00006b80: 756c 6129 0a20 2020 2020 2020 2066 6f72  ula).        for
-00006b90: 6d75 6c61 203d 2072 652e 7375 6228 7227  mula = re.sub(r'
-00006ba0: 5c62 584f 525c 2827 2c20 275f 786c 666e  \bXOR\(', '_xlfn
-00006bb0: 2e58 4f52 2827 2c20 666f 726d 756c 6129  .XOR(', formula)
-00006bc0: 0a20 2020 2020 2020 2066 6f72 6d75 6c61  .        formula
-00006bd0: 203d 2072 652e 7375 6228 7227 5c62 4143   = re.sub(r'\bAC
-00006be0: 4f54 5c28 272c 2027 5f78 6c66 6e2e 4143  OT\(', '_xlfn.AC
-00006bf0: 4f54 2827 2c20 666f 726d 756c 6129 0a20  OT(', formula). 
-00006c00: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
-00006c10: 2072 652e 7375 6228 7227 5c62 4241 5345   re.sub(r'\bBASE
-00006c20: 5c28 272c 2027 5f78 6c66 6e2e 4241 5345  \(', '_xlfn.BASE
-00006c30: 2827 2c20 666f 726d 756c 6129 0a20 2020  (', formula).   
-00006c40: 2020 2020 2066 6f72 6d75 6c61 203d 2072       formula = r
-00006c50: 652e 7375 6228 7227 5c62 434f 5448 5c28  e.sub(r'\bCOTH\(
-00006c60: 272c 2027 5f78 6c66 6e2e 434f 5448 2827  ', '_xlfn.COTH('
-00006c70: 2c20 666f 726d 756c 6129 0a20 2020 2020  , formula).     
-00006c80: 2020 2066 6f72 6d75 6c61 203d 2072 652e     formula = re.
-00006c90: 7375 6228 7227 5c62 4353 4348 5c28 272c  sub(r'\bCSCH\(',
-00006ca0: 2027 5f78 6c66 6e2e 4353 4348 2827 2c20   '_xlfn.CSCH(', 
-00006cb0: 666f 726d 756c 6129 0a20 2020 2020 2020  formula).       
-00006cc0: 2066 6f72 6d75 6c61 203d 2072 652e 7375   formula = re.su
-00006cd0: 6228 7227 5c62 4441 5953 5c28 272c 2027  b(r'\bDAYS\(', '
-00006ce0: 5f78 6c66 6e2e 4441 5953 2827 2c20 666f  _xlfn.DAYS(', fo
-00006cf0: 726d 756c 6129 0a20 2020 2020 2020 2066  rmula).        f
-00006d00: 6f72 6d75 6c61 203d 2072 652e 7375 6228  ormula = re.sub(
-00006d10: 7227 5c62 4946 4e41 5c28 272c 2027 5f78  r'\bIFNA\(', '_x
-00006d20: 6c66 6e2e 4946 4e41 2827 2c20 666f 726d  lfn.IFNA(', form
-00006d30: 756c 6129 0a20 2020 2020 2020 2066 6f72  ula).        for
-00006d40: 6d75 6c61 203d 2072 652e 7375 6228 7227  mula = re.sub(r'
-00006d50: 5c62 5345 4348 5c28 272c 2027 5f78 6c66  \bSECH\(', '_xlf
-00006d60: 6e2e 5345 4348 2827 2c20 666f 726d 756c  n.SECH(', formul
-00006d70: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-00006d80: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00006d90: 4143 4f54 485c 2827 2c20 275f 786c 666e  ACOTH\(', '_xlfn
-00006da0: 2e41 434f 5448 2827 2c20 666f 726d 756c  .ACOTH(', formul
-00006db0: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-00006dc0: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00006dd0: 4249 544f 525c 2827 2c20 275f 786c 666e  BITOR\(', '_xlfn
-00006de0: 2e42 4954 4f52 2827 2c20 666f 726d 756c  .BITOR(', formul
-00006df0: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-00006e00: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00006e10: 462e 494e 565c 2827 2c20 275f 786c 666e  F.INV\(', '_xlfn
-00006e20: 2e46 2e49 4e56 2827 2c20 666f 726d 756c  .F.INV(', formul
-00006e30: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-00006e40: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00006e50: 4741 4d4d 415c 2827 2c20 275f 786c 666e  GAMMA\(', '_xlfn
-00006e60: 2e47 414d 4d41 2827 2c20 666f 726d 756c  .GAMMA(', formul
-00006e70: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-00006e80: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00006e90: 4741 5553 535c 2827 2c20 275f 786c 666e  GAUSS\(', '_xlfn
-00006ea0: 2e47 4155 5353 2827 2c20 666f 726d 756c  .GAUSS(', formul
-00006eb0: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-00006ec0: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00006ed0: 494d 434f 545c 2827 2c20 275f 786c 666e  IMCOT\(', '_xlfn
-00006ee0: 2e49 4d43 4f54 2827 2c20 666f 726d 756c  .IMCOT(', formul
-00006ef0: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-00006f00: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00006f10: 494d 4353 435c 2827 2c20 275f 786c 666e  IMCSC\(', '_xlfn
-00006f20: 2e49 4d43 5343 2827 2c20 666f 726d 756c  .IMCSC(', formul
-00006f30: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-00006f40: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00006f50: 494d 5345 435c 2827 2c20 275f 786c 666e  IMSEC\(', '_xlfn
-00006f60: 2e49 4d53 4543 2827 2c20 666f 726d 756c  .IMSEC(', formul
-00006f70: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-00006f80: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00006f90: 494d 5441 4e5c 2827 2c20 275f 786c 666e  IMTAN\(', '_xlfn
-00006fa0: 2e49 4d54 414e 2827 2c20 666f 726d 756c  .IMTAN(', formul
-00006fb0: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-00006fc0: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00006fd0: 4d55 4e49 545c 2827 2c20 275f 786c 666e  MUNIT\(', '_xlfn
-00006fe0: 2e4d 554e 4954 2827 2c20 666f 726d 756c  .MUNIT(', formul
-00006ff0: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-00007000: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00007010: 5348 4545 545c 2827 2c20 275f 786c 666e  SHEET\(', '_xlfn
-00007020: 2e53 4845 4554 2827 2c20 666f 726d 756c  .SHEET(', formul
-00007030: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-00007040: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00007050: 542e 494e 565c 2827 2c20 275f 786c 666e  T.INV\(', '_xlfn
-00007060: 2e54 2e49 4e56 2827 2c20 666f 726d 756c  .T.INV(', formul
-00007070: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-00007080: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00007090: 5641 522e 505c 2827 2c20 275f 786c 666e  VAR.P\(', '_xlfn
-000070a0: 2e56 4152 2e50 2827 2c20 666f 726d 756c  .VAR.P(', formul
-000070b0: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-000070c0: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-000070d0: 5641 522e 535c 2827 2c20 275f 786c 666e  VAR.S\(', '_xlfn
-000070e0: 2e56 4152 2e53 2827 2c20 666f 726d 756c  .VAR.S(', formul
-000070f0: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-00007100: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00007110: 4152 4142 4943 5c28 272c 2027 5f78 6c66  ARABIC\(', '_xlf
-00007120: 6e2e 4152 4142 4943 2827 2c20 666f 726d  n.ARABIC(', form
-00007130: 756c 6129 0a20 2020 2020 2020 2066 6f72  ula).        for
-00007140: 6d75 6c61 203d 2072 652e 7375 6228 7227  mula = re.sub(r'
-00007150: 5c62 4249 5441 4e44 5c28 272c 2027 5f78  \bBITAND\(', '_x
-00007160: 6c66 6e2e 4249 5441 4e44 2827 2c20 666f  lfn.BITAND(', fo
-00007170: 726d 756c 6129 0a20 2020 2020 2020 2066  rmula).        f
-00007180: 6f72 6d75 6c61 203d 2072 652e 7375 6228  ormula = re.sub(
-00007190: 7227 5c62 4249 5458 4f52 5c28 272c 2027  r'\bBITXOR\(', '
-000071a0: 5f78 6c66 6e2e 4249 5458 4f52 2827 2c20  _xlfn.BITXOR(', 
-000071b0: 666f 726d 756c 6129 0a20 2020 2020 2020  formula).       
-000071c0: 2066 6f72 6d75 6c61 203d 2072 652e 7375   formula = re.su
-000071d0: 6228 7227 5c62 434f 4e43 4154 5c28 272c  b(r'\bCONCAT\(',
-000071e0: 2027 5f78 6c66 6e2e 434f 4e43 4154 2827   '_xlfn.CONCAT('
-000071f0: 2c20 666f 726d 756c 6129 0a20 2020 2020  , formula).     
-00007200: 2020 2066 6f72 6d75 6c61 203d 2072 652e     formula = re.
-00007210: 7375 6228 7227 5c62 462e 4449 5354 5c28  sub(r'\bF.DIST\(
-00007220: 272c 2027 5f78 6c66 6e2e 462e 4449 5354  ', '_xlfn.F.DIST
-00007230: 2827 2c20 666f 726d 756c 6129 0a20 2020  (', formula).   
-00007240: 2020 2020 2066 6f72 6d75 6c61 203d 2072       formula = r
-00007250: 652e 7375 6228 7227 5c62 462e 5445 5354  e.sub(r'\bF.TEST
-00007260: 5c28 272c 2027 5f78 6c66 6e2e 462e 5445  \(', '_xlfn.F.TE
-00007270: 5354 2827 2c20 666f 726d 756c 6129 0a20  ST(', formula). 
-00007280: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
-00007290: 2072 652e 7375 6228 7227 5c62 494d 434f   re.sub(r'\bIMCO
-000072a0: 5348 5c28 272c 2027 5f78 6c66 6e2e 494d  SH\(', '_xlfn.IM
-000072b0: 434f 5348 2827 2c20 666f 726d 756c 6129  COSH(', formula)
-000072c0: 0a20 2020 2020 2020 2066 6f72 6d75 6c61  .        formula
-000072d0: 203d 2072 652e 7375 6228 7227 5c62 494d   = re.sub(r'\bIM
-000072e0: 4353 4348 5c28 272c 2027 5f78 6c66 6e2e  CSCH\(', '_xlfn.
-000072f0: 494d 4353 4348 2827 2c20 666f 726d 756c  IMCSCH(', formul
-00007300: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-00007310: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00007320: 494d 5345 4348 5c28 272c 2027 5f78 6c66  IMSECH\(', '_xlf
-00007330: 6e2e 494d 5345 4348 2827 2c20 666f 726d  n.IMSECH(', form
-00007340: 756c 6129 0a20 2020 2020 2020 2066 6f72  ula).        for
-00007350: 6d75 6c61 203d 2072 652e 7375 6228 7227  mula = re.sub(r'
-00007360: 5c62 494d 5349 4e48 5c28 272c 2027 5f78  \bIMSINH\(', '_x
-00007370: 6c66 6e2e 494d 5349 4e48 2827 2c20 666f  lfn.IMSINH(', fo
-00007380: 726d 756c 6129 0a20 2020 2020 2020 2066  rmula).        f
-00007390: 6f72 6d75 6c61 203d 2072 652e 7375 6228  ormula = re.sub(
-000073a0: 7227 5c62 4d41 5849 4653 5c28 272c 2027  r'\bMAXIFS\(', '
-000073b0: 5f78 6c66 6e2e 4d41 5849 4653 2827 2c20  _xlfn.MAXIFS(', 
-000073c0: 666f 726d 756c 6129 0a20 2020 2020 2020  formula).       
-000073d0: 2066 6f72 6d75 6c61 203d 2072 652e 7375   formula = re.su
-000073e0: 6228 7227 5c62 4d49 4e49 4653 5c28 272c  b(r'\bMINIFS\(',
-000073f0: 2027 5f78 6c66 6e2e 4d49 4e49 4653 2827   '_xlfn.MINIFS('
-00007400: 2c20 666f 726d 756c 6129 0a20 2020 2020  , formula).     
-00007410: 2020 2066 6f72 6d75 6c61 203d 2072 652e     formula = re.
-00007420: 7375 6228 7227 5c62 5348 4545 5453 5c28  sub(r'\bSHEETS\(
-00007430: 272c 2027 5f78 6c66 6e2e 5348 4545 5453  ', '_xlfn.SHEETS
-00007440: 2827 2c20 666f 726d 756c 6129 0a20 2020  (', formula).   
-00007450: 2020 2020 2066 6f72 6d75 6c61 203d 2072       formula = r
-00007460: 652e 7375 6228 7227 5c62 534b 4557 2e50  e.sub(r'\bSKEW.P
-00007470: 5c28 272c 2027 5f78 6c66 6e2e 534b 4557  \(', '_xlfn.SKEW
-00007480: 2e50 2827 2c20 666f 726d 756c 6129 0a20  .P(', formula). 
-00007490: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
-000074a0: 2072 652e 7375 6228 7227 5c62 5357 4954   re.sub(r'\bSWIT
-000074b0: 4348 5c28 272c 2027 5f78 6c66 6e2e 5357  CH\(', '_xlfn.SW
-000074c0: 4954 4348 2827 2c20 666f 726d 756c 6129  ITCH(', formula)
-000074d0: 0a20 2020 2020 2020 2066 6f72 6d75 6c61  .        formula
-000074e0: 203d 2072 652e 7375 6228 7227 5c62 542e   = re.sub(r'\bT.
-000074f0: 4449 5354 5c28 272c 2027 5f78 6c66 6e2e  DIST\(', '_xlfn.
-00007500: 542e 4449 5354 2827 2c20 666f 726d 756c  T.DIST(', formul
-00007510: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-00007520: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00007530: 542e 5445 5354 5c28 272c 2027 5f78 6c66  T.TEST\(', '_xlf
-00007540: 6e2e 542e 5445 5354 2827 2c20 666f 726d  n.T.TEST(', form
-00007550: 756c 6129 0a20 2020 2020 2020 2066 6f72  ula).        for
-00007560: 6d75 6c61 203d 2072 652e 7375 6228 7227  mula = re.sub(r'
-00007570: 5c62 5a2e 5445 5354 5c28 272c 2027 5f78  \bZ.TEST\(', '_x
-00007580: 6c66 6e2e 5a2e 5445 5354 2827 2c20 666f  lfn.Z.TEST(', fo
-00007590: 726d 756c 6129 0a20 2020 2020 2020 2066  rmula).        f
-000075a0: 6f72 6d75 6c61 203d 2072 652e 7375 6228  ormula = re.sub(
-000075b0: 7227 5c62 434f 4d42 494e 415c 2827 2c20  r'\bCOMBINA\(', 
-000075c0: 275f 786c 666e 2e43 4f4d 4249 4e41 2827  '_xlfn.COMBINA('
-000075d0: 2c20 666f 726d 756c 6129 0a20 2020 2020  , formula).     
-000075e0: 2020 2066 6f72 6d75 6c61 203d 2072 652e     formula = re.
-000075f0: 7375 6228 7227 5c62 4445 4349 4d41 4c5c  sub(r'\bDECIMAL\
-00007600: 2827 2c20 275f 786c 666e 2e44 4543 494d  (', '_xlfn.DECIM
-00007610: 414c 2827 2c20 666f 726d 756c 6129 0a20  AL(', formula). 
-00007620: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
-00007630: 2072 652e 7375 6228 7227 5c62 5241 4e4b   re.sub(r'\bRANK
-00007640: 2e45 515c 2827 2c20 275f 786c 666e 2e52  .EQ\(', '_xlfn.R
-00007650: 414e 4b2e 4551 2827 2c20 666f 726d 756c  ANK.EQ(', formul
-00007660: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-00007670: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00007680: 5354 4445 562e 505c 2827 2c20 275f 786c  STDEV.P\(', '_xl
-00007690: 666e 2e53 5444 4556 2e50 2827 2c20 666f  fn.STDEV.P(', fo
-000076a0: 726d 756c 6129 0a20 2020 2020 2020 2066  rmula).        f
-000076b0: 6f72 6d75 6c61 203d 2072 652e 7375 6228  ormula = re.sub(
-000076c0: 7227 5c62 5354 4445 562e 535c 2827 2c20  r'\bSTDEV.S\(', 
-000076d0: 275f 786c 666e 2e53 5444 4556 2e53 2827  '_xlfn.STDEV.S('
-000076e0: 2c20 666f 726d 756c 6129 0a20 2020 2020  , formula).     
-000076f0: 2020 2066 6f72 6d75 6c61 203d 2072 652e     formula = re.
-00007700: 7375 6228 7227 5c62 554e 4943 4841 525c  sub(r'\bUNICHAR\
-00007710: 2827 2c20 275f 786c 666e 2e55 4e49 4348  (', '_xlfn.UNICH
-00007720: 4152 2827 2c20 666f 726d 756c 6129 0a20  AR(', formula). 
-00007730: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
-00007740: 2072 652e 7375 6228 7227 5c62 554e 4943   re.sub(r'\bUNIC
-00007750: 4f44 455c 2827 2c20 275f 786c 666e 2e55  ODE\(', '_xlfn.U
-00007760: 4e49 434f 4445 2827 2c20 666f 726d 756c  NICODE(', formul
-00007770: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-00007780: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00007790: 4245 5441 2e49 4e56 5c28 272c 2027 5f78  BETA.INV\(', '_x
-000077a0: 6c66 6e2e 4245 5441 2e49 4e56 2827 2c20  lfn.BETA.INV(', 
-000077b0: 666f 726d 756c 6129 0a20 2020 2020 2020  formula).       
-000077c0: 2066 6f72 6d75 6c61 203d 2072 652e 7375   formula = re.su
-000077d0: 6228 7227 5c62 462e 494e 562e 5254 5c28  b(r'\bF.INV.RT\(
-000077e0: 272c 2027 5f78 6c66 6e2e 462e 494e 562e  ', '_xlfn.F.INV.
-000077f0: 5254 2827 2c20 666f 726d 756c 6129 0a20  RT(', formula). 
-00007800: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
-00007810: 2072 652e 7375 6228 7227 5c62 4e4f 524d   re.sub(r'\bNORM
-00007820: 2e49 4e56 5c28 272c 2027 5f78 6c66 6e2e  .INV\(', '_xlfn.
-00007830: 4e4f 524d 2e49 4e56 2827 2c20 666f 726d  NORM.INV(', form
-00007840: 756c 6129 0a20 2020 2020 2020 2066 6f72  ula).        for
-00007850: 6d75 6c61 203d 2072 652e 7375 6228 7227  mula = re.sub(r'
-00007860: 5c62 5241 4e4b 2e41 5647 5c28 272c 2027  \bRANK.AVG\(', '
-00007870: 5f78 6c66 6e2e 5241 4e4b 2e41 5647 2827  _xlfn.RANK.AVG('
-00007880: 2c20 666f 726d 756c 6129 0a20 2020 2020  , formula).     
-00007890: 2020 2066 6f72 6d75 6c61 203d 2072 652e     formula = re.
-000078a0: 7375 6228 7227 5c62 542e 494e 562e 3254  sub(r'\bT.INV.2T
-000078b0: 5c28 272c 2027 5f78 6c66 6e2e 542e 494e  \(', '_xlfn.T.IN
-000078c0: 562e 3254 2827 2c20 666f 726d 756c 6129  V.2T(', formula)
-000078d0: 0a20 2020 2020 2020 2066 6f72 6d75 6c61  .        formula
-000078e0: 203d 2072 652e 7375 6228 7227 5c62 5445   = re.sub(r'\bTE
-000078f0: 5854 4a4f 494e 5c28 272c 2027 5f78 6c66  XTJOIN\(', '_xlf
-00007900: 6e2e 5445 5854 4a4f 494e 2827 2c20 666f  n.TEXTJOIN(', fo
-00007910: 726d 756c 6129 0a20 2020 2020 2020 2066  rmula).        f
-00007920: 6f72 6d75 6c61 203d 2072 652e 7375 6228  ormula = re.sub(
-00007930: 7227 5c62 4147 4752 4547 4154 455c 2827  r'\bAGGREGATE\('
-00007940: 2c20 275f 786c 666e 2e41 4747 5245 4741  , '_xlfn.AGGREGA
-00007950: 5445 2827 2c20 666f 726d 756c 6129 0a20  TE(', formula). 
-00007960: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
-00007970: 2072 652e 7375 6228 7227 5c62 4245 5441   re.sub(r'\bBETA
-00007980: 2e44 4953 545c 2827 2c20 275f 786c 666e  .DIST\(', '_xlfn
-00007990: 2e42 4554 412e 4449 5354 2827 2c20 666f  .BETA.DIST(', fo
-000079a0: 726d 756c 6129 0a20 2020 2020 2020 2066  rmula).        f
-000079b0: 6f72 6d75 6c61 203d 2072 652e 7375 6228  ormula = re.sub(
-000079c0: 7227 5c62 4249 4e4f 4d2e 494e 565c 2827  r'\bBINOM.INV\('
-000079d0: 2c20 275f 786c 666e 2e42 494e 4f4d 2e49  , '_xlfn.BINOM.I
-000079e0: 4e56 2827 2c20 666f 726d 756c 6129 0a20  NV(', formula). 
-000079f0: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
-00007a00: 2072 652e 7375 6228 7227 5c62 4249 544c   re.sub(r'\bBITL
-00007a10: 5348 4946 545c 2827 2c20 275f 786c 666e  SHIFT\(', '_xlfn
-00007a20: 2e42 4954 4c53 4849 4654 2827 2c20 666f  .BITLSHIFT(', fo
-00007a30: 726d 756c 6129 0a20 2020 2020 2020 2066  rmula).        f
-00007a40: 6f72 6d75 6c61 203d 2072 652e 7375 6228  ormula = re.sub(
-00007a50: 7227 5c62 4249 5452 5348 4946 545c 2827  r'\bBITRSHIFT\('
-00007a60: 2c20 275f 786c 666e 2e42 4954 5253 4849  , '_xlfn.BITRSHI
-00007a70: 4654 2827 2c20 666f 726d 756c 6129 0a20  FT(', formula). 
-00007a80: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
-00007a90: 2072 652e 7375 6228 7227 5c62 4348 4953   re.sub(r'\bCHIS
-00007aa0: 512e 494e 565c 2827 2c20 275f 786c 666e  Q.INV\(', '_xlfn
-00007ab0: 2e43 4849 5351 2e49 4e56 2827 2c20 666f  .CHISQ.INV(', fo
-00007ac0: 726d 756c 6129 0a20 2020 2020 2020 2066  rmula).        f
-00007ad0: 6f72 6d75 6c61 203d 2072 652e 7375 6228  ormula = re.sub(
-00007ae0: 7227 5c62 462e 4449 5354 2e52 545c 2827  r'\bF.DIST.RT\('
-00007af0: 2c20 275f 786c 666e 2e46 2e44 4953 542e  , '_xlfn.F.DIST.
-00007b00: 5254 2827 2c20 666f 726d 756c 6129 0a20  RT(', formula). 
-00007b10: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
-00007b20: 2072 652e 7375 6228 7227 5c62 4649 4c54   re.sub(r'\bFILT
-00007b30: 4552 584d 4c5c 2827 2c20 275f 786c 666e  ERXML\(', '_xlfn
-00007b40: 2e46 494c 5445 5258 4d4c 2827 2c20 666f  .FILTERXML(', fo
-00007b50: 726d 756c 6129 0a20 2020 2020 2020 2066  rmula).        f
-00007b60: 6f72 6d75 6c61 203d 2072 652e 7375 6228  ormula = re.sub(
-00007b70: 7227 5c62 4741 4d4d 412e 494e 565c 2827  r'\bGAMMA.INV\('
-00007b80: 2c20 275f 786c 666e 2e47 414d 4d41 2e49  , '_xlfn.GAMMA.I
-00007b90: 4e56 2827 2c20 666f 726d 756c 6129 0a20  NV(', formula). 
-00007ba0: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
-00007bb0: 2072 652e 7375 6228 7227 5c62 4953 464f   re.sub(r'\bISFO
-00007bc0: 524d 554c 415c 2827 2c20 275f 786c 666e  RMULA\(', '_xlfn
-00007bd0: 2e49 5346 4f52 4d55 4c41 2827 2c20 666f  .ISFORMULA(', fo
-00007be0: 726d 756c 6129 0a20 2020 2020 2020 2066  rmula).        f
-00007bf0: 6f72 6d75 6c61 203d 2072 652e 7375 6228  ormula = re.sub(
-00007c00: 7227 5c62 4d4f 4445 2e4d 554c 545c 2827  r'\bMODE.MULT\('
-00007c10: 2c20 275f 786c 666e 2e4d 4f44 452e 4d55  , '_xlfn.MODE.MU
-00007c20: 4c54 2827 2c20 666f 726d 756c 6129 0a20  LT(', formula). 
-00007c30: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
-00007c40: 2072 652e 7375 6228 7227 5c62 4d4f 4445   re.sub(r'\bMODE
-00007c50: 2e53 4e47 4c5c 2827 2c20 275f 786c 666e  .SNGL\(', '_xlfn
-00007c60: 2e4d 4f44 452e 534e 474c 2827 2c20 666f  .MODE.SNGL(', fo
-00007c70: 726d 756c 6129 0a20 2020 2020 2020 2066  rmula).        f
-00007c80: 6f72 6d75 6c61 203d 2072 652e 7375 6228  ormula = re.sub(
-00007c90: 7227 5c62 4e4f 524d 2e44 4953 545c 2827  r'\bNORM.DIST\('
-00007ca0: 2c20 275f 786c 666e 2e4e 4f52 4d2e 4449  , '_xlfn.NORM.DI
-00007cb0: 5354 2827 2c20 666f 726d 756c 6129 0a20  ST(', formula). 
-00007cc0: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
-00007cd0: 2072 652e 7375 6228 7227 5c62 5044 5552   re.sub(r'\bPDUR
-00007ce0: 4154 494f 4e5c 2827 2c20 275f 786c 666e  ATION\(', '_xlfn
-00007cf0: 2e50 4455 5241 5449 4f4e 2827 2c20 666f  .PDURATION(', fo
-00007d00: 726d 756c 6129 0a20 2020 2020 2020 2066  rmula).        f
-00007d10: 6f72 6d75 6c61 203d 2072 652e 7375 6228  ormula = re.sub(
-00007d20: 7227 5c62 542e 4449 5354 2e32 545c 2827  r'\bT.DIST.2T\('
-00007d30: 2c20 275f 786c 666e 2e54 2e44 4953 542e  , '_xlfn.T.DIST.
-00007d40: 3254 2827 2c20 666f 726d 756c 6129 0a20  2T(', formula). 
-00007d50: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
-00007d60: 2072 652e 7375 6228 7227 5c62 542e 4449   re.sub(r'\bT.DI
-00007d70: 5354 2e52 545c 2827 2c20 275f 786c 666e  ST.RT\(', '_xlfn
-00007d80: 2e54 2e44 4953 542e 5254 2827 2c20 666f  .T.DIST.RT(', fo
-00007d90: 726d 756c 6129 0a20 2020 2020 2020 2066  rmula).        f
-00007da0: 6f72 6d75 6c61 203d 2072 652e 7375 6228  ormula = re.sub(
-00007db0: 7227 5c62 4249 4e4f 4d2e 4449 5354 5c28  r'\bBINOM.DIST\(
-00007dc0: 272c 2027 5f78 6c66 6e2e 4249 4e4f 4d2e  ', '_xlfn.BINOM.
-00007dd0: 4449 5354 2827 2c20 666f 726d 756c 6129  DIST(', formula)
-00007de0: 0a20 2020 2020 2020 2066 6f72 6d75 6c61  .        formula
-00007df0: 203d 2072 652e 7375 6228 7227 5c62 4348   = re.sub(r'\bCH
-00007e00: 4953 512e 4449 5354 5c28 272c 2027 5f78  ISQ.DIST\(', '_x
-00007e10: 6c66 6e2e 4348 4953 512e 4449 5354 2827  lfn.CHISQ.DIST('
-00007e20: 2c20 666f 726d 756c 6129 0a20 2020 2020  , formula).     
-00007e30: 2020 2066 6f72 6d75 6c61 203d 2072 652e     formula = re.
-00007e40: 7375 6228 7227 5c62 4348 4953 512e 5445  sub(r'\bCHISQ.TE
-00007e50: 5354 5c28 272c 2027 5f78 6c66 6e2e 4348  ST\(', '_xlfn.CH
-00007e60: 4953 512e 5445 5354 2827 2c20 666f 726d  ISQ.TEST(', form
-00007e70: 756c 6129 0a20 2020 2020 2020 2066 6f72  ula).        for
-00007e80: 6d75 6c61 203d 2072 652e 7375 6228 7227  mula = re.sub(r'
-00007e90: 5c62 4558 504f 4e2e 4449 5354 5c28 272c  \bEXPON.DIST\(',
-00007ea0: 2027 5f78 6c66 6e2e 4558 504f 4e2e 4449   '_xlfn.EXPON.DI
-00007eb0: 5354 2827 2c20 666f 726d 756c 6129 0a20  ST(', formula). 
-00007ec0: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
-00007ed0: 2072 652e 7375 6228 7227 5c62 464c 4f4f   re.sub(r'\bFLOO
-00007ee0: 522e 4d41 5448 5c28 272c 2027 5f78 6c66  R.MATH\(', '_xlf
-00007ef0: 6e2e 464c 4f4f 522e 4d41 5448 2827 2c20  n.FLOOR.MATH(', 
-00007f00: 666f 726d 756c 6129 0a20 2020 2020 2020  formula).       
-00007f10: 2066 6f72 6d75 6c61 203d 2072 652e 7375   formula = re.su
-00007f20: 6228 7227 5c62 4741 4d4d 412e 4449 5354  b(r'\bGAMMA.DIST
-00007f30: 5c28 272c 2027 5f78 6c66 6e2e 4741 4d4d  \(', '_xlfn.GAMM
-00007f40: 412e 4449 5354 2827 2c20 666f 726d 756c  A.DIST(', formul
-00007f50: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-00007f60: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00007f70: 4953 4f57 4545 4b4e 554d 5c28 272c 2027  ISOWEEKNUM\(', '
-00007f80: 5f78 6c66 6e2e 4953 4f57 4545 4b4e 554d  _xlfn.ISOWEEKNUM
-00007f90: 2827 2c20 666f 726d 756c 6129 0a20 2020  (', formula).   
-00007fa0: 2020 2020 2066 6f72 6d75 6c61 203d 2072       formula = r
-00007fb0: 652e 7375 6228 7227 5c62 4e4f 524d 2e53  e.sub(r'\bNORM.S
-00007fc0: 2e49 4e56 5c28 272c 2027 5f78 6c66 6e2e  .INV\(', '_xlfn.
-00007fd0: 4e4f 524d 2e53 2e49 4e56 2827 2c20 666f  NORM.S.INV(', fo
-00007fe0: 726d 756c 6129 0a20 2020 2020 2020 2066  rmula).        f
-00007ff0: 6f72 6d75 6c61 203d 2072 652e 7375 6228  ormula = re.sub(
-00008000: 7227 5c62 5745 4253 4552 5649 4345 5c28  r'\bWEBSERVICE\(
-00008010: 272c 2027 5f78 6c66 6e2e 5745 4253 4552  ', '_xlfn.WEBSER
-00008020: 5649 4345 2827 2c20 666f 726d 756c 6129  VICE(', formula)
-00008030: 0a20 2020 2020 2020 2066 6f72 6d75 6c61  .        formula
-00008040: 203d 2072 652e 7375 6228 7227 5c62 4552   = re.sub(r'\bER
-00008050: 462e 5052 4543 4953 455c 2827 2c20 275f  F.PRECISE\(', '_
-00008060: 786c 666e 2e45 5246 2e50 5245 4349 5345  xlfn.ERF.PRECISE
-00008070: 2827 2c20 666f 726d 756c 6129 0a20 2020  (', formula).   
-00008080: 2020 2020 2066 6f72 6d75 6c61 203d 2072       formula = r
-00008090: 652e 7375 6228 7227 5c62 464f 524d 554c  e.sub(r'\bFORMUL
-000080a0: 4154 4558 545c 2827 2c20 275f 786c 666e  ATEXT\(', '_xlfn
-000080b0: 2e46 4f52 4d55 4c41 5445 5854 2827 2c20  .FORMULATEXT(', 
-000080c0: 666f 726d 756c 6129 0a20 2020 2020 2020  formula).       
-000080d0: 2066 6f72 6d75 6c61 203d 2072 652e 7375   formula = re.su
-000080e0: 6228 7227 5c62 4c4f 474e 4f52 4d2e 494e  b(r'\bLOGNORM.IN
-000080f0: 565c 2827 2c20 275f 786c 666e 2e4c 4f47  V\(', '_xlfn.LOG
-00008100: 4e4f 524d 2e49 4e56 2827 2c20 666f 726d  NORM.INV(', form
-00008110: 756c 6129 0a20 2020 2020 2020 2066 6f72  ula).        for
-00008120: 6d75 6c61 203d 2072 652e 7375 6228 7227  mula = re.sub(r'
-00008130: 5c62 4e4f 524d 2e53 2e44 4953 545c 2827  \bNORM.S.DIST\('
-00008140: 2c20 275f 786c 666e 2e4e 4f52 4d2e 532e  , '_xlfn.NORM.S.
-00008150: 4449 5354 2827 2c20 666f 726d 756c 6129  DIST(', formula)
-00008160: 0a20 2020 2020 2020 2066 6f72 6d75 6c61  .        formula
-00008170: 203d 2072 652e 7375 6228 7227 5c62 4e55   = re.sub(r'\bNU
-00008180: 4d42 4552 5641 4c55 455c 2827 2c20 275f  MBERVALUE\(', '_
-00008190: 786c 666e 2e4e 554d 4245 5256 414c 5545  xlfn.NUMBERVALUE
-000081a0: 2827 2c20 666f 726d 756c 6129 0a20 2020  (', formula).   
-000081b0: 2020 2020 2066 6f72 6d75 6c61 203d 2072       formula = r
-000081c0: 652e 7375 6228 7227 5c62 5155 4552 5953  e.sub(r'\bQUERYS
-000081d0: 5452 494e 475c 2827 2c20 275f 786c 666e  TRING\(', '_xlfn
-000081e0: 2e51 5545 5259 5354 5249 4e47 2827 2c20  .QUERYSTRING(', 
-000081f0: 666f 726d 756c 6129 0a20 2020 2020 2020  formula).       
-00008200: 2066 6f72 6d75 6c61 203d 2072 652e 7375   formula = re.su
-00008210: 6228 7227 5c62 4345 494c 494e 472e 4d41  b(r'\bCEILING.MA
-00008220: 5448 5c28 272c 2027 5f78 6c66 6e2e 4345  TH\(', '_xlfn.CE
-00008230: 494c 494e 472e 4d41 5448 2827 2c20 666f  ILING.MATH(', fo
-00008240: 726d 756c 6129 0a20 2020 2020 2020 2066  rmula).        f
-00008250: 6f72 6d75 6c61 203d 2072 652e 7375 6228  ormula = re.sub(
-00008260: 7227 5c62 4348 4953 512e 494e 562e 5254  r'\bCHISQ.INV.RT
-00008270: 5c28 272c 2027 5f78 6c66 6e2e 4348 4953  \(', '_xlfn.CHIS
-00008280: 512e 494e 562e 5254 2827 2c20 666f 726d  Q.INV.RT(', form
-00008290: 756c 6129 0a20 2020 2020 2020 2066 6f72  ula).        for
-000082a0: 6d75 6c61 203d 2072 652e 7375 6228 7227  mula = re.sub(r'
-000082b0: 5c62 434f 4e46 4944 454e 4345 2e54 5c28  \bCONFIDENCE.T\(
-000082c0: 272c 2027 5f78 6c66 6e2e 434f 4e46 4944  ', '_xlfn.CONFID
-000082d0: 454e 4345 2e54 2827 2c20 666f 726d 756c  ENCE.T(', formul
-000082e0: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-000082f0: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00008300: 434f 5641 5249 414e 4345 2e50 5c28 272c  COVARIANCE.P\(',
-00008310: 2027 5f78 6c66 6e2e 434f 5641 5249 414e   '_xlfn.COVARIAN
-00008320: 4345 2e50 2827 2c20 666f 726d 756c 6129  CE.P(', formula)
-00008330: 0a20 2020 2020 2020 2066 6f72 6d75 6c61  .        formula
-00008340: 203d 2072 652e 7375 6228 7227 5c62 434f   = re.sub(r'\bCO
-00008350: 5641 5249 414e 4345 2e53 5c28 272c 2027  VARIANCE.S\(', '
-00008360: 5f78 6c66 6e2e 434f 5641 5249 414e 4345  _xlfn.COVARIANCE
-00008370: 2e53 2827 2c20 666f 726d 756c 6129 0a20  .S(', formula). 
-00008380: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
-00008390: 2072 652e 7375 6228 7227 5c62 4552 4643   re.sub(r'\bERFC
-000083a0: 2e50 5245 4349 5345 5c28 272c 2027 5f78  .PRECISE\(', '_x
-000083b0: 6c66 6e2e 4552 4643 2e50 5245 4349 5345  lfn.ERFC.PRECISE
-000083c0: 2827 2c20 666f 726d 756c 6129 0a20 2020  (', formula).   
-000083d0: 2020 2020 2066 6f72 6d75 6c61 203d 2072       formula = r
-000083e0: 652e 7375 6228 7227 5c62 464f 5245 4341  e.sub(r'\bFORECA
-000083f0: 5354 2e45 5453 5c28 272c 2027 5f78 6c66  ST.ETS\(', '_xlf
-00008400: 6e2e 464f 5245 4341 5354 2e45 5453 2827  n.FORECAST.ETS('
-00008410: 2c20 666f 726d 756c 6129 0a20 2020 2020  , formula).     
-00008420: 2020 2066 6f72 6d75 6c61 203d 2072 652e     formula = re.
-00008430: 7375 6228 7227 5c62 4859 5047 454f 4d2e  sub(r'\bHYPGEOM.
-00008440: 4449 5354 5c28 272c 2027 5f78 6c66 6e2e  DIST\(', '_xlfn.
-00008450: 4859 5047 454f 4d2e 4449 5354 2827 2c20  HYPGEOM.DIST(', 
-00008460: 666f 726d 756c 6129 0a20 2020 2020 2020  formula).       
-00008470: 2066 6f72 6d75 6c61 203d 2072 652e 7375   formula = re.su
-00008480: 6228 7227 5c62 4c4f 474e 4f52 4d2e 4449  b(r'\bLOGNORM.DI
-00008490: 5354 5c28 272c 2027 5f78 6c66 6e2e 4c4f  ST\(', '_xlfn.LO
-000084a0: 474e 4f52 4d2e 4449 5354 2827 2c20 666f  GNORM.DIST(', fo
-000084b0: 726d 756c 6129 0a20 2020 2020 2020 2066  rmula).        f
-000084c0: 6f72 6d75 6c61 203d 2072 652e 7375 6228  ormula = re.sub(
-000084d0: 7227 5c62 5045 524d 5554 4154 494f 4e41  r'\bPERMUTATIONA
-000084e0: 5c28 272c 2027 5f78 6c66 6e2e 5045 524d  \(', '_xlfn.PERM
-000084f0: 5554 4154 494f 4e41 2827 2c20 666f 726d  UTATIONA(', form
-00008500: 756c 6129 0a20 2020 2020 2020 2066 6f72  ula).        for
-00008510: 6d75 6c61 203d 2072 652e 7375 6228 7227  mula = re.sub(r'
-00008520: 5c62 504f 4953 534f 4e2e 4449 5354 5c28  \bPOISSON.DIST\(
-00008530: 272c 2027 5f78 6c66 6e2e 504f 4953 534f  ', '_xlfn.POISSO
-00008540: 4e2e 4449 5354 2827 2c20 666f 726d 756c  N.DIST(', formul
-00008550: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
-00008560: 6c61 203d 2072 652e 7375 6228 7227 5c62  la = re.sub(r'\b
-00008570: 5155 4152 5449 4c45 2e45 5843 5c28 272c  QUARTILE.EXC\(',
-00008580: 2027 5f78 6c66 6e2e 5155 4152 5449 4c45   '_xlfn.QUARTILE
-00008590: 2e45 5843 2827 2c20 666f 726d 756c 6129  .EXC(', formula)
-000085a0: 0a20 2020 2020 2020 2066 6f72 6d75 6c61  .        formula
-000085b0: 203d 2072 652e 7375 6228 7227 5c62 5155   = re.sub(r'\bQU
-000085c0: 4152 5449 4c45 2e49 4e43 5c28 272c 2027  ARTILE.INC\(', '
-000085d0: 5f78 6c66 6e2e 5155 4152 5449 4c45 2e49  _xlfn.QUARTILE.I
-000085e0: 4e43 2827 2c20 666f 726d 756c 6129 0a20  NC(', formula). 
-000085f0: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
-00008600: 2072 652e 7375 6228 7227 5c62 5745 4942   re.sub(r'\bWEIB
-00008610: 554c 4c2e 4449 5354 5c28 272c 2027 5f78  ULL.DIST\(', '_x
-00008620: 6c66 6e2e 5745 4942 554c 4c2e 4449 5354  lfn.WEIBULL.DIST
-00008630: 2827 2c20 666f 726d 756c 6129 0a20 2020  (', formula).   
-00008640: 2020 2020 2066 6f72 6d75 6c61 203d 2072       formula = r
-00008650: 652e 7375 6228 7227 5c62 4348 4953 512e  e.sub(r'\bCHISQ.
-00008660: 4449 5354 2e52 545c 2827 2c20 275f 786c  DIST.RT\(', '_xl
-00008670: 666e 2e43 4849 5351 2e44 4953 542e 5254  fn.CHISQ.DIST.RT
-00008680: 2827 2c20 666f 726d 756c 6129 0a20 2020  (', formula).   
-00008690: 2020 2020 2066 6f72 6d75 6c61 203d 2072       formula = r
-000086a0: 652e 7375 6228 7227 5c62 464c 4f4f 522e  e.sub(r'\bFLOOR.
-000086b0: 5052 4543 4953 455c 2827 2c20 275f 786c  PRECISE\(', '_xl
-000086c0: 666e 2e46 4c4f 4f52 2e50 5245 4349 5345  fn.FLOOR.PRECISE
-000086d0: 2827 2c20 666f 726d 756c 6129 0a20 2020  (', formula).   
-000086e0: 2020 2020 2066 6f72 6d75 6c61 203d 2072       formula = r
-000086f0: 652e 7375 6228 7227 5c62 4e45 4742 494e  e.sub(r'\bNEGBIN
-00008700: 4f4d 2e44 4953 545c 2827 2c20 275f 786c  OM.DIST\(', '_xl
-00008710: 666e 2e4e 4547 4249 4e4f 4d2e 4449 5354  fn.NEGBINOM.DIST
-00008720: 2827 2c20 666f 726d 756c 6129 0a0a 2020  (', formula)..  
-00008730: 2020 2020 2020 666f 726d 756c 6120 3d20        formula = 
-00008740: 7265 2e73 7562 2872 275c 6250 4552 4345  re.sub(r'\bPERCE
-00008750: 4e54 494c 452e 4558 435c 2827 2c0a 2020  NTILE.EXC\(',.  
-00008760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008770: 2020 2020 2020 2027 5f78 6c66 6e2e 5045         '_xlfn.PE
-00008780: 5243 454e 5449 4c45 2e45 5843 2827 2c20  RCENTILE.EXC(', 
-00008790: 666f 726d 756c 6129 0a20 2020 2020 2020  formula).       
-000087a0: 2066 6f72 6d75 6c61 203d 2072 652e 7375   formula = re.su
-000087b0: 6228 7227 5c62 5045 5243 454e 5449 4c45  b(r'\bPERCENTILE
-000087c0: 2e49 4e43 5c28 272c 0a20 2020 2020 2020  .INC\(',.       
-000087d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000087e0: 2020 275f 786c 666e 2e50 4552 4345 4e54    '_xlfn.PERCENT
-000087f0: 494c 452e 494e 4328 272c 2066 6f72 6d75  ILE.INC(', formu
-00008800: 6c61 290a 2020 2020 2020 2020 666f 726d  la).        form
-00008810: 756c 6120 3d20 7265 2e73 7562 2872 275c  ula = re.sub(r'\
-00008820: 6243 4549 4c49 4e47 2e50 5245 4349 5345  bCEILING.PRECISE
-00008830: 5c28 272c 0a20 2020 2020 2020 2020 2020  \(',.           
-00008840: 2020 2020 2020 2020 2020 2020 2020 275f                '_
-00008850: 786c 666e 2e43 4549 4c49 4e47 2e50 5245  xlfn.CEILING.PRE
-00008860: 4349 5345 2827 2c20 666f 726d 756c 6129  CISE(', formula)
-00008870: 0a20 2020 2020 2020 2066 6f72 6d75 6c61  .        formula
-00008880: 203d 2072 652e 7375 6228 7227 5c62 434f   = re.sub(r'\bCO
-00008890: 4e46 4944 454e 4345 2e4e 4f52 4d5c 2827  NFIDENCE.NORM\('
-000088a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000088b0: 2020 2020 2020 2020 2020 2027 5f78 6c66             '_xlf
-000088c0: 6e2e 434f 4e46 4944 454e 4345 2e4e 4f52  n.CONFIDENCE.NOR
-000088d0: 4d28 272c 2066 6f72 6d75 6c61 290a 2020  M(', formula).  
-000088e0: 2020 2020 2020 666f 726d 756c 6120 3d20        formula = 
-000088f0: 7265 2e73 7562 2872 275c 6246 4f52 4543  re.sub(r'\bFOREC
-00008900: 4153 542e 4c49 4e45 4152 5c28 272c 0a20  AST.LINEAR\(',. 
-00008910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008920: 2020 2020 2020 2020 275f 786c 666e 2e46          '_xlfn.F
-00008930: 4f52 4543 4153 542e 4c49 4e45 4152 2827  ORECAST.LINEAR('
-00008940: 2c20 666f 726d 756c 6129 0a20 2020 2020  , formula).     
-00008950: 2020 2066 6f72 6d75 6c61 203d 2072 652e     formula = re.
-00008960: 7375 6228 7227 5c62 4741 4d4d 414c 4e2e  sub(r'\bGAMMALN.
-00008970: 5052 4543 4953 455c 2827 2c0a 2020 2020  PRECISE\(',.    
-00008980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008990: 2020 2020 2027 5f78 6c66 6e2e 4741 4d4d       '_xlfn.GAMM
-000089a0: 414c 4e2e 5052 4543 4953 4528 272c 2066  ALN.PRECISE(', f
-000089b0: 6f72 6d75 6c61 290a 2020 2020 2020 2020  ormula).        
-000089c0: 666f 726d 756c 6120 3d20 7265 2e73 7562  formula = re.sub
-000089d0: 2872 275c 6250 4552 4345 4e54 5241 4e4b  (r'\bPERCENTRANK
-000089e0: 2e45 5843 5c28 272c 0a20 2020 2020 2020  .EXC\(',.       
-000089f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008a00: 2020 275f 786c 666e 2e50 4552 4345 4e54    '_xlfn.PERCENT
-00008a10: 5241 4e4b 2e45 5843 2827 2c20 666f 726d  RANK.EXC(', form
-00008a20: 756c 6129 0a20 2020 2020 2020 2066 6f72  ula).        for
-00008a30: 6d75 6c61 203d 2072 652e 7375 6228 7227  mula = re.sub(r'
-00008a40: 5c62 5045 5243 454e 5452 414e 4b2e 494e  \bPERCENTRANK.IN
-00008a50: 435c 2827 2c0a 2020 2020 2020 2020 2020  C\(',.          
-00008a60: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00008a70: 5f78 6c66 6e2e 5045 5243 454e 5452 414e  _xlfn.PERCENTRAN
-00008a80: 4b2e 494e 4328 272c 2066 6f72 6d75 6c61  K.INC(', formula
-00008a90: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
-00008aa0: 6120 3d20 7265 2e73 7562 2872 275c 6242  a = re.sub(r'\bB
-00008ab0: 494e 4f4d 2e44 4953 542e 5241 4e47 455c  INOM.DIST.RANGE\
-00008ac0: 2827 2c0a 2020 2020 2020 2020 2020 2020  (',.            
-00008ad0: 2020 2020 2020 2020 2020 2020 2027 5f78               '_x
-00008ae0: 6c66 6e2e 4249 4e4f 4d2e 4449 5354 2e52  lfn.BINOM.DIST.R
-00008af0: 414e 4745 2827 2c20 666f 726d 756c 6129  ANGE(', formula)
-00008b00: 0a20 2020 2020 2020 2066 6f72 6d75 6c61  .        formula
-00008b10: 203d 2072 652e 7375 6228 7227 5c62 464f   = re.sub(r'\bFO
-00008b20: 5245 4341 5354 2e45 5453 2e53 5441 545c  RECAST.ETS.STAT\
-00008b30: 2827 2c0a 2020 2020 2020 2020 2020 2020  (',.            
-00008b40: 2020 2020 2020 2020 2020 2020 2027 5f78               '_x
-00008b50: 6c66 6e2e 464f 5245 4341 5354 2e45 5453  lfn.FORECAST.ETS
-00008b60: 2e53 5441 5428 272c 2066 6f72 6d75 6c61  .STAT(', formula
-00008b70: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
-00008b80: 6120 3d20 7265 2e73 7562 2872 275c 6246  a = re.sub(r'\bF
-00008b90: 4f52 4543 4153 542e 4554 532e 434f 4e46  ORECAST.ETS.CONF
-00008ba0: 494e 545c 2827 2c0a 2020 2020 2020 2020  INT\(',.        
-00008bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008bc0: 2027 5f78 6c66 6e2e 464f 5245 4341 5354   '_xlfn.FORECAST
-00008bd0: 2e45 5453 2e43 4f4e 4649 4e54 2827 2c20  .ETS.CONFINT(', 
-00008be0: 666f 726d 756c 6129 0a20 2020 2020 2020  formula).       
-00008bf0: 2066 6f72 6d75 6c61 203d 2072 652e 7375   formula = re.su
-00008c00: 6228 7227 5c62 464f 5245 4341 5354 2e45  b(r'\bFORECAST.E
-00008c10: 5453 2e53 4541 534f 4e41 4c49 5459 5c28  TS.SEASONALITY\(
-00008c20: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-00008c30: 2020 2020 2020 2020 2020 2020 275f 786c              '_xl
-00008c40: 666e 2e46 4f52 4543 4153 542e 4554 532e  fn.FORECAST.ETS.
-00008c50: 5345 4153 4f4e 414c 4954 5928 272c 2066  SEASONALITY(', f
-00008c60: 6f72 6d75 6c61 290a 0a20 2020 2020 2020  ormula)..       
-00008c70: 2072 6574 7572 6e20 666f 726d 756c 610a   return formula.
-00008c80: 0a20 2020 2023 2055 6e64 6563 6f72 6174  .    # Undecorat
-00008c90: 6564 2076 6572 7369 6f6e 206f 6620 7772  ed version of wr
-00008ca0: 6974 655f 6172 7261 795f 666f 726d 756c  ite_array_formul
-00008cb0: 6128 2920 616e 640a 2020 2020 2320 7772  a() and.    # wr
-00008cc0: 6974 655f 6479 6e61 6d69 635f 6172 7261  ite_dynamic_arra
-00008cd0: 795f 666f 726d 756c 6128 292e 0a20 2020  y_formula()..   
-00008ce0: 2064 6566 205f 7772 6974 655f 6172 7261   def _write_arra
-00008cf0: 795f 666f 726d 756c 6128 7365 6c66 2c20  y_formula(self, 
-00008d00: 6669 7273 745f 726f 772c 2066 6972 7374  first_row, first
-00008d10: 5f63 6f6c 2c20 6c61 7374 5f72 6f77 2c20  _col, last_row, 
-00008d20: 6c61 7374 5f63 6f6c 2c0a 2020 2020 2020  last_col,.      
-00008d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008d40: 2020 2020 2020 2066 6f72 6d75 6c61 2c20         formula, 
-00008d50: 6365 6c6c 5f66 6f72 6d61 743d 4e6f 6e65  cell_format=None
-00008d60: 2c20 7661 6c75 653d 302c 0a20 2020 2020  , value=0,.     
-00008d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008d80: 2020 2020 2020 2020 6174 7970 653d 2773          atype='s
-00008d90: 7461 7469 6327 293a 0a0a 2020 2020 2020  tatic'):..      
-00008da0: 2020 2320 5377 6170 206c 6173 7420 726f    # Swap last ro
-00008db0: 772f 636f 6c20 7769 7468 2066 6972 7374  w/col with first
-00008dc0: 2072 6f77 2f63 6f6c 2061 7320 6e65 6365   row/col as nece
-00008dd0: 7373 6172 792e 0a20 2020 2020 2020 2069  ssary..        i
-00008de0: 6620 6669 7273 745f 726f 7720 3e20 6c61  f first_row > la
-00008df0: 7374 5f72 6f77 3a0a 2020 2020 2020 2020  st_row:.        
-00008e00: 2020 2020 6669 7273 745f 726f 772c 206c      first_row, l
-00008e10: 6173 745f 726f 7720 3d20 6c61 7374 5f72  ast_row = last_r
-00008e20: 6f77 2c20 6669 7273 745f 726f 770a 2020  ow, first_row.  
-00008e30: 2020 2020 2020 6966 2066 6972 7374 5f63        if first_c
-00008e40: 6f6c 203e 206c 6173 745f 636f 6c3a 0a20  ol > last_col:. 
-00008e50: 2020 2020 2020 2020 2020 2066 6972 7374             first
-00008e60: 5f63 6f6c 2c20 6c61 7374 5f63 6f6c 203d  _col, last_col =
-00008e70: 206c 6173 745f 636f 6c2c 2066 6972 7374   last_col, first
-00008e80: 5f63 6f6c 0a0a 2020 2020 2020 2020 2320  _col..        # 
-00008e90: 4368 6563 6b20 7468 6174 2072 6f77 2061  Check that row a
-00008ea0: 6e64 2063 6f6c 2061 7265 2076 616c 6964  nd col are valid
-00008eb0: 2061 6e64 2073 746f 7265 206d 6178 2061   and store max a
-00008ec0: 6e64 206d 696e 2076 616c 7565 732e 0a20  nd min values.. 
-00008ed0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-00008ee0: 6368 6563 6b5f 6469 6d65 6e73 696f 6e73  check_dimensions
-00008ef0: 2866 6972 7374 5f72 6f77 2c20 6669 7273  (first_row, firs
-00008f00: 745f 636f 6c29 3a0a 2020 2020 2020 2020  t_col):.        
-00008f10: 2020 2020 7265 7475 726e 202d 310a 2020      return -1.  
-00008f20: 2020 2020 2020 6966 2073 656c 662e 5f63        if self._c
-00008f30: 6865 636b 5f64 696d 656e 7369 6f6e 7328  heck_dimensions(
-00008f40: 6c61 7374 5f72 6f77 2c20 6c61 7374 5f63  last_row, last_c
-00008f50: 6f6c 293a 0a20 2020 2020 2020 2020 2020  ol):.           
-00008f60: 2072 6574 7572 6e20 2d31 0a0a 2020 2020   return -1..    
-00008f70: 2020 2020 2320 4465 6669 6e65 2061 7272      # Define arr
-00008f80: 6179 2072 616e 6765 0a20 2020 2020 2020  ay range.       
-00008f90: 2069 6620 6669 7273 745f 726f 7720 3d3d   if first_row ==
-00008fa0: 206c 6173 745f 726f 7720 616e 6420 6669   last_row and fi
-00008fb0: 7273 745f 636f 6c20 3d3d 206c 6173 745f  rst_col == last_
-00008fc0: 636f 6c3a 0a20 2020 2020 2020 2020 2020  col:.           
-00008fd0: 2063 656c 6c5f 7261 6e67 6520 3d20 786c   cell_range = xl
-00008fe0: 5f72 6f77 636f 6c5f 746f 5f63 656c 6c28  _rowcol_to_cell(
-00008ff0: 6669 7273 745f 726f 772c 2066 6972 7374  first_row, first
-00009000: 5f63 6f6c 290a 2020 2020 2020 2020 656c  _col).        el
-00009010: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00009020: 6365 6c6c 5f72 616e 6765 203d 2028 786c  cell_range = (xl
-00009030: 5f72 6f77 636f 6c5f 746f 5f63 656c 6c28  _rowcol_to_cell(
-00009040: 6669 7273 745f 726f 772c 2066 6972 7374  first_row, first
-00009050: 5f63 6f6c 2920 2b20 273a 270a 2020 2020  _col) + ':'.    
-00009060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009070: 2020 2020 2020 2b20 786c 5f72 6f77 636f        + xl_rowco
-00009080: 6c5f 746f 5f63 656c 6c28 6c61 7374 5f72  l_to_cell(last_r
-00009090: 6f77 2c20 6c61 7374 5f63 6f6c 2929 0a0a  ow, last_col))..
-000090a0: 2020 2020 2020 2020 2320 4d6f 6469 6679          # Modify
-000090b0: 2074 6865 2066 6f72 6d75 6c61 2073 7472   the formula str
-000090c0: 696e 672c 2061 7320 6e65 6564 6564 2e0a  ing, as needed..
-000090d0: 2020 2020 2020 2020 666f 726d 756c 6120          formula 
-000090e0: 3d20 7365 6c66 2e5f 7072 6570 6172 655f  = self._prepare_
-000090f0: 666f 726d 756c 6128 666f 726d 756c 6129  formula(formula)
-00009100: 0a0a 2020 2020 2020 2020 2320 5772 6974  ..        # Writ
-00009110: 6520 7072 6576 696f 7573 2072 6f77 2069  e previous row i
-00009120: 6620 696e 2069 6e2d 6c69 6e65 2073 7472  f in in-line str
-00009130: 696e 6720 636f 6e73 7461 6e74 5f6d 656d  ing constant_mem
-00009140: 6f72 7920 6d6f 6465 2e0a 2020 2020 2020  ory mode..      
-00009150: 2020 6966 2073 656c 662e 636f 6e73 7461    if self.consta
-00009160: 6e74 5f6d 656d 6f72 7920 616e 6420 6669  nt_memory and fi
-00009170: 7273 745f 726f 7720 3e20 7365 6c66 2e70  rst_row > self.p
-00009180: 7265 7669 6f75 735f 726f 773a 0a20 2020  revious_row:.   
-00009190: 2020 2020 2020 2020 2073 656c 662e 5f77           self._w
-000091a0: 7269 7465 5f73 696e 676c 655f 726f 7728  rite_single_row(
-000091b0: 6669 7273 745f 726f 7729 0a0a 2020 2020  first_row)..    
-000091c0: 2020 2020 2320 5374 6f72 6520 7468 6520      # Store the 
-000091d0: 6365 6c6c 2064 6174 6120 696e 2074 6865  cell data in the
-000091e0: 2077 6f72 6b73 6865 6574 2064 6174 6120   worksheet data 
-000091f0: 7461 626c 652e 0a20 2020 2020 2020 2073  table..        s
-00009200: 656c 662e 7461 626c 655b 6669 7273 745f  elf.table[first_
-00009210: 726f 775d 5b66 6972 7374 5f63 6f6c 5d20  row][first_col] 
-00009220: 3d20 6365 6c6c 5f61 7266 6f72 6d75 6c61  = cell_arformula
-00009230: 5f74 7570 6c65 2866 6f72 6d75 6c61 2c0a  _tuple(formula,.
-00009240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009280: 6365 6c6c 5f66 6f72 6d61 742c 0a20 2020  cell_format,.   
-00009290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000092a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000092b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000092c0: 2020 2020 2020 2020 2020 2020 2076 616c               val
-000092d0: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
-000092e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000092f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009310: 2020 2020 6365 6c6c 5f72 616e 6765 2c0a      cell_range,.
-00009320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009360: 6174 7970 6529 0a0a 2020 2020 2020 2020  atype)..        
-00009370: 2320 5061 6420 6f75 7420 7468 6520 7265  # Pad out the re
-00009380: 7374 206f 6620 7468 6520 6172 6561 2077  st of the area w
-00009390: 6974 6820 666f 726d 6174 7465 6420 7a65  ith formatted ze
-000093a0: 726f 6573 2e0a 2020 2020 2020 2020 6966  roes..        if
-000093b0: 206e 6f74 2073 656c 662e 636f 6e73 7461   not self.consta
-000093c0: 6e74 5f6d 656d 6f72 793a 0a20 2020 2020  nt_memory:.     
-000093d0: 2020 2020 2020 2066 6f72 2072 6f77 2069         for row i
-000093e0: 6e20 7261 6e67 6528 6669 7273 745f 726f  n range(first_ro
-000093f0: 772c 206c 6173 745f 726f 7720 2b20 3129  w, last_row + 1)
-00009400: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00009410: 2020 666f 7220 636f 6c20 696e 2072 616e    for col in ran
-00009420: 6765 2866 6972 7374 5f63 6f6c 2c20 6c61  ge(first_col, la
-00009430: 7374 5f63 6f6c 202b 2031 293a 0a20 2020  st_col + 1):.   
-00009440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009450: 2069 6620 726f 7720 213d 2066 6972 7374   if row != first
-00009460: 5f72 6f77 206f 7220 636f 6c20 213d 2066  _row or col != f
-00009470: 6972 7374 5f63 6f6c 3a0a 2020 2020 2020  irst_col:.      
-00009480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009490: 2020 7365 6c66 2e5f 7772 6974 655f 6e75    self._write_nu
-000094a0: 6d62 6572 2872 6f77 2c20 636f 6c2c 2030  mber(row, col, 0
-000094b0: 2c20 6365 6c6c 5f66 6f72 6d61 7429 0a0a  , cell_format)..
-000094c0: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
-000094d0: 0a0a 2020 2020 4063 6f6e 7665 7274 5f63  ..    @convert_c
-000094e0: 656c 6c5f 6172 6773 0a20 2020 2064 6566  ell_args.    def
-000094f0: 2077 7269 7465 5f64 6174 6574 696d 6528   write_datetime(
-00009500: 7365 6c66 2c20 726f 772c 2063 6f6c 2c20  self, row, col, 
-00009510: 6461 7465 2c20 6365 6c6c 5f66 6f72 6d61  date, cell_forma
-00009520: 743d 4e6f 6e65 293a 0a20 2020 2020 2020  t=None):.       
-00009530: 2022 2222 0a20 2020 2020 2020 2057 7269   """.        Wri
-00009540: 7465 2061 2064 6174 6520 6f72 2074 696d  te a date or tim
-00009550: 6520 746f 2061 2077 6f72 6b73 6865 6574  e to a worksheet
-00009560: 2063 656c 6c2e 0a0a 2020 2020 2020 2020   cell...        
-00009570: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
-00009580: 2020 726f 773a 2020 2020 2020 2020 2054    row:         T
-00009590: 6865 2063 656c 6c20 726f 7720 287a 6572  he cell row (zer
-000095a0: 6f20 696e 6465 7865 6429 2e0a 2020 2020  o indexed)..    
-000095b0: 2020 2020 2020 2020 636f 6c3a 2020 2020          col:    
-000095c0: 2020 2020 2054 6865 2063 656c 6c20 636f       The cell co
-000095d0: 6c75 6d6e 2028 7a65 726f 2069 6e64 6578  lumn (zero index
-000095e0: 6564 292e 0a20 2020 2020 2020 2020 2020  ed)..           
-000095f0: 2064 6174 653a 2020 2020 2020 2020 4461   date:        Da
-00009600: 7465 2061 6e64 2f6f 7220 7469 6d65 2061  te and/or time a
-00009610: 7320 6120 6461 7465 7469 6d65 206f 626a  s a datetime obj
-00009620: 6563 742e 0a20 2020 2020 2020 2020 2020  ect..           
-00009630: 2063 656c 6c5f 666f 726d 6174 3a20 4120   cell_format: A 
-00009640: 6365 6c6c 2046 6f72 6d61 7420 6f62 6a65  cell Format obje
-00009650: 6374 2e0a 0a20 2020 2020 2020 2052 6574  ct...        Ret
-00009660: 7572 6e73 3a0a 2020 2020 2020 2020 2020  urns:.          
-00009670: 2020 303a 2020 5375 6363 6573 732e 0a20    0:  Success.. 
-00009680: 2020 2020 2020 2020 2020 202d 313a 2052             -1: R
-00009690: 6f77 206f 7220 636f 6c75 6d6e 2069 7320  ow or column is 
-000096a0: 6f75 7420 6f66 2077 6f72 6b73 6865 6574  out of worksheet
-000096b0: 2062 6f75 6e64 732e 0a0a 2020 2020 2020   bounds...      
-000096c0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-000096d0: 7475 726e 2073 656c 662e 5f77 7269 7465  turn self._write
-000096e0: 5f64 6174 6574 696d 6528 726f 772c 2063  _datetime(row, c
-000096f0: 6f6c 2c20 6461 7465 2c20 6365 6c6c 5f66  ol, date, cell_f
-00009700: 6f72 6d61 7429 0a0a 2020 2020 2320 556e  ormat)..    # Un
-00009710: 6465 636f 7261 7465 6420 7665 7273 696f  decorated versio
-00009720: 6e20 6f66 2077 7269 7465 5f64 6174 6574  n of write_datet
-00009730: 696d 6528 292e 0a20 2020 2064 6566 205f  ime()..    def _
-00009740: 7772 6974 655f 6461 7465 7469 6d65 2873  write_datetime(s
-00009750: 656c 662c 2072 6f77 2c20 636f 6c2c 2064  elf, row, col, d
-00009760: 6174 652c 2063 656c 6c5f 666f 726d 6174  ate, cell_format
-00009770: 3d4e 6f6e 6529 3a0a 0a20 2020 2020 2020  =None):..       
-00009780: 2023 2043 6865 636b 2074 6861 7420 726f   # Check that ro
-00009790: 7720 616e 6420 636f 6c20 6172 6520 7661  w and col are va
-000097a0: 6c69 6420 616e 6420 7374 6f72 6520 6d61  lid and store ma
-000097b0: 7820 616e 6420 6d69 6e20 7661 6c75 6573  x and min values
-000097c0: 2e0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-000097d0: 662e 5f63 6865 636b 5f64 696d 656e 7369  f._check_dimensi
-000097e0: 6f6e 7328 726f 772c 2063 6f6c 293a 0a20  ons(row, col):. 
-000097f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00009800: 6e20 2d31 0a0a 2020 2020 2020 2020 2320  n -1..        # 
-00009810: 5772 6974 6520 7072 6576 696f 7573 2072  Write previous r
-00009820: 6f77 2069 6620 696e 2069 6e2d 6c69 6e65  ow if in in-line
-00009830: 2073 7472 696e 6720 636f 6e73 7461 6e74   string constant
-00009840: 5f6d 656d 6f72 7920 6d6f 6465 2e0a 2020  _memory mode..  
-00009850: 2020 2020 2020 6966 2073 656c 662e 636f        if self.co
-00009860: 6e73 7461 6e74 5f6d 656d 6f72 7920 616e  nstant_memory an
-00009870: 6420 726f 7720 3e20 7365 6c66 2e70 7265  d row > self.pre
-00009880: 7669 6f75 735f 726f 773a 0a20 2020 2020  vious_row:.     
-00009890: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
-000098a0: 7465 5f73 696e 676c 655f 726f 7728 726f  te_single_row(ro
-000098b0: 7729 0a0a 2020 2020 2020 2020 2320 436f  w)..        # Co
-000098c0: 6e76 6572 7420 6461 7465 7469 6d65 2074  nvert datetime t
-000098d0: 6f20 616e 2045 7863 656c 2064 6174 652e  o an Excel date.
-000098e0: 0a20 2020 2020 2020 206e 756d 6265 7220  .        number 
-000098f0: 3d20 7365 6c66 2e5f 636f 6e76 6572 745f  = self._convert_
-00009900: 6461 7465 5f74 696d 6528 6461 7465 290a  date_time(date).
-00009910: 0a20 2020 2020 2020 2023 2041 6464 2074  .        # Add t
-00009920: 6865 2064 6566 6175 6c74 2064 6174 6520  he default date 
-00009930: 666f 726d 6174 2e0a 2020 2020 2020 2020  format..        
-00009940: 6966 2063 656c 6c5f 666f 726d 6174 2069  if cell_format i
-00009950: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00009960: 2020 2020 6365 6c6c 5f66 6f72 6d61 7420      cell_format 
-00009970: 3d20 7365 6c66 2e64 6566 6175 6c74 5f64  = self.default_d
-00009980: 6174 655f 666f 726d 6174 0a0a 2020 2020  ate_format..    
-00009990: 2020 2020 2320 5374 6f72 6520 7468 6520      # Store the 
-000099a0: 6365 6c6c 2064 6174 6120 696e 2074 6865  cell data in the
-000099b0: 2077 6f72 6b73 6865 6574 2064 6174 6120   worksheet data 
-000099c0: 7461 626c 652e 0a20 2020 2020 2020 2073  table..        s
-000099d0: 656c 662e 7461 626c 655b 726f 775d 5b63  elf.table[row][c
-000099e0: 6f6c 5d20 3d20 6365 6c6c 5f64 6174 6574  ol] = cell_datet
-000099f0: 696d 655f 7475 706c 6528 6e75 6d62 6572  ime_tuple(number
-00009a00: 2c20 6365 6c6c 5f66 6f72 6d61 7429 0a0a  , cell_format)..
-00009a10: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
-00009a20: 0a0a 2020 2020 4063 6f6e 7665 7274 5f63  ..    @convert_c
-00009a30: 656c 6c5f 6172 6773 0a20 2020 2064 6566  ell_args.    def
-00009a40: 2077 7269 7465 5f62 6f6f 6c65 616e 2873   write_boolean(s
-00009a50: 656c 662c 2072 6f77 2c20 636f 6c2c 2062  elf, row, col, b
-00009a60: 6f6f 6c65 616e 2c20 6365 6c6c 5f66 6f72  oolean, cell_for
-00009a70: 6d61 743d 4e6f 6e65 293a 0a20 2020 2020  mat=None):.     
-00009a80: 2020 2022 2222 0a20 2020 2020 2020 2057     """.        W
-00009a90: 7269 7465 2061 2062 6f6f 6c65 616e 2076  rite a boolean v
-00009aa0: 616c 7565 2074 6f20 6120 776f 726b 7368  alue to a worksh
-00009ab0: 6565 7420 6365 6c6c 2e0a 0a20 2020 2020  eet cell...     
-00009ac0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-00009ad0: 2020 2020 2072 6f77 3a20 2020 2020 2020       row:       
-00009ae0: 2020 5468 6520 6365 6c6c 2072 6f77 2028    The cell row (
-00009af0: 7a65 726f 2069 6e64 6578 6564 292e 0a20  zero indexed).. 
-00009b00: 2020 2020 2020 2020 2020 2063 6f6c 3a20             col: 
-00009b10: 2020 2020 2020 2020 5468 6520 6365 6c6c          The cell
-00009b20: 2063 6f6c 756d 6e20 287a 6572 6f20 696e   column (zero in
-00009b30: 6465 7865 6429 2e0a 2020 2020 2020 2020  dexed)..        
-00009b40: 2020 2020 626f 6f6c 6561 6e3a 2020 2020      boolean:    
-00009b50: 2043 656c 6c20 6461 7461 2e20 626f 6f6c   Cell data. bool
-00009b60: 2074 7970 652e 0a20 2020 2020 2020 2020   type..         
-00009b70: 2020 2063 656c 6c5f 666f 726d 6174 3a20     cell_format: 
-00009b80: 416e 206f 7074 696f 6e61 6c20 6365 6c6c  An optional cell
-00009b90: 2046 6f72 6d61 7420 6f62 6a65 6374 2e0a   Format object..
-00009ba0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00009bb0: 3a0a 2020 2020 2020 2020 2020 2020 303a  :.            0:
-00009bc0: 2020 5375 6363 6573 732e 0a20 2020 2020    Success..     
-00009bd0: 2020 2020 2020 202d 313a 2052 6f77 206f         -1: Row o
-00009be0: 7220 636f 6c75 6d6e 2069 7320 6f75 7420  r column is out 
-00009bf0: 6f66 2077 6f72 6b73 6865 6574 2062 6f75  of worksheet bou
-00009c00: 6e64 732e 0a0a 2020 2020 2020 2020 2222  nds...        ""
-00009c10: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-00009c20: 2073 656c 662e 5f77 7269 7465 5f62 6f6f   self._write_boo
-00009c30: 6c65 616e 2872 6f77 2c20 636f 6c2c 2062  lean(row, col, b
-00009c40: 6f6f 6c65 616e 2c20 6365 6c6c 5f66 6f72  oolean, cell_for
-00009c50: 6d61 7429 0a0a 2020 2020 2320 556e 6465  mat)..    # Unde
-00009c60: 636f 7261 7465 6420 7665 7273 696f 6e20  corated version 
-00009c70: 6f66 2077 7269 7465 5f62 6f6f 6c65 616e  of write_boolean
-00009c80: 2829 2e0a 2020 2020 6465 6620 5f77 7269  ()..    def _wri
-00009c90: 7465 5f62 6f6f 6c65 616e 2873 656c 662c  te_boolean(self,
-00009ca0: 2072 6f77 2c20 636f 6c2c 2062 6f6f 6c65   row, col, boole
-00009cb0: 616e 2c20 6365 6c6c 5f66 6f72 6d61 743d  an, cell_format=
-00009cc0: 4e6f 6e65 293a 0a0a 2020 2020 2020 2020  None):..        
-00009cd0: 2320 4368 6563 6b20 7468 6174 2072 6f77  # Check that row
-00009ce0: 2061 6e64 2063 6f6c 2061 7265 2076 616c   and col are val
-00009cf0: 6964 2061 6e64 2073 746f 7265 206d 6178  id and store max
-00009d00: 2061 6e64 206d 696e 2076 616c 7565 732e   and min values.
-00009d10: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00009d20: 2e5f 6368 6563 6b5f 6469 6d65 6e73 696f  ._check_dimensio
-00009d30: 6e73 2872 6f77 2c20 636f 6c29 3a0a 2020  ns(row, col):.  
-00009d40: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00009d50: 202d 310a 0a20 2020 2020 2020 2023 2057   -1..        # W
-00009d60: 7269 7465 2070 7265 7669 6f75 7320 726f  rite previous ro
-00009d70: 7720 6966 2069 6e20 696e 2d6c 696e 6520  w if in in-line 
-00009d80: 7374 7269 6e67 2063 6f6e 7374 616e 745f  string constant_
-00009d90: 6d65 6d6f 7279 206d 6f64 652e 0a20 2020  memory mode..   
-00009da0: 2020 2020 2069 6620 7365 6c66 2e63 6f6e       if self.con
-00009db0: 7374 616e 745f 6d65 6d6f 7279 2061 6e64  stant_memory and
-00009dc0: 2072 6f77 203e 2073 656c 662e 7072 6576   row > self.prev
-00009dd0: 696f 7573 5f72 6f77 3a0a 2020 2020 2020  ious_row:.      
-00009de0: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
-00009df0: 655f 7369 6e67 6c65 5f72 6f77 2872 6f77  e_single_row(row
-00009e00: 290a 0a20 2020 2020 2020 2069 6620 626f  )..        if bo
-00009e10: 6f6c 6561 6e3a 0a20 2020 2020 2020 2020  olean:.         
-00009e20: 2020 2076 616c 7565 203d 2031 0a20 2020     value = 1.   
-00009e30: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00009e40: 2020 2020 2020 2076 616c 7565 203d 2030         value = 0
-00009e50: 0a0a 2020 2020 2020 2020 2320 5374 6f72  ..        # Stor
-00009e60: 6520 7468 6520 6365 6c6c 2064 6174 6120  e the cell data 
-00009e70: 696e 2074 6865 2077 6f72 6b73 6865 6574  in the worksheet
-00009e80: 2064 6174 6120 7461 626c 652e 0a20 2020   data table..   
-00009e90: 2020 2020 2073 656c 662e 7461 626c 655b       self.table[
-00009ea0: 726f 775d 5b63 6f6c 5d20 3d20 6365 6c6c  row][col] = cell
-00009eb0: 5f62 6f6f 6c65 616e 5f74 7570 6c65 2876  _boolean_tuple(v
-00009ec0: 616c 7565 2c20 6365 6c6c 5f66 6f72 6d61  alue, cell_forma
-00009ed0: 7429 0a0a 2020 2020 2020 2020 7265 7475  t)..        retu
-00009ee0: 726e 2030 0a0a 2020 2020 2320 5772 6974  rn 0..    # Writ
-00009ef0: 6520 6120 6879 7065 726c 696e 6b2e 2054  e a hyperlink. T
-00009f00: 6869 7320 6973 2063 6f6d 7072 6973 6564  his is comprised
-00009f10: 206f 6620 7477 6f20 656c 656d 656e 7473   of two elements
-00009f20: 3a20 7468 6520 6469 7370 6c61 7965 640a  : the displayed.
-00009f30: 2020 2020 2320 7374 7269 6e67 2061 6e64      # string and
-00009f40: 2074 6865 206e 6f6e 2d64 6973 706c 6179   the non-display
-00009f50: 6564 206c 696e 6b2e 2054 6865 2064 6973  ed link. The dis
-00009f60: 706c 6179 6564 2073 7472 696e 6720 6973  played string is
-00009f70: 2074 6865 2073 616d 6520 6173 0a20 2020   the same as.   
-00009f80: 2023 2074 6865 206c 696e 6b20 756e 6c65   # the link unle
-00009f90: 7373 2061 6e20 616c 7465 726e 6174 6976  ss an alternativ
-00009fa0: 6520 7374 7269 6e67 2069 7320 7370 6563  e string is spec
-00009fb0: 6966 6965 642e 2054 6865 2064 6973 706c  ified. The displ
-00009fc0: 6179 2073 7472 696e 670a 2020 2020 2320  ay string.    # 
-00009fd0: 6973 2077 7269 7474 656e 2075 7369 6e67  is written using
-00009fe0: 2074 6865 2077 7269 7465 5f73 7472 696e   the write_strin
-00009ff0: 6728 2920 6d65 7468 6f64 2e20 5468 6572  g() method. Ther
-0000a000: 6566 6f72 6520 7468 6520 6d61 7820 6368  efore the max ch
-0000a010: 6172 6163 7465 7273 0a20 2020 2023 2073  aracters.    # s
-0000a020: 7472 696e 6720 6c69 6d69 7420 6170 706c  tring limit appl
-0000a030: 6965 732e 0a20 2020 2023 0a20 2020 2023  ies..    #.    #
-0000a040: 2054 6865 2068 7970 6572 6c69 6e6b 2063   The hyperlink c
-0000a050: 616e 2062 6520 746f 2061 2068 7474 702c  an be to a http,
-0000a060: 2066 7470 2c20 6d61 696c 2c20 696e 7465   ftp, mail, inte
-0000a070: 726e 616c 2073 6865 6574 2c20 6f72 2065  rnal sheet, or e
-0000a080: 7874 6572 6e61 6c0a 2020 2020 2320 6469  xternal.    # di
-0000a090: 7265 6374 6f72 7920 7572 6c73 2e0a 2020  rectory urls..  
-0000a0a0: 2020 4063 6f6e 7665 7274 5f63 656c 6c5f    @convert_cell_
-0000a0b0: 6172 6773 0a20 2020 2064 6566 2077 7269  args.    def wri
-0000a0c0: 7465 5f75 726c 2873 656c 662c 2072 6f77  te_url(self, row
-0000a0d0: 2c20 636f 6c2c 2075 726c 2c20 6365 6c6c  , col, url, cell
-0000a0e0: 5f66 6f72 6d61 743d 4e6f 6e65 2c0a 2020  _format=None,.  
-0000a0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a100: 7374 7269 6e67 3d4e 6f6e 652c 2074 6970  string=None, tip
-0000a110: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-0000a120: 2222 220a 2020 2020 2020 2020 5772 6974  """.        Writ
-0000a130: 6520 6120 6879 7065 726c 696e 6b20 746f  e a hyperlink to
-0000a140: 2061 2077 6f72 6b73 6865 6574 2063 656c   a worksheet cel
-0000a150: 6c2e 0a0a 2020 2020 2020 2020 4172 6773  l...        Args
-0000a160: 3a0a 2020 2020 2020 2020 2020 2020 726f  :.            ro
-0000a170: 773a 2020 2020 5468 6520 6365 6c6c 2072  w:    The cell r
-0000a180: 6f77 2028 7a65 726f 2069 6e64 6578 6564  ow (zero indexed
-0000a190: 292e 0a20 2020 2020 2020 2020 2020 2063  )..            c
-0000a1a0: 6f6c 3a20 2020 2054 6865 2063 656c 6c20  ol:    The cell 
-0000a1b0: 636f 6c75 6d6e 2028 7a65 726f 2069 6e64  column (zero ind
-0000a1c0: 6578 6564 292e 0a20 2020 2020 2020 2020  exed)..         
-0000a1d0: 2020 2075 726c 3a20 2020 2048 7970 6572     url:    Hyper
-0000a1e0: 6c69 6e6b 2075 726c 2e0a 2020 2020 2020  link url..      
-0000a1f0: 2020 2020 2020 666f 726d 6174 3a20 416e        format: An
-0000a200: 206f 7074 696f 6e61 6c20 6365 6c6c 2046   optional cell F
-0000a210: 6f72 6d61 7420 6f62 6a65 6374 2e0a 2020  ormat object..  
-0000a220: 2020 2020 2020 2020 2020 7374 7269 6e67            string
-0000a230: 3a20 416e 206f 7074 696f 6e61 6c20 6469  : An optional di
-0000a240: 7370 6c61 7920 7374 7269 6e67 2066 6f72  splay string for
-0000a250: 2074 6865 2068 7970 6572 6c69 6e6b 2e0a   the hyperlink..
-0000a260: 2020 2020 2020 2020 2020 2020 7469 703a              tip:
-0000a270: 2020 2020 416e 206f 7074 696f 6e61 6c20      An optional 
-0000a280: 746f 6f6c 7469 702e 0a20 2020 2020 2020  tooltip..       
-0000a290: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
-0000a2a0: 2020 2020 2020 303a 2020 5375 6363 6573        0:  Succes
-0000a2b0: 732e 0a20 2020 2020 2020 2020 2020 202d  s..            -
-0000a2c0: 313a 2052 6f77 206f 7220 636f 6c75 6d6e  1: Row or column
-0000a2d0: 2069 7320 6f75 7420 6f66 2077 6f72 6b73   is out of works
-0000a2e0: 6865 6574 2062 6f75 6e64 732e 0a20 2020  heet bounds..   
-0000a2f0: 2020 2020 2020 2020 202d 323a 2053 7472           -2: Str
-0000a300: 696e 6720 6c6f 6e67 6572 2074 6861 6e20  ing longer than 
-0000a310: 3332 3736 3720 6368 6172 6163 7465 7273  32767 characters
-0000a320: 2e0a 2020 2020 2020 2020 2020 2020 2d33  ..            -3
-0000a330: 3a20 5552 4c20 6c6f 6e67 6572 2074 6861  : URL longer tha
-0000a340: 6e20 4578 6365 6c20 6c69 6d69 7420 6f66  n Excel limit of
-0000a350: 2032 3535 2063 6861 7261 6374 6572 732e   255 characters.
-0000a360: 0a20 2020 2020 2020 2020 2020 202d 343a  .            -4:
-0000a370: 2045 7863 6565 6473 2045 7863 656c 206c   Exceeds Excel l
-0000a380: 696d 6974 206f 6620 3635 2c35 3330 2075  imit of 65,530 u
-0000a390: 726c 7320 7065 7220 776f 726b 7368 6565  rls per workshee
-0000a3a0: 742e 0a20 2020 2020 2020 2022 2222 0a20  t..        """. 
-0000a3b0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000a3c0: 6c66 2e5f 7772 6974 655f 7572 6c28 726f  lf._write_url(ro
-0000a3d0: 772c 2063 6f6c 2c20 7572 6c2c 2063 656c  w, col, url, cel
-0000a3e0: 6c5f 666f 726d 6174 2c20 7374 7269 6e67  l_format, string
-0000a3f0: 2c20 7469 7029 0a0a 2020 2020 2320 556e  , tip)..    # Un
-0000a400: 6465 636f 7261 7465 6420 7665 7273 696f  decorated versio
-0000a410: 6e20 6f66 2077 7269 7465 5f75 726c 2829  n of write_url()
-0000a420: 2e0a 2020 2020 6465 6620 5f77 7269 7465  ..    def _write
-0000a430: 5f75 726c 2873 656c 662c 2072 6f77 2c20  _url(self, row, 
-0000a440: 636f 6c2c 2075 726c 2c20 6365 6c6c 5f66  col, url, cell_f
-0000a450: 6f72 6d61 743d 4e6f 6e65 2c0a 2020 2020  ormat=None,.    
-0000a460: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000a470: 7472 696e 673d 4e6f 6e65 2c20 7469 703d  tring=None, tip=
-0000a480: 4e6f 6e65 293a 0a0a 2020 2020 2020 2020  None):..        
-0000a490: 2320 4368 6563 6b20 7468 6174 2072 6f77  # Check that row
-0000a4a0: 2061 6e64 2063 6f6c 2061 7265 2076 616c   and col are val
-0000a4b0: 6964 2061 6e64 2073 746f 7265 206d 6178  id and store max
-0000a4c0: 2061 6e64 206d 696e 2076 616c 7565 730a   and min values.
-0000a4d0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0000a4e0: 5f63 6865 636b 5f64 696d 656e 7369 6f6e  _check_dimension
-0000a4f0: 7328 726f 772c 2063 6f6c 293a 0a20 2020  s(row, col):.   
-0000a500: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000a510: 2d31 0a0a 2020 2020 2020 2020 2320 5365  -1..        # Se
-0000a520: 7420 7468 6520 6469 7370 6c61 7965 6420  t the displayed 
-0000a530: 7374 7269 6e67 2074 6f20 7468 6520 5552  string to the UR
-0000a540: 4c20 756e 6c65 7373 2064 6566 696e 6564  L unless defined
-0000a550: 2062 7920 7468 6520 7573 6572 2e0a 2020   by the user..  
-0000a560: 2020 2020 2020 6966 2073 7472 696e 6720        if string 
-0000a570: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-0000a580: 2020 2020 2073 7472 696e 6720 3d20 7572       string = ur
-0000a590: 6c0a 0a20 2020 2020 2020 2023 2044 6566  l..        # Def
-0000a5a0: 6175 6c74 2074 6f20 6578 7465 726e 616c  ault to external
-0000a5b0: 206c 696e 6b20 7479 7065 2073 7563 6820   link type such 
-0000a5c0: 6173 2027 6874 7470 3a2f 2f27 206f 7220  as 'http://' or 
-0000a5d0: 2765 7874 6572 6e61 6c3a 272e 0a20 2020  'external:'..   
-0000a5e0: 2020 2020 206c 696e 6b5f 7479 7065 203d       link_type =
-0000a5f0: 2031 0a0a 2020 2020 2020 2020 2320 5265   1..        # Re
-0000a600: 6d6f 7665 2074 6865 2055 5249 2073 6368  move the URI sch
-0000a610: 656d 6520 6672 6f6d 2069 6e74 6572 6e61  eme from interna
-0000a620: 6c20 6c69 6e6b 732e 0a20 2020 2020 2020  l links..       
-0000a630: 2069 6620 7572 6c2e 7374 6172 7473 7769   if url.startswi
-0000a640: 7468 2827 696e 7465 726e 616c 3a27 293a  th('internal:'):
-0000a650: 0a20 2020 2020 2020 2020 2020 2075 726c  .            url
-0000a660: 203d 2075 726c 2e72 6570 6c61 6365 2827   = url.replace('
-0000a670: 696e 7465 726e 616c 3a27 2c20 2727 290a  internal:', '').
-0000a680: 2020 2020 2020 2020 2020 2020 7374 7269              stri
-0000a690: 6e67 203d 2073 7472 696e 672e 7265 706c  ng = string.repl
-0000a6a0: 6163 6528 2769 6e74 6572 6e61 6c3a 272c  ace('internal:',
-0000a6b0: 2027 2729 0a20 2020 2020 2020 2020 2020   '').           
-0000a6c0: 206c 696e 6b5f 7479 7065 203d 2032 0a0a   link_type = 2..
-0000a6d0: 2020 2020 2020 2020 2320 5265 6d6f 7665          # Remove
-0000a6e0: 2074 6865 2055 5249 2073 6368 656d 6520   the URI scheme 
-0000a6f0: 6672 6f6d 2065 7874 6572 6e61 6c20 6c69  from external li
-0000a700: 6e6b 7320 616e 6420 6368 616e 6765 2074  nks and change t
-0000a710: 6865 2064 6972 6563 746f 7279 0a20 2020  he directory.   
-0000a720: 2020 2020 2023 2073 6570 6172 6174 6f72       # separator
-0000a730: 2066 726f 6d20 556e 6978 2074 6f20 446f   from Unix to Do
-0000a740: 732e 0a20 2020 2020 2020 2065 7874 6572  s..        exter
-0000a750: 6e61 6c20 3d20 4661 6c73 650a 2020 2020  nal = False.    
-0000a760: 2020 2020 6966 2075 726c 2e73 7461 7274      if url.start
-0000a770: 7377 6974 6828 2765 7874 6572 6e61 6c3a  swith('external:
-0000a780: 2729 3a0a 2020 2020 2020 2020 2020 2020  '):.            
-0000a790: 7572 6c20 3d20 7572 6c2e 7265 706c 6163  url = url.replac
-0000a7a0: 6528 2765 7874 6572 6e61 6c3a 272c 2027  e('external:', '
-0000a7b0: 2729 0a20 2020 2020 2020 2020 2020 2075  ').            u
-0000a7c0: 726c 203d 2075 726c 2e72 6570 6c61 6365  rl = url.replace
-0000a7d0: 2827 2f27 2c20 275c 5c27 290a 2020 2020  ('/', '\\').    
-0000a7e0: 2020 2020 2020 2020 7374 7269 6e67 203d          string =
-0000a7f0: 2073 7472 696e 672e 7265 706c 6163 6528   string.replace(
-0000a800: 2765 7874 6572 6e61 6c3a 272c 2027 2729  'external:', '')
-0000a810: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
-0000a820: 696e 6720 3d20 7374 7269 6e67 2e72 6570  ing = string.rep
-0000a830: 6c61 6365 2827 2f27 2c20 275c 5c27 290a  lace('/', '\\').
-0000a840: 2020 2020 2020 2020 2020 2020 6578 7465              exte
-0000a850: 726e 616c 203d 2054 7275 650a 0a20 2020  rnal = True..   
-0000a860: 2020 2020 2023 2053 7472 6970 2074 6865       # Strip the
-0000a870: 206d 6169 6c74 6f20 6865 6164 6572 2e0a   mailto header..
-0000a880: 2020 2020 2020 2020 7374 7269 6e67 203d          string =
-0000a890: 2073 7472 696e 672e 7265 706c 6163 6528   string.replace(
-0000a8a0: 276d 6169 6c74 6f3a 272c 2027 2729 0a0a  'mailto:', '')..
-0000a8b0: 2020 2020 2020 2020 2320 4368 6563 6b20          # Check 
-0000a8c0: 7468 6174 2074 6865 2073 7472 696e 6720  that the string 
-0000a8d0: 6973 203c 2033 3237 3637 2063 6861 7273  is < 32767 chars
-0000a8e0: 0a20 2020 2020 2020 2073 7472 5f65 7272  .        str_err
-0000a8f0: 6f72 203d 2030 0a20 2020 2020 2020 2069  or = 0.        i
-0000a900: 6620 6c65 6e28 7374 7269 6e67 2920 3e20  f len(string) > 
-0000a910: 7365 6c66 2e78 6c73 5f73 7472 6d61 783a  self.xls_strmax:
-0000a920: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
-0000a930: 6e28 2249 676e 6f72 696e 6720 5552 4c20  n("Ignoring URL 
-0000a940: 7369 6e63 6520 6974 2065 7863 6565 6473  since it exceeds
-0000a950: 2045 7863 656c 2773 2073 7472 696e 6720   Excel's string 
-0000a960: 6c69 6d69 7420 6f66 2022 0a20 2020 2020  limit of ".     
-0000a970: 2020 2020 2020 2020 2020 2020 2233 3237              "327
-0000a980: 3637 2063 6861 7261 6374 6572 7322 290a  67 characters").
-0000a990: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000a9a0: 726e 202d 320a 0a20 2020 2020 2020 2023  rn -2..        #
-0000a9b0: 2043 6f70 7920 7374 7269 6e67 2066 6f72   Copy string for
-0000a9c0: 2075 7365 2069 6e20 6879 7065 726c 696e   use in hyperlin
-0000a9d0: 6b20 656c 656d 656e 7473 2e0a 2020 2020  k elements..    
-0000a9e0: 2020 2020 7572 6c5f 7374 7220 3d20 7374      url_str = st
-0000a9f0: 7269 6e67 0a0a 2020 2020 2020 2020 2320  ring..        # 
-0000aa00: 4578 7465 726e 616c 206c 696e 6b73 2074  External links t
-0000aa10: 6f20 5552 4c73 2061 6e64 2074 6f20 6f74  o URLs and to ot
-0000aa20: 6865 7220 4578 6365 6c20 776f 726b 626f  her Excel workbo
-0000aa30: 6f6b 7320 6861 7665 2073 6c69 6768 746c  oks have slightl
-0000aa40: 790a 2020 2020 2020 2020 2320 6469 6666  y.        # diff
-0000aa50: 6572 656e 7420 6368 6172 6163 7465 7269  erent characteri
-0000aa60: 7374 6963 7320 7468 6174 2077 6520 6861  stics that we ha
-0000aa70: 7665 2074 6f20 6163 636f 756e 7420 666f  ve to account fo
-0000aa80: 722e 0a20 2020 2020 2020 2069 6620 6c69  r..        if li
-0000aa90: 6e6b 5f74 7970 6520 3d3d 2031 3a0a 0a20  nk_type == 1:.. 
-0000aaa0: 2020 2020 2020 2020 2020 2023 2053 706c             # Spl
-0000aab0: 6974 2075 726c 2069 6e74 6f20 7468 6520  it url into the 
-0000aac0: 6c69 6e6b 2061 6e64 206f 7074 696f 6e61  link and optiona
-0000aad0: 6c20 616e 6368 6f72 2f6c 6f63 6174 696f  l anchor/locatio
-0000aae0: 6e2e 0a20 2020 2020 2020 2020 2020 2069  n..            i
-0000aaf0: 6620 2723 2720 696e 2075 726c 3a0a 2020  f '#' in url:.  
-0000ab00: 2020 2020 2020 2020 2020 2020 2020 7572                ur
-0000ab10: 6c2c 2075 726c 5f73 7472 203d 2075 726c  l, url_str = url
-0000ab20: 2e73 706c 6974 2827 2327 2c20 3129 0a20  .split('#', 1). 
-0000ab30: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0000ab40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ab50: 2075 726c 5f73 7472 203d 204e 6f6e 650a   url_str = None.
-0000ab60: 0a20 2020 2020 2020 2020 2020 2075 726c  .            url
-0000ab70: 203d 2073 656c 662e 5f65 7363 6170 655f   = self._escape_
-0000ab80: 7572 6c28 7572 6c29 0a0a 2020 2020 2020  url(url)..      
-0000ab90: 2020 2020 2020 6966 2075 726c 5f73 7472        if url_str
-0000aba0: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
-0000abb0: 206e 6f74 2065 7874 6572 6e61 6c3a 0a20   not external:. 
-0000abc0: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-0000abd0: 726c 5f73 7472 203d 2073 656c 662e 5f65  rl_str = self._e
-0000abe0: 7363 6170 655f 7572 6c28 7572 6c5f 7374  scape_url(url_st
-0000abf0: 7229 0a0a 2020 2020 2020 2020 2020 2020  r)..            
-0000ac00: 2320 4164 6420 7468 6520 6669 6c65 3a2f  # Add the file:/
-0000ac10: 2f2f 2055 5249 2074 6f20 7468 6520 7572  // URI to the ur
-0000ac20: 6c20 666f 7220 5769 6e64 6f77 7320 7374  l for Windows st
-0000ac30: 796c 6520 2243 3a2f 2220 6c69 6e6b 2061  yle "C:/" link a
-0000ac40: 6e64 0a20 2020 2020 2020 2020 2020 2023  nd.            #
-0000ac50: 204e 6574 776f 726b 2073 6861 7265 732e   Network shares.
-0000ac60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000ac70: 7265 2e6d 6174 6368 2872 275c 773a 272c  re.match(r'\w:',
-0000ac80: 2075 726c 2920 6f72 2072 652e 6d61 7463   url) or re.matc
-0000ac90: 6828 7227 5c5c 272c 2075 726c 293a 0a20  h(r'\\', url):. 
-0000aca0: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-0000acb0: 726c 203d 2027 6669 6c65 3a2f 2f2f 2720  rl = 'file:///' 
-0000acc0: 2b20 7572 6c0a 0a20 2020 2020 2020 2020  + url..         
-0000acd0: 2020 2023 2043 6f6e 7665 7274 2061 202e     # Convert a .
-0000ace0: 5c64 6972 5c66 696c 652e 786c 7378 206c  \dir\file.xlsx l
-0000acf0: 696e 6b20 746f 2064 6972 5c66 696c 652e  ink to dir\file.
-0000ad00: 786c 7378 2e0a 2020 2020 2020 2020 2020  xlsx..          
-0000ad10: 2020 7572 6c20 3d20 7265 2e73 7562 2872    url = re.sub(r
-0000ad20: 275e 5c2e 5c5c 272c 2027 272c 2075 726c  '^\.\\', '', url
-0000ad30: 290a 0a20 2020 2020 2020 2023 2045 7863  )..        # Exc
-0000ad40: 656c 206c 696d 6974 7320 7468 6520 6573  el limits the es
-0000ad50: 6361 7065 6420 5552 4c20 616e 6420 6c6f  caped URL and lo
-0000ad60: 6361 7469 6f6e 2f61 6e63 686f 7220 746f  cation/anchor to
-0000ad70: 2032 3535 2063 6861 7261 6374 6572 732e   255 characters.
-0000ad80: 0a20 2020 2020 2020 2074 6d70 5f75 726c  .        tmp_url
-0000ad90: 5f73 7472 203d 2075 726c 5f73 7472 206f  _str = url_str o
-0000ada0: 7220 2727 0a20 2020 2020 2020 206d 6178  r ''.        max
-0000adb0: 5f75 726c 203d 2073 656c 662e 6d61 785f  _url = self.max_
-0000adc0: 7572 6c5f 6c65 6e67 7468 0a20 2020 2020  url_length.     
-0000add0: 2020 2069 6620 6c65 6e28 7572 6c29 203e     if len(url) >
-0000ade0: 206d 6178 5f75 726c 206f 7220 6c65 6e28   max_url or len(
-0000adf0: 746d 705f 7572 6c5f 7374 7229 203e 206d  tmp_url_str) > m
-0000ae00: 6178 5f75 726c 3a0a 2020 2020 2020 2020  ax_url:.        
-0000ae10: 2020 2020 7761 726e 2822 4967 6e6f 7269      warn("Ignori
-0000ae20: 6e67 2055 524c 2027 2573 2720 7769 7468  ng URL '%s' with
-0000ae30: 206c 696e 6b20 6f72 206c 6f63 6174 696f   link or locatio
-0000ae40: 6e2f 616e 6368 6f72 203e 2025 6420 220a  n/anchor > %d ".
-0000ae50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ae60: 2022 6368 6172 6163 7465 7273 2073 696e   "characters sin
-0000ae70: 6365 2069 7420 6578 6365 6564 7320 4578  ce it exceeds Ex
-0000ae80: 6365 6c27 7320 6c69 6d69 7420 666f 7220  cel's limit for 
-0000ae90: 5552 4c53 2220 250a 2020 2020 2020 2020  URLS" %.        
-0000aea0: 2020 2020 2020 2020 2028 7572 6c2c 206d           (url, m
-0000aeb0: 6178 5f75 726c 2929 0a20 2020 2020 2020  ax_url)).       
-0000aec0: 2020 2020 2072 6574 7572 6e20 2d33 0a0a       return -3..
-0000aed0: 2020 2020 2020 2020 2320 4368 6563 6b20          # Check 
-0000aee0: 7468 6520 6c69 6d69 7420 6f66 2055 524c  the limit of URL
-0000aef0: 5320 7065 7220 776f 726b 7368 6565 742e  S per worksheet.
-0000af00: 0a20 2020 2020 2020 2073 656c 662e 686c  .        self.hl
-0000af10: 696e 6b5f 636f 756e 7420 2b3d 2031 0a0a  ink_count += 1..
-0000af20: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0000af30: 686c 696e 6b5f 636f 756e 7420 3e20 3635  hlink_count > 65
-0000af40: 3533 303a 0a20 2020 2020 2020 2020 2020  530:.           
-0000af50: 2077 6172 6e28 2249 676e 6f72 696e 6720   warn("Ignoring 
-0000af60: 5552 4c20 2725 7327 2073 696e 6365 2069  URL '%s' since i
-0000af70: 7420 6578 6365 6564 7320 4578 6365 6c27  t exceeds Excel'
-0000af80: 7320 6c69 6d69 7420 6f66 2022 0a20 2020  s limit of ".   
-0000af90: 2020 2020 2020 2020 2020 2020 2020 2236                "6
-0000afa0: 352c 3533 3020 5552 4c53 2070 6572 2077  5,530 URLS per w
-0000afb0: 6f72 6b73 6865 6574 2e22 2025 2075 726c  orksheet." % url
-0000afc0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-0000afd0: 7475 726e 202d 340a 0a20 2020 2020 2020  turn -4..       
-0000afe0: 2023 2057 7269 7465 2070 7265 7669 6f75   # Write previou
-0000aff0: 7320 726f 7720 6966 2069 6e20 696e 2d6c  s row if in in-l
-0000b000: 696e 6520 7374 7269 6e67 2063 6f6e 7374  ine string const
-0000b010: 616e 745f 6d65 6d6f 7279 206d 6f64 652e  ant_memory mode.
-0000b020: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0000b030: 2e63 6f6e 7374 616e 745f 6d65 6d6f 7279  .constant_memory
-0000b040: 2061 6e64 2072 6f77 203e 2073 656c 662e   and row > self.
-0000b050: 7072 6576 696f 7573 5f72 6f77 3a0a 2020  previous_row:.  
-0000b060: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0000b070: 7772 6974 655f 7369 6e67 6c65 5f72 6f77  write_single_row
-0000b080: 2872 6f77 290a 0a20 2020 2020 2020 2023  (row)..        #
-0000b090: 2041 6464 2074 6865 2064 6566 6175 6c74   Add the default
-0000b0a0: 2055 524c 2066 6f72 6d61 742e 0a20 2020   URL format..   
-0000b0b0: 2020 2020 2069 6620 6365 6c6c 5f66 6f72       if cell_for
-0000b0c0: 6d61 7420 6973 204e 6f6e 653a 0a20 2020  mat is None:.   
-0000b0d0: 2020 2020 2020 2020 2063 656c 6c5f 666f           cell_fo
-0000b0e0: 726d 6174 203d 2073 656c 662e 6465 6661  rmat = self.defa
-0000b0f0: 756c 745f 7572 6c5f 666f 726d 6174 0a0a  ult_url_format..
-0000b100: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
-0000b110: 7468 6520 6879 7065 726c 696e 6b20 7374  the hyperlink st
-0000b120: 7269 6e67 2e0a 2020 2020 2020 2020 7365  ring..        se
-0000b130: 6c66 2e5f 7772 6974 655f 7374 7269 6e67  lf._write_string
-0000b140: 2872 6f77 2c20 636f 6c2c 2073 7472 696e  (row, col, strin
-0000b150: 672c 2063 656c 6c5f 666f 726d 6174 290a  g, cell_format).
-0000b160: 0a20 2020 2020 2020 2023 2053 746f 7265  .        # Store
-0000b170: 2074 6865 2068 7970 6572 6c69 6e6b 2064   the hyperlink d
-0000b180: 6174 6120 696e 2061 2073 6570 6172 6174  ata in a separat
-0000b190: 6520 7374 7275 6374 7572 652e 0a20 2020  e structure..   
-0000b1a0: 2020 2020 2073 656c 662e 6879 7065 726c       self.hyperl
-0000b1b0: 696e 6b73 5b72 6f77 5d5b 636f 6c5d 203d  inks[row][col] =
-0000b1c0: 207b 0a20 2020 2020 2020 2020 2020 2027   {.            '
-0000b1d0: 6c69 6e6b 5f74 7970 6527 3a20 6c69 6e6b  link_type': link
-0000b1e0: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-0000b1f0: 2020 2027 7572 6c27 3a20 7572 6c2c 0a20     'url': url,. 
-0000b200: 2020 2020 2020 2020 2020 2027 7374 7227             'str'
-0000b210: 3a20 7572 6c5f 7374 722c 0a20 2020 2020  : url_str,.     
-0000b220: 2020 2020 2020 2027 7469 7027 3a20 7469         'tip': ti
-0000b230: 707d 0a0a 2020 2020 2020 2020 7265 7475  p}..        retu
-0000b240: 726e 2073 7472 5f65 7272 6f72 0a0a 2020  rn str_error..  
-0000b250: 2020 4063 6f6e 7665 7274 5f63 656c 6c5f    @convert_cell_
-0000b260: 6172 6773 0a20 2020 2064 6566 2077 7269  args.    def wri
-0000b270: 7465 5f72 6963 685f 7374 7269 6e67 2873  te_rich_string(s
-0000b280: 656c 662c 2072 6f77 2c20 636f 6c2c 202a  elf, row, col, *
-0000b290: 6172 6773 293a 0a20 2020 2020 2020 2022  args):.        "
-0000b2a0: 2222 0a20 2020 2020 2020 2057 7269 7465  "".        Write
-0000b2b0: 2061 2022 7269 6368 2220 7374 7269 6e67   a "rich" string
-0000b2c0: 2077 6974 6820 6d75 6c74 6970 6c65 2066   with multiple f
-0000b2d0: 6f72 6d61 7473 2074 6f20 6120 776f 726b  ormats to a work
-0000b2e0: 7368 6565 7420 6365 6c6c 2e0a 0a20 2020  sheet cell...   
-0000b2f0: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
-0000b300: 2020 2020 2020 2072 6f77 3a20 2020 2020         row:     
-0000b310: 2020 2020 2054 6865 2063 656c 6c20 726f       The cell ro
-0000b320: 7720 287a 6572 6f20 696e 6465 7865 6429  w (zero indexed)
-0000b330: 2e0a 2020 2020 2020 2020 2020 2020 636f  ..            co
-0000b340: 6c3a 2020 2020 2020 2020 2020 5468 6520  l:          The 
-0000b350: 6365 6c6c 2063 6f6c 756d 6e20 287a 6572  cell column (zer
-0000b360: 6f20 696e 6465 7865 6429 2e0a 2020 2020  o indexed)..    
-0000b370: 2020 2020 2020 2020 7374 7269 6e67 5f70          string_p
-0000b380: 6172 7473 3a20 5374 7269 6e67 2061 6e64  arts: String and
-0000b390: 2066 6f72 6d61 7420 7061 6972 732e 0a20   format pairs.. 
-0000b3a0: 2020 2020 2020 2020 2020 2063 656c 6c5f             cell_
-0000b3b0: 666f 726d 6174 3a20 204f 7074 696f 6e61  format:  Optiona
-0000b3c0: 6c20 466f 726d 6174 206f 626a 6563 742e  l Format object.
-0000b3d0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-0000b3e0: 733a 0a20 2020 2020 2020 2020 2020 2030  s:.            0
-0000b3f0: 3a20 2053 7563 6365 7373 2e0a 2020 2020  :  Success..    
-0000b400: 2020 2020 2020 2020 2d31 3a20 526f 7720          -1: Row 
-0000b410: 6f72 2063 6f6c 756d 6e20 6973 206f 7574  or column is out
-0000b420: 206f 6620 776f 726b 7368 6565 7420 626f   of worksheet bo
-0000b430: 756e 6473 2e0a 2020 2020 2020 2020 2020  unds..          
-0000b440: 2020 2d32 3a20 5374 7269 6e67 2074 7275    -2: String tru
-0000b450: 6e63 6174 6564 2074 6f20 3332 6b20 6368  ncated to 32k ch
-0000b460: 6172 6163 7465 7273 2e0a 2020 2020 2020  aracters..      
-0000b470: 2020 2020 2020 2d33 3a20 3220 636f 6e73        -3: 2 cons
-0000b480: 6563 7574 6976 6520 666f 726d 6174 7320  ecutive formats 
-0000b490: 7573 6564 2e0a 2020 2020 2020 2020 2020  used..          
-0000b4a0: 2020 2d34 3a20 456d 7074 7920 7374 7269    -4: Empty stri
-0000b4b0: 6e67 2075 7365 642e 0a20 2020 2020 2020  ng used..       
-0000b4c0: 2020 2020 202d 353a 2049 6e73 7566 6669       -5: Insuffi
-0000b4d0: 6369 656e 7420 7061 7261 6d65 7465 7273  cient parameters
-0000b4e0: 2e0a 0a20 2020 2020 2020 2022 2222 0a0a  ...        """..
-0000b4f0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000b500: 656c 662e 5f77 7269 7465 5f72 6963 685f  elf._write_rich_
-0000b510: 7374 7269 6e67 2872 6f77 2c20 636f 6c2c  string(row, col,
-0000b520: 202a 6172 6773 290a 0a20 2020 2023 2055   *args)..    # U
-0000b530: 6e64 6563 6f72 6174 6564 2076 6572 7369  ndecorated versi
-0000b540: 6f6e 206f 6620 7772 6974 655f 7269 6368  on of write_rich
-0000b550: 5f73 7472 696e 6728 292e 0a20 2020 2064  _string()..    d
-0000b560: 6566 205f 7772 6974 655f 7269 6368 5f73  ef _write_rich_s
-0000b570: 7472 696e 6728 7365 6c66 2c20 726f 772c  tring(self, row,
-0000b580: 2063 6f6c 2c20 2a61 7267 7329 3a0a 2020   col, *args):.  
-0000b590: 2020 2020 2020 746f 6b65 6e73 203d 206c        tokens = l
-0000b5a0: 6973 7428 6172 6773 290a 2020 2020 2020  ist(args).      
-0000b5b0: 2020 6365 6c6c 5f66 6f72 6d61 7420 3d20    cell_format = 
-0000b5c0: 4e6f 6e65 0a20 2020 2020 2020 2073 7472  None.        str
-0000b5d0: 696e 675f 696e 6465 7820 3d20 300a 2020  ing_index = 0.  
-0000b5e0: 2020 2020 2020 7261 775f 7374 7269 6e67        raw_string
-0000b5f0: 203d 2027 270a 0a20 2020 2020 2020 2023   = ''..        #
-0000b600: 2043 6865 636b 2074 6861 7420 726f 7720   Check that row 
-0000b610: 616e 6420 636f 6c20 6172 6520 7661 6c69  and col are vali
-0000b620: 6420 616e 6420 7374 6f72 6520 6d61 7820  d and store max 
-0000b630: 616e 6420 6d69 6e20 7661 6c75 6573 0a20  and min values. 
-0000b640: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-0000b650: 6368 6563 6b5f 6469 6d65 6e73 696f 6e73  check_dimensions
-0000b660: 2872 6f77 2c20 636f 6c29 3a0a 2020 2020  (row, col):.    
-0000b670: 2020 2020 2020 2020 7265 7475 726e 202d          return -
-0000b680: 310a 0a20 2020 2020 2020 2023 2049 6620  1..        # If 
-0000b690: 7468 6520 6c61 7374 2061 7267 2069 7320  the last arg is 
-0000b6a0: 6120 666f 726d 6174 2077 6520 7573 6520  a format we use 
-0000b6b0: 6974 2061 7320 7468 6520 6365 6c6c 2066  it as the cell f
-0000b6c0: 6f72 6d61 742e 0a20 2020 2020 2020 2069  ormat..        i
-0000b6d0: 6620 6973 696e 7374 616e 6365 2874 6f6b  f isinstance(tok
-0000b6e0: 656e 735b 2d31 5d2c 2046 6f72 6d61 7429  ens[-1], Format)
-0000b6f0: 3a0a 2020 2020 2020 2020 2020 2020 6365  :.            ce
-0000b700: 6c6c 5f66 6f72 6d61 7420 3d20 746f 6b65  ll_format = toke
-0000b710: 6e73 2e70 6f70 2829 0a0a 2020 2020 2020  ns.pop()..      
-0000b720: 2020 2320 4372 6561 7465 2061 2074 656d    # Create a tem
-0000b730: 7020 584d 4c57 7269 7465 7220 6f62 6a65  p XMLWriter obje
-0000b740: 6374 2061 6e64 2075 7365 2069 7420 746f  ct and use it to
-0000b750: 2077 7269 7465 2074 6865 2072 6963 6820   write the rich 
-0000b760: 7374 7269 6e67 0a20 2020 2020 2020 2023  string.        #
-0000b770: 2058 4d4c 2074 6f20 6120 7374 7269 6e67   XML to a string
-0000b780: 2e0a 2020 2020 2020 2020 6668 203d 2053  ..        fh = S
-0000b790: 7472 696e 6749 4f28 290a 2020 2020 2020  tringIO().      
-0000b7a0: 2020 7365 6c66 2e72 7374 7269 6e67 203d    self.rstring =
-0000b7b0: 2058 4d4c 7772 6974 6572 2829 0a20 2020   XMLwriter().   
-0000b7c0: 2020 2020 2073 656c 662e 7273 7472 696e       self.rstrin
-0000b7d0: 672e 5f73 6574 5f66 696c 6568 616e 646c  g._set_filehandl
-0000b7e0: 6528 6668 290a 0a20 2020 2020 2020 2023  e(fh)..        #
-0000b7f0: 2043 7265 6174 6520 6120 7465 6d70 2066   Create a temp f
-0000b800: 6f72 6d61 7420 7769 7468 2074 6865 2064  ormat with the d
-0000b810: 6566 6175 6c74 2066 6f6e 7420 666f 7220  efault font for 
-0000b820: 756e 666f 726d 6174 7465 6420 6672 6167  unformatted frag
-0000b830: 6d65 6e74 732e 0a20 2020 2020 2020 2064  ments..        d
-0000b840: 6566 6175 6c74 203d 2046 6f72 6d61 7428  efault = Format(
-0000b850: 290a 0a20 2020 2020 2020 2023 2043 6f6e  )..        # Con
-0000b860: 7665 7274 206c 6973 7420 6f66 2066 6f72  vert list of for
-0000b870: 6d61 742c 2073 7472 696e 6720 746f 6b65  mat, string toke
-0000b880: 6e73 2074 6f20 7061 6972 7320 6f66 2028  ns to pairs of (
-0000b890: 666f 726d 6174 2c20 7374 7269 6e67 290a  format, string).
-0000b8a0: 2020 2020 2020 2020 2320 6578 6365 7074          # except
-0000b8b0: 2066 6f72 2074 6865 2066 6972 7374 2073   for the first s
-0000b8c0: 7472 696e 6720 6672 6167 6d65 6e74 2077  tring fragment w
-0000b8d0: 6869 6368 2064 6f65 736e 2774 2072 6571  hich doesn't req
-0000b8e0: 7569 7265 2061 2064 6566 6175 6c74 0a20  uire a default. 
-0000b8f0: 2020 2020 2020 2023 2066 6f72 6d61 7474         # formatt
-0000b900: 696e 6720 7275 6e2e 2055 7365 2074 6865  ing run. Use the
-0000b910: 2064 6566 6175 6c74 2066 6f72 2073 7472   default for str
-0000b920: 696e 6773 2077 6974 686f 7574 2061 206c  ings without a l
-0000b930: 6561 6469 6e67 2066 6f72 6d61 742e 0a20  eading format.. 
-0000b940: 2020 2020 2020 2066 7261 676d 656e 7473         fragments
-0000b950: 203d 205b 5d0a 2020 2020 2020 2020 7072   = [].        pr
-0000b960: 6576 696f 7573 203d 2027 666f 726d 6174  evious = 'format
-0000b970: 270a 2020 2020 2020 2020 706f 7320 3d20  '.        pos = 
-0000b980: 300a 0a20 2020 2020 2020 2069 6620 6c65  0..        if le
-0000b990: 6e28 746f 6b65 6e73 2920 3c3d 2032 3a0a  n(tokens) <= 2:.
-0000b9a0: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-0000b9b0: 2822 596f 7520 6d75 7374 2073 7065 6369  ("You must speci
-0000b9c0: 6679 206d 6f72 6520 7468 616e 2032 2066  fy more than 2 f
-0000b9d0: 6f72 6d61 742f 6672 6167 6d65 6e74 7320  ormat/fragments 
-0000b9e0: 666f 7220 7269 6368 2022 0a20 2020 2020  for rich ".     
-0000b9f0: 2020 2020 2020 2020 2020 2020 2273 7472              "str
-0000ba00: 696e 6773 2e20 4967 6e6f 7269 6e67 2069  ings. Ignoring i
-0000ba10: 6e70 7574 2069 6e20 7772 6974 655f 7269  nput in write_ri
-0000ba20: 6368 5f73 7472 696e 6728 292e 2229 0a20  ch_string()."). 
-0000ba30: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000ba40: 6e20 2d35 0a0a 2020 2020 2020 2020 666f  n -5..        fo
-0000ba50: 7220 746f 6b65 6e20 696e 2074 6f6b 656e  r token in token
-0000ba60: 733a 0a20 2020 2020 2020 2020 2020 2069  s:.            i
-0000ba70: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
-0000ba80: 2874 6f6b 656e 2c20 466f 726d 6174 293a  (token, Format):
-0000ba90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000baa0: 2023 2054 6f6b 656e 2069 7320 6120 7374   # Token is a st
-0000bab0: 7269 6e67 2e0a 2020 2020 2020 2020 2020  ring..          
-0000bac0: 2020 2020 2020 6966 2070 7265 7669 6f75        if previou
-0000bad0: 7320 213d 2027 666f 726d 6174 273a 0a20  s != 'format':. 
-0000bae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000baf0: 2020 2023 2049 6620 7072 6576 696f 7573     # If previous
-0000bb00: 2074 6f6b 656e 2077 6173 6e27 7420 6120   token wasn't a 
-0000bb10: 666f 726d 6174 2061 6464 206f 6e65 2062  format add one b
-0000bb20: 6566 6f72 6520 7374 7269 6e67 2e0a 2020  efore string..  
-0000bb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bb40: 2020 6672 6167 6d65 6e74 732e 6170 7065    fragments.appe
-0000bb50: 6e64 2864 6566 6175 6c74 290a 2020 2020  nd(default).    
+000015b0: 2323 2323 2323 2323 2323 2323 230a 0a20  #############.. 
+000015c0: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+000015d0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+000015e0: 2222 0a20 2020 2020 2020 2043 6f6e 7374  "".        Const
+000015f0: 7275 6374 6f72 2e0a 0a20 2020 2020 2020  ructor...       
+00001600: 2022 2222 0a0a 2020 2020 2020 2020 7375   """..        su
+00001610: 7065 7228 576f 726b 7368 6565 742c 2073  per(Worksheet, s
+00001620: 656c 6629 2e5f 5f69 6e69 745f 5f28 290a  elf).__init__().
+00001630: 0a20 2020 2020 2020 2073 656c 662e 6e61  .        self.na
+00001640: 6d65 203d 204e 6f6e 650a 2020 2020 2020  me = None.      
+00001650: 2020 7365 6c66 2e69 6e64 6578 203d 204e    self.index = N
+00001660: 6f6e 650a 2020 2020 2020 2020 7365 6c66  one.        self
+00001670: 2e73 7472 5f74 6162 6c65 203d 204e 6f6e  .str_table = Non
+00001680: 650a 2020 2020 2020 2020 7365 6c66 2e70  e.        self.p
+00001690: 616c 6574 7465 203d 204e 6f6e 650a 2020  alette = None.  
+000016a0: 2020 2020 2020 7365 6c66 2e63 6f6e 7374        self.const
+000016b0: 616e 745f 6d65 6d6f 7279 203d 2030 0a20  ant_memory = 0. 
+000016c0: 2020 2020 2020 2073 656c 662e 746d 7064         self.tmpd
+000016d0: 6972 203d 204e 6f6e 650a 2020 2020 2020  ir = None.      
+000016e0: 2020 7365 6c66 2e69 735f 6368 6172 7473    self.is_charts
+000016f0: 6865 6574 203d 2046 616c 7365 0a0a 2020  heet = False..  
+00001700: 2020 2020 2020 7365 6c66 2e65 7874 5f73        self.ext_s
+00001710: 6865 6574 7320 3d20 5b5d 0a20 2020 2020  heets = [].     
+00001720: 2020 2073 656c 662e 6669 6c65 636c 6f73     self.fileclos
+00001730: 6564 203d 2030 0a20 2020 2020 2020 2073  ed = 0.        s
+00001740: 656c 662e 6578 6365 6c5f 7665 7273 696f  elf.excel_versio
+00001750: 6e20 3d20 3230 3037 0a20 2020 2020 2020  n = 2007.       
+00001760: 2073 656c 662e 6578 6365 6c32 3030 335f   self.excel2003_
+00001770: 7374 796c 6520 3d20 4661 6c73 650a 0a20  style = False.. 
+00001780: 2020 2020 2020 2073 656c 662e 786c 735f         self.xls_
+00001790: 726f 776d 6178 203d 2031 3034 3835 3736  rowmax = 1048576
+000017a0: 0a20 2020 2020 2020 2073 656c 662e 786c  .        self.xl
+000017b0: 735f 636f 6c6d 6178 203d 2031 3633 3834  s_colmax = 16384
+000017c0: 0a20 2020 2020 2020 2073 656c 662e 786c  .        self.xl
+000017d0: 735f 7374 726d 6178 203d 2033 3237 3637  s_strmax = 32767
+000017e0: 0a20 2020 2020 2020 2073 656c 662e 6469  .        self.di
+000017f0: 6d5f 726f 776d 696e 203d 204e 6f6e 650a  m_rowmin = None.
+00001800: 2020 2020 2020 2020 7365 6c66 2e64 696d          self.dim
+00001810: 5f72 6f77 6d61 7820 3d20 4e6f 6e65 0a20  _rowmax = None. 
+00001820: 2020 2020 2020 2073 656c 662e 6469 6d5f         self.dim_
+00001830: 636f 6c6d 696e 203d 204e 6f6e 650a 2020  colmin = None.  
+00001840: 2020 2020 2020 7365 6c66 2e64 696d 5f63        self.dim_c
+00001850: 6f6c 6d61 7820 3d20 4e6f 6e65 0a0a 2020  olmax = None..  
+00001860: 2020 2020 2020 7365 6c66 2e63 6f6c 5f69        self.col_i
+00001870: 6e66 6f20 3d20 7b7d 0a20 2020 2020 2020  nfo = {}.       
+00001880: 2073 656c 662e 7365 6c65 6374 696f 6e73   self.selections
+00001890: 203d 205b 5d0a 2020 2020 2020 2020 7365   = [].        se
+000018a0: 6c66 2e68 6964 6465 6e20 3d20 300a 2020  lf.hidden = 0.  
+000018b0: 2020 2020 2020 7365 6c66 2e61 6374 6976        self.activ
+000018c0: 6520 3d20 300a 2020 2020 2020 2020 7365  e = 0.        se
+000018d0: 6c66 2e74 6162 5f63 6f6c 6f72 203d 2030  lf.tab_color = 0
+000018e0: 0a20 2020 2020 2020 2073 656c 662e 746f  .        self.to
+000018f0: 705f 6c65 6674 5f63 656c 6c20 3d20 2222  p_left_cell = ""
+00001900: 0a0a 2020 2020 2020 2020 7365 6c66 2e70  ..        self.p
+00001910: 616e 6573 203d 205b 5d0a 2020 2020 2020  anes = [].      
+00001920: 2020 7365 6c66 2e61 6374 6976 655f 7061    self.active_pa
+00001930: 6e65 203d 2033 0a20 2020 2020 2020 2073  ne = 3.        s
+00001940: 656c 662e 7365 6c65 6374 6564 203d 2030  elf.selected = 0
+00001950: 0a0a 2020 2020 2020 2020 7365 6c66 2e70  ..        self.p
+00001960: 6167 655f 7365 7475 705f 6368 616e 6765  age_setup_change
+00001970: 6420 3d20 4661 6c73 650a 2020 2020 2020  d = False.      
+00001980: 2020 7365 6c66 2e70 6170 6572 5f73 697a    self.paper_siz
+00001990: 6520 3d20 300a 2020 2020 2020 2020 7365  e = 0.        se
+000019a0: 6c66 2e6f 7269 656e 7461 7469 6f6e 203d  lf.orientation =
+000019b0: 2031 0a0a 2020 2020 2020 2020 7365 6c66   1..        self
+000019c0: 2e70 7269 6e74 5f6f 7074 696f 6e73 5f63  .print_options_c
+000019d0: 6861 6e67 6564 203d 2046 616c 7365 0a20  hanged = False. 
+000019e0: 2020 2020 2020 2073 656c 662e 6863 656e         self.hcen
+000019f0: 7465 7220 3d20 4661 6c73 650a 2020 2020  ter = False.    
+00001a00: 2020 2020 7365 6c66 2e76 6365 6e74 6572      self.vcenter
+00001a10: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+00001a20: 2073 656c 662e 7072 696e 745f 6772 6964   self.print_grid
+00001a30: 6c69 6e65 7320 3d20 4661 6c73 650a 2020  lines = False.  
+00001a40: 2020 2020 2020 7365 6c66 2e73 6372 6565        self.scree
+00001a50: 6e5f 6772 6964 6c69 6e65 7320 3d20 5472  n_gridlines = Tr
+00001a60: 7565 0a20 2020 2020 2020 2073 656c 662e  ue.        self.
+00001a70: 7072 696e 745f 6865 6164 6572 7320 3d20  print_headers = 
+00001a80: 4661 6c73 650a 2020 2020 2020 2020 7365  False.        se
+00001a90: 6c66 2e72 6f77 5f63 6f6c 5f68 6561 6465  lf.row_col_heade
+00001aa0: 7273 203d 2046 616c 7365 0a0a 2020 2020  rs = False..    
+00001ab0: 2020 2020 7365 6c66 2e68 6561 6465 725f      self.header_
+00001ac0: 666f 6f74 6572 5f63 6861 6e67 6564 203d  footer_changed =
+00001ad0: 2046 616c 7365 0a20 2020 2020 2020 2073   False.        s
+00001ae0: 656c 662e 6865 6164 6572 203d 2022 220a  elf.header = "".
+00001af0: 2020 2020 2020 2020 7365 6c66 2e66 6f6f          self.foo
+00001b00: 7465 7220 3d20 2222 0a20 2020 2020 2020  ter = "".       
+00001b10: 2073 656c 662e 6865 6164 6572 5f66 6f6f   self.header_foo
+00001b20: 7465 725f 616c 6967 6e73 203d 2054 7275  ter_aligns = Tru
+00001b30: 650a 2020 2020 2020 2020 7365 6c66 2e68  e.        self.h
+00001b40: 6561 6465 725f 666f 6f74 6572 5f73 6361  eader_footer_sca
+00001b50: 6c65 7320 3d20 5472 7565 0a20 2020 2020  les = True.     
+00001b60: 2020 2073 656c 662e 6865 6164 6572 5f69     self.header_i
+00001b70: 6d61 6765 7320 3d20 5b5d 0a20 2020 2020  mages = [].     
+00001b80: 2020 2073 656c 662e 666f 6f74 6572 5f69     self.footer_i
+00001b90: 6d61 6765 7320 3d20 5b5d 0a20 2020 2020  mages = [].     
+00001ba0: 2020 2073 656c 662e 6865 6164 6572 5f69     self.header_i
+00001bb0: 6d61 6765 735f 6c69 7374 203d 205b 5d0a  mages_list = [].
+00001bc0: 0a20 2020 2020 2020 2073 656c 662e 6d61  .        self.ma
+00001bd0: 7267 696e 5f6c 6566 7420 3d20 302e 370a  rgin_left = 0.7.
+00001be0: 2020 2020 2020 2020 7365 6c66 2e6d 6172          self.mar
+00001bf0: 6769 6e5f 7269 6768 7420 3d20 302e 370a  gin_right = 0.7.
+00001c00: 2020 2020 2020 2020 7365 6c66 2e6d 6172          self.mar
+00001c10: 6769 6e5f 746f 7020 3d20 302e 3735 0a20  gin_top = 0.75. 
+00001c20: 2020 2020 2020 2073 656c 662e 6d61 7267         self.marg
+00001c30: 696e 5f62 6f74 746f 6d20 3d20 302e 3735  in_bottom = 0.75
+00001c40: 0a20 2020 2020 2020 2073 656c 662e 6d61  .        self.ma
+00001c50: 7267 696e 5f68 6561 6465 7220 3d20 302e  rgin_header = 0.
+00001c60: 330a 2020 2020 2020 2020 7365 6c66 2e6d  3.        self.m
+00001c70: 6172 6769 6e5f 666f 6f74 6572 203d 2030  argin_footer = 0
+00001c80: 2e33 0a0a 2020 2020 2020 2020 7365 6c66  .3..        self
+00001c90: 2e72 6570 6561 745f 726f 775f 7261 6e67  .repeat_row_rang
+00001ca0: 6520 3d20 2222 0a20 2020 2020 2020 2073  e = "".        s
+00001cb0: 656c 662e 7265 7065 6174 5f63 6f6c 5f72  elf.repeat_col_r
+00001cc0: 616e 6765 203d 2022 220a 2020 2020 2020  ange = "".      
+00001cd0: 2020 7365 6c66 2e70 7269 6e74 5f61 7265    self.print_are
+00001ce0: 615f 7261 6e67 6520 3d20 2222 0a0a 2020  a_range = ""..  
+00001cf0: 2020 2020 2020 7365 6c66 2e70 6167 655f        self.page_
+00001d00: 6f72 6465 7220 3d20 300a 2020 2020 2020  order = 0.      
+00001d10: 2020 7365 6c66 2e62 6c61 636b 5f77 6869    self.black_whi
+00001d20: 7465 203d 2030 0a20 2020 2020 2020 2073  te = 0.        s
+00001d30: 656c 662e 6472 6166 745f 7175 616c 6974  elf.draft_qualit
+00001d40: 7920 3d20 300a 2020 2020 2020 2020 7365  y = 0.        se
+00001d50: 6c66 2e70 7269 6e74 5f63 6f6d 6d65 6e74  lf.print_comment
+00001d60: 7320 3d20 300a 2020 2020 2020 2020 7365  s = 0.        se
+00001d70: 6c66 2e70 6167 655f 7374 6172 7420 3d20  lf.page_start = 
+00001d80: 300a 0a20 2020 2020 2020 2073 656c 662e  0..        self.
+00001d90: 6669 745f 7061 6765 203d 2030 0a20 2020  fit_page = 0.   
+00001da0: 2020 2020 2073 656c 662e 6669 745f 7769       self.fit_wi
+00001db0: 6474 6820 3d20 300a 2020 2020 2020 2020  dth = 0.        
+00001dc0: 7365 6c66 2e66 6974 5f68 6569 6768 7420  self.fit_height 
+00001dd0: 3d20 300a 0a20 2020 2020 2020 2073 656c  = 0..        sel
+00001de0: 662e 6862 7265 616b 7320 3d20 5b5d 0a20  f.hbreaks = []. 
+00001df0: 2020 2020 2020 2073 656c 662e 7662 7265         self.vbre
+00001e00: 616b 7320 3d20 5b5d 0a0a 2020 2020 2020  aks = []..      
+00001e10: 2020 7365 6c66 2e70 726f 7465 6374 5f6f    self.protect_o
+00001e20: 7074 696f 6e73 203d 207b 7d0a 2020 2020  ptions = {}.    
+00001e30: 2020 2020 7365 6c66 2e70 726f 7465 6374      self.protect
+00001e40: 6564 5f72 616e 6765 7320 3d20 5b5d 0a20  ed_ranges = []. 
+00001e50: 2020 2020 2020 2073 656c 662e 6e75 6d5f         self.num_
+00001e60: 7072 6f74 6563 7465 645f 7261 6e67 6573  protected_ranges
+00001e70: 203d 2030 0a20 2020 2020 2020 2073 656c   = 0.        sel
+00001e80: 662e 7365 745f 636f 6c73 203d 207b 7d0a  f.set_cols = {}.
+00001e90: 2020 2020 2020 2020 7365 6c66 2e73 6574          self.set
+00001ea0: 5f72 6f77 7320 3d20 6465 6661 756c 7464  _rows = defaultd
+00001eb0: 6963 7428 6469 6374 290a 0a20 2020 2020  ict(dict)..     
+00001ec0: 2020 2073 656c 662e 7a6f 6f6d 203d 2031     self.zoom = 1
+00001ed0: 3030 0a20 2020 2020 2020 2073 656c 662e  00.        self.
+00001ee0: 7a6f 6f6d 5f73 6361 6c65 5f6e 6f72 6d61  zoom_scale_norma
+00001ef0: 6c20 3d20 310a 2020 2020 2020 2020 7365  l = 1.        se
+00001f00: 6c66 2e70 7269 6e74 5f73 6361 6c65 203d  lf.print_scale =
+00001f10: 2031 3030 0a20 2020 2020 2020 2073 656c   100.        sel
+00001f20: 662e 6973 5f72 6967 6874 5f74 6f5f 6c65  f.is_right_to_le
+00001f30: 6674 203d 2030 0a20 2020 2020 2020 2073  ft = 0.        s
+00001f40: 656c 662e 7368 6f77 5f7a 6572 6f73 203d  elf.show_zeros =
+00001f50: 2031 0a20 2020 2020 2020 2073 656c 662e   1.        self.
+00001f60: 6c65 6164 696e 675f 7a65 726f 7320 3d20  leading_zeros = 
+00001f70: 300a 0a20 2020 2020 2020 2073 656c 662e  0..        self.
+00001f80: 6f75 746c 696e 655f 726f 775f 6c65 7665  outline_row_leve
+00001f90: 6c20 3d20 300a 2020 2020 2020 2020 7365  l = 0.        se
+00001fa0: 6c66 2e6f 7574 6c69 6e65 5f63 6f6c 5f6c  lf.outline_col_l
+00001fb0: 6576 656c 203d 2030 0a20 2020 2020 2020  evel = 0.       
+00001fc0: 2073 656c 662e 6f75 746c 696e 655f 7374   self.outline_st
+00001fd0: 796c 6520 3d20 300a 2020 2020 2020 2020  yle = 0.        
+00001fe0: 7365 6c66 2e6f 7574 6c69 6e65 5f62 656c  self.outline_bel
+00001ff0: 6f77 203d 2031 0a20 2020 2020 2020 2073  ow = 1.        s
+00002000: 656c 662e 6f75 746c 696e 655f 7269 6768  elf.outline_righ
+00002010: 7420 3d20 310a 2020 2020 2020 2020 7365  t = 1.        se
+00002020: 6c66 2e6f 7574 6c69 6e65 5f6f 6e20 3d20  lf.outline_on = 
+00002030: 310a 2020 2020 2020 2020 7365 6c66 2e6f  1.        self.o
+00002040: 7574 6c69 6e65 5f63 6861 6e67 6564 203d  utline_changed =
+00002050: 2046 616c 7365 0a0a 2020 2020 2020 2020   False..        
+00002060: 7365 6c66 2e6f 7269 6769 6e61 6c5f 726f  self.original_ro
+00002070: 775f 6865 6967 6874 203d 2031 350a 2020  w_height = 15.  
+00002080: 2020 2020 2020 7365 6c66 2e64 6566 6175        self.defau
+00002090: 6c74 5f72 6f77 5f68 6569 6768 7420 3d20  lt_row_height = 
+000020a0: 3135 0a20 2020 2020 2020 2073 656c 662e  15.        self.
+000020b0: 6465 6661 756c 745f 726f 775f 7069 7865  default_row_pixe
+000020c0: 6c73 203d 2032 300a 2020 2020 2020 2020  ls = 20.        
+000020d0: 7365 6c66 2e64 6566 6175 6c74 5f63 6f6c  self.default_col
+000020e0: 5f77 6964 7468 203d 2038 2e34 330a 2020  _width = 8.43.  
+000020f0: 2020 2020 2020 7365 6c66 2e64 6566 6175        self.defau
+00002100: 6c74 5f63 6f6c 5f70 6978 656c 7320 3d20  lt_col_pixels = 
+00002110: 3634 0a20 2020 2020 2020 2073 656c 662e  64.        self.
+00002120: 6465 6661 756c 745f 6461 7465 5f70 6978  default_date_pix
+00002130: 656c 7320 3d20 3638 0a20 2020 2020 2020  els = 68.       
+00002140: 2073 656c 662e 6465 6661 756c 745f 726f   self.default_ro
+00002150: 775f 7a65 726f 6564 203d 2030 0a0a 2020  w_zeroed = 0..  
+00002160: 2020 2020 2020 7365 6c66 2e6e 616d 6573        self.names
+00002170: 203d 207b 7d0a 2020 2020 2020 2020 7365   = {}.        se
+00002180: 6c66 2e77 7269 7465 5f6d 6174 6368 203d  lf.write_match =
+00002190: 205b 5d0a 2020 2020 2020 2020 7365 6c66   [].        self
+000021a0: 2e74 6162 6c65 203d 2064 6566 6175 6c74  .table = default
+000021b0: 6469 6374 2864 6963 7429 0a20 2020 2020  dict(dict).     
+000021c0: 2020 2073 656c 662e 6d65 7267 6520 3d20     self.merge = 
+000021d0: 5b5d 0a20 2020 2020 2020 2073 656c 662e  [].        self.
+000021e0: 6d65 7267 6564 5f63 656c 6c73 203d 207b  merged_cells = {
+000021f0: 7d0a 2020 2020 2020 2020 7365 6c66 2e74  }.        self.t
+00002200: 6162 6c65 5f63 656c 6c73 203d 207b 7d0a  able_cells = {}.
+00002210: 2020 2020 2020 2020 7365 6c66 2e72 6f77          self.row
+00002220: 5f73 7061 6e73 203d 207b 7d0a 0a20 2020  _spans = {}..   
+00002230: 2020 2020 2073 656c 662e 6861 735f 766d       self.has_vm
+00002240: 6c20 3d20 4661 6c73 650a 2020 2020 2020  l = False.      
+00002250: 2020 7365 6c66 2e68 6173 5f68 6561 6465    self.has_heade
+00002260: 725f 766d 6c20 3d20 4661 6c73 650a 2020  r_vml = False.  
+00002270: 2020 2020 2020 7365 6c66 2e68 6173 5f63        self.has_c
+00002280: 6f6d 6d65 6e74 7320 3d20 4661 6c73 650a  omments = False.
+00002290: 2020 2020 2020 2020 7365 6c66 2e63 6f6d          self.com
+000022a0: 6d65 6e74 7320 3d20 6465 6661 756c 7464  ments = defaultd
+000022b0: 6963 7428 6469 6374 290a 2020 2020 2020  ict(dict).      
+000022c0: 2020 7365 6c66 2e63 6f6d 6d65 6e74 735f    self.comments_
+000022d0: 6c69 7374 203d 205b 5d0a 2020 2020 2020  list = [].      
+000022e0: 2020 7365 6c66 2e63 6f6d 6d65 6e74 735f    self.comments_
+000022f0: 6175 7468 6f72 203d 2022 220a 2020 2020  author = "".    
+00002300: 2020 2020 7365 6c66 2e63 6f6d 6d65 6e74      self.comment
+00002310: 735f 7669 7369 626c 6520 3d20 300a 2020  s_visible = 0.  
+00002320: 2020 2020 2020 7365 6c66 2e76 6d6c 5f73        self.vml_s
+00002330: 6861 7065 5f69 6420 3d20 3130 3234 0a20  hape_id = 1024. 
+00002340: 2020 2020 2020 2073 656c 662e 6275 7474         self.butt
+00002350: 6f6e 735f 6c69 7374 203d 205b 5d0a 2020  ons_list = [].  
+00002360: 2020 2020 2020 7365 6c66 2e76 6d6c 5f68        self.vml_h
+00002370: 6561 6465 725f 6964 203d 2030 0a0a 2020  eader_id = 0..  
+00002380: 2020 2020 2020 7365 6c66 2e61 7574 6f66        self.autof
+00002390: 696c 7465 725f 6172 6561 203d 2022 220a  ilter_area = "".
+000023a0: 2020 2020 2020 2020 7365 6c66 2e61 7574          self.aut
+000023b0: 6f66 696c 7465 725f 7265 6620 3d20 4e6f  ofilter_ref = No
+000023c0: 6e65 0a20 2020 2020 2020 2073 656c 662e  ne.        self.
+000023d0: 6669 6c74 6572 5f72 616e 6765 203d 205b  filter_range = [
+000023e0: 5d0a 2020 2020 2020 2020 7365 6c66 2e66  ].        self.f
+000023f0: 696c 7465 725f 6f6e 203d 2030 0a20 2020  ilter_on = 0.   
+00002400: 2020 2020 2073 656c 662e 6669 6c74 6572       self.filter
+00002410: 5f63 6f6c 7320 3d20 7b7d 0a20 2020 2020  _cols = {}.     
+00002420: 2020 2073 656c 662e 6669 6c74 6572 5f74     self.filter_t
+00002430: 7970 6520 3d20 7b7d 0a20 2020 2020 2020  ype = {}.       
+00002440: 2073 656c 662e 6669 6c74 6572 5f63 656c   self.filter_cel
+00002450: 6c73 203d 207b 7d0a 0a20 2020 2020 2020  ls = {}..       
+00002460: 2073 656c 662e 726f 775f 7369 7a65 7320   self.row_sizes 
+00002470: 3d20 7b7d 0a20 2020 2020 2020 2073 656c  = {}.        sel
+00002480: 662e 636f 6c5f 7369 7a65 5f63 6861 6e67  f.col_size_chang
+00002490: 6564 203d 2046 616c 7365 0a20 2020 2020  ed = False.     
+000024a0: 2020 2073 656c 662e 726f 775f 7369 7a65     self.row_size
+000024b0: 5f63 6861 6e67 6564 203d 2046 616c 7365  _changed = False
+000024c0: 0a0a 2020 2020 2020 2020 7365 6c66 2e6c  ..        self.l
+000024d0: 6173 745f 7368 6170 655f 6964 203d 2031  ast_shape_id = 1
+000024e0: 0a20 2020 2020 2020 2073 656c 662e 7265  .        self.re
+000024f0: 6c5f 636f 756e 7420 3d20 300a 2020 2020  l_count = 0.    
+00002500: 2020 2020 7365 6c66 2e68 6c69 6e6b 5f63      self.hlink_c
+00002510: 6f75 6e74 203d 2030 0a20 2020 2020 2020  ount = 0.       
+00002520: 2073 656c 662e 686c 696e 6b5f 7265 6673   self.hlink_refs
+00002530: 203d 205b 5d0a 2020 2020 2020 2020 7365   = [].        se
+00002540: 6c66 2e65 7874 6572 6e61 6c5f 6879 7065  lf.external_hype
+00002550: 725f 6c69 6e6b 7320 3d20 5b5d 0a20 2020  r_links = [].   
+00002560: 2020 2020 2073 656c 662e 6578 7465 726e       self.extern
+00002570: 616c 5f64 7261 7769 6e67 5f6c 696e 6b73  al_drawing_links
+00002580: 203d 205b 5d0a 2020 2020 2020 2020 7365   = [].        se
+00002590: 6c66 2e65 7874 6572 6e61 6c5f 636f 6d6d  lf.external_comm
+000025a0: 656e 745f 6c69 6e6b 7320 3d20 5b5d 0a20  ent_links = []. 
+000025b0: 2020 2020 2020 2073 656c 662e 6578 7465         self.exte
+000025c0: 726e 616c 5f76 6d6c 5f6c 696e 6b73 203d  rnal_vml_links =
+000025d0: 205b 5d0a 2020 2020 2020 2020 7365 6c66   [].        self
+000025e0: 2e65 7874 6572 6e61 6c5f 7461 626c 655f  .external_table_
+000025f0: 6c69 6e6b 7320 3d20 5b5d 0a20 2020 2020  links = [].     
+00002600: 2020 2073 656c 662e 6578 7465 726e 616c     self.external
+00002610: 5f62 6163 6b67 726f 756e 645f 6c69 6e6b  _background_link
+00002620: 7320 3d20 5b5d 0a20 2020 2020 2020 2073  s = [].        s
+00002630: 656c 662e 6472 6177 696e 675f 6c69 6e6b  elf.drawing_link
+00002640: 7320 3d20 5b5d 0a20 2020 2020 2020 2073  s = [].        s
+00002650: 656c 662e 766d 6c5f 6472 6177 696e 675f  elf.vml_drawing_
+00002660: 6c69 6e6b 7320 3d20 5b5d 0a20 2020 2020  links = [].     
+00002670: 2020 2073 656c 662e 6368 6172 7473 203d     self.charts =
+00002680: 205b 5d0a 2020 2020 2020 2020 7365 6c66   [].        self
+00002690: 2e69 6d61 6765 7320 3d20 5b5d 0a20 2020  .images = [].   
+000026a0: 2020 2020 2073 656c 662e 7461 626c 6573       self.tables
+000026b0: 203d 205b 5d0a 2020 2020 2020 2020 7365   = [].        se
+000026c0: 6c66 2e73 7061 726b 6c69 6e65 7320 3d20  lf.sparklines = 
+000026d0: 5b5d 0a20 2020 2020 2020 2073 656c 662e  [].        self.
+000026e0: 7368 6170 6573 203d 205b 5d0a 2020 2020  shapes = [].    
+000026f0: 2020 2020 7365 6c66 2e73 6861 7065 5f68      self.shape_h
+00002700: 6173 6820 3d20 7b7d 0a20 2020 2020 2020  ash = {}.       
+00002710: 2073 656c 662e 6472 6177 696e 6720 3d20   self.drawing = 
+00002720: 300a 2020 2020 2020 2020 7365 6c66 2e64  0.        self.d
+00002730: 7261 7769 6e67 5f72 656c 7320 3d20 7b7d  rawing_rels = {}
+00002740: 0a20 2020 2020 2020 2073 656c 662e 6472  .        self.dr
+00002750: 6177 696e 675f 7265 6c73 5f69 6420 3d20  awing_rels_id = 
+00002760: 300a 2020 2020 2020 2020 7365 6c66 2e76  0.        self.v
+00002770: 6d6c 5f64 7261 7769 6e67 5f72 656c 7320  ml_drawing_rels 
+00002780: 3d20 7b7d 0a20 2020 2020 2020 2073 656c  = {}.        sel
+00002790: 662e 766d 6c5f 6472 6177 696e 675f 7265  f.vml_drawing_re
+000027a0: 6c73 5f69 6420 3d20 300a 2020 2020 2020  ls_id = 0.      
+000027b0: 2020 7365 6c66 2e62 6163 6b67 726f 756e    self.backgroun
+000027c0: 645f 696d 6167 6520 3d20 4e6f 6e65 0a20  d_image = None. 
+000027d0: 2020 2020 2020 2073 656c 662e 6261 636b         self.back
+000027e0: 6772 6f75 6e64 5f62 7974 6573 203d 2046  ground_bytes = F
+000027f0: 616c 7365 0a0a 2020 2020 2020 2020 7365  alse..        se
+00002800: 6c66 2e72 7374 7269 6e67 203d 2022 220a  lf.rstring = "".
+00002810: 2020 2020 2020 2020 7365 6c66 2e70 7265          self.pre
+00002820: 7669 6f75 735f 726f 7720 3d20 300a 0a20  vious_row = 0.. 
+00002830: 2020 2020 2020 2073 656c 662e 7661 6c69         self.vali
+00002840: 6461 7469 6f6e 7320 3d20 5b5d 0a20 2020  dations = [].   
+00002850: 2020 2020 2073 656c 662e 636f 6e64 5f66       self.cond_f
+00002860: 6f72 6d61 7473 203d 207b 7d0a 2020 2020  ormats = {}.    
+00002870: 2020 2020 7365 6c66 2e64 6174 615f 6261      self.data_ba
+00002880: 7273 5f32 3031 3020 3d20 5b5d 0a20 2020  rs_2010 = [].   
+00002890: 2020 2020 2073 656c 662e 7573 655f 6461       self.use_da
+000028a0: 7461 5f62 6172 735f 3230 3130 203d 2046  ta_bars_2010 = F
+000028b0: 616c 7365 0a20 2020 2020 2020 2073 656c  alse.        sel
+000028c0: 662e 6478 665f 7072 696f 7269 7479 203d  f.dxf_priority =
+000028d0: 2031 0a20 2020 2020 2020 2073 656c 662e   1.        self.
+000028e0: 7061 6765 5f76 6965 7720 3d20 300a 0a20  page_view = 0.. 
+000028f0: 2020 2020 2020 2073 656c 662e 7662 615f         self.vba_
+00002900: 636f 6465 6e61 6d65 203d 204e 6f6e 650a  codename = None.
+00002910: 0a20 2020 2020 2020 2073 656c 662e 6461  .        self.da
+00002920: 7465 5f31 3930 3420 3d20 4661 6c73 650a  te_1904 = False.
+00002930: 2020 2020 2020 2020 7365 6c66 2e68 7970          self.hyp
+00002940: 6572 6c69 6e6b 7320 3d20 6465 6661 756c  erlinks = defaul
+00002950: 7464 6963 7428 6469 6374 290a 0a20 2020  tdict(dict)..   
+00002960: 2020 2020 2073 656c 662e 7374 7269 6e67       self.string
+00002970: 735f 746f 5f6e 756d 6265 7273 203d 2046  s_to_numbers = F
+00002980: 616c 7365 0a20 2020 2020 2020 2073 656c  alse.        sel
+00002990: 662e 7374 7269 6e67 735f 746f 5f75 726c  f.strings_to_url
+000029a0: 7320 3d20 5472 7565 0a20 2020 2020 2020  s = True.       
+000029b0: 2073 656c 662e 6e61 6e5f 696e 665f 746f   self.nan_inf_to
+000029c0: 5f65 7272 6f72 7320 3d20 4661 6c73 650a  _errors = False.
+000029d0: 2020 2020 2020 2020 7365 6c66 2e73 7472          self.str
+000029e0: 696e 6773 5f74 6f5f 666f 726d 756c 6173  ings_to_formulas
+000029f0: 203d 2054 7275 650a 0a20 2020 2020 2020   = True..       
+00002a00: 2073 656c 662e 6465 6661 756c 745f 6461   self.default_da
+00002a10: 7465 5f66 6f72 6d61 7420 3d20 4e6f 6e65  te_format = None
+00002a20: 0a20 2020 2020 2020 2073 656c 662e 6465  .        self.de
+00002a30: 6661 756c 745f 7572 6c5f 666f 726d 6174  fault_url_format
+00002a40: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+00002a50: 7365 6c66 2e72 656d 6f76 655f 7469 6d65  self.remove_time
+00002a60: 7a6f 6e65 203d 2046 616c 7365 0a20 2020  zone = False.   
+00002a70: 2020 2020 2073 656c 662e 6d61 785f 7572       self.max_ur
+00002a80: 6c5f 6c65 6e67 7468 203d 2032 3037 390a  l_length = 2079.
+00002a90: 0a20 2020 2020 2020 2073 656c 662e 726f  .        self.ro
+00002aa0: 775f 6461 7461 5f66 696c 656e 616d 6520  w_data_filename 
+00002ab0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
+00002ac0: 656c 662e 726f 775f 6461 7461 5f66 6820  elf.row_data_fh 
+00002ad0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
+00002ae0: 656c 662e 776f 726b 7368 6565 745f 6d65  elf.worksheet_me
+00002af0: 7461 203d 204e 6f6e 650a 2020 2020 2020  ta = None.      
+00002b00: 2020 7365 6c66 2e76 6d6c 5f64 6174 615f    self.vml_data_
+00002b10: 6964 203d 204e 6f6e 650a 2020 2020 2020  id = None.      
+00002b20: 2020 7365 6c66 2e76 6d6c 5f73 6861 7065    self.vml_shape
+00002b30: 5f69 6420 3d20 4e6f 6e65 0a0a 2020 2020  _id = None..    
+00002b40: 2020 2020 7365 6c66 2e72 6f77 5f64 6174      self.row_dat
+00002b50: 615f 6669 6c65 6e61 6d65 203d 204e 6f6e  a_filename = Non
+00002b60: 650a 2020 2020 2020 2020 7365 6c66 2e72  e.        self.r
+00002b70: 6f77 5f64 6174 615f 6668 203d 204e 6f6e  ow_data_fh = Non
+00002b80: 650a 2020 2020 2020 2020 7365 6c66 2e72  e.        self.r
+00002b90: 6f77 5f64 6174 615f 6668 5f63 6c6f 7365  ow_data_fh_close
+00002ba0: 6420 3d20 4661 6c73 650a 0a20 2020 2020  d = False..     
+00002bb0: 2020 2073 656c 662e 7665 7274 6963 616c     self.vertical
+00002bc0: 5f64 7069 203d 2030 0a20 2020 2020 2020  _dpi = 0.       
+00002bd0: 2073 656c 662e 686f 7269 7a6f 6e74 616c   self.horizontal
+00002be0: 5f64 7069 203d 2030 0a0a 2020 2020 2020  _dpi = 0..      
+00002bf0: 2020 7365 6c66 2e77 7269 7465 5f68 616e    self.write_han
+00002c00: 646c 6572 7320 3d20 7b7d 0a0a 2020 2020  dlers = {}..    
+00002c10: 2020 2020 7365 6c66 2e69 676e 6f72 6564      self.ignored
+00002c20: 5f65 7272 6f72 7320 3d20 4e6f 6e65 0a0a  _errors = None..
+00002c30: 2020 2020 2020 2020 7365 6c66 2e68 6173          self.has
+00002c40: 5f64 796e 616d 6963 5f61 7272 6179 7320  _dynamic_arrays 
+00002c50: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+00002c60: 7365 6c66 2e75 7365 5f66 7574 7572 655f  self.use_future_
+00002c70: 6675 6e63 7469 6f6e 7320 3d20 4661 6c73  functions = Fals
+00002c80: 650a 0a20 2020 2023 2055 7469 6c69 7479  e..    # Utility
+00002c90: 2066 756e 6374 696f 6e20 666f 7220 7772   function for wr
+00002ca0: 6974 696e 6720 6469 6666 6572 656e 7420  iting different 
+00002cb0: 7479 7065 7320 6f66 2073 7472 696e 6773  types of strings
+00002cc0: 2e0a 2020 2020 6465 6620 5f77 7269 7465  ..    def _write
+00002cd0: 5f74 6f6b 656e 5f61 735f 7374 7269 6e67  _token_as_string
+00002ce0: 2873 656c 662c 2074 6f6b 656e 2c20 726f  (self, token, ro
+00002cf0: 772c 2063 6f6c 2c20 2a61 7267 7329 3a0a  w, col, *args):.
+00002d00: 2020 2020 2020 2020 2320 4d61 7020 7468          # Map th
+00002d10: 6520 6461 7461 2074 6f20 7468 6520 6170  e data to the ap
+00002d20: 7072 6f70 7269 6174 6520 7772 6974 655f  propriate write_
+00002d30: 2a28 2920 6d65 7468 6f64 2e0a 2020 2020  *() method..    
+00002d40: 2020 2020 6966 2074 6f6b 656e 203d 3d20      if token == 
+00002d50: 2222 3a0a 2020 2020 2020 2020 2020 2020  "":.            
+00002d60: 7265 7475 726e 2073 656c 662e 5f77 7269  return self._wri
+00002d70: 7465 5f62 6c61 6e6b 2872 6f77 2c20 636f  te_blank(row, co
+00002d80: 6c2c 202a 6172 6773 290a 0a20 2020 2020  l, *args)..     
+00002d90: 2020 2069 6620 7365 6c66 2e73 7472 696e     if self.strin
+00002da0: 6773 5f74 6f5f 666f 726d 756c 6173 2061  gs_to_formulas a
+00002db0: 6e64 2074 6f6b 656e 2e73 7461 7274 7377  nd token.startsw
+00002dc0: 6974 6828 223d 2229 3a0a 2020 2020 2020  ith("="):.      
+00002dd0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00002de0: 662e 5f77 7269 7465 5f66 6f72 6d75 6c61  f._write_formula
+00002df0: 2872 6f77 2c20 636f 6c2c 202a 6172 6773  (row, col, *args
+00002e00: 290a 0a20 2020 2020 2020 2069 6620 746f  )..        if to
+00002e10: 6b65 6e2e 7374 6172 7473 7769 7468 2822  ken.startswith("
+00002e20: 7b3d 2229 2061 6e64 2074 6f6b 656e 2e65  {=") and token.e
+00002e30: 6e64 7377 6974 6828 227d 2229 3a0a 2020  ndswith("}"):.  
+00002e40: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00002e50: 2073 656c 662e 5f77 7269 7465 5f66 6f72   self._write_for
+00002e60: 6d75 6c61 2872 6f77 2c20 636f 6c2c 202a  mula(row, col, *
+00002e70: 6172 6773 290a 0a20 2020 2020 2020 2069  args)..        i
+00002e80: 6620 223a 2220 696e 2074 6f6b 656e 3a0a  f ":" in token:.
+00002e90: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00002ea0: 656c 662e 7374 7269 6e67 735f 746f 5f75  elf.strings_to_u
+00002eb0: 726c 7320 616e 6420 7265 2e6d 6174 6368  rls and re.match
+00002ec0: 2822 2866 7470 7c68 7474 7029 733f 3a2f  ("(ftp|http)s?:/
+00002ed0: 2f22 2c20 746f 6b65 6e29 3a0a 2020 2020  /", token):.    
+00002ee0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00002ef0: 726e 2073 656c 662e 5f77 7269 7465 5f75  rn self._write_u
+00002f00: 726c 2872 6f77 2c20 636f 6c2c 202a 6172  rl(row, col, *ar
+00002f10: 6773 290a 2020 2020 2020 2020 2020 2020  gs).            
+00002f20: 656c 6966 2073 656c 662e 7374 7269 6e67  elif self.string
+00002f30: 735f 746f 5f75 726c 7320 616e 6420 7265  s_to_urls and re
+00002f40: 2e6d 6174 6368 2822 6d61 696c 746f 3a22  .match("mailto:"
+00002f50: 2c20 746f 6b65 6e29 3a0a 2020 2020 2020  , token):.      
+00002f60: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00002f70: 2073 656c 662e 5f77 7269 7465 5f75 726c   self._write_url
+00002f80: 2872 6f77 2c20 636f 6c2c 202a 6172 6773  (row, col, *args
+00002f90: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+00002fa0: 6966 2073 656c 662e 7374 7269 6e67 735f  if self.strings_
+00002fb0: 746f 5f75 726c 7320 616e 6420 7265 2e6d  to_urls and re.m
+00002fc0: 6174 6368 2822 2869 6e7c 6578 2974 6572  atch("(in|ex)ter
+00002fd0: 6e61 6c3a 222c 2074 6f6b 656e 293a 0a20  nal:", token):. 
+00002fe0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00002ff0: 6574 7572 6e20 7365 6c66 2e5f 7772 6974  eturn self._writ
+00003000: 655f 7572 6c28 726f 772c 2063 6f6c 2c20  e_url(row, col, 
+00003010: 2a61 7267 7329 0a0a 2020 2020 2020 2020  *args)..        
+00003020: 6966 2073 656c 662e 7374 7269 6e67 735f  if self.strings_
+00003030: 746f 5f6e 756d 6265 7273 3a0a 2020 2020  to_numbers:.    
+00003040: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+00003050: 2020 2020 2020 2020 2020 2020 2066 203d               f =
+00003060: 2066 6c6f 6174 2874 6f6b 656e 290a 2020   float(token).  
+00003070: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00003080: 2073 656c 662e 6e61 6e5f 696e 665f 746f   self.nan_inf_to
+00003090: 5f65 7272 6f72 7320 6f72 2028 6e6f 7420  _errors or (not 
+000030a0: 6973 6e61 6e28 6629 2061 6e64 206e 6f74  isnan(f) and not
+000030b0: 2069 7369 6e66 2866 2929 3a0a 2020 2020   isinf(f)):.    
+000030c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000030d0: 7265 7475 726e 2073 656c 662e 5f77 7269  return self._wri
+000030e0: 7465 5f6e 756d 6265 7228 726f 772c 2063  te_number(row, c
+000030f0: 6f6c 2c20 662c 202a 6172 6773 5b31 3a5d  ol, f, *args[1:]
+00003100: 290a 2020 2020 2020 2020 2020 2020 6578  ).            ex
+00003110: 6365 7074 2056 616c 7565 4572 726f 723a  cept ValueError:
+00003120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003130: 2023 204e 6f74 2061 206e 756d 6265 722c   # Not a number,
+00003140: 2077 7269 7465 2061 7320 6120 7374 7269   write as a stri
+00003150: 6e67 2e0a 2020 2020 2020 2020 2020 2020  ng..            
+00003160: 2020 2020 7061 7373 0a0a 2020 2020 2020      pass..      
+00003170: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00003180: 662e 5f77 7269 7465 5f73 7472 696e 6728  f._write_string(
+00003190: 726f 772c 2063 6f6c 2c20 2a61 7267 7329  row, col, *args)
+000031a0: 0a0a 2020 2020 2020 2020 656c 7365 3a0a  ..        else:.
+000031b0: 2020 2020 2020 2020 2020 2020 2320 5765              # We
+000031c0: 2068 6176 6520 6120 706c 6169 6e20 7374   have a plain st
+000031d0: 7269 6e67 2e0a 2020 2020 2020 2020 2020  ring..          
+000031e0: 2020 7265 7475 726e 2073 656c 662e 5f77    return self._w
+000031f0: 7269 7465 5f73 7472 696e 6728 726f 772c  rite_string(row,
+00003200: 2063 6f6c 2c20 2a61 7267 7329 0a0a 2020   col, *args)..  
+00003210: 2020 4063 6f6e 7665 7274 5f63 656c 6c5f    @convert_cell_
+00003220: 6172 6773 0a20 2020 2064 6566 2077 7269  args.    def wri
+00003230: 7465 2873 656c 662c 2072 6f77 2c20 636f  te(self, row, co
+00003240: 6c2c 202a 6172 6773 293a 0a20 2020 2020  l, *args):.     
+00003250: 2020 2022 2222 0a20 2020 2020 2020 2057     """.        W
+00003260: 7269 7465 2064 6174 6120 746f 2061 2077  rite data to a w
+00003270: 6f72 6b73 6865 6574 2063 656c 6c20 6279  orksheet cell by
+00003280: 2063 616c 6c69 6e67 2074 6865 2061 7070   calling the app
+00003290: 726f 7072 6961 7465 2077 7269 7465 5f2a  ropriate write_*
+000032a0: 2829 0a20 2020 2020 2020 206d 6574 686f  ().        metho
+000032b0: 6420 6261 7365 6420 6f6e 2074 6865 2074  d based on the t
+000032c0: 7970 6520 6f66 2064 6174 6120 6265 696e  ype of data bein
+000032d0: 6720 7061 7373 6564 2e0a 0a20 2020 2020  g passed...     
+000032e0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+000032f0: 2020 2020 2072 6f77 3a20 2020 5468 6520       row:   The 
+00003300: 6365 6c6c 2072 6f77 2028 7a65 726f 2069  cell row (zero i
+00003310: 6e64 6578 6564 292e 0a20 2020 2020 2020  ndexed)..       
+00003320: 2020 2020 2063 6f6c 3a20 2020 5468 6520       col:   The 
+00003330: 6365 6c6c 2063 6f6c 756d 6e20 287a 6572  cell column (zer
+00003340: 6f20 696e 6465 7865 6429 2e0a 2020 2020  o indexed)..    
+00003350: 2020 2020 2020 2020 2a61 7267 733a 2041          *args: A
+00003360: 7267 7320 746f 2070 6173 7320 746f 2073  rgs to pass to s
+00003370: 7562 2066 756e 6374 696f 6e73 2e0a 0a20  ub functions... 
+00003380: 2020 2020 2020 2052 6574 7572 6e73 3a0a         Returns:.
+00003390: 2020 2020 2020 2020 2020 2020 2030 3a20               0: 
+000033a0: 2020 2053 7563 6365 7373 2e0a 2020 2020     Success..    
+000033b0: 2020 2020 2020 2020 2d31 3a20 2020 2052          -1:    R
+000033c0: 6f77 206f 7220 636f 6c75 6d6e 2069 7320  ow or column is 
+000033d0: 6f75 7420 6f66 2077 6f72 6b73 6865 6574  out of worksheet
+000033e0: 2062 6f75 6e64 732e 0a20 2020 2020 2020   bounds..       
+000033f0: 2020 2020 206f 7468 6572 3a20 5265 7475       other: Retu
+00003400: 726e 2076 616c 7565 206f 6620 6361 6c6c  rn value of call
+00003410: 6564 206d 6574 686f 642e 0a0a 2020 2020  ed method...    
+00003420: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00003430: 7265 7475 726e 2073 656c 662e 5f77 7269  return self._wri
+00003440: 7465 2872 6f77 2c20 636f 6c2c 202a 6172  te(row, col, *ar
+00003450: 6773 290a 0a20 2020 2023 2055 6e64 6563  gs)..    # Undec
+00003460: 6f72 6174 6564 2076 6572 7369 6f6e 206f  orated version o
+00003470: 6620 7772 6974 6528 292e 0a20 2020 2064  f write()..    d
+00003480: 6566 205f 7772 6974 6528 7365 6c66 2c20  ef _write(self, 
+00003490: 726f 772c 2063 6f6c 2c20 2a61 7267 7329  row, col, *args)
+000034a0: 3a0a 2020 2020 2020 2020 2320 4368 6563  :.        # Chec
+000034b0: 6b20 7468 6520 6e75 6d62 6572 206f 6620  k the number of 
+000034c0: 6172 6773 2070 6173 7365 642e 0a20 2020  args passed..   
+000034d0: 2020 2020 2069 6620 6e6f 7420 6172 6773       if not args
+000034e0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+000034f0: 6973 6520 5479 7065 4572 726f 7228 2277  ise TypeError("w
+00003500: 7269 7465 2829 2074 616b 6573 2061 7420  rite() takes at 
+00003510: 6c65 6173 7420 3420 6172 6775 6d65 6e74  least 4 argument
+00003520: 7320 2833 2067 6976 656e 2922 290a 0a20  s (3 given)").. 
+00003530: 2020 2020 2020 2023 2054 6865 2066 6972         # The fir
+00003540: 7374 2061 7267 2073 686f 756c 6420 6265  st arg should be
+00003550: 2074 6865 2074 6f6b 656e 2066 6f72 2061   the token for a
+00003560: 6c6c 2077 7269 7465 2063 616c 6c73 2e0a  ll write calls..
+00003570: 2020 2020 2020 2020 746f 6b65 6e20 3d20          token = 
+00003580: 6172 6773 5b30 5d0a 0a20 2020 2020 2020  args[0]..       
+00003590: 2023 2041 766f 6964 2069 7369 6e73 7461   # Avoid isinsta
+000035a0: 6e63 6528 2920 666f 7220 6265 7474 6572  nce() for better
+000035b0: 2070 6572 666f 726d 616e 6365 2e0a 2020   performance..  
+000035c0: 2020 2020 2020 746f 6b65 6e5f 7479 7065        token_type
+000035d0: 203d 2074 6f6b 656e 2e5f 5f63 6c61 7373   = token.__class
+000035e0: 5f5f 0a0a 2020 2020 2020 2020 2320 4368  __..        # Ch
+000035f0: 6563 6b20 666f 7220 616e 7920 7573 6572  eck for any user
+00003600: 2064 6566 696e 6564 2074 7970 6520 6861   defined type ha
+00003610: 6e64 6c65 7273 2077 6974 6820 6361 6c6c  ndlers with call
+00003620: 6261 636b 2066 756e 6374 696f 6e73 2e0a  back functions..
+00003630: 2020 2020 2020 2020 6966 2074 6f6b 656e          if token
+00003640: 5f74 7970 6520 696e 2073 656c 662e 7772  _type in self.wr
+00003650: 6974 655f 6861 6e64 6c65 7273 3a0a 2020  ite_handlers:.  
+00003660: 2020 2020 2020 2020 2020 7772 6974 655f            write_
+00003670: 6861 6e64 6c65 7220 3d20 7365 6c66 2e77  handler = self.w
+00003680: 7269 7465 5f68 616e 646c 6572 735b 746f  rite_handlers[to
+00003690: 6b65 6e5f 7479 7065 5d0a 2020 2020 2020  ken_type].      
+000036a0: 2020 2020 2020 6675 6e63 7469 6f6e 5f72        function_r
+000036b0: 6574 7572 6e20 3d20 7772 6974 655f 6861  eturn = write_ha
+000036c0: 6e64 6c65 7228 7365 6c66 2c20 726f 772c  ndler(self, row,
+000036d0: 2063 6f6c 2c20 2a61 7267 7329 0a0a 2020   col, *args)..  
+000036e0: 2020 2020 2020 2020 2020 2320 4966 2074            # If t
+000036f0: 6865 2072 6574 7572 6e20 7661 6c75 6520  he return value 
+00003700: 6973 204e 6f6e 6520 7468 656e 2074 6865  is None then the
+00003710: 2063 616c 6c62 6163 6b20 6861 7320 7265   callback has re
+00003720: 7475 726e 6564 0a20 2020 2020 2020 2020  turned.         
+00003730: 2020 2023 2063 6f6e 7472 6f6c 2074 6f20     # control to 
+00003740: 7468 6973 2066 756e 6374 696f 6e20 616e  this function an
+00003750: 6420 7765 2073 686f 756c 6420 636f 6e74  d we should cont
+00003760: 696e 7565 2061 730a 2020 2020 2020 2020  inue as.        
+00003770: 2020 2020 2320 6e6f 726d 616c 2e20 4f74      # normal. Ot
+00003780: 6865 7277 6973 6520 7765 2072 6574 7572  herwise we retur
+00003790: 6e20 7468 6520 7661 6c75 6520 746f 2074  n the value to t
+000037a0: 6865 2063 616c 6c65 7220 616e 6420 6578  he caller and ex
+000037b0: 6974 2e0a 2020 2020 2020 2020 2020 2020  it..            
+000037c0: 6966 2066 756e 6374 696f 6e5f 7265 7475  if function_retu
+000037d0: 726e 2069 7320 4e6f 6e65 3a0a 2020 2020  rn is None:.    
+000037e0: 2020 2020 2020 2020 2020 2020 7061 7373              pass
+000037f0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00003800: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00003810: 2020 2072 6574 7572 6e20 6675 6e63 7469     return functi
+00003820: 6f6e 5f72 6574 7572 6e0a 0a20 2020 2020  on_return..     
+00003830: 2020 2023 2057 7269 7465 204e 6f6e 6520     # Write None 
+00003840: 6173 2061 2062 6c61 6e6b 2063 656c 6c2e  as a blank cell.
+00003850: 0a20 2020 2020 2020 2069 6620 746f 6b65  .        if toke
+00003860: 6e20 6973 204e 6f6e 653a 0a20 2020 2020  n is None:.     
+00003870: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00003880: 6c66 2e5f 7772 6974 655f 626c 616e 6b28  lf._write_blank(
+00003890: 726f 772c 2063 6f6c 2c20 2a61 7267 7329  row, col, *args)
+000038a0: 0a0a 2020 2020 2020 2020 2320 4368 6563  ..        # Chec
+000038b0: 6b20 666f 7220 7374 616e 6461 7264 2050  k for standard P
+000038c0: 7974 686f 6e20 7479 7065 732e 0a20 2020  ython types..   
+000038d0: 2020 2020 2069 6620 746f 6b65 6e5f 7479       if token_ty
+000038e0: 7065 2069 7320 626f 6f6c 3a0a 2020 2020  pe is bool:.    
+000038f0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00003900: 656c 662e 5f77 7269 7465 5f62 6f6f 6c65  elf._write_boole
+00003910: 616e 2872 6f77 2c20 636f 6c2c 202a 6172  an(row, col, *ar
+00003920: 6773 290a 0a20 2020 2020 2020 2069 6620  gs)..        if 
+00003930: 746f 6b65 6e5f 7479 7065 2069 6e20 2866  token_type in (f
+00003940: 6c6f 6174 2c20 696e 742c 2044 6563 696d  loat, int, Decim
+00003950: 616c 2c20 4672 6163 7469 6f6e 293a 0a20  al, Fraction):. 
+00003960: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00003970: 6e20 7365 6c66 2e5f 7772 6974 655f 6e75  n self._write_nu
+00003980: 6d62 6572 2872 6f77 2c20 636f 6c2c 202a  mber(row, col, *
+00003990: 6172 6773 290a 0a20 2020 2020 2020 2069  args)..        i
+000039a0: 6620 746f 6b65 6e5f 7479 7065 2069 7320  f token_type is 
+000039b0: 7374 723a 0a20 2020 2020 2020 2020 2020  str:.           
+000039c0: 2072 6574 7572 6e20 7365 6c66 2e5f 7772   return self._wr
+000039d0: 6974 655f 746f 6b65 6e5f 6173 5f73 7472  ite_token_as_str
+000039e0: 696e 6728 746f 6b65 6e2c 2072 6f77 2c20  ing(token, row, 
+000039f0: 636f 6c2c 202a 6172 6773 290a 0a20 2020  col, *args)..   
+00003a00: 2020 2020 2069 6620 746f 6b65 6e5f 7479       if token_ty
+00003a10: 7065 2069 6e20 280a 2020 2020 2020 2020  pe in (.        
+00003a20: 2020 2020 6461 7465 7469 6d65 2e64 6174      datetime.dat
+00003a30: 6574 696d 652c 0a20 2020 2020 2020 2020  etime,.         
+00003a40: 2020 2064 6174 6574 696d 652e 6461 7465     datetime.date
+00003a50: 2c0a 2020 2020 2020 2020 2020 2020 6461  ,.            da
+00003a60: 7465 7469 6d65 2e74 696d 652c 0a20 2020  tetime.time,.   
+00003a70: 2020 2020 2020 2020 2064 6174 6574 696d           datetim
+00003a80: 652e 7469 6d65 6465 6c74 612c 0a20 2020  e.timedelta,.   
+00003a90: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+00003aa0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00003ab0: 5f77 7269 7465 5f64 6174 6574 696d 6528  _write_datetime(
+00003ac0: 726f 772c 2063 6f6c 2c20 2a61 7267 7329  row, col, *args)
+00003ad0: 0a0a 2020 2020 2020 2020 2320 5265 736f  ..        # Reso
+00003ae0: 7274 2074 6f20 6973 696e 7374 616e 6365  rt to isinstance
+00003af0: 2829 2066 6f72 2073 7562 636c 6173 7365  () for subclasse
+00003b00: 6420 7072 696d 6974 6976 6573 2e0a 0a20  d primitives... 
+00003b10: 2020 2020 2020 2023 2057 7269 7465 206e         # Write n
+00003b20: 756d 6265 7220 7479 7065 732e 0a20 2020  umber types..   
+00003b30: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00003b40: 6365 2874 6f6b 656e 2c20 2866 6c6f 6174  ce(token, (float
+00003b50: 2c20 696e 742c 2044 6563 696d 616c 2c20  , int, Decimal, 
+00003b60: 4672 6163 7469 6f6e 2929 3a0a 2020 2020  Fraction)):.    
+00003b70: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00003b80: 656c 662e 5f77 7269 7465 5f6e 756d 6265  elf._write_numbe
+00003b90: 7228 726f 772c 2063 6f6c 2c20 2a61 7267  r(row, col, *arg
+00003ba0: 7329 0a0a 2020 2020 2020 2020 2320 5772  s)..        # Wr
+00003bb0: 6974 6520 7374 7269 6e67 2074 7970 6573  ite string types
+00003bc0: 2e0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
+00003bd0: 6e73 7461 6e63 6528 746f 6b65 6e2c 2073  nstance(token, s
+00003be0: 7472 293a 0a20 2020 2020 2020 2020 2020  tr):.           
+00003bf0: 2072 6574 7572 6e20 7365 6c66 2e5f 7772   return self._wr
+00003c00: 6974 655f 746f 6b65 6e5f 6173 5f73 7472  ite_token_as_str
+00003c10: 696e 6728 746f 6b65 6e2c 2072 6f77 2c20  ing(token, row, 
+00003c20: 636f 6c2c 202a 6172 6773 290a 0a20 2020  col, *args)..   
+00003c30: 2020 2020 2023 2057 7269 7465 2062 6f6f       # Write boo
+00003c40: 6c65 616e 2074 7970 6573 2e0a 2020 2020  lean types..    
+00003c50: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00003c60: 6528 746f 6b65 6e2c 2062 6f6f 6c29 3a0a  e(token, bool):.
+00003c70: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00003c80: 726e 2073 656c 662e 5f77 7269 7465 5f62  rn self._write_b
+00003c90: 6f6f 6c65 616e 2872 6f77 2c20 636f 6c2c  oolean(row, col,
+00003ca0: 202a 6172 6773 290a 0a20 2020 2020 2020   *args)..       
+00003cb0: 2023 2057 7269 7465 2064 6174 6574 696d   # Write datetim
+00003cc0: 6520 6f62 6a65 6374 732e 0a20 2020 2020  e objects..     
+00003cd0: 2020 2069 6620 7375 7070 6f72 7465 645f     if supported_
+00003ce0: 6461 7465 7469 6d65 2874 6f6b 656e 293a  datetime(token):
+00003cf0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00003d00: 7572 6e20 7365 6c66 2e5f 7772 6974 655f  urn self._write_
+00003d10: 6461 7465 7469 6d65 2872 6f77 2c20 636f  datetime(row, co
+00003d20: 6c2c 202a 6172 6773 290a 0a20 2020 2020  l, *args)..     
+00003d30: 2020 2023 2057 6520 6861 7665 6e27 7420     # We haven't 
+00003d40: 6d61 7463 6865 6420 6120 7375 7070 6f72  matched a suppor
+00003d50: 7465 6420 7479 7065 2e20 5472 7920 666c  ted type. Try fl
+00003d60: 6f61 742e 0a20 2020 2020 2020 2074 7279  oat..        try
+00003d70: 3a0a 2020 2020 2020 2020 2020 2020 6620  :.            f 
+00003d80: 3d20 666c 6f61 7428 746f 6b65 6e29 0a20  = float(token). 
+00003d90: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00003da0: 6e20 7365 6c66 2e5f 7772 6974 655f 6e75  n self._write_nu
+00003db0: 6d62 6572 2872 6f77 2c20 636f 6c2c 2066  mber(row, col, f
+00003dc0: 2c20 2a61 7267 735b 313a 5d29 0a20 2020  , *args[1:]).   
+00003dd0: 2020 2020 2065 7863 6570 7420 5661 6c75       except Valu
+00003de0: 6545 7272 6f72 3a0a 2020 2020 2020 2020  eError:.        
+00003df0: 2020 2020 7061 7373 0a20 2020 2020 2020      pass.       
+00003e00: 2065 7863 6570 7420 5479 7065 4572 726f   except TypeErro
+00003e10: 723a 0a20 2020 2020 2020 2020 2020 2072  r:.            r
+00003e20: 6169 7365 2054 7970 6545 7272 6f72 2822  aise TypeError("
+00003e30: 556e 7375 7070 6f72 7465 6420 7479 7065  Unsupported type
+00003e40: 2025 7320 696e 2077 7269 7465 2829 2220   %s in write()" 
+00003e50: 2520 7479 7065 2874 6f6b 656e 2929 0a0a  % type(token))..
+00003e60: 2020 2020 2020 2020 2320 4669 6e61 6c6c          # Finall
+00003e70: 7920 7472 7920 7374 7269 6e67 2e0a 2020  y try string..  
+00003e80: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
+00003e90: 2020 2020 2020 2073 7472 2874 6f6b 656e         str(token
+00003ea0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00003eb0: 7475 726e 2073 656c 662e 5f77 7269 7465  turn self._write
+00003ec0: 5f73 7472 696e 6728 726f 772c 2063 6f6c  _string(row, col
+00003ed0: 2c20 2a61 7267 7329 0a20 2020 2020 2020  , *args).       
+00003ee0: 2065 7863 6570 7420 5661 6c75 6545 7272   except ValueErr
+00003ef0: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+00003f00: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+00003f10: 2255 6e73 7570 706f 7274 6564 2074 7970  "Unsupported typ
+00003f20: 6520 2573 2069 6e20 7772 6974 6528 2922  e %s in write()"
+00003f30: 2025 2074 7970 6528 746f 6b65 6e29 290a   % type(token)).
+00003f40: 0a20 2020 2040 636f 6e76 6572 745f 6365  .    @convert_ce
+00003f50: 6c6c 5f61 7267 730a 2020 2020 6465 6620  ll_args.    def 
+00003f60: 7772 6974 655f 7374 7269 6e67 2873 656c  write_string(sel
+00003f70: 662c 2072 6f77 2c20 636f 6c2c 2073 7472  f, row, col, str
+00003f80: 696e 672c 2063 656c 6c5f 666f 726d 6174  ing, cell_format
+00003f90: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00003fa0: 2222 220a 2020 2020 2020 2020 5772 6974  """.        Writ
+00003fb0: 6520 6120 7374 7269 6e67 2074 6f20 6120  e a string to a 
+00003fc0: 776f 726b 7368 6565 7420 6365 6c6c 2e0a  worksheet cell..
+00003fd0: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
+00003fe0: 2020 2020 2020 2020 2020 2072 6f77 3a20             row: 
+00003ff0: 2020 2054 6865 2063 656c 6c20 726f 7720     The cell row 
+00004000: 287a 6572 6f20 696e 6465 7865 6429 2e0a  (zero indexed)..
+00004010: 2020 2020 2020 2020 2020 2020 636f 6c3a              col:
+00004020: 2020 2020 5468 6520 6365 6c6c 2063 6f6c      The cell col
+00004030: 756d 6e20 287a 6572 6f20 696e 6465 7865  umn (zero indexe
+00004040: 6429 2e0a 2020 2020 2020 2020 2020 2020  d)..            
+00004050: 7374 7269 6e67 3a20 4365 6c6c 2064 6174  string: Cell dat
+00004060: 612e 2053 7472 2e0a 2020 2020 2020 2020  a. Str..        
+00004070: 2020 2020 666f 726d 6174 3a20 416e 206f      format: An o
+00004080: 7074 696f 6e61 6c20 6365 6c6c 2046 6f72  ptional cell For
+00004090: 6d61 7420 6f62 6a65 6374 2e0a 0a20 2020  mat object...   
+000040a0: 2020 2020 2052 6574 7572 6e73 3a0a 2020       Returns:.  
+000040b0: 2020 2020 2020 2020 2020 303a 2020 5375            0:  Su
+000040c0: 6363 6573 732e 0a20 2020 2020 2020 2020  ccess..         
+000040d0: 2020 202d 313a 2052 6f77 206f 7220 636f     -1: Row or co
+000040e0: 6c75 6d6e 2069 7320 6f75 7420 6f66 2077  lumn is out of w
+000040f0: 6f72 6b73 6865 6574 2062 6f75 6e64 732e  orksheet bounds.
+00004100: 0a20 2020 2020 2020 2020 2020 202d 323a  .            -2:
+00004110: 2053 7472 696e 6720 7472 756e 6361 7465   String truncate
+00004120: 6420 746f 2033 326b 2063 6861 7261 6374  d to 32k charact
+00004130: 6572 732e 0a0a 2020 2020 2020 2020 2222  ers...        ""
+00004140: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00004150: 2073 656c 662e 5f77 7269 7465 5f73 7472   self._write_str
+00004160: 696e 6728 726f 772c 2063 6f6c 2c20 7374  ing(row, col, st
+00004170: 7269 6e67 2c20 6365 6c6c 5f66 6f72 6d61  ring, cell_forma
+00004180: 7429 0a0a 2020 2020 2320 556e 6465 636f  t)..    # Undeco
+00004190: 7261 7465 6420 7665 7273 696f 6e20 6f66  rated version of
+000041a0: 2077 7269 7465 5f73 7472 696e 6728 292e   write_string().
+000041b0: 0a20 2020 2064 6566 205f 7772 6974 655f  .    def _write_
+000041c0: 7374 7269 6e67 2873 656c 662c 2072 6f77  string(self, row
+000041d0: 2c20 636f 6c2c 2073 7472 696e 672c 2063  , col, string, c
+000041e0: 656c 6c5f 666f 726d 6174 3d4e 6f6e 6529  ell_format=None)
+000041f0: 3a0a 2020 2020 2020 2020 7374 725f 6572  :.        str_er
+00004200: 726f 7220 3d20 300a 0a20 2020 2020 2020  ror = 0..       
+00004210: 2023 2043 6865 636b 2074 6861 7420 726f   # Check that ro
+00004220: 7720 616e 6420 636f 6c20 6172 6520 7661  w and col are va
+00004230: 6c69 6420 616e 6420 7374 6f72 6520 6d61  lid and store ma
+00004240: 7820 616e 6420 6d69 6e20 7661 6c75 6573  x and min values
+00004250: 2e0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+00004260: 662e 5f63 6865 636b 5f64 696d 656e 7369  f._check_dimensi
+00004270: 6f6e 7328 726f 772c 2063 6f6c 293a 0a20  ons(row, col):. 
+00004280: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00004290: 6e20 2d31 0a0a 2020 2020 2020 2020 2320  n -1..        # 
+000042a0: 4368 6563 6b20 7468 6174 2074 6865 2073  Check that the s
+000042b0: 7472 696e 6720 6973 203c 2033 3237 3637  tring is < 32767
+000042c0: 2063 6861 7273 2e0a 2020 2020 2020 2020   chars..        
+000042d0: 6966 206c 656e 2873 7472 696e 6729 203e  if len(string) >
+000042e0: 2073 656c 662e 786c 735f 7374 726d 6178   self.xls_strmax
+000042f0: 3a0a 2020 2020 2020 2020 2020 2020 7374  :.            st
+00004300: 7269 6e67 203d 2073 7472 696e 675b 3a20  ring = string[: 
+00004310: 7365 6c66 2e78 6c73 5f73 7472 6d61 785d  self.xls_strmax]
+00004320: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
+00004330: 5f65 7272 6f72 203d 202d 320a 0a20 2020  _error = -2..   
+00004340: 2020 2020 2023 2057 7269 7465 2061 2073       # Write a s
+00004350: 6861 7265 6420 7374 7269 6e67 206f 7220  hared string or 
+00004360: 616e 2069 6e2d 6c69 6e65 2073 7472 696e  an in-line strin
+00004370: 6720 696e 2063 6f6e 7374 616e 745f 6d65  g in constant_me
+00004380: 6d6f 7279 206d 6f64 652e 0a20 2020 2020  mory mode..     
+00004390: 2020 2069 6620 6e6f 7420 7365 6c66 2e63     if not self.c
+000043a0: 6f6e 7374 616e 745f 6d65 6d6f 7279 3a0a  onstant_memory:.
+000043b0: 2020 2020 2020 2020 2020 2020 7374 7269              stri
+000043c0: 6e67 5f69 6e64 6578 203d 2073 656c 662e  ng_index = self.
+000043d0: 7374 725f 7461 626c 652e 5f67 6574 5f73  str_table._get_s
+000043e0: 6861 7265 645f 7374 7269 6e67 5f69 6e64  hared_string_ind
+000043f0: 6578 2873 7472 696e 6729 0a20 2020 2020  ex(string).     
+00004400: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00004410: 2020 2020 2073 7472 696e 675f 696e 6465       string_inde
+00004420: 7820 3d20 7374 7269 6e67 0a0a 2020 2020  x = string..    
+00004430: 2020 2020 2320 5772 6974 6520 7072 6576      # Write prev
+00004440: 696f 7573 2072 6f77 2069 6620 696e 2069  ious row if in i
+00004450: 6e2d 6c69 6e65 2073 7472 696e 6720 636f  n-line string co
+00004460: 6e73 7461 6e74 5f6d 656d 6f72 7920 6d6f  nstant_memory mo
+00004470: 6465 2e0a 2020 2020 2020 2020 6966 2073  de..        if s
+00004480: 656c 662e 636f 6e73 7461 6e74 5f6d 656d  elf.constant_mem
+00004490: 6f72 7920 616e 6420 726f 7720 3e20 7365  ory and row > se
+000044a0: 6c66 2e70 7265 7669 6f75 735f 726f 773a  lf.previous_row:
+000044b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000044c0: 662e 5f77 7269 7465 5f73 696e 676c 655f  f._write_single_
+000044d0: 726f 7728 726f 7729 0a0a 2020 2020 2020  row(row)..      
+000044e0: 2020 2320 5374 6f72 6520 7468 6520 6365    # Store the ce
+000044f0: 6c6c 2064 6174 6120 696e 2074 6865 2077  ll data in the w
+00004500: 6f72 6b73 6865 6574 2064 6174 6120 7461  orksheet data ta
+00004510: 626c 652e 0a20 2020 2020 2020 2073 656c  ble..        sel
+00004520: 662e 7461 626c 655b 726f 775d 5b63 6f6c  f.table[row][col
+00004530: 5d20 3d20 6365 6c6c 5f73 7472 696e 675f  ] = cell_string_
+00004540: 7475 706c 6528 7374 7269 6e67 5f69 6e64  tuple(string_ind
+00004550: 6578 2c20 6365 6c6c 5f66 6f72 6d61 7429  ex, cell_format)
+00004560: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00004570: 2073 7472 5f65 7272 6f72 0a0a 2020 2020   str_error..    
+00004580: 4063 6f6e 7665 7274 5f63 656c 6c5f 6172  @convert_cell_ar
+00004590: 6773 0a20 2020 2064 6566 2077 7269 7465  gs.    def write
+000045a0: 5f6e 756d 6265 7228 7365 6c66 2c20 726f  _number(self, ro
+000045b0: 772c 2063 6f6c 2c20 6e75 6d62 6572 2c20  w, col, number, 
+000045c0: 6365 6c6c 5f66 6f72 6d61 743d 4e6f 6e65  cell_format=None
+000045d0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+000045e0: 2020 2020 2020 2057 7269 7465 2061 206e         Write a n
+000045f0: 756d 6265 7220 746f 2061 2077 6f72 6b73  umber to a works
+00004600: 6865 6574 2063 656c 6c2e 0a0a 2020 2020  heet cell...    
+00004610: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+00004620: 2020 2020 2020 726f 773a 2020 2020 2020        row:      
+00004630: 2020 2054 6865 2063 656c 6c20 726f 7720     The cell row 
+00004640: 287a 6572 6f20 696e 6465 7865 6429 2e0a  (zero indexed)..
+00004650: 2020 2020 2020 2020 2020 2020 636f 6c3a              col:
+00004660: 2020 2020 2020 2020 2054 6865 2063 656c           The cel
+00004670: 6c20 636f 6c75 6d6e 2028 7a65 726f 2069  l column (zero i
+00004680: 6e64 6578 6564 292e 0a20 2020 2020 2020  ndexed)..       
+00004690: 2020 2020 206e 756d 6265 723a 2020 2020       number:    
+000046a0: 2020 4365 6c6c 2064 6174 612e 2049 6e74    Cell data. Int
+000046b0: 206f 7220 666c 6f61 742e 0a20 2020 2020   or float..     
+000046c0: 2020 2020 2020 2063 656c 6c5f 666f 726d         cell_form
+000046d0: 6174 3a20 416e 206f 7074 696f 6e61 6c20  at: An optional 
+000046e0: 6365 6c6c 2046 6f72 6d61 7420 6f62 6a65  cell Format obje
+000046f0: 6374 2e0a 0a20 2020 2020 2020 2052 6574  ct...        Ret
+00004700: 7572 6e73 3a0a 2020 2020 2020 2020 2020  urns:.          
+00004710: 2020 303a 2020 5375 6363 6573 732e 0a20    0:  Success.. 
+00004720: 2020 2020 2020 2020 2020 202d 313a 2052             -1: R
+00004730: 6f77 206f 7220 636f 6c75 6d6e 2069 7320  ow or column is 
+00004740: 6f75 7420 6f66 2077 6f72 6b73 6865 6574  out of worksheet
+00004750: 2062 6f75 6e64 732e 0a0a 2020 2020 2020   bounds...      
+00004760: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+00004770: 7475 726e 2073 656c 662e 5f77 7269 7465  turn self._write
+00004780: 5f6e 756d 6265 7228 726f 772c 2063 6f6c  _number(row, col
+00004790: 2c20 6e75 6d62 6572 2c20 6365 6c6c 5f66  , number, cell_f
+000047a0: 6f72 6d61 7429 0a0a 2020 2020 2320 556e  ormat)..    # Un
+000047b0: 6465 636f 7261 7465 6420 7665 7273 696f  decorated versio
+000047c0: 6e20 6f66 2077 7269 7465 5f6e 756d 6265  n of write_numbe
+000047d0: 7228 292e 0a20 2020 2064 6566 205f 7772  r()..    def _wr
+000047e0: 6974 655f 6e75 6d62 6572 2873 656c 662c  ite_number(self,
+000047f0: 2072 6f77 2c20 636f 6c2c 206e 756d 6265   row, col, numbe
+00004800: 722c 2063 656c 6c5f 666f 726d 6174 3d4e  r, cell_format=N
+00004810: 6f6e 6529 3a0a 2020 2020 2020 2020 6966  one):.        if
+00004820: 2069 736e 616e 286e 756d 6265 7229 206f   isnan(number) o
+00004830: 7220 6973 696e 6628 6e75 6d62 6572 293a  r isinf(number):
+00004840: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00004850: 7365 6c66 2e6e 616e 5f69 6e66 5f74 6f5f  self.nan_inf_to_
+00004860: 6572 726f 7273 3a0a 2020 2020 2020 2020  errors:.        
+00004870: 2020 2020 2020 2020 6966 2069 736e 616e          if isnan
+00004880: 286e 756d 6265 7229 3a0a 2020 2020 2020  (number):.      
+00004890: 2020 2020 2020 2020 2020 2020 2020 7265                re
+000048a0: 7475 726e 2073 656c 662e 5f77 7269 7465  turn self._write
+000048b0: 5f66 6f72 6d75 6c61 2872 6f77 2c20 636f  _formula(row, co
+000048c0: 6c2c 2022 234e 554d 2122 2c20 6365 6c6c  l, "#NUM!", cell
+000048d0: 5f66 6f72 6d61 742c 2022 234e 554d 2122  _format, "#NUM!"
+000048e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000048f0: 2020 656c 6966 206e 756d 6265 7220 3d3d    elif number ==
+00004900: 206d 6174 682e 696e 663a 0a20 2020 2020   math.inf:.     
+00004910: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00004920: 6574 7572 6e20 7365 6c66 2e5f 7772 6974  eturn self._writ
+00004930: 655f 666f 726d 756c 6128 726f 772c 2063  e_formula(row, c
+00004940: 6f6c 2c20 2231 2f30 222c 2063 656c 6c5f  ol, "1/0", cell_
+00004950: 666f 726d 6174 2c20 2223 4449 562f 3021  format, "#DIV/0!
+00004960: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+00004970: 2020 2065 6c69 6620 6e75 6d62 6572 203d     elif number =
+00004980: 3d20 2d6d 6174 682e 696e 663a 0a20 2020  = -math.inf:.   
+00004990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000049a0: 2072 6574 7572 6e20 7365 6c66 2e5f 7772   return self._wr
+000049b0: 6974 655f 666f 726d 756c 6128 726f 772c  ite_formula(row,
+000049c0: 2063 6f6c 2c20 222d 312f 3022 2c20 6365   col, "-1/0", ce
+000049d0: 6c6c 5f66 6f72 6d61 742c 2022 2344 4956  ll_format, "#DIV
+000049e0: 2f30 2122 290a 2020 2020 2020 2020 2020  /0!").          
+000049f0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00004a00: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00004a10: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
+00004a20: 2020 2020 2020 2020 2020 2020 2022 4e41               "NA
+00004a30: 4e2f 494e 4620 6e6f 7420 7375 7070 6f72  N/INF not suppor
+00004a40: 7465 6420 696e 2077 7269 7465 5f6e 756d  ted in write_num
+00004a50: 6265 7228 2920 220a 2020 2020 2020 2020  ber() ".        
+00004a60: 2020 2020 2020 2020 2020 2020 2277 6974              "wit
+00004a70: 686f 7574 2027 6e61 6e5f 696e 665f 746f  hout 'nan_inf_to
+00004a80: 5f65 7272 6f72 7327 2057 6f72 6b62 6f6f  _errors' Workboo
+00004a90: 6b28 2920 6f70 7469 6f6e 220a 2020 2020  k() option".    
+00004aa0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00004ab0: 2020 2020 2020 2023 2043 6865 636b 2074         # Check t
+00004ac0: 6861 7420 726f 7720 616e 6420 636f 6c20  hat row and col 
+00004ad0: 6172 6520 7661 6c69 6420 616e 6420 7374  are valid and st
+00004ae0: 6f72 6520 6d61 7820 616e 6420 6d69 6e20  ore max and min 
+00004af0: 7661 6c75 6573 2e0a 2020 2020 2020 2020  values..        
+00004b00: 6966 2073 656c 662e 5f63 6865 636b 5f64  if self._check_d
+00004b10: 696d 656e 7369 6f6e 7328 726f 772c 2063  imensions(row, c
+00004b20: 6f6c 293a 0a20 2020 2020 2020 2020 2020  ol):.           
+00004b30: 2072 6574 7572 6e20 2d31 0a0a 2020 2020   return -1..    
+00004b40: 2020 2020 2320 5772 6974 6520 7072 6576      # Write prev
+00004b50: 696f 7573 2072 6f77 2069 6620 696e 2069  ious row if in i
+00004b60: 6e2d 6c69 6e65 2073 7472 696e 6720 636f  n-line string co
+00004b70: 6e73 7461 6e74 5f6d 656d 6f72 7920 6d6f  nstant_memory mo
+00004b80: 6465 2e0a 2020 2020 2020 2020 6966 2073  de..        if s
+00004b90: 656c 662e 636f 6e73 7461 6e74 5f6d 656d  elf.constant_mem
+00004ba0: 6f72 7920 616e 6420 726f 7720 3e20 7365  ory and row > se
+00004bb0: 6c66 2e70 7265 7669 6f75 735f 726f 773a  lf.previous_row:
+00004bc0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00004bd0: 662e 5f77 7269 7465 5f73 696e 676c 655f  f._write_single_
+00004be0: 726f 7728 726f 7729 0a0a 2020 2020 2020  row(row)..      
+00004bf0: 2020 2320 5374 6f72 6520 7468 6520 6365    # Store the ce
+00004c00: 6c6c 2064 6174 6120 696e 2074 6865 2077  ll data in the w
+00004c10: 6f72 6b73 6865 6574 2064 6174 6120 7461  orksheet data ta
+00004c20: 626c 652e 0a20 2020 2020 2020 2073 656c  ble..        sel
+00004c30: 662e 7461 626c 655b 726f 775d 5b63 6f6c  f.table[row][col
+00004c40: 5d20 3d20 6365 6c6c 5f6e 756d 6265 725f  ] = cell_number_
+00004c50: 7475 706c 6528 6e75 6d62 6572 2c20 6365  tuple(number, ce
+00004c60: 6c6c 5f66 6f72 6d61 7429 0a0a 2020 2020  ll_format)..    
+00004c70: 2020 2020 7265 7475 726e 2030 0a0a 2020      return 0..  
+00004c80: 2020 4063 6f6e 7665 7274 5f63 656c 6c5f    @convert_cell_
+00004c90: 6172 6773 0a20 2020 2064 6566 2077 7269  args.    def wri
+00004ca0: 7465 5f62 6c61 6e6b 2873 656c 662c 2072  te_blank(self, r
+00004cb0: 6f77 2c20 636f 6c2c 2062 6c61 6e6b 2c20  ow, col, blank, 
+00004cc0: 6365 6c6c 5f66 6f72 6d61 743d 4e6f 6e65  cell_format=None
+00004cd0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00004ce0: 2020 2020 2020 2057 7269 7465 2061 2062         Write a b
+00004cf0: 6c61 6e6b 2063 656c 6c20 7769 7468 2066  lank cell with f
+00004d00: 6f72 6d61 7474 696e 6720 746f 2061 2077  ormatting to a w
+00004d10: 6f72 6b73 6865 6574 2063 656c 6c2e 2054  orksheet cell. T
+00004d20: 6865 2062 6c61 6e6b 0a20 2020 2020 2020  he blank.       
+00004d30: 2074 6f6b 656e 2069 7320 6967 6e6f 7265   token is ignore
+00004d40: 6420 616e 6420 7468 6520 666f 726d 6174  d and the format
+00004d50: 206f 6e6c 7920 6973 2077 7269 7474 656e   only is written
+00004d60: 2074 6f20 7468 6520 6365 6c6c 2e0a 0a20   to the cell... 
+00004d70: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
+00004d80: 2020 2020 2020 2020 2072 6f77 3a20 2020           row:   
+00004d90: 2020 2020 2020 5468 6520 6365 6c6c 2072        The cell r
+00004da0: 6f77 2028 7a65 726f 2069 6e64 6578 6564  ow (zero indexed
+00004db0: 292e 0a20 2020 2020 2020 2020 2020 2063  )..            c
+00004dc0: 6f6c 3a20 2020 2020 2020 2020 5468 6520  ol:         The 
+00004dd0: 6365 6c6c 2063 6f6c 756d 6e20 287a 6572  cell column (zer
+00004de0: 6f20 696e 6465 7865 6429 2e0a 2020 2020  o indexed)..    
+00004df0: 2020 2020 2020 2020 626c 616e 6b3a 2020          blank:  
+00004e00: 2020 2020 2041 6e79 2076 616c 7565 2e20       Any value. 
+00004e10: 4974 2069 7320 6967 6e6f 7265 642e 0a20  It is ignored.. 
+00004e20: 2020 2020 2020 2020 2020 2063 656c 6c5f             cell_
+00004e30: 666f 726d 6174 3a20 416e 206f 7074 696f  format: An optio
+00004e40: 6e61 6c20 6365 6c6c 2046 6f72 6d61 7420  nal cell Format 
+00004e50: 6f62 6a65 6374 2e0a 0a20 2020 2020 2020  object...       
+00004e60: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
+00004e70: 2020 2020 2020 303a 2020 5375 6363 6573        0:  Succes
+00004e80: 732e 0a20 2020 2020 2020 2020 2020 202d  s..            -
+00004e90: 313a 2052 6f77 206f 7220 636f 6c75 6d6e  1: Row or column
+00004ea0: 2069 7320 6f75 7420 6f66 2077 6f72 6b73   is out of works
+00004eb0: 6865 6574 2062 6f75 6e64 732e 0a0a 2020  heet bounds...  
+00004ec0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00004ed0: 2020 7265 7475 726e 2073 656c 662e 5f77    return self._w
+00004ee0: 7269 7465 5f62 6c61 6e6b 2872 6f77 2c20  rite_blank(row, 
+00004ef0: 636f 6c2c 2062 6c61 6e6b 2c20 6365 6c6c  col, blank, cell
+00004f00: 5f66 6f72 6d61 7429 0a0a 2020 2020 2320  _format)..    # 
+00004f10: 556e 6465 636f 7261 7465 6420 7665 7273  Undecorated vers
+00004f20: 696f 6e20 6f66 2077 7269 7465 5f62 6c61  ion of write_bla
+00004f30: 6e6b 2829 2e0a 2020 2020 6465 6620 5f77  nk()..    def _w
+00004f40: 7269 7465 5f62 6c61 6e6b 2873 656c 662c  rite_blank(self,
+00004f50: 2072 6f77 2c20 636f 6c2c 2062 6c61 6e6b   row, col, blank
+00004f60: 2c20 6365 6c6c 5f66 6f72 6d61 743d 4e6f  , cell_format=No
+00004f70: 6e65 293a 0a20 2020 2020 2020 2023 2044  ne):.        # D
+00004f80: 6f6e 2774 2077 7269 7465 2061 2062 6c61  on't write a bla
+00004f90: 6e6b 2063 656c 6c20 756e 6c65 7373 2069  nk cell unless i
+00004fa0: 7420 6861 7320 6120 666f 726d 6174 2e0a  t has a format..
+00004fb0: 2020 2020 2020 2020 6966 2063 656c 6c5f          if cell_
+00004fc0: 666f 726d 6174 2069 7320 4e6f 6e65 3a0a  format is None:.
+00004fd0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00004fe0: 726e 2030 0a0a 2020 2020 2020 2020 2320  rn 0..        # 
+00004ff0: 4368 6563 6b20 7468 6174 2072 6f77 2061  Check that row a
+00005000: 6e64 2063 6f6c 2061 7265 2076 616c 6964  nd col are valid
+00005010: 2061 6e64 2073 746f 7265 206d 6178 2061   and store max a
+00005020: 6e64 206d 696e 2076 616c 7565 732e 0a20  nd min values.. 
+00005030: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+00005040: 6368 6563 6b5f 6469 6d65 6e73 696f 6e73  check_dimensions
+00005050: 2872 6f77 2c20 636f 6c29 3a0a 2020 2020  (row, col):.    
+00005060: 2020 2020 2020 2020 7265 7475 726e 202d          return -
+00005070: 310a 0a20 2020 2020 2020 2023 2057 7269  1..        # Wri
+00005080: 7465 2070 7265 7669 6f75 7320 726f 7720  te previous row 
+00005090: 6966 2069 6e20 696e 2d6c 696e 6520 7374  if in in-line st
+000050a0: 7269 6e67 2063 6f6e 7374 616e 745f 6d65  ring constant_me
+000050b0: 6d6f 7279 206d 6f64 652e 0a20 2020 2020  mory mode..     
+000050c0: 2020 2069 6620 7365 6c66 2e63 6f6e 7374     if self.const
+000050d0: 616e 745f 6d65 6d6f 7279 2061 6e64 2072  ant_memory and r
+000050e0: 6f77 203e 2073 656c 662e 7072 6576 696f  ow > self.previo
+000050f0: 7573 5f72 6f77 3a0a 2020 2020 2020 2020  us_row:.        
+00005100: 2020 2020 7365 6c66 2e5f 7772 6974 655f      self._write_
+00005110: 7369 6e67 6c65 5f72 6f77 2872 6f77 290a  single_row(row).
+00005120: 0a20 2020 2020 2020 2023 2053 746f 7265  .        # Store
+00005130: 2074 6865 2063 656c 6c20 6461 7461 2069   the cell data i
+00005140: 6e20 7468 6520 776f 726b 7368 6565 7420  n the worksheet 
+00005150: 6461 7461 2074 6162 6c65 2e0a 2020 2020  data table..    
+00005160: 2020 2020 7365 6c66 2e74 6162 6c65 5b72      self.table[r
+00005170: 6f77 5d5b 636f 6c5d 203d 2063 656c 6c5f  ow][col] = cell_
+00005180: 626c 616e 6b5f 7475 706c 6528 6365 6c6c  blank_tuple(cell
+00005190: 5f66 6f72 6d61 7429 0a0a 2020 2020 2020  _format)..      
+000051a0: 2020 7265 7475 726e 2030 0a0a 2020 2020    return 0..    
+000051b0: 4063 6f6e 7665 7274 5f63 656c 6c5f 6172  @convert_cell_ar
+000051c0: 6773 0a20 2020 2064 6566 2077 7269 7465  gs.    def write
+000051d0: 5f66 6f72 6d75 6c61 2873 656c 662c 2072  _formula(self, r
+000051e0: 6f77 2c20 636f 6c2c 2066 6f72 6d75 6c61  ow, col, formula
+000051f0: 2c20 6365 6c6c 5f66 6f72 6d61 743d 4e6f  , cell_format=No
+00005200: 6e65 2c20 7661 6c75 653d 3029 3a0a 2020  ne, value=0):.  
+00005210: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00005220: 2020 5772 6974 6520 6120 666f 726d 756c    Write a formul
+00005230: 6120 746f 2061 2077 6f72 6b73 6865 6574  a to a worksheet
+00005240: 2063 656c 6c2e 0a0a 2020 2020 2020 2020   cell...        
+00005250: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
+00005260: 2020 726f 773a 2020 2020 2020 2020 2054    row:         T
+00005270: 6865 2063 656c 6c20 726f 7720 287a 6572  he cell row (zer
+00005280: 6f20 696e 6465 7865 6429 2e0a 2020 2020  o indexed)..    
+00005290: 2020 2020 2020 2020 636f 6c3a 2020 2020          col:    
+000052a0: 2020 2020 2054 6865 2063 656c 6c20 636f       The cell co
+000052b0: 6c75 6d6e 2028 7a65 726f 2069 6e64 6578  lumn (zero index
+000052c0: 6564 292e 0a20 2020 2020 2020 2020 2020  ed)..           
+000052d0: 2066 6f72 6d75 6c61 3a20 2020 2020 4365   formula:     Ce
+000052e0: 6c6c 2066 6f72 6d75 6c61 2e0a 2020 2020  ll formula..    
+000052f0: 2020 2020 2020 2020 6365 6c6c 5f66 6f72          cell_for
+00005300: 6d61 743a 2041 6e20 6f70 7469 6f6e 616c  mat: An optional
+00005310: 2063 656c 6c20 466f 726d 6174 206f 626a   cell Format obj
+00005320: 6563 742e 0a20 2020 2020 2020 2020 2020  ect..           
+00005330: 2076 616c 7565 3a20 2020 2020 2020 416e   value:       An
+00005340: 206f 7074 696f 6e61 6c20 7661 6c75 6520   optional value 
+00005350: 666f 7220 7468 6520 666f 726d 756c 612e  for the formula.
+00005360: 2044 6566 6175 6c74 2069 7320 302e 0a0a   Default is 0...
+00005370: 2020 2020 2020 2020 5265 7475 726e 733a          Returns:
+00005380: 0a20 2020 2020 2020 2020 2020 2030 3a20  .            0: 
+00005390: 2053 7563 6365 7373 2e0a 2020 2020 2020   Success..      
+000053a0: 2020 2020 2020 2d31 3a20 526f 7720 6f72        -1: Row or
+000053b0: 2063 6f6c 756d 6e20 6973 206f 7574 206f   column is out o
+000053c0: 6620 776f 726b 7368 6565 7420 626f 756e  f worksheet boun
+000053d0: 6473 2e0a 2020 2020 2020 2020 2020 2020  ds..            
+000053e0: 2d32 3a20 466f 726d 756c 6120 6361 6e27  -2: Formula can'
+000053f0: 7420 6265 204e 6f6e 6520 6f72 2065 6d70  t be None or emp
+00005400: 7479 2e0a 0a20 2020 2020 2020 2022 2222  ty...        """
+00005410: 0a20 2020 2020 2020 2023 2043 6865 636b  .        # Check
+00005420: 2074 6861 7420 726f 7720 616e 6420 636f   that row and co
+00005430: 6c20 6172 6520 7661 6c69 6420 616e 6420  l are valid and 
+00005440: 7374 6f72 6520 6d61 7820 616e 6420 6d69  store max and mi
+00005450: 6e20 7661 6c75 6573 2e0a 2020 2020 2020  n values..      
+00005460: 2020 7265 7475 726e 2073 656c 662e 5f77    return self._w
+00005470: 7269 7465 5f66 6f72 6d75 6c61 2872 6f77  rite_formula(row
+00005480: 2c20 636f 6c2c 2066 6f72 6d75 6c61 2c20  , col, formula, 
+00005490: 6365 6c6c 5f66 6f72 6d61 742c 2076 616c  cell_format, val
+000054a0: 7565 290a 0a20 2020 2023 2055 6e64 6563  ue)..    # Undec
+000054b0: 6f72 6174 6564 2076 6572 7369 6f6e 206f  orated version o
+000054c0: 6620 7772 6974 655f 666f 726d 756c 6128  f write_formula(
+000054d0: 292e 0a20 2020 2064 6566 205f 7772 6974  )..    def _writ
+000054e0: 655f 666f 726d 756c 6128 7365 6c66 2c20  e_formula(self, 
+000054f0: 726f 772c 2063 6f6c 2c20 666f 726d 756c  row, col, formul
+00005500: 612c 2063 656c 6c5f 666f 726d 6174 3d4e  a, cell_format=N
+00005510: 6f6e 652c 2076 616c 7565 3d30 293a 0a20  one, value=0):. 
+00005520: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+00005530: 6368 6563 6b5f 6469 6d65 6e73 696f 6e73  check_dimensions
+00005540: 2872 6f77 2c20 636f 6c29 3a0a 2020 2020  (row, col):.    
+00005550: 2020 2020 2020 2020 7265 7475 726e 202d          return -
+00005560: 310a 0a20 2020 2020 2020 2069 6620 666f  1..        if fo
+00005570: 726d 756c 6120 6973 204e 6f6e 6520 6f72  rmula is None or
+00005580: 2066 6f72 6d75 6c61 203d 3d20 2222 3a0a   formula == "":.
+00005590: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+000055a0: 2822 466f 726d 756c 6120 6361 6e27 7420  ("Formula can't 
+000055b0: 6265 204e 6f6e 6520 6f72 2065 6d70 7479  be None or empty
+000055c0: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
+000055d0: 6574 7572 6e20 2d31 0a0a 2020 2020 2020  eturn -1..      
+000055e0: 2020 2320 4368 6563 6b20 666f 7220 6479    # Check for dy
+000055f0: 6e61 6d69 6320 6172 7261 7920 6675 6e63  namic array func
+00005600: 7469 6f6e 732e 0a20 2020 2020 2020 2069  tions..        i
+00005610: 6620 7265 5f64 796e 616d 6963 5f66 756e  f re_dynamic_fun
+00005620: 6374 696f 6e2e 7365 6172 6368 2866 6f72  ction.search(for
+00005630: 6d75 6c61 293a 0a20 2020 2020 2020 2020  mula):.         
+00005640: 2020 2072 6574 7572 6e20 7365 6c66 2e77     return self.w
+00005650: 7269 7465 5f64 796e 616d 6963 5f61 7272  rite_dynamic_arr
+00005660: 6179 5f66 6f72 6d75 6c61 280a 2020 2020  ay_formula(.    
+00005670: 2020 2020 2020 2020 2020 2020 726f 772c              row,
+00005680: 2063 6f6c 2c20 726f 772c 2063 6f6c 2c20   col, row, col, 
+00005690: 666f 726d 756c 612c 2063 656c 6c5f 666f  formula, cell_fo
+000056a0: 726d 6174 2c20 7661 6c75 650a 2020 2020  rmat, value.    
+000056b0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+000056c0: 2020 2023 2048 616e 6420 6f66 6620 6172     # Hand off ar
+000056d0: 7261 7920 666f 726d 756c 6173 2e0a 2020  ray formulas..  
+000056e0: 2020 2020 2020 6966 2066 6f72 6d75 6c61        if formula
+000056f0: 2e73 7461 7274 7377 6974 6828 227b 2229  .startswith("{")
+00005700: 2061 6e64 2066 6f72 6d75 6c61 2e65 6e64   and formula.end
+00005710: 7377 6974 6828 227d 2229 3a0a 2020 2020  swith("}"):.    
+00005720: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00005730: 656c 662e 5f77 7269 7465 5f61 7272 6179  elf._write_array
+00005740: 5f66 6f72 6d75 6c61 280a 2020 2020 2020  _formula(.      
+00005750: 2020 2020 2020 2020 2020 726f 772c 2063            row, c
+00005760: 6f6c 2c20 726f 772c 2063 6f6c 2c20 666f  ol, row, col, fo
+00005770: 726d 756c 612c 2063 656c 6c5f 666f 726d  rmula, cell_form
+00005780: 6174 2c20 7661 6c75 650a 2020 2020 2020  at, value.      
+00005790: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+000057a0: 2023 204d 6f64 6966 7920 7468 6520 666f   # Modify the fo
+000057b0: 726d 756c 6120 7374 7269 6e67 2c20 6173  rmula string, as
+000057c0: 206e 6565 6465 642e 0a20 2020 2020 2020   needed..       
+000057d0: 2066 6f72 6d75 6c61 203d 2073 656c 662e   formula = self.
+000057e0: 5f70 7265 7061 7265 5f66 6f72 6d75 6c61  _prepare_formula
+000057f0: 2866 6f72 6d75 6c61 290a 0a20 2020 2020  (formula)..     
+00005800: 2020 2023 2057 7269 7465 2070 7265 7669     # Write previ
+00005810: 6f75 7320 726f 7720 6966 2069 6e20 696e  ous row if in in
+00005820: 2d6c 696e 6520 7374 7269 6e67 2063 6f6e  -line string con
+00005830: 7374 616e 745f 6d65 6d6f 7279 206d 6f64  stant_memory mod
+00005840: 652e 0a20 2020 2020 2020 2069 6620 7365  e..        if se
+00005850: 6c66 2e63 6f6e 7374 616e 745f 6d65 6d6f  lf.constant_memo
+00005860: 7279 2061 6e64 2072 6f77 203e 2073 656c  ry and row > sel
+00005870: 662e 7072 6576 696f 7573 5f72 6f77 3a0a  f.previous_row:.
+00005880: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00005890: 2e5f 7772 6974 655f 7369 6e67 6c65 5f72  ._write_single_r
+000058a0: 6f77 2872 6f77 290a 0a20 2020 2020 2020  ow(row)..       
+000058b0: 2023 2053 746f 7265 2074 6865 2063 656c   # Store the cel
+000058c0: 6c20 6461 7461 2069 6e20 7468 6520 776f  l data in the wo
+000058d0: 726b 7368 6565 7420 6461 7461 2074 6162  rksheet data tab
+000058e0: 6c65 2e0a 2020 2020 2020 2020 7365 6c66  le..        self
+000058f0: 2e74 6162 6c65 5b72 6f77 5d5b 636f 6c5d  .table[row][col]
+00005900: 203d 2063 656c 6c5f 666f 726d 756c 615f   = cell_formula_
+00005910: 7475 706c 6528 666f 726d 756c 612c 2063  tuple(formula, c
+00005920: 656c 6c5f 666f 726d 6174 2c20 7661 6c75  ell_format, valu
+00005930: 6529 0a0a 2020 2020 2020 2020 7265 7475  e)..        retu
+00005940: 726e 2030 0a0a 2020 2020 4063 6f6e 7665  rn 0..    @conve
+00005950: 7274 5f72 616e 6765 5f61 7267 730a 2020  rt_range_args.  
+00005960: 2020 6465 6620 7772 6974 655f 6172 7261    def write_arra
+00005970: 795f 666f 726d 756c 6128 0a20 2020 2020  y_formula(.     
+00005980: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00005990: 2066 6972 7374 5f72 6f77 2c0a 2020 2020   first_row,.    
+000059a0: 2020 2020 6669 7273 745f 636f 6c2c 0a20      first_col,. 
+000059b0: 2020 2020 2020 206c 6173 745f 726f 772c         last_row,
+000059c0: 0a20 2020 2020 2020 206c 6173 745f 636f  .        last_co
+000059d0: 6c2c 0a20 2020 2020 2020 2066 6f72 6d75  l,.        formu
+000059e0: 6c61 2c0a 2020 2020 2020 2020 6365 6c6c  la,.        cell
+000059f0: 5f66 6f72 6d61 743d 4e6f 6e65 2c0a 2020  _format=None,.  
+00005a00: 2020 2020 2020 7661 6c75 653d 302c 0a20        value=0,. 
+00005a10: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
+00005a20: 220a 2020 2020 2020 2020 5772 6974 6520  ".        Write 
+00005a30: 6120 666f 726d 756c 6120 746f 2061 2077  a formula to a w
+00005a40: 6f72 6b73 6865 6574 2063 656c 6c2f 7261  orksheet cell/ra
+00005a50: 6e67 652e 0a0a 2020 2020 2020 2020 4172  nge...        Ar
+00005a60: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+00005a70: 6669 7273 745f 726f 773a 2020 2020 5468  first_row:    Th
+00005a80: 6520 6669 7273 7420 726f 7720 6f66 2074  e first row of t
+00005a90: 6865 2063 656c 6c20 7261 6e67 652e 2028  he cell range. (
+00005aa0: 7a65 726f 2069 6e64 6578 6564 292e 0a20  zero indexed).. 
+00005ab0: 2020 2020 2020 2020 2020 2066 6972 7374             first
+00005ac0: 5f63 6f6c 3a20 2020 2054 6865 2066 6972  _col:    The fir
+00005ad0: 7374 2063 6f6c 756d 6e20 6f66 2074 6865  st column of the
+00005ae0: 2063 656c 6c20 7261 6e67 652e 0a20 2020   cell range..   
+00005af0: 2020 2020 2020 2020 206c 6173 745f 726f           last_ro
+00005b00: 773a 2020 2020 2054 6865 206c 6173 7420  w:     The last 
+00005b10: 726f 7720 6f66 2074 6865 2063 656c 6c20  row of the cell 
+00005b20: 7261 6e67 652e 2028 7a65 726f 2069 6e64  range. (zero ind
+00005b30: 6578 6564 292e 0a20 2020 2020 2020 2020  exed)..         
+00005b40: 2020 206c 6173 745f 636f 6c3a 2020 2020     last_col:    
+00005b50: 2054 6865 206c 6173 7420 636f 6c75 6d6e   The last column
+00005b60: 206f 6620 7468 6520 6365 6c6c 2072 616e   of the cell ran
+00005b70: 6765 2e0a 2020 2020 2020 2020 2020 2020  ge..            
+00005b80: 666f 726d 756c 613a 2020 2020 2020 4365  formula:      Ce
+00005b90: 6c6c 2066 6f72 6d75 6c61 2e0a 2020 2020  ll formula..    
+00005ba0: 2020 2020 2020 2020 6365 6c6c 5f66 6f72          cell_for
+00005bb0: 6d61 743a 2020 416e 206f 7074 696f 6e61  mat:  An optiona
+00005bc0: 6c20 6365 6c6c 2046 6f72 6d61 7420 6f62  l cell Format ob
+00005bd0: 6a65 6374 2e0a 2020 2020 2020 2020 2020  ject..          
+00005be0: 2020 7661 6c75 653a 2020 2020 2020 2020    value:        
+00005bf0: 416e 206f 7074 696f 6e61 6c20 7661 6c75  An optional valu
+00005c00: 6520 666f 7220 7468 6520 666f 726d 756c  e for the formul
+00005c10: 612e 2044 6566 6175 6c74 2069 7320 302e  a. Default is 0.
+00005c20: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00005c30: 733a 0a20 2020 2020 2020 2020 2020 2030  s:.            0
+00005c40: 3a20 2053 7563 6365 7373 2e0a 2020 2020  :  Success..    
+00005c50: 2020 2020 2020 2020 2d31 3a20 526f 7720          -1: Row 
+00005c60: 6f72 2063 6f6c 756d 6e20 6973 206f 7574  or column is out
+00005c70: 206f 6620 776f 726b 7368 6565 7420 626f   of worksheet bo
+00005c80: 756e 6473 2e0a 0a20 2020 2020 2020 2022  unds...        "
+00005c90: 2222 0a20 2020 2020 2020 2023 2043 6865  "".        # Che
+00005ca0: 636b 2066 6f72 2064 796e 616d 6963 2061  ck for dynamic a
+00005cb0: 7272 6179 2066 756e 6374 696f 6e73 2e0a  rray functions..
+00005cc0: 2020 2020 2020 2020 6966 2072 655f 6479          if re_dy
+00005cd0: 6e61 6d69 635f 6675 6e63 7469 6f6e 2e73  namic_function.s
+00005ce0: 6561 7263 6828 666f 726d 756c 6129 3a0a  earch(formula):.
+00005cf0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00005d00: 726e 2073 656c 662e 7772 6974 655f 6479  rn self.write_dy
+00005d10: 6e61 6d69 635f 6172 7261 795f 666f 726d  namic_array_form
+00005d20: 756c 6128 0a20 2020 2020 2020 2020 2020  ula(.           
+00005d30: 2020 2020 2066 6972 7374 5f72 6f77 2c20       first_row, 
+00005d40: 6669 7273 745f 636f 6c2c 206c 6173 745f  first_col, last_
+00005d50: 726f 772c 206c 6173 745f 636f 6c2c 2066  row, last_col, f
+00005d60: 6f72 6d75 6c61 2c20 6365 6c6c 5f66 6f72  ormula, cell_for
+00005d70: 6d61 742c 2076 616c 7565 0a20 2020 2020  mat, value.     
+00005d80: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00005d90: 2020 7265 7475 726e 2073 656c 662e 5f77    return self._w
+00005da0: 7269 7465 5f61 7272 6179 5f66 6f72 6d75  rite_array_formu
+00005db0: 6c61 280a 2020 2020 2020 2020 2020 2020  la(.            
+00005dc0: 6669 7273 745f 726f 772c 0a20 2020 2020  first_row,.     
+00005dd0: 2020 2020 2020 2066 6972 7374 5f63 6f6c         first_col
+00005de0: 2c0a 2020 2020 2020 2020 2020 2020 6c61  ,.            la
+00005df0: 7374 5f72 6f77 2c0a 2020 2020 2020 2020  st_row,.        
+00005e00: 2020 2020 6c61 7374 5f63 6f6c 2c0a 2020      last_col,.  
+00005e10: 2020 2020 2020 2020 2020 666f 726d 756c            formul
+00005e20: 612c 0a20 2020 2020 2020 2020 2020 2063  a,.            c
+00005e30: 656c 6c5f 666f 726d 6174 2c0a 2020 2020  ell_format,.    
+00005e40: 2020 2020 2020 2020 7661 6c75 652c 0a20          value,. 
+00005e50: 2020 2020 2020 2020 2020 2022 7374 6174             "stat
+00005e60: 6963 222c 0a20 2020 2020 2020 2029 0a0a  ic",.        )..
+00005e70: 2020 2020 4063 6f6e 7665 7274 5f72 616e      @convert_ran
+00005e80: 6765 5f61 7267 730a 2020 2020 6465 6620  ge_args.    def 
+00005e90: 7772 6974 655f 6479 6e61 6d69 635f 6172  write_dynamic_ar
+00005ea0: 7261 795f 666f 726d 756c 6128 0a20 2020  ray_formula(.   
+00005eb0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00005ec0: 2020 2066 6972 7374 5f72 6f77 2c0a 2020     first_row,.  
+00005ed0: 2020 2020 2020 6669 7273 745f 636f 6c2c        first_col,
+00005ee0: 0a20 2020 2020 2020 206c 6173 745f 726f  .        last_ro
+00005ef0: 772c 0a20 2020 2020 2020 206c 6173 745f  w,.        last_
+00005f00: 636f 6c2c 0a20 2020 2020 2020 2066 6f72  col,.        for
+00005f10: 6d75 6c61 2c0a 2020 2020 2020 2020 6365  mula,.        ce
+00005f20: 6c6c 5f66 6f72 6d61 743d 4e6f 6e65 2c0a  ll_format=None,.
+00005f30: 2020 2020 2020 2020 7661 6c75 653d 302c          value=0,
+00005f40: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+00005f50: 2222 220a 2020 2020 2020 2020 5772 6974  """.        Writ
+00005f60: 6520 6120 6479 6e61 6d69 6320 6172 7261  e a dynamic arra
+00005f70: 7920 666f 726d 756c 6120 746f 2061 2077  y formula to a w
+00005f80: 6f72 6b73 6865 6574 2063 656c 6c2f 7261  orksheet cell/ra
+00005f90: 6e67 652e 0a0a 2020 2020 2020 2020 4172  nge...        Ar
+00005fa0: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+00005fb0: 6669 7273 745f 726f 773a 2020 2020 5468  first_row:    Th
+00005fc0: 6520 6669 7273 7420 726f 7720 6f66 2074  e first row of t
+00005fd0: 6865 2063 656c 6c20 7261 6e67 652e 2028  he cell range. (
+00005fe0: 7a65 726f 2069 6e64 6578 6564 292e 0a20  zero indexed).. 
+00005ff0: 2020 2020 2020 2020 2020 2066 6972 7374             first
+00006000: 5f63 6f6c 3a20 2020 2054 6865 2066 6972  _col:    The fir
+00006010: 7374 2063 6f6c 756d 6e20 6f66 2074 6865  st column of the
+00006020: 2063 656c 6c20 7261 6e67 652e 0a20 2020   cell range..   
+00006030: 2020 2020 2020 2020 206c 6173 745f 726f           last_ro
+00006040: 773a 2020 2020 2054 6865 206c 6173 7420  w:     The last 
+00006050: 726f 7720 6f66 2074 6865 2063 656c 6c20  row of the cell 
+00006060: 7261 6e67 652e 2028 7a65 726f 2069 6e64  range. (zero ind
+00006070: 6578 6564 292e 0a20 2020 2020 2020 2020  exed)..         
+00006080: 2020 206c 6173 745f 636f 6c3a 2020 2020     last_col:    
+00006090: 2054 6865 206c 6173 7420 636f 6c75 6d6e   The last column
+000060a0: 206f 6620 7468 6520 6365 6c6c 2072 616e   of the cell ran
+000060b0: 6765 2e0a 2020 2020 2020 2020 2020 2020  ge..            
+000060c0: 666f 726d 756c 613a 2020 2020 2020 4365  formula:      Ce
+000060d0: 6c6c 2066 6f72 6d75 6c61 2e0a 2020 2020  ll formula..    
+000060e0: 2020 2020 2020 2020 6365 6c6c 5f66 6f72          cell_for
+000060f0: 6d61 743a 2020 416e 206f 7074 696f 6e61  mat:  An optiona
+00006100: 6c20 6365 6c6c 2046 6f72 6d61 7420 6f62  l cell Format ob
+00006110: 6a65 6374 2e0a 2020 2020 2020 2020 2020  ject..          
+00006120: 2020 7661 6c75 653a 2020 2020 2020 2020    value:        
+00006130: 416e 206f 7074 696f 6e61 6c20 7661 6c75  An optional valu
+00006140: 6520 666f 7220 7468 6520 666f 726d 756c  e for the formul
+00006150: 612e 2044 6566 6175 6c74 2069 7320 302e  a. Default is 0.
+00006160: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00006170: 733a 0a20 2020 2020 2020 2020 2020 2030  s:.            0
+00006180: 3a20 2053 7563 6365 7373 2e0a 2020 2020  :  Success..    
+00006190: 2020 2020 2020 2020 2d31 3a20 526f 7720          -1: Row 
+000061a0: 6f72 2063 6f6c 756d 6e20 6973 206f 7574  or column is out
+000061b0: 206f 6620 776f 726b 7368 6565 7420 626f   of worksheet bo
+000061c0: 756e 6473 2e0a 0a20 2020 2020 2020 2022  unds...        "
+000061d0: 2222 0a20 2020 2020 2020 2065 7272 6f72  "".        error
+000061e0: 203d 2073 656c 662e 5f77 7269 7465 5f61   = self._write_a
+000061f0: 7272 6179 5f66 6f72 6d75 6c61 280a 2020  rray_formula(.  
+00006200: 2020 2020 2020 2020 2020 6669 7273 745f            first_
+00006210: 726f 772c 0a20 2020 2020 2020 2020 2020  row,.           
+00006220: 2066 6972 7374 5f63 6f6c 2c0a 2020 2020   first_col,.    
+00006230: 2020 2020 2020 2020 6c61 7374 5f72 6f77          last_row
+00006240: 2c0a 2020 2020 2020 2020 2020 2020 6c61  ,.            la
+00006250: 7374 5f63 6f6c 2c0a 2020 2020 2020 2020  st_col,.        
+00006260: 2020 2020 666f 726d 756c 612c 0a20 2020      formula,.   
+00006270: 2020 2020 2020 2020 2063 656c 6c5f 666f           cell_fo
+00006280: 726d 6174 2c0a 2020 2020 2020 2020 2020  rmat,.          
+00006290: 2020 7661 6c75 652c 0a20 2020 2020 2020    value,.       
+000062a0: 2020 2020 2022 6479 6e61 6d69 6322 2c0a       "dynamic",.
+000062b0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+000062c0: 2020 2069 6620 6572 726f 7220 3d3d 2030     if error == 0
+000062d0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+000062e0: 6c66 2e68 6173 5f64 796e 616d 6963 5f61  lf.has_dynamic_a
+000062f0: 7272 6179 7320 3d20 5472 7565 0a0a 2020  rrays = True..  
+00006300: 2020 2020 2020 7265 7475 726e 2065 7272        return err
+00006310: 6f72 0a0a 2020 2020 2320 5574 696c 6974  or..    # Utilit
+00006320: 7920 6d65 7468 6f64 2074 6f20 7374 7269  y method to stri
+00006330: 7020 6571 7561 6c20 7369 676e 2061 6e64  p equal sign and
+00006340: 2061 7272 6179 2062 7261 6365 7320 6672   array braces fr
+00006350: 6f6d 2061 2066 6f72 6d75 6c61 2061 6e64  om a formula and
+00006360: 0a20 2020 2023 2061 6c73 6f20 6578 7061  .    # also expa
+00006370: 6e64 206f 7574 2066 7574 7572 6520 616e  nd out future an
+00006380: 6420 6479 6e61 6d69 6320 6172 7261 7920  d dynamic array 
+00006390: 666f 726d 756c 6173 2e0a 2020 2020 6465  formulas..    de
+000063a0: 6620 5f70 7265 7061 7265 5f66 6f72 6d75  f _prepare_formu
+000063b0: 6c61 2873 656c 662c 2066 6f72 6d75 6c61  la(self, formula
+000063c0: 293a 0a20 2020 2020 2020 2023 2052 656d  ):.        # Rem
+000063d0: 6f76 6520 6172 7261 7920 666f 726d 756c  ove array formul
+000063e0: 6120 6272 6163 6573 2061 6e64 2074 6865  a braces and the
+000063f0: 206c 6561 6469 6e67 203d 2e0a 2020 2020   leading =..    
+00006400: 2020 2020 6966 2066 6f72 6d75 6c61 2e73      if formula.s
+00006410: 7461 7274 7377 6974 6828 227b 2229 3a0a  tartswith("{"):.
+00006420: 2020 2020 2020 2020 2020 2020 666f 726d              form
+00006430: 756c 6120 3d20 666f 726d 756c 615b 313a  ula = formula[1:
+00006440: 5d0a 2020 2020 2020 2020 6966 2066 6f72  ].        if for
+00006450: 6d75 6c61 2e73 7461 7274 7377 6974 6828  mula.startswith(
+00006460: 223d 2229 3a0a 2020 2020 2020 2020 2020  "="):.          
+00006470: 2020 666f 726d 756c 6120 3d20 666f 726d    formula = form
+00006480: 756c 615b 313a 5d0a 2020 2020 2020 2020  ula[1:].        
+00006490: 6966 2066 6f72 6d75 6c61 2e65 6e64 7377  if formula.endsw
+000064a0: 6974 6828 227d 2229 3a0a 2020 2020 2020  ith("}"):.      
+000064b0: 2020 2020 2020 666f 726d 756c 6120 3d20        formula = 
+000064c0: 666f 726d 756c 615b 3a2d 315d 0a0a 2020  formula[:-1]..  
+000064d0: 2020 2020 2020 2320 4368 6563 6b20 6966        # Check if
+000064e0: 2066 6f72 6d75 6c61 2069 7320 616c 7265   formula is alre
+000064f0: 6164 7920 6578 7061 6e64 6564 2062 7920  ady expanded by 
+00006500: 7468 6520 7573 6572 2e0a 2020 2020 2020  the user..      
+00006510: 2020 6966 2022 5f78 6c66 6e2e 2220 696e    if "_xlfn." in
+00006520: 2066 6f72 6d75 6c61 3a0a 2020 2020 2020   formula:.      
+00006530: 2020 2020 2020 7265 7475 726e 2066 6f72        return for
+00006540: 6d75 6c61 0a0a 2020 2020 2020 2020 2320  mula..        # 
+00006550: 4578 7061 6e64 2064 796e 616d 6963 2066  Expand dynamic f
+00006560: 6f72 6d75 6c61 732e 0a20 2020 2020 2020  ormulas..       
+00006570: 2066 6f72 6d75 6c61 203d 2072 652e 7375   formula = re.su
+00006580: 6228 7222 5c62 4c45 545c 2822 2c20 225f  b(r"\bLET\(", "_
+00006590: 786c 666e 2e4c 4554 2822 2c20 666f 726d  xlfn.LET(", form
+000065a0: 756c 6129 0a20 2020 2020 2020 2066 6f72  ula).        for
+000065b0: 6d75 6c61 203d 2072 652e 7375 6228 7222  mula = re.sub(r"
+000065c0: 5c62 4c41 4d42 4441 5c28 222c 2022 5f78  \bLAMBDA\(", "_x
+000065d0: 6c66 6e2e 4c41 4d42 4441 2822 2c20 666f  lfn.LAMBDA(", fo
+000065e0: 726d 756c 6129 0a20 2020 2020 2020 2066  rmula).        f
+000065f0: 6f72 6d75 6c61 203d 2072 652e 7375 6228  ormula = re.sub(
+00006600: 7222 5c62 5349 4e47 4c45 5c28 222c 2022  r"\bSINGLE\(", "
+00006610: 5f78 6c66 6e2e 5349 4e47 4c45 2822 2c20  _xlfn.SINGLE(", 
+00006620: 666f 726d 756c 6129 0a20 2020 2020 2020  formula).       
+00006630: 2066 6f72 6d75 6c61 203d 2072 652e 7375   formula = re.su
+00006640: 6228 7222 5c62 534f 5254 4259 5c28 222c  b(r"\bSORTBY\(",
+00006650: 2022 5f78 6c66 6e2e 534f 5254 4259 2822   "_xlfn.SORTBY("
+00006660: 2c20 666f 726d 756c 6129 0a20 2020 2020  , formula).     
+00006670: 2020 2066 6f72 6d75 6c61 203d 2072 652e     formula = re.
+00006680: 7375 6228 7222 5c62 554e 4951 5545 5c28  sub(r"\bUNIQUE\(
+00006690: 222c 2022 5f78 6c66 6e2e 554e 4951 5545  ", "_xlfn.UNIQUE
+000066a0: 2822 2c20 666f 726d 756c 6129 0a20 2020  (", formula).   
+000066b0: 2020 2020 2066 6f72 6d75 6c61 203d 2072       formula = r
+000066c0: 652e 7375 6228 7222 5c62 584d 4154 4348  e.sub(r"\bXMATCH
+000066d0: 5c28 222c 2022 5f78 6c66 6e2e 584d 4154  \(", "_xlfn.XMAT
+000066e0: 4348 2822 2c20 666f 726d 756c 6129 0a20  CH(", formula). 
+000066f0: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
+00006700: 2072 652e 7375 6228 7222 5c62 534f 5254   re.sub(r"\bSORT
+00006710: 5c28 222c 2022 5f78 6c66 6e2e 5f78 6c77  \(", "_xlfn._xlw
+00006720: 732e 534f 5254 2822 2c20 666f 726d 756c  s.SORT(", formul
+00006730: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
+00006740: 6c61 203d 2072 652e 7375 6228 7222 5c62  la = re.sub(r"\b
+00006750: 584c 4f4f 4b55 505c 2822 2c20 225f 786c  XLOOKUP\(", "_xl
+00006760: 666e 2e58 4c4f 4f4b 5550 2822 2c20 666f  fn.XLOOKUP(", fo
+00006770: 726d 756c 6129 0a20 2020 2020 2020 2066  rmula).        f
+00006780: 6f72 6d75 6c61 203d 2072 652e 7375 6228  ormula = re.sub(
+00006790: 7222 5c62 5345 5155 454e 4345 5c28 222c  r"\bSEQUENCE\(",
+000067a0: 2022 5f78 6c66 6e2e 5345 5155 454e 4345   "_xlfn.SEQUENCE
+000067b0: 2822 2c20 666f 726d 756c 6129 0a20 2020  (", formula).   
+000067c0: 2020 2020 2066 6f72 6d75 6c61 203d 2072       formula = r
+000067d0: 652e 7375 6228 7222 5c62 4649 4c54 4552  e.sub(r"\bFILTER
+000067e0: 5c28 222c 2022 5f78 6c66 6e2e 5f78 6c77  \(", "_xlfn._xlw
+000067f0: 732e 4649 4c54 4552 2822 2c20 666f 726d  s.FILTER(", form
+00006800: 756c 6129 0a20 2020 2020 2020 2066 6f72  ula).        for
+00006810: 6d75 6c61 203d 2072 652e 7375 6228 7222  mula = re.sub(r"
+00006820: 5c62 5241 4e44 4152 5241 595c 2822 2c20  \bRANDARRAY\(", 
+00006830: 225f 786c 666e 2e52 414e 4441 5252 4159  "_xlfn.RANDARRAY
+00006840: 2822 2c20 666f 726d 756c 6129 0a20 2020  (", formula).   
+00006850: 2020 2020 2066 6f72 6d75 6c61 203d 2072       formula = r
+00006860: 652e 7375 6228 7222 5c62 414e 4348 4f52  e.sub(r"\bANCHOR
+00006870: 4152 5241 595c 2822 2c20 225f 786c 666e  ARRAY\(", "_xlfn
+00006880: 2e41 4e43 484f 5241 5252 4159 2822 2c20  .ANCHORARRAY(", 
+00006890: 666f 726d 756c 6129 0a0a 2020 2020 2020  formula)..      
+000068a0: 2020 6966 206e 6f74 2073 656c 662e 7573    if not self.us
+000068b0: 655f 6675 7475 7265 5f66 756e 6374 696f  e_future_functio
+000068c0: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+000068d0: 7265 7475 726e 2066 6f72 6d75 6c61 0a0a  return formula..
+000068e0: 2020 2020 2020 2020 666f 726d 756c 6120          formula 
+000068f0: 3d20 7265 2e73 7562 2872 225c 6243 4f54  = re.sub(r"\bCOT
+00006900: 5c28 222c 2022 5f78 6c66 6e2e 434f 5428  \(", "_xlfn.COT(
+00006910: 222c 2066 6f72 6d75 6c61 290a 2020 2020  ", formula).    
+00006920: 2020 2020 666f 726d 756c 6120 3d20 7265      formula = re
+00006930: 2e73 7562 2872 225c 6243 5343 5c28 222c  .sub(r"\bCSC\(",
+00006940: 2022 5f78 6c66 6e2e 4353 4328 222c 2066   "_xlfn.CSC(", f
+00006950: 6f72 6d75 6c61 290a 2020 2020 2020 2020  ormula).        
+00006960: 666f 726d 756c 6120 3d20 7265 2e73 7562  formula = re.sub
+00006970: 2872 225c 6249 4653 5c28 222c 2022 5f78  (r"\bIFS\(", "_x
+00006980: 6c66 6e2e 4946 5328 222c 2066 6f72 6d75  lfn.IFS(", formu
+00006990: 6c61 290a 2020 2020 2020 2020 666f 726d  la).        form
+000069a0: 756c 6120 3d20 7265 2e73 7562 2872 225c  ula = re.sub(r"\
+000069b0: 6250 4849 5c28 222c 2022 5f78 6c66 6e2e  bPHI\(", "_xlfn.
+000069c0: 5048 4928 222c 2066 6f72 6d75 6c61 290a  PHI(", formula).
+000069d0: 2020 2020 2020 2020 666f 726d 756c 6120          formula 
+000069e0: 3d20 7265 2e73 7562 2872 225c 6252 5249  = re.sub(r"\bRRI
+000069f0: 5c28 222c 2022 5f78 6c66 6e2e 5252 4928  \(", "_xlfn.RRI(
+00006a00: 222c 2066 6f72 6d75 6c61 290a 2020 2020  ", formula).    
+00006a10: 2020 2020 666f 726d 756c 6120 3d20 7265      formula = re
+00006a20: 2e73 7562 2872 225c 6253 4543 5c28 222c  .sub(r"\bSEC\(",
+00006a30: 2022 5f78 6c66 6e2e 5345 4328 222c 2066   "_xlfn.SEC(", f
+00006a40: 6f72 6d75 6c61 290a 2020 2020 2020 2020  ormula).        
+00006a50: 666f 726d 756c 6120 3d20 7265 2e73 7562  formula = re.sub
+00006a60: 2872 225c 6258 4f52 5c28 222c 2022 5f78  (r"\bXOR\(", "_x
+00006a70: 6c66 6e2e 584f 5228 222c 2066 6f72 6d75  lfn.XOR(", formu
+00006a80: 6c61 290a 2020 2020 2020 2020 666f 726d  la).        form
+00006a90: 756c 6120 3d20 7265 2e73 7562 2872 225c  ula = re.sub(r"\
+00006aa0: 6241 434f 545c 2822 2c20 225f 786c 666e  bACOT\(", "_xlfn
+00006ab0: 2e41 434f 5428 222c 2066 6f72 6d75 6c61  .ACOT(", formula
+00006ac0: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
+00006ad0: 6120 3d20 7265 2e73 7562 2872 225c 6242  a = re.sub(r"\bB
+00006ae0: 4153 455c 2822 2c20 225f 786c 666e 2e42  ASE\(", "_xlfn.B
+00006af0: 4153 4528 222c 2066 6f72 6d75 6c61 290a  ASE(", formula).
+00006b00: 2020 2020 2020 2020 666f 726d 756c 6120          formula 
+00006b10: 3d20 7265 2e73 7562 2872 225c 6243 4f54  = re.sub(r"\bCOT
+00006b20: 485c 2822 2c20 225f 786c 666e 2e43 4f54  H\(", "_xlfn.COT
+00006b30: 4828 222c 2066 6f72 6d75 6c61 290a 2020  H(", formula).  
+00006b40: 2020 2020 2020 666f 726d 756c 6120 3d20        formula = 
+00006b50: 7265 2e73 7562 2872 225c 6243 5343 485c  re.sub(r"\bCSCH\
+00006b60: 2822 2c20 225f 786c 666e 2e43 5343 4828  (", "_xlfn.CSCH(
+00006b70: 222c 2066 6f72 6d75 6c61 290a 2020 2020  ", formula).    
+00006b80: 2020 2020 666f 726d 756c 6120 3d20 7265      formula = re
+00006b90: 2e73 7562 2872 225c 6244 4159 535c 2822  .sub(r"\bDAYS\("
+00006ba0: 2c20 225f 786c 666e 2e44 4159 5328 222c  , "_xlfn.DAYS(",
+00006bb0: 2066 6f72 6d75 6c61 290a 2020 2020 2020   formula).      
+00006bc0: 2020 666f 726d 756c 6120 3d20 7265 2e73    formula = re.s
+00006bd0: 7562 2872 225c 6249 464e 415c 2822 2c20  ub(r"\bIFNA\(", 
+00006be0: 225f 786c 666e 2e49 464e 4128 222c 2066  "_xlfn.IFNA(", f
+00006bf0: 6f72 6d75 6c61 290a 2020 2020 2020 2020  ormula).        
+00006c00: 666f 726d 756c 6120 3d20 7265 2e73 7562  formula = re.sub
+00006c10: 2872 225c 6253 4543 485c 2822 2c20 225f  (r"\bSECH\(", "_
+00006c20: 786c 666e 2e53 4543 4828 222c 2066 6f72  xlfn.SECH(", for
+00006c30: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+00006c40: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+00006c50: 225c 6241 434f 5448 5c28 222c 2022 5f78  "\bACOTH\(", "_x
+00006c60: 6c66 6e2e 4143 4f54 4828 222c 2066 6f72  lfn.ACOTH(", for
+00006c70: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+00006c80: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+00006c90: 225c 6242 4954 4f52 5c28 222c 2022 5f78  "\bBITOR\(", "_x
+00006ca0: 6c66 6e2e 4249 544f 5228 222c 2066 6f72  lfn.BITOR(", for
+00006cb0: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+00006cc0: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+00006cd0: 225c 6246 2e49 4e56 5c28 222c 2022 5f78  "\bF.INV\(", "_x
+00006ce0: 6c66 6e2e 462e 494e 5628 222c 2066 6f72  lfn.F.INV(", for
+00006cf0: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+00006d00: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+00006d10: 225c 6247 414d 4d41 5c28 222c 2022 5f78  "\bGAMMA\(", "_x
+00006d20: 6c66 6e2e 4741 4d4d 4128 222c 2066 6f72  lfn.GAMMA(", for
+00006d30: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+00006d40: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+00006d50: 225c 6247 4155 5353 5c28 222c 2022 5f78  "\bGAUSS\(", "_x
+00006d60: 6c66 6e2e 4741 5553 5328 222c 2066 6f72  lfn.GAUSS(", for
+00006d70: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+00006d80: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+00006d90: 225c 6249 4d43 4f54 5c28 222c 2022 5f78  "\bIMCOT\(", "_x
+00006da0: 6c66 6e2e 494d 434f 5428 222c 2066 6f72  lfn.IMCOT(", for
+00006db0: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+00006dc0: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+00006dd0: 225c 6249 4d43 5343 5c28 222c 2022 5f78  "\bIMCSC\(", "_x
+00006de0: 6c66 6e2e 494d 4353 4328 222c 2066 6f72  lfn.IMCSC(", for
+00006df0: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+00006e00: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+00006e10: 225c 6249 4d53 4543 5c28 222c 2022 5f78  "\bIMSEC\(", "_x
+00006e20: 6c66 6e2e 494d 5345 4328 222c 2066 6f72  lfn.IMSEC(", for
+00006e30: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+00006e40: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+00006e50: 225c 6249 4d54 414e 5c28 222c 2022 5f78  "\bIMTAN\(", "_x
+00006e60: 6c66 6e2e 494d 5441 4e28 222c 2066 6f72  lfn.IMTAN(", for
+00006e70: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+00006e80: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+00006e90: 225c 624d 554e 4954 5c28 222c 2022 5f78  "\bMUNIT\(", "_x
+00006ea0: 6c66 6e2e 4d55 4e49 5428 222c 2066 6f72  lfn.MUNIT(", for
+00006eb0: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+00006ec0: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+00006ed0: 225c 6253 4845 4554 5c28 222c 2022 5f78  "\bSHEET\(", "_x
+00006ee0: 6c66 6e2e 5348 4545 5428 222c 2066 6f72  lfn.SHEET(", for
+00006ef0: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+00006f00: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+00006f10: 225c 6254 2e49 4e56 5c28 222c 2022 5f78  "\bT.INV\(", "_x
+00006f20: 6c66 6e2e 542e 494e 5628 222c 2066 6f72  lfn.T.INV(", for
+00006f30: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+00006f40: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+00006f50: 225c 6256 4152 2e50 5c28 222c 2022 5f78  "\bVAR.P\(", "_x
+00006f60: 6c66 6e2e 5641 522e 5028 222c 2066 6f72  lfn.VAR.P(", for
+00006f70: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+00006f80: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+00006f90: 225c 6256 4152 2e53 5c28 222c 2022 5f78  "\bVAR.S\(", "_x
+00006fa0: 6c66 6e2e 5641 522e 5328 222c 2066 6f72  lfn.VAR.S(", for
+00006fb0: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+00006fc0: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+00006fd0: 225c 6241 5241 4249 435c 2822 2c20 225f  "\bARABIC\(", "_
+00006fe0: 786c 666e 2e41 5241 4249 4328 222c 2066  xlfn.ARABIC(", f
+00006ff0: 6f72 6d75 6c61 290a 2020 2020 2020 2020  ormula).        
+00007000: 666f 726d 756c 6120 3d20 7265 2e73 7562  formula = re.sub
+00007010: 2872 225c 6242 4954 414e 445c 2822 2c20  (r"\bBITAND\(", 
+00007020: 225f 786c 666e 2e42 4954 414e 4428 222c  "_xlfn.BITAND(",
+00007030: 2066 6f72 6d75 6c61 290a 2020 2020 2020   formula).      
+00007040: 2020 666f 726d 756c 6120 3d20 7265 2e73    formula = re.s
+00007050: 7562 2872 225c 6242 4954 584f 525c 2822  ub(r"\bBITXOR\("
+00007060: 2c20 225f 786c 666e 2e42 4954 584f 5228  , "_xlfn.BITXOR(
+00007070: 222c 2066 6f72 6d75 6c61 290a 2020 2020  ", formula).    
+00007080: 2020 2020 666f 726d 756c 6120 3d20 7265      formula = re
+00007090: 2e73 7562 2872 225c 6243 4f4e 4341 545c  .sub(r"\bCONCAT\
+000070a0: 2822 2c20 225f 786c 666e 2e43 4f4e 4341  (", "_xlfn.CONCA
+000070b0: 5428 222c 2066 6f72 6d75 6c61 290a 2020  T(", formula).  
+000070c0: 2020 2020 2020 666f 726d 756c 6120 3d20        formula = 
+000070d0: 7265 2e73 7562 2872 225c 6246 2e44 4953  re.sub(r"\bF.DIS
+000070e0: 545c 2822 2c20 225f 786c 666e 2e46 2e44  T\(", "_xlfn.F.D
+000070f0: 4953 5428 222c 2066 6f72 6d75 6c61 290a  IST(", formula).
+00007100: 2020 2020 2020 2020 666f 726d 756c 6120          formula 
+00007110: 3d20 7265 2e73 7562 2872 225c 6246 2e54  = re.sub(r"\bF.T
+00007120: 4553 545c 2822 2c20 225f 786c 666e 2e46  EST\(", "_xlfn.F
+00007130: 2e54 4553 5428 222c 2066 6f72 6d75 6c61  .TEST(", formula
+00007140: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
+00007150: 6120 3d20 7265 2e73 7562 2872 225c 6249  a = re.sub(r"\bI
+00007160: 4d43 4f53 485c 2822 2c20 225f 786c 666e  MCOSH\(", "_xlfn
+00007170: 2e49 4d43 4f53 4828 222c 2066 6f72 6d75  .IMCOSH(", formu
+00007180: 6c61 290a 2020 2020 2020 2020 666f 726d  la).        form
+00007190: 756c 6120 3d20 7265 2e73 7562 2872 225c  ula = re.sub(r"\
+000071a0: 6249 4d43 5343 485c 2822 2c20 225f 786c  bIMCSCH\(", "_xl
+000071b0: 666e 2e49 4d43 5343 4828 222c 2066 6f72  fn.IMCSCH(", for
+000071c0: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+000071d0: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+000071e0: 225c 6249 4d53 4543 485c 2822 2c20 225f  "\bIMSECH\(", "_
+000071f0: 786c 666e 2e49 4d53 4543 4828 222c 2066  xlfn.IMSECH(", f
+00007200: 6f72 6d75 6c61 290a 2020 2020 2020 2020  ormula).        
+00007210: 666f 726d 756c 6120 3d20 7265 2e73 7562  formula = re.sub
+00007220: 2872 225c 6249 4d53 494e 485c 2822 2c20  (r"\bIMSINH\(", 
+00007230: 225f 786c 666e 2e49 4d53 494e 4828 222c  "_xlfn.IMSINH(",
+00007240: 2066 6f72 6d75 6c61 290a 2020 2020 2020   formula).      
+00007250: 2020 666f 726d 756c 6120 3d20 7265 2e73    formula = re.s
+00007260: 7562 2872 225c 624d 4158 4946 535c 2822  ub(r"\bMAXIFS\("
+00007270: 2c20 225f 786c 666e 2e4d 4158 4946 5328  , "_xlfn.MAXIFS(
+00007280: 222c 2066 6f72 6d75 6c61 290a 2020 2020  ", formula).    
+00007290: 2020 2020 666f 726d 756c 6120 3d20 7265      formula = re
+000072a0: 2e73 7562 2872 225c 624d 494e 4946 535c  .sub(r"\bMINIFS\
+000072b0: 2822 2c20 225f 786c 666e 2e4d 494e 4946  (", "_xlfn.MINIF
+000072c0: 5328 222c 2066 6f72 6d75 6c61 290a 2020  S(", formula).  
+000072d0: 2020 2020 2020 666f 726d 756c 6120 3d20        formula = 
+000072e0: 7265 2e73 7562 2872 225c 6253 4845 4554  re.sub(r"\bSHEET
+000072f0: 535c 2822 2c20 225f 786c 666e 2e53 4845  S\(", "_xlfn.SHE
+00007300: 4554 5328 222c 2066 6f72 6d75 6c61 290a  ETS(", formula).
+00007310: 2020 2020 2020 2020 666f 726d 756c 6120          formula 
+00007320: 3d20 7265 2e73 7562 2872 225c 6253 4b45  = re.sub(r"\bSKE
+00007330: 572e 505c 2822 2c20 225f 786c 666e 2e53  W.P\(", "_xlfn.S
+00007340: 4b45 572e 5028 222c 2066 6f72 6d75 6c61  KEW.P(", formula
+00007350: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
+00007360: 6120 3d20 7265 2e73 7562 2872 225c 6253  a = re.sub(r"\bS
+00007370: 5749 5443 485c 2822 2c20 225f 786c 666e  WITCH\(", "_xlfn
+00007380: 2e53 5749 5443 4828 222c 2066 6f72 6d75  .SWITCH(", formu
+00007390: 6c61 290a 2020 2020 2020 2020 666f 726d  la).        form
+000073a0: 756c 6120 3d20 7265 2e73 7562 2872 225c  ula = re.sub(r"\
+000073b0: 6254 2e44 4953 545c 2822 2c20 225f 786c  bT.DIST\(", "_xl
+000073c0: 666e 2e54 2e44 4953 5428 222c 2066 6f72  fn.T.DIST(", for
+000073d0: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+000073e0: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+000073f0: 225c 6254 2e54 4553 545c 2822 2c20 225f  "\bT.TEST\(", "_
+00007400: 786c 666e 2e54 2e54 4553 5428 222c 2066  xlfn.T.TEST(", f
+00007410: 6f72 6d75 6c61 290a 2020 2020 2020 2020  ormula).        
+00007420: 666f 726d 756c 6120 3d20 7265 2e73 7562  formula = re.sub
+00007430: 2872 225c 625a 2e54 4553 545c 2822 2c20  (r"\bZ.TEST\(", 
+00007440: 225f 786c 666e 2e5a 2e54 4553 5428 222c  "_xlfn.Z.TEST(",
+00007450: 2066 6f72 6d75 6c61 290a 2020 2020 2020   formula).      
+00007460: 2020 666f 726d 756c 6120 3d20 7265 2e73    formula = re.s
+00007470: 7562 2872 225c 6243 4f4d 4249 4e41 5c28  ub(r"\bCOMBINA\(
+00007480: 222c 2022 5f78 6c66 6e2e 434f 4d42 494e  ", "_xlfn.COMBIN
+00007490: 4128 222c 2066 6f72 6d75 6c61 290a 2020  A(", formula).  
+000074a0: 2020 2020 2020 666f 726d 756c 6120 3d20        formula = 
+000074b0: 7265 2e73 7562 2872 225c 6244 4543 494d  re.sub(r"\bDECIM
+000074c0: 414c 5c28 222c 2022 5f78 6c66 6e2e 4445  AL\(", "_xlfn.DE
+000074d0: 4349 4d41 4c28 222c 2066 6f72 6d75 6c61  CIMAL(", formula
+000074e0: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
+000074f0: 6120 3d20 7265 2e73 7562 2872 225c 6252  a = re.sub(r"\bR
+00007500: 414e 4b2e 4551 5c28 222c 2022 5f78 6c66  ANK.EQ\(", "_xlf
+00007510: 6e2e 5241 4e4b 2e45 5128 222c 2066 6f72  n.RANK.EQ(", for
+00007520: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+00007530: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+00007540: 225c 6253 5444 4556 2e50 5c28 222c 2022  "\bSTDEV.P\(", "
+00007550: 5f78 6c66 6e2e 5354 4445 562e 5028 222c  _xlfn.STDEV.P(",
+00007560: 2066 6f72 6d75 6c61 290a 2020 2020 2020   formula).      
+00007570: 2020 666f 726d 756c 6120 3d20 7265 2e73    formula = re.s
+00007580: 7562 2872 225c 6253 5444 4556 2e53 5c28  ub(r"\bSTDEV.S\(
+00007590: 222c 2022 5f78 6c66 6e2e 5354 4445 562e  ", "_xlfn.STDEV.
+000075a0: 5328 222c 2066 6f72 6d75 6c61 290a 2020  S(", formula).  
+000075b0: 2020 2020 2020 666f 726d 756c 6120 3d20        formula = 
+000075c0: 7265 2e73 7562 2872 225c 6255 4e49 4348  re.sub(r"\bUNICH
+000075d0: 4152 5c28 222c 2022 5f78 6c66 6e2e 554e  AR\(", "_xlfn.UN
+000075e0: 4943 4841 5228 222c 2066 6f72 6d75 6c61  ICHAR(", formula
+000075f0: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
+00007600: 6120 3d20 7265 2e73 7562 2872 225c 6255  a = re.sub(r"\bU
+00007610: 4e49 434f 4445 5c28 222c 2022 5f78 6c66  NICODE\(", "_xlf
+00007620: 6e2e 554e 4943 4f44 4528 222c 2066 6f72  n.UNICODE(", for
+00007630: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+00007640: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+00007650: 225c 6242 4554 412e 494e 565c 2822 2c20  "\bBETA.INV\(", 
+00007660: 225f 786c 666e 2e42 4554 412e 494e 5628  "_xlfn.BETA.INV(
+00007670: 222c 2066 6f72 6d75 6c61 290a 2020 2020  ", formula).    
+00007680: 2020 2020 666f 726d 756c 6120 3d20 7265      formula = re
+00007690: 2e73 7562 2872 225c 6246 2e49 4e56 2e52  .sub(r"\bF.INV.R
+000076a0: 545c 2822 2c20 225f 786c 666e 2e46 2e49  T\(", "_xlfn.F.I
+000076b0: 4e56 2e52 5428 222c 2066 6f72 6d75 6c61  NV.RT(", formula
+000076c0: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
+000076d0: 6120 3d20 7265 2e73 7562 2872 225c 624e  a = re.sub(r"\bN
+000076e0: 4f52 4d2e 494e 565c 2822 2c20 225f 786c  ORM.INV\(", "_xl
+000076f0: 666e 2e4e 4f52 4d2e 494e 5628 222c 2066  fn.NORM.INV(", f
+00007700: 6f72 6d75 6c61 290a 2020 2020 2020 2020  ormula).        
+00007710: 666f 726d 756c 6120 3d20 7265 2e73 7562  formula = re.sub
+00007720: 2872 225c 6252 414e 4b2e 4156 475c 2822  (r"\bRANK.AVG\("
+00007730: 2c20 225f 786c 666e 2e52 414e 4b2e 4156  , "_xlfn.RANK.AV
+00007740: 4728 222c 2066 6f72 6d75 6c61 290a 2020  G(", formula).  
+00007750: 2020 2020 2020 666f 726d 756c 6120 3d20        formula = 
+00007760: 7265 2e73 7562 2872 225c 6254 2e49 4e56  re.sub(r"\bT.INV
+00007770: 2e32 545c 2822 2c20 225f 786c 666e 2e54  .2T\(", "_xlfn.T
+00007780: 2e49 4e56 2e32 5428 222c 2066 6f72 6d75  .INV.2T(", formu
+00007790: 6c61 290a 2020 2020 2020 2020 666f 726d  la).        form
+000077a0: 756c 6120 3d20 7265 2e73 7562 2872 225c  ula = re.sub(r"\
+000077b0: 6254 4558 544a 4f49 4e5c 2822 2c20 225f  bTEXTJOIN\(", "_
+000077c0: 786c 666e 2e54 4558 544a 4f49 4e28 222c  xlfn.TEXTJOIN(",
+000077d0: 2066 6f72 6d75 6c61 290a 2020 2020 2020   formula).      
+000077e0: 2020 666f 726d 756c 6120 3d20 7265 2e73    formula = re.s
+000077f0: 7562 2872 225c 6241 4747 5245 4741 5445  ub(r"\bAGGREGATE
+00007800: 5c28 222c 2022 5f78 6c66 6e2e 4147 4752  \(", "_xlfn.AGGR
+00007810: 4547 4154 4528 222c 2066 6f72 6d75 6c61  EGATE(", formula
+00007820: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
+00007830: 6120 3d20 7265 2e73 7562 2872 225c 6242  a = re.sub(r"\bB
+00007840: 4554 412e 4449 5354 5c28 222c 2022 5f78  ETA.DIST\(", "_x
+00007850: 6c66 6e2e 4245 5441 2e44 4953 5428 222c  lfn.BETA.DIST(",
+00007860: 2066 6f72 6d75 6c61 290a 2020 2020 2020   formula).      
+00007870: 2020 666f 726d 756c 6120 3d20 7265 2e73    formula = re.s
+00007880: 7562 2872 225c 6242 494e 4f4d 2e49 4e56  ub(r"\bBINOM.INV
+00007890: 5c28 222c 2022 5f78 6c66 6e2e 4249 4e4f  \(", "_xlfn.BINO
+000078a0: 4d2e 494e 5628 222c 2066 6f72 6d75 6c61  M.INV(", formula
+000078b0: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
+000078c0: 6120 3d20 7265 2e73 7562 2872 225c 6242  a = re.sub(r"\bB
+000078d0: 4954 4c53 4849 4654 5c28 222c 2022 5f78  ITLSHIFT\(", "_x
+000078e0: 6c66 6e2e 4249 544c 5348 4946 5428 222c  lfn.BITLSHIFT(",
+000078f0: 2066 6f72 6d75 6c61 290a 2020 2020 2020   formula).      
+00007900: 2020 666f 726d 756c 6120 3d20 7265 2e73    formula = re.s
+00007910: 7562 2872 225c 6242 4954 5253 4849 4654  ub(r"\bBITRSHIFT
+00007920: 5c28 222c 2022 5f78 6c66 6e2e 4249 5452  \(", "_xlfn.BITR
+00007930: 5348 4946 5428 222c 2066 6f72 6d75 6c61  SHIFT(", formula
+00007940: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
+00007950: 6120 3d20 7265 2e73 7562 2872 225c 6243  a = re.sub(r"\bC
+00007960: 4849 5351 2e49 4e56 5c28 222c 2022 5f78  HISQ.INV\(", "_x
+00007970: 6c66 6e2e 4348 4953 512e 494e 5628 222c  lfn.CHISQ.INV(",
+00007980: 2066 6f72 6d75 6c61 290a 2020 2020 2020   formula).      
+00007990: 2020 666f 726d 756c 6120 3d20 7265 2e73    formula = re.s
+000079a0: 7562 2872 225c 6246 2e44 4953 542e 5254  ub(r"\bF.DIST.RT
+000079b0: 5c28 222c 2022 5f78 6c66 6e2e 462e 4449  \(", "_xlfn.F.DI
+000079c0: 5354 2e52 5428 222c 2066 6f72 6d75 6c61  ST.RT(", formula
+000079d0: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
+000079e0: 6120 3d20 7265 2e73 7562 2872 225c 6246  a = re.sub(r"\bF
+000079f0: 494c 5445 5258 4d4c 5c28 222c 2022 5f78  ILTERXML\(", "_x
+00007a00: 6c66 6e2e 4649 4c54 4552 584d 4c28 222c  lfn.FILTERXML(",
+00007a10: 2066 6f72 6d75 6c61 290a 2020 2020 2020   formula).      
+00007a20: 2020 666f 726d 756c 6120 3d20 7265 2e73    formula = re.s
+00007a30: 7562 2872 225c 6247 414d 4d41 2e49 4e56  ub(r"\bGAMMA.INV
+00007a40: 5c28 222c 2022 5f78 6c66 6e2e 4741 4d4d  \(", "_xlfn.GAMM
+00007a50: 412e 494e 5628 222c 2066 6f72 6d75 6c61  A.INV(", formula
+00007a60: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
+00007a70: 6120 3d20 7265 2e73 7562 2872 225c 6249  a = re.sub(r"\bI
+00007a80: 5346 4f52 4d55 4c41 5c28 222c 2022 5f78  SFORMULA\(", "_x
+00007a90: 6c66 6e2e 4953 464f 524d 554c 4128 222c  lfn.ISFORMULA(",
+00007aa0: 2066 6f72 6d75 6c61 290a 2020 2020 2020   formula).      
+00007ab0: 2020 666f 726d 756c 6120 3d20 7265 2e73    formula = re.s
+00007ac0: 7562 2872 225c 624d 4f44 452e 4d55 4c54  ub(r"\bMODE.MULT
+00007ad0: 5c28 222c 2022 5f78 6c66 6e2e 4d4f 4445  \(", "_xlfn.MODE
+00007ae0: 2e4d 554c 5428 222c 2066 6f72 6d75 6c61  .MULT(", formula
+00007af0: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
+00007b00: 6120 3d20 7265 2e73 7562 2872 225c 624d  a = re.sub(r"\bM
+00007b10: 4f44 452e 534e 474c 5c28 222c 2022 5f78  ODE.SNGL\(", "_x
+00007b20: 6c66 6e2e 4d4f 4445 2e53 4e47 4c28 222c  lfn.MODE.SNGL(",
+00007b30: 2066 6f72 6d75 6c61 290a 2020 2020 2020   formula).      
+00007b40: 2020 666f 726d 756c 6120 3d20 7265 2e73    formula = re.s
+00007b50: 7562 2872 225c 624e 4f52 4d2e 4449 5354  ub(r"\bNORM.DIST
+00007b60: 5c28 222c 2022 5f78 6c66 6e2e 4e4f 524d  \(", "_xlfn.NORM
+00007b70: 2e44 4953 5428 222c 2066 6f72 6d75 6c61  .DIST(", formula
+00007b80: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
+00007b90: 6120 3d20 7265 2e73 7562 2872 225c 6250  a = re.sub(r"\bP
+00007ba0: 4455 5241 5449 4f4e 5c28 222c 2022 5f78  DURATION\(", "_x
+00007bb0: 6c66 6e2e 5044 5552 4154 494f 4e28 222c  lfn.PDURATION(",
+00007bc0: 2066 6f72 6d75 6c61 290a 2020 2020 2020   formula).      
+00007bd0: 2020 666f 726d 756c 6120 3d20 7265 2e73    formula = re.s
+00007be0: 7562 2872 225c 6254 2e44 4953 542e 3254  ub(r"\bT.DIST.2T
+00007bf0: 5c28 222c 2022 5f78 6c66 6e2e 542e 4449  \(", "_xlfn.T.DI
+00007c00: 5354 2e32 5428 222c 2066 6f72 6d75 6c61  ST.2T(", formula
+00007c10: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
+00007c20: 6120 3d20 7265 2e73 7562 2872 225c 6254  a = re.sub(r"\bT
+00007c30: 2e44 4953 542e 5254 5c28 222c 2022 5f78  .DIST.RT\(", "_x
+00007c40: 6c66 6e2e 542e 4449 5354 2e52 5428 222c  lfn.T.DIST.RT(",
+00007c50: 2066 6f72 6d75 6c61 290a 2020 2020 2020   formula).      
+00007c60: 2020 666f 726d 756c 6120 3d20 7265 2e73    formula = re.s
+00007c70: 7562 2872 225c 6242 494e 4f4d 2e44 4953  ub(r"\bBINOM.DIS
+00007c80: 545c 2822 2c20 225f 786c 666e 2e42 494e  T\(", "_xlfn.BIN
+00007c90: 4f4d 2e44 4953 5428 222c 2066 6f72 6d75  OM.DIST(", formu
+00007ca0: 6c61 290a 2020 2020 2020 2020 666f 726d  la).        form
+00007cb0: 756c 6120 3d20 7265 2e73 7562 2872 225c  ula = re.sub(r"\
+00007cc0: 6243 4849 5351 2e44 4953 545c 2822 2c20  bCHISQ.DIST\(", 
+00007cd0: 225f 786c 666e 2e43 4849 5351 2e44 4953  "_xlfn.CHISQ.DIS
+00007ce0: 5428 222c 2066 6f72 6d75 6c61 290a 2020  T(", formula).  
+00007cf0: 2020 2020 2020 666f 726d 756c 6120 3d20        formula = 
+00007d00: 7265 2e73 7562 2872 225c 6243 4849 5351  re.sub(r"\bCHISQ
+00007d10: 2e54 4553 545c 2822 2c20 225f 786c 666e  .TEST\(", "_xlfn
+00007d20: 2e43 4849 5351 2e54 4553 5428 222c 2066  .CHISQ.TEST(", f
+00007d30: 6f72 6d75 6c61 290a 2020 2020 2020 2020  ormula).        
+00007d40: 666f 726d 756c 6120 3d20 7265 2e73 7562  formula = re.sub
+00007d50: 2872 225c 6245 5850 4f4e 2e44 4953 545c  (r"\bEXPON.DIST\
+00007d60: 2822 2c20 225f 786c 666e 2e45 5850 4f4e  (", "_xlfn.EXPON
+00007d70: 2e44 4953 5428 222c 2066 6f72 6d75 6c61  .DIST(", formula
+00007d80: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
+00007d90: 6120 3d20 7265 2e73 7562 2872 225c 6246  a = re.sub(r"\bF
+00007da0: 4c4f 4f52 2e4d 4154 485c 2822 2c20 225f  LOOR.MATH\(", "_
+00007db0: 786c 666e 2e46 4c4f 4f52 2e4d 4154 4828  xlfn.FLOOR.MATH(
+00007dc0: 222c 2066 6f72 6d75 6c61 290a 2020 2020  ", formula).    
+00007dd0: 2020 2020 666f 726d 756c 6120 3d20 7265      formula = re
+00007de0: 2e73 7562 2872 225c 6247 414d 4d41 2e44  .sub(r"\bGAMMA.D
+00007df0: 4953 545c 2822 2c20 225f 786c 666e 2e47  IST\(", "_xlfn.G
+00007e00: 414d 4d41 2e44 4953 5428 222c 2066 6f72  AMMA.DIST(", for
+00007e10: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+00007e20: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+00007e30: 225c 6249 534f 5745 454b 4e55 4d5c 2822  "\bISOWEEKNUM\("
+00007e40: 2c20 225f 786c 666e 2e49 534f 5745 454b  , "_xlfn.ISOWEEK
+00007e50: 4e55 4d28 222c 2066 6f72 6d75 6c61 290a  NUM(", formula).
+00007e60: 2020 2020 2020 2020 666f 726d 756c 6120          formula 
+00007e70: 3d20 7265 2e73 7562 2872 225c 624e 4f52  = re.sub(r"\bNOR
+00007e80: 4d2e 532e 494e 565c 2822 2c20 225f 786c  M.S.INV\(", "_xl
+00007e90: 666e 2e4e 4f52 4d2e 532e 494e 5628 222c  fn.NORM.S.INV(",
+00007ea0: 2066 6f72 6d75 6c61 290a 2020 2020 2020   formula).      
+00007eb0: 2020 666f 726d 756c 6120 3d20 7265 2e73    formula = re.s
+00007ec0: 7562 2872 225c 6257 4542 5345 5256 4943  ub(r"\bWEBSERVIC
+00007ed0: 455c 2822 2c20 225f 786c 666e 2e57 4542  E\(", "_xlfn.WEB
+00007ee0: 5345 5256 4943 4528 222c 2066 6f72 6d75  SERVICE(", formu
+00007ef0: 6c61 290a 2020 2020 2020 2020 666f 726d  la).        form
+00007f00: 756c 6120 3d20 7265 2e73 7562 2872 225c  ula = re.sub(r"\
+00007f10: 6245 5246 2e50 5245 4349 5345 5c28 222c  bERF.PRECISE\(",
+00007f20: 2022 5f78 6c66 6e2e 4552 462e 5052 4543   "_xlfn.ERF.PREC
+00007f30: 4953 4528 222c 2066 6f72 6d75 6c61 290a  ISE(", formula).
+00007f40: 2020 2020 2020 2020 666f 726d 756c 6120          formula 
+00007f50: 3d20 7265 2e73 7562 2872 225c 6246 4f52  = re.sub(r"\bFOR
+00007f60: 4d55 4c41 5445 5854 5c28 222c 2022 5f78  MULATEXT\(", "_x
+00007f70: 6c66 6e2e 464f 524d 554c 4154 4558 5428  lfn.FORMULATEXT(
+00007f80: 222c 2066 6f72 6d75 6c61 290a 2020 2020  ", formula).    
+00007f90: 2020 2020 666f 726d 756c 6120 3d20 7265      formula = re
+00007fa0: 2e73 7562 2872 225c 624c 4f47 4e4f 524d  .sub(r"\bLOGNORM
+00007fb0: 2e49 4e56 5c28 222c 2022 5f78 6c66 6e2e  .INV\(", "_xlfn.
+00007fc0: 4c4f 474e 4f52 4d2e 494e 5628 222c 2066  LOGNORM.INV(", f
+00007fd0: 6f72 6d75 6c61 290a 2020 2020 2020 2020  ormula).        
+00007fe0: 666f 726d 756c 6120 3d20 7265 2e73 7562  formula = re.sub
+00007ff0: 2872 225c 624e 4f52 4d2e 532e 4449 5354  (r"\bNORM.S.DIST
+00008000: 5c28 222c 2022 5f78 6c66 6e2e 4e4f 524d  \(", "_xlfn.NORM
+00008010: 2e53 2e44 4953 5428 222c 2066 6f72 6d75  .S.DIST(", formu
+00008020: 6c61 290a 2020 2020 2020 2020 666f 726d  la).        form
+00008030: 756c 6120 3d20 7265 2e73 7562 2872 225c  ula = re.sub(r"\
+00008040: 624e 554d 4245 5256 414c 5545 5c28 222c  bNUMBERVALUE\(",
+00008050: 2022 5f78 6c66 6e2e 4e55 4d42 4552 5641   "_xlfn.NUMBERVA
+00008060: 4c55 4528 222c 2066 6f72 6d75 6c61 290a  LUE(", formula).
+00008070: 2020 2020 2020 2020 666f 726d 756c 6120          formula 
+00008080: 3d20 7265 2e73 7562 2872 225c 6251 5545  = re.sub(r"\bQUE
+00008090: 5259 5354 5249 4e47 5c28 222c 2022 5f78  RYSTRING\(", "_x
+000080a0: 6c66 6e2e 5155 4552 5953 5452 494e 4728  lfn.QUERYSTRING(
+000080b0: 222c 2066 6f72 6d75 6c61 290a 2020 2020  ", formula).    
+000080c0: 2020 2020 666f 726d 756c 6120 3d20 7265      formula = re
+000080d0: 2e73 7562 2872 225c 6243 4549 4c49 4e47  .sub(r"\bCEILING
+000080e0: 2e4d 4154 485c 2822 2c20 225f 786c 666e  .MATH\(", "_xlfn
+000080f0: 2e43 4549 4c49 4e47 2e4d 4154 4828 222c  .CEILING.MATH(",
+00008100: 2066 6f72 6d75 6c61 290a 2020 2020 2020   formula).      
+00008110: 2020 666f 726d 756c 6120 3d20 7265 2e73    formula = re.s
+00008120: 7562 2872 225c 6243 4849 5351 2e49 4e56  ub(r"\bCHISQ.INV
+00008130: 2e52 545c 2822 2c20 225f 786c 666e 2e43  .RT\(", "_xlfn.C
+00008140: 4849 5351 2e49 4e56 2e52 5428 222c 2066  HISQ.INV.RT(", f
+00008150: 6f72 6d75 6c61 290a 2020 2020 2020 2020  ormula).        
+00008160: 666f 726d 756c 6120 3d20 7265 2e73 7562  formula = re.sub
+00008170: 2872 225c 6243 4f4e 4649 4445 4e43 452e  (r"\bCONFIDENCE.
+00008180: 545c 2822 2c20 225f 786c 666e 2e43 4f4e  T\(", "_xlfn.CON
+00008190: 4649 4445 4e43 452e 5428 222c 2066 6f72  FIDENCE.T(", for
+000081a0: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+000081b0: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+000081c0: 225c 6243 4f56 4152 4941 4e43 452e 505c  "\bCOVARIANCE.P\
+000081d0: 2822 2c20 225f 786c 666e 2e43 4f56 4152  (", "_xlfn.COVAR
+000081e0: 4941 4e43 452e 5028 222c 2066 6f72 6d75  IANCE.P(", formu
+000081f0: 6c61 290a 2020 2020 2020 2020 666f 726d  la).        form
+00008200: 756c 6120 3d20 7265 2e73 7562 2872 225c  ula = re.sub(r"\
+00008210: 6243 4f56 4152 4941 4e43 452e 535c 2822  bCOVARIANCE.S\("
+00008220: 2c20 225f 786c 666e 2e43 4f56 4152 4941  , "_xlfn.COVARIA
+00008230: 4e43 452e 5328 222c 2066 6f72 6d75 6c61  NCE.S(", formula
+00008240: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
+00008250: 6120 3d20 7265 2e73 7562 2872 225c 6245  a = re.sub(r"\bE
+00008260: 5246 432e 5052 4543 4953 455c 2822 2c20  RFC.PRECISE\(", 
+00008270: 225f 786c 666e 2e45 5246 432e 5052 4543  "_xlfn.ERFC.PREC
+00008280: 4953 4528 222c 2066 6f72 6d75 6c61 290a  ISE(", formula).
+00008290: 2020 2020 2020 2020 666f 726d 756c 6120          formula 
+000082a0: 3d20 7265 2e73 7562 2872 225c 6246 4f52  = re.sub(r"\bFOR
+000082b0: 4543 4153 542e 4554 535c 2822 2c20 225f  ECAST.ETS\(", "_
+000082c0: 786c 666e 2e46 4f52 4543 4153 542e 4554  xlfn.FORECAST.ET
+000082d0: 5328 222c 2066 6f72 6d75 6c61 290a 2020  S(", formula).  
+000082e0: 2020 2020 2020 666f 726d 756c 6120 3d20        formula = 
+000082f0: 7265 2e73 7562 2872 225c 6248 5950 4745  re.sub(r"\bHYPGE
+00008300: 4f4d 2e44 4953 545c 2822 2c20 225f 786c  OM.DIST\(", "_xl
+00008310: 666e 2e48 5950 4745 4f4d 2e44 4953 5428  fn.HYPGEOM.DIST(
+00008320: 222c 2066 6f72 6d75 6c61 290a 2020 2020  ", formula).    
+00008330: 2020 2020 666f 726d 756c 6120 3d20 7265      formula = re
+00008340: 2e73 7562 2872 225c 624c 4f47 4e4f 524d  .sub(r"\bLOGNORM
+00008350: 2e44 4953 545c 2822 2c20 225f 786c 666e  .DIST\(", "_xlfn
+00008360: 2e4c 4f47 4e4f 524d 2e44 4953 5428 222c  .LOGNORM.DIST(",
+00008370: 2066 6f72 6d75 6c61 290a 2020 2020 2020   formula).      
+00008380: 2020 666f 726d 756c 6120 3d20 7265 2e73    formula = re.s
+00008390: 7562 2872 225c 6250 4552 4d55 5441 5449  ub(r"\bPERMUTATI
+000083a0: 4f4e 415c 2822 2c20 225f 786c 666e 2e50  ONA\(", "_xlfn.P
+000083b0: 4552 4d55 5441 5449 4f4e 4128 222c 2066  ERMUTATIONA(", f
+000083c0: 6f72 6d75 6c61 290a 2020 2020 2020 2020  ormula).        
+000083d0: 666f 726d 756c 6120 3d20 7265 2e73 7562  formula = re.sub
+000083e0: 2872 225c 6250 4f49 5353 4f4e 2e44 4953  (r"\bPOISSON.DIS
+000083f0: 545c 2822 2c20 225f 786c 666e 2e50 4f49  T\(", "_xlfn.POI
+00008400: 5353 4f4e 2e44 4953 5428 222c 2066 6f72  SSON.DIST(", for
+00008410: 6d75 6c61 290a 2020 2020 2020 2020 666f  mula).        fo
+00008420: 726d 756c 6120 3d20 7265 2e73 7562 2872  rmula = re.sub(r
+00008430: 225c 6251 5541 5254 494c 452e 4558 435c  "\bQUARTILE.EXC\
+00008440: 2822 2c20 225f 786c 666e 2e51 5541 5254  (", "_xlfn.QUART
+00008450: 494c 452e 4558 4328 222c 2066 6f72 6d75  ILE.EXC(", formu
+00008460: 6c61 290a 2020 2020 2020 2020 666f 726d  la).        form
+00008470: 756c 6120 3d20 7265 2e73 7562 2872 225c  ula = re.sub(r"\
+00008480: 6251 5541 5254 494c 452e 494e 435c 2822  bQUARTILE.INC\("
+00008490: 2c20 225f 786c 666e 2e51 5541 5254 494c  , "_xlfn.QUARTIL
+000084a0: 452e 494e 4328 222c 2066 6f72 6d75 6c61  E.INC(", formula
+000084b0: 290a 2020 2020 2020 2020 666f 726d 756c  ).        formul
+000084c0: 6120 3d20 7265 2e73 7562 2872 225c 6257  a = re.sub(r"\bW
+000084d0: 4549 4255 4c4c 2e44 4953 545c 2822 2c20  EIBULL.DIST\(", 
+000084e0: 225f 786c 666e 2e57 4549 4255 4c4c 2e44  "_xlfn.WEIBULL.D
+000084f0: 4953 5428 222c 2066 6f72 6d75 6c61 290a  IST(", formula).
+00008500: 2020 2020 2020 2020 666f 726d 756c 6120          formula 
+00008510: 3d20 7265 2e73 7562 2872 225c 6243 4849  = re.sub(r"\bCHI
+00008520: 5351 2e44 4953 542e 5254 5c28 222c 2022  SQ.DIST.RT\(", "
+00008530: 5f78 6c66 6e2e 4348 4953 512e 4449 5354  _xlfn.CHISQ.DIST
+00008540: 2e52 5428 222c 2066 6f72 6d75 6c61 290a  .RT(", formula).
+00008550: 2020 2020 2020 2020 666f 726d 756c 6120          formula 
+00008560: 3d20 7265 2e73 7562 2872 225c 6246 4c4f  = re.sub(r"\bFLO
+00008570: 4f52 2e50 5245 4349 5345 5c28 222c 2022  OR.PRECISE\(", "
+00008580: 5f78 6c66 6e2e 464c 4f4f 522e 5052 4543  _xlfn.FLOOR.PREC
+00008590: 4953 4528 222c 2066 6f72 6d75 6c61 290a  ISE(", formula).
+000085a0: 2020 2020 2020 2020 666f 726d 756c 6120          formula 
+000085b0: 3d20 7265 2e73 7562 2872 225c 624e 4547  = re.sub(r"\bNEG
+000085c0: 4249 4e4f 4d2e 4449 5354 5c28 222c 2022  BINOM.DIST\(", "
+000085d0: 5f78 6c66 6e2e 4e45 4742 494e 4f4d 2e44  _xlfn.NEGBINOM.D
+000085e0: 4953 5428 222c 2066 6f72 6d75 6c61 290a  IST(", formula).
+000085f0: 0a20 2020 2020 2020 2066 6f72 6d75 6c61  .        formula
+00008600: 203d 2072 652e 7375 6228 7222 5c62 5045   = re.sub(r"\bPE
+00008610: 5243 454e 5449 4c45 2e45 5843 5c28 222c  RCENTILE.EXC\(",
+00008620: 2022 5f78 6c66 6e2e 5045 5243 454e 5449   "_xlfn.PERCENTI
+00008630: 4c45 2e45 5843 2822 2c20 666f 726d 756c  LE.EXC(", formul
+00008640: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
+00008650: 6c61 203d 2072 652e 7375 6228 7222 5c62  la = re.sub(r"\b
+00008660: 5045 5243 454e 5449 4c45 2e49 4e43 5c28  PERCENTILE.INC\(
+00008670: 222c 2022 5f78 6c66 6e2e 5045 5243 454e  ", "_xlfn.PERCEN
+00008680: 5449 4c45 2e49 4e43 2822 2c20 666f 726d  TILE.INC(", form
+00008690: 756c 6129 0a20 2020 2020 2020 2066 6f72  ula).        for
+000086a0: 6d75 6c61 203d 2072 652e 7375 6228 7222  mula = re.sub(r"
+000086b0: 5c62 4345 494c 494e 472e 5052 4543 4953  \bCEILING.PRECIS
+000086c0: 455c 2822 2c20 225f 786c 666e 2e43 4549  E\(", "_xlfn.CEI
+000086d0: 4c49 4e47 2e50 5245 4349 5345 2822 2c20  LING.PRECISE(", 
+000086e0: 666f 726d 756c 6129 0a20 2020 2020 2020  formula).       
+000086f0: 2066 6f72 6d75 6c61 203d 2072 652e 7375   formula = re.su
+00008700: 6228 7222 5c62 434f 4e46 4944 454e 4345  b(r"\bCONFIDENCE
+00008710: 2e4e 4f52 4d5c 2822 2c20 225f 786c 666e  .NORM\(", "_xlfn
+00008720: 2e43 4f4e 4649 4445 4e43 452e 4e4f 524d  .CONFIDENCE.NORM
+00008730: 2822 2c20 666f 726d 756c 6129 0a20 2020  (", formula).   
+00008740: 2020 2020 2066 6f72 6d75 6c61 203d 2072       formula = r
+00008750: 652e 7375 6228 7222 5c62 464f 5245 4341  e.sub(r"\bFORECA
+00008760: 5354 2e4c 494e 4541 525c 2822 2c20 225f  ST.LINEAR\(", "_
+00008770: 786c 666e 2e46 4f52 4543 4153 542e 4c49  xlfn.FORECAST.LI
+00008780: 4e45 4152 2822 2c20 666f 726d 756c 6129  NEAR(", formula)
+00008790: 0a20 2020 2020 2020 2066 6f72 6d75 6c61  .        formula
+000087a0: 203d 2072 652e 7375 6228 7222 5c62 4741   = re.sub(r"\bGA
+000087b0: 4d4d 414c 4e2e 5052 4543 4953 455c 2822  MMALN.PRECISE\("
+000087c0: 2c20 225f 786c 666e 2e47 414d 4d41 4c4e  , "_xlfn.GAMMALN
+000087d0: 2e50 5245 4349 5345 2822 2c20 666f 726d  .PRECISE(", form
+000087e0: 756c 6129 0a20 2020 2020 2020 2066 6f72  ula).        for
+000087f0: 6d75 6c61 203d 2072 652e 7375 6228 7222  mula = re.sub(r"
+00008800: 5c62 5045 5243 454e 5452 414e 4b2e 4558  \bPERCENTRANK.EX
+00008810: 435c 2822 2c20 225f 786c 666e 2e50 4552  C\(", "_xlfn.PER
+00008820: 4345 4e54 5241 4e4b 2e45 5843 2822 2c20  CENTRANK.EXC(", 
+00008830: 666f 726d 756c 6129 0a20 2020 2020 2020  formula).       
+00008840: 2066 6f72 6d75 6c61 203d 2072 652e 7375   formula = re.su
+00008850: 6228 7222 5c62 5045 5243 454e 5452 414e  b(r"\bPERCENTRAN
+00008860: 4b2e 494e 435c 2822 2c20 225f 786c 666e  K.INC\(", "_xlfn
+00008870: 2e50 4552 4345 4e54 5241 4e4b 2e49 4e43  .PERCENTRANK.INC
+00008880: 2822 2c20 666f 726d 756c 6129 0a20 2020  (", formula).   
+00008890: 2020 2020 2066 6f72 6d75 6c61 203d 2072       formula = r
+000088a0: 652e 7375 6228 7222 5c62 4249 4e4f 4d2e  e.sub(r"\bBINOM.
+000088b0: 4449 5354 2e52 414e 4745 5c28 222c 2022  DIST.RANGE\(", "
+000088c0: 5f78 6c66 6e2e 4249 4e4f 4d2e 4449 5354  _xlfn.BINOM.DIST
+000088d0: 2e52 414e 4745 2822 2c20 666f 726d 756c  .RANGE(", formul
+000088e0: 6129 0a20 2020 2020 2020 2066 6f72 6d75  a).        formu
+000088f0: 6c61 203d 2072 652e 7375 6228 7222 5c62  la = re.sub(r"\b
+00008900: 464f 5245 4341 5354 2e45 5453 2e53 5441  FORECAST.ETS.STA
+00008910: 545c 2822 2c20 225f 786c 666e 2e46 4f52  T\(", "_xlfn.FOR
+00008920: 4543 4153 542e 4554 532e 5354 4154 2822  ECAST.ETS.STAT("
+00008930: 2c20 666f 726d 756c 6129 0a20 2020 2020  , formula).     
+00008940: 2020 2066 6f72 6d75 6c61 203d 2072 652e     formula = re.
+00008950: 7375 6228 0a20 2020 2020 2020 2020 2020  sub(.           
+00008960: 2072 225c 6246 4f52 4543 4153 542e 4554   r"\bFORECAST.ET
+00008970: 532e 434f 4e46 494e 545c 2822 2c20 225f  S.CONFINT\(", "_
+00008980: 786c 666e 2e46 4f52 4543 4153 542e 4554  xlfn.FORECAST.ET
+00008990: 532e 434f 4e46 494e 5428 222c 2066 6f72  S.CONFINT(", for
+000089a0: 6d75 6c61 0a20 2020 2020 2020 2029 0a20  mula.        ). 
+000089b0: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
+000089c0: 2072 652e 7375 6228 0a20 2020 2020 2020   re.sub(.       
+000089d0: 2020 2020 2072 225c 6246 4f52 4543 4153       r"\bFORECAS
+000089e0: 542e 4554 532e 5345 4153 4f4e 414c 4954  T.ETS.SEASONALIT
+000089f0: 595c 2822 2c20 225f 786c 666e 2e46 4f52  Y\(", "_xlfn.FOR
+00008a00: 4543 4153 542e 4554 532e 5345 4153 4f4e  ECAST.ETS.SEASON
+00008a10: 414c 4954 5928 222c 2066 6f72 6d75 6c61  ALITY(", formula
+00008a20: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00008a30: 2020 2020 7265 7475 726e 2066 6f72 6d75      return formu
+00008a40: 6c61 0a0a 2020 2020 2320 556e 6465 636f  la..    # Undeco
+00008a50: 7261 7465 6420 7665 7273 696f 6e20 6f66  rated version of
+00008a60: 2077 7269 7465 5f61 7272 6179 5f66 6f72   write_array_for
+00008a70: 6d75 6c61 2829 2061 6e64 0a20 2020 2023  mula() and.    #
+00008a80: 2077 7269 7465 5f64 796e 616d 6963 5f61   write_dynamic_a
+00008a90: 7272 6179 5f66 6f72 6d75 6c61 2829 2e0a  rray_formula()..
+00008aa0: 2020 2020 6465 6620 5f77 7269 7465 5f61      def _write_a
+00008ab0: 7272 6179 5f66 6f72 6d75 6c61 280a 2020  rray_formula(.  
+00008ac0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00008ad0: 2020 2020 6669 7273 745f 726f 772c 0a20      first_row,. 
+00008ae0: 2020 2020 2020 2066 6972 7374 5f63 6f6c         first_col
+00008af0: 2c0a 2020 2020 2020 2020 6c61 7374 5f72  ,.        last_r
+00008b00: 6f77 2c0a 2020 2020 2020 2020 6c61 7374  ow,.        last
+00008b10: 5f63 6f6c 2c0a 2020 2020 2020 2020 666f  _col,.        fo
+00008b20: 726d 756c 612c 0a20 2020 2020 2020 2063  rmula,.        c
+00008b30: 656c 6c5f 666f 726d 6174 3d4e 6f6e 652c  ell_format=None,
+00008b40: 0a20 2020 2020 2020 2076 616c 7565 3d30  .        value=0
+00008b50: 2c0a 2020 2020 2020 2020 6174 7970 653d  ,.        atype=
+00008b60: 2273 7461 7469 6322 2c0a 2020 2020 293a  "static",.    ):
+00008b70: 0a20 2020 2020 2020 2023 2053 7761 7020  .        # Swap 
+00008b80: 6c61 7374 2072 6f77 2f63 6f6c 2077 6974  last row/col wit
+00008b90: 6820 6669 7273 7420 726f 772f 636f 6c20  h first row/col 
+00008ba0: 6173 206e 6563 6573 7361 7279 2e0a 2020  as necessary..  
+00008bb0: 2020 2020 2020 6966 2066 6972 7374 5f72        if first_r
+00008bc0: 6f77 203e 206c 6173 745f 726f 773a 0a20  ow > last_row:. 
+00008bd0: 2020 2020 2020 2020 2020 2066 6972 7374             first
+00008be0: 5f72 6f77 2c20 6c61 7374 5f72 6f77 203d  _row, last_row =
+00008bf0: 206c 6173 745f 726f 772c 2066 6972 7374   last_row, first
+00008c00: 5f72 6f77 0a20 2020 2020 2020 2069 6620  _row.        if 
+00008c10: 6669 7273 745f 636f 6c20 3e20 6c61 7374  first_col > last
+00008c20: 5f63 6f6c 3a0a 2020 2020 2020 2020 2020  _col:.          
+00008c30: 2020 6669 7273 745f 636f 6c2c 206c 6173    first_col, las
+00008c40: 745f 636f 6c20 3d20 6c61 7374 5f63 6f6c  t_col = last_col
+00008c50: 2c20 6669 7273 745f 636f 6c0a 0a20 2020  , first_col..   
+00008c60: 2020 2020 2023 2043 6865 636b 2074 6861       # Check tha
+00008c70: 7420 726f 7720 616e 6420 636f 6c20 6172  t row and col ar
+00008c80: 6520 7661 6c69 6420 616e 6420 7374 6f72  e valid and stor
+00008c90: 6520 6d61 7820 616e 6420 6d69 6e20 7661  e max and min va
+00008ca0: 6c75 6573 2e0a 2020 2020 2020 2020 6966  lues..        if
+00008cb0: 2073 656c 662e 5f63 6865 636b 5f64 696d   self._check_dim
+00008cc0: 656e 7369 6f6e 7328 6669 7273 745f 726f  ensions(first_ro
+00008cd0: 772c 2066 6972 7374 5f63 6f6c 293a 0a20  w, first_col):. 
+00008ce0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00008cf0: 6e20 2d31 0a20 2020 2020 2020 2069 6620  n -1.        if 
+00008d00: 7365 6c66 2e5f 6368 6563 6b5f 6469 6d65  self._check_dime
+00008d10: 6e73 696f 6e73 286c 6173 745f 726f 772c  nsions(last_row,
+00008d20: 206c 6173 745f 636f 6c29 3a0a 2020 2020   last_col):.    
+00008d30: 2020 2020 2020 2020 7265 7475 726e 202d          return -
+00008d40: 310a 0a20 2020 2020 2020 2023 2044 6566  1..        # Def
+00008d50: 696e 6520 6172 7261 7920 7261 6e67 650a  ine array range.
+00008d60: 2020 2020 2020 2020 6966 2066 6972 7374          if first
+00008d70: 5f72 6f77 203d 3d20 6c61 7374 5f72 6f77  _row == last_row
+00008d80: 2061 6e64 2066 6972 7374 5f63 6f6c 203d   and first_col =
+00008d90: 3d20 6c61 7374 5f63 6f6c 3a0a 2020 2020  = last_col:.    
+00008da0: 2020 2020 2020 2020 6365 6c6c 5f72 616e          cell_ran
+00008db0: 6765 203d 2078 6c5f 726f 7763 6f6c 5f74  ge = xl_rowcol_t
+00008dc0: 6f5f 6365 6c6c 2866 6972 7374 5f72 6f77  o_cell(first_row
+00008dd0: 2c20 6669 7273 745f 636f 6c29 0a20 2020  , first_col).   
+00008de0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00008df0: 2020 2020 2020 2063 656c 6c5f 7261 6e67         cell_rang
+00008e00: 6520 3d20 280a 2020 2020 2020 2020 2020  e = (.          
+00008e10: 2020 2020 2020 786c 5f72 6f77 636f 6c5f        xl_rowcol_
+00008e20: 746f 5f63 656c 6c28 6669 7273 745f 726f  to_cell(first_ro
+00008e30: 772c 2066 6972 7374 5f63 6f6c 290a 2020  w, first_col).  
+00008e40: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
+00008e50: 223a 220a 2020 2020 2020 2020 2020 2020  ":".            
+00008e60: 2020 2020 2b20 786c 5f72 6f77 636f 6c5f      + xl_rowcol_
+00008e70: 746f 5f63 656c 6c28 6c61 7374 5f72 6f77  to_cell(last_row
+00008e80: 2c20 6c61 7374 5f63 6f6c 290a 2020 2020  , last_col).    
+00008e90: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00008ea0: 2020 2023 204d 6f64 6966 7920 7468 6520     # Modify the 
+00008eb0: 666f 726d 756c 6120 7374 7269 6e67 2c20  formula string, 
+00008ec0: 6173 206e 6565 6465 642e 0a20 2020 2020  as needed..     
+00008ed0: 2020 2066 6f72 6d75 6c61 203d 2073 656c     formula = sel
+00008ee0: 662e 5f70 7265 7061 7265 5f66 6f72 6d75  f._prepare_formu
+00008ef0: 6c61 2866 6f72 6d75 6c61 290a 0a20 2020  la(formula)..   
+00008f00: 2020 2020 2023 2057 7269 7465 2070 7265       # Write pre
+00008f10: 7669 6f75 7320 726f 7720 6966 2069 6e20  vious row if in 
+00008f20: 696e 2d6c 696e 6520 7374 7269 6e67 2063  in-line string c
+00008f30: 6f6e 7374 616e 745f 6d65 6d6f 7279 206d  onstant_memory m
+00008f40: 6f64 652e 0a20 2020 2020 2020 2069 6620  ode..        if 
+00008f50: 7365 6c66 2e63 6f6e 7374 616e 745f 6d65  self.constant_me
+00008f60: 6d6f 7279 2061 6e64 2066 6972 7374 5f72  mory and first_r
+00008f70: 6f77 203e 2073 656c 662e 7072 6576 696f  ow > self.previo
+00008f80: 7573 5f72 6f77 3a0a 2020 2020 2020 2020  us_row:.        
+00008f90: 2020 2020 7365 6c66 2e5f 7772 6974 655f      self._write_
+00008fa0: 7369 6e67 6c65 5f72 6f77 2866 6972 7374  single_row(first
+00008fb0: 5f72 6f77 290a 0a20 2020 2020 2020 2023  _row)..        #
+00008fc0: 2053 746f 7265 2074 6865 2063 656c 6c20   Store the cell 
+00008fd0: 6461 7461 2069 6e20 7468 6520 776f 726b  data in the work
+00008fe0: 7368 6565 7420 6461 7461 2074 6162 6c65  sheet data table
+00008ff0: 2e0a 2020 2020 2020 2020 7365 6c66 2e74  ..        self.t
+00009000: 6162 6c65 5b66 6972 7374 5f72 6f77 5d5b  able[first_row][
+00009010: 6669 7273 745f 636f 6c5d 203d 2063 656c  first_col] = cel
+00009020: 6c5f 6172 666f 726d 756c 615f 7475 706c  l_arformula_tupl
+00009030: 6528 0a20 2020 2020 2020 2020 2020 2066  e(.            f
+00009040: 6f72 6d75 6c61 2c20 6365 6c6c 5f66 6f72  ormula, cell_for
+00009050: 6d61 742c 2076 616c 7565 2c20 6365 6c6c  mat, value, cell
+00009060: 5f72 616e 6765 2c20 6174 7970 650a 2020  _range, atype.  
+00009070: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00009080: 2023 2050 6164 206f 7574 2074 6865 2072   # Pad out the r
+00009090: 6573 7420 6f66 2074 6865 2061 7265 6120  est of the area 
+000090a0: 7769 7468 2066 6f72 6d61 7474 6564 207a  with formatted z
+000090b0: 6572 6f65 732e 0a20 2020 2020 2020 2069  eroes..        i
+000090c0: 6620 6e6f 7420 7365 6c66 2e63 6f6e 7374  f not self.const
+000090d0: 616e 745f 6d65 6d6f 7279 3a0a 2020 2020  ant_memory:.    
+000090e0: 2020 2020 2020 2020 666f 7220 726f 7720          for row 
+000090f0: 696e 2072 616e 6765 2866 6972 7374 5f72  in range(first_r
+00009100: 6f77 2c20 6c61 7374 5f72 6f77 202b 2031  ow, last_row + 1
+00009110: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00009120: 2020 2066 6f72 2063 6f6c 2069 6e20 7261     for col in ra
+00009130: 6e67 6528 6669 7273 745f 636f 6c2c 206c  nge(first_col, l
+00009140: 6173 745f 636f 6c20 2b20 3129 3a0a 2020  ast_col + 1):.  
+00009150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009160: 2020 6966 2072 6f77 2021 3d20 6669 7273    if row != firs
+00009170: 745f 726f 7720 6f72 2063 6f6c 2021 3d20  t_row or col != 
+00009180: 6669 7273 745f 636f 6c3a 0a20 2020 2020  first_col:.     
+00009190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000091a0: 2020 2073 656c 662e 5f77 7269 7465 5f6e     self._write_n
+000091b0: 756d 6265 7228 726f 772c 2063 6f6c 2c20  umber(row, col, 
+000091c0: 302c 2063 656c 6c5f 666f 726d 6174 290a  0, cell_format).
+000091d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000091e0: 300a 0a20 2020 2040 636f 6e76 6572 745f  0..    @convert_
+000091f0: 6365 6c6c 5f61 7267 730a 2020 2020 6465  cell_args.    de
+00009200: 6620 7772 6974 655f 6461 7465 7469 6d65  f write_datetime
+00009210: 2873 656c 662c 2072 6f77 2c20 636f 6c2c  (self, row, col,
+00009220: 2064 6174 652c 2063 656c 6c5f 666f 726d   date, cell_form
+00009230: 6174 3d4e 6f6e 6529 3a0a 2020 2020 2020  at=None):.      
+00009240: 2020 2222 220a 2020 2020 2020 2020 5772    """.        Wr
+00009250: 6974 6520 6120 6461 7465 206f 7220 7469  ite a date or ti
+00009260: 6d65 2074 6f20 6120 776f 726b 7368 6565  me to a workshee
+00009270: 7420 6365 6c6c 2e0a 0a20 2020 2020 2020  t cell...       
+00009280: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
+00009290: 2020 2072 6f77 3a20 2020 2020 2020 2020     row:         
+000092a0: 5468 6520 6365 6c6c 2072 6f77 2028 7a65  The cell row (ze
+000092b0: 726f 2069 6e64 6578 6564 292e 0a20 2020  ro indexed)..   
+000092c0: 2020 2020 2020 2020 2063 6f6c 3a20 2020           col:   
+000092d0: 2020 2020 2020 5468 6520 6365 6c6c 2063        The cell c
+000092e0: 6f6c 756d 6e20 287a 6572 6f20 696e 6465  olumn (zero inde
+000092f0: 7865 6429 2e0a 2020 2020 2020 2020 2020  xed)..          
+00009300: 2020 6461 7465 3a20 2020 2020 2020 2044    date:        D
+00009310: 6174 6520 616e 642f 6f72 2074 696d 6520  ate and/or time 
+00009320: 6173 2061 2064 6174 6574 696d 6520 6f62  as a datetime ob
+00009330: 6a65 6374 2e0a 2020 2020 2020 2020 2020  ject..          
+00009340: 2020 6365 6c6c 5f66 6f72 6d61 743a 2041    cell_format: A
+00009350: 2063 656c 6c20 466f 726d 6174 206f 626a   cell Format obj
+00009360: 6563 742e 0a0a 2020 2020 2020 2020 5265  ect...        Re
+00009370: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
+00009380: 2020 2030 3a20 2053 7563 6365 7373 2e0a     0:  Success..
+00009390: 2020 2020 2020 2020 2020 2020 2d31 3a20              -1: 
+000093a0: 526f 7720 6f72 2063 6f6c 756d 6e20 6973  Row or column is
+000093b0: 206f 7574 206f 6620 776f 726b 7368 6565   out of workshee
+000093c0: 7420 626f 756e 6473 2e0a 0a20 2020 2020  t bounds...     
+000093d0: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+000093e0: 6574 7572 6e20 7365 6c66 2e5f 7772 6974  eturn self._writ
+000093f0: 655f 6461 7465 7469 6d65 2872 6f77 2c20  e_datetime(row, 
+00009400: 636f 6c2c 2064 6174 652c 2063 656c 6c5f  col, date, cell_
+00009410: 666f 726d 6174 290a 0a20 2020 2023 2055  format)..    # U
+00009420: 6e64 6563 6f72 6174 6564 2076 6572 7369  ndecorated versi
+00009430: 6f6e 206f 6620 7772 6974 655f 6461 7465  on of write_date
+00009440: 7469 6d65 2829 2e0a 2020 2020 6465 6620  time()..    def 
+00009450: 5f77 7269 7465 5f64 6174 6574 696d 6528  _write_datetime(
+00009460: 7365 6c66 2c20 726f 772c 2063 6f6c 2c20  self, row, col, 
+00009470: 6461 7465 2c20 6365 6c6c 5f66 6f72 6d61  date, cell_forma
+00009480: 743d 4e6f 6e65 293a 0a20 2020 2020 2020  t=None):.       
+00009490: 2023 2043 6865 636b 2074 6861 7420 726f   # Check that ro
+000094a0: 7720 616e 6420 636f 6c20 6172 6520 7661  w and col are va
+000094b0: 6c69 6420 616e 6420 7374 6f72 6520 6d61  lid and store ma
+000094c0: 7820 616e 6420 6d69 6e20 7661 6c75 6573  x and min values
+000094d0: 2e0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+000094e0: 662e 5f63 6865 636b 5f64 696d 656e 7369  f._check_dimensi
+000094f0: 6f6e 7328 726f 772c 2063 6f6c 293a 0a20  ons(row, col):. 
+00009500: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00009510: 6e20 2d31 0a0a 2020 2020 2020 2020 2320  n -1..        # 
+00009520: 5772 6974 6520 7072 6576 696f 7573 2072  Write previous r
+00009530: 6f77 2069 6620 696e 2069 6e2d 6c69 6e65  ow if in in-line
+00009540: 2073 7472 696e 6720 636f 6e73 7461 6e74   string constant
+00009550: 5f6d 656d 6f72 7920 6d6f 6465 2e0a 2020  _memory mode..  
+00009560: 2020 2020 2020 6966 2073 656c 662e 636f        if self.co
+00009570: 6e73 7461 6e74 5f6d 656d 6f72 7920 616e  nstant_memory an
+00009580: 6420 726f 7720 3e20 7365 6c66 2e70 7265  d row > self.pre
+00009590: 7669 6f75 735f 726f 773a 0a20 2020 2020  vious_row:.     
+000095a0: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
+000095b0: 7465 5f73 696e 676c 655f 726f 7728 726f  te_single_row(ro
+000095c0: 7729 0a0a 2020 2020 2020 2020 2320 436f  w)..        # Co
+000095d0: 6e76 6572 7420 6461 7465 7469 6d65 2074  nvert datetime t
+000095e0: 6f20 616e 2045 7863 656c 2064 6174 652e  o an Excel date.
+000095f0: 0a20 2020 2020 2020 206e 756d 6265 7220  .        number 
+00009600: 3d20 7365 6c66 2e5f 636f 6e76 6572 745f  = self._convert_
+00009610: 6461 7465 5f74 696d 6528 6461 7465 290a  date_time(date).
+00009620: 0a20 2020 2020 2020 2023 2041 6464 2074  .        # Add t
+00009630: 6865 2064 6566 6175 6c74 2064 6174 6520  he default date 
+00009640: 666f 726d 6174 2e0a 2020 2020 2020 2020  format..        
+00009650: 6966 2063 656c 6c5f 666f 726d 6174 2069  if cell_format i
+00009660: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00009670: 2020 2020 6365 6c6c 5f66 6f72 6d61 7420      cell_format 
+00009680: 3d20 7365 6c66 2e64 6566 6175 6c74 5f64  = self.default_d
+00009690: 6174 655f 666f 726d 6174 0a0a 2020 2020  ate_format..    
+000096a0: 2020 2020 2320 5374 6f72 6520 7468 6520      # Store the 
+000096b0: 6365 6c6c 2064 6174 6120 696e 2074 6865  cell data in the
+000096c0: 2077 6f72 6b73 6865 6574 2064 6174 6120   worksheet data 
+000096d0: 7461 626c 652e 0a20 2020 2020 2020 2073  table..        s
+000096e0: 656c 662e 7461 626c 655b 726f 775d 5b63  elf.table[row][c
+000096f0: 6f6c 5d20 3d20 6365 6c6c 5f64 6174 6574  ol] = cell_datet
+00009700: 696d 655f 7475 706c 6528 6e75 6d62 6572  ime_tuple(number
+00009710: 2c20 6365 6c6c 5f66 6f72 6d61 7429 0a0a  , cell_format)..
+00009720: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
+00009730: 0a0a 2020 2020 4063 6f6e 7665 7274 5f63  ..    @convert_c
+00009740: 656c 6c5f 6172 6773 0a20 2020 2064 6566  ell_args.    def
+00009750: 2077 7269 7465 5f62 6f6f 6c65 616e 2873   write_boolean(s
+00009760: 656c 662c 2072 6f77 2c20 636f 6c2c 2062  elf, row, col, b
+00009770: 6f6f 6c65 616e 2c20 6365 6c6c 5f66 6f72  oolean, cell_for
+00009780: 6d61 743d 4e6f 6e65 293a 0a20 2020 2020  mat=None):.     
+00009790: 2020 2022 2222 0a20 2020 2020 2020 2057     """.        W
+000097a0: 7269 7465 2061 2062 6f6f 6c65 616e 2076  rite a boolean v
+000097b0: 616c 7565 2074 6f20 6120 776f 726b 7368  alue to a worksh
+000097c0: 6565 7420 6365 6c6c 2e0a 0a20 2020 2020  eet cell...     
+000097d0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+000097e0: 2020 2020 2072 6f77 3a20 2020 2020 2020       row:       
+000097f0: 2020 5468 6520 6365 6c6c 2072 6f77 2028    The cell row (
+00009800: 7a65 726f 2069 6e64 6578 6564 292e 0a20  zero indexed).. 
+00009810: 2020 2020 2020 2020 2020 2063 6f6c 3a20             col: 
+00009820: 2020 2020 2020 2020 5468 6520 6365 6c6c          The cell
+00009830: 2063 6f6c 756d 6e20 287a 6572 6f20 696e   column (zero in
+00009840: 6465 7865 6429 2e0a 2020 2020 2020 2020  dexed)..        
+00009850: 2020 2020 626f 6f6c 6561 6e3a 2020 2020      boolean:    
+00009860: 2043 656c 6c20 6461 7461 2e20 626f 6f6c   Cell data. bool
+00009870: 2074 7970 652e 0a20 2020 2020 2020 2020   type..         
+00009880: 2020 2063 656c 6c5f 666f 726d 6174 3a20     cell_format: 
+00009890: 416e 206f 7074 696f 6e61 6c20 6365 6c6c  An optional cell
+000098a0: 2046 6f72 6d61 7420 6f62 6a65 6374 2e0a   Format object..
+000098b0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+000098c0: 3a0a 2020 2020 2020 2020 2020 2020 303a  :.            0:
+000098d0: 2020 5375 6363 6573 732e 0a20 2020 2020    Success..     
+000098e0: 2020 2020 2020 202d 313a 2052 6f77 206f         -1: Row o
+000098f0: 7220 636f 6c75 6d6e 2069 7320 6f75 7420  r column is out 
+00009900: 6f66 2077 6f72 6b73 6865 6574 2062 6f75  of worksheet bou
+00009910: 6e64 732e 0a0a 2020 2020 2020 2020 2222  nds...        ""
+00009920: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00009930: 2073 656c 662e 5f77 7269 7465 5f62 6f6f   self._write_boo
+00009940: 6c65 616e 2872 6f77 2c20 636f 6c2c 2062  lean(row, col, b
+00009950: 6f6f 6c65 616e 2c20 6365 6c6c 5f66 6f72  oolean, cell_for
+00009960: 6d61 7429 0a0a 2020 2020 2320 556e 6465  mat)..    # Unde
+00009970: 636f 7261 7465 6420 7665 7273 696f 6e20  corated version 
+00009980: 6f66 2077 7269 7465 5f62 6f6f 6c65 616e  of write_boolean
+00009990: 2829 2e0a 2020 2020 6465 6620 5f77 7269  ()..    def _wri
+000099a0: 7465 5f62 6f6f 6c65 616e 2873 656c 662c  te_boolean(self,
+000099b0: 2072 6f77 2c20 636f 6c2c 2062 6f6f 6c65   row, col, boole
+000099c0: 616e 2c20 6365 6c6c 5f66 6f72 6d61 743d  an, cell_format=
+000099d0: 4e6f 6e65 293a 0a20 2020 2020 2020 2023  None):.        #
+000099e0: 2043 6865 636b 2074 6861 7420 726f 7720   Check that row 
+000099f0: 616e 6420 636f 6c20 6172 6520 7661 6c69  and col are vali
+00009a00: 6420 616e 6420 7374 6f72 6520 6d61 7820  d and store max 
+00009a10: 616e 6420 6d69 6e20 7661 6c75 6573 2e0a  and min values..
+00009a20: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00009a30: 5f63 6865 636b 5f64 696d 656e 7369 6f6e  _check_dimension
+00009a40: 7328 726f 772c 2063 6f6c 293a 0a20 2020  s(row, col):.   
+00009a50: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00009a60: 2d31 0a0a 2020 2020 2020 2020 2320 5772  -1..        # Wr
+00009a70: 6974 6520 7072 6576 696f 7573 2072 6f77  ite previous row
+00009a80: 2069 6620 696e 2069 6e2d 6c69 6e65 2073   if in in-line s
+00009a90: 7472 696e 6720 636f 6e73 7461 6e74 5f6d  tring constant_m
+00009aa0: 656d 6f72 7920 6d6f 6465 2e0a 2020 2020  emory mode..    
+00009ab0: 2020 2020 6966 2073 656c 662e 636f 6e73      if self.cons
+00009ac0: 7461 6e74 5f6d 656d 6f72 7920 616e 6420  tant_memory and 
+00009ad0: 726f 7720 3e20 7365 6c66 2e70 7265 7669  row > self.previ
+00009ae0: 6f75 735f 726f 773a 0a20 2020 2020 2020  ous_row:.       
+00009af0: 2020 2020 2073 656c 662e 5f77 7269 7465       self._write
+00009b00: 5f73 696e 676c 655f 726f 7728 726f 7729  _single_row(row)
+00009b10: 0a0a 2020 2020 2020 2020 6966 2062 6f6f  ..        if boo
+00009b20: 6c65 616e 3a0a 2020 2020 2020 2020 2020  lean:.          
+00009b30: 2020 7661 6c75 6520 3d20 310a 2020 2020    value = 1.    
+00009b40: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00009b50: 2020 2020 2020 7661 6c75 6520 3d20 300a        value = 0.
+00009b60: 0a20 2020 2020 2020 2023 2053 746f 7265  .        # Store
+00009b70: 2074 6865 2063 656c 6c20 6461 7461 2069   the cell data i
+00009b80: 6e20 7468 6520 776f 726b 7368 6565 7420  n the worksheet 
+00009b90: 6461 7461 2074 6162 6c65 2e0a 2020 2020  data table..    
+00009ba0: 2020 2020 7365 6c66 2e74 6162 6c65 5b72      self.table[r
+00009bb0: 6f77 5d5b 636f 6c5d 203d 2063 656c 6c5f  ow][col] = cell_
+00009bc0: 626f 6f6c 6561 6e5f 7475 706c 6528 7661  boolean_tuple(va
+00009bd0: 6c75 652c 2063 656c 6c5f 666f 726d 6174  lue, cell_format
+00009be0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00009bf0: 6e20 300a 0a20 2020 2023 2057 7269 7465  n 0..    # Write
+00009c00: 2061 2068 7970 6572 6c69 6e6b 2e20 5468   a hyperlink. Th
+00009c10: 6973 2069 7320 636f 6d70 7269 7365 6420  is is comprised 
+00009c20: 6f66 2074 776f 2065 6c65 6d65 6e74 733a  of two elements:
+00009c30: 2074 6865 2064 6973 706c 6179 6564 0a20   the displayed. 
+00009c40: 2020 2023 2073 7472 696e 6720 616e 6420     # string and 
+00009c50: 7468 6520 6e6f 6e2d 6469 7370 6c61 7965  the non-displaye
+00009c60: 6420 6c69 6e6b 2e20 5468 6520 6469 7370  d link. The disp
+00009c70: 6c61 7965 6420 7374 7269 6e67 2069 7320  layed string is 
+00009c80: 7468 6520 7361 6d65 2061 730a 2020 2020  the same as.    
+00009c90: 2320 7468 6520 6c69 6e6b 2075 6e6c 6573  # the link unles
+00009ca0: 7320 616e 2061 6c74 6572 6e61 7469 7665  s an alternative
+00009cb0: 2073 7472 696e 6720 6973 2073 7065 6369   string is speci
+00009cc0: 6669 6564 2e20 5468 6520 6469 7370 6c61  fied. The displa
+00009cd0: 7920 7374 7269 6e67 0a20 2020 2023 2069  y string.    # i
+00009ce0: 7320 7772 6974 7465 6e20 7573 696e 6720  s written using 
+00009cf0: 7468 6520 7772 6974 655f 7374 7269 6e67  the write_string
+00009d00: 2829 206d 6574 686f 642e 2054 6865 7265  () method. There
+00009d10: 666f 7265 2074 6865 206d 6178 2063 6861  fore the max cha
+00009d20: 7261 6374 6572 730a 2020 2020 2320 7374  racters.    # st
+00009d30: 7269 6e67 206c 696d 6974 2061 7070 6c69  ring limit appli
+00009d40: 6573 2e0a 2020 2020 230a 2020 2020 2320  es..    #.    # 
+00009d50: 5468 6520 6879 7065 726c 696e 6b20 6361  The hyperlink ca
+00009d60: 6e20 6265 2074 6f20 6120 6874 7470 2c20  n be to a http, 
+00009d70: 6674 702c 206d 6169 6c2c 2069 6e74 6572  ftp, mail, inter
+00009d80: 6e61 6c20 7368 6565 742c 206f 7220 6578  nal sheet, or ex
+00009d90: 7465 726e 616c 0a20 2020 2023 2064 6972  ternal.    # dir
+00009da0: 6563 746f 7279 2075 726c 732e 0a20 2020  ectory urls..   
+00009db0: 2040 636f 6e76 6572 745f 6365 6c6c 5f61   @convert_cell_a
+00009dc0: 7267 730a 2020 2020 6465 6620 7772 6974  rgs.    def writ
+00009dd0: 655f 7572 6c28 7365 6c66 2c20 726f 772c  e_url(self, row,
+00009de0: 2063 6f6c 2c20 7572 6c2c 2063 656c 6c5f   col, url, cell_
+00009df0: 666f 726d 6174 3d4e 6f6e 652c 2073 7472  format=None, str
+00009e00: 696e 673d 4e6f 6e65 2c20 7469 703d 4e6f  ing=None, tip=No
+00009e10: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
+00009e20: 0a20 2020 2020 2020 2057 7269 7465 2061  .        Write a
+00009e30: 2068 7970 6572 6c69 6e6b 2074 6f20 6120   hyperlink to a 
+00009e40: 776f 726b 7368 6565 7420 6365 6c6c 2e0a  worksheet cell..
+00009e50: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
+00009e60: 2020 2020 2020 2020 2020 2072 6f77 3a20             row: 
+00009e70: 2020 2054 6865 2063 656c 6c20 726f 7720     The cell row 
+00009e80: 287a 6572 6f20 696e 6465 7865 6429 2e0a  (zero indexed)..
+00009e90: 2020 2020 2020 2020 2020 2020 636f 6c3a              col:
+00009ea0: 2020 2020 5468 6520 6365 6c6c 2063 6f6c      The cell col
+00009eb0: 756d 6e20 287a 6572 6f20 696e 6465 7865  umn (zero indexe
+00009ec0: 6429 2e0a 2020 2020 2020 2020 2020 2020  d)..            
+00009ed0: 7572 6c3a 2020 2020 4879 7065 726c 696e  url:    Hyperlin
+00009ee0: 6b20 7572 6c2e 0a20 2020 2020 2020 2020  k url..         
+00009ef0: 2020 2066 6f72 6d61 743a 2041 6e20 6f70     format: An op
+00009f00: 7469 6f6e 616c 2063 656c 6c20 466f 726d  tional cell Form
+00009f10: 6174 206f 626a 6563 742e 0a20 2020 2020  at object..     
+00009f20: 2020 2020 2020 2073 7472 696e 673a 2041         string: A
+00009f30: 6e20 6f70 7469 6f6e 616c 2064 6973 706c  n optional displ
+00009f40: 6179 2073 7472 696e 6720 666f 7220 7468  ay string for th
+00009f50: 6520 6879 7065 726c 696e 6b2e 0a20 2020  e hyperlink..   
+00009f60: 2020 2020 2020 2020 2074 6970 3a20 2020           tip:   
+00009f70: 2041 6e20 6f70 7469 6f6e 616c 2074 6f6f   An optional too
+00009f80: 6c74 6970 2e0a 2020 2020 2020 2020 5265  ltip..        Re
+00009f90: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
+00009fa0: 2020 2030 3a20 2053 7563 6365 7373 2e0a     0:  Success..
+00009fb0: 2020 2020 2020 2020 2020 2020 2d31 3a20              -1: 
+00009fc0: 526f 7720 6f72 2063 6f6c 756d 6e20 6973  Row or column is
+00009fd0: 206f 7574 206f 6620 776f 726b 7368 6565   out of workshee
+00009fe0: 7420 626f 756e 6473 2e0a 2020 2020 2020  t bounds..      
+00009ff0: 2020 2020 2020 2d32 3a20 5374 7269 6e67        -2: String
+0000a000: 206c 6f6e 6765 7220 7468 616e 2033 3237   longer than 327
+0000a010: 3637 2063 6861 7261 6374 6572 732e 0a20  67 characters.. 
+0000a020: 2020 2020 2020 2020 2020 202d 333a 2055             -3: U
+0000a030: 524c 206c 6f6e 6765 7220 7468 616e 2045  RL longer than E
+0000a040: 7863 656c 206c 696d 6974 206f 6620 3235  xcel limit of 25
+0000a050: 3520 6368 6172 6163 7465 7273 2e0a 2020  5 characters..  
+0000a060: 2020 2020 2020 2020 2020 2d34 3a20 4578            -4: Ex
+0000a070: 6365 6564 7320 4578 6365 6c20 6c69 6d69  ceeds Excel limi
+0000a080: 7420 6f66 2036 352c 3533 3020 7572 6c73  t of 65,530 urls
+0000a090: 2070 6572 2077 6f72 6b73 6865 6574 2e0a   per worksheet..
+0000a0a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000a0b0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000a0c0: 5f77 7269 7465 5f75 726c 2872 6f77 2c20  _write_url(row, 
+0000a0d0: 636f 6c2c 2075 726c 2c20 6365 6c6c 5f66  col, url, cell_f
+0000a0e0: 6f72 6d61 742c 2073 7472 696e 672c 2074  ormat, string, t
+0000a0f0: 6970 290a 0a20 2020 2023 2055 6e64 6563  ip)..    # Undec
+0000a100: 6f72 6174 6564 2076 6572 7369 6f6e 206f  orated version o
+0000a110: 6620 7772 6974 655f 7572 6c28 292e 0a20  f write_url().. 
+0000a120: 2020 2064 6566 205f 7772 6974 655f 7572     def _write_ur
+0000a130: 6c28 7365 6c66 2c20 726f 772c 2063 6f6c  l(self, row, col
+0000a140: 2c20 7572 6c2c 2063 656c 6c5f 666f 726d  , url, cell_form
+0000a150: 6174 3d4e 6f6e 652c 2073 7472 696e 673d  at=None, string=
+0000a160: 4e6f 6e65 2c20 7469 703d 4e6f 6e65 293a  None, tip=None):
+0000a170: 0a20 2020 2020 2020 2023 2043 6865 636b  .        # Check
+0000a180: 2074 6861 7420 726f 7720 616e 6420 636f   that row and co
+0000a190: 6c20 6172 6520 7661 6c69 6420 616e 6420  l are valid and 
+0000a1a0: 7374 6f72 6520 6d61 7820 616e 6420 6d69  store max and mi
+0000a1b0: 6e20 7661 6c75 6573 0a20 2020 2020 2020  n values.       
+0000a1c0: 2069 6620 7365 6c66 2e5f 6368 6563 6b5f   if self._check_
+0000a1d0: 6469 6d65 6e73 696f 6e73 2872 6f77 2c20  dimensions(row, 
+0000a1e0: 636f 6c29 3a0a 2020 2020 2020 2020 2020  col):.          
+0000a1f0: 2020 7265 7475 726e 202d 310a 0a20 2020    return -1..   
+0000a200: 2020 2020 2023 2053 6574 2074 6865 2064       # Set the d
+0000a210: 6973 706c 6179 6564 2073 7472 696e 6720  isplayed string 
+0000a220: 746f 2074 6865 2055 524c 2075 6e6c 6573  to the URL unles
+0000a230: 7320 6465 6669 6e65 6420 6279 2074 6865  s defined by the
+0000a240: 2075 7365 722e 0a20 2020 2020 2020 2069   user..        i
+0000a250: 6620 7374 7269 6e67 2069 7320 4e6f 6e65  f string is None
+0000a260: 3a0a 2020 2020 2020 2020 2020 2020 7374  :.            st
+0000a270: 7269 6e67 203d 2075 726c 0a0a 2020 2020  ring = url..    
+0000a280: 2020 2020 2320 4465 6661 756c 7420 746f      # Default to
+0000a290: 2065 7874 6572 6e61 6c20 6c69 6e6b 2074   external link t
+0000a2a0: 7970 6520 7375 6368 2061 7320 2768 7474  ype such as 'htt
+0000a2b0: 703a 2f2f 2720 6f72 2027 6578 7465 726e  p://' or 'extern
+0000a2c0: 616c 3a27 2e0a 2020 2020 2020 2020 6c69  al:'..        li
+0000a2d0: 6e6b 5f74 7970 6520 3d20 310a 0a20 2020  nk_type = 1..   
+0000a2e0: 2020 2020 2023 2052 656d 6f76 6520 7468       # Remove th
+0000a2f0: 6520 5552 4920 7363 6865 6d65 2066 726f  e URI scheme fro
+0000a300: 6d20 696e 7465 726e 616c 206c 696e 6b73  m internal links
+0000a310: 2e0a 2020 2020 2020 2020 6966 2075 726c  ..        if url
+0000a320: 2e73 7461 7274 7377 6974 6828 2269 6e74  .startswith("int
+0000a330: 6572 6e61 6c3a 2229 3a0a 2020 2020 2020  ernal:"):.      
+0000a340: 2020 2020 2020 7572 6c20 3d20 7572 6c2e        url = url.
+0000a350: 7265 706c 6163 6528 2269 6e74 6572 6e61  replace("interna
+0000a360: 6c3a 222c 2022 2229 0a20 2020 2020 2020  l:", "").       
+0000a370: 2020 2020 2073 7472 696e 6720 3d20 7374       string = st
+0000a380: 7269 6e67 2e72 6570 6c61 6365 2822 696e  ring.replace("in
+0000a390: 7465 726e 616c 3a22 2c20 2222 290a 2020  ternal:", "").  
+0000a3a0: 2020 2020 2020 2020 2020 6c69 6e6b 5f74            link_t
+0000a3b0: 7970 6520 3d20 320a 0a20 2020 2020 2020  ype = 2..       
+0000a3c0: 2023 2052 656d 6f76 6520 7468 6520 5552   # Remove the UR
+0000a3d0: 4920 7363 6865 6d65 2066 726f 6d20 6578  I scheme from ex
+0000a3e0: 7465 726e 616c 206c 696e 6b73 2061 6e64  ternal links and
+0000a3f0: 2063 6861 6e67 6520 7468 6520 6469 7265   change the dire
+0000a400: 6374 6f72 790a 2020 2020 2020 2020 2320  ctory.        # 
+0000a410: 7365 7061 7261 746f 7220 6672 6f6d 2055  separator from U
+0000a420: 6e69 7820 746f 2044 6f73 2e0a 2020 2020  nix to Dos..    
+0000a430: 2020 2020 6578 7465 726e 616c 203d 2046      external = F
+0000a440: 616c 7365 0a20 2020 2020 2020 2069 6620  alse.        if 
+0000a450: 7572 6c2e 7374 6172 7473 7769 7468 2822  url.startswith("
+0000a460: 6578 7465 726e 616c 3a22 293a 0a20 2020  external:"):.   
+0000a470: 2020 2020 2020 2020 2075 726c 203d 2075           url = u
+0000a480: 726c 2e72 6570 6c61 6365 2822 6578 7465  rl.replace("exte
+0000a490: 726e 616c 3a22 2c20 2222 290a 2020 2020  rnal:", "").    
+0000a4a0: 2020 2020 2020 2020 7572 6c20 3d20 7572          url = ur
+0000a4b0: 6c2e 7265 706c 6163 6528 222f 222c 2022  l.replace("/", "
+0000a4c0: 5c5c 2229 0a20 2020 2020 2020 2020 2020  \\").           
+0000a4d0: 2073 7472 696e 6720 3d20 7374 7269 6e67   string = string
+0000a4e0: 2e72 6570 6c61 6365 2822 6578 7465 726e  .replace("extern
+0000a4f0: 616c 3a22 2c20 2222 290a 2020 2020 2020  al:", "").      
+0000a500: 2020 2020 2020 7374 7269 6e67 203d 2073        string = s
+0000a510: 7472 696e 672e 7265 706c 6163 6528 222f  tring.replace("/
+0000a520: 222c 2022 5c5c 2229 0a20 2020 2020 2020  ", "\\").       
+0000a530: 2020 2020 2065 7874 6572 6e61 6c20 3d20       external = 
+0000a540: 5472 7565 0a0a 2020 2020 2020 2020 2320  True..        # 
+0000a550: 5374 7269 7020 7468 6520 6d61 696c 746f  Strip the mailto
+0000a560: 2068 6561 6465 722e 0a20 2020 2020 2020   header..       
+0000a570: 2073 7472 696e 6720 3d20 7374 7269 6e67   string = string
+0000a580: 2e72 6570 6c61 6365 2822 6d61 696c 746f  .replace("mailto
+0000a590: 3a22 2c20 2222 290a 0a20 2020 2020 2020  :", "")..       
+0000a5a0: 2023 2043 6865 636b 2074 6861 7420 7468   # Check that th
+0000a5b0: 6520 7374 7269 6e67 2069 7320 3c20 3332  e string is < 32
+0000a5c0: 3736 3720 6368 6172 730a 2020 2020 2020  767 chars.      
+0000a5d0: 2020 7374 725f 6572 726f 7220 3d20 300a    str_error = 0.
+0000a5e0: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
+0000a5f0: 7472 696e 6729 203e 2073 656c 662e 786c  tring) > self.xl
+0000a600: 735f 7374 726d 6178 3a0a 2020 2020 2020  s_strmax:.      
+0000a610: 2020 2020 2020 7761 726e 280a 2020 2020        warn(.    
+0000a620: 2020 2020 2020 2020 2020 2020 2249 676e              "Ign
+0000a630: 6f72 696e 6720 5552 4c20 7369 6e63 6520  oring URL since 
+0000a640: 6974 2065 7863 6565 6473 2045 7863 656c  it exceeds Excel
+0000a650: 2773 2073 7472 696e 6720 6c69 6d69 7420  's string limit 
+0000a660: 6f66 2022 0a20 2020 2020 2020 2020 2020  of ".           
+0000a670: 2020 2020 2022 3332 3736 3720 6368 6172       "32767 char
+0000a680: 6163 7465 7273 220a 2020 2020 2020 2020  acters".        
+0000a690: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0000a6a0: 2020 7265 7475 726e 202d 320a 0a20 2020    return -2..   
+0000a6b0: 2020 2020 2023 2043 6f70 7920 7374 7269       # Copy stri
+0000a6c0: 6e67 2066 6f72 2075 7365 2069 6e20 6879  ng for use in hy
+0000a6d0: 7065 726c 696e 6b20 656c 656d 656e 7473  perlink elements
+0000a6e0: 2e0a 2020 2020 2020 2020 7572 6c5f 7374  ..        url_st
+0000a6f0: 7220 3d20 7374 7269 6e67 0a0a 2020 2020  r = string..    
+0000a700: 2020 2020 2320 4578 7465 726e 616c 206c      # External l
+0000a710: 696e 6b73 2074 6f20 5552 4c73 2061 6e64  inks to URLs and
+0000a720: 2074 6f20 6f74 6865 7220 4578 6365 6c20   to other Excel 
+0000a730: 776f 726b 626f 6f6b 7320 6861 7665 2073  workbooks have s
+0000a740: 6c69 6768 746c 790a 2020 2020 2020 2020  lightly.        
+0000a750: 2320 6469 6666 6572 656e 7420 6368 6172  # different char
+0000a760: 6163 7465 7269 7374 6963 7320 7468 6174  acteristics that
+0000a770: 2077 6520 6861 7665 2074 6f20 6163 636f   we have to acco
+0000a780: 756e 7420 666f 722e 0a20 2020 2020 2020  unt for..       
+0000a790: 2069 6620 6c69 6e6b 5f74 7970 6520 3d3d   if link_type ==
+0000a7a0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+0000a7b0: 2320 5370 6c69 7420 7572 6c20 696e 746f  # Split url into
+0000a7c0: 2074 6865 206c 696e 6b20 616e 6420 6f70   the link and op
+0000a7d0: 7469 6f6e 616c 2061 6e63 686f 722f 6c6f  tional anchor/lo
+0000a7e0: 6361 7469 6f6e 2e0a 2020 2020 2020 2020  cation..        
+0000a7f0: 2020 2020 6966 2022 2322 2069 6e20 7572      if "#" in ur
+0000a800: 6c3a 0a20 2020 2020 2020 2020 2020 2020  l:.             
+0000a810: 2020 2075 726c 2c20 7572 6c5f 7374 7220     url, url_str 
+0000a820: 3d20 7572 6c2e 7370 6c69 7428 2223 222c  = url.split("#",
+0000a830: 2031 290a 2020 2020 2020 2020 2020 2020   1).            
+0000a840: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000a850: 2020 2020 2020 7572 6c5f 7374 7220 3d20        url_str = 
+0000a860: 4e6f 6e65 0a0a 2020 2020 2020 2020 2020  None..          
+0000a870: 2020 7572 6c20 3d20 7365 6c66 2e5f 6573    url = self._es
+0000a880: 6361 7065 5f75 726c 2875 726c 290a 0a20  cape_url(url).. 
+0000a890: 2020 2020 2020 2020 2020 2069 6620 7572             if ur
+0000a8a0: 6c5f 7374 7220 6973 206e 6f74 204e 6f6e  l_str is not Non
+0000a8b0: 6520 616e 6420 6e6f 7420 6578 7465 726e  e and not extern
+0000a8c0: 616c 3a0a 2020 2020 2020 2020 2020 2020  al:.            
+0000a8d0: 2020 2020 7572 6c5f 7374 7220 3d20 7365      url_str = se
+0000a8e0: 6c66 2e5f 6573 6361 7065 5f75 726c 2875  lf._escape_url(u
+0000a8f0: 726c 5f73 7472 290a 0a20 2020 2020 2020  rl_str)..       
+0000a900: 2020 2020 2023 2041 6464 2074 6865 2066       # Add the f
+0000a910: 696c 653a 2f2f 2f20 5552 4920 746f 2074  ile:/// URI to t
+0000a920: 6865 2075 726c 2066 6f72 2057 696e 646f  he url for Windo
+0000a930: 7773 2073 7479 6c65 2022 433a 2f22 206c  ws style "C:/" l
+0000a940: 696e 6b20 616e 640a 2020 2020 2020 2020  ink and.        
+0000a950: 2020 2020 2320 4e65 7477 6f72 6b20 7368      # Network sh
+0000a960: 6172 6573 2e0a 2020 2020 2020 2020 2020  ares..          
+0000a970: 2020 6966 2072 652e 6d61 7463 6828 7222    if re.match(r"
+0000a980: 5c77 3a22 2c20 7572 6c29 206f 7220 7265  \w:", url) or re
+0000a990: 2e6d 6174 6368 2872 225c 5c22 2c20 7572  .match(r"\\", ur
+0000a9a0: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
+0000a9b0: 2020 2020 7572 6c20 3d20 2266 696c 653a      url = "file:
+0000a9c0: 2f2f 2f22 202b 2075 726c 0a0a 2020 2020  ///" + url..    
+0000a9d0: 2020 2020 2020 2020 2320 436f 6e76 6572          # Conver
+0000a9e0: 7420 6120 2e5c 6469 725c 6669 6c65 2e78  t a .\dir\file.x
+0000a9f0: 6c73 7820 6c69 6e6b 2074 6f20 6469 725c  lsx link to dir\
+0000aa00: 6669 6c65 2e78 6c73 782e 0a20 2020 2020  file.xlsx..     
+0000aa10: 2020 2020 2020 2075 726c 203d 2072 652e         url = re.
+0000aa20: 7375 6228 7222 5e5c 2e5c 5c22 2c20 2222  sub(r"^\.\\", ""
+0000aa30: 2c20 7572 6c29 0a0a 2020 2020 2020 2020  , url)..        
+0000aa40: 2320 4578 6365 6c20 6c69 6d69 7473 2074  # Excel limits t
+0000aa50: 6865 2065 7363 6170 6564 2055 524c 2061  he escaped URL a
+0000aa60: 6e64 206c 6f63 6174 696f 6e2f 616e 6368  nd location/anch
+0000aa70: 6f72 2074 6f20 3235 3520 6368 6172 6163  or to 255 charac
+0000aa80: 7465 7273 2e0a 2020 2020 2020 2020 746d  ters..        tm
+0000aa90: 705f 7572 6c5f 7374 7220 3d20 7572 6c5f  p_url_str = url_
+0000aaa0: 7374 7220 6f72 2022 220a 2020 2020 2020  str or "".      
+0000aab0: 2020 6d61 785f 7572 6c20 3d20 7365 6c66    max_url = self
+0000aac0: 2e6d 6178 5f75 726c 5f6c 656e 6774 680a  .max_url_length.
+0000aad0: 2020 2020 2020 2020 6966 206c 656e 2875          if len(u
+0000aae0: 726c 2920 3e20 6d61 785f 7572 6c20 6f72  rl) > max_url or
+0000aaf0: 206c 656e 2874 6d70 5f75 726c 5f73 7472   len(tmp_url_str
+0000ab00: 2920 3e20 6d61 785f 7572 6c3a 0a20 2020  ) > max_url:.   
+0000ab10: 2020 2020 2020 2020 2077 6172 6e28 0a20           warn(. 
+0000ab20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0000ab30: 4967 6e6f 7269 6e67 2055 524c 2027 2573  Ignoring URL '%s
+0000ab40: 2720 7769 7468 206c 696e 6b20 6f72 206c  ' with link or l
+0000ab50: 6f63 6174 696f 6e2f 616e 6368 6f72 203e  ocation/anchor >
+0000ab60: 2025 6420 220a 2020 2020 2020 2020 2020   %d ".          
+0000ab70: 2020 2020 2020 2263 6861 7261 6374 6572        "character
+0000ab80: 7320 7369 6e63 6520 6974 2065 7863 6565  s since it excee
+0000ab90: 6473 2045 7863 656c 2773 206c 696d 6974  ds Excel's limit
+0000aba0: 2066 6f72 2055 524c 5322 2025 2028 7572   for URLS" % (ur
+0000abb0: 6c2c 206d 6178 5f75 726c 290a 2020 2020  l, max_url).    
+0000abc0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000abd0: 2020 2020 2020 7265 7475 726e 202d 330a        return -3.
+0000abe0: 0a20 2020 2020 2020 2023 2043 6865 636b  .        # Check
+0000abf0: 2074 6865 206c 696d 6974 206f 6620 5552   the limit of UR
+0000ac00: 4c53 2070 6572 2077 6f72 6b73 6865 6574  LS per worksheet
+0000ac10: 2e0a 2020 2020 2020 2020 7365 6c66 2e68  ..        self.h
+0000ac20: 6c69 6e6b 5f63 6f75 6e74 202b 3d20 310a  link_count += 1.
+0000ac30: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0000ac40: 2e68 6c69 6e6b 5f63 6f75 6e74 203e 2036  .hlink_count > 6
+0000ac50: 3535 3330 3a0a 2020 2020 2020 2020 2020  5530:.          
+0000ac60: 2020 7761 726e 280a 2020 2020 2020 2020    warn(.        
+0000ac70: 2020 2020 2020 2020 2249 676e 6f72 696e          "Ignorin
+0000ac80: 6720 5552 4c20 2725 7327 2073 696e 6365  g URL '%s' since
+0000ac90: 2069 7420 6578 6365 6564 7320 4578 6365   it exceeds Exce
+0000aca0: 6c27 7320 6c69 6d69 7420 6f66 2022 0a20  l's limit of ". 
+0000acb0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0000acc0: 3635 2c35 3330 2055 524c 5320 7065 7220  65,530 URLS per 
+0000acd0: 776f 726b 7368 6565 742e 2220 2520 7572  worksheet." % ur
+0000ace0: 6c0a 2020 2020 2020 2020 2020 2020 290a  l.            ).
+0000acf0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000ad00: 726e 202d 340a 0a20 2020 2020 2020 2023  rn -4..        #
+0000ad10: 2057 7269 7465 2070 7265 7669 6f75 7320   Write previous 
+0000ad20: 726f 7720 6966 2069 6e20 696e 2d6c 696e  row if in in-lin
+0000ad30: 6520 7374 7269 6e67 2063 6f6e 7374 616e  e string constan
+0000ad40: 745f 6d65 6d6f 7279 206d 6f64 652e 0a20  t_memory mode.. 
+0000ad50: 2020 2020 2020 2069 6620 7365 6c66 2e63         if self.c
+0000ad60: 6f6e 7374 616e 745f 6d65 6d6f 7279 2061  onstant_memory a
+0000ad70: 6e64 2072 6f77 203e 2073 656c 662e 7072  nd row > self.pr
+0000ad80: 6576 696f 7573 5f72 6f77 3a0a 2020 2020  evious_row:.    
+0000ad90: 2020 2020 2020 2020 7365 6c66 2e5f 7772          self._wr
+0000ada0: 6974 655f 7369 6e67 6c65 5f72 6f77 2872  ite_single_row(r
+0000adb0: 6f77 290a 0a20 2020 2020 2020 2023 2041  ow)..        # A
+0000adc0: 6464 2074 6865 2064 6566 6175 6c74 2055  dd the default U
+0000add0: 524c 2066 6f72 6d61 742e 0a20 2020 2020  RL format..     
+0000ade0: 2020 2069 6620 6365 6c6c 5f66 6f72 6d61     if cell_forma
+0000adf0: 7420 6973 204e 6f6e 653a 0a20 2020 2020  t is None:.     
+0000ae00: 2020 2020 2020 2063 656c 6c5f 666f 726d         cell_form
+0000ae10: 6174 203d 2073 656c 662e 6465 6661 756c  at = self.defaul
+0000ae20: 745f 7572 6c5f 666f 726d 6174 0a0a 2020  t_url_format..  
+0000ae30: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
+0000ae40: 6520 6879 7065 726c 696e 6b20 7374 7269  e hyperlink stri
+0000ae50: 6e67 2e0a 2020 2020 2020 2020 7365 6c66  ng..        self
+0000ae60: 2e5f 7772 6974 655f 7374 7269 6e67 2872  ._write_string(r
+0000ae70: 6f77 2c20 636f 6c2c 2073 7472 696e 672c  ow, col, string,
+0000ae80: 2063 656c 6c5f 666f 726d 6174 290a 0a20   cell_format).. 
+0000ae90: 2020 2020 2020 2023 2053 746f 7265 2074         # Store t
+0000aea0: 6865 2068 7970 6572 6c69 6e6b 2064 6174  he hyperlink dat
+0000aeb0: 6120 696e 2061 2073 6570 6172 6174 6520  a in a separate 
+0000aec0: 7374 7275 6374 7572 652e 0a20 2020 2020  structure..     
+0000aed0: 2020 2073 656c 662e 6879 7065 726c 696e     self.hyperlin
+0000aee0: 6b73 5b72 6f77 5d5b 636f 6c5d 203d 207b  ks[row][col] = {
+0000aef0: 0a20 2020 2020 2020 2020 2020 2022 6c69  .            "li
+0000af00: 6e6b 5f74 7970 6522 3a20 6c69 6e6b 5f74  nk_type": link_t
+0000af10: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+0000af20: 2022 7572 6c22 3a20 7572 6c2c 0a20 2020   "url": url,.   
+0000af30: 2020 2020 2020 2020 2022 7374 7222 3a20           "str": 
+0000af40: 7572 6c5f 7374 722c 0a20 2020 2020 2020  url_str,.       
+0000af50: 2020 2020 2022 7469 7022 3a20 7469 702c       "tip": tip,
+0000af60: 0a20 2020 2020 2020 207d 0a0a 2020 2020  .        }..    
+0000af70: 2020 2020 7265 7475 726e 2073 7472 5f65      return str_e
+0000af80: 7272 6f72 0a0a 2020 2020 4063 6f6e 7665  rror..    @conve
+0000af90: 7274 5f63 656c 6c5f 6172 6773 0a20 2020  rt_cell_args.   
+0000afa0: 2064 6566 2077 7269 7465 5f72 6963 685f   def write_rich_
+0000afb0: 7374 7269 6e67 2873 656c 662c 2072 6f77  string(self, row
+0000afc0: 2c20 636f 6c2c 202a 6172 6773 293a 0a20  , col, *args):. 
+0000afd0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000afe0: 2020 2057 7269 7465 2061 2022 7269 6368     Write a "rich
+0000aff0: 2220 7374 7269 6e67 2077 6974 6820 6d75  " string with mu
+0000b000: 6c74 6970 6c65 2066 6f72 6d61 7473 2074  ltiple formats t
+0000b010: 6f20 6120 776f 726b 7368 6565 7420 6365  o a worksheet ce
+0000b020: 6c6c 2e0a 0a20 2020 2020 2020 2041 7267  ll...        Arg
+0000b030: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+0000b040: 6f77 3a20 2020 2020 2020 2020 2054 6865  ow:          The
+0000b050: 2063 656c 6c20 726f 7720 287a 6572 6f20   cell row (zero 
+0000b060: 696e 6465 7865 6429 2e0a 2020 2020 2020  indexed)..      
+0000b070: 2020 2020 2020 636f 6c3a 2020 2020 2020        col:      
+0000b080: 2020 2020 5468 6520 6365 6c6c 2063 6f6c      The cell col
+0000b090: 756d 6e20 287a 6572 6f20 696e 6465 7865  umn (zero indexe
+0000b0a0: 6429 2e0a 2020 2020 2020 2020 2020 2020  d)..            
+0000b0b0: 7374 7269 6e67 5f70 6172 7473 3a20 5374  string_parts: St
+0000b0c0: 7269 6e67 2061 6e64 2066 6f72 6d61 7420  ring and format 
+0000b0d0: 7061 6972 732e 0a20 2020 2020 2020 2020  pairs..         
+0000b0e0: 2020 2063 656c 6c5f 666f 726d 6174 3a20     cell_format: 
+0000b0f0: 204f 7074 696f 6e61 6c20 466f 726d 6174   Optional Format
+0000b100: 206f 626a 6563 742e 0a0a 2020 2020 2020   object...      
+0000b110: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
+0000b120: 2020 2020 2020 2030 3a20 2053 7563 6365         0:  Succe
+0000b130: 7373 2e0a 2020 2020 2020 2020 2020 2020  ss..            
+0000b140: 2d31 3a20 526f 7720 6f72 2063 6f6c 756d  -1: Row or colum
+0000b150: 6e20 6973 206f 7574 206f 6620 776f 726b  n is out of work
+0000b160: 7368 6565 7420 626f 756e 6473 2e0a 2020  sheet bounds..  
+0000b170: 2020 2020 2020 2020 2020 2d32 3a20 5374            -2: St
+0000b180: 7269 6e67 2074 7275 6e63 6174 6564 2074  ring truncated t
+0000b190: 6f20 3332 6b20 6368 6172 6163 7465 7273  o 32k characters
+0000b1a0: 2e0a 2020 2020 2020 2020 2020 2020 2d33  ..            -3
+0000b1b0: 3a20 3220 636f 6e73 6563 7574 6976 6520  : 2 consecutive 
+0000b1c0: 666f 726d 6174 7320 7573 6564 2e0a 2020  formats used..  
+0000b1d0: 2020 2020 2020 2020 2020 2d34 3a20 456d            -4: Em
+0000b1e0: 7074 7920 7374 7269 6e67 2075 7365 642e  pty string used.
+0000b1f0: 0a20 2020 2020 2020 2020 2020 202d 353a  .            -5:
+0000b200: 2049 6e73 7566 6669 6369 656e 7420 7061   Insufficient pa
+0000b210: 7261 6d65 7465 7273 2e0a 0a20 2020 2020  rameters...     
+0000b220: 2020 2022 2222 0a0a 2020 2020 2020 2020     """..        
+0000b230: 7265 7475 726e 2073 656c 662e 5f77 7269  return self._wri
+0000b240: 7465 5f72 6963 685f 7374 7269 6e67 2872  te_rich_string(r
+0000b250: 6f77 2c20 636f 6c2c 202a 6172 6773 290a  ow, col, *args).
+0000b260: 0a20 2020 2023 2055 6e64 6563 6f72 6174  .    # Undecorat
+0000b270: 6564 2076 6572 7369 6f6e 206f 6620 7772  ed version of wr
+0000b280: 6974 655f 7269 6368 5f73 7472 696e 6728  ite_rich_string(
+0000b290: 292e 0a20 2020 2064 6566 205f 7772 6974  )..    def _writ
+0000b2a0: 655f 7269 6368 5f73 7472 696e 6728 7365  e_rich_string(se
+0000b2b0: 6c66 2c20 726f 772c 2063 6f6c 2c20 2a61  lf, row, col, *a
+0000b2c0: 7267 7329 3a0a 2020 2020 2020 2020 746f  rgs):.        to
+0000b2d0: 6b65 6e73 203d 206c 6973 7428 6172 6773  kens = list(args
+0000b2e0: 290a 2020 2020 2020 2020 6365 6c6c 5f66  ).        cell_f
+0000b2f0: 6f72 6d61 7420 3d20 4e6f 6e65 0a20 2020  ormat = None.   
+0000b300: 2020 2020 2073 7472 696e 675f 696e 6465       string_inde
+0000b310: 7820 3d20 300a 2020 2020 2020 2020 7261  x = 0.        ra
+0000b320: 775f 7374 7269 6e67 203d 2022 220a 0a20  w_string = "".. 
+0000b330: 2020 2020 2020 2023 2043 6865 636b 2074         # Check t
+0000b340: 6861 7420 726f 7720 616e 6420 636f 6c20  hat row and col 
+0000b350: 6172 6520 7661 6c69 6420 616e 6420 7374  are valid and st
+0000b360: 6f72 6520 6d61 7820 616e 6420 6d69 6e20  ore max and min 
+0000b370: 7661 6c75 6573 0a20 2020 2020 2020 2069  values.        i
+0000b380: 6620 7365 6c66 2e5f 6368 6563 6b5f 6469  f self._check_di
+0000b390: 6d65 6e73 696f 6e73 2872 6f77 2c20 636f  mensions(row, co
+0000b3a0: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
+0000b3b0: 7265 7475 726e 202d 310a 0a20 2020 2020  return -1..     
+0000b3c0: 2020 2023 2049 6620 7468 6520 6c61 7374     # If the last
+0000b3d0: 2061 7267 2069 7320 6120 666f 726d 6174   arg is a format
+0000b3e0: 2077 6520 7573 6520 6974 2061 7320 7468   we use it as th
+0000b3f0: 6520 6365 6c6c 2066 6f72 6d61 742e 0a20  e cell format.. 
+0000b400: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0000b410: 616e 6365 2874 6f6b 656e 735b 2d31 5d2c  ance(tokens[-1],
+0000b420: 2046 6f72 6d61 7429 3a0a 2020 2020 2020   Format):.      
+0000b430: 2020 2020 2020 6365 6c6c 5f66 6f72 6d61        cell_forma
+0000b440: 7420 3d20 746f 6b65 6e73 2e70 6f70 2829  t = tokens.pop()
+0000b450: 0a0a 2020 2020 2020 2020 2320 4372 6561  ..        # Crea
+0000b460: 7465 2061 2074 656d 7020 584d 4c57 7269  te a temp XMLWri
+0000b470: 7465 7220 6f62 6a65 6374 2061 6e64 2075  ter object and u
+0000b480: 7365 2069 7420 746f 2077 7269 7465 2074  se it to write t
+0000b490: 6865 2072 6963 6820 7374 7269 6e67 0a20  he rich string. 
+0000b4a0: 2020 2020 2020 2023 2058 4d4c 2074 6f20         # XML to 
+0000b4b0: 6120 7374 7269 6e67 2e0a 2020 2020 2020  a string..      
+0000b4c0: 2020 6668 203d 2053 7472 696e 6749 4f28    fh = StringIO(
+0000b4d0: 290a 2020 2020 2020 2020 7365 6c66 2e72  ).        self.r
+0000b4e0: 7374 7269 6e67 203d 2058 4d4c 7772 6974  string = XMLwrit
+0000b4f0: 6572 2829 0a20 2020 2020 2020 2073 656c  er().        sel
+0000b500: 662e 7273 7472 696e 672e 5f73 6574 5f66  f.rstring._set_f
+0000b510: 696c 6568 616e 646c 6528 6668 290a 0a20  ilehandle(fh).. 
+0000b520: 2020 2020 2020 2023 2043 7265 6174 6520         # Create 
+0000b530: 6120 7465 6d70 2066 6f72 6d61 7420 7769  a temp format wi
+0000b540: 7468 2074 6865 2064 6566 6175 6c74 2066  th the default f
+0000b550: 6f6e 7420 666f 7220 756e 666f 726d 6174  ont for unformat
+0000b560: 7465 6420 6672 6167 6d65 6e74 732e 0a20  ted fragments.. 
+0000b570: 2020 2020 2020 2064 6566 6175 6c74 203d         default =
+0000b580: 2046 6f72 6d61 7428 290a 0a20 2020 2020   Format()..     
+0000b590: 2020 2023 2043 6f6e 7665 7274 206c 6973     # Convert lis
+0000b5a0: 7420 6f66 2066 6f72 6d61 742c 2073 7472  t of format, str
+0000b5b0: 696e 6720 746f 6b65 6e73 2074 6f20 7061  ing tokens to pa
+0000b5c0: 6972 7320 6f66 2028 666f 726d 6174 2c20  irs of (format, 
+0000b5d0: 7374 7269 6e67 290a 2020 2020 2020 2020  string).        
+0000b5e0: 2320 6578 6365 7074 2066 6f72 2074 6865  # except for the
+0000b5f0: 2066 6972 7374 2073 7472 696e 6720 6672   first string fr
+0000b600: 6167 6d65 6e74 2077 6869 6368 2064 6f65  agment which doe
+0000b610: 736e 2774 2072 6571 7569 7265 2061 2064  sn't require a d
+0000b620: 6566 6175 6c74 0a20 2020 2020 2020 2023  efault.        #
+0000b630: 2066 6f72 6d61 7474 696e 6720 7275 6e2e   formatting run.
+0000b640: 2055 7365 2074 6865 2064 6566 6175 6c74   Use the default
+0000b650: 2066 6f72 2073 7472 696e 6773 2077 6974   for strings wit
+0000b660: 686f 7574 2061 206c 6561 6469 6e67 2066  hout a leading f
+0000b670: 6f72 6d61 742e 0a20 2020 2020 2020 2066  ormat..        f
+0000b680: 7261 676d 656e 7473 203d 205b 5d0a 2020  ragments = [].  
+0000b690: 2020 2020 2020 7072 6576 696f 7573 203d        previous =
+0000b6a0: 2022 666f 726d 6174 220a 2020 2020 2020   "format".      
+0000b6b0: 2020 706f 7320 3d20 300a 0a20 2020 2020    pos = 0..     
+0000b6c0: 2020 2069 6620 6c65 6e28 746f 6b65 6e73     if len(tokens
+0000b6d0: 2920 3c3d 2032 3a0a 2020 2020 2020 2020  ) <= 2:.        
+0000b6e0: 2020 2020 7761 726e 280a 2020 2020 2020      warn(.      
+0000b6f0: 2020 2020 2020 2020 2020 2259 6f75 206d            "You m
+0000b700: 7573 7420 7370 6563 6966 7920 6d6f 7265  ust specify more
+0000b710: 2074 6861 6e20 3220 666f 726d 6174 2f66   than 2 format/f
+0000b720: 7261 676d 656e 7473 2066 6f72 2072 6963  ragments for ric
+0000b730: 6820 220a 2020 2020 2020 2020 2020 2020  h ".            
+0000b740: 2020 2020 2273 7472 696e 6773 2e20 4967      "strings. Ig
+0000b750: 6e6f 7269 6e67 2069 6e70 7574 2069 6e20  noring input in 
+0000b760: 7772 6974 655f 7269 6368 5f73 7472 696e  write_rich_strin
+0000b770: 6728 292e 220a 2020 2020 2020 2020 2020  g().".          
+0000b780: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0000b790: 7265 7475 726e 202d 350a 0a20 2020 2020  return -5..     
+0000b7a0: 2020 2066 6f72 2074 6f6b 656e 2069 6e20     for token in 
+0000b7b0: 746f 6b65 6e73 3a0a 2020 2020 2020 2020  tokens:.        
+0000b7c0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+0000b7d0: 7461 6e63 6528 746f 6b65 6e2c 2046 6f72  tance(token, For
+0000b7e0: 6d61 7429 3a0a 2020 2020 2020 2020 2020  mat):.          
+0000b7f0: 2020 2020 2020 2320 546f 6b65 6e20 6973        # Token is
+0000b800: 2061 2073 7472 696e 672e 0a20 2020 2020   a string..     
+0000b810: 2020 2020 2020 2020 2020 2069 6620 7072             if pr
+0000b820: 6576 696f 7573 2021 3d20 2266 6f72 6d61  evious != "forma
+0000b830: 7422 3a0a 2020 2020 2020 2020 2020 2020  t":.            
+0000b840: 2020 2020 2020 2020 2320 4966 2070 7265          # If pre
+0000b850: 7669 6f75 7320 746f 6b65 6e20 7761 736e  vious token wasn
+0000b860: 2774 2061 2066 6f72 6d61 7420 6164 6420  't a format add 
+0000b870: 6f6e 6520 6265 666f 7265 2073 7472 696e  one before strin
+0000b880: 672e 0a20 2020 2020 2020 2020 2020 2020  g..             
+0000b890: 2020 2020 2020 2066 7261 676d 656e 7473         fragments
+0000b8a0: 2e61 7070 656e 6428 6465 6661 756c 7429  .append(default)
+0000b8b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b8c0: 2020 2020 2066 7261 676d 656e 7473 2e61       fragments.a
+0000b8d0: 7070 656e 6428 746f 6b65 6e29 0a20 2020  ppend(token).   
+0000b8e0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+0000b8f0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0000b900: 2020 2020 2020 2023 2049 6620 7072 6576         # If prev
+0000b910: 696f 7573 2074 6f6b 656e 2077 6173 2061  ious token was a
+0000b920: 2066 6f72 6d61 7420 6a75 7374 2061 6464   format just add
+0000b930: 2074 6865 2073 7472 696e 672e 0a20 2020   the string..   
+0000b940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b950: 2066 7261 676d 656e 7473 2e61 7070 656e   fragments.appen
+0000b960: 6428 746f 6b65 6e29 0a0a 2020 2020 2020  d(token)..      
+0000b970: 2020 2020 2020 2020 2020 6966 2074 6f6b            if tok
+0000b980: 656e 203d 3d20 2222 3a0a 2020 2020 2020  en == "":.      
+0000b990: 2020 2020 2020 2020 2020 2020 2020 7761                wa
+0000b9a0: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
+0000b9b0: 2020 2020 2020 2020 2020 2020 2245 7863              "Exc
+0000b9c0: 656c 2064 6f65 736e 2774 2061 6c6c 6f77  el doesn't allow
+0000b9d0: 2065 6d70 7479 2073 7472 696e 6773 2069   empty strings i
+0000b9e0: 6e20 7269 6368 2073 7472 696e 6773 2e20  n rich strings. 
+0000b9f0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0000ba00: 2020 2020 2020 2020 2020 2249 676e 6f72            "Ignor
+0000ba10: 696e 6720 696e 7075 7420 696e 2077 7269  ing input in wri
+0000ba20: 7465 5f72 6963 685f 7374 7269 6e67 2829  te_rich_string()
+0000ba30: 2e22 0a20 2020 2020 2020 2020 2020 2020  .".             
+0000ba40: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000ba50: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0000ba60: 7572 6e20 2d34 0a0a 2020 2020 2020 2020  urn -4..        
+0000ba70: 2020 2020 2020 2020 2320 4b65 6570 2074          # Keep t
+0000ba80: 7261 636b 206f 6620 756e 666f 726d 6174  rack of unformat
+0000ba90: 7465 6420 7374 7269 6e67 2e0a 2020 2020  ted string..    
+0000baa0: 2020 2020 2020 2020 2020 2020 7261 775f              raw_
+0000bab0: 7374 7269 6e67 202b 3d20 746f 6b65 6e0a  string += token.
+0000bac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bad0: 7072 6576 696f 7573 203d 2022 7374 7269  previous = "stri
+0000bae0: 6e67 220a 2020 2020 2020 2020 2020 2020  ng".            
+0000baf0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000bb00: 2020 2020 2020 2320 4361 6e27 7420 616c        # Can't al
+0000bb10: 6c6f 7720 3220 666f 726d 6174 7320 696e  low 2 formats in
+0000bb20: 2061 2072 6f77 2e0a 2020 2020 2020 2020   a row..        
+0000bb30: 2020 2020 2020 2020 6966 2070 7265 7669          if previ
+0000bb40: 6f75 7320 3d3d 2022 666f 726d 6174 2220  ous == "format" 
+0000bb50: 616e 6420 706f 7320 3e20 303a 0a20 2020  and pos > 0:.   
 0000bb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bb70: 6672 6167 6d65 6e74 732e 6170 7065 6e64  fragments.append
-0000bb80: 2874 6f6b 656e 290a 2020 2020 2020 2020  (token).        
-0000bb90: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000bba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bbb0: 2020 2320 4966 2070 7265 7669 6f75 7320    # If previous 
-0000bbc0: 746f 6b65 6e20 7761 7320 6120 666f 726d  token was a form
-0000bbd0: 6174 206a 7573 7420 6164 6420 7468 6520  at just add the 
-0000bbe0: 7374 7269 6e67 2e0a 2020 2020 2020 2020  string..        
-0000bbf0: 2020 2020 2020 2020 2020 2020 6672 6167              frag
-0000bc00: 6d65 6e74 732e 6170 7065 6e64 2874 6f6b  ments.append(tok
-0000bc10: 656e 290a 0a20 2020 2020 2020 2020 2020  en)..           
-0000bc20: 2020 2020 2069 6620 746f 6b65 6e20 3d3d       if token ==
-0000bc30: 2027 273a 0a20 2020 2020 2020 2020 2020   '':.           
-0000bc40: 2020 2020 2020 2020 2077 6172 6e28 2245           warn("E
-0000bc50: 7863 656c 2064 6f65 736e 2774 2061 6c6c  xcel doesn't all
-0000bc60: 6f77 2065 6d70 7479 2073 7472 696e 6773  ow empty strings
-0000bc70: 2069 6e20 7269 6368 2073 7472 696e 6773   in rich strings
-0000bc80: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
-0000bc90: 2020 2020 2020 2020 2020 2020 2022 4967               "Ig
-0000bca0: 6e6f 7269 6e67 2069 6e70 7574 2069 6e20  noring input in 
-0000bcb0: 7772 6974 655f 7269 6368 5f73 7472 696e  write_rich_strin
-0000bcc0: 6728 292e 2229 0a20 2020 2020 2020 2020  g().").         
-0000bcd0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000bce0: 6e20 2d34 0a0a 2020 2020 2020 2020 2020  n -4..          
-0000bcf0: 2020 2020 2020 2320 4b65 6570 2074 7261        # Keep tra
-0000bd00: 636b 206f 6620 756e 666f 726d 6174 7465  ck of unformatte
-0000bd10: 6420 7374 7269 6e67 2e0a 2020 2020 2020  d string..      
-0000bd20: 2020 2020 2020 2020 2020 7261 775f 7374            raw_st
-0000bd30: 7269 6e67 202b 3d20 746f 6b65 6e0a 2020  ring += token.  
-0000bd40: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0000bd50: 6576 696f 7573 203d 2027 7374 7269 6e67  evious = 'string
-0000bd60: 270a 2020 2020 2020 2020 2020 2020 656c  '.            el
-0000bd70: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000bd80: 2020 2020 2320 4361 6e27 7420 616c 6c6f      # Can't allo
-0000bd90: 7720 3220 666f 726d 6174 7320 696e 2061  w 2 formats in a
-0000bda0: 2072 6f77 2e0a 2020 2020 2020 2020 2020   row..          
-0000bdb0: 2020 2020 2020 6966 2070 7265 7669 6f75        if previou
-0000bdc0: 7320 3d3d 2027 666f 726d 6174 2720 616e  s == 'format' an
-0000bdd0: 6420 706f 7320 3e20 303a 0a20 2020 2020  d pos > 0:.     
-0000bde0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-0000bdf0: 6172 6e28 2245 7863 656c 2064 6f65 736e  arn("Excel doesn
-0000be00: 2774 2061 6c6c 6f77 2032 2063 6f6e 7365  't allow 2 conse
-0000be10: 6375 7469 7665 2066 6f72 6d61 7473 2069  cutive formats i
-0000be20: 6e20 7269 6368 2022 0a20 2020 2020 2020  n rich ".       
-0000be30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000be40: 2020 2273 7472 696e 6773 2e20 4967 6e6f    "strings. Igno
-0000be50: 7269 6e67 2069 6e70 7574 2069 6e20 7772  ring input in wr
-0000be60: 6974 655f 7269 6368 5f73 7472 696e 6728  ite_rich_string(
-0000be70: 292e 2229 0a20 2020 2020 2020 2020 2020  ).").           
-0000be80: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000be90: 2d33 0a0a 2020 2020 2020 2020 2020 2020  -3..            
-0000bea0: 2020 2020 2320 546f 6b65 6e20 6973 2061      # Token is a
-0000beb0: 2066 6f72 6d61 7420 6f62 6a65 6374 2e20   format object. 
-0000bec0: 4164 6420 6974 2074 6f20 7468 6520 6672  Add it to the fr
-0000bed0: 6167 6d65 6e74 206c 6973 742e 0a20 2020  agment list..   
-0000bee0: 2020 2020 2020 2020 2020 2020 2066 7261               fra
-0000bef0: 676d 656e 7473 2e61 7070 656e 6428 746f  gments.append(to
-0000bf00: 6b65 6e29 0a20 2020 2020 2020 2020 2020  ken).           
-0000bf10: 2020 2020 2070 7265 7669 6f75 7320 3d20       previous = 
-0000bf20: 2766 6f72 6d61 7427 0a0a 2020 2020 2020  'format'..      
-0000bf30: 2020 2020 2020 706f 7320 2b3d 2031 0a0a        pos += 1..
-0000bf40: 2020 2020 2020 2020 2320 4966 2074 6865          # If the
-0000bf50: 2066 6972 7374 2074 6f6b 656e 2069 7320   first token is 
-0000bf60: 6120 7374 7269 6e67 2073 7461 7274 2074  a string start t
-0000bf70: 6865 203c 723e 2065 6c65 6d65 6e74 2e0a  he <r> element..
-0000bf80: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-0000bf90: 7369 6e73 7461 6e63 6528 6672 6167 6d65  sinstance(fragme
-0000bfa0: 6e74 735b 305d 2c20 466f 726d 6174 293a  nts[0], Format):
-0000bfb0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000bfc0: 662e 7273 7472 696e 672e 5f78 6d6c 5f73  f.rstring._xml_s
-0000bfd0: 7461 7274 5f74 6167 2827 7227 290a 0a20  tart_tag('r').. 
-0000bfe0: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
-0000bff0: 6865 2058 4d4c 2065 6c65 6d65 6e74 7320  he XML elements 
-0000c000: 666f 7220 7468 6520 2466 6f72 6d61 7420  for the $format 
-0000c010: 2473 7472 696e 6720 6672 6167 6d65 6e74  $string fragment
-0000c020: 732e 0a20 2020 2020 2020 2066 6f72 2074  s..        for t
-0000c030: 6f6b 656e 2069 6e20 6672 6167 6d65 6e74  oken in fragment
-0000c040: 733a 0a20 2020 2020 2020 2020 2020 2069  s:.            i
-0000c050: 6620 6973 696e 7374 616e 6365 2874 6f6b  f isinstance(tok
-0000c060: 656e 2c20 466f 726d 6174 293a 0a20 2020  en, Format):.   
-0000c070: 2020 2020 2020 2020 2020 2020 2023 2057               # W
-0000c080: 7269 7465 2074 6865 2066 6f6e 7420 7275  rite the font ru
-0000c090: 6e2e 0a20 2020 2020 2020 2020 2020 2020  n..             
-0000c0a0: 2020 2073 656c 662e 7273 7472 696e 672e     self.rstring.
-0000c0b0: 5f78 6d6c 5f73 7461 7274 5f74 6167 2827  _xml_start_tag('
-0000c0c0: 7227 290a 2020 2020 2020 2020 2020 2020  r').            
-0000c0d0: 2020 2020 7365 6c66 2e5f 7772 6974 655f      self._write_
-0000c0e0: 666f 6e74 2874 6f6b 656e 290a 2020 2020  font(token).    
-0000c0f0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000c100: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0000c110: 5772 6974 6520 7468 6520 7374 7269 6e67  Write the string
-0000c120: 2066 7261 676d 656e 7420 7061 7274 2c20   fragment part, 
-0000c130: 7769 7468 2077 6869 7465 7370 6163 6520  with whitespace 
-0000c140: 6861 6e64 6c69 6e67 2e0a 2020 2020 2020  handling..      
-0000c150: 2020 2020 2020 2020 2020 6174 7472 6962            attrib
-0000c160: 7574 6573 203d 205b 5d0a 0a20 2020 2020  utes = []..     
-0000c170: 2020 2020 2020 2020 2020 2069 6620 7072             if pr
-0000c180: 6573 6572 7665 5f77 6869 7465 7370 6163  eserve_whitespac
-0000c190: 6528 746f 6b65 6e29 3a0a 2020 2020 2020  e(token):.      
-0000c1a0: 2020 2020 2020 2020 2020 2020 2020 6174                at
-0000c1b0: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
-0000c1c0: 2827 786d 6c3a 7370 6163 6527 2c20 2770  ('xml:space', 'p
-0000c1d0: 7265 7365 7276 6527 2929 0a0a 2020 2020  reserve'))..    
-0000c1e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000c1f0: 2e72 7374 7269 6e67 2e5f 786d 6c5f 6461  .rstring._xml_da
-0000c200: 7461 5f65 6c65 6d65 6e74 2827 7427 2c20  ta_element('t', 
-0000c210: 746f 6b65 6e2c 2061 7474 7269 6275 7465  token, attribute
-0000c220: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
-0000c230: 2020 2073 656c 662e 7273 7472 696e 672e     self.rstring.
-0000c240: 5f78 6d6c 5f65 6e64 5f74 6167 2827 7227  _xml_end_tag('r'
-0000c250: 290a 0a20 2020 2020 2020 2023 2052 6561  )..        # Rea
-0000c260: 6420 7468 6520 696e 2d6d 656d 6f72 7920  d the in-memory 
-0000c270: 7374 7269 6e67 2e0a 2020 2020 2020 2020  string..        
-0000c280: 7374 7269 6e67 203d 2073 656c 662e 7273  string = self.rs
-0000c290: 7472 696e 672e 6668 2e67 6574 7661 6c75  tring.fh.getvalu
-0000c2a0: 6528 290a 0a20 2020 2020 2020 2023 2043  e()..        # C
-0000c2b0: 6865 636b 2074 6861 7420 7468 6520 7374  heck that the st
-0000c2c0: 7269 6e67 2069 7320 3c20 3332 3736 3720  ring is < 32767 
-0000c2d0: 6368 6172 732e 0a20 2020 2020 2020 2069  chars..        i
-0000c2e0: 6620 6c65 6e28 7261 775f 7374 7269 6e67  f len(raw_string
-0000c2f0: 2920 3e20 7365 6c66 2e78 6c73 5f73 7472  ) > self.xls_str
-0000c300: 6d61 783a 0a20 2020 2020 2020 2020 2020  max:.           
-0000c310: 2077 6172 6e28 2253 7472 696e 6720 6c65   warn("String le
-0000c320: 6e67 7468 206d 7573 7420 6265 206c 6573  ngth must be les
-0000c330: 7320 7468 616e 206f 7220 6571 7561 6c20  s than or equal 
-0000c340: 746f 2045 7863 656c 2773 206c 696d 6974  to Excel's limit
-0000c350: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-0000c360: 2020 2020 226f 6620 3332 2c37 3637 2063      "of 32,767 c
-0000c370: 6861 7261 6374 6572 7320 696e 2077 7269  haracters in wri
-0000c380: 7465 5f72 6963 685f 7374 7269 6e67 2829  te_rich_string()
-0000c390: 2e22 290a 2020 2020 2020 2020 2020 2020  .").            
-0000c3a0: 7265 7475 726e 202d 320a 0a20 2020 2020  return -2..     
-0000c3b0: 2020 2023 2057 7269 7465 2061 2073 6861     # Write a sha
-0000c3c0: 7265 6420 7374 7269 6e67 206f 7220 616e  red string or an
-0000c3d0: 2069 6e2d 6c69 6e65 2073 7472 696e 6720   in-line string 
-0000c3e0: 696e 2063 6f6e 7374 616e 745f 6d65 6d6f  in constant_memo
-0000c3f0: 7279 206d 6f64 652e 0a20 2020 2020 2020  ry mode..       
-0000c400: 2069 6620 6e6f 7420 7365 6c66 2e63 6f6e   if not self.con
-0000c410: 7374 616e 745f 6d65 6d6f 7279 3a0a 2020  stant_memory:.  
-0000c420: 2020 2020 2020 2020 2020 7374 7269 6e67            string
-0000c430: 5f69 6e64 6578 203d 2073 656c 662e 7374  _index = self.st
-0000c440: 725f 7461 626c 652e 5f67 6574 5f73 6861  r_table._get_sha
-0000c450: 7265 645f 7374 7269 6e67 5f69 6e64 6578  red_string_index
-0000c460: 2873 7472 696e 6729 0a20 2020 2020 2020  (string).       
-0000c470: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0000c480: 2020 2073 7472 696e 675f 696e 6465 7820     string_index 
-0000c490: 3d20 7374 7269 6e67 0a0a 2020 2020 2020  = string..      
-0000c4a0: 2020 2320 5772 6974 6520 7072 6576 696f    # Write previo
-0000c4b0: 7573 2072 6f77 2069 6620 696e 2069 6e2d  us row if in in-
-0000c4c0: 6c69 6e65 2073 7472 696e 6720 636f 6e73  line string cons
-0000c4d0: 7461 6e74 5f6d 656d 6f72 7920 6d6f 6465  tant_memory mode
-0000c4e0: 2e0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-0000c4f0: 662e 636f 6e73 7461 6e74 5f6d 656d 6f72  f.constant_memor
-0000c500: 7920 616e 6420 726f 7720 3e20 7365 6c66  y and row > self
-0000c510: 2e70 7265 7669 6f75 735f 726f 773a 0a20  .previous_row:. 
-0000c520: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000c530: 5f77 7269 7465 5f73 696e 676c 655f 726f  _write_single_ro
-0000c540: 7728 726f 7729 0a0a 2020 2020 2020 2020  w(row)..        
-0000c550: 2320 5374 6f72 6520 7468 6520 6365 6c6c  # Store the cell
-0000c560: 2064 6174 6120 696e 2074 6865 2077 6f72   data in the wor
-0000c570: 6b73 6865 6574 2064 6174 6120 7461 626c  ksheet data tabl
-0000c580: 652e 0a20 2020 2020 2020 2073 656c 662e  e..        self.
-0000c590: 7461 626c 655b 726f 775d 5b63 6f6c 5d20  table[row][col] 
-0000c5a0: 3d20 6365 6c6c 5f72 6963 685f 7374 7269  = cell_rich_stri
-0000c5b0: 6e67 5f74 7570 6c65 2873 7472 696e 675f  ng_tuple(string_
-0000c5c0: 696e 6465 782c 0a20 2020 2020 2020 2020  index,.         
-0000c5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c5f0: 2020 2020 2020 2020 2020 2020 2063 656c               cel
-0000c600: 6c5f 666f 726d 6174 2c0a 2020 2020 2020  l_format,.      
-0000c610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c640: 7261 775f 7374 7269 6e67 290a 0a20 2020  raw_string)..   
-0000c650: 2020 2020 2072 6574 7572 6e20 300a 0a20       return 0.. 
-0000c660: 2020 2064 6566 2061 6464 5f77 7269 7465     def add_write
-0000c670: 5f68 616e 646c 6572 2873 656c 662c 2075  _handler(self, u
-0000c680: 7365 725f 7479 7065 2c20 7573 6572 5f66  ser_type, user_f
-0000c690: 756e 6374 696f 6e29 3a0a 2020 2020 2020  unction):.      
-0000c6a0: 2020 2222 220a 2020 2020 2020 2020 4164    """.        Ad
-0000c6b0: 6420 6120 6361 6c6c 6261 636b 2066 756e  d a callback fun
-0000c6c0: 6374 696f 6e20 746f 2074 6865 2077 7269  ction to the wri
-0000c6d0: 7465 2829 206d 6574 686f 6420 746f 2068  te() method to h
-0000c6e0: 616e 646c 6520 7573 6572 2064 6566 696e  andle user defin
-0000c6f0: 6564 0a20 2020 2020 2020 2074 7970 6573  ed.        types
-0000c700: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
-0000c710: 0a20 2020 2020 2020 2020 2020 2075 7365  .            use
-0000c720: 725f 7479 7065 3a20 2020 2020 2054 6865  r_type:      The
-0000c730: 2075 7365 7220 7479 7065 2829 2074 6f20   user type() to 
-0000c740: 6d61 7463 6820 6f6e 2e0a 2020 2020 2020  match on..      
-0000c750: 2020 2020 2020 7573 6572 5f66 756e 6374        user_funct
-0000c760: 696f 6e3a 2020 5468 6520 7573 6572 2064  ion:  The user d
-0000c770: 6566 696e 6564 2066 756e 6374 696f 6e20  efined function 
-0000c780: 746f 2077 7269 7465 2074 6865 2074 7970  to write the typ
-0000c790: 6520 6461 7461 2e0a 2020 2020 2020 2020  e data..        
-0000c7a0: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
-0000c7b0: 2020 2020 204e 6f74 6869 6e67 2e0a 0a20       Nothing... 
-0000c7c0: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-0000c7d0: 2020 2020 7365 6c66 2e77 7269 7465 5f68      self.write_h
-0000c7e0: 616e 646c 6572 735b 7573 6572 5f74 7970  andlers[user_typ
-0000c7f0: 655d 203d 2075 7365 725f 6675 6e63 7469  e] = user_functi
-0000c800: 6f6e 0a0a 2020 2020 4063 6f6e 7665 7274  on..    @convert
-0000c810: 5f63 656c 6c5f 6172 6773 0a20 2020 2064  _cell_args.    d
-0000c820: 6566 2077 7269 7465 5f72 6f77 2873 656c  ef write_row(sel
-0000c830: 662c 2072 6f77 2c20 636f 6c2c 2064 6174  f, row, col, dat
-0000c840: 612c 2063 656c 6c5f 666f 726d 6174 3d4e  a, cell_format=N
-0000c850: 6f6e 6529 3a0a 2020 2020 2020 2020 2222  one):.        ""
-0000c860: 220a 2020 2020 2020 2020 5772 6974 6520  ".        Write 
-0000c870: 6120 726f 7720 6f66 2064 6174 6120 7374  a row of data st
-0000c880: 6172 7469 6e67 2066 726f 6d20 2872 6f77  arting from (row
-0000c890: 2c20 636f 6c29 2e0a 0a20 2020 2020 2020  , col)...       
-0000c8a0: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
-0000c8b0: 2020 2072 6f77 3a20 2020 2054 6865 2063     row:    The c
-0000c8c0: 656c 6c20 726f 7720 287a 6572 6f20 696e  ell row (zero in
-0000c8d0: 6465 7865 6429 2e0a 2020 2020 2020 2020  dexed)..        
-0000c8e0: 2020 2020 636f 6c3a 2020 2020 5468 6520      col:    The 
-0000c8f0: 6365 6c6c 2063 6f6c 756d 6e20 287a 6572  cell column (zer
-0000c900: 6f20 696e 6465 7865 6429 2e0a 2020 2020  o indexed)..    
-0000c910: 2020 2020 2020 2020 6461 7461 3a20 2020          data:   
-0000c920: 4120 6c69 7374 206f 6620 746f 6b65 6e73  A list of tokens
-0000c930: 2074 6f20 6265 2077 7269 7474 656e 2077   to be written w
-0000c940: 6974 6820 7772 6974 6528 292e 0a20 2020  ith write()..   
-0000c950: 2020 2020 2020 2020 2066 6f72 6d61 743a           format:
-0000c960: 2041 6e20 6f70 7469 6f6e 616c 2063 656c   An optional cel
-0000c970: 6c20 466f 726d 6174 206f 626a 6563 742e  l Format object.
-0000c980: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-0000c990: 3a0a 2020 2020 2020 2020 2020 2020 303a  :.            0:
-0000c9a0: 2020 5375 6363 6573 732e 0a20 2020 2020    Success..     
-0000c9b0: 2020 2020 2020 206f 7468 6572 3a20 5265         other: Re
-0000c9c0: 7475 726e 2076 616c 7565 206f 6620 7772  turn value of wr
-0000c9d0: 6974 6528 2920 6d65 7468 6f64 2e0a 0a20  ite() method... 
-0000c9e0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000c9f0: 2020 2066 6f72 2074 6f6b 656e 2069 6e20     for token in 
-0000ca00: 6461 7461 3a0a 2020 2020 2020 2020 2020  data:.          
-0000ca10: 2020 6572 726f 7220 3d20 7365 6c66 2e5f    error = self._
-0000ca20: 7772 6974 6528 726f 772c 2063 6f6c 2c20  write(row, col, 
-0000ca30: 746f 6b65 6e2c 2063 656c 6c5f 666f 726d  token, cell_form
-0000ca40: 6174 290a 2020 2020 2020 2020 2020 2020  at).            
-0000ca50: 6966 2065 7272 6f72 3a0a 2020 2020 2020  if error:.      
-0000ca60: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000ca70: 2065 7272 6f72 0a20 2020 2020 2020 2020   error.         
-0000ca80: 2020 2063 6f6c 202b 3d20 310a 0a20 2020     col += 1..   
-0000ca90: 2020 2020 2072 6574 7572 6e20 300a 0a20       return 0.. 
-0000caa0: 2020 2040 636f 6e76 6572 745f 6365 6c6c     @convert_cell
-0000cab0: 5f61 7267 730a 2020 2020 6465 6620 7772  _args.    def wr
-0000cac0: 6974 655f 636f 6c75 6d6e 2873 656c 662c  ite_column(self,
-0000cad0: 2072 6f77 2c20 636f 6c2c 2064 6174 612c   row, col, data,
-0000cae0: 2063 656c 6c5f 666f 726d 6174 3d4e 6f6e   cell_format=Non
-0000caf0: 6529 3a0a 2020 2020 2020 2020 2222 220a  e):.        """.
-0000cb00: 2020 2020 2020 2020 5772 6974 6520 6120          Write a 
-0000cb10: 636f 6c75 6d6e 206f 6620 6461 7461 2073  column of data s
-0000cb20: 7461 7274 696e 6720 6672 6f6d 2028 726f  tarting from (ro
-0000cb30: 772c 2063 6f6c 292e 0a0a 2020 2020 2020  w, col)...      
-0000cb40: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
-0000cb50: 2020 2020 726f 773a 2020 2020 5468 6520      row:    The 
-0000cb60: 6365 6c6c 2072 6f77 2028 7a65 726f 2069  cell row (zero i
-0000cb70: 6e64 6578 6564 292e 0a20 2020 2020 2020  ndexed)..       
-0000cb80: 2020 2020 2063 6f6c 3a20 2020 2054 6865       col:    The
-0000cb90: 2063 656c 6c20 636f 6c75 6d6e 2028 7a65   cell column (ze
-0000cba0: 726f 2069 6e64 6578 6564 292e 0a20 2020  ro indexed)..   
-0000cbb0: 2020 2020 2020 2020 2064 6174 613a 2020           data:  
-0000cbc0: 2041 206c 6973 7420 6f66 2074 6f6b 656e   A list of token
-0000cbd0: 7320 746f 2062 6520 7772 6974 7465 6e20  s to be written 
-0000cbe0: 7769 7468 2077 7269 7465 2829 2e0a 2020  with write()..  
-0000cbf0: 2020 2020 2020 2020 2020 666f 726d 6174            format
-0000cc00: 3a20 416e 206f 7074 696f 6e61 6c20 6365  : An optional ce
-0000cc10: 6c6c 2046 6f72 6d61 7420 6f62 6a65 6374  ll Format object
-0000cc20: 2e0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-0000cc30: 733a 0a20 2020 2020 2020 2020 2020 2030  s:.            0
-0000cc40: 3a20 2053 7563 6365 7373 2e0a 2020 2020  :  Success..    
-0000cc50: 2020 2020 2020 2020 6f74 6865 723a 2052          other: R
-0000cc60: 6574 7572 6e20 7661 6c75 6520 6f66 2077  eturn value of w
-0000cc70: 7269 7465 2829 206d 6574 686f 642e 0a0a  rite() method...
-0000cc80: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000cc90: 2020 2020 666f 7220 746f 6b65 6e20 696e      for token in
-0000cca0: 2064 6174 613a 0a20 2020 2020 2020 2020   data:.         
-0000ccb0: 2020 2065 7272 6f72 203d 2073 656c 662e     error = self.
-0000ccc0: 5f77 7269 7465 2872 6f77 2c20 636f 6c2c  _write(row, col,
-0000ccd0: 2074 6f6b 656e 2c20 6365 6c6c 5f66 6f72   token, cell_for
-0000cce0: 6d61 7429 0a20 2020 2020 2020 2020 2020  mat).           
-0000ccf0: 2069 6620 6572 726f 723a 0a20 2020 2020   if error:.     
-0000cd00: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0000cd10: 6e20 6572 726f 720a 2020 2020 2020 2020  n error.        
-0000cd20: 2020 2020 726f 7720 2b3d 2031 0a0a 2020      row += 1..  
-0000cd30: 2020 2020 2020 7265 7475 726e 2030 0a0a        return 0..
-0000cd40: 2020 2020 4063 6f6e 7665 7274 5f63 656c      @convert_cel
-0000cd50: 6c5f 6172 6773 0a20 2020 2064 6566 2069  l_args.    def i
-0000cd60: 6e73 6572 745f 696d 6167 6528 7365 6c66  nsert_image(self
-0000cd70: 2c20 726f 772c 2063 6f6c 2c20 6669 6c65  , row, col, file
-0000cd80: 6e61 6d65 2c20 6f70 7469 6f6e 733d 4e6f  name, options=No
-0000cd90: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
-0000cda0: 0a20 2020 2020 2020 2049 6e73 6572 7420  .        Insert 
-0000cdb0: 616e 2069 6d61 6765 2077 6974 6820 6974  an image with it
-0000cdc0: 7320 746f 702d 6c65 6674 2063 6f72 6e65  s top-left corne
-0000cdd0: 7220 696e 2061 2077 6f72 6b73 6865 6574  r in a worksheet
-0000cde0: 2063 656c 6c2e 0a0a 2020 2020 2020 2020   cell...        
-0000cdf0: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
-0000ce00: 2020 726f 773a 2020 2020 2020 5468 6520    row:      The 
-0000ce10: 6365 6c6c 2072 6f77 2028 7a65 726f 2069  cell row (zero i
-0000ce20: 6e64 6578 6564 292e 0a20 2020 2020 2020  ndexed)..       
-0000ce30: 2020 2020 2063 6f6c 3a20 2020 2020 2054       col:      T
-0000ce40: 6865 2063 656c 6c20 636f 6c75 6d6e 2028  he cell column (
-0000ce50: 7a65 726f 2069 6e64 6578 6564 292e 0a20  zero indexed).. 
-0000ce60: 2020 2020 2020 2020 2020 2066 696c 656e             filen
-0000ce70: 616d 653a 2050 6174 6820 616e 6420 6669  ame: Path and fi
-0000ce80: 6c65 6e61 6d65 2066 6f72 2069 6e20 7375  lename for in su
-0000ce90: 7070 6f72 7465 6420 666f 726d 6174 732e  pported formats.
-0000cea0: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
-0000ceb0: 696f 6e73 3a20 2050 6f73 6974 696f 6e2c  ions:  Position,
-0000cec0: 2073 6361 6c65 2c20 7572 6c20 616e 6420   scale, url and 
-0000ced0: 6461 7461 2073 7472 6561 6d20 6f66 2074  data stream of t
-0000cee0: 6865 2069 6d61 6765 2e0a 0a20 2020 2020  he image...     
-0000cef0: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
-0000cf00: 2020 2020 2020 2020 303a 2020 5375 6363          0:  Succ
-0000cf10: 6573 732e 0a20 2020 2020 2020 2020 2020  ess..           
-0000cf20: 202d 313a 2052 6f77 206f 7220 636f 6c75   -1: Row or colu
-0000cf30: 6d6e 2069 7320 6f75 7420 6f66 2077 6f72  mn is out of wor
-0000cf40: 6b73 6865 6574 2062 6f75 6e64 732e 0a0a  ksheet bounds...
-0000cf50: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000cf60: 2020 2020 2320 4368 6563 6b20 696e 7365      # Check inse
-0000cf70: 7274 2028 726f 772c 2063 6f6c 2920 7769  rt (row, col) wi
-0000cf80: 7468 6f75 7420 7374 6f72 696e 672e 0a20  thout storing.. 
-0000cf90: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-0000cfa0: 6368 6563 6b5f 6469 6d65 6e73 696f 6e73  check_dimensions
-0000cfb0: 2872 6f77 2c20 636f 6c2c 2054 7275 652c  (row, col, True,
-0000cfc0: 2054 7275 6529 3a0a 2020 2020 2020 2020   True):.        
-0000cfd0: 2020 2020 7761 726e 2827 4361 6e6e 6f74      warn('Cannot
-0000cfe0: 2069 6e73 6572 7420 696d 6167 6520 6174   insert image at
-0000cff0: 2028 2564 2c20 2564 292e 2720 2520 2872   (%d, %d).' % (r
-0000d000: 6f77 2c20 636f 6c29 290a 2020 2020 2020  ow, col)).      
-0000d010: 2020 2020 2020 7265 7475 726e 202d 310a        return -1.
-0000d020: 0a20 2020 2020 2020 2069 6620 6f70 7469  .        if opti
-0000d030: 6f6e 7320 6973 204e 6f6e 653a 0a20 2020  ons is None:.   
-0000d040: 2020 2020 2020 2020 206f 7074 696f 6e73           options
-0000d050: 203d 207b 7d0a 0a20 2020 2020 2020 2078   = {}..        x
-0000d060: 5f6f 6666 7365 7420 3d20 6f70 7469 6f6e  _offset = option
-0000d070: 732e 6765 7428 2778 5f6f 6666 7365 7427  s.get('x_offset'
-0000d080: 2c20 3029 0a20 2020 2020 2020 2079 5f6f  , 0).        y_o
-0000d090: 6666 7365 7420 3d20 6f70 7469 6f6e 732e  ffset = options.
-0000d0a0: 6765 7428 2779 5f6f 6666 7365 7427 2c20  get('y_offset', 
-0000d0b0: 3029 0a20 2020 2020 2020 2078 5f73 6361  0).        x_sca
-0000d0c0: 6c65 203d 206f 7074 696f 6e73 2e67 6574  le = options.get
-0000d0d0: 2827 785f 7363 616c 6527 2c20 3129 0a20  ('x_scale', 1). 
-0000d0e0: 2020 2020 2020 2079 5f73 6361 6c65 203d         y_scale =
-0000d0f0: 206f 7074 696f 6e73 2e67 6574 2827 795f   options.get('y_
-0000d100: 7363 616c 6527 2c20 3129 0a20 2020 2020  scale', 1).     
-0000d110: 2020 2075 726c 203d 206f 7074 696f 6e73     url = options
-0000d120: 2e67 6574 2827 7572 6c27 2c20 4e6f 6e65  .get('url', None
-0000d130: 290a 2020 2020 2020 2020 7469 7020 3d20  ).        tip = 
-0000d140: 6f70 7469 6f6e 732e 6765 7428 2774 6970  options.get('tip
-0000d150: 272c 204e 6f6e 6529 0a20 2020 2020 2020  ', None).       
-0000d160: 2061 6e63 686f 7220 3d20 6f70 7469 6f6e   anchor = option
-0000d170: 732e 6765 7428 276f 626a 6563 745f 706f  s.get('object_po
-0000d180: 7369 7469 6f6e 272c 2032 290a 2020 2020  sition', 2).    
-0000d190: 2020 2020 696d 6167 655f 6461 7461 203d      image_data =
-0000d1a0: 206f 7074 696f 6e73 2e67 6574 2827 696d   options.get('im
-0000d1b0: 6167 655f 6461 7461 272c 204e 6f6e 6529  age_data', None)
-0000d1c0: 0a20 2020 2020 2020 2064 6573 6372 6970  .        descrip
-0000d1d0: 7469 6f6e 203d 206f 7074 696f 6e73 2e67  tion = options.g
-0000d1e0: 6574 2827 6465 7363 7269 7074 696f 6e27  et('description'
-0000d1f0: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
-0000d200: 6465 636f 7261 7469 7665 203d 206f 7074  decorative = opt
-0000d210: 696f 6e73 2e67 6574 2827 6465 636f 7261  ions.get('decora
-0000d220: 7469 7665 272c 2046 616c 7365 290a 0a20  tive', False).. 
-0000d230: 2020 2020 2020 2023 2046 6f72 2062 6163         # For bac
-0000d240: 6b77 6172 6420 636f 6d70 6174 6962 696c  kward compatibil
-0000d250: 6974 7920 7769 7468 206f 6c64 6572 2070  ity with older p
-0000d260: 6172 616d 6574 6572 206e 616d 652e 0a20  arameter name.. 
-0000d270: 2020 2020 2020 2061 6e63 686f 7220 3d20         anchor = 
-0000d280: 6f70 7469 6f6e 732e 6765 7428 2770 6f73  options.get('pos
-0000d290: 6974 696f 6e69 6e67 272c 2061 6e63 686f  itioning', ancho
-0000d2a0: 7229 0a0a 2020 2020 2020 2020 6966 206e  r)..        if n
-0000d2b0: 6f74 2069 6d61 6765 5f64 6174 6120 616e  ot image_data an
-0000d2c0: 6420 6e6f 7420 6f73 2e70 6174 682e 6578  d not os.path.ex
-0000d2d0: 6973 7473 2866 696c 656e 616d 6529 3a0a  ists(filename):.
-0000d2e0: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-0000d2f0: 2822 496d 6167 6520 6669 6c65 2027 2573  ("Image file '%s
-0000d300: 2720 6e6f 7420 666f 756e 642e 2220 2520  ' not found." % 
-0000d310: 6669 6c65 6e61 6d65 290a 2020 2020 2020  filename).      
-0000d320: 2020 2020 2020 7265 7475 726e 202d 310a        return -1.
-0000d330: 0a20 2020 2020 2020 2073 656c 662e 696d  .        self.im
-0000d340: 6167 6573 2e61 7070 656e 6428 5b72 6f77  ages.append([row
-0000d350: 2c20 636f 6c2c 2066 696c 656e 616d 652c  , col, filename,
-0000d360: 2078 5f6f 6666 7365 742c 2079 5f6f 6666   x_offset, y_off
-0000d370: 7365 742c 0a20 2020 2020 2020 2020 2020  set,.           
-0000d380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d390: 2078 5f73 6361 6c65 2c20 795f 7363 616c   x_scale, y_scal
-0000d3a0: 652c 2075 726c 2c20 7469 702c 2061 6e63  e, url, tip, anc
-0000d3b0: 686f 722c 2069 6d61 6765 5f64 6174 612c  hor, image_data,
-0000d3c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d3d0: 2020 2020 2020 2020 2020 2020 2064 6573               des
-0000d3e0: 6372 6970 7469 6f6e 2c20 6465 636f 7261  cription, decora
-0000d3f0: 7469 7665 5d29 0a20 2020 2020 2020 2072  tive]).        r
-0000d400: 6574 7572 6e20 300a 0a20 2020 2040 636f  eturn 0..    @co
-0000d410: 6e76 6572 745f 6365 6c6c 5f61 7267 730a  nvert_cell_args.
-0000d420: 2020 2020 6465 6620 696e 7365 7274 5f74      def insert_t
-0000d430: 6578 7462 6f78 2873 656c 662c 2072 6f77  extbox(self, row
-0000d440: 2c20 636f 6c2c 2074 6578 742c 206f 7074  , col, text, opt
-0000d450: 696f 6e73 3d4e 6f6e 6529 3a0a 2020 2020  ions=None):.    
-0000d460: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000d470: 496e 7365 7274 2061 6e20 7465 7874 626f  Insert an textbo
-0000d480: 7820 7769 7468 2069 7473 2074 6f70 2d6c  x with its top-l
-0000d490: 6566 7420 636f 726e 6572 2069 6e20 6120  eft corner in a 
-0000d4a0: 776f 726b 7368 6565 7420 6365 6c6c 2e0a  worksheet cell..
-0000d4b0: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
-0000d4c0: 2020 2020 2020 2020 2020 2072 6f77 3a20             row: 
-0000d4d0: 2020 2020 2054 6865 2063 656c 6c20 726f       The cell ro
-0000d4e0: 7720 287a 6572 6f20 696e 6465 7865 6429  w (zero indexed)
-0000d4f0: 2e0a 2020 2020 2020 2020 2020 2020 636f  ..            co
-0000d500: 6c3a 2020 2020 2020 5468 6520 6365 6c6c  l:      The cell
-0000d510: 2063 6f6c 756d 6e20 287a 6572 6f20 696e   column (zero in
-0000d520: 6465 7865 6429 2e0a 2020 2020 2020 2020  dexed)..        
-0000d530: 2020 2020 7465 7874 3a20 2020 2020 5468      text:     Th
-0000d540: 6520 7465 7874 2066 6f72 2074 6865 2074  e text for the t
-0000d550: 6578 7462 6f78 2e0a 2020 2020 2020 2020  extbox..        
-0000d560: 2020 2020 6f70 7469 6f6e 733a 2020 5465      options:  Te
-0000d570: 7874 626f 7820 6f70 7469 6f6e 732e 0a0a  xtbox options...
-0000d580: 2020 2020 2020 2020 5265 7475 726e 733a          Returns:
-0000d590: 0a20 2020 2020 2020 2020 2020 2030 3a20  .            0: 
-0000d5a0: 2053 7563 6365 7373 2e0a 2020 2020 2020   Success..      
-0000d5b0: 2020 2020 2020 2d31 3a20 526f 7720 6f72        -1: Row or
-0000d5c0: 2063 6f6c 756d 6e20 6973 206f 7574 206f   column is out o
-0000d5d0: 6620 776f 726b 7368 6565 7420 626f 756e  f worksheet boun
-0000d5e0: 6473 2e0a 0a20 2020 2020 2020 2022 2222  ds...        """
-0000d5f0: 0a20 2020 2020 2020 2023 2043 6865 636b  .        # Check
-0000d600: 2069 6e73 6572 7420 2872 6f77 2c20 636f   insert (row, co
-0000d610: 6c29 2077 6974 686f 7574 2073 746f 7269  l) without stori
-0000d620: 6e67 2e0a 2020 2020 2020 2020 6966 2073  ng..        if s
-0000d630: 656c 662e 5f63 6865 636b 5f64 696d 656e  elf._check_dimen
-0000d640: 7369 6f6e 7328 726f 772c 2063 6f6c 2c20  sions(row, col, 
-0000d650: 5472 7565 2c20 5472 7565 293a 0a20 2020  True, True):.   
-0000d660: 2020 2020 2020 2020 2077 6172 6e28 2743           warn('C
-0000d670: 616e 6e6f 7420 696e 7365 7274 2074 6578  annot insert tex
-0000d680: 7462 6f78 2061 7420 2825 642c 2025 6429  tbox at (%d, %d)
-0000d690: 2e27 2025 2028 726f 772c 2063 6f6c 2929  .' % (row, col))
-0000d6a0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0000d6b0: 7572 6e20 2d31 0a0a 2020 2020 2020 2020  urn -1..        
-0000d6c0: 6966 2074 6578 7420 6973 204e 6f6e 653a  if text is None:
-0000d6d0: 0a20 2020 2020 2020 2020 2020 2074 6578  .            tex
-0000d6e0: 7420 3d20 2727 0a0a 2020 2020 2020 2020  t = ''..        
-0000d6f0: 6966 206f 7074 696f 6e73 2069 7320 4e6f  if options is No
-0000d700: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0000d710: 6f70 7469 6f6e 7320 3d20 7b7d 0a0a 2020  options = {}..  
-0000d720: 2020 2020 2020 785f 6f66 6673 6574 203d        x_offset =
-0000d730: 206f 7074 696f 6e73 2e67 6574 2827 785f   options.get('x_
-0000d740: 6f66 6673 6574 272c 2030 290a 2020 2020  offset', 0).    
-0000d750: 2020 2020 795f 6f66 6673 6574 203d 206f      y_offset = o
-0000d760: 7074 696f 6e73 2e67 6574 2827 795f 6f66  ptions.get('y_of
-0000d770: 6673 6574 272c 2030 290a 2020 2020 2020  fset', 0).      
-0000d780: 2020 785f 7363 616c 6520 3d20 6f70 7469    x_scale = opti
-0000d790: 6f6e 732e 6765 7428 2778 5f73 6361 6c65  ons.get('x_scale
-0000d7a0: 272c 2031 290a 2020 2020 2020 2020 795f  ', 1).        y_
-0000d7b0: 7363 616c 6520 3d20 6f70 7469 6f6e 732e  scale = options.
-0000d7c0: 6765 7428 2779 5f73 6361 6c65 272c 2031  get('y_scale', 1
-0000d7d0: 290a 2020 2020 2020 2020 616e 6368 6f72  ).        anchor
-0000d7e0: 203d 206f 7074 696f 6e73 2e67 6574 2827   = options.get('
-0000d7f0: 6f62 6a65 6374 5f70 6f73 6974 696f 6e27  object_position'
-0000d800: 2c20 3129 0a20 2020 2020 2020 2064 6573  , 1).        des
-0000d810: 6372 6970 7469 6f6e 203d 206f 7074 696f  cription = optio
-0000d820: 6e73 2e67 6574 2827 6465 7363 7269 7074  ns.get('descript
-0000d830: 696f 6e27 2c20 4e6f 6e65 290a 2020 2020  ion', None).    
-0000d840: 2020 2020 6465 636f 7261 7469 7665 203d      decorative =
-0000d850: 206f 7074 696f 6e73 2e67 6574 2827 6465   options.get('de
-0000d860: 636f 7261 7469 7665 272c 2046 616c 7365  corative', False
-0000d870: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-0000d880: 7368 6170 6573 2e61 7070 656e 6428 5b72  shapes.append([r
-0000d890: 6f77 2c20 636f 6c2c 2078 5f6f 6666 7365  ow, col, x_offse
-0000d8a0: 742c 2079 5f6f 6666 7365 742c 0a20 2020  t, y_offset,.   
-0000d8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d8c0: 2020 2020 2020 2020 2078 5f73 6361 6c65           x_scale
-0000d8d0: 2c20 795f 7363 616c 652c 2074 6578 742c  , y_scale, text,
-0000d8e0: 2061 6e63 686f 722c 206f 7074 696f 6e73   anchor, options
-0000d8f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000d900: 2020 2020 2020 2020 2020 2020 2020 6465                de
-0000d910: 7363 7269 7074 696f 6e2c 2064 6563 6f72  scription, decor
-0000d920: 6174 6976 655d 290a 2020 2020 2020 2020  ative]).        
-0000d930: 7265 7475 726e 2030 0a0a 2020 2020 4063  return 0..    @c
-0000d940: 6f6e 7665 7274 5f63 656c 6c5f 6172 6773  onvert_cell_args
-0000d950: 0a20 2020 2064 6566 2069 6e73 6572 745f  .    def insert_
-0000d960: 6368 6172 7428 7365 6c66 2c20 726f 772c  chart(self, row,
-0000d970: 2063 6f6c 2c20 6368 6172 742c 206f 7074   col, chart, opt
-0000d980: 696f 6e73 3d4e 6f6e 6529 3a0a 2020 2020  ions=None):.    
-0000d990: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000d9a0: 496e 7365 7274 2061 6e20 6368 6172 7420  Insert an chart 
-0000d9b0: 7769 7468 2069 7473 2074 6f70 2d6c 6566  with its top-lef
-0000d9c0: 7420 636f 726e 6572 2069 6e20 6120 776f  t corner in a wo
-0000d9d0: 726b 7368 6565 7420 6365 6c6c 2e0a 0a20  rksheet cell... 
-0000d9e0: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
-0000d9f0: 2020 2020 2020 2020 2072 6f77 3a20 2020           row:   
-0000da00: 2020 5468 6520 6365 6c6c 2072 6f77 2028    The cell row (
-0000da10: 7a65 726f 2069 6e64 6578 6564 292e 0a20  zero indexed).. 
-0000da20: 2020 2020 2020 2020 2020 2063 6f6c 3a20             col: 
-0000da30: 2020 2020 5468 6520 6365 6c6c 2063 6f6c      The cell col
-0000da40: 756d 6e20 287a 6572 6f20 696e 6465 7865  umn (zero indexe
-0000da50: 6429 2e0a 2020 2020 2020 2020 2020 2020  d)..            
-0000da60: 6368 6172 743a 2020 2043 6861 7274 206f  chart:   Chart o
-0000da70: 626a 6563 742e 0a20 2020 2020 2020 2020  bject..         
-0000da80: 2020 206f 7074 696f 6e73 3a20 506f 7369     options: Posi
-0000da90: 7469 6f6e 2061 6e64 2073 6361 6c65 206f  tion and scale o
-0000daa0: 6620 7468 6520 6368 6172 742e 0a0a 2020  f the chart...  
-0000dab0: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
-0000dac0: 2020 2020 2020 2020 2020 2030 3a20 2053             0:  S
-0000dad0: 7563 6365 7373 2e0a 2020 2020 2020 2020  uccess..        
-0000dae0: 2020 2020 2d31 3a20 526f 7720 6f72 2063      -1: Row or c
-0000daf0: 6f6c 756d 6e20 6973 206f 7574 206f 6620  olumn is out of 
-0000db00: 776f 726b 7368 6565 7420 626f 756e 6473  worksheet bounds
-0000db10: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
-0000db20: 2020 2020 2020 2023 2043 6865 636b 2069         # Check i
-0000db30: 6e73 6572 7420 2872 6f77 2c20 636f 6c29  nsert (row, col)
-0000db40: 2077 6974 686f 7574 2073 746f 7269 6e67   without storing
-0000db50: 2e0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-0000db60: 662e 5f63 6865 636b 5f64 696d 656e 7369  f._check_dimensi
-0000db70: 6f6e 7328 726f 772c 2063 6f6c 2c20 5472  ons(row, col, Tr
-0000db80: 7565 2c20 5472 7565 293a 0a20 2020 2020  ue, True):.     
-0000db90: 2020 2020 2020 2077 6172 6e28 2743 616e         warn('Can
-0000dba0: 6e6f 7420 696e 7365 7274 2063 6861 7274  not insert chart
-0000dbb0: 2061 7420 2825 642c 2025 6429 2e27 2025   at (%d, %d).' %
-0000dbc0: 2028 726f 772c 2063 6f6c 2929 0a20 2020   (row, col)).   
-0000dbd0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000dbe0: 2d31 0a0a 2020 2020 2020 2020 6966 206f  -1..        if o
-0000dbf0: 7074 696f 6e73 2069 7320 4e6f 6e65 3a0a  ptions is None:.
-0000dc00: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
-0000dc10: 6f6e 7320 3d20 7b7d 0a0a 2020 2020 2020  ons = {}..      
-0000dc20: 2020 2320 456e 7375 7265 2061 2063 6861    # Ensure a cha
-0000dc30: 7274 2069 736e 2774 2069 6e73 6572 7465  rt isn't inserte
-0000dc40: 6420 6d6f 7265 2074 6861 6e20 6f6e 6365  d more than once
-0000dc50: 2e0a 2020 2020 2020 2020 6966 2028 6368  ..        if (ch
-0000dc60: 6172 742e 616c 7265 6164 795f 696e 7365  art.already_inse
-0000dc70: 7274 6564 206f 7220 6368 6172 742e 636f  rted or chart.co
-0000dc80: 6d62 696e 6564 0a20 2020 2020 2020 2020  mbined.         
-0000dc90: 2020 2020 2020 2061 6e64 2063 6861 7274         and chart
-0000dca0: 2e63 6f6d 6269 6e65 642e 616c 7265 6164  .combined.alread
-0000dcb0: 795f 696e 7365 7274 6564 293a 0a0a 2020  y_inserted):..  
-0000dcc0: 2020 2020 2020 2020 2020 7761 726e 2827            warn('
-0000dcd0: 4368 6172 7420 6361 6e6e 6f74 2062 6520  Chart cannot be 
-0000dce0: 696e 7365 7274 6564 2069 6e20 6120 776f  inserted in a wo
-0000dcf0: 726b 7368 6565 7420 6d6f 7265 2074 6861  rksheet more tha
-0000dd00: 6e20 6f6e 6365 2e27 290a 2020 2020 2020  n once.').      
-0000dd10: 2020 2020 2020 7265 7475 726e 0a20 2020        return.   
-0000dd20: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0000dd30: 2020 2020 2020 2063 6861 7274 2e61 6c72         chart.alr
-0000dd40: 6561 6479 5f69 6e73 6572 7465 6420 3d20  eady_inserted = 
-0000dd50: 5472 7565 0a0a 2020 2020 2020 2020 2020  True..          
-0000dd60: 2020 6966 2063 6861 7274 2e63 6f6d 6269    if chart.combi
-0000dd70: 6e65 643a 0a20 2020 2020 2020 2020 2020  ned:.           
-0000dd80: 2020 2020 2063 6861 7274 2e63 6f6d 6269       chart.combi
-0000dd90: 6e65 642e 616c 7265 6164 795f 696e 7365  ned.already_inse
-0000dda0: 7274 6564 203d 2054 7275 650a 0a20 2020  rted = True..   
-0000ddb0: 2020 2020 2078 5f6f 6666 7365 7420 3d20       x_offset = 
-0000ddc0: 6f70 7469 6f6e 732e 6765 7428 2778 5f6f  options.get('x_o
-0000ddd0: 6666 7365 7427 2c20 3029 0a20 2020 2020  ffset', 0).     
-0000dde0: 2020 2079 5f6f 6666 7365 7420 3d20 6f70     y_offset = op
-0000ddf0: 7469 6f6e 732e 6765 7428 2779 5f6f 6666  tions.get('y_off
-0000de00: 7365 7427 2c20 3029 0a20 2020 2020 2020  set', 0).       
-0000de10: 2078 5f73 6361 6c65 203d 206f 7074 696f   x_scale = optio
-0000de20: 6e73 2e67 6574 2827 785f 7363 616c 6527  ns.get('x_scale'
-0000de30: 2c20 3129 0a20 2020 2020 2020 2079 5f73  , 1).        y_s
-0000de40: 6361 6c65 203d 206f 7074 696f 6e73 2e67  cale = options.g
-0000de50: 6574 2827 795f 7363 616c 6527 2c20 3129  et('y_scale', 1)
-0000de60: 0a20 2020 2020 2020 2061 6e63 686f 7220  .        anchor 
-0000de70: 3d20 6f70 7469 6f6e 732e 6765 7428 276f  = options.get('o
-0000de80: 626a 6563 745f 706f 7369 7469 6f6e 272c  bject_position',
-0000de90: 2031 290a 2020 2020 2020 2020 6465 7363   1).        desc
-0000dea0: 7269 7074 696f 6e20 3d20 6f70 7469 6f6e  ription = option
-0000deb0: 732e 6765 7428 2764 6573 6372 6970 7469  s.get('descripti
-0000dec0: 6f6e 272c 204e 6f6e 6529 0a20 2020 2020  on', None).     
-0000ded0: 2020 2064 6563 6f72 6174 6976 6520 3d20     decorative = 
-0000dee0: 6f70 7469 6f6e 732e 6765 7428 2764 6563  options.get('dec
-0000def0: 6f72 6174 6976 6527 2c20 4661 6c73 6529  orative', False)
-0000df00: 0a0a 2020 2020 2020 2020 2320 416c 6c6f  ..        # Allo
-0000df10: 7720 4368 6172 7420 746f 206f 7665 7272  w Chart to overr
-0000df20: 6964 6520 7468 6520 7363 616c 6520 616e  ide the scale an
-0000df30: 6420 6f66 6673 6574 2e0a 2020 2020 2020  d offset..      
-0000df40: 2020 6966 2063 6861 7274 2e78 5f73 6361    if chart.x_sca
-0000df50: 6c65 2021 3d20 313a 0a20 2020 2020 2020  le != 1:.       
-0000df60: 2020 2020 2078 5f73 6361 6c65 203d 2063       x_scale = c
-0000df70: 6861 7274 2e78 5f73 6361 6c65 0a0a 2020  hart.x_scale..  
-0000df80: 2020 2020 2020 6966 2063 6861 7274 2e79        if chart.y
-0000df90: 5f73 6361 6c65 2021 3d20 313a 0a20 2020  _scale != 1:.   
-0000dfa0: 2020 2020 2020 2020 2079 5f73 6361 6c65           y_scale
-0000dfb0: 203d 2063 6861 7274 2e79 5f73 6361 6c65   = chart.y_scale
-0000dfc0: 0a0a 2020 2020 2020 2020 6966 2063 6861  ..        if cha
-0000dfd0: 7274 2e78 5f6f 6666 7365 743a 0a20 2020  rt.x_offset:.   
-0000dfe0: 2020 2020 2020 2020 2078 5f6f 6666 7365           x_offse
-0000dff0: 7420 3d20 6368 6172 742e 785f 6f66 6673  t = chart.x_offs
-0000e000: 6574 0a0a 2020 2020 2020 2020 6966 2063  et..        if c
-0000e010: 6861 7274 2e79 5f6f 6666 7365 743a 0a20  hart.y_offset:. 
-0000e020: 2020 2020 2020 2020 2020 2079 5f6f 6666             y_off
-0000e030: 7365 7420 3d20 6368 6172 742e 795f 6f66  set = chart.y_of
-0000e040: 6673 6574 0a0a 2020 2020 2020 2020 7365  fset..        se
-0000e050: 6c66 2e63 6861 7274 732e 6170 7065 6e64  lf.charts.append
-0000e060: 285b 726f 772c 2063 6f6c 2c20 6368 6172  ([row, col, char
-0000e070: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-0000e080: 2020 2020 2020 2020 2020 2020 2020 2078                 x
-0000e090: 5f6f 6666 7365 742c 2079 5f6f 6666 7365  _offset, y_offse
-0000e0a0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-0000e0b0: 2020 2020 2020 2020 2020 2020 2020 2078                 x
-0000e0c0: 5f73 6361 6c65 2c20 795f 7363 616c 652c  _scale, y_scale,
-0000e0d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e0e0: 2020 2020 2020 2020 2020 2020 2061 6e63               anc
-0000e0f0: 686f 722c 0a20 2020 2020 2020 2020 2020  hor,.           
-0000e100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e110: 2064 6573 6372 6970 7469 6f6e 2c20 6465   description, de
-0000e120: 636f 7261 7469 7665 5d29 0a20 2020 2020  corative]).     
-0000e130: 2020 2072 6574 7572 6e20 300a 0a20 2020     return 0..   
-0000e140: 2040 636f 6e76 6572 745f 6365 6c6c 5f61   @convert_cell_a
-0000e150: 7267 730a 2020 2020 6465 6620 7772 6974  rgs.    def writ
-0000e160: 655f 636f 6d6d 656e 7428 7365 6c66 2c20  e_comment(self, 
-0000e170: 726f 772c 2063 6f6c 2c20 636f 6d6d 656e  row, col, commen
-0000e180: 742c 206f 7074 696f 6e73 3d4e 6f6e 6529  t, options=None)
-0000e190: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0000e1a0: 2020 2020 2020 5772 6974 6520 6120 636f        Write a co
-0000e1b0: 6d6d 656e 7420 746f 2061 2077 6f72 6b73  mment to a works
-0000e1c0: 6865 6574 2063 656c 6c2e 0a0a 2020 2020  heet cell...    
-0000e1d0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-0000e1e0: 2020 2020 2020 726f 773a 2020 2020 2054        row:     T
-0000e1f0: 6865 2063 656c 6c20 726f 7720 287a 6572  he cell row (zer
-0000e200: 6f20 696e 6465 7865 6429 2e0a 2020 2020  o indexed)..    
-0000e210: 2020 2020 2020 2020 636f 6c3a 2020 2020          col:    
-0000e220: 2054 6865 2063 656c 6c20 636f 6c75 6d6e   The cell column
-0000e230: 2028 7a65 726f 2069 6e64 6578 6564 292e   (zero indexed).
-0000e240: 0a20 2020 2020 2020 2020 2020 2063 6f6d  .            com
-0000e250: 6d65 6e74 3a20 4365 6c6c 2063 6f6d 6d65  ment: Cell comme
-0000e260: 6e74 2e20 5374 722e 0a20 2020 2020 2020  nt. Str..       
-0000e270: 2020 2020 206f 7074 696f 6e73 3a20 436f       options: Co
-0000e280: 6d6d 656e 7420 666f 726d 6174 7469 6e67  mment formatting
-0000e290: 206f 7074 696f 6e73 2e0a 0a20 2020 2020   options...     
-0000e2a0: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
-0000e2b0: 2020 2020 2020 2020 303a 2020 5375 6363          0:  Succ
-0000e2c0: 6573 732e 0a20 2020 2020 2020 2020 2020  ess..           
-0000e2d0: 202d 313a 2052 6f77 206f 7220 636f 6c75   -1: Row or colu
-0000e2e0: 6d6e 2069 7320 6f75 7420 6f66 2077 6f72  mn is out of wor
-0000e2f0: 6b73 6865 6574 2062 6f75 6e64 732e 0a20  ksheet bounds.. 
-0000e300: 2020 2020 2020 2020 2020 202d 323a 2053             -2: S
-0000e310: 7472 696e 6720 6c6f 6e67 6572 2074 6861  tring longer tha
-0000e320: 6e20 3332 6b20 6368 6172 6163 7465 7273  n 32k characters
-0000e330: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
-0000e340: 2020 2020 2020 2069 6620 6f70 7469 6f6e         if option
-0000e350: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
-0000e360: 2020 2020 2020 206f 7074 696f 6e73 203d         options =
-0000e370: 207b 7d0a 0a20 2020 2020 2020 2023 2043   {}..        # C
-0000e380: 6865 636b 2074 6861 7420 726f 7720 616e  heck that row an
-0000e390: 6420 636f 6c20 6172 6520 7661 6c69 6420  d col are valid 
-0000e3a0: 616e 6420 7374 6f72 6520 6d61 7820 616e  and store max an
-0000e3b0: 6420 6d69 6e20 7661 6c75 6573 0a20 2020  d min values.   
-0000e3c0: 2020 2020 2069 6620 7365 6c66 2e5f 6368       if self._ch
-0000e3d0: 6563 6b5f 6469 6d65 6e73 696f 6e73 2872  eck_dimensions(r
-0000e3e0: 6f77 2c20 636f 6c29 3a0a 2020 2020 2020  ow, col):.      
-0000e3f0: 2020 2020 2020 7265 7475 726e 202d 310a        return -1.
-0000e400: 0a20 2020 2020 2020 2023 2043 6865 636b  .        # Check
-0000e410: 2074 6861 7420 7468 6520 636f 6d6d 656e   that the commen
-0000e420: 7420 7374 7269 6e67 2069 7320 3c20 3332  t string is < 32
-0000e430: 3736 3720 6368 6172 732e 0a20 2020 2020  767 chars..     
-0000e440: 2020 2069 6620 6c65 6e28 636f 6d6d 656e     if len(commen
-0000e450: 7429 203e 2073 656c 662e 786c 735f 7374  t) > self.xls_st
-0000e460: 726d 6178 3a0a 2020 2020 2020 2020 2020  rmax:.          
-0000e470: 2020 7265 7475 726e 202d 320a 0a20 2020    return -2..   
-0000e480: 2020 2020 2073 656c 662e 6861 735f 766d       self.has_vm
-0000e490: 6c20 3d20 310a 2020 2020 2020 2020 7365  l = 1.        se
-0000e4a0: 6c66 2e68 6173 5f63 6f6d 6d65 6e74 7320  lf.has_comments 
-0000e4b0: 3d20 310a 0a20 2020 2020 2020 2023 2053  = 1..        # S
-0000e4c0: 746f 7265 2074 6865 206f 7074 696f 6e73  tore the options
-0000e4d0: 206f 6620 7468 6520 6365 6c6c 2063 6f6d   of the cell com
-0000e4e0: 6d65 6e74 2c20 746f 2070 726f 6365 7373  ment, to process
-0000e4f0: 206f 6e20 6669 6c65 2063 6c6f 7365 2e0a   on file close..
-0000e500: 2020 2020 2020 2020 7365 6c66 2e63 6f6d          self.com
-0000e510: 6d65 6e74 735b 726f 775d 5b63 6f6c 5d20  ments[row][col] 
-0000e520: 3d20 5b72 6f77 2c20 636f 6c2c 2063 6f6d  = [row, col, com
-0000e530: 6d65 6e74 2c20 6f70 7469 6f6e 735d 0a0a  ment, options]..
-0000e540: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
-0000e550: 0a0a 2020 2020 6465 6620 7368 6f77 5f63  ..    def show_c
-0000e560: 6f6d 6d65 6e74 7328 7365 6c66 293a 0a20  omments(self):. 
-0000e570: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000e580: 2020 204d 616b 6520 616e 7920 636f 6d6d     Make any comm
-0000e590: 656e 7473 2069 6e20 7468 6520 776f 726b  ents in the work
-0000e5a0: 7368 6565 7420 7669 7369 626c 652e 0a0a  sheet visible...
-0000e5b0: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
-0000e5c0: 2020 2020 2020 2020 2020 4e6f 6e65 2e0a            None..
-0000e5d0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-0000e5e0: 3a0a 2020 2020 2020 2020 2020 2020 4e6f  :.            No
-0000e5f0: 7468 696e 672e 0a0a 2020 2020 2020 2020  thing...        
-0000e600: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
-0000e610: 2e63 6f6d 6d65 6e74 735f 7669 7369 626c  .comments_visibl
-0000e620: 6520 3d20 310a 0a20 2020 2064 6566 2073  e = 1..    def s
-0000e630: 6574 5f62 6163 6b67 726f 756e 6428 7365  et_background(se
-0000e640: 6c66 2c20 6669 6c65 6e61 6d65 2c20 6973  lf, filename, is
-0000e650: 5f62 7974 655f 7374 7265 616d 3d46 616c  _byte_stream=Fal
-0000e660: 7365 293a 0a20 2020 2020 2020 2022 2222  se):.        """
-0000e670: 0a20 2020 2020 2020 2053 6574 2061 2062  .        Set a b
-0000e680: 6163 6b67 726f 756e 6420 696d 6167 6520  ackground image 
-0000e690: 666f 7220 6120 776f 726b 7368 6565 742e  for a worksheet.
-0000e6a0: 0a0a 2020 2020 2020 2020 4172 6773 3a0a  ..        Args:.
-0000e6b0: 2020 2020 2020 2020 2020 2020 6669 6c65              file
-0000e6c0: 6e61 6d65 3a20 2020 2020 2020 5061 7468  name:       Path
-0000e6d0: 2061 6e64 2066 696c 656e 616d 6520 666f   and filename fo
-0000e6e0: 7220 696e 2073 7570 706f 7274 6564 2066  r in supported f
-0000e6f0: 6f72 6d61 7473 2e0a 2020 2020 2020 2020  ormats..        
-0000e700: 2020 2020 6973 5f62 7974 655f 7374 7265      is_byte_stre
-0000e710: 616d 3a20 4669 6c65 2069 7320 6120 7374  am: File is a st
-0000e720: 7265 616d 206f 6620 6279 7465 732e 0a20  ream of bytes.. 
-0000e730: 2020 2020 2020 2052 6574 7572 6e73 3a0a         Returns:.
-0000e740: 2020 2020 2020 2020 2020 2020 4e6f 7468              Noth
-0000e750: 696e 672e 0a0a 2020 2020 2020 2020 2222  ing...        ""
-0000e760: 220a 0a20 2020 2020 2020 2069 6620 6e6f  "..        if no
-0000e770: 7420 6973 5f62 7974 655f 7374 7265 616d  t is_byte_stream
-0000e780: 2061 6e64 206e 6f74 206f 732e 7061 7468   and not os.path
-0000e790: 2e65 7869 7374 7328 6669 6c65 6e61 6d65  .exists(filename
-0000e7a0: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
-0000e7b0: 6172 6e28 2249 6d61 6765 2066 696c 6520  arn("Image file 
-0000e7c0: 2725 7327 206e 6f74 2066 6f75 6e64 2e22  '%s' not found."
-0000e7d0: 2025 2066 696c 656e 616d 6529 0a20 2020   % filename).   
-0000e7e0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000e7f0: 2d31 0a0a 2020 2020 2020 2020 7365 6c66  -1..        self
-0000e800: 2e62 6163 6b67 726f 756e 645f 6279 7465  .background_byte
-0000e810: 7320 3d20 6973 5f62 7974 655f 7374 7265  s = is_byte_stre
-0000e820: 616d 0a20 2020 2020 2020 2073 656c 662e  am.        self.
-0000e830: 6261 636b 6772 6f75 6e64 5f69 6d61 6765  background_image
-0000e840: 203d 2066 696c 656e 616d 650a 0a20 2020   = filename..   
-0000e850: 2064 6566 2073 6574 5f63 6f6d 6d65 6e74   def set_comment
-0000e860: 735f 6175 7468 6f72 2873 656c 662c 2061  s_author(self, a
-0000e870: 7574 686f 7229 3a0a 2020 2020 2020 2020  uthor):.        
-0000e880: 2222 220a 2020 2020 2020 2020 5365 7420  """.        Set 
-0000e890: 7468 6520 6465 6661 756c 7420 6175 7468  the default auth
-0000e8a0: 6f72 206f 6620 7468 6520 6365 6c6c 2063  or of the cell c
-0000e8b0: 6f6d 6d65 6e74 732e 0a0a 2020 2020 2020  omments...      
-0000e8c0: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
-0000e8d0: 2020 2020 6175 7468 6f72 3a20 436f 6d6d      author: Comm
-0000e8e0: 656e 7420 6175 7468 6f72 206e 616d 652e  ent author name.
-0000e8f0: 2053 7472 696e 672e 0a0a 2020 2020 2020   String...      
-0000e900: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
-0000e910: 2020 2020 2020 204e 6f74 6869 6e67 2e0a         Nothing..
-0000e920: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000e930: 2020 2020 2073 656c 662e 636f 6d6d 656e       self.commen
-0000e940: 7473 5f61 7574 686f 7220 3d20 6175 7468  ts_author = auth
-0000e950: 6f72 0a0a 2020 2020 6465 6620 6765 745f  or..    def get_
-0000e960: 6e61 6d65 2873 656c 6629 3a0a 2020 2020  name(self):.    
-0000e970: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000e980: 5265 7472 6965 7665 2074 6865 2077 6f72  Retrieve the wor
-0000e990: 6b73 6865 6574 206e 616d 652e 0a0a 2020  ksheet name...  
-0000e9a0: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
-0000e9b0: 2020 2020 2020 2020 4e6f 6e65 2e0a 0a20          None... 
-0000e9c0: 2020 2020 2020 2052 6574 7572 6e73 3a0a         Returns:.
-0000e9d0: 2020 2020 2020 2020 2020 2020 4e6f 7468              Noth
-0000e9e0: 696e 672e 0a0a 2020 2020 2020 2020 2222  ing...        ""
-0000e9f0: 220a 2020 2020 2020 2020 2320 5468 6572  ".        # Ther
-0000ea00: 6520 6973 206e 6f20 7365 745f 6e61 6d65  e is no set_name
-0000ea10: 2829 206d 6574 686f 642e 204e 616d 6520  () method. Name 
-0000ea20: 6d75 7374 2062 6520 7365 7420 696e 2061  must be set in a
-0000ea30: 6464 5f77 6f72 6b73 6865 6574 2829 2e0a  dd_worksheet()..
-0000ea40: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000ea50: 656c 662e 6e61 6d65 0a0a 2020 2020 6465  elf.name..    de
-0000ea60: 6620 6163 7469 7661 7465 2873 656c 6629  f activate(self)
-0000ea70: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-0000ea80: 2020 2020 2020 5365 7420 7468 6973 2077        Set this w
-0000ea90: 6f72 6b73 6865 6574 2061 7320 7468 6520  orksheet as the 
-0000eaa0: 6163 7469 7665 2077 6f72 6b73 6865 6574  active worksheet
-0000eab0: 2c20 692e 652e 2074 6865 2077 6f72 6b73  , i.e. the works
-0000eac0: 6865 6574 2074 6861 7420 6973 0a20 2020  heet that is.   
-0000ead0: 2020 2020 2064 6973 706c 6179 6564 2077       displayed w
-0000eae0: 6865 6e20 7468 6520 776f 726b 626f 6f6b  hen the workbook
-0000eaf0: 2069 7320 6f70 656e 6564 2e20 416c 736f   is opened. Also
-0000eb00: 2073 6574 2069 7420 6173 2073 656c 6563   set it as selec
-0000eb10: 7465 642e 0a0a 2020 2020 2020 2020 4e6f  ted...        No
-0000eb20: 7465 3a20 416e 2061 6374 6976 6520 776f  te: An active wo
-0000eb30: 726b 7368 6565 7420 6361 6e6e 6f74 2062  rksheet cannot b
-0000eb40: 6520 6869 6464 656e 2e0a 0a20 2020 2020  e hidden...     
-0000eb50: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-0000eb60: 2020 2020 204e 6f6e 652e 0a0a 2020 2020       None...    
-0000eb70: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
-0000eb80: 2020 2020 2020 2020 204e 6f74 6869 6e67           Nothing
-0000eb90: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
-0000eba0: 2020 2020 2020 2073 656c 662e 6869 6464         self.hidd
-0000ebb0: 656e 203d 2030 0a20 2020 2020 2020 2073  en = 0.        s
-0000ebc0: 656c 662e 7365 6c65 6374 6564 203d 2031  elf.selected = 1
-0000ebd0: 0a20 2020 2020 2020 2073 656c 662e 776f  .        self.wo
-0000ebe0: 726b 7368 6565 745f 6d65 7461 2e61 6374  rksheet_meta.act
-0000ebf0: 6976 6573 6865 6574 203d 2073 656c 662e  ivesheet = self.
-0000ec00: 696e 6465 780a 0a20 2020 2064 6566 2073  index..    def s
-0000ec10: 656c 6563 7428 7365 6c66 293a 0a20 2020  elect(self):.   
-0000ec20: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0000ec30: 2053 6574 2063 7572 7265 6e74 2077 6f72   Set current wor
-0000ec40: 6b73 6865 6574 2061 7320 6120 7365 6c65  ksheet as a sele
-0000ec50: 6374 6564 2077 6f72 6b73 6865 6574 2c20  cted worksheet, 
-0000ec60: 692e 652e 2074 6865 2077 6f72 6b73 6865  i.e. the workshe
-0000ec70: 6574 0a20 2020 2020 2020 2068 6173 2069  et.        has i
-0000ec80: 7473 2074 6162 2068 6967 686c 6967 6874  ts tab highlight
-0000ec90: 6564 2e0a 0a20 2020 2020 2020 204e 6f74  ed...        Not
-0000eca0: 653a 2041 2073 656c 6563 7465 6420 776f  e: A selected wo
-0000ecb0: 726b 7368 6565 7420 6361 6e6e 6f74 2062  rksheet cannot b
-0000ecc0: 6520 6869 6464 656e 2e0a 0a20 2020 2020  e hidden...     
-0000ecd0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-0000ece0: 2020 2020 204e 6f6e 652e 0a0a 2020 2020       None...    
-0000ecf0: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
-0000ed00: 2020 2020 2020 2020 204e 6f74 6869 6e67           Nothing
-0000ed10: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
-0000ed20: 2020 2020 2020 2073 656c 662e 7365 6c65         self.sele
-0000ed30: 6374 6564 203d 2031 0a20 2020 2020 2020  cted = 1.       
-0000ed40: 2073 656c 662e 6869 6464 656e 203d 2030   self.hidden = 0
-0000ed50: 0a0a 2020 2020 6465 6620 6869 6465 2873  ..    def hide(s
-0000ed60: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-0000ed70: 220a 2020 2020 2020 2020 4869 6465 2074  ".        Hide t
-0000ed80: 6865 2063 7572 7265 6e74 2077 6f72 6b73  he current works
-0000ed90: 6865 6574 2e0a 0a20 2020 2020 2020 2041  heet...        A
-0000eda0: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
-0000edb0: 204e 6f6e 652e 0a0a 2020 2020 2020 2020   None...        
-0000edc0: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
-0000edd0: 2020 2020 204e 6f74 6869 6e67 2e0a 0a20       Nothing... 
-0000ede0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000edf0: 2020 2073 656c 662e 6869 6464 656e 203d     self.hidden =
-0000ee00: 2031 0a0a 2020 2020 2020 2020 2320 4120   1..        # A 
-0000ee10: 6869 6464 656e 2077 6f72 6b73 6865 6574  hidden worksheet
-0000ee20: 2073 686f 756c 646e 2774 2062 6520 6163   shouldn't be ac
-0000ee30: 7469 7665 206f 7220 7365 6c65 6374 6564  tive or selected
-0000ee40: 2e0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
-0000ee50: 656c 6563 7465 6420 3d20 300a 0a20 2020  elected = 0..   
-0000ee60: 2020 2020 2023 2054 4f44 4f2e 2053 686f       # TODO. Sho
-0000ee70: 756c 6420 6164 6420 6120 6368 6563 6b20  uld add a check 
-0000ee80: 746f 2073 6565 2069 6620 7468 6520 7368  to see if the sh
-0000ee90: 6565 7420 6973 2074 6865 2067 6c6f 6261  eet is the globa
-0000eea0: 6c0a 2020 2020 2020 2020 2320 6163 7469  l.        # acti
-0000eeb0: 7665 7368 6565 7420 6f72 2066 6972 7374  vesheet or first
-0000eec0: 7368 6565 7420 616e 6420 7265 7365 7420  sheet and reset 
-0000eed0: 7468 656d 2e0a 0a20 2020 2064 6566 2073  them...    def s
-0000eee0: 6574 5f66 6972 7374 5f73 6865 6574 2873  et_first_sheet(s
-0000eef0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-0000ef00: 220a 2020 2020 2020 2020 5365 7420 6375  ".        Set cu
-0000ef10: 7272 656e 7420 776f 726b 7368 6565 7420  rrent worksheet 
-0000ef20: 6173 2074 6865 2066 6972 7374 2076 6973  as the first vis
-0000ef30: 6962 6c65 2073 6865 6574 2e20 5468 6973  ible sheet. This
-0000ef40: 2069 7320 6e65 6365 7373 6172 790a 2020   is necessary.  
-0000ef50: 2020 2020 2020 7768 656e 2074 6865 7265        when there
-0000ef60: 2061 7265 2061 206c 6172 6765 206e 756d   are a large num
-0000ef70: 6265 7220 6f66 2077 6f72 6b73 6865 6574  ber of worksheet
-0000ef80: 7320 616e 6420 7468 6520 6163 7469 7661  s and the activa
-0000ef90: 7465 640a 2020 2020 2020 2020 776f 726b  ted.        work
-0000efa0: 7368 6565 7420 6973 206e 6f74 2076 6973  sheet is not vis
-0000efb0: 6962 6c65 206f 6e20 7468 6520 7363 7265  ible on the scre
-0000efc0: 656e 2e0a 0a20 2020 2020 2020 204e 6f74  en...        Not
-0000efd0: 653a 2041 2073 656c 6563 7465 6420 776f  e: A selected wo
-0000efe0: 726b 7368 6565 7420 6361 6e6e 6f74 2062  rksheet cannot b
-0000eff0: 6520 6869 6464 656e 2e0a 0a20 2020 2020  e hidden...     
-0000f000: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-0000f010: 2020 2020 204e 6f6e 652e 0a0a 2020 2020       None...    
-0000f020: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
-0000f030: 2020 2020 2020 2020 204e 6f74 6869 6e67           Nothing
-0000f040: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
-0000f050: 2020 2020 2020 2073 656c 662e 6869 6464         self.hidd
-0000f060: 656e 203d 2030 2020 2320 4163 7469 7665  en = 0  # Active
-0000f070: 2077 6f72 6b73 6865 6574 2063 616e 2774   worksheet can't
-0000f080: 2062 6520 6869 6464 656e 2e0a 2020 2020   be hidden..    
-0000f090: 2020 2020 7365 6c66 2e77 6f72 6b73 6865      self.workshe
-0000f0a0: 6574 5f6d 6574 612e 6669 7273 7473 6865  et_meta.firstshe
-0000f0b0: 6574 203d 2073 656c 662e 696e 6465 780a  et = self.index.
-0000f0c0: 0a20 2020 2040 636f 6e76 6572 745f 636f  .    @convert_co
-0000f0d0: 6c75 6d6e 5f61 7267 730a 2020 2020 6465  lumn_args.    de
-0000f0e0: 6620 7365 745f 636f 6c75 6d6e 2873 656c  f set_column(sel
-0000f0f0: 662c 2066 6972 7374 5f63 6f6c 2c20 6c61  f, first_col, la
-0000f100: 7374 5f63 6f6c 2c20 7769 6474 683d 4e6f  st_col, width=No
-0000f110: 6e65 2c20 6365 6c6c 5f66 6f72 6d61 743d  ne, cell_format=
-0000f120: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0000f130: 2020 2020 2020 2020 206f 7074 696f 6e73           options
-0000f140: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
-0000f150: 2222 220a 2020 2020 2020 2020 5365 7420  """.        Set 
-0000f160: 7468 6520 7769 6474 682c 2061 6e64 206f  the width, and o
-0000f170: 7468 6572 2070 726f 7065 7274 6965 7320  ther properties 
-0000f180: 6f66 2061 2073 696e 676c 6520 636f 6c75  of a single colu
-0000f190: 6d6e 206f 7220 610a 2020 2020 2020 2020  mn or a.        
-0000f1a0: 7261 6e67 6520 6f66 2063 6f6c 756d 6e73  range of columns
-0000f1b0: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
-0000f1c0: 0a20 2020 2020 2020 2020 2020 2066 6972  .            fir
-0000f1d0: 7374 5f63 6f6c 3a20 2020 4669 7273 7420  st_col:   First 
-0000f1e0: 636f 6c75 6d6e 2028 7a65 726f 2d69 6e64  column (zero-ind
-0000f1f0: 6578 6564 292e 0a20 2020 2020 2020 2020  exed)..         
-0000f200: 2020 206c 6173 745f 636f 6c3a 2020 2020     last_col:    
-0000f210: 4c61 7374 2063 6f6c 756d 6e20 287a 6572  Last column (zer
-0000f220: 6f2d 696e 6465 7865 6429 2e20 4361 6e20  o-indexed). Can 
-0000f230: 6265 2073 616d 6520 6173 2066 6972 7374  be same as first
-0000f240: 5f63 6f6c 2e0a 2020 2020 2020 2020 2020  _col..          
-0000f250: 2020 7769 6474 683a 2020 2020 2020 2043    width:       C
-0000f260: 6f6c 756d 6e20 7769 6474 682e 2028 6f70  olumn width. (op
-0000f270: 7469 6f6e 616c 292e 0a20 2020 2020 2020  tional)..       
-0000f280: 2020 2020 2063 656c 6c5f 666f 726d 6174       cell_format
-0000f290: 3a20 436f 6c75 6d6e 2063 656c 6c5f 666f  : Column cell_fo
-0000f2a0: 726d 6174 2e20 286f 7074 696f 6e61 6c29  rmat. (optional)
-0000f2b0: 2e0a 2020 2020 2020 2020 2020 2020 6f70  ..            op
-0000f2c0: 7469 6f6e 733a 2020 2020 2044 6963 7420  tions:     Dict 
-0000f2d0: 6f66 206f 7074 696f 6e73 2073 7563 6820  of options such 
-0000f2e0: 6173 2068 6964 6465 6e20 616e 6420 6c65  as hidden and le
-0000f2f0: 7665 6c2e 0a0a 2020 2020 2020 2020 5265  vel...        Re
-0000f300: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
-0000f310: 2020 2030 3a20 2053 7563 6365 7373 2e0a     0:  Success..
-0000f320: 2020 2020 2020 2020 2020 2020 2d31 3a20              -1: 
-0000f330: 436f 6c75 6d6e 206e 756d 6265 7220 6973  Column number is
-0000f340: 206f 7574 206f 6620 776f 726b 7368 6565   out of workshee
-0000f350: 7420 626f 756e 6473 2e0a 0a20 2020 2020  t bounds...     
-0000f360: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-0000f370: 6620 6f70 7469 6f6e 7320 6973 204e 6f6e  f options is Non
-0000f380: 653a 0a20 2020 2020 2020 2020 2020 206f  e:.            o
-0000f390: 7074 696f 6e73 203d 207b 7d0a 0a20 2020  ptions = {}..   
-0000f3a0: 2020 2020 2023 2045 6e73 7572 6520 326e       # Ensure 2n
-0000f3b0: 6420 636f 6c20 6973 206c 6172 6765 7220  d col is larger 
-0000f3c0: 7468 616e 2066 6972 7374 2e0a 2020 2020  than first..    
-0000f3d0: 2020 2020 6966 2066 6972 7374 5f63 6f6c      if first_col
-0000f3e0: 203e 206c 6173 745f 636f 6c3a 0a20 2020   > last_col:.   
-0000f3f0: 2020 2020 2020 2020 2028 6669 7273 745f           (first_
-0000f400: 636f 6c2c 206c 6173 745f 636f 6c29 203d  col, last_col) =
-0000f410: 2028 6c61 7374 5f63 6f6c 2c20 6669 7273   (last_col, firs
-0000f420: 745f 636f 6c29 0a0a 2020 2020 2020 2020  t_col)..        
-0000f430: 2320 446f 6e27 7420 6d6f 6469 6679 2074  # Don't modify t
-0000f440: 6865 2072 6f77 2064 696d 656e 7369 6f6e  he row dimension
-0000f450: 7320 7768 656e 2063 6865 636b 696e 6720  s when checking 
-0000f460: 7468 6520 636f 6c75 6d6e 732e 0a20 2020  the columns..   
-0000f470: 2020 2020 2069 676e 6f72 655f 726f 7720       ignore_row 
-0000f480: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
-0000f490: 2320 5365 7420 6f70 7469 6f6e 616c 2063  # Set optional c
-0000f4a0: 6f6c 756d 6e20 7661 6c75 6573 2e0a 2020  olumn values..  
-0000f4b0: 2020 2020 2020 6869 6464 656e 203d 206f        hidden = o
-0000f4c0: 7074 696f 6e73 2e67 6574 2827 6869 6464  ptions.get('hidd
-0000f4d0: 656e 272c 2046 616c 7365 290a 2020 2020  en', False).    
-0000f4e0: 2020 2020 636f 6c6c 6170 7365 6420 3d20      collapsed = 
-0000f4f0: 6f70 7469 6f6e 732e 6765 7428 2763 6f6c  options.get('col
-0000f500: 6c61 7073 6564 272c 2046 616c 7365 290a  lapsed', False).
-0000f510: 2020 2020 2020 2020 6c65 7665 6c20 3d20          level = 
-0000f520: 6f70 7469 6f6e 732e 6765 7428 276c 6576  options.get('lev
-0000f530: 656c 272c 2030 290a 0a20 2020 2020 2020  el', 0)..       
-0000f540: 2023 2053 746f 7265 2074 6865 2063 6f6c   # Store the col
-0000f550: 756d 6e20 6469 6d65 6e73 696f 6e20 6f6e  umn dimension on
-0000f560: 6c79 2069 6e20 736f 6d65 2063 6f6e 6469  ly in some condi
-0000f570: 7469 6f6e 732e 0a20 2020 2020 2020 2069  tions..        i
-0000f580: 6620 6365 6c6c 5f66 6f72 6d61 7420 6f72  f cell_format or
-0000f590: 2028 7769 6474 6820 616e 6420 6869 6464   (width and hidd
-0000f5a0: 656e 293a 0a20 2020 2020 2020 2020 2020  en):.           
-0000f5b0: 2069 676e 6f72 655f 636f 6c20 3d20 4661   ignore_col = Fa
-0000f5c0: 6c73 650a 2020 2020 2020 2020 656c 7365  lse.        else
-0000f5d0: 3a0a 2020 2020 2020 2020 2020 2020 6967  :.            ig
-0000f5e0: 6e6f 7265 5f63 6f6c 203d 2054 7275 650a  nore_col = True.
-0000f5f0: 0a20 2020 2020 2020 2023 2043 6865 636b  .        # Check
-0000f600: 2074 6861 7420 6561 6368 2063 6f6c 756d   that each colum
-0000f610: 6e20 6973 2076 616c 6964 2061 6e64 2073  n is valid and s
-0000f620: 746f 7265 2074 6865 206d 6178 2061 6e64  tore the max and
-0000f630: 206d 696e 2076 616c 7565 732e 0a20 2020   min values..   
-0000f640: 2020 2020 2069 6620 7365 6c66 2e5f 6368       if self._ch
-0000f650: 6563 6b5f 6469 6d65 6e73 696f 6e73 2830  eck_dimensions(0
-0000f660: 2c20 6c61 7374 5f63 6f6c 2c20 6967 6e6f  , last_col, igno
-0000f670: 7265 5f72 6f77 2c20 6967 6e6f 7265 5f63  re_row, ignore_c
-0000f680: 6f6c 293a 0a20 2020 2020 2020 2020 2020  ol):.           
-0000f690: 2072 6574 7572 6e20 2d31 0a20 2020 2020   return -1.     
-0000f6a0: 2020 2069 6620 7365 6c66 2e5f 6368 6563     if self._chec
-0000f6b0: 6b5f 6469 6d65 6e73 696f 6e73 2830 2c20  k_dimensions(0, 
-0000f6c0: 6669 7273 745f 636f 6c2c 2069 676e 6f72  first_col, ignor
-0000f6d0: 655f 726f 772c 2069 676e 6f72 655f 636f  e_row, ignore_co
-0000f6e0: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
-0000f6f0: 7265 7475 726e 202d 310a 0a20 2020 2020  return -1..     
-0000f700: 2020 2023 2053 6574 2074 6865 206c 696d     # Set the lim
-0000f710: 6974 7320 666f 7220 7468 6520 6f75 746c  its for the outl
-0000f720: 696e 6520 6c65 7665 6c73 2028 3020 3c3d  ine levels (0 <=
-0000f730: 2078 203c 3d20 3729 2e0a 2020 2020 2020   x <= 7)..      
-0000f740: 2020 6966 206c 6576 656c 203c 2030 3a0a    if level < 0:.
-0000f750: 2020 2020 2020 2020 2020 2020 6c65 7665              leve
-0000f760: 6c20 3d20 300a 2020 2020 2020 2020 6966  l = 0.        if
-0000f770: 206c 6576 656c 203e 2037 3a0a 2020 2020   level > 7:.    
-0000f780: 2020 2020 2020 2020 6c65 7665 6c20 3d20          level = 
-0000f790: 370a 0a20 2020 2020 2020 2069 6620 6c65  7..        if le
-0000f7a0: 7665 6c20 3e20 7365 6c66 2e6f 7574 6c69  vel > self.outli
-0000f7b0: 6e65 5f63 6f6c 5f6c 6576 656c 3a0a 2020  ne_col_level:.  
-0000f7c0: 2020 2020 2020 2020 2020 7365 6c66 2e6f            self.o
-0000f7d0: 7574 6c69 6e65 5f63 6f6c 5f6c 6576 656c  utline_col_level
-0000f7e0: 203d 206c 6576 656c 0a0a 2020 2020 2020   = level..      
-0000f7f0: 2020 2320 5374 6f72 6520 7468 6520 636f    # Store the co
-0000f800: 6c75 6d6e 2064 6174 612e 0a20 2020 2020  lumn data..     
-0000f810: 2020 2066 6f72 2063 6f6c 2069 6e20 7261     for col in ra
-0000f820: 6e67 6528 6669 7273 745f 636f 6c2c 206c  nge(first_col, l
-0000f830: 6173 745f 636f 6c20 2b20 3129 3a0a 2020  ast_col + 1):.  
-0000f840: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
-0000f850: 6f6c 5f69 6e66 6f5b 636f 6c5d 203d 205b  ol_info[col] = [
-0000f860: 7769 6474 682c 2063 656c 6c5f 666f 726d  width, cell_form
-0000f870: 6174 2c20 6869 6464 656e 2c0a 2020 2020  at, hidden,.    
-0000f880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f890: 2020 2020 2020 2020 2020 2020 2020 6c65                le
-0000f8a0: 7665 6c2c 2063 6f6c 6c61 7073 6564 2c20  vel, collapsed, 
-0000f8b0: 4661 6c73 655d 0a0a 2020 2020 2020 2020  False]..        
-0000f8c0: 2320 5374 6f72 6520 7468 6520 636f 6c75  # Store the colu
-0000f8d0: 6d6e 2063 6861 6e67 6520 746f 2061 6c6c  mn change to all
-0000f8e0: 6f77 206f 7074 696d 697a 6174 696f 6e73  ow optimizations
-0000f8f0: 2e0a 2020 2020 2020 2020 7365 6c66 2e63  ..        self.c
-0000f900: 6f6c 5f73 697a 655f 6368 616e 6765 6420  ol_size_changed 
-0000f910: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
-0000f920: 7265 7475 726e 2030 0a0a 2020 2020 4063  return 0..    @c
-0000f930: 6f6e 7665 7274 5f63 6f6c 756d 6e5f 6172  onvert_column_ar
-0000f940: 6773 0a20 2020 2064 6566 2073 6574 5f63  gs.    def set_c
-0000f950: 6f6c 756d 6e5f 7069 7865 6c73 2873 656c  olumn_pixels(sel
-0000f960: 662c 2066 6972 7374 5f63 6f6c 2c20 6c61  f, first_col, la
-0000f970: 7374 5f63 6f6c 2c20 7769 6474 683d 4e6f  st_col, width=No
-0000f980: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-0000f990: 2020 2020 2020 2020 2020 2020 2020 6365                ce
-0000f9a0: 6c6c 5f66 6f72 6d61 743d 4e6f 6e65 2c20  ll_format=None, 
-0000f9b0: 6f70 7469 6f6e 733d 4e6f 6e65 293a 0a20  options=None):. 
-0000f9c0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000f9d0: 2020 2053 6574 2074 6865 2077 6964 7468     Set the width
-0000f9e0: 2c20 616e 6420 6f74 6865 7220 7072 6f70  , and other prop
-0000f9f0: 6572 7469 6573 206f 6620 6120 7369 6e67  erties of a sing
-0000fa00: 6c65 2063 6f6c 756d 6e20 6f72 2061 0a20  le column or a. 
-0000fa10: 2020 2020 2020 2072 616e 6765 206f 6620         range of 
-0000fa20: 636f 6c75 6d6e 732c 2077 6865 7265 2063  columns, where c
-0000fa30: 6f6c 756d 6e20 7769 6474 6820 6973 2069  olumn width is i
-0000fa40: 6e20 7069 7865 6c73 2e0a 0a20 2020 2020  n pixels...     
-0000fa50: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-0000fa60: 2020 2020 2066 6972 7374 5f63 6f6c 3a20       first_col: 
-0000fa70: 2020 4669 7273 7420 636f 6c75 6d6e 2028    First column (
-0000fa80: 7a65 726f 2d69 6e64 6578 6564 292e 0a20  zero-indexed).. 
-0000fa90: 2020 2020 2020 2020 2020 206c 6173 745f             last_
-0000faa0: 636f 6c3a 2020 2020 4c61 7374 2063 6f6c  col:    Last col
-0000fab0: 756d 6e20 287a 6572 6f2d 696e 6465 7865  umn (zero-indexe
-0000fac0: 6429 2e20 4361 6e20 6265 2073 616d 6520  d). Can be same 
-0000fad0: 6173 2066 6972 7374 5f63 6f6c 2e0a 2020  as first_col..  
-0000fae0: 2020 2020 2020 2020 2020 7769 6474 683a            width:
-0000faf0: 2020 2020 2020 2043 6f6c 756d 6e20 7769         Column wi
-0000fb00: 6474 6820 696e 2070 6978 656c 732e 2028  dth in pixels. (
-0000fb10: 6f70 7469 6f6e 616c 292e 0a20 2020 2020  optional)..     
-0000fb20: 2020 2020 2020 2063 656c 6c5f 666f 726d         cell_form
-0000fb30: 6174 3a20 436f 6c75 6d6e 2063 656c 6c5f  at: Column cell_
-0000fb40: 666f 726d 6174 2e20 286f 7074 696f 6e61  format. (optiona
-0000fb50: 6c29 2e0a 2020 2020 2020 2020 2020 2020  l)..            
-0000fb60: 6f70 7469 6f6e 733a 2020 2020 2044 6963  options:     Dic
-0000fb70: 7420 6f66 206f 7074 696f 6e73 2073 7563  t of options suc
-0000fb80: 6820 6173 2068 6964 6465 6e20 616e 6420  h as hidden and 
-0000fb90: 6c65 7665 6c2e 0a0a 2020 2020 2020 2020  level...        
-0000fba0: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
-0000fbb0: 2020 2020 2030 3a20 2053 7563 6365 7373       0:  Success
-0000fbc0: 2e0a 2020 2020 2020 2020 2020 2020 2d31  ..            -1
-0000fbd0: 3a20 436f 6c75 6d6e 206e 756d 6265 7220  : Column number 
-0000fbe0: 6973 206f 7574 206f 6620 776f 726b 7368  is out of worksh
-0000fbf0: 6565 7420 626f 756e 6473 2e0a 0a20 2020  eet bounds...   
-0000fc00: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0000fc10: 2069 6620 7769 6474 6820 6973 206e 6f74   if width is not
-0000fc20: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0000fc30: 2020 2077 6964 7468 203d 2073 656c 662e     width = self.
-0000fc40: 5f70 6978 656c 735f 746f 5f77 6964 7468  _pixels_to_width
-0000fc50: 2877 6964 7468 290a 0a20 2020 2020 2020  (width)..       
-0000fc60: 2072 6574 7572 6e20 7365 6c66 2e73 6574   return self.set
-0000fc70: 5f63 6f6c 756d 6e28 6669 7273 745f 636f  _column(first_co
-0000fc80: 6c2c 206c 6173 745f 636f 6c2c 2077 6964  l, last_col, wid
-0000fc90: 7468 2c0a 2020 2020 2020 2020 2020 2020  th,.            
-0000fca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fcb0: 2020 2063 656c 6c5f 666f 726d 6174 2c20     cell_format, 
-0000fcc0: 6f70 7469 6f6e 7329 0a0a 2020 2020 6465  options)..    de
-0000fcd0: 6620 6175 746f 6669 7428 7365 6c66 293a  f autofit(self):
-0000fce0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000fcf0: 2020 2020 2053 696d 756c 6174 6520 6175       Simulate au
-0000fd00: 746f 6669 7420 6261 7365 6420 6f6e 2074  tofit based on t
-0000fd10: 6865 2064 6174 612c 2061 6e64 2064 6174  he data, and dat
-0000fd20: 6174 7970 6573 2069 6e20 6561 6368 2063  atypes in each c
-0000fd30: 6f6c 756d 6e2e 0a0a 2020 2020 2020 2020  olumn...        
-0000fd40: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
-0000fd50: 2020 4e6f 6e65 2e0a 0a20 2020 2020 2020    None...       
-0000fd60: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
-0000fd70: 2020 2020 2020 4e6f 7468 696e 672e 0a0a        Nothing...
-0000fd80: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000fd90: 2020 2020 6966 2073 656c 662e 636f 6e73      if self.cons
-0000fda0: 7461 6e74 5f6d 656d 6f72 793a 0a20 2020  tant_memory:.   
-0000fdb0: 2020 2020 2020 2020 2077 6172 6e28 2241           warn("A
-0000fdc0: 7574 6f66 6974 2069 7320 6e6f 7420 7375  utofit is not su
-0000fdd0: 7070 6f72 7465 6420 696e 2063 6f6e 7374  pported in const
-0000fde0: 616e 745f 6d65 6d6f 7279 206d 6f64 652e  ant_memory mode.
-0000fdf0: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
-0000fe00: 6574 7572 6e0a 0a20 2020 2020 2020 2023  eturn..        #
-0000fe10: 204e 6f20 6461 7461 2077 7269 7474 656e   No data written
-0000fe20: 2074 6f20 7468 6520 7461 7267 6574 2073   to the target s
-0000fe30: 6865 6574 3b20 6e6f 7468 696e 6720 746f  heet; nothing to
-0000fe40: 2061 7574 6f66 6974 0a20 2020 2020 2020   autofit.       
-0000fe50: 2069 6620 7365 6c66 2e64 696d 5f72 6f77   if self.dim_row
-0000fe60: 6d61 7820 6973 204e 6f6e 653a 0a20 2020  max is None:.   
-0000fe70: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-0000fe80: 0a20 2020 2020 2020 2023 2053 746f 7265  .        # Store
-0000fe90: 2074 6865 206d 6178 2070 6978 656c 2077   the max pixel w
-0000fea0: 6964 7468 2066 6f72 2065 6163 6820 636f  idth for each co
-0000feb0: 6c75 6d6e 2e0a 2020 2020 2020 2020 636f  lumn..        co
-0000fec0: 6c5f 7769 6474 685f 6d61 7820 3d20 7b7d  l_width_max = {}
-0000fed0: 0a0a 2020 2020 2020 2020 2320 4372 6561  ..        # Crea
-0000fee0: 7465 2061 2072 6576 6572 7365 206c 6f6f  te a reverse loo
-0000fef0: 6b75 7020 666f 7220 7468 6520 7368 6172  kup for the shar
-0000ff00: 6520 7374 7269 6e67 7320 7461 626c 6520  e strings table 
-0000ff10: 736f 2077 6520 6361 6e20 636f 6e76 6572  so we can conver
-0000ff20: 740a 2020 2020 2020 2020 2320 7468 6520  t.        # the 
-0000ff30: 7374 7269 6e67 2069 6420 6261 636b 2074  string id back t
-0000ff40: 6f20 7468 6520 6f72 6967 696e 616c 2073  o the original s
-0000ff50: 7472 696e 672e 0a20 2020 2020 2020 2073  tring..        s
-0000ff60: 7472 696e 6773 203d 2073 6f72 7465 6428  trings = sorted(
-0000ff70: 7365 6c66 2e73 7472 5f74 6162 6c65 2e73  self.str_table.s
-0000ff80: 7472 696e 675f 7461 626c 652c 0a20 2020  tring_table,.   
-0000ff90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ffa0: 2020 2020 2020 6b65 793d 7365 6c66 2e73        key=self.s
-0000ffb0: 7472 5f74 6162 6c65 2e73 7472 696e 675f  tr_table.string_
-0000ffc0: 7461 626c 652e 5f5f 6765 7469 7465 6d5f  table.__getitem_
-0000ffd0: 5f29 0a0a 2020 2020 2020 2020 666f 7220  _)..        for 
-0000ffe0: 726f 775f 6e75 6d20 696e 2072 616e 6765  row_num in range
-0000fff0: 2873 656c 662e 6469 6d5f 726f 776d 696e  (self.dim_rowmin
-00010000: 2c20 7365 6c66 2e64 696d 5f72 6f77 6d61  , self.dim_rowma
-00010010: 7820 2b20 3129 3a0a 2020 2020 2020 2020  x + 1):.        
-00010020: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
-00010030: 7461 626c 652e 6765 7428 726f 775f 6e75  table.get(row_nu
-00010040: 6d29 3a0a 2020 2020 2020 2020 2020 2020  m):.            
-00010050: 2020 2020 636f 6e74 696e 7565 0a0a 2020      continue..  
-00010060: 2020 2020 2020 2020 2020 666f 7220 636f            for co
-00010070: 6c5f 6e75 6d20 696e 2072 616e 6765 2873  l_num in range(s
-00010080: 656c 662e 6469 6d5f 636f 6c6d 696e 2c20  elf.dim_colmin, 
-00010090: 7365 6c66 2e64 696d 5f63 6f6c 6d61 7820  self.dim_colmax 
-000100a0: 2b20 3129 3a0a 2020 2020 2020 2020 2020  + 1):.          
-000100b0: 2020 2020 2020 6966 2063 6f6c 5f6e 756d        if col_num
-000100c0: 2069 6e20 7365 6c66 2e74 6162 6c65 5b72   in self.table[r
-000100d0: 6f77 5f6e 756d 5d3a 0a20 2020 2020 2020  ow_num]:.       
-000100e0: 2020 2020 2020 2020 2020 2020 2063 656c               cel
-000100f0: 6c20 3d20 7365 6c66 2e74 6162 6c65 5b72  l = self.table[r
-00010100: 6f77 5f6e 756d 5d5b 636f 6c5f 6e75 6d5d  ow_num][col_num]
-00010110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010120: 2020 2020 2063 656c 6c5f 7479 7065 203d       cell_type =
-00010130: 2063 656c 6c2e 5f5f 636c 6173 735f 5f2e   cell.__class__.
-00010140: 5f5f 6e61 6d65 5f5f 0a20 2020 2020 2020  __name__.       
-00010150: 2020 2020 2020 2020 2020 2020 206c 656e               len
-00010160: 6774 6820 3d20 300a 0a20 2020 2020 2020  gth = 0..       
-00010170: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00010180: 6365 6c6c 5f74 7970 6520 696e 2028 2753  cell_type in ('S
-00010190: 7472 696e 6727 2c20 2752 6963 6853 7472  tring', 'RichStr
-000101a0: 696e 6727 293a 0a20 2020 2020 2020 2020  ing'):.         
-000101b0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-000101c0: 2048 616e 646c 6520 7374 7269 6e67 7320   Handle strings 
-000101d0: 616e 6420 7269 6368 2073 7472 696e 6773  and rich strings
-000101e0: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000101f0: 2020 2020 2020 2020 2020 230a 2020 2020            #.    
-00010200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010210: 2020 2020 2320 466f 7220 7374 616e 6461      # For standa
-00010220: 7264 2073 6861 7265 6420 7374 7269 6e67  rd shared string
-00010230: 7320 7765 2064 6f20 6120 7265 7665 7273  s we do a revers
-00010240: 6520 6c6f 6f6b 7570 0a20 2020 2020 2020  e lookup.       
-00010250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010260: 2023 2066 726f 6d20 7468 6520 7368 6172   # from the shar
-00010270: 6564 2073 7472 696e 6720 6964 2074 6f20  ed string id to 
-00010280: 7468 6520 6163 7475 616c 2073 7472 696e  the actual strin
-00010290: 672e 2046 6f72 0a20 2020 2020 2020 2020  g. For.         
-000102a0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-000102b0: 2072 6963 6820 7374 7269 6e67 7320 7765   rich strings we
-000102c0: 2075 7365 2074 6865 2075 6e66 6f72 6d61   use the unforma
-000102d0: 7474 6564 2073 7472 696e 672e 2057 6520  tted string. We 
-000102e0: 616c 736f 0a20 2020 2020 2020 2020 2020  also.           
-000102f0: 2020 2020 2020 2020 2020 2020 2023 2073               # s
-00010300: 706c 6974 206d 756c 7469 2d6c 696e 6520  plit multi-line 
-00010310: 7374 7269 6e67 7320 616e 6420 6861 6e64  strings and hand
-00010320: 6c65 2065 6163 6820 7061 7274 0a20 2020  le each part.   
-00010330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010340: 2020 2020 2023 2073 6570 6172 6174 656c       # separatel
-00010350: 792e 0a20 2020 2020 2020 2020 2020 2020  y..             
-00010360: 2020 2020 2020 2020 2020 2069 6620 6365             if ce
-00010370: 6c6c 5f74 7970 6520 3d3d 2027 5374 7269  ll_type == 'Stri
-00010380: 6e67 273a 0a20 2020 2020 2020 2020 2020  ng':.           
-00010390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000103a0: 2073 7472 696e 675f 6964 203d 2063 656c   string_id = cel
-000103b0: 6c2e 7374 7269 6e67 0a20 2020 2020 2020  l.string.       
+0000bb70: 2077 6172 6e28 0a20 2020 2020 2020 2020   warn(.         
+0000bb80: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0000bb90: 4578 6365 6c20 646f 6573 6e27 7420 616c  Excel doesn't al
+0000bba0: 6c6f 7720 3220 636f 6e73 6563 7574 6976  low 2 consecutiv
+0000bbb0: 6520 666f 726d 6174 7320 696e 2072 6963  e formats in ric
+0000bbc0: 6820 220a 2020 2020 2020 2020 2020 2020  h ".            
+0000bbd0: 2020 2020 2020 2020 2020 2020 2273 7472              "str
+0000bbe0: 696e 6773 2e20 4967 6e6f 7269 6e67 2069  ings. Ignoring i
+0000bbf0: 6e70 7574 2069 6e20 7772 6974 655f 7269  nput in write_ri
+0000bc00: 6368 5f73 7472 696e 6728 292e 220a 2020  ch_string().".  
+0000bc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bc20: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0000bc30: 2020 2020 2020 2020 7265 7475 726e 202d          return -
+0000bc40: 330a 0a20 2020 2020 2020 2020 2020 2020  3..             
+0000bc50: 2020 2023 2054 6f6b 656e 2069 7320 6120     # Token is a 
+0000bc60: 666f 726d 6174 206f 626a 6563 742e 2041  format object. A
+0000bc70: 6464 2069 7420 746f 2074 6865 2066 7261  dd it to the fra
+0000bc80: 676d 656e 7420 6c69 7374 2e0a 2020 2020  gment list..    
+0000bc90: 2020 2020 2020 2020 2020 2020 6672 6167              frag
+0000bca0: 6d65 6e74 732e 6170 7065 6e64 2874 6f6b  ments.append(tok
+0000bcb0: 656e 290a 2020 2020 2020 2020 2020 2020  en).            
+0000bcc0: 2020 2020 7072 6576 696f 7573 203d 2022      previous = "
+0000bcd0: 666f 726d 6174 220a 0a20 2020 2020 2020  format"..       
+0000bce0: 2020 2020 2070 6f73 202b 3d20 310a 0a20       pos += 1.. 
+0000bcf0: 2020 2020 2020 2023 2049 6620 7468 6520         # If the 
+0000bd00: 6669 7273 7420 746f 6b65 6e20 6973 2061  first token is a
+0000bd10: 2073 7472 696e 6720 7374 6172 7420 7468   string start th
+0000bd20: 6520 3c72 3e20 656c 656d 656e 742e 0a20  e <r> element.. 
+0000bd30: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
+0000bd40: 696e 7374 616e 6365 2866 7261 676d 656e  instance(fragmen
+0000bd50: 7473 5b30 5d2c 2046 6f72 6d61 7429 3a0a  ts[0], Format):.
+0000bd60: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000bd70: 2e72 7374 7269 6e67 2e5f 786d 6c5f 7374  .rstring._xml_st
+0000bd80: 6172 745f 7461 6728 2272 2229 0a0a 2020  art_tag("r")..  
+0000bd90: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
+0000bda0: 6520 584d 4c20 656c 656d 656e 7473 2066  e XML elements f
+0000bdb0: 6f72 2074 6865 2024 666f 726d 6174 2024  or the $format $
+0000bdc0: 7374 7269 6e67 2066 7261 676d 656e 7473  string fragments
+0000bdd0: 2e0a 2020 2020 2020 2020 666f 7220 746f  ..        for to
+0000bde0: 6b65 6e20 696e 2066 7261 676d 656e 7473  ken in fragments
+0000bdf0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0000be00: 2069 7369 6e73 7461 6e63 6528 746f 6b65   isinstance(toke
+0000be10: 6e2c 2046 6f72 6d61 7429 3a0a 2020 2020  n, Format):.    
+0000be20: 2020 2020 2020 2020 2020 2020 2320 5772              # Wr
+0000be30: 6974 6520 7468 6520 666f 6e74 2072 756e  ite the font run
+0000be40: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000be50: 2020 7365 6c66 2e72 7374 7269 6e67 2e5f    self.rstring._
+0000be60: 786d 6c5f 7374 6172 745f 7461 6728 2272  xml_start_tag("r
+0000be70: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+0000be80: 2020 2073 656c 662e 5f77 7269 7465 5f66     self._write_f
+0000be90: 6f6e 7428 746f 6b65 6e29 0a20 2020 2020  ont(token).     
+0000bea0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0000beb0: 2020 2020 2020 2020 2020 2020 2023 2057               # W
+0000bec0: 7269 7465 2074 6865 2073 7472 696e 6720  rite the string 
+0000bed0: 6672 6167 6d65 6e74 2070 6172 742c 2077  fragment part, w
+0000bee0: 6974 6820 7768 6974 6573 7061 6365 2068  ith whitespace h
+0000bef0: 616e 646c 696e 672e 0a20 2020 2020 2020  andling..       
+0000bf00: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+0000bf10: 7465 7320 3d20 5b5d 0a0a 2020 2020 2020  tes = []..      
+0000bf20: 2020 2020 2020 2020 2020 6966 2070 7265            if pre
+0000bf30: 7365 7276 655f 7768 6974 6573 7061 6365  serve_whitespace
+0000bf40: 2874 6f6b 656e 293a 0a20 2020 2020 2020  (token):.       
+0000bf50: 2020 2020 2020 2020 2020 2020 2061 7474               att
+0000bf60: 7269 6275 7465 732e 6170 7065 6e64 2828  ributes.append((
+0000bf70: 2278 6d6c 3a73 7061 6365 222c 2022 7072  "xml:space", "pr
+0000bf80: 6573 6572 7665 2229 290a 0a20 2020 2020  eserve"))..     
+0000bf90: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000bfa0: 7273 7472 696e 672e 5f78 6d6c 5f64 6174  rstring._xml_dat
+0000bfb0: 615f 656c 656d 656e 7428 2274 222c 2074  a_element("t", t
+0000bfc0: 6f6b 656e 2c20 6174 7472 6962 7574 6573  oken, attributes
+0000bfd0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000bfe0: 2020 7365 6c66 2e72 7374 7269 6e67 2e5f    self.rstring._
+0000bff0: 786d 6c5f 656e 645f 7461 6728 2272 2229  xml_end_tag("r")
+0000c000: 0a0a 2020 2020 2020 2020 2320 5265 6164  ..        # Read
+0000c010: 2074 6865 2069 6e2d 6d65 6d6f 7279 2073   the in-memory s
+0000c020: 7472 696e 672e 0a20 2020 2020 2020 2073  tring..        s
+0000c030: 7472 696e 6720 3d20 7365 6c66 2e72 7374  tring = self.rst
+0000c040: 7269 6e67 2e66 682e 6765 7476 616c 7565  ring.fh.getvalue
+0000c050: 2829 0a0a 2020 2020 2020 2020 2320 4368  ()..        # Ch
+0000c060: 6563 6b20 7468 6174 2074 6865 2073 7472  eck that the str
+0000c070: 696e 6720 6973 203c 2033 3237 3637 2063  ing is < 32767 c
+0000c080: 6861 7273 2e0a 2020 2020 2020 2020 6966  hars..        if
+0000c090: 206c 656e 2872 6177 5f73 7472 696e 6729   len(raw_string)
+0000c0a0: 203e 2073 656c 662e 786c 735f 7374 726d   > self.xls_strm
+0000c0b0: 6178 3a0a 2020 2020 2020 2020 2020 2020  ax:.            
+0000c0c0: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
+0000c0d0: 2020 2020 2020 2253 7472 696e 6720 6c65        "String le
+0000c0e0: 6e67 7468 206d 7573 7420 6265 206c 6573  ngth must be les
+0000c0f0: 7320 7468 616e 206f 7220 6571 7561 6c20  s than or equal 
+0000c100: 746f 2045 7863 656c 2773 206c 696d 6974  to Excel's limit
+0000c110: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+0000c120: 2020 2022 6f66 2033 322c 3736 3720 6368     "of 32,767 ch
+0000c130: 6172 6163 7465 7273 2069 6e20 7772 6974  aracters in writ
+0000c140: 655f 7269 6368 5f73 7472 696e 6728 292e  e_rich_string().
+0000c150: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+0000c160: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000c170: 726e 202d 320a 0a20 2020 2020 2020 2023  rn -2..        #
+0000c180: 2057 7269 7465 2061 2073 6861 7265 6420   Write a shared 
+0000c190: 7374 7269 6e67 206f 7220 616e 2069 6e2d  string or an in-
+0000c1a0: 6c69 6e65 2073 7472 696e 6720 696e 2063  line string in c
+0000c1b0: 6f6e 7374 616e 745f 6d65 6d6f 7279 206d  onstant_memory m
+0000c1c0: 6f64 652e 0a20 2020 2020 2020 2069 6620  ode..        if 
+0000c1d0: 6e6f 7420 7365 6c66 2e63 6f6e 7374 616e  not self.constan
+0000c1e0: 745f 6d65 6d6f 7279 3a0a 2020 2020 2020  t_memory:.      
+0000c1f0: 2020 2020 2020 7374 7269 6e67 5f69 6e64        string_ind
+0000c200: 6578 203d 2073 656c 662e 7374 725f 7461  ex = self.str_ta
+0000c210: 626c 652e 5f67 6574 5f73 6861 7265 645f  ble._get_shared_
+0000c220: 7374 7269 6e67 5f69 6e64 6578 2873 7472  string_index(str
+0000c230: 696e 6729 0a20 2020 2020 2020 2065 6c73  ing).        els
+0000c240: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+0000c250: 7472 696e 675f 696e 6465 7820 3d20 7374  tring_index = st
+0000c260: 7269 6e67 0a0a 2020 2020 2020 2020 2320  ring..        # 
+0000c270: 5772 6974 6520 7072 6576 696f 7573 2072  Write previous r
+0000c280: 6f77 2069 6620 696e 2069 6e2d 6c69 6e65  ow if in in-line
+0000c290: 2073 7472 696e 6720 636f 6e73 7461 6e74   string constant
+0000c2a0: 5f6d 656d 6f72 7920 6d6f 6465 2e0a 2020  _memory mode..  
+0000c2b0: 2020 2020 2020 6966 2073 656c 662e 636f        if self.co
+0000c2c0: 6e73 7461 6e74 5f6d 656d 6f72 7920 616e  nstant_memory an
+0000c2d0: 6420 726f 7720 3e20 7365 6c66 2e70 7265  d row > self.pre
+0000c2e0: 7669 6f75 735f 726f 773a 0a20 2020 2020  vious_row:.     
+0000c2f0: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
+0000c300: 7465 5f73 696e 676c 655f 726f 7728 726f  te_single_row(ro
+0000c310: 7729 0a0a 2020 2020 2020 2020 2320 5374  w)..        # St
+0000c320: 6f72 6520 7468 6520 6365 6c6c 2064 6174  ore the cell dat
+0000c330: 6120 696e 2074 6865 2077 6f72 6b73 6865  a in the workshe
+0000c340: 6574 2064 6174 6120 7461 626c 652e 0a20  et data table.. 
+0000c350: 2020 2020 2020 2073 656c 662e 7461 626c         self.tabl
+0000c360: 655b 726f 775d 5b63 6f6c 5d20 3d20 6365  e[row][col] = ce
+0000c370: 6c6c 5f72 6963 685f 7374 7269 6e67 5f74  ll_rich_string_t
+0000c380: 7570 6c65 280a 2020 2020 2020 2020 2020  uple(.          
+0000c390: 2020 7374 7269 6e67 5f69 6e64 6578 2c20    string_index, 
+0000c3a0: 6365 6c6c 5f66 6f72 6d61 742c 2072 6177  cell_format, raw
+0000c3b0: 5f73 7472 696e 670a 2020 2020 2020 2020  _string.        
+0000c3c0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+0000c3d0: 6e20 300a 0a20 2020 2064 6566 2061 6464  n 0..    def add
+0000c3e0: 5f77 7269 7465 5f68 616e 646c 6572 2873  _write_handler(s
+0000c3f0: 656c 662c 2075 7365 725f 7479 7065 2c20  elf, user_type, 
+0000c400: 7573 6572 5f66 756e 6374 696f 6e29 3a0a  user_function):.
+0000c410: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000c420: 2020 2020 4164 6420 6120 6361 6c6c 6261      Add a callba
+0000c430: 636b 2066 756e 6374 696f 6e20 746f 2074  ck function to t
+0000c440: 6865 2077 7269 7465 2829 206d 6574 686f  he write() metho
+0000c450: 6420 746f 2068 616e 646c 6520 7573 6572  d to handle user
+0000c460: 2064 6566 696e 6564 0a20 2020 2020 2020   defined.       
+0000c470: 2074 7970 6573 2e0a 0a20 2020 2020 2020   types...       
+0000c480: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
+0000c490: 2020 2075 7365 725f 7479 7065 3a20 2020     user_type:   
+0000c4a0: 2020 2054 6865 2075 7365 7220 7479 7065     The user type
+0000c4b0: 2829 2074 6f20 6d61 7463 6820 6f6e 2e0a  () to match on..
+0000c4c0: 2020 2020 2020 2020 2020 2020 7573 6572              user
+0000c4d0: 5f66 756e 6374 696f 6e3a 2020 5468 6520  _function:  The 
+0000c4e0: 7573 6572 2064 6566 696e 6564 2066 756e  user defined fun
+0000c4f0: 6374 696f 6e20 746f 2077 7269 7465 2074  ction to write t
+0000c500: 6865 2074 7970 6520 6461 7461 2e0a 2020  he type data..  
+0000c510: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
+0000c520: 2020 2020 2020 2020 2020 204e 6f74 6869             Nothi
+0000c530: 6e67 2e0a 0a20 2020 2020 2020 2022 2222  ng...        """
+0000c540: 0a0a 2020 2020 2020 2020 7365 6c66 2e77  ..        self.w
+0000c550: 7269 7465 5f68 616e 646c 6572 735b 7573  rite_handlers[us
+0000c560: 6572 5f74 7970 655d 203d 2075 7365 725f  er_type] = user_
+0000c570: 6675 6e63 7469 6f6e 0a0a 2020 2020 4063  function..    @c
+0000c580: 6f6e 7665 7274 5f63 656c 6c5f 6172 6773  onvert_cell_args
+0000c590: 0a20 2020 2064 6566 2077 7269 7465 5f72  .    def write_r
+0000c5a0: 6f77 2873 656c 662c 2072 6f77 2c20 636f  ow(self, row, co
+0000c5b0: 6c2c 2064 6174 612c 2063 656c 6c5f 666f  l, data, cell_fo
+0000c5c0: 726d 6174 3d4e 6f6e 6529 3a0a 2020 2020  rmat=None):.    
+0000c5d0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0000c5e0: 5772 6974 6520 6120 726f 7720 6f66 2064  Write a row of d
+0000c5f0: 6174 6120 7374 6172 7469 6e67 2066 726f  ata starting fro
+0000c600: 6d20 2872 6f77 2c20 636f 6c29 2e0a 0a20  m (row, col)... 
+0000c610: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
+0000c620: 2020 2020 2020 2020 2072 6f77 3a20 2020           row:   
+0000c630: 2054 6865 2063 656c 6c20 726f 7720 287a   The cell row (z
+0000c640: 6572 6f20 696e 6465 7865 6429 2e0a 2020  ero indexed)..  
+0000c650: 2020 2020 2020 2020 2020 636f 6c3a 2020            col:  
+0000c660: 2020 5468 6520 6365 6c6c 2063 6f6c 756d    The cell colum
+0000c670: 6e20 287a 6572 6f20 696e 6465 7865 6429  n (zero indexed)
+0000c680: 2e0a 2020 2020 2020 2020 2020 2020 6461  ..            da
+0000c690: 7461 3a20 2020 4120 6c69 7374 206f 6620  ta:   A list of 
+0000c6a0: 746f 6b65 6e73 2074 6f20 6265 2077 7269  tokens to be wri
+0000c6b0: 7474 656e 2077 6974 6820 7772 6974 6528  tten with write(
+0000c6c0: 292e 0a20 2020 2020 2020 2020 2020 2066  )..            f
+0000c6d0: 6f72 6d61 743a 2041 6e20 6f70 7469 6f6e  ormat: An option
+0000c6e0: 616c 2063 656c 6c20 466f 726d 6174 206f  al cell Format o
+0000c6f0: 626a 6563 742e 0a20 2020 2020 2020 2052  bject..        R
+0000c700: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
+0000c710: 2020 2020 303a 2020 5375 6363 6573 732e      0:  Success.
+0000c720: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
+0000c730: 6572 3a20 5265 7475 726e 2076 616c 7565  er: Return value
+0000c740: 206f 6620 7772 6974 6528 2920 6d65 7468   of write() meth
+0000c750: 6f64 2e0a 0a20 2020 2020 2020 2022 2222  od...        """
+0000c760: 0a20 2020 2020 2020 2066 6f72 2074 6f6b  .        for tok
+0000c770: 656e 2069 6e20 6461 7461 3a0a 2020 2020  en in data:.    
+0000c780: 2020 2020 2020 2020 6572 726f 7220 3d20          error = 
+0000c790: 7365 6c66 2e5f 7772 6974 6528 726f 772c  self._write(row,
+0000c7a0: 2063 6f6c 2c20 746f 6b65 6e2c 2063 656c   col, token, cel
+0000c7b0: 6c5f 666f 726d 6174 290a 2020 2020 2020  l_format).      
+0000c7c0: 2020 2020 2020 6966 2065 7272 6f72 3a0a        if error:.
+0000c7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c7e0: 7265 7475 726e 2065 7272 6f72 0a20 2020  return error.   
+0000c7f0: 2020 2020 2020 2020 2063 6f6c 202b 3d20           col += 
+0000c800: 310a 0a20 2020 2020 2020 2072 6574 7572  1..        retur
+0000c810: 6e20 300a 0a20 2020 2040 636f 6e76 6572  n 0..    @conver
+0000c820: 745f 6365 6c6c 5f61 7267 730a 2020 2020  t_cell_args.    
+0000c830: 6465 6620 7772 6974 655f 636f 6c75 6d6e  def write_column
+0000c840: 2873 656c 662c 2072 6f77 2c20 636f 6c2c  (self, row, col,
+0000c850: 2064 6174 612c 2063 656c 6c5f 666f 726d   data, cell_form
+0000c860: 6174 3d4e 6f6e 6529 3a0a 2020 2020 2020  at=None):.      
+0000c870: 2020 2222 220a 2020 2020 2020 2020 5772    """.        Wr
+0000c880: 6974 6520 6120 636f 6c75 6d6e 206f 6620  ite a column of 
+0000c890: 6461 7461 2073 7461 7274 696e 6720 6672  data starting fr
+0000c8a0: 6f6d 2028 726f 772c 2063 6f6c 292e 0a0a  om (row, col)...
+0000c8b0: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
+0000c8c0: 2020 2020 2020 2020 2020 726f 773a 2020            row:  
+0000c8d0: 2020 5468 6520 6365 6c6c 2072 6f77 2028    The cell row (
+0000c8e0: 7a65 726f 2069 6e64 6578 6564 292e 0a20  zero indexed).. 
+0000c8f0: 2020 2020 2020 2020 2020 2063 6f6c 3a20             col: 
+0000c900: 2020 2054 6865 2063 656c 6c20 636f 6c75     The cell colu
+0000c910: 6d6e 2028 7a65 726f 2069 6e64 6578 6564  mn (zero indexed
+0000c920: 292e 0a20 2020 2020 2020 2020 2020 2064  )..            d
+0000c930: 6174 613a 2020 2041 206c 6973 7420 6f66  ata:   A list of
+0000c940: 2074 6f6b 656e 7320 746f 2062 6520 7772   tokens to be wr
+0000c950: 6974 7465 6e20 7769 7468 2077 7269 7465  itten with write
+0000c960: 2829 2e0a 2020 2020 2020 2020 2020 2020  ()..            
+0000c970: 666f 726d 6174 3a20 416e 206f 7074 696f  format: An optio
+0000c980: 6e61 6c20 6365 6c6c 2046 6f72 6d61 7420  nal cell Format 
+0000c990: 6f62 6a65 6374 2e0a 2020 2020 2020 2020  object..        
+0000c9a0: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
+0000c9b0: 2020 2020 2030 3a20 2053 7563 6365 7373       0:  Success
+0000c9c0: 2e0a 2020 2020 2020 2020 2020 2020 6f74  ..            ot
+0000c9d0: 6865 723a 2052 6574 7572 6e20 7661 6c75  her: Return valu
+0000c9e0: 6520 6f66 2077 7269 7465 2829 206d 6574  e of write() met
+0000c9f0: 686f 642e 0a0a 2020 2020 2020 2020 2222  hod...        ""
+0000ca00: 220a 2020 2020 2020 2020 666f 7220 746f  ".        for to
+0000ca10: 6b65 6e20 696e 2064 6174 613a 0a20 2020  ken in data:.   
+0000ca20: 2020 2020 2020 2020 2065 7272 6f72 203d           error =
+0000ca30: 2073 656c 662e 5f77 7269 7465 2872 6f77   self._write(row
+0000ca40: 2c20 636f 6c2c 2074 6f6b 656e 2c20 6365  , col, token, ce
+0000ca50: 6c6c 5f66 6f72 6d61 7429 0a20 2020 2020  ll_format).     
+0000ca60: 2020 2020 2020 2069 6620 6572 726f 723a         if error:
+0000ca70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ca80: 2072 6574 7572 6e20 6572 726f 720a 2020   return error.  
+0000ca90: 2020 2020 2020 2020 2020 726f 7720 2b3d            row +=
+0000caa0: 2031 0a0a 2020 2020 2020 2020 7265 7475   1..        retu
+0000cab0: 726e 2030 0a0a 2020 2020 4063 6f6e 7665  rn 0..    @conve
+0000cac0: 7274 5f63 656c 6c5f 6172 6773 0a20 2020  rt_cell_args.   
+0000cad0: 2064 6566 2069 6e73 6572 745f 696d 6167   def insert_imag
+0000cae0: 6528 7365 6c66 2c20 726f 772c 2063 6f6c  e(self, row, col
+0000caf0: 2c20 6669 6c65 6e61 6d65 2c20 6f70 7469  , filename, opti
+0000cb00: 6f6e 733d 4e6f 6e65 293a 0a20 2020 2020  ons=None):.     
+0000cb10: 2020 2022 2222 0a20 2020 2020 2020 2049     """.        I
+0000cb20: 6e73 6572 7420 616e 2069 6d61 6765 2077  nsert an image w
+0000cb30: 6974 6820 6974 7320 746f 702d 6c65 6674  ith its top-left
+0000cb40: 2063 6f72 6e65 7220 696e 2061 2077 6f72   corner in a wor
+0000cb50: 6b73 6865 6574 2063 656c 6c2e 0a0a 2020  ksheet cell...  
+0000cb60: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
+0000cb70: 2020 2020 2020 2020 726f 773a 2020 2020          row:    
+0000cb80: 2020 5468 6520 6365 6c6c 2072 6f77 2028    The cell row (
+0000cb90: 7a65 726f 2069 6e64 6578 6564 292e 0a20  zero indexed).. 
+0000cba0: 2020 2020 2020 2020 2020 2063 6f6c 3a20             col: 
+0000cbb0: 2020 2020 2054 6865 2063 656c 6c20 636f       The cell co
+0000cbc0: 6c75 6d6e 2028 7a65 726f 2069 6e64 6578  lumn (zero index
+0000cbd0: 6564 292e 0a20 2020 2020 2020 2020 2020  ed)..           
+0000cbe0: 2066 696c 656e 616d 653a 2050 6174 6820   filename: Path 
+0000cbf0: 616e 6420 6669 6c65 6e61 6d65 2066 6f72  and filename for
+0000cc00: 2069 6e20 7375 7070 6f72 7465 6420 666f   in supported fo
+0000cc10: 726d 6174 732e 0a20 2020 2020 2020 2020  rmats..         
+0000cc20: 2020 206f 7074 696f 6e73 3a20 2050 6f73     options:  Pos
+0000cc30: 6974 696f 6e2c 2073 6361 6c65 2c20 7572  ition, scale, ur
+0000cc40: 6c20 616e 6420 6461 7461 2073 7472 6561  l and data strea
+0000cc50: 6d20 6f66 2074 6865 2069 6d61 6765 2e0a  m of the image..
+0000cc60: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0000cc70: 3a0a 2020 2020 2020 2020 2020 2020 303a  :.            0:
+0000cc80: 2020 5375 6363 6573 732e 0a20 2020 2020    Success..     
+0000cc90: 2020 2020 2020 202d 313a 2052 6f77 206f         -1: Row o
+0000cca0: 7220 636f 6c75 6d6e 2069 7320 6f75 7420  r column is out 
+0000ccb0: 6f66 2077 6f72 6b73 6865 6574 2062 6f75  of worksheet bou
+0000ccc0: 6e64 732e 0a0a 2020 2020 2020 2020 2222  nds...        ""
+0000ccd0: 220a 2020 2020 2020 2020 2320 4368 6563  ".        # Chec
+0000cce0: 6b20 696e 7365 7274 2028 726f 772c 2063  k insert (row, c
+0000ccf0: 6f6c 2920 7769 7468 6f75 7420 7374 6f72  ol) without stor
+0000cd00: 696e 672e 0a20 2020 2020 2020 2069 6620  ing..        if 
+0000cd10: 7365 6c66 2e5f 6368 6563 6b5f 6469 6d65  self._check_dime
+0000cd20: 6e73 696f 6e73 2872 6f77 2c20 636f 6c2c  nsions(row, col,
+0000cd30: 2054 7275 652c 2054 7275 6529 3a0a 2020   True, True):.  
+0000cd40: 2020 2020 2020 2020 2020 7761 726e 2822            warn("
+0000cd50: 4361 6e6e 6f74 2069 6e73 6572 7420 696d  Cannot insert im
+0000cd60: 6167 6520 6174 2028 2564 2c20 2564 292e  age at (%d, %d).
+0000cd70: 2220 2520 2872 6f77 2c20 636f 6c29 290a  " % (row, col)).
+0000cd80: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000cd90: 726e 202d 310a 0a20 2020 2020 2020 2069  rn -1..        i
+0000cda0: 6620 6f70 7469 6f6e 7320 6973 204e 6f6e  f options is Non
+0000cdb0: 653a 0a20 2020 2020 2020 2020 2020 206f  e:.            o
+0000cdc0: 7074 696f 6e73 203d 207b 7d0a 0a20 2020  ptions = {}..   
+0000cdd0: 2020 2020 2078 5f6f 6666 7365 7420 3d20       x_offset = 
+0000cde0: 6f70 7469 6f6e 732e 6765 7428 2278 5f6f  options.get("x_o
+0000cdf0: 6666 7365 7422 2c20 3029 0a20 2020 2020  ffset", 0).     
+0000ce00: 2020 2079 5f6f 6666 7365 7420 3d20 6f70     y_offset = op
+0000ce10: 7469 6f6e 732e 6765 7428 2279 5f6f 6666  tions.get("y_off
+0000ce20: 7365 7422 2c20 3029 0a20 2020 2020 2020  set", 0).       
+0000ce30: 2078 5f73 6361 6c65 203d 206f 7074 696f   x_scale = optio
+0000ce40: 6e73 2e67 6574 2822 785f 7363 616c 6522  ns.get("x_scale"
+0000ce50: 2c20 3129 0a20 2020 2020 2020 2079 5f73  , 1).        y_s
+0000ce60: 6361 6c65 203d 206f 7074 696f 6e73 2e67  cale = options.g
+0000ce70: 6574 2822 795f 7363 616c 6522 2c20 3129  et("y_scale", 1)
+0000ce80: 0a20 2020 2020 2020 2075 726c 203d 206f  .        url = o
+0000ce90: 7074 696f 6e73 2e67 6574 2822 7572 6c22  ptions.get("url"
+0000cea0: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
+0000ceb0: 7469 7020 3d20 6f70 7469 6f6e 732e 6765  tip = options.ge
+0000cec0: 7428 2274 6970 222c 204e 6f6e 6529 0a20  t("tip", None). 
+0000ced0: 2020 2020 2020 2061 6e63 686f 7220 3d20         anchor = 
+0000cee0: 6f70 7469 6f6e 732e 6765 7428 226f 626a  options.get("obj
+0000cef0: 6563 745f 706f 7369 7469 6f6e 222c 2032  ect_position", 2
+0000cf00: 290a 2020 2020 2020 2020 696d 6167 655f  ).        image_
+0000cf10: 6461 7461 203d 206f 7074 696f 6e73 2e67  data = options.g
+0000cf20: 6574 2822 696d 6167 655f 6461 7461 222c  et("image_data",
+0000cf30: 204e 6f6e 6529 0a20 2020 2020 2020 2064   None).        d
+0000cf40: 6573 6372 6970 7469 6f6e 203d 206f 7074  escription = opt
+0000cf50: 696f 6e73 2e67 6574 2822 6465 7363 7269  ions.get("descri
+0000cf60: 7074 696f 6e22 2c20 4e6f 6e65 290a 2020  ption", None).  
+0000cf70: 2020 2020 2020 6465 636f 7261 7469 7665        decorative
+0000cf80: 203d 206f 7074 696f 6e73 2e67 6574 2822   = options.get("
+0000cf90: 6465 636f 7261 7469 7665 222c 2046 616c  decorative", Fal
+0000cfa0: 7365 290a 0a20 2020 2020 2020 2023 2046  se)..        # F
+0000cfb0: 6f72 2062 6163 6b77 6172 6420 636f 6d70  or backward comp
+0000cfc0: 6174 6962 696c 6974 7920 7769 7468 206f  atibility with o
+0000cfd0: 6c64 6572 2070 6172 616d 6574 6572 206e  lder parameter n
+0000cfe0: 616d 652e 0a20 2020 2020 2020 2061 6e63  ame..        anc
+0000cff0: 686f 7220 3d20 6f70 7469 6f6e 732e 6765  hor = options.ge
+0000d000: 7428 2270 6f73 6974 696f 6e69 6e67 222c  t("positioning",
+0000d010: 2061 6e63 686f 7229 0a0a 2020 2020 2020   anchor)..      
+0000d020: 2020 6966 206e 6f74 2069 6d61 6765 5f64    if not image_d
+0000d030: 6174 6120 616e 6420 6e6f 7420 6f73 2e70  ata and not os.p
+0000d040: 6174 682e 6578 6973 7473 2866 696c 656e  ath.exists(filen
+0000d050: 616d 6529 3a0a 2020 2020 2020 2020 2020  ame):.          
+0000d060: 2020 7761 726e 2822 496d 6167 6520 6669    warn("Image fi
+0000d070: 6c65 2027 2573 2720 6e6f 7420 666f 756e  le '%s' not foun
+0000d080: 642e 2220 2520 6669 6c65 6e61 6d65 290a  d." % filename).
+0000d090: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000d0a0: 726e 202d 310a 0a20 2020 2020 2020 2073  rn -1..        s
+0000d0b0: 656c 662e 696d 6167 6573 2e61 7070 656e  elf.images.appen
+0000d0c0: 6428 0a20 2020 2020 2020 2020 2020 205b  d(.            [
+0000d0d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d0e0: 2072 6f77 2c0a 2020 2020 2020 2020 2020   row,.          
+0000d0f0: 2020 2020 2020 636f 6c2c 0a20 2020 2020        col,.     
+0000d100: 2020 2020 2020 2020 2020 2066 696c 656e             filen
+0000d110: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+0000d120: 2020 2020 2078 5f6f 6666 7365 742c 0a20       x_offset,. 
+0000d130: 2020 2020 2020 2020 2020 2020 2020 2079                 y
+0000d140: 5f6f 6666 7365 742c 0a20 2020 2020 2020  _offset,.       
+0000d150: 2020 2020 2020 2020 2078 5f73 6361 6c65           x_scale
+0000d160: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000d170: 2020 795f 7363 616c 652c 0a20 2020 2020    y_scale,.     
+0000d180: 2020 2020 2020 2020 2020 2075 726c 2c0a             url,.
+0000d190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d1a0: 7469 702c 0a20 2020 2020 2020 2020 2020  tip,.           
+0000d1b0: 2020 2020 2061 6e63 686f 722c 0a20 2020       anchor,.   
+0000d1c0: 2020 2020 2020 2020 2020 2020 2069 6d61               ima
+0000d1d0: 6765 5f64 6174 612c 0a20 2020 2020 2020  ge_data,.       
+0000d1e0: 2020 2020 2020 2020 2064 6573 6372 6970           descrip
+0000d1f0: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+0000d200: 2020 2020 2020 6465 636f 7261 7469 7665        decorative
+0000d210: 2c0a 2020 2020 2020 2020 2020 2020 5d0a  ,.            ].
+0000d220: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000d230: 2020 7265 7475 726e 2030 0a0a 2020 2020    return 0..    
+0000d240: 4063 6f6e 7665 7274 5f63 656c 6c5f 6172  @convert_cell_ar
+0000d250: 6773 0a20 2020 2064 6566 2069 6e73 6572  gs.    def inser
+0000d260: 745f 7465 7874 626f 7828 7365 6c66 2c20  t_textbox(self, 
+0000d270: 726f 772c 2063 6f6c 2c20 7465 7874 2c20  row, col, text, 
+0000d280: 6f70 7469 6f6e 733d 4e6f 6e65 293a 0a20  options=None):. 
+0000d290: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000d2a0: 2020 2049 6e73 6572 7420 616e 2074 6578     Insert an tex
+0000d2b0: 7462 6f78 2077 6974 6820 6974 7320 746f  tbox with its to
+0000d2c0: 702d 6c65 6674 2063 6f72 6e65 7220 696e  p-left corner in
+0000d2d0: 2061 2077 6f72 6b73 6865 6574 2063 656c   a worksheet cel
+0000d2e0: 6c2e 0a0a 2020 2020 2020 2020 4172 6773  l...        Args
+0000d2f0: 3a0a 2020 2020 2020 2020 2020 2020 726f  :.            ro
+0000d300: 773a 2020 2020 2020 5468 6520 6365 6c6c  w:      The cell
+0000d310: 2072 6f77 2028 7a65 726f 2069 6e64 6578   row (zero index
+0000d320: 6564 292e 0a20 2020 2020 2020 2020 2020  ed)..           
+0000d330: 2063 6f6c 3a20 2020 2020 2054 6865 2063   col:      The c
+0000d340: 656c 6c20 636f 6c75 6d6e 2028 7a65 726f  ell column (zero
+0000d350: 2069 6e64 6578 6564 292e 0a20 2020 2020   indexed)..     
+0000d360: 2020 2020 2020 2074 6578 743a 2020 2020         text:    
+0000d370: 2054 6865 2074 6578 7420 666f 7220 7468   The text for th
+0000d380: 6520 7465 7874 626f 782e 0a20 2020 2020  e textbox..     
+0000d390: 2020 2020 2020 206f 7074 696f 6e73 3a20         options: 
+0000d3a0: 2054 6578 7462 6f78 206f 7074 696f 6e73   Textbox options
+0000d3b0: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+0000d3c0: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+0000d3d0: 303a 2020 5375 6363 6573 732e 0a20 2020  0:  Success..   
+0000d3e0: 2020 2020 2020 2020 202d 313a 2052 6f77           -1: Row
+0000d3f0: 206f 7220 636f 6c75 6d6e 2069 7320 6f75   or column is ou
+0000d400: 7420 6f66 2077 6f72 6b73 6865 6574 2062  t of worksheet b
+0000d410: 6f75 6e64 732e 0a0a 2020 2020 2020 2020  ounds...        
+0000d420: 2222 220a 2020 2020 2020 2020 2320 4368  """.        # Ch
+0000d430: 6563 6b20 696e 7365 7274 2028 726f 772c  eck insert (row,
+0000d440: 2063 6f6c 2920 7769 7468 6f75 7420 7374   col) without st
+0000d450: 6f72 696e 672e 0a20 2020 2020 2020 2069  oring..        i
+0000d460: 6620 7365 6c66 2e5f 6368 6563 6b5f 6469  f self._check_di
+0000d470: 6d65 6e73 696f 6e73 2872 6f77 2c20 636f  mensions(row, co
+0000d480: 6c2c 2054 7275 652c 2054 7275 6529 3a0a  l, True, True):.
+0000d490: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+0000d4a0: 2822 4361 6e6e 6f74 2069 6e73 6572 7420  ("Cannot insert 
+0000d4b0: 7465 7874 626f 7820 6174 2028 2564 2c20  textbox at (%d, 
+0000d4c0: 2564 292e 2220 2520 2872 6f77 2c20 636f  %d)." % (row, co
+0000d4d0: 6c29 290a 2020 2020 2020 2020 2020 2020  l)).            
+0000d4e0: 7265 7475 726e 202d 310a 0a20 2020 2020  return -1..     
+0000d4f0: 2020 2069 6620 7465 7874 2069 7320 4e6f     if text is No
+0000d500: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0000d510: 7465 7874 203d 2022 220a 0a20 2020 2020  text = ""..     
+0000d520: 2020 2069 6620 6f70 7469 6f6e 7320 6973     if options is
+0000d530: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0000d540: 2020 206f 7074 696f 6e73 203d 207b 7d0a     options = {}.
+0000d550: 0a20 2020 2020 2020 2078 5f6f 6666 7365  .        x_offse
+0000d560: 7420 3d20 6f70 7469 6f6e 732e 6765 7428  t = options.get(
+0000d570: 2278 5f6f 6666 7365 7422 2c20 3029 0a20  "x_offset", 0). 
+0000d580: 2020 2020 2020 2079 5f6f 6666 7365 7420         y_offset 
+0000d590: 3d20 6f70 7469 6f6e 732e 6765 7428 2279  = options.get("y
+0000d5a0: 5f6f 6666 7365 7422 2c20 3029 0a20 2020  _offset", 0).   
+0000d5b0: 2020 2020 2078 5f73 6361 6c65 203d 206f       x_scale = o
+0000d5c0: 7074 696f 6e73 2e67 6574 2822 785f 7363  ptions.get("x_sc
+0000d5d0: 616c 6522 2c20 3129 0a20 2020 2020 2020  ale", 1).       
+0000d5e0: 2079 5f73 6361 6c65 203d 206f 7074 696f   y_scale = optio
+0000d5f0: 6e73 2e67 6574 2822 795f 7363 616c 6522  ns.get("y_scale"
+0000d600: 2c20 3129 0a20 2020 2020 2020 2061 6e63  , 1).        anc
+0000d610: 686f 7220 3d20 6f70 7469 6f6e 732e 6765  hor = options.ge
+0000d620: 7428 226f 626a 6563 745f 706f 7369 7469  t("object_positi
+0000d630: 6f6e 222c 2031 290a 2020 2020 2020 2020  on", 1).        
+0000d640: 6465 7363 7269 7074 696f 6e20 3d20 6f70  description = op
+0000d650: 7469 6f6e 732e 6765 7428 2264 6573 6372  tions.get("descr
+0000d660: 6970 7469 6f6e 222c 204e 6f6e 6529 0a20  iption", None). 
+0000d670: 2020 2020 2020 2064 6563 6f72 6174 6976         decorativ
+0000d680: 6520 3d20 6f70 7469 6f6e 732e 6765 7428  e = options.get(
+0000d690: 2264 6563 6f72 6174 6976 6522 2c20 4661  "decorative", Fa
+0000d6a0: 6c73 6529 0a0a 2020 2020 2020 2020 7365  lse)..        se
+0000d6b0: 6c66 2e73 6861 7065 732e 6170 7065 6e64  lf.shapes.append
+0000d6c0: 280a 2020 2020 2020 2020 2020 2020 5b0a  (.            [.
+0000d6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d6e0: 726f 772c 0a20 2020 2020 2020 2020 2020  row,.           
+0000d6f0: 2020 2020 2063 6f6c 2c0a 2020 2020 2020       col,.      
+0000d700: 2020 2020 2020 2020 2020 785f 6f66 6673            x_offs
+0000d710: 6574 2c0a 2020 2020 2020 2020 2020 2020  et,.            
+0000d720: 2020 2020 795f 6f66 6673 6574 2c0a 2020      y_offset,.  
+0000d730: 2020 2020 2020 2020 2020 2020 2020 785f                x_
+0000d740: 7363 616c 652c 0a20 2020 2020 2020 2020  scale,.         
+0000d750: 2020 2020 2020 2079 5f73 6361 6c65 2c0a         y_scale,.
+0000d760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d770: 7465 7874 2c0a 2020 2020 2020 2020 2020  text,.          
+0000d780: 2020 2020 2020 616e 6368 6f72 2c0a 2020        anchor,.  
+0000d790: 2020 2020 2020 2020 2020 2020 2020 6f70                op
+0000d7a0: 7469 6f6e 732c 0a20 2020 2020 2020 2020  tions,.         
+0000d7b0: 2020 2020 2020 2064 6573 6372 6970 7469         descripti
+0000d7c0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+0000d7d0: 2020 2020 6465 636f 7261 7469 7665 2c0a      decorative,.
+0000d7e0: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+0000d7f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000d800: 7265 7475 726e 2030 0a0a 2020 2020 4063  return 0..    @c
+0000d810: 6f6e 7665 7274 5f63 656c 6c5f 6172 6773  onvert_cell_args
+0000d820: 0a20 2020 2064 6566 2069 6e73 6572 745f  .    def insert_
+0000d830: 6368 6172 7428 7365 6c66 2c20 726f 772c  chart(self, row,
+0000d840: 2063 6f6c 2c20 6368 6172 742c 206f 7074   col, chart, opt
+0000d850: 696f 6e73 3d4e 6f6e 6529 3a0a 2020 2020  ions=None):.    
+0000d860: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0000d870: 496e 7365 7274 2061 6e20 6368 6172 7420  Insert an chart 
+0000d880: 7769 7468 2069 7473 2074 6f70 2d6c 6566  with its top-lef
+0000d890: 7420 636f 726e 6572 2069 6e20 6120 776f  t corner in a wo
+0000d8a0: 726b 7368 6565 7420 6365 6c6c 2e0a 0a20  rksheet cell... 
+0000d8b0: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
+0000d8c0: 2020 2020 2020 2020 2072 6f77 3a20 2020           row:   
+0000d8d0: 2020 5468 6520 6365 6c6c 2072 6f77 2028    The cell row (
+0000d8e0: 7a65 726f 2069 6e64 6578 6564 292e 0a20  zero indexed).. 
+0000d8f0: 2020 2020 2020 2020 2020 2063 6f6c 3a20             col: 
+0000d900: 2020 2020 5468 6520 6365 6c6c 2063 6f6c      The cell col
+0000d910: 756d 6e20 287a 6572 6f20 696e 6465 7865  umn (zero indexe
+0000d920: 6429 2e0a 2020 2020 2020 2020 2020 2020  d)..            
+0000d930: 6368 6172 743a 2020 2043 6861 7274 206f  chart:   Chart o
+0000d940: 626a 6563 742e 0a20 2020 2020 2020 2020  bject..         
+0000d950: 2020 206f 7074 696f 6e73 3a20 506f 7369     options: Posi
+0000d960: 7469 6f6e 2061 6e64 2073 6361 6c65 206f  tion and scale o
+0000d970: 6620 7468 6520 6368 6172 742e 0a0a 2020  f the chart...  
+0000d980: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
+0000d990: 2020 2020 2020 2020 2020 2030 3a20 2053             0:  S
+0000d9a0: 7563 6365 7373 2e0a 2020 2020 2020 2020  uccess..        
+0000d9b0: 2020 2020 2d31 3a20 526f 7720 6f72 2063      -1: Row or c
+0000d9c0: 6f6c 756d 6e20 6973 206f 7574 206f 6620  olumn is out of 
+0000d9d0: 776f 726b 7368 6565 7420 626f 756e 6473  worksheet bounds
+0000d9e0: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
+0000d9f0: 2020 2020 2020 2023 2043 6865 636b 2069         # Check i
+0000da00: 6e73 6572 7420 2872 6f77 2c20 636f 6c29  nsert (row, col)
+0000da10: 2077 6974 686f 7574 2073 746f 7269 6e67   without storing
+0000da20: 2e0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+0000da30: 662e 5f63 6865 636b 5f64 696d 656e 7369  f._check_dimensi
+0000da40: 6f6e 7328 726f 772c 2063 6f6c 2c20 5472  ons(row, col, Tr
+0000da50: 7565 2c20 5472 7565 293a 0a20 2020 2020  ue, True):.     
+0000da60: 2020 2020 2020 2077 6172 6e28 2243 616e         warn("Can
+0000da70: 6e6f 7420 696e 7365 7274 2063 6861 7274  not insert chart
+0000da80: 2061 7420 2825 642c 2025 6429 2e22 2025   at (%d, %d)." %
+0000da90: 2028 726f 772c 2063 6f6c 2929 0a20 2020   (row, col)).   
+0000daa0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000dab0: 2d31 0a0a 2020 2020 2020 2020 6966 206f  -1..        if o
+0000dac0: 7074 696f 6e73 2069 7320 4e6f 6e65 3a0a  ptions is None:.
+0000dad0: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
+0000dae0: 6f6e 7320 3d20 7b7d 0a0a 2020 2020 2020  ons = {}..      
+0000daf0: 2020 2320 456e 7375 7265 2061 2063 6861    # Ensure a cha
+0000db00: 7274 2069 736e 2774 2069 6e73 6572 7465  rt isn't inserte
+0000db10: 6420 6d6f 7265 2074 6861 6e20 6f6e 6365  d more than once
+0000db20: 2e0a 2020 2020 2020 2020 6966 2063 6861  ..        if cha
+0000db30: 7274 2e61 6c72 6561 6479 5f69 6e73 6572  rt.already_inser
+0000db40: 7465 6420 6f72 2063 6861 7274 2e63 6f6d  ted or chart.com
+0000db50: 6269 6e65 6420 616e 6420 6368 6172 742e  bined and chart.
+0000db60: 636f 6d62 696e 6564 2e61 6c72 6561 6479  combined.already
+0000db70: 5f69 6e73 6572 7465 643a 0a20 2020 2020  _inserted:.     
+0000db80: 2020 2020 2020 2077 6172 6e28 2243 6861         warn("Cha
+0000db90: 7274 2063 616e 6e6f 7420 6265 2069 6e73  rt cannot be ins
+0000dba0: 6572 7465 6420 696e 2061 2077 6f72 6b73  erted in a works
+0000dbb0: 6865 6574 206d 6f72 6520 7468 616e 206f  heet more than o
+0000dbc0: 6e63 652e 2229 0a20 2020 2020 2020 2020  nce.").         
+0000dbd0: 2020 2072 6574 7572 6e0a 2020 2020 2020     return.      
+0000dbe0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0000dbf0: 2020 2020 6368 6172 742e 616c 7265 6164      chart.alread
+0000dc00: 795f 696e 7365 7274 6564 203d 2054 7275  y_inserted = Tru
+0000dc10: 650a 0a20 2020 2020 2020 2020 2020 2069  e..            i
+0000dc20: 6620 6368 6172 742e 636f 6d62 696e 6564  f chart.combined
+0000dc30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000dc40: 2020 6368 6172 742e 636f 6d62 696e 6564    chart.combined
+0000dc50: 2e61 6c72 6561 6479 5f69 6e73 6572 7465  .already_inserte
+0000dc60: 6420 3d20 5472 7565 0a0a 2020 2020 2020  d = True..      
+0000dc70: 2020 785f 6f66 6673 6574 203d 206f 7074    x_offset = opt
+0000dc80: 696f 6e73 2e67 6574 2822 785f 6f66 6673  ions.get("x_offs
+0000dc90: 6574 222c 2030 290a 2020 2020 2020 2020  et", 0).        
+0000dca0: 795f 6f66 6673 6574 203d 206f 7074 696f  y_offset = optio
+0000dcb0: 6e73 2e67 6574 2822 795f 6f66 6673 6574  ns.get("y_offset
+0000dcc0: 222c 2030 290a 2020 2020 2020 2020 785f  ", 0).        x_
+0000dcd0: 7363 616c 6520 3d20 6f70 7469 6f6e 732e  scale = options.
+0000dce0: 6765 7428 2278 5f73 6361 6c65 222c 2031  get("x_scale", 1
+0000dcf0: 290a 2020 2020 2020 2020 795f 7363 616c  ).        y_scal
+0000dd00: 6520 3d20 6f70 7469 6f6e 732e 6765 7428  e = options.get(
+0000dd10: 2279 5f73 6361 6c65 222c 2031 290a 2020  "y_scale", 1).  
+0000dd20: 2020 2020 2020 616e 6368 6f72 203d 206f        anchor = o
+0000dd30: 7074 696f 6e73 2e67 6574 2822 6f62 6a65  ptions.get("obje
+0000dd40: 6374 5f70 6f73 6974 696f 6e22 2c20 3129  ct_position", 1)
+0000dd50: 0a20 2020 2020 2020 2064 6573 6372 6970  .        descrip
+0000dd60: 7469 6f6e 203d 206f 7074 696f 6e73 2e67  tion = options.g
+0000dd70: 6574 2822 6465 7363 7269 7074 696f 6e22  et("description"
+0000dd80: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
+0000dd90: 6465 636f 7261 7469 7665 203d 206f 7074  decorative = opt
+0000dda0: 696f 6e73 2e67 6574 2822 6465 636f 7261  ions.get("decora
+0000ddb0: 7469 7665 222c 2046 616c 7365 290a 0a20  tive", False).. 
+0000ddc0: 2020 2020 2020 2023 2041 6c6c 6f77 2043         # Allow C
+0000ddd0: 6861 7274 2074 6f20 6f76 6572 7269 6465  hart to override
+0000dde0: 2074 6865 2073 6361 6c65 2061 6e64 206f   the scale and o
+0000ddf0: 6666 7365 742e 0a20 2020 2020 2020 2069  ffset..        i
+0000de00: 6620 6368 6172 742e 785f 7363 616c 6520  f chart.x_scale 
+0000de10: 213d 2031 3a0a 2020 2020 2020 2020 2020  != 1:.          
+0000de20: 2020 785f 7363 616c 6520 3d20 6368 6172    x_scale = char
+0000de30: 742e 785f 7363 616c 650a 0a20 2020 2020  t.x_scale..     
+0000de40: 2020 2069 6620 6368 6172 742e 795f 7363     if chart.y_sc
+0000de50: 616c 6520 213d 2031 3a0a 2020 2020 2020  ale != 1:.      
+0000de60: 2020 2020 2020 795f 7363 616c 6520 3d20        y_scale = 
+0000de70: 6368 6172 742e 795f 7363 616c 650a 0a20  chart.y_scale.. 
+0000de80: 2020 2020 2020 2069 6620 6368 6172 742e         if chart.
+0000de90: 785f 6f66 6673 6574 3a0a 2020 2020 2020  x_offset:.      
+0000dea0: 2020 2020 2020 785f 6f66 6673 6574 203d        x_offset =
+0000deb0: 2063 6861 7274 2e78 5f6f 6666 7365 740a   chart.x_offset.
+0000dec0: 0a20 2020 2020 2020 2069 6620 6368 6172  .        if char
+0000ded0: 742e 795f 6f66 6673 6574 3a0a 2020 2020  t.y_offset:.    
+0000dee0: 2020 2020 2020 2020 795f 6f66 6673 6574          y_offset
+0000def0: 203d 2063 6861 7274 2e79 5f6f 6666 7365   = chart.y_offse
+0000df00: 740a 0a20 2020 2020 2020 2073 656c 662e  t..        self.
+0000df10: 6368 6172 7473 2e61 7070 656e 6428 0a20  charts.append(. 
+0000df20: 2020 2020 2020 2020 2020 205b 0a20 2020             [.   
+0000df30: 2020 2020 2020 2020 2020 2020 2072 6f77               row
+0000df40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000df50: 2020 636f 6c2c 0a20 2020 2020 2020 2020    col,.         
+0000df60: 2020 2020 2020 2063 6861 7274 2c0a 2020         chart,.  
+0000df70: 2020 2020 2020 2020 2020 2020 2020 785f                x_
+0000df80: 6f66 6673 6574 2c0a 2020 2020 2020 2020  offset,.        
+0000df90: 2020 2020 2020 2020 795f 6f66 6673 6574          y_offset
+0000dfa0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000dfb0: 2020 785f 7363 616c 652c 0a20 2020 2020    x_scale,.     
+0000dfc0: 2020 2020 2020 2020 2020 2079 5f73 6361             y_sca
+0000dfd0: 6c65 2c0a 2020 2020 2020 2020 2020 2020  le,.            
+0000dfe0: 2020 2020 616e 6368 6f72 2c0a 2020 2020      anchor,.    
+0000dff0: 2020 2020 2020 2020 2020 2020 6465 7363              desc
+0000e000: 7269 7074 696f 6e2c 0a20 2020 2020 2020  ription,.       
+0000e010: 2020 2020 2020 2020 2064 6563 6f72 6174           decorat
+0000e020: 6976 652c 0a20 2020 2020 2020 2020 2020  ive,.           
+0000e030: 205d 0a20 2020 2020 2020 2029 0a20 2020   ].        ).   
+0000e040: 2020 2020 2072 6574 7572 6e20 300a 0a20       return 0.. 
+0000e050: 2020 2040 636f 6e76 6572 745f 6365 6c6c     @convert_cell
+0000e060: 5f61 7267 730a 2020 2020 6465 6620 7772  _args.    def wr
+0000e070: 6974 655f 636f 6d6d 656e 7428 7365 6c66  ite_comment(self
+0000e080: 2c20 726f 772c 2063 6f6c 2c20 636f 6d6d  , row, col, comm
+0000e090: 656e 742c 206f 7074 696f 6e73 3d4e 6f6e  ent, options=Non
+0000e0a0: 6529 3a0a 2020 2020 2020 2020 2222 220a  e):.        """.
+0000e0b0: 2020 2020 2020 2020 5772 6974 6520 6120          Write a 
+0000e0c0: 636f 6d6d 656e 7420 746f 2061 2077 6f72  comment to a wor
+0000e0d0: 6b73 6865 6574 2063 656c 6c2e 0a0a 2020  ksheet cell...  
+0000e0e0: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
+0000e0f0: 2020 2020 2020 2020 726f 773a 2020 2020          row:    
+0000e100: 2054 6865 2063 656c 6c20 726f 7720 287a   The cell row (z
+0000e110: 6572 6f20 696e 6465 7865 6429 2e0a 2020  ero indexed)..  
+0000e120: 2020 2020 2020 2020 2020 636f 6c3a 2020            col:  
+0000e130: 2020 2054 6865 2063 656c 6c20 636f 6c75     The cell colu
+0000e140: 6d6e 2028 7a65 726f 2069 6e64 6578 6564  mn (zero indexed
+0000e150: 292e 0a20 2020 2020 2020 2020 2020 2063  )..            c
+0000e160: 6f6d 6d65 6e74 3a20 4365 6c6c 2063 6f6d  omment: Cell com
+0000e170: 6d65 6e74 2e20 5374 722e 0a20 2020 2020  ment. Str..     
+0000e180: 2020 2020 2020 206f 7074 696f 6e73 3a20         options: 
+0000e190: 436f 6d6d 656e 7420 666f 726d 6174 7469  Comment formatti
+0000e1a0: 6e67 206f 7074 696f 6e73 2e0a 0a20 2020  ng options...   
+0000e1b0: 2020 2020 2052 6574 7572 6e73 3a0a 2020       Returns:.  
+0000e1c0: 2020 2020 2020 2020 2020 303a 2020 5375            0:  Su
+0000e1d0: 6363 6573 732e 0a20 2020 2020 2020 2020  ccess..         
+0000e1e0: 2020 202d 313a 2052 6f77 206f 7220 636f     -1: Row or co
+0000e1f0: 6c75 6d6e 2069 7320 6f75 7420 6f66 2077  lumn is out of w
+0000e200: 6f72 6b73 6865 6574 2062 6f75 6e64 732e  orksheet bounds.
+0000e210: 0a20 2020 2020 2020 2020 2020 202d 323a  .            -2:
+0000e220: 2053 7472 696e 6720 6c6f 6e67 6572 2074   String longer t
+0000e230: 6861 6e20 3332 6b20 6368 6172 6163 7465  han 32k characte
+0000e240: 7273 2e0a 0a20 2020 2020 2020 2022 2222  rs...        """
+0000e250: 0a20 2020 2020 2020 2069 6620 6f70 7469  .        if opti
+0000e260: 6f6e 7320 6973 204e 6f6e 653a 0a20 2020  ons is None:.   
+0000e270: 2020 2020 2020 2020 206f 7074 696f 6e73           options
+0000e280: 203d 207b 7d0a 0a20 2020 2020 2020 2023   = {}..        #
+0000e290: 2043 6865 636b 2074 6861 7420 726f 7720   Check that row 
+0000e2a0: 616e 6420 636f 6c20 6172 6520 7661 6c69  and col are vali
+0000e2b0: 6420 616e 6420 7374 6f72 6520 6d61 7820  d and store max 
+0000e2c0: 616e 6420 6d69 6e20 7661 6c75 6573 0a20  and min values. 
+0000e2d0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+0000e2e0: 6368 6563 6b5f 6469 6d65 6e73 696f 6e73  check_dimensions
+0000e2f0: 2872 6f77 2c20 636f 6c29 3a0a 2020 2020  (row, col):.    
+0000e300: 2020 2020 2020 2020 7265 7475 726e 202d          return -
+0000e310: 310a 0a20 2020 2020 2020 2023 2043 6865  1..        # Che
+0000e320: 636b 2074 6861 7420 7468 6520 636f 6d6d  ck that the comm
+0000e330: 656e 7420 7374 7269 6e67 2069 7320 3c20  ent string is < 
+0000e340: 3332 3736 3720 6368 6172 732e 0a20 2020  32767 chars..   
+0000e350: 2020 2020 2069 6620 6c65 6e28 636f 6d6d       if len(comm
+0000e360: 656e 7429 203e 2073 656c 662e 786c 735f  ent) > self.xls_
+0000e370: 7374 726d 6178 3a0a 2020 2020 2020 2020  strmax:.        
+0000e380: 2020 2020 7265 7475 726e 202d 320a 0a20      return -2.. 
+0000e390: 2020 2020 2020 2073 656c 662e 6861 735f         self.has_
+0000e3a0: 766d 6c20 3d20 310a 2020 2020 2020 2020  vml = 1.        
+0000e3b0: 7365 6c66 2e68 6173 5f63 6f6d 6d65 6e74  self.has_comment
+0000e3c0: 7320 3d20 310a 0a20 2020 2020 2020 2023  s = 1..        #
+0000e3d0: 2053 746f 7265 2074 6865 206f 7074 696f   Store the optio
+0000e3e0: 6e73 206f 6620 7468 6520 6365 6c6c 2063  ns of the cell c
+0000e3f0: 6f6d 6d65 6e74 2c20 746f 2070 726f 6365  omment, to proce
+0000e400: 7373 206f 6e20 6669 6c65 2063 6c6f 7365  ss on file close
+0000e410: 2e0a 2020 2020 2020 2020 7365 6c66 2e63  ..        self.c
+0000e420: 6f6d 6d65 6e74 735b 726f 775d 5b63 6f6c  omments[row][col
+0000e430: 5d20 3d20 5b72 6f77 2c20 636f 6c2c 2063  ] = [row, col, c
+0000e440: 6f6d 6d65 6e74 2c20 6f70 7469 6f6e 735d  omment, options]
+0000e450: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000e460: 2030 0a0a 2020 2020 6465 6620 7368 6f77   0..    def show
+0000e470: 5f63 6f6d 6d65 6e74 7328 7365 6c66 293a  _comments(self):
+0000e480: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000e490: 2020 2020 204d 616b 6520 616e 7920 636f       Make any co
+0000e4a0: 6d6d 656e 7473 2069 6e20 7468 6520 776f  mments in the wo
+0000e4b0: 726b 7368 6565 7420 7669 7369 626c 652e  rksheet visible.
+0000e4c0: 0a0a 2020 2020 2020 2020 4172 6773 3a0a  ..        Args:.
+0000e4d0: 2020 2020 2020 2020 2020 2020 4e6f 6e65              None
+0000e4e0: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+0000e4f0: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+0000e500: 4e6f 7468 696e 672e 0a0a 2020 2020 2020  Nothing...      
+0000e510: 2020 2222 220a 2020 2020 2020 2020 7365    """.        se
+0000e520: 6c66 2e63 6f6d 6d65 6e74 735f 7669 7369  lf.comments_visi
+0000e530: 626c 6520 3d20 310a 0a20 2020 2064 6566  ble = 1..    def
+0000e540: 2073 6574 5f62 6163 6b67 726f 756e 6428   set_background(
+0000e550: 7365 6c66 2c20 6669 6c65 6e61 6d65 2c20  self, filename, 
+0000e560: 6973 5f62 7974 655f 7374 7265 616d 3d46  is_byte_stream=F
+0000e570: 616c 7365 293a 0a20 2020 2020 2020 2022  alse):.        "
+0000e580: 2222 0a20 2020 2020 2020 2053 6574 2061  "".        Set a
+0000e590: 2062 6163 6b67 726f 756e 6420 696d 6167   background imag
+0000e5a0: 6520 666f 7220 6120 776f 726b 7368 6565  e for a workshee
+0000e5b0: 742e 0a0a 2020 2020 2020 2020 4172 6773  t...        Args
+0000e5c0: 3a0a 2020 2020 2020 2020 2020 2020 6669  :.            fi
+0000e5d0: 6c65 6e61 6d65 3a20 2020 2020 2020 5061  lename:       Pa
+0000e5e0: 7468 2061 6e64 2066 696c 656e 616d 6520  th and filename 
+0000e5f0: 666f 7220 696e 2073 7570 706f 7274 6564  for in supported
+0000e600: 2066 6f72 6d61 7473 2e0a 2020 2020 2020   formats..      
+0000e610: 2020 2020 2020 6973 5f62 7974 655f 7374        is_byte_st
+0000e620: 7265 616d 3a20 4669 6c65 2069 7320 6120  ream: File is a 
+0000e630: 7374 7265 616d 206f 6620 6279 7465 732e  stream of bytes.
+0000e640: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0000e650: 3a0a 2020 2020 2020 2020 2020 2020 4e6f  :.            No
+0000e660: 7468 696e 672e 0a0a 2020 2020 2020 2020  thing...        
+0000e670: 2222 220a 0a20 2020 2020 2020 2069 6620  """..        if 
+0000e680: 6e6f 7420 6973 5f62 7974 655f 7374 7265  not is_byte_stre
+0000e690: 616d 2061 6e64 206e 6f74 206f 732e 7061  am and not os.pa
+0000e6a0: 7468 2e65 7869 7374 7328 6669 6c65 6e61  th.exists(filena
+0000e6b0: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
+0000e6c0: 2077 6172 6e28 2249 6d61 6765 2066 696c   warn("Image fil
+0000e6d0: 6520 2725 7327 206e 6f74 2066 6f75 6e64  e '%s' not found
+0000e6e0: 2e22 2025 2066 696c 656e 616d 6529 0a20  ." % filename). 
+0000e6f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000e700: 6e20 2d31 0a0a 2020 2020 2020 2020 7365  n -1..        se
+0000e710: 6c66 2e62 6163 6b67 726f 756e 645f 6279  lf.background_by
+0000e720: 7465 7320 3d20 6973 5f62 7974 655f 7374  tes = is_byte_st
+0000e730: 7265 616d 0a20 2020 2020 2020 2073 656c  ream.        sel
+0000e740: 662e 6261 636b 6772 6f75 6e64 5f69 6d61  f.background_ima
+0000e750: 6765 203d 2066 696c 656e 616d 650a 0a20  ge = filename.. 
+0000e760: 2020 2064 6566 2073 6574 5f63 6f6d 6d65     def set_comme
+0000e770: 6e74 735f 6175 7468 6f72 2873 656c 662c  nts_author(self,
+0000e780: 2061 7574 686f 7229 3a0a 2020 2020 2020   author):.      
+0000e790: 2020 2222 220a 2020 2020 2020 2020 5365    """.        Se
+0000e7a0: 7420 7468 6520 6465 6661 756c 7420 6175  t the default au
+0000e7b0: 7468 6f72 206f 6620 7468 6520 6365 6c6c  thor of the cell
+0000e7c0: 2063 6f6d 6d65 6e74 732e 0a0a 2020 2020   comments...    
+0000e7d0: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+0000e7e0: 2020 2020 2020 6175 7468 6f72 3a20 436f        author: Co
+0000e7f0: 6d6d 656e 7420 6175 7468 6f72 206e 616d  mment author nam
+0000e800: 652e 2053 7472 696e 672e 0a0a 2020 2020  e. String...    
+0000e810: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
+0000e820: 2020 2020 2020 2020 204e 6f74 6869 6e67           Nothing
+0000e830: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
+0000e840: 2020 2020 2020 2073 656c 662e 636f 6d6d         self.comm
+0000e850: 656e 7473 5f61 7574 686f 7220 3d20 6175  ents_author = au
+0000e860: 7468 6f72 0a0a 2020 2020 6465 6620 6765  thor..    def ge
+0000e870: 745f 6e61 6d65 2873 656c 6629 3a0a 2020  t_name(self):.  
+0000e880: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000e890: 2020 5265 7472 6965 7665 2074 6865 2077    Retrieve the w
+0000e8a0: 6f72 6b73 6865 6574 206e 616d 652e 0a0a  orksheet name...
+0000e8b0: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
+0000e8c0: 2020 2020 2020 2020 2020 4e6f 6e65 2e0a            None..
+0000e8d0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0000e8e0: 3a0a 2020 2020 2020 2020 2020 2020 4e6f  :.            No
+0000e8f0: 7468 696e 672e 0a0a 2020 2020 2020 2020  thing...        
+0000e900: 2222 220a 2020 2020 2020 2020 2320 5468  """.        # Th
+0000e910: 6572 6520 6973 206e 6f20 7365 745f 6e61  ere is no set_na
+0000e920: 6d65 2829 206d 6574 686f 642e 204e 616d  me() method. Nam
+0000e930: 6520 6d75 7374 2062 6520 7365 7420 696e  e must be set in
+0000e940: 2061 6464 5f77 6f72 6b73 6865 6574 2829   add_worksheet()
+0000e950: 2e0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000e960: 2073 656c 662e 6e61 6d65 0a0a 2020 2020   self.name..    
+0000e970: 6465 6620 6163 7469 7661 7465 2873 656c  def activate(sel
+0000e980: 6629 3a0a 2020 2020 2020 2020 2222 220a  f):.        """.
+0000e990: 2020 2020 2020 2020 5365 7420 7468 6973          Set this
+0000e9a0: 2077 6f72 6b73 6865 6574 2061 7320 7468   worksheet as th
+0000e9b0: 6520 6163 7469 7665 2077 6f72 6b73 6865  e active workshe
+0000e9c0: 6574 2c20 692e 652e 2074 6865 2077 6f72  et, i.e. the wor
+0000e9d0: 6b73 6865 6574 2074 6861 7420 6973 0a20  ksheet that is. 
+0000e9e0: 2020 2020 2020 2064 6973 706c 6179 6564         displayed
+0000e9f0: 2077 6865 6e20 7468 6520 776f 726b 626f   when the workbo
+0000ea00: 6f6b 2069 7320 6f70 656e 6564 2e20 416c  ok is opened. Al
+0000ea10: 736f 2073 6574 2069 7420 6173 2073 656c  so set it as sel
+0000ea20: 6563 7465 642e 0a0a 2020 2020 2020 2020  ected...        
+0000ea30: 4e6f 7465 3a20 416e 2061 6374 6976 6520  Note: An active 
+0000ea40: 776f 726b 7368 6565 7420 6361 6e6e 6f74  worksheet cannot
+0000ea50: 2062 6520 6869 6464 656e 2e0a 0a20 2020   be hidden...   
+0000ea60: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
+0000ea70: 2020 2020 2020 204e 6f6e 652e 0a0a 2020         None...  
+0000ea80: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
+0000ea90: 2020 2020 2020 2020 2020 204e 6f74 6869             Nothi
+0000eaa0: 6e67 2e0a 0a20 2020 2020 2020 2022 2222  ng...        """
+0000eab0: 0a20 2020 2020 2020 2073 656c 662e 6869  .        self.hi
+0000eac0: 6464 656e 203d 2030 0a20 2020 2020 2020  dden = 0.       
+0000ead0: 2073 656c 662e 7365 6c65 6374 6564 203d   self.selected =
+0000eae0: 2031 0a20 2020 2020 2020 2073 656c 662e   1.        self.
+0000eaf0: 776f 726b 7368 6565 745f 6d65 7461 2e61  worksheet_meta.a
+0000eb00: 6374 6976 6573 6865 6574 203d 2073 656c  ctivesheet = sel
+0000eb10: 662e 696e 6465 780a 0a20 2020 2064 6566  f.index..    def
+0000eb20: 2073 656c 6563 7428 7365 6c66 293a 0a20   select(self):. 
+0000eb30: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000eb40: 2020 2053 6574 2063 7572 7265 6e74 2077     Set current w
+0000eb50: 6f72 6b73 6865 6574 2061 7320 6120 7365  orksheet as a se
+0000eb60: 6c65 6374 6564 2077 6f72 6b73 6865 6574  lected worksheet
+0000eb70: 2c20 692e 652e 2074 6865 2077 6f72 6b73  , i.e. the works
+0000eb80: 6865 6574 0a20 2020 2020 2020 2068 6173  heet.        has
+0000eb90: 2069 7473 2074 6162 2068 6967 686c 6967   its tab highlig
+0000eba0: 6874 6564 2e0a 0a20 2020 2020 2020 204e  hted...        N
+0000ebb0: 6f74 653a 2041 2073 656c 6563 7465 6420  ote: A selected 
+0000ebc0: 776f 726b 7368 6565 7420 6361 6e6e 6f74  worksheet cannot
+0000ebd0: 2062 6520 6869 6464 656e 2e0a 0a20 2020   be hidden...   
+0000ebe0: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
+0000ebf0: 2020 2020 2020 204e 6f6e 652e 0a0a 2020         None...  
+0000ec00: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
+0000ec10: 2020 2020 2020 2020 2020 204e 6f74 6869             Nothi
+0000ec20: 6e67 2e0a 0a20 2020 2020 2020 2022 2222  ng...        """
+0000ec30: 0a20 2020 2020 2020 2073 656c 662e 7365  .        self.se
+0000ec40: 6c65 6374 6564 203d 2031 0a20 2020 2020  lected = 1.     
+0000ec50: 2020 2073 656c 662e 6869 6464 656e 203d     self.hidden =
+0000ec60: 2030 0a0a 2020 2020 6465 6620 6869 6465   0..    def hide
+0000ec70: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0000ec80: 2222 220a 2020 2020 2020 2020 4869 6465  """.        Hide
+0000ec90: 2074 6865 2063 7572 7265 6e74 2077 6f72   the current wor
+0000eca0: 6b73 6865 6574 2e0a 0a20 2020 2020 2020  ksheet...       
+0000ecb0: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
+0000ecc0: 2020 204e 6f6e 652e 0a0a 2020 2020 2020     None...      
+0000ecd0: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
+0000ece0: 2020 2020 2020 204e 6f74 6869 6e67 2e0a         Nothing..
+0000ecf0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000ed00: 2020 2020 2073 656c 662e 6869 6464 656e       self.hidden
+0000ed10: 203d 2031 0a0a 2020 2020 2020 2020 2320   = 1..        # 
+0000ed20: 4120 6869 6464 656e 2077 6f72 6b73 6865  A hidden workshe
+0000ed30: 6574 2073 686f 756c 646e 2774 2062 6520  et shouldn't be 
+0000ed40: 6163 7469 7665 206f 7220 7365 6c65 6374  active or select
+0000ed50: 6564 2e0a 2020 2020 2020 2020 7365 6c66  ed..        self
+0000ed60: 2e73 656c 6563 7465 6420 3d20 300a 0a20  .selected = 0.. 
+0000ed70: 2020 2020 2020 2023 2054 4f44 4f2e 2053         # TODO. S
+0000ed80: 686f 756c 6420 6164 6420 6120 6368 6563  hould add a chec
+0000ed90: 6b20 746f 2073 6565 2069 6620 7468 6520  k to see if the 
+0000eda0: 7368 6565 7420 6973 2074 6865 2067 6c6f  sheet is the glo
+0000edb0: 6261 6c0a 2020 2020 2020 2020 2320 6163  bal.        # ac
+0000edc0: 7469 7665 7368 6565 7420 6f72 2066 6972  tivesheet or fir
+0000edd0: 7374 7368 6565 7420 616e 6420 7265 7365  stsheet and rese
+0000ede0: 7420 7468 656d 2e0a 0a20 2020 2064 6566  t them...    def
+0000edf0: 2073 6574 5f66 6972 7374 5f73 6865 6574   set_first_sheet
+0000ee00: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+0000ee10: 2222 220a 2020 2020 2020 2020 5365 7420  """.        Set 
+0000ee20: 6375 7272 656e 7420 776f 726b 7368 6565  current workshee
+0000ee30: 7420 6173 2074 6865 2066 6972 7374 2076  t as the first v
+0000ee40: 6973 6962 6c65 2073 6865 6574 2e20 5468  isible sheet. Th
+0000ee50: 6973 2069 7320 6e65 6365 7373 6172 790a  is is necessary.
+0000ee60: 2020 2020 2020 2020 7768 656e 2074 6865          when the
+0000ee70: 7265 2061 7265 2061 206c 6172 6765 206e  re are a large n
+0000ee80: 756d 6265 7220 6f66 2077 6f72 6b73 6865  umber of workshe
+0000ee90: 6574 7320 616e 6420 7468 6520 6163 7469  ets and the acti
+0000eea0: 7661 7465 640a 2020 2020 2020 2020 776f  vated.        wo
+0000eeb0: 726b 7368 6565 7420 6973 206e 6f74 2076  rksheet is not v
+0000eec0: 6973 6962 6c65 206f 6e20 7468 6520 7363  isible on the sc
+0000eed0: 7265 656e 2e0a 0a20 2020 2020 2020 204e  reen...        N
+0000eee0: 6f74 653a 2041 2073 656c 6563 7465 6420  ote: A selected 
+0000eef0: 776f 726b 7368 6565 7420 6361 6e6e 6f74  worksheet cannot
+0000ef00: 2062 6520 6869 6464 656e 2e0a 0a20 2020   be hidden...   
+0000ef10: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
+0000ef20: 2020 2020 2020 204e 6f6e 652e 0a0a 2020         None...  
+0000ef30: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
+0000ef40: 2020 2020 2020 2020 2020 204e 6f74 6869             Nothi
+0000ef50: 6e67 2e0a 0a20 2020 2020 2020 2022 2222  ng...        """
+0000ef60: 0a20 2020 2020 2020 2073 656c 662e 6869  .        self.hi
+0000ef70: 6464 656e 203d 2030 2020 2320 4163 7469  dden = 0  # Acti
+0000ef80: 7665 2077 6f72 6b73 6865 6574 2063 616e  ve worksheet can
+0000ef90: 2774 2062 6520 6869 6464 656e 2e0a 2020  't be hidden..  
+0000efa0: 2020 2020 2020 7365 6c66 2e77 6f72 6b73        self.works
+0000efb0: 6865 6574 5f6d 6574 612e 6669 7273 7473  heet_meta.firsts
+0000efc0: 6865 6574 203d 2073 656c 662e 696e 6465  heet = self.inde
+0000efd0: 780a 0a20 2020 2040 636f 6e76 6572 745f  x..    @convert_
+0000efe0: 636f 6c75 6d6e 5f61 7267 730a 2020 2020  column_args.    
+0000eff0: 6465 6620 7365 745f 636f 6c75 6d6e 280a  def set_column(.
+0000f000: 2020 2020 2020 2020 7365 6c66 2c20 6669          self, fi
+0000f010: 7273 745f 636f 6c2c 206c 6173 745f 636f  rst_col, last_co
+0000f020: 6c2c 2077 6964 7468 3d4e 6f6e 652c 2063  l, width=None, c
+0000f030: 656c 6c5f 666f 726d 6174 3d4e 6f6e 652c  ell_format=None,
+0000f040: 206f 7074 696f 6e73 3d4e 6f6e 650a 2020   options=None.  
+0000f050: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+0000f060: 0a20 2020 2020 2020 2053 6574 2074 6865  .        Set the
+0000f070: 2077 6964 7468 2c20 616e 6420 6f74 6865   width, and othe
+0000f080: 7220 7072 6f70 6572 7469 6573 206f 6620  r properties of 
+0000f090: 6120 7369 6e67 6c65 2063 6f6c 756d 6e20  a single column 
+0000f0a0: 6f72 2061 0a20 2020 2020 2020 2072 616e  or a.        ran
+0000f0b0: 6765 206f 6620 636f 6c75 6d6e 732e 0a0a  ge of columns...
+0000f0c0: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
+0000f0d0: 2020 2020 2020 2020 2020 6669 7273 745f            first_
+0000f0e0: 636f 6c3a 2020 2046 6972 7374 2063 6f6c  col:   First col
+0000f0f0: 756d 6e20 287a 6572 6f2d 696e 6465 7865  umn (zero-indexe
+0000f100: 6429 2e0a 2020 2020 2020 2020 2020 2020  d)..            
+0000f110: 6c61 7374 5f63 6f6c 3a20 2020 204c 6173  last_col:    Las
+0000f120: 7420 636f 6c75 6d6e 2028 7a65 726f 2d69  t column (zero-i
+0000f130: 6e64 6578 6564 292e 2043 616e 2062 6520  ndexed). Can be 
+0000f140: 7361 6d65 2061 7320 6669 7273 745f 636f  same as first_co
+0000f150: 6c2e 0a20 2020 2020 2020 2020 2020 2077  l..            w
+0000f160: 6964 7468 3a20 2020 2020 2020 436f 6c75  idth:       Colu
+0000f170: 6d6e 2077 6964 7468 2e20 286f 7074 696f  mn width. (optio
+0000f180: 6e61 6c29 2e0a 2020 2020 2020 2020 2020  nal)..          
+0000f190: 2020 6365 6c6c 5f66 6f72 6d61 743a 2043    cell_format: C
+0000f1a0: 6f6c 756d 6e20 6365 6c6c 5f66 6f72 6d61  olumn cell_forma
+0000f1b0: 742e 2028 6f70 7469 6f6e 616c 292e 0a20  t. (optional).. 
+0000f1c0: 2020 2020 2020 2020 2020 206f 7074 696f             optio
+0000f1d0: 6e73 3a20 2020 2020 4469 6374 206f 6620  ns:     Dict of 
+0000f1e0: 6f70 7469 6f6e 7320 7375 6368 2061 7320  options such as 
+0000f1f0: 6869 6464 656e 2061 6e64 206c 6576 656c  hidden and level
+0000f200: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+0000f210: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+0000f220: 303a 2020 5375 6363 6573 732e 0a20 2020  0:  Success..   
+0000f230: 2020 2020 2020 2020 202d 313a 2043 6f6c           -1: Col
+0000f240: 756d 6e20 6e75 6d62 6572 2069 7320 6f75  umn number is ou
+0000f250: 7420 6f66 2077 6f72 6b73 6865 6574 2062  t of worksheet b
+0000f260: 6f75 6e64 732e 0a0a 2020 2020 2020 2020  ounds...        
+0000f270: 2222 220a 2020 2020 2020 2020 6966 206f  """.        if o
+0000f280: 7074 696f 6e73 2069 7320 4e6f 6e65 3a0a  ptions is None:.
+0000f290: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
+0000f2a0: 6f6e 7320 3d20 7b7d 0a0a 2020 2020 2020  ons = {}..      
+0000f2b0: 2020 2320 456e 7375 7265 2032 6e64 2063    # Ensure 2nd c
+0000f2c0: 6f6c 2069 7320 6c61 7267 6572 2074 6861  ol is larger tha
+0000f2d0: 6e20 6669 7273 742e 0a20 2020 2020 2020  n first..       
+0000f2e0: 2069 6620 6669 7273 745f 636f 6c20 3e20   if first_col > 
+0000f2f0: 6c61 7374 5f63 6f6c 3a0a 2020 2020 2020  last_col:.      
+0000f300: 2020 2020 2020 2866 6972 7374 5f63 6f6c        (first_col
+0000f310: 2c20 6c61 7374 5f63 6f6c 2920 3d20 286c  , last_col) = (l
+0000f320: 6173 745f 636f 6c2c 2066 6972 7374 5f63  ast_col, first_c
+0000f330: 6f6c 290a 0a20 2020 2020 2020 2023 2044  ol)..        # D
+0000f340: 6f6e 2774 206d 6f64 6966 7920 7468 6520  on't modify the 
+0000f350: 726f 7720 6469 6d65 6e73 696f 6e73 2077  row dimensions w
+0000f360: 6865 6e20 6368 6563 6b69 6e67 2074 6865  hen checking the
+0000f370: 2063 6f6c 756d 6e73 2e0a 2020 2020 2020   columns..      
+0000f380: 2020 6967 6e6f 7265 5f72 6f77 203d 2054    ignore_row = T
+0000f390: 7275 650a 0a20 2020 2020 2020 2023 2053  rue..        # S
+0000f3a0: 6574 206f 7074 696f 6e61 6c20 636f 6c75  et optional colu
+0000f3b0: 6d6e 2076 616c 7565 732e 0a20 2020 2020  mn values..     
+0000f3c0: 2020 2068 6964 6465 6e20 3d20 6f70 7469     hidden = opti
+0000f3d0: 6f6e 732e 6765 7428 2268 6964 6465 6e22  ons.get("hidden"
+0000f3e0: 2c20 4661 6c73 6529 0a20 2020 2020 2020  , False).       
+0000f3f0: 2063 6f6c 6c61 7073 6564 203d 206f 7074   collapsed = opt
+0000f400: 696f 6e73 2e67 6574 2822 636f 6c6c 6170  ions.get("collap
+0000f410: 7365 6422 2c20 4661 6c73 6529 0a20 2020  sed", False).   
+0000f420: 2020 2020 206c 6576 656c 203d 206f 7074       level = opt
+0000f430: 696f 6e73 2e67 6574 2822 6c65 7665 6c22  ions.get("level"
+0000f440: 2c20 3029 0a0a 2020 2020 2020 2020 2320  , 0)..        # 
+0000f450: 5374 6f72 6520 7468 6520 636f 6c75 6d6e  Store the column
+0000f460: 2064 696d 656e 7369 6f6e 206f 6e6c 7920   dimension only 
+0000f470: 696e 2073 6f6d 6520 636f 6e64 6974 696f  in some conditio
+0000f480: 6e73 2e0a 2020 2020 2020 2020 6966 2063  ns..        if c
+0000f490: 656c 6c5f 666f 726d 6174 206f 7220 2877  ell_format or (w
+0000f4a0: 6964 7468 2061 6e64 2068 6964 6465 6e29  idth and hidden)
+0000f4b0: 3a0a 2020 2020 2020 2020 2020 2020 6967  :.            ig
+0000f4c0: 6e6f 7265 5f63 6f6c 203d 2046 616c 7365  nore_col = False
+0000f4d0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0000f4e0: 2020 2020 2020 2020 2020 2069 676e 6f72             ignor
+0000f4f0: 655f 636f 6c20 3d20 5472 7565 0a0a 2020  e_col = True..  
+0000f500: 2020 2020 2020 2320 4368 6563 6b20 7468        # Check th
+0000f510: 6174 2065 6163 6820 636f 6c75 6d6e 2069  at each column i
+0000f520: 7320 7661 6c69 6420 616e 6420 7374 6f72  s valid and stor
+0000f530: 6520 7468 6520 6d61 7820 616e 6420 6d69  e the max and mi
+0000f540: 6e20 7661 6c75 6573 2e0a 2020 2020 2020  n values..      
+0000f550: 2020 6966 2073 656c 662e 5f63 6865 636b    if self._check
+0000f560: 5f64 696d 656e 7369 6f6e 7328 302c 206c  _dimensions(0, l
+0000f570: 6173 745f 636f 6c2c 2069 676e 6f72 655f  ast_col, ignore_
+0000f580: 726f 772c 2069 676e 6f72 655f 636f 6c29  row, ignore_col)
+0000f590: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0000f5a0: 7475 726e 202d 310a 2020 2020 2020 2020  turn -1.        
+0000f5b0: 6966 2073 656c 662e 5f63 6865 636b 5f64  if self._check_d
+0000f5c0: 696d 656e 7369 6f6e 7328 302c 2066 6972  imensions(0, fir
+0000f5d0: 7374 5f63 6f6c 2c20 6967 6e6f 7265 5f72  st_col, ignore_r
+0000f5e0: 6f77 2c20 6967 6e6f 7265 5f63 6f6c 293a  ow, ignore_col):
+0000f5f0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000f600: 7572 6e20 2d31 0a0a 2020 2020 2020 2020  urn -1..        
+0000f610: 2320 5365 7420 7468 6520 6c69 6d69 7473  # Set the limits
+0000f620: 2066 6f72 2074 6865 206f 7574 6c69 6e65   for the outline
+0000f630: 206c 6576 656c 7320 2830 203c 3d20 7820   levels (0 <= x 
+0000f640: 3c3d 2037 292e 0a20 2020 2020 2020 2069  <= 7)..        i
+0000f650: 6620 6c65 7665 6c20 3c20 303a 0a20 2020  f level < 0:.   
+0000f660: 2020 2020 2020 2020 206c 6576 656c 203d           level =
+0000f670: 2030 0a20 2020 2020 2020 2069 6620 6c65   0.        if le
+0000f680: 7665 6c20 3e20 373a 0a20 2020 2020 2020  vel > 7:.       
+0000f690: 2020 2020 206c 6576 656c 203d 2037 0a0a       level = 7..
+0000f6a0: 2020 2020 2020 2020 6966 206c 6576 656c          if level
+0000f6b0: 203e 2073 656c 662e 6f75 746c 696e 655f   > self.outline_
+0000f6c0: 636f 6c5f 6c65 7665 6c3a 0a20 2020 2020  col_level:.     
+0000f6d0: 2020 2020 2020 2073 656c 662e 6f75 746c         self.outl
+0000f6e0: 696e 655f 636f 6c5f 6c65 7665 6c20 3d20  ine_col_level = 
+0000f6f0: 6c65 7665 6c0a 0a20 2020 2020 2020 2023  level..        #
+0000f700: 2053 746f 7265 2074 6865 2063 6f6c 756d   Store the colum
+0000f710: 6e20 6461 7461 2e0a 2020 2020 2020 2020  n data..        
+0000f720: 666f 7220 636f 6c20 696e 2072 616e 6765  for col in range
+0000f730: 2866 6972 7374 5f63 6f6c 2c20 6c61 7374  (first_col, last
+0000f740: 5f63 6f6c 202b 2031 293a 0a20 2020 2020  _col + 1):.     
+0000f750: 2020 2020 2020 2073 656c 662e 636f 6c5f         self.col_
+0000f760: 696e 666f 5b63 6f6c 5d20 3d20 5b77 6964  info[col] = [wid
+0000f770: 7468 2c20 6365 6c6c 5f66 6f72 6d61 742c  th, cell_format,
+0000f780: 2068 6964 6465 6e2c 206c 6576 656c 2c20   hidden, level, 
+0000f790: 636f 6c6c 6170 7365 642c 2046 616c 7365  collapsed, False
+0000f7a0: 5d0a 0a20 2020 2020 2020 2023 2053 746f  ]..        # Sto
+0000f7b0: 7265 2074 6865 2063 6f6c 756d 6e20 6368  re the column ch
+0000f7c0: 616e 6765 2074 6f20 616c 6c6f 7720 6f70  ange to allow op
+0000f7d0: 7469 6d69 7a61 7469 6f6e 732e 0a20 2020  timizations..   
+0000f7e0: 2020 2020 2073 656c 662e 636f 6c5f 7369       self.col_si
+0000f7f0: 7a65 5f63 6861 6e67 6564 203d 2054 7275  ze_changed = Tru
+0000f800: 650a 0a20 2020 2020 2020 2072 6574 7572  e..        retur
+0000f810: 6e20 300a 0a20 2020 2040 636f 6e76 6572  n 0..    @conver
+0000f820: 745f 636f 6c75 6d6e 5f61 7267 730a 2020  t_column_args.  
+0000f830: 2020 6465 6620 7365 745f 636f 6c75 6d6e    def set_column
+0000f840: 5f70 6978 656c 7328 0a20 2020 2020 2020  _pixels(.       
+0000f850: 2073 656c 662c 2066 6972 7374 5f63 6f6c   self, first_col
+0000f860: 2c20 6c61 7374 5f63 6f6c 2c20 7769 6474  , last_col, widt
+0000f870: 683d 4e6f 6e65 2c20 6365 6c6c 5f66 6f72  h=None, cell_for
+0000f880: 6d61 743d 4e6f 6e65 2c20 6f70 7469 6f6e  mat=None, option
+0000f890: 733d 4e6f 6e65 0a20 2020 2029 3a0a 2020  s=None.    ):.  
+0000f8a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000f8b0: 2020 5365 7420 7468 6520 7769 6474 682c    Set the width,
+0000f8c0: 2061 6e64 206f 7468 6572 2070 726f 7065   and other prope
+0000f8d0: 7274 6965 7320 6f66 2061 2073 696e 676c  rties of a singl
+0000f8e0: 6520 636f 6c75 6d6e 206f 7220 610a 2020  e column or a.  
+0000f8f0: 2020 2020 2020 7261 6e67 6520 6f66 2063        range of c
+0000f900: 6f6c 756d 6e73 2c20 7768 6572 6520 636f  olumns, where co
+0000f910: 6c75 6d6e 2077 6964 7468 2069 7320 696e  lumn width is in
+0000f920: 2070 6978 656c 732e 0a0a 2020 2020 2020   pixels...      
+0000f930: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
+0000f940: 2020 2020 6669 7273 745f 636f 6c3a 2020      first_col:  
+0000f950: 2046 6972 7374 2063 6f6c 756d 6e20 287a   First column (z
+0000f960: 6572 6f2d 696e 6465 7865 6429 2e0a 2020  ero-indexed)..  
+0000f970: 2020 2020 2020 2020 2020 6c61 7374 5f63            last_c
+0000f980: 6f6c 3a20 2020 204c 6173 7420 636f 6c75  ol:    Last colu
+0000f990: 6d6e 2028 7a65 726f 2d69 6e64 6578 6564  mn (zero-indexed
+0000f9a0: 292e 2043 616e 2062 6520 7361 6d65 2061  ). Can be same a
+0000f9b0: 7320 6669 7273 745f 636f 6c2e 0a20 2020  s first_col..   
+0000f9c0: 2020 2020 2020 2020 2077 6964 7468 3a20           width: 
+0000f9d0: 2020 2020 2020 436f 6c75 6d6e 2077 6964        Column wid
+0000f9e0: 7468 2069 6e20 7069 7865 6c73 2e20 286f  th in pixels. (o
+0000f9f0: 7074 696f 6e61 6c29 2e0a 2020 2020 2020  ptional)..      
+0000fa00: 2020 2020 2020 6365 6c6c 5f66 6f72 6d61        cell_forma
+0000fa10: 743a 2043 6f6c 756d 6e20 6365 6c6c 5f66  t: Column cell_f
+0000fa20: 6f72 6d61 742e 2028 6f70 7469 6f6e 616c  ormat. (optional
+0000fa30: 292e 0a20 2020 2020 2020 2020 2020 206f  )..            o
+0000fa40: 7074 696f 6e73 3a20 2020 2020 4469 6374  ptions:     Dict
+0000fa50: 206f 6620 6f70 7469 6f6e 7320 7375 6368   of options such
+0000fa60: 2061 7320 6869 6464 656e 2061 6e64 206c   as hidden and l
+0000fa70: 6576 656c 2e0a 0a20 2020 2020 2020 2052  evel...        R
+0000fa80: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
+0000fa90: 2020 2020 303a 2020 5375 6363 6573 732e      0:  Success.
+0000faa0: 0a20 2020 2020 2020 2020 2020 202d 313a  .            -1:
+0000fab0: 2043 6f6c 756d 6e20 6e75 6d62 6572 2069   Column number i
+0000fac0: 7320 6f75 7420 6f66 2077 6f72 6b73 6865  s out of workshe
+0000fad0: 6574 2062 6f75 6e64 732e 0a0a 2020 2020  et bounds...    
+0000fae0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0000faf0: 6966 2077 6964 7468 2069 7320 6e6f 7420  if width is not 
+0000fb00: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0000fb10: 2020 7769 6474 6820 3d20 7365 6c66 2e5f    width = self._
+0000fb20: 7069 7865 6c73 5f74 6f5f 7769 6474 6828  pixels_to_width(
+0000fb30: 7769 6474 6829 0a0a 2020 2020 2020 2020  width)..        
+0000fb40: 7265 7475 726e 2073 656c 662e 7365 745f  return self.set_
+0000fb50: 636f 6c75 6d6e 2866 6972 7374 5f63 6f6c  column(first_col
+0000fb60: 2c20 6c61 7374 5f63 6f6c 2c20 7769 6474  , last_col, widt
+0000fb70: 682c 2063 656c 6c5f 666f 726d 6174 2c20  h, cell_format, 
+0000fb80: 6f70 7469 6f6e 7329 0a0a 2020 2020 6465  options)..    de
+0000fb90: 6620 6175 746f 6669 7428 7365 6c66 293a  f autofit(self):
+0000fba0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000fbb0: 2020 2020 2053 696d 756c 6174 6520 6175       Simulate au
+0000fbc0: 746f 6669 7420 6261 7365 6420 6f6e 2074  tofit based on t
+0000fbd0: 6865 2064 6174 612c 2061 6e64 2064 6174  he data, and dat
+0000fbe0: 6174 7970 6573 2069 6e20 6561 6368 2063  atypes in each c
+0000fbf0: 6f6c 756d 6e2e 0a0a 2020 2020 2020 2020  olumn...        
+0000fc00: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
+0000fc10: 2020 4e6f 6e65 2e0a 0a20 2020 2020 2020    None...       
+0000fc20: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
+0000fc30: 2020 2020 2020 4e6f 7468 696e 672e 0a0a        Nothing...
+0000fc40: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000fc50: 2020 2020 6966 2073 656c 662e 636f 6e73      if self.cons
+0000fc60: 7461 6e74 5f6d 656d 6f72 793a 0a20 2020  tant_memory:.   
+0000fc70: 2020 2020 2020 2020 2077 6172 6e28 2241           warn("A
+0000fc80: 7574 6f66 6974 2069 7320 6e6f 7420 7375  utofit is not su
+0000fc90: 7070 6f72 7465 6420 696e 2063 6f6e 7374  pported in const
+0000fca0: 616e 745f 6d65 6d6f 7279 206d 6f64 652e  ant_memory mode.
+0000fcb0: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
+0000fcc0: 6574 7572 6e0a 0a20 2020 2020 2020 2023  eturn..        #
+0000fcd0: 204e 6f20 6461 7461 2077 7269 7474 656e   No data written
+0000fce0: 2074 6f20 7468 6520 7461 7267 6574 2073   to the target s
+0000fcf0: 6865 6574 3b20 6e6f 7468 696e 6720 746f  heet; nothing to
+0000fd00: 2061 7574 6f66 6974 0a20 2020 2020 2020   autofit.       
+0000fd10: 2069 6620 7365 6c66 2e64 696d 5f72 6f77   if self.dim_row
+0000fd20: 6d61 7820 6973 204e 6f6e 653a 0a20 2020  max is None:.   
+0000fd30: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
+0000fd40: 0a20 2020 2020 2020 2023 2053 746f 7265  .        # Store
+0000fd50: 2074 6865 206d 6178 2070 6978 656c 2077   the max pixel w
+0000fd60: 6964 7468 2066 6f72 2065 6163 6820 636f  idth for each co
+0000fd70: 6c75 6d6e 2e0a 2020 2020 2020 2020 636f  lumn..        co
+0000fd80: 6c5f 7769 6474 685f 6d61 7820 3d20 7b7d  l_width_max = {}
+0000fd90: 0a0a 2020 2020 2020 2020 2320 4372 6561  ..        # Crea
+0000fda0: 7465 2061 2072 6576 6572 7365 206c 6f6f  te a reverse loo
+0000fdb0: 6b75 7020 666f 7220 7468 6520 7368 6172  kup for the shar
+0000fdc0: 6520 7374 7269 6e67 7320 7461 626c 6520  e strings table 
+0000fdd0: 736f 2077 6520 6361 6e20 636f 6e76 6572  so we can conver
+0000fde0: 740a 2020 2020 2020 2020 2320 7468 6520  t.        # the 
+0000fdf0: 7374 7269 6e67 2069 6420 6261 636b 2074  string id back t
+0000fe00: 6f20 7468 6520 6f72 6967 696e 616c 2073  o the original s
+0000fe10: 7472 696e 672e 0a20 2020 2020 2020 2073  tring..        s
+0000fe20: 7472 696e 6773 203d 2073 6f72 7465 6428  trings = sorted(
+0000fe30: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000fe40: 662e 7374 725f 7461 626c 652e 7374 7269  f.str_table.stri
+0000fe50: 6e67 5f74 6162 6c65 2c20 6b65 793d 7365  ng_table, key=se
+0000fe60: 6c66 2e73 7472 5f74 6162 6c65 2e73 7472  lf.str_table.str
+0000fe70: 696e 675f 7461 626c 652e 5f5f 6765 7469  ing_table.__geti
+0000fe80: 7465 6d5f 5f0a 2020 2020 2020 2020 290a  tem__.        ).
+0000fe90: 0a20 2020 2020 2020 2066 6f72 2072 6f77  .        for row
+0000fea0: 5f6e 756d 2069 6e20 7261 6e67 6528 7365  _num in range(se
+0000feb0: 6c66 2e64 696d 5f72 6f77 6d69 6e2c 2073  lf.dim_rowmin, s
+0000fec0: 656c 662e 6469 6d5f 726f 776d 6178 202b  elf.dim_rowmax +
+0000fed0: 2031 293a 0a20 2020 2020 2020 2020 2020   1):.           
+0000fee0: 2069 6620 6e6f 7420 7365 6c66 2e74 6162   if not self.tab
+0000fef0: 6c65 2e67 6574 2872 6f77 5f6e 756d 293a  le.get(row_num):
+0000ff00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ff10: 2063 6f6e 7469 6e75 650a 0a20 2020 2020   continue..     
+0000ff20: 2020 2020 2020 2066 6f72 2063 6f6c 5f6e         for col_n
+0000ff30: 756d 2069 6e20 7261 6e67 6528 7365 6c66  um in range(self
+0000ff40: 2e64 696d 5f63 6f6c 6d69 6e2c 2073 656c  .dim_colmin, sel
+0000ff50: 662e 6469 6d5f 636f 6c6d 6178 202b 2031  f.dim_colmax + 1
+0000ff60: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0000ff70: 2020 2069 6620 636f 6c5f 6e75 6d20 696e     if col_num in
+0000ff80: 2073 656c 662e 7461 626c 655b 726f 775f   self.table[row_
+0000ff90: 6e75 6d5d 3a0a 2020 2020 2020 2020 2020  num]:.          
+0000ffa0: 2020 2020 2020 2020 2020 6365 6c6c 203d            cell =
+0000ffb0: 2073 656c 662e 7461 626c 655b 726f 775f   self.table[row_
+0000ffc0: 6e75 6d5d 5b63 6f6c 5f6e 756d 5d0a 2020  num][col_num].  
+0000ffd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ffe0: 2020 6365 6c6c 5f74 7970 6520 3d20 6365    cell_type = ce
+0000fff0: 6c6c 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  ll.__class__.__n
+00010000: 616d 655f 5f0a 2020 2020 2020 2020 2020  ame__.          
+00010010: 2020 2020 2020 2020 2020 6c65 6e67 7468            length
+00010020: 203d 2030 0a0a 2020 2020 2020 2020 2020   = 0..          
+00010030: 2020 2020 2020 2020 2020 6966 2063 656c            if cel
+00010040: 6c5f 7479 7065 2069 6e20 2822 5374 7269  l_type in ("Stri
+00010050: 6e67 222c 2022 5269 6368 5374 7269 6e67  ng", "RichString
+00010060: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+00010070: 2020 2020 2020 2020 2020 2020 2320 4861              # Ha
+00010080: 6e64 6c65 2073 7472 696e 6773 2061 6e64  ndle strings and
+00010090: 2072 6963 6820 7374 7269 6e67 732e 0a20   rich strings.. 
+000100a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000100b0: 2020 2020 2020 2023 0a20 2020 2020 2020         #.       
+000100c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000100d0: 2023 2046 6f72 2073 7461 6e64 6172 6420   # For standard 
+000100e0: 7368 6172 6564 2073 7472 696e 6773 2077  shared strings w
+000100f0: 6520 646f 2061 2072 6576 6572 7365 206c  e do a reverse l
+00010100: 6f6f 6b75 700a 2020 2020 2020 2020 2020  ookup.          
+00010110: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00010120: 6672 6f6d 2074 6865 2073 6861 7265 6420  from the shared 
+00010130: 7374 7269 6e67 2069 6420 746f 2074 6865  string id to the
+00010140: 2061 6374 7561 6c20 7374 7269 6e67 2e20   actual string. 
+00010150: 466f 720a 2020 2020 2020 2020 2020 2020  For.            
+00010160: 2020 2020 2020 2020 2020 2020 2320 7269              # ri
+00010170: 6368 2073 7472 696e 6773 2077 6520 7573  ch strings we us
+00010180: 6520 7468 6520 756e 666f 726d 6174 7465  e the unformatte
+00010190: 6420 7374 7269 6e67 2e20 5765 2061 6c73  d string. We als
+000101a0: 6f0a 2020 2020 2020 2020 2020 2020 2020  o.              
+000101b0: 2020 2020 2020 2020 2020 2320 7370 6c69            # spli
+000101c0: 7420 6d75 6c74 692d 6c69 6e65 2073 7472  t multi-line str
+000101d0: 696e 6773 2061 6e64 2068 616e 646c 6520  ings and handle 
+000101e0: 6561 6368 2070 6172 740a 2020 2020 2020  each part.      
+000101f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010200: 2020 2320 7365 7061 7261 7465 6c79 2e0a    # separately..
+00010210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010220: 2020 2020 2020 2020 6966 2063 656c 6c5f          if cell_
+00010230: 7479 7065 203d 3d20 2253 7472 696e 6722  type == "String"
+00010240: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00010250: 2020 2020 2020 2020 2020 2020 2020 7374                st
+00010260: 7269 6e67 5f69 6420 3d20 6365 6c6c 2e73  ring_id = cell.s
+00010270: 7472 696e 670a 2020 2020 2020 2020 2020  tring.          
+00010280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010290: 2020 7374 7269 6e67 203d 2073 7472 696e    string = strin
+000102a0: 6773 5b73 7472 696e 675f 6964 5d0a 2020  gs[string_id].  
+000102b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000102c0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000102d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000102e0: 2020 2020 2020 2020 7374 7269 6e67 203d          string =
+000102f0: 2063 656c 6c2e 7261 775f 7374 7269 6e67   cell.raw_string
+00010300: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00010310: 2020 2020 2020 2020 2020 6966 2022 5c6e            if "\n
+00010320: 2220 6e6f 7420 696e 2073 7472 696e 673a  " not in string:
+00010330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010340: 2020 2020 2020 2020 2020 2020 2023 2053               # S
+00010350: 696e 676c 6520 6c69 6e65 2073 7472 696e  ingle line strin
+00010360: 672e 0a20 2020 2020 2020 2020 2020 2020  g..             
+00010370: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00010380: 656e 6774 6820 3d20 786c 5f70 6978 656c  ength = xl_pixel
+00010390: 5f77 6964 7468 2873 7472 696e 6729 0a20  _width(string). 
+000103a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000103b0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
 000103c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000103d0: 2020 2020 2073 7472 696e 6720 3d20 7374       string = st
-000103e0: 7269 6e67 735b 7374 7269 6e67 5f69 645d  rings[string_id]
-000103f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010400: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00010410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010420: 2020 2020 2020 2020 2020 2073 7472 696e             strin
-00010430: 6720 3d20 6365 6c6c 2e72 6177 5f73 7472  g = cell.raw_str
-00010440: 696e 670a 0a20 2020 2020 2020 2020 2020  ing..           
-00010450: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00010460: 225c 6e22 206e 6f74 2069 6e20 7374 7269  "\n" not in stri
-00010470: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
+000103d0: 2020 2020 2020 2020 2023 2048 616e 646c           # Handl
+000103e0: 6520 6d75 6c74 692d 6c69 6e65 2073 7472  e multi-line str
+000103f0: 696e 6773 2e0a 2020 2020 2020 2020 2020  ings..          
+00010400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010410: 2020 666f 7220 7374 7269 6e67 2069 6e20    for string in 
+00010420: 7374 7269 6e67 2e73 706c 6974 2822 5c6e  string.split("\n
+00010430: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+00010440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010450: 2020 2020 7365 675f 6c65 6e67 7468 203d      seg_length =
+00010460: 2078 6c5f 7069 7865 6c5f 7769 6474 6828   xl_pixel_width(
+00010470: 7374 7269 6e67 290a 2020 2020 2020 2020  string).        
 00010480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010490: 2320 5369 6e67 6c65 206c 696e 6520 7374  # Single line st
-000104a0: 7269 6e67 2e0a 2020 2020 2020 2020 2020  ring..          
+00010490: 2020 2020 2020 2020 6966 2073 6567 5f6c          if seg_l
+000104a0: 656e 6774 6820 3e20 6c65 6e67 7468 3a0a  ength > length:.
 000104b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000104c0: 2020 6c65 6e67 7468 203d 2078 6c5f 7069    length = xl_pi
-000104d0: 7865 6c5f 7769 6474 6828 7374 7269 6e67  xel_width(string
-000104e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000104f0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00010500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010510: 2020 2020 2020 2020 2020 2020 2320 4861              # Ha
-00010520: 6e64 6c65 206d 756c 7469 2d6c 696e 6520  ndle multi-line 
-00010530: 7374 7269 6e67 732e 0a20 2020 2020 2020  strings..       
-00010540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010550: 2020 2020 2066 6f72 2073 7472 696e 6720       for string 
-00010560: 696e 2028 7374 7269 6e67 2e73 706c 6974  in (string.split
-00010570: 2822 5c6e 2229 293a 0a20 2020 2020 2020  ("\n")):.       
-00010580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010590: 2020 2020 2020 2020 2073 6567 5f6c 656e           seg_len
-000105a0: 6774 6820 3d20 786c 5f70 6978 656c 5f77  gth = xl_pixel_w
-000105b0: 6964 7468 2873 7472 696e 6729 0a20 2020  idth(string).   
-000105c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000105d0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000105e0: 7365 675f 6c65 6e67 7468 203e 206c 656e  seg_length > len
-000105f0: 6774 683a 0a20 2020 2020 2020 2020 2020  gth:.           
-00010600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010610: 2020 2020 2020 2020 206c 656e 6774 6820           length 
-00010620: 3d20 7365 675f 6c65 6e67 7468 0a0a 2020  = seg_length..  
-00010630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010640: 2020 656c 6966 2063 656c 6c5f 7479 7065    elif cell_type
-00010650: 203d 3d20 274e 756d 6265 7227 3a0a 2020   == 'Number':.  
-00010660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010670: 2020 2020 2020 2320 4861 6e64 6c65 206e        # Handle n
-00010680: 756d 6265 7273 2e0a 2020 2020 2020 2020  umbers..        
-00010690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000106a0: 230a 2020 2020 2020 2020 2020 2020 2020  #.              
-000106b0: 2020 2020 2020 2020 2020 2320 5765 2075            # We u
-000106c0: 7365 2061 2077 6f72 6b61 726f 756e 642f  se a workaround/
-000106d0: 6f70 7469 6d69 7a61 7469 6f6e 2066 6f72  optimization for
-000106e0: 206e 756d 6265 7273 2073 696e 6365 0a20   numbers since. 
-000106f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010700: 2020 2020 2020 2023 2064 6967 6974 7320         # digits 
-00010710: 616c 6c20 6861 7665 2061 2070 6978 656c  all have a pixel
-00010720: 2077 6964 7468 206f 6620 372e 2054 6869   width of 7. Thi
-00010730: 7320 6769 7665 7320 610a 2020 2020 2020  s gives a.      
-00010740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010750: 2020 2320 736c 6967 6874 6c79 2067 7265    # slightly gre
-00010760: 6174 6572 2077 6964 7468 2066 6f72 2074  ater width for t
-00010770: 6865 2064 6563 696d 616c 2070 6c61 6365  he decimal place
-00010780: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
-00010790: 2020 2020 2020 2020 2020 2020 2023 206d               # m
-000107a0: 696e 7573 2073 6967 6e20 6275 7420 6f6e  inus sign but on
-000107b0: 6c79 2062 7920 6120 6665 7720 7069 7865  ly by a few pixe
-000107c0: 6c73 2061 6e64 0a20 2020 2020 2020 2020  ls and.         
-000107d0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-000107e0: 206f 7665 722d 6573 7469 6d61 7469 6f6e   over-estimation
-000107f0: 2069 7320 6f6b 6179 2e0a 2020 2020 2020   is okay..      
-00010800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010810: 2020 6c65 6e67 7468 203d 2037 202a 206c    length = 7 * l
-00010820: 656e 2873 7472 2863 656c 6c2e 6e75 6d62  en(str(cell.numb
-00010830: 6572 2929 0a0a 2020 2020 2020 2020 2020  er))..          
-00010840: 2020 2020 2020 2020 2020 656c 6966 2063            elif c
-00010850: 656c 6c5f 7479 7065 203d 3d20 2744 6174  ell_type == 'Dat
-00010860: 6574 696d 6527 3a0a 2020 2020 2020 2020  etime':.        
-00010870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010880: 2320 4861 6e64 6c65 2064 6174 6573 2e0a  # Handle dates..
-00010890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000108a0: 2020 2020 2020 2020 230a 2020 2020 2020          #.      
-000108b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000108c0: 2020 2320 5468 6520 666f 6c6c 6f77 696e    # The followin
-000108d0: 6720 7573 6573 2074 6865 2064 6566 6175  g uses the defau
-000108e0: 6c74 2077 6964 7468 2066 6f72 206d 6d2f  lt width for mm/
-000108f0: 6464 2f79 7979 790a 2020 2020 2020 2020  dd/yyyy.        
-00010900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010910: 2320 6461 7465 732e 2049 7420 6973 6e27  # dates. It isn'
-00010920: 7420 6665 6173 6962 6c65 2074 6f20 7061  t feasible to pa
-00010930: 7273 6520 7468 6520 6e75 6d62 6572 2066  rse the number f
-00010940: 6f72 6d61 740a 2020 2020 2020 2020 2020  ormat.          
-00010950: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00010960: 746f 2067 6574 2074 6865 2061 6374 7561  to get the actua
-00010970: 6c20 7374 7269 6e67 2077 6964 7468 2066  l string width f
-00010980: 6f72 2061 6c6c 2066 6f72 6d61 7420 7479  or all format ty
-00010990: 7065 732e 0a20 2020 2020 2020 2020 2020  pes..           
-000109a0: 2020 2020 2020 2020 2020 2020 206c 656e               len
-000109b0: 6774 6820 3d20 7365 6c66 2e64 6566 6175  gth = self.defau
-000109c0: 6c74 5f64 6174 655f 7069 7865 6c73 0a0a  lt_date_pixels..
-000109d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000109e0: 2020 2020 656c 6966 2063 656c 6c5f 7479      elif cell_ty
-000109f0: 7065 203d 3d20 2742 6f6f 6c65 616e 273a  pe == 'Boolean':
-00010a00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010a10: 2020 2020 2020 2020 2023 2048 616e 646c           # Handl
-00010a20: 6520 626f 6f6c 6561 6e20 7661 6c75 6573  e boolean values
-00010a30: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00010a40: 2020 2020 2020 2020 2020 230a 2020 2020            #.    
-00010a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010a60: 2020 2020 2320 5573 6520 7468 6520 4578      # Use the Ex
-00010a70: 6365 6c20 7374 616e 6461 7264 2077 6964  cel standard wid
-00010a80: 7468 7320 666f 7220 5452 5545 2061 6e64  ths for TRUE and
-00010a90: 2046 414c 5345 2e0a 2020 2020 2020 2020   FALSE..        
-00010aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ab0: 6966 2063 656c 6c2e 626f 6f6c 6561 6e3a  if cell.boolean:
-00010ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010ad0: 2020 2020 2020 2020 2020 2020 206c 656e               len
-00010ae0: 6774 6820 3d20 3331 0a20 2020 2020 2020  gth = 31.       
-00010af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010b00: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00010b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010b20: 2020 206c 656e 6774 6820 3d20 3336 0a0a     length = 36..
-00010b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010b40: 2020 2020 656c 6966 2028 6365 6c6c 5f74      elif (cell_t
-00010b50: 7970 6520 3d3d 2027 466f 726d 756c 6127  ype == 'Formula'
+000104c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000104d0: 2020 2020 6c65 6e67 7468 203d 2073 6567      length = seg
+000104e0: 5f6c 656e 6774 680a 0a20 2020 2020 2020  _length..       
+000104f0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00010500: 6620 6365 6c6c 5f74 7970 6520 3d3d 2022  f cell_type == "
+00010510: 4e75 6d62 6572 223a 0a20 2020 2020 2020  Number":.       
+00010520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010530: 2023 2048 616e 646c 6520 6e75 6d62 6572   # Handle number
+00010540: 732e 0a20 2020 2020 2020 2020 2020 2020  s..             
+00010550: 2020 2020 2020 2020 2020 2023 0a20 2020             #.   
+00010560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010570: 2020 2020 2023 2057 6520 7573 6520 6120       # We use a 
+00010580: 776f 726b 6172 6f75 6e64 2f6f 7074 696d  workaround/optim
+00010590: 697a 6174 696f 6e20 666f 7220 6e75 6d62  ization for numb
+000105a0: 6572 7320 7369 6e63 650a 2020 2020 2020  ers since.      
+000105b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000105c0: 2020 2320 6469 6769 7473 2061 6c6c 2068    # digits all h
+000105d0: 6176 6520 6120 7069 7865 6c20 7769 6474  ave a pixel widt
+000105e0: 6820 6f66 2037 2e20 5468 6973 2067 6976  h of 7. This giv
+000105f0: 6573 2061 0a20 2020 2020 2020 2020 2020  es a.           
+00010600: 2020 2020 2020 2020 2020 2020 2023 2073               # s
+00010610: 6c69 6768 746c 7920 6772 6561 7465 7220  lightly greater 
+00010620: 7769 6474 6820 666f 7220 7468 6520 6465  width for the de
+00010630: 6369 6d61 6c20 706c 6163 6520 616e 640a  cimal place and.
+00010640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010650: 2020 2020 2020 2020 2320 6d69 6e75 7320          # minus 
+00010660: 7369 676e 2062 7574 206f 6e6c 7920 6279  sign but only by
+00010670: 2061 2066 6577 2070 6978 656c 7320 616e   a few pixels an
+00010680: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+00010690: 2020 2020 2020 2020 2020 2320 6f76 6572            # over
+000106a0: 2d65 7374 696d 6174 696f 6e20 6973 206f  -estimation is o
+000106b0: 6b61 792e 0a20 2020 2020 2020 2020 2020  kay..           
+000106c0: 2020 2020 2020 2020 2020 2020 206c 656e               len
+000106d0: 6774 6820 3d20 3720 2a20 6c65 6e28 7374  gth = 7 * len(st
+000106e0: 7228 6365 6c6c 2e6e 756d 6265 7229 290a  r(cell.number)).
+000106f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010700: 2020 2020 2065 6c69 6620 6365 6c6c 5f74       elif cell_t
+00010710: 7970 6520 3d3d 2022 4461 7465 7469 6d65  ype == "Datetime
+00010720: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
+00010730: 2020 2020 2020 2020 2020 2023 2048 616e             # Han
+00010740: 646c 6520 6461 7465 732e 0a20 2020 2020  dle dates..     
+00010750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010760: 2020 2023 0a20 2020 2020 2020 2020 2020     #.           
+00010770: 2020 2020 2020 2020 2020 2020 2023 2054               # T
+00010780: 6865 2066 6f6c 6c6f 7769 6e67 2075 7365  he following use
+00010790: 7320 7468 6520 6465 6661 756c 7420 7769  s the default wi
+000107a0: 6474 6820 666f 7220 6d6d 2f64 642f 7979  dth for mm/dd/yy
+000107b0: 7979 0a20 2020 2020 2020 2020 2020 2020  yy.             
+000107c0: 2020 2020 2020 2020 2020 2023 2064 6174             # dat
+000107d0: 6573 2e20 4974 2069 736e 2774 2066 6561  es. It isn't fea
+000107e0: 7369 626c 6520 746f 2070 6172 7365 2074  sible to parse t
+000107f0: 6865 206e 756d 6265 7220 666f 726d 6174  he number format
+00010800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010810: 2020 2020 2020 2020 2023 2074 6f20 6765           # to ge
+00010820: 7420 7468 6520 6163 7475 616c 2073 7472  t the actual str
+00010830: 696e 6720 7769 6474 6820 666f 7220 616c  ing width for al
+00010840: 6c20 666f 726d 6174 2074 7970 6573 2e0a  l format types..
+00010850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010860: 2020 2020 2020 2020 6c65 6e67 7468 203d          length =
+00010870: 2073 656c 662e 6465 6661 756c 745f 6461   self.default_da
+00010880: 7465 5f70 6978 656c 730a 0a20 2020 2020  te_pixels..     
+00010890: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000108a0: 6c69 6620 6365 6c6c 5f74 7970 6520 3d3d  lif cell_type ==
+000108b0: 2022 426f 6f6c 6561 6e22 3a0a 2020 2020   "Boolean":.    
+000108c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000108d0: 2020 2020 2320 4861 6e64 6c65 2062 6f6f      # Handle boo
+000108e0: 6c65 616e 2076 616c 7565 732e 0a20 2020  lean values..   
+000108f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010900: 2020 2020 2023 0a20 2020 2020 2020 2020       #.         
+00010910: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00010920: 2055 7365 2074 6865 2045 7863 656c 2073   Use the Excel s
+00010930: 7461 6e64 6172 6420 7769 6474 6873 2066  tandard widths f
+00010940: 6f72 2054 5255 4520 616e 6420 4641 4c53  or TRUE and FALS
+00010950: 452e 0a20 2020 2020 2020 2020 2020 2020  E..             
+00010960: 2020 2020 2020 2020 2020 2069 6620 6365             if ce
+00010970: 6c6c 2e62 6f6f 6c65 616e 3a0a 2020 2020  ll.boolean:.    
+00010980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010990: 2020 2020 2020 2020 6c65 6e67 7468 203d          length =
+000109a0: 2033 310a 2020 2020 2020 2020 2020 2020   31.            
+000109b0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000109c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000109d0: 2020 2020 2020 2020 2020 2020 2020 6c65                le
+000109e0: 6e67 7468 203d 2033 360a 0a20 2020 2020  ngth = 36..     
+000109f0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00010a00: 6c69 6620 6365 6c6c 5f74 7970 6520 3d3d  lif cell_type ==
+00010a10: 2022 466f 726d 756c 6122 206f 7220 6365   "Formula" or ce
+00010a20: 6c6c 5f74 7970 6520 3d3d 2022 4172 7261  ll_type == "Arra
+00010a30: 7946 6f72 6d75 6c61 223a 0a20 2020 2020  yFormula":.     
+00010a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010a50: 2020 2023 2048 616e 646c 6520 666f 726d     # Handle form
+00010a60: 756c 6173 2e0a 2020 2020 2020 2020 2020  ulas..          
+00010a70: 2020 2020 2020 2020 2020 2020 2020 230a                #.
+00010a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010a90: 2020 2020 2020 2020 2320 5765 206f 6e6c          # We onl
+00010aa0: 7920 7472 7920 746f 2061 7574 6f66 6974  y try to autofit
+00010ab0: 2061 2066 6f72 6d75 6c61 2069 6620 6974   a formula if it
+00010ac0: 2068 6173 2061 0a20 2020 2020 2020 2020   has a.         
+00010ad0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00010ae0: 206e 6f6e 2d7a 6572 6f20 7661 6c75 652e   non-zero value.
+00010af0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010b00: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
+00010b10: 7374 616e 6365 2863 656c 6c2e 7661 6c75  stance(cell.valu
+00010b20: 652c 2028 666c 6f61 742c 2069 6e74 2929  e, (float, int))
+00010b30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00010b40: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00010b50: 2063 656c 6c2e 7661 6c75 6520 3e20 303a   cell.value > 0:
 00010b60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010b70: 2020 2020 2020 2020 2020 2020 206f 7220               or 
-00010b80: 6365 6c6c 5f74 7970 6520 3d3d 2027 4172  cell_type == 'Ar
-00010b90: 7261 7946 6f72 6d75 6c61 2729 3a0a 2020  rayFormula'):.  
-00010ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010bb0: 2020 2020 2020 2320 4861 6e64 6c65 2066        # Handle f
-00010bc0: 6f72 6d75 6c61 732e 0a20 2020 2020 2020  ormulas..       
-00010bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010be0: 2023 0a20 2020 2020 2020 2020 2020 2020   #.             
-00010bf0: 2020 2020 2020 2020 2020 2023 2057 6520             # We 
-00010c00: 6f6e 6c79 2074 7279 2074 6f20 6175 746f  only try to auto
-00010c10: 6669 7420 6120 666f 726d 756c 6120 6966  fit a formula if
-00010c20: 2069 7420 6861 7320 610a 2020 2020 2020   it has a.      
-00010c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010c40: 2020 2320 6e6f 6e2d 7a65 726f 2076 616c    # non-zero val
-00010c50: 7565 2e0a 2020 2020 2020 2020 2020 2020  ue..            
-00010c60: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00010c70: 7369 6e73 7461 6e63 6528 6365 6c6c 2e76  sinstance(cell.v
-00010c80: 616c 7565 2c20 2866 6c6f 6174 2c20 696e  alue, (float, in
-00010c90: 7429 293a 0a20 2020 2020 2020 2020 2020  t)):.           
-00010ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010cb0: 2069 6620 6365 6c6c 2e76 616c 7565 203e   if cell.value >
-00010cc0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+00010b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010b80: 206c 656e 6774 6820 3d20 3720 2a20 6c65   length = 7 * le
+00010b90: 6e28 7374 7228 6365 6c6c 2e76 616c 7565  n(str(cell.value
+00010ba0: 2929 0a0a 2020 2020 2020 2020 2020 2020  ))..            
+00010bb0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00010bc0: 2069 7369 6e73 7461 6e63 6528 6365 6c6c   isinstance(cell
+00010bd0: 2e76 616c 7565 2c20 7374 7229 3a0a 2020  .value, str):.  
+00010be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010bf0: 2020 2020 2020 2020 2020 6c65 6e67 7468            length
+00010c00: 203d 2078 6c5f 7069 7865 6c5f 7769 6474   = xl_pixel_widt
+00010c10: 6828 6365 6c6c 2e76 616c 7565 290a 0a20  h(cell.value).. 
+00010c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010c30: 2020 2020 2020 2065 6c69 6620 7479 7065         elif type
+00010c40: 2863 656c 6c2e 7661 6c75 6529 203d 3d20  (cell.value) == 
+00010c50: 626f 6f6c 3a0a 2020 2020 2020 2020 2020  bool:.          
+00010c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010c70: 2020 6966 2063 656c 6c2e 7661 6c75 653a    if cell.value:
+00010c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010ca0: 206c 656e 6774 6820 3d20 3331 0a20 2020   length = 31.   
+00010cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010cc0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
 00010cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ce0: 2020 2020 6c65 6e67 7468 203d 2037 202a      length = 7 *
-00010cf0: 206c 656e 2873 7472 2863 656c 6c2e 7661   len(str(cell.va
-00010d00: 6c75 6529 290a 0a20 2020 2020 2020 2020  lue))..         
-00010d10: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00010d20: 6c69 6620 6973 696e 7374 616e 6365 2863  lif isinstance(c
-00010d30: 656c 6c2e 7661 6c75 652c 2073 7472 293a  ell.value, str):
-00010d40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010d50: 2020 2020 2020 2020 2020 2020 206c 656e               len
-00010d60: 6774 6820 3d20 786c 5f70 6978 656c 5f77  gth = xl_pixel_w
-00010d70: 6964 7468 2863 656c 6c2e 7661 6c75 6529  idth(cell.value)
-00010d80: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00010d90: 2020 2020 2020 2020 2020 656c 6966 2074            elif t
-00010da0: 7970 6528 6365 6c6c 2e76 616c 7565 2920  ype(cell.value) 
-00010db0: 3d3d 2062 6f6f 6c3a 0a20 2020 2020 2020  == bool:.       
-00010dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010dd0: 2020 2020 2069 6620 6365 6c6c 2e76 616c       if cell.val
-00010de0: 7565 3a0a 2020 2020 2020 2020 2020 2020  ue:.            
+00010ce0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00010cf0: 656e 6774 6820 3d20 3336 0a0a 2020 2020  ength = 36..    
+00010d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010d10: 2320 4966 2074 6865 2063 656c 6c20 6973  # If the cell is
+00010d20: 2069 6e20 616e 2061 7574 6f66 696c 7465   in an autofilte
+00010d30: 7220 6865 6164 6572 2077 6520 6164 6420  r header we add 
+00010d40: 616e 0a20 2020 2020 2020 2020 2020 2020  an.             
+00010d50: 2020 2020 2020 2023 2061 6464 6974 696f         # additio
+00010d60: 6e61 6c20 3136 2070 6978 656c 7320 666f  nal 16 pixels fo
+00010d70: 7220 7468 6520 6472 6f70 646f 776e 2061  r the dropdown a
+00010d80: 7272 6f77 2e0a 2020 2020 2020 2020 2020  rrow..          
+00010d90: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00010da0: 662e 6669 6c74 6572 5f63 656c 6c73 2e67  f.filter_cells.g
+00010db0: 6574 2828 726f 775f 6e75 6d2c 2063 6f6c  et((row_num, col
+00010dc0: 5f6e 756d 2929 3a0a 2020 2020 2020 2020  _num)):.        
+00010dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010de0: 6966 206c 656e 6774 6820 3e20 303a 0a20  if length > 0:. 
 00010df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010e00: 2020 2020 6c65 6e67 7468 203d 2033 310a      length = 31.
-00010e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010e20: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00010e30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00010e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010e50: 2020 6c65 6e67 7468 203d 2033 360a 0a20    length = 36.. 
-00010e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010e70: 2020 2023 2049 6620 7468 6520 6365 6c6c     # If the cell
-00010e80: 2069 7320 696e 2061 6e20 6175 746f 6669   is in an autofi
-00010e90: 6c74 6572 2068 6561 6465 7220 7765 2061  lter header we a
-00010ea0: 6464 2061 6e0a 2020 2020 2020 2020 2020  dd an.          
-00010eb0: 2020 2020 2020 2020 2020 2320 6164 6469            # addi
-00010ec0: 7469 6f6e 616c 2031 3620 7069 7865 6c73  tional 16 pixels
-00010ed0: 2066 6f72 2074 6865 2064 726f 7064 6f77   for the dropdow
-00010ee0: 6e20 6172 726f 772e 0a20 2020 2020 2020  n arrow..       
-00010ef0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00010f00: 7365 6c66 2e66 696c 7465 725f 6365 6c6c  self.filter_cell
-00010f10: 732e 6765 7428 2872 6f77 5f6e 756d 2c20  s.get((row_num, 
-00010f20: 636f 6c5f 6e75 6d29 293a 0a20 2020 2020  col_num)):.     
-00010f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010f40: 2020 2069 6620 6c65 6e67 7468 203e 2030     if length > 0
-00010f50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00010f60: 2020 2020 2020 2020 2020 2020 2020 6c65                le
-00010f70: 6e67 7468 202b 3d20 3136 0a0a 2020 2020  ngth += 16..    
-00010f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010f90: 2320 4164 6420 7468 6520 7374 7269 6e67  # Add the string
-00010fa0: 206c 656e 6774 6820 746f 2074 6865 206c   length to the l
-00010fb0: 6f6f 6b75 7020 7461 626c 652e 0a20 2020  ookup table..   
-00010fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010fd0: 206d 6178 203d 2063 6f6c 5f77 6964 7468   max = col_width
-00010fe0: 5f6d 6178 2e67 6574 2863 6f6c 5f6e 756d  _max.get(col_num
-00010ff0: 2c20 3029 0a20 2020 2020 2020 2020 2020  , 0).           
-00011000: 2020 2020 2020 2020 2069 6620 6c65 6e67           if leng
-00011010: 7468 203e 206d 6178 3a0a 2020 2020 2020  th > max:.      
-00011020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011030: 2020 636f 6c5f 7769 6474 685f 6d61 785b    col_width_max[
-00011040: 636f 6c5f 6e75 6d5d 203d 206c 656e 6774  col_num] = lengt
-00011050: 680a 0a20 2020 2020 2020 2023 2041 7070  h..        # App
-00011060: 6c79 2074 6865 2077 6964 7468 2074 6f20  ly the width to 
-00011070: 7468 6520 636f 6c75 6d6e 2e0a 2020 2020  the column..    
-00011080: 2020 2020 666f 7220 2863 6f6c 5f6e 756d      for (col_num
-00011090: 2c20 7069 7865 6c5f 7769 6474 6829 2069  , pixel_width) i
-000110a0: 6e20 636f 6c5f 7769 6474 685f 6d61 782e  n col_width_max.
-000110b0: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
-000110c0: 2020 2020 2023 2043 6f6e 7665 7274 2074       # Convert t
-000110d0: 6865 2073 7472 696e 6720 7069 7865 6c20  he string pixel 
-000110e0: 7769 6474 6820 746f 2061 2063 6861 7261  width to a chara
-000110f0: 6374 6572 2077 6964 7468 2075 7369 6e67  cter width using
-00011100: 2061 6e0a 2020 2020 2020 2020 2020 2020   an.            
-00011110: 2320 6164 6469 7469 6f6e 616c 2070 6164  # additional pad
-00011120: 6469 6e67 206f 6620 3720 7069 7865 6c73  ding of 7 pixels
-00011130: 2c20 6c69 6b65 2045 7863 656c 2e0a 2020  , like Excel..  
-00011140: 2020 2020 2020 2020 2020 7769 6474 6820            width 
-00011150: 3d20 7365 6c66 2e5f 7069 7865 6c73 5f74  = self._pixels_t
-00011160: 6f5f 7769 6474 6828 7069 7865 6c5f 7769  o_width(pixel_wi
-00011170: 6474 6820 2b20 3729 0a0a 2020 2020 2020  dth + 7)..      
-00011180: 2020 2020 2020 2320 5468 6520 6d61 7820        # The max 
-00011190: 636f 6c75 6d6e 2063 6861 7261 6374 6572  column character
-000111a0: 2077 6964 7468 2069 6e20 4578 6365 6c20   width in Excel 
-000111b0: 6973 2032 3535 2e0a 2020 2020 2020 2020  is 255..        
-000111c0: 2020 2020 6966 2077 6964 7468 203e 2032      if width > 2
-000111d0: 3535 2e30 3a0a 2020 2020 2020 2020 2020  55.0:.          
-000111e0: 2020 2020 2020 7769 6474 6820 3d20 3235        width = 25
-000111f0: 352e 300a 0a20 2020 2020 2020 2020 2020  5.0..           
-00011200: 2023 2041 6464 2074 6865 2077 6964 7468   # Add the width
-00011210: 2074 6f20 616e 2065 7869 7374 696e 6720   to an existing 
-00011220: 636f 6c20 696e 666f 2073 7472 7563 7475  col info structu
-00011230: 7265 206f 7220 6164 6420 6120 6e65 7720  re or add a new 
-00011240: 6f6e 652e 0a20 2020 2020 2020 2020 2020  one..           
-00011250: 2069 6620 7365 6c66 2e63 6f6c 5f69 6e66   if self.col_inf
-00011260: 6f2e 6765 7428 636f 6c5f 6e75 6d29 3a0a  o.get(col_num):.
-00011270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011280: 2320 5765 206f 6e6c 7920 7570 6461 7465  # We only update
-00011290: 2074 6865 2077 6964 7468 2066 6f72 2061   the width for a
-000112a0: 6e20 6578 6973 7469 6e67 2063 6f6c 756d  n existing colum
-000112b0: 6e20 6966 2069 7420 6973 0a20 2020 2020  n if it is.     
-000112c0: 2020 2020 2020 2020 2020 2023 2067 7265             # gre
-000112d0: 6174 6572 2074 6861 6e20 7468 6520 7573  ater than the us
-000112e0: 6572 2064 6566 696e 6564 2076 616c 7565  er defined value
-000112f0: 2e20 5468 6973 2061 6c6c 6f77 7320 7468  . This allows th
-00011300: 6520 7573 6572 0a20 2020 2020 2020 2020  e user.         
-00011310: 2020 2020 2020 2023 2074 6f20 7072 652d         # to pre-
-00011320: 6c6f 6164 2061 206d 696e 696d 756d 2063  load a minimum c
-00011330: 6f6c 2077 6964 7468 2e0a 2020 2020 2020  ol width..      
-00011340: 2020 2020 2020 2020 2020 636f 6c5f 696e            col_in
-00011350: 666f 203d 2073 656c 662e 636f 6c5f 696e  fo = self.col_in
-00011360: 666f 2e67 6574 2863 6f6c 5f6e 756d 290a  fo.get(col_num).
-00011370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011380: 7573 6572 5f77 6964 7468 203d 2063 6f6c  user_width = col
-00011390: 5f69 6e66 6f5b 305d 0a20 2020 2020 2020  _info[0].       
-000113a0: 2020 2020 2020 2020 2068 6964 6465 6e20           hidden 
-000113b0: 3d20 636f 6c5f 696e 666f 5b35 5d0a 2020  = col_info[5].  
-000113c0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000113d0: 2075 7365 725f 7769 6474 6820 6973 206e   user_width is n
-000113e0: 6f74 204e 6f6e 6520 616e 6420 6e6f 7420  ot None and not 
-000113f0: 6869 6464 656e 3a0a 2020 2020 2020 2020  hidden:.        
-00011400: 2020 2020 2020 2020 2020 2020 2320 436f              # Co
-00011410: 6c20 696e 666f 2069 7320 7573 6572 2064  l info is user d
-00011420: 6566 696e 6564 2e0a 2020 2020 2020 2020  efined..        
-00011430: 2020 2020 2020 2020 2020 2020 6966 2077              if w
-00011440: 6964 7468 203e 2075 7365 725f 7769 6474  idth > user_widt
-00011450: 683a 0a20 2020 2020 2020 2020 2020 2020  h:.             
-00011460: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00011470: 636f 6c5f 696e 666f 5b63 6f6c 5f6e 756d  col_info[col_num
-00011480: 5d5b 305d 203d 2077 6964 7468 0a20 2020  ][0] = width.   
-00011490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000114a0: 2020 2020 2073 656c 662e 636f 6c5f 696e       self.col_in
-000114b0: 666f 5b63 6f6c 5f6e 756d 5d5b 355d 203d  fo[col_num][5] =
-000114c0: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
-000114d0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000114e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000114f0: 7365 6c66 2e63 6f6c 5f69 6e66 6f5b 636f  self.col_info[co
-00011500: 6c5f 6e75 6d5d 5b30 5d20 3d20 7769 6474  l_num][0] = widt
-00011510: 680a 2020 2020 2020 2020 2020 2020 2020  h.              
-00011520: 2020 2020 2020 7365 6c66 2e63 6f6c 5f69        self.col_i
-00011530: 6e66 6f5b 636f 6c5f 6e75 6d5d 5b35 5d20  nfo[col_num][5] 
-00011540: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
-00011550: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00011560: 2020 2020 2020 2020 2073 656c 662e 636f           self.co
-00011570: 6c5f 696e 666f 5b63 6f6c 5f6e 756d 5d20  l_info[col_num] 
-00011580: 3d20 5b77 6964 7468 2c20 4e6f 6e65 2c20  = [width, None, 
-00011590: 4661 6c73 652c 2030 2c20 4661 6c73 652c  False, 0, False,
-000115a0: 2054 7275 655d 0a0a 2020 2020 6465 6620   True]..    def 
-000115b0: 7365 745f 726f 7728 7365 6c66 2c20 726f  set_row(self, ro
-000115c0: 772c 2068 6569 6768 743d 4e6f 6e65 2c20  w, height=None, 
-000115d0: 6365 6c6c 5f66 6f72 6d61 743d 4e6f 6e65  cell_format=None
-000115e0: 2c20 6f70 7469 6f6e 733d 4e6f 6e65 293a  , options=None):
-000115f0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00011600: 2020 2020 2053 6574 2074 6865 2077 6964       Set the wid
-00011610: 7468 2c20 616e 6420 6f74 6865 7220 7072  th, and other pr
-00011620: 6f70 6572 7469 6573 206f 6620 6120 726f  operties of a ro
-00011630: 772e 0a0a 2020 2020 2020 2020 4172 6773  w...        Args
-00011640: 3a0a 2020 2020 2020 2020 2020 2020 726f  :.            ro
-00011650: 773a 2020 2020 2020 2020 2052 6f77 206e  w:         Row n
-00011660: 756d 6265 7220 287a 6572 6f2d 696e 6465  umber (zero-inde
-00011670: 7865 6429 2e0a 2020 2020 2020 2020 2020  xed)..          
-00011680: 2020 6865 6967 6874 3a20 2020 2020 2052    height:      R
-00011690: 6f77 2068 6569 6768 742e 2028 6f70 7469  ow height. (opti
-000116a0: 6f6e 616c 292e 0a20 2020 2020 2020 2020  onal)..         
-000116b0: 2020 2063 656c 6c5f 666f 726d 6174 3a20     cell_format: 
-000116c0: 526f 7720 6365 6c6c 5f66 6f72 6d61 742e  Row cell_format.
-000116d0: 2028 6f70 7469 6f6e 616c 292e 0a20 2020   (optional)..   
-000116e0: 2020 2020 2020 2020 206f 7074 696f 6e73           options
-000116f0: 3a20 2020 2020 4469 6374 206f 6620 6f70  :     Dict of op
-00011700: 7469 6f6e 7320 7375 6368 2061 7320 6869  tions such as hi
-00011710: 6464 656e 2c20 6c65 7665 6c20 616e 6420  dden, level and 
-00011720: 636f 6c6c 6170 7365 642e 0a0a 2020 2020  collapsed...    
-00011730: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
-00011740: 2020 2020 2020 2020 2030 3a20 2053 7563           0:  Suc
-00011750: 6365 7373 2e0a 2020 2020 2020 2020 2020  cess..          
-00011760: 2020 2d31 3a20 526f 7720 6e75 6d62 6572    -1: Row number
-00011770: 2069 7320 6f75 7420 6f66 2077 6f72 6b73   is out of works
-00011780: 6865 6574 2062 6f75 6e64 732e 0a0a 2020  heet bounds...  
-00011790: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000117a0: 2020 6966 206f 7074 696f 6e73 2069 7320    if options is 
-000117b0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-000117c0: 2020 6f70 7469 6f6e 7320 3d20 7b7d 0a0a    options = {}..
-000117d0: 2020 2020 2020 2020 2320 5573 6520 6d69          # Use mi
-000117e0: 6e69 6d75 6d20 636f 6c20 696e 205f 6368  nimum col in _ch
-000117f0: 6563 6b5f 6469 6d65 6e73 696f 6e73 2829  eck_dimensions()
-00011800: 2e0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-00011810: 662e 6469 6d5f 636f 6c6d 696e 2069 7320  f.dim_colmin is 
-00011820: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00011830: 2020 2020 2020 6d69 6e5f 636f 6c20 3d20        min_col = 
-00011840: 7365 6c66 2e64 696d 5f63 6f6c 6d69 6e0a  self.dim_colmin.
-00011850: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00011860: 2020 2020 2020 2020 2020 6d69 6e5f 636f            min_co
-00011870: 6c20 3d20 300a 0a20 2020 2020 2020 2023  l = 0..        #
-00011880: 2043 6865 636b 2074 6861 7420 726f 7720   Check that row 
-00011890: 6973 2076 616c 6964 2e0a 2020 2020 2020  is valid..      
-000118a0: 2020 6966 2073 656c 662e 5f63 6865 636b    if self._check
-000118b0: 5f64 696d 656e 7369 6f6e 7328 726f 772c  _dimensions(row,
-000118c0: 206d 696e 5f63 6f6c 293a 0a20 2020 2020   min_col):.     
-000118d0: 2020 2020 2020 2072 6574 7572 6e20 2d31         return -1
-000118e0: 0a0a 2020 2020 2020 2020 6966 2068 6569  ..        if hei
-000118f0: 6768 7420 6973 204e 6f6e 653a 0a20 2020  ght is None:.   
-00011900: 2020 2020 2020 2020 2068 6569 6768 7420           height 
-00011910: 3d20 7365 6c66 2e64 6566 6175 6c74 5f72  = self.default_r
-00011920: 6f77 5f68 6569 6768 740a 0a20 2020 2020  ow_height..     
-00011930: 2020 2023 2053 6574 206f 7074 696f 6e61     # Set optiona
-00011940: 6c20 726f 7720 7661 6c75 6573 2e0a 2020  l row values..  
-00011950: 2020 2020 2020 6869 6464 656e 203d 206f        hidden = o
-00011960: 7074 696f 6e73 2e67 6574 2827 6869 6464  ptions.get('hidd
-00011970: 656e 272c 2046 616c 7365 290a 2020 2020  en', False).    
-00011980: 2020 2020 636f 6c6c 6170 7365 6420 3d20      collapsed = 
-00011990: 6f70 7469 6f6e 732e 6765 7428 2763 6f6c  options.get('col
-000119a0: 6c61 7073 6564 272c 2046 616c 7365 290a  lapsed', False).
-000119b0: 2020 2020 2020 2020 6c65 7665 6c20 3d20          level = 
-000119c0: 6f70 7469 6f6e 732e 6765 7428 276c 6576  options.get('lev
-000119d0: 656c 272c 2030 290a 0a20 2020 2020 2020  el', 0)..       
-000119e0: 2023 2049 6620 7468 6520 6865 6967 6874   # If the height
-000119f0: 2069 7320 3020 7468 6520 726f 7720 6973   is 0 the row is
-00011a00: 2068 6964 6465 6e20 616e 6420 7468 6520   hidden and the 
-00011a10: 6865 6967 6874 2069 7320 7468 6520 6465  height is the de
-00011a20: 6661 756c 742e 0a20 2020 2020 2020 2069  fault..        i
-00011a30: 6620 6865 6967 6874 203d 3d20 303a 0a20  f height == 0:. 
-00011a40: 2020 2020 2020 2020 2020 2068 6964 6465             hidde
-00011a50: 6e20 3d20 310a 2020 2020 2020 2020 2020  n = 1.          
-00011a60: 2020 6865 6967 6874 203d 2073 656c 662e    height = self.
-00011a70: 6465 6661 756c 745f 726f 775f 6865 6967  default_row_heig
-00011a80: 6874 0a0a 2020 2020 2020 2020 2320 5365  ht..        # Se
-00011a90: 7420 7468 6520 6c69 6d69 7473 2066 6f72  t the limits for
-00011aa0: 2074 6865 206f 7574 6c69 6e65 206c 6576   the outline lev
-00011ab0: 656c 7320 2830 203c 3d20 7820 3c3d 2037  els (0 <= x <= 7
-00011ac0: 292e 0a20 2020 2020 2020 2069 6620 6c65  )..        if le
-00011ad0: 7665 6c20 3c20 303a 0a20 2020 2020 2020  vel < 0:.       
-00011ae0: 2020 2020 206c 6576 656c 203d 2030 0a20       level = 0. 
-00011af0: 2020 2020 2020 2069 6620 6c65 7665 6c20         if level 
-00011b00: 3e20 373a 0a20 2020 2020 2020 2020 2020  > 7:.           
-00011b10: 206c 6576 656c 203d 2037 0a0a 2020 2020   level = 7..    
-00011b20: 2020 2020 6966 206c 6576 656c 203e 2073      if level > s
-00011b30: 656c 662e 6f75 746c 696e 655f 726f 775f  elf.outline_row_
-00011b40: 6c65 7665 6c3a 0a20 2020 2020 2020 2020  level:.         
-00011b50: 2020 2073 656c 662e 6f75 746c 696e 655f     self.outline_
-00011b60: 726f 775f 6c65 7665 6c20 3d20 6c65 7665  row_level = leve
-00011b70: 6c0a 0a20 2020 2020 2020 2023 2053 746f  l..        # Sto
-00011b80: 7265 2074 6865 2072 6f77 2070 726f 7065  re the row prope
-00011b90: 7274 6965 732e 0a20 2020 2020 2020 2073  rties..        s
-00011ba0: 656c 662e 7365 745f 726f 7773 5b72 6f77  elf.set_rows[row
-00011bb0: 5d20 3d20 5b68 6569 6768 742c 2063 656c  ] = [height, cel
-00011bc0: 6c5f 666f 726d 6174 2c20 6869 6464 656e  l_format, hidden
-00011bd0: 2c20 6c65 7665 6c2c 2063 6f6c 6c61 7073  , level, collaps
-00011be0: 6564 5d0a 0a20 2020 2020 2020 2023 2053  ed]..        # S
-00011bf0: 746f 7265 2074 6865 2072 6f77 2063 6861  tore the row cha
-00011c00: 6e67 6520 746f 2061 6c6c 6f77 206f 7074  nge to allow opt
-00011c10: 696d 697a 6174 696f 6e73 2e0a 2020 2020  imizations..    
-00011c20: 2020 2020 7365 6c66 2e72 6f77 5f73 697a      self.row_siz
-00011c30: 655f 6368 616e 6765 6420 3d20 5472 7565  e_changed = True
-00011c40: 0a0a 2020 2020 2020 2020 2320 5374 6f72  ..        # Stor
-00011c50: 6520 7468 6520 726f 7720 7369 7a65 7320  e the row sizes 
-00011c60: 666f 7220 7573 6520 7768 656e 2063 616c  for use when cal
-00011c70: 6375 6c61 7469 6e67 2069 6d61 6765 2076  culating image v
-00011c80: 6572 7469 6365 732e 0a20 2020 2020 2020  ertices..       
-00011c90: 2073 656c 662e 726f 775f 7369 7a65 735b   self.row_sizes[
-00011ca0: 726f 775d 203d 205b 6865 6967 6874 2c20  row] = [height, 
-00011cb0: 6869 6464 656e 5d0a 0a20 2020 2020 2020  hidden]..       
-00011cc0: 2072 6574 7572 6e20 300a 0a20 2020 2064   return 0..    d
-00011cd0: 6566 2073 6574 5f72 6f77 5f70 6978 656c  ef set_row_pixel
-00011ce0: 7328 7365 6c66 2c20 726f 772c 2068 6569  s(self, row, hei
-00011cf0: 6768 743d 4e6f 6e65 2c20 6365 6c6c 5f66  ght=None, cell_f
-00011d00: 6f72 6d61 743d 4e6f 6e65 2c20 6f70 7469  ormat=None, opti
-00011d10: 6f6e 733d 4e6f 6e65 293a 0a20 2020 2020  ons=None):.     
-00011d20: 2020 2022 2222 0a20 2020 2020 2020 2053     """.        S
-00011d30: 6574 2074 6865 2077 6964 7468 2028 696e  et the width (in
-00011d40: 2070 6978 656c 7329 2c20 616e 6420 6f74   pixels), and ot
-00011d50: 6865 7220 7072 6f70 6572 7469 6573 206f  her properties o
-00011d60: 6620 6120 726f 772e 0a0a 2020 2020 2020  f a row...      
-00011d70: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
-00011d80: 2020 2020 726f 773a 2020 2020 2020 2020      row:        
-00011d90: 2052 6f77 206e 756d 6265 7220 287a 6572   Row number (zer
-00011da0: 6f2d 696e 6465 7865 6429 2e0a 2020 2020  o-indexed)..    
-00011db0: 2020 2020 2020 2020 6865 6967 6874 3a20          height: 
-00011dc0: 2020 2020 2052 6f77 2068 6569 6768 7420       Row height 
-00011dd0: 696e 2070 6978 656c 732e 2028 6f70 7469  in pixels. (opti
-00011de0: 6f6e 616c 292e 0a20 2020 2020 2020 2020  onal)..         
-00011df0: 2020 2063 656c 6c5f 666f 726d 6174 3a20     cell_format: 
-00011e00: 526f 7720 6365 6c6c 5f66 6f72 6d61 742e  Row cell_format.
-00011e10: 2028 6f70 7469 6f6e 616c 292e 0a20 2020   (optional)..   
-00011e20: 2020 2020 2020 2020 206f 7074 696f 6e73           options
-00011e30: 3a20 2020 2020 4469 6374 206f 6620 6f70  :     Dict of op
-00011e40: 7469 6f6e 7320 7375 6368 2061 7320 6869  tions such as hi
-00011e50: 6464 656e 2c20 6c65 7665 6c20 616e 6420  dden, level and 
-00011e60: 636f 6c6c 6170 7365 642e 0a0a 2020 2020  collapsed...    
-00011e70: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
-00011e80: 2020 2020 2020 2020 2030 3a20 2053 7563           0:  Suc
-00011e90: 6365 7373 2e0a 2020 2020 2020 2020 2020  cess..          
-00011ea0: 2020 2d31 3a20 526f 7720 6e75 6d62 6572    -1: Row number
-00011eb0: 2069 7320 6f75 7420 6f66 2077 6f72 6b73   is out of works
-00011ec0: 6865 6574 2062 6f75 6e64 732e 0a0a 2020  heet bounds...  
-00011ed0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00011ee0: 2020 6966 2068 6569 6768 7420 6973 206e    if height is n
-00011ef0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00011f00: 2020 2020 2068 6569 6768 7420 3d20 7365       height = se
-00011f10: 6c66 2e5f 7069 7865 6c73 5f74 6f5f 6865  lf._pixels_to_he
-00011f20: 6967 6874 2868 6569 6768 7429 0a0a 2020  ight(height)..  
-00011f30: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00011f40: 662e 7365 745f 726f 7728 726f 772c 2068  f.set_row(row, h
-00011f50: 6569 6768 742c 2063 656c 6c5f 666f 726d  eight, cell_form
-00011f60: 6174 2c20 6f70 7469 6f6e 7329 0a0a 2020  at, options)..  
-00011f70: 2020 6465 6620 7365 745f 6465 6661 756c    def set_defaul
-00011f80: 745f 726f 7728 7365 6c66 2c20 6865 6967  t_row(self, heig
-00011f90: 6874 3d4e 6f6e 652c 2068 6964 655f 756e  ht=None, hide_un
-00011fa0: 7573 6564 5f72 6f77 733d 4661 6c73 6529  used_rows=False)
-00011fb0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00011fc0: 2020 2020 2020 5365 7420 7468 6520 6465        Set the de
-00011fd0: 6661 756c 7420 726f 7720 7072 6f70 6572  fault row proper
-00011fe0: 7469 6573 2e0a 0a20 2020 2020 2020 2041  ties...        A
-00011ff0: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
-00012000: 2068 6569 6768 743a 2020 2020 2020 2020   height:        
-00012010: 2020 2044 6566 6175 6c74 2068 6569 6768     Default heigh
-00012020: 742e 204f 7074 696f 6e61 6c2c 2064 6566  t. Optional, def
-00012030: 6175 6c74 7320 746f 2031 352e 0a20 2020  aults to 15..   
-00012040: 2020 2020 2020 2020 2068 6964 655f 756e           hide_un
-00012050: 7573 6564 5f72 6f77 733a 2048 6964 6520  used_rows: Hide 
-00012060: 756e 7573 6564 2072 6f77 732e 204f 7074  unused rows. Opt
-00012070: 696f 6e61 6c2c 2064 6566 6175 6c74 7320  ional, defaults 
-00012080: 746f 2046 616c 7365 2e0a 0a20 2020 2020  to False...     
-00012090: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
-000120a0: 2020 2020 2020 2020 4e6f 7468 696e 672e          Nothing.
-000120b0: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-000120c0: 2020 2020 2020 6966 2068 6569 6768 7420        if height 
-000120d0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-000120e0: 2020 2020 2068 6569 6768 7420 3d20 7365       height = se
-000120f0: 6c66 2e64 6566 6175 6c74 5f72 6f77 5f68  lf.default_row_h
-00012100: 6569 6768 740a 0a20 2020 2020 2020 2069  eight..        i
-00012110: 6620 6865 6967 6874 2021 3d20 7365 6c66  f height != self
-00012120: 2e6f 7269 6769 6e61 6c5f 726f 775f 6865  .original_row_he
-00012130: 6967 6874 3a0a 2020 2020 2020 2020 2020  ight:.          
-00012140: 2020 2320 5374 6f72 6520 7468 6520 726f    # Store the ro
-00012150: 7720 6368 616e 6765 2074 6f20 616c 6c6f  w change to allo
-00012160: 7720 6f70 7469 6d69 7a61 7469 6f6e 732e  w optimizations.
-00012170: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00012180: 662e 726f 775f 7369 7a65 5f63 6861 6e67  f.row_size_chang
-00012190: 6564 203d 2054 7275 650a 2020 2020 2020  ed = True.      
-000121a0: 2020 2020 2020 7365 6c66 2e64 6566 6175        self.defau
-000121b0: 6c74 5f72 6f77 5f68 6569 6768 7420 3d20  lt_row_height = 
-000121c0: 6865 6967 6874 0a0a 2020 2020 2020 2020  height..        
-000121d0: 6966 2068 6964 655f 756e 7573 6564 5f72  if hide_unused_r
-000121e0: 6f77 733a 0a20 2020 2020 2020 2020 2020  ows:.           
-000121f0: 2073 656c 662e 6465 6661 756c 745f 726f   self.default_ro
-00012200: 775f 7a65 726f 6564 203d 2031 0a0a 2020  w_zeroed = 1..  
-00012210: 2020 4063 6f6e 7665 7274 5f72 616e 6765    @convert_range
-00012220: 5f61 7267 730a 2020 2020 6465 6620 6d65  _args.    def me
-00012230: 7267 655f 7261 6e67 6528 7365 6c66 2c20  rge_range(self, 
-00012240: 6669 7273 745f 726f 772c 2066 6972 7374  first_row, first
-00012250: 5f63 6f6c 2c20 6c61 7374 5f72 6f77 2c20  _col, last_row, 
-00012260: 6c61 7374 5f63 6f6c 2c0a 2020 2020 2020  last_col,.      
-00012270: 2020 2020 2020 2020 2020 2020 2020 6461                da
-00012280: 7461 2c20 6365 6c6c 5f66 6f72 6d61 743d  ta, cell_format=
-00012290: 4e6f 6e65 293a 0a20 2020 2020 2020 2022  None):.        "
-000122a0: 2222 0a20 2020 2020 2020 204d 6572 6765  "".        Merge
-000122b0: 2061 2072 616e 6765 206f 6620 6365 6c6c   a range of cell
-000122c0: 732e 0a0a 2020 2020 2020 2020 4172 6773  s...        Args
-000122d0: 3a0a 2020 2020 2020 2020 2020 2020 6669  :.            fi
-000122e0: 7273 745f 726f 773a 2020 2020 5468 6520  rst_row:    The 
-000122f0: 6669 7273 7420 726f 7720 6f66 2074 6865  first row of the
-00012300: 2063 656c 6c20 7261 6e67 652e 2028 7a65   cell range. (ze
-00012310: 726f 2069 6e64 6578 6564 292e 0a20 2020  ro indexed)..   
-00012320: 2020 2020 2020 2020 2066 6972 7374 5f63           first_c
-00012330: 6f6c 3a20 2020 2054 6865 2066 6972 7374  ol:    The first
-00012340: 2063 6f6c 756d 6e20 6f66 2074 6865 2063   column of the c
-00012350: 656c 6c20 7261 6e67 652e 0a20 2020 2020  ell range..     
-00012360: 2020 2020 2020 206c 6173 745f 726f 773a         last_row:
-00012370: 2020 2020 2054 6865 206c 6173 7420 726f       The last ro
-00012380: 7720 6f66 2074 6865 2063 656c 6c20 7261  w of the cell ra
-00012390: 6e67 652e 2028 7a65 726f 2069 6e64 6578  nge. (zero index
-000123a0: 6564 292e 0a20 2020 2020 2020 2020 2020  ed)..           
-000123b0: 206c 6173 745f 636f 6c3a 2020 2020 2054   last_col:     T
-000123c0: 6865 206c 6173 7420 636f 6c75 6d6e 206f  he last column o
-000123d0: 6620 7468 6520 6365 6c6c 2072 616e 6765  f the cell range
-000123e0: 2e0a 2020 2020 2020 2020 2020 2020 6461  ..            da
-000123f0: 7461 3a20 2020 2020 2020 2020 4365 6c6c  ta:         Cell
-00012400: 2064 6174 612e 0a20 2020 2020 2020 2020   data..         
-00012410: 2020 2063 656c 6c5f 666f 726d 6174 3a20     cell_format: 
-00012420: 2043 656c 6c20 466f 726d 6174 206f 626a   Cell Format obj
-00012430: 6563 742e 0a0a 2020 2020 2020 2020 5265  ect...        Re
-00012440: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
-00012450: 2020 2020 303a 2020 2020 5375 6363 6573      0:    Succes
-00012460: 732e 0a20 2020 2020 2020 2020 2020 202d  s..            -
-00012470: 313a 2020 2020 526f 7720 6f72 2063 6f6c  1:    Row or col
-00012480: 756d 6e20 6973 206f 7574 206f 6620 776f  umn is out of wo
-00012490: 726b 7368 6565 7420 626f 756e 6473 2e0a  rksheet bounds..
-000124a0: 2020 2020 2020 2020 2020 2020 6f74 6865              othe
-000124b0: 723a 2052 6574 7572 6e20 7661 6c75 6520  r: Return value 
-000124c0: 6f66 2077 7269 7465 2829 2e0a 0a20 2020  of write()...   
-000124d0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000124e0: 2023 204d 6572 6765 2061 2072 616e 6765   # Merge a range
-000124f0: 206f 6620 6365 6c6c 732e 2054 6865 2066   of cells. The f
-00012500: 6972 7374 2063 656c 6c20 7368 6f75 6c64  irst cell should
-00012510: 2063 6f6e 7461 696e 2074 6865 2064 6174   contain the dat
-00012520: 6120 616e 640a 2020 2020 2020 2020 2320  a and.        # 
-00012530: 7468 6520 6f74 6865 7273 2073 686f 756c  the others shoul
-00012540: 6420 6265 2062 6c61 6e6b 2e20 416c 6c20  d be blank. All 
-00012550: 6365 6c6c 7320 7368 6f75 6c64 2068 6176  cells should hav
-00012560: 6520 7468 6520 7361 6d65 2066 6f72 6d61  e the same forma
-00012570: 742e 0a0a 2020 2020 2020 2020 2320 4578  t...        # Ex
-00012580: 6365 6c20 646f 6573 6e27 7420 616c 6c6f  cel doesn't allo
-00012590: 7720 6120 7369 6e67 6c65 2063 656c 6c20  w a single cell 
-000125a0: 746f 2062 6520 6d65 7267 6564 0a20 2020  to be merged.   
-000125b0: 2020 2020 2069 6620 6669 7273 745f 726f       if first_ro
-000125c0: 7720 3d3d 206c 6173 745f 726f 7720 616e  w == last_row an
-000125d0: 6420 6669 7273 745f 636f 6c20 3d3d 206c  d first_col == l
-000125e0: 6173 745f 636f 6c3a 0a20 2020 2020 2020  ast_col:.       
-000125f0: 2020 2020 2077 6172 6e28 2243 616e 2774       warn("Can't
-00012600: 206d 6572 6765 2073 696e 676c 6520 6365   merge single ce
-00012610: 6c6c 2229 0a20 2020 2020 2020 2020 2020  ll").           
-00012620: 2072 6574 7572 6e0a 0a20 2020 2020 2020   return..       
-00012630: 2023 2053 7761 7020 6c61 7374 2072 6f77   # Swap last row
-00012640: 2f63 6f6c 2077 6974 6820 6669 7273 7420  /col with first 
-00012650: 726f 772f 636f 6c20 6173 206e 6563 6573  row/col as neces
-00012660: 7361 7279 0a20 2020 2020 2020 2069 6620  sary.        if 
-00012670: 6669 7273 745f 726f 7720 3e20 6c61 7374  first_row > last
-00012680: 5f72 6f77 3a0a 2020 2020 2020 2020 2020  _row:.          
-00012690: 2020 2866 6972 7374 5f72 6f77 2c20 6c61    (first_row, la
-000126a0: 7374 5f72 6f77 2920 3d20 286c 6173 745f  st_row) = (last_
-000126b0: 726f 772c 2066 6972 7374 5f72 6f77 290a  row, first_row).
-000126c0: 2020 2020 2020 2020 6966 2066 6972 7374          if first
-000126d0: 5f63 6f6c 203e 206c 6173 745f 636f 6c3a  _col > last_col:
-000126e0: 0a20 2020 2020 2020 2020 2020 2028 6669  .            (fi
-000126f0: 7273 745f 636f 6c2c 206c 6173 745f 636f  rst_col, last_co
-00012700: 6c29 203d 2028 6c61 7374 5f63 6f6c 2c20  l) = (last_col, 
-00012710: 6669 7273 745f 636f 6c29 0a0a 2020 2020  first_col)..    
-00012720: 2020 2020 2320 4368 6563 6b20 7468 6174      # Check that
-00012730: 2072 6f77 2061 6e64 2063 6f6c 2061 7265   row and col are
-00012740: 2076 616c 6964 2061 6e64 2073 746f 7265   valid and store
-00012750: 206d 6178 2061 6e64 206d 696e 2076 616c   max and min val
-00012760: 7565 732e 0a20 2020 2020 2020 2069 6620  ues..        if 
-00012770: 7365 6c66 2e5f 6368 6563 6b5f 6469 6d65  self._check_dime
-00012780: 6e73 696f 6e73 2866 6972 7374 5f72 6f77  nsions(first_row
-00012790: 2c20 6669 7273 745f 636f 6c29 3a0a 2020  , first_col):.  
-000127a0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-000127b0: 202d 310a 2020 2020 2020 2020 6966 2073   -1.        if s
-000127c0: 656c 662e 5f63 6865 636b 5f64 696d 656e  elf._check_dimen
-000127d0: 7369 6f6e 7328 6c61 7374 5f72 6f77 2c20  sions(last_row, 
-000127e0: 6c61 7374 5f63 6f6c 293a 0a20 2020 2020  last_col):.     
-000127f0: 2020 2020 2020 2072 6574 7572 6e20 2d31         return -1
-00012800: 0a0a 2020 2020 2020 2020 2320 4368 6563  ..        # Chec
-00012810: 6b20 6966 2074 6865 206d 6572 6765 2072  k if the merge r
-00012820: 616e 6765 206f 7665 726c 6170 7320 6120  ange overlaps a 
-00012830: 7072 6576 696f 7573 206d 6572 6765 6420  previous merged 
-00012840: 6f72 2074 6162 6c65 2072 616e 6765 2e0a  or table range..
-00012850: 2020 2020 2020 2020 2320 5468 6973 2069          # This i
-00012860: 7320 6120 6372 6974 6963 616c 2066 696c  s a critical fil
-00012870: 6520 636f 7272 7570 7469 6f6e 2065 7272  e corruption err
-00012880: 6f72 2069 6e20 4578 6365 6c2e 0a20 2020  or in Excel..   
-00012890: 2020 2020 2063 656c 6c5f 7261 6e67 6520       cell_range 
-000128a0: 3d20 786c 5f72 616e 6765 2866 6972 7374  = xl_range(first
-000128b0: 5f72 6f77 2c20 6669 7273 745f 636f 6c2c  _row, first_col,
-000128c0: 206c 6173 745f 726f 772c 206c 6173 745f   last_row, last_
-000128d0: 636f 6c29 0a20 2020 2020 2020 2066 6f72  col).        for
-000128e0: 2072 6f77 2069 6e20 7261 6e67 6528 6669   row in range(fi
-000128f0: 7273 745f 726f 772c 206c 6173 745f 726f  rst_row, last_ro
-00012900: 7720 2b20 3129 3a0a 2020 2020 2020 2020  w + 1):.        
-00012910: 2020 2020 666f 7220 636f 6c20 696e 2072      for col in r
-00012920: 616e 6765 2866 6972 7374 5f63 6f6c 2c20  ange(first_col, 
-00012930: 6c61 7374 5f63 6f6c 202b 2031 293a 0a20  last_col + 1):. 
-00012940: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00012950: 6620 7365 6c66 2e6d 6572 6765 645f 6365  f self.merged_ce
-00012960: 6c6c 732e 6765 7428 2872 6f77 2c20 636f  lls.get((row, co
-00012970: 6c29 293a 0a20 2020 2020 2020 2020 2020  l)):.           
-00012980: 2020 2020 2020 2020 2070 7265 7669 6f75           previou
-00012990: 735f 7261 6e67 6520 3d20 7365 6c66 2e6d  s_range = self.m
-000129a0: 6572 6765 645f 6365 6c6c 732e 6765 7428  erged_cells.get(
-000129b0: 2872 6f77 2c20 636f 6c29 290a 2020 2020  (row, col)).    
-000129c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000129d0: 7261 6973 6520 4f76 6572 6c61 7070 696e  raise Overlappin
-000129e0: 6752 616e 6765 280a 2020 2020 2020 2020  gRange(.        
-000129f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a00: 224d 6572 6765 2072 616e 6765 2027 2573  "Merge range '%s
-00012a10: 2720 6f76 6572 6c61 7073 2070 7265 7669  ' overlaps previ
-00012a20: 6f75 7320 6d65 7267 6520 7261 6e67 6520  ous merge range 
-00012a30: 2725 7327 2e22 0a20 2020 2020 2020 2020  '%s'.".         
-00012a40: 2020 2020 2020 2020 2020 2020 2020 2025                 %
-00012a50: 2028 6365 6c6c 5f72 616e 6765 2c20 7072   (cell_range, pr
-00012a60: 6576 696f 7573 5f72 616e 6765 2929 0a20  evious_range)). 
-00012a70: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00012a80: 6c69 6620 7365 6c66 2e74 6162 6c65 5f63  lif self.table_c
-00012a90: 656c 6c73 2e67 6574 2828 726f 772c 2063  ells.get((row, c
-00012aa0: 6f6c 2929 3a0a 2020 2020 2020 2020 2020  ol)):.          
-00012ab0: 2020 2020 2020 2020 2020 7072 6576 696f            previo
-00012ac0: 7573 5f72 616e 6765 203d 2073 656c 662e  us_range = self.
-00012ad0: 7461 626c 655f 6365 6c6c 732e 6765 7428  table_cells.get(
-00012ae0: 2872 6f77 2c20 636f 6c29 290a 2020 2020  (row, col)).    
-00012af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012b00: 7261 6973 6520 4f76 6572 6c61 7070 696e  raise Overlappin
-00012b10: 6752 616e 6765 280a 2020 2020 2020 2020  gRange(.        
-00012b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012b30: 224d 6572 6765 2072 616e 6765 2027 2573  "Merge range '%s
-00012b40: 2720 6f76 6572 6c61 7073 2070 7265 7669  ' overlaps previ
-00012b50: 6f75 7320 7461 626c 6520 7261 6e67 6520  ous table range 
-00012b60: 2725 7327 2e22 0a20 2020 2020 2020 2020  '%s'.".         
-00012b70: 2020 2020 2020 2020 2020 2020 2020 2025                 %
-00012b80: 2028 6365 6c6c 5f72 616e 6765 2c20 7072   (cell_range, pr
-00012b90: 6576 696f 7573 5f72 616e 6765 2929 0a20  evious_range)). 
-00012ba0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00012bb0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00012bc0: 2020 2020 2020 2020 2073 656c 662e 6d65           self.me
-00012bd0: 7267 6564 5f63 656c 6c73 5b28 726f 772c  rged_cells[(row,
-00012be0: 2063 6f6c 295d 203d 2063 656c 6c5f 7261   col)] = cell_ra
-00012bf0: 6e67 650a 0a20 2020 2020 2020 2023 2053  nge..        # S
-00012c00: 746f 7265 2074 6865 206d 6572 6765 2072  tore the merge r
-00012c10: 616e 6765 2e0a 2020 2020 2020 2020 7365  ange..        se
-00012c20: 6c66 2e6d 6572 6765 2e61 7070 656e 6428  lf.merge.append(
-00012c30: 5b66 6972 7374 5f72 6f77 2c20 6669 7273  [first_row, firs
-00012c40: 745f 636f 6c2c 206c 6173 745f 726f 772c  t_col, last_row,
-00012c50: 206c 6173 745f 636f 6c5d 290a 0a20 2020   last_col])..   
-00012c60: 2020 2020 2023 2057 7269 7465 2074 6865       # Write the
-00012c70: 2066 6972 7374 2063 656c 6c0a 2020 2020   first cell.    
-00012c80: 2020 2020 7365 6c66 2e5f 7772 6974 6528      self._write(
-00012c90: 6669 7273 745f 726f 772c 2066 6972 7374  first_row, first
-00012ca0: 5f63 6f6c 2c20 6461 7461 2c20 6365 6c6c  _col, data, cell
-00012cb0: 5f66 6f72 6d61 7429 0a0a 2020 2020 2020  _format)..      
-00012cc0: 2020 2320 5061 6420 6f75 7420 7468 6520    # Pad out the 
-00012cd0: 7265 7374 206f 6620 7468 6520 6172 6561  rest of the area
-00012ce0: 2077 6974 6820 666f 726d 6174 7465 6420   with formatted 
-00012cf0: 626c 616e 6b20 6365 6c6c 732e 0a20 2020  blank cells..   
-00012d00: 2020 2020 2066 6f72 2072 6f77 2069 6e20       for row in 
-00012d10: 7261 6e67 6528 6669 7273 745f 726f 772c  range(first_row,
-00012d20: 206c 6173 745f 726f 7720 2b20 3129 3a0a   last_row + 1):.
-00012d30: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00012d40: 636f 6c20 696e 2072 616e 6765 2866 6972  col in range(fir
-00012d50: 7374 5f63 6f6c 2c20 6c61 7374 5f63 6f6c  st_col, last_col
-00012d60: 202b 2031 293a 0a20 2020 2020 2020 2020   + 1):.         
-00012d70: 2020 2020 2020 2069 6620 726f 7720 3d3d         if row ==
-00012d80: 2066 6972 7374 5f72 6f77 2061 6e64 2063   first_row and c
-00012d90: 6f6c 203d 3d20 6669 7273 745f 636f 6c3a  ol == first_col:
-00012da0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012db0: 2020 2020 2063 6f6e 7469 6e75 650a 2020       continue.  
-00012dc0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00012dd0: 6c66 2e5f 7772 6974 655f 626c 616e 6b28  lf._write_blank(
-00012de0: 726f 772c 2063 6f6c 2c20 2727 2c20 6365  row, col, '', ce
-00012df0: 6c6c 5f66 6f72 6d61 7429 0a0a 2020 2020  ll_format)..    
-00012e00: 2020 2020 7265 7475 726e 2030 0a0a 2020      return 0..  
-00012e10: 2020 4063 6f6e 7665 7274 5f72 616e 6765    @convert_range
-00012e20: 5f61 7267 730a 2020 2020 6465 6620 6175  _args.    def au
-00012e30: 746f 6669 6c74 6572 2873 656c 662c 2066  tofilter(self, f
-00012e40: 6972 7374 5f72 6f77 2c20 6669 7273 745f  irst_row, first_
-00012e50: 636f 6c2c 206c 6173 745f 726f 772c 206c  col, last_row, l
-00012e60: 6173 745f 636f 6c29 3a0a 2020 2020 2020  ast_col):.      
-00012e70: 2020 2222 220a 2020 2020 2020 2020 5365    """.        Se
-00012e80: 7420 7468 6520 6175 746f 6669 6c74 6572  t the autofilter
-00012e90: 2061 7265 6120 696e 2074 6865 2077 6f72   area in the wor
-00012ea0: 6b73 6865 6574 2e0a 0a20 2020 2020 2020  ksheet...       
-00012eb0: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
-00012ec0: 2020 2066 6972 7374 5f72 6f77 3a20 2020     first_row:   
-00012ed0: 2054 6865 2066 6972 7374 2072 6f77 206f   The first row o
-00012ee0: 6620 7468 6520 6365 6c6c 2072 616e 6765  f the cell range
-00012ef0: 2e20 287a 6572 6f20 696e 6465 7865 6429  . (zero indexed)
-00012f00: 2e0a 2020 2020 2020 2020 2020 2020 6669  ..            fi
-00012f10: 7273 745f 636f 6c3a 2020 2020 5468 6520  rst_col:    The 
-00012f20: 6669 7273 7420 636f 6c75 6d6e 206f 6620  first column of 
-00012f30: 7468 6520 6365 6c6c 2072 616e 6765 2e0a  the cell range..
-00012f40: 2020 2020 2020 2020 2020 2020 6c61 7374              last
-00012f50: 5f72 6f77 3a20 2020 2020 5468 6520 6c61  _row:     The la
-00012f60: 7374 2072 6f77 206f 6620 7468 6520 6365  st row of the ce
-00012f70: 6c6c 2072 616e 6765 2e20 287a 6572 6f20  ll range. (zero 
-00012f80: 696e 6465 7865 6429 2e0a 2020 2020 2020  indexed)..      
-00012f90: 2020 2020 2020 6c61 7374 5f63 6f6c 3a20        last_col: 
-00012fa0: 2020 2020 5468 6520 6c61 7374 2063 6f6c      The last col
-00012fb0: 756d 6e20 6f66 2074 6865 2063 656c 6c20  umn of the cell 
-00012fc0: 7261 6e67 652e 0a0a 2020 2020 2020 2020  range...        
-00012fd0: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
-00012fe0: 2020 2020 2020 4e6f 7468 696e 672e 0a0a        Nothing...
-00012ff0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00013000: 2020 2020 2320 5265 7665 7273 6520 6d61      # Reverse ma
-00013010: 7820 616e 6420 6d69 6e20 7661 6c75 6573  x and min values
-00013020: 2069 6620 6e65 6365 7373 6172 792e 0a20   if necessary.. 
-00013030: 2020 2020 2020 2069 6620 6c61 7374 5f72         if last_r
-00013040: 6f77 203c 2066 6972 7374 5f72 6f77 3a0a  ow < first_row:.
-00013050: 2020 2020 2020 2020 2020 2020 2866 6972              (fir
-00013060: 7374 5f72 6f77 2c20 6c61 7374 5f72 6f77  st_row, last_row
-00013070: 2920 3d20 286c 6173 745f 726f 772c 2066  ) = (last_row, f
-00013080: 6972 7374 5f72 6f77 290a 2020 2020 2020  irst_row).      
-00013090: 2020 6966 206c 6173 745f 636f 6c20 3c20    if last_col < 
-000130a0: 6669 7273 745f 636f 6c3a 0a20 2020 2020  first_col:.     
-000130b0: 2020 2020 2020 2028 6669 7273 745f 636f         (first_co
-000130c0: 6c2c 206c 6173 745f 636f 6c29 203d 2028  l, last_col) = (
-000130d0: 6c61 7374 5f63 6f6c 2c20 6669 7273 745f  last_col, first_
-000130e0: 636f 6c29 0a0a 2020 2020 2020 2020 2320  col)..        # 
-000130f0: 4275 696c 6420 7570 2074 6865 2070 7269  Build up the pri
-00013100: 6e74 2061 7265 6120 7261 6e67 6520 2253  nt area range "S
-00013110: 6865 6574 3121 2441 2431 3a24 4324 3133  heet1!$A$1:$C$13
-00013120: 222e 0a20 2020 2020 2020 2061 7265 6120  "..        area 
-00013130: 3d20 7365 6c66 2e5f 636f 6e76 6572 745f  = self._convert_
-00013140: 6e61 6d65 5f61 7265 6128 6669 7273 745f  name_area(first_
-00013150: 726f 772c 2066 6972 7374 5f63 6f6c 2c0a  row, first_col,.
-00013160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013180: 2020 2020 2020 206c 6173 745f 726f 772c         last_row,
-00013190: 206c 6173 745f 636f 6c29 0a20 2020 2020   last_col).     
-000131a0: 2020 2072 6566 203d 2078 6c5f 7261 6e67     ref = xl_rang
-000131b0: 6528 6669 7273 745f 726f 772c 2066 6972  e(first_row, fir
-000131c0: 7374 5f63 6f6c 2c20 6c61 7374 5f72 6f77  st_col, last_row
-000131d0: 2c20 6c61 7374 5f63 6f6c 290a 0a20 2020  , last_col)..   
-000131e0: 2020 2020 2073 656c 662e 6175 746f 6669       self.autofi
-000131f0: 6c74 6572 5f61 7265 6120 3d20 6172 6561  lter_area = area
-00013200: 0a20 2020 2020 2020 2073 656c 662e 6175  .        self.au
-00013210: 746f 6669 6c74 6572 5f72 6566 203d 2072  tofilter_ref = r
-00013220: 6566 0a20 2020 2020 2020 2073 656c 662e  ef.        self.
-00013230: 6669 6c74 6572 5f72 616e 6765 203d 205b  filter_range = [
-00013240: 6669 7273 745f 636f 6c2c 206c 6173 745f  first_col, last_
-00013250: 636f 6c5d 0a0a 2020 2020 2020 2020 2320  col]..        # 
-00013260: 5374 6f72 6520 7468 6520 6669 6c74 6572  Store the filter
-00013270: 2063 656c 6c20 706f 7369 7469 6f6e 7320   cell positions 
-00013280: 666f 7220 7573 6520 696e 2074 6865 2061  for use in the a
-00013290: 7574 6f66 6974 2063 616c 6375 6c61 7469  utofit calculati
-000132a0: 6f6e 2e0a 2020 2020 2020 2020 666f 7220  on..        for 
-000132b0: 636f 6c20 696e 2072 616e 6765 2866 6972  col in range(fir
-000132c0: 7374 5f63 6f6c 2c20 6c61 7374 5f63 6f6c  st_col, last_col
-000132d0: 202b 2031 293a 0a20 2020 2020 2020 2020   + 1):.         
-000132e0: 2020 2073 656c 662e 6669 6c74 6572 5f63     self.filter_c
-000132f0: 656c 6c73 5b28 6669 7273 745f 726f 772c  ells[(first_row,
-00013300: 2063 6f6c 295d 203d 2054 7275 650a 0a20   col)] = True.. 
-00013310: 2020 2064 6566 2066 696c 7465 725f 636f     def filter_co
-00013320: 6c75 6d6e 2873 656c 662c 2063 6f6c 2c20  lumn(self, col, 
-00013330: 6372 6974 6572 6961 293a 0a20 2020 2020  criteria):.     
-00013340: 2020 2022 2222 0a20 2020 2020 2020 2053     """.        S
-00013350: 6574 2074 6865 2063 6f6c 756d 6e20 6669  et the column fi
-00013360: 6c74 6572 2063 7269 7465 7269 612e 0a0a  lter criteria...
-00013370: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
-00013380: 2020 2020 2020 2020 2020 636f 6c3a 2020            col:  
-00013390: 2020 2020 2046 696c 7465 7220 636f 6c75       Filter colu
-000133a0: 6d6e 2028 7a65 726f 2d69 6e64 6578 6564  mn (zero-indexed
-000133b0: 292e 0a20 2020 2020 2020 2020 2020 2063  )..            c
-000133c0: 7269 7465 7269 613a 2020 4669 6c74 6572  riteria:  Filter
-000133d0: 2063 7269 7465 7269 612e 0a0a 2020 2020   criteria...    
-000133e0: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
-000133f0: 2020 2020 2020 2020 2020 4e6f 7468 696e            Nothin
-00013400: 672e 0a0a 2020 2020 2020 2020 2222 220a  g...        """.
-00013410: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-00013420: 656c 662e 6175 746f 6669 6c74 6572 5f61  elf.autofilter_a
-00013430: 7265 613a 0a20 2020 2020 2020 2020 2020  rea:.           
-00013440: 2077 6172 6e28 224d 7573 7420 6361 6c6c   warn("Must call
-00013450: 2061 7574 6f66 696c 7465 7228 2920 6265   autofilter() be
-00013460: 666f 7265 2066 696c 7465 725f 636f 6c75  fore filter_colu
-00013470: 6d6e 2829 2229 0a20 2020 2020 2020 2020  mn()").         
-00013480: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
-00013490: 2020 2023 2043 6865 636b 2066 6f72 2061     # Check for a
-000134a0: 2063 6f6c 756d 6e20 7265 6665 7265 6e63   column referenc
-000134b0: 6520 696e 2041 3120 6e6f 7461 7469 6f6e  e in A1 notation
-000134c0: 2061 6e64 2073 7562 7374 6974 7574 652e   and substitute.
-000134d0: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
-000134e0: 2020 2020 2020 2020 2020 696e 7428 636f            int(co
-000134f0: 6c29 0a20 2020 2020 2020 2065 7863 6570  l).        excep
-00013500: 7420 5661 6c75 6545 7272 6f72 3a0a 2020  t ValueError:.  
-00013510: 2020 2020 2020 2020 2020 2320 436f 6e76            # Conv
-00013520: 6572 7420 636f 6c20 7265 6620 746f 2061  ert col ref to a
-00013530: 2063 656c 6c20 7265 6620 616e 6420 7468   cell ref and th
-00013540: 656e 2074 6f20 6120 636f 6c20 6e75 6d62  en to a col numb
-00013550: 6572 2e0a 2020 2020 2020 2020 2020 2020  er..            
-00013560: 636f 6c5f 6c65 7474 6572 203d 2063 6f6c  col_letter = col
-00013570: 0a20 2020 2020 2020 2020 2020 2028 5f2c  .            (_,
-00013580: 2063 6f6c 2920 3d20 786c 5f63 656c 6c5f   col) = xl_cell_
-00013590: 746f 5f72 6f77 636f 6c28 636f 6c20 2b20  to_rowcol(col + 
-000135a0: 2731 2729 0a0a 2020 2020 2020 2020 2020  '1')..          
-000135b0: 2020 6966 2063 6f6c 203e 3d20 7365 6c66    if col >= self
-000135c0: 2e78 6c73 5f63 6f6c 6d61 783a 0a20 2020  .xls_colmax:.   
-000135d0: 2020 2020 2020 2020 2020 2020 2077 6172               war
-000135e0: 6e28 2249 6e76 616c 6964 2063 6f6c 756d  n("Invalid colum
-000135f0: 6e20 2725 7327 2220 2520 636f 6c5f 6c65  n '%s'" % col_le
-00013600: 7474 6572 290a 2020 2020 2020 2020 2020  tter).          
-00013610: 2020 2020 2020 7265 7475 726e 0a0a 2020        return..  
-00013620: 2020 2020 2020 2863 6f6c 5f66 6972 7374        (col_first
-00013630: 2c20 636f 6c5f 6c61 7374 2920 3d20 7365  , col_last) = se
-00013640: 6c66 2e66 696c 7465 725f 7261 6e67 650a  lf.filter_range.
-00013650: 0a20 2020 2020 2020 2023 2052 656a 6563  .        # Rejec
-00013660: 7420 636f 6c75 6d6e 2069 6620 6974 2069  t column if it i
-00013670: 7320 6f75 7473 6964 6520 6669 6c74 6572  s outside filter
-00013680: 2072 616e 6765 2e0a 2020 2020 2020 2020   range..        
-00013690: 6966 2063 6f6c 203c 2063 6f6c 5f66 6972  if col < col_fir
-000136a0: 7374 206f 7220 636f 6c20 3e20 636f 6c5f  st or col > col_
-000136b0: 6c61 7374 3a0a 2020 2020 2020 2020 2020  last:.          
-000136c0: 2020 7761 726e 2822 436f 6c75 6d6e 2027    warn("Column '
-000136d0: 2564 2720 6f75 7473 6964 6520 6175 746f  %d' outside auto
-000136e0: 6669 6c74 6572 2829 2063 6f6c 756d 6e20  filter() column 
-000136f0: 7261 6e67 6520 2825 642c 2025 6429 220a  range (%d, %d)".
-00013700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013710: 2025 2028 636f 6c2c 2063 6f6c 5f66 6972   % (col, col_fir
-00013720: 7374 2c20 636f 6c5f 6c61 7374 2929 0a20  st, col_last)). 
-00013730: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00013740: 6e0a 0a20 2020 2020 2020 2074 6f6b 656e  n..        token
-00013750: 7320 3d20 7365 6c66 2e5f 6578 7472 6163  s = self._extrac
-00013760: 745f 6669 6c74 6572 5f74 6f6b 656e 7328  t_filter_tokens(
-00013770: 6372 6974 6572 6961 290a 0a20 2020 2020  criteria)..     
-00013780: 2020 2069 6620 6c65 6e28 746f 6b65 6e73     if len(tokens
-00013790: 2920 6e6f 7420 696e 2028 332c 2037 293a  ) not in (3, 7):
-000137a0: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
-000137b0: 6e28 2249 6e63 6f72 7265 6374 206e 756d  n("Incorrect num
-000137c0: 6265 7220 6f66 2074 6f6b 656e 7320 696e  ber of tokens in
-000137d0: 2063 7269 7465 7269 6120 2725 7327 2220   criteria '%s'" 
-000137e0: 2520 6372 6974 6572 6961 290a 0a20 2020  % criteria)..   
-000137f0: 2020 2020 2074 6f6b 656e 7320 3d20 7365       tokens = se
-00013800: 6c66 2e5f 7061 7273 655f 6669 6c74 6572  lf._parse_filter
-00013810: 5f65 7870 7265 7373 696f 6e28 6372 6974  _expression(crit
-00013820: 6572 6961 2c20 746f 6b65 6e73 290a 0a20  eria, tokens).. 
-00013830: 2020 2020 2020 2023 2045 7863 656c 2068         # Excel h
-00013840: 616e 646c 6573 2073 696e 676c 6520 6f72  andles single or
-00013850: 2064 6f75 626c 6520 6375 7374 6f6d 2066   double custom f
-00013860: 696c 7465 7273 2061 7320 6465 6661 756c  ilters as defaul
-00013870: 7420 6669 6c74 6572 732e 0a20 2020 2020  t filters..     
-00013880: 2020 2023 2020 5765 206e 6565 6420 746f     #  We need to
-00013890: 2063 6865 636b 2066 6f72 2074 6865 6d20   check for them 
-000138a0: 616e 6420 6861 6e64 6c65 2074 6865 6d20  and handle them 
-000138b0: 6163 636f 7264 696e 676c 792e 0a20 2020  accordingly..   
-000138c0: 2020 2020 2069 6620 6c65 6e28 746f 6b65       if len(toke
-000138d0: 6e73 2920 3d3d 2032 2061 6e64 2074 6f6b  ns) == 2 and tok
-000138e0: 656e 735b 305d 203d 3d20 323a 0a20 2020  ens[0] == 2:.   
-000138f0: 2020 2020 2020 2020 2023 2053 696e 676c           # Singl
-00013900: 6520 6571 7561 6c69 7479 2e0a 2020 2020  e equality..    
-00013910: 2020 2020 2020 2020 7365 6c66 2e66 696c          self.fil
-00013920: 7465 725f 636f 6c75 6d6e 5f6c 6973 7428  ter_column_list(
-00013930: 636f 6c2c 205b 746f 6b65 6e73 5b31 5d5d  col, [tokens[1]]
-00013940: 290a 2020 2020 2020 2020 656c 6966 2028  ).        elif (
-00013950: 6c65 6e28 746f 6b65 6e73 2920 3d3d 2035  len(tokens) == 5
-00013960: 2061 6e64 2074 6f6b 656e 735b 305d 203d   and tokens[0] =
-00013970: 3d20 3220 616e 6420 746f 6b65 6e73 5b32  = 2 and tokens[2
-00013980: 5d20 3d3d 2031 0a20 2020 2020 2020 2020  ] == 1.         
-00013990: 2020 2020 2061 6e64 2074 6f6b 656e 735b       and tokens[
-000139a0: 335d 203d 3d20 3229 3a0a 2020 2020 2020  3] == 2):.      
-000139b0: 2020 2020 2020 2320 446f 7562 6c65 2065        # Double e
-000139c0: 7175 616c 6974 7920 7769 7468 2022 6f72  quality with "or
-000139d0: 2220 6f70 6572 6174 6f72 2e0a 2020 2020  " operator..    
-000139e0: 2020 2020 2020 2020 7365 6c66 2e66 696c          self.fil
-000139f0: 7465 725f 636f 6c75 6d6e 5f6c 6973 7428  ter_column_list(
-00013a00: 636f 6c2c 205b 746f 6b65 6e73 5b31 5d2c  col, [tokens[1],
-00013a10: 2074 6f6b 656e 735b 345d 5d29 0a20 2020   tokens[4]]).   
-00013a20: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00013a30: 2020 2020 2020 2023 204e 6f6e 2064 6566         # Non def
-00013a40: 6175 6c74 2063 7573 746f 6d20 6669 6c74  ault custom filt
-00013a50: 6572 2e0a 2020 2020 2020 2020 2020 2020  er..            
-00013a60: 7365 6c66 2e66 696c 7465 725f 636f 6c73  self.filter_cols
-00013a70: 5b63 6f6c 5d20 3d20 746f 6b65 6e73 0a20  [col] = tokens. 
-00013a80: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00013a90: 6669 6c74 6572 5f74 7970 655b 636f 6c5d  filter_type[col]
-00013aa0: 203d 2030 0a0a 2020 2020 2020 2020 7365   = 0..        se
-00013ab0: 6c66 2e66 696c 7465 725f 6f6e 203d 2031  lf.filter_on = 1
-00013ac0: 0a0a 2020 2020 6465 6620 6669 6c74 6572  ..    def filter
-00013ad0: 5f63 6f6c 756d 6e5f 6c69 7374 2873 656c  _column_list(sel
-00013ae0: 662c 2063 6f6c 2c20 6669 6c74 6572 7329  f, col, filters)
-00013af0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00013b00: 2020 2020 2020 5365 7420 7468 6520 636f        Set the co
-00013b10: 6c75 6d6e 2066 696c 7465 7220 6372 6974  lumn filter crit
-00013b20: 6572 6961 2069 6e20 4578 6365 6c20 3230  eria in Excel 20
-00013b30: 3037 206c 6973 7420 7374 796c 652e 0a0a  07 list style...
-00013b40: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
-00013b50: 2020 2020 2020 2020 2020 636f 6c3a 2020            col:  
-00013b60: 2020 2020 4669 6c74 6572 2063 6f6c 756d      Filter colum
-00013b70: 6e20 287a 6572 6f2d 696e 6465 7865 6429  n (zero-indexed)
-00013b80: 2e0a 2020 2020 2020 2020 2020 2020 6669  ..            fi
-00013b90: 6c74 6572 733a 2020 4c69 7374 206f 6620  lters:  List of 
-00013ba0: 6669 6c74 6572 2063 7269 7465 7269 6120  filter criteria 
-00013bb0: 746f 206d 6174 6368 2e0a 0a20 2020 2020  to match...     
-00013bc0: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
-00013bd0: 2020 2020 2020 2020 204e 6f74 6869 6e67           Nothing
-00013be0: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
-00013bf0: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-00013c00: 6c66 2e61 7574 6f66 696c 7465 725f 6172  lf.autofilter_ar
-00013c10: 6561 3a0a 2020 2020 2020 2020 2020 2020  ea:.            
-00013c20: 7761 726e 2822 4d75 7374 2063 616c 6c20  warn("Must call 
-00013c30: 6175 746f 6669 6c74 6572 2829 2062 6566  autofilter() bef
-00013c40: 6f72 6520 6669 6c74 6572 5f63 6f6c 756d  ore filter_colum
-00013c50: 6e28 2922 290a 2020 2020 2020 2020 2020  n()").          
-00013c60: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
-00013c70: 2020 2320 4368 6563 6b20 666f 7220 6120    # Check for a 
-00013c80: 636f 6c75 6d6e 2072 6566 6572 656e 6365  column reference
-00013c90: 2069 6e20 4131 206e 6f74 6174 696f 6e20   in A1 notation 
-00013ca0: 616e 6420 7375 6273 7469 7475 7465 2e0a  and substitute..
-00013cb0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-00013cc0: 2020 2020 2020 2020 2069 6e74 2863 6f6c           int(col
-00013cd0: 290a 2020 2020 2020 2020 6578 6365 7074  ).        except
-00013ce0: 2056 616c 7565 4572 726f 723a 0a20 2020   ValueError:.   
-00013cf0: 2020 2020 2020 2020 2023 2043 6f6e 7665           # Conve
-00013d00: 7274 2063 6f6c 2072 6566 2074 6f20 6120  rt col ref to a 
-00013d10: 6365 6c6c 2072 6566 2061 6e64 2074 6865  cell ref and the
-00013d20: 6e20 746f 2061 2063 6f6c 206e 756d 6265  n to a col numbe
-00013d30: 722e 0a20 2020 2020 2020 2020 2020 2063  r..            c
-00013d40: 6f6c 5f6c 6574 7465 7220 3d20 636f 6c0a  ol_letter = col.
-00013d50: 2020 2020 2020 2020 2020 2020 285f 2c20              (_, 
-00013d60: 636f 6c29 203d 2078 6c5f 6365 6c6c 5f74  col) = xl_cell_t
-00013d70: 6f5f 726f 7763 6f6c 2863 6f6c 202b 2027  o_rowcol(col + '
-00013d80: 3127 290a 0a20 2020 2020 2020 2020 2020  1')..           
-00013d90: 2069 6620 636f 6c20 3e3d 2073 656c 662e   if col >= self.
-00013da0: 786c 735f 636f 6c6d 6178 3a0a 2020 2020  xls_colmax:.    
-00013db0: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-00013dc0: 2822 496e 7661 6c69 6420 636f 6c75 6d6e  ("Invalid column
-00013dd0: 2027 2573 2722 2025 2063 6f6c 5f6c 6574   '%s'" % col_let
-00013de0: 7465 7229 0a20 2020 2020 2020 2020 2020  ter).           
-00013df0: 2020 2020 2072 6574 7572 6e0a 0a20 2020       return..   
-00013e00: 2020 2020 2028 636f 6c5f 6669 7273 742c       (col_first,
-00013e10: 2063 6f6c 5f6c 6173 7429 203d 2073 656c   col_last) = sel
-00013e20: 662e 6669 6c74 6572 5f72 616e 6765 0a0a  f.filter_range..
-00013e30: 2020 2020 2020 2020 2320 5265 6a65 6374          # Reject
-00013e40: 2063 6f6c 756d 6e20 6966 2069 7420 6973   column if it is
-00013e50: 206f 7574 7369 6465 2066 696c 7465 7220   outside filter 
-00013e60: 7261 6e67 652e 0a20 2020 2020 2020 2069  range..        i
-00013e70: 6620 636f 6c20 3c20 636f 6c5f 6669 7273  f col < col_firs
-00013e80: 7420 6f72 2063 6f6c 203e 2063 6f6c 5f6c  t or col > col_l
-00013e90: 6173 743a 0a20 2020 2020 2020 2020 2020  ast:.           
-00013ea0: 2077 6172 6e28 2243 6f6c 756d 6e20 2725   warn("Column '%
-00013eb0: 6427 206f 7574 7369 6465 2061 7574 6f66  d' outside autof
-00013ec0: 696c 7465 7228 2920 636f 6c75 6d6e 2072  ilter() column r
-00013ed0: 616e 6765 2022 0a20 2020 2020 2020 2020  ange ".         
-00013ee0: 2020 2020 2020 2020 2228 2564 2c25 6429          "(%d,%d)
-00013ef0: 2220 2520 2863 6f6c 2c20 636f 6c5f 6669  " % (col, col_fi
-00013f00: 7273 742c 2063 6f6c 5f6c 6173 7429 290a  rst, col_last)).
-00013f10: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00013f20: 726e 0a0a 2020 2020 2020 2020 7365 6c66  rn..        self
-00013f30: 2e66 696c 7465 725f 636f 6c73 5b63 6f6c  .filter_cols[col
-00013f40: 5d20 3d20 6669 6c74 6572 730a 2020 2020  ] = filters.    
-00013f50: 2020 2020 7365 6c66 2e66 696c 7465 725f      self.filter_
-00013f60: 7479 7065 5b63 6f6c 5d20 3d20 310a 2020  type[col] = 1.  
-00013f70: 2020 2020 2020 7365 6c66 2e66 696c 7465        self.filte
-00013f80: 725f 6f6e 203d 2031 0a0a 2020 2020 4063  r_on = 1..    @c
-00013f90: 6f6e 7665 7274 5f72 616e 6765 5f61 7267  onvert_range_arg
-00013fa0: 730a 2020 2020 6465 6620 6461 7461 5f76  s.    def data_v
-00013fb0: 616c 6964 6174 696f 6e28 7365 6c66 2c20  alidation(self, 
-00013fc0: 6669 7273 745f 726f 772c 2066 6972 7374  first_row, first
-00013fd0: 5f63 6f6c 2c20 6c61 7374 5f72 6f77 2c20  _col, last_row, 
-00013fe0: 6c61 7374 5f63 6f6c 2c0a 2020 2020 2020  last_col,.      
-00013ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014000: 2020 6f70 7469 6f6e 733d 4e6f 6e65 293a    options=None):
-00014010: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00014020: 2020 2020 2041 6464 2061 2064 6174 6120       Add a data 
-00014030: 7661 6c69 6461 7469 6f6e 2074 6f20 6120  validation to a 
-00014040: 776f 726b 7368 6565 742e 0a0a 2020 2020  worksheet...    
-00014050: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-00014060: 2020 2020 2020 6669 7273 745f 726f 773a        first_row:
-00014070: 2020 2020 5468 6520 6669 7273 7420 726f      The first ro
-00014080: 7720 6f66 2074 6865 2063 656c 6c20 7261  w of the cell ra
-00014090: 6e67 652e 2028 7a65 726f 2069 6e64 6578  nge. (zero index
-000140a0: 6564 292e 0a20 2020 2020 2020 2020 2020  ed)..           
-000140b0: 2066 6972 7374 5f63 6f6c 3a20 2020 2054   first_col:    T
-000140c0: 6865 2066 6972 7374 2063 6f6c 756d 6e20  he first column 
-000140d0: 6f66 2074 6865 2063 656c 6c20 7261 6e67  of the cell rang
-000140e0: 652e 0a20 2020 2020 2020 2020 2020 206c  e..            l
-000140f0: 6173 745f 726f 773a 2020 2020 2054 6865  ast_row:     The
-00014100: 206c 6173 7420 726f 7720 6f66 2074 6865   last row of the
-00014110: 2063 656c 6c20 7261 6e67 652e 2028 7a65   cell range. (ze
-00014120: 726f 2069 6e64 6578 6564 292e 0a20 2020  ro indexed)..   
-00014130: 2020 2020 2020 2020 206c 6173 745f 636f           last_co
-00014140: 6c3a 2020 2020 2054 6865 206c 6173 7420  l:     The last 
-00014150: 636f 6c75 6d6e 206f 6620 7468 6520 6365  column of the ce
-00014160: 6c6c 2072 616e 6765 2e0a 2020 2020 2020  ll range..      
-00014170: 2020 2020 2020 6f70 7469 6f6e 733a 2020        options:  
-00014180: 2020 2020 4461 7461 2076 616c 6964 6174      Data validat
-00014190: 696f 6e20 6f70 7469 6f6e 732e 0a0a 2020  ion options...  
-000141a0: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
-000141b0: 2020 2020 2020 2020 2020 2030 3a20 2053             0:  S
-000141c0: 7563 6365 7373 2e0a 2020 2020 2020 2020  uccess..        
-000141d0: 2020 2020 2d31 3a20 526f 7720 6f72 2063      -1: Row or c
-000141e0: 6f6c 756d 6e20 6973 206f 7574 206f 6620  olumn is out of 
-000141f0: 776f 726b 7368 6565 7420 626f 756e 6473  worksheet bounds
-00014200: 2e0a 2020 2020 2020 2020 2020 2020 2d32  ..            -2
-00014210: 3a20 496e 636f 7272 6563 7420 7061 7261  : Incorrect para
-00014220: 6d65 7465 7220 6f72 206f 7074 696f 6e2e  meter or option.
-00014230: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00014240: 2020 2020 2023 2043 6865 636b 2074 6861       # Check tha
-00014250: 7420 726f 7720 616e 6420 636f 6c20 6172  t row and col ar
-00014260: 6520 7661 6c69 6420 7769 7468 6f75 7420  e valid without 
-00014270: 7374 6f72 696e 6720 7468 6520 7661 6c75  storing the valu
-00014280: 6573 2e0a 2020 2020 2020 2020 6966 2073  es..        if s
-00014290: 656c 662e 5f63 6865 636b 5f64 696d 656e  elf._check_dimen
-000142a0: 7369 6f6e 7328 6669 7273 745f 726f 772c  sions(first_row,
-000142b0: 2066 6972 7374 5f63 6f6c 2c20 5472 7565   first_col, True
-000142c0: 2c20 5472 7565 293a 0a20 2020 2020 2020  , True):.       
-000142d0: 2020 2020 2072 6574 7572 6e20 2d31 0a20       return -1. 
-000142e0: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-000142f0: 6368 6563 6b5f 6469 6d65 6e73 696f 6e73  check_dimensions
-00014300: 286c 6173 745f 726f 772c 206c 6173 745f  (last_row, last_
-00014310: 636f 6c2c 2054 7275 652c 2054 7275 6529  col, True, True)
-00014320: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00014330: 7475 726e 202d 310a 0a20 2020 2020 2020  turn -1..       
-00014340: 2069 6620 6f70 7469 6f6e 7320 6973 204e   if options is N
-00014350: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00014360: 206f 7074 696f 6e73 203d 207b 7d0a 2020   options = {}.  
-00014370: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00014380: 2020 2020 2020 2020 2320 436f 7079 2074          # Copy t
-00014390: 6865 2075 7365 7220 6465 6669 6e65 6420  he user defined 
-000143a0: 6f70 7469 6f6e 7320 736f 2074 6865 7920  options so they 
-000143b0: 6172 656e 2774 206d 6f64 6966 6965 642e  aren't modified.
-000143c0: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
-000143d0: 696f 6e73 203d 206f 7074 696f 6e73 2e63  ions = options.c
-000143e0: 6f70 7928 290a 0a20 2020 2020 2020 2023  opy()..        #
-000143f0: 2056 616c 6964 2069 6e70 7574 2070 6172   Valid input par
-00014400: 616d 6574 6572 732e 0a20 2020 2020 2020  ameters..       
-00014410: 2076 616c 6964 5f70 6172 616d 6574 6572   valid_parameter
-00014420: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-00014430: 2020 2776 616c 6964 6174 6527 2c0a 2020    'validate',.  
-00014440: 2020 2020 2020 2020 2020 2763 7269 7465            'crite
-00014450: 7269 6127 2c0a 2020 2020 2020 2020 2020  ria',.          
-00014460: 2020 2776 616c 7565 272c 0a20 2020 2020    'value',.     
-00014470: 2020 2020 2020 2027 736f 7572 6365 272c         'source',
-00014480: 0a20 2020 2020 2020 2020 2020 2027 6d69  .            'mi
-00014490: 6e69 6d75 6d27 2c0a 2020 2020 2020 2020  nimum',.        
-000144a0: 2020 2020 276d 6178 696d 756d 272c 0a20      'maximum',. 
-000144b0: 2020 2020 2020 2020 2020 2027 6967 6e6f             'igno
-000144c0: 7265 5f62 6c61 6e6b 272c 0a20 2020 2020  re_blank',.     
-000144d0: 2020 2020 2020 2027 6472 6f70 646f 776e         'dropdown
-000144e0: 272c 0a20 2020 2020 2020 2020 2020 2027  ',.            '
-000144f0: 7368 6f77 5f69 6e70 7574 272c 0a20 2020  show_input',.   
-00014500: 2020 2020 2020 2020 2027 696e 7075 745f           'input_
-00014510: 7469 746c 6527 2c0a 2020 2020 2020 2020  title',.        
-00014520: 2020 2020 2769 6e70 7574 5f6d 6573 7361      'input_messa
-00014530: 6765 272c 0a20 2020 2020 2020 2020 2020  ge',.           
-00014540: 2027 7368 6f77 5f65 7272 6f72 272c 0a20   'show_error',. 
-00014550: 2020 2020 2020 2020 2020 2027 6572 726f             'erro
-00014560: 725f 7469 746c 6527 2c0a 2020 2020 2020  r_title',.      
-00014570: 2020 2020 2020 2765 7272 6f72 5f6d 6573        'error_mes
-00014580: 7361 6765 272c 0a20 2020 2020 2020 2020  sage',.         
-00014590: 2020 2027 6572 726f 725f 7479 7065 272c     'error_type',
-000145a0: 0a20 2020 2020 2020 2020 2020 2027 6f74  .            'ot
-000145b0: 6865 725f 6365 6c6c 7327 2c0a 2020 2020  her_cells',.    
-000145c0: 2020 2020 2020 2020 276d 756c 7469 5f72          'multi_r
-000145d0: 616e 6765 272c 0a20 2020 2020 2020 207d  ange',.        }
-000145e0: 0a0a 2020 2020 2020 2020 2320 4368 6563  ..        # Chec
-000145f0: 6b20 666f 7220 7661 6c69 6420 696e 7075  k for valid inpu
-00014600: 7420 7061 7261 6d65 7465 7273 2e0a 2020  t parameters..  
-00014610: 2020 2020 2020 666f 7220 7061 7261 6d5f        for param_
-00014620: 6b65 7920 696e 206f 7074 696f 6e73 2e6b  key in options.k
-00014630: 6579 7328 293a 0a20 2020 2020 2020 2020  eys():.         
-00014640: 2020 2069 6620 7061 7261 6d5f 6b65 7920     if param_key 
-00014650: 6e6f 7420 696e 2076 616c 6964 5f70 6172  not in valid_par
-00014660: 616d 6574 6572 733a 0a20 2020 2020 2020  ameters:.       
-00014670: 2020 2020 2020 2020 2077 6172 6e28 2255           warn("U
-00014680: 6e6b 6e6f 776e 2070 6172 616d 6574 6572  nknown parameter
-00014690: 2027 2573 2720 696e 2064 6174 615f 7661   '%s' in data_va
-000146a0: 6c69 6461 7469 6f6e 2829 2220 2520 7061  lidation()" % pa
-000146b0: 7261 6d5f 6b65 7929 0a20 2020 2020 2020  ram_key).       
-000146c0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000146d0: 2d32 0a0a 2020 2020 2020 2020 2320 4d61  -2..        # Ma
-000146e0: 7020 616c 7465 726e 6174 6976 6520 7061  p alternative pa
-000146f0: 7261 6d65 7465 7220 6e61 6d65 7320 2773  rameter names 's
-00014700: 6f75 7263 6527 206f 7220 276d 696e 696d  ource' or 'minim
-00014710: 756d 2720 746f 2027 7661 6c75 6527 2e0a  um' to 'value'..
-00014720: 2020 2020 2020 2020 6966 2027 736f 7572          if 'sour
-00014730: 6365 2720 696e 206f 7074 696f 6e73 3a0a  ce' in options:.
-00014740: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
-00014750: 6f6e 735b 2776 616c 7565 275d 203d 206f  ons['value'] = o
-00014760: 7074 696f 6e73 5b27 736f 7572 6365 275d  ptions['source']
-00014770: 0a20 2020 2020 2020 2069 6620 276d 696e  .        if 'min
-00014780: 696d 756d 2720 696e 206f 7074 696f 6e73  imum' in options
-00014790: 3a0a 2020 2020 2020 2020 2020 2020 6f70  :.            op
-000147a0: 7469 6f6e 735b 2776 616c 7565 275d 203d  tions['value'] =
-000147b0: 206f 7074 696f 6e73 5b27 6d69 6e69 6d75   options['minimu
-000147c0: 6d27 5d0a 0a20 2020 2020 2020 2023 2027  m']..        # '
-000147d0: 7661 6c69 6461 7465 2720 6973 2061 2072  validate' is a r
-000147e0: 6571 7569 7265 6420 7061 7261 6d65 7465  equired paramete
-000147f0: 722e 0a20 2020 2020 2020 2069 6620 2776  r..        if 'v
-00014800: 616c 6964 6174 6527 206e 6f74 2069 6e20  alidate' not in 
-00014810: 6f70 7469 6f6e 733a 0a20 2020 2020 2020  options:.       
-00014820: 2020 2020 2077 6172 6e28 2250 6172 616d       warn("Param
-00014830: 6574 6572 2027 7661 6c69 6461 7465 2720  eter 'validate' 
-00014840: 6973 2072 6571 7569 7265 6420 696e 2064  is required in d
-00014850: 6174 615f 7661 6c69 6461 7469 6f6e 2829  ata_validation()
-00014860: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
-00014870: 6574 7572 6e20 2d32 0a0a 2020 2020 2020  eturn -2..      
-00014880: 2020 2320 4c69 7374 206f 6620 2076 616c    # List of  val
-00014890: 6964 2076 616c 6964 6174 696f 6e20 7479  id validation ty
-000148a0: 7065 732e 0a20 2020 2020 2020 2076 616c  pes..        val
-000148b0: 6964 5f74 7970 6573 203d 207b 0a20 2020  id_types = {.   
-000148c0: 2020 2020 2020 2020 2027 616e 7927 3a20           'any': 
-000148d0: 276e 6f6e 6527 2c0a 2020 2020 2020 2020  'none',.        
-000148e0: 2020 2020 2761 6e79 2076 616c 7565 273a      'any value':
-000148f0: 2027 6e6f 6e65 272c 0a20 2020 2020 2020   'none',.       
-00014900: 2020 2020 2027 7768 6f6c 6520 6e75 6d62       'whole numb
-00014910: 6572 273a 2027 7768 6f6c 6527 2c0a 2020  er': 'whole',.  
-00014920: 2020 2020 2020 2020 2020 2777 686f 6c65            'whole
-00014930: 273a 2027 7768 6f6c 6527 2c0a 2020 2020  ': 'whole',.    
-00014940: 2020 2020 2020 2020 2769 6e74 6567 6572          'integer
-00014950: 273a 2027 7768 6f6c 6527 2c0a 2020 2020  ': 'whole',.    
-00014960: 2020 2020 2020 2020 2764 6563 696d 616c          'decimal
-00014970: 273a 2027 6465 6369 6d61 6c27 2c0a 2020  ': 'decimal',.  
-00014980: 2020 2020 2020 2020 2020 276c 6973 7427            'list'
-00014990: 3a20 276c 6973 7427 2c0a 2020 2020 2020  : 'list',.      
-000149a0: 2020 2020 2020 2764 6174 6527 3a20 2764        'date': 'd
-000149b0: 6174 6527 2c0a 2020 2020 2020 2020 2020  ate',.          
-000149c0: 2020 2774 696d 6527 3a20 2774 696d 6527    'time': 'time'
-000149d0: 2c0a 2020 2020 2020 2020 2020 2020 2774  ,.            't
-000149e0: 6578 7420 6c65 6e67 7468 273a 2027 7465  ext length': 'te
-000149f0: 7874 4c65 6e67 7468 272c 0a20 2020 2020  xtLength',.     
-00014a00: 2020 2020 2020 2027 6c65 6e67 7468 273a         'length':
-00014a10: 2027 7465 7874 4c65 6e67 7468 272c 0a20   'textLength',. 
-00014a20: 2020 2020 2020 2020 2020 2027 6375 7374             'cust
-00014a30: 6f6d 273a 2027 6375 7374 6f6d 272c 0a20  om': 'custom',. 
-00014a40: 2020 2020 2020 207d 0a0a 2020 2020 2020         }..      
-00014a50: 2020 2320 4368 6563 6b20 666f 7220 7661    # Check for va
-00014a60: 6c69 6420 7661 6c69 6461 7469 6f6e 2074  lid validation t
-00014a70: 7970 6573 2e0a 2020 2020 2020 2020 6966  ypes..        if
-00014a80: 206e 6f74 206f 7074 696f 6e73 5b27 7661   not options['va
-00014a90: 6c69 6461 7465 275d 2069 6e20 7661 6c69  lidate'] in vali
-00014aa0: 645f 7479 7065 733a 0a20 2020 2020 2020  d_types:.       
-00014ab0: 2020 2020 2077 6172 6e28 2255 6e6b 6e6f       warn("Unkno
-00014ac0: 776e 2076 616c 6964 6174 696f 6e20 7479  wn validation ty
-00014ad0: 7065 2027 2573 2720 666f 7220 7061 7261  pe '%s' for para
-00014ae0: 6d65 7465 7220 220a 2020 2020 2020 2020  meter ".        
-00014af0: 2020 2020 2020 2020 2022 2776 616c 6964           "'valid
-00014b00: 6174 6527 2069 6e20 6461 7461 5f76 616c  ate' in data_val
-00014b10: 6964 6174 696f 6e28 2922 2025 206f 7074  idation()" % opt
-00014b20: 696f 6e73 5b27 7661 6c69 6461 7465 275d  ions['validate']
-00014b30: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00014b40: 7475 726e 202d 320a 2020 2020 2020 2020  turn -2.        
-00014b50: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00014b60: 2020 6f70 7469 6f6e 735b 2776 616c 6964    options['valid
-00014b70: 6174 6527 5d20 3d20 7661 6c69 645f 7479  ate'] = valid_ty
-00014b80: 7065 735b 6f70 7469 6f6e 735b 2776 616c  pes[options['val
-00014b90: 6964 6174 6527 5d5d 0a0a 2020 2020 2020  idate']]..      
-00014ba0: 2020 2320 4e6f 2061 6374 696f 6e20 6973    # No action is
-00014bb0: 2072 6571 7569 7265 6420 666f 7220 7661   required for va
-00014bc0: 6c69 6461 7469 6f6e 2074 7970 6520 2761  lidation type 'a
-00014bd0: 6e79 2720 6966 2074 6865 7265 2061 7265  ny' if there are
-00014be0: 206e 6f0a 2020 2020 2020 2020 2320 696e   no.        # in
-00014bf0: 7075 7420 6d65 7373 6167 6573 2074 6f20  put messages to 
-00014c00: 6469 7370 6c61 792e 0a20 2020 2020 2020  display..       
-00014c10: 2069 6620 286f 7074 696f 6e73 5b27 7661   if (options['va
-00014c20: 6c69 6461 7465 275d 203d 3d20 276e 6f6e  lidate'] == 'non
-00014c30: 6527 0a20 2020 2020 2020 2020 2020 2020  e'.             
-00014c40: 2020 2061 6e64 206f 7074 696f 6e73 2e67     and options.g
-00014c50: 6574 2827 696e 7075 745f 7469 746c 6527  et('input_title'
-00014c60: 2920 6973 204e 6f6e 650a 2020 2020 2020  ) is None.      
-00014c70: 2020 2020 2020 2020 2020 616e 6420 6f70            and op
-00014c80: 7469 6f6e 732e 6765 7428 2769 6e70 7574  tions.get('input
-00014c90: 5f6d 6573 7361 6765 2729 2069 7320 4e6f  _message') is No
-00014ca0: 6e65 293a 0a20 2020 2020 2020 2020 2020  ne):.           
-00014cb0: 2072 6574 7572 6e20 2d32 0a0a 2020 2020   return -2..    
-00014cc0: 2020 2020 2320 5468 6520 616e 792c 206c      # The any, l
-00014cd0: 6973 7420 616e 6420 6375 7374 6f6d 2076  ist and custom v
-00014ce0: 616c 6964 6174 696f 6e73 2064 6f6e 2774  alidations don't
-00014cf0: 2068 6176 6520 6120 6372 6974 6572 6961   have a criteria
-00014d00: 2073 6f20 7765 2075 7365 0a20 2020 2020   so we use.     
-00014d10: 2020 2023 2061 2064 6566 6175 6c74 206f     # a default o
-00014d20: 6620 2762 6574 7765 656e 272e 0a20 2020  f 'between'..   
-00014d30: 2020 2020 2069 6620 286f 7074 696f 6e73       if (options
-00014d40: 5b27 7661 6c69 6461 7465 275d 203d 3d20  ['validate'] == 
-00014d50: 276e 6f6e 6527 0a20 2020 2020 2020 2020  'none'.         
-00014d60: 2020 2020 2020 206f 7220 6f70 7469 6f6e         or option
-00014d70: 735b 2776 616c 6964 6174 6527 5d20 3d3d  s['validate'] ==
-00014d80: 2027 6c69 7374 270a 2020 2020 2020 2020   'list'.        
-00014d90: 2020 2020 2020 2020 6f72 206f 7074 696f          or optio
-00014da0: 6e73 5b27 7661 6c69 6461 7465 275d 203d  ns['validate'] =
-00014db0: 3d20 2763 7573 746f 6d27 293a 0a20 2020  = 'custom'):.   
-00014dc0: 2020 2020 2020 2020 206f 7074 696f 6e73           options
-00014dd0: 5b27 6372 6974 6572 6961 275d 203d 2027  ['criteria'] = '
-00014de0: 6265 7477 6565 6e27 0a20 2020 2020 2020  between'.       
-00014df0: 2020 2020 206f 7074 696f 6e73 5b27 6d61       options['ma
-00014e00: 7869 6d75 6d27 5d20 3d20 4e6f 6e65 0a0a  ximum'] = None..
-00014e10: 2020 2020 2020 2020 2320 2763 7269 7465          # 'crite
-00014e20: 7269 6127 2069 7320 6120 7265 7175 6972  ria' is a requir
-00014e30: 6564 2070 6172 616d 6574 6572 2e0a 2020  ed parameter..  
-00014e40: 2020 2020 2020 6966 2027 6372 6974 6572        if 'criter
-00014e50: 6961 2720 6e6f 7420 696e 206f 7074 696f  ia' not in optio
-00014e60: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
-00014e70: 7761 726e 2822 5061 7261 6d65 7465 7220  warn("Parameter 
-00014e80: 2763 7269 7465 7269 6127 2069 7320 7265  'criteria' is re
-00014e90: 7175 6972 6564 2069 6e20 6461 7461 5f76  quired in data_v
-00014ea0: 616c 6964 6174 696f 6e28 2922 290a 2020  alidation()").  
-00014eb0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00014ec0: 202d 320a 0a20 2020 2020 2020 2023 2056   -2..        # V
-00014ed0: 616c 6964 2063 7269 7465 7269 6120 7479  alid criteria ty
-00014ee0: 7065 732e 0a20 2020 2020 2020 2063 7269  pes..        cri
-00014ef0: 7465 7269 615f 7479 7065 7320 3d20 7b0a  teria_types = {.
-00014f00: 2020 2020 2020 2020 2020 2020 2762 6574              'bet
-00014f10: 7765 656e 273a 2027 6265 7477 6565 6e27  ween': 'between'
-00014f20: 2c0a 2020 2020 2020 2020 2020 2020 276e  ,.            'n
-00014f30: 6f74 2062 6574 7765 656e 273a 2027 6e6f  ot between': 'no
-00014f40: 7442 6574 7765 656e 272c 0a20 2020 2020  tBetween',.     
-00014f50: 2020 2020 2020 2027 6571 7561 6c20 746f         'equal to
-00014f60: 273a 2027 6571 7561 6c27 2c0a 2020 2020  ': 'equal',.    
-00014f70: 2020 2020 2020 2020 273d 273a 2027 6571          '=': 'eq
-00014f80: 7561 6c27 2c0a 2020 2020 2020 2020 2020  ual',.          
-00014f90: 2020 273d 3d27 3a20 2765 7175 616c 272c    '==': 'equal',
-00014fa0: 0a20 2020 2020 2020 2020 2020 2027 6e6f  .            'no
-00014fb0: 7420 6571 7561 6c20 746f 273a 2027 6e6f  t equal to': 'no
-00014fc0: 7445 7175 616c 272c 0a20 2020 2020 2020  tEqual',.       
-00014fd0: 2020 2020 2027 213d 273a 2027 6e6f 7445       '!=': 'notE
-00014fe0: 7175 616c 272c 0a20 2020 2020 2020 2020  qual',.         
-00014ff0: 2020 2027 3c3e 273a 2027 6e6f 7445 7175     '<>': 'notEqu
-00015000: 616c 272c 0a20 2020 2020 2020 2020 2020  al',.           
-00015010: 2027 6772 6561 7465 7220 7468 616e 273a   'greater than':
-00015020: 2027 6772 6561 7465 7254 6861 6e27 2c0a   'greaterThan',.
-00015030: 2020 2020 2020 2020 2020 2020 273e 273a              '>':
-00015040: 2027 6772 6561 7465 7254 6861 6e27 2c0a   'greaterThan',.
-00015050: 2020 2020 2020 2020 2020 2020 276c 6573              'les
-00015060: 7320 7468 616e 273a 2027 6c65 7373 5468  s than': 'lessTh
-00015070: 616e 272c 0a20 2020 2020 2020 2020 2020  an',.           
-00015080: 2027 3c27 3a20 276c 6573 7354 6861 6e27   '<': 'lessThan'
-00015090: 2c0a 2020 2020 2020 2020 2020 2020 2767  ,.            'g
-000150a0: 7265 6174 6572 2074 6861 6e20 6f72 2065  reater than or e
-000150b0: 7175 616c 2074 6f27 3a20 2767 7265 6174  qual to': 'great
-000150c0: 6572 5468 616e 4f72 4571 7561 6c27 2c0a  erThanOrEqual',.
-000150d0: 2020 2020 2020 2020 2020 2020 273e 3d27              '>='
-000150e0: 3a20 2767 7265 6174 6572 5468 616e 4f72  : 'greaterThanOr
-000150f0: 4571 7561 6c27 2c0a 2020 2020 2020 2020  Equal',.        
-00015100: 2020 2020 276c 6573 7320 7468 616e 206f      'less than o
-00015110: 7220 6571 7561 6c20 746f 273a 2027 6c65  r equal to': 'le
-00015120: 7373 5468 616e 4f72 4571 7561 6c27 2c0a  ssThanOrEqual',.
-00015130: 2020 2020 2020 2020 2020 2020 273c 3d27              '<='
-00015140: 3a20 276c 6573 7354 6861 6e4f 7245 7175  : 'lessThanOrEqu
-00015150: 616c 272c 0a20 2020 2020 2020 207d 0a0a  al',.        }..
-00015160: 2020 2020 2020 2020 2320 4368 6563 6b20          # Check 
-00015170: 666f 7220 7661 6c69 6420 6372 6974 6572  for valid criter
-00015180: 6961 2074 7970 6573 2e0a 2020 2020 2020  ia types..      
-00015190: 2020 6966 206e 6f74 206f 7074 696f 6e73    if not options
-000151a0: 5b27 6372 6974 6572 6961 275d 2069 6e20  ['criteria'] in 
-000151b0: 6372 6974 6572 6961 5f74 7970 6573 3a0a  criteria_types:.
-000151c0: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-000151d0: 2822 556e 6b6e 6f77 6e20 6372 6974 6572  ("Unknown criter
-000151e0: 6961 2074 7970 6520 2725 7327 2066 6f72  ia type '%s' for
-000151f0: 2070 6172 616d 6574 6572 2022 0a20 2020   parameter ".   
-00015200: 2020 2020 2020 2020 2020 2020 2020 2227                "'
-00015210: 6372 6974 6572 6961 2720 696e 2064 6174  criteria' in dat
-00015220: 615f 7661 6c69 6461 7469 6f6e 2829 2220  a_validation()" 
-00015230: 2520 6f70 7469 6f6e 735b 2763 7269 7465  % options['crite
-00015240: 7269 6127 5d29 0a20 2020 2020 2020 2020  ria']).         
-00015250: 2020 2072 6574 7572 6e20 2d32 0a20 2020     return -2.   
-00015260: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00015270: 2020 2020 2020 206f 7074 696f 6e73 5b27         options['
-00015280: 6372 6974 6572 6961 275d 203d 2063 7269  criteria'] = cri
-00015290: 7465 7269 615f 7479 7065 735b 6f70 7469  teria_types[opti
-000152a0: 6f6e 735b 2763 7269 7465 7269 6127 5d5d  ons['criteria']]
-000152b0: 0a0a 2020 2020 2020 2020 2320 2742 6574  ..        # 'Bet
-000152c0: 7765 656e 2720 616e 6420 274e 6f74 2062  ween' and 'Not b
-000152d0: 6574 7765 656e 2720 6372 6974 6572 6961  etween' criteria
-000152e0: 2072 6571 7569 7265 2032 2076 616c 7565   require 2 value
-000152f0: 732e 0a20 2020 2020 2020 2069 6620 286f  s..        if (o
-00015300: 7074 696f 6e73 5b27 6372 6974 6572 6961  ptions['criteria
-00015310: 275d 203d 3d20 2762 6574 7765 656e 2720  '] == 'between' 
-00015320: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
-00015330: 2020 206f 7074 696f 6e73 5b27 6372 6974     options['crit
-00015340: 6572 6961 275d 203d 3d20 276e 6f74 4265  eria'] == 'notBe
-00015350: 7477 6565 6e27 293a 0a20 2020 2020 2020  tween'):.       
-00015360: 2020 2020 2069 6620 276d 6178 696d 756d       if 'maximum
-00015370: 2720 6e6f 7420 696e 206f 7074 696f 6e73  ' not in options
-00015380: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00015390: 2020 7761 726e 2822 5061 7261 6d65 7465    warn("Paramete
-000153a0: 7220 276d 6178 696d 756d 2720 6973 2072  r 'maximum' is r
-000153b0: 6571 7569 7265 6420 696e 2064 6174 615f  equired in data_
-000153c0: 7661 6c69 6461 7469 6f6e 2829 2022 0a20  validation() ". 
-000153d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000153e0: 2020 2020 2277 6865 6e20 7573 696e 6720      "when using 
-000153f0: 2762 6574 7765 656e 2720 6f72 2027 6e6f  'between' or 'no
-00015400: 7420 6265 7477 6565 6e27 2063 7269 7465  t between' crite
-00015410: 7269 6122 290a 2020 2020 2020 2020 2020  ria").          
-00015420: 2020 2020 2020 7265 7475 726e 202d 320a        return -2.
-00015430: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00015440: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
-00015450: 735b 276d 6178 696d 756d 275d 203d 204e  s['maximum'] = N
-00015460: 6f6e 650a 0a20 2020 2020 2020 2023 2056  one..        # V
-00015470: 616c 6964 2065 7272 6f72 2064 6961 6c6f  alid error dialo
-00015480: 6720 7479 7065 732e 0a20 2020 2020 2020  g types..       
-00015490: 2065 7272 6f72 5f74 7970 6573 203d 207b   error_types = {
-000154a0: 0a20 2020 2020 2020 2020 2020 2027 7374  .            'st
-000154b0: 6f70 273a 2030 2c0a 2020 2020 2020 2020  op': 0,.        
-000154c0: 2020 2020 2777 6172 6e69 6e67 273a 2031      'warning': 1
-000154d0: 2c0a 2020 2020 2020 2020 2020 2020 2769  ,.            'i
-000154e0: 6e66 6f72 6d61 7469 6f6e 273a 2032 2c0a  nformation': 2,.
-000154f0: 2020 2020 2020 2020 7d0a 0a20 2020 2020          }..     
-00015500: 2020 2023 2043 6865 636b 2066 6f72 2076     # Check for v
-00015510: 616c 6964 2065 7272 6f72 2064 6961 6c6f  alid error dialo
-00015520: 6720 7479 7065 732e 0a20 2020 2020 2020  g types..       
-00015530: 2069 6620 2765 7272 6f72 5f74 7970 6527   if 'error_type'
-00015540: 206e 6f74 2069 6e20 6f70 7469 6f6e 733a   not in options:
-00015550: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
-00015560: 696f 6e73 5b27 6572 726f 725f 7479 7065  ions['error_type
-00015570: 275d 203d 2030 0a20 2020 2020 2020 2065  '] = 0.        e
-00015580: 6c69 6620 6e6f 7420 6f70 7469 6f6e 735b  lif not options[
-00015590: 2765 7272 6f72 5f74 7970 6527 5d20 696e  'error_type'] in
-000155a0: 2065 7272 6f72 5f74 7970 6573 3a0a 2020   error_types:.  
-000155b0: 2020 2020 2020 2020 2020 7761 726e 2822            warn("
-000155c0: 556e 6b6e 6f77 6e20 6372 6974 6572 6961  Unknown criteria
-000155d0: 2074 7970 6520 2725 7327 2066 6f72 2070   type '%s' for p
-000155e0: 6172 616d 6574 6572 2027 6572 726f 725f  arameter 'error_
-000155f0: 7479 7065 2720 220a 2020 2020 2020 2020  type' ".        
-00015600: 2020 2020 2020 2020 2022 696e 2064 6174           "in dat
-00015610: 615f 7661 6c69 6461 7469 6f6e 2829 2220  a_validation()" 
-00015620: 2520 6f70 7469 6f6e 735b 2765 7272 6f72  % options['error
-00015630: 5f74 7970 6527 5d29 0a20 2020 2020 2020  _type']).       
-00015640: 2020 2020 2072 6574 7572 6e20 2d32 0a20       return -2. 
-00015650: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00015660: 2020 2020 2020 2020 206f 7074 696f 6e73           options
-00015670: 5b27 6572 726f 725f 7479 7065 275d 203d  ['error_type'] =
-00015680: 2065 7272 6f72 5f74 7970 6573 5b6f 7074   error_types[opt
-00015690: 696f 6e73 5b27 6572 726f 725f 7479 7065  ions['error_type
-000156a0: 275d 5d0a 0a20 2020 2020 2020 2023 2043  ']]..        # C
-000156b0: 6f6e 7665 7274 2064 6174 652f 7469 6d65  onvert date/time
-000156c0: 7320 7661 6c75 6520 6966 2072 6571 7569  s value if requi
-000156d0: 7265 642e 0a20 2020 2020 2020 2069 6620  red..        if 
-000156e0: 6f70 7469 6f6e 735b 2776 616c 6964 6174  options['validat
-000156f0: 6527 5d20 696e 2028 2764 6174 6527 2c20  e'] in ('date', 
-00015700: 2774 696d 6527 293a 0a0a 2020 2020 2020  'time'):..      
-00015710: 2020 2020 2020 6966 206f 7074 696f 6e73        if options
-00015720: 5b27 7661 6c75 6527 5d3a 0a20 2020 2020  ['value']:.     
-00015730: 2020 2020 2020 2020 2020 2069 6620 7375             if su
-00015740: 7070 6f72 7465 645f 6461 7465 7469 6d65  pported_datetime
-00015750: 286f 7074 696f 6e73 5b27 7661 6c75 6527  (options['value'
-00015760: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
-00015770: 2020 2020 2020 2020 6461 7465 5f74 696d          date_tim
-00015780: 6520 3d20 7365 6c66 2e5f 636f 6e76 6572  e = self._conver
-00015790: 745f 6461 7465 5f74 696d 6528 6f70 7469  t_date_time(opti
-000157a0: 6f6e 735b 2776 616c 7565 275d 290a 2020  ons['value']).  
-000157b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000157c0: 2020 2320 466f 726d 6174 2064 6174 6520    # Format date 
-000157d0: 6e75 6d62 6572 2074 6f20 7468 6520 7361  number to the sa
-000157e0: 6d65 2070 7265 6369 7369 6f6e 2061 7320  me precision as 
-000157f0: 4578 6365 6c2e 0a20 2020 2020 2020 2020  Excel..         
-00015800: 2020 2020 2020 2020 2020 206f 7074 696f             optio
-00015810: 6e73 5b27 7661 6c75 6527 5d20 3d20 2225  ns['value'] = "%
-00015820: 2e31 3667 2220 2520 6461 7465 5f74 696d  .16g" % date_tim
-00015830: 650a 0a20 2020 2020 2020 2020 2020 2069  e..            i
-00015840: 6620 6f70 7469 6f6e 735b 276d 6178 696d  f options['maxim
-00015850: 756d 275d 3a0a 2020 2020 2020 2020 2020  um']:.          
-00015860: 2020 2020 2020 6966 2073 7570 706f 7274        if support
-00015870: 6564 5f64 6174 6574 696d 6528 6f70 7469  ed_datetime(opti
-00015880: 6f6e 735b 276d 6178 696d 756d 275d 293a  ons['maximum']):
-00015890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000158a0: 2020 2020 2064 6174 655f 7469 6d65 203d       date_time =
-000158b0: 2073 656c 662e 5f63 6f6e 7665 7274 5f64   self._convert_d
-000158c0: 6174 655f 7469 6d65 286f 7074 696f 6e73  ate_time(options
-000158d0: 5b27 6d61 7869 6d75 6d27 5d29 0a20 2020  ['maximum']).   
-000158e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000158f0: 206f 7074 696f 6e73 5b27 6d61 7869 6d75   options['maximu
-00015900: 6d27 5d20 3d20 2225 2e31 3667 2220 2520  m'] = "%.16g" % 
-00015910: 6461 7465 5f74 696d 650a 0a20 2020 2020  date_time..     
-00015920: 2020 2023 2043 6865 636b 2074 6861 7420     # Check that 
-00015930: 7468 6520 696e 7075 7420 7469 746c 6520  the input title 
-00015940: 646f 6573 6e27 7420 6578 6365 6564 2074  doesn't exceed t
-00015950: 6865 206d 6178 696d 756d 206c 656e 6774  he maximum lengt
-00015960: 682e 0a20 2020 2020 2020 2069 6620 6f70  h..        if op
-00015970: 7469 6f6e 732e 6765 7428 2769 6e70 7574  tions.get('input
-00015980: 5f74 6974 6c65 2729 2061 6e64 206c 656e  _title') and len
-00015990: 286f 7074 696f 6e73 5b27 696e 7075 745f  (options['input_
-000159a0: 7469 746c 6527 5d29 203e 2033 323a 0a20  title']) > 32:. 
-000159b0: 2020 2020 2020 2020 2020 2077 6172 6e28             warn(
-000159c0: 224c 656e 6774 6820 6f66 2069 6e70 7574  "Length of input
-000159d0: 2074 6974 6c65 2027 2573 2720 6578 6365   title '%s' exce
-000159e0: 6564 7320 4578 6365 6c27 7320 6c69 6d69  eds Excel's limi
-000159f0: 7420 6f66 2033 3222 0a20 2020 2020 2020  t of 32".       
-00015a00: 2020 2020 2020 2020 2020 2520 6f70 7469            % opti
-00015a10: 6f6e 735b 2769 6e70 7574 5f74 6974 6c65  ons['input_title
-00015a20: 275d 290a 2020 2020 2020 2020 2020 2020  ']).            
-00015a30: 7265 7475 726e 202d 320a 0a20 2020 2020  return -2..     
-00015a40: 2020 2023 2043 6865 636b 2074 6861 7420     # Check that 
-00015a50: 7468 6520 6572 726f 7220 7469 746c 6520  the error title 
-00015a60: 646f 6573 6e27 7420 6578 6365 6564 2074  doesn't exceed t
-00015a70: 6865 206d 6178 696d 756d 206c 656e 6774  he maximum lengt
-00015a80: 682e 0a20 2020 2020 2020 2069 6620 6f70  h..        if op
-00015a90: 7469 6f6e 732e 6765 7428 2765 7272 6f72  tions.get('error
-00015aa0: 5f74 6974 6c65 2729 2061 6e64 206c 656e  _title') and len
-00015ab0: 286f 7074 696f 6e73 5b27 6572 726f 725f  (options['error_
-00015ac0: 7469 746c 6527 5d29 203e 2033 323a 0a20  title']) > 32:. 
-00015ad0: 2020 2020 2020 2020 2020 2077 6172 6e28             warn(
-00015ae0: 224c 656e 6774 6820 6f66 2065 7272 6f72  "Length of error
-00015af0: 2074 6974 6c65 2027 2573 2720 6578 6365   title '%s' exce
-00015b00: 6564 7320 4578 6365 6c27 7320 6c69 6d69  eds Excel's limi
-00015b10: 7420 6f66 2033 3222 0a20 2020 2020 2020  t of 32".       
-00015b20: 2020 2020 2020 2020 2020 2520 6f70 7469            % opti
-00015b30: 6f6e 735b 2765 7272 6f72 5f74 6974 6c65  ons['error_title
-00015b40: 275d 290a 2020 2020 2020 2020 2020 2020  ']).            
-00015b50: 7265 7475 726e 202d 320a 0a20 2020 2020  return -2..     
-00015b60: 2020 2023 2043 6865 636b 2074 6861 7420     # Check that 
-00015b70: 7468 6520 696e 7075 7420 6d65 7373 6167  the input messag
-00015b80: 6520 646f 6573 6e27 7420 6578 6365 6564  e doesn't exceed
-00015b90: 2074 6865 206d 6178 696d 756d 206c 656e   the maximum len
-00015ba0: 6774 682e 0a20 2020 2020 2020 2069 6620  gth..        if 
-00015bb0: 286f 7074 696f 6e73 2e67 6574 2827 696e  (options.get('in
-00015bc0: 7075 745f 6d65 7373 6167 6527 290a 2020  put_message').  
-00015bd0: 2020 2020 2020 2020 2020 2020 2020 616e                an
-00015be0: 6420 6c65 6e28 6f70 7469 6f6e 735b 2769  d len(options['i
-00015bf0: 6e70 7574 5f6d 6573 7361 6765 275d 2920  nput_message']) 
-00015c00: 3e20 3235 3529 3a0a 2020 2020 2020 2020  > 255):.        
-00015c10: 2020 2020 7761 726e 2822 4c65 6e67 7468      warn("Length
-00015c20: 206f 6620 696e 7075 7420 6d65 7373 6167   of input messag
-00015c30: 6520 2725 7327 2065 7863 6565 6473 2045  e '%s' exceeds E
-00015c40: 7863 656c 2773 206c 696d 6974 206f 6620  xcel's limit of 
-00015c50: 3235 3522 0a20 2020 2020 2020 2020 2020  255".           
-00015c60: 2020 2020 2020 2520 6f70 7469 6f6e 735b        % options[
-00015c70: 2769 6e70 7574 5f6d 6573 7361 6765 275d  'input_message']
-00015c80: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00015c90: 7475 726e 202d 320a 0a20 2020 2020 2020  turn -2..       
-00015ca0: 2023 2043 6865 636b 2074 6861 7420 7468   # Check that th
-00015cb0: 6520 6572 726f 7220 6d65 7373 6167 6520  e error message 
-00015cc0: 646f 6573 6e27 7420 6578 6365 6564 2074  doesn't exceed t
-00015cd0: 6865 206d 6178 696d 756d 206c 656e 6774  he maximum lengt
-00015ce0: 682e 0a20 2020 2020 2020 2069 6620 286f  h..        if (o
-00015cf0: 7074 696f 6e73 2e67 6574 2827 6572 726f  ptions.get('erro
-00015d00: 725f 6d65 7373 6167 6527 290a 2020 2020  r_message').    
-00015d10: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00015d20: 6c65 6e28 6f70 7469 6f6e 735b 2765 7272  len(options['err
-00015d30: 6f72 5f6d 6573 7361 6765 275d 2920 3e20  or_message']) > 
-00015d40: 3235 3529 3a0a 2020 2020 2020 2020 2020  255):.          
-00015d50: 2020 7761 726e 2822 4c65 6e67 7468 206f    warn("Length o
-00015d60: 6620 6572 726f 7220 6d65 7373 6167 6520  f error message 
-00015d70: 2725 7327 2065 7863 6565 6473 2045 7863  '%s' exceeds Exc
-00015d80: 656c 2773 206c 696d 6974 206f 6620 3235  el's limit of 25
-00015d90: 3522 0a20 2020 2020 2020 2020 2020 2020  5".             
-00015da0: 2020 2020 2520 6f70 7469 6f6e 735b 2765      % options['e
-00015db0: 7272 6f72 5f6d 6573 7361 6765 275d 290a  rror_message']).
-00015dc0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00015dd0: 726e 202d 320a 0a20 2020 2020 2020 2023  rn -2..        #
-00015de0: 2043 6865 636b 2074 6861 7420 7468 6520   Check that the 
-00015df0: 696e 7075 7420 6c69 7374 2064 6f65 736e  input list doesn
-00015e00: 2774 2065 7863 6565 6420 7468 6520 6d61  't exceed the ma
-00015e10: 7869 6d75 6d20 6c65 6e67 7468 2e0a 2020  ximum length..  
-00015e20: 2020 2020 2020 6966 206f 7074 696f 6e73        if options
-00015e30: 5b27 7661 6c69 6461 7465 275d 203d 3d20  ['validate'] == 
-00015e40: 276c 6973 7427 2061 6e64 2074 7970 6528  'list' and type(
-00015e50: 6f70 7469 6f6e 735b 2776 616c 7565 275d  options['value']
-00015e60: 2920 6973 206c 6973 743a 0a20 2020 2020  ) is list:.     
-00015e70: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
-00015e80: 2073 656c 662e 5f63 7376 5f6a 6f69 6e28   self._csv_join(
-00015e90: 2a6f 7074 696f 6e73 5b27 7661 6c75 6527  *options['value'
-00015ea0: 5d29 0a20 2020 2020 2020 2020 2020 2069  ]).            i
-00015eb0: 6620 6c65 6e28 666f 726d 756c 6129 203e  f len(formula) >
-00015ec0: 2032 3535 3a0a 2020 2020 2020 2020 2020   255:.          
-00015ed0: 2020 2020 2020 7761 726e 2822 4c65 6e67        warn("Leng
-00015ee0: 7468 206f 6620 6c69 7374 2069 7465 6d73  th of list items
-00015ef0: 2027 2573 2720 6578 6365 6564 7320 4578   '%s' exceeds Ex
-00015f00: 6365 6c27 7320 6c69 6d69 7420 6f66 2022  cel's limit of "
-00015f10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015f20: 2020 2020 2020 2232 3535 2c20 7573 6520        "255, use 
-00015f30: 6120 666f 726d 756c 6120 7261 6e67 6520  a formula range 
-00015f40: 696e 7374 6561 6422 2025 2066 6f72 6d75  instead" % formu
-00015f50: 6c61 290a 2020 2020 2020 2020 2020 2020  la).            
-00015f60: 2020 2020 7265 7475 726e 202d 320a 0a20      return -2.. 
-00015f70: 2020 2020 2020 2023 2053 6574 2073 6f6d         # Set som
-00015f80: 6520 6465 6661 756c 7473 2069 6620 7468  e defaults if th
-00015f90: 6579 2068 6176 656e 2774 2062 6565 6e20  ey haven't been 
-00015fa0: 6465 6669 6e65 6420 6279 2074 6865 2075  defined by the u
-00015fb0: 7365 722e 0a20 2020 2020 2020 2069 6620  ser..        if 
-00015fc0: 2769 676e 6f72 655f 626c 616e 6b27 206e  'ignore_blank' n
-00015fd0: 6f74 2069 6e20 6f70 7469 6f6e 733a 0a20  ot in options:. 
-00015fe0: 2020 2020 2020 2020 2020 206f 7074 696f             optio
-00015ff0: 6e73 5b27 6967 6e6f 7265 5f62 6c61 6e6b  ns['ignore_blank
-00016000: 275d 203d 2031 0a20 2020 2020 2020 2069  '] = 1.        i
-00016010: 6620 2764 726f 7064 6f77 6e27 206e 6f74  f 'dropdown' not
-00016020: 2069 6e20 6f70 7469 6f6e 733a 0a20 2020   in options:.   
-00016030: 2020 2020 2020 2020 206f 7074 696f 6e73           options
-00016040: 5b27 6472 6f70 646f 776e 275d 203d 2031  ['dropdown'] = 1
-00016050: 0a20 2020 2020 2020 2069 6620 2773 686f  .        if 'sho
-00016060: 775f 696e 7075 7427 206e 6f74 2069 6e20  w_input' not in 
-00016070: 6f70 7469 6f6e 733a 0a20 2020 2020 2020  options:.       
-00016080: 2020 2020 206f 7074 696f 6e73 5b27 7368       options['sh
-00016090: 6f77 5f69 6e70 7574 275d 203d 2031 0a20  ow_input'] = 1. 
-000160a0: 2020 2020 2020 2069 6620 2773 686f 775f         if 'show_
-000160b0: 6572 726f 7227 206e 6f74 2069 6e20 6f70  error' not in op
-000160c0: 7469 6f6e 733a 0a20 2020 2020 2020 2020  tions:.         
-000160d0: 2020 206f 7074 696f 6e73 5b27 7368 6f77     options['show
-000160e0: 5f65 7272 6f72 275d 203d 2031 0a0a 2020  _error'] = 1..  
-000160f0: 2020 2020 2020 2320 5468 6573 6520 6172        # These ar
-00016100: 6520 7468 6520 6365 6c6c 7320 746f 2077  e the cells to w
-00016110: 6869 6368 2074 6865 2076 616c 6964 6174  hich the validat
-00016120: 696f 6e20 6973 2061 7070 6c69 6564 2e0a  ion is applied..
-00016130: 2020 2020 2020 2020 6f70 7469 6f6e 735b          options[
-00016140: 2763 656c 6c73 275d 203d 205b 5b66 6972  'cells'] = [[fir
-00016150: 7374 5f72 6f77 2c20 6669 7273 745f 636f  st_row, first_co
-00016160: 6c2c 206c 6173 745f 726f 772c 206c 6173  l, last_row, las
-00016170: 745f 636f 6c5d 5d0a 0a20 2020 2020 2020  t_col]]..       
-00016180: 2023 2041 2028 666f 7220 6e6f 7729 2075   # A (for now) u
-00016190: 6e64 6f63 756d 656e 7465 6420 7061 7261  ndocumented para
-000161a0: 6d65 7465 7220 746f 2070 6173 7320 6164  meter to pass ad
-000161b0: 6469 7469 6f6e 616c 2063 656c 6c20 7261  ditional cell ra
-000161c0: 6e67 6573 2e0a 2020 2020 2020 2020 6966  nges..        if
-000161d0: 2027 6f74 6865 725f 6365 6c6c 7327 2069   'other_cells' i
-000161e0: 6e20 6f70 7469 6f6e 733a 0a20 2020 2020  n options:.     
-000161f0: 2020 2020 2020 206f 7074 696f 6e73 5b27         options['
-00016200: 6365 6c6c 7327 5d2e 6578 7465 6e64 286f  cells'].extend(o
-00016210: 7074 696f 6e73 5b27 6f74 6865 725f 6365  ptions['other_ce
-00016220: 6c6c 7327 5d29 0a0a 2020 2020 2020 2020  lls'])..        
-00016230: 2320 4f76 6572 7269 6465 2077 6974 6820  # Override with 
-00016240: 7573 6572 2064 6566 696e 6564 206d 756c  user defined mul
-00016250: 7469 706c 6520 7261 6e67 6520 6966 2070  tiple range if p
-00016260: 726f 7669 6465 642e 0a20 2020 2020 2020  rovided..       
-00016270: 2069 6620 276d 756c 7469 5f72 616e 6765   if 'multi_range
-00016280: 2720 696e 206f 7074 696f 6e73 3a0a 2020  ' in options:.  
-00016290: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
-000162a0: 735b 276d 756c 7469 5f72 616e 6765 275d  s['multi_range']
-000162b0: 203d 206f 7074 696f 6e73 5b27 6d75 6c74   = options['mult
-000162c0: 695f 7261 6e67 6527 5d2e 7265 706c 6163  i_range'].replac
-000162d0: 6528 2724 272c 2027 2729 0a0a 2020 2020  e('$', '')..    
-000162e0: 2020 2020 2320 5374 6f72 6520 7468 6520      # Store the 
-000162f0: 7661 6c69 6461 7469 6f6e 2069 6e66 6f72  validation infor
-00016300: 6d61 7469 6f6e 2075 6e74 696c 2077 6520  mation until we 
-00016310: 636c 6f73 6520 7468 6520 776f 726b 7368  close the worksh
-00016320: 6565 742e 0a20 2020 2020 2020 2073 656c  eet..        sel
-00016330: 662e 7661 6c69 6461 7469 6f6e 732e 6170  f.validations.ap
-00016340: 7065 6e64 286f 7074 696f 6e73 290a 0a20  pend(options).. 
-00016350: 2020 2020 2020 2072 6574 7572 6e20 300a         return 0.
-00016360: 0a20 2020 2040 636f 6e76 6572 745f 7261  .    @convert_ra
-00016370: 6e67 655f 6172 6773 0a20 2020 2064 6566  nge_args.    def
-00016380: 2063 6f6e 6469 7469 6f6e 616c 5f66 6f72   conditional_for
-00016390: 6d61 7428 7365 6c66 2c20 6669 7273 745f  mat(self, first_
-000163a0: 726f 772c 2066 6972 7374 5f63 6f6c 2c20  row, first_col, 
-000163b0: 6c61 7374 5f72 6f77 2c20 6c61 7374 5f63  last_row, last_c
-000163c0: 6f6c 2c0a 2020 2020 2020 2020 2020 2020  ol,.            
-000163d0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-000163e0: 7074 696f 6e73 3d4e 6f6e 6529 3a0a 2020  ptions=None):.  
-000163f0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00016400: 2020 4164 6420 6120 636f 6e64 6974 696f    Add a conditio
-00016410: 6e61 6c20 666f 726d 6174 2074 6f20 6120  nal format to a 
-00016420: 776f 726b 7368 6565 742e 0a0a 2020 2020  worksheet...    
-00016430: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
-00016440: 2020 2020 2020 6669 7273 745f 726f 773a        first_row:
-00016450: 2020 2020 5468 6520 6669 7273 7420 726f      The first ro
-00016460: 7720 6f66 2074 6865 2063 656c 6c20 7261  w of the cell ra
-00016470: 6e67 652e 2028 7a65 726f 2069 6e64 6578  nge. (zero index
-00016480: 6564 292e 0a20 2020 2020 2020 2020 2020  ed)..           
-00016490: 2066 6972 7374 5f63 6f6c 3a20 2020 2054   first_col:    T
-000164a0: 6865 2066 6972 7374 2063 6f6c 756d 6e20  he first column 
-000164b0: 6f66 2074 6865 2063 656c 6c20 7261 6e67  of the cell rang
-000164c0: 652e 0a20 2020 2020 2020 2020 2020 206c  e..            l
-000164d0: 6173 745f 726f 773a 2020 2020 2054 6865  ast_row:     The
-000164e0: 206c 6173 7420 726f 7720 6f66 2074 6865   last row of the
-000164f0: 2063 656c 6c20 7261 6e67 652e 2028 7a65   cell range. (ze
-00016500: 726f 2069 6e64 6578 6564 292e 0a20 2020  ro indexed)..   
-00016510: 2020 2020 2020 2020 206c 6173 745f 636f           last_co
-00016520: 6c3a 2020 2020 2054 6865 206c 6173 7420  l:     The last 
-00016530: 636f 6c75 6d6e 206f 6620 7468 6520 6365  column of the ce
-00016540: 6c6c 2072 616e 6765 2e0a 2020 2020 2020  ll range..      
-00016550: 2020 2020 2020 6f70 7469 6f6e 733a 2020        options:  
-00016560: 2020 2020 436f 6e64 6974 696f 6e61 6c20      Conditional 
-00016570: 666f 726d 6174 206f 7074 696f 6e73 2e0a  format options..
-00016580: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00016590: 3a0a 2020 2020 2020 2020 2020 2020 303a  :.            0:
-000165a0: 2020 5375 6363 6573 732e 0a20 2020 2020    Success..     
-000165b0: 2020 2020 2020 202d 313a 2052 6f77 206f         -1: Row o
-000165c0: 7220 636f 6c75 6d6e 2069 7320 6f75 7420  r column is out 
-000165d0: 6f66 2077 6f72 6b73 6865 6574 2062 6f75  of worksheet bou
-000165e0: 6e64 732e 0a20 2020 2020 2020 2020 2020  nds..           
-000165f0: 202d 323a 2049 6e63 6f72 7265 6374 2070   -2: Incorrect p
-00016600: 6172 616d 6574 6572 206f 7220 6f70 7469  arameter or opti
-00016610: 6f6e 2e0a 2020 2020 2020 2020 2222 220a  on..        """.
-00016620: 2020 2020 2020 2020 2320 4368 6563 6b20          # Check 
-00016630: 7468 6174 2072 6f77 2061 6e64 2063 6f6c  that row and col
-00016640: 2061 7265 2076 616c 6964 2077 6974 686f   are valid witho
-00016650: 7574 2073 746f 7269 6e67 2074 6865 2076  ut storing the v
-00016660: 616c 7565 732e 0a20 2020 2020 2020 2069  alues..        i
-00016670: 6620 7365 6c66 2e5f 6368 6563 6b5f 6469  f self._check_di
-00016680: 6d65 6e73 696f 6e73 2866 6972 7374 5f72  mensions(first_r
-00016690: 6f77 2c20 6669 7273 745f 636f 6c2c 2054  ow, first_col, T
-000166a0: 7275 652c 2054 7275 6529 3a0a 2020 2020  rue, True):.    
-000166b0: 2020 2020 2020 2020 7265 7475 726e 202d          return -
-000166c0: 310a 2020 2020 2020 2020 6966 2073 656c  1.        if sel
-000166d0: 662e 5f63 6865 636b 5f64 696d 656e 7369  f._check_dimensi
-000166e0: 6f6e 7328 6c61 7374 5f72 6f77 2c20 6c61  ons(last_row, la
-000166f0: 7374 5f63 6f6c 2c20 5472 7565 2c20 5472  st_col, True, Tr
-00016700: 7565 293a 0a20 2020 2020 2020 2020 2020  ue):.           
-00016710: 2072 6574 7572 6e20 2d31 0a0a 2020 2020   return -1..    
-00016720: 2020 2020 6966 206f 7074 696f 6e73 2069      if options i
-00016730: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00016740: 2020 2020 6f70 7469 6f6e 7320 3d20 7b7d      options = {}
-00016750: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00016760: 2020 2020 2020 2020 2020 2023 2043 6f70             # Cop
-00016770: 7920 7468 6520 7573 6572 2064 6566 696e  y the user defin
-00016780: 6564 206f 7074 696f 6e73 2073 6f20 7468  ed options so th
-00016790: 6579 2061 7265 6e27 7420 6d6f 6469 6669  ey aren't modifi
-000167a0: 6564 2e0a 2020 2020 2020 2020 2020 2020  ed..            
-000167b0: 6f70 7469 6f6e 7320 3d20 6f70 7469 6f6e  options = option
-000167c0: 732e 636f 7079 2829 0a0a 2020 2020 2020  s.copy()..      
-000167d0: 2020 2320 5661 6c69 6420 696e 7075 7420    # Valid input 
-000167e0: 7061 7261 6d65 7465 7273 2e0a 2020 2020  parameters..    
-000167f0: 2020 2020 7661 6c69 645f 7061 7261 6d65      valid_parame
-00016800: 7465 7220 3d20 7b0a 2020 2020 2020 2020  ter = {.        
-00016810: 2020 2020 2774 7970 6527 2c0a 2020 2020      'type',.    
-00016820: 2020 2020 2020 2020 2766 6f72 6d61 7427          'format'
-00016830: 2c0a 2020 2020 2020 2020 2020 2020 2763  ,.            'c
-00016840: 7269 7465 7269 6127 2c0a 2020 2020 2020  riteria',.      
-00016850: 2020 2020 2020 2776 616c 7565 272c 0a20        'value',. 
-00016860: 2020 2020 2020 2020 2020 2027 6d69 6e69             'mini
-00016870: 6d75 6d27 2c0a 2020 2020 2020 2020 2020  mum',.          
-00016880: 2020 276d 6178 696d 756d 272c 0a20 2020    'maximum',.   
-00016890: 2020 2020 2020 2020 2027 7374 6f70 5f69           'stop_i
-000168a0: 665f 7472 7565 272c 0a20 2020 2020 2020  f_true',.       
-000168b0: 2020 2020 2027 6d69 6e5f 7479 7065 272c       'min_type',
-000168c0: 0a20 2020 2020 2020 2020 2020 2027 6d69  .            'mi
-000168d0: 645f 7479 7065 272c 0a20 2020 2020 2020  d_type',.       
-000168e0: 2020 2020 2027 6d61 785f 7479 7065 272c       'max_type',
-000168f0: 0a20 2020 2020 2020 2020 2020 2027 6d69  .            'mi
-00016900: 6e5f 7661 6c75 6527 2c0a 2020 2020 2020  n_value',.      
-00016910: 2020 2020 2020 276d 6964 5f76 616c 7565        'mid_value
-00016920: 272c 0a20 2020 2020 2020 2020 2020 2027  ',.            '
-00016930: 6d61 785f 7661 6c75 6527 2c0a 2020 2020  max_value',.    
-00016940: 2020 2020 2020 2020 276d 696e 5f63 6f6c          'min_col
-00016950: 6f72 272c 0a20 2020 2020 2020 2020 2020  or',.           
-00016960: 2027 6d69 645f 636f 6c6f 7227 2c0a 2020   'mid_color',.  
-00016970: 2020 2020 2020 2020 2020 276d 6178 5f63            'max_c
-00016980: 6f6c 6f72 272c 0a20 2020 2020 2020 2020  olor',.         
-00016990: 2020 2027 6d69 6e5f 6c65 6e67 7468 272c     'min_length',
-000169a0: 0a20 2020 2020 2020 2020 2020 2027 6d61  .            'ma
-000169b0: 785f 6c65 6e67 7468 272c 0a20 2020 2020  x_length',.     
-000169c0: 2020 2020 2020 2027 6d75 6c74 695f 7261         'multi_ra
-000169d0: 6e67 6527 2c0a 2020 2020 2020 2020 2020  nge',.          
-000169e0: 2020 2762 6172 5f63 6f6c 6f72 272c 0a20    'bar_color',. 
-000169f0: 2020 2020 2020 2020 2020 2027 6261 725f             'bar_
-00016a00: 6e65 6761 7469 7665 5f63 6f6c 6f72 272c  negative_color',
-00016a10: 0a20 2020 2020 2020 2020 2020 2027 6261  .            'ba
-00016a20: 725f 6e65 6761 7469 7665 5f63 6f6c 6f72  r_negative_color
-00016a30: 5f73 616d 6527 2c0a 2020 2020 2020 2020  _same',.        
-00016a40: 2020 2020 2762 6172 5f73 6f6c 6964 272c      'bar_solid',
-00016a50: 0a20 2020 2020 2020 2020 2020 2027 6261  .            'ba
-00016a60: 725f 626f 7264 6572 5f63 6f6c 6f72 272c  r_border_color',
-00016a70: 0a20 2020 2020 2020 2020 2020 2027 6261  .            'ba
-00016a80: 725f 6e65 6761 7469 7665 5f62 6f72 6465  r_negative_borde
-00016a90: 725f 636f 6c6f 7227 2c0a 2020 2020 2020  r_color',.      
-00016aa0: 2020 2020 2020 2762 6172 5f6e 6567 6174        'bar_negat
-00016ab0: 6976 655f 626f 7264 6572 5f63 6f6c 6f72  ive_border_color
-00016ac0: 5f73 616d 6527 2c0a 2020 2020 2020 2020  _same',.        
-00016ad0: 2020 2020 2762 6172 5f6e 6f5f 626f 7264      'bar_no_bord
-00016ae0: 6572 272c 0a20 2020 2020 2020 2020 2020  er',.           
-00016af0: 2027 6261 725f 6469 7265 6374 696f 6e27   'bar_direction'
-00016b00: 2c0a 2020 2020 2020 2020 2020 2020 2762  ,.            'b
-00016b10: 6172 5f61 7869 735f 706f 7369 7469 6f6e  ar_axis_position
-00016b20: 272c 0a20 2020 2020 2020 2020 2020 2027  ',.            '
-00016b30: 6261 725f 6178 6973 5f63 6f6c 6f72 272c  bar_axis_color',
-00016b40: 0a20 2020 2020 2020 2020 2020 2027 6261  .            'ba
-00016b50: 725f 6f6e 6c79 272c 0a20 2020 2020 2020  r_only',.       
-00016b60: 2020 2020 2027 6461 7461 5f62 6172 5f32       'data_bar_2
-00016b70: 3031 3027 2c0a 2020 2020 2020 2020 2020  010',.          
-00016b80: 2020 2769 636f 6e5f 7374 796c 6527 2c0a    'icon_style',.
-00016b90: 2020 2020 2020 2020 2020 2020 2772 6576              'rev
-00016ba0: 6572 7365 5f69 636f 6e73 272c 0a20 2020  erse_icons',.   
-00016bb0: 2020 2020 2020 2020 2027 6963 6f6e 735f           'icons_
-00016bc0: 6f6e 6c79 272c 0a20 2020 2020 2020 2020  only',.         
-00016bd0: 2020 2027 6963 6f6e 7327 7d0a 0a20 2020     'icons'}..   
-00016be0: 2020 2020 2023 2043 6865 636b 2066 6f72       # Check for
-00016bf0: 2076 616c 6964 2069 6e70 7574 2070 6172   valid input par
-00016c00: 616d 6574 6572 732e 0a20 2020 2020 2020  ameters..       
-00016c10: 2066 6f72 2070 6172 616d 5f6b 6579 2069   for param_key i
-00016c20: 6e20 6f70 7469 6f6e 732e 6b65 7973 2829  n options.keys()
-00016c30: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00016c40: 2070 6172 616d 5f6b 6579 206e 6f74 2069   param_key not i
-00016c50: 6e20 7661 6c69 645f 7061 7261 6d65 7465  n valid_paramete
-00016c60: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
-00016c70: 2020 2077 6172 6e28 2255 6e6b 6e6f 776e     warn("Unknown
-00016c80: 2070 6172 616d 6574 6572 2027 2573 2720   parameter '%s' 
-00016c90: 696e 2063 6f6e 6469 7469 6f6e 616c 5f66  in conditional_f
-00016ca0: 6f72 6d61 7428 2922 2025 0a20 2020 2020  ormat()" %.     
-00016cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016cc0: 7061 7261 6d5f 6b65 7929 0a20 2020 2020  param_key).     
-00016cd0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00016ce0: 6e20 2d32 0a0a 2020 2020 2020 2020 2320  n -2..        # 
-00016cf0: 2774 7970 6527 2069 7320 6120 7265 7175  'type' is a requ
-00016d00: 6972 6564 2070 6172 616d 6574 6572 2e0a  ired parameter..
-00016d10: 2020 2020 2020 2020 6966 2027 7479 7065          if 'type
-00016d20: 2720 6e6f 7420 696e 206f 7074 696f 6e73  ' not in options
-00016d30: 3a0a 2020 2020 2020 2020 2020 2020 7761  :.            wa
-00016d40: 726e 2822 5061 7261 6d65 7465 7220 2774  rn("Parameter 't
-00016d50: 7970 6527 2069 7320 7265 7175 6972 6564  ype' is required
-00016d60: 2069 6e20 636f 6e64 6974 696f 6e61 6c5f   in conditional_
-00016d70: 666f 726d 6174 2829 2229 0a20 2020 2020  format()").     
-00016d80: 2020 2020 2020 2072 6574 7572 6e20 2d32         return -2
-00016d90: 0a0a 2020 2020 2020 2020 2320 5661 6c69  ..        # Vali
-00016da0: 6420 7479 7065 732e 0a20 2020 2020 2020  d types..       
-00016db0: 2076 616c 6964 5f74 7970 6520 3d20 7b0a   valid_type = {.
-00016dc0: 2020 2020 2020 2020 2020 2020 2763 656c              'cel
-00016dd0: 6c27 3a20 2763 656c 6c49 7327 2c0a 2020  l': 'cellIs',.  
-00016de0: 2020 2020 2020 2020 2020 2764 6174 6527            'date'
-00016df0: 3a20 2764 6174 6527 2c0a 2020 2020 2020  : 'date',.      
-00016e00: 2020 2020 2020 2774 696d 6527 3a20 2774        'time': 't
-00016e10: 696d 6527 2c0a 2020 2020 2020 2020 2020  ime',.          
-00016e20: 2020 2761 7665 7261 6765 273a 2027 6162    'average': 'ab
-00016e30: 6f76 6541 7665 7261 6765 272c 0a20 2020  oveAverage',.   
-00016e40: 2020 2020 2020 2020 2027 6475 706c 6963           'duplic
-00016e50: 6174 6527 3a20 2764 7570 6c69 6361 7465  ate': 'duplicate
-00016e60: 5661 6c75 6573 272c 0a20 2020 2020 2020  Values',.       
-00016e70: 2020 2020 2027 756e 6971 7565 273a 2027       'unique': '
-00016e80: 756e 6971 7565 5661 6c75 6573 272c 0a20  uniqueValues',. 
-00016e90: 2020 2020 2020 2020 2020 2027 746f 7027             'top'
-00016ea0: 3a20 2774 6f70 3130 272c 0a20 2020 2020  : 'top10',.     
-00016eb0: 2020 2020 2020 2027 626f 7474 6f6d 273a         'bottom':
-00016ec0: 2027 746f 7031 3027 2c0a 2020 2020 2020   'top10',.      
-00016ed0: 2020 2020 2020 2774 6578 7427 3a20 2774        'text': 't
-00016ee0: 6578 7427 2c0a 2020 2020 2020 2020 2020  ext',.          
-00016ef0: 2020 2774 696d 655f 7065 7269 6f64 273a    'time_period':
-00016f00: 2027 7469 6d65 5065 7269 6f64 272c 0a20   'timePeriod',. 
-00016f10: 2020 2020 2020 2020 2020 2027 626c 616e             'blan
-00016f20: 6b73 273a 2027 636f 6e74 6169 6e73 426c  ks': 'containsBl
-00016f30: 616e 6b73 272c 0a20 2020 2020 2020 2020  anks',.         
-00016f40: 2020 2027 6e6f 5f62 6c61 6e6b 7327 3a20     'no_blanks': 
-00016f50: 276e 6f74 436f 6e74 6169 6e73 426c 616e  'notContainsBlan
-00016f60: 6b73 272c 0a20 2020 2020 2020 2020 2020  ks',.           
-00016f70: 2027 6572 726f 7273 273a 2027 636f 6e74   'errors': 'cont
-00016f80: 6169 6e73 4572 726f 7273 272c 0a20 2020  ainsErrors',.   
-00016f90: 2020 2020 2020 2020 2027 6e6f 5f65 7272           'no_err
-00016fa0: 6f72 7327 3a20 276e 6f74 436f 6e74 6169  ors': 'notContai
-00016fb0: 6e73 4572 726f 7273 272c 0a20 2020 2020  nsErrors',.     
-00016fc0: 2020 2020 2020 2027 325f 636f 6c6f 725f         '2_color_
-00016fd0: 7363 616c 6527 3a20 2732 5f63 6f6c 6f72  scale': '2_color
-00016fe0: 5f73 6361 6c65 272c 0a20 2020 2020 2020  _scale',.       
-00016ff0: 2020 2020 2027 335f 636f 6c6f 725f 7363       '3_color_sc
-00017000: 616c 6527 3a20 2733 5f63 6f6c 6f72 5f73  ale': '3_color_s
-00017010: 6361 6c65 272c 0a20 2020 2020 2020 2020  cale',.         
-00017020: 2020 2027 6461 7461 5f62 6172 273a 2027     'data_bar': '
-00017030: 6461 7461 4261 7227 2c0a 2020 2020 2020  dataBar',.      
-00017040: 2020 2020 2020 2766 6f72 6d75 6c61 273a        'formula':
-00017050: 2027 6578 7072 6573 7369 6f6e 272c 0a20   'expression',. 
-00017060: 2020 2020 2020 2020 2020 2027 6963 6f6e             'icon
-00017070: 5f73 6574 273a 2027 6963 6f6e 5365 7427  _set': 'iconSet'
-00017080: 7d0a 0a20 2020 2020 2020 2023 2043 6865  }..        # Che
-00017090: 636b 2066 6f72 2076 616c 6964 2074 7970  ck for valid typ
-000170a0: 6573 2e0a 2020 2020 2020 2020 6966 206f  es..        if o
-000170b0: 7074 696f 6e73 5b27 7479 7065 275d 206e  ptions['type'] n
-000170c0: 6f74 2069 6e20 7661 6c69 645f 7479 7065  ot in valid_type
-000170d0: 3a0a 2020 2020 2020 2020 2020 2020 7761  :.            wa
-000170e0: 726e 2822 556e 6b6e 6f77 6e20 7661 6c75  rn("Unknown valu
-000170f0: 6520 2725 7327 2066 6f72 2070 6172 616d  e '%s' for param
-00017100: 6574 6572 2027 7479 7065 2720 220a 2020  eter 'type' ".  
-00017110: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00017120: 696e 2063 6f6e 6469 7469 6f6e 616c 5f66  in conditional_f
-00017130: 6f72 6d61 7428 2922 2025 206f 7074 696f  ormat()" % optio
-00017140: 6e73 5b27 7479 7065 275d 290a 2020 2020  ns['type']).    
-00017150: 2020 2020 2020 2020 7265 7475 726e 202d          return -
-00017160: 320a 2020 2020 2020 2020 656c 7365 3a0a  2.        else:.
-00017170: 2020 2020 2020 2020 2020 2020 6966 206f              if o
-00017180: 7074 696f 6e73 5b27 7479 7065 275d 203d  ptions['type'] =
-00017190: 3d20 2762 6f74 746f 6d27 3a0a 2020 2020  = 'bottom':.    
-000171a0: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
-000171b0: 6f6e 735b 2764 6972 6563 7469 6f6e 275d  ons['direction']
-000171c0: 203d 2027 626f 7474 6f6d 270a 2020 2020   = 'bottom'.    
-000171d0: 2020 2020 2020 2020 6f70 7469 6f6e 735b          options[
-000171e0: 2774 7970 6527 5d20 3d20 7661 6c69 645f  'type'] = valid_
-000171f0: 7479 7065 5b6f 7074 696f 6e73 5b27 7479  type[options['ty
-00017200: 7065 275d 5d0a 0a20 2020 2020 2020 2023  pe']]..        #
-00017210: 2056 616c 6964 2063 7269 7465 7269 6120   Valid criteria 
-00017220: 7479 7065 732e 0a20 2020 2020 2020 2063  types..        c
-00017230: 7269 7465 7269 615f 7479 7065 203d 207b  riteria_type = {
-00017240: 0a20 2020 2020 2020 2020 2020 2027 6265  .            'be
-00017250: 7477 6565 6e27 3a20 2762 6574 7765 656e  tween': 'between
-00017260: 272c 0a20 2020 2020 2020 2020 2020 2027  ',.            '
-00017270: 6e6f 7420 6265 7477 6565 6e27 3a20 276e  not between': 'n
-00017280: 6f74 4265 7477 6565 6e27 2c0a 2020 2020  otBetween',.    
-00017290: 2020 2020 2020 2020 2765 7175 616c 2074          'equal t
-000172a0: 6f27 3a20 2765 7175 616c 272c 0a20 2020  o': 'equal',.   
-000172b0: 2020 2020 2020 2020 2027 3d27 3a20 2765           '=': 'e
-000172c0: 7175 616c 272c 0a20 2020 2020 2020 2020  qual',.         
-000172d0: 2020 2027 3d3d 273a 2027 6571 7561 6c27     '==': 'equal'
-000172e0: 2c0a 2020 2020 2020 2020 2020 2020 276e  ,.            'n
-000172f0: 6f74 2065 7175 616c 2074 6f27 3a20 276e  ot equal to': 'n
-00017300: 6f74 4571 7561 6c27 2c0a 2020 2020 2020  otEqual',.      
-00017310: 2020 2020 2020 2721 3d27 3a20 276e 6f74        '!=': 'not
-00017320: 4571 7561 6c27 2c0a 2020 2020 2020 2020  Equal',.        
-00017330: 2020 2020 273c 3e27 3a20 276e 6f74 4571      '<>': 'notEq
-00017340: 7561 6c27 2c0a 2020 2020 2020 2020 2020  ual',.          
-00017350: 2020 2767 7265 6174 6572 2074 6861 6e27    'greater than'
-00017360: 3a20 2767 7265 6174 6572 5468 616e 272c  : 'greaterThan',
-00017370: 0a20 2020 2020 2020 2020 2020 2027 3e27  .            '>'
-00017380: 3a20 2767 7265 6174 6572 5468 616e 272c  : 'greaterThan',
-00017390: 0a20 2020 2020 2020 2020 2020 2027 6c65  .            'le
-000173a0: 7373 2074 6861 6e27 3a20 276c 6573 7354  ss than': 'lessT
-000173b0: 6861 6e27 2c0a 2020 2020 2020 2020 2020  han',.          
-000173c0: 2020 273c 273a 2027 6c65 7373 5468 616e    '<': 'lessThan
-000173d0: 272c 0a20 2020 2020 2020 2020 2020 2027  ',.            '
-000173e0: 6772 6561 7465 7220 7468 616e 206f 7220  greater than or 
-000173f0: 6571 7561 6c20 746f 273a 2027 6772 6561  equal to': 'grea
-00017400: 7465 7254 6861 6e4f 7245 7175 616c 272c  terThanOrEqual',
-00017410: 0a20 2020 2020 2020 2020 2020 2027 3e3d  .            '>=
-00017420: 273a 2027 6772 6561 7465 7254 6861 6e4f  ': 'greaterThanO
-00017430: 7245 7175 616c 272c 0a20 2020 2020 2020  rEqual',.       
-00017440: 2020 2020 2027 6c65 7373 2074 6861 6e20       'less than 
-00017450: 6f72 2065 7175 616c 2074 6f27 3a20 276c  or equal to': 'l
-00017460: 6573 7354 6861 6e4f 7245 7175 616c 272c  essThanOrEqual',
-00017470: 0a20 2020 2020 2020 2020 2020 2027 3c3d  .            '<=
-00017480: 273a 2027 6c65 7373 5468 616e 4f72 4571  ': 'lessThanOrEq
-00017490: 7561 6c27 2c0a 2020 2020 2020 2020 2020  ual',.          
-000174a0: 2020 2763 6f6e 7461 696e 696e 6727 3a20    'containing': 
-000174b0: 2763 6f6e 7461 696e 7354 6578 7427 2c0a  'containsText',.
-000174c0: 2020 2020 2020 2020 2020 2020 276e 6f74              'not
-000174d0: 2063 6f6e 7461 696e 696e 6727 3a20 276e   containing': 'n
-000174e0: 6f74 436f 6e74 6169 6e73 272c 0a20 2020  otContains',.   
-000174f0: 2020 2020 2020 2020 2027 6265 6769 6e73           'begins
-00017500: 2077 6974 6827 3a20 2762 6567 696e 7357   with': 'beginsW
-00017510: 6974 6827 2c0a 2020 2020 2020 2020 2020  ith',.          
-00017520: 2020 2765 6e64 7320 7769 7468 273a 2027    'ends with': '
-00017530: 656e 6473 5769 7468 272c 0a20 2020 2020  endsWith',.     
-00017540: 2020 2020 2020 2027 7965 7374 6572 6461         'yesterda
-00017550: 7927 3a20 2779 6573 7465 7264 6179 272c  y': 'yesterday',
-00017560: 0a20 2020 2020 2020 2020 2020 2027 746f  .            'to
-00017570: 6461 7927 3a20 2774 6f64 6179 272c 0a20  day': 'today',. 
-00017580: 2020 2020 2020 2020 2020 2027 6c61 7374             'last
-00017590: 2037 2064 6179 7327 3a20 276c 6173 7437   7 days': 'last7
-000175a0: 4461 7973 272c 0a20 2020 2020 2020 2020  Days',.         
-000175b0: 2020 2027 6c61 7374 2077 6565 6b27 3a20     'last week': 
-000175c0: 276c 6173 7457 6565 6b27 2c0a 2020 2020  'lastWeek',.    
-000175d0: 2020 2020 2020 2020 2774 6869 7320 7765          'this we
-000175e0: 656b 273a 2027 7468 6973 5765 656b 272c  ek': 'thisWeek',
-000175f0: 0a20 2020 2020 2020 2020 2020 2027 6e65  .            'ne
-00017600: 7874 2077 6565 6b27 3a20 276e 6578 7457  xt week': 'nextW
-00017610: 6565 6b27 2c0a 2020 2020 2020 2020 2020  eek',.          
-00017620: 2020 276c 6173 7420 6d6f 6e74 6827 3a20    'last month': 
-00017630: 276c 6173 744d 6f6e 7468 272c 0a20 2020  'lastMonth',.   
-00017640: 2020 2020 2020 2020 2027 7468 6973 206d           'this m
-00017650: 6f6e 7468 273a 2027 7468 6973 4d6f 6e74  onth': 'thisMont
-00017660: 6827 2c0a 2020 2020 2020 2020 2020 2020  h',.            
-00017670: 276e 6578 7420 6d6f 6e74 6827 3a20 276e  'next month': 'n
-00017680: 6578 744d 6f6e 7468 272c 0a20 2020 2020  extMonth',.     
-00017690: 2020 2020 2020 2023 2046 6f72 206c 6567         # For leg
-000176a0: 6163 792c 2062 7574 2069 6e63 6f72 7265  acy, but incorre
-000176b0: 6374 2c20 7375 7070 6f72 742e 0a20 2020  ct, support..   
-000176c0: 2020 2020 2020 2020 2027 636f 6e74 696e           'contin
-000176d0: 7565 2077 6565 6b27 3a20 276e 6578 7457  ue week': 'nextW
-000176e0: 6565 6b27 2c0a 2020 2020 2020 2020 2020  eek',.          
-000176f0: 2020 2763 6f6e 7469 6e75 6520 6d6f 6e74    'continue mont
-00017700: 6827 3a20 276e 6578 744d 6f6e 7468 277d  h': 'nextMonth'}
-00017710: 0a0a 2020 2020 2020 2020 2320 4368 6563  ..        # Chec
-00017720: 6b20 666f 7220 7661 6c69 6420 6372 6974  k for valid crit
-00017730: 6572 6961 2074 7970 6573 2e0a 2020 2020  eria types..    
-00017740: 2020 2020 6966 2027 6372 6974 6572 6961      if 'criteria
-00017750: 2720 696e 206f 7074 696f 6e73 2061 6e64  ' in options and
-00017760: 206f 7074 696f 6e73 5b27 6372 6974 6572   options['criter
-00017770: 6961 275d 2069 6e20 6372 6974 6572 6961  ia'] in criteria
-00017780: 5f74 7970 653a 0a20 2020 2020 2020 2020  _type:.         
-00017790: 2020 206f 7074 696f 6e73 5b27 6372 6974     options['crit
-000177a0: 6572 6961 275d 203d 2063 7269 7465 7269  eria'] = criteri
-000177b0: 615f 7479 7065 5b6f 7074 696f 6e73 5b27  a_type[options['
-000177c0: 6372 6974 6572 6961 275d 5d0a 0a20 2020  criteria']]..   
-000177d0: 2020 2020 2023 2043 6f6e 7665 7274 2064       # Convert d
-000177e0: 6174 652f 7469 6d65 7320 7661 6c75 6520  ate/times value 
-000177f0: 6966 2072 6571 7569 7265 642e 0a20 2020  if required..   
-00017800: 2020 2020 2069 6620 6f70 7469 6f6e 735b       if options[
-00017810: 2774 7970 6527 5d20 696e 2028 2764 6174  'type'] in ('dat
-00017820: 6527 2c20 2774 696d 6527 293a 0a20 2020  e', 'time'):.   
-00017830: 2020 2020 2020 2020 206f 7074 696f 6e73           options
-00017840: 5b27 7479 7065 275d 203d 2027 6365 6c6c  ['type'] = 'cell
-00017850: 4973 270a 0a20 2020 2020 2020 2020 2020  Is'..           
-00017860: 2069 6620 2776 616c 7565 2720 696e 206f   if 'value' in o
-00017870: 7074 696f 6e73 3a0a 2020 2020 2020 2020  ptions:.        
-00017880: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-00017890: 7570 706f 7274 6564 5f64 6174 6574 696d  upported_datetim
-000178a0: 6528 6f70 7469 6f6e 735b 2776 616c 7565  e(options['value
-000178b0: 275d 293a 0a20 2020 2020 2020 2020 2020  ']):.           
-000178c0: 2020 2020 2020 2020 2077 6172 6e28 2243           warn("C
-000178d0: 6f6e 6469 7469 6f6e 616c 2066 6f72 6d61  onditional forma
-000178e0: 7420 2776 616c 7565 2720 6d75 7374 2062  t 'value' must b
-000178f0: 6520 6120 220a 2020 2020 2020 2020 2020  e a ".          
-00017900: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00017910: 6461 7465 7469 6d65 206f 626a 6563 742e  datetime object.
-00017920: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-00017930: 2020 2020 2020 2072 6574 7572 6e20 2d32         return -2
-00017940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017950: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00017960: 2020 2020 2020 2020 2020 2064 6174 655f             date_
-00017970: 7469 6d65 203d 2073 656c 662e 5f63 6f6e  time = self._con
-00017980: 7665 7274 5f64 6174 655f 7469 6d65 286f  vert_date_time(o
-00017990: 7074 696f 6e73 5b27 7661 6c75 6527 5d29  ptions['value'])
-000179a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000179b0: 2020 2020 2023 2046 6f72 6d61 7420 6461       # Format da
-000179c0: 7465 206e 756d 6265 7220 746f 2074 6865  te number to the
-000179d0: 2073 616d 6520 7072 6563 6973 696f 6e20   same precision 
-000179e0: 6173 2045 7863 656c 2e0a 2020 2020 2020  as Excel..      
-000179f0: 2020 2020 2020 2020 2020 2020 2020 6f70                op
-00017a00: 7469 6f6e 735b 2776 616c 7565 275d 203d  tions['value'] =
-00017a10: 2022 252e 3136 6722 2025 2064 6174 655f   "%.16g" % date_
-00017a20: 7469 6d65 0a0a 2020 2020 2020 2020 2020  time..          
-00017a30: 2020 6966 2027 6d69 6e69 6d75 6d27 2069    if 'minimum' i
-00017a40: 6e20 6f70 7469 6f6e 733a 0a20 2020 2020  n options:.     
-00017a50: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-00017a60: 7420 7375 7070 6f72 7465 645f 6461 7465  t supported_date
-00017a70: 7469 6d65 286f 7074 696f 6e73 5b27 6d69  time(options['mi
-00017a80: 6e69 6d75 6d27 5d29 3a0a 2020 2020 2020  nimum']):.      
-00017a90: 2020 2020 2020 2020 2020 2020 2020 7761                wa
-00017aa0: 726e 2822 436f 6e64 6974 696f 6e61 6c20  rn("Conditional 
-00017ab0: 666f 726d 6174 2027 6d69 6e69 6d75 6d27  format 'minimum'
-00017ac0: 206d 7573 7420 6265 2061 2022 0a20 2020   must be a ".   
-00017ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017ae0: 2020 2020 2020 2264 6174 6574 696d 6520        "datetime 
-00017af0: 6f62 6a65 6374 2e22 290a 2020 2020 2020  object.").      
-00017b00: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00017b10: 7475 726e 202d 320a 2020 2020 2020 2020  turn -2.        
-00017b20: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00017b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017b40: 2020 6461 7465 5f74 696d 6520 3d20 7365    date_time = se
-00017b50: 6c66 2e5f 636f 6e76 6572 745f 6461 7465  lf._convert_date
-00017b60: 5f74 696d 6528 6f70 7469 6f6e 735b 276d  _time(options['m
-00017b70: 696e 696d 756d 275d 290a 2020 2020 2020  inimum']).      
-00017b80: 2020 2020 2020 2020 2020 2020 2020 6f70                op
-00017b90: 7469 6f6e 735b 276d 696e 696d 756d 275d  tions['minimum']
-00017ba0: 203d 2022 252e 3136 6722 2025 2064 6174   = "%.16g" % dat
-00017bb0: 655f 7469 6d65 0a0a 2020 2020 2020 2020  e_time..        
-00017bc0: 2020 2020 6966 2027 6d61 7869 6d75 6d27      if 'maximum'
-00017bd0: 2069 6e20 6f70 7469 6f6e 733a 0a20 2020   in options:.   
-00017be0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00017bf0: 6e6f 7420 7375 7070 6f72 7465 645f 6461  not supported_da
-00017c00: 7465 7469 6d65 286f 7074 696f 6e73 5b27  tetime(options['
-00017c10: 6d61 7869 6d75 6d27 5d29 3a0a 2020 2020  maximum']):.    
-00017c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017c30: 7761 726e 2822 436f 6e64 6974 696f 6e61  warn("Conditiona
-00017c40: 6c20 666f 726d 6174 2027 6d61 7869 6d75  l format 'maximu
-00017c50: 6d27 206d 7573 7420 6265 2061 2022 0a20  m' must be a ". 
-00017c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017c70: 2020 2020 2020 2020 2264 6174 6574 696d          "datetim
-00017c80: 6520 6f62 6a65 6374 2e22 290a 2020 2020  e object.").    
-00017c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017ca0: 7265 7475 726e 202d 320a 2020 2020 2020  return -2.      
-00017cb0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00017cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017cd0: 2020 2020 6461 7465 5f74 696d 6520 3d20      date_time = 
-00017ce0: 7365 6c66 2e5f 636f 6e76 6572 745f 6461  self._convert_da
-00017cf0: 7465 5f74 696d 6528 6f70 7469 6f6e 735b  te_time(options[
-00017d00: 276d 6178 696d 756d 275d 290a 2020 2020  'maximum']).    
-00017d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017d20: 6f70 7469 6f6e 735b 276d 6178 696d 756d  options['maximum
-00017d30: 275d 203d 2022 252e 3136 6722 2025 2064  '] = "%.16g" % d
-00017d40: 6174 655f 7469 6d65 0a0a 2020 2020 2020  ate_time..      
-00017d50: 2020 2320 5661 6c69 6420 6963 6f6e 2073    # Valid icon s
-00017d60: 7479 6c65 732e 0a20 2020 2020 2020 2076  tyles..        v
-00017d70: 616c 6964 5f69 636f 6e73 203d 207b 0a20  alid_icons = {. 
-00017d80: 2020 2020 2020 2020 2020 2022 335f 6172             "3_ar
-00017d90: 726f 7773 223a 2022 3341 7272 6f77 7322  rows": "3Arrows"
-00017da0: 2c20 2020 2020 2020 2020 2020 2020 2020  ,               
-00017db0: 2020 2020 2020 2020 2020 2023 2031 0a20             # 1. 
-00017dc0: 2020 2020 2020 2020 2020 2022 335f 666c             "3_fl
-00017dd0: 6167 7322 3a20 2233 466c 6167 7322 2c20  ags": "3Flags", 
-00017de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017df0: 2020 2020 2020 2020 2020 2023 2032 0a20             # 2. 
-00017e00: 2020 2020 2020 2020 2020 2022 335f 7472             "3_tr
-00017e10: 6166 6669 635f 6c69 6768 7473 5f72 696d  affic_lights_rim
-00017e20: 6d65 6422 3a20 2233 5472 6166 6669 634c  med": "3TrafficL
-00017e30: 6967 6874 7332 222c 2020 2023 2033 0a20  ights2",   # 3. 
-00017e40: 2020 2020 2020 2020 2020 2022 335f 7379             "3_sy
-00017e50: 6d62 6f6c 735f 6369 7263 6c65 6422 3a20  mbols_circled": 
-00017e60: 2233 5379 6d62 6f6c 7322 2c20 2020 2020  "3Symbols",     
-00017e70: 2020 2020 2020 2020 2020 2023 2034 0a20             # 4. 
-00017e80: 2020 2020 2020 2020 2020 2022 345f 6172             "4_ar
-00017e90: 726f 7773 223a 2022 3441 7272 6f77 7322  rows": "4Arrows"
-00017ea0: 2c20 2020 2020 2020 2020 2020 2020 2020  ,               
-00017eb0: 2020 2020 2020 2020 2020 2023 2035 0a20             # 5. 
-00017ec0: 2020 2020 2020 2020 2020 2022 345f 7265             "4_re
-00017ed0: 645f 746f 5f62 6c61 636b 223a 2022 3452  d_to_black": "4R
-00017ee0: 6564 546f 426c 6163 6b22 2c20 2020 2020  edToBlack",     
-00017ef0: 2020 2020 2020 2020 2020 2023 2036 0a20             # 6. 
-00017f00: 2020 2020 2020 2020 2020 2022 345f 7472             "4_tr
-00017f10: 6166 6669 635f 6c69 6768 7473 223a 2022  affic_lights": "
-00017f20: 3454 7261 6666 6963 4c69 6768 7473 222c  4TrafficLights",
-00017f30: 2020 2020 2020 2020 2020 2023 2037 0a20             # 7. 
-00017f40: 2020 2020 2020 2020 2020 2022 355f 6172             "5_ar
-00017f50: 726f 7773 5f67 7261 7922 3a20 2235 4172  rows_gray": "5Ar
-00017f60: 726f 7773 4772 6179 222c 2020 2020 2020  rowsGray",      
-00017f70: 2020 2020 2020 2020 2020 2023 2038 0a20             # 8. 
-00017f80: 2020 2020 2020 2020 2020 2022 355f 7175             "5_qu
-00017f90: 6172 7465 7273 223a 2022 3551 7561 7274  arters": "5Quart
-00017fa0: 6572 7322 2c20 2020 2020 2020 2020 2020  ers",           
-00017fb0: 2020 2020 2020 2020 2020 2023 2039 0a20             # 9. 
-00017fc0: 2020 2020 2020 2020 2020 2022 335f 6172             "3_ar
-00017fd0: 726f 7773 5f67 7261 7922 3a20 2233 4172  rows_gray": "3Ar
-00017fe0: 726f 7773 4772 6179 222c 2020 2020 2020  rowsGray",      
-00017ff0: 2020 2020 2020 2020 2020 2023 2031 300a             # 10.
-00018000: 2020 2020 2020 2020 2020 2020 2233 5f74              "3_t
-00018010: 7261 6666 6963 5f6c 6967 6874 7322 3a20  raffic_lights": 
-00018020: 2233 5472 6166 6669 634c 6967 6874 7322  "3TrafficLights"
-00018030: 2c20 2020 2020 2020 2020 2020 2320 3131  ,           # 11
-00018040: 0a20 2020 2020 2020 2020 2020 2022 335f  .            "3_
-00018050: 7369 676e 7322 3a20 2233 5369 676e 7322  signs": "3Signs"
-00018060: 2c20 2020 2020 2020 2020 2020 2020 2020  ,               
-00018070: 2020 2020 2020 2020 2020 2020 2023 2031               # 1
-00018080: 320a 2020 2020 2020 2020 2020 2020 2233  2.            "3
-00018090: 5f73 796d 626f 6c73 223a 2022 3353 796d  _symbols": "3Sym
-000180a0: 626f 6c73 3222 2c20 2020 2020 2020 2020  bols2",         
-000180b0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-000180c0: 3133 0a20 2020 2020 2020 2020 2020 2022  13.            "
-000180d0: 345f 6172 726f 7773 5f67 7261 7922 3a20  4_arrows_gray": 
-000180e0: 2234 4172 726f 7773 4772 6179 222c 2020  "4ArrowsGray",  
-000180f0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00018100: 2031 340a 2020 2020 2020 2020 2020 2020   14.            
-00018110: 2234 5f72 6174 696e 6773 223a 2022 3452  "4_ratings": "4R
-00018120: 6174 696e 6722 2c20 2020 2020 2020 2020  ating",         
-00018130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018140: 2320 3135 0a20 2020 2020 2020 2020 2020  # 15.           
-00018150: 2022 355f 6172 726f 7773 223a 2022 3541   "5_arrows": "5A
-00018160: 7272 6f77 7322 2c20 2020 2020 2020 2020  rrows",         
-00018170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018180: 2023 2031 360a 2020 2020 2020 2020 2020   # 16.          
-00018190: 2020 2235 5f72 6174 696e 6773 223a 2022    "5_ratings": "
-000181a0: 3552 6174 696e 6722 7d20 2020 2020 2020  5Rating"}       
-000181b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000181c0: 2020 2320 3137 0a0a 2020 2020 2020 2020    # 17..        
-000181d0: 2320 5365 7420 7468 6520 6963 6f6e 2073  # Set the icon s
-000181e0: 6574 2070 726f 7065 7274 6965 732e 0a20  et properties.. 
-000181f0: 2020 2020 2020 2069 6620 6f70 7469 6f6e         if option
-00018200: 735b 2774 7970 6527 5d20 3d3d 2027 6963  s['type'] == 'ic
-00018210: 6f6e 5365 7427 3a0a 0a20 2020 2020 2020  onSet':..       
-00018220: 2020 2020 2023 2041 6e20 6963 6f6e 5f73       # An icon_s
-00018230: 6574 206d 7573 7420 6861 7665 2061 6e20  et must have an 
-00018240: 6963 6f6e 2073 7479 6c65 2e0a 2020 2020  icon style..    
-00018250: 2020 2020 2020 2020 6966 206e 6f74 206f          if not o
-00018260: 7074 696f 6e73 2e67 6574 2827 6963 6f6e  ptions.get('icon
-00018270: 5f73 7479 6c65 2729 3a0a 2020 2020 2020  _style'):.      
-00018280: 2020 2020 2020 2020 2020 7761 726e 2822            warn("
-00018290: 5468 6520 2769 636f 6e5f 7374 796c 6527  The 'icon_style'
-000182a0: 2070 6172 616d 6574 6572 206d 7573 7420   parameter must 
-000182b0: 6265 2073 7065 6369 6669 6564 2077 6865  be specified whe
-000182c0: 6e20 220a 2020 2020 2020 2020 2020 2020  n ".            
-000182d0: 2020 2020 2020 2020 2022 2774 7970 6527           "'type'
-000182e0: 203d 3d20 2769 636f 6e5f 7365 7427 2069   == 'icon_set' i
-000182f0: 6e20 636f 6e64 6974 696f 6e61 6c5f 666f  n conditional_fo
-00018300: 726d 6174 2829 2229 0a20 2020 2020 2020  rmat()").       
-00018310: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00018320: 2d33 0a0a 2020 2020 2020 2020 2020 2020  -3..            
-00018330: 2320 4368 6563 6b20 666f 7220 7661 6c69  # Check for vali
-00018340: 6420 6963 6f6e 2073 7479 6c65 732e 0a20  d icon styles.. 
-00018350: 2020 2020 2020 2020 2020 2069 6620 6f70             if op
-00018360: 7469 6f6e 735b 2769 636f 6e5f 7374 796c  tions['icon_styl
-00018370: 6527 5d20 6e6f 7420 696e 2076 616c 6964  e'] not in valid
-00018380: 5f69 636f 6e73 3a0a 2020 2020 2020 2020  _icons:.        
-00018390: 2020 2020 2020 2020 7761 726e 2822 556e          warn("Un
-000183a0: 6b6e 6f77 6e20 6963 6f6e 5f73 7479 6c65  known icon_style
-000183b0: 2027 2573 2720 696e 2063 6f6e 6469 7469   '%s' in conditi
-000183c0: 6f6e 616c 5f66 6f72 6d61 7428 2922 2025  onal_format()" %
-000183d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000183e0: 2020 2020 2020 6f70 7469 6f6e 735b 2769        options['i
-000183f0: 636f 6e5f 7374 796c 6527 5d29 0a20 2020  con_style']).   
-00018400: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00018410: 7572 6e20 2d32 0a20 2020 2020 2020 2020  urn -2.         
-00018420: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00018430: 2020 2020 2020 2020 206f 7074 696f 6e73           options
-00018440: 5b27 6963 6f6e 5f73 7479 6c65 275d 203d  ['icon_style'] =
-00018450: 2076 616c 6964 5f69 636f 6e73 5b6f 7074   valid_icons[opt
-00018460: 696f 6e73 5b27 6963 6f6e 5f73 7479 6c65  ions['icon_style
-00018470: 275d 5d0a 0a20 2020 2020 2020 2020 2020  ']]..           
-00018480: 2023 2053 6574 2074 6865 206e 756d 6265   # Set the numbe
-00018490: 7220 6f66 2069 636f 6e73 2066 6f72 2074  r of icons for t
-000184a0: 6865 2069 636f 6e20 7374 796c 652e 0a20  he icon style.. 
-000184b0: 2020 2020 2020 2020 2020 206f 7074 696f             optio
-000184c0: 6e73 5b27 746f 7461 6c5f 6963 6f6e 7327  ns['total_icons'
-000184d0: 5d20 3d20 330a 2020 2020 2020 2020 2020  ] = 3.          
-000184e0: 2020 6966 206f 7074 696f 6e73 5b27 6963    if options['ic
-000184f0: 6f6e 5f73 7479 6c65 275d 2e73 7461 7274  on_style'].start
-00018500: 7377 6974 6828 2734 2729 3a0a 2020 2020  swith('4'):.    
-00018510: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
-00018520: 6f6e 735b 2774 6f74 616c 5f69 636f 6e73  ons['total_icons
-00018530: 275d 203d 2034 0a20 2020 2020 2020 2020  '] = 4.         
-00018540: 2020 2065 6c69 6620 6f70 7469 6f6e 735b     elif options[
-00018550: 2769 636f 6e5f 7374 796c 6527 5d2e 7374  'icon_style'].st
-00018560: 6172 7473 7769 7468 2827 3527 293a 0a20  artswith('5'):. 
-00018570: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00018580: 7074 696f 6e73 5b27 746f 7461 6c5f 6963  ptions['total_ic
-00018590: 6f6e 7327 5d20 3d20 350a 0a20 2020 2020  ons'] = 5..     
-000185a0: 2020 2020 2020 206f 7074 696f 6e73 5b27         options['
-000185b0: 6963 6f6e 7327 5d20 3d20 7365 6c66 2e5f  icons'] = self._
-000185c0: 7365 745f 6963 6f6e 5f70 726f 7073 286f  set_icon_props(o
-000185d0: 7074 696f 6e73 2e67 6574 2827 746f 7461  ptions.get('tota
-000185e0: 6c5f 6963 6f6e 7327 292c 0a20 2020 2020  l_icons'),.     
-000185f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018610: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00018620: 7074 696f 6e73 2e67 6574 2827 6963 6f6e  ptions.get('icon
-00018630: 7327 2929 0a0a 2020 2020 2020 2020 2320  s'))..        # 
-00018640: 5377 6170 206c 6173 7420 726f 772f 636f  Swap last row/co
-00018650: 6c20 666f 7220 6669 7273 7420 726f 772f  l for first row/
-00018660: 636f 6c20 6173 206e 6563 6573 7361 7279  col as necessary
-00018670: 0a20 2020 2020 2020 2069 6620 6669 7273  .        if firs
-00018680: 745f 726f 7720 3e20 6c61 7374 5f72 6f77  t_row > last_row
-00018690: 3a0a 2020 2020 2020 2020 2020 2020 6669  :.            fi
-000186a0: 7273 745f 726f 772c 206c 6173 745f 726f  rst_row, last_ro
-000186b0: 7720 3d20 6c61 7374 5f72 6f77 2c20 6669  w = last_row, fi
-000186c0: 7273 745f 726f 770a 0a20 2020 2020 2020  rst_row..       
-000186d0: 2069 6620 6669 7273 745f 636f 6c20 3e20   if first_col > 
-000186e0: 6c61 7374 5f63 6f6c 3a0a 2020 2020 2020  last_col:.      
-000186f0: 2020 2020 2020 6669 7273 745f 636f 6c2c        first_col,
-00018700: 206c 6173 745f 636f 6c20 3d20 6c61 7374   last_col = last
-00018710: 5f63 6f6c 2c20 6669 7273 745f 636f 6c0a  _col, first_col.
-00018720: 0a20 2020 2020 2020 2023 2053 6574 2074  .        # Set t
-00018730: 6865 2066 6f72 6d61 7474 696e 6720 7261  he formatting ra
-00018740: 6e67 652e 0a20 2020 2020 2020 2063 656c  nge..        cel
-00018750: 6c5f 7261 6e67 6520 3d20 786c 5f72 616e  l_range = xl_ran
-00018760: 6765 2866 6972 7374 5f72 6f77 2c20 6669  ge(first_row, fi
-00018770: 7273 745f 636f 6c2c 206c 6173 745f 726f  rst_col, last_ro
-00018780: 772c 206c 6173 745f 636f 6c29 0a20 2020  w, last_col).   
-00018790: 2020 2020 2073 7461 7274 5f63 656c 6c20       start_cell 
-000187a0: 3d20 786c 5f72 6f77 636f 6c5f 746f 5f63  = xl_rowcol_to_c
-000187b0: 656c 6c28 6669 7273 745f 726f 772c 2066  ell(first_row, f
-000187c0: 6972 7374 5f63 6f6c 290a 0a20 2020 2020  irst_col)..     
-000187d0: 2020 2023 204f 7665 7272 6964 6520 7769     # Override wi
-000187e0: 7468 2075 7365 7220 6465 6669 6e65 6420  th user defined 
-000187f0: 6d75 6c74 6970 6c65 2072 616e 6765 2069  multiple range i
-00018800: 6620 7072 6f76 6964 6564 2e0a 2020 2020  f provided..    
-00018810: 2020 2020 6966 2027 6d75 6c74 695f 7261      if 'multi_ra
-00018820: 6e67 6527 2069 6e20 6f70 7469 6f6e 733a  nge' in options:
-00018830: 0a20 2020 2020 2020 2020 2020 2063 656c  .            cel
-00018840: 6c5f 7261 6e67 6520 3d20 6f70 7469 6f6e  l_range = option
-00018850: 735b 276d 756c 7469 5f72 616e 6765 275d  s['multi_range']
-00018860: 0a20 2020 2020 2020 2020 2020 2063 656c  .            cel
-00018870: 6c5f 7261 6e67 6520 3d20 6365 6c6c 5f72  l_range = cell_r
-00018880: 616e 6765 2e72 6570 6c61 6365 2827 2427  ange.replace('$'
-00018890: 2c20 2727 290a 0a20 2020 2020 2020 2023  , '')..        #
-000188a0: 2047 6574 2074 6865 2064 7866 2066 6f72   Get the dxf for
-000188b0: 6d61 7420 696e 6465 782e 0a20 2020 2020  mat index..     
-000188c0: 2020 2069 6620 2766 6f72 6d61 7427 2069     if 'format' i
-000188d0: 6e20 6f70 7469 6f6e 7320 616e 6420 6f70  n options and op
-000188e0: 7469 6f6e 735b 2766 6f72 6d61 7427 5d3a  tions['format']:
-000188f0: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
-00018900: 696f 6e73 5b27 666f 726d 6174 275d 203d  ions['format'] =
-00018910: 206f 7074 696f 6e73 5b27 666f 726d 6174   options['format
-00018920: 275d 2e5f 6765 745f 6478 665f 696e 6465  ']._get_dxf_inde
-00018930: 7828 290a 0a20 2020 2020 2020 2023 2053  x()..        # S
-00018940: 6574 2074 6865 2070 7269 6f72 6974 7920  et the priority 
-00018950: 6261 7365 6420 6f6e 2074 6865 206f 7264  based on the ord
-00018960: 6572 206f 6620 6164 6469 6e67 2e0a 2020  er of adding..  
-00018970: 2020 2020 2020 6f70 7469 6f6e 735b 2770        options['p
-00018980: 7269 6f72 6974 7927 5d20 3d20 7365 6c66  riority'] = self
-00018990: 2e64 7866 5f70 7269 6f72 6974 790a 2020  .dxf_priority.  
-000189a0: 2020 2020 2020 7365 6c66 2e64 7866 5f70        self.dxf_p
-000189b0: 7269 6f72 6974 7920 2b3d 2031 0a0a 2020  riority += 1..  
-000189c0: 2020 2020 2020 2320 4368 6563 6b20 666f        # Check fo
-000189d0: 7220 3230 3130 2073 7479 6c65 2064 6174  r 2010 style dat
-000189e0: 615f 6261 7220 7061 7261 6d65 7465 7273  a_bar parameters
-000189f0: 2e0a 2020 2020 2020 2020 6966 2028 7365  ..        if (se
-00018a00: 6c66 2e75 7365 5f64 6174 615f 6261 7273  lf.use_data_bars
-00018a10: 5f32 3031 3020 6f72 0a20 2020 2020 2020  _2010 or.       
-00018a20: 2020 2020 2020 2020 206f 7074 696f 6e73           options
-00018a30: 2e67 6574 2827 6461 7461 5f62 6172 5f32  .get('data_bar_2
-00018a40: 3031 3027 2920 6f72 0a20 2020 2020 2020  010') or.       
-00018a50: 2020 2020 2020 2020 206f 7074 696f 6e73           options
-00018a60: 2e67 6574 2827 6261 725f 736f 6c69 6427  .get('bar_solid'
-00018a70: 2920 6f72 0a20 2020 2020 2020 2020 2020  ) or.           
-00018a80: 2020 2020 206f 7074 696f 6e73 2e67 6574       options.get
-00018a90: 2827 6261 725f 626f 7264 6572 5f63 6f6c  ('bar_border_col
-00018aa0: 6f72 2729 206f 720a 2020 2020 2020 2020  or') or.        
-00018ab0: 2020 2020 2020 2020 6f70 7469 6f6e 732e          options.
-00018ac0: 6765 7428 2762 6172 5f6e 6567 6174 6976  get('bar_negativ
-00018ad0: 655f 636f 6c6f 7227 2920 6f72 0a20 2020  e_color') or.   
-00018ae0: 2020 2020 2020 2020 2020 2020 206f 7074               opt
-00018af0: 696f 6e73 2e67 6574 2827 6261 725f 6e65  ions.get('bar_ne
-00018b00: 6761 7469 7665 5f63 6f6c 6f72 5f73 616d  gative_color_sam
-00018b10: 6527 2920 6f72 0a20 2020 2020 2020 2020  e') or.         
-00018b20: 2020 2020 2020 206f 7074 696f 6e73 2e67         options.g
-00018b30: 6574 2827 6261 725f 6e65 6761 7469 7665  et('bar_negative
-00018b40: 5f62 6f72 6465 725f 636f 6c6f 7227 2920  _border_color') 
-00018b50: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
-00018b60: 2020 206f 7074 696f 6e73 2e67 6574 2827     options.get('
-00018b70: 6261 725f 6e65 6761 7469 7665 5f62 6f72  bar_negative_bor
-00018b80: 6465 725f 636f 6c6f 725f 7361 6d65 2729  der_color_same')
-00018b90: 206f 720a 2020 2020 2020 2020 2020 2020   or.            
-00018ba0: 2020 2020 6f70 7469 6f6e 732e 6765 7428      options.get(
-00018bb0: 2762 6172 5f6e 6f5f 626f 7264 6572 2729  'bar_no_border')
-00018bc0: 206f 720a 2020 2020 2020 2020 2020 2020   or.            
-00018bd0: 2020 2020 6f70 7469 6f6e 732e 6765 7428      options.get(
-00018be0: 2762 6172 5f61 7869 735f 706f 7369 7469  'bar_axis_positi
-00018bf0: 6f6e 2729 206f 720a 2020 2020 2020 2020  on') or.        
-00018c00: 2020 2020 2020 2020 6f70 7469 6f6e 732e          options.
-00018c10: 6765 7428 2762 6172 5f61 7869 735f 636f  get('bar_axis_co
-00018c20: 6c6f 7227 2920 6f72 0a20 2020 2020 2020  lor') or.       
-00018c30: 2020 2020 2020 2020 206f 7074 696f 6e73           options
-00018c40: 2e67 6574 2827 6261 725f 6469 7265 6374  .get('bar_direct
-00018c50: 696f 6e27 2929 3a0a 2020 2020 2020 2020  ion')):.        
-00018c60: 2020 2020 6f70 7469 6f6e 735b 2769 735f      options['is_
-00018c70: 6461 7461 5f62 6172 5f32 3031 3027 5d20  data_bar_2010'] 
-00018c80: 3d20 5472 7565 0a0a 2020 2020 2020 2020  = True..        
-00018c90: 2320 5370 6563 6961 6c20 6861 6e64 6c69  # Special handli
-00018ca0: 6e67 206f 6620 7465 7874 2063 7269 7465  ng of text crite
-00018cb0: 7269 612e 0a20 2020 2020 2020 2069 6620  ria..        if 
-00018cc0: 6f70 7469 6f6e 735b 2774 7970 6527 5d20  options['type'] 
-00018cd0: 3d3d 2027 7465 7874 273a 0a0a 2020 2020  == 'text':..    
-00018ce0: 2020 2020 2020 2020 6966 206f 7074 696f          if optio
-00018cf0: 6e73 5b27 6372 6974 6572 6961 275d 203d  ns['criteria'] =
-00018d00: 3d20 2763 6f6e 7461 696e 7354 6578 7427  = 'containsText'
-00018d10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00018d20: 2020 6f70 7469 6f6e 735b 2774 7970 6527    options['type'
-00018d30: 5d20 3d20 2763 6f6e 7461 696e 7354 6578  ] = 'containsTex
-00018d40: 7427 0a20 2020 2020 2020 2020 2020 2020  t'.             
-00018d50: 2020 206f 7074 696f 6e73 5b27 666f 726d     options['form
-00018d60: 756c 6127 5d20 3d20 2827 4e4f 5428 4953  ula'] = ('NOT(IS
-00018d70: 4552 524f 5228 5345 4152 4348 2822 2573  ERROR(SEARCH("%s
-00018d80: 222c 2573 2929 2927 0a20 2020 2020 2020  ",%s)))'.       
-00018d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018da0: 2020 2020 2020 2020 2020 2020 2020 2025                 %
-00018db0: 2028 6f70 7469 6f6e 735b 2776 616c 7565   (options['value
-00018dc0: 275d 2c20 7374 6172 745f 6365 6c6c 2929  '], start_cell))
-00018dd0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-00018de0: 6620 6f70 7469 6f6e 735b 2763 7269 7465  f options['crite
-00018df0: 7269 6127 5d20 3d3d 2027 6e6f 7443 6f6e  ria'] == 'notCon
-00018e00: 7461 696e 7327 3a0a 2020 2020 2020 2020  tains':.        
-00018e10: 2020 2020 2020 2020 6f70 7469 6f6e 735b          options[
-00018e20: 2774 7970 6527 5d20 3d20 276e 6f74 436f  'type'] = 'notCo
-00018e30: 6e74 6169 6e73 5465 7874 270a 2020 2020  ntainsText'.    
-00018e40: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
-00018e50: 6f6e 735b 2766 6f72 6d75 6c61 275d 203d  ons['formula'] =
-00018e60: 2028 2749 5345 5252 4f52 2853 4541 5243   ('ISERROR(SEARC
-00018e70: 4828 2225 7322 2c25 7329 2927 0a20 2020  H("%s",%s))'.   
-00018e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018ea0: 2020 2025 2028 6f70 7469 6f6e 735b 2776     % (options['v
-00018eb0: 616c 7565 275d 2c20 7374 6172 745f 6365  alue'], start_ce
-00018ec0: 6c6c 2929 0a20 2020 2020 2020 2020 2020  ll)).           
-00018ed0: 2065 6c69 6620 6f70 7469 6f6e 735b 2763   elif options['c
-00018ee0: 7269 7465 7269 6127 5d20 3d3d 2027 6265  riteria'] == 'be
-00018ef0: 6769 6e73 5769 7468 273a 0a20 2020 2020  ginsWith':.     
-00018f00: 2020 2020 2020 2020 2020 206f 7074 696f             optio
-00018f10: 6e73 5b27 7479 7065 275d 203d 2027 6265  ns['type'] = 'be
-00018f20: 6769 6e73 5769 7468 270a 2020 2020 2020  ginsWith'.      
-00018f30: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
-00018f40: 735b 2766 6f72 6d75 6c61 275d 203d 2028  s['formula'] = (
-00018f50: 274c 4546 5428 2573 2c25 6429 3d22 2573  'LEFT(%s,%d)="%s
-00018f60: 2227 0a20 2020 2020 2020 2020 2020 2020  "'.             
-00018f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018f80: 2020 2020 2020 2020 2025 2028 7374 6172           % (star
-00018f90: 745f 6365 6c6c 2c0a 2020 2020 2020 2020  t_cell,.        
-00018fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018fc0: 206c 656e 286f 7074 696f 6e73 5b27 7661   len(options['va
-00018fd0: 6c75 6527 5d29 2c0a 2020 2020 2020 2020  lue']),.        
-00018fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019000: 206f 7074 696f 6e73 5b27 7661 6c75 6527   options['value'
-00019010: 5d29 290a 2020 2020 2020 2020 2020 2020  ])).            
-00019020: 656c 6966 206f 7074 696f 6e73 5b27 6372  elif options['cr
-00019030: 6974 6572 6961 275d 203d 3d20 2765 6e64  iteria'] == 'end
-00019040: 7357 6974 6827 3a0a 2020 2020 2020 2020  sWith':.        
-00019050: 2020 2020 2020 2020 6f70 7469 6f6e 735b          options[
-00019060: 2774 7970 6527 5d20 3d20 2765 6e64 7357  'type'] = 'endsW
-00019070: 6974 6827 0a20 2020 2020 2020 2020 2020  ith'.           
-00019080: 2020 2020 206f 7074 696f 6e73 5b27 666f       options['fo
-00019090: 726d 756c 6127 5d20 3d20 2827 5249 4748  rmula'] = ('RIGH
-000190a0: 5428 2573 2c25 6429 3d22 2573 2227 0a20  T(%s,%d)="%s"'. 
-000190b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000190c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000190d0: 2020 2020 2025 2028 7374 6172 745f 6365       % (start_ce
-000190e0: 6c6c 2c0a 2020 2020 2020 2020 2020 2020  ll,.            
-000190f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019100: 2020 2020 2020 2020 2020 2020 206c 656e               len
-00019110: 286f 7074 696f 6e73 5b27 7661 6c75 6527  (options['value'
-00019120: 5d29 2c0a 2020 2020 2020 2020 2020 2020  ]),.            
-00019130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019140: 2020 2020 2020 2020 2020 2020 206f 7074               opt
-00019150: 696f 6e73 5b27 7661 6c75 6527 5d29 290a  ions['value'])).
-00019160: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00019170: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00019180: 2020 7761 726e 2822 496e 7661 6c69 6420    warn("Invalid 
-00019190: 7465 7874 2063 7269 7465 7269 6120 2725  text criteria '%
-000191a0: 7327 2022 0a20 2020 2020 2020 2020 2020  s' ".           
-000191b0: 2020 2020 2020 2020 2020 2269 6e20 636f            "in co
-000191c0: 6e64 6974 696f 6e61 6c5f 666f 726d 6174  nditional_format
-000191d0: 2829 2220 2520 6f70 7469 6f6e 735b 2763  ()" % options['c
-000191e0: 7269 7465 7269 6127 5d29 0a0a 2020 2020  riteria'])..    
-000191f0: 2020 2020 2320 5370 6563 6961 6c20 6861      # Special ha
-00019200: 6e64 6c69 6e67 206f 6620 7469 6d65 2074  ndling of time t
-00019210: 696d 655f 7065 7269 6f64 2063 7269 7465  ime_period crite
-00019220: 7269 612e 0a20 2020 2020 2020 2069 6620  ria..        if 
-00019230: 6f70 7469 6f6e 735b 2774 7970 6527 5d20  options['type'] 
-00019240: 3d3d 2027 7469 6d65 5065 7269 6f64 273a  == 'timePeriod':
-00019250: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00019260: 206f 7074 696f 6e73 5b27 6372 6974 6572   options['criter
-00019270: 6961 275d 203d 3d20 2779 6573 7465 7264  ia'] == 'yesterd
-00019280: 6179 273a 0a20 2020 2020 2020 2020 2020  ay':.           
-00019290: 2020 2020 206f 7074 696f 6e73 5b27 666f       options['fo
-000192a0: 726d 756c 6127 5d20 3d20 2746 4c4f 4f52  rmula'] = 'FLOOR
-000192b0: 2825 732c 3129 3d54 4f44 4159 2829 2d31  (%s,1)=TODAY()-1
-000192c0: 2720 2520 7374 6172 745f 6365 6c6c 0a0a  ' % start_cell..
-000192d0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-000192e0: 206f 7074 696f 6e73 5b27 6372 6974 6572   options['criter
-000192f0: 6961 275d 203d 3d20 2774 6f64 6179 273a  ia'] == 'today':
-00019300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019310: 206f 7074 696f 6e73 5b27 666f 726d 756c   options['formul
-00019320: 6127 5d20 3d20 2746 4c4f 4f52 2825 732c  a'] = 'FLOOR(%s,
-00019330: 3129 3d54 4f44 4159 2829 2720 2520 7374  1)=TODAY()' % st
-00019340: 6172 745f 6365 6c6c 0a0a 2020 2020 2020  art_cell..      
-00019350: 2020 2020 2020 656c 6966 206f 7074 696f        elif optio
-00019360: 6e73 5b27 6372 6974 6572 6961 275d 203d  ns['criteria'] =
-00019370: 3d20 2774 6f6d 6f72 726f 7727 3a0a 2020  = 'tomorrow':.  
-00019380: 2020 2020 2020 2020 2020 2020 2020 6f70                op
-00019390: 7469 6f6e 735b 2766 6f72 6d75 6c61 275d  tions['formula']
-000193a0: 203d 2027 464c 4f4f 5228 2573 2c31 293d   = 'FLOOR(%s,1)=
-000193b0: 544f 4441 5928 292b 3127 2025 2073 7461  TODAY()+1' % sta
-000193c0: 7274 5f63 656c 6c0a 0a20 2020 2020 2020  rt_cell..       
-000193d0: 2020 2020 2065 6c69 6620 6f70 7469 6f6e       elif option
-000193e0: 735b 2763 7269 7465 7269 6127 5d20 3d3d  s['criteria'] ==
-000193f0: 2027 6c61 7374 3744 6179 7327 3a0a 2020   'last7Days':.  
-00019400: 2020 2020 2020 2020 2020 2020 2020 6f70                op
-00019410: 7469 6f6e 735b 2766 6f72 6d75 6c61 275d  tions['formula']
-00019420: 203d 205c 0a20 2020 2020 2020 2020 2020   = \.           
-00019430: 2020 2020 2020 2020 2028 2741 4e44 2854           ('AND(T
-00019440: 4f44 4159 2829 2d46 4c4f 4f52 2825 732c  ODAY()-FLOOR(%s,
-00019450: 3129 3c3d 362c 464c 4f4f 5228 2573 2c31  1)<=6,FLOOR(%s,1
-00019460: 293c 3d54 4f44 4159 2829 2927 2025 0a20  )<=TODAY())' %. 
-00019470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019480: 2020 2020 2873 7461 7274 5f63 656c 6c2c      (start_cell,
-00019490: 2073 7461 7274 5f63 656c 6c29 290a 0a20   start_cell)).. 
-000194a0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-000194b0: 6f70 7469 6f6e 735b 2763 7269 7465 7269  options['criteri
-000194c0: 6127 5d20 3d3d 2027 6c61 7374 5765 656b  a'] == 'lastWeek
-000194d0: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-000194e0: 2020 206f 7074 696f 6e73 5b27 666f 726d     options['form
-000194f0: 756c 6127 5d20 3d20 5c0a 2020 2020 2020  ula'] = \.      
-00019500: 2020 2020 2020 2020 2020 2020 2020 2827                ('
-00019510: 414e 4428 544f 4441 5928 292d 524f 554e  AND(TODAY()-ROUN
-00019520: 4444 4f57 4e28 2573 2c30 293e 3d28 5745  DDOWN(%s,0)>=(WE
-00019530: 454b 4441 5928 544f 4441 5928 2929 292c  EKDAY(TODAY())),
-00019540: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-00019550: 2020 2020 2020 2027 544f 4441 5928 292d         'TODAY()-
-00019560: 524f 554e 4444 4f57 4e28 2573 2c30 293c  ROUNDDOWN(%s,0)<
-00019570: 2857 4545 4b44 4159 2854 4f44 4159 2829  (WEEKDAY(TODAY()
-00019580: 292b 3729 2927 2025 0a20 2020 2020 2020  )+7))' %.       
-00019590: 2020 2020 2020 2020 2020 2020 2020 2873                (s
-000195a0: 7461 7274 5f63 656c 6c2c 2073 7461 7274  tart_cell, start
-000195b0: 5f63 656c 6c29 290a 0a20 2020 2020 2020  _cell))..       
-000195c0: 2020 2020 2065 6c69 6620 6f70 7469 6f6e       elif option
-000195d0: 735b 2763 7269 7465 7269 6127 5d20 3d3d  s['criteria'] ==
-000195e0: 2027 7468 6973 5765 656b 273a 0a20 2020   'thisWeek':.   
-000195f0: 2020 2020 2020 2020 2020 2020 206f 7074               opt
-00019600: 696f 6e73 5b27 666f 726d 756c 6127 5d20  ions['formula'] 
-00019610: 3d20 5c0a 2020 2020 2020 2020 2020 2020  = \.            
-00019620: 2020 2020 2020 2020 2827 414e 4428 544f          ('AND(TO
-00019630: 4441 5928 292d 524f 554e 4444 4f57 4e28  DAY()-ROUNDDOWN(
-00019640: 2573 2c30 293c 3d57 4545 4b44 4159 2854  %s,0)<=WEEKDAY(T
-00019650: 4f44 4159 2829 292d 312c 270a 2020 2020  ODAY())-1,'.    
-00019660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019670: 2027 524f 554e 4444 4f57 4e28 2573 2c30   'ROUNDDOWN(%s,0
-00019680: 292d 544f 4441 5928 293c 3d37 2d57 4545  )-TODAY()<=7-WEE
-00019690: 4b44 4159 2854 4f44 4159 2829 2929 2720  KDAY(TODAY()))' 
-000196a0: 250a 2020 2020 2020 2020 2020 2020 2020  %.              
-000196b0: 2020 2020 2020 2028 7374 6172 745f 6365         (start_ce
-000196c0: 6c6c 2c20 7374 6172 745f 6365 6c6c 2929  ll, start_cell))
-000196d0: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-000196e0: 6966 206f 7074 696f 6e73 5b27 6372 6974  if options['crit
-000196f0: 6572 6961 275d 203d 3d20 276e 6578 7457  eria'] == 'nextW
-00019700: 6565 6b27 3a0a 2020 2020 2020 2020 2020  eek':.          
-00019710: 2020 2020 2020 6f70 7469 6f6e 735b 2766        options['f
-00019720: 6f72 6d75 6c61 275d 203d 205c 0a20 2020  ormula'] = \.   
-00019730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019740: 2028 2741 4e44 2852 4f55 4e44 444f 574e   ('AND(ROUNDDOWN
-00019750: 2825 732c 3029 2d54 4f44 4159 2829 3e28  (%s,0)-TODAY()>(
-00019760: 372d 5745 454b 4441 5928 544f 4441 5928  7-WEEKDAY(TODAY(
-00019770: 2929 292c 270a 2020 2020 2020 2020 2020  ))),'.          
-00019780: 2020 2020 2020 2020 2020 2027 524f 554e             'ROUN
-00019790: 4444 4f57 4e28 2573 2c30 292d 544f 4441  DDOWN(%s,0)-TODA
-000197a0: 5928 293c 2831 352d 5745 454b 4441 5928  Y()<(15-WEEKDAY(
-000197b0: 544f 4441 5928 2929 2929 2720 250a 2020  TODAY())))' %.  
-000197c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000197d0: 2020 2028 7374 6172 745f 6365 6c6c 2c20     (start_cell, 
-000197e0: 7374 6172 745f 6365 6c6c 2929 0a0a 2020  start_cell))..  
-000197f0: 2020 2020 2020 2020 2020 656c 6966 206f            elif o
-00019800: 7074 696f 6e73 5b27 6372 6974 6572 6961  ptions['criteria
-00019810: 275d 203d 3d20 276c 6173 744d 6f6e 7468  '] == 'lastMonth
-00019820: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-00019830: 2020 206f 7074 696f 6e73 5b27 666f 726d     options['form
-00019840: 756c 6127 5d20 3d20 5c0a 2020 2020 2020  ula'] = \.      
-00019850: 2020 2020 2020 2020 2020 2020 2020 2827                ('
-00019860: 414e 4428 4d4f 4e54 4828 2573 293d 4d4f  AND(MONTH(%s)=MO
-00019870: 4e54 4828 544f 4441 5928 2929 2d31 2c4f  NTH(TODAY())-1,O
-00019880: 5228 5945 4152 2825 7329 3d59 4541 5228  R(YEAR(%s)=YEAR(
-00019890: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-000198a0: 2020 2020 2020 2027 544f 4441 5928 2929         'TODAY())
-000198b0: 2c41 4e44 284d 4f4e 5448 2825 7329 3d31  ,AND(MONTH(%s)=1
-000198c0: 2c59 4541 5228 4131 293d 5945 4152 2854  ,YEAR(A1)=YEAR(T
-000198d0: 4f44 4159 2829 292d 3129 2929 2720 250a  ODAY())-1)))' %.
+00010e00: 2020 2020 2020 2020 2020 206c 656e 6774             lengt
+00010e10: 6820 2b3d 2031 360a 0a20 2020 2020 2020  h += 16..       
+00010e20: 2020 2020 2020 2020 2020 2020 2023 2041               # A
+00010e30: 6464 2074 6865 2073 7472 696e 6720 6c65  dd the string le
+00010e40: 6e67 7468 2074 6f20 7468 6520 6c6f 6f6b  ngth to the look
+00010e50: 7570 2074 6162 6c65 2e0a 2020 2020 2020  up table..      
+00010e60: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
+00010e70: 7820 3d20 636f 6c5f 7769 6474 685f 6d61  x = col_width_ma
+00010e80: 782e 6765 7428 636f 6c5f 6e75 6d2c 2030  x.get(col_num, 0
+00010e90: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00010ea0: 2020 2020 2020 6966 206c 656e 6774 6820        if length 
+00010eb0: 3e20 6d61 783a 0a20 2020 2020 2020 2020  > max:.         
+00010ec0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00010ed0: 6f6c 5f77 6964 7468 5f6d 6178 5b63 6f6c  ol_width_max[col
+00010ee0: 5f6e 756d 5d20 3d20 6c65 6e67 7468 0a0a  _num] = length..
+00010ef0: 2020 2020 2020 2020 2320 4170 706c 7920          # Apply 
+00010f00: 7468 6520 7769 6474 6820 746f 2074 6865  the width to the
+00010f10: 2063 6f6c 756d 6e2e 0a20 2020 2020 2020   column..       
+00010f20: 2066 6f72 2063 6f6c 5f6e 756d 2c20 7069   for col_num, pi
+00010f30: 7865 6c5f 7769 6474 6820 696e 2063 6f6c  xel_width in col
+00010f40: 5f77 6964 7468 5f6d 6178 2e69 7465 6d73  _width_max.items
+00010f50: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00010f60: 2320 436f 6e76 6572 7420 7468 6520 7374  # Convert the st
+00010f70: 7269 6e67 2070 6978 656c 2077 6964 7468  ring pixel width
+00010f80: 2074 6f20 6120 6368 6172 6163 7465 7220   to a character 
+00010f90: 7769 6474 6820 7573 696e 6720 616e 0a20  width using an. 
+00010fa0: 2020 2020 2020 2020 2020 2023 2061 6464             # add
+00010fb0: 6974 696f 6e61 6c20 7061 6464 696e 6720  itional padding 
+00010fc0: 6f66 2037 2070 6978 656c 732c 206c 696b  of 7 pixels, lik
+00010fd0: 6520 4578 6365 6c2e 0a20 2020 2020 2020  e Excel..       
+00010fe0: 2020 2020 2077 6964 7468 203d 2073 656c       width = sel
+00010ff0: 662e 5f70 6978 656c 735f 746f 5f77 6964  f._pixels_to_wid
+00011000: 7468 2870 6978 656c 5f77 6964 7468 202b  th(pixel_width +
+00011010: 2037 290a 0a20 2020 2020 2020 2020 2020   7)..           
+00011020: 2023 2054 6865 206d 6178 2063 6f6c 756d   # The max colum
+00011030: 6e20 6368 6172 6163 7465 7220 7769 6474  n character widt
+00011040: 6820 696e 2045 7863 656c 2069 7320 3235  h in Excel is 25
+00011050: 352e 0a20 2020 2020 2020 2020 2020 2069  5..            i
+00011060: 6620 7769 6474 6820 3e20 3235 352e 303a  f width > 255.0:
+00011070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011080: 2077 6964 7468 203d 2032 3535 2e30 0a0a   width = 255.0..
+00011090: 2020 2020 2020 2020 2020 2020 2320 4164              # Ad
+000110a0: 6420 7468 6520 7769 6474 6820 746f 2061  d the width to a
+000110b0: 6e20 6578 6973 7469 6e67 2063 6f6c 2069  n existing col i
+000110c0: 6e66 6f20 7374 7275 6374 7572 6520 6f72  nfo structure or
+000110d0: 2061 6464 2061 206e 6577 206f 6e65 2e0a   add a new one..
+000110e0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+000110f0: 656c 662e 636f 6c5f 696e 666f 2e67 6574  elf.col_info.get
+00011100: 2863 6f6c 5f6e 756d 293a 0a20 2020 2020  (col_num):.     
+00011110: 2020 2020 2020 2020 2020 2023 2057 6520             # We 
+00011120: 6f6e 6c79 2075 7064 6174 6520 7468 6520  only update the 
+00011130: 7769 6474 6820 666f 7220 616e 2065 7869  width for an exi
+00011140: 7374 696e 6720 636f 6c75 6d6e 2069 6620  sting column if 
+00011150: 6974 2069 730a 2020 2020 2020 2020 2020  it is.          
+00011160: 2020 2020 2020 2320 6772 6561 7465 7220        # greater 
+00011170: 7468 616e 2074 6865 2075 7365 7220 6465  than the user de
+00011180: 6669 6e65 6420 7661 6c75 652e 2054 6869  fined value. Thi
+00011190: 7320 616c 6c6f 7773 2074 6865 2075 7365  s allows the use
+000111a0: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+000111b0: 2020 2320 746f 2070 7265 2d6c 6f61 6420    # to pre-load 
+000111c0: 6120 6d69 6e69 6d75 6d20 636f 6c20 7769  a minimum col wi
+000111d0: 6474 682e 0a20 2020 2020 2020 2020 2020  dth..           
+000111e0: 2020 2020 2063 6f6c 5f69 6e66 6f20 3d20       col_info = 
+000111f0: 7365 6c66 2e63 6f6c 5f69 6e66 6f2e 6765  self.col_info.ge
+00011200: 7428 636f 6c5f 6e75 6d29 0a20 2020 2020  t(col_num).     
+00011210: 2020 2020 2020 2020 2020 2075 7365 725f             user_
+00011220: 7769 6474 6820 3d20 636f 6c5f 696e 666f  width = col_info
+00011230: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
+00011240: 2020 2020 6869 6464 656e 203d 2063 6f6c      hidden = col
+00011250: 5f69 6e66 6f5b 355d 0a20 2020 2020 2020  _info[5].       
+00011260: 2020 2020 2020 2020 2069 6620 7573 6572           if user
+00011270: 5f77 6964 7468 2069 7320 6e6f 7420 4e6f  _width is not No
+00011280: 6e65 2061 6e64 206e 6f74 2068 6964 6465  ne and not hidde
+00011290: 6e3a 0a20 2020 2020 2020 2020 2020 2020  n:.             
+000112a0: 2020 2020 2020 2023 2043 6f6c 2069 6e66         # Col inf
+000112b0: 6f20 6973 2075 7365 7220 6465 6669 6e65  o is user define
+000112c0: 642e 0a20 2020 2020 2020 2020 2020 2020  d..             
+000112d0: 2020 2020 2020 2069 6620 7769 6474 6820         if width 
+000112e0: 3e20 7573 6572 5f77 6964 7468 3a0a 2020  > user_width:.  
+000112f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011300: 2020 2020 2020 7365 6c66 2e63 6f6c 5f69        self.col_i
+00011310: 6e66 6f5b 636f 6c5f 6e75 6d5d 5b30 5d20  nfo[col_num][0] 
+00011320: 3d20 7769 6474 680a 2020 2020 2020 2020  = width.        
+00011330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011340: 7365 6c66 2e63 6f6c 5f69 6e66 6f5b 636f  self.col_info[co
+00011350: 6c5f 6e75 6d5d 5b35 5d20 3d20 5472 7565  l_num][5] = True
+00011360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011370: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00011380: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00011390: 636f 6c5f 696e 666f 5b63 6f6c 5f6e 756d  col_info[col_num
+000113a0: 5d5b 305d 203d 2077 6964 7468 0a20 2020  ][0] = width.   
+000113b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000113c0: 2073 656c 662e 636f 6c5f 696e 666f 5b63   self.col_info[c
+000113d0: 6f6c 5f6e 756d 5d5b 355d 203d 2054 7275  ol_num][5] = Tru
+000113e0: 650a 2020 2020 2020 2020 2020 2020 656c  e.            el
+000113f0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00011400: 2020 2020 7365 6c66 2e63 6f6c 5f69 6e66      self.col_inf
+00011410: 6f5b 636f 6c5f 6e75 6d5d 203d 205b 7769  o[col_num] = [wi
+00011420: 6474 682c 204e 6f6e 652c 2046 616c 7365  dth, None, False
+00011430: 2c20 302c 2046 616c 7365 2c20 5472 7565  , 0, False, True
+00011440: 5d0a 0a20 2020 2064 6566 2073 6574 5f72  ]..    def set_r
+00011450: 6f77 2873 656c 662c 2072 6f77 2c20 6865  ow(self, row, he
+00011460: 6967 6874 3d4e 6f6e 652c 2063 656c 6c5f  ight=None, cell_
+00011470: 666f 726d 6174 3d4e 6f6e 652c 206f 7074  format=None, opt
+00011480: 696f 6e73 3d4e 6f6e 6529 3a0a 2020 2020  ions=None):.    
+00011490: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000114a0: 5365 7420 7468 6520 7769 6474 682c 2061  Set the width, a
+000114b0: 6e64 206f 7468 6572 2070 726f 7065 7274  nd other propert
+000114c0: 6965 7320 6f66 2061 2072 6f77 2e0a 0a20  ies of a row... 
+000114d0: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
+000114e0: 2020 2020 2020 2020 2072 6f77 3a20 2020           row:   
+000114f0: 2020 2020 2020 526f 7720 6e75 6d62 6572        Row number
+00011500: 2028 7a65 726f 2d69 6e64 6578 6564 292e   (zero-indexed).
+00011510: 0a20 2020 2020 2020 2020 2020 2068 6569  .            hei
+00011520: 6768 743a 2020 2020 2020 526f 7720 6865  ght:      Row he
+00011530: 6967 6874 2e20 286f 7074 696f 6e61 6c29  ight. (optional)
+00011540: 2e0a 2020 2020 2020 2020 2020 2020 6365  ..            ce
+00011550: 6c6c 5f66 6f72 6d61 743a 2052 6f77 2063  ll_format: Row c
+00011560: 656c 6c5f 666f 726d 6174 2e20 286f 7074  ell_format. (opt
+00011570: 696f 6e61 6c29 2e0a 2020 2020 2020 2020  ional)..        
+00011580: 2020 2020 6f70 7469 6f6e 733a 2020 2020      options:    
+00011590: 2044 6963 7420 6f66 206f 7074 696f 6e73   Dict of options
+000115a0: 2073 7563 6820 6173 2068 6964 6465 6e2c   such as hidden,
+000115b0: 206c 6576 656c 2061 6e64 2063 6f6c 6c61   level and colla
+000115c0: 7073 6564 2e0a 0a20 2020 2020 2020 2052  psed...        R
+000115d0: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
+000115e0: 2020 2020 303a 2020 5375 6363 6573 732e      0:  Success.
+000115f0: 0a20 2020 2020 2020 2020 2020 202d 313a  .            -1:
+00011600: 2052 6f77 206e 756d 6265 7220 6973 206f   Row number is o
+00011610: 7574 206f 6620 776f 726b 7368 6565 7420  ut of worksheet 
+00011620: 626f 756e 6473 2e0a 0a20 2020 2020 2020  bounds...       
+00011630: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
+00011640: 6f70 7469 6f6e 7320 6973 204e 6f6e 653a  options is None:
+00011650: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
+00011660: 696f 6e73 203d 207b 7d0a 0a20 2020 2020  ions = {}..     
+00011670: 2020 2023 2055 7365 206d 696e 696d 756d     # Use minimum
+00011680: 2063 6f6c 2069 6e20 5f63 6865 636b 5f64   col in _check_d
+00011690: 696d 656e 7369 6f6e 7328 292e 0a20 2020  imensions()..   
+000116a0: 2020 2020 2069 6620 7365 6c66 2e64 696d       if self.dim
+000116b0: 5f63 6f6c 6d69 6e20 6973 206e 6f74 204e  _colmin is not N
+000116c0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000116d0: 206d 696e 5f63 6f6c 203d 2073 656c 662e   min_col = self.
+000116e0: 6469 6d5f 636f 6c6d 696e 0a20 2020 2020  dim_colmin.     
+000116f0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00011700: 2020 2020 206d 696e 5f63 6f6c 203d 2030       min_col = 0
+00011710: 0a0a 2020 2020 2020 2020 2320 4368 6563  ..        # Chec
+00011720: 6b20 7468 6174 2072 6f77 2069 7320 7661  k that row is va
+00011730: 6c69 642e 0a20 2020 2020 2020 2069 6620  lid..        if 
+00011740: 7365 6c66 2e5f 6368 6563 6b5f 6469 6d65  self._check_dime
+00011750: 6e73 696f 6e73 2872 6f77 2c20 6d69 6e5f  nsions(row, min_
+00011760: 636f 6c29 3a0a 2020 2020 2020 2020 2020  col):.          
+00011770: 2020 7265 7475 726e 202d 310a 0a20 2020    return -1..   
+00011780: 2020 2020 2069 6620 6865 6967 6874 2069       if height i
+00011790: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+000117a0: 2020 2020 6865 6967 6874 203d 2073 656c      height = sel
+000117b0: 662e 6465 6661 756c 745f 726f 775f 6865  f.default_row_he
+000117c0: 6967 6874 0a0a 2020 2020 2020 2020 2320  ight..        # 
+000117d0: 5365 7420 6f70 7469 6f6e 616c 2072 6f77  Set optional row
+000117e0: 2076 616c 7565 732e 0a20 2020 2020 2020   values..       
+000117f0: 2068 6964 6465 6e20 3d20 6f70 7469 6f6e   hidden = option
+00011800: 732e 6765 7428 2268 6964 6465 6e22 2c20  s.get("hidden", 
+00011810: 4661 6c73 6529 0a20 2020 2020 2020 2063  False).        c
+00011820: 6f6c 6c61 7073 6564 203d 206f 7074 696f  ollapsed = optio
+00011830: 6e73 2e67 6574 2822 636f 6c6c 6170 7365  ns.get("collapse
+00011840: 6422 2c20 4661 6c73 6529 0a20 2020 2020  d", False).     
+00011850: 2020 206c 6576 656c 203d 206f 7074 696f     level = optio
+00011860: 6e73 2e67 6574 2822 6c65 7665 6c22 2c20  ns.get("level", 
+00011870: 3029 0a0a 2020 2020 2020 2020 2320 4966  0)..        # If
+00011880: 2074 6865 2068 6569 6768 7420 6973 2030   the height is 0
+00011890: 2074 6865 2072 6f77 2069 7320 6869 6464   the row is hidd
+000118a0: 656e 2061 6e64 2074 6865 2068 6569 6768  en and the heigh
+000118b0: 7420 6973 2074 6865 2064 6566 6175 6c74  t is the default
+000118c0: 2e0a 2020 2020 2020 2020 6966 2068 6569  ..        if hei
+000118d0: 6768 7420 3d3d 2030 3a0a 2020 2020 2020  ght == 0:.      
+000118e0: 2020 2020 2020 6869 6464 656e 203d 2031        hidden = 1
+000118f0: 0a20 2020 2020 2020 2020 2020 2068 6569  .            hei
+00011900: 6768 7420 3d20 7365 6c66 2e64 6566 6175  ght = self.defau
+00011910: 6c74 5f72 6f77 5f68 6569 6768 740a 0a20  lt_row_height.. 
+00011920: 2020 2020 2020 2023 2053 6574 2074 6865         # Set the
+00011930: 206c 696d 6974 7320 666f 7220 7468 6520   limits for the 
+00011940: 6f75 746c 696e 6520 6c65 7665 6c73 2028  outline levels (
+00011950: 3020 3c3d 2078 203c 3d20 3729 2e0a 2020  0 <= x <= 7)..  
+00011960: 2020 2020 2020 6966 206c 6576 656c 203c        if level <
+00011970: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+00011980: 6c65 7665 6c20 3d20 300a 2020 2020 2020  level = 0.      
+00011990: 2020 6966 206c 6576 656c 203e 2037 3a0a    if level > 7:.
+000119a0: 2020 2020 2020 2020 2020 2020 6c65 7665              leve
+000119b0: 6c20 3d20 370a 0a20 2020 2020 2020 2069  l = 7..        i
+000119c0: 6620 6c65 7665 6c20 3e20 7365 6c66 2e6f  f level > self.o
+000119d0: 7574 6c69 6e65 5f72 6f77 5f6c 6576 656c  utline_row_level
+000119e0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+000119f0: 6c66 2e6f 7574 6c69 6e65 5f72 6f77 5f6c  lf.outline_row_l
+00011a00: 6576 656c 203d 206c 6576 656c 0a0a 2020  evel = level..  
+00011a10: 2020 2020 2020 2320 5374 6f72 6520 7468        # Store th
+00011a20: 6520 726f 7720 7072 6f70 6572 7469 6573  e row properties
+00011a30: 2e0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
+00011a40: 6574 5f72 6f77 735b 726f 775d 203d 205b  et_rows[row] = [
+00011a50: 6865 6967 6874 2c20 6365 6c6c 5f66 6f72  height, cell_for
+00011a60: 6d61 742c 2068 6964 6465 6e2c 206c 6576  mat, hidden, lev
+00011a70: 656c 2c20 636f 6c6c 6170 7365 645d 0a0a  el, collapsed]..
+00011a80: 2020 2020 2020 2020 2320 5374 6f72 6520          # Store 
+00011a90: 7468 6520 726f 7720 6368 616e 6765 2074  the row change t
+00011aa0: 6f20 616c 6c6f 7720 6f70 7469 6d69 7a61  o allow optimiza
+00011ab0: 7469 6f6e 732e 0a20 2020 2020 2020 2073  tions..        s
+00011ac0: 656c 662e 726f 775f 7369 7a65 5f63 6861  elf.row_size_cha
+00011ad0: 6e67 6564 203d 2054 7275 650a 0a20 2020  nged = True..   
+00011ae0: 2020 2020 2023 2053 746f 7265 2074 6865       # Store the
+00011af0: 2072 6f77 2073 697a 6573 2066 6f72 2075   row sizes for u
+00011b00: 7365 2077 6865 6e20 6361 6c63 756c 6174  se when calculat
+00011b10: 696e 6720 696d 6167 6520 7665 7274 6963  ing image vertic
+00011b20: 6573 2e0a 2020 2020 2020 2020 7365 6c66  es..        self
+00011b30: 2e72 6f77 5f73 697a 6573 5b72 6f77 5d20  .row_sizes[row] 
+00011b40: 3d20 5b68 6569 6768 742c 2068 6964 6465  = [height, hidde
+00011b50: 6e5d 0a0a 2020 2020 2020 2020 7265 7475  n]..        retu
+00011b60: 726e 2030 0a0a 2020 2020 6465 6620 7365  rn 0..    def se
+00011b70: 745f 726f 775f 7069 7865 6c73 2873 656c  t_row_pixels(sel
+00011b80: 662c 2072 6f77 2c20 6865 6967 6874 3d4e  f, row, height=N
+00011b90: 6f6e 652c 2063 656c 6c5f 666f 726d 6174  one, cell_format
+00011ba0: 3d4e 6f6e 652c 206f 7074 696f 6e73 3d4e  =None, options=N
+00011bb0: 6f6e 6529 3a0a 2020 2020 2020 2020 2222  one):.        ""
+00011bc0: 220a 2020 2020 2020 2020 5365 7420 7468  ".        Set th
+00011bd0: 6520 7769 6474 6820 2869 6e20 7069 7865  e width (in pixe
+00011be0: 6c73 292c 2061 6e64 206f 7468 6572 2070  ls), and other p
+00011bf0: 726f 7065 7274 6965 7320 6f66 2061 2072  roperties of a r
+00011c00: 6f77 2e0a 0a20 2020 2020 2020 2041 7267  ow...        Arg
+00011c10: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
+00011c20: 6f77 3a20 2020 2020 2020 2020 526f 7720  ow:         Row 
+00011c30: 6e75 6d62 6572 2028 7a65 726f 2d69 6e64  number (zero-ind
+00011c40: 6578 6564 292e 0a20 2020 2020 2020 2020  exed)..         
+00011c50: 2020 2068 6569 6768 743a 2020 2020 2020     height:      
+00011c60: 526f 7720 6865 6967 6874 2069 6e20 7069  Row height in pi
+00011c70: 7865 6c73 2e20 286f 7074 696f 6e61 6c29  xels. (optional)
+00011c80: 2e0a 2020 2020 2020 2020 2020 2020 6365  ..            ce
+00011c90: 6c6c 5f66 6f72 6d61 743a 2052 6f77 2063  ll_format: Row c
+00011ca0: 656c 6c5f 666f 726d 6174 2e20 286f 7074  ell_format. (opt
+00011cb0: 696f 6e61 6c29 2e0a 2020 2020 2020 2020  ional)..        
+00011cc0: 2020 2020 6f70 7469 6f6e 733a 2020 2020      options:    
+00011cd0: 2044 6963 7420 6f66 206f 7074 696f 6e73   Dict of options
+00011ce0: 2073 7563 6820 6173 2068 6964 6465 6e2c   such as hidden,
+00011cf0: 206c 6576 656c 2061 6e64 2063 6f6c 6c61   level and colla
+00011d00: 7073 6564 2e0a 0a20 2020 2020 2020 2052  psed...        R
+00011d10: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
+00011d20: 2020 2020 303a 2020 5375 6363 6573 732e      0:  Success.
+00011d30: 0a20 2020 2020 2020 2020 2020 202d 313a  .            -1:
+00011d40: 2052 6f77 206e 756d 6265 7220 6973 206f   Row number is o
+00011d50: 7574 206f 6620 776f 726b 7368 6565 7420  ut of worksheet 
+00011d60: 626f 756e 6473 2e0a 0a20 2020 2020 2020  bounds...       
+00011d70: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
+00011d80: 6865 6967 6874 2069 7320 6e6f 7420 4e6f  height is not No
+00011d90: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00011da0: 6865 6967 6874 203d 2073 656c 662e 5f70  height = self._p
+00011db0: 6978 656c 735f 746f 5f68 6569 6768 7428  ixels_to_height(
+00011dc0: 6865 6967 6874 290a 0a20 2020 2020 2020  height)..       
+00011dd0: 2072 6574 7572 6e20 7365 6c66 2e73 6574   return self.set
+00011de0: 5f72 6f77 2872 6f77 2c20 6865 6967 6874  _row(row, height
+00011df0: 2c20 6365 6c6c 5f66 6f72 6d61 742c 206f  , cell_format, o
+00011e00: 7074 696f 6e73 290a 0a20 2020 2064 6566  ptions)..    def
+00011e10: 2073 6574 5f64 6566 6175 6c74 5f72 6f77   set_default_row
+00011e20: 2873 656c 662c 2068 6569 6768 743d 4e6f  (self, height=No
+00011e30: 6e65 2c20 6869 6465 5f75 6e75 7365 645f  ne, hide_unused_
+00011e40: 726f 7773 3d46 616c 7365 293a 0a20 2020  rows=False):.   
+00011e50: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00011e60: 2053 6574 2074 6865 2064 6566 6175 6c74   Set the default
+00011e70: 2072 6f77 2070 726f 7065 7274 6965 732e   row properties.
+00011e80: 0a0a 2020 2020 2020 2020 4172 6773 3a0a  ..        Args:.
+00011e90: 2020 2020 2020 2020 2020 2020 6865 6967              heig
+00011ea0: 6874 3a20 2020 2020 2020 2020 2020 4465  ht:           De
+00011eb0: 6661 756c 7420 6865 6967 6874 2e20 4f70  fault height. Op
+00011ec0: 7469 6f6e 616c 2c20 6465 6661 756c 7473  tional, defaults
+00011ed0: 2074 6f20 3135 2e0a 2020 2020 2020 2020   to 15..        
+00011ee0: 2020 2020 6869 6465 5f75 6e75 7365 645f      hide_unused_
+00011ef0: 726f 7773 3a20 4869 6465 2075 6e75 7365  rows: Hide unuse
+00011f00: 6420 726f 7773 2e20 4f70 7469 6f6e 616c  d rows. Optional
+00011f10: 2c20 6465 6661 756c 7473 2074 6f20 4661  , defaults to Fa
+00011f20: 6c73 652e 0a0a 2020 2020 2020 2020 5265  lse...        Re
+00011f30: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
+00011f40: 2020 204e 6f74 6869 6e67 2e0a 0a20 2020     Nothing...   
+00011f50: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00011f60: 2069 6620 6865 6967 6874 2069 7320 4e6f   if height is No
+00011f70: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00011f80: 6865 6967 6874 203d 2073 656c 662e 6465  height = self.de
+00011f90: 6661 756c 745f 726f 775f 6865 6967 6874  fault_row_height
+00011fa0: 0a0a 2020 2020 2020 2020 6966 2068 6569  ..        if hei
+00011fb0: 6768 7420 213d 2073 656c 662e 6f72 6967  ght != self.orig
+00011fc0: 696e 616c 5f72 6f77 5f68 6569 6768 743a  inal_row_height:
+00011fd0: 0a20 2020 2020 2020 2020 2020 2023 2053  .            # S
+00011fe0: 746f 7265 2074 6865 2072 6f77 2063 6861  tore the row cha
+00011ff0: 6e67 6520 746f 2061 6c6c 6f77 206f 7074  nge to allow opt
+00012000: 696d 697a 6174 696f 6e73 2e0a 2020 2020  imizations..    
+00012010: 2020 2020 2020 2020 7365 6c66 2e72 6f77          self.row
+00012020: 5f73 697a 655f 6368 616e 6765 6420 3d20  _size_changed = 
+00012030: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+00012040: 2073 656c 662e 6465 6661 756c 745f 726f   self.default_ro
+00012050: 775f 6865 6967 6874 203d 2068 6569 6768  w_height = heigh
+00012060: 740a 0a20 2020 2020 2020 2069 6620 6869  t..        if hi
+00012070: 6465 5f75 6e75 7365 645f 726f 7773 3a0a  de_unused_rows:.
+00012080: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00012090: 2e64 6566 6175 6c74 5f72 6f77 5f7a 6572  .default_row_zer
+000120a0: 6f65 6420 3d20 310a 0a20 2020 2040 636f  oed = 1..    @co
+000120b0: 6e76 6572 745f 7261 6e67 655f 6172 6773  nvert_range_args
+000120c0: 0a20 2020 2064 6566 206d 6572 6765 5f72  .    def merge_r
+000120d0: 616e 6765 280a 2020 2020 2020 2020 7365  ange(.        se
+000120e0: 6c66 2c20 6669 7273 745f 726f 772c 2066  lf, first_row, f
+000120f0: 6972 7374 5f63 6f6c 2c20 6c61 7374 5f72  irst_col, last_r
+00012100: 6f77 2c20 6c61 7374 5f63 6f6c 2c20 6461  ow, last_col, da
+00012110: 7461 2c20 6365 6c6c 5f66 6f72 6d61 743d  ta, cell_format=
+00012120: 4e6f 6e65 0a20 2020 2029 3a0a 2020 2020  None.    ):.    
+00012130: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00012140: 4d65 7267 6520 6120 7261 6e67 6520 6f66  Merge a range of
+00012150: 2063 656c 6c73 2e0a 0a20 2020 2020 2020   cells...       
+00012160: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
+00012170: 2020 2066 6972 7374 5f72 6f77 3a20 2020     first_row:   
+00012180: 2054 6865 2066 6972 7374 2072 6f77 206f   The first row o
+00012190: 6620 7468 6520 6365 6c6c 2072 616e 6765  f the cell range
+000121a0: 2e20 287a 6572 6f20 696e 6465 7865 6429  . (zero indexed)
+000121b0: 2e0a 2020 2020 2020 2020 2020 2020 6669  ..            fi
+000121c0: 7273 745f 636f 6c3a 2020 2020 5468 6520  rst_col:    The 
+000121d0: 6669 7273 7420 636f 6c75 6d6e 206f 6620  first column of 
+000121e0: 7468 6520 6365 6c6c 2072 616e 6765 2e0a  the cell range..
+000121f0: 2020 2020 2020 2020 2020 2020 6c61 7374              last
+00012200: 5f72 6f77 3a20 2020 2020 5468 6520 6c61  _row:     The la
+00012210: 7374 2072 6f77 206f 6620 7468 6520 6365  st row of the ce
+00012220: 6c6c 2072 616e 6765 2e20 287a 6572 6f20  ll range. (zero 
+00012230: 696e 6465 7865 6429 2e0a 2020 2020 2020  indexed)..      
+00012240: 2020 2020 2020 6c61 7374 5f63 6f6c 3a20        last_col: 
+00012250: 2020 2020 5468 6520 6c61 7374 2063 6f6c      The last col
+00012260: 756d 6e20 6f66 2074 6865 2063 656c 6c20  umn of the cell 
+00012270: 7261 6e67 652e 0a20 2020 2020 2020 2020  range..         
+00012280: 2020 2064 6174 613a 2020 2020 2020 2020     data:        
+00012290: 2043 656c 6c20 6461 7461 2e0a 2020 2020   Cell data..    
+000122a0: 2020 2020 2020 2020 6365 6c6c 5f66 6f72          cell_for
+000122b0: 6d61 743a 2020 4365 6c6c 2046 6f72 6d61  mat:  Cell Forma
+000122c0: 7420 6f62 6a65 6374 2e0a 0a20 2020 2020  t object...     
+000122d0: 2020 2052 6574 7572 6e73 3a0a 2020 2020     Returns:.    
+000122e0: 2020 2020 2020 2020 2030 3a20 2020 2053           0:    S
+000122f0: 7563 6365 7373 2e0a 2020 2020 2020 2020  uccess..        
+00012300: 2020 2020 2d31 3a20 2020 2052 6f77 206f      -1:    Row o
+00012310: 7220 636f 6c75 6d6e 2069 7320 6f75 7420  r column is out 
+00012320: 6f66 2077 6f72 6b73 6865 6574 2062 6f75  of worksheet bou
+00012330: 6e64 732e 0a20 2020 2020 2020 2020 2020  nds..           
+00012340: 206f 7468 6572 3a20 5265 7475 726e 2076   other: Return v
+00012350: 616c 7565 206f 6620 7772 6974 6528 292e  alue of write().
+00012360: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00012370: 2020 2020 2020 2320 4d65 7267 6520 6120        # Merge a 
+00012380: 7261 6e67 6520 6f66 2063 656c 6c73 2e20  range of cells. 
+00012390: 5468 6520 6669 7273 7420 6365 6c6c 2073  The first cell s
+000123a0: 686f 756c 6420 636f 6e74 6169 6e20 7468  hould contain th
+000123b0: 6520 6461 7461 2061 6e64 0a20 2020 2020  e data and.     
+000123c0: 2020 2023 2074 6865 206f 7468 6572 7320     # the others 
+000123d0: 7368 6f75 6c64 2062 6520 626c 616e 6b2e  should be blank.
+000123e0: 2041 6c6c 2063 656c 6c73 2073 686f 756c   All cells shoul
+000123f0: 6420 6861 7665 2074 6865 2073 616d 6520  d have the same 
+00012400: 666f 726d 6174 2e0a 0a20 2020 2020 2020  format...       
+00012410: 2023 2045 7863 656c 2064 6f65 736e 2774   # Excel doesn't
+00012420: 2061 6c6c 6f77 2061 2073 696e 676c 6520   allow a single 
+00012430: 6365 6c6c 2074 6f20 6265 206d 6572 6765  cell to be merge
+00012440: 640a 2020 2020 2020 2020 6966 2066 6972  d.        if fir
+00012450: 7374 5f72 6f77 203d 3d20 6c61 7374 5f72  st_row == last_r
+00012460: 6f77 2061 6e64 2066 6972 7374 5f63 6f6c  ow and first_col
+00012470: 203d 3d20 6c61 7374 5f63 6f6c 3a0a 2020   == last_col:.  
+00012480: 2020 2020 2020 2020 2020 7761 726e 2822            warn("
+00012490: 4361 6e27 7420 6d65 7267 6520 7369 6e67  Can't merge sing
+000124a0: 6c65 2063 656c 6c22 290a 2020 2020 2020  le cell").      
+000124b0: 2020 2020 2020 7265 7475 726e 0a0a 2020        return..  
+000124c0: 2020 2020 2020 2320 5377 6170 206c 6173        # Swap las
+000124d0: 7420 726f 772f 636f 6c20 7769 7468 2066  t row/col with f
+000124e0: 6972 7374 2072 6f77 2f63 6f6c 2061 7320  irst row/col as 
+000124f0: 6e65 6365 7373 6172 790a 2020 2020 2020  necessary.      
+00012500: 2020 6966 2066 6972 7374 5f72 6f77 203e    if first_row >
+00012510: 206c 6173 745f 726f 773a 0a20 2020 2020   last_row:.     
+00012520: 2020 2020 2020 2028 6669 7273 745f 726f         (first_ro
+00012530: 772c 206c 6173 745f 726f 7729 203d 2028  w, last_row) = (
+00012540: 6c61 7374 5f72 6f77 2c20 6669 7273 745f  last_row, first_
+00012550: 726f 7729 0a20 2020 2020 2020 2069 6620  row).        if 
+00012560: 6669 7273 745f 636f 6c20 3e20 6c61 7374  first_col > last
+00012570: 5f63 6f6c 3a0a 2020 2020 2020 2020 2020  _col:.          
+00012580: 2020 2866 6972 7374 5f63 6f6c 2c20 6c61    (first_col, la
+00012590: 7374 5f63 6f6c 2920 3d20 286c 6173 745f  st_col) = (last_
+000125a0: 636f 6c2c 2066 6972 7374 5f63 6f6c 290a  col, first_col).
+000125b0: 0a20 2020 2020 2020 2023 2043 6865 636b  .        # Check
+000125c0: 2074 6861 7420 726f 7720 616e 6420 636f   that row and co
+000125d0: 6c20 6172 6520 7661 6c69 6420 616e 6420  l are valid and 
+000125e0: 7374 6f72 6520 6d61 7820 616e 6420 6d69  store max and mi
+000125f0: 6e20 7661 6c75 6573 2e0a 2020 2020 2020  n values..      
+00012600: 2020 6966 2073 656c 662e 5f63 6865 636b    if self._check
+00012610: 5f64 696d 656e 7369 6f6e 7328 6669 7273  _dimensions(firs
+00012620: 745f 726f 772c 2066 6972 7374 5f63 6f6c  t_row, first_col
+00012630: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00012640: 6574 7572 6e20 2d31 0a20 2020 2020 2020  eturn -1.       
+00012650: 2069 6620 7365 6c66 2e5f 6368 6563 6b5f   if self._check_
+00012660: 6469 6d65 6e73 696f 6e73 286c 6173 745f  dimensions(last_
+00012670: 726f 772c 206c 6173 745f 636f 6c29 3a0a  row, last_col):.
+00012680: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00012690: 726e 202d 310a 0a20 2020 2020 2020 2023  rn -1..        #
+000126a0: 2043 6865 636b 2069 6620 7468 6520 6d65   Check if the me
+000126b0: 7267 6520 7261 6e67 6520 6f76 6572 6c61  rge range overla
+000126c0: 7073 2061 2070 7265 7669 6f75 7320 6d65  ps a previous me
+000126d0: 7267 6564 206f 7220 7461 626c 6520 7261  rged or table ra
+000126e0: 6e67 652e 0a20 2020 2020 2020 2023 2054  nge..        # T
+000126f0: 6869 7320 6973 2061 2063 7269 7469 6361  his is a critica
+00012700: 6c20 6669 6c65 2063 6f72 7275 7074 696f  l file corruptio
+00012710: 6e20 6572 726f 7220 696e 2045 7863 656c  n error in Excel
+00012720: 2e0a 2020 2020 2020 2020 6365 6c6c 5f72  ..        cell_r
+00012730: 616e 6765 203d 2078 6c5f 7261 6e67 6528  ange = xl_range(
+00012740: 6669 7273 745f 726f 772c 2066 6972 7374  first_row, first
+00012750: 5f63 6f6c 2c20 6c61 7374 5f72 6f77 2c20  _col, last_row, 
+00012760: 6c61 7374 5f63 6f6c 290a 2020 2020 2020  last_col).      
+00012770: 2020 666f 7220 726f 7720 696e 2072 616e    for row in ran
+00012780: 6765 2866 6972 7374 5f72 6f77 2c20 6c61  ge(first_row, la
+00012790: 7374 5f72 6f77 202b 2031 293a 0a20 2020  st_row + 1):.   
+000127a0: 2020 2020 2020 2020 2066 6f72 2063 6f6c           for col
+000127b0: 2069 6e20 7261 6e67 6528 6669 7273 745f   in range(first_
+000127c0: 636f 6c2c 206c 6173 745f 636f 6c20 2b20  col, last_col + 
+000127d0: 3129 3a0a 2020 2020 2020 2020 2020 2020  1):.            
+000127e0: 2020 2020 6966 2073 656c 662e 6d65 7267      if self.merg
+000127f0: 6564 5f63 656c 6c73 2e67 6574 2828 726f  ed_cells.get((ro
+00012800: 772c 2063 6f6c 2929 3a0a 2020 2020 2020  w, col)):.      
+00012810: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+00012820: 6576 696f 7573 5f72 616e 6765 203d 2073  evious_range = s
+00012830: 656c 662e 6d65 7267 6564 5f63 656c 6c73  elf.merged_cells
+00012840: 2e67 6574 2828 726f 772c 2063 6f6c 2929  .get((row, col))
+00012850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012860: 2020 2020 2072 6169 7365 204f 7665 726c       raise Overl
+00012870: 6170 7069 6e67 5261 6e67 6528 0a20 2020  appingRange(.   
+00012880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012890: 2020 2020 2022 4d65 7267 6520 7261 6e67       "Merge rang
+000128a0: 6520 2725 7327 206f 7665 726c 6170 7320  e '%s' overlaps 
+000128b0: 7072 6576 696f 7573 206d 6572 6765 2072  previous merge r
+000128c0: 616e 6765 2027 2573 272e 220a 2020 2020  ange '%s'.".    
+000128d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000128e0: 2020 2020 2520 2863 656c 6c5f 7261 6e67      % (cell_rang
+000128f0: 652c 2070 7265 7669 6f75 735f 7261 6e67  e, previous_rang
+00012900: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
+00012910: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00012920: 2020 2020 2020 2020 2065 6c69 6620 7365           elif se
+00012930: 6c66 2e74 6162 6c65 5f63 656c 6c73 2e67  lf.table_cells.g
+00012940: 6574 2828 726f 772c 2063 6f6c 2929 3a0a  et((row, col)):.
+00012950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012960: 2020 2020 7072 6576 696f 7573 5f72 616e      previous_ran
+00012970: 6765 203d 2073 656c 662e 7461 626c 655f  ge = self.table_
+00012980: 6365 6c6c 732e 6765 7428 2872 6f77 2c20  cells.get((row, 
+00012990: 636f 6c29 290a 2020 2020 2020 2020 2020  col)).          
+000129a0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+000129b0: 4f76 6572 6c61 7070 696e 6752 616e 6765  OverlappingRange
+000129c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000129d0: 2020 2020 2020 2020 2020 224d 6572 6765            "Merge
+000129e0: 2072 616e 6765 2027 2573 2720 6f76 6572   range '%s' over
+000129f0: 6c61 7073 2070 7265 7669 6f75 7320 7461  laps previous ta
+00012a00: 626c 6520 7261 6e67 6520 2725 7327 2e22  ble range '%s'."
+00012a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012a20: 2020 2020 2020 2020 2025 2028 6365 6c6c           % (cell
+00012a30: 5f72 616e 6765 2c20 7072 6576 696f 7573  _range, previous
+00012a40: 5f72 616e 6765 290a 2020 2020 2020 2020  _range).        
+00012a50: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00012a60: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00012a70: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00012a80: 2020 2020 2020 2020 7365 6c66 2e6d 6572          self.mer
+00012a90: 6765 645f 6365 6c6c 735b 2872 6f77 2c20  ged_cells[(row, 
+00012aa0: 636f 6c29 5d20 3d20 6365 6c6c 5f72 616e  col)] = cell_ran
+00012ab0: 6765 0a0a 2020 2020 2020 2020 2320 5374  ge..        # St
+00012ac0: 6f72 6520 7468 6520 6d65 7267 6520 7261  ore the merge ra
+00012ad0: 6e67 652e 0a20 2020 2020 2020 2073 656c  nge..        sel
+00012ae0: 662e 6d65 7267 652e 6170 7065 6e64 285b  f.merge.append([
+00012af0: 6669 7273 745f 726f 772c 2066 6972 7374  first_row, first
+00012b00: 5f63 6f6c 2c20 6c61 7374 5f72 6f77 2c20  _col, last_row, 
+00012b10: 6c61 7374 5f63 6f6c 5d29 0a0a 2020 2020  last_col])..    
+00012b20: 2020 2020 2320 5772 6974 6520 7468 6520      # Write the 
+00012b30: 6669 7273 7420 6365 6c6c 0a20 2020 2020  first cell.     
+00012b40: 2020 2073 656c 662e 5f77 7269 7465 2866     self._write(f
+00012b50: 6972 7374 5f72 6f77 2c20 6669 7273 745f  irst_row, first_
+00012b60: 636f 6c2c 2064 6174 612c 2063 656c 6c5f  col, data, cell_
+00012b70: 666f 726d 6174 290a 0a20 2020 2020 2020  format)..       
+00012b80: 2023 2050 6164 206f 7574 2074 6865 2072   # Pad out the r
+00012b90: 6573 7420 6f66 2074 6865 2061 7265 6120  est of the area 
+00012ba0: 7769 7468 2066 6f72 6d61 7474 6564 2062  with formatted b
+00012bb0: 6c61 6e6b 2063 656c 6c73 2e0a 2020 2020  lank cells..    
+00012bc0: 2020 2020 666f 7220 726f 7720 696e 2072      for row in r
+00012bd0: 616e 6765 2866 6972 7374 5f72 6f77 2c20  ange(first_row, 
+00012be0: 6c61 7374 5f72 6f77 202b 2031 293a 0a20  last_row + 1):. 
+00012bf0: 2020 2020 2020 2020 2020 2066 6f72 2063             for c
+00012c00: 6f6c 2069 6e20 7261 6e67 6528 6669 7273  ol in range(firs
+00012c10: 745f 636f 6c2c 206c 6173 745f 636f 6c20  t_col, last_col 
+00012c20: 2b20 3129 3a0a 2020 2020 2020 2020 2020  + 1):.          
+00012c30: 2020 2020 2020 6966 2072 6f77 203d 3d20        if row == 
+00012c40: 6669 7273 745f 726f 7720 616e 6420 636f  first_row and co
+00012c50: 6c20 3d3d 2066 6972 7374 5f63 6f6c 3a0a  l == first_col:.
+00012c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012c70: 2020 2020 636f 6e74 696e 7565 0a20 2020      continue.   
+00012c80: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00012c90: 662e 5f77 7269 7465 5f62 6c61 6e6b 2872  f._write_blank(r
+00012ca0: 6f77 2c20 636f 6c2c 2022 222c 2063 656c  ow, col, "", cel
+00012cb0: 6c5f 666f 726d 6174 290a 0a20 2020 2020  l_format)..     
+00012cc0: 2020 2072 6574 7572 6e20 300a 0a20 2020     return 0..   
+00012cd0: 2040 636f 6e76 6572 745f 7261 6e67 655f   @convert_range_
+00012ce0: 6172 6773 0a20 2020 2064 6566 2061 7574  args.    def aut
+00012cf0: 6f66 696c 7465 7228 7365 6c66 2c20 6669  ofilter(self, fi
+00012d00: 7273 745f 726f 772c 2066 6972 7374 5f63  rst_row, first_c
+00012d10: 6f6c 2c20 6c61 7374 5f72 6f77 2c20 6c61  ol, last_row, la
+00012d20: 7374 5f63 6f6c 293a 0a20 2020 2020 2020  st_col):.       
+00012d30: 2022 2222 0a20 2020 2020 2020 2053 6574   """.        Set
+00012d40: 2074 6865 2061 7574 6f66 696c 7465 7220   the autofilter 
+00012d50: 6172 6561 2069 6e20 7468 6520 776f 726b  area in the work
+00012d60: 7368 6565 742e 0a0a 2020 2020 2020 2020  sheet...        
+00012d70: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
+00012d80: 2020 6669 7273 745f 726f 773a 2020 2020    first_row:    
+00012d90: 5468 6520 6669 7273 7420 726f 7720 6f66  The first row of
+00012da0: 2074 6865 2063 656c 6c20 7261 6e67 652e   the cell range.
+00012db0: 2028 7a65 726f 2069 6e64 6578 6564 292e   (zero indexed).
+00012dc0: 0a20 2020 2020 2020 2020 2020 2066 6972  .            fir
+00012dd0: 7374 5f63 6f6c 3a20 2020 2054 6865 2066  st_col:    The f
+00012de0: 6972 7374 2063 6f6c 756d 6e20 6f66 2074  irst column of t
+00012df0: 6865 2063 656c 6c20 7261 6e67 652e 0a20  he cell range.. 
+00012e00: 2020 2020 2020 2020 2020 206c 6173 745f             last_
+00012e10: 726f 773a 2020 2020 2054 6865 206c 6173  row:     The las
+00012e20: 7420 726f 7720 6f66 2074 6865 2063 656c  t row of the cel
+00012e30: 6c20 7261 6e67 652e 2028 7a65 726f 2069  l range. (zero i
+00012e40: 6e64 6578 6564 292e 0a20 2020 2020 2020  ndexed)..       
+00012e50: 2020 2020 206c 6173 745f 636f 6c3a 2020       last_col:  
+00012e60: 2020 2054 6865 206c 6173 7420 636f 6c75     The last colu
+00012e70: 6d6e 206f 6620 7468 6520 6365 6c6c 2072  mn of the cell r
+00012e80: 616e 6765 2e0a 0a20 2020 2020 2020 2052  ange...        R
+00012e90: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
+00012ea0: 2020 2020 204e 6f74 6869 6e67 2e0a 0a20       Nothing... 
+00012eb0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00012ec0: 2020 2023 2052 6576 6572 7365 206d 6178     # Reverse max
+00012ed0: 2061 6e64 206d 696e 2076 616c 7565 7320   and min values 
+00012ee0: 6966 206e 6563 6573 7361 7279 2e0a 2020  if necessary..  
+00012ef0: 2020 2020 2020 6966 206c 6173 745f 726f        if last_ro
+00012f00: 7720 3c20 6669 7273 745f 726f 773a 0a20  w < first_row:. 
+00012f10: 2020 2020 2020 2020 2020 2028 6669 7273             (firs
+00012f20: 745f 726f 772c 206c 6173 745f 726f 7729  t_row, last_row)
+00012f30: 203d 2028 6c61 7374 5f72 6f77 2c20 6669   = (last_row, fi
+00012f40: 7273 745f 726f 7729 0a20 2020 2020 2020  rst_row).       
+00012f50: 2069 6620 6c61 7374 5f63 6f6c 203c 2066   if last_col < f
+00012f60: 6972 7374 5f63 6f6c 3a0a 2020 2020 2020  irst_col:.      
+00012f70: 2020 2020 2020 2866 6972 7374 5f63 6f6c        (first_col
+00012f80: 2c20 6c61 7374 5f63 6f6c 2920 3d20 286c  , last_col) = (l
+00012f90: 6173 745f 636f 6c2c 2066 6972 7374 5f63  ast_col, first_c
+00012fa0: 6f6c 290a 0a20 2020 2020 2020 2023 2042  ol)..        # B
+00012fb0: 7569 6c64 2075 7020 7468 6520 7072 696e  uild up the prin
+00012fc0: 7420 6172 6561 2072 616e 6765 2022 5368  t area range "Sh
+00012fd0: 6565 7431 2124 4124 313a 2443 2431 3322  eet1!$A$1:$C$13"
+00012fe0: 2e0a 2020 2020 2020 2020 6172 6561 203d  ..        area =
+00012ff0: 2073 656c 662e 5f63 6f6e 7665 7274 5f6e   self._convert_n
+00013000: 616d 655f 6172 6561 2866 6972 7374 5f72  ame_area(first_r
+00013010: 6f77 2c20 6669 7273 745f 636f 6c2c 206c  ow, first_col, l
+00013020: 6173 745f 726f 772c 206c 6173 745f 636f  ast_row, last_co
+00013030: 6c29 0a20 2020 2020 2020 2072 6566 203d  l).        ref =
+00013040: 2078 6c5f 7261 6e67 6528 6669 7273 745f   xl_range(first_
+00013050: 726f 772c 2066 6972 7374 5f63 6f6c 2c20  row, first_col, 
+00013060: 6c61 7374 5f72 6f77 2c20 6c61 7374 5f63  last_row, last_c
+00013070: 6f6c 290a 0a20 2020 2020 2020 2073 656c  ol)..        sel
+00013080: 662e 6175 746f 6669 6c74 6572 5f61 7265  f.autofilter_are
+00013090: 6120 3d20 6172 6561 0a20 2020 2020 2020  a = area.       
+000130a0: 2073 656c 662e 6175 746f 6669 6c74 6572   self.autofilter
+000130b0: 5f72 6566 203d 2072 6566 0a20 2020 2020  _ref = ref.     
+000130c0: 2020 2073 656c 662e 6669 6c74 6572 5f72     self.filter_r
+000130d0: 616e 6765 203d 205b 6669 7273 745f 636f  ange = [first_co
+000130e0: 6c2c 206c 6173 745f 636f 6c5d 0a0a 2020  l, last_col]..  
+000130f0: 2020 2020 2020 2320 5374 6f72 6520 7468        # Store th
+00013100: 6520 6669 6c74 6572 2063 656c 6c20 706f  e filter cell po
+00013110: 7369 7469 6f6e 7320 666f 7220 7573 6520  sitions for use 
+00013120: 696e 2074 6865 2061 7574 6f66 6974 2063  in the autofit c
+00013130: 616c 6375 6c61 7469 6f6e 2e0a 2020 2020  alculation..    
+00013140: 2020 2020 666f 7220 636f 6c20 696e 2072      for col in r
+00013150: 616e 6765 2866 6972 7374 5f63 6f6c 2c20  ange(first_col, 
+00013160: 6c61 7374 5f63 6f6c 202b 2031 293a 0a20  last_col + 1):. 
+00013170: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00013180: 6669 6c74 6572 5f63 656c 6c73 5b28 6669  filter_cells[(fi
+00013190: 7273 745f 726f 772c 2063 6f6c 295d 203d  rst_row, col)] =
+000131a0: 2054 7275 650a 0a20 2020 2064 6566 2066   True..    def f
+000131b0: 696c 7465 725f 636f 6c75 6d6e 2873 656c  ilter_column(sel
+000131c0: 662c 2063 6f6c 2c20 6372 6974 6572 6961  f, col, criteria
+000131d0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+000131e0: 2020 2020 2020 2053 6574 2074 6865 2063         Set the c
+000131f0: 6f6c 756d 6e20 6669 6c74 6572 2063 7269  olumn filter cri
+00013200: 7465 7269 612e 0a0a 2020 2020 2020 2020  teria...        
+00013210: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
+00013220: 2020 636f 6c3a 2020 2020 2020 2046 696c    col:       Fil
+00013230: 7465 7220 636f 6c75 6d6e 2028 7a65 726f  ter column (zero
+00013240: 2d69 6e64 6578 6564 292e 0a20 2020 2020  -indexed)..     
+00013250: 2020 2020 2020 2063 7269 7465 7269 613a         criteria:
+00013260: 2020 4669 6c74 6572 2063 7269 7465 7269    Filter criteri
+00013270: 612e 0a0a 2020 2020 2020 2020 5265 7475  a...        Retu
+00013280: 726e 733a 0a20 2020 2020 2020 2020 2020  rns:.           
+00013290: 2020 4e6f 7468 696e 672e 0a0a 2020 2020    Nothing...    
+000132a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000132b0: 6966 206e 6f74 2073 656c 662e 6175 746f  if not self.auto
+000132c0: 6669 6c74 6572 5f61 7265 613a 0a20 2020  filter_area:.   
+000132d0: 2020 2020 2020 2020 2077 6172 6e28 224d           warn("M
+000132e0: 7573 7420 6361 6c6c 2061 7574 6f66 696c  ust call autofil
+000132f0: 7465 7228 2920 6265 666f 7265 2066 696c  ter() before fil
+00013300: 7465 725f 636f 6c75 6d6e 2829 2229 0a20  ter_column()"). 
+00013310: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00013320: 6e0a 0a20 2020 2020 2020 2023 2043 6865  n..        # Che
+00013330: 636b 2066 6f72 2061 2063 6f6c 756d 6e20  ck for a column 
+00013340: 7265 6665 7265 6e63 6520 696e 2041 3120  reference in A1 
+00013350: 6e6f 7461 7469 6f6e 2061 6e64 2073 7562  notation and sub
+00013360: 7374 6974 7574 652e 0a20 2020 2020 2020  stitute..       
+00013370: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+00013380: 2020 696e 7428 636f 6c29 0a20 2020 2020    int(col).     
+00013390: 2020 2065 7863 6570 7420 5661 6c75 6545     except ValueE
+000133a0: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
+000133b0: 2020 2320 436f 6e76 6572 7420 636f 6c20    # Convert col 
+000133c0: 7265 6620 746f 2061 2063 656c 6c20 7265  ref to a cell re
+000133d0: 6620 616e 6420 7468 656e 2074 6f20 6120  f and then to a 
+000133e0: 636f 6c20 6e75 6d62 6572 2e0a 2020 2020  col number..    
+000133f0: 2020 2020 2020 2020 636f 6c5f 6c65 7474          col_lett
+00013400: 6572 203d 2063 6f6c 0a20 2020 2020 2020  er = col.       
+00013410: 2020 2020 2028 5f2c 2063 6f6c 2920 3d20       (_, col) = 
+00013420: 786c 5f63 656c 6c5f 746f 5f72 6f77 636f  xl_cell_to_rowco
+00013430: 6c28 636f 6c20 2b20 2231 2229 0a0a 2020  l(col + "1")..  
+00013440: 2020 2020 2020 2020 2020 6966 2063 6f6c            if col
+00013450: 203e 3d20 7365 6c66 2e78 6c73 5f63 6f6c   >= self.xls_col
+00013460: 6d61 783a 0a20 2020 2020 2020 2020 2020  max:.           
+00013470: 2020 2020 2077 6172 6e28 2249 6e76 616c       warn("Inval
+00013480: 6964 2063 6f6c 756d 6e20 2725 7327 2220  id column '%s'" 
+00013490: 2520 636f 6c5f 6c65 7474 6572 290a 2020  % col_letter).  
+000134a0: 2020 2020 2020 2020 2020 2020 2020 7265                re
+000134b0: 7475 726e 0a0a 2020 2020 2020 2020 2863  turn..        (c
+000134c0: 6f6c 5f66 6972 7374 2c20 636f 6c5f 6c61  ol_first, col_la
+000134d0: 7374 2920 3d20 7365 6c66 2e66 696c 7465  st) = self.filte
+000134e0: 725f 7261 6e67 650a 0a20 2020 2020 2020  r_range..       
+000134f0: 2023 2052 656a 6563 7420 636f 6c75 6d6e   # Reject column
+00013500: 2069 6620 6974 2069 7320 6f75 7473 6964   if it is outsid
+00013510: 6520 6669 6c74 6572 2072 616e 6765 2e0a  e filter range..
+00013520: 2020 2020 2020 2020 6966 2063 6f6c 203c          if col <
+00013530: 2063 6f6c 5f66 6972 7374 206f 7220 636f   col_first or co
+00013540: 6c20 3e20 636f 6c5f 6c61 7374 3a0a 2020  l > col_last:.  
+00013550: 2020 2020 2020 2020 2020 7761 726e 280a            warn(.
+00013560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013570: 2243 6f6c 756d 6e20 2725 6427 206f 7574  "Column '%d' out
+00013580: 7369 6465 2061 7574 6f66 696c 7465 7228  side autofilter(
+00013590: 2920 636f 6c75 6d6e 2072 616e 6765 2028  ) column range (
+000135a0: 2564 2c20 2564 2922 0a20 2020 2020 2020  %d, %d)".       
+000135b0: 2020 2020 2020 2020 2025 2028 636f 6c2c           % (col,
+000135c0: 2063 6f6c 5f66 6972 7374 2c20 636f 6c5f   col_first, col_
+000135d0: 6c61 7374 290a 2020 2020 2020 2020 2020  last).          
+000135e0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+000135f0: 7265 7475 726e 0a0a 2020 2020 2020 2020  return..        
+00013600: 746f 6b65 6e73 203d 2073 656c 662e 5f65  tokens = self._e
+00013610: 7874 7261 6374 5f66 696c 7465 725f 746f  xtract_filter_to
+00013620: 6b65 6e73 2863 7269 7465 7269 6129 0a0a  kens(criteria)..
+00013630: 2020 2020 2020 2020 6966 206c 656e 2874          if len(t
+00013640: 6f6b 656e 7329 206e 6f74 2069 6e20 2833  okens) not in (3
+00013650: 2c20 3729 3a0a 2020 2020 2020 2020 2020  , 7):.          
+00013660: 2020 7761 726e 2822 496e 636f 7272 6563    warn("Incorrec
+00013670: 7420 6e75 6d62 6572 206f 6620 746f 6b65  t number of toke
+00013680: 6e73 2069 6e20 6372 6974 6572 6961 2027  ns in criteria '
+00013690: 2573 2722 2025 2063 7269 7465 7269 6129  %s'" % criteria)
+000136a0: 0a0a 2020 2020 2020 2020 746f 6b65 6e73  ..        tokens
+000136b0: 203d 2073 656c 662e 5f70 6172 7365 5f66   = self._parse_f
+000136c0: 696c 7465 725f 6578 7072 6573 7369 6f6e  ilter_expression
+000136d0: 2863 7269 7465 7269 612c 2074 6f6b 656e  (criteria, token
+000136e0: 7329 0a0a 2020 2020 2020 2020 2320 4578  s)..        # Ex
+000136f0: 6365 6c20 6861 6e64 6c65 7320 7369 6e67  cel handles sing
+00013700: 6c65 206f 7220 646f 7562 6c65 2063 7573  le or double cus
+00013710: 746f 6d20 6669 6c74 6572 7320 6173 2064  tom filters as d
+00013720: 6566 6175 6c74 2066 696c 7465 7273 2e0a  efault filters..
+00013730: 2020 2020 2020 2020 2320 2057 6520 6e65          #  We ne
+00013740: 6564 2074 6f20 6368 6563 6b20 666f 7220  ed to check for 
+00013750: 7468 656d 2061 6e64 2068 616e 646c 6520  them and handle 
+00013760: 7468 656d 2061 6363 6f72 6469 6e67 6c79  them accordingly
+00013770: 2e0a 2020 2020 2020 2020 6966 206c 656e  ..        if len
+00013780: 2874 6f6b 656e 7329 203d 3d20 3220 616e  (tokens) == 2 an
+00013790: 6420 746f 6b65 6e73 5b30 5d20 3d3d 2032  d tokens[0] == 2
+000137a0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+000137b0: 5369 6e67 6c65 2065 7175 616c 6974 792e  Single equality.
+000137c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000137d0: 662e 6669 6c74 6572 5f63 6f6c 756d 6e5f  f.filter_column_
+000137e0: 6c69 7374 2863 6f6c 2c20 5b74 6f6b 656e  list(col, [token
+000137f0: 735b 315d 5d29 0a20 2020 2020 2020 2065  s[1]]).        e
+00013800: 6c69 6620 6c65 6e28 746f 6b65 6e73 2920  lif len(tokens) 
+00013810: 3d3d 2035 2061 6e64 2074 6f6b 656e 735b  == 5 and tokens[
+00013820: 305d 203d 3d20 3220 616e 6420 746f 6b65  0] == 2 and toke
+00013830: 6e73 5b32 5d20 3d3d 2031 2061 6e64 2074  ns[2] == 1 and t
+00013840: 6f6b 656e 735b 335d 203d 3d20 323a 0a20  okens[3] == 2:. 
+00013850: 2020 2020 2020 2020 2020 2023 2044 6f75             # Dou
+00013860: 626c 6520 6571 7561 6c69 7479 2077 6974  ble equality wit
+00013870: 6820 226f 7222 206f 7065 7261 746f 722e  h "or" operator.
+00013880: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00013890: 662e 6669 6c74 6572 5f63 6f6c 756d 6e5f  f.filter_column_
+000138a0: 6c69 7374 2863 6f6c 2c20 5b74 6f6b 656e  list(col, [token
+000138b0: 735b 315d 2c20 746f 6b65 6e73 5b34 5d5d  s[1], tokens[4]]
+000138c0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+000138d0: 2020 2020 2020 2020 2020 2020 2320 4e6f              # No
+000138e0: 6e20 6465 6661 756c 7420 6375 7374 6f6d  n default custom
+000138f0: 2066 696c 7465 722e 0a20 2020 2020 2020   filter..       
+00013900: 2020 2020 2073 656c 662e 6669 6c74 6572       self.filter
+00013910: 5f63 6f6c 735b 636f 6c5d 203d 2074 6f6b  _cols[col] = tok
+00013920: 656e 730a 2020 2020 2020 2020 2020 2020  ens.            
+00013930: 7365 6c66 2e66 696c 7465 725f 7479 7065  self.filter_type
+00013940: 5b63 6f6c 5d20 3d20 300a 0a20 2020 2020  [col] = 0..     
+00013950: 2020 2073 656c 662e 6669 6c74 6572 5f6f     self.filter_o
+00013960: 6e20 3d20 310a 0a20 2020 2064 6566 2066  n = 1..    def f
+00013970: 696c 7465 725f 636f 6c75 6d6e 5f6c 6973  ilter_column_lis
+00013980: 7428 7365 6c66 2c20 636f 6c2c 2066 696c  t(self, col, fil
+00013990: 7465 7273 293a 0a20 2020 2020 2020 2022  ters):.        "
+000139a0: 2222 0a20 2020 2020 2020 2053 6574 2074  "".        Set t
+000139b0: 6865 2063 6f6c 756d 6e20 6669 6c74 6572  he column filter
+000139c0: 2063 7269 7465 7269 6120 696e 2045 7863   criteria in Exc
+000139d0: 656c 2032 3030 3720 6c69 7374 2073 7479  el 2007 list sty
+000139e0: 6c65 2e0a 0a20 2020 2020 2020 2041 7267  le...        Arg
+000139f0: 733a 0a20 2020 2020 2020 2020 2020 2063  s:.            c
+00013a00: 6f6c 3a20 2020 2020 2046 696c 7465 7220  ol:      Filter 
+00013a10: 636f 6c75 6d6e 2028 7a65 726f 2d69 6e64  column (zero-ind
+00013a20: 6578 6564 292e 0a20 2020 2020 2020 2020  exed)..         
+00013a30: 2020 2066 696c 7465 7273 3a20 204c 6973     filters:  Lis
+00013a40: 7420 6f66 2066 696c 7465 7220 6372 6974  t of filter crit
+00013a50: 6572 6961 2074 6f20 6d61 7463 682e 0a0a  eria to match...
+00013a60: 2020 2020 2020 2020 5265 7475 726e 733a          Returns:
+00013a70: 0a20 2020 2020 2020 2020 2020 2020 4e6f  .             No
+00013a80: 7468 696e 672e 0a0a 2020 2020 2020 2020  thing...        
+00013a90: 2222 220a 2020 2020 2020 2020 6966 206e  """.        if n
+00013aa0: 6f74 2073 656c 662e 6175 746f 6669 6c74  ot self.autofilt
+00013ab0: 6572 5f61 7265 613a 0a20 2020 2020 2020  er_area:.       
+00013ac0: 2020 2020 2077 6172 6e28 224d 7573 7420       warn("Must 
+00013ad0: 6361 6c6c 2061 7574 6f66 696c 7465 7228  call autofilter(
+00013ae0: 2920 6265 666f 7265 2066 696c 7465 725f  ) before filter_
+00013af0: 636f 6c75 6d6e 2829 2229 0a20 2020 2020  column()").     
+00013b00: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
+00013b10: 2020 2020 2020 2023 2043 6865 636b 2066         # Check f
+00013b20: 6f72 2061 2063 6f6c 756d 6e20 7265 6665  or a column refe
+00013b30: 7265 6e63 6520 696e 2041 3120 6e6f 7461  rence in A1 nota
+00013b40: 7469 6f6e 2061 6e64 2073 7562 7374 6974  tion and substit
+00013b50: 7574 652e 0a20 2020 2020 2020 2074 7279  ute..        try
+00013b60: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
+00013b70: 7428 636f 6c29 0a20 2020 2020 2020 2065  t(col).        e
+00013b80: 7863 6570 7420 5661 6c75 6545 7272 6f72  xcept ValueError
+00013b90: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00013ba0: 436f 6e76 6572 7420 636f 6c20 7265 6620  Convert col ref 
+00013bb0: 746f 2061 2063 656c 6c20 7265 6620 616e  to a cell ref an
+00013bc0: 6420 7468 656e 2074 6f20 6120 636f 6c20  d then to a col 
+00013bd0: 6e75 6d62 6572 2e0a 2020 2020 2020 2020  number..        
+00013be0: 2020 2020 636f 6c5f 6c65 7474 6572 203d      col_letter =
+00013bf0: 2063 6f6c 0a20 2020 2020 2020 2020 2020   col.           
+00013c00: 2028 5f2c 2063 6f6c 2920 3d20 786c 5f63   (_, col) = xl_c
+00013c10: 656c 6c5f 746f 5f72 6f77 636f 6c28 636f  ell_to_rowcol(co
+00013c20: 6c20 2b20 2231 2229 0a0a 2020 2020 2020  l + "1")..      
+00013c30: 2020 2020 2020 6966 2063 6f6c 203e 3d20        if col >= 
+00013c40: 7365 6c66 2e78 6c73 5f63 6f6c 6d61 783a  self.xls_colmax:
+00013c50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013c60: 2077 6172 6e28 2249 6e76 616c 6964 2063   warn("Invalid c
+00013c70: 6f6c 756d 6e20 2725 7327 2220 2520 636f  olumn '%s'" % co
+00013c80: 6c5f 6c65 7474 6572 290a 2020 2020 2020  l_letter).      
+00013c90: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00013ca0: 0a0a 2020 2020 2020 2020 2863 6f6c 5f66  ..        (col_f
+00013cb0: 6972 7374 2c20 636f 6c5f 6c61 7374 2920  irst, col_last) 
+00013cc0: 3d20 7365 6c66 2e66 696c 7465 725f 7261  = self.filter_ra
+00013cd0: 6e67 650a 0a20 2020 2020 2020 2023 2052  nge..        # R
+00013ce0: 656a 6563 7420 636f 6c75 6d6e 2069 6620  eject column if 
+00013cf0: 6974 2069 7320 6f75 7473 6964 6520 6669  it is outside fi
+00013d00: 6c74 6572 2072 616e 6765 2e0a 2020 2020  lter range..    
+00013d10: 2020 2020 6966 2063 6f6c 203c 2063 6f6c      if col < col
+00013d20: 5f66 6972 7374 206f 7220 636f 6c20 3e20  _first or col > 
+00013d30: 636f 6c5f 6c61 7374 3a0a 2020 2020 2020  col_last:.      
+00013d40: 2020 2020 2020 7761 726e 280a 2020 2020        warn(.    
+00013d50: 2020 2020 2020 2020 2020 2020 2243 6f6c              "Col
+00013d60: 756d 6e20 2725 6427 206f 7574 7369 6465  umn '%d' outside
+00013d70: 2061 7574 6f66 696c 7465 7228 2920 636f   autofilter() co
+00013d80: 6c75 6d6e 2072 616e 6765 2022 0a20 2020  lumn range ".   
+00013d90: 2020 2020 2020 2020 2020 2020 2022 2825               "(%
+00013da0: 642c 2564 2922 2025 2028 636f 6c2c 2063  d,%d)" % (col, c
+00013db0: 6f6c 5f66 6972 7374 2c20 636f 6c5f 6c61  ol_first, col_la
+00013dc0: 7374 290a 2020 2020 2020 2020 2020 2020  st).            
+00013dd0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
+00013de0: 7475 726e 0a0a 2020 2020 2020 2020 7365  turn..        se
+00013df0: 6c66 2e66 696c 7465 725f 636f 6c73 5b63  lf.filter_cols[c
+00013e00: 6f6c 5d20 3d20 6669 6c74 6572 730a 2020  ol] = filters.  
+00013e10: 2020 2020 2020 7365 6c66 2e66 696c 7465        self.filte
+00013e20: 725f 7479 7065 5b63 6f6c 5d20 3d20 310a  r_type[col] = 1.
+00013e30: 2020 2020 2020 2020 7365 6c66 2e66 696c          self.fil
+00013e40: 7465 725f 6f6e 203d 2031 0a0a 2020 2020  ter_on = 1..    
+00013e50: 4063 6f6e 7665 7274 5f72 616e 6765 5f61  @convert_range_a
+00013e60: 7267 730a 2020 2020 6465 6620 6461 7461  rgs.    def data
+00013e70: 5f76 616c 6964 6174 696f 6e28 7365 6c66  _validation(self
+00013e80: 2c20 6669 7273 745f 726f 772c 2066 6972  , first_row, fir
+00013e90: 7374 5f63 6f6c 2c20 6c61 7374 5f72 6f77  st_col, last_row
+00013ea0: 2c20 6c61 7374 5f63 6f6c 2c20 6f70 7469  , last_col, opti
+00013eb0: 6f6e 733d 4e6f 6e65 293a 0a20 2020 2020  ons=None):.     
+00013ec0: 2020 2022 2222 0a20 2020 2020 2020 2041     """.        A
+00013ed0: 6464 2061 2064 6174 6120 7661 6c69 6461  dd a data valida
+00013ee0: 7469 6f6e 2074 6f20 6120 776f 726b 7368  tion to a worksh
+00013ef0: 6565 742e 0a0a 2020 2020 2020 2020 4172  eet...        Ar
+00013f00: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+00013f10: 6669 7273 745f 726f 773a 2020 2020 5468  first_row:    Th
+00013f20: 6520 6669 7273 7420 726f 7720 6f66 2074  e first row of t
+00013f30: 6865 2063 656c 6c20 7261 6e67 652e 2028  he cell range. (
+00013f40: 7a65 726f 2069 6e64 6578 6564 292e 0a20  zero indexed).. 
+00013f50: 2020 2020 2020 2020 2020 2066 6972 7374             first
+00013f60: 5f63 6f6c 3a20 2020 2054 6865 2066 6972  _col:    The fir
+00013f70: 7374 2063 6f6c 756d 6e20 6f66 2074 6865  st column of the
+00013f80: 2063 656c 6c20 7261 6e67 652e 0a20 2020   cell range..   
+00013f90: 2020 2020 2020 2020 206c 6173 745f 726f           last_ro
+00013fa0: 773a 2020 2020 2054 6865 206c 6173 7420  w:     The last 
+00013fb0: 726f 7720 6f66 2074 6865 2063 656c 6c20  row of the cell 
+00013fc0: 7261 6e67 652e 2028 7a65 726f 2069 6e64  range. (zero ind
+00013fd0: 6578 6564 292e 0a20 2020 2020 2020 2020  exed)..         
+00013fe0: 2020 206c 6173 745f 636f 6c3a 2020 2020     last_col:    
+00013ff0: 2054 6865 206c 6173 7420 636f 6c75 6d6e   The last column
+00014000: 206f 6620 7468 6520 6365 6c6c 2072 616e   of the cell ran
+00014010: 6765 2e0a 2020 2020 2020 2020 2020 2020  ge..            
+00014020: 6f70 7469 6f6e 733a 2020 2020 2020 4461  options:      Da
+00014030: 7461 2076 616c 6964 6174 696f 6e20 6f70  ta validation op
+00014040: 7469 6f6e 732e 0a0a 2020 2020 2020 2020  tions...        
+00014050: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
+00014060: 2020 2020 2030 3a20 2053 7563 6365 7373       0:  Success
+00014070: 2e0a 2020 2020 2020 2020 2020 2020 2d31  ..            -1
+00014080: 3a20 526f 7720 6f72 2063 6f6c 756d 6e20  : Row or column 
+00014090: 6973 206f 7574 206f 6620 776f 726b 7368  is out of worksh
+000140a0: 6565 7420 626f 756e 6473 2e0a 2020 2020  eet bounds..    
+000140b0: 2020 2020 2020 2020 2d32 3a20 496e 636f          -2: Inco
+000140c0: 7272 6563 7420 7061 7261 6d65 7465 7220  rrect parameter 
+000140d0: 6f72 206f 7074 696f 6e2e 0a20 2020 2020  or option..     
+000140e0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+000140f0: 2043 6865 636b 2074 6861 7420 726f 7720   Check that row 
+00014100: 616e 6420 636f 6c20 6172 6520 7661 6c69  and col are vali
+00014110: 6420 7769 7468 6f75 7420 7374 6f72 696e  d without storin
+00014120: 6720 7468 6520 7661 6c75 6573 2e0a 2020  g the values..  
+00014130: 2020 2020 2020 6966 2073 656c 662e 5f63        if self._c
+00014140: 6865 636b 5f64 696d 656e 7369 6f6e 7328  heck_dimensions(
+00014150: 6669 7273 745f 726f 772c 2066 6972 7374  first_row, first
+00014160: 5f63 6f6c 2c20 5472 7565 2c20 5472 7565  _col, True, True
+00014170: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00014180: 6574 7572 6e20 2d31 0a20 2020 2020 2020  eturn -1.       
+00014190: 2069 6620 7365 6c66 2e5f 6368 6563 6b5f   if self._check_
+000141a0: 6469 6d65 6e73 696f 6e73 286c 6173 745f  dimensions(last_
+000141b0: 726f 772c 206c 6173 745f 636f 6c2c 2054  row, last_col, T
+000141c0: 7275 652c 2054 7275 6529 3a0a 2020 2020  rue, True):.    
+000141d0: 2020 2020 2020 2020 7265 7475 726e 202d          return -
+000141e0: 310a 0a20 2020 2020 2020 2069 6620 6f70  1..        if op
+000141f0: 7469 6f6e 7320 6973 204e 6f6e 653a 0a20  tions is None:. 
+00014200: 2020 2020 2020 2020 2020 206f 7074 696f             optio
+00014210: 6e73 203d 207b 7d0a 2020 2020 2020 2020  ns = {}.        
+00014220: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00014230: 2020 2320 436f 7079 2074 6865 2075 7365    # Copy the use
+00014240: 7220 6465 6669 6e65 6420 6f70 7469 6f6e  r defined option
+00014250: 7320 736f 2074 6865 7920 6172 656e 2774  s so they aren't
+00014260: 206d 6f64 6966 6965 642e 0a20 2020 2020   modified..     
+00014270: 2020 2020 2020 206f 7074 696f 6e73 203d         options =
+00014280: 206f 7074 696f 6e73 2e63 6f70 7928 290a   options.copy().
+00014290: 0a20 2020 2020 2020 2023 2056 616c 6964  .        # Valid
+000142a0: 2069 6e70 7574 2070 6172 616d 6574 6572   input parameter
+000142b0: 732e 0a20 2020 2020 2020 2076 616c 6964  s..        valid
+000142c0: 5f70 6172 616d 6574 6572 7320 3d20 7b0a  _parameters = {.
+000142d0: 2020 2020 2020 2020 2020 2020 2276 616c              "val
+000142e0: 6964 6174 6522 2c0a 2020 2020 2020 2020  idate",.        
+000142f0: 2020 2020 2263 7269 7465 7269 6122 2c0a      "criteria",.
+00014300: 2020 2020 2020 2020 2020 2020 2276 616c              "val
+00014310: 7565 222c 0a20 2020 2020 2020 2020 2020  ue",.           
+00014320: 2022 736f 7572 6365 222c 0a20 2020 2020   "source",.     
+00014330: 2020 2020 2020 2022 6d69 6e69 6d75 6d22         "minimum"
+00014340: 2c0a 2020 2020 2020 2020 2020 2020 226d  ,.            "m
+00014350: 6178 696d 756d 222c 0a20 2020 2020 2020  aximum",.       
+00014360: 2020 2020 2022 6967 6e6f 7265 5f62 6c61       "ignore_bla
+00014370: 6e6b 222c 0a20 2020 2020 2020 2020 2020  nk",.           
+00014380: 2022 6472 6f70 646f 776e 222c 0a20 2020   "dropdown",.   
+00014390: 2020 2020 2020 2020 2022 7368 6f77 5f69           "show_i
+000143a0: 6e70 7574 222c 0a20 2020 2020 2020 2020  nput",.         
+000143b0: 2020 2022 696e 7075 745f 7469 746c 6522     "input_title"
+000143c0: 2c0a 2020 2020 2020 2020 2020 2020 2269  ,.            "i
+000143d0: 6e70 7574 5f6d 6573 7361 6765 222c 0a20  nput_message",. 
+000143e0: 2020 2020 2020 2020 2020 2022 7368 6f77             "show
+000143f0: 5f65 7272 6f72 222c 0a20 2020 2020 2020  _error",.       
+00014400: 2020 2020 2022 6572 726f 725f 7469 746c       "error_titl
+00014410: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+00014420: 2265 7272 6f72 5f6d 6573 7361 6765 222c  "error_message",
+00014430: 0a20 2020 2020 2020 2020 2020 2022 6572  .            "er
+00014440: 726f 725f 7479 7065 222c 0a20 2020 2020  ror_type",.     
+00014450: 2020 2020 2020 2022 6f74 6865 725f 6365         "other_ce
+00014460: 6c6c 7322 2c0a 2020 2020 2020 2020 2020  lls",.          
+00014470: 2020 226d 756c 7469 5f72 616e 6765 222c    "multi_range",
+00014480: 0a20 2020 2020 2020 207d 0a0a 2020 2020  .        }..    
+00014490: 2020 2020 2320 4368 6563 6b20 666f 7220      # Check for 
+000144a0: 7661 6c69 6420 696e 7075 7420 7061 7261  valid input para
+000144b0: 6d65 7465 7273 2e0a 2020 2020 2020 2020  meters..        
+000144c0: 666f 7220 7061 7261 6d5f 6b65 7920 696e  for param_key in
+000144d0: 206f 7074 696f 6e73 2e6b 6579 7328 293a   options.keys():
+000144e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000144f0: 7061 7261 6d5f 6b65 7920 6e6f 7420 696e  param_key not in
+00014500: 2076 616c 6964 5f70 6172 616d 6574 6572   valid_parameter
+00014510: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00014520: 2020 2077 6172 6e28 2255 6e6b 6e6f 776e     warn("Unknown
+00014530: 2070 6172 616d 6574 6572 2027 2573 2720   parameter '%s' 
+00014540: 696e 2064 6174 615f 7661 6c69 6461 7469  in data_validati
+00014550: 6f6e 2829 2220 2520 7061 7261 6d5f 6b65  on()" % param_ke
+00014560: 7929 0a20 2020 2020 2020 2020 2020 2020  y).             
+00014570: 2020 2072 6574 7572 6e20 2d32 0a0a 2020     return -2..  
+00014580: 2020 2020 2020 2320 4d61 7020 616c 7465        # Map alte
+00014590: 726e 6174 6976 6520 7061 7261 6d65 7465  rnative paramete
+000145a0: 7220 6e61 6d65 7320 2773 6f75 7263 6527  r names 'source'
+000145b0: 206f 7220 276d 696e 696d 756d 2720 746f   or 'minimum' to
+000145c0: 2027 7661 6c75 6527 2e0a 2020 2020 2020   'value'..      
+000145d0: 2020 6966 2022 736f 7572 6365 2220 696e    if "source" in
+000145e0: 206f 7074 696f 6e73 3a0a 2020 2020 2020   options:.      
+000145f0: 2020 2020 2020 6f70 7469 6f6e 735b 2276        options["v
+00014600: 616c 7565 225d 203d 206f 7074 696f 6e73  alue"] = options
+00014610: 5b22 736f 7572 6365 225d 0a20 2020 2020  ["source"].     
+00014620: 2020 2069 6620 226d 696e 696d 756d 2220     if "minimum" 
+00014630: 696e 206f 7074 696f 6e73 3a0a 2020 2020  in options:.    
+00014640: 2020 2020 2020 2020 6f70 7469 6f6e 735b          options[
+00014650: 2276 616c 7565 225d 203d 206f 7074 696f  "value"] = optio
+00014660: 6e73 5b22 6d69 6e69 6d75 6d22 5d0a 0a20  ns["minimum"].. 
+00014670: 2020 2020 2020 2023 2027 7661 6c69 6461         # 'valida
+00014680: 7465 2720 6973 2061 2072 6571 7569 7265  te' is a require
+00014690: 6420 7061 7261 6d65 7465 722e 0a20 2020  d parameter..   
+000146a0: 2020 2020 2069 6620 2276 616c 6964 6174       if "validat
+000146b0: 6522 206e 6f74 2069 6e20 6f70 7469 6f6e  e" not in option
+000146c0: 733a 0a20 2020 2020 2020 2020 2020 2077  s:.            w
+000146d0: 6172 6e28 2250 6172 616d 6574 6572 2027  arn("Parameter '
+000146e0: 7661 6c69 6461 7465 2720 6973 2072 6571  validate' is req
+000146f0: 7569 7265 6420 696e 2064 6174 615f 7661  uired in data_va
+00014700: 6c69 6461 7469 6f6e 2829 2229 0a20 2020  lidation()").   
+00014710: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00014720: 2d32 0a0a 2020 2020 2020 2020 2320 4c69  -2..        # Li
+00014730: 7374 206f 6620 2076 616c 6964 2076 616c  st of  valid val
+00014740: 6964 6174 696f 6e20 7479 7065 732e 0a20  idation types.. 
+00014750: 2020 2020 2020 2076 616c 6964 5f74 7970         valid_typ
+00014760: 6573 203d 207b 0a20 2020 2020 2020 2020  es = {.         
+00014770: 2020 2022 616e 7922 3a20 226e 6f6e 6522     "any": "none"
+00014780: 2c0a 2020 2020 2020 2020 2020 2020 2261  ,.            "a
+00014790: 6e79 2076 616c 7565 223a 2022 6e6f 6e65  ny value": "none
+000147a0: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
+000147b0: 7768 6f6c 6520 6e75 6d62 6572 223a 2022  whole number": "
+000147c0: 7768 6f6c 6522 2c0a 2020 2020 2020 2020  whole",.        
+000147d0: 2020 2020 2277 686f 6c65 223a 2022 7768      "whole": "wh
+000147e0: 6f6c 6522 2c0a 2020 2020 2020 2020 2020  ole",.          
+000147f0: 2020 2269 6e74 6567 6572 223a 2022 7768    "integer": "wh
+00014800: 6f6c 6522 2c0a 2020 2020 2020 2020 2020  ole",.          
+00014810: 2020 2264 6563 696d 616c 223a 2022 6465    "decimal": "de
+00014820: 6369 6d61 6c22 2c0a 2020 2020 2020 2020  cimal",.        
+00014830: 2020 2020 226c 6973 7422 3a20 226c 6973      "list": "lis
+00014840: 7422 2c0a 2020 2020 2020 2020 2020 2020  t",.            
+00014850: 2264 6174 6522 3a20 2264 6174 6522 2c0a  "date": "date",.
+00014860: 2020 2020 2020 2020 2020 2020 2274 696d              "tim
+00014870: 6522 3a20 2274 696d 6522 2c0a 2020 2020  e": "time",.    
+00014880: 2020 2020 2020 2020 2274 6578 7420 6c65          "text le
+00014890: 6e67 7468 223a 2022 7465 7874 4c65 6e67  ngth": "textLeng
+000148a0: 7468 222c 0a20 2020 2020 2020 2020 2020  th",.           
+000148b0: 2022 6c65 6e67 7468 223a 2022 7465 7874   "length": "text
+000148c0: 4c65 6e67 7468 222c 0a20 2020 2020 2020  Length",.       
+000148d0: 2020 2020 2022 6375 7374 6f6d 223a 2022       "custom": "
+000148e0: 6375 7374 6f6d 222c 0a20 2020 2020 2020  custom",.       
+000148f0: 207d 0a0a 2020 2020 2020 2020 2320 4368   }..        # Ch
+00014900: 6563 6b20 666f 7220 7661 6c69 6420 7661  eck for valid va
+00014910: 6c69 6461 7469 6f6e 2074 7970 6573 2e0a  lidation types..
+00014920: 2020 2020 2020 2020 6966 206f 7074 696f          if optio
+00014930: 6e73 5b22 7661 6c69 6461 7465 225d 206e  ns["validate"] n
+00014940: 6f74 2069 6e20 7661 6c69 645f 7479 7065  ot in valid_type
+00014950: 733a 0a20 2020 2020 2020 2020 2020 2077  s:.            w
+00014960: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
+00014970: 2020 2020 2022 556e 6b6e 6f77 6e20 7661       "Unknown va
+00014980: 6c69 6461 7469 6f6e 2074 7970 6520 2725  lidation type '%
+00014990: 7327 2066 6f72 2070 6172 616d 6574 6572  s' for parameter
+000149a0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+000149b0: 2020 2022 2776 616c 6964 6174 6527 2069     "'validate' i
+000149c0: 6e20 6461 7461 5f76 616c 6964 6174 696f  n data_validatio
+000149d0: 6e28 2922 2025 206f 7074 696f 6e73 5b22  n()" % options["
+000149e0: 7661 6c69 6461 7465 225d 0a20 2020 2020  validate"].     
+000149f0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00014a00: 2020 2020 2072 6574 7572 6e20 2d32 0a20       return -2. 
+00014a10: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00014a20: 2020 2020 2020 2020 206f 7074 696f 6e73           options
+00014a30: 5b22 7661 6c69 6461 7465 225d 203d 2076  ["validate"] = v
+00014a40: 616c 6964 5f74 7970 6573 5b6f 7074 696f  alid_types[optio
+00014a50: 6e73 5b22 7661 6c69 6461 7465 225d 5d0a  ns["validate"]].
+00014a60: 0a20 2020 2020 2020 2023 204e 6f20 6163  .        # No ac
+00014a70: 7469 6f6e 2069 7320 7265 7175 6972 6564  tion is required
+00014a80: 2066 6f72 2076 616c 6964 6174 696f 6e20   for validation 
+00014a90: 7479 7065 2027 616e 7927 2069 6620 7468  type 'any' if th
+00014aa0: 6572 6520 6172 6520 6e6f 0a20 2020 2020  ere are no.     
+00014ab0: 2020 2023 2069 6e70 7574 206d 6573 7361     # input messa
+00014ac0: 6765 7320 746f 2064 6973 706c 6179 2e0a  ges to display..
+00014ad0: 2020 2020 2020 2020 6966 2028 0a20 2020          if (.   
+00014ae0: 2020 2020 2020 2020 206f 7074 696f 6e73           options
+00014af0: 5b22 7661 6c69 6461 7465 225d 203d 3d20  ["validate"] == 
+00014b00: 226e 6f6e 6522 0a20 2020 2020 2020 2020  "none".         
+00014b10: 2020 2061 6e64 206f 7074 696f 6e73 2e67     and options.g
+00014b20: 6574 2822 696e 7075 745f 7469 746c 6522  et("input_title"
+00014b30: 2920 6973 204e 6f6e 650a 2020 2020 2020  ) is None.      
+00014b40: 2020 2020 2020 616e 6420 6f70 7469 6f6e        and option
+00014b50: 732e 6765 7428 2269 6e70 7574 5f6d 6573  s.get("input_mes
+00014b60: 7361 6765 2229 2069 7320 4e6f 6e65 0a20  sage") is None. 
+00014b70: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+00014b80: 2020 2020 2020 7265 7475 726e 202d 320a        return -2.
+00014b90: 0a20 2020 2020 2020 2023 2054 6865 2061  .        # The a
+00014ba0: 6e79 2c20 6c69 7374 2061 6e64 2063 7573  ny, list and cus
+00014bb0: 746f 6d20 7661 6c69 6461 7469 6f6e 7320  tom validations 
+00014bc0: 646f 6e27 7420 6861 7665 2061 2063 7269  don't have a cri
+00014bd0: 7465 7269 6120 736f 2077 6520 7573 650a  teria so we use.
+00014be0: 2020 2020 2020 2020 2320 6120 6465 6661          # a defa
+00014bf0: 756c 7420 6f66 2027 6265 7477 6565 6e27  ult of 'between'
+00014c00: 2e0a 2020 2020 2020 2020 6966 2028 0a20  ..        if (. 
+00014c10: 2020 2020 2020 2020 2020 206f 7074 696f             optio
+00014c20: 6e73 5b22 7661 6c69 6461 7465 225d 203d  ns["validate"] =
+00014c30: 3d20 226e 6f6e 6522 0a20 2020 2020 2020  = "none".       
+00014c40: 2020 2020 206f 7220 6f70 7469 6f6e 735b       or options[
+00014c50: 2276 616c 6964 6174 6522 5d20 3d3d 2022  "validate"] == "
+00014c60: 6c69 7374 220a 2020 2020 2020 2020 2020  list".          
+00014c70: 2020 6f72 206f 7074 696f 6e73 5b22 7661    or options["va
+00014c80: 6c69 6461 7465 225d 203d 3d20 2263 7573  lidate"] == "cus
+00014c90: 746f 6d22 0a20 2020 2020 2020 2029 3a0a  tom".        ):.
+00014ca0: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
+00014cb0: 6f6e 735b 2263 7269 7465 7269 6122 5d20  ons["criteria"] 
+00014cc0: 3d20 2262 6574 7765 656e 220a 2020 2020  = "between".    
+00014cd0: 2020 2020 2020 2020 6f70 7469 6f6e 735b          options[
+00014ce0: 226d 6178 696d 756d 225d 203d 204e 6f6e  "maximum"] = Non
+00014cf0: 650a 0a20 2020 2020 2020 2023 2027 6372  e..        # 'cr
+00014d00: 6974 6572 6961 2720 6973 2061 2072 6571  iteria' is a req
+00014d10: 7569 7265 6420 7061 7261 6d65 7465 722e  uired parameter.
+00014d20: 0a20 2020 2020 2020 2069 6620 2263 7269  .        if "cri
+00014d30: 7465 7269 6122 206e 6f74 2069 6e20 6f70  teria" not in op
+00014d40: 7469 6f6e 733a 0a20 2020 2020 2020 2020  tions:.         
+00014d50: 2020 2077 6172 6e28 2250 6172 616d 6574     warn("Paramet
+00014d60: 6572 2027 6372 6974 6572 6961 2720 6973  er 'criteria' is
+00014d70: 2072 6571 7569 7265 6420 696e 2064 6174   required in dat
+00014d80: 615f 7661 6c69 6461 7469 6f6e 2829 2229  a_validation()")
+00014d90: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00014da0: 7572 6e20 2d32 0a0a 2020 2020 2020 2020  urn -2..        
+00014db0: 2320 5661 6c69 6420 6372 6974 6572 6961  # Valid criteria
+00014dc0: 2074 7970 6573 2e0a 2020 2020 2020 2020   types..        
+00014dd0: 6372 6974 6572 6961 5f74 7970 6573 203d  criteria_types =
+00014de0: 207b 0a20 2020 2020 2020 2020 2020 2022   {.            "
+00014df0: 6265 7477 6565 6e22 3a20 2262 6574 7765  between": "betwe
+00014e00: 656e 222c 0a20 2020 2020 2020 2020 2020  en",.           
+00014e10: 2022 6e6f 7420 6265 7477 6565 6e22 3a20   "not between": 
+00014e20: 226e 6f74 4265 7477 6565 6e22 2c0a 2020  "notBetween",.  
+00014e30: 2020 2020 2020 2020 2020 2265 7175 616c            "equal
+00014e40: 2074 6f22 3a20 2265 7175 616c 222c 0a20   to": "equal",. 
+00014e50: 2020 2020 2020 2020 2020 2022 3d22 3a20             "=": 
+00014e60: 2265 7175 616c 222c 0a20 2020 2020 2020  "equal",.       
+00014e70: 2020 2020 2022 3d3d 223a 2022 6571 7561       "==": "equa
+00014e80: 6c22 2c0a 2020 2020 2020 2020 2020 2020  l",.            
+00014e90: 226e 6f74 2065 7175 616c 2074 6f22 3a20  "not equal to": 
+00014ea0: 226e 6f74 4571 7561 6c22 2c0a 2020 2020  "notEqual",.    
+00014eb0: 2020 2020 2020 2020 2221 3d22 3a20 226e          "!=": "n
+00014ec0: 6f74 4571 7561 6c22 2c0a 2020 2020 2020  otEqual",.      
+00014ed0: 2020 2020 2020 223c 3e22 3a20 226e 6f74        "<>": "not
+00014ee0: 4571 7561 6c22 2c0a 2020 2020 2020 2020  Equal",.        
+00014ef0: 2020 2020 2267 7265 6174 6572 2074 6861      "greater tha
+00014f00: 6e22 3a20 2267 7265 6174 6572 5468 616e  n": "greaterThan
+00014f10: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
+00014f20: 3e22 3a20 2267 7265 6174 6572 5468 616e  >": "greaterThan
+00014f30: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
+00014f40: 6c65 7373 2074 6861 6e22 3a20 226c 6573  less than": "les
+00014f50: 7354 6861 6e22 2c0a 2020 2020 2020 2020  sThan",.        
+00014f60: 2020 2020 223c 223a 2022 6c65 7373 5468      "<": "lessTh
+00014f70: 616e 222c 0a20 2020 2020 2020 2020 2020  an",.           
+00014f80: 2022 6772 6561 7465 7220 7468 616e 206f   "greater than o
+00014f90: 7220 6571 7561 6c20 746f 223a 2022 6772  r equal to": "gr
+00014fa0: 6561 7465 7254 6861 6e4f 7245 7175 616c  eaterThanOrEqual
+00014fb0: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
+00014fc0: 3e3d 223a 2022 6772 6561 7465 7254 6861  >=": "greaterTha
+00014fd0: 6e4f 7245 7175 616c 222c 0a20 2020 2020  nOrEqual",.     
+00014fe0: 2020 2020 2020 2022 6c65 7373 2074 6861         "less tha
+00014ff0: 6e20 6f72 2065 7175 616c 2074 6f22 3a20  n or equal to": 
+00015000: 226c 6573 7354 6861 6e4f 7245 7175 616c  "lessThanOrEqual
+00015010: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
+00015020: 3c3d 223a 2022 6c65 7373 5468 616e 4f72  <=": "lessThanOr
+00015030: 4571 7561 6c22 2c0a 2020 2020 2020 2020  Equal",.        
+00015040: 7d0a 0a20 2020 2020 2020 2023 2043 6865  }..        # Che
+00015050: 636b 2066 6f72 2076 616c 6964 2063 7269  ck for valid cri
+00015060: 7465 7269 6120 7479 7065 732e 0a20 2020  teria types..   
+00015070: 2020 2020 2069 6620 6f70 7469 6f6e 735b       if options[
+00015080: 2263 7269 7465 7269 6122 5d20 6e6f 7420  "criteria"] not 
+00015090: 696e 2063 7269 7465 7269 615f 7479 7065  in criteria_type
+000150a0: 733a 0a20 2020 2020 2020 2020 2020 2077  s:.            w
+000150b0: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
+000150c0: 2020 2020 2022 556e 6b6e 6f77 6e20 6372       "Unknown cr
+000150d0: 6974 6572 6961 2074 7970 6520 2725 7327  iteria type '%s'
+000150e0: 2066 6f72 2070 6172 616d 6574 6572 2022   for parameter "
+000150f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015100: 2022 2763 7269 7465 7269 6127 2069 6e20   "'criteria' in 
+00015110: 6461 7461 5f76 616c 6964 6174 696f 6e28  data_validation(
+00015120: 2922 2025 206f 7074 696f 6e73 5b22 6372  )" % options["cr
+00015130: 6974 6572 6961 225d 0a20 2020 2020 2020  iteria"].       
+00015140: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00015150: 2020 2072 6574 7572 6e20 2d32 0a20 2020     return -2.   
+00015160: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00015170: 2020 2020 2020 206f 7074 696f 6e73 5b22         options["
+00015180: 6372 6974 6572 6961 225d 203d 2063 7269  criteria"] = cri
+00015190: 7465 7269 615f 7479 7065 735b 6f70 7469  teria_types[opti
+000151a0: 6f6e 735b 2263 7269 7465 7269 6122 5d5d  ons["criteria"]]
+000151b0: 0a0a 2020 2020 2020 2020 2320 2742 6574  ..        # 'Bet
+000151c0: 7765 656e 2720 616e 6420 274e 6f74 2062  ween' and 'Not b
+000151d0: 6574 7765 656e 2720 6372 6974 6572 6961  etween' criteria
+000151e0: 2072 6571 7569 7265 2032 2076 616c 7565   require 2 value
+000151f0: 732e 0a20 2020 2020 2020 2069 6620 6f70  s..        if op
+00015200: 7469 6f6e 735b 2263 7269 7465 7269 6122  tions["criteria"
+00015210: 5d20 3d3d 2022 6265 7477 6565 6e22 206f  ] == "between" o
+00015220: 7220 6f70 7469 6f6e 735b 2263 7269 7465  r options["crite
+00015230: 7269 6122 5d20 3d3d 2022 6e6f 7442 6574  ria"] == "notBet
+00015240: 7765 656e 223a 0a20 2020 2020 2020 2020  ween":.         
+00015250: 2020 2069 6620 226d 6178 696d 756d 2220     if "maximum" 
+00015260: 6e6f 7420 696e 206f 7074 696f 6e73 3a0a  not in options:.
+00015270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015280: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
+00015290: 2020 2020 2020 2020 2020 2250 6172 616d            "Param
+000152a0: 6574 6572 2027 6d61 7869 6d75 6d27 2069  eter 'maximum' i
+000152b0: 7320 7265 7175 6972 6564 2069 6e20 6461  s required in da
+000152c0: 7461 5f76 616c 6964 6174 696f 6e28 2920  ta_validation() 
+000152d0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+000152e0: 2020 2020 2020 2277 6865 6e20 7573 696e        "when usin
+000152f0: 6720 2762 6574 7765 656e 2720 6f72 2027  g 'between' or '
+00015300: 6e6f 7420 6265 7477 6565 6e27 2063 7269  not between' cri
+00015310: 7465 7269 6122 0a20 2020 2020 2020 2020  teria".         
+00015320: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00015330: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00015340: 2d32 0a20 2020 2020 2020 2065 6c73 653a  -2.        else:
+00015350: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
+00015360: 696f 6e73 5b22 6d61 7869 6d75 6d22 5d20  ions["maximum"] 
+00015370: 3d20 4e6f 6e65 0a0a 2020 2020 2020 2020  = None..        
+00015380: 2320 5661 6c69 6420 6572 726f 7220 6469  # Valid error di
+00015390: 616c 6f67 2074 7970 6573 2e0a 2020 2020  alog types..    
+000153a0: 2020 2020 6572 726f 725f 7479 7065 7320      error_types 
+000153b0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+000153c0: 2273 746f 7022 3a20 302c 0a20 2020 2020  "stop": 0,.     
+000153d0: 2020 2020 2020 2022 7761 726e 696e 6722         "warning"
+000153e0: 3a20 312c 0a20 2020 2020 2020 2020 2020  : 1,.           
+000153f0: 2022 696e 666f 726d 6174 696f 6e22 3a20   "information": 
+00015400: 322c 0a20 2020 2020 2020 207d 0a0a 2020  2,.        }..  
+00015410: 2020 2020 2020 2320 4368 6563 6b20 666f        # Check fo
+00015420: 7220 7661 6c69 6420 6572 726f 7220 6469  r valid error di
+00015430: 616c 6f67 2074 7970 6573 2e0a 2020 2020  alog types..    
+00015440: 2020 2020 6966 2022 6572 726f 725f 7479      if "error_ty
+00015450: 7065 2220 6e6f 7420 696e 206f 7074 696f  pe" not in optio
+00015460: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+00015470: 6f70 7469 6f6e 735b 2265 7272 6f72 5f74  options["error_t
+00015480: 7970 6522 5d20 3d20 300a 2020 2020 2020  ype"] = 0.      
+00015490: 2020 656c 6966 206f 7074 696f 6e73 5b22    elif options["
+000154a0: 6572 726f 725f 7479 7065 225d 206e 6f74  error_type"] not
+000154b0: 2069 6e20 6572 726f 725f 7479 7065 733a   in error_types:
+000154c0: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
+000154d0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+000154e0: 2020 2022 556e 6b6e 6f77 6e20 6372 6974     "Unknown crit
+000154f0: 6572 6961 2074 7970 6520 2725 7327 2066  eria type '%s' f
+00015500: 6f72 2070 6172 616d 6574 6572 2027 6572  or parameter 'er
+00015510: 726f 725f 7479 7065 2720 220a 2020 2020  ror_type' ".    
+00015520: 2020 2020 2020 2020 2020 2020 2269 6e20              "in 
+00015530: 6461 7461 5f76 616c 6964 6174 696f 6e28  data_validation(
+00015540: 2922 2025 206f 7074 696f 6e73 5b22 6572  )" % options["er
+00015550: 726f 725f 7479 7065 225d 0a20 2020 2020  ror_type"].     
+00015560: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00015570: 2020 2020 2072 6574 7572 6e20 2d32 0a20       return -2. 
+00015580: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00015590: 2020 2020 2020 2020 206f 7074 696f 6e73           options
+000155a0: 5b22 6572 726f 725f 7479 7065 225d 203d  ["error_type"] =
+000155b0: 2065 7272 6f72 5f74 7970 6573 5b6f 7074   error_types[opt
+000155c0: 696f 6e73 5b22 6572 726f 725f 7479 7065  ions["error_type
+000155d0: 225d 5d0a 0a20 2020 2020 2020 2023 2043  "]]..        # C
+000155e0: 6f6e 7665 7274 2064 6174 652f 7469 6d65  onvert date/time
+000155f0: 7320 7661 6c75 6520 6966 2072 6571 7569  s value if requi
+00015600: 7265 642e 0a20 2020 2020 2020 2069 6620  red..        if 
+00015610: 6f70 7469 6f6e 735b 2276 616c 6964 6174  options["validat
+00015620: 6522 5d20 696e 2028 2264 6174 6522 2c20  e"] in ("date", 
+00015630: 2274 696d 6522 293a 0a20 2020 2020 2020  "time"):.       
+00015640: 2020 2020 2069 6620 6f70 7469 6f6e 735b       if options[
+00015650: 2276 616c 7565 225d 3a0a 2020 2020 2020  "value"]:.      
+00015660: 2020 2020 2020 2020 2020 6966 2073 7570            if sup
+00015670: 706f 7274 6564 5f64 6174 6574 696d 6528  ported_datetime(
+00015680: 6f70 7469 6f6e 735b 2276 616c 7565 225d  options["value"]
+00015690: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+000156a0: 2020 2020 2020 2064 6174 655f 7469 6d65         date_time
+000156b0: 203d 2073 656c 662e 5f63 6f6e 7665 7274   = self._convert
+000156c0: 5f64 6174 655f 7469 6d65 286f 7074 696f  _date_time(optio
+000156d0: 6e73 5b22 7661 6c75 6522 5d29 0a20 2020  ns["value"]).   
+000156e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000156f0: 2023 2046 6f72 6d61 7420 6461 7465 206e   # Format date n
+00015700: 756d 6265 7220 746f 2074 6865 2073 616d  umber to the sam
+00015710: 6520 7072 6563 6973 696f 6e20 6173 2045  e precision as E
+00015720: 7863 656c 2e0a 2020 2020 2020 2020 2020  xcel..          
+00015730: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
+00015740: 735b 2276 616c 7565 225d 203d 2022 252e  s["value"] = "%.
+00015750: 3136 6722 2025 2064 6174 655f 7469 6d65  16g" % date_time
+00015760: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00015770: 206f 7074 696f 6e73 5b22 6d61 7869 6d75   options["maximu
+00015780: 6d22 5d3a 0a20 2020 2020 2020 2020 2020  m"]:.           
+00015790: 2020 2020 2069 6620 7375 7070 6f72 7465       if supporte
+000157a0: 645f 6461 7465 7469 6d65 286f 7074 696f  d_datetime(optio
+000157b0: 6e73 5b22 6d61 7869 6d75 6d22 5d29 3a0a  ns["maximum"]):.
+000157c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000157d0: 2020 2020 6461 7465 5f74 696d 6520 3d20      date_time = 
+000157e0: 7365 6c66 2e5f 636f 6e76 6572 745f 6461  self._convert_da
+000157f0: 7465 5f74 696d 6528 6f70 7469 6f6e 735b  te_time(options[
+00015800: 226d 6178 696d 756d 225d 290a 2020 2020  "maximum"]).    
+00015810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015820: 6f70 7469 6f6e 735b 226d 6178 696d 756d  options["maximum
+00015830: 225d 203d 2022 252e 3136 6722 2025 2064  "] = "%.16g" % d
+00015840: 6174 655f 7469 6d65 0a0a 2020 2020 2020  ate_time..      
+00015850: 2020 2320 4368 6563 6b20 7468 6174 2074    # Check that t
+00015860: 6865 2069 6e70 7574 2074 6974 6c65 2064  he input title d
+00015870: 6f65 736e 2774 2065 7863 6565 6420 7468  oesn't exceed th
+00015880: 6520 6d61 7869 6d75 6d20 6c65 6e67 7468  e maximum length
+00015890: 2e0a 2020 2020 2020 2020 6966 206f 7074  ..        if opt
+000158a0: 696f 6e73 2e67 6574 2822 696e 7075 745f  ions.get("input_
+000158b0: 7469 746c 6522 2920 616e 6420 6c65 6e28  title") and len(
+000158c0: 6f70 7469 6f6e 735b 2269 6e70 7574 5f74  options["input_t
+000158d0: 6974 6c65 225d 2920 3e20 3332 3a0a 2020  itle"]) > 32:.  
+000158e0: 2020 2020 2020 2020 2020 7761 726e 280a            warn(.
+000158f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015900: 224c 656e 6774 6820 6f66 2069 6e70 7574  "Length of input
+00015910: 2074 6974 6c65 2027 2573 2720 6578 6365   title '%s' exce
+00015920: 6564 7320 4578 6365 6c27 7320 6c69 6d69  eds Excel's limi
+00015930: 7420 6f66 2033 3222 0a20 2020 2020 2020  t of 32".       
+00015940: 2020 2020 2020 2020 2025 206f 7074 696f           % optio
+00015950: 6e73 5b22 696e 7075 745f 7469 746c 6522  ns["input_title"
+00015960: 5d0a 2020 2020 2020 2020 2020 2020 290a  ].            ).
+00015970: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00015980: 726e 202d 320a 0a20 2020 2020 2020 2023  rn -2..        #
+00015990: 2043 6865 636b 2074 6861 7420 7468 6520   Check that the 
+000159a0: 6572 726f 7220 7469 746c 6520 646f 6573  error title does
+000159b0: 6e27 7420 6578 6365 6564 2074 6865 206d  n't exceed the m
+000159c0: 6178 696d 756d 206c 656e 6774 682e 0a20  aximum length.. 
+000159d0: 2020 2020 2020 2069 6620 6f70 7469 6f6e         if option
+000159e0: 732e 6765 7428 2265 7272 6f72 5f74 6974  s.get("error_tit
+000159f0: 6c65 2229 2061 6e64 206c 656e 286f 7074  le") and len(opt
+00015a00: 696f 6e73 5b22 6572 726f 725f 7469 746c  ions["error_titl
+00015a10: 6522 5d29 203e 2033 323a 0a20 2020 2020  e"]) > 32:.     
+00015a20: 2020 2020 2020 2077 6172 6e28 0a20 2020         warn(.   
+00015a30: 2020 2020 2020 2020 2020 2020 2022 4c65               "Le
+00015a40: 6e67 7468 206f 6620 6572 726f 7220 7469  ngth of error ti
+00015a50: 746c 6520 2725 7327 2065 7863 6565 6473  tle '%s' exceeds
+00015a60: 2045 7863 656c 2773 206c 696d 6974 206f   Excel's limit o
+00015a70: 6620 3332 220a 2020 2020 2020 2020 2020  f 32".          
+00015a80: 2020 2020 2020 2520 6f70 7469 6f6e 735b        % options[
+00015a90: 2265 7272 6f72 5f74 6974 6c65 225d 0a20  "error_title"]. 
+00015aa0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00015ab0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00015ac0: 2d32 0a0a 2020 2020 2020 2020 2320 4368  -2..        # Ch
+00015ad0: 6563 6b20 7468 6174 2074 6865 2069 6e70  eck that the inp
+00015ae0: 7574 206d 6573 7361 6765 2064 6f65 736e  ut message doesn
+00015af0: 2774 2065 7863 6565 6420 7468 6520 6d61  't exceed the ma
+00015b00: 7869 6d75 6d20 6c65 6e67 7468 2e0a 2020  ximum length..  
+00015b10: 2020 2020 2020 6966 206f 7074 696f 6e73        if options
+00015b20: 2e67 6574 2822 696e 7075 745f 6d65 7373  .get("input_mess
+00015b30: 6167 6522 2920 616e 6420 6c65 6e28 6f70  age") and len(op
+00015b40: 7469 6f6e 735b 2269 6e70 7574 5f6d 6573  tions["input_mes
+00015b50: 7361 6765 225d 2920 3e20 3235 353a 0a20  sage"]) > 255:. 
+00015b60: 2020 2020 2020 2020 2020 2077 6172 6e28             warn(
+00015b70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015b80: 2022 4c65 6e67 7468 206f 6620 696e 7075   "Length of inpu
+00015b90: 7420 6d65 7373 6167 6520 2725 7327 2065  t message '%s' e
+00015ba0: 7863 6565 6473 2045 7863 656c 2773 206c  xceeds Excel's l
+00015bb0: 696d 6974 206f 6620 3235 3522 0a20 2020  imit of 255".   
+00015bc0: 2020 2020 2020 2020 2020 2020 2025 206f               % o
+00015bd0: 7074 696f 6e73 5b22 696e 7075 745f 6d65  ptions["input_me
+00015be0: 7373 6167 6522 5d0a 2020 2020 2020 2020  ssage"].        
+00015bf0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00015c00: 2020 7265 7475 726e 202d 320a 0a20 2020    return -2..   
+00015c10: 2020 2020 2023 2043 6865 636b 2074 6861       # Check tha
+00015c20: 7420 7468 6520 6572 726f 7220 6d65 7373  t the error mess
+00015c30: 6167 6520 646f 6573 6e27 7420 6578 6365  age doesn't exce
+00015c40: 6564 2074 6865 206d 6178 696d 756d 206c  ed the maximum l
+00015c50: 656e 6774 682e 0a20 2020 2020 2020 2069  ength..        i
+00015c60: 6620 6f70 7469 6f6e 732e 6765 7428 2265  f options.get("e
+00015c70: 7272 6f72 5f6d 6573 7361 6765 2229 2061  rror_message") a
+00015c80: 6e64 206c 656e 286f 7074 696f 6e73 5b22  nd len(options["
+00015c90: 6572 726f 725f 6d65 7373 6167 6522 5d29  error_message"])
+00015ca0: 203e 2032 3535 3a0a 2020 2020 2020 2020   > 255:.        
+00015cb0: 2020 2020 7761 726e 280a 2020 2020 2020      warn(.      
+00015cc0: 2020 2020 2020 2020 2020 224c 656e 6774            "Lengt
+00015cd0: 6820 6f66 2065 7272 6f72 206d 6573 7361  h of error messa
+00015ce0: 6765 2027 2573 2720 6578 6365 6564 7320  ge '%s' exceeds 
+00015cf0: 4578 6365 6c27 7320 6c69 6d69 7420 6f66  Excel's limit of
+00015d00: 2032 3535 220a 2020 2020 2020 2020 2020   255".          
+00015d10: 2020 2020 2020 2520 6f70 7469 6f6e 735b        % options[
+00015d20: 2265 7272 6f72 5f6d 6573 7361 6765 225d  "error_message"]
+00015d30: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00015d40: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00015d50: 6e20 2d32 0a0a 2020 2020 2020 2020 2320  n -2..        # 
+00015d60: 4368 6563 6b20 7468 6174 2074 6865 2069  Check that the i
+00015d70: 6e70 7574 206c 6973 7420 646f 6573 6e27  nput list doesn'
+00015d80: 7420 6578 6365 6564 2074 6865 206d 6178  t exceed the max
+00015d90: 696d 756d 206c 656e 6774 682e 0a20 2020  imum length..   
+00015da0: 2020 2020 2069 6620 6f70 7469 6f6e 735b       if options[
+00015db0: 2276 616c 6964 6174 6522 5d20 3d3d 2022  "validate"] == "
+00015dc0: 6c69 7374 2220 616e 6420 7479 7065 286f  list" and type(o
+00015dd0: 7074 696f 6e73 5b22 7661 6c75 6522 5d29  ptions["value"])
+00015de0: 2069 7320 6c69 7374 3a0a 2020 2020 2020   is list:.      
+00015df0: 2020 2020 2020 666f 726d 756c 6120 3d20        formula = 
+00015e00: 7365 6c66 2e5f 6373 765f 6a6f 696e 282a  self._csv_join(*
+00015e10: 6f70 7469 6f6e 735b 2276 616c 7565 225d  options["value"]
+00015e20: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00015e30: 206c 656e 2866 6f72 6d75 6c61 2920 3e20   len(formula) > 
+00015e40: 3235 353a 0a20 2020 2020 2020 2020 2020  255:.           
+00015e50: 2020 2020 2077 6172 6e28 0a20 2020 2020       warn(.     
+00015e60: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00015e70: 4c65 6e67 7468 206f 6620 6c69 7374 2069  Length of list i
+00015e80: 7465 6d73 2027 2573 2720 6578 6365 6564  tems '%s' exceed
+00015e90: 7320 4578 6365 6c27 7320 6c69 6d69 7420  s Excel's limit 
+00015ea0: 6f66 2022 0a20 2020 2020 2020 2020 2020  of ".           
+00015eb0: 2020 2020 2020 2020 2022 3235 352c 2075           "255, u
+00015ec0: 7365 2061 2066 6f72 6d75 6c61 2072 616e  se a formula ran
+00015ed0: 6765 2069 6e73 7465 6164 2220 2520 666f  ge instead" % fo
+00015ee0: 726d 756c 610a 2020 2020 2020 2020 2020  rmula.          
+00015ef0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00015f00: 2020 2020 2020 2020 7265 7475 726e 202d          return -
+00015f10: 320a 0a20 2020 2020 2020 2023 2053 6574  2..        # Set
+00015f20: 2073 6f6d 6520 6465 6661 756c 7473 2069   some defaults i
+00015f30: 6620 7468 6579 2068 6176 656e 2774 2062  f they haven't b
+00015f40: 6565 6e20 6465 6669 6e65 6420 6279 2074  een defined by t
+00015f50: 6865 2075 7365 722e 0a20 2020 2020 2020  he user..       
+00015f60: 2069 6620 2269 676e 6f72 655f 626c 616e   if "ignore_blan
+00015f70: 6b22 206e 6f74 2069 6e20 6f70 7469 6f6e  k" not in option
+00015f80: 733a 0a20 2020 2020 2020 2020 2020 206f  s:.            o
+00015f90: 7074 696f 6e73 5b22 6967 6e6f 7265 5f62  ptions["ignore_b
+00015fa0: 6c61 6e6b 225d 203d 2031 0a20 2020 2020  lank"] = 1.     
+00015fb0: 2020 2069 6620 2264 726f 7064 6f77 6e22     if "dropdown"
+00015fc0: 206e 6f74 2069 6e20 6f70 7469 6f6e 733a   not in options:
+00015fd0: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
+00015fe0: 696f 6e73 5b22 6472 6f70 646f 776e 225d  ions["dropdown"]
+00015ff0: 203d 2031 0a20 2020 2020 2020 2069 6620   = 1.        if 
+00016000: 2273 686f 775f 696e 7075 7422 206e 6f74  "show_input" not
+00016010: 2069 6e20 6f70 7469 6f6e 733a 0a20 2020   in options:.   
+00016020: 2020 2020 2020 2020 206f 7074 696f 6e73           options
+00016030: 5b22 7368 6f77 5f69 6e70 7574 225d 203d  ["show_input"] =
+00016040: 2031 0a20 2020 2020 2020 2069 6620 2273   1.        if "s
+00016050: 686f 775f 6572 726f 7222 206e 6f74 2069  how_error" not i
+00016060: 6e20 6f70 7469 6f6e 733a 0a20 2020 2020  n options:.     
+00016070: 2020 2020 2020 206f 7074 696f 6e73 5b22         options["
+00016080: 7368 6f77 5f65 7272 6f72 225d 203d 2031  show_error"] = 1
+00016090: 0a0a 2020 2020 2020 2020 2320 5468 6573  ..        # Thes
+000160a0: 6520 6172 6520 7468 6520 6365 6c6c 7320  e are the cells 
+000160b0: 746f 2077 6869 6368 2074 6865 2076 616c  to which the val
+000160c0: 6964 6174 696f 6e20 6973 2061 7070 6c69  idation is appli
+000160d0: 6564 2e0a 2020 2020 2020 2020 6f70 7469  ed..        opti
+000160e0: 6f6e 735b 2263 656c 6c73 225d 203d 205b  ons["cells"] = [
+000160f0: 5b66 6972 7374 5f72 6f77 2c20 6669 7273  [first_row, firs
+00016100: 745f 636f 6c2c 206c 6173 745f 726f 772c  t_col, last_row,
+00016110: 206c 6173 745f 636f 6c5d 5d0a 0a20 2020   last_col]]..   
+00016120: 2020 2020 2023 2041 2028 666f 7220 6e6f       # A (for no
+00016130: 7729 2075 6e64 6f63 756d 656e 7465 6420  w) undocumented 
+00016140: 7061 7261 6d65 7465 7220 746f 2070 6173  parameter to pas
+00016150: 7320 6164 6469 7469 6f6e 616c 2063 656c  s additional cel
+00016160: 6c20 7261 6e67 6573 2e0a 2020 2020 2020  l ranges..      
+00016170: 2020 6966 2022 6f74 6865 725f 6365 6c6c    if "other_cell
+00016180: 7322 2069 6e20 6f70 7469 6f6e 733a 0a20  s" in options:. 
+00016190: 2020 2020 2020 2020 2020 206f 7074 696f             optio
+000161a0: 6e73 5b22 6365 6c6c 7322 5d2e 6578 7465  ns["cells"].exte
+000161b0: 6e64 286f 7074 696f 6e73 5b22 6f74 6865  nd(options["othe
+000161c0: 725f 6365 6c6c 7322 5d29 0a0a 2020 2020  r_cells"])..    
+000161d0: 2020 2020 2320 4f76 6572 7269 6465 2077      # Override w
+000161e0: 6974 6820 7573 6572 2064 6566 696e 6564  ith user defined
+000161f0: 206d 756c 7469 706c 6520 7261 6e67 6520   multiple range 
+00016200: 6966 2070 726f 7669 6465 642e 0a20 2020  if provided..   
+00016210: 2020 2020 2069 6620 226d 756c 7469 5f72       if "multi_r
+00016220: 616e 6765 2220 696e 206f 7074 696f 6e73  ange" in options
+00016230: 3a0a 2020 2020 2020 2020 2020 2020 6f70  :.            op
+00016240: 7469 6f6e 735b 226d 756c 7469 5f72 616e  tions["multi_ran
+00016250: 6765 225d 203d 206f 7074 696f 6e73 5b22  ge"] = options["
+00016260: 6d75 6c74 695f 7261 6e67 6522 5d2e 7265  multi_range"].re
+00016270: 706c 6163 6528 2224 222c 2022 2229 0a0a  place("$", "")..
+00016280: 2020 2020 2020 2020 2320 5374 6f72 6520          # Store 
+00016290: 7468 6520 7661 6c69 6461 7469 6f6e 2069  the validation i
+000162a0: 6e66 6f72 6d61 7469 6f6e 2075 6e74 696c  nformation until
+000162b0: 2077 6520 636c 6f73 6520 7468 6520 776f   we close the wo
+000162c0: 726b 7368 6565 742e 0a20 2020 2020 2020  rksheet..       
+000162d0: 2073 656c 662e 7661 6c69 6461 7469 6f6e   self.validation
+000162e0: 732e 6170 7065 6e64 286f 7074 696f 6e73  s.append(options
+000162f0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00016300: 6e20 300a 0a20 2020 2040 636f 6e76 6572  n 0..    @conver
+00016310: 745f 7261 6e67 655f 6172 6773 0a20 2020  t_range_args.   
+00016320: 2064 6566 2063 6f6e 6469 7469 6f6e 616c   def conditional
+00016330: 5f66 6f72 6d61 7428 0a20 2020 2020 2020  _format(.       
+00016340: 2073 656c 662c 2066 6972 7374 5f72 6f77   self, first_row
+00016350: 2c20 6669 7273 745f 636f 6c2c 206c 6173  , first_col, las
+00016360: 745f 726f 772c 206c 6173 745f 636f 6c2c  t_row, last_col,
+00016370: 206f 7074 696f 6e73 3d4e 6f6e 650a 2020   options=None.  
+00016380: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+00016390: 0a20 2020 2020 2020 2041 6464 2061 2063  .        Add a c
+000163a0: 6f6e 6469 7469 6f6e 616c 2066 6f72 6d61  onditional forma
+000163b0: 7420 746f 2061 2077 6f72 6b73 6865 6574  t to a worksheet
+000163c0: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
+000163d0: 0a20 2020 2020 2020 2020 2020 2066 6972  .            fir
+000163e0: 7374 5f72 6f77 3a20 2020 2054 6865 2066  st_row:    The f
+000163f0: 6972 7374 2072 6f77 206f 6620 7468 6520  irst row of the 
+00016400: 6365 6c6c 2072 616e 6765 2e20 287a 6572  cell range. (zer
+00016410: 6f20 696e 6465 7865 6429 2e0a 2020 2020  o indexed)..    
+00016420: 2020 2020 2020 2020 6669 7273 745f 636f          first_co
+00016430: 6c3a 2020 2020 5468 6520 6669 7273 7420  l:    The first 
+00016440: 636f 6c75 6d6e 206f 6620 7468 6520 6365  column of the ce
+00016450: 6c6c 2072 616e 6765 2e0a 2020 2020 2020  ll range..      
+00016460: 2020 2020 2020 6c61 7374 5f72 6f77 3a20        last_row: 
+00016470: 2020 2020 5468 6520 6c61 7374 2072 6f77      The last row
+00016480: 206f 6620 7468 6520 6365 6c6c 2072 616e   of the cell ran
+00016490: 6765 2e20 287a 6572 6f20 696e 6465 7865  ge. (zero indexe
+000164a0: 6429 2e0a 2020 2020 2020 2020 2020 2020  d)..            
+000164b0: 6c61 7374 5f63 6f6c 3a20 2020 2020 5468  last_col:     Th
+000164c0: 6520 6c61 7374 2063 6f6c 756d 6e20 6f66  e last column of
+000164d0: 2074 6865 2063 656c 6c20 7261 6e67 652e   the cell range.
+000164e0: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
+000164f0: 696f 6e73 3a20 2020 2020 2043 6f6e 6469  ions:      Condi
+00016500: 7469 6f6e 616c 2066 6f72 6d61 7420 6f70  tional format op
+00016510: 7469 6f6e 732e 0a0a 2020 2020 2020 2020  tions...        
+00016520: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
+00016530: 2020 2020 2030 3a20 2053 7563 6365 7373       0:  Success
+00016540: 2e0a 2020 2020 2020 2020 2020 2020 2d31  ..            -1
+00016550: 3a20 526f 7720 6f72 2063 6f6c 756d 6e20  : Row or column 
+00016560: 6973 206f 7574 206f 6620 776f 726b 7368  is out of worksh
+00016570: 6565 7420 626f 756e 6473 2e0a 2020 2020  eet bounds..    
+00016580: 2020 2020 2020 2020 2d32 3a20 496e 636f          -2: Inco
+00016590: 7272 6563 7420 7061 7261 6d65 7465 7220  rrect parameter 
+000165a0: 6f72 206f 7074 696f 6e2e 0a20 2020 2020  or option..     
+000165b0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+000165c0: 2043 6865 636b 2074 6861 7420 726f 7720   Check that row 
+000165d0: 616e 6420 636f 6c20 6172 6520 7661 6c69  and col are vali
+000165e0: 6420 7769 7468 6f75 7420 7374 6f72 696e  d without storin
+000165f0: 6720 7468 6520 7661 6c75 6573 2e0a 2020  g the values..  
+00016600: 2020 2020 2020 6966 2073 656c 662e 5f63        if self._c
+00016610: 6865 636b 5f64 696d 656e 7369 6f6e 7328  heck_dimensions(
+00016620: 6669 7273 745f 726f 772c 2066 6972 7374  first_row, first
+00016630: 5f63 6f6c 2c20 5472 7565 2c20 5472 7565  _col, True, True
+00016640: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00016650: 6574 7572 6e20 2d31 0a20 2020 2020 2020  eturn -1.       
+00016660: 2069 6620 7365 6c66 2e5f 6368 6563 6b5f   if self._check_
+00016670: 6469 6d65 6e73 696f 6e73 286c 6173 745f  dimensions(last_
+00016680: 726f 772c 206c 6173 745f 636f 6c2c 2054  row, last_col, T
+00016690: 7275 652c 2054 7275 6529 3a0a 2020 2020  rue, True):.    
+000166a0: 2020 2020 2020 2020 7265 7475 726e 202d          return -
+000166b0: 310a 0a20 2020 2020 2020 2069 6620 6f70  1..        if op
+000166c0: 7469 6f6e 7320 6973 204e 6f6e 653a 0a20  tions is None:. 
+000166d0: 2020 2020 2020 2020 2020 206f 7074 696f             optio
+000166e0: 6e73 203d 207b 7d0a 2020 2020 2020 2020  ns = {}.        
+000166f0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00016700: 2020 2320 436f 7079 2074 6865 2075 7365    # Copy the use
+00016710: 7220 6465 6669 6e65 6420 6f70 7469 6f6e  r defined option
+00016720: 7320 736f 2074 6865 7920 6172 656e 2774  s so they aren't
+00016730: 206d 6f64 6966 6965 642e 0a20 2020 2020   modified..     
+00016740: 2020 2020 2020 206f 7074 696f 6e73 203d         options =
+00016750: 206f 7074 696f 6e73 2e63 6f70 7928 290a   options.copy().
+00016760: 0a20 2020 2020 2020 2023 2056 616c 6964  .        # Valid
+00016770: 2069 6e70 7574 2070 6172 616d 6574 6572   input parameter
+00016780: 732e 0a20 2020 2020 2020 2076 616c 6964  s..        valid
+00016790: 5f70 6172 616d 6574 6572 203d 207b 0a20  _parameter = {. 
+000167a0: 2020 2020 2020 2020 2020 2022 7479 7065             "type
+000167b0: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
+000167c0: 666f 726d 6174 222c 0a20 2020 2020 2020  format",.       
+000167d0: 2020 2020 2022 6372 6974 6572 6961 222c       "criteria",
+000167e0: 0a20 2020 2020 2020 2020 2020 2022 7661  .            "va
+000167f0: 6c75 6522 2c0a 2020 2020 2020 2020 2020  lue",.          
+00016800: 2020 226d 696e 696d 756d 222c 0a20 2020    "minimum",.   
+00016810: 2020 2020 2020 2020 2022 6d61 7869 6d75           "maximu
+00016820: 6d22 2c0a 2020 2020 2020 2020 2020 2020  m",.            
+00016830: 2273 746f 705f 6966 5f74 7275 6522 2c0a  "stop_if_true",.
+00016840: 2020 2020 2020 2020 2020 2020 226d 696e              "min
+00016850: 5f74 7970 6522 2c0a 2020 2020 2020 2020  _type",.        
+00016860: 2020 2020 226d 6964 5f74 7970 6522 2c0a      "mid_type",.
+00016870: 2020 2020 2020 2020 2020 2020 226d 6178              "max
+00016880: 5f74 7970 6522 2c0a 2020 2020 2020 2020  _type",.        
+00016890: 2020 2020 226d 696e 5f76 616c 7565 222c      "min_value",
+000168a0: 0a20 2020 2020 2020 2020 2020 2022 6d69  .            "mi
+000168b0: 645f 7661 6c75 6522 2c0a 2020 2020 2020  d_value",.      
+000168c0: 2020 2020 2020 226d 6178 5f76 616c 7565        "max_value
+000168d0: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
+000168e0: 6d69 6e5f 636f 6c6f 7222 2c0a 2020 2020  min_color",.    
+000168f0: 2020 2020 2020 2020 226d 6964 5f63 6f6c          "mid_col
+00016900: 6f72 222c 0a20 2020 2020 2020 2020 2020  or",.           
+00016910: 2022 6d61 785f 636f 6c6f 7222 2c0a 2020   "max_color",.  
+00016920: 2020 2020 2020 2020 2020 226d 696e 5f6c            "min_l
+00016930: 656e 6774 6822 2c0a 2020 2020 2020 2020  ength",.        
+00016940: 2020 2020 226d 6178 5f6c 656e 6774 6822      "max_length"
+00016950: 2c0a 2020 2020 2020 2020 2020 2020 226d  ,.            "m
+00016960: 756c 7469 5f72 616e 6765 222c 0a20 2020  ulti_range",.   
+00016970: 2020 2020 2020 2020 2022 6261 725f 636f           "bar_co
+00016980: 6c6f 7222 2c0a 2020 2020 2020 2020 2020  lor",.          
+00016990: 2020 2262 6172 5f6e 6567 6174 6976 655f    "bar_negative_
+000169a0: 636f 6c6f 7222 2c0a 2020 2020 2020 2020  color",.        
+000169b0: 2020 2020 2262 6172 5f6e 6567 6174 6976      "bar_negativ
+000169c0: 655f 636f 6c6f 725f 7361 6d65 222c 0a20  e_color_same",. 
+000169d0: 2020 2020 2020 2020 2020 2022 6261 725f             "bar_
+000169e0: 736f 6c69 6422 2c0a 2020 2020 2020 2020  solid",.        
+000169f0: 2020 2020 2262 6172 5f62 6f72 6465 725f      "bar_border_
+00016a00: 636f 6c6f 7222 2c0a 2020 2020 2020 2020  color",.        
+00016a10: 2020 2020 2262 6172 5f6e 6567 6174 6976      "bar_negativ
+00016a20: 655f 626f 7264 6572 5f63 6f6c 6f72 222c  e_border_color",
+00016a30: 0a20 2020 2020 2020 2020 2020 2022 6261  .            "ba
+00016a40: 725f 6e65 6761 7469 7665 5f62 6f72 6465  r_negative_borde
+00016a50: 725f 636f 6c6f 725f 7361 6d65 222c 0a20  r_color_same",. 
+00016a60: 2020 2020 2020 2020 2020 2022 6261 725f             "bar_
+00016a70: 6e6f 5f62 6f72 6465 7222 2c0a 2020 2020  no_border",.    
+00016a80: 2020 2020 2020 2020 2262 6172 5f64 6972          "bar_dir
+00016a90: 6563 7469 6f6e 222c 0a20 2020 2020 2020  ection",.       
+00016aa0: 2020 2020 2022 6261 725f 6178 6973 5f70       "bar_axis_p
+00016ab0: 6f73 6974 696f 6e22 2c0a 2020 2020 2020  osition",.      
+00016ac0: 2020 2020 2020 2262 6172 5f61 7869 735f        "bar_axis_
+00016ad0: 636f 6c6f 7222 2c0a 2020 2020 2020 2020  color",.        
+00016ae0: 2020 2020 2262 6172 5f6f 6e6c 7922 2c0a      "bar_only",.
+00016af0: 2020 2020 2020 2020 2020 2020 2264 6174              "dat
+00016b00: 615f 6261 725f 3230 3130 222c 0a20 2020  a_bar_2010",.   
+00016b10: 2020 2020 2020 2020 2022 6963 6f6e 5f73           "icon_s
+00016b20: 7479 6c65 222c 0a20 2020 2020 2020 2020  tyle",.         
+00016b30: 2020 2022 7265 7665 7273 655f 6963 6f6e     "reverse_icon
+00016b40: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
+00016b50: 2269 636f 6e73 5f6f 6e6c 7922 2c0a 2020  "icons_only",.  
+00016b60: 2020 2020 2020 2020 2020 2269 636f 6e73            "icons
+00016b70: 222c 0a20 2020 2020 2020 207d 0a0a 2020  ",.        }..  
+00016b80: 2020 2020 2020 2320 4368 6563 6b20 666f        # Check fo
+00016b90: 7220 7661 6c69 6420 696e 7075 7420 7061  r valid input pa
+00016ba0: 7261 6d65 7465 7273 2e0a 2020 2020 2020  rameters..      
+00016bb0: 2020 666f 7220 7061 7261 6d5f 6b65 7920    for param_key 
+00016bc0: 696e 206f 7074 696f 6e73 2e6b 6579 7328  in options.keys(
+00016bd0: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+00016be0: 6620 7061 7261 6d5f 6b65 7920 6e6f 7420  f param_key not 
+00016bf0: 696e 2076 616c 6964 5f70 6172 616d 6574  in valid_paramet
+00016c00: 6572 3a0a 2020 2020 2020 2020 2020 2020  er:.            
+00016c10: 2020 2020 7761 726e 2822 556e 6b6e 6f77      warn("Unknow
+00016c20: 6e20 7061 7261 6d65 7465 7220 2725 7327  n parameter '%s'
+00016c30: 2069 6e20 636f 6e64 6974 696f 6e61 6c5f   in conditional_
+00016c40: 666f 726d 6174 2829 2220 2520 7061 7261  format()" % para
+00016c50: 6d5f 6b65 7929 0a20 2020 2020 2020 2020  m_key).         
+00016c60: 2020 2020 2020 2072 6574 7572 6e20 2d32         return -2
+00016c70: 0a0a 2020 2020 2020 2020 2320 2774 7970  ..        # 'typ
+00016c80: 6527 2069 7320 6120 7265 7175 6972 6564  e' is a required
+00016c90: 2070 6172 616d 6574 6572 2e0a 2020 2020   parameter..    
+00016ca0: 2020 2020 6966 2022 7479 7065 2220 6e6f      if "type" no
+00016cb0: 7420 696e 206f 7074 696f 6e73 3a0a 2020  t in options:.  
+00016cc0: 2020 2020 2020 2020 2020 7761 726e 2822            warn("
+00016cd0: 5061 7261 6d65 7465 7220 2774 7970 6527  Parameter 'type'
+00016ce0: 2069 7320 7265 7175 6972 6564 2069 6e20   is required in 
+00016cf0: 636f 6e64 6974 696f 6e61 6c5f 666f 726d  conditional_form
+00016d00: 6174 2829 2229 0a20 2020 2020 2020 2020  at()").         
+00016d10: 2020 2072 6574 7572 6e20 2d32 0a0a 2020     return -2..  
+00016d20: 2020 2020 2020 2320 5661 6c69 6420 7479        # Valid ty
+00016d30: 7065 732e 0a20 2020 2020 2020 2076 616c  pes..        val
+00016d40: 6964 5f74 7970 6520 3d20 7b0a 2020 2020  id_type = {.    
+00016d50: 2020 2020 2020 2020 2263 656c 6c22 3a20          "cell": 
+00016d60: 2263 656c 6c49 7322 2c0a 2020 2020 2020  "cellIs",.      
+00016d70: 2020 2020 2020 2264 6174 6522 3a20 2264        "date": "d
+00016d80: 6174 6522 2c0a 2020 2020 2020 2020 2020  ate",.          
+00016d90: 2020 2274 696d 6522 3a20 2274 696d 6522    "time": "time"
+00016da0: 2c0a 2020 2020 2020 2020 2020 2020 2261  ,.            "a
+00016db0: 7665 7261 6765 223a 2022 6162 6f76 6541  verage": "aboveA
+00016dc0: 7665 7261 6765 222c 0a20 2020 2020 2020  verage",.       
+00016dd0: 2020 2020 2022 6475 706c 6963 6174 6522       "duplicate"
+00016de0: 3a20 2264 7570 6c69 6361 7465 5661 6c75  : "duplicateValu
+00016df0: 6573 222c 0a20 2020 2020 2020 2020 2020  es",.           
+00016e00: 2022 756e 6971 7565 223a 2022 756e 6971   "unique": "uniq
+00016e10: 7565 5661 6c75 6573 222c 0a20 2020 2020  ueValues",.     
+00016e20: 2020 2020 2020 2022 746f 7022 3a20 2274         "top": "t
+00016e30: 6f70 3130 222c 0a20 2020 2020 2020 2020  op10",.         
+00016e40: 2020 2022 626f 7474 6f6d 223a 2022 746f     "bottom": "to
+00016e50: 7031 3022 2c0a 2020 2020 2020 2020 2020  p10",.          
+00016e60: 2020 2274 6578 7422 3a20 2274 6578 7422    "text": "text"
+00016e70: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+00016e80: 696d 655f 7065 7269 6f64 223a 2022 7469  ime_period": "ti
+00016e90: 6d65 5065 7269 6f64 222c 0a20 2020 2020  mePeriod",.     
+00016ea0: 2020 2020 2020 2022 626c 616e 6b73 223a         "blanks":
+00016eb0: 2022 636f 6e74 6169 6e73 426c 616e 6b73   "containsBlanks
+00016ec0: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
+00016ed0: 6e6f 5f62 6c61 6e6b 7322 3a20 226e 6f74  no_blanks": "not
+00016ee0: 436f 6e74 6169 6e73 426c 616e 6b73 222c  ContainsBlanks",
+00016ef0: 0a20 2020 2020 2020 2020 2020 2022 6572  .            "er
+00016f00: 726f 7273 223a 2022 636f 6e74 6169 6e73  rors": "contains
+00016f10: 4572 726f 7273 222c 0a20 2020 2020 2020  Errors",.       
+00016f20: 2020 2020 2022 6e6f 5f65 7272 6f72 7322       "no_errors"
+00016f30: 3a20 226e 6f74 436f 6e74 6169 6e73 4572  : "notContainsEr
+00016f40: 726f 7273 222c 0a20 2020 2020 2020 2020  rors",.         
+00016f50: 2020 2022 325f 636f 6c6f 725f 7363 616c     "2_color_scal
+00016f60: 6522 3a20 2232 5f63 6f6c 6f72 5f73 6361  e": "2_color_sca
+00016f70: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
+00016f80: 2022 335f 636f 6c6f 725f 7363 616c 6522   "3_color_scale"
+00016f90: 3a20 2233 5f63 6f6c 6f72 5f73 6361 6c65  : "3_color_scale
+00016fa0: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
+00016fb0: 6461 7461 5f62 6172 223a 2022 6461 7461  data_bar": "data
+00016fc0: 4261 7222 2c0a 2020 2020 2020 2020 2020  Bar",.          
+00016fd0: 2020 2266 6f72 6d75 6c61 223a 2022 6578    "formula": "ex
+00016fe0: 7072 6573 7369 6f6e 222c 0a20 2020 2020  pression",.     
+00016ff0: 2020 2020 2020 2022 6963 6f6e 5f73 6574         "icon_set
+00017000: 223a 2022 6963 6f6e 5365 7422 2c0a 2020  ": "iconSet",.  
+00017010: 2020 2020 2020 7d0a 0a20 2020 2020 2020        }..       
+00017020: 2023 2043 6865 636b 2066 6f72 2076 616c   # Check for val
+00017030: 6964 2074 7970 6573 2e0a 2020 2020 2020  id types..      
+00017040: 2020 6966 206f 7074 696f 6e73 5b22 7479    if options["ty
+00017050: 7065 225d 206e 6f74 2069 6e20 7661 6c69  pe"] not in vali
+00017060: 645f 7479 7065 3a0a 2020 2020 2020 2020  d_type:.        
+00017070: 2020 2020 7761 726e 280a 2020 2020 2020      warn(.      
+00017080: 2020 2020 2020 2020 2020 2255 6e6b 6e6f            "Unkno
+00017090: 776e 2076 616c 7565 2027 2573 2720 666f  wn value '%s' fo
+000170a0: 7220 7061 7261 6d65 7465 7220 2774 7970  r parameter 'typ
+000170b0: 6527 2022 0a20 2020 2020 2020 2020 2020  e' ".           
+000170c0: 2020 2020 2022 696e 2063 6f6e 6469 7469       "in conditi
+000170d0: 6f6e 616c 5f66 6f72 6d61 7428 2922 2025  onal_format()" %
+000170e0: 206f 7074 696f 6e73 5b22 7479 7065 225d   options["type"]
+000170f0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00017100: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00017110: 6e20 2d32 0a20 2020 2020 2020 2065 6c73  n -2.        els
+00017120: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
+00017130: 6620 6f70 7469 6f6e 735b 2274 7970 6522  f options["type"
+00017140: 5d20 3d3d 2022 626f 7474 6f6d 223a 0a20  ] == "bottom":. 
+00017150: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00017160: 7074 696f 6e73 5b22 6469 7265 6374 696f  ptions["directio
+00017170: 6e22 5d20 3d20 2262 6f74 746f 6d22 0a20  n"] = "bottom". 
+00017180: 2020 2020 2020 2020 2020 206f 7074 696f             optio
+00017190: 6e73 5b22 7479 7065 225d 203d 2076 616c  ns["type"] = val
+000171a0: 6964 5f74 7970 655b 6f70 7469 6f6e 735b  id_type[options[
+000171b0: 2274 7970 6522 5d5d 0a0a 2020 2020 2020  "type"]]..      
+000171c0: 2020 2320 5661 6c69 6420 6372 6974 6572    # Valid criter
+000171d0: 6961 2074 7970 6573 2e0a 2020 2020 2020  ia types..      
+000171e0: 2020 6372 6974 6572 6961 5f74 7970 6520    criteria_type 
+000171f0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00017200: 2262 6574 7765 656e 223a 2022 6265 7477  "between": "betw
+00017210: 6565 6e22 2c0a 2020 2020 2020 2020 2020  een",.          
+00017220: 2020 226e 6f74 2062 6574 7765 656e 223a    "not between":
+00017230: 2022 6e6f 7442 6574 7765 656e 222c 0a20   "notBetween",. 
+00017240: 2020 2020 2020 2020 2020 2022 6571 7561             "equa
+00017250: 6c20 746f 223a 2022 6571 7561 6c22 2c0a  l to": "equal",.
+00017260: 2020 2020 2020 2020 2020 2020 223d 223a              "=":
+00017270: 2022 6571 7561 6c22 2c0a 2020 2020 2020   "equal",.      
+00017280: 2020 2020 2020 223d 3d22 3a20 2265 7175        "==": "equ
+00017290: 616c 222c 0a20 2020 2020 2020 2020 2020  al",.           
+000172a0: 2022 6e6f 7420 6571 7561 6c20 746f 223a   "not equal to":
+000172b0: 2022 6e6f 7445 7175 616c 222c 0a20 2020   "notEqual",.   
+000172c0: 2020 2020 2020 2020 2022 213d 223a 2022           "!=": "
+000172d0: 6e6f 7445 7175 616c 222c 0a20 2020 2020  notEqual",.     
+000172e0: 2020 2020 2020 2022 3c3e 223a 2022 6e6f         "<>": "no
+000172f0: 7445 7175 616c 222c 0a20 2020 2020 2020  tEqual",.       
+00017300: 2020 2020 2022 6772 6561 7465 7220 7468       "greater th
+00017310: 616e 223a 2022 6772 6561 7465 7254 6861  an": "greaterTha
+00017320: 6e22 2c0a 2020 2020 2020 2020 2020 2020  n",.            
+00017330: 223e 223a 2022 6772 6561 7465 7254 6861  ">": "greaterTha
+00017340: 6e22 2c0a 2020 2020 2020 2020 2020 2020  n",.            
+00017350: 226c 6573 7320 7468 616e 223a 2022 6c65  "less than": "le
+00017360: 7373 5468 616e 222c 0a20 2020 2020 2020  ssThan",.       
+00017370: 2020 2020 2022 3c22 3a20 226c 6573 7354       "<": "lessT
+00017380: 6861 6e22 2c0a 2020 2020 2020 2020 2020  han",.          
+00017390: 2020 2267 7265 6174 6572 2074 6861 6e20    "greater than 
+000173a0: 6f72 2065 7175 616c 2074 6f22 3a20 2267  or equal to": "g
+000173b0: 7265 6174 6572 5468 616e 4f72 4571 7561  reaterThanOrEqua
+000173c0: 6c22 2c0a 2020 2020 2020 2020 2020 2020  l",.            
+000173d0: 223e 3d22 3a20 2267 7265 6174 6572 5468  ">=": "greaterTh
+000173e0: 616e 4f72 4571 7561 6c22 2c0a 2020 2020  anOrEqual",.    
+000173f0: 2020 2020 2020 2020 226c 6573 7320 7468          "less th
+00017400: 616e 206f 7220 6571 7561 6c20 746f 223a  an or equal to":
+00017410: 2022 6c65 7373 5468 616e 4f72 4571 7561   "lessThanOrEqua
+00017420: 6c22 2c0a 2020 2020 2020 2020 2020 2020  l",.            
+00017430: 223c 3d22 3a20 226c 6573 7354 6861 6e4f  "<=": "lessThanO
+00017440: 7245 7175 616c 222c 0a20 2020 2020 2020  rEqual",.       
+00017450: 2020 2020 2022 636f 6e74 6169 6e69 6e67       "containing
+00017460: 223a 2022 636f 6e74 6169 6e73 5465 7874  ": "containsText
+00017470: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
+00017480: 6e6f 7420 636f 6e74 6169 6e69 6e67 223a  not containing":
+00017490: 2022 6e6f 7443 6f6e 7461 696e 7322 2c0a   "notContains",.
+000174a0: 2020 2020 2020 2020 2020 2020 2262 6567              "beg
+000174b0: 696e 7320 7769 7468 223a 2022 6265 6769  ins with": "begi
+000174c0: 6e73 5769 7468 222c 0a20 2020 2020 2020  nsWith",.       
+000174d0: 2020 2020 2022 656e 6473 2077 6974 6822       "ends with"
+000174e0: 3a20 2265 6e64 7357 6974 6822 2c0a 2020  : "endsWith",.  
+000174f0: 2020 2020 2020 2020 2020 2279 6573 7465            "yeste
+00017500: 7264 6179 223a 2022 7965 7374 6572 6461  rday": "yesterda
+00017510: 7922 2c0a 2020 2020 2020 2020 2020 2020  y",.            
+00017520: 2274 6f64 6179 223a 2022 746f 6461 7922  "today": "today"
+00017530: 2c0a 2020 2020 2020 2020 2020 2020 226c  ,.            "l
+00017540: 6173 7420 3720 6461 7973 223a 2022 6c61  ast 7 days": "la
+00017550: 7374 3744 6179 7322 2c0a 2020 2020 2020  st7Days",.      
+00017560: 2020 2020 2020 226c 6173 7420 7765 656b        "last week
+00017570: 223a 2022 6c61 7374 5765 656b 222c 0a20  ": "lastWeek",. 
+00017580: 2020 2020 2020 2020 2020 2022 7468 6973             "this
+00017590: 2077 6565 6b22 3a20 2274 6869 7357 6565   week": "thisWee
+000175a0: 6b22 2c0a 2020 2020 2020 2020 2020 2020  k",.            
+000175b0: 226e 6578 7420 7765 656b 223a 2022 6e65  "next week": "ne
+000175c0: 7874 5765 656b 222c 0a20 2020 2020 2020  xtWeek",.       
+000175d0: 2020 2020 2022 6c61 7374 206d 6f6e 7468       "last month
+000175e0: 223a 2022 6c61 7374 4d6f 6e74 6822 2c0a  ": "lastMonth",.
+000175f0: 2020 2020 2020 2020 2020 2020 2274 6869              "thi
+00017600: 7320 6d6f 6e74 6822 3a20 2274 6869 734d  s month": "thisM
+00017610: 6f6e 7468 222c 0a20 2020 2020 2020 2020  onth",.         
+00017620: 2020 2022 6e65 7874 206d 6f6e 7468 223a     "next month":
+00017630: 2022 6e65 7874 4d6f 6e74 6822 2c0a 2020   "nextMonth",.  
+00017640: 2020 2020 2020 2020 2020 2320 466f 7220            # For 
+00017650: 6c65 6761 6379 2c20 6275 7420 696e 636f  legacy, but inco
+00017660: 7272 6563 742c 2073 7570 706f 7274 2e0a  rrect, support..
+00017670: 2020 2020 2020 2020 2020 2020 2263 6f6e              "con
+00017680: 7469 6e75 6520 7765 656b 223a 2022 6e65  tinue week": "ne
+00017690: 7874 5765 656b 222c 0a20 2020 2020 2020  xtWeek",.       
+000176a0: 2020 2020 2022 636f 6e74 696e 7565 206d       "continue m
+000176b0: 6f6e 7468 223a 2022 6e65 7874 4d6f 6e74  onth": "nextMont
+000176c0: 6822 2c0a 2020 2020 2020 2020 7d0a 0a20  h",.        }.. 
+000176d0: 2020 2020 2020 2023 2043 6865 636b 2066         # Check f
+000176e0: 6f72 2076 616c 6964 2063 7269 7465 7269  or valid criteri
+000176f0: 6120 7479 7065 732e 0a20 2020 2020 2020  a types..       
+00017700: 2069 6620 2263 7269 7465 7269 6122 2069   if "criteria" i
+00017710: 6e20 6f70 7469 6f6e 7320 616e 6420 6f70  n options and op
+00017720: 7469 6f6e 735b 2263 7269 7465 7269 6122  tions["criteria"
+00017730: 5d20 696e 2063 7269 7465 7269 615f 7479  ] in criteria_ty
+00017740: 7065 3a0a 2020 2020 2020 2020 2020 2020  pe:.            
+00017750: 6f70 7469 6f6e 735b 2263 7269 7465 7269  options["criteri
+00017760: 6122 5d20 3d20 6372 6974 6572 6961 5f74  a"] = criteria_t
+00017770: 7970 655b 6f70 7469 6f6e 735b 2263 7269  ype[options["cri
+00017780: 7465 7269 6122 5d5d 0a0a 2020 2020 2020  teria"]]..      
+00017790: 2020 2320 436f 6e76 6572 7420 6461 7465    # Convert date
+000177a0: 2f74 696d 6573 2076 616c 7565 2069 6620  /times value if 
+000177b0: 7265 7175 6972 6564 2e0a 2020 2020 2020  required..      
+000177c0: 2020 6966 206f 7074 696f 6e73 5b22 7479    if options["ty
+000177d0: 7065 225d 2069 6e20 2822 6461 7465 222c  pe"] in ("date",
+000177e0: 2022 7469 6d65 2229 3a0a 2020 2020 2020   "time"):.      
+000177f0: 2020 2020 2020 6f70 7469 6f6e 735b 2274        options["t
+00017800: 7970 6522 5d20 3d20 2263 656c 6c49 7322  ype"] = "cellIs"
+00017810: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00017820: 2022 7661 6c75 6522 2069 6e20 6f70 7469   "value" in opti
+00017830: 6f6e 733a 0a20 2020 2020 2020 2020 2020  ons:.           
+00017840: 2020 2020 2069 6620 6e6f 7420 7375 7070       if not supp
+00017850: 6f72 7465 645f 6461 7465 7469 6d65 286f  orted_datetime(o
+00017860: 7074 696f 6e73 5b22 7661 6c75 6522 5d29  ptions["value"])
+00017870: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00017880: 2020 2020 2020 7761 726e 2822 436f 6e64        warn("Cond
+00017890: 6974 696f 6e61 6c20 666f 726d 6174 2027  itional format '
+000178a0: 7661 6c75 6527 206d 7573 7420 6265 2061  value' must be a
+000178b0: 2022 2022 6461 7465 7469 6d65 206f 626a   " "datetime obj
+000178c0: 6563 742e 2229 0a20 2020 2020 2020 2020  ect.").         
+000178d0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000178e0: 6e20 2d32 0a20 2020 2020 2020 2020 2020  n -2.           
+000178f0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00017900: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00017910: 6174 655f 7469 6d65 203d 2073 656c 662e  ate_time = self.
+00017920: 5f63 6f6e 7665 7274 5f64 6174 655f 7469  _convert_date_ti
+00017930: 6d65 286f 7074 696f 6e73 5b22 7661 6c75  me(options["valu
+00017940: 6522 5d29 0a20 2020 2020 2020 2020 2020  e"]).           
+00017950: 2020 2020 2020 2020 2023 2046 6f72 6d61           # Forma
+00017960: 7420 6461 7465 206e 756d 6265 7220 746f  t date number to
+00017970: 2074 6865 2073 616d 6520 7072 6563 6973   the same precis
+00017980: 696f 6e20 6173 2045 7863 656c 2e0a 2020  ion as Excel..  
+00017990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000179a0: 2020 6f70 7469 6f6e 735b 2276 616c 7565    options["value
+000179b0: 225d 203d 2022 252e 3136 6722 2025 2064  "] = "%.16g" % d
+000179c0: 6174 655f 7469 6d65 0a0a 2020 2020 2020  ate_time..      
+000179d0: 2020 2020 2020 6966 2022 6d69 6e69 6d75        if "minimu
+000179e0: 6d22 2069 6e20 6f70 7469 6f6e 733a 0a20  m" in options:. 
+000179f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00017a00: 6620 6e6f 7420 7375 7070 6f72 7465 645f  f not supported_
+00017a10: 6461 7465 7469 6d65 286f 7074 696f 6e73  datetime(options
+00017a20: 5b22 6d69 6e69 6d75 6d22 5d29 3a0a 2020  ["minimum"]):.  
+00017a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017a40: 2020 7761 726e 2822 436f 6e64 6974 696f    warn("Conditio
+00017a50: 6e61 6c20 666f 726d 6174 2027 6d69 6e69  nal format 'mini
+00017a60: 6d75 6d27 206d 7573 7420 6265 2061 2022  mum' must be a "
+00017a70: 2022 6461 7465 7469 6d65 206f 626a 6563   "datetime objec
+00017a80: 742e 2229 0a20 2020 2020 2020 2020 2020  t.").           
+00017a90: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00017aa0: 2d32 0a20 2020 2020 2020 2020 2020 2020  -2.             
+00017ab0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00017ac0: 2020 2020 2020 2020 2020 2020 2064 6174               dat
+00017ad0: 655f 7469 6d65 203d 2073 656c 662e 5f63  e_time = self._c
+00017ae0: 6f6e 7665 7274 5f64 6174 655f 7469 6d65  onvert_date_time
+00017af0: 286f 7074 696f 6e73 5b22 6d69 6e69 6d75  (options["minimu
+00017b00: 6d22 5d29 0a20 2020 2020 2020 2020 2020  m"]).           
+00017b10: 2020 2020 2020 2020 206f 7074 696f 6e73           options
+00017b20: 5b22 6d69 6e69 6d75 6d22 5d20 3d20 2225  ["minimum"] = "%
+00017b30: 2e31 3667 2220 2520 6461 7465 5f74 696d  .16g" % date_tim
+00017b40: 650a 0a20 2020 2020 2020 2020 2020 2069  e..            i
+00017b50: 6620 226d 6178 696d 756d 2220 696e 206f  f "maximum" in o
+00017b60: 7074 696f 6e73 3a0a 2020 2020 2020 2020  ptions:.        
+00017b70: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+00017b80: 7570 706f 7274 6564 5f64 6174 6574 696d  upported_datetim
+00017b90: 6528 6f70 7469 6f6e 735b 226d 6178 696d  e(options["maxim
+00017ba0: 756d 225d 293a 0a20 2020 2020 2020 2020  um"]):.         
+00017bb0: 2020 2020 2020 2020 2020 2077 6172 6e28             warn(
+00017bc0: 2243 6f6e 6469 7469 6f6e 616c 2066 6f72  "Conditional for
+00017bd0: 6d61 7420 276d 6178 696d 756d 2720 6d75  mat 'maximum' mu
+00017be0: 7374 2062 6520 6120 2220 2264 6174 6574  st be a " "datet
+00017bf0: 696d 6520 6f62 6a65 6374 2e22 290a 2020  ime object.").  
+00017c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017c10: 2020 7265 7475 726e 202d 320a 2020 2020    return -2.    
+00017c20: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00017c30: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00017c40: 2020 2020 2020 6461 7465 5f74 696d 6520        date_time 
+00017c50: 3d20 7365 6c66 2e5f 636f 6e76 6572 745f  = self._convert_
+00017c60: 6461 7465 5f74 696d 6528 6f70 7469 6f6e  date_time(option
+00017c70: 735b 226d 6178 696d 756d 225d 290a 2020  s["maximum"]).  
+00017c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017c90: 2020 6f70 7469 6f6e 735b 226d 6178 696d    options["maxim
+00017ca0: 756d 225d 203d 2022 252e 3136 6722 2025  um"] = "%.16g" %
+00017cb0: 2064 6174 655f 7469 6d65 0a0a 2020 2020   date_time..    
+00017cc0: 2020 2020 2320 5661 6c69 6420 6963 6f6e      # Valid icon
+00017cd0: 2073 7479 6c65 732e 0a20 2020 2020 2020   styles..       
+00017ce0: 2076 616c 6964 5f69 636f 6e73 203d 207b   valid_icons = {
+00017cf0: 0a20 2020 2020 2020 2020 2020 2022 335f  .            "3_
+00017d00: 6172 726f 7773 223a 2022 3341 7272 6f77  arrows": "3Arrow
+00017d10: 7322 2c20 2023 2031 0a20 2020 2020 2020  s",  # 1.       
+00017d20: 2020 2020 2022 335f 666c 6167 7322 3a20       "3_flags": 
+00017d30: 2233 466c 6167 7322 2c20 2023 2032 0a20  "3Flags",  # 2. 
+00017d40: 2020 2020 2020 2020 2020 2022 335f 7472             "3_tr
+00017d50: 6166 6669 635f 6c69 6768 7473 5f72 696d  affic_lights_rim
+00017d60: 6d65 6422 3a20 2233 5472 6166 6669 634c  med": "3TrafficL
+00017d70: 6967 6874 7332 222c 2020 2320 330a 2020  ights2",  # 3.  
+00017d80: 2020 2020 2020 2020 2020 2233 5f73 796d            "3_sym
+00017d90: 626f 6c73 5f63 6972 636c 6564 223a 2022  bols_circled": "
+00017da0: 3353 796d 626f 6c73 222c 2020 2320 340a  3Symbols",  # 4.
+00017db0: 2020 2020 2020 2020 2020 2020 2234 5f61              "4_a
+00017dc0: 7272 6f77 7322 3a20 2234 4172 726f 7773  rrows": "4Arrows
+00017dd0: 222c 2020 2320 350a 2020 2020 2020 2020  ",  # 5.        
+00017de0: 2020 2020 2234 5f72 6564 5f74 6f5f 626c      "4_red_to_bl
+00017df0: 6163 6b22 3a20 2234 5265 6454 6f42 6c61  ack": "4RedToBla
+00017e00: 636b 222c 2020 2320 360a 2020 2020 2020  ck",  # 6.      
+00017e10: 2020 2020 2020 2234 5f74 7261 6666 6963        "4_traffic
+00017e20: 5f6c 6967 6874 7322 3a20 2234 5472 6166  _lights": "4Traf
+00017e30: 6669 634c 6967 6874 7322 2c20 2023 2037  ficLights",  # 7
+00017e40: 0a20 2020 2020 2020 2020 2020 2022 355f  .            "5_
+00017e50: 6172 726f 7773 5f67 7261 7922 3a20 2235  arrows_gray": "5
+00017e60: 4172 726f 7773 4772 6179 222c 2020 2320  ArrowsGray",  # 
+00017e70: 380a 2020 2020 2020 2020 2020 2020 2235  8.            "5
+00017e80: 5f71 7561 7274 6572 7322 3a20 2235 5175  _quarters": "5Qu
+00017e90: 6172 7465 7273 222c 2020 2320 390a 2020  arters",  # 9.  
+00017ea0: 2020 2020 2020 2020 2020 2233 5f61 7272            "3_arr
+00017eb0: 6f77 735f 6772 6179 223a 2022 3341 7272  ows_gray": "3Arr
+00017ec0: 6f77 7347 7261 7922 2c20 2023 2031 300a  owsGray",  # 10.
+00017ed0: 2020 2020 2020 2020 2020 2020 2233 5f74              "3_t
+00017ee0: 7261 6666 6963 5f6c 6967 6874 7322 3a20  raffic_lights": 
+00017ef0: 2233 5472 6166 6669 634c 6967 6874 7322  "3TrafficLights"
+00017f00: 2c20 2023 2031 310a 2020 2020 2020 2020  ,  # 11.        
+00017f10: 2020 2020 2233 5f73 6967 6e73 223a 2022      "3_signs": "
+00017f20: 3353 6967 6e73 222c 2020 2320 3132 0a20  3Signs",  # 12. 
+00017f30: 2020 2020 2020 2020 2020 2022 335f 7379             "3_sy
+00017f40: 6d62 6f6c 7322 3a20 2233 5379 6d62 6f6c  mbols": "3Symbol
+00017f50: 7332 222c 2020 2320 3133 0a20 2020 2020  s2",  # 13.     
+00017f60: 2020 2020 2020 2022 345f 6172 726f 7773         "4_arrows
+00017f70: 5f67 7261 7922 3a20 2234 4172 726f 7773  _gray": "4Arrows
+00017f80: 4772 6179 222c 2020 2320 3134 0a20 2020  Gray",  # 14.   
+00017f90: 2020 2020 2020 2020 2022 345f 7261 7469           "4_rati
+00017fa0: 6e67 7322 3a20 2234 5261 7469 6e67 222c  ngs": "4Rating",
+00017fb0: 2020 2320 3135 0a20 2020 2020 2020 2020    # 15.         
+00017fc0: 2020 2022 355f 6172 726f 7773 223a 2022     "5_arrows": "
+00017fd0: 3541 7272 6f77 7322 2c20 2023 2031 360a  5Arrows",  # 16.
+00017fe0: 2020 2020 2020 2020 2020 2020 2235 5f72              "5_r
+00017ff0: 6174 696e 6773 223a 2022 3552 6174 696e  atings": "5Ratin
+00018000: 6722 2c0a 2020 2020 2020 2020 7d20 2023  g",.        }  #
+00018010: 2031 370a 0a20 2020 2020 2020 2023 2053   17..        # S
+00018020: 6574 2074 6865 2069 636f 6e20 7365 7420  et the icon set 
+00018030: 7072 6f70 6572 7469 6573 2e0a 2020 2020  properties..    
+00018040: 2020 2020 6966 206f 7074 696f 6e73 5b22      if options["
+00018050: 7479 7065 225d 203d 3d20 2269 636f 6e53  type"] == "iconS
+00018060: 6574 223a 0a20 2020 2020 2020 2020 2020  et":.           
+00018070: 2023 2041 6e20 6963 6f6e 5f73 6574 206d   # An icon_set m
+00018080: 7573 7420 6861 7665 2061 6e20 6963 6f6e  ust have an icon
+00018090: 2073 7479 6c65 2e0a 2020 2020 2020 2020   style..        
+000180a0: 2020 2020 6966 206e 6f74 206f 7074 696f      if not optio
+000180b0: 6e73 2e67 6574 2822 6963 6f6e 5f73 7479  ns.get("icon_sty
+000180c0: 6c65 2229 3a0a 2020 2020 2020 2020 2020  le"):.          
+000180d0: 2020 2020 2020 7761 726e 280a 2020 2020        warn(.    
+000180e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000180f0: 2254 6865 2027 6963 6f6e 5f73 7479 6c65  "The 'icon_style
+00018100: 2720 7061 7261 6d65 7465 7220 6d75 7374  ' parameter must
+00018110: 2062 6520 7370 6563 6966 6965 6420 7768   be specified wh
+00018120: 656e 2022 0a20 2020 2020 2020 2020 2020  en ".           
+00018130: 2020 2020 2020 2020 2022 2774 7970 6527           "'type'
+00018140: 203d 3d20 2769 636f 6e5f 7365 7427 2069   == 'icon_set' i
+00018150: 6e20 636f 6e64 6974 696f 6e61 6c5f 666f  n conditional_fo
+00018160: 726d 6174 2829 220a 2020 2020 2020 2020  rmat()".        
+00018170: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00018180: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00018190: 202d 330a 0a20 2020 2020 2020 2020 2020   -3..           
+000181a0: 2023 2043 6865 636b 2066 6f72 2076 616c   # Check for val
+000181b0: 6964 2069 636f 6e20 7374 796c 6573 2e0a  id icon styles..
+000181c0: 2020 2020 2020 2020 2020 2020 6966 206f              if o
+000181d0: 7074 696f 6e73 5b22 6963 6f6e 5f73 7479  ptions["icon_sty
+000181e0: 6c65 225d 206e 6f74 2069 6e20 7661 6c69  le"] not in vali
+000181f0: 645f 6963 6f6e 733a 0a20 2020 2020 2020  d_icons:.       
+00018200: 2020 2020 2020 2020 2077 6172 6e28 0a20           warn(. 
+00018210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018220: 2020 2022 556e 6b6e 6f77 6e20 6963 6f6e     "Unknown icon
+00018230: 5f73 7479 6c65 2027 2573 2720 696e 2063  _style '%s' in c
+00018240: 6f6e 6469 7469 6f6e 616c 5f66 6f72 6d61  onditional_forma
+00018250: 7428 2922 0a20 2020 2020 2020 2020 2020  t()".           
+00018260: 2020 2020 2020 2020 2025 206f 7074 696f           % optio
+00018270: 6e73 5b22 6963 6f6e 5f73 7479 6c65 225d  ns["icon_style"]
+00018280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018290: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+000182a0: 2020 2072 6574 7572 6e20 2d32 0a20 2020     return -2.   
+000182b0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+000182c0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+000182d0: 7074 696f 6e73 5b22 6963 6f6e 5f73 7479  ptions["icon_sty
+000182e0: 6c65 225d 203d 2076 616c 6964 5f69 636f  le"] = valid_ico
+000182f0: 6e73 5b6f 7074 696f 6e73 5b22 6963 6f6e  ns[options["icon
+00018300: 5f73 7479 6c65 225d 5d0a 0a20 2020 2020  _style"]]..     
+00018310: 2020 2020 2020 2023 2053 6574 2074 6865         # Set the
+00018320: 206e 756d 6265 7220 6f66 2069 636f 6e73   number of icons
+00018330: 2066 6f72 2074 6865 2069 636f 6e20 7374   for the icon st
+00018340: 796c 652e 0a20 2020 2020 2020 2020 2020  yle..           
+00018350: 206f 7074 696f 6e73 5b22 746f 7461 6c5f   options["total_
+00018360: 6963 6f6e 7322 5d20 3d20 330a 2020 2020  icons"] = 3.    
+00018370: 2020 2020 2020 2020 6966 206f 7074 696f          if optio
+00018380: 6e73 5b22 6963 6f6e 5f73 7479 6c65 225d  ns["icon_style"]
+00018390: 2e73 7461 7274 7377 6974 6828 2234 2229  .startswith("4")
+000183a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000183b0: 2020 6f70 7469 6f6e 735b 2274 6f74 616c    options["total
+000183c0: 5f69 636f 6e73 225d 203d 2034 0a20 2020  _icons"] = 4.   
+000183d0: 2020 2020 2020 2020 2065 6c69 6620 6f70           elif op
+000183e0: 7469 6f6e 735b 2269 636f 6e5f 7374 796c  tions["icon_styl
+000183f0: 6522 5d2e 7374 6172 7473 7769 7468 2822  e"].startswith("
+00018400: 3522 293a 0a20 2020 2020 2020 2020 2020  5"):.           
+00018410: 2020 2020 206f 7074 696f 6e73 5b22 746f       options["to
+00018420: 7461 6c5f 6963 6f6e 7322 5d20 3d20 350a  tal_icons"] = 5.
+00018430: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
+00018440: 696f 6e73 5b22 6963 6f6e 7322 5d20 3d20  ions["icons"] = 
+00018450: 7365 6c66 2e5f 7365 745f 6963 6f6e 5f70  self._set_icon_p
+00018460: 726f 7073 280a 2020 2020 2020 2020 2020  rops(.          
+00018470: 2020 2020 2020 6f70 7469 6f6e 732e 6765        options.ge
+00018480: 7428 2274 6f74 616c 5f69 636f 6e73 2229  t("total_icons")
+00018490: 2c20 6f70 7469 6f6e 732e 6765 7428 2269  , options.get("i
+000184a0: 636f 6e73 2229 0a20 2020 2020 2020 2020  cons").         
+000184b0: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
+000184c0: 5377 6170 206c 6173 7420 726f 772f 636f  Swap last row/co
+000184d0: 6c20 666f 7220 6669 7273 7420 726f 772f  l for first row/
+000184e0: 636f 6c20 6173 206e 6563 6573 7361 7279  col as necessary
+000184f0: 0a20 2020 2020 2020 2069 6620 6669 7273  .        if firs
+00018500: 745f 726f 7720 3e20 6c61 7374 5f72 6f77  t_row > last_row
+00018510: 3a0a 2020 2020 2020 2020 2020 2020 6669  :.            fi
+00018520: 7273 745f 726f 772c 206c 6173 745f 726f  rst_row, last_ro
+00018530: 7720 3d20 6c61 7374 5f72 6f77 2c20 6669  w = last_row, fi
+00018540: 7273 745f 726f 770a 0a20 2020 2020 2020  rst_row..       
+00018550: 2069 6620 6669 7273 745f 636f 6c20 3e20   if first_col > 
+00018560: 6c61 7374 5f63 6f6c 3a0a 2020 2020 2020  last_col:.      
+00018570: 2020 2020 2020 6669 7273 745f 636f 6c2c        first_col,
+00018580: 206c 6173 745f 636f 6c20 3d20 6c61 7374   last_col = last
+00018590: 5f63 6f6c 2c20 6669 7273 745f 636f 6c0a  _col, first_col.
+000185a0: 0a20 2020 2020 2020 2023 2053 6574 2074  .        # Set t
+000185b0: 6865 2066 6f72 6d61 7474 696e 6720 7261  he formatting ra
+000185c0: 6e67 652e 0a20 2020 2020 2020 2063 656c  nge..        cel
+000185d0: 6c5f 7261 6e67 6520 3d20 786c 5f72 616e  l_range = xl_ran
+000185e0: 6765 2866 6972 7374 5f72 6f77 2c20 6669  ge(first_row, fi
+000185f0: 7273 745f 636f 6c2c 206c 6173 745f 726f  rst_col, last_ro
+00018600: 772c 206c 6173 745f 636f 6c29 0a20 2020  w, last_col).   
+00018610: 2020 2020 2073 7461 7274 5f63 656c 6c20       start_cell 
+00018620: 3d20 786c 5f72 6f77 636f 6c5f 746f 5f63  = xl_rowcol_to_c
+00018630: 656c 6c28 6669 7273 745f 726f 772c 2066  ell(first_row, f
+00018640: 6972 7374 5f63 6f6c 290a 0a20 2020 2020  irst_col)..     
+00018650: 2020 2023 204f 7665 7272 6964 6520 7769     # Override wi
+00018660: 7468 2075 7365 7220 6465 6669 6e65 6420  th user defined 
+00018670: 6d75 6c74 6970 6c65 2072 616e 6765 2069  multiple range i
+00018680: 6620 7072 6f76 6964 6564 2e0a 2020 2020  f provided..    
+00018690: 2020 2020 6966 2022 6d75 6c74 695f 7261      if "multi_ra
+000186a0: 6e67 6522 2069 6e20 6f70 7469 6f6e 733a  nge" in options:
+000186b0: 0a20 2020 2020 2020 2020 2020 2063 656c  .            cel
+000186c0: 6c5f 7261 6e67 6520 3d20 6f70 7469 6f6e  l_range = option
+000186d0: 735b 226d 756c 7469 5f72 616e 6765 225d  s["multi_range"]
+000186e0: 0a20 2020 2020 2020 2020 2020 2063 656c  .            cel
+000186f0: 6c5f 7261 6e67 6520 3d20 6365 6c6c 5f72  l_range = cell_r
+00018700: 616e 6765 2e72 6570 6c61 6365 2822 2422  ange.replace("$"
+00018710: 2c20 2222 290a 0a20 2020 2020 2020 2023  , "")..        #
+00018720: 2047 6574 2074 6865 2064 7866 2066 6f72   Get the dxf for
+00018730: 6d61 7420 696e 6465 782e 0a20 2020 2020  mat index..     
+00018740: 2020 2069 6620 2266 6f72 6d61 7422 2069     if "format" i
+00018750: 6e20 6f70 7469 6f6e 7320 616e 6420 6f70  n options and op
+00018760: 7469 6f6e 735b 2266 6f72 6d61 7422 5d3a  tions["format"]:
+00018770: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
+00018780: 696f 6e73 5b22 666f 726d 6174 225d 203d  ions["format"] =
+00018790: 206f 7074 696f 6e73 5b22 666f 726d 6174   options["format
+000187a0: 225d 2e5f 6765 745f 6478 665f 696e 6465  "]._get_dxf_inde
+000187b0: 7828 290a 0a20 2020 2020 2020 2023 2053  x()..        # S
+000187c0: 6574 2074 6865 2070 7269 6f72 6974 7920  et the priority 
+000187d0: 6261 7365 6420 6f6e 2074 6865 206f 7264  based on the ord
+000187e0: 6572 206f 6620 6164 6469 6e67 2e0a 2020  er of adding..  
+000187f0: 2020 2020 2020 6f70 7469 6f6e 735b 2270        options["p
+00018800: 7269 6f72 6974 7922 5d20 3d20 7365 6c66  riority"] = self
+00018810: 2e64 7866 5f70 7269 6f72 6974 790a 2020  .dxf_priority.  
+00018820: 2020 2020 2020 7365 6c66 2e64 7866 5f70        self.dxf_p
+00018830: 7269 6f72 6974 7920 2b3d 2031 0a0a 2020  riority += 1..  
+00018840: 2020 2020 2020 2320 4368 6563 6b20 666f        # Check fo
+00018850: 7220 3230 3130 2073 7479 6c65 2064 6174  r 2010 style dat
+00018860: 615f 6261 7220 7061 7261 6d65 7465 7273  a_bar parameters
+00018870: 2e0a 2020 2020 2020 2020 6966 2028 0a20  ..        if (. 
+00018880: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00018890: 7573 655f 6461 7461 5f62 6172 735f 3230  use_data_bars_20
+000188a0: 3130 0a20 2020 2020 2020 2020 2020 206f  10.            o
+000188b0: 7220 6f70 7469 6f6e 732e 6765 7428 2264  r options.get("d
+000188c0: 6174 615f 6261 725f 3230 3130 2229 0a20  ata_bar_2010"). 
+000188d0: 2020 2020 2020 2020 2020 206f 7220 6f70             or op
+000188e0: 7469 6f6e 732e 6765 7428 2262 6172 5f73  tions.get("bar_s
+000188f0: 6f6c 6964 2229 0a20 2020 2020 2020 2020  olid").         
+00018900: 2020 206f 7220 6f70 7469 6f6e 732e 6765     or options.ge
+00018910: 7428 2262 6172 5f62 6f72 6465 725f 636f  t("bar_border_co
+00018920: 6c6f 7222 290a 2020 2020 2020 2020 2020  lor").          
+00018930: 2020 6f72 206f 7074 696f 6e73 2e67 6574    or options.get
+00018940: 2822 6261 725f 6e65 6761 7469 7665 5f63  ("bar_negative_c
+00018950: 6f6c 6f72 2229 0a20 2020 2020 2020 2020  olor").         
+00018960: 2020 206f 7220 6f70 7469 6f6e 732e 6765     or options.ge
+00018970: 7428 2262 6172 5f6e 6567 6174 6976 655f  t("bar_negative_
+00018980: 636f 6c6f 725f 7361 6d65 2229 0a20 2020  color_same").   
+00018990: 2020 2020 2020 2020 206f 7220 6f70 7469           or opti
+000189a0: 6f6e 732e 6765 7428 2262 6172 5f6e 6567  ons.get("bar_neg
+000189b0: 6174 6976 655f 626f 7264 6572 5f63 6f6c  ative_border_col
+000189c0: 6f72 2229 0a20 2020 2020 2020 2020 2020  or").           
+000189d0: 206f 7220 6f70 7469 6f6e 732e 6765 7428   or options.get(
+000189e0: 2262 6172 5f6e 6567 6174 6976 655f 626f  "bar_negative_bo
+000189f0: 7264 6572 5f63 6f6c 6f72 5f73 616d 6522  rder_color_same"
+00018a00: 290a 2020 2020 2020 2020 2020 2020 6f72  ).            or
+00018a10: 206f 7074 696f 6e73 2e67 6574 2822 6261   options.get("ba
+00018a20: 725f 6e6f 5f62 6f72 6465 7222 290a 2020  r_no_border").  
+00018a30: 2020 2020 2020 2020 2020 6f72 206f 7074            or opt
+00018a40: 696f 6e73 2e67 6574 2822 6261 725f 6178  ions.get("bar_ax
+00018a50: 6973 5f70 6f73 6974 696f 6e22 290a 2020  is_position").  
+00018a60: 2020 2020 2020 2020 2020 6f72 206f 7074            or opt
+00018a70: 696f 6e73 2e67 6574 2822 6261 725f 6178  ions.get("bar_ax
+00018a80: 6973 5f63 6f6c 6f72 2229 0a20 2020 2020  is_color").     
+00018a90: 2020 2020 2020 206f 7220 6f70 7469 6f6e         or option
+00018aa0: 732e 6765 7428 2262 6172 5f64 6972 6563  s.get("bar_direc
+00018ab0: 7469 6f6e 2229 0a20 2020 2020 2020 2029  tion").        )
+00018ac0: 3a0a 2020 2020 2020 2020 2020 2020 6f70  :.            op
+00018ad0: 7469 6f6e 735b 2269 735f 6461 7461 5f62  tions["is_data_b
+00018ae0: 6172 5f32 3031 3022 5d20 3d20 5472 7565  ar_2010"] = True
+00018af0: 0a0a 2020 2020 2020 2020 2320 5370 6563  ..        # Spec
+00018b00: 6961 6c20 6861 6e64 6c69 6e67 206f 6620  ial handling of 
+00018b10: 7465 7874 2063 7269 7465 7269 612e 0a20  text criteria.. 
+00018b20: 2020 2020 2020 2069 6620 6f70 7469 6f6e         if option
+00018b30: 735b 2274 7970 6522 5d20 3d3d 2022 7465  s["type"] == "te
+00018b40: 7874 223a 0a20 2020 2020 2020 2020 2020  xt":.           
+00018b50: 2069 6620 6f70 7469 6f6e 735b 2263 7269   if options["cri
+00018b60: 7465 7269 6122 5d20 3d3d 2022 636f 6e74  teria"] == "cont
+00018b70: 6169 6e73 5465 7874 223a 0a20 2020 2020  ainsText":.     
+00018b80: 2020 2020 2020 2020 2020 206f 7074 696f             optio
+00018b90: 6e73 5b22 7479 7065 225d 203d 2022 636f  ns["type"] = "co
+00018ba0: 6e74 6169 6e73 5465 7874 220a 2020 2020  ntainsText".    
+00018bb0: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
+00018bc0: 6f6e 735b 2266 6f72 6d75 6c61 225d 203d  ons["formula"] =
+00018bd0: 2027 4e4f 5428 4953 4552 524f 5228 5345   'NOT(ISERROR(SE
+00018be0: 4152 4348 2822 2573 222c 2573 2929 2927  ARCH("%s",%s)))'
+00018bf0: 2025 2028 0a20 2020 2020 2020 2020 2020   % (.           
+00018c00: 2020 2020 2020 2020 206f 7074 696f 6e73           options
+00018c10: 5b22 7661 6c75 6522 5d2c 0a20 2020 2020  ["value"],.     
+00018c20: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00018c30: 7461 7274 5f63 656c 6c2c 0a20 2020 2020  tart_cell,.     
+00018c40: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00018c50: 2020 2020 2020 2020 2065 6c69 6620 6f70           elif op
+00018c60: 7469 6f6e 735b 2263 7269 7465 7269 6122  tions["criteria"
+00018c70: 5d20 3d3d 2022 6e6f 7443 6f6e 7461 696e  ] == "notContain
+00018c80: 7322 3a0a 2020 2020 2020 2020 2020 2020  s":.            
+00018c90: 2020 2020 6f70 7469 6f6e 735b 2274 7970      options["typ
+00018ca0: 6522 5d20 3d20 226e 6f74 436f 6e74 6169  e"] = "notContai
+00018cb0: 6e73 5465 7874 220a 2020 2020 2020 2020  nsText".        
+00018cc0: 2020 2020 2020 2020 6f70 7469 6f6e 735b          options[
+00018cd0: 2266 6f72 6d75 6c61 225d 203d 2027 4953  "formula"] = 'IS
+00018ce0: 4552 524f 5228 5345 4152 4348 2822 2573  ERROR(SEARCH("%s
+00018cf0: 222c 2573 2929 2720 2520 280a 2020 2020  ",%s))' % (.    
+00018d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018d10: 6f70 7469 6f6e 735b 2276 616c 7565 225d  options["value"]
+00018d20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00018d30: 2020 2020 2020 7374 6172 745f 6365 6c6c        start_cell
+00018d40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00018d50: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00018d60: 656c 6966 206f 7074 696f 6e73 5b22 6372  elif options["cr
+00018d70: 6974 6572 6961 225d 203d 3d20 2262 6567  iteria"] == "beg
+00018d80: 696e 7357 6974 6822 3a0a 2020 2020 2020  insWith":.      
+00018d90: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
+00018da0: 735b 2274 7970 6522 5d20 3d20 2262 6567  s["type"] = "beg
+00018db0: 696e 7357 6974 6822 0a20 2020 2020 2020  insWith".       
+00018dc0: 2020 2020 2020 2020 206f 7074 696f 6e73           options
+00018dd0: 5b22 666f 726d 756c 6122 5d20 3d20 274c  ["formula"] = 'L
+00018de0: 4546 5428 2573 2c25 6429 3d22 2573 2227  EFT(%s,%d)="%s"'
+00018df0: 2025 2028 0a20 2020 2020 2020 2020 2020   % (.           
+00018e00: 2020 2020 2020 2020 2073 7461 7274 5f63           start_c
+00018e10: 656c 6c2c 0a20 2020 2020 2020 2020 2020  ell,.           
+00018e20: 2020 2020 2020 2020 206c 656e 286f 7074           len(opt
+00018e30: 696f 6e73 5b22 7661 6c75 6522 5d29 2c0a  ions["value"]),.
+00018e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018e50: 2020 2020 6f70 7469 6f6e 735b 2276 616c      options["val
+00018e60: 7565 225d 2c0a 2020 2020 2020 2020 2020  ue"],.          
+00018e70: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00018e80: 2020 2020 656c 6966 206f 7074 696f 6e73      elif options
+00018e90: 5b22 6372 6974 6572 6961 225d 203d 3d20  ["criteria"] == 
+00018ea0: 2265 6e64 7357 6974 6822 3a0a 2020 2020  "endsWith":.    
+00018eb0: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
+00018ec0: 6f6e 735b 2274 7970 6522 5d20 3d20 2265  ons["type"] = "e
+00018ed0: 6e64 7357 6974 6822 0a20 2020 2020 2020  ndsWith".       
+00018ee0: 2020 2020 2020 2020 206f 7074 696f 6e73           options
+00018ef0: 5b22 666f 726d 756c 6122 5d20 3d20 2752  ["formula"] = 'R
+00018f00: 4947 4854 2825 732c 2564 293d 2225 7322  IGHT(%s,%d)="%s"
+00018f10: 2720 2520 280a 2020 2020 2020 2020 2020  ' % (.          
+00018f20: 2020 2020 2020 2020 2020 7374 6172 745f            start_
+00018f30: 6365 6c6c 2c0a 2020 2020 2020 2020 2020  cell,.          
+00018f40: 2020 2020 2020 2020 2020 6c65 6e28 6f70            len(op
+00018f50: 7469 6f6e 735b 2276 616c 7565 225d 292c  tions["value"]),
+00018f60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018f70: 2020 2020 206f 7074 696f 6e73 5b22 7661       options["va
+00018f80: 6c75 6522 5d2c 0a20 2020 2020 2020 2020  lue"],.         
+00018f90: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00018fa0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00018fb0: 2020 2020 2020 2020 2020 2077 6172 6e28             warn(
+00018fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018fd0: 2020 2020 2022 496e 7661 6c69 6420 7465       "Invalid te
+00018fe0: 7874 2063 7269 7465 7269 6120 2725 7327  xt criteria '%s'
+00018ff0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+00019000: 2020 2020 2020 2022 696e 2063 6f6e 6469         "in condi
+00019010: 7469 6f6e 616c 5f66 6f72 6d61 7428 2922  tional_format()"
+00019020: 2025 206f 7074 696f 6e73 5b22 6372 6974   % options["crit
+00019030: 6572 6961 225d 0a20 2020 2020 2020 2020  eria"].         
+00019040: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00019050: 2020 2320 5370 6563 6961 6c20 6861 6e64    # Special hand
+00019060: 6c69 6e67 206f 6620 7469 6d65 2074 696d  ling of time tim
+00019070: 655f 7065 7269 6f64 2063 7269 7465 7269  e_period criteri
+00019080: 612e 0a20 2020 2020 2020 2069 6620 6f70  a..        if op
+00019090: 7469 6f6e 735b 2274 7970 6522 5d20 3d3d  tions["type"] ==
+000190a0: 2022 7469 6d65 5065 7269 6f64 223a 0a20   "timePeriod":. 
+000190b0: 2020 2020 2020 2020 2020 2069 6620 6f70             if op
+000190c0: 7469 6f6e 735b 2263 7269 7465 7269 6122  tions["criteria"
+000190d0: 5d20 3d3d 2022 7965 7374 6572 6461 7922  ] == "yesterday"
+000190e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000190f0: 2020 6f70 7469 6f6e 735b 2266 6f72 6d75    options["formu
+00019100: 6c61 225d 203d 2022 464c 4f4f 5228 2573  la"] = "FLOOR(%s
+00019110: 2c31 293d 544f 4441 5928 292d 3122 2025  ,1)=TODAY()-1" %
+00019120: 2073 7461 7274 5f63 656c 6c0a 0a20 2020   start_cell..   
+00019130: 2020 2020 2020 2020 2065 6c69 6620 6f70           elif op
+00019140: 7469 6f6e 735b 2263 7269 7465 7269 6122  tions["criteria"
+00019150: 5d20 3d3d 2022 746f 6461 7922 3a0a 2020  ] == "today":.  
+00019160: 2020 2020 2020 2020 2020 2020 2020 6f70                op
+00019170: 7469 6f6e 735b 2266 6f72 6d75 6c61 225d  tions["formula"]
+00019180: 203d 2022 464c 4f4f 5228 2573 2c31 293d   = "FLOOR(%s,1)=
+00019190: 544f 4441 5928 2922 2025 2073 7461 7274  TODAY()" % start
+000191a0: 5f63 656c 6c0a 0a20 2020 2020 2020 2020  _cell..         
+000191b0: 2020 2065 6c69 6620 6f70 7469 6f6e 735b     elif options[
+000191c0: 2263 7269 7465 7269 6122 5d20 3d3d 2022  "criteria"] == "
+000191d0: 746f 6d6f 7272 6f77 223a 0a20 2020 2020  tomorrow":.     
+000191e0: 2020 2020 2020 2020 2020 206f 7074 696f             optio
+000191f0: 6e73 5b22 666f 726d 756c 6122 5d20 3d20  ns["formula"] = 
+00019200: 2246 4c4f 4f52 2825 732c 3129 3d54 4f44  "FLOOR(%s,1)=TOD
+00019210: 4159 2829 2b31 2220 2520 7374 6172 745f  AY()+1" % start_
+00019220: 6365 6c6c 0a0a 2020 2020 2020 2020 2020  cell..          
+00019230: 2020 656c 6966 206f 7074 696f 6e73 5b22    elif options["
+00019240: 6372 6974 6572 6961 225d 203d 3d20 226c  criteria"] == "l
+00019250: 6173 7437 4461 7973 223a 0a20 2020 2020  ast7Days":.     
+00019260: 2020 2020 2020 2020 2020 206f 7074 696f             optio
+00019270: 6e73 5b0a 2020 2020 2020 2020 2020 2020  ns[.            
+00019280: 2020 2020 2020 2020 2266 6f72 6d75 6c61          "formula
+00019290: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+000192a0: 2020 5d20 3d20 2241 4e44 2854 4f44 4159    ] = "AND(TODAY
+000192b0: 2829 2d46 4c4f 4f52 2825 732c 3129 3c3d  ()-FLOOR(%s,1)<=
+000192c0: 362c 464c 4f4f 5228 2573 2c31 293c 3d54  6,FLOOR(%s,1)<=T
+000192d0: 4f44 4159 2829 2922 2025 2028 0a20 2020  ODAY())" % (.   
+000192e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000192f0: 2073 7461 7274 5f63 656c 6c2c 0a20 2020   start_cell,.   
+00019300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019310: 2073 7461 7274 5f63 656c 6c2c 0a20 2020   start_cell,.   
+00019320: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+00019330: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00019340: 206f 7074 696f 6e73 5b22 6372 6974 6572   options["criter
+00019350: 6961 225d 203d 3d20 226c 6173 7457 6565  ia"] == "lastWee
+00019360: 6b22 3a0a 2020 2020 2020 2020 2020 2020  k":.            
+00019370: 2020 2020 6f70 7469 6f6e 735b 2266 6f72      options["for
+00019380: 6d75 6c61 225d 203d 2028 0a20 2020 2020  mula"] = (.     
+00019390: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000193a0: 414e 4428 544f 4441 5928 292d 524f 554e  AND(TODAY()-ROUN
+000193b0: 4444 4f57 4e28 2573 2c30 293e 3d28 5745  DDOWN(%s,0)>=(WE
+000193c0: 454b 4441 5928 544f 4441 5928 2929 292c  EKDAY(TODAY())),
+000193d0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+000193e0: 2020 2020 2020 2254 4f44 4159 2829 2d52        "TODAY()-R
+000193f0: 4f55 4e44 444f 574e 2825 732c 3029 3c28  OUNDDOWN(%s,0)<(
+00019400: 5745 454b 4441 5928 544f 4441 5928 2929  WEEKDAY(TODAY())
+00019410: 2b37 2929 220a 2020 2020 2020 2020 2020  +7))".          
+00019420: 2020 2020 2020 2020 2020 2520 2873 7461            % (sta
+00019430: 7274 5f63 656c 6c2c 2073 7461 7274 5f63  rt_cell, start_c
+00019440: 656c 6c29 0a20 2020 2020 2020 2020 2020  ell).           
+00019450: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00019460: 2020 2020 656c 6966 206f 7074 696f 6e73      elif options
+00019470: 5b22 6372 6974 6572 6961 225d 203d 3d20  ["criteria"] == 
+00019480: 2274 6869 7357 6565 6b22 3a0a 2020 2020  "thisWeek":.    
+00019490: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
+000194a0: 6f6e 735b 2266 6f72 6d75 6c61 225d 203d  ons["formula"] =
+000194b0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+000194c0: 2020 2020 2020 2022 414e 4428 544f 4441         "AND(TODA
+000194d0: 5928 292d 524f 554e 4444 4f57 4e28 2573  Y()-ROUNDDOWN(%s
+000194e0: 2c30 293c 3d57 4545 4b44 4159 2854 4f44  ,0)<=WEEKDAY(TOD
+000194f0: 4159 2829 292d 312c 220a 2020 2020 2020  AY())-1,".      
+00019500: 2020 2020 2020 2020 2020 2020 2020 2252                "R
+00019510: 4f55 4e44 444f 574e 2825 732c 3029 2d54  OUNDDOWN(%s,0)-T
+00019520: 4f44 4159 2829 3c3d 372d 5745 454b 4441  ODAY()<=7-WEEKDA
+00019530: 5928 544f 4441 5928 2929 2922 0a20 2020  Y(TODAY()))".   
+00019540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019550: 2025 2028 7374 6172 745f 6365 6c6c 2c20   % (start_cell, 
+00019560: 7374 6172 745f 6365 6c6c 290a 2020 2020  start_cell).    
+00019570: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00019580: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00019590: 6f70 7469 6f6e 735b 2263 7269 7465 7269  options["criteri
+000195a0: 6122 5d20 3d3d 2022 6e65 7874 5765 656b  a"] == "nextWeek
+000195b0: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
+000195c0: 2020 206f 7074 696f 6e73 5b22 666f 726d     options["form
+000195d0: 756c 6122 5d20 3d20 280a 2020 2020 2020  ula"] = (.      
+000195e0: 2020 2020 2020 2020 2020 2020 2020 2241                "A
+000195f0: 4e44 2852 4f55 4e44 444f 574e 2825 732c  ND(ROUNDDOWN(%s,
+00019600: 3029 2d54 4f44 4159 2829 3e28 372d 5745  0)-TODAY()>(7-WE
+00019610: 454b 4441 5928 544f 4441 5928 2929 292c  EKDAY(TODAY())),
+00019620: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00019630: 2020 2020 2020 2252 4f55 4e44 444f 574e        "ROUNDDOWN
+00019640: 2825 732c 3029 2d54 4f44 4159 2829 3c28  (%s,0)-TODAY()<(
+00019650: 3135 2d57 4545 4b44 4159 2854 4f44 4159  15-WEEKDAY(TODAY
+00019660: 2829 2929 2922 0a20 2020 2020 2020 2020  ())))".         
+00019670: 2020 2020 2020 2020 2020 2025 2028 7374             % (st
+00019680: 6172 745f 6365 6c6c 2c20 7374 6172 745f  art_cell, start_
+00019690: 6365 6c6c 290a 2020 2020 2020 2020 2020  cell).          
+000196a0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+000196b0: 2020 2020 2065 6c69 6620 6f70 7469 6f6e       elif option
+000196c0: 735b 2263 7269 7465 7269 6122 5d20 3d3d  s["criteria"] ==
+000196d0: 2022 6c61 7374 4d6f 6e74 6822 3a0a 2020   "lastMonth":.  
+000196e0: 2020 2020 2020 2020 2020 2020 2020 6f70                op
+000196f0: 7469 6f6e 735b 2266 6f72 6d75 6c61 225d  tions["formula"]
+00019700: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+00019710: 2020 2020 2020 2020 2022 414e 4428 4d4f           "AND(MO
+00019720: 4e54 4828 2573 293d 4d4f 4e54 4828 544f  NTH(%s)=MONTH(TO
+00019730: 4441 5928 2929 2d31 2c4f 5228 5945 4152  DAY())-1,OR(YEAR
+00019740: 2825 7329 3d59 4541 5228 220a 2020 2020  (%s)=YEAR(".    
+00019750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019760: 2254 4f44 4159 2829 292c 414e 4428 4d4f  "TODAY()),AND(MO
+00019770: 4e54 4828 2573 293d 312c 5945 4152 2841  NTH(%s)=1,YEAR(A
+00019780: 3129 3d59 4541 5228 544f 4441 5928 2929  1)=YEAR(TODAY())
+00019790: 2d31 2929 2922 0a20 2020 2020 2020 2020  -1)))".         
+000197a0: 2020 2020 2020 2020 2020 2025 2028 7374             % (st
+000197b0: 6172 745f 6365 6c6c 2c20 7374 6172 745f  art_cell, start_
+000197c0: 6365 6c6c 2c20 7374 6172 745f 6365 6c6c  cell, start_cell
+000197d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000197e0: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+000197f0: 2065 6c69 6620 6f70 7469 6f6e 735b 2263   elif options["c
+00019800: 7269 7465 7269 6122 5d20 3d3d 2022 7468  riteria"] == "th
+00019810: 6973 4d6f 6e74 6822 3a0a 2020 2020 2020  isMonth":.      
+00019820: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
+00019830: 735b 0a20 2020 2020 2020 2020 2020 2020  s[.             
+00019840: 2020 2020 2020 2022 666f 726d 756c 6122         "formula"
+00019850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019860: 205d 203d 2022 414e 4428 4d4f 4e54 4828   ] = "AND(MONTH(
+00019870: 2573 293d 4d4f 4e54 4828 544f 4441 5928  %s)=MONTH(TODAY(
+00019880: 2929 2c59 4541 5228 2573 293d 5945 4152  )),YEAR(%s)=YEAR
+00019890: 2854 4f44 4159 2829 2929 2220 2520 280a  (TODAY()))" % (.
+000198a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000198b0: 2020 2020 7374 6172 745f 6365 6c6c 2c0a      start_cell,.
+000198c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000198d0: 2020 2020 7374 6172 745f 6365 6c6c 2c0a      start_cell,.
 000198e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000198f0: 2020 2020 2028 7374 6172 745f 6365 6c6c       (start_cell
-00019900: 2c20 7374 6172 745f 6365 6c6c 2c20 7374  , start_cell, st
-00019910: 6172 745f 6365 6c6c 2929 0a0a 2020 2020  art_cell))..    
-00019920: 2020 2020 2020 2020 656c 6966 206f 7074          elif opt
-00019930: 696f 6e73 5b27 6372 6974 6572 6961 275d  ions['criteria']
-00019940: 203d 3d20 2774 6869 734d 6f6e 7468 273a   == 'thisMonth':
-00019950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019960: 206f 7074 696f 6e73 5b27 666f 726d 756c   options['formul
-00019970: 6127 5d20 3d20 5c0a 2020 2020 2020 2020  a'] = \.        
-00019980: 2020 2020 2020 2020 2020 2020 2827 414e              ('AN
-00019990: 4428 4d4f 4e54 4828 2573 293d 4d4f 4e54  D(MONTH(%s)=MONT
-000199a0: 4828 544f 4441 5928 2929 2c59 4541 5228  H(TODAY()),YEAR(
-000199b0: 2573 293d 5945 4152 2854 4f44 4159 2829  %s)=YEAR(TODAY()
-000199c0: 2929 2720 250a 2020 2020 2020 2020 2020  ))' %.          
-000199d0: 2020 2020 2020 2020 2020 2028 7374 6172             (star
-000199e0: 745f 6365 6c6c 2c20 7374 6172 745f 6365  t_cell, start_ce
-000199f0: 6c6c 2929 0a0a 2020 2020 2020 2020 2020  ll))..          
-00019a00: 2020 656c 6966 206f 7074 696f 6e73 5b27    elif options['
-00019a10: 6372 6974 6572 6961 275d 203d 3d20 276e  criteria'] == 'n
-00019a20: 6578 744d 6f6e 7468 273a 0a20 2020 2020  extMonth':.     
-00019a30: 2020 2020 2020 2020 2020 206f 7074 696f             optio
-00019a40: 6e73 5b27 666f 726d 756c 6127 5d20 3d20  ns['formula'] = 
-00019a50: 5c0a 2020 2020 2020 2020 2020 2020 2020  \.              
-00019a60: 2020 2020 2020 2827 414e 4428 4d4f 4e54        ('AND(MONT
-00019a70: 4828 2573 293d 4d4f 4e54 4828 544f 4441  H(%s)=MONTH(TODA
-00019a80: 5928 2929 2b31 2c4f 5228 5945 4152 2825  Y())+1,OR(YEAR(%
-00019a90: 7329 3d59 4541 5228 270a 2020 2020 2020  s)=YEAR('.      
-00019aa0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00019ab0: 544f 4441 5928 2929 2c41 4e44 284d 4f4e  TODAY()),AND(MON
-00019ac0: 5448 2825 7329 3d31 322c 5945 4152 2825  TH(%s)=12,YEAR(%
-00019ad0: 7329 3d59 4541 5228 544f 4441 5928 2929  s)=YEAR(TODAY())
-00019ae0: 2b31 2929 2927 2025 0a20 2020 2020 2020  +1)))' %.       
-00019af0: 2020 2020 2020 2020 2020 2020 2020 2873                (s
-00019b00: 7461 7274 5f63 656c 6c2c 2073 7461 7274  tart_cell, start
-00019b10: 5f63 656c 6c2c 2073 7461 7274 5f63 656c  _cell, start_cel
-00019b20: 6c2c 2073 7461 7274 5f63 656c 6c29 290a  l, start_cell)).
-00019b30: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00019b40: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00019b50: 2020 2077 6172 6e28 2249 6e76 616c 6964     warn("Invalid
-00019b60: 2074 696d 655f 7065 7269 6f64 2063 7269   time_period cri
-00019b70: 7465 7269 6120 2725 7327 2022 0a20 2020  teria '%s' ".   
-00019b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019b90: 2020 2269 6e20 636f 6e64 6974 696f 6e61    "in conditiona
-00019ba0: 6c5f 666f 726d 6174 2829 2220 2520 6f70  l_format()" % op
-00019bb0: 7469 6f6e 735b 2763 7269 7465 7269 6127  tions['criteria'
-00019bc0: 5d29 0a0a 2020 2020 2020 2020 2320 5370  ])..        # Sp
-00019bd0: 6563 6961 6c20 6861 6e64 6c69 6e67 206f  ecial handling o
-00019be0: 6620 626c 616e 6b73 2f65 7272 6f72 2074  f blanks/error t
-00019bf0: 7970 6573 2e0a 2020 2020 2020 2020 6966  ypes..        if
-00019c00: 206f 7074 696f 6e73 5b27 7479 7065 275d   options['type']
-00019c10: 203d 3d20 2763 6f6e 7461 696e 7342 6c61   == 'containsBla
-00019c20: 6e6b 7327 3a0a 2020 2020 2020 2020 2020  nks':.          
-00019c30: 2020 6f70 7469 6f6e 735b 2766 6f72 6d75    options['formu
-00019c40: 6c61 275d 203d 2027 4c45 4e28 5452 494d  la'] = 'LEN(TRIM
-00019c50: 2825 7329 293d 3027 2025 2073 7461 7274  (%s))=0' % start
-00019c60: 5f63 656c 6c0a 0a20 2020 2020 2020 2069  _cell..        i
-00019c70: 6620 6f70 7469 6f6e 735b 2774 7970 6527  f options['type'
-00019c80: 5d20 3d3d 2027 6e6f 7443 6f6e 7461 696e  ] == 'notContain
-00019c90: 7342 6c61 6e6b 7327 3a0a 2020 2020 2020  sBlanks':.      
-00019ca0: 2020 2020 2020 6f70 7469 6f6e 735b 2766        options['f
-00019cb0: 6f72 6d75 6c61 275d 203d 2027 4c45 4e28  ormula'] = 'LEN(
-00019cc0: 5452 494d 2825 7329 293e 3027 2025 2073  TRIM(%s))>0' % s
-00019cd0: 7461 7274 5f63 656c 6c0a 0a20 2020 2020  tart_cell..     
-00019ce0: 2020 2069 6620 6f70 7469 6f6e 735b 2774     if options['t
-00019cf0: 7970 6527 5d20 3d3d 2027 636f 6e74 6169  ype'] == 'contai
-00019d00: 6e73 4572 726f 7273 273a 0a20 2020 2020  nsErrors':.     
-00019d10: 2020 2020 2020 206f 7074 696f 6e73 5b27         options['
-00019d20: 666f 726d 756c 6127 5d20 3d20 2749 5345  formula'] = 'ISE
-00019d30: 5252 4f52 2825 7329 2720 2520 7374 6172  RROR(%s)' % star
-00019d40: 745f 6365 6c6c 0a0a 2020 2020 2020 2020  t_cell..        
-00019d50: 6966 206f 7074 696f 6e73 5b27 7479 7065  if options['type
-00019d60: 275d 203d 3d20 276e 6f74 436f 6e74 6169  '] == 'notContai
-00019d70: 6e73 4572 726f 7273 273a 0a20 2020 2020  nsErrors':.     
-00019d80: 2020 2020 2020 206f 7074 696f 6e73 5b27         options['
-00019d90: 666f 726d 756c 6127 5d20 3d20 274e 4f54  formula'] = 'NOT
-00019da0: 2849 5345 5252 4f52 2825 7329 2927 2025  (ISERROR(%s))' %
-00019db0: 2073 7461 7274 5f63 656c 6c0a 0a20 2020   start_cell..   
-00019dc0: 2020 2020 2023 2053 7065 6369 616c 2068       # Special h
-00019dd0: 616e 646c 696e 6720 666f 7220 3220 636f  andling for 2 co
-00019de0: 6c6f 7220 7363 616c 652e 0a20 2020 2020  lor scale..     
-00019df0: 2020 2069 6620 6f70 7469 6f6e 735b 2774     if options['t
-00019e00: 7970 6527 5d20 3d3d 2027 325f 636f 6c6f  ype'] == '2_colo
-00019e10: 725f 7363 616c 6527 3a0a 2020 2020 2020  r_scale':.      
-00019e20: 2020 2020 2020 6f70 7469 6f6e 735b 2774        options['t
-00019e30: 7970 6527 5d20 3d20 2763 6f6c 6f72 5363  ype'] = 'colorSc
-00019e40: 616c 6527 0a0a 2020 2020 2020 2020 2020  ale'..          
-00019e50: 2020 2320 436f 6c6f 7220 7363 616c 6573    # Color scales
-00019e60: 2064 6f6e 2774 2075 7365 2061 6e79 2061   don't use any a
-00019e70: 6464 6974 696f 6e61 6c20 666f 726d 6174  dditional format
-00019e80: 7469 6e67 2e0a 2020 2020 2020 2020 2020  ting..          
-00019e90: 2020 6f70 7469 6f6e 735b 2766 6f72 6d61    options['forma
-00019ea0: 7427 5d20 3d20 4e6f 6e65 0a0a 2020 2020  t'] = None..    
-00019eb0: 2020 2020 2020 2020 2320 5475 726e 206f          # Turn o
-00019ec0: 6666 2033 2063 6f6c 6f72 2070 6172 616d  ff 3 color param
-00019ed0: 6574 6572 732e 0a20 2020 2020 2020 2020  eters..         
-00019ee0: 2020 206f 7074 696f 6e73 5b27 6d69 645f     options['mid_
-00019ef0: 7479 7065 275d 203d 204e 6f6e 650a 2020  type'] = None.  
-00019f00: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
-00019f10: 735b 276d 6964 5f63 6f6c 6f72 275d 203d  s['mid_color'] =
-00019f20: 204e 6f6e 650a 0a20 2020 2020 2020 2020   None..         
-00019f30: 2020 206f 7074 696f 6e73 2e73 6574 6465     options.setde
-00019f40: 6661 756c 7428 276d 696e 5f74 7970 6527  fault('min_type'
-00019f50: 2c20 276d 696e 2729 0a20 2020 2020 2020  , 'min').       
-00019f60: 2020 2020 206f 7074 696f 6e73 2e73 6574       options.set
-00019f70: 6465 6661 756c 7428 276d 6178 5f74 7970  default('max_typ
-00019f80: 6527 2c20 276d 6178 2729 0a20 2020 2020  e', 'max').     
-00019f90: 2020 2020 2020 206f 7074 696f 6e73 2e73         options.s
-00019fa0: 6574 6465 6661 756c 7428 276d 696e 5f76  etdefault('min_v
-00019fb0: 616c 7565 272c 2030 290a 2020 2020 2020  alue', 0).      
-00019fc0: 2020 2020 2020 6f70 7469 6f6e 732e 7365        options.se
-00019fd0: 7464 6566 6175 6c74 2827 6d61 785f 7661  tdefault('max_va
-00019fe0: 6c75 6527 2c20 3029 0a20 2020 2020 2020  lue', 0).       
-00019ff0: 2020 2020 206f 7074 696f 6e73 2e73 6574       options.set
-0001a000: 6465 6661 756c 7428 276d 696e 5f63 6f6c  default('min_col
-0001a010: 6f72 272c 2027 2346 4637 3132 3827 290a  or', '#FF7128').
-0001a020: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
-0001a030: 6f6e 732e 7365 7464 6566 6175 6c74 2827  ons.setdefault('
-0001a040: 6d61 785f 636f 6c6f 7227 2c20 2723 4646  max_color', '#FF
-0001a050: 4546 3943 2729 0a0a 2020 2020 2020 2020  EF9C')..        
-0001a060: 2020 2020 6f70 7469 6f6e 735b 276d 696e      options['min
-0001a070: 5f63 6f6c 6f72 275d 203d 2078 6c5f 636f  _color'] = xl_co
-0001a080: 6c6f 7228 6f70 7469 6f6e 735b 276d 696e  lor(options['min
-0001a090: 5f63 6f6c 6f72 275d 290a 2020 2020 2020  _color']).      
-0001a0a0: 2020 2020 2020 6f70 7469 6f6e 735b 276d        options['m
-0001a0b0: 6178 5f63 6f6c 6f72 275d 203d 2078 6c5f  ax_color'] = xl_
-0001a0c0: 636f 6c6f 7228 6f70 7469 6f6e 735b 276d  color(options['m
-0001a0d0: 6178 5f63 6f6c 6f72 275d 290a 0a20 2020  ax_color'])..   
-0001a0e0: 2020 2020 2023 2053 7065 6369 616c 2068       # Special h
-0001a0f0: 616e 646c 696e 6720 666f 7220 3320 636f  andling for 3 co
-0001a100: 6c6f 7220 7363 616c 652e 0a20 2020 2020  lor scale..     
-0001a110: 2020 2069 6620 6f70 7469 6f6e 735b 2774     if options['t
-0001a120: 7970 6527 5d20 3d3d 2027 335f 636f 6c6f  ype'] == '3_colo
-0001a130: 725f 7363 616c 6527 3a0a 2020 2020 2020  r_scale':.      
-0001a140: 2020 2020 2020 6f70 7469 6f6e 735b 2774        options['t
-0001a150: 7970 6527 5d20 3d20 2763 6f6c 6f72 5363  ype'] = 'colorSc
-0001a160: 616c 6527 0a0a 2020 2020 2020 2020 2020  ale'..          
-0001a170: 2020 2320 436f 6c6f 7220 7363 616c 6573    # Color scales
-0001a180: 2064 6f6e 2774 2075 7365 2061 6e79 2061   don't use any a
-0001a190: 6464 6974 696f 6e61 6c20 666f 726d 6174  dditional format
-0001a1a0: 7469 6e67 2e0a 2020 2020 2020 2020 2020  ting..          
-0001a1b0: 2020 6f70 7469 6f6e 735b 2766 6f72 6d61    options['forma
-0001a1c0: 7427 5d20 3d20 4e6f 6e65 0a0a 2020 2020  t'] = None..    
-0001a1d0: 2020 2020 2020 2020 6f70 7469 6f6e 732e          options.
-0001a1e0: 7365 7464 6566 6175 6c74 2827 6d69 6e5f  setdefault('min_
-0001a1f0: 7479 7065 272c 2027 6d69 6e27 290a 2020  type', 'min').  
-0001a200: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
-0001a210: 732e 7365 7464 6566 6175 6c74 2827 6d69  s.setdefault('mi
-0001a220: 645f 7479 7065 272c 2027 7065 7263 656e  d_type', 'percen
-0001a230: 7469 6c65 2729 0a20 2020 2020 2020 2020  tile').         
-0001a240: 2020 206f 7074 696f 6e73 2e73 6574 6465     options.setde
-0001a250: 6661 756c 7428 276d 6178 5f74 7970 6527  fault('max_type'
-0001a260: 2c20 276d 6178 2729 0a20 2020 2020 2020  , 'max').       
-0001a270: 2020 2020 206f 7074 696f 6e73 2e73 6574       options.set
-0001a280: 6465 6661 756c 7428 276d 696e 5f76 616c  default('min_val
-0001a290: 7565 272c 2030 290a 2020 2020 2020 2020  ue', 0).        
-0001a2a0: 2020 2020 6f70 7469 6f6e 732e 7365 7464      options.setd
-0001a2b0: 6566 6175 6c74 2827 6d61 785f 7661 6c75  efault('max_valu
-0001a2c0: 6527 2c20 3029 0a20 2020 2020 2020 2020  e', 0).         
-0001a2d0: 2020 206f 7074 696f 6e73 2e73 6574 6465     options.setde
-0001a2e0: 6661 756c 7428 276d 696e 5f63 6f6c 6f72  fault('min_color
-0001a2f0: 272c 2027 2346 3836 3936 4227 290a 2020  ', '#F8696B').  
-0001a300: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
-0001a310: 732e 7365 7464 6566 6175 6c74 2827 6d69  s.setdefault('mi
-0001a320: 645f 636f 6c6f 7227 2c20 2723 4646 4542  d_color', '#FFEB
-0001a330: 3834 2729 0a20 2020 2020 2020 2020 2020  84').           
-0001a340: 206f 7074 696f 6e73 2e73 6574 6465 6661   options.setdefa
-0001a350: 756c 7428 276d 6178 5f63 6f6c 6f72 272c  ult('max_color',
-0001a360: 2027 2336 3342 4537 4227 290a 0a20 2020   '#63BE7B')..   
-0001a370: 2020 2020 2020 2020 206f 7074 696f 6e73           options
-0001a380: 5b27 6d69 6e5f 636f 6c6f 7227 5d20 3d20  ['min_color'] = 
-0001a390: 786c 5f63 6f6c 6f72 286f 7074 696f 6e73  xl_color(options
-0001a3a0: 5b27 6d69 6e5f 636f 6c6f 7227 5d29 0a20  ['min_color']). 
-0001a3b0: 2020 2020 2020 2020 2020 206f 7074 696f             optio
-0001a3c0: 6e73 5b27 6d69 645f 636f 6c6f 7227 5d20  ns['mid_color'] 
-0001a3d0: 3d20 786c 5f63 6f6c 6f72 286f 7074 696f  = xl_color(optio
-0001a3e0: 6e73 5b27 6d69 645f 636f 6c6f 7227 5d29  ns['mid_color'])
-0001a3f0: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
-0001a400: 696f 6e73 5b27 6d61 785f 636f 6c6f 7227  ions['max_color'
-0001a410: 5d20 3d20 786c 5f63 6f6c 6f72 286f 7074  ] = xl_color(opt
-0001a420: 696f 6e73 5b27 6d61 785f 636f 6c6f 7227  ions['max_color'
-0001a430: 5d29 0a0a 2020 2020 2020 2020 2020 2020  ])..            
-0001a440: 2320 5365 7420 6120 6465 6661 756c 7420  # Set a default 
-0001a450: 6d69 6420 7661 6c75 652e 0a20 2020 2020  mid value..     
-0001a460: 2020 2020 2020 2069 6620 276d 6964 5f76         if 'mid_v
-0001a470: 616c 7565 2720 6e6f 7420 696e 206f 7074  alue' not in opt
-0001a480: 696f 6e73 3a0a 2020 2020 2020 2020 2020  ions:.          
-0001a490: 2020 2020 2020 6f70 7469 6f6e 735b 276d        options['m
-0001a4a0: 6964 5f76 616c 7565 275d 203d 2035 300a  id_value'] = 50.
-0001a4b0: 0a20 2020 2020 2020 2023 2053 7065 6369  .        # Speci
-0001a4c0: 616c 2068 616e 646c 696e 6720 666f 7220  al handling for 
-0001a4d0: 6461 7461 2062 6172 2e0a 2020 2020 2020  data bar..      
-0001a4e0: 2020 6966 206f 7074 696f 6e73 5b27 7479    if options['ty
-0001a4f0: 7065 275d 203d 3d20 2764 6174 6142 6172  pe'] == 'dataBar
-0001a500: 273a 0a0a 2020 2020 2020 2020 2020 2020  ':..            
-0001a510: 2320 436f 6c6f 7220 7363 616c 6573 2064  # Color scales d
-0001a520: 6f6e 2774 2075 7365 2061 6e79 2061 6464  on't use any add
-0001a530: 6974 696f 6e61 6c20 666f 726d 6174 7469  itional formatti
-0001a540: 6e67 2e0a 2020 2020 2020 2020 2020 2020  ng..            
-0001a550: 6f70 7469 6f6e 735b 2766 6f72 6d61 7427  options['format'
-0001a560: 5d20 3d20 4e6f 6e65 0a0a 2020 2020 2020  ] = None..      
-0001a570: 2020 2020 2020 6966 206e 6f74 206f 7074        if not opt
-0001a580: 696f 6e73 2e67 6574 2827 6d69 6e5f 7479  ions.get('min_ty
-0001a590: 7065 2729 3a0a 2020 2020 2020 2020 2020  pe'):.          
-0001a5a0: 2020 2020 2020 6f70 7469 6f6e 735b 276d        options['m
-0001a5b0: 696e 5f74 7970 6527 5d20 3d20 276d 696e  in_type'] = 'min
-0001a5c0: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-0001a5d0: 2020 6f70 7469 6f6e 735b 2778 3134 5f6d    options['x14_m
-0001a5e0: 696e 5f74 7970 6527 5d20 3d20 2761 7574  in_type'] = 'aut
-0001a5f0: 6f4d 696e 270a 2020 2020 2020 2020 2020  oMin'.          
-0001a600: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0001a610: 2020 2020 2020 2020 6f70 7469 6f6e 735b          options[
-0001a620: 2778 3134 5f6d 696e 5f74 7970 6527 5d20  'x14_min_type'] 
-0001a630: 3d20 6f70 7469 6f6e 735b 276d 696e 5f74  = options['min_t
-0001a640: 7970 6527 5d0a 0a20 2020 2020 2020 2020  ype']..         
-0001a650: 2020 2069 6620 6e6f 7420 6f70 7469 6f6e     if not option
-0001a660: 732e 6765 7428 276d 6178 5f74 7970 6527  s.get('max_type'
-0001a670: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0001a680: 2020 206f 7074 696f 6e73 5b27 6d61 785f     options['max_
-0001a690: 7479 7065 275d 203d 2027 6d61 7827 0a20  type'] = 'max'. 
-0001a6a0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-0001a6b0: 7074 696f 6e73 5b27 7831 345f 6d61 785f  ptions['x14_max_
-0001a6c0: 7479 7065 275d 203d 2027 6175 746f 4d61  type'] = 'autoMa
-0001a6d0: 7827 0a20 2020 2020 2020 2020 2020 2065  x'.            e
-0001a6e0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0001a6f0: 2020 2020 206f 7074 696f 6e73 5b27 7831       options['x1
-0001a700: 345f 6d61 785f 7479 7065 275d 203d 206f  4_max_type'] = o
-0001a710: 7074 696f 6e73 5b27 6d61 785f 7479 7065  ptions['max_type
-0001a720: 275d 0a0a 2020 2020 2020 2020 2020 2020  ']..            
-0001a730: 6f70 7469 6f6e 732e 7365 7464 6566 6175  options.setdefau
-0001a740: 6c74 2827 6d69 6e5f 7661 6c75 6527 2c20  lt('min_value', 
-0001a750: 3029 0a20 2020 2020 2020 2020 2020 206f  0).            o
-0001a760: 7074 696f 6e73 2e73 6574 6465 6661 756c  ptions.setdefaul
-0001a770: 7428 276d 6178 5f76 616c 7565 272c 2030  t('max_value', 0
-0001a780: 290a 2020 2020 2020 2020 2020 2020 6f70  ).            op
-0001a790: 7469 6f6e 732e 7365 7464 6566 6175 6c74  tions.setdefault
-0001a7a0: 2827 6261 725f 636f 6c6f 7227 2c20 2723  ('bar_color', '#
-0001a7b0: 3633 3845 4336 2729 0a20 2020 2020 2020  638EC6').       
-0001a7c0: 2020 2020 206f 7074 696f 6e73 2e73 6574       options.set
-0001a7d0: 6465 6661 756c 7428 2762 6172 5f62 6f72  default('bar_bor
-0001a7e0: 6465 725f 636f 6c6f 7227 2c20 6f70 7469  der_color', opti
-0001a7f0: 6f6e 735b 2762 6172 5f63 6f6c 6f72 275d  ons['bar_color']
-0001a800: 290a 2020 2020 2020 2020 2020 2020 6f70  ).            op
-0001a810: 7469 6f6e 732e 7365 7464 6566 6175 6c74  tions.setdefault
-0001a820: 2827 6261 725f 6f6e 6c79 272c 2046 616c  ('bar_only', Fal
-0001a830: 7365 290a 2020 2020 2020 2020 2020 2020  se).            
-0001a840: 6f70 7469 6f6e 732e 7365 7464 6566 6175  options.setdefau
-0001a850: 6c74 2827 6261 725f 6e6f 5f62 6f72 6465  lt('bar_no_borde
-0001a860: 7227 2c20 4661 6c73 6529 0a20 2020 2020  r', False).     
-0001a870: 2020 2020 2020 206f 7074 696f 6e73 2e73         options.s
-0001a880: 6574 6465 6661 756c 7428 2762 6172 5f73  etdefault('bar_s
-0001a890: 6f6c 6964 272c 2046 616c 7365 290a 2020  olid', False).  
-0001a8a0: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
-0001a8b0: 732e 7365 7464 6566 6175 6c74 2827 6261  s.setdefault('ba
-0001a8c0: 725f 6469 7265 6374 696f 6e27 2c20 2727  r_direction', ''
-0001a8d0: 290a 2020 2020 2020 2020 2020 2020 6f70  ).            op
-0001a8e0: 7469 6f6e 732e 7365 7464 6566 6175 6c74  tions.setdefault
-0001a8f0: 2827 6261 725f 6e65 6761 7469 7665 5f63  ('bar_negative_c
-0001a900: 6f6c 6f72 272c 2027 2346 4630 3030 3027  olor', '#FF0000'
-0001a910: 290a 2020 2020 2020 2020 2020 2020 6f70  ).            op
-0001a920: 7469 6f6e 732e 7365 7464 6566 6175 6c74  tions.setdefault
-0001a930: 2827 6261 725f 6e65 6761 7469 7665 5f62  ('bar_negative_b
-0001a940: 6f72 6465 725f 636f 6c6f 7227 2c20 2723  order_color', '#
-0001a950: 4646 3030 3030 2729 0a20 2020 2020 2020  FF0000').       
-0001a960: 2020 2020 206f 7074 696f 6e73 2e73 6574       options.set
-0001a970: 6465 6661 756c 7428 2762 6172 5f6e 6567  default('bar_neg
-0001a980: 6174 6976 655f 636f 6c6f 725f 7361 6d65  ative_color_same
-0001a990: 272c 2046 616c 7365 290a 2020 2020 2020  ', False).      
-0001a9a0: 2020 2020 2020 6f70 7469 6f6e 732e 7365        options.se
-0001a9b0: 7464 6566 6175 6c74 2827 6261 725f 6e65  tdefault('bar_ne
-0001a9c0: 6761 7469 7665 5f62 6f72 6465 725f 636f  gative_border_co
-0001a9d0: 6c6f 725f 7361 6d65 272c 2046 616c 7365  lor_same', False
-0001a9e0: 290a 2020 2020 2020 2020 2020 2020 6f70  ).            op
-0001a9f0: 7469 6f6e 732e 7365 7464 6566 6175 6c74  tions.setdefault
-0001aa00: 2827 6261 725f 6178 6973 5f70 6f73 6974  ('bar_axis_posit
-0001aa10: 696f 6e27 2c20 2727 290a 2020 2020 2020  ion', '').      
-0001aa20: 2020 2020 2020 6f70 7469 6f6e 732e 7365        options.se
-0001aa30: 7464 6566 6175 6c74 2827 6261 725f 6178  tdefault('bar_ax
-0001aa40: 6973 5f63 6f6c 6f72 272c 2027 2330 3030  is_color', '#000
-0001aa50: 3030 3027 290a 0a20 2020 2020 2020 2020  000')..         
-0001aa60: 2020 206f 7074 696f 6e73 5b27 6261 725f     options['bar_
-0001aa70: 636f 6c6f 7227 5d20 3d20 786c 5f63 6f6c  color'] = xl_col
-0001aa80: 6f72 286f 7074 696f 6e73 5b27 6261 725f  or(options['bar_
-0001aa90: 636f 6c6f 7227 5d29 0a20 2020 2020 2020  color']).       
-0001aaa0: 2020 2020 206f 7074 696f 6e73 5b27 6261       options['ba
-0001aab0: 725f 626f 7264 6572 5f63 6f6c 6f72 275d  r_border_color']
-0001aac0: 203d 2078 6c5f 636f 6c6f 7228 6f70 7469   = xl_color(opti
-0001aad0: 6f6e 735b 2762 6172 5f62 6f72 6465 725f  ons['bar_border_
-0001aae0: 636f 6c6f 7227 5d29 0a20 2020 2020 2020  color']).       
-0001aaf0: 2020 2020 206f 7074 696f 6e73 5b27 6261       options['ba
-0001ab00: 725f 6178 6973 5f63 6f6c 6f72 275d 203d  r_axis_color'] =
-0001ab10: 2078 6c5f 636f 6c6f 7228 6f70 7469 6f6e   xl_color(option
-0001ab20: 735b 2762 6172 5f61 7869 735f 636f 6c6f  s['bar_axis_colo
-0001ab30: 7227 5d29 0a20 2020 2020 2020 2020 2020  r']).           
-0001ab40: 206f 7074 696f 6e73 5b27 6261 725f 6e65   options['bar_ne
-0001ab50: 6761 7469 7665 5f63 6f6c 6f72 275d 203d  gative_color'] =
-0001ab60: 205c 0a20 2020 2020 2020 2020 2020 2020   \.             
-0001ab70: 2020 2078 6c5f 636f 6c6f 7228 6f70 7469     xl_color(opti
-0001ab80: 6f6e 735b 2762 6172 5f6e 6567 6174 6976  ons['bar_negativ
-0001ab90: 655f 636f 6c6f 7227 5d29 0a20 2020 2020  e_color']).     
-0001aba0: 2020 2020 2020 206f 7074 696f 6e73 5b27         options['
-0001abb0: 6261 725f 6e65 6761 7469 7665 5f62 6f72  bar_negative_bor
-0001abc0: 6465 725f 636f 6c6f 7227 5d20 3d20 5c0a  der_color'] = \.
-0001abd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001abe0: 786c 5f63 6f6c 6f72 286f 7074 696f 6e73  xl_color(options
-0001abf0: 5b27 6261 725f 6e65 6761 7469 7665 5f62  ['bar_negative_b
-0001ac00: 6f72 6465 725f 636f 6c6f 7227 5d29 0a0a  order_color'])..
-0001ac10: 2020 2020 2020 2020 2320 4164 6a75 7374          # Adjust
-0001ac20: 2066 6f72 2032 3031 3020 7374 796c 6520   for 2010 style 
-0001ac30: 6461 7461 5f62 6172 2070 6172 616d 6574  data_bar paramet
-0001ac40: 6572 732e 0a20 2020 2020 2020 2069 6620  ers..        if 
-0001ac50: 6f70 7469 6f6e 732e 6765 7428 2769 735f  options.get('is_
-0001ac60: 6461 7461 5f62 6172 5f32 3031 3027 293a  data_bar_2010'):
-0001ac70: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0001ac80: 662e 6578 6365 6c5f 7665 7273 696f 6e20  f.excel_version 
-0001ac90: 3d20 3230 3130 0a0a 2020 2020 2020 2020  = 2010..        
-0001aca0: 2020 2020 6966 206f 7074 696f 6e73 5b27      if options['
-0001acb0: 6d69 6e5f 7479 7065 275d 203d 3d20 276d  min_type'] == 'm
-0001acc0: 696e 2720 616e 6420 6f70 7469 6f6e 735b  in' and options[
-0001acd0: 276d 696e 5f76 616c 7565 275d 203d 3d20  'min_value'] == 
-0001ace0: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-0001acf0: 2020 206f 7074 696f 6e73 5b27 6d69 6e5f     options['min_
-0001ad00: 7661 6c75 6527 5d20 3d20 4e6f 6e65 0a0a  value'] = None..
-0001ad10: 2020 2020 2020 2020 2020 2020 6966 206f              if o
-0001ad20: 7074 696f 6e73 5b27 6d61 785f 7479 7065  ptions['max_type
-0001ad30: 275d 203d 3d20 276d 6178 2720 616e 6420  '] == 'max' and 
-0001ad40: 6f70 7469 6f6e 735b 276d 6178 5f76 616c  options['max_val
-0001ad50: 7565 275d 203d 3d20 303a 0a20 2020 2020  ue'] == 0:.     
-0001ad60: 2020 2020 2020 2020 2020 206f 7074 696f             optio
-0001ad70: 6e73 5b27 6d61 785f 7661 6c75 6527 5d20  ns['max_value'] 
-0001ad80: 3d20 4e6f 6e65 0a0a 2020 2020 2020 2020  = None..        
-0001ad90: 2020 2020 6f70 7469 6f6e 735b 2772 616e      options['ran
-0001ada0: 6765 275d 203d 2063 656c 6c5f 7261 6e67  ge'] = cell_rang
-0001adb0: 650a 0a20 2020 2020 2020 2023 2053 7472  e..        # Str
-0001adc0: 6970 2074 6865 206c 6561 6469 6e67 203d  ip the leading =
-0001add0: 2066 726f 6d20 666f 726d 756c 6173 2e0a   from formulas..
-0001ade0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-0001adf0: 2020 2020 2020 2020 206f 7074 696f 6e73           options
-0001ae00: 5b27 6d69 6e5f 7661 6c75 6527 5d20 3d20  ['min_value'] = 
-0001ae10: 6f70 7469 6f6e 735b 276d 696e 5f76 616c  options['min_val
-0001ae20: 7565 275d 2e6c 7374 7269 7028 273d 2729  ue'].lstrip('=')
-0001ae30: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-0001ae40: 284b 6579 4572 726f 722c 2041 7474 7269  (KeyError, Attri
-0001ae50: 6275 7465 4572 726f 7229 3a0a 2020 2020  buteError):.    
-0001ae60: 2020 2020 2020 2020 7061 7373 0a20 2020          pass.   
-0001ae70: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
-0001ae80: 2020 2020 2020 6f70 7469 6f6e 735b 276d        options['m
-0001ae90: 6964 5f76 616c 7565 275d 203d 206f 7074  id_value'] = opt
-0001aea0: 696f 6e73 5b27 6d69 645f 7661 6c75 6527  ions['mid_value'
-0001aeb0: 5d2e 6c73 7472 6970 2827 3d27 290a 2020  ].lstrip('=').  
-0001aec0: 2020 2020 2020 6578 6365 7074 2028 4b65        except (Ke
-0001aed0: 7945 7272 6f72 2c20 4174 7472 6962 7574  yError, Attribut
-0001aee0: 6545 7272 6f72 293a 0a20 2020 2020 2020  eError):.       
-0001aef0: 2020 2020 2070 6173 730a 2020 2020 2020       pass.      
-0001af00: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
-0001af10: 2020 206f 7074 696f 6e73 5b27 6d61 785f     options['max_
-0001af20: 7661 6c75 6527 5d20 3d20 6f70 7469 6f6e  value'] = option
-0001af30: 735b 276d 6178 5f76 616c 7565 275d 2e6c  s['max_value'].l
-0001af40: 7374 7269 7028 273d 2729 0a20 2020 2020  strip('=').     
-0001af50: 2020 2065 7863 6570 7420 284b 6579 4572     except (KeyEr
-0001af60: 726f 722c 2041 7474 7269 6275 7465 4572  ror, AttributeEr
-0001af70: 726f 7229 3a0a 2020 2020 2020 2020 2020  ror):.          
-0001af80: 2020 7061 7373 0a0a 2020 2020 2020 2020    pass..        
-0001af90: 2320 5374 6f72 6520 7468 6520 636f 6e64  # Store the cond
-0001afa0: 6974 696f 6e61 6c20 666f 726d 6174 2075  itional format u
-0001afb0: 6e74 696c 2077 6520 636c 6f73 6520 7468  ntil we close th
-0001afc0: 6520 776f 726b 7368 6565 742e 0a20 2020  e worksheet..   
-0001afd0: 2020 2020 2069 6620 6365 6c6c 5f72 616e       if cell_ran
-0001afe0: 6765 2069 6e20 7365 6c66 2e63 6f6e 645f  ge in self.cond_
-0001aff0: 666f 726d 6174 733a 0a20 2020 2020 2020  formats:.       
-0001b000: 2020 2020 2073 656c 662e 636f 6e64 5f66       self.cond_f
-0001b010: 6f72 6d61 7473 5b63 656c 6c5f 7261 6e67  ormats[cell_rang
-0001b020: 655d 2e61 7070 656e 6428 6f70 7469 6f6e  e].append(option
-0001b030: 7329 0a20 2020 2020 2020 2065 6c73 653a  s).        else:
-0001b040: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0001b050: 662e 636f 6e64 5f66 6f72 6d61 7473 5b63  f.cond_formats[c
-0001b060: 656c 6c5f 7261 6e67 655d 203d 205b 6f70  ell_range] = [op
-0001b070: 7469 6f6e 735d 0a0a 2020 2020 2020 2020  tions]..        
-0001b080: 7265 7475 726e 2030 0a0a 2020 2020 4063  return 0..    @c
-0001b090: 6f6e 7665 7274 5f72 616e 6765 5f61 7267  onvert_range_arg
-0001b0a0: 730a 2020 2020 6465 6620 6164 645f 7461  s.    def add_ta
-0001b0b0: 626c 6528 7365 6c66 2c20 6669 7273 745f  ble(self, first_
-0001b0c0: 726f 772c 2066 6972 7374 5f63 6f6c 2c20  row, first_col, 
-0001b0d0: 6c61 7374 5f72 6f77 2c20 6c61 7374 5f63  last_row, last_c
-0001b0e0: 6f6c 2c0a 2020 2020 2020 2020 2020 2020  ol,.            
-0001b0f0: 2020 2020 2020 6f70 7469 6f6e 733d 4e6f        options=No
-0001b100: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
-0001b110: 0a20 2020 2020 2020 2041 6464 2061 6e20  .        Add an 
-0001b120: 4578 6365 6c20 7461 626c 6520 746f 2061  Excel table to a
-0001b130: 2077 6f72 6b73 6865 6574 2e0a 0a20 2020   worksheet...   
-0001b140: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
-0001b150: 2020 2020 2020 2066 6972 7374 5f72 6f77         first_row
-0001b160: 3a20 2020 2054 6865 2066 6972 7374 2072  :    The first r
-0001b170: 6f77 206f 6620 7468 6520 6365 6c6c 2072  ow of the cell r
-0001b180: 616e 6765 2e20 287a 6572 6f20 696e 6465  ange. (zero inde
-0001b190: 7865 6429 2e0a 2020 2020 2020 2020 2020  xed)..          
-0001b1a0: 2020 6669 7273 745f 636f 6c3a 2020 2020    first_col:    
-0001b1b0: 5468 6520 6669 7273 7420 636f 6c75 6d6e  The first column
-0001b1c0: 206f 6620 7468 6520 6365 6c6c 2072 616e   of the cell ran
-0001b1d0: 6765 2e0a 2020 2020 2020 2020 2020 2020  ge..            
-0001b1e0: 6c61 7374 5f72 6f77 3a20 2020 2020 5468  last_row:     Th
-0001b1f0: 6520 6c61 7374 2072 6f77 206f 6620 7468  e last row of th
-0001b200: 6520 6365 6c6c 2072 616e 6765 2e20 287a  e cell range. (z
-0001b210: 6572 6f20 696e 6465 7865 6429 2e0a 2020  ero indexed)..  
-0001b220: 2020 2020 2020 2020 2020 6c61 7374 5f63            last_c
-0001b230: 6f6c 3a20 2020 2020 5468 6520 6c61 7374  ol:     The last
-0001b240: 2063 6f6c 756d 6e20 6f66 2074 6865 2063   column of the c
-0001b250: 656c 6c20 7261 6e67 652e 0a20 2020 2020  ell range..     
-0001b260: 2020 2020 2020 206f 7074 696f 6e73 3a20         options: 
-0001b270: 2020 2020 2054 6162 6c65 2066 6f72 6d61       Table forma
-0001b280: 7420 6f70 7469 6f6e 732e 2028 4f70 7469  t options. (Opti
-0001b290: 6f6e 616c 290a 0a20 2020 2020 2020 2052  onal)..        R
-0001b2a0: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
-0001b2b0: 2020 2020 303a 2020 5375 6363 6573 732e      0:  Success.
-0001b2c0: 0a20 2020 2020 2020 2020 2020 202d 313a  .            -1:
-0001b2d0: 2052 6f77 206f 7220 636f 6c75 6d6e 2069   Row or column i
-0001b2e0: 7320 6f75 7420 6f66 2077 6f72 6b73 6865  s out of workshe
-0001b2f0: 6574 2062 6f75 6e64 732e 0a20 2020 2020  et bounds..     
-0001b300: 2020 2020 2020 202d 323a 2049 6e63 6f72         -2: Incor
-0001b310: 7265 6374 2070 6172 616d 6574 6572 206f  rect parameter o
-0001b320: 7220 6f70 7469 6f6e 2e0a 2020 2020 2020  r option..      
-0001b330: 2020 2020 2020 2d33 3a20 4e6f 7420 7375        -3: Not su
-0001b340: 7070 6f72 7465 6420 696e 2063 6f6e 7374  pported in const
-0001b350: 616e 745f 6d65 6d6f 7279 206d 6f64 652e  ant_memory mode.
-0001b360: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001b370: 2020 2020 2074 6162 6c65 203d 207b 7d0a       table = {}.
-0001b380: 2020 2020 2020 2020 636f 6c5f 666f 726d          col_form
-0001b390: 6174 7320 3d20 7b7d 0a0a 2020 2020 2020  ats = {}..      
-0001b3a0: 2020 6966 206f 7074 696f 6e73 2069 7320    if options is 
-0001b3b0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0001b3c0: 2020 6f70 7469 6f6e 7320 3d20 7b7d 0a20    options = {}. 
-0001b3d0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0001b3e0: 2020 2020 2020 2020 2023 2043 6f70 7920           # Copy 
-0001b3f0: 7468 6520 7573 6572 2064 6566 696e 6564  the user defined
-0001b400: 206f 7074 696f 6e73 2073 6f20 7468 6579   options so they
-0001b410: 2061 7265 6e27 7420 6d6f 6469 6669 6564   aren't modified
-0001b420: 2e0a 2020 2020 2020 2020 2020 2020 6f70  ..            op
-0001b430: 7469 6f6e 7320 3d20 6f70 7469 6f6e 732e  tions = options.
-0001b440: 636f 7079 2829 0a0a 2020 2020 2020 2020  copy()..        
-0001b450: 6966 2073 656c 662e 636f 6e73 7461 6e74  if self.constant
-0001b460: 5f6d 656d 6f72 793a 0a20 2020 2020 2020  _memory:.       
-0001b470: 2020 2020 2077 6172 6e28 2261 6464 5f74       warn("add_t
-0001b480: 6162 6c65 2829 2069 736e 2774 2073 7570  able() isn't sup
-0001b490: 706f 7274 6564 2069 6e20 2763 6f6e 7374  ported in 'const
-0001b4a0: 616e 745f 6d65 6d6f 7279 2720 6d6f 6465  ant_memory' mode
-0001b4b0: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
-0001b4c0: 6574 7572 6e20 2d33 0a0a 2020 2020 2020  eturn -3..      
-0001b4d0: 2020 2320 4368 6563 6b20 7468 6174 2072    # Check that r
-0001b4e0: 6f77 2061 6e64 2063 6f6c 2061 7265 2076  ow and col are v
-0001b4f0: 616c 6964 2077 6974 686f 7574 2073 746f  alid without sto
-0001b500: 7269 6e67 2074 6865 2076 616c 7565 732e  ring the values.
-0001b510: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0001b520: 2e5f 6368 6563 6b5f 6469 6d65 6e73 696f  ._check_dimensio
-0001b530: 6e73 2866 6972 7374 5f72 6f77 2c20 6669  ns(first_row, fi
-0001b540: 7273 745f 636f 6c2c 2054 7275 652c 2054  rst_col, True, T
-0001b550: 7275 6529 3a0a 2020 2020 2020 2020 2020  rue):.          
-0001b560: 2020 7265 7475 726e 202d 310a 2020 2020    return -1.    
-0001b570: 2020 2020 6966 2073 656c 662e 5f63 6865      if self._che
-0001b580: 636b 5f64 696d 656e 7369 6f6e 7328 6c61  ck_dimensions(la
-0001b590: 7374 5f72 6f77 2c20 6c61 7374 5f63 6f6c  st_row, last_col
-0001b5a0: 2c20 5472 7565 2c20 5472 7565 293a 0a20  , True, True):. 
-0001b5b0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001b5c0: 6e20 2d31 0a0a 2020 2020 2020 2020 2320  n -1..        # 
-0001b5d0: 5377 6170 206c 6173 7420 726f 772f 636f  Swap last row/co
-0001b5e0: 6c20 666f 7220 6669 7273 7420 726f 772f  l for first row/
-0001b5f0: 636f 6c20 6173 206e 6563 6573 7361 7279  col as necessary
-0001b600: 2e0a 2020 2020 2020 2020 6966 2066 6972  ..        if fir
-0001b610: 7374 5f72 6f77 203e 206c 6173 745f 726f  st_row > last_ro
-0001b620: 773a 0a20 2020 2020 2020 2020 2020 2028  w:.            (
-0001b630: 6669 7273 745f 726f 772c 206c 6173 745f  first_row, last_
-0001b640: 726f 7729 203d 2028 6c61 7374 5f72 6f77  row) = (last_row
-0001b650: 2c20 6669 7273 745f 726f 7729 0a20 2020  , first_row).   
-0001b660: 2020 2020 2069 6620 6669 7273 745f 636f       if first_co
-0001b670: 6c20 3e20 6c61 7374 5f63 6f6c 3a0a 2020  l > last_col:.  
-0001b680: 2020 2020 2020 2020 2020 2866 6972 7374            (first
-0001b690: 5f63 6f6c 2c20 6c61 7374 5f63 6f6c 2920  _col, last_col) 
-0001b6a0: 3d20 286c 6173 745f 636f 6c2c 2066 6972  = (last_col, fir
-0001b6b0: 7374 5f63 6f6c 290a 0a20 2020 2020 2020  st_col)..       
-0001b6c0: 2023 2043 6865 636b 2069 6620 7468 6520   # Check if the 
-0001b6d0: 7461 626c 6520 7261 6e67 6520 6f76 6572  table range over
-0001b6e0: 6c61 7073 2061 2070 7265 7669 6f75 7320  laps a previous 
-0001b6f0: 6d65 7267 6564 206f 7220 7461 626c 6520  merged or table 
-0001b700: 7261 6e67 652e 0a20 2020 2020 2020 2023  range..        #
-0001b710: 2054 6869 7320 6973 2061 2063 7269 7469   This is a criti
-0001b720: 6361 6c20 6669 6c65 2063 6f72 7275 7074  cal file corrupt
-0001b730: 696f 6e20 6572 726f 7220 696e 2045 7863  ion error in Exc
-0001b740: 656c 2e0a 2020 2020 2020 2020 6365 6c6c  el..        cell
-0001b750: 5f72 616e 6765 203d 2078 6c5f 7261 6e67  _range = xl_rang
-0001b760: 6528 6669 7273 745f 726f 772c 2066 6972  e(first_row, fir
-0001b770: 7374 5f63 6f6c 2c20 6c61 7374 5f72 6f77  st_col, last_row
-0001b780: 2c20 6c61 7374 5f63 6f6c 290a 2020 2020  , last_col).    
-0001b790: 2020 2020 666f 7220 726f 7720 696e 2072      for row in r
-0001b7a0: 616e 6765 2866 6972 7374 5f72 6f77 2c20  ange(first_row, 
-0001b7b0: 6c61 7374 5f72 6f77 202b 2031 293a 0a20  last_row + 1):. 
-0001b7c0: 2020 2020 2020 2020 2020 2066 6f72 2063             for c
-0001b7d0: 6f6c 2069 6e20 7261 6e67 6528 6669 7273  ol in range(firs
-0001b7e0: 745f 636f 6c2c 206c 6173 745f 636f 6c20  t_col, last_col 
-0001b7f0: 2b20 3129 3a0a 2020 2020 2020 2020 2020  + 1):.          
-0001b800: 2020 2020 2020 6966 2073 656c 662e 7461        if self.ta
-0001b810: 626c 655f 6365 6c6c 732e 6765 7428 2872  ble_cells.get((r
-0001b820: 6f77 2c20 636f 6c29 293a 0a20 2020 2020  ow, col)):.     
-0001b830: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0001b840: 7265 7669 6f75 735f 7261 6e67 6520 3d20  revious_range = 
-0001b850: 7365 6c66 2e74 6162 6c65 5f63 656c 6c73  self.table_cells
-0001b860: 2e67 6574 2828 726f 772c 2063 6f6c 2929  .get((row, col))
-0001b870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b880: 2020 2020 2072 6169 7365 204f 7665 726c       raise Overl
-0001b890: 6170 7069 6e67 5261 6e67 6528 0a20 2020  appingRange(.   
-0001b8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b8b0: 2020 2020 2022 5461 626c 6520 7261 6e67       "Table rang
-0001b8c0: 6520 2725 7327 206f 7665 726c 6170 7320  e '%s' overlaps 
-0001b8d0: 7072 6576 696f 7573 2074 6162 6c65 2072  previous table r
-0001b8e0: 616e 6765 2027 2573 272e 220a 2020 2020  ange '%s'.".    
-0001b8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b900: 2020 2020 2520 2863 656c 6c5f 7261 6e67      % (cell_rang
-0001b910: 652c 2070 7265 7669 6f75 735f 7261 6e67  e, previous_rang
-0001b920: 6529 290a 2020 2020 2020 2020 2020 2020  e)).            
-0001b930: 2020 2020 656c 6966 2073 656c 662e 6d65      elif self.me
-0001b940: 7267 6564 5f63 656c 6c73 2e67 6574 2828  rged_cells.get((
-0001b950: 726f 772c 2063 6f6c 2929 3a0a 2020 2020  row, col)):.    
-0001b960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b970: 7072 6576 696f 7573 5f72 616e 6765 203d  previous_range =
-0001b980: 2073 656c 662e 6d65 7267 6564 5f63 656c   self.merged_cel
-0001b990: 6c73 2e67 6574 2828 726f 772c 2063 6f6c  ls.get((row, col
-0001b9a0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-0001b9b0: 2020 2020 2020 2072 6169 7365 204f 7665         raise Ove
-0001b9c0: 726c 6170 7069 6e67 5261 6e67 6528 0a20  rlappingRange(. 
-0001b9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b9e0: 2020 2020 2020 2022 5461 626c 6520 7261         "Table ra
-0001b9f0: 6e67 6520 2725 7327 206f 7665 726c 6170  nge '%s' overlap
-0001ba00: 7320 7072 6576 696f 7573 206d 6572 6765  s previous merge
-0001ba10: 2072 616e 6765 2027 2573 272e 220a 2020   range '%s'.".  
-0001ba20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ba30: 2020 2020 2020 2520 2863 656c 6c5f 7261        % (cell_ra
-0001ba40: 6e67 652c 2070 7265 7669 6f75 735f 7261  nge, previous_ra
-0001ba50: 6e67 6529 290a 2020 2020 2020 2020 2020  nge)).          
-0001ba60: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0001ba70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ba80: 7365 6c66 2e74 6162 6c65 5f63 656c 6c73  self.table_cells
-0001ba90: 5b28 726f 772c 2063 6f6c 295d 203d 2063  [(row, col)] = c
-0001baa0: 656c 6c5f 7261 6e67 650a 0a20 2020 2020  ell_range..     
-0001bab0: 2020 2023 2056 616c 6964 2069 6e70 7574     # Valid input
-0001bac0: 2070 6172 616d 6574 6572 732e 0a20 2020   parameters..   
-0001bad0: 2020 2020 2076 616c 6964 5f70 6172 616d       valid_param
-0001bae0: 6574 6572 203d 207b 0a20 2020 2020 2020  eter = {.       
-0001baf0: 2020 2020 2027 6175 746f 6669 6c74 6572       'autofilter
-0001bb00: 272c 0a20 2020 2020 2020 2020 2020 2027  ',.            '
-0001bb10: 6261 6e64 6564 5f63 6f6c 756d 6e73 272c  banded_columns',
-0001bb20: 0a20 2020 2020 2020 2020 2020 2027 6261  .            'ba
-0001bb30: 6e64 6564 5f72 6f77 7327 2c0a 2020 2020  nded_rows',.    
-0001bb40: 2020 2020 2020 2020 2763 6f6c 756d 6e73          'columns
-0001bb50: 272c 0a20 2020 2020 2020 2020 2020 2027  ',.            '
-0001bb60: 6461 7461 272c 0a20 2020 2020 2020 2020  data',.         
-0001bb70: 2020 2027 6669 7273 745f 636f 6c75 6d6e     'first_column
-0001bb80: 272c 0a20 2020 2020 2020 2020 2020 2027  ',.            '
-0001bb90: 6865 6164 6572 5f72 6f77 272c 0a20 2020  header_row',.   
-0001bba0: 2020 2020 2020 2020 2027 6c61 7374 5f63           'last_c
-0001bbb0: 6f6c 756d 6e27 2c0a 2020 2020 2020 2020  olumn',.        
-0001bbc0: 2020 2020 276e 616d 6527 2c0a 2020 2020      'name',.    
-0001bbd0: 2020 2020 2020 2020 2773 7479 6c65 272c          'style',
-0001bbe0: 0a20 2020 2020 2020 2020 2020 2027 746f  .            'to
-0001bbf0: 7461 6c5f 726f 7727 2c0a 2020 2020 2020  tal_row',.      
-0001bc00: 2020 7d0a 0a20 2020 2020 2020 2023 2043    }..        # C
-0001bc10: 6865 636b 2066 6f72 2076 616c 6964 2069  heck for valid i
-0001bc20: 6e70 7574 2070 6172 616d 6574 6572 732e  nput parameters.
-0001bc30: 0a20 2020 2020 2020 2066 6f72 2070 6172  .        for par
-0001bc40: 616d 5f6b 6579 2069 6e20 6f70 7469 6f6e  am_key in option
-0001bc50: 732e 6b65 7973 2829 3a0a 2020 2020 2020  s.keys():.      
-0001bc60: 2020 2020 2020 6966 2070 6172 616d 5f6b        if param_k
-0001bc70: 6579 206e 6f74 2069 6e20 7661 6c69 645f  ey not in valid_
-0001bc80: 7061 7261 6d65 7465 723a 0a20 2020 2020  parameter:.     
-0001bc90: 2020 2020 2020 2020 2020 2077 6172 6e28             warn(
-0001bca0: 2255 6e6b 6e6f 776e 2070 6172 616d 6574  "Unknown paramet
-0001bcb0: 6572 2027 2573 2720 696e 2061 6464 5f74  er '%s' in add_t
-0001bcc0: 6162 6c65 2829 2220 2520 7061 7261 6d5f  able()" % param_
-0001bcd0: 6b65 7929 0a20 2020 2020 2020 2020 2020  key).           
-0001bce0: 2020 2020 2072 6574 7572 6e20 2d32 0a0a       return -2..
-0001bcf0: 2020 2020 2020 2020 2320 5475 726e 206f          # Turn o
-0001bd00: 6e20 4578 6365 6c27 7320 6465 6661 756c  n Excel's defaul
-0001bd10: 7473 2e0a 2020 2020 2020 2020 6f70 7469  ts..        opti
-0001bd20: 6f6e 735b 2762 616e 6465 645f 726f 7773  ons['banded_rows
-0001bd30: 275d 203d 206f 7074 696f 6e73 2e67 6574  '] = options.get
-0001bd40: 2827 6261 6e64 6564 5f72 6f77 7327 2c20  ('banded_rows', 
-0001bd50: 5472 7565 290a 2020 2020 2020 2020 6f70  True).        op
-0001bd60: 7469 6f6e 735b 2768 6561 6465 725f 726f  tions['header_ro
-0001bd70: 7727 5d20 3d20 6f70 7469 6f6e 732e 6765  w'] = options.ge
-0001bd80: 7428 2768 6561 6465 725f 726f 7727 2c20  t('header_row', 
-0001bd90: 5472 7565 290a 2020 2020 2020 2020 6f70  True).        op
-0001bda0: 7469 6f6e 735b 2761 7574 6f66 696c 7465  tions['autofilte
-0001bdb0: 7227 5d20 3d20 6f70 7469 6f6e 732e 6765  r'] = options.ge
-0001bdc0: 7428 2761 7574 6f66 696c 7465 7227 2c20  t('autofilter', 
-0001bdd0: 5472 7565 290a 0a20 2020 2020 2020 2023  True)..        #
-0001bde0: 2043 6865 636b 2074 6861 7420 7468 6572   Check that ther
-0001bdf0: 6520 6172 6520 656e 6f75 6768 2072 6f77  e are enough row
-0001be00: 732e 0a20 2020 2020 2020 206e 756d 5f72  s..        num_r
-0001be10: 6f77 7320 3d20 6c61 7374 5f72 6f77 202d  ows = last_row -
-0001be20: 2066 6972 7374 5f72 6f77 0a20 2020 2020   first_row.     
-0001be30: 2020 2069 6620 6f70 7469 6f6e 735b 2768     if options['h
-0001be40: 6561 6465 725f 726f 7727 5d3a 0a20 2020  eader_row']:.   
-0001be50: 2020 2020 2020 2020 206e 756d 5f72 6f77           num_row
-0001be60: 7320 2d3d 2031 0a0a 2020 2020 2020 2020  s -= 1..        
-0001be70: 6966 206e 756d 5f72 6f77 7320 3c20 303a  if num_rows < 0:
-0001be80: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
-0001be90: 6e28 224d 7573 7420 6861 7665 2061 7420  n("Must have at 
-0001bea0: 6c65 6173 7420 6f6e 6520 6461 7461 2072  least one data r
-0001beb0: 6f77 2069 6e20 696e 2061 6464 5f74 6162  ow in in add_tab
-0001bec0: 6c65 2829 2229 0a20 2020 2020 2020 2020  le()").         
-0001bed0: 2020 2072 6574 7572 6e20 2d32 0a0a 2020     return -2..  
-0001bee0: 2020 2020 2020 2320 5365 7420 7468 6520        # Set the 
-0001bef0: 7461 626c 6520 6f70 7469 6f6e 732e 0a20  table options.. 
-0001bf00: 2020 2020 2020 2074 6162 6c65 5b27 7368         table['sh
-0001bf10: 6f77 5f66 6972 7374 5f63 6f6c 275d 203d  ow_first_col'] =
-0001bf20: 206f 7074 696f 6e73 2e67 6574 2827 6669   options.get('fi
-0001bf30: 7273 745f 636f 6c75 6d6e 272c 2046 616c  rst_column', Fal
-0001bf40: 7365 290a 2020 2020 2020 2020 7461 626c  se).        tabl
-0001bf50: 655b 2773 686f 775f 6c61 7374 5f63 6f6c  e['show_last_col
-0001bf60: 275d 203d 206f 7074 696f 6e73 2e67 6574  '] = options.get
-0001bf70: 2827 6c61 7374 5f63 6f6c 756d 6e27 2c20  ('last_column', 
-0001bf80: 4661 6c73 6529 0a20 2020 2020 2020 2074  False).        t
-0001bf90: 6162 6c65 5b27 7368 6f77 5f72 6f77 5f73  able['show_row_s
-0001bfa0: 7472 6970 6573 275d 203d 206f 7074 696f  tripes'] = optio
-0001bfb0: 6e73 2e67 6574 2827 6261 6e64 6564 5f72  ns.get('banded_r
-0001bfc0: 6f77 7327 2c20 4661 6c73 6529 0a20 2020  ows', False).   
-0001bfd0: 2020 2020 2074 6162 6c65 5b27 7368 6f77       table['show
-0001bfe0: 5f63 6f6c 5f73 7472 6970 6573 275d 203d  _col_stripes'] =
-0001bff0: 206f 7074 696f 6e73 2e67 6574 2827 6261   options.get('ba
-0001c000: 6e64 6564 5f63 6f6c 756d 6e73 272c 2046  nded_columns', F
-0001c010: 616c 7365 290a 2020 2020 2020 2020 7461  alse).        ta
-0001c020: 626c 655b 2768 6561 6465 725f 726f 775f  ble['header_row_
-0001c030: 636f 756e 7427 5d20 3d20 6f70 7469 6f6e  count'] = option
-0001c040: 732e 6765 7428 2768 6561 6465 725f 726f  s.get('header_ro
-0001c050: 7727 2c20 3029 0a20 2020 2020 2020 2074  w', 0).        t
-0001c060: 6162 6c65 5b27 746f 7461 6c73 5f72 6f77  able['totals_row
-0001c070: 5f73 686f 776e 275d 203d 206f 7074 696f  _shown'] = optio
-0001c080: 6e73 2e67 6574 2827 746f 7461 6c5f 726f  ns.get('total_ro
-0001c090: 7727 2c20 4661 6c73 6529 0a0a 2020 2020  w', False)..    
-0001c0a0: 2020 2020 2320 5365 7420 7468 6520 7461      # Set the ta
-0001c0b0: 626c 6520 6e61 6d65 2e0a 2020 2020 2020  ble name..      
-0001c0c0: 2020 6966 2027 6e61 6d65 2720 696e 206f    if 'name' in o
-0001c0d0: 7074 696f 6e73 3a0a 2020 2020 2020 2020  ptions:.        
-0001c0e0: 2020 2020 6e61 6d65 203d 206f 7074 696f      name = optio
-0001c0f0: 6e73 5b27 6e61 6d65 275d 0a20 2020 2020  ns['name'].     
-0001c100: 2020 2020 2020 2074 6162 6c65 5b27 6e61         table['na
-0001c110: 6d65 275d 203d 206e 616d 650a 0a20 2020  me'] = name..   
-0001c120: 2020 2020 2020 2020 2069 6620 2720 2720           if ' ' 
-0001c130: 696e 206e 616d 653a 0a20 2020 2020 2020  in name:.       
-0001c140: 2020 2020 2020 2020 2077 6172 6e28 224e           warn("N
-0001c150: 616d 6520 2725 7327 2069 6e20 6164 645f  ame '%s' in add_
-0001c160: 7461 626c 6528 2920 6361 6e6e 6f74 2063  table() cannot c
-0001c170: 6f6e 7461 696e 2073 7061 6365 7322 2025  ontain spaces" %
-0001c180: 206e 616d 6529 0a20 2020 2020 2020 2020   name).         
-0001c190: 2020 2020 2020 2072 6574 7572 6e20 2d32         return -2
-0001c1a0: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-0001c1b0: 5761 726e 2069 6620 7468 6520 6e61 6d65  Warn if the name
-0001c1c0: 2063 6f6e 7461 696e 7320 696e 7661 6c69   contains invali
-0001c1d0: 6420 6368 6172 7320 6173 2064 6566 696e  d chars as defin
-0001c1e0: 6564 2062 7920 4578 6365 6c2e 0a20 2020  ed by Excel..   
-0001c1f0: 2020 2020 2020 2020 2069 6620 286e 6f74           if (not
-0001c200: 2072 652e 6d61 7463 6828 7227 5e5b 5c77   re.match(r'^[\w
-0001c210: 5c5c 5d5b 5c77 5c5c 2e5d 2a24 272c 206e  \\][\w\\.]*$', n
-0001c220: 616d 652c 2072 652e 554e 4943 4f44 4529  ame, re.UNICODE)
-0001c230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c240: 2020 2020 206f 7220 7265 2e6d 6174 6368       or re.match
-0001c250: 2872 275e 5c64 272c 206e 616d 6529 293a  (r'^\d', name)):
-0001c260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c270: 2077 6172 6e28 2249 6e76 616c 6964 2045   warn("Invalid E
-0001c280: 7863 656c 2063 6861 7261 6374 6572 7320  xcel characters 
-0001c290: 696e 2061 6464 5f74 6162 6c65 2829 3a20  in add_table(): 
-0001c2a0: 2725 7327 2220 2520 6e61 6d65 290a 2020  '%s'" % name).  
-0001c2b0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0001c2c0: 7475 726e 202d 320a 0a20 2020 2020 2020  turn -2..       
-0001c2d0: 2020 2020 2023 2057 6172 6e20 6966 2074       # Warn if t
-0001c2e0: 6865 206e 616d 6520 6c6f 6f6b 7320 6c69  he name looks li
-0001c2f0: 6b65 2061 2063 656c 6c20 6e61 6d65 2e0a  ke a cell name..
-0001c300: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-0001c310: 652e 6d61 7463 6828 7227 5e5b 612d 7a41  e.match(r'^[a-zA
-0001c320: 2d5a 5d5b 612d 7a41 2d5a 5d3f 5b61 2d64  -Z][a-zA-Z]?[a-d
-0001c330: 412d 445d 3f5b 302d 395d 2b24 272c 206e  A-D]?[0-9]+$', n
-0001c340: 616d 6529 3a0a 2020 2020 2020 2020 2020  ame):.          
-0001c350: 2020 2020 2020 7761 726e 2822 4e61 6d65        warn("Name
-0001c360: 206c 6f6f 6b73 206c 696b 6520 6120 6365   looks like a ce
-0001c370: 6c6c 206e 616d 6520 696e 2061 6464 5f74  ll name in add_t
-0001c380: 6162 6c65 2829 3a20 2725 7327 2220 2520  able(): '%s'" % 
-0001c390: 6e61 6d65 290a 2020 2020 2020 2020 2020  name).          
-0001c3a0: 2020 2020 2020 7265 7475 726e 202d 320a        return -2.
-0001c3b0: 0a20 2020 2020 2020 2020 2020 2023 2057  .            # W
-0001c3c0: 6172 6e20 6966 2074 6865 206e 616d 6520  arn if the name 
-0001c3d0: 6c6f 6f6b 7320 6c69 6b65 2061 2052 3143  looks like a R1C
-0001c3e0: 3120 6365 6c6c 2072 6566 6572 656e 6365  1 cell reference
-0001c3f0: 2e0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0001c400: 2028 7265 2e6d 6174 6368 2872 275e 5b72   (re.match(r'^[r
-0001c410: 6352 435d 2427 2c20 6e61 6d65 290a 2020  cRC]$', name).  
-0001c420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c430: 2020 6f72 2072 652e 6d61 7463 6828 7227    or re.match(r'
-0001c440: 5e5b 7263 5243 5d5c 642b 5b72 6352 435d  ^[rcRC]\d+[rcRC]
-0001c450: 5c64 2b24 272c 206e 616d 6529 293a 0a20  \d+$', name)):. 
-0001c460: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-0001c470: 6172 6e28 2249 6e76 616c 6964 206e 616d  arn("Invalid nam
-0001c480: 6520 2725 7327 206c 696b 6520 6120 5243  e '%s' like a RC
-0001c490: 2063 656c 6c20 7265 6620 696e 2061 6464   cell ref in add
-0001c4a0: 5f74 6162 6c65 2829 220a 2020 2020 2020  _table()".      
-0001c4b0: 2020 2020 2020 2020 2020 2020 2020 2025                 %
-0001c4c0: 206e 616d 6529 0a20 2020 2020 2020 2020   name).         
-0001c4d0: 2020 2020 2020 2072 6574 7572 6e20 2d32         return -2
-0001c4e0: 0a0a 2020 2020 2020 2020 2320 5365 7420  ..        # Set 
-0001c4f0: 7468 6520 7461 626c 6520 7374 796c 652e  the table style.
-0001c500: 0a20 2020 2020 2020 2069 6620 2773 7479  .        if 'sty
-0001c510: 6c65 2720 696e 206f 7074 696f 6e73 3a0a  le' in options:.
-0001c520: 2020 2020 2020 2020 2020 2020 7461 626c              tabl
-0001c530: 655b 2773 7479 6c65 275d 203d 206f 7074  e['style'] = opt
-0001c540: 696f 6e73 5b27 7374 796c 6527 5d0a 0a20  ions['style'].. 
-0001c550: 2020 2020 2020 2020 2020 2069 6620 7461             if ta
-0001c560: 626c 655b 2773 7479 6c65 275d 2069 7320  ble['style'] is 
-0001c570: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0001c580: 2020 2020 2020 7461 626c 655b 2773 7479        table['sty
-0001c590: 6c65 275d 203d 2027 270a 0a20 2020 2020  le'] = ''..     
-0001c5a0: 2020 2020 2020 2023 2052 656d 6f76 6520         # Remove 
-0001c5b0: 7768 6974 6573 7061 6365 2066 726f 6d20  whitespace from 
-0001c5c0: 7374 796c 6520 6e61 6d65 2e0a 2020 2020  style name..    
-0001c5d0: 2020 2020 2020 2020 7461 626c 655b 2773          table['s
-0001c5e0: 7479 6c65 275d 203d 2074 6162 6c65 5b27  tyle'] = table['
-0001c5f0: 7374 796c 6527 5d2e 7265 706c 6163 6528  style'].replace(
-0001c600: 2720 272c 2027 2729 0a20 2020 2020 2020  ' ', '').       
-0001c610: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0001c620: 2020 2074 6162 6c65 5b27 7374 796c 6527     table['style'
-0001c630: 5d20 3d20 2254 6162 6c65 5374 796c 654d  ] = "TableStyleM
-0001c640: 6564 6975 6d39 220a 0a20 2020 2020 2020  edium9"..       
-0001c650: 2023 2053 6574 2074 6865 2064 6174 6120   # Set the data 
-0001c660: 7261 6e67 6520 726f 7773 2028 7769 7468  range rows (with
-0001c670: 6f75 7420 7468 6520 6865 6164 6572 2061  out the header a
-0001c680: 6e64 2066 6f6f 7465 7229 2e0a 2020 2020  nd footer)..    
-0001c690: 2020 2020 6669 7273 745f 6461 7461 5f72      first_data_r
-0001c6a0: 6f77 203d 2066 6972 7374 5f72 6f77 0a20  ow = first_row. 
-0001c6b0: 2020 2020 2020 206c 6173 745f 6461 7461         last_data
-0001c6c0: 5f72 6f77 203d 206c 6173 745f 726f 770a  _row = last_row.
-0001c6d0: 0a20 2020 2020 2020 2069 6620 6f70 7469  .        if opti
-0001c6e0: 6f6e 732e 6765 7428 2768 6561 6465 725f  ons.get('header_
-0001c6f0: 726f 7727 293a 0a20 2020 2020 2020 2020  row'):.         
-0001c700: 2020 2066 6972 7374 5f64 6174 615f 726f     first_data_ro
-0001c710: 7720 2b3d 2031 0a0a 2020 2020 2020 2020  w += 1..        
-0001c720: 6966 206f 7074 696f 6e73 2e67 6574 2827  if options.get('
-0001c730: 746f 7461 6c5f 726f 7727 293a 0a20 2020  total_row'):.   
-0001c740: 2020 2020 2020 2020 206c 6173 745f 6461           last_da
-0001c750: 7461 5f72 6f77 202d 3d20 310a 0a20 2020  ta_row -= 1..   
-0001c760: 2020 2020 2023 2053 6574 2074 6865 2074       # Set the t
-0001c770: 6162 6c65 2061 6e64 2061 7574 6f66 696c  able and autofil
-0001c780: 7465 7220 7261 6e67 6573 2e0a 2020 2020  ter ranges..    
-0001c790: 2020 2020 7461 626c 655b 2772 616e 6765      table['range
-0001c7a0: 275d 203d 2078 6c5f 7261 6e67 6528 6669  '] = xl_range(fi
-0001c7b0: 7273 745f 726f 772c 2066 6972 7374 5f63  rst_row, first_c
-0001c7c0: 6f6c 2c0a 2020 2020 2020 2020 2020 2020  ol,.            
-0001c7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c7e0: 2020 2020 2020 6c61 7374 5f72 6f77 2c20        last_row, 
-0001c7f0: 6c61 7374 5f63 6f6c 290a 0a20 2020 2020  last_col)..     
-0001c800: 2020 2074 6162 6c65 5b27 615f 7261 6e67     table['a_rang
-0001c810: 6527 5d20 3d20 786c 5f72 616e 6765 2866  e'] = xl_range(f
-0001c820: 6972 7374 5f72 6f77 2c20 6669 7273 745f  irst_row, first_
-0001c830: 636f 6c2c 0a20 2020 2020 2020 2020 2020  col,.           
-0001c840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c850: 2020 2020 2020 2020 206c 6173 745f 6461           last_da
-0001c860: 7461 5f72 6f77 2c20 6c61 7374 5f63 6f6c  ta_row, last_col
-0001c870: 290a 0a20 2020 2020 2020 2023 2049 6620  )..        # If 
-0001c880: 7468 6520 6865 6164 6572 2072 6f77 2069  the header row i
-0001c890: 6620 6f66 6620 7468 6520 6465 6661 756c  f off the defaul
-0001c8a0: 7420 6973 2074 6f20 7475 726e 2061 7574  t is to turn aut
-0001c8b0: 6f66 696c 7465 7220 6f66 662e 0a20 2020  ofilter off..   
-0001c8c0: 2020 2020 2069 6620 6e6f 7420 6f70 7469       if not opti
-0001c8d0: 6f6e 735b 2768 6561 6465 725f 726f 7727  ons['header_row'
-0001c8e0: 5d3a 0a20 2020 2020 2020 2020 2020 206f  ]:.            o
-0001c8f0: 7074 696f 6e73 5b27 6175 746f 6669 6c74  ptions['autofilt
-0001c900: 6572 275d 203d 2030 0a0a 2020 2020 2020  er'] = 0..      
-0001c910: 2020 2320 5365 7420 7468 6520 6175 746f    # Set the auto
-0001c920: 6669 6c74 6572 2072 616e 6765 2e0a 2020  filter range..  
-0001c930: 2020 2020 2020 6966 206f 7074 696f 6e73        if options
-0001c940: 5b27 6175 746f 6669 6c74 6572 275d 3a0a  ['autofilter']:.
-0001c950: 2020 2020 2020 2020 2020 2020 7461 626c              tabl
-0001c960: 655b 2761 7574 6f66 696c 7465 7227 5d20  e['autofilter'] 
-0001c970: 3d20 7461 626c 655b 2761 5f72 616e 6765  = table['a_range
-0001c980: 275d 0a0a 2020 2020 2020 2020 2320 4164  ']..        # Ad
-0001c990: 6420 7468 6520 7461 626c 6520 636f 6c75  d the table colu
-0001c9a0: 6d6e 732e 0a20 2020 2020 2020 2063 6f6c  mns..        col
-0001c9b0: 5f69 6420 3d20 310a 2020 2020 2020 2020  _id = 1.        
-0001c9c0: 7461 626c 655b 2763 6f6c 756d 6e73 275d  table['columns']
-0001c9d0: 203d 205b 5d0a 2020 2020 2020 2020 7365   = [].        se
-0001c9e0: 656e 5f6e 616d 6573 203d 207b 7d0a 0a20  en_names = {}.. 
-0001c9f0: 2020 2020 2020 2066 6f72 2063 6f6c 5f6e         for col_n
-0001ca00: 756d 2069 6e20 7261 6e67 6528 6669 7273  um in range(firs
-0001ca10: 745f 636f 6c2c 206c 6173 745f 636f 6c20  t_col, last_col 
-0001ca20: 2b20 3129 3a0a 2020 2020 2020 2020 2020  + 1):.          
-0001ca30: 2020 2320 5365 7420 7570 2074 6865 2064    # Set up the d
-0001ca40: 6566 6175 6c74 2063 6f6c 756d 6e20 6461  efault column da
-0001ca50: 7461 2e0a 2020 2020 2020 2020 2020 2020  ta..            
-0001ca60: 636f 6c5f 6461 7461 203d 207b 0a20 2020  col_data = {.   
-0001ca70: 2020 2020 2020 2020 2020 2020 2027 6964               'id
-0001ca80: 273a 2063 6f6c 5f69 642c 0a20 2020 2020  ': col_id,.     
-0001ca90: 2020 2020 2020 2020 2020 2027 6e61 6d65             'name
-0001caa0: 273a 2027 436f 6c75 6d6e 2720 2b20 7374  ': 'Column' + st
-0001cab0: 7228 636f 6c5f 6964 292c 0a20 2020 2020  r(col_id),.     
-0001cac0: 2020 2020 2020 2020 2020 2027 746f 7461             'tota
-0001cad0: 6c5f 7374 7269 6e67 273a 2027 272c 0a20  l_string': '',. 
-0001cae0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-0001caf0: 746f 7461 6c5f 6675 6e63 7469 6f6e 273a  total_function':
-0001cb00: 2027 272c 0a20 2020 2020 2020 2020 2020   '',.           
-0001cb10: 2020 2020 2027 746f 7461 6c5f 7661 6c75       'total_valu
-0001cb20: 6527 3a20 302c 0a20 2020 2020 2020 2020  e': 0,.         
-0001cb30: 2020 2020 2020 2027 666f 726d 756c 6127         'formula'
-0001cb40: 3a20 2727 2c0a 2020 2020 2020 2020 2020  : '',.          
-0001cb50: 2020 2020 2020 2766 6f72 6d61 7427 3a20        'format': 
-0001cb60: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-0001cb70: 2020 2020 2020 276e 616d 655f 666f 726d        'name_form
-0001cb80: 6174 273a 204e 6f6e 652c 0a20 2020 2020  at': None,.     
-0001cb90: 2020 2020 2020 207d 0a0a 2020 2020 2020         }..      
-0001cba0: 2020 2020 2020 2320 4f76 6572 7772 6974        # Overwrit
-0001cbb0: 6520 7468 6520 6465 6661 756c 7473 2077  e the defaults w
-0001cbc0: 6974 6820 616e 7920 7573 6572 2064 6566  ith any user def
-0001cbd0: 696e 6564 2076 616c 7565 732e 0a20 2020  ined values..   
-0001cbe0: 2020 2020 2020 2020 2069 6620 2763 6f6c           if 'col
-0001cbf0: 756d 6e73 2720 696e 206f 7074 696f 6e73  umns' in options
-0001cc00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001cc10: 2020 2320 4368 6563 6b20 6966 2074 6865    # Check if the
-0001cc20: 7265 2061 7265 2075 7365 7220 6465 6669  re are user defi
-0001cc30: 6e65 6420 7661 6c75 6573 2066 6f72 2074  ned values for t
-0001cc40: 6869 7320 636f 6c75 6d6e 2e0a 2020 2020  his column..    
-0001cc50: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-0001cc60: 6f6c 5f69 6420 3c3d 206c 656e 286f 7074  ol_id <= len(opt
-0001cc70: 696f 6e73 5b27 636f 6c75 6d6e 7327 5d29  ions['columns'])
-0001cc80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001cc90: 2020 2020 2020 7573 6572 5f64 6174 6120        user_data 
-0001cca0: 3d20 6f70 7469 6f6e 735b 2763 6f6c 756d  = options['colum
-0001ccb0: 6e73 275d 5b63 6f6c 5f69 6420 2d20 315d  ns'][col_id - 1]
-0001ccc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ccd0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0001cce0: 2020 2020 2020 2020 2020 2075 7365 725f             user_
-0001ccf0: 6461 7461 203d 204e 6f6e 650a 0a20 2020  data = None..   
-0001cd00: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0001cd10: 7573 6572 5f64 6174 613a 0a20 2020 2020  user_data:.     
-0001cd20: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0001cd30: 2047 6574 2074 6865 2063 6f6c 756d 6e20   Get the column 
-0001cd40: 666f 726d 6174 2e0a 2020 2020 2020 2020  format..        
-0001cd50: 2020 2020 2020 2020 2020 2020 7866 6f72              xfor
-0001cd60: 6d61 7420 3d20 7573 6572 5f64 6174 612e  mat = user_data.
-0001cd70: 6765 7428 2766 6f72 6d61 7427 2c20 4e6f  get('format', No
-0001cd80: 6e65 290a 0a20 2020 2020 2020 2020 2020  ne)..           
-0001cd90: 2020 2020 2020 2020 2023 204d 6170 2075           # Map u
-0001cda0: 7365 7220 6465 6669 6e65 6420 7661 6c75  ser defined valu
-0001cdb0: 6573 2074 6f20 696e 7465 726e 616c 2076  es to internal v
-0001cdc0: 616c 7565 732e 0a20 2020 2020 2020 2020  alues..         
-0001cdd0: 2020 2020 2020 2020 2020 2069 6620 7573             if us
-0001cde0: 6572 5f64 6174 612e 6765 7428 2768 6561  er_data.get('hea
-0001cdf0: 6465 7227 293a 0a20 2020 2020 2020 2020  der'):.         
-0001ce00: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0001ce10: 6f6c 5f64 6174 615b 276e 616d 6527 5d20  ol_data['name'] 
-0001ce20: 3d20 7573 6572 5f64 6174 615b 2768 6561  = user_data['hea
-0001ce30: 6465 7227 5d0a 0a20 2020 2020 2020 2020  der']..         
-0001ce40: 2020 2020 2020 2020 2020 2023 2045 7863             # Exc
-0001ce50: 656c 2072 6571 7569 7265 7320 756e 6971  el requires uniq
-0001ce60: 7565 2063 6173 6520 696e 7365 6e73 6974  ue case insensit
-0001ce70: 6976 6520 6865 6164 6572 206e 616d 6573  ive header names
-0001ce80: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001ce90: 2020 2020 2020 6865 6164 6572 5f6e 616d        header_nam
-0001cea0: 6520 3d20 636f 6c5f 6461 7461 5b27 6e61  e = col_data['na
-0001ceb0: 6d65 275d 0a20 2020 2020 2020 2020 2020  me'].           
-0001cec0: 2020 2020 2020 2020 206e 616d 6520 3d20           name = 
-0001ced0: 6865 6164 6572 5f6e 616d 652e 6c6f 7765  header_name.lowe
-0001cee0: 7228 290a 2020 2020 2020 2020 2020 2020  r().            
-0001cef0: 2020 2020 2020 2020 6966 206e 616d 6520          if name 
-0001cf00: 696e 2073 6565 6e5f 6e61 6d65 733a 0a20  in seen_names:. 
-0001cf10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cf20: 2020 2020 2020 2077 6172 6e28 2244 7570         warn("Dup
-0001cf30: 6c69 6361 7465 2068 6561 6465 7220 6e61  licate header na
-0001cf40: 6d65 2069 6e20 6164 645f 7461 626c 6528  me in add_table(
-0001cf50: 293a 2027 2573 2722 0a20 2020 2020 2020  ): '%s'".       
-0001cf60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cf70: 2020 2020 2020 2520 6e61 6d65 290a 2020        % name).  
-0001cf80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cf90: 2020 2020 2020 7265 7475 726e 202d 320a        return -2.
-0001cfa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cfb0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001cfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cfd0: 2020 7365 656e 5f6e 616d 6573 5b6e 616d    seen_names[nam
-0001cfe0: 655d 203d 2054 7275 650a 0a20 2020 2020  e] = True..     
-0001cff0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0001d000: 6f6c 5f64 6174 615b 276e 616d 655f 666f  ol_data['name_fo
-0001d010: 726d 6174 275d 203d 2075 7365 725f 6461  rmat'] = user_da
-0001d020: 7461 2e67 6574 2827 6865 6164 6572 5f66  ta.get('header_f
-0001d030: 6f72 6d61 7427 290a 0a20 2020 2020 2020  ormat')..       
-0001d040: 2020 2020 2020 2020 2020 2020 2023 2048               # H
-0001d050: 616e 646c 6520 7468 6520 636f 6c75 6d6e  andle the column
-0001d060: 2066 6f72 6d75 6c61 2e0a 2020 2020 2020   formula..      
-0001d070: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0001d080: 2027 666f 726d 756c 6127 2069 6e20 7573   'formula' in us
-0001d090: 6572 5f64 6174 6120 616e 6420 7573 6572  er_data and user
-0001d0a0: 5f64 6174 615b 2766 6f72 6d75 6c61 275d  _data['formula']
-0001d0b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001d0c0: 2020 2020 2020 2020 2020 666f 726d 756c            formul
-0001d0d0: 6120 3d20 7573 6572 5f64 6174 615b 2766  a = user_data['f
-0001d0e0: 6f72 6d75 6c61 275d 0a0a 2020 2020 2020  ormula']..      
+000198f0: 290a 0a20 2020 2020 2020 2020 2020 2065  )..            e
+00019900: 6c69 6620 6f70 7469 6f6e 735b 2263 7269  lif options["cri
+00019910: 7465 7269 6122 5d20 3d3d 2022 6e65 7874  teria"] == "next
+00019920: 4d6f 6e74 6822 3a0a 2020 2020 2020 2020  Month":.        
+00019930: 2020 2020 2020 2020 6f70 7469 6f6e 735b          options[
+00019940: 2266 6f72 6d75 6c61 225d 203d 2028 0a20  "formula"] = (. 
+00019950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019960: 2020 2022 414e 4428 4d4f 4e54 4828 2573     "AND(MONTH(%s
+00019970: 293d 4d4f 4e54 4828 544f 4441 5928 2929  )=MONTH(TODAY())
+00019980: 2b31 2c4f 5228 5945 4152 2825 7329 3d59  +1,OR(YEAR(%s)=Y
+00019990: 4541 5228 220a 2020 2020 2020 2020 2020  EAR(".          
+000199a0: 2020 2020 2020 2020 2020 2254 4f44 4159            "TODAY
+000199b0: 2829 292c 414e 4428 4d4f 4e54 4828 2573  ()),AND(MONTH(%s
+000199c0: 293d 3132 2c59 4541 5228 2573 293d 5945  )=12,YEAR(%s)=YE
+000199d0: 4152 2854 4f44 4159 2829 292b 3129 2929  AR(TODAY())+1)))
+000199e0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+000199f0: 2020 2020 2020 2520 2873 7461 7274 5f63        % (start_c
+00019a00: 656c 6c2c 2073 7461 7274 5f63 656c 6c2c  ell, start_cell,
+00019a10: 2073 7461 7274 5f63 656c 6c2c 2073 7461   start_cell, sta
+00019a20: 7274 5f63 656c 6c29 0a20 2020 2020 2020  rt_cell).       
+00019a30: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00019a40: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00019a50: 2020 2020 2020 2020 2020 2020 2020 7761                wa
+00019a60: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
+00019a70: 2020 2020 2020 2020 2249 6e76 616c 6964          "Invalid
+00019a80: 2074 696d 655f 7065 7269 6f64 2063 7269   time_period cri
+00019a90: 7465 7269 6120 2725 7327 2022 0a20 2020  teria '%s' ".   
+00019aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019ab0: 2022 696e 2063 6f6e 6469 7469 6f6e 616c   "in conditional
+00019ac0: 5f66 6f72 6d61 7428 2922 2025 206f 7074  _format()" % opt
+00019ad0: 696f 6e73 5b22 6372 6974 6572 6961 225d  ions["criteria"]
+00019ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019af0: 2029 0a0a 2020 2020 2020 2020 2320 5370   )..        # Sp
+00019b00: 6563 6961 6c20 6861 6e64 6c69 6e67 206f  ecial handling o
+00019b10: 6620 626c 616e 6b73 2f65 7272 6f72 2074  f blanks/error t
+00019b20: 7970 6573 2e0a 2020 2020 2020 2020 6966  ypes..        if
+00019b30: 206f 7074 696f 6e73 5b22 7479 7065 225d   options["type"]
+00019b40: 203d 3d20 2263 6f6e 7461 696e 7342 6c61   == "containsBla
+00019b50: 6e6b 7322 3a0a 2020 2020 2020 2020 2020  nks":.          
+00019b60: 2020 6f70 7469 6f6e 735b 2266 6f72 6d75    options["formu
+00019b70: 6c61 225d 203d 2022 4c45 4e28 5452 494d  la"] = "LEN(TRIM
+00019b80: 2825 7329 293d 3022 2025 2073 7461 7274  (%s))=0" % start
+00019b90: 5f63 656c 6c0a 0a20 2020 2020 2020 2069  _cell..        i
+00019ba0: 6620 6f70 7469 6f6e 735b 2274 7970 6522  f options["type"
+00019bb0: 5d20 3d3d 2022 6e6f 7443 6f6e 7461 696e  ] == "notContain
+00019bc0: 7342 6c61 6e6b 7322 3a0a 2020 2020 2020  sBlanks":.      
+00019bd0: 2020 2020 2020 6f70 7469 6f6e 735b 2266        options["f
+00019be0: 6f72 6d75 6c61 225d 203d 2022 4c45 4e28  ormula"] = "LEN(
+00019bf0: 5452 494d 2825 7329 293e 3022 2025 2073  TRIM(%s))>0" % s
+00019c00: 7461 7274 5f63 656c 6c0a 0a20 2020 2020  tart_cell..     
+00019c10: 2020 2069 6620 6f70 7469 6f6e 735b 2274     if options["t
+00019c20: 7970 6522 5d20 3d3d 2022 636f 6e74 6169  ype"] == "contai
+00019c30: 6e73 4572 726f 7273 223a 0a20 2020 2020  nsErrors":.     
+00019c40: 2020 2020 2020 206f 7074 696f 6e73 5b22         options["
+00019c50: 666f 726d 756c 6122 5d20 3d20 2249 5345  formula"] = "ISE
+00019c60: 5252 4f52 2825 7329 2220 2520 7374 6172  RROR(%s)" % star
+00019c70: 745f 6365 6c6c 0a0a 2020 2020 2020 2020  t_cell..        
+00019c80: 6966 206f 7074 696f 6e73 5b22 7479 7065  if options["type
+00019c90: 225d 203d 3d20 226e 6f74 436f 6e74 6169  "] == "notContai
+00019ca0: 6e73 4572 726f 7273 223a 0a20 2020 2020  nsErrors":.     
+00019cb0: 2020 2020 2020 206f 7074 696f 6e73 5b22         options["
+00019cc0: 666f 726d 756c 6122 5d20 3d20 224e 4f54  formula"] = "NOT
+00019cd0: 2849 5345 5252 4f52 2825 7329 2922 2025  (ISERROR(%s))" %
+00019ce0: 2073 7461 7274 5f63 656c 6c0a 0a20 2020   start_cell..   
+00019cf0: 2020 2020 2023 2053 7065 6369 616c 2068       # Special h
+00019d00: 616e 646c 696e 6720 666f 7220 3220 636f  andling for 2 co
+00019d10: 6c6f 7220 7363 616c 652e 0a20 2020 2020  lor scale..     
+00019d20: 2020 2069 6620 6f70 7469 6f6e 735b 2274     if options["t
+00019d30: 7970 6522 5d20 3d3d 2022 325f 636f 6c6f  ype"] == "2_colo
+00019d40: 725f 7363 616c 6522 3a0a 2020 2020 2020  r_scale":.      
+00019d50: 2020 2020 2020 6f70 7469 6f6e 735b 2274        options["t
+00019d60: 7970 6522 5d20 3d20 2263 6f6c 6f72 5363  ype"] = "colorSc
+00019d70: 616c 6522 0a0a 2020 2020 2020 2020 2020  ale"..          
+00019d80: 2020 2320 436f 6c6f 7220 7363 616c 6573    # Color scales
+00019d90: 2064 6f6e 2774 2075 7365 2061 6e79 2061   don't use any a
+00019da0: 6464 6974 696f 6e61 6c20 666f 726d 6174  dditional format
+00019db0: 7469 6e67 2e0a 2020 2020 2020 2020 2020  ting..          
+00019dc0: 2020 6f70 7469 6f6e 735b 2266 6f72 6d61    options["forma
+00019dd0: 7422 5d20 3d20 4e6f 6e65 0a0a 2020 2020  t"] = None..    
+00019de0: 2020 2020 2020 2020 2320 5475 726e 206f          # Turn o
+00019df0: 6666 2033 2063 6f6c 6f72 2070 6172 616d  ff 3 color param
+00019e00: 6574 6572 732e 0a20 2020 2020 2020 2020  eters..         
+00019e10: 2020 206f 7074 696f 6e73 5b22 6d69 645f     options["mid_
+00019e20: 7479 7065 225d 203d 204e 6f6e 650a 2020  type"] = None.  
+00019e30: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
+00019e40: 735b 226d 6964 5f63 6f6c 6f72 225d 203d  s["mid_color"] =
+00019e50: 204e 6f6e 650a 0a20 2020 2020 2020 2020   None..         
+00019e60: 2020 206f 7074 696f 6e73 2e73 6574 6465     options.setde
+00019e70: 6661 756c 7428 226d 696e 5f74 7970 6522  fault("min_type"
+00019e80: 2c20 226d 696e 2229 0a20 2020 2020 2020  , "min").       
+00019e90: 2020 2020 206f 7074 696f 6e73 2e73 6574       options.set
+00019ea0: 6465 6661 756c 7428 226d 6178 5f74 7970  default("max_typ
+00019eb0: 6522 2c20 226d 6178 2229 0a20 2020 2020  e", "max").     
+00019ec0: 2020 2020 2020 206f 7074 696f 6e73 2e73         options.s
+00019ed0: 6574 6465 6661 756c 7428 226d 696e 5f76  etdefault("min_v
+00019ee0: 616c 7565 222c 2030 290a 2020 2020 2020  alue", 0).      
+00019ef0: 2020 2020 2020 6f70 7469 6f6e 732e 7365        options.se
+00019f00: 7464 6566 6175 6c74 2822 6d61 785f 7661  tdefault("max_va
+00019f10: 6c75 6522 2c20 3029 0a20 2020 2020 2020  lue", 0).       
+00019f20: 2020 2020 206f 7074 696f 6e73 2e73 6574       options.set
+00019f30: 6465 6661 756c 7428 226d 696e 5f63 6f6c  default("min_col
+00019f40: 6f72 222c 2022 2346 4637 3132 3822 290a  or", "#FF7128").
+00019f50: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
+00019f60: 6f6e 732e 7365 7464 6566 6175 6c74 2822  ons.setdefault("
+00019f70: 6d61 785f 636f 6c6f 7222 2c20 2223 4646  max_color", "#FF
+00019f80: 4546 3943 2229 0a0a 2020 2020 2020 2020  EF9C")..        
+00019f90: 2020 2020 6f70 7469 6f6e 735b 226d 696e      options["min
+00019fa0: 5f63 6f6c 6f72 225d 203d 2078 6c5f 636f  _color"] = xl_co
+00019fb0: 6c6f 7228 6f70 7469 6f6e 735b 226d 696e  lor(options["min
+00019fc0: 5f63 6f6c 6f72 225d 290a 2020 2020 2020  _color"]).      
+00019fd0: 2020 2020 2020 6f70 7469 6f6e 735b 226d        options["m
+00019fe0: 6178 5f63 6f6c 6f72 225d 203d 2078 6c5f  ax_color"] = xl_
+00019ff0: 636f 6c6f 7228 6f70 7469 6f6e 735b 226d  color(options["m
+0001a000: 6178 5f63 6f6c 6f72 225d 290a 0a20 2020  ax_color"])..   
+0001a010: 2020 2020 2023 2053 7065 6369 616c 2068       # Special h
+0001a020: 616e 646c 696e 6720 666f 7220 3320 636f  andling for 3 co
+0001a030: 6c6f 7220 7363 616c 652e 0a20 2020 2020  lor scale..     
+0001a040: 2020 2069 6620 6f70 7469 6f6e 735b 2274     if options["t
+0001a050: 7970 6522 5d20 3d3d 2022 335f 636f 6c6f  ype"] == "3_colo
+0001a060: 725f 7363 616c 6522 3a0a 2020 2020 2020  r_scale":.      
+0001a070: 2020 2020 2020 6f70 7469 6f6e 735b 2274        options["t
+0001a080: 7970 6522 5d20 3d20 2263 6f6c 6f72 5363  ype"] = "colorSc
+0001a090: 616c 6522 0a0a 2020 2020 2020 2020 2020  ale"..          
+0001a0a0: 2020 2320 436f 6c6f 7220 7363 616c 6573    # Color scales
+0001a0b0: 2064 6f6e 2774 2075 7365 2061 6e79 2061   don't use any a
+0001a0c0: 6464 6974 696f 6e61 6c20 666f 726d 6174  dditional format
+0001a0d0: 7469 6e67 2e0a 2020 2020 2020 2020 2020  ting..          
+0001a0e0: 2020 6f70 7469 6f6e 735b 2266 6f72 6d61    options["forma
+0001a0f0: 7422 5d20 3d20 4e6f 6e65 0a0a 2020 2020  t"] = None..    
+0001a100: 2020 2020 2020 2020 6f70 7469 6f6e 732e          options.
+0001a110: 7365 7464 6566 6175 6c74 2822 6d69 6e5f  setdefault("min_
+0001a120: 7479 7065 222c 2022 6d69 6e22 290a 2020  type", "min").  
+0001a130: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
+0001a140: 732e 7365 7464 6566 6175 6c74 2822 6d69  s.setdefault("mi
+0001a150: 645f 7479 7065 222c 2022 7065 7263 656e  d_type", "percen
+0001a160: 7469 6c65 2229 0a20 2020 2020 2020 2020  tile").         
+0001a170: 2020 206f 7074 696f 6e73 2e73 6574 6465     options.setde
+0001a180: 6661 756c 7428 226d 6178 5f74 7970 6522  fault("max_type"
+0001a190: 2c20 226d 6178 2229 0a20 2020 2020 2020  , "max").       
+0001a1a0: 2020 2020 206f 7074 696f 6e73 2e73 6574       options.set
+0001a1b0: 6465 6661 756c 7428 226d 696e 5f76 616c  default("min_val
+0001a1c0: 7565 222c 2030 290a 2020 2020 2020 2020  ue", 0).        
+0001a1d0: 2020 2020 6f70 7469 6f6e 732e 7365 7464      options.setd
+0001a1e0: 6566 6175 6c74 2822 6d61 785f 7661 6c75  efault("max_valu
+0001a1f0: 6522 2c20 3029 0a20 2020 2020 2020 2020  e", 0).         
+0001a200: 2020 206f 7074 696f 6e73 2e73 6574 6465     options.setde
+0001a210: 6661 756c 7428 226d 696e 5f63 6f6c 6f72  fault("min_color
+0001a220: 222c 2022 2346 3836 3936 4222 290a 2020  ", "#F8696B").  
+0001a230: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
+0001a240: 732e 7365 7464 6566 6175 6c74 2822 6d69  s.setdefault("mi
+0001a250: 645f 636f 6c6f 7222 2c20 2223 4646 4542  d_color", "#FFEB
+0001a260: 3834 2229 0a20 2020 2020 2020 2020 2020  84").           
+0001a270: 206f 7074 696f 6e73 2e73 6574 6465 6661   options.setdefa
+0001a280: 756c 7428 226d 6178 5f63 6f6c 6f72 222c  ult("max_color",
+0001a290: 2022 2336 3342 4537 4222 290a 0a20 2020   "#63BE7B")..   
+0001a2a0: 2020 2020 2020 2020 206f 7074 696f 6e73           options
+0001a2b0: 5b22 6d69 6e5f 636f 6c6f 7222 5d20 3d20  ["min_color"] = 
+0001a2c0: 786c 5f63 6f6c 6f72 286f 7074 696f 6e73  xl_color(options
+0001a2d0: 5b22 6d69 6e5f 636f 6c6f 7222 5d29 0a20  ["min_color"]). 
+0001a2e0: 2020 2020 2020 2020 2020 206f 7074 696f             optio
+0001a2f0: 6e73 5b22 6d69 645f 636f 6c6f 7222 5d20  ns["mid_color"] 
+0001a300: 3d20 786c 5f63 6f6c 6f72 286f 7074 696f  = xl_color(optio
+0001a310: 6e73 5b22 6d69 645f 636f 6c6f 7222 5d29  ns["mid_color"])
+0001a320: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
+0001a330: 696f 6e73 5b22 6d61 785f 636f 6c6f 7222  ions["max_color"
+0001a340: 5d20 3d20 786c 5f63 6f6c 6f72 286f 7074  ] = xl_color(opt
+0001a350: 696f 6e73 5b22 6d61 785f 636f 6c6f 7222  ions["max_color"
+0001a360: 5d29 0a0a 2020 2020 2020 2020 2020 2020  ])..            
+0001a370: 2320 5365 7420 6120 6465 6661 756c 7420  # Set a default 
+0001a380: 6d69 6420 7661 6c75 652e 0a20 2020 2020  mid value..     
+0001a390: 2020 2020 2020 2069 6620 226d 6964 5f76         if "mid_v
+0001a3a0: 616c 7565 2220 6e6f 7420 696e 206f 7074  alue" not in opt
+0001a3b0: 696f 6e73 3a0a 2020 2020 2020 2020 2020  ions:.          
+0001a3c0: 2020 2020 2020 6f70 7469 6f6e 735b 226d        options["m
+0001a3d0: 6964 5f76 616c 7565 225d 203d 2035 300a  id_value"] = 50.
+0001a3e0: 0a20 2020 2020 2020 2023 2053 7065 6369  .        # Speci
+0001a3f0: 616c 2068 616e 646c 696e 6720 666f 7220  al handling for 
+0001a400: 6461 7461 2062 6172 2e0a 2020 2020 2020  data bar..      
+0001a410: 2020 6966 206f 7074 696f 6e73 5b22 7479    if options["ty
+0001a420: 7065 225d 203d 3d20 2264 6174 6142 6172  pe"] == "dataBar
+0001a430: 223a 0a20 2020 2020 2020 2020 2020 2023  ":.            #
+0001a440: 2043 6f6c 6f72 2073 6361 6c65 7320 646f   Color scales do
+0001a450: 6e27 7420 7573 6520 616e 7920 6164 6469  n't use any addi
+0001a460: 7469 6f6e 616c 2066 6f72 6d61 7474 696e  tional formattin
+0001a470: 672e 0a20 2020 2020 2020 2020 2020 206f  g..            o
+0001a480: 7074 696f 6e73 5b22 666f 726d 6174 225d  ptions["format"]
+0001a490: 203d 204e 6f6e 650a 0a20 2020 2020 2020   = None..       
+0001a4a0: 2020 2020 2069 6620 6e6f 7420 6f70 7469       if not opti
+0001a4b0: 6f6e 732e 6765 7428 226d 696e 5f74 7970  ons.get("min_typ
+0001a4c0: 6522 293a 0a20 2020 2020 2020 2020 2020  e"):.           
+0001a4d0: 2020 2020 206f 7074 696f 6e73 5b22 6d69       options["mi
+0001a4e0: 6e5f 7479 7065 225d 203d 2022 6d69 6e22  n_type"] = "min"
+0001a4f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a500: 206f 7074 696f 6e73 5b22 7831 345f 6d69   options["x14_mi
+0001a510: 6e5f 7479 7065 225d 203d 2022 6175 746f  n_type"] = "auto
+0001a520: 4d69 6e22 0a20 2020 2020 2020 2020 2020  Min".           
+0001a530: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001a540: 2020 2020 2020 206f 7074 696f 6e73 5b22         options["
+0001a550: 7831 345f 6d69 6e5f 7479 7065 225d 203d  x14_min_type"] =
+0001a560: 206f 7074 696f 6e73 5b22 6d69 6e5f 7479   options["min_ty
+0001a570: 7065 225d 0a0a 2020 2020 2020 2020 2020  pe"]..          
+0001a580: 2020 6966 206e 6f74 206f 7074 696f 6e73    if not options
+0001a590: 2e67 6574 2822 6d61 785f 7479 7065 2229  .get("max_type")
+0001a5a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001a5b0: 2020 6f70 7469 6f6e 735b 226d 6178 5f74    options["max_t
+0001a5c0: 7970 6522 5d20 3d20 226d 6178 220a 2020  ype"] = "max".  
+0001a5d0: 2020 2020 2020 2020 2020 2020 2020 6f70                op
+0001a5e0: 7469 6f6e 735b 2278 3134 5f6d 6178 5f74  tions["x14_max_t
+0001a5f0: 7970 6522 5d20 3d20 2261 7574 6f4d 6178  ype"] = "autoMax
+0001a600: 220a 2020 2020 2020 2020 2020 2020 656c  ".            el
+0001a610: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0001a620: 2020 2020 6f70 7469 6f6e 735b 2278 3134      options["x14
+0001a630: 5f6d 6178 5f74 7970 6522 5d20 3d20 6f70  _max_type"] = op
+0001a640: 7469 6f6e 735b 226d 6178 5f74 7970 6522  tions["max_type"
+0001a650: 5d0a 0a20 2020 2020 2020 2020 2020 206f  ]..            o
+0001a660: 7074 696f 6e73 2e73 6574 6465 6661 756c  ptions.setdefaul
+0001a670: 7428 226d 696e 5f76 616c 7565 222c 2030  t("min_value", 0
+0001a680: 290a 2020 2020 2020 2020 2020 2020 6f70  ).            op
+0001a690: 7469 6f6e 732e 7365 7464 6566 6175 6c74  tions.setdefault
+0001a6a0: 2822 6d61 785f 7661 6c75 6522 2c20 3029  ("max_value", 0)
+0001a6b0: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
+0001a6c0: 696f 6e73 2e73 6574 6465 6661 756c 7428  ions.setdefault(
+0001a6d0: 2262 6172 5f63 6f6c 6f72 222c 2022 2336  "bar_color", "#6
+0001a6e0: 3338 4543 3622 290a 2020 2020 2020 2020  38EC6").        
+0001a6f0: 2020 2020 6f70 7469 6f6e 732e 7365 7464      options.setd
+0001a700: 6566 6175 6c74 2822 6261 725f 626f 7264  efault("bar_bord
+0001a710: 6572 5f63 6f6c 6f72 222c 206f 7074 696f  er_color", optio
+0001a720: 6e73 5b22 6261 725f 636f 6c6f 7222 5d29  ns["bar_color"])
+0001a730: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
+0001a740: 696f 6e73 2e73 6574 6465 6661 756c 7428  ions.setdefault(
+0001a750: 2262 6172 5f6f 6e6c 7922 2c20 4661 6c73  "bar_only", Fals
+0001a760: 6529 0a20 2020 2020 2020 2020 2020 206f  e).            o
+0001a770: 7074 696f 6e73 2e73 6574 6465 6661 756c  ptions.setdefaul
+0001a780: 7428 2262 6172 5f6e 6f5f 626f 7264 6572  t("bar_no_border
+0001a790: 222c 2046 616c 7365 290a 2020 2020 2020  ", False).      
+0001a7a0: 2020 2020 2020 6f70 7469 6f6e 732e 7365        options.se
+0001a7b0: 7464 6566 6175 6c74 2822 6261 725f 736f  tdefault("bar_so
+0001a7c0: 6c69 6422 2c20 4661 6c73 6529 0a20 2020  lid", False).   
+0001a7d0: 2020 2020 2020 2020 206f 7074 696f 6e73           options
+0001a7e0: 2e73 6574 6465 6661 756c 7428 2262 6172  .setdefault("bar
+0001a7f0: 5f64 6972 6563 7469 6f6e 222c 2022 2229  _direction", "")
+0001a800: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
+0001a810: 696f 6e73 2e73 6574 6465 6661 756c 7428  ions.setdefault(
+0001a820: 2262 6172 5f6e 6567 6174 6976 655f 636f  "bar_negative_co
+0001a830: 6c6f 7222 2c20 2223 4646 3030 3030 2229  lor", "#FF0000")
+0001a840: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
+0001a850: 696f 6e73 2e73 6574 6465 6661 756c 7428  ions.setdefault(
+0001a860: 2262 6172 5f6e 6567 6174 6976 655f 626f  "bar_negative_bo
+0001a870: 7264 6572 5f63 6f6c 6f72 222c 2022 2346  rder_color", "#F
+0001a880: 4630 3030 3022 290a 2020 2020 2020 2020  F0000").        
+0001a890: 2020 2020 6f70 7469 6f6e 732e 7365 7464      options.setd
+0001a8a0: 6566 6175 6c74 2822 6261 725f 6e65 6761  efault("bar_nega
+0001a8b0: 7469 7665 5f63 6f6c 6f72 5f73 616d 6522  tive_color_same"
+0001a8c0: 2c20 4661 6c73 6529 0a20 2020 2020 2020  , False).       
+0001a8d0: 2020 2020 206f 7074 696f 6e73 2e73 6574       options.set
+0001a8e0: 6465 6661 756c 7428 2262 6172 5f6e 6567  default("bar_neg
+0001a8f0: 6174 6976 655f 626f 7264 6572 5f63 6f6c  ative_border_col
+0001a900: 6f72 5f73 616d 6522 2c20 4661 6c73 6529  or_same", False)
+0001a910: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
+0001a920: 696f 6e73 2e73 6574 6465 6661 756c 7428  ions.setdefault(
+0001a930: 2262 6172 5f61 7869 735f 706f 7369 7469  "bar_axis_positi
+0001a940: 6f6e 222c 2022 2229 0a20 2020 2020 2020  on", "").       
+0001a950: 2020 2020 206f 7074 696f 6e73 2e73 6574       options.set
+0001a960: 6465 6661 756c 7428 2262 6172 5f61 7869  default("bar_axi
+0001a970: 735f 636f 6c6f 7222 2c20 2223 3030 3030  s_color", "#0000
+0001a980: 3030 2229 0a0a 2020 2020 2020 2020 2020  00")..          
+0001a990: 2020 6f70 7469 6f6e 735b 2262 6172 5f63    options["bar_c
+0001a9a0: 6f6c 6f72 225d 203d 2078 6c5f 636f 6c6f  olor"] = xl_colo
+0001a9b0: 7228 6f70 7469 6f6e 735b 2262 6172 5f63  r(options["bar_c
+0001a9c0: 6f6c 6f72 225d 290a 2020 2020 2020 2020  olor"]).        
+0001a9d0: 2020 2020 6f70 7469 6f6e 735b 2262 6172      options["bar
+0001a9e0: 5f62 6f72 6465 725f 636f 6c6f 7222 5d20  _border_color"] 
+0001a9f0: 3d20 786c 5f63 6f6c 6f72 286f 7074 696f  = xl_color(optio
+0001aa00: 6e73 5b22 6261 725f 626f 7264 6572 5f63  ns["bar_border_c
+0001aa10: 6f6c 6f72 225d 290a 2020 2020 2020 2020  olor"]).        
+0001aa20: 2020 2020 6f70 7469 6f6e 735b 2262 6172      options["bar
+0001aa30: 5f61 7869 735f 636f 6c6f 7222 5d20 3d20  _axis_color"] = 
+0001aa40: 786c 5f63 6f6c 6f72 286f 7074 696f 6e73  xl_color(options
+0001aa50: 5b22 6261 725f 6178 6973 5f63 6f6c 6f72  ["bar_axis_color
+0001aa60: 225d 290a 2020 2020 2020 2020 2020 2020  "]).            
+0001aa70: 6f70 7469 6f6e 735b 2262 6172 5f6e 6567  options["bar_neg
+0001aa80: 6174 6976 655f 636f 6c6f 7222 5d20 3d20  ative_color"] = 
+0001aa90: 786c 5f63 6f6c 6f72 286f 7074 696f 6e73  xl_color(options
+0001aaa0: 5b22 6261 725f 6e65 6761 7469 7665 5f63  ["bar_negative_c
+0001aab0: 6f6c 6f72 225d 290a 2020 2020 2020 2020  olor"]).        
+0001aac0: 2020 2020 6f70 7469 6f6e 735b 2262 6172      options["bar
+0001aad0: 5f6e 6567 6174 6976 655f 626f 7264 6572  _negative_border
+0001aae0: 5f63 6f6c 6f72 225d 203d 2078 6c5f 636f  _color"] = xl_co
+0001aaf0: 6c6f 7228 0a20 2020 2020 2020 2020 2020  lor(.           
+0001ab00: 2020 2020 206f 7074 696f 6e73 5b22 6261       options["ba
+0001ab10: 725f 6e65 6761 7469 7665 5f62 6f72 6465  r_negative_borde
+0001ab20: 725f 636f 6c6f 7222 5d0a 2020 2020 2020  r_color"].      
+0001ab30: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+0001ab40: 2023 2041 646a 7573 7420 666f 7220 3230   # Adjust for 20
+0001ab50: 3130 2073 7479 6c65 2064 6174 615f 6261  10 style data_ba
+0001ab60: 7220 7061 7261 6d65 7465 7273 2e0a 2020  r parameters..  
+0001ab70: 2020 2020 2020 6966 206f 7074 696f 6e73        if options
+0001ab80: 2e67 6574 2822 6973 5f64 6174 615f 6261  .get("is_data_ba
+0001ab90: 725f 3230 3130 2229 3a0a 2020 2020 2020  r_2010"):.      
+0001aba0: 2020 2020 2020 7365 6c66 2e65 7863 656c        self.excel
+0001abb0: 5f76 6572 7369 6f6e 203d 2032 3031 300a  _version = 2010.
+0001abc0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001abd0: 6f70 7469 6f6e 735b 226d 696e 5f74 7970  options["min_typ
+0001abe0: 6522 5d20 3d3d 2022 6d69 6e22 2061 6e64  e"] == "min" and
+0001abf0: 206f 7074 696f 6e73 5b22 6d69 6e5f 7661   options["min_va
+0001ac00: 6c75 6522 5d20 3d3d 2030 3a0a 2020 2020  lue"] == 0:.    
+0001ac10: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
+0001ac20: 6f6e 735b 226d 696e 5f76 616c 7565 225d  ons["min_value"]
+0001ac30: 203d 204e 6f6e 650a 0a20 2020 2020 2020   = None..       
+0001ac40: 2020 2020 2069 6620 6f70 7469 6f6e 735b       if options[
+0001ac50: 226d 6178 5f74 7970 6522 5d20 3d3d 2022  "max_type"] == "
+0001ac60: 6d61 7822 2061 6e64 206f 7074 696f 6e73  max" and options
+0001ac70: 5b22 6d61 785f 7661 6c75 6522 5d20 3d3d  ["max_value"] ==
+0001ac80: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+0001ac90: 2020 2020 6f70 7469 6f6e 735b 226d 6178      options["max
+0001aca0: 5f76 616c 7565 225d 203d 204e 6f6e 650a  _value"] = None.
+0001acb0: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
+0001acc0: 696f 6e73 5b22 7261 6e67 6522 5d20 3d20  ions["range"] = 
+0001acd0: 6365 6c6c 5f72 616e 6765 0a0a 2020 2020  cell_range..    
+0001ace0: 2020 2020 2320 5374 7269 7020 7468 6520      # Strip the 
+0001acf0: 6c65 6164 696e 6720 3d20 6672 6f6d 2066  leading = from f
+0001ad00: 6f72 6d75 6c61 732e 0a20 2020 2020 2020  ormulas..       
+0001ad10: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+0001ad20: 2020 6f70 7469 6f6e 735b 226d 696e 5f76    options["min_v
+0001ad30: 616c 7565 225d 203d 206f 7074 696f 6e73  alue"] = options
+0001ad40: 5b22 6d69 6e5f 7661 6c75 6522 5d2e 6c73  ["min_value"].ls
+0001ad50: 7472 6970 2822 3d22 290a 2020 2020 2020  trip("=").      
+0001ad60: 2020 6578 6365 7074 2028 4b65 7945 7272    except (KeyErr
+0001ad70: 6f72 2c20 4174 7472 6962 7574 6545 7272  or, AttributeErr
+0001ad80: 6f72 293a 0a20 2020 2020 2020 2020 2020  or):.           
+0001ad90: 2070 6173 730a 2020 2020 2020 2020 7472   pass.        tr
+0001ada0: 793a 0a20 2020 2020 2020 2020 2020 206f  y:.            o
+0001adb0: 7074 696f 6e73 5b22 6d69 645f 7661 6c75  ptions["mid_valu
+0001adc0: 6522 5d20 3d20 6f70 7469 6f6e 735b 226d  e"] = options["m
+0001add0: 6964 5f76 616c 7565 225d 2e6c 7374 7269  id_value"].lstri
+0001ade0: 7028 223d 2229 0a20 2020 2020 2020 2065  p("=").        e
+0001adf0: 7863 6570 7420 284b 6579 4572 726f 722c  xcept (KeyError,
+0001ae00: 2041 7474 7269 6275 7465 4572 726f 7229   AttributeError)
+0001ae10: 3a0a 2020 2020 2020 2020 2020 2020 7061  :.            pa
+0001ae20: 7373 0a20 2020 2020 2020 2074 7279 3a0a  ss.        try:.
+0001ae30: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
+0001ae40: 6f6e 735b 226d 6178 5f76 616c 7565 225d  ons["max_value"]
+0001ae50: 203d 206f 7074 696f 6e73 5b22 6d61 785f   = options["max_
+0001ae60: 7661 6c75 6522 5d2e 6c73 7472 6970 2822  value"].lstrip("
+0001ae70: 3d22 290a 2020 2020 2020 2020 6578 6365  =").        exce
+0001ae80: 7074 2028 4b65 7945 7272 6f72 2c20 4174  pt (KeyError, At
+0001ae90: 7472 6962 7574 6545 7272 6f72 293a 0a20  tributeError):. 
+0001aea0: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
+0001aeb0: 0a20 2020 2020 2020 2023 2053 746f 7265  .        # Store
+0001aec0: 2074 6865 2063 6f6e 6469 7469 6f6e 616c   the conditional
+0001aed0: 2066 6f72 6d61 7420 756e 7469 6c20 7765   format until we
+0001aee0: 2063 6c6f 7365 2074 6865 2077 6f72 6b73   close the works
+0001aef0: 6865 6574 2e0a 2020 2020 2020 2020 6966  heet..        if
+0001af00: 2063 656c 6c5f 7261 6e67 6520 696e 2073   cell_range in s
+0001af10: 656c 662e 636f 6e64 5f66 6f72 6d61 7473  elf.cond_formats
+0001af20: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+0001af30: 6c66 2e63 6f6e 645f 666f 726d 6174 735b  lf.cond_formats[
+0001af40: 6365 6c6c 5f72 616e 6765 5d2e 6170 7065  cell_range].appe
+0001af50: 6e64 286f 7074 696f 6e73 290a 2020 2020  nd(options).    
+0001af60: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001af70: 2020 2020 2020 7365 6c66 2e63 6f6e 645f        self.cond_
+0001af80: 666f 726d 6174 735b 6365 6c6c 5f72 616e  formats[cell_ran
+0001af90: 6765 5d20 3d20 5b6f 7074 696f 6e73 5d0a  ge] = [options].
+0001afa0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001afb0: 300a 0a20 2020 2040 636f 6e76 6572 745f  0..    @convert_
+0001afc0: 7261 6e67 655f 6172 6773 0a20 2020 2064  range_args.    d
+0001afd0: 6566 2061 6464 5f74 6162 6c65 2873 656c  ef add_table(sel
+0001afe0: 662c 2066 6972 7374 5f72 6f77 2c20 6669  f, first_row, fi
+0001aff0: 7273 745f 636f 6c2c 206c 6173 745f 726f  rst_col, last_ro
+0001b000: 772c 206c 6173 745f 636f 6c2c 206f 7074  w, last_col, opt
+0001b010: 696f 6e73 3d4e 6f6e 6529 3a0a 2020 2020  ions=None):.    
+0001b020: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001b030: 4164 6420 616e 2045 7863 656c 2074 6162  Add an Excel tab
+0001b040: 6c65 2074 6f20 6120 776f 726b 7368 6565  le to a workshee
+0001b050: 742e 0a0a 2020 2020 2020 2020 4172 6773  t...        Args
+0001b060: 3a0a 2020 2020 2020 2020 2020 2020 6669  :.            fi
+0001b070: 7273 745f 726f 773a 2020 2020 5468 6520  rst_row:    The 
+0001b080: 6669 7273 7420 726f 7720 6f66 2074 6865  first row of the
+0001b090: 2063 656c 6c20 7261 6e67 652e 2028 7a65   cell range. (ze
+0001b0a0: 726f 2069 6e64 6578 6564 292e 0a20 2020  ro indexed)..   
+0001b0b0: 2020 2020 2020 2020 2066 6972 7374 5f63           first_c
+0001b0c0: 6f6c 3a20 2020 2054 6865 2066 6972 7374  ol:    The first
+0001b0d0: 2063 6f6c 756d 6e20 6f66 2074 6865 2063   column of the c
+0001b0e0: 656c 6c20 7261 6e67 652e 0a20 2020 2020  ell range..     
+0001b0f0: 2020 2020 2020 206c 6173 745f 726f 773a         last_row:
+0001b100: 2020 2020 2054 6865 206c 6173 7420 726f       The last ro
+0001b110: 7720 6f66 2074 6865 2063 656c 6c20 7261  w of the cell ra
+0001b120: 6e67 652e 2028 7a65 726f 2069 6e64 6578  nge. (zero index
+0001b130: 6564 292e 0a20 2020 2020 2020 2020 2020  ed)..           
+0001b140: 206c 6173 745f 636f 6c3a 2020 2020 2054   last_col:     T
+0001b150: 6865 206c 6173 7420 636f 6c75 6d6e 206f  he last column o
+0001b160: 6620 7468 6520 6365 6c6c 2072 616e 6765  f the cell range
+0001b170: 2e0a 2020 2020 2020 2020 2020 2020 6f70  ..            op
+0001b180: 7469 6f6e 733a 2020 2020 2020 5461 626c  tions:      Tabl
+0001b190: 6520 666f 726d 6174 206f 7074 696f 6e73  e format options
+0001b1a0: 2e20 284f 7074 696f 6e61 6c29 0a0a 2020  . (Optional)..  
+0001b1b0: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
+0001b1c0: 2020 2020 2020 2020 2020 2030 3a20 2053             0:  S
+0001b1d0: 7563 6365 7373 2e0a 2020 2020 2020 2020  uccess..        
+0001b1e0: 2020 2020 2d31 3a20 526f 7720 6f72 2063      -1: Row or c
+0001b1f0: 6f6c 756d 6e20 6973 206f 7574 206f 6620  olumn is out of 
+0001b200: 776f 726b 7368 6565 7420 626f 756e 6473  worksheet bounds
+0001b210: 2e0a 2020 2020 2020 2020 2020 2020 2d32  ..            -2
+0001b220: 3a20 496e 636f 7272 6563 7420 7061 7261  : Incorrect para
+0001b230: 6d65 7465 7220 6f72 206f 7074 696f 6e2e  meter or option.
+0001b240: 0a20 2020 2020 2020 2020 2020 202d 333a  .            -3:
+0001b250: 204e 6f74 2073 7570 706f 7274 6564 2069   Not supported i
+0001b260: 6e20 636f 6e73 7461 6e74 5f6d 656d 6f72  n constant_memor
+0001b270: 7920 6d6f 6465 2e0a 2020 2020 2020 2020  y mode..        
+0001b280: 2222 220a 2020 2020 2020 2020 7461 626c  """.        tabl
+0001b290: 6520 3d20 7b7d 0a20 2020 2020 2020 2063  e = {}.        c
+0001b2a0: 6f6c 5f66 6f72 6d61 7473 203d 207b 7d0a  ol_formats = {}.
+0001b2b0: 0a20 2020 2020 2020 2069 6620 6f70 7469  .        if opti
+0001b2c0: 6f6e 7320 6973 204e 6f6e 653a 0a20 2020  ons is None:.   
+0001b2d0: 2020 2020 2020 2020 206f 7074 696f 6e73           options
+0001b2e0: 203d 207b 7d0a 2020 2020 2020 2020 656c   = {}.        el
+0001b2f0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0001b300: 2320 436f 7079 2074 6865 2075 7365 7220  # Copy the user 
+0001b310: 6465 6669 6e65 6420 6f70 7469 6f6e 7320  defined options 
+0001b320: 736f 2074 6865 7920 6172 656e 2774 206d  so they aren't m
+0001b330: 6f64 6966 6965 642e 0a20 2020 2020 2020  odified..       
+0001b340: 2020 2020 206f 7074 696f 6e73 203d 206f       options = o
+0001b350: 7074 696f 6e73 2e63 6f70 7928 290a 0a20  ptions.copy().. 
+0001b360: 2020 2020 2020 2069 6620 7365 6c66 2e63         if self.c
+0001b370: 6f6e 7374 616e 745f 6d65 6d6f 7279 3a0a  onstant_memory:.
+0001b380: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+0001b390: 2822 6164 645f 7461 626c 6528 2920 6973  ("add_table() is
+0001b3a0: 6e27 7420 7375 7070 6f72 7465 6420 696e  n't supported in
+0001b3b0: 2027 636f 6e73 7461 6e74 5f6d 656d 6f72   'constant_memor
+0001b3c0: 7927 206d 6f64 6522 290a 2020 2020 2020  y' mode").      
+0001b3d0: 2020 2020 2020 7265 7475 726e 202d 330a        return -3.
+0001b3e0: 0a20 2020 2020 2020 2023 2043 6865 636b  .        # Check
+0001b3f0: 2074 6861 7420 726f 7720 616e 6420 636f   that row and co
+0001b400: 6c20 6172 6520 7661 6c69 6420 7769 7468  l are valid with
+0001b410: 6f75 7420 7374 6f72 696e 6720 7468 6520  out storing the 
+0001b420: 7661 6c75 6573 2e0a 2020 2020 2020 2020  values..        
+0001b430: 6966 2073 656c 662e 5f63 6865 636b 5f64  if self._check_d
+0001b440: 696d 656e 7369 6f6e 7328 6669 7273 745f  imensions(first_
+0001b450: 726f 772c 2066 6972 7374 5f63 6f6c 2c20  row, first_col, 
+0001b460: 5472 7565 2c20 5472 7565 293a 0a20 2020  True, True):.   
+0001b470: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001b480: 2d31 0a20 2020 2020 2020 2069 6620 7365  -1.        if se
+0001b490: 6c66 2e5f 6368 6563 6b5f 6469 6d65 6e73  lf._check_dimens
+0001b4a0: 696f 6e73 286c 6173 745f 726f 772c 206c  ions(last_row, l
+0001b4b0: 6173 745f 636f 6c2c 2054 7275 652c 2054  ast_col, True, T
+0001b4c0: 7275 6529 3a0a 2020 2020 2020 2020 2020  rue):.          
+0001b4d0: 2020 7265 7475 726e 202d 310a 0a20 2020    return -1..   
+0001b4e0: 2020 2020 2023 2053 7761 7020 6c61 7374       # Swap last
+0001b4f0: 2072 6f77 2f63 6f6c 2066 6f72 2066 6972   row/col for fir
+0001b500: 7374 2072 6f77 2f63 6f6c 2061 7320 6e65  st row/col as ne
+0001b510: 6365 7373 6172 792e 0a20 2020 2020 2020  cessary..       
+0001b520: 2069 6620 6669 7273 745f 726f 7720 3e20   if first_row > 
+0001b530: 6c61 7374 5f72 6f77 3a0a 2020 2020 2020  last_row:.      
+0001b540: 2020 2020 2020 2866 6972 7374 5f72 6f77        (first_row
+0001b550: 2c20 6c61 7374 5f72 6f77 2920 3d20 286c  , last_row) = (l
+0001b560: 6173 745f 726f 772c 2066 6972 7374 5f72  ast_row, first_r
+0001b570: 6f77 290a 2020 2020 2020 2020 6966 2066  ow).        if f
+0001b580: 6972 7374 5f63 6f6c 203e 206c 6173 745f  irst_col > last_
+0001b590: 636f 6c3a 0a20 2020 2020 2020 2020 2020  col:.           
+0001b5a0: 2028 6669 7273 745f 636f 6c2c 206c 6173   (first_col, las
+0001b5b0: 745f 636f 6c29 203d 2028 6c61 7374 5f63  t_col) = (last_c
+0001b5c0: 6f6c 2c20 6669 7273 745f 636f 6c29 0a0a  ol, first_col)..
+0001b5d0: 2020 2020 2020 2020 2320 4368 6563 6b20          # Check 
+0001b5e0: 6966 2074 6865 2074 6162 6c65 2072 616e  if the table ran
+0001b5f0: 6765 206f 7665 726c 6170 7320 6120 7072  ge overlaps a pr
+0001b600: 6576 696f 7573 206d 6572 6765 6420 6f72  evious merged or
+0001b610: 2074 6162 6c65 2072 616e 6765 2e0a 2020   table range..  
+0001b620: 2020 2020 2020 2320 5468 6973 2069 7320        # This is 
+0001b630: 6120 6372 6974 6963 616c 2066 696c 6520  a critical file 
+0001b640: 636f 7272 7570 7469 6f6e 2065 7272 6f72  corruption error
+0001b650: 2069 6e20 4578 6365 6c2e 0a20 2020 2020   in Excel..     
+0001b660: 2020 2063 656c 6c5f 7261 6e67 6520 3d20     cell_range = 
+0001b670: 786c 5f72 616e 6765 2866 6972 7374 5f72  xl_range(first_r
+0001b680: 6f77 2c20 6669 7273 745f 636f 6c2c 206c  ow, first_col, l
+0001b690: 6173 745f 726f 772c 206c 6173 745f 636f  ast_row, last_co
+0001b6a0: 6c29 0a20 2020 2020 2020 2066 6f72 2072  l).        for r
+0001b6b0: 6f77 2069 6e20 7261 6e67 6528 6669 7273  ow in range(firs
+0001b6c0: 745f 726f 772c 206c 6173 745f 726f 7720  t_row, last_row 
+0001b6d0: 2b20 3129 3a0a 2020 2020 2020 2020 2020  + 1):.          
+0001b6e0: 2020 666f 7220 636f 6c20 696e 2072 616e    for col in ran
+0001b6f0: 6765 2866 6972 7374 5f63 6f6c 2c20 6c61  ge(first_col, la
+0001b700: 7374 5f63 6f6c 202b 2031 293a 0a20 2020  st_col + 1):.   
+0001b710: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0001b720: 7365 6c66 2e74 6162 6c65 5f63 656c 6c73  self.table_cells
+0001b730: 2e67 6574 2828 726f 772c 2063 6f6c 2929  .get((row, col))
+0001b740: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001b750: 2020 2020 2020 7072 6576 696f 7573 5f72        previous_r
+0001b760: 616e 6765 203d 2073 656c 662e 7461 626c  ange = self.tabl
+0001b770: 655f 6365 6c6c 732e 6765 7428 2872 6f77  e_cells.get((row
+0001b780: 2c20 636f 6c29 290a 2020 2020 2020 2020  , col)).        
+0001b790: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001b7a0: 6520 4f76 6572 6c61 7070 696e 6752 616e  e OverlappingRan
+0001b7b0: 6765 280a 2020 2020 2020 2020 2020 2020  ge(.            
+0001b7c0: 2020 2020 2020 2020 2020 2020 2254 6162              "Tab
+0001b7d0: 6c65 2072 616e 6765 2027 2573 2720 6f76  le range '%s' ov
+0001b7e0: 6572 6c61 7073 2070 7265 7669 6f75 7320  erlaps previous 
+0001b7f0: 7461 626c 6520 7261 6e67 6520 2725 7327  table range '%s'
+0001b800: 2e22 0a20 2020 2020 2020 2020 2020 2020  .".             
+0001b810: 2020 2020 2020 2020 2020 2025 2028 6365             % (ce
+0001b820: 6c6c 5f72 616e 6765 2c20 7072 6576 696f  ll_range, previo
+0001b830: 7573 5f72 616e 6765 290a 2020 2020 2020  us_range).      
+0001b840: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0001b850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b860: 656c 6966 2073 656c 662e 6d65 7267 6564  elif self.merged
+0001b870: 5f63 656c 6c73 2e67 6574 2828 726f 772c  _cells.get((row,
+0001b880: 2063 6f6c 2929 3a0a 2020 2020 2020 2020   col)):.        
+0001b890: 2020 2020 2020 2020 2020 2020 7072 6576              prev
+0001b8a0: 696f 7573 5f72 616e 6765 203d 2073 656c  ious_range = sel
+0001b8b0: 662e 6d65 7267 6564 5f63 656c 6c73 2e67  f.merged_cells.g
+0001b8c0: 6574 2828 726f 772c 2063 6f6c 2929 0a20  et((row, col)). 
+0001b8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b8e0: 2020 2072 6169 7365 204f 7665 726c 6170     raise Overlap
+0001b8f0: 7069 6e67 5261 6e67 6528 0a20 2020 2020  pingRange(.     
+0001b900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b910: 2020 2022 5461 626c 6520 7261 6e67 6520     "Table range 
+0001b920: 2725 7327 206f 7665 726c 6170 7320 7072  '%s' overlaps pr
+0001b930: 6576 696f 7573 206d 6572 6765 2072 616e  evious merge ran
+0001b940: 6765 2027 2573 272e 220a 2020 2020 2020  ge '%s'.".      
+0001b950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b960: 2020 2520 2863 656c 6c5f 7261 6e67 652c    % (cell_range,
+0001b970: 2070 7265 7669 6f75 735f 7261 6e67 6529   previous_range)
+0001b980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b990: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0001b9a0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001b9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b9c0: 2073 656c 662e 7461 626c 655f 6365 6c6c   self.table_cell
+0001b9d0: 735b 2872 6f77 2c20 636f 6c29 5d20 3d20  s[(row, col)] = 
+0001b9e0: 6365 6c6c 5f72 616e 6765 0a0a 2020 2020  cell_range..    
+0001b9f0: 2020 2020 2320 5661 6c69 6420 696e 7075      # Valid inpu
+0001ba00: 7420 7061 7261 6d65 7465 7273 2e0a 2020  t parameters..  
+0001ba10: 2020 2020 2020 7661 6c69 645f 7061 7261        valid_para
+0001ba20: 6d65 7465 7220 3d20 7b0a 2020 2020 2020  meter = {.      
+0001ba30: 2020 2020 2020 2261 7574 6f66 696c 7465        "autofilte
+0001ba40: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
+0001ba50: 2262 616e 6465 645f 636f 6c75 6d6e 7322  "banded_columns"
+0001ba60: 2c0a 2020 2020 2020 2020 2020 2020 2262  ,.            "b
+0001ba70: 616e 6465 645f 726f 7773 222c 0a20 2020  anded_rows",.   
+0001ba80: 2020 2020 2020 2020 2022 636f 6c75 6d6e           "column
+0001ba90: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
+0001baa0: 2264 6174 6122 2c0a 2020 2020 2020 2020  "data",.        
+0001bab0: 2020 2020 2266 6972 7374 5f63 6f6c 756d      "first_colum
+0001bac0: 6e22 2c0a 2020 2020 2020 2020 2020 2020  n",.            
+0001bad0: 2268 6561 6465 725f 726f 7722 2c0a 2020  "header_row",.  
+0001bae0: 2020 2020 2020 2020 2020 226c 6173 745f            "last_
+0001baf0: 636f 6c75 6d6e 222c 0a20 2020 2020 2020  column",.       
+0001bb00: 2020 2020 2022 6e61 6d65 222c 0a20 2020       "name",.   
+0001bb10: 2020 2020 2020 2020 2022 7374 796c 6522           "style"
+0001bb20: 2c0a 2020 2020 2020 2020 2020 2020 2274  ,.            "t
+0001bb30: 6f74 616c 5f72 6f77 222c 0a20 2020 2020  otal_row",.     
+0001bb40: 2020 207d 0a0a 2020 2020 2020 2020 2320     }..        # 
+0001bb50: 4368 6563 6b20 666f 7220 7661 6c69 6420  Check for valid 
+0001bb60: 696e 7075 7420 7061 7261 6d65 7465 7273  input parameters
+0001bb70: 2e0a 2020 2020 2020 2020 666f 7220 7061  ..        for pa
+0001bb80: 7261 6d5f 6b65 7920 696e 206f 7074 696f  ram_key in optio
+0001bb90: 6e73 2e6b 6579 7328 293a 0a20 2020 2020  ns.keys():.     
+0001bba0: 2020 2020 2020 2069 6620 7061 7261 6d5f         if param_
+0001bbb0: 6b65 7920 6e6f 7420 696e 2076 616c 6964  key not in valid
+0001bbc0: 5f70 6172 616d 6574 6572 3a0a 2020 2020  _parameter:.    
+0001bbd0: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+0001bbe0: 2822 556e 6b6e 6f77 6e20 7061 7261 6d65  ("Unknown parame
+0001bbf0: 7465 7220 2725 7327 2069 6e20 6164 645f  ter '%s' in add_
+0001bc00: 7461 626c 6528 2922 2025 2070 6172 616d  table()" % param
+0001bc10: 5f6b 6579 290a 2020 2020 2020 2020 2020  _key).          
+0001bc20: 2020 2020 2020 7265 7475 726e 202d 320a        return -2.
+0001bc30: 0a20 2020 2020 2020 2023 2054 7572 6e20  .        # Turn 
+0001bc40: 6f6e 2045 7863 656c 2773 2064 6566 6175  on Excel's defau
+0001bc50: 6c74 732e 0a20 2020 2020 2020 206f 7074  lts..        opt
+0001bc60: 696f 6e73 5b22 6261 6e64 6564 5f72 6f77  ions["banded_row
+0001bc70: 7322 5d20 3d20 6f70 7469 6f6e 732e 6765  s"] = options.ge
+0001bc80: 7428 2262 616e 6465 645f 726f 7773 222c  t("banded_rows",
+0001bc90: 2054 7275 6529 0a20 2020 2020 2020 206f   True).        o
+0001bca0: 7074 696f 6e73 5b22 6865 6164 6572 5f72  ptions["header_r
+0001bcb0: 6f77 225d 203d 206f 7074 696f 6e73 2e67  ow"] = options.g
+0001bcc0: 6574 2822 6865 6164 6572 5f72 6f77 222c  et("header_row",
+0001bcd0: 2054 7275 6529 0a20 2020 2020 2020 206f   True).        o
+0001bce0: 7074 696f 6e73 5b22 6175 746f 6669 6c74  ptions["autofilt
+0001bcf0: 6572 225d 203d 206f 7074 696f 6e73 2e67  er"] = options.g
+0001bd00: 6574 2822 6175 746f 6669 6c74 6572 222c  et("autofilter",
+0001bd10: 2054 7275 6529 0a0a 2020 2020 2020 2020   True)..        
+0001bd20: 2320 4368 6563 6b20 7468 6174 2074 6865  # Check that the
+0001bd30: 7265 2061 7265 2065 6e6f 7567 6820 726f  re are enough ro
+0001bd40: 7773 2e0a 2020 2020 2020 2020 6e75 6d5f  ws..        num_
+0001bd50: 726f 7773 203d 206c 6173 745f 726f 7720  rows = last_row 
+0001bd60: 2d20 6669 7273 745f 726f 770a 2020 2020  - first_row.    
+0001bd70: 2020 2020 6966 206f 7074 696f 6e73 5b22      if options["
+0001bd80: 6865 6164 6572 5f72 6f77 225d 3a0a 2020  header_row"]:.  
+0001bd90: 2020 2020 2020 2020 2020 6e75 6d5f 726f            num_ro
+0001bda0: 7773 202d 3d20 310a 0a20 2020 2020 2020  ws -= 1..       
+0001bdb0: 2069 6620 6e75 6d5f 726f 7773 203c 2030   if num_rows < 0
+0001bdc0: 3a0a 2020 2020 2020 2020 2020 2020 7761  :.            wa
+0001bdd0: 726e 2822 4d75 7374 2068 6176 6520 6174  rn("Must have at
+0001bde0: 206c 6561 7374 206f 6e65 2064 6174 6120   least one data 
+0001bdf0: 726f 7720 696e 2069 6e20 6164 645f 7461  row in in add_ta
+0001be00: 626c 6528 2922 290a 2020 2020 2020 2020  ble()").        
+0001be10: 2020 2020 7265 7475 726e 202d 320a 0a20      return -2.. 
+0001be20: 2020 2020 2020 2023 2053 6574 2074 6865         # Set the
+0001be30: 2074 6162 6c65 206f 7074 696f 6e73 2e0a   table options..
+0001be40: 2020 2020 2020 2020 7461 626c 655b 2273          table["s
+0001be50: 686f 775f 6669 7273 745f 636f 6c22 5d20  how_first_col"] 
+0001be60: 3d20 6f70 7469 6f6e 732e 6765 7428 2266  = options.get("f
+0001be70: 6972 7374 5f63 6f6c 756d 6e22 2c20 4661  irst_column", Fa
+0001be80: 6c73 6529 0a20 2020 2020 2020 2074 6162  lse).        tab
+0001be90: 6c65 5b22 7368 6f77 5f6c 6173 745f 636f  le["show_last_co
+0001bea0: 6c22 5d20 3d20 6f70 7469 6f6e 732e 6765  l"] = options.ge
+0001beb0: 7428 226c 6173 745f 636f 6c75 6d6e 222c  t("last_column",
+0001bec0: 2046 616c 7365 290a 2020 2020 2020 2020   False).        
+0001bed0: 7461 626c 655b 2273 686f 775f 726f 775f  table["show_row_
+0001bee0: 7374 7269 7065 7322 5d20 3d20 6f70 7469  stripes"] = opti
+0001bef0: 6f6e 732e 6765 7428 2262 616e 6465 645f  ons.get("banded_
+0001bf00: 726f 7773 222c 2046 616c 7365 290a 2020  rows", False).  
+0001bf10: 2020 2020 2020 7461 626c 655b 2273 686f        table["sho
+0001bf20: 775f 636f 6c5f 7374 7269 7065 7322 5d20  w_col_stripes"] 
+0001bf30: 3d20 6f70 7469 6f6e 732e 6765 7428 2262  = options.get("b
+0001bf40: 616e 6465 645f 636f 6c75 6d6e 7322 2c20  anded_columns", 
+0001bf50: 4661 6c73 6529 0a20 2020 2020 2020 2074  False).        t
+0001bf60: 6162 6c65 5b22 6865 6164 6572 5f72 6f77  able["header_row
+0001bf70: 5f63 6f75 6e74 225d 203d 206f 7074 696f  _count"] = optio
+0001bf80: 6e73 2e67 6574 2822 6865 6164 6572 5f72  ns.get("header_r
+0001bf90: 6f77 222c 2030 290a 2020 2020 2020 2020  ow", 0).        
+0001bfa0: 7461 626c 655b 2274 6f74 616c 735f 726f  table["totals_ro
+0001bfb0: 775f 7368 6f77 6e22 5d20 3d20 6f70 7469  w_shown"] = opti
+0001bfc0: 6f6e 732e 6765 7428 2274 6f74 616c 5f72  ons.get("total_r
+0001bfd0: 6f77 222c 2046 616c 7365 290a 0a20 2020  ow", False)..   
+0001bfe0: 2020 2020 2023 2053 6574 2074 6865 2074       # Set the t
+0001bff0: 6162 6c65 206e 616d 652e 0a20 2020 2020  able name..     
+0001c000: 2020 2069 6620 226e 616d 6522 2069 6e20     if "name" in 
+0001c010: 6f70 7469 6f6e 733a 0a20 2020 2020 2020  options:.       
+0001c020: 2020 2020 206e 616d 6520 3d20 6f70 7469       name = opti
+0001c030: 6f6e 735b 226e 616d 6522 5d0a 2020 2020  ons["name"].    
+0001c040: 2020 2020 2020 2020 7461 626c 655b 226e          table["n
+0001c050: 616d 6522 5d20 3d20 6e61 6d65 0a0a 2020  ame"] = name..  
+0001c060: 2020 2020 2020 2020 2020 6966 2022 2022            if " "
+0001c070: 2069 6e20 6e61 6d65 3a0a 2020 2020 2020   in name:.      
+0001c080: 2020 2020 2020 2020 2020 7761 726e 2822            warn("
+0001c090: 4e61 6d65 2027 2573 2720 696e 2061 6464  Name '%s' in add
+0001c0a0: 5f74 6162 6c65 2829 2063 616e 6e6f 7420  _table() cannot 
+0001c0b0: 636f 6e74 6169 6e20 7370 6163 6573 2220  contain spaces" 
+0001c0c0: 2520 6e61 6d65 290a 2020 2020 2020 2020  % name).        
+0001c0d0: 2020 2020 2020 2020 7265 7475 726e 202d          return -
+0001c0e0: 320a 0a20 2020 2020 2020 2020 2020 2023  2..            #
+0001c0f0: 2057 6172 6e20 6966 2074 6865 206e 616d   Warn if the nam
+0001c100: 6520 636f 6e74 6169 6e73 2069 6e76 616c  e contains inval
+0001c110: 6964 2063 6861 7273 2061 7320 6465 6669  id chars as defi
+0001c120: 6e65 6420 6279 2045 7863 656c 2e0a 2020  ned by Excel..  
+0001c130: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+0001c140: 2072 652e 6d61 7463 6828 7222 5e5b 5c77   re.match(r"^[\w
+0001c150: 5c5c 5d5b 5c77 5c5c 2e5d 2a24 222c 206e  \\][\w\\.]*$", n
+0001c160: 616d 652c 2072 652e 554e 4943 4f44 4529  ame, re.UNICODE)
+0001c170: 206f 7220 7265 2e6d 6174 6368 280a 2020   or re.match(.  
+0001c180: 2020 2020 2020 2020 2020 2020 2020 7222                r"
+0001c190: 5e5c 6422 2c20 6e61 6d65 0a20 2020 2020  ^\d", name.     
+0001c1a0: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+0001c1b0: 2020 2020 2020 2020 2020 7761 726e 2822            warn("
+0001c1c0: 496e 7661 6c69 6420 4578 6365 6c20 6368  Invalid Excel ch
+0001c1d0: 6172 6163 7465 7273 2069 6e20 6164 645f  aracters in add_
+0001c1e0: 7461 626c 6528 293a 2027 2573 2722 2025  table(): '%s'" %
+0001c1f0: 206e 616d 6529 0a20 2020 2020 2020 2020   name).         
+0001c200: 2020 2020 2020 2072 6574 7572 6e20 2d32         return -2
+0001c210: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+0001c220: 5761 726e 2069 6620 7468 6520 6e61 6d65  Warn if the name
+0001c230: 206c 6f6f 6b73 206c 696b 6520 6120 6365   looks like a ce
+0001c240: 6c6c 206e 616d 652e 0a20 2020 2020 2020  ll name..       
+0001c250: 2020 2020 2069 6620 7265 2e6d 6174 6368       if re.match
+0001c260: 2872 225e 5b61 2d7a 412d 5a5d 5b61 2d7a  (r"^[a-zA-Z][a-z
+0001c270: 412d 5a5d 3f5b 612d 6441 2d44 5d3f 5b30  A-Z]?[a-dA-D]?[0
+0001c280: 2d39 5d2b 2422 2c20 6e61 6d65 293a 0a20  -9]+$", name):. 
+0001c290: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+0001c2a0: 6172 6e28 224e 616d 6520 6c6f 6f6b 7320  arn("Name looks 
+0001c2b0: 6c69 6b65 2061 2063 656c 6c20 6e61 6d65  like a cell name
+0001c2c0: 2069 6e20 6164 645f 7461 626c 6528 293a   in add_table():
+0001c2d0: 2027 2573 2722 2025 206e 616d 6529 0a20   '%s'" % name). 
+0001c2e0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0001c2f0: 6574 7572 6e20 2d32 0a0a 2020 2020 2020  eturn -2..      
+0001c300: 2020 2020 2020 2320 5761 726e 2069 6620        # Warn if 
+0001c310: 7468 6520 6e61 6d65 206c 6f6f 6b73 206c  the name looks l
+0001c320: 696b 6520 6120 5231 4331 2063 656c 6c20  ike a R1C1 cell 
+0001c330: 7265 6665 7265 6e63 652e 0a20 2020 2020  reference..     
+0001c340: 2020 2020 2020 2069 6620 7265 2e6d 6174         if re.mat
+0001c350: 6368 2872 225e 5b72 6352 435d 2422 2c20  ch(r"^[rcRC]$", 
+0001c360: 6e61 6d65 2920 6f72 2072 652e 6d61 7463  name) or re.matc
+0001c370: 6828 7222 5e5b 7263 5243 5d5c 642b 5b72  h(r"^[rcRC]\d+[r
+0001c380: 6352 435d 5c64 2b24 222c 206e 616d 6529  cRC]\d+$", name)
+0001c390: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001c3a0: 2020 7761 726e 2822 496e 7661 6c69 6420    warn("Invalid 
+0001c3b0: 6e61 6d65 2027 2573 2720 6c69 6b65 2061  name '%s' like a
+0001c3c0: 2052 4320 6365 6c6c 2072 6566 2069 6e20   RC cell ref in 
+0001c3d0: 6164 645f 7461 626c 6528 2922 2025 206e  add_table()" % n
+0001c3e0: 616d 6529 0a20 2020 2020 2020 2020 2020  ame).           
+0001c3f0: 2020 2020 2072 6574 7572 6e20 2d32 0a0a       return -2..
+0001c400: 2020 2020 2020 2020 2320 5365 7420 7468          # Set th
+0001c410: 6520 7461 626c 6520 7374 796c 652e 0a20  e table style.. 
+0001c420: 2020 2020 2020 2069 6620 2273 7479 6c65         if "style
+0001c430: 2220 696e 206f 7074 696f 6e73 3a0a 2020  " in options:.  
+0001c440: 2020 2020 2020 2020 2020 7461 626c 655b            table[
+0001c450: 2273 7479 6c65 225d 203d 206f 7074 696f  "style"] = optio
+0001c460: 6e73 5b22 7374 796c 6522 5d0a 0a20 2020  ns["style"]..   
+0001c470: 2020 2020 2020 2020 2069 6620 7461 626c           if tabl
+0001c480: 655b 2273 7479 6c65 225d 2069 7320 4e6f  e["style"] is No
+0001c490: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0001c4a0: 2020 2020 7461 626c 655b 2273 7479 6c65      table["style
+0001c4b0: 225d 203d 2022 220a 0a20 2020 2020 2020  "] = ""..       
+0001c4c0: 2020 2020 2023 2052 656d 6f76 6520 7768       # Remove wh
+0001c4d0: 6974 6573 7061 6365 2066 726f 6d20 7374  itespace from st
+0001c4e0: 796c 6520 6e61 6d65 2e0a 2020 2020 2020  yle name..      
+0001c4f0: 2020 2020 2020 7461 626c 655b 2273 7479        table["sty
+0001c500: 6c65 225d 203d 2074 6162 6c65 5b22 7374  le"] = table["st
+0001c510: 796c 6522 5d2e 7265 706c 6163 6528 2220  yle"].replace(" 
+0001c520: 222c 2022 2229 0a20 2020 2020 2020 2065  ", "").        e
+0001c530: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0001c540: 2074 6162 6c65 5b22 7374 796c 6522 5d20   table["style"] 
+0001c550: 3d20 2254 6162 6c65 5374 796c 654d 6564  = "TableStyleMed
+0001c560: 6975 6d39 220a 0a20 2020 2020 2020 2023  ium9"..        #
+0001c570: 2053 6574 2074 6865 2064 6174 6120 7261   Set the data ra
+0001c580: 6e67 6520 726f 7773 2028 7769 7468 6f75  nge rows (withou
+0001c590: 7420 7468 6520 6865 6164 6572 2061 6e64  t the header and
+0001c5a0: 2066 6f6f 7465 7229 2e0a 2020 2020 2020   footer)..      
+0001c5b0: 2020 6669 7273 745f 6461 7461 5f72 6f77    first_data_row
+0001c5c0: 203d 2066 6972 7374 5f72 6f77 0a20 2020   = first_row.   
+0001c5d0: 2020 2020 206c 6173 745f 6461 7461 5f72       last_data_r
+0001c5e0: 6f77 203d 206c 6173 745f 726f 770a 0a20  ow = last_row.. 
+0001c5f0: 2020 2020 2020 2069 6620 6f70 7469 6f6e         if option
+0001c600: 732e 6765 7428 2268 6561 6465 725f 726f  s.get("header_ro
+0001c610: 7722 293a 0a20 2020 2020 2020 2020 2020  w"):.           
+0001c620: 2066 6972 7374 5f64 6174 615f 726f 7720   first_data_row 
+0001c630: 2b3d 2031 0a0a 2020 2020 2020 2020 6966  += 1..        if
+0001c640: 206f 7074 696f 6e73 2e67 6574 2822 746f   options.get("to
+0001c650: 7461 6c5f 726f 7722 293a 0a20 2020 2020  tal_row"):.     
+0001c660: 2020 2020 2020 206c 6173 745f 6461 7461         last_data
+0001c670: 5f72 6f77 202d 3d20 310a 0a20 2020 2020  _row -= 1..     
+0001c680: 2020 2023 2053 6574 2074 6865 2074 6162     # Set the tab
+0001c690: 6c65 2061 6e64 2061 7574 6f66 696c 7465  le and autofilte
+0001c6a0: 7220 7261 6e67 6573 2e0a 2020 2020 2020  r ranges..      
+0001c6b0: 2020 7461 626c 655b 2272 616e 6765 225d    table["range"]
+0001c6c0: 203d 2078 6c5f 7261 6e67 6528 6669 7273   = xl_range(firs
+0001c6d0: 745f 726f 772c 2066 6972 7374 5f63 6f6c  t_row, first_col
+0001c6e0: 2c20 6c61 7374 5f72 6f77 2c20 6c61 7374  , last_row, last
+0001c6f0: 5f63 6f6c 290a 0a20 2020 2020 2020 2074  _col)..        t
+0001c700: 6162 6c65 5b22 615f 7261 6e67 6522 5d20  able["a_range"] 
+0001c710: 3d20 786c 5f72 616e 6765 2866 6972 7374  = xl_range(first
+0001c720: 5f72 6f77 2c20 6669 7273 745f 636f 6c2c  _row, first_col,
+0001c730: 206c 6173 745f 6461 7461 5f72 6f77 2c20   last_data_row, 
+0001c740: 6c61 7374 5f63 6f6c 290a 0a20 2020 2020  last_col)..     
+0001c750: 2020 2023 2049 6620 7468 6520 6865 6164     # If the head
+0001c760: 6572 2072 6f77 2069 6620 6f66 6620 7468  er row if off th
+0001c770: 6520 6465 6661 756c 7420 6973 2074 6f20  e default is to 
+0001c780: 7475 726e 2061 7574 6f66 696c 7465 7220  turn autofilter 
+0001c790: 6f66 662e 0a20 2020 2020 2020 2069 6620  off..        if 
+0001c7a0: 6e6f 7420 6f70 7469 6f6e 735b 2268 6561  not options["hea
+0001c7b0: 6465 725f 726f 7722 5d3a 0a20 2020 2020  der_row"]:.     
+0001c7c0: 2020 2020 2020 206f 7074 696f 6e73 5b22         options["
+0001c7d0: 6175 746f 6669 6c74 6572 225d 203d 2030  autofilter"] = 0
+0001c7e0: 0a0a 2020 2020 2020 2020 2320 5365 7420  ..        # Set 
+0001c7f0: 7468 6520 6175 746f 6669 6c74 6572 2072  the autofilter r
+0001c800: 616e 6765 2e0a 2020 2020 2020 2020 6966  ange..        if
+0001c810: 206f 7074 696f 6e73 5b22 6175 746f 6669   options["autofi
+0001c820: 6c74 6572 225d 3a0a 2020 2020 2020 2020  lter"]:.        
+0001c830: 2020 2020 7461 626c 655b 2261 7574 6f66      table["autof
+0001c840: 696c 7465 7222 5d20 3d20 7461 626c 655b  ilter"] = table[
+0001c850: 2261 5f72 616e 6765 225d 0a0a 2020 2020  "a_range"]..    
+0001c860: 2020 2020 2320 4164 6420 7468 6520 7461      # Add the ta
+0001c870: 626c 6520 636f 6c75 6d6e 732e 0a20 2020  ble columns..   
+0001c880: 2020 2020 2063 6f6c 5f69 6420 3d20 310a       col_id = 1.
+0001c890: 2020 2020 2020 2020 7461 626c 655b 2263          table["c
+0001c8a0: 6f6c 756d 6e73 225d 203d 205b 5d0a 2020  olumns"] = [].  
+0001c8b0: 2020 2020 2020 7365 656e 5f6e 616d 6573        seen_names
+0001c8c0: 203d 207b 7d0a 0a20 2020 2020 2020 2066   = {}..        f
+0001c8d0: 6f72 2063 6f6c 5f6e 756d 2069 6e20 7261  or col_num in ra
+0001c8e0: 6e67 6528 6669 7273 745f 636f 6c2c 206c  nge(first_col, l
+0001c8f0: 6173 745f 636f 6c20 2b20 3129 3a0a 2020  ast_col + 1):.  
+0001c900: 2020 2020 2020 2020 2020 2320 5365 7420            # Set 
+0001c910: 7570 2074 6865 2064 6566 6175 6c74 2063  up the default c
+0001c920: 6f6c 756d 6e20 6461 7461 2e0a 2020 2020  olumn data..    
+0001c930: 2020 2020 2020 2020 636f 6c5f 6461 7461          col_data
+0001c940: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+0001c950: 2020 2020 2022 6964 223a 2063 6f6c 5f69       "id": col_i
+0001c960: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
+0001c970: 2020 2022 6e61 6d65 223a 2022 436f 6c75     "name": "Colu
+0001c980: 6d6e 2220 2b20 7374 7228 636f 6c5f 6964  mn" + str(col_id
+0001c990: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0001c9a0: 2020 2022 746f 7461 6c5f 7374 7269 6e67     "total_string
+0001c9b0: 223a 2022 222c 0a20 2020 2020 2020 2020  ": "",.         
+0001c9c0: 2020 2020 2020 2022 746f 7461 6c5f 6675         "total_fu
+0001c9d0: 6e63 7469 6f6e 223a 2022 222c 0a20 2020  nction": "",.   
+0001c9e0: 2020 2020 2020 2020 2020 2020 2022 746f               "to
+0001c9f0: 7461 6c5f 7661 6c75 6522 3a20 302c 0a20  tal_value": 0,. 
+0001ca00: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001ca10: 666f 726d 756c 6122 3a20 2222 2c0a 2020  formula": "",.  
+0001ca20: 2020 2020 2020 2020 2020 2020 2020 2266                "f
+0001ca30: 6f72 6d61 7422 3a20 4e6f 6e65 2c0a 2020  ormat": None,.  
+0001ca40: 2020 2020 2020 2020 2020 2020 2020 226e                "n
+0001ca50: 616d 655f 666f 726d 6174 223a 204e 6f6e  ame_format": Non
+0001ca60: 652c 0a20 2020 2020 2020 2020 2020 207d  e,.            }
+0001ca70: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+0001ca80: 4f76 6572 7772 6974 6520 7468 6520 6465  Overwrite the de
+0001ca90: 6661 756c 7473 2077 6974 6820 616e 7920  faults with any 
+0001caa0: 7573 6572 2064 6566 696e 6564 2076 616c  user defined val
+0001cab0: 7565 732e 0a20 2020 2020 2020 2020 2020  ues..           
+0001cac0: 2069 6620 2263 6f6c 756d 6e73 2220 696e   if "columns" in
+0001cad0: 206f 7074 696f 6e73 3a0a 2020 2020 2020   options:.      
+0001cae0: 2020 2020 2020 2020 2020 2320 4368 6563            # Chec
+0001caf0: 6b20 6966 2074 6865 7265 2061 7265 2075  k if there are u
+0001cb00: 7365 7220 6465 6669 6e65 6420 7661 6c75  ser defined valu
+0001cb10: 6573 2066 6f72 2074 6869 7320 636f 6c75  es for this colu
+0001cb20: 6d6e 2e0a 2020 2020 2020 2020 2020 2020  mn..            
+0001cb30: 2020 2020 6966 2063 6f6c 5f69 6420 3c3d      if col_id <=
+0001cb40: 206c 656e 286f 7074 696f 6e73 5b22 636f   len(options["co
+0001cb50: 6c75 6d6e 7322 5d29 3a0a 2020 2020 2020  lumns"]):.      
+0001cb60: 2020 2020 2020 2020 2020 2020 2020 7573                us
+0001cb70: 6572 5f64 6174 6120 3d20 6f70 7469 6f6e  er_data = option
+0001cb80: 735b 2263 6f6c 756d 6e73 225d 5b63 6f6c  s["columns"][col
+0001cb90: 5f69 6420 2d20 315d 0a20 2020 2020 2020  _id - 1].       
+0001cba0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0001cbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cbc0: 2020 2075 7365 725f 6461 7461 203d 204e     user_data = N
+0001cbd0: 6f6e 650a 0a20 2020 2020 2020 2020 2020  one..           
+0001cbe0: 2020 2020 2069 6620 7573 6572 5f64 6174       if user_dat
+0001cbf0: 613a 0a20 2020 2020 2020 2020 2020 2020  a:.             
+0001cc00: 2020 2020 2020 2023 2047 6574 2074 6865         # Get the
+0001cc10: 2063 6f6c 756d 6e20 666f 726d 6174 2e0a   column format..
+0001cc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cc30: 2020 2020 7866 6f72 6d61 7420 3d20 7573      xformat = us
+0001cc40: 6572 5f64 6174 612e 6765 7428 2266 6f72  er_data.get("for
+0001cc50: 6d61 7422 2c20 4e6f 6e65 290a 0a20 2020  mat", None)..   
+0001cc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cc70: 2023 204d 6170 2075 7365 7220 6465 6669   # Map user defi
+0001cc80: 6e65 6420 7661 6c75 6573 2074 6f20 696e  ned values to in
+0001cc90: 7465 726e 616c 2076 616c 7565 732e 0a20  ternal values.. 
+0001cca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ccb0: 2020 2069 6620 7573 6572 5f64 6174 612e     if user_data.
+0001ccc0: 6765 7428 2268 6561 6465 7222 293a 0a20  get("header"):. 
+0001ccd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cce0: 2020 2020 2020 2063 6f6c 5f64 6174 615b         col_data[
+0001ccf0: 226e 616d 6522 5d20 3d20 7573 6572 5f64  "name"] = user_d
+0001cd00: 6174 615b 2268 6561 6465 7222 5d0a 0a20  ata["header"].. 
+0001cd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cd20: 2020 2023 2045 7863 656c 2072 6571 7569     # Excel requi
+0001cd30: 7265 7320 756e 6971 7565 2063 6173 6520  res unique case 
+0001cd40: 696e 7365 6e73 6974 6976 6520 6865 6164  insensitive head
+0001cd50: 6572 206e 616d 6573 2e0a 2020 2020 2020  er names..      
+0001cd60: 2020 2020 2020 2020 2020 2020 2020 6865                he
+0001cd70: 6164 6572 5f6e 616d 6520 3d20 636f 6c5f  ader_name = col_
+0001cd80: 6461 7461 5b22 6e61 6d65 225d 0a20 2020  data["name"].   
+0001cd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cda0: 206e 616d 6520 3d20 6865 6164 6572 5f6e   name = header_n
+0001cdb0: 616d 652e 6c6f 7765 7228 290a 2020 2020  ame.lower().    
+0001cdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cdd0: 6966 206e 616d 6520 696e 2073 6565 6e5f  if name in seen_
+0001cde0: 6e61 6d65 733a 0a20 2020 2020 2020 2020  names:.         
+0001cdf0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+0001ce00: 6172 6e28 2244 7570 6c69 6361 7465 2068  arn("Duplicate h
+0001ce10: 6561 6465 7220 6e61 6d65 2069 6e20 6164  eader name in ad
+0001ce20: 645f 7461 626c 6528 293a 2027 2573 2722  d_table(): '%s'"
+0001ce30: 2025 206e 616d 6529 0a20 2020 2020 2020   % name).       
+0001ce40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ce50: 2072 6574 7572 6e20 2d32 0a20 2020 2020   return -2.     
+0001ce60: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0001ce70: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0001ce80: 2020 2020 2020 2020 2020 2020 2073 6565               see
+0001ce90: 6e5f 6e61 6d65 735b 6e61 6d65 5d20 3d20  n_names[name] = 
+0001cea0: 5472 7565 0a0a 2020 2020 2020 2020 2020  True..          
+0001ceb0: 2020 2020 2020 2020 2020 636f 6c5f 6461            col_da
+0001cec0: 7461 5b22 6e61 6d65 5f66 6f72 6d61 7422  ta["name_format"
+0001ced0: 5d20 3d20 7573 6572 5f64 6174 612e 6765  ] = user_data.ge
+0001cee0: 7428 2268 6561 6465 725f 666f 726d 6174  t("header_format
+0001cef0: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
+0001cf00: 2020 2020 2020 2020 2320 4861 6e64 6c65          # Handle
+0001cf10: 2074 6865 2063 6f6c 756d 6e20 666f 726d   the column form
+0001cf20: 756c 612e 0a20 2020 2020 2020 2020 2020  ula..           
+0001cf30: 2020 2020 2020 2020 2069 6620 2266 6f72           if "for
+0001cf40: 6d75 6c61 2220 696e 2075 7365 725f 6461  mula" in user_da
+0001cf50: 7461 2061 6e64 2075 7365 725f 6461 7461  ta and user_data
+0001cf60: 5b22 666f 726d 756c 6122 5d3a 0a20 2020  ["formula"]:.   
+0001cf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cf80: 2020 2020 2066 6f72 6d75 6c61 203d 2075       formula = u
+0001cf90: 7365 725f 6461 7461 5b22 666f 726d 756c  ser_data["formul
+0001cfa0: 6122 5d0a 0a20 2020 2020 2020 2020 2020  a"]..           
+0001cfb0: 2020 2020 2020 2020 2020 2020 2023 2052               # R
+0001cfc0: 656d 6f76 6520 7468 6520 666f 726d 756c  emove the formul
+0001cfd0: 6120 273d 2720 7369 676e 2069 6620 6974  a '=' sign if it
+0001cfe0: 2065 7869 7374 732e 0a20 2020 2020 2020   exists..       
+0001cff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d000: 2069 6620 666f 726d 756c 612e 7374 6172   if formula.star
+0001d010: 7473 7769 7468 2822 3d22 293a 0a20 2020  tswith("="):.   
+0001d020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d030: 2020 2020 2020 2020 2066 6f72 6d75 6c61           formula
+0001d040: 203d 2066 6f72 6d75 6c61 2e6c 7374 7269   = formula.lstri
+0001d050: 7028 223d 2229 0a0a 2020 2020 2020 2020  p("=")..        
+0001d060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d070: 2320 436f 6e76 6572 7420 4578 6365 6c20  # Convert Excel 
+0001d080: 3230 3130 2022 4022 2072 6566 2074 6f20  2010 "@" ref to 
+0001d090: 3230 3037 2022 2354 6869 7320 526f 7722  2007 "#This Row"
+0001d0a0: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001d0b0: 2020 2020 2020 2020 2020 666f 726d 756c            formul
+0001d0c0: 6120 3d20 666f 726d 756c 612e 7265 706c  a = formula.repl
+0001d0d0: 6163 6528 2240 222c 2022 5b23 5468 6973  ace("@", "[#This
+0001d0e0: 2052 6f77 5d2c 2229 0a0a 2020 2020 2020   Row],")..      
 0001d0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d100: 2020 2320 5265 6d6f 7665 2074 6865 2066    # Remove the f
-0001d110: 6f72 6d75 6c61 2027 3d27 2073 6967 6e20  ormula '=' sign 
-0001d120: 6966 2069 7420 6578 6973 7473 2e0a 2020  if it exists..  
-0001d130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d140: 2020 2020 2020 6966 2066 6f72 6d75 6c61        if formula
-0001d150: 2e73 7461 7274 7377 6974 6828 273d 2729  .startswith('=')
-0001d160: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001d170: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0001d180: 726d 756c 6120 3d20 666f 726d 756c 612e  rmula = formula.
-0001d190: 6c73 7472 6970 2827 3d27 290a 0a20 2020  lstrip('=')..   
-0001d1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d1b0: 2020 2020 2023 2043 6f6e 7665 7274 2045       # Convert E
-0001d1c0: 7863 656c 2032 3031 3020 2240 2220 7265  xcel 2010 "@" re
-0001d1d0: 6620 746f 2032 3030 3720 2223 5468 6973  f to 2007 "#This
-0001d1e0: 2052 6f77 222e 0a20 2020 2020 2020 2020   Row"..         
-0001d1f0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001d200: 6f72 6d75 6c61 203d 2066 6f72 6d75 6c61  ormula = formula
-0001d210: 2e72 6570 6c61 6365 2827 4027 2c20 275b  .replace('@', '[
-0001d220: 2354 6869 7320 526f 775d 2c27 290a 0a20  #This Row],').. 
-0001d230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d240: 2020 2020 2020 2063 6f6c 5f64 6174 615b         col_data[
-0001d250: 2766 6f72 6d75 6c61 275d 203d 2066 6f72  'formula'] = for
-0001d260: 6d75 6c61 0a0a 2020 2020 2020 2020 2020  mula..          
-0001d270: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0001d280: 7220 726f 7720 696e 2072 616e 6765 2866  r row in range(f
-0001d290: 6972 7374 5f64 6174 615f 726f 772c 206c  irst_data_row, l
-0001d2a0: 6173 745f 6461 7461 5f72 6f77 202b 2031  ast_data_row + 1
-0001d2b0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0001d2c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001d2d0: 656c 662e 5f77 7269 7465 5f66 6f72 6d75  elf._write_formu
-0001d2e0: 6c61 2872 6f77 2c20 636f 6c5f 6e75 6d2c  la(row, col_num,
-0001d2f0: 2066 6f72 6d75 6c61 2c20 7866 6f72 6d61   formula, xforma
-0001d300: 7429 0a0a 2020 2020 2020 2020 2020 2020  t)..            
-0001d310: 2020 2020 2020 2020 2320 4861 6e64 6c65          # Handle
-0001d320: 2074 6865 2066 756e 6374 696f 6e20 666f   the function fo
-0001d330: 7220 7468 6520 746f 7461 6c20 726f 772e  r the total row.
-0001d340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d350: 2020 2020 2069 6620 7573 6572 5f64 6174       if user_dat
-0001d360: 612e 6765 7428 2774 6f74 616c 5f66 756e  a.get('total_fun
-0001d370: 6374 696f 6e27 293a 0a20 2020 2020 2020  ction'):.       
-0001d380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d390: 2066 756e 6374 696f 6e20 3d20 7573 6572   function = user
-0001d3a0: 5f64 6174 615b 2774 6f74 616c 5f66 756e  _data['total_fun
-0001d3b0: 6374 696f 6e27 5d0a 0a20 2020 2020 2020  ction']..       
+0001d100: 2020 636f 6c5f 6461 7461 5b22 666f 726d    col_data["form
+0001d110: 756c 6122 5d20 3d20 666f 726d 756c 610a  ula"] = formula.
+0001d120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d130: 2020 2020 2020 2020 2066 6f72 2072 6f77           for row
+0001d140: 2069 6e20 7261 6e67 6528 6669 7273 745f   in range(first_
+0001d150: 6461 7461 5f72 6f77 2c20 6c61 7374 5f64  data_row, last_d
+0001d160: 6174 615f 726f 7720 2b20 3129 3a0a 2020  ata_row + 1):.  
+0001d170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d180: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0001d190: 7772 6974 655f 666f 726d 756c 6128 726f  write_formula(ro
+0001d1a0: 772c 2063 6f6c 5f6e 756d 2c20 666f 726d  w, col_num, form
+0001d1b0: 756c 612c 2078 666f 726d 6174 290a 0a20  ula, xformat).. 
+0001d1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d1d0: 2020 2023 2048 616e 646c 6520 7468 6520     # Handle the 
+0001d1e0: 6675 6e63 7469 6f6e 2066 6f72 2074 6865  function for the
+0001d1f0: 2074 6f74 616c 2072 6f77 2e0a 2020 2020   total row..    
+0001d200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d210: 6966 2075 7365 725f 6461 7461 2e67 6574  if user_data.get
+0001d220: 2822 746f 7461 6c5f 6675 6e63 7469 6f6e  ("total_function
+0001d230: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+0001d240: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+0001d250: 7469 6f6e 203d 2075 7365 725f 6461 7461  tion = user_data
+0001d260: 5b22 746f 7461 6c5f 6675 6e63 7469 6f6e  ["total_function
+0001d270: 225d 0a0a 2020 2020 2020 2020 2020 2020  "]..            
+0001d280: 2020 2020 2020 2020 2020 2020 2320 4d61              # Ma
+0001d290: 7373 6167 6520 7468 6520 6675 6e63 7469  ssage the functi
+0001d2a0: 6f6e 206e 616d 652e 0a20 2020 2020 2020  on name..       
+0001d2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d2c0: 2066 756e 6374 696f 6e20 3d20 6675 6e63   function = func
+0001d2d0: 7469 6f6e 2e6c 6f77 6572 2829 0a20 2020  tion.lower().   
+0001d2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d2f0: 2020 2020 2066 756e 6374 696f 6e20 3d20       function = 
+0001d300: 6675 6e63 7469 6f6e 2e72 6570 6c61 6365  function.replace
+0001d310: 2822 5f22 2c20 2222 290a 2020 2020 2020  ("_", "").      
+0001d320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d330: 2020 6675 6e63 7469 6f6e 203d 2066 756e    function = fun
+0001d340: 6374 696f 6e2e 7265 706c 6163 6528 2220  ction.replace(" 
+0001d350: 222c 2022 2229 0a0a 2020 2020 2020 2020  ", "")..        
+0001d360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d370: 6966 2066 756e 6374 696f 6e20 3d3d 2022  if function == "
+0001d380: 636f 756e 746e 756d 7322 3a0a 2020 2020  countnums":.    
+0001d390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d3a0: 2020 2020 2020 2020 6675 6e63 7469 6f6e          function
+0001d3b0: 203d 2022 636f 756e 744e 756d 7322 0a20   = "countNums". 
 0001d3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d3d0: 2023 204d 6173 7361 6765 2074 6865 2066   # Massage the f
-0001d3e0: 756e 6374 696f 6e20 6e61 6d65 2e0a 2020  unction name..  
+0001d3d0: 2020 2020 2020 2069 6620 6675 6e63 7469         if functi
+0001d3e0: 6f6e 203d 3d20 2273 7464 6465 7622 3a0a  on == "stddev":.
 0001d3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d400: 2020 2020 2020 6675 6e63 7469 6f6e 203d        function =
-0001d410: 2066 756e 6374 696f 6e2e 6c6f 7765 7228   function.lower(
-0001d420: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001d430: 2020 2020 2020 2020 2020 6675 6e63 7469            functi
-0001d440: 6f6e 203d 2066 756e 6374 696f 6e2e 7265  on = function.re
-0001d450: 706c 6163 6528 275f 272c 2027 2729 0a20  place('_', ''). 
+0001d400: 2020 2020 2020 2020 2020 2020 6675 6e63              func
+0001d410: 7469 6f6e 203d 2022 7374 6444 6576 220a  tion = "stdDev".
+0001d420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d430: 2020 2020 2020 2020 2063 6f6c 5f64 6174           col_dat
+0001d440: 615b 2274 6f74 616c 5f66 756e 6374 696f  a["total_functio
+0001d450: 6e22 5d20 3d20 6675 6e63 7469 6f6e 0a0a  n"] = function..
 0001d460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d470: 2020 2020 2020 2066 756e 6374 696f 6e20         function 
-0001d480: 3d20 6675 6e63 7469 6f6e 2e72 6570 6c61  = function.repla
-0001d490: 6365 2827 2027 2c20 2727 290a 0a20 2020  ce(' ', '')..   
-0001d4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d4b0: 2020 2020 2069 6620 6675 6e63 7469 6f6e       if function
-0001d4c0: 203d 3d20 2763 6f75 6e74 6e75 6d73 273a   == 'countnums':
-0001d4d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d4e0: 2020 2020 2020 2020 2020 2020 2066 756e               fun
-0001d4f0: 6374 696f 6e20 3d20 2763 6f75 6e74 4e75  ction = 'countNu
-0001d500: 6d73 270a 2020 2020 2020 2020 2020 2020  ms'.            
-0001d510: 2020 2020 2020 2020 2020 2020 6966 2066              if f
-0001d520: 756e 6374 696f 6e20 3d3d 2027 7374 6464  unction == 'stdd
-0001d530: 6576 273a 0a20 2020 2020 2020 2020 2020  ev':.           
-0001d540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d550: 2066 756e 6374 696f 6e20 3d20 2773 7464   function = 'std
-0001d560: 4465 7627 0a0a 2020 2020 2020 2020 2020  Dev'..          
-0001d570: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0001d580: 6c5f 6461 7461 5b27 746f 7461 6c5f 6675  l_data['total_fu
-0001d590: 6e63 7469 6f6e 275d 203d 2066 756e 6374  nction'] = funct
-0001d5a0: 696f 6e0a 0a20 2020 2020 2020 2020 2020  ion..           
-0001d5b0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0001d5c0: 6d75 6c61 203d 205c 0a20 2020 2020 2020  mula = \.       
-0001d5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d5e0: 2020 2020 2073 656c 662e 5f74 6162 6c65       self._table
-0001d5f0: 5f66 756e 6374 696f 6e5f 746f 5f66 6f72  _function_to_for
-0001d600: 6d75 6c61 2866 756e 6374 696f 6e2c 0a20  mula(function,. 
-0001d610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d640: 2020 2020 2020 2020 2020 2063 6f6c 5f64             col_d
-0001d650: 6174 615b 276e 616d 6527 5d29 0a0a 2020  ata['name'])..  
-0001d660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d670: 2020 2020 2020 7661 6c75 6520 3d20 7573        value = us
-0001d680: 6572 5f64 6174 612e 6765 7428 2774 6f74  er_data.get('tot
-0001d690: 616c 5f76 616c 7565 272c 2030 290a 0a20  al_value', 0).. 
-0001d6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d6b0: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
-0001d6c0: 7465 5f66 6f72 6d75 6c61 286c 6173 745f  te_formula(last_
-0001d6d0: 726f 772c 2063 6f6c 5f6e 756d 2c20 666f  row, col_num, fo
-0001d6e0: 726d 756c 612c 0a20 2020 2020 2020 2020  rmula,.         
-0001d6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d710: 2020 2078 666f 726d 6174 2c20 7661 6c75     xformat, valu
-0001d720: 6529 0a0a 2020 2020 2020 2020 2020 2020  e)..            
-0001d730: 2020 2020 2020 2020 656c 6966 2075 7365          elif use
-0001d740: 725f 6461 7461 2e67 6574 2827 746f 7461  r_data.get('tota
-0001d750: 6c5f 7374 7269 6e67 2729 3a0a 2020 2020  l_string'):.    
-0001d760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d770: 2020 2020 2320 546f 7461 6c20 6c61 6265      # Total labe
-0001d780: 6c20 6f6e 6c79 2028 6e6f 7420 6120 6675  l only (not a fu
-0001d790: 6e63 7469 6f6e 292e 0a20 2020 2020 2020  nction)..       
-0001d7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d7b0: 2074 6f74 616c 5f73 7472 696e 6720 3d20   total_string = 
-0001d7c0: 7573 6572 5f64 6174 615b 2774 6f74 616c  user_data['total
-0001d7d0: 5f73 7472 696e 6727 5d0a 2020 2020 2020  _string'].      
-0001d7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d7f0: 2020 636f 6c5f 6461 7461 5b27 746f 7461    col_data['tota
-0001d800: 6c5f 7374 7269 6e67 275d 203d 2074 6f74  l_string'] = tot
-0001d810: 616c 5f73 7472 696e 670a 0a20 2020 2020  al_string..     
-0001d820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d830: 2020 2073 656c 662e 5f77 7269 7465 5f73     self._write_s
-0001d840: 7472 696e 6728 6c61 7374 5f72 6f77 2c20  tring(last_row, 
-0001d850: 636f 6c5f 6e75 6d2c 2074 6f74 616c 5f73  col_num, total_s
-0001d860: 7472 696e 672c 0a20 2020 2020 2020 2020  tring,.         
-0001d870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d890: 2020 7573 6572 5f64 6174 612e 6765 7428    user_data.get(
-0001d8a0: 2766 6f72 6d61 7427 2929 0a0a 2020 2020  'format'))..    
-0001d8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d8c0: 2320 4765 7420 7468 6520 6478 6620 666f  # Get the dxf fo
-0001d8d0: 726d 6174 2069 6e64 6578 2e0a 2020 2020  rmat index..    
-0001d8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d8f0: 6966 2078 666f 726d 6174 2069 7320 6e6f  if xformat is no
-0001d900: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0001d910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d920: 636f 6c5f 6461 7461 5b27 666f 726d 6174  col_data['format
-0001d930: 275d 203d 2078 666f 726d 6174 2e5f 6765  '] = xformat._ge
-0001d940: 745f 6478 665f 696e 6465 7828 290a 0a20  t_dxf_index().. 
-0001d950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d960: 2020 2023 2053 746f 7265 2074 6865 2063     # Store the c
-0001d970: 6f6c 756d 6e20 666f 726d 6174 2066 6f72  olumn format for
-0001d980: 2077 7269 7469 6e67 2074 6865 2063 656c   writing the cel
-0001d990: 6c20 6461 7461 2e0a 2020 2020 2020 2020  l data..        
-0001d9a0: 2020 2020 2020 2020 2020 2020 2320 4974              # It
-0001d9b0: 2064 6f65 736e 2774 206d 6174 7465 7220   doesn't matter 
-0001d9c0: 6966 2069 7420 6973 2075 6e64 6566 696e  if it is undefin
-0001d9d0: 6564 2e0a 2020 2020 2020 2020 2020 2020  ed..            
-0001d9e0: 2020 2020 2020 2020 636f 6c5f 666f 726d          col_form
-0001d9f0: 6174 735b 636f 6c5f 6964 202d 2031 5d20  ats[col_id - 1] 
-0001da00: 3d20 7866 6f72 6d61 740a 0a20 2020 2020  = xformat..     
-0001da10: 2020 2020 2020 2023 2053 746f 7265 2074         # Store t
-0001da20: 6865 2063 6f6c 756d 6e20 6461 7461 2e0a  he column data..
-0001da30: 2020 2020 2020 2020 2020 2020 7461 626c              tabl
-0001da40: 655b 2763 6f6c 756d 6e73 275d 2e61 7070  e['columns'].app
-0001da50: 656e 6428 636f 6c5f 6461 7461 290a 0a20  end(col_data).. 
-0001da60: 2020 2020 2020 2020 2020 2023 2057 7269             # Wri
-0001da70: 7465 2074 6865 2063 6f6c 756d 6e20 6865  te the column he
-0001da80: 6164 6572 7320 746f 2074 6865 2077 6f72  aders to the wor
-0001da90: 6b73 6865 6574 2e0a 2020 2020 2020 2020  ksheet..        
-0001daa0: 2020 2020 6966 206f 7074 696f 6e73 5b27      if options['
-0001dab0: 6865 6164 6572 5f72 6f77 275d 3a0a 2020  header_row']:.  
-0001dac0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001dad0: 6c66 2e5f 7772 6974 655f 7374 7269 6e67  lf._write_string
-0001dae0: 2866 6972 7374 5f72 6f77 2c20 636f 6c5f  (first_row, col_
-0001daf0: 6e75 6d2c 2063 6f6c 5f64 6174 615b 276e  num, col_data['n
-0001db00: 616d 6527 5d2c 0a20 2020 2020 2020 2020  ame'],.         
-0001db10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001db20: 2020 2020 2020 2020 2020 636f 6c5f 6461            col_da
-0001db30: 7461 5b27 6e61 6d65 5f66 6f72 6d61 7427  ta['name_format'
-0001db40: 5d29 0a0a 2020 2020 2020 2020 2020 2020  ])..            
-0001db50: 636f 6c5f 6964 202b 3d20 310a 0a20 2020  col_id += 1..   
-0001db60: 2020 2020 2023 2057 7269 7465 2074 6865       # Write the
-0001db70: 2063 656c 6c20 6461 7461 2069 6620 7375   cell data if su
-0001db80: 7070 6c69 6564 2e0a 2020 2020 2020 2020  pplied..        
-0001db90: 6966 2027 6461 7461 2720 696e 206f 7074  if 'data' in opt
-0001dba0: 696f 6e73 3a0a 2020 2020 2020 2020 2020  ions:.          
-0001dbb0: 2020 6461 7461 203d 206f 7074 696f 6e73    data = options
-0001dbc0: 5b27 6461 7461 275d 0a0a 2020 2020 2020  ['data']..      
-0001dbd0: 2020 2020 2020 6920 3d20 3020 2023 2046        i = 0  # F
-0001dbe0: 6f72 2069 6e64 6578 696e 6720 7468 6520  or indexing the 
-0001dbf0: 726f 7720 6461 7461 2e0a 2020 2020 2020  row data..      
-0001dc00: 2020 2020 2020 666f 7220 726f 7720 696e        for row in
-0001dc10: 2072 616e 6765 2866 6972 7374 5f64 6174   range(first_dat
-0001dc20: 615f 726f 772c 206c 6173 745f 6461 7461  a_row, last_data
-0001dc30: 5f72 6f77 202b 2031 293a 0a20 2020 2020  _row + 1):.     
-0001dc40: 2020 2020 2020 2020 2020 206a 203d 2030             j = 0
-0001dc50: 2020 2320 466f 7220 696e 6465 7869 6e67    # For indexing
-0001dc60: 2074 6865 2063 6f6c 2064 6174 612e 0a20   the col data.. 
-0001dc70: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0001dc80: 6f72 2063 6f6c 2069 6e20 7261 6e67 6528  or col in range(
-0001dc90: 6669 7273 745f 636f 6c2c 206c 6173 745f  first_col, last_
-0001dca0: 636f 6c20 2b20 3129 3a0a 2020 2020 2020  col + 1):.      
-0001dcb0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0001dcc0: 2069 203c 206c 656e 2864 6174 6129 2061   i < len(data) a
-0001dcd0: 6e64 206a 203c 206c 656e 2864 6174 615b  nd j < len(data[
-0001dce0: 695d 293a 0a20 2020 2020 2020 2020 2020  i]):.           
-0001dcf0: 2020 2020 2020 2020 2020 2020 2074 6f6b               tok
-0001dd00: 656e 203d 2064 6174 615b 695d 5b6a 5d0a  en = data[i][j].
-0001dd10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dd20: 2020 2020 2020 2020 6966 206a 2069 6e20          if j in 
-0001dd30: 636f 6c5f 666f 726d 6174 733a 0a20 2020  col_formats:.   
-0001dd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dd50: 2020 2020 2020 2020 2073 656c 662e 5f77           self._w
-0001dd60: 7269 7465 2872 6f77 2c20 636f 6c2c 2074  rite(row, col, t
-0001dd70: 6f6b 656e 2c20 636f 6c5f 666f 726d 6174  oken, col_format
-0001dd80: 735b 6a5d 290a 2020 2020 2020 2020 2020  s[j]).          
-0001dd90: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0001dda0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0001ddb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ddc0: 7365 6c66 2e5f 7772 6974 6528 726f 772c  self._write(row,
-0001ddd0: 2063 6f6c 2c20 746f 6b65 6e2c 204e 6f6e   col, token, Non
-0001dde0: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
-0001ddf0: 2020 2020 2020 206a 202b 3d20 310a 2020         j += 1.  
-0001de00: 2020 2020 2020 2020 2020 2020 2020 6920                i 
-0001de10: 2b3d 2031 0a0a 2020 2020 2020 2020 2320  += 1..        # 
-0001de20: 5374 6f72 6520 7468 6520 7461 626c 6520  Store the table 
-0001de30: 6461 7461 2e0a 2020 2020 2020 2020 7365  data..        se
-0001de40: 6c66 2e74 6162 6c65 732e 6170 7065 6e64  lf.tables.append
-0001de50: 2874 6162 6c65 290a 0a20 2020 2020 2020  (table)..       
-0001de60: 2023 2053 746f 7265 2074 6865 2066 696c   # Store the fil
-0001de70: 7465 7220 6365 6c6c 2070 6f73 6974 696f  ter cell positio
-0001de80: 6e73 2066 6f72 2075 7365 2069 6e20 7468  ns for use in th
-0001de90: 6520 6175 746f 6669 7420 6361 6c63 756c  e autofit calcul
-0001dea0: 6174 696f 6e2e 0a20 2020 2020 2020 2069  ation..        i
-0001deb0: 6620 6f70 7469 6f6e 735b 2761 7574 6f66  f options['autof
-0001dec0: 696c 7465 7227 5d3a 0a20 2020 2020 2020  ilter']:.       
-0001ded0: 2020 2020 2066 6f72 2063 6f6c 2069 6e20       for col in 
-0001dee0: 7261 6e67 6528 6669 7273 745f 636f 6c2c  range(first_col,
-0001def0: 206c 6173 745f 636f 6c20 2b20 3129 3a0a   last_col + 1):.
-0001df00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001df10: 7365 6c66 2e66 696c 7465 725f 6365 6c6c  self.filter_cell
-0001df20: 735b 2866 6972 7374 5f72 6f77 2c20 636f  s[(first_row, co
-0001df30: 6c29 5d20 3d20 5472 7565 0a0a 2020 2020  l)] = True..    
-0001df40: 2020 2020 7265 7475 726e 2030 0a0a 2020      return 0..  
-0001df50: 2020 4063 6f6e 7665 7274 5f63 656c 6c5f    @convert_cell_
-0001df60: 6172 6773 0a20 2020 2064 6566 2061 6464  args.    def add
-0001df70: 5f73 7061 726b 6c69 6e65 2873 656c 662c  _sparkline(self,
-0001df80: 2072 6f77 2c20 636f 6c2c 206f 7074 696f   row, col, optio
-0001df90: 6e73 3d4e 6f6e 6529 3a0a 2020 2020 2020  ns=None):.      
-0001dfa0: 2020 2222 220a 2020 2020 2020 2020 4164    """.        Ad
-0001dfb0: 6420 7370 6172 6b6c 696e 6573 2074 6f20  d sparklines to 
-0001dfc0: 7468 6520 776f 726b 7368 6565 742e 0a0a  the worksheet...
-0001dfd0: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
-0001dfe0: 2020 2020 2020 2020 2020 726f 773a 2020            row:  
-0001dff0: 2020 2054 6865 2063 656c 6c20 726f 7720     The cell row 
-0001e000: 287a 6572 6f20 696e 6465 7865 6429 2e0a  (zero indexed)..
-0001e010: 2020 2020 2020 2020 2020 2020 636f 6c3a              col:
-0001e020: 2020 2020 2054 6865 2063 656c 6c20 636f       The cell co
-0001e030: 6c75 6d6e 2028 7a65 726f 2069 6e64 6578  lumn (zero index
-0001e040: 6564 292e 0a20 2020 2020 2020 2020 2020  ed)..           
-0001e050: 206f 7074 696f 6e73 3a20 5370 6172 6b6c   options: Sparkl
-0001e060: 696e 6520 666f 726d 6174 7469 6e67 206f  ine formatting o
-0001e070: 7074 696f 6e73 2e0a 0a20 2020 2020 2020  ptions...       
-0001e080: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
-0001e090: 2020 2020 2020 303a 2020 5375 6363 6573        0:  Succes
-0001e0a0: 732e 0a20 2020 2020 2020 2020 2020 202d  s..            -
-0001e0b0: 313a 2052 6f77 206f 7220 636f 6c75 6d6e  1: Row or column
-0001e0c0: 2069 7320 6f75 7420 6f66 2077 6f72 6b73   is out of works
-0001e0d0: 6865 6574 2062 6f75 6e64 732e 0a20 2020  heet bounds..   
-0001e0e0: 2020 2020 2020 2020 202d 323a 2049 6e63           -2: Inc
-0001e0f0: 6f72 7265 6374 2070 6172 616d 6574 6572  orrect parameter
-0001e100: 206f 7220 6f70 7469 6f6e 2e0a 0a20 2020   or option...   
-0001e110: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-0001e120: 2020 2320 4368 6563 6b20 7468 6174 2072    # Check that r
-0001e130: 6f77 2061 6e64 2063 6f6c 2061 7265 2076  ow and col are v
-0001e140: 616c 6964 2077 6974 686f 7574 2073 746f  alid without sto
-0001e150: 7269 6e67 2074 6865 2076 616c 7565 732e  ring the values.
-0001e160: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-0001e170: 2e5f 6368 6563 6b5f 6469 6d65 6e73 696f  ._check_dimensio
-0001e180: 6e73 2872 6f77 2c20 636f 6c2c 2054 7275  ns(row, col, Tru
-0001e190: 652c 2054 7275 6529 3a0a 2020 2020 2020  e, True):.      
-0001e1a0: 2020 2020 2020 7265 7475 726e 202d 310a        return -1.
-0001e1b0: 0a20 2020 2020 2020 2073 7061 726b 6c69  .        sparkli
-0001e1c0: 6e65 203d 207b 276c 6f63 6174 696f 6e73  ne = {'locations
-0001e1d0: 273a 205b 786c 5f72 6f77 636f 6c5f 746f  ': [xl_rowcol_to
-0001e1e0: 5f63 656c 6c28 726f 772c 2063 6f6c 295d  _cell(row, col)]
-0001e1f0: 7d0a 0a20 2020 2020 2020 2069 6620 6f70  }..        if op
-0001e200: 7469 6f6e 7320 6973 204e 6f6e 653a 0a20  tions is None:. 
-0001e210: 2020 2020 2020 2020 2020 206f 7074 696f             optio
-0001e220: 6e73 203d 207b 7d0a 0a20 2020 2020 2020  ns = {}..       
-0001e230: 2023 2056 616c 6964 2069 6e70 7574 2070   # Valid input p
-0001e240: 6172 616d 6574 6572 732e 0a20 2020 2020  arameters..     
-0001e250: 2020 2076 616c 6964 5f70 6172 616d 6574     valid_paramet
-0001e260: 6572 7320 3d20 7b0a 2020 2020 2020 2020  ers = {.        
-0001e270: 2020 2020 276c 6f63 6174 696f 6e27 2c0a      'location',.
-0001e280: 2020 2020 2020 2020 2020 2020 2772 616e              'ran
-0001e290: 6765 272c 0a20 2020 2020 2020 2020 2020  ge',.           
-0001e2a0: 2027 7479 7065 272c 0a20 2020 2020 2020   'type',.       
-0001e2b0: 2020 2020 2027 6869 6768 5f70 6f69 6e74       'high_point
-0001e2c0: 272c 0a20 2020 2020 2020 2020 2020 2027  ',.            '
-0001e2d0: 6c6f 775f 706f 696e 7427 2c0a 2020 2020  low_point',.    
-0001e2e0: 2020 2020 2020 2020 276e 6567 6174 6976          'negativ
-0001e2f0: 655f 706f 696e 7473 272c 0a20 2020 2020  e_points',.     
-0001e300: 2020 2020 2020 2027 6669 7273 745f 706f         'first_po
-0001e310: 696e 7427 2c0a 2020 2020 2020 2020 2020  int',.          
-0001e320: 2020 276c 6173 745f 706f 696e 7427 2c0a    'last_point',.
-0001e330: 2020 2020 2020 2020 2020 2020 276d 6172              'mar
-0001e340: 6b65 7273 272c 0a20 2020 2020 2020 2020  kers',.         
-0001e350: 2020 2027 7374 796c 6527 2c0a 2020 2020     'style',.    
-0001e360: 2020 2020 2020 2020 2773 6572 6965 735f          'series_
-0001e370: 636f 6c6f 7227 2c0a 2020 2020 2020 2020  color',.        
-0001e380: 2020 2020 276e 6567 6174 6976 655f 636f      'negative_co
-0001e390: 6c6f 7227 2c0a 2020 2020 2020 2020 2020  lor',.          
-0001e3a0: 2020 276d 6172 6b65 7273 5f63 6f6c 6f72    'markers_color
-0001e3b0: 272c 0a20 2020 2020 2020 2020 2020 2027  ',.            '
-0001e3c0: 6669 7273 745f 636f 6c6f 7227 2c0a 2020  first_color',.  
-0001e3d0: 2020 2020 2020 2020 2020 276c 6173 745f            'last_
-0001e3e0: 636f 6c6f 7227 2c0a 2020 2020 2020 2020  color',.        
-0001e3f0: 2020 2020 2768 6967 685f 636f 6c6f 7227      'high_color'
-0001e400: 2c0a 2020 2020 2020 2020 2020 2020 276c  ,.            'l
-0001e410: 6f77 5f63 6f6c 6f72 272c 0a20 2020 2020  ow_color',.     
-0001e420: 2020 2020 2020 2027 6d61 7827 2c0a 2020         'max',.  
-0001e430: 2020 2020 2020 2020 2020 276d 696e 272c            'min',
-0001e440: 0a20 2020 2020 2020 2020 2020 2027 6178  .            'ax
-0001e450: 6973 272c 0a20 2020 2020 2020 2020 2020  is',.           
-0001e460: 2027 7265 7665 7273 6527 2c0a 2020 2020   'reverse',.    
-0001e470: 2020 2020 2020 2020 2765 6d70 7479 5f63          'empty_c
-0001e480: 656c 6c73 272c 0a20 2020 2020 2020 2020  ells',.         
-0001e490: 2020 2027 7368 6f77 5f68 6964 6465 6e27     'show_hidden'
-0001e4a0: 2c0a 2020 2020 2020 2020 2020 2020 2770  ,.            'p
-0001e4b0: 6c6f 745f 6869 6464 656e 272c 0a20 2020  lot_hidden',.   
-0001e4c0: 2020 2020 2020 2020 2027 6461 7465 5f61           'date_a
-0001e4d0: 7869 7327 2c0a 2020 2020 2020 2020 2020  xis',.          
-0001e4e0: 2020 2777 6569 6768 7427 2c0a 2020 2020    'weight',.    
-0001e4f0: 2020 2020 7d0a 0a20 2020 2020 2020 2023      }..        #
-0001e500: 2043 6865 636b 2066 6f72 2076 616c 6964   Check for valid
-0001e510: 2069 6e70 7574 2070 6172 616d 6574 6572   input parameter
-0001e520: 732e 0a20 2020 2020 2020 2066 6f72 2070  s..        for p
-0001e530: 6172 616d 5f6b 6579 2069 6e20 6f70 7469  aram_key in opti
-0001e540: 6f6e 732e 6b65 7973 2829 3a0a 2020 2020  ons.keys():.    
-0001e550: 2020 2020 2020 2020 6966 2070 6172 616d          if param
-0001e560: 5f6b 6579 206e 6f74 2069 6e20 7661 6c69  _key not in vali
-0001e570: 645f 7061 7261 6d65 7465 7273 3a0a 2020  d_parameters:.  
-0001e580: 2020 2020 2020 2020 2020 2020 2020 7761                wa
-0001e590: 726e 2822 556e 6b6e 6f77 6e20 7061 7261  rn("Unknown para
-0001e5a0: 6d65 7465 7220 2725 7327 2069 6e20 6164  meter '%s' in ad
-0001e5b0: 645f 7370 6172 6b6c 696e 6528 2922 2025  d_sparkline()" %
-0001e5c0: 2070 6172 616d 5f6b 6579 290a 2020 2020   param_key).    
-0001e5d0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0001e5e0: 726e 202d 310a 0a20 2020 2020 2020 2023  rn -1..        #
-0001e5f0: 2027 7261 6e67 6527 2069 7320 6120 7265   'range' is a re
-0001e600: 7175 6972 6564 2070 6172 616d 6574 6572  quired parameter
-0001e610: 2e0a 2020 2020 2020 2020 6966 2027 7261  ..        if 'ra
-0001e620: 6e67 6527 206e 6f74 2069 6e20 6f70 7469  nge' not in opti
-0001e630: 6f6e 733a 0a20 2020 2020 2020 2020 2020  ons:.           
-0001e640: 2077 6172 6e28 2250 6172 616d 6574 6572   warn("Parameter
-0001e650: 2027 7261 6e67 6527 2069 7320 7265 7175   'range' is requ
-0001e660: 6972 6564 2069 6e20 6164 645f 7370 6172  ired in add_spar
-0001e670: 6b6c 696e 6528 2922 290a 2020 2020 2020  kline()").      
-0001e680: 2020 2020 2020 7265 7475 726e 202d 320a        return -2.
-0001e690: 0a20 2020 2020 2020 2023 2048 616e 646c  .        # Handl
-0001e6a0: 6520 7468 6520 7370 6172 6b6c 696e 6520  e the sparkline 
-0001e6b0: 7479 7065 2e0a 2020 2020 2020 2020 7370  type..        sp
-0001e6c0: 6172 6b5f 7479 7065 203d 206f 7074 696f  ark_type = optio
-0001e6d0: 6e73 2e67 6574 2827 7479 7065 272c 2027  ns.get('type', '
-0001e6e0: 6c69 6e65 2729 0a0a 2020 2020 2020 2020  line')..        
-0001e6f0: 6966 2073 7061 726b 5f74 7970 6520 6e6f  if spark_type no
-0001e700: 7420 696e 2028 276c 696e 6527 2c20 2763  t in ('line', 'c
-0001e710: 6f6c 756d 6e27 2c20 2777 696e 5f6c 6f73  olumn', 'win_los
-0001e720: 7327 293a 0a20 2020 2020 2020 2020 2020  s'):.           
-0001e730: 2077 6172 6e28 2250 6172 616d 6574 6572   warn("Parameter
-0001e740: 2027 7479 7065 2720 6d75 7374 2062 6520   'type' must be 
-0001e750: 276c 696e 6527 2c20 2763 6f6c 756d 6e27  'line', 'column'
-0001e760: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-0001e770: 2020 2020 226f 7220 2777 696e 5f6c 6f73      "or 'win_los
-0001e780: 7327 2069 6e20 6164 645f 7370 6172 6b6c  s' in add_sparkl
-0001e790: 696e 6528 2922 290a 2020 2020 2020 2020  ine()").        
-0001e7a0: 2020 2020 7265 7475 726e 202d 320a 0a20      return -2.. 
-0001e7b0: 2020 2020 2020 2069 6620 7370 6172 6b5f         if spark_
-0001e7c0: 7479 7065 203d 3d20 2777 696e 5f6c 6f73  type == 'win_los
-0001e7d0: 7327 3a0a 2020 2020 2020 2020 2020 2020  s':.            
-0001e7e0: 7370 6172 6b5f 7479 7065 203d 2027 7374  spark_type = 'st
-0001e7f0: 6163 6b65 6427 0a20 2020 2020 2020 2073  acked'.        s
-0001e800: 7061 726b 6c69 6e65 5b27 7479 7065 275d  parkline['type']
-0001e810: 203d 2073 7061 726b 5f74 7970 650a 0a20   = spark_type.. 
-0001e820: 2020 2020 2020 2023 2057 6520 6861 6e64         # We hand
-0001e830: 6c65 2073 696e 676c 6520 6c6f 6361 7469  le single locati
-0001e840: 6f6e 2f72 616e 6765 2076 616c 7565 7320  on/range values 
-0001e850: 6f72 206c 6973 7420 6f66 2076 616c 7565  or list of value
-0001e860: 732e 0a20 2020 2020 2020 2069 6620 276c  s..        if 'l
-0001e870: 6f63 6174 696f 6e27 2069 6e20 6f70 7469  ocation' in opti
-0001e880: 6f6e 733a 0a20 2020 2020 2020 2020 2020  ons:.           
-0001e890: 2069 6620 7479 7065 286f 7074 696f 6e73   if type(options
-0001e8a0: 5b27 6c6f 6361 7469 6f6e 275d 2920 6973  ['location']) is
-0001e8b0: 206c 6973 743a 0a20 2020 2020 2020 2020   list:.         
-0001e8c0: 2020 2020 2020 2073 7061 726b 6c69 6e65         sparkline
-0001e8d0: 5b27 6c6f 6361 7469 6f6e 7327 5d20 3d20  ['locations'] = 
-0001e8e0: 6f70 7469 6f6e 735b 276c 6f63 6174 696f  options['locatio
-0001e8f0: 6e27 5d0a 2020 2020 2020 2020 2020 2020  n'].            
-0001e900: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0001e910: 2020 2020 2020 7370 6172 6b6c 696e 655b        sparkline[
-0001e920: 276c 6f63 6174 696f 6e73 275d 203d 205b  'locations'] = [
-0001e930: 6f70 7469 6f6e 735b 276c 6f63 6174 696f  options['locatio
-0001e940: 6e27 5d5d 0a0a 2020 2020 2020 2020 6966  n']]..        if
-0001e950: 2074 7970 6528 6f70 7469 6f6e 735b 2772   type(options['r
-0001e960: 616e 6765 275d 2920 6973 206c 6973 743a  ange']) is list:
-0001e970: 0a20 2020 2020 2020 2020 2020 2073 7061  .            spa
-0001e980: 726b 6c69 6e65 5b27 7261 6e67 6573 275d  rkline['ranges']
-0001e990: 203d 206f 7074 696f 6e73 5b27 7261 6e67   = options['rang
-0001e9a0: 6527 5d0a 2020 2020 2020 2020 656c 7365  e'].        else
-0001e9b0: 3a0a 2020 2020 2020 2020 2020 2020 7370  :.            sp
-0001e9c0: 6172 6b6c 696e 655b 2772 616e 6765 7327  arkline['ranges'
-0001e9d0: 5d20 3d20 5b6f 7074 696f 6e73 5b27 7261  ] = [options['ra
-0001e9e0: 6e67 6527 5d5d 0a0a 2020 2020 2020 2020  nge']]..        
-0001e9f0: 7261 6e67 655f 636f 756e 7420 3d20 6c65  range_count = le
-0001ea00: 6e28 7370 6172 6b6c 696e 655b 2772 616e  n(sparkline['ran
-0001ea10: 6765 7327 5d29 0a20 2020 2020 2020 206c  ges']).        l
-0001ea20: 6f63 6174 696f 6e5f 636f 756e 7420 3d20  ocation_count = 
-0001ea30: 6c65 6e28 7370 6172 6b6c 696e 655b 276c  len(sparkline['l
-0001ea40: 6f63 6174 696f 6e73 275d 290a 0a20 2020  ocations'])..   
-0001ea50: 2020 2020 2023 2054 6865 2072 616e 6765       # The range
-0001ea60: 7320 616e 6420 6c6f 6361 7469 6f6e 7320  s and locations 
-0001ea70: 6d75 7374 206d 6174 6368 2e0a 2020 2020  must match..    
-0001ea80: 2020 2020 6966 2072 616e 6765 5f63 6f75      if range_cou
-0001ea90: 6e74 2021 3d20 6c6f 6361 7469 6f6e 5f63  nt != location_c
-0001eaa0: 6f75 6e74 3a0a 2020 2020 2020 2020 2020  ount:.          
-0001eab0: 2020 7761 726e 2822 4d75 7374 2068 6176    warn("Must hav
-0001eac0: 6520 7468 6520 7361 6d65 206e 756d 6265  e the same numbe
-0001ead0: 7220 6f66 206c 6f63 6174 696f 6e20 616e  r of location an
-0001eae0: 6420 7261 6e67 6520 220a 2020 2020 2020  d range ".      
-0001eaf0: 2020 2020 2020 2020 2020 2022 7061 7261             "para
-0001eb00: 6d65 7465 7273 2069 6e20 6164 645f 7370  meters in add_sp
-0001eb10: 6172 6b6c 696e 6528 2922 290a 2020 2020  arkline()").    
-0001eb20: 2020 2020 2020 2020 7265 7475 726e 202d          return -
-0001eb30: 320a 0a20 2020 2020 2020 2023 2053 746f  2..        # Sto
-0001eb40: 7265 2074 6865 2063 6f75 6e74 2e0a 2020  re the count..  
-0001eb50: 2020 2020 2020 7370 6172 6b6c 696e 655b        sparkline[
-0001eb60: 2763 6f75 6e74 275d 203d 206c 656e 2873  'count'] = len(s
-0001eb70: 7061 726b 6c69 6e65 5b27 6c6f 6361 7469  parkline['locati
-0001eb80: 6f6e 7327 5d29 0a0a 2020 2020 2020 2020  ons'])..        
-0001eb90: 2320 4765 7420 7468 6520 776f 726b 7368  # Get the worksh
-0001eba0: 6565 7420 6e61 6d65 2066 6f72 2074 6865  eet name for the
-0001ebb0: 2072 616e 6765 2063 6f6e 7665 7273 696f   range conversio
-0001ebc0: 6e20 6265 6c6f 772e 0a20 2020 2020 2020  n below..       
-0001ebd0: 2073 6865 6574 6e61 6d65 203d 2071 756f   sheetname = quo
-0001ebe0: 7465 5f73 6865 6574 6e61 6d65 2873 656c  te_sheetname(sel
-0001ebf0: 662e 6e61 6d65 290a 0a20 2020 2020 2020  f.name)..       
-0001ec00: 2023 2043 6c65 616e 7570 2074 6865 2069   # Cleanup the i
-0001ec10: 6e70 7574 2072 616e 6765 732e 0a20 2020  nput ranges..   
-0001ec20: 2020 2020 206e 6577 5f72 616e 6765 7320       new_ranges 
-0001ec30: 3d20 5b5d 0a20 2020 2020 2020 2066 6f72  = [].        for
-0001ec40: 2073 7061 726b 5f72 616e 6765 2069 6e20   spark_range in 
-0001ec50: 7370 6172 6b6c 696e 655b 2772 616e 6765  sparkline['range
-0001ec60: 7327 5d3a 0a0a 2020 2020 2020 2020 2020  s']:..          
-0001ec70: 2020 2320 5265 6d6f 7665 2074 6865 2061    # Remove the a
-0001ec80: 6273 6f6c 7574 6520 7265 6665 7265 6e63  bsolute referenc
-0001ec90: 6520 2420 7379 6d62 6f6c 732e 0a20 2020  e $ symbols..   
-0001eca0: 2020 2020 2020 2020 2073 7061 726b 5f72           spark_r
-0001ecb0: 616e 6765 203d 2073 7061 726b 5f72 616e  ange = spark_ran
-0001ecc0: 6765 2e72 6570 6c61 6365 2827 2427 2c20  ge.replace('$', 
-0001ecd0: 2727 290a 0a20 2020 2020 2020 2020 2020  '')..           
-0001ece0: 2023 2052 656d 6f76 6520 7468 6520 3d20   # Remove the = 
-0001ecf0: 6672 6f6d 2066 6f72 6d75 6c61 2e0a 2020  from formula..  
-0001ed00: 2020 2020 2020 2020 2020 7370 6172 6b5f            spark_
-0001ed10: 7261 6e67 6520 3d20 7370 6172 6b5f 7261  range = spark_ra
-0001ed20: 6e67 652e 6c73 7472 6970 2827 3d27 290a  nge.lstrip('=').
-0001ed30: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
-0001ed40: 6f6e 7665 7274 2061 2073 696d 706c 6520  onvert a simple 
-0001ed50: 7261 6e67 6520 696e 746f 2061 2066 756c  range into a ful
-0001ed60: 6c20 5368 6565 7431 2141 313a 4431 2072  l Sheet1!A1:D1 r
-0001ed70: 616e 6765 2e0a 2020 2020 2020 2020 2020  ange..          
-0001ed80: 2020 6966 2027 2127 206e 6f74 2069 6e20    if '!' not in 
-0001ed90: 7370 6172 6b5f 7261 6e67 653a 0a20 2020  spark_range:.   
-0001eda0: 2020 2020 2020 2020 2020 2020 2073 7061               spa
-0001edb0: 726b 5f72 616e 6765 203d 2073 6865 6574  rk_range = sheet
-0001edc0: 6e61 6d65 202b 2022 2122 202b 2073 7061  name + "!" + spa
-0001edd0: 726b 5f72 616e 6765 0a0a 2020 2020 2020  rk_range..      
-0001ede0: 2020 2020 2020 6e65 775f 7261 6e67 6573        new_ranges
-0001edf0: 2e61 7070 656e 6428 7370 6172 6b5f 7261  .append(spark_ra
-0001ee00: 6e67 6529 0a0a 2020 2020 2020 2020 7370  nge)..        sp
-0001ee10: 6172 6b6c 696e 655b 2772 616e 6765 7327  arkline['ranges'
-0001ee20: 5d20 3d20 6e65 775f 7261 6e67 6573 0a0a  ] = new_ranges..
-0001ee30: 2020 2020 2020 2020 2320 436c 6561 6e75          # Cleanu
-0001ee40: 7020 7468 6520 696e 7075 7420 6c6f 6361  p the input loca
-0001ee50: 7469 6f6e 732e 0a20 2020 2020 2020 206e  tions..        n
-0001ee60: 6577 5f6c 6f63 6174 696f 6e73 203d 205b  ew_locations = [
-0001ee70: 5d0a 2020 2020 2020 2020 666f 7220 6c6f  ].        for lo
-0001ee80: 6361 7469 6f6e 2069 6e20 7370 6172 6b6c  cation in sparkl
-0001ee90: 696e 655b 276c 6f63 6174 696f 6e73 275d  ine['locations']
-0001eea0: 3a0a 2020 2020 2020 2020 2020 2020 6c6f  :.            lo
-0001eeb0: 6361 7469 6f6e 203d 206c 6f63 6174 696f  cation = locatio
-0001eec0: 6e2e 7265 706c 6163 6528 2724 272c 2027  n.replace('$', '
-0001eed0: 2729 0a20 2020 2020 2020 2020 2020 206e  ').            n
-0001eee0: 6577 5f6c 6f63 6174 696f 6e73 2e61 7070  ew_locations.app
-0001eef0: 656e 6428 6c6f 6361 7469 6f6e 290a 0a20  end(location).. 
-0001ef00: 2020 2020 2020 2073 7061 726b 6c69 6e65         sparkline
-0001ef10: 5b27 6c6f 6361 7469 6f6e 7327 5d20 3d20  ['locations'] = 
-0001ef20: 6e65 775f 6c6f 6361 7469 6f6e 730a 0a20  new_locations.. 
-0001ef30: 2020 2020 2020 2023 204d 6170 206f 7074         # Map opt
-0001ef40: 696f 6e73 2e0a 2020 2020 2020 2020 7370  ions..        sp
-0001ef50: 6172 6b6c 696e 655b 2768 6967 6827 5d20  arkline['high'] 
-0001ef60: 3d20 6f70 7469 6f6e 732e 6765 7428 2768  = options.get('h
-0001ef70: 6967 685f 706f 696e 7427 290a 2020 2020  igh_point').    
-0001ef80: 2020 2020 7370 6172 6b6c 696e 655b 276c      sparkline['l
-0001ef90: 6f77 275d 203d 206f 7074 696f 6e73 2e67  ow'] = options.g
-0001efa0: 6574 2827 6c6f 775f 706f 696e 7427 290a  et('low_point').
-0001efb0: 2020 2020 2020 2020 7370 6172 6b6c 696e          sparklin
-0001efc0: 655b 276e 6567 6174 6976 6527 5d20 3d20  e['negative'] = 
-0001efd0: 6f70 7469 6f6e 732e 6765 7428 276e 6567  options.get('neg
-0001efe0: 6174 6976 655f 706f 696e 7473 2729 0a20  ative_points'). 
-0001eff0: 2020 2020 2020 2073 7061 726b 6c69 6e65         sparkline
-0001f000: 5b27 6669 7273 7427 5d20 3d20 6f70 7469  ['first'] = opti
-0001f010: 6f6e 732e 6765 7428 2766 6972 7374 5f70  ons.get('first_p
-0001f020: 6f69 6e74 2729 0a20 2020 2020 2020 2073  oint').        s
-0001f030: 7061 726b 6c69 6e65 5b27 6c61 7374 275d  parkline['last']
-0001f040: 203d 206f 7074 696f 6e73 2e67 6574 2827   = options.get('
-0001f050: 6c61 7374 5f70 6f69 6e74 2729 0a20 2020  last_point').   
-0001f060: 2020 2020 2073 7061 726b 6c69 6e65 5b27       sparkline['
-0001f070: 6d61 726b 6572 7327 5d20 3d20 6f70 7469  markers'] = opti
-0001f080: 6f6e 732e 6765 7428 276d 6172 6b65 7273  ons.get('markers
-0001f090: 2729 0a20 2020 2020 2020 2073 7061 726b  ').        spark
-0001f0a0: 6c69 6e65 5b27 6d69 6e27 5d20 3d20 6f70  line['min'] = op
-0001f0b0: 7469 6f6e 732e 6765 7428 276d 696e 2729  tions.get('min')
-0001f0c0: 0a20 2020 2020 2020 2073 7061 726b 6c69  .        sparkli
-0001f0d0: 6e65 5b27 6d61 7827 5d20 3d20 6f70 7469  ne['max'] = opti
-0001f0e0: 6f6e 732e 6765 7428 276d 6178 2729 0a20  ons.get('max'). 
-0001f0f0: 2020 2020 2020 2073 7061 726b 6c69 6e65         sparkline
-0001f100: 5b27 6178 6973 275d 203d 206f 7074 696f  ['axis'] = optio
-0001f110: 6e73 2e67 6574 2827 6178 6973 2729 0a20  ns.get('axis'). 
-0001f120: 2020 2020 2020 2073 7061 726b 6c69 6e65         sparkline
-0001f130: 5b27 7265 7665 7273 6527 5d20 3d20 6f70  ['reverse'] = op
-0001f140: 7469 6f6e 732e 6765 7428 2772 6576 6572  tions.get('rever
-0001f150: 7365 2729 0a20 2020 2020 2020 2073 7061  se').        spa
-0001f160: 726b 6c69 6e65 5b27 6869 6464 656e 275d  rkline['hidden']
-0001f170: 203d 206f 7074 696f 6e73 2e67 6574 2827   = options.get('
-0001f180: 7368 6f77 5f68 6964 6465 6e27 290a 2020  show_hidden').  
-0001f190: 2020 2020 2020 7370 6172 6b6c 696e 655b        sparkline[
-0001f1a0: 2777 6569 6768 7427 5d20 3d20 6f70 7469  'weight'] = opti
-0001f1b0: 6f6e 732e 6765 7428 2777 6569 6768 7427  ons.get('weight'
-0001f1c0: 290a 0a20 2020 2020 2020 2023 204d 6170  )..        # Map
-0001f1d0: 2065 6d70 7479 2063 656c 6c73 206f 7074   empty cells opt
-0001f1e0: 696f 6e73 2e0a 2020 2020 2020 2020 656d  ions..        em
-0001f1f0: 7074 7920 3d20 6f70 7469 6f6e 732e 6765  pty = options.ge
-0001f200: 7428 2765 6d70 7479 5f63 656c 6c73 272c  t('empty_cells',
-0001f210: 2027 2729 0a0a 2020 2020 2020 2020 6966   '')..        if
-0001f220: 2065 6d70 7479 203d 3d20 277a 6572 6f27   empty == 'zero'
-0001f230: 3a0a 2020 2020 2020 2020 2020 2020 7370  :.            sp
-0001f240: 6172 6b6c 696e 655b 2765 6d70 7479 275d  arkline['empty']
-0001f250: 203d 2030 0a20 2020 2020 2020 2065 6c69   = 0.        eli
-0001f260: 6620 656d 7074 7920 3d3d 2027 636f 6e6e  f empty == 'conn
-0001f270: 6563 7427 3a0a 2020 2020 2020 2020 2020  ect':.          
-0001f280: 2020 7370 6172 6b6c 696e 655b 2765 6d70    sparkline['emp
-0001f290: 7479 275d 203d 2027 7370 616e 270a 2020  ty'] = 'span'.  
-0001f2a0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0001f2b0: 2020 2020 2020 2020 7370 6172 6b6c 696e          sparklin
-0001f2c0: 655b 2765 6d70 7479 275d 203d 2027 6761  e['empty'] = 'ga
-0001f2d0: 7027 0a0a 2020 2020 2020 2020 2320 4d61  p'..        # Ma
-0001f2e0: 7020 7468 6520 6461 7465 2061 7869 7320  p the date axis 
-0001f2f0: 7261 6e67 652e 0a20 2020 2020 2020 2064  range..        d
-0001f300: 6174 655f 7261 6e67 6520 3d20 6f70 7469  ate_range = opti
-0001f310: 6f6e 732e 6765 7428 2764 6174 655f 6178  ons.get('date_ax
-0001f320: 6973 2729 0a0a 2020 2020 2020 2020 6966  is')..        if
-0001f330: 2064 6174 655f 7261 6e67 6520 616e 6420   date_range and 
-0001f340: 2721 2720 6e6f 7420 696e 2064 6174 655f  '!' not in date_
-0001f350: 7261 6e67 653a 0a20 2020 2020 2020 2020  range:.         
-0001f360: 2020 2064 6174 655f 7261 6e67 6520 3d20     date_range = 
-0001f370: 7368 6565 746e 616d 6520 2b20 2221 2220  sheetname + "!" 
-0001f380: 2b20 6461 7465 5f72 616e 6765 0a0a 2020  + date_range..  
-0001f390: 2020 2020 2020 7370 6172 6b6c 696e 655b        sparkline[
-0001f3a0: 2764 6174 655f 6178 6973 275d 203d 2064  'date_axis'] = d
-0001f3b0: 6174 655f 7261 6e67 650a 0a20 2020 2020  ate_range..     
-0001f3c0: 2020 2023 2053 6574 2074 6865 2073 7061     # Set the spa
-0001f3d0: 726b 6c69 6e65 2073 7479 6c65 732e 0a20  rkline styles.. 
-0001f3e0: 2020 2020 2020 2073 7479 6c65 5f69 6420         style_id 
-0001f3f0: 3d20 6f70 7469 6f6e 732e 6765 7428 2773  = options.get('s
-0001f400: 7479 6c65 272c 2030 290a 2020 2020 2020  tyle', 0).      
-0001f410: 2020 7374 796c 6520 3d20 6765 745f 7370    style = get_sp
-0001f420: 6172 6b6c 696e 655f 7374 796c 6528 7374  arkline_style(st
-0001f430: 796c 655f 6964 290a 0a20 2020 2020 2020  yle_id)..       
-0001f440: 2073 7061 726b 6c69 6e65 5b27 7365 7269   sparkline['seri
-0001f450: 6573 5f63 6f6c 6f72 275d 203d 2073 7479  es_color'] = sty
-0001f460: 6c65 5b27 7365 7269 6573 275d 0a20 2020  le['series'].   
-0001f470: 2020 2020 2073 7061 726b 6c69 6e65 5b27       sparkline['
-0001f480: 6e65 6761 7469 7665 5f63 6f6c 6f72 275d  negative_color']
-0001f490: 203d 2073 7479 6c65 5b27 6e65 6761 7469   = style['negati
-0001f4a0: 7665 275d 0a20 2020 2020 2020 2073 7061  ve'].        spa
-0001f4b0: 726b 6c69 6e65 5b27 6d61 726b 6572 735f  rkline['markers_
-0001f4c0: 636f 6c6f 7227 5d20 3d20 7374 796c 655b  color'] = style[
-0001f4d0: 276d 6172 6b65 7273 275d 0a20 2020 2020  'markers'].     
-0001f4e0: 2020 2073 7061 726b 6c69 6e65 5b27 6669     sparkline['fi
-0001f4f0: 7273 745f 636f 6c6f 7227 5d20 3d20 7374  rst_color'] = st
-0001f500: 796c 655b 2766 6972 7374 275d 0a20 2020  yle['first'].   
-0001f510: 2020 2020 2073 7061 726b 6c69 6e65 5b27       sparkline['
-0001f520: 6c61 7374 5f63 6f6c 6f72 275d 203d 2073  last_color'] = s
-0001f530: 7479 6c65 5b27 6c61 7374 275d 0a20 2020  tyle['last'].   
-0001f540: 2020 2020 2073 7061 726b 6c69 6e65 5b27       sparkline['
-0001f550: 6869 6768 5f63 6f6c 6f72 275d 203d 2073  high_color'] = s
-0001f560: 7479 6c65 5b27 6869 6768 275d 0a20 2020  tyle['high'].   
-0001f570: 2020 2020 2073 7061 726b 6c69 6e65 5b27       sparkline['
-0001f580: 6c6f 775f 636f 6c6f 7227 5d20 3d20 7374  low_color'] = st
-0001f590: 796c 655b 276c 6f77 275d 0a0a 2020 2020  yle['low']..    
-0001f5a0: 2020 2020 2320 4f76 6572 7269 6465 2074      # Override t
-0001f5b0: 6865 2073 7479 6c65 2063 6f6c 6f72 7320  he style colors 
-0001f5c0: 7769 7468 2075 7365 7220 6465 6669 6e65  with user define
-0001f5d0: 6420 636f 6c6f 7273 2e0a 2020 2020 2020  d colors..      
-0001f5e0: 2020 7365 6c66 2e5f 7365 745f 7370 6172    self._set_spar
-0001f5f0: 6b5f 636f 6c6f 7228 7370 6172 6b6c 696e  k_color(sparklin
-0001f600: 652c 206f 7074 696f 6e73 2c20 2773 6572  e, options, 'ser
-0001f610: 6965 735f 636f 6c6f 7227 290a 2020 2020  ies_color').    
-0001f620: 2020 2020 7365 6c66 2e5f 7365 745f 7370      self._set_sp
-0001f630: 6172 6b5f 636f 6c6f 7228 7370 6172 6b6c  ark_color(sparkl
-0001f640: 696e 652c 206f 7074 696f 6e73 2c20 276e  ine, options, 'n
-0001f650: 6567 6174 6976 655f 636f 6c6f 7227 290a  egative_color').
-0001f660: 2020 2020 2020 2020 7365 6c66 2e5f 7365          self._se
-0001f670: 745f 7370 6172 6b5f 636f 6c6f 7228 7370  t_spark_color(sp
-0001f680: 6172 6b6c 696e 652c 206f 7074 696f 6e73  arkline, options
-0001f690: 2c20 276d 6172 6b65 7273 5f63 6f6c 6f72  , 'markers_color
-0001f6a0: 2729 0a20 2020 2020 2020 2073 656c 662e  ').        self.
-0001f6b0: 5f73 6574 5f73 7061 726b 5f63 6f6c 6f72  _set_spark_color
-0001f6c0: 2873 7061 726b 6c69 6e65 2c20 6f70 7469  (sparkline, opti
-0001f6d0: 6f6e 732c 2027 6669 7273 745f 636f 6c6f  ons, 'first_colo
-0001f6e0: 7227 290a 2020 2020 2020 2020 7365 6c66  r').        self
-0001f6f0: 2e5f 7365 745f 7370 6172 6b5f 636f 6c6f  ._set_spark_colo
-0001f700: 7228 7370 6172 6b6c 696e 652c 206f 7074  r(sparkline, opt
-0001f710: 696f 6e73 2c20 276c 6173 745f 636f 6c6f  ions, 'last_colo
-0001f720: 7227 290a 2020 2020 2020 2020 7365 6c66  r').        self
-0001f730: 2e5f 7365 745f 7370 6172 6b5f 636f 6c6f  ._set_spark_colo
-0001f740: 7228 7370 6172 6b6c 696e 652c 206f 7074  r(sparkline, opt
-0001f750: 696f 6e73 2c20 2768 6967 685f 636f 6c6f  ions, 'high_colo
-0001f760: 7227 290a 2020 2020 2020 2020 7365 6c66  r').        self
-0001f770: 2e5f 7365 745f 7370 6172 6b5f 636f 6c6f  ._set_spark_colo
-0001f780: 7228 7370 6172 6b6c 696e 652c 206f 7074  r(sparkline, opt
-0001f790: 696f 6e73 2c20 276c 6f77 5f63 6f6c 6f72  ions, 'low_color
-0001f7a0: 2729 0a0a 2020 2020 2020 2020 7365 6c66  ')..        self
-0001f7b0: 2e73 7061 726b 6c69 6e65 732e 6170 7065  .sparklines.appe
-0001f7c0: 6e64 2873 7061 726b 6c69 6e65 290a 0a20  nd(sparkline).. 
-0001f7d0: 2020 2020 2020 2072 6574 7572 6e20 300a         return 0.
-0001f7e0: 0a20 2020 2040 636f 6e76 6572 745f 7261  .    @convert_ra
-0001f7f0: 6e67 655f 6172 6773 0a20 2020 2064 6566  nge_args.    def
-0001f800: 2073 6574 5f73 656c 6563 7469 6f6e 2873   set_selection(s
-0001f810: 656c 662c 2066 6972 7374 5f72 6f77 2c20  elf, first_row, 
-0001f820: 6669 7273 745f 636f 6c2c 206c 6173 745f  first_col, last_
-0001f830: 726f 772c 206c 6173 745f 636f 6c29 3a0a  row, last_col):.
-0001f840: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001f850: 2020 2020 5365 7420 7468 6520 7365 6c65      Set the sele
-0001f860: 6374 6564 2063 656c 6c20 6f72 2063 656c  cted cell or cel
-0001f870: 6c73 2069 6e20 6120 776f 726b 7368 6565  ls in a workshee
-0001f880: 740a 0a20 2020 2020 2020 2041 7267 733a  t..        Args:
-0001f890: 0a20 2020 2020 2020 2020 2020 2066 6972  .            fir
-0001f8a0: 7374 5f72 6f77 3a20 2020 2054 6865 2066  st_row:    The f
-0001f8b0: 6972 7374 2072 6f77 206f 6620 7468 6520  irst row of the 
-0001f8c0: 6365 6c6c 2072 616e 6765 2e20 287a 6572  cell range. (zer
-0001f8d0: 6f20 696e 6465 7865 6429 2e0a 2020 2020  o indexed)..    
-0001f8e0: 2020 2020 2020 2020 6669 7273 745f 636f          first_co
-0001f8f0: 6c3a 2020 2020 5468 6520 6669 7273 7420  l:    The first 
-0001f900: 636f 6c75 6d6e 206f 6620 7468 6520 6365  column of the ce
-0001f910: 6c6c 2072 616e 6765 2e0a 2020 2020 2020  ll range..      
-0001f920: 2020 2020 2020 6c61 7374 5f72 6f77 3a20        last_row: 
-0001f930: 2020 2020 5468 6520 6c61 7374 2072 6f77      The last row
-0001f940: 206f 6620 7468 6520 6365 6c6c 2072 616e   of the cell ran
-0001f950: 6765 2e20 287a 6572 6f20 696e 6465 7865  ge. (zero indexe
-0001f960: 6429 2e0a 2020 2020 2020 2020 2020 2020  d)..            
-0001f970: 6c61 7374 5f63 6f6c 3a20 2020 2020 5468  last_col:     Th
-0001f980: 6520 6c61 7374 2063 6f6c 756d 6e20 6f66  e last column of
-0001f990: 2074 6865 2063 656c 6c20 7261 6e67 652e   the cell range.
-0001f9a0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-0001f9b0: 733a 0a20 2020 2020 2020 2020 2020 2030  s:.            0
-0001f9c0: 3a20 204e 6f74 6869 6e67 2e0a 2020 2020  :  Nothing..    
-0001f9d0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001f9e0: 7061 6e65 203d 204e 6f6e 650a 0a20 2020  pane = None..   
-0001f9f0: 2020 2020 2023 2052 616e 6765 2073 656c       # Range sel
-0001fa00: 6563 7469 6f6e 2e20 446f 2074 6869 7320  ection. Do this 
-0001fa10: 6265 666f 7265 2073 7761 7070 696e 6720  before swapping 
-0001fa20: 6d61 782f 6d69 6e20 746f 2061 6c6c 6f77  max/min to allow
-0001fa30: 2074 6865 0a20 2020 2020 2020 2023 2073   the.        # s
-0001fa40: 656c 6563 7469 6f6e 2064 6972 6563 7469  election directi
-0001fa50: 6f6e 2074 6f20 6265 2072 6576 6572 7365  on to be reverse
-0001fa60: 642e 0a20 2020 2020 2020 2061 6374 6976  d..        activ
-0001fa70: 655f 6365 6c6c 203d 2078 6c5f 726f 7763  e_cell = xl_rowc
-0001fa80: 6f6c 5f74 6f5f 6365 6c6c 2866 6972 7374  ol_to_cell(first
-0001fa90: 5f72 6f77 2c20 6669 7273 745f 636f 6c29  _row, first_col)
-0001faa0: 0a0a 2020 2020 2020 2020 2320 5377 6170  ..        # Swap
-0001fab0: 206c 6173 7420 726f 772f 636f 6c20 666f   last row/col fo
-0001fac0: 7220 6669 7273 7420 726f 772f 636f 6c20  r first row/col 
-0001fad0: 6966 206e 6563 6573 7361 7279 0a20 2020  if necessary.   
-0001fae0: 2020 2020 2069 6620 6669 7273 745f 726f       if first_ro
-0001faf0: 7720 3e20 6c61 7374 5f72 6f77 3a0a 2020  w > last_row:.  
-0001fb00: 2020 2020 2020 2020 2020 2866 6972 7374            (first
-0001fb10: 5f72 6f77 2c20 6c61 7374 5f72 6f77 2920  _row, last_row) 
-0001fb20: 3d20 286c 6173 745f 726f 772c 2066 6972  = (last_row, fir
-0001fb30: 7374 5f72 6f77 290a 0a20 2020 2020 2020  st_row)..       
-0001fb40: 2069 6620 6669 7273 745f 636f 6c20 3e20   if first_col > 
-0001fb50: 6c61 7374 5f63 6f6c 3a0a 2020 2020 2020  last_col:.      
-0001fb60: 2020 2020 2020 2866 6972 7374 5f63 6f6c        (first_col
-0001fb70: 2c20 6c61 7374 5f63 6f6c 2920 3d20 286c  , last_col) = (l
-0001fb80: 6173 745f 636f 6c2c 2066 6972 7374 5f63  ast_col, first_c
-0001fb90: 6f6c 290a 0a20 2020 2020 2020 2073 7172  ol)..        sqr
-0001fba0: 6566 203d 2078 6c5f 7261 6e67 6528 6669  ef = xl_range(fi
-0001fbb0: 7273 745f 726f 772c 2066 6972 7374 5f63  rst_row, first_c
-0001fbc0: 6f6c 2c20 6c61 7374 5f72 6f77 2c20 6c61  ol, last_row, la
-0001fbd0: 7374 5f63 6f6c 290a 0a20 2020 2020 2020  st_col)..       
-0001fbe0: 2023 2053 656c 6563 7469 6f6e 2069 736e   # Selection isn
-0001fbf0: 2774 2073 6574 2066 6f72 2063 656c 6c20  't set for cell 
-0001fc00: 4131 2e0a 2020 2020 2020 2020 6966 2073  A1..        if s
-0001fc10: 7172 6566 203d 3d20 2741 3127 3a0a 2020  qref == 'A1':.  
-0001fc20: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001fc30: 0a0a 2020 2020 2020 2020 7365 6c66 2e73  ..        self.s
-0001fc40: 656c 6563 7469 6f6e 7320 3d20 5b5b 7061  elections = [[pa
-0001fc50: 6e65 2c20 6163 7469 7665 5f63 656c 6c2c  ne, active_cell,
-0001fc60: 2073 7172 6566 5d5d 0a0a 2020 2020 4063   sqref]]..    @c
-0001fc70: 6f6e 7665 7274 5f63 656c 6c5f 6172 6773  onvert_cell_args
-0001fc80: 0a20 2020 2064 6566 2073 6574 5f74 6f70  .    def set_top
-0001fc90: 5f6c 6566 745f 6365 6c6c 2873 656c 662c  _left_cell(self,
-0001fca0: 2072 6f77 3d30 2c20 636f 6c3d 3029 3a0a   row=0, col=0):.
-0001fcb0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001fcc0: 2020 2020 5365 7420 7468 6520 6669 7273      Set the firs
-0001fcd0: 7420 7669 7369 626c 6520 6365 6c6c 2061  t visible cell a
-0001fce0: 7420 7468 6520 746f 7020 6c65 6674 206f  t the top left o
-0001fcf0: 6620 6120 776f 726b 7368 6565 742e 0a0a  f a worksheet...
-0001fd00: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
-0001fd10: 2020 2020 2020 2020 2020 726f 773a 2054            row: T
-0001fd20: 6865 2063 656c 6c20 726f 7720 287a 6572  he cell row (zer
-0001fd30: 6f20 696e 6465 7865 6429 2e0a 2020 2020  o indexed)..    
-0001fd40: 2020 2020 2020 2020 636f 6c3a 2054 6865          col: The
-0001fd50: 2063 656c 6c20 636f 6c75 6d6e 2028 7a65   cell column (ze
-0001fd60: 726f 2069 6e64 6578 6564 292e 0a0a 2020  ro indexed)...  
-0001fd70: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
-0001fd80: 2020 2020 2020 2020 2020 2030 3a20 204e             0:  N
-0001fd90: 6f74 6869 6e67 2e0a 2020 2020 2020 2020  othing..        
-0001fda0: 2222 220a 0a20 2020 2020 2020 2069 6620  """..        if 
-0001fdb0: 726f 7720 3d3d 2030 2061 6e64 2063 6f6c  row == 0 and col
-0001fdc0: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
-0001fdd0: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
-0001fde0: 2020 2073 656c 662e 746f 705f 6c65 6674     self.top_left
-0001fdf0: 5f63 656c 6c20 3d20 786c 5f72 6f77 636f  _cell = xl_rowco
-0001fe00: 6c5f 746f 5f63 656c 6c28 726f 772c 2063  l_to_cell(row, c
-0001fe10: 6f6c 290a 0a20 2020 2064 6566 206f 7574  ol)..    def out
-0001fe20: 6c69 6e65 5f73 6574 7469 6e67 7328 7365  line_settings(se
-0001fe30: 6c66 2c20 7669 7369 626c 653d 312c 2073  lf, visible=1, s
-0001fe40: 796d 626f 6c73 5f62 656c 6f77 3d31 2c20  ymbols_below=1, 
-0001fe50: 7379 6d62 6f6c 735f 7269 6768 743d 312c  symbols_right=1,
-0001fe60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001fe70: 2020 2020 2020 2020 2020 6175 746f 5f73            auto_s
-0001fe80: 7479 6c65 3d30 293a 0a20 2020 2020 2020  tyle=0):.       
-0001fe90: 2022 2222 0a20 2020 2020 2020 2043 6f6e   """.        Con
-0001fea0: 7472 6f6c 206f 7574 6c69 6e65 2073 6574  trol outline set
-0001feb0: 7469 6e67 732e 0a0a 2020 2020 2020 2020  tings...        
-0001fec0: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
-0001fed0: 2020 7669 7369 626c 653a 2020 2020 2020    visible:      
-0001fee0: 204f 7574 6c69 6e65 7320 6172 6520 7669   Outlines are vi
-0001fef0: 7369 626c 652e 204f 7074 696f 6e61 6c2c  sible. Optional,
-0001ff00: 2064 6566 6175 6c74 7320 746f 2054 7275   defaults to Tru
-0001ff10: 652e 0a20 2020 2020 2020 2020 2020 2073  e..            s
-0001ff20: 796d 626f 6c73 5f62 656c 6f77 3a20 5368  ymbols_below: Sh
-0001ff30: 6f77 2072 6f77 206f 7574 6c69 6e65 2073  ow row outline s
-0001ff40: 796d 626f 6c73 2062 656c 6f77 2074 6865  ymbols below the
-0001ff50: 206f 7574 6c69 6e65 2062 6172 2e0a 2020   outline bar..  
-0001ff60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ff70: 2020 2020 2020 2020 204f 7074 696f 6e61           Optiona
-0001ff80: 6c2c 2064 6566 6175 6c74 7320 746f 2054  l, defaults to T
-0001ff90: 7275 652e 0a20 2020 2020 2020 2020 2020  rue..           
-0001ffa0: 2073 796d 626f 6c73 5f72 6967 6874 3a20   symbols_right: 
-0001ffb0: 5368 6f77 2063 6f6c 756d 6e20 6f75 746c  Show column outl
-0001ffc0: 696e 6520 7379 6d62 6f6c 7320 746f 2074  ine symbols to t
-0001ffd0: 6865 2072 6967 6874 206f 6620 7468 650a  he right of the.
-0001ffe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fff0: 2020 2020 2020 2020 2020 206f 7574 6c69             outli
-00020000: 6e65 2062 6172 2e20 4f70 7469 6f6e 616c  ne bar. Optional
-00020010: 2c20 6465 6661 756c 7473 2074 6f20 5472  , defaults to Tr
-00020020: 7565 2e0a 2020 2020 2020 2020 2020 2020  ue..            
-00020030: 6175 746f 5f73 7479 6c65 3a20 2020 2055  auto_style:    U
-00020040: 7365 2041 7574 6f6d 6174 6963 2073 7479  se Automatic sty
-00020050: 6c65 2e20 4f70 7469 6f6e 616c 2c20 6465  le. Optional, de
-00020060: 6661 756c 7473 2074 6f20 4661 6c73 652e  faults to False.
-00020070: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-00020080: 733a 0a20 2020 2020 2020 2020 2020 2030  s:.            0
-00020090: 3a20 204e 6f74 6869 6e67 2e0a 2020 2020  :  Nothing..    
-000200a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000200b0: 7365 6c66 2e6f 7574 6c69 6e65 5f6f 6e20  self.outline_on 
-000200c0: 3d20 7669 7369 626c 650a 2020 2020 2020  = visible.      
-000200d0: 2020 7365 6c66 2e6f 7574 6c69 6e65 5f62    self.outline_b
-000200e0: 656c 6f77 203d 2073 796d 626f 6c73 5f62  elow = symbols_b
-000200f0: 656c 6f77 0a20 2020 2020 2020 2073 656c  elow.        sel
-00020100: 662e 6f75 746c 696e 655f 7269 6768 7420  f.outline_right 
-00020110: 3d20 7379 6d62 6f6c 735f 7269 6768 740a  = symbols_right.
-00020120: 2020 2020 2020 2020 7365 6c66 2e6f 7574          self.out
-00020130: 6c69 6e65 5f73 7479 6c65 203d 2061 7574  line_style = aut
-00020140: 6f5f 7374 796c 650a 0a20 2020 2020 2020  o_style..       
-00020150: 2073 656c 662e 6f75 746c 696e 655f 6368   self.outline_ch
-00020160: 616e 6765 6420 3d20 5472 7565 0a0a 2020  anged = True..  
-00020170: 2020 4063 6f6e 7665 7274 5f63 656c 6c5f    @convert_cell_
-00020180: 6172 6773 0a20 2020 2064 6566 2066 7265  args.    def fre
-00020190: 657a 655f 7061 6e65 7328 7365 6c66 2c20  eze_panes(self, 
-000201a0: 726f 772c 2063 6f6c 2c20 746f 705f 726f  row, col, top_ro
-000201b0: 773d 4e6f 6e65 2c20 6c65 6674 5f63 6f6c  w=None, left_col
-000201c0: 3d4e 6f6e 652c 2070 616e 655f 7479 7065  =None, pane_type
-000201d0: 3d30 293a 0a20 2020 2020 2020 2022 2222  =0):.        """
-000201e0: 0a20 2020 2020 2020 2043 7265 6174 6520  .        Create 
-000201f0: 776f 726b 7368 6565 7420 7061 6e65 7320  worksheet panes 
-00020200: 616e 6420 6d61 726b 2074 6865 6d20 6173  and mark them as
-00020210: 2066 726f 7a65 6e2e 0a0a 2020 2020 2020   frozen...      
-00020220: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
-00020230: 2020 2020 726f 773a 2020 2020 2020 5468      row:      Th
-00020240: 6520 6365 6c6c 2072 6f77 2028 7a65 726f  e cell row (zero
-00020250: 2069 6e64 6578 6564 292e 0a20 2020 2020   indexed)..     
-00020260: 2020 2020 2020 2063 6f6c 3a20 2020 2020         col:     
-00020270: 2054 6865 2063 656c 6c20 636f 6c75 6d6e   The cell column
-00020280: 2028 7a65 726f 2069 6e64 6578 6564 292e   (zero indexed).
-00020290: 0a20 2020 2020 2020 2020 2020 2074 6f70  .            top
-000202a0: 5f72 6f77 3a20 2054 6f70 6d6f 7374 2076  _row:  Topmost v
-000202b0: 6973 6962 6c65 2072 6f77 2069 6e20 7363  isible row in sc
-000202c0: 726f 6c6c 696e 6720 7265 6769 6f6e 206f  rolling region o
-000202d0: 6620 7061 6e65 2e0a 2020 2020 2020 2020  f pane..        
-000202e0: 2020 2020 6c65 6674 5f63 6f6c 3a20 4c65      left_col: Le
-000202f0: 6674 6d6f 7374 2076 6973 6962 6c65 2072  ftmost visible r
-00020300: 6f77 2069 6e20 7363 726f 6c6c 696e 6720  ow in scrolling 
-00020310: 7265 6769 6f6e 206f 6620 7061 6e65 2e0a  region of pane..
-00020320: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00020330: 3a0a 2020 2020 2020 2020 2020 2020 303a  :.            0:
-00020340: 2020 4e6f 7468 696e 672e 0a0a 2020 2020    Nothing...    
-00020350: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00020360: 6966 2074 6f70 5f72 6f77 2069 7320 4e6f  if top_row is No
-00020370: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00020380: 746f 705f 726f 7720 3d20 726f 770a 0a20  top_row = row.. 
-00020390: 2020 2020 2020 2069 6620 6c65 6674 5f63         if left_c
-000203a0: 6f6c 2069 7320 4e6f 6e65 3a0a 2020 2020  ol is None:.    
-000203b0: 2020 2020 2020 2020 6c65 6674 5f63 6f6c          left_col
-000203c0: 203d 2063 6f6c 0a0a 2020 2020 2020 2020   = col..        
-000203d0: 7365 6c66 2e70 616e 6573 203d 205b 726f  self.panes = [ro
-000203e0: 772c 2063 6f6c 2c20 746f 705f 726f 772c  w, col, top_row,
-000203f0: 206c 6566 745f 636f 6c2c 2070 616e 655f   left_col, pane_
-00020400: 7479 7065 5d0a 0a20 2020 2040 636f 6e76  type]..    @conv
-00020410: 6572 745f 6365 6c6c 5f61 7267 730a 2020  ert_cell_args.  
-00020420: 2020 6465 6620 7370 6c69 745f 7061 6e65    def split_pane
-00020430: 7328 7365 6c66 2c20 782c 2079 2c20 746f  s(self, x, y, to
-00020440: 705f 726f 773d 4e6f 6e65 2c20 6c65 6674  p_row=None, left
-00020450: 5f63 6f6c 3d4e 6f6e 6529 3a0a 2020 2020  _col=None):.    
-00020460: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00020470: 4372 6561 7465 2077 6f72 6b73 6865 6574  Create worksheet
-00020480: 2070 616e 6573 2061 6e64 206d 6172 6b20   panes and mark 
-00020490: 7468 656d 2061 7320 7370 6c69 742e 0a0a  them as split...
-000204a0: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
-000204b0: 2020 2020 2020 2020 2020 783a 2020 2020            x:    
-000204c0: 2020 2020 5468 6520 706f 7369 7469 6f6e      The position
-000204d0: 2066 6f72 2074 6865 2076 6572 7469 6361   for the vertica
-000204e0: 6c20 7370 6c69 742e 0a20 2020 2020 2020  l split..       
-000204f0: 2020 2020 2079 3a20 2020 2020 2020 2054       y:        T
-00020500: 6865 2070 6f73 6974 696f 6e20 666f 7220  he position for 
-00020510: 7468 6520 686f 7269 7a6f 6e74 616c 2073  the horizontal s
-00020520: 706c 6974 2e0a 2020 2020 2020 2020 2020  plit..          
-00020530: 2020 746f 705f 726f 773a 2020 546f 706d    top_row:  Topm
-00020540: 6f73 7420 7669 7369 626c 6520 726f 7720  ost visible row 
-00020550: 696e 2073 6372 6f6c 6c69 6e67 2072 6567  in scrolling reg
-00020560: 696f 6e20 6f66 2070 616e 652e 0a20 2020  ion of pane..   
-00020570: 2020 2020 2020 2020 206c 6566 745f 636f           left_co
-00020580: 6c3a 204c 6566 746d 6f73 7420 7669 7369  l: Leftmost visi
-00020590: 626c 6520 726f 7720 696e 2073 6372 6f6c  ble row in scrol
-000205a0: 6c69 6e67 2072 6567 696f 6e20 6f66 2070  ling region of p
-000205b0: 616e 652e 0a0a 2020 2020 2020 2020 5265  ane...        Re
-000205c0: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
-000205d0: 2020 2030 3a20 204e 6f74 6869 6e67 2e0a     0:  Nothing..
-000205e0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000205f0: 2020 2020 2023 2053 616d 6520 6173 2066       # Same as f
-00020600: 7265 657a 6520 7061 6e65 7320 7769 7468  reeze panes with
-00020610: 2061 2064 6966 6665 7265 6e74 2070 616e   a different pan
-00020620: 6520 7479 7065 2e0a 2020 2020 2020 2020  e type..        
-00020630: 7365 6c66 2e66 7265 657a 655f 7061 6e65  self.freeze_pane
-00020640: 7328 782c 2079 2c20 746f 705f 726f 772c  s(x, y, top_row,
-00020650: 206c 6566 745f 636f 6c2c 2032 290a 0a20   left_col, 2).. 
-00020660: 2020 2064 6566 2073 6574 5f7a 6f6f 6d28     def set_zoom(
-00020670: 7365 6c66 2c20 7a6f 6f6d 3d31 3030 293a  self, zoom=100):
-00020680: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00020690: 2020 2020 2053 6574 2074 6865 2077 6f72       Set the wor
-000206a0: 6b73 6865 6574 207a 6f6f 6d20 6661 6374  ksheet zoom fact
-000206b0: 6f72 2e0a 0a20 2020 2020 2020 2041 7267  or...        Arg
-000206c0: 733a 0a20 2020 2020 2020 2020 2020 207a  s:.            z
-000206d0: 6f6f 6d3a 2053 6361 6c65 2066 6163 746f  oom: Scale facto
-000206e0: 723a 2031 3020 3c3d 207a 6f6f 6d20 3c3d  r: 10 <= zoom <=
-000206f0: 2034 3030 2e0a 0a20 2020 2020 2020 2052   400...        R
-00020700: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
-00020710: 2020 2020 4e6f 7468 696e 672e 0a0a 2020      Nothing...  
-00020720: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00020730: 2020 2320 456e 7375 7265 2074 6865 207a    # Ensure the z
-00020740: 6f6f 6d20 7363 616c 6520 6973 2069 6e20  oom scale is in 
-00020750: 4578 6365 6c27 7320 7261 6e67 652e 0a20  Excel's range.. 
-00020760: 2020 2020 2020 2069 6620 7a6f 6f6d 203c         if zoom <
-00020770: 2031 3020 6f72 207a 6f6f 6d20 3e20 3430   10 or zoom > 40
-00020780: 303a 0a20 2020 2020 2020 2020 2020 2077  0:.            w
-00020790: 6172 6e28 225a 6f6f 6d20 6661 6374 6f72  arn("Zoom factor
-000207a0: 2025 6420 6f75 7473 6964 6520 7261 6e67   %d outside rang
-000207b0: 653a 2031 3020 3c3d 207a 6f6f 6d20 3c3d  e: 10 <= zoom <=
-000207c0: 2034 3030 2220 2520 7a6f 6f6d 290a 2020   400" % zoom).  
-000207d0: 2020 2020 2020 2020 2020 7a6f 6f6d 203d            zoom =
-000207e0: 2031 3030 0a0a 2020 2020 2020 2020 7365   100..        se
-000207f0: 6c66 2e7a 6f6f 6d20 3d20 696e 7428 7a6f  lf.zoom = int(zo
-00020800: 6f6d 290a 0a20 2020 2064 6566 2072 6967  om)..    def rig
-00020810: 6874 5f74 6f5f 6c65 6674 2873 656c 6629  ht_to_left(self)
-00020820: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00020830: 2020 2020 2020 4469 7370 6c61 7920 7468        Display th
-00020840: 6520 776f 726b 7368 6565 7420 7269 6768  e worksheet righ
-00020850: 7420 746f 206c 6566 7420 666f 7220 736f  t to left for so
-00020860: 6d65 2076 6572 7369 6f6e 7320 6f66 2045  me versions of E
-00020870: 7863 656c 2e0a 0a20 2020 2020 2020 2041  xcel...        A
-00020880: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
-00020890: 204e 6f6e 652e 0a0a 2020 2020 2020 2020   None...        
-000208a0: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
-000208b0: 2020 2020 204e 6f74 6869 6e67 2e0a 0a20       Nothing... 
-000208c0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000208d0: 2020 2073 656c 662e 6973 5f72 6967 6874     self.is_right
-000208e0: 5f74 6f5f 6c65 6674 203d 2031 0a0a 2020  _to_left = 1..  
-000208f0: 2020 6465 6620 6869 6465 5f7a 6572 6f28    def hide_zero(
-00020900: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00020910: 2222 0a20 2020 2020 2020 2048 6964 6520  "".        Hide 
-00020920: 7a65 726f 2076 616c 7565 7320 696e 2077  zero values in w
-00020930: 6f72 6b73 6865 6574 2063 656c 6c73 2e0a  orksheet cells..
-00020940: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
-00020950: 2020 2020 2020 2020 2020 204e 6f6e 652e             None.
-00020960: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-00020970: 733a 0a20 2020 2020 2020 2020 2020 204e  s:.            N
-00020980: 6f74 6869 6e67 2e0a 0a20 2020 2020 2020  othing...       
-00020990: 2022 2222 0a20 2020 2020 2020 2073 656c   """.        sel
-000209a0: 662e 7368 6f77 5f7a 6572 6f73 203d 2030  f.show_zeros = 0
-000209b0: 0a0a 2020 2020 6465 6620 7365 745f 7461  ..    def set_ta
-000209c0: 625f 636f 6c6f 7228 7365 6c66 2c20 636f  b_color(self, co
-000209d0: 6c6f 7229 3a0a 2020 2020 2020 2020 2222  lor):.        ""
-000209e0: 220a 2020 2020 2020 2020 5365 7420 7468  ".        Set th
-000209f0: 6520 636f 6c6f 7220 6f66 2074 6865 2077  e color of the w
-00020a00: 6f72 6b73 6865 6574 2074 6162 2e0a 0a20  orksheet tab... 
-00020a10: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
-00020a20: 2020 2020 2020 2020 2063 6f6c 6f72 3a20           color: 
-00020a30: 4120 2352 4742 2063 6f6c 6f72 2069 6e64  A #RGB color ind
-00020a40: 6578 2e0a 0a20 2020 2020 2020 2052 6574  ex...        Ret
-00020a50: 7572 6e73 3a0a 2020 2020 2020 2020 2020  urns:.          
-00020a60: 2020 4e6f 7468 696e 672e 0a0a 2020 2020    Nothing...    
-00020a70: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00020a80: 7365 6c66 2e74 6162 5f63 6f6c 6f72 203d  self.tab_color =
-00020a90: 2078 6c5f 636f 6c6f 7228 636f 6c6f 7229   xl_color(color)
-00020aa0: 0a0a 2020 2020 6465 6620 7072 6f74 6563  ..    def protec
-00020ab0: 7428 7365 6c66 2c20 7061 7373 776f 7264  t(self, password
-00020ac0: 3d27 272c 206f 7074 696f 6e73 3d4e 6f6e  ='', options=Non
-00020ad0: 6529 3a0a 2020 2020 2020 2020 2222 220a  e):.        """.
-00020ae0: 2020 2020 2020 2020 5365 7420 7468 6520          Set the 
-00020af0: 7061 7373 776f 7264 2061 6e64 2070 726f  password and pro
-00020b00: 7465 6374 696f 6e20 6f70 7469 6f6e 7320  tection options 
-00020b10: 6f66 2074 6865 2077 6f72 6b73 6865 6574  of the worksheet
-00020b20: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
-00020b30: 0a20 2020 2020 2020 2020 2020 2070 6173  .            pas
-00020b40: 7377 6f72 643a 2041 6e20 6f70 7469 6f6e  sword: An option
-00020b50: 616c 2070 6173 7377 6f72 6420 7374 7269  al password stri
-00020b60: 6e67 2e0a 2020 2020 2020 2020 2020 2020  ng..            
-00020b70: 6f70 7469 6f6e 733a 2020 4120 6469 6374  options:  A dict
-00020b80: 696f 6e61 7279 206f 6620 776f 726b 7368  ionary of worksh
-00020b90: 6565 7420 6f62 6a65 6374 7320 746f 2070  eet objects to p
-00020ba0: 726f 7465 6374 2e0a 0a20 2020 2020 2020  rotect...       
-00020bb0: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
-00020bc0: 2020 2020 2020 4e6f 7468 696e 672e 0a0a        Nothing...
-00020bd0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00020be0: 2020 2020 6966 2070 6173 7377 6f72 6420      if password 
-00020bf0: 213d 2027 273a 0a20 2020 2020 2020 2020  != '':.         
-00020c00: 2020 2070 6173 7377 6f72 6420 3d20 7365     password = se
-00020c10: 6c66 2e5f 656e 636f 6465 5f70 6173 7377  lf._encode_passw
-00020c20: 6f72 6428 7061 7373 776f 7264 290a 0a20  ord(password).. 
-00020c30: 2020 2020 2020 2069 6620 6e6f 7420 6f70         if not op
-00020c40: 7469 6f6e 733a 0a20 2020 2020 2020 2020  tions:.         
-00020c50: 2020 206f 7074 696f 6e73 203d 207b 7d0a     options = {}.
-00020c60: 0a20 2020 2020 2020 2023 2044 6566 6175  .        # Defau
-00020c70: 6c74 2076 616c 7565 7320 666f 7220 6f62  lt values for ob
-00020c80: 6a65 6374 7320 7468 6174 2063 616e 2062  jects that can b
-00020c90: 6520 7072 6f74 6563 7465 642e 0a20 2020  e protected..   
-00020ca0: 2020 2020 2064 6566 6175 6c74 7320 3d20       defaults = 
-00020cb0: 7b0a 2020 2020 2020 2020 2020 2020 2773  {.            's
-00020cc0: 6865 6574 273a 2054 7275 652c 0a20 2020  heet': True,.   
-00020cd0: 2020 2020 2020 2020 2027 636f 6e74 656e           'conten
-00020ce0: 7427 3a20 4661 6c73 652c 0a20 2020 2020  t': False,.     
-00020cf0: 2020 2020 2020 2027 6f62 6a65 6374 7327         'objects'
-00020d00: 3a20 4661 6c73 652c 0a20 2020 2020 2020  : False,.       
-00020d10: 2020 2020 2027 7363 656e 6172 696f 7327       'scenarios'
-00020d20: 3a20 4661 6c73 652c 0a20 2020 2020 2020  : False,.       
-00020d30: 2020 2020 2027 666f 726d 6174 5f63 656c       'format_cel
-00020d40: 6c73 273a 2046 616c 7365 2c0a 2020 2020  ls': False,.    
-00020d50: 2020 2020 2020 2020 2766 6f72 6d61 745f          'format_
-00020d60: 636f 6c75 6d6e 7327 3a20 4661 6c73 652c  columns': False,
-00020d70: 0a20 2020 2020 2020 2020 2020 2027 666f  .            'fo
-00020d80: 726d 6174 5f72 6f77 7327 3a20 4661 6c73  rmat_rows': Fals
-00020d90: 652c 0a20 2020 2020 2020 2020 2020 2027  e,.            '
-00020da0: 696e 7365 7274 5f63 6f6c 756d 6e73 273a  insert_columns':
-00020db0: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
-00020dc0: 2020 2020 2769 6e73 6572 745f 726f 7773      'insert_rows
-00020dd0: 273a 2046 616c 7365 2c0a 2020 2020 2020  ': False,.      
-00020de0: 2020 2020 2020 2769 6e73 6572 745f 6879        'insert_hy
-00020df0: 7065 726c 696e 6b73 273a 2046 616c 7365  perlinks': False
-00020e00: 2c0a 2020 2020 2020 2020 2020 2020 2764  ,.            'd
-00020e10: 656c 6574 655f 636f 6c75 6d6e 7327 3a20  elete_columns': 
-00020e20: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
-00020e30: 2020 2027 6465 6c65 7465 5f72 6f77 7327     'delete_rows'
-00020e40: 3a20 4661 6c73 652c 0a20 2020 2020 2020  : False,.       
-00020e50: 2020 2020 2027 7365 6c65 6374 5f6c 6f63       'select_loc
-00020e60: 6b65 645f 6365 6c6c 7327 3a20 5472 7565  ked_cells': True
-00020e70: 2c0a 2020 2020 2020 2020 2020 2020 2773  ,.            's
-00020e80: 6f72 7427 3a20 4661 6c73 652c 0a20 2020  ort': False,.   
-00020e90: 2020 2020 2020 2020 2027 6175 746f 6669           'autofi
-00020ea0: 6c74 6572 273a 2046 616c 7365 2c0a 2020  lter': False,.  
-00020eb0: 2020 2020 2020 2020 2020 2770 6976 6f74            'pivot
-00020ec0: 5f74 6162 6c65 7327 3a20 4661 6c73 652c  _tables': False,
-00020ed0: 0a20 2020 2020 2020 2020 2020 2027 7365  .            'se
-00020ee0: 6c65 6374 5f75 6e6c 6f63 6b65 645f 6365  lect_unlocked_ce
-00020ef0: 6c6c 7327 3a20 5472 7565 7d0a 0a20 2020  lls': True}..   
-00020f00: 2020 2020 2023 204f 7665 7277 7269 7465       # Overwrite
-00020f10: 2074 6865 2064 6566 6175 6c74 7320 7769   the defaults wi
-00020f20: 7468 2075 7365 7220 7370 6563 6966 6965  th user specifie
-00020f30: 6420 7661 6c75 6573 2e0a 2020 2020 2020  d values..      
-00020f40: 2020 666f 7220 6b65 7920 696e 2028 6f70    for key in (op
-00020f50: 7469 6f6e 732e 6b65 7973 2829 293a 0a0a  tions.keys()):..
-00020f60: 2020 2020 2020 2020 2020 2020 6966 206b              if k
-00020f70: 6579 2069 6e20 6465 6661 756c 7473 3a0a  ey in defaults:.
-00020f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020f90: 6465 6661 756c 7473 5b6b 6579 5d20 3d20  defaults[key] = 
-00020fa0: 6f70 7469 6f6e 735b 6b65 795d 0a20 2020  options[key].   
-00020fb0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00020fc0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-00020fd0: 6172 6e28 2255 6e6b 6e6f 776e 2070 726f  arn("Unknown pro
-00020fe0: 7465 6374 696f 6e20 6f62 6a65 6374 3a20  tection object: 
-00020ff0: 2725 7327 2220 2520 6b65 7929 0a0a 2020  '%s'" % key)..  
-00021000: 2020 2020 2020 2320 5365 7420 7468 6520        # Set the 
-00021010: 7061 7373 776f 7264 2061 6674 6572 2074  password after t
-00021020: 6865 2075 7365 7220 6465 6669 6e65 6420  he user defined 
-00021030: 7661 6c75 6573 2e0a 2020 2020 2020 2020  values..        
-00021040: 6465 6661 756c 7473 5b27 7061 7373 776f  defaults['passwo
-00021050: 7264 275d 203d 2070 6173 7377 6f72 640a  rd'] = password.
-00021060: 0a20 2020 2020 2020 2073 656c 662e 7072  .        self.pr
-00021070: 6f74 6563 745f 6f70 7469 6f6e 7320 3d20  otect_options = 
-00021080: 6465 6661 756c 7473 0a0a 2020 2020 6465  defaults..    de
-00021090: 6620 756e 7072 6f74 6563 745f 7261 6e67  f unprotect_rang
-000210a0: 6528 7365 6c66 2c20 6365 6c6c 5f72 616e  e(self, cell_ran
-000210b0: 6765 2c20 7261 6e67 655f 6e61 6d65 3d4e  ge, range_name=N
-000210c0: 6f6e 652c 2070 6173 7377 6f72 643d 4e6f  one, password=No
-000210d0: 6e65 293a 0a20 2020 2020 2020 2022 2222  ne):.        """
-000210e0: 0a20 2020 2020 2020 2055 6e70 726f 7465  .        Unprote
-000210f0: 6374 2072 616e 6765 7320 7769 7468 696e  ct ranges within
-00021100: 2061 2070 726f 7465 6374 6564 2077 6f72   a protected wor
-00021110: 6b73 6865 6574 2e0a 0a20 2020 2020 2020  ksheet...       
-00021120: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
-00021130: 2020 2063 656c 6c5f 7261 6e67 653a 2054     cell_range: T
-00021140: 6865 2063 656c 6c20 6f72 2063 656c 6c20  he cell or cell 
-00021150: 7261 6e67 6520 746f 2075 6e70 726f 7465  range to unprote
-00021160: 6374 2e0a 2020 2020 2020 2020 2020 2020  ct..            
-00021170: 7261 6e67 655f 6e61 6d65 3a20 416e 206f  range_name: An o
-00021180: 7074 696f 6e61 6c20 6e61 6d65 2066 6f72  ptional name for
-00021190: 2074 6865 2072 616e 6765 2e0a 2020 2020   the range..    
-000211a0: 2020 2020 2020 2020 7061 7373 776f 7264          password
-000211b0: 3a20 2020 416e 206f 7074 696f 6e61 6c20  :   An optional 
-000211c0: 7061 7373 776f 7264 2073 7472 696e 672e  password string.
-000211d0: 2028 756e 646f 6375 6d65 6e74 6564 290a   (undocumented).
-000211e0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-000211f0: 3a0a 2020 2020 2020 2020 2020 2020 4e6f  :.            No
-00021200: 7468 696e 672e 0a0a 2020 2020 2020 2020  thing...        
-00021210: 2222 220a 2020 2020 2020 2020 6966 2063  """.        if c
-00021220: 656c 6c5f 7261 6e67 6520 6973 204e 6f6e  ell_range is Non
-00021230: 653a 0a20 2020 2020 2020 2020 2020 2077  e:.            w
-00021240: 6172 6e28 2743 656c 6c20 7261 6e67 6520  arn('Cell range 
-00021250: 6d75 7374 2062 6520 7370 6563 6966 6965  must be specifie
-00021260: 6420 696e 2075 6e70 726f 7465 6374 5f72  d in unprotect_r
-00021270: 616e 6765 2829 2729 0a20 2020 2020 2020  ange()').       
-00021280: 2020 2020 2072 6574 7572 6e20 2d31 0a0a       return -1..
-00021290: 2020 2020 2020 2020 2320 5361 6e69 7469          # Saniti
-000212a0: 7a65 2074 6865 2063 656c 6c20 7261 6e67  ze the cell rang
-000212b0: 652e 0a20 2020 2020 2020 2063 656c 6c5f  e..        cell_
-000212c0: 7261 6e67 6520 3d20 6365 6c6c 5f72 616e  range = cell_ran
-000212d0: 6765 2e6c 7374 7269 7028 273d 2729 0a20  ge.lstrip('='). 
-000212e0: 2020 2020 2020 2063 656c 6c5f 7261 6e67         cell_rang
-000212f0: 6520 3d20 6365 6c6c 5f72 616e 6765 2e72  e = cell_range.r
-00021300: 6570 6c61 6365 2827 2427 2c20 2727 290a  eplace('$', '').
-00021310: 0a20 2020 2020 2020 2073 656c 662e 6e75  .        self.nu
-00021320: 6d5f 7072 6f74 6563 7465 645f 7261 6e67  m_protected_rang
-00021330: 6573 202b 3d20 310a 0a20 2020 2020 2020  es += 1..       
-00021340: 2069 6620 7261 6e67 655f 6e61 6d65 2069   if range_name i
-00021350: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00021360: 2020 2020 7261 6e67 655f 6e61 6d65 203d      range_name =
-00021370: 2027 5261 6e67 6527 202b 2073 7472 2873   'Range' + str(s
-00021380: 656c 662e 6e75 6d5f 7072 6f74 6563 7465  elf.num_protecte
-00021390: 645f 7261 6e67 6573 290a 0a20 2020 2020  d_ranges)..     
-000213a0: 2020 2069 6620 7061 7373 776f 7264 3a0a     if password:.
-000213b0: 2020 2020 2020 2020 2020 2020 7061 7373              pass
-000213c0: 776f 7264 203d 2073 656c 662e 5f65 6e63  word = self._enc
-000213d0: 6f64 655f 7061 7373 776f 7264 2870 6173  ode_password(pas
-000213e0: 7377 6f72 6429 0a0a 2020 2020 2020 2020  sword)..        
-000213f0: 7365 6c66 2e70 726f 7465 6374 6564 5f72  self.protected_r
-00021400: 616e 6765 732e 6170 7065 6e64 2828 6365  anges.append((ce
-00021410: 6c6c 5f72 616e 6765 2c20 7261 6e67 655f  ll_range, range_
-00021420: 6e61 6d65 2c20 7061 7373 776f 7264 2929  name, password))
-00021430: 0a0a 2020 2020 4063 6f6e 7665 7274 5f63  ..    @convert_c
-00021440: 656c 6c5f 6172 6773 0a20 2020 2064 6566  ell_args.    def
-00021450: 2069 6e73 6572 745f 6275 7474 6f6e 2873   insert_button(s
-00021460: 656c 662c 2072 6f77 2c20 636f 6c2c 206f  elf, row, col, o
-00021470: 7074 696f 6e73 3d4e 6f6e 6529 3a0a 2020  ptions=None):.  
-00021480: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00021490: 2020 496e 7365 7274 2061 2062 7574 746f    Insert a butto
-000214a0: 6e20 666f 726d 206f 626a 6563 7420 696e  n form object in
-000214b0: 746f 2074 6865 2077 6f72 6b73 6865 6574  to the worksheet
-000214c0: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
-000214d0: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
-000214e0: 3a20 2020 2020 5468 6520 6365 6c6c 2072  :     The cell r
-000214f0: 6f77 2028 7a65 726f 2069 6e64 6578 6564  ow (zero indexed
-00021500: 292e 0a20 2020 2020 2020 2020 2020 2063  )..            c
-00021510: 6f6c 3a20 2020 2020 5468 6520 6365 6c6c  ol:     The cell
-00021520: 2063 6f6c 756d 6e20 287a 6572 6f20 696e   column (zero in
-00021530: 6465 7865 6429 2e0a 2020 2020 2020 2020  dexed)..        
-00021540: 2020 2020 6f70 7469 6f6e 733a 2042 7574      options: But
-00021550: 746f 6e20 666f 726d 6174 7469 6e67 206f  ton formatting o
-00021560: 7074 696f 6e73 2e0a 0a20 2020 2020 2020  ptions...       
-00021570: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
-00021580: 2020 2020 2020 303a 2020 5375 6363 6573        0:  Succes
-00021590: 732e 0a20 2020 2020 2020 2020 2020 202d  s..            -
-000215a0: 313a 2052 6f77 206f 7220 636f 6c75 6d6e  1: Row or column
-000215b0: 2069 7320 6f75 7420 6f66 2077 6f72 6b73   is out of works
-000215c0: 6865 6574 2062 6f75 6e64 732e 0a0a 2020  heet bounds...  
-000215d0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000215e0: 2020 2320 4368 6563 6b20 696e 7365 7274    # Check insert
-000215f0: 2028 726f 772c 2063 6f6c 2920 7769 7468   (row, col) with
-00021600: 6f75 7420 7374 6f72 696e 672e 0a20 2020  out storing..   
-00021610: 2020 2020 2069 6620 7365 6c66 2e5f 6368       if self._ch
-00021620: 6563 6b5f 6469 6d65 6e73 696f 6e73 2872  eck_dimensions(r
-00021630: 6f77 2c20 636f 6c2c 2054 7275 652c 2054  ow, col, True, T
-00021640: 7275 6529 3a0a 2020 2020 2020 2020 2020  rue):.          
-00021650: 2020 7761 726e 2827 4361 6e6e 6f74 2069    warn('Cannot i
-00021660: 6e73 6572 7420 6275 7474 6f6e 2061 7420  nsert button at 
-00021670: 2825 642c 2025 6429 2e27 2025 2028 726f  (%d, %d).' % (ro
-00021680: 772c 2063 6f6c 2929 0a20 2020 2020 2020  w, col)).       
-00021690: 2020 2020 2072 6574 7572 6e20 2d31 0a0a       return -1..
-000216a0: 2020 2020 2020 2020 6966 206f 7074 696f          if optio
-000216b0: 6e73 2069 7320 4e6f 6e65 3a0a 2020 2020  ns is None:.    
-000216c0: 2020 2020 2020 2020 6f70 7469 6f6e 7320          options 
-000216d0: 3d20 7b7d 0a0a 2020 2020 2020 2020 6275  = {}..        bu
-000216e0: 7474 6f6e 203d 2073 656c 662e 5f62 7574  tton = self._but
-000216f0: 746f 6e5f 7061 7261 6d73 2872 6f77 2c20  ton_params(row, 
-00021700: 636f 6c2c 206f 7074 696f 6e73 290a 0a20  col, options).. 
-00021710: 2020 2020 2020 2073 656c 662e 6275 7474         self.butt
-00021720: 6f6e 735f 6c69 7374 2e61 7070 656e 6428  ons_list.append(
-00021730: 6275 7474 6f6e 290a 0a20 2020 2020 2020  button)..       
-00021740: 2073 656c 662e 6861 735f 766d 6c20 3d20   self.has_vml = 
-00021750: 310a 0a20 2020 2020 2020 2072 6574 7572  1..        retur
-00021760: 6e20 300a 0a20 2020 2023 2323 2323 2323  n 0..    #######
-00021770: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021780: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021790: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000217a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000217b0: 2323 2323 0a20 2020 2023 0a20 2020 2023  ####.    #.    #
-000217c0: 2050 7562 6c69 6320 4150 492e 2050 6167   Public API. Pag
-000217d0: 6520 5365 7475 7020 6d65 7468 6f64 732e  e Setup methods.
-000217e0: 0a20 2020 2023 0a20 2020 2023 2323 2323  .    #.    #####
-000217f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021800: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021810: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021820: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00021830: 2323 2323 2323 0a20 2020 2064 6566 2073  ######.    def s
-00021840: 6574 5f6c 616e 6473 6361 7065 2873 656c  et_landscape(sel
-00021850: 6629 3a0a 2020 2020 2020 2020 2222 220a  f):.        """.
-00021860: 2020 2020 2020 2020 5365 7420 7468 6520          Set the 
-00021870: 7061 6765 206f 7269 656e 7461 7469 6f6e  page orientation
-00021880: 2061 7320 6c61 6e64 7363 6170 652e 0a0a   as landscape...
-00021890: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
-000218a0: 2020 2020 2020 2020 2020 4e6f 6e65 2e0a            None..
-000218b0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-000218c0: 3a0a 2020 2020 2020 2020 2020 2020 4e6f  :.            No
-000218d0: 7468 696e 672e 0a0a 2020 2020 2020 2020  thing...        
-000218e0: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
-000218f0: 2e6f 7269 656e 7461 7469 6f6e 203d 2030  .orientation = 0
-00021900: 0a20 2020 2020 2020 2073 656c 662e 7061  .        self.pa
-00021910: 6765 5f73 6574 7570 5f63 6861 6e67 6564  ge_setup_changed
-00021920: 203d 2054 7275 650a 0a20 2020 2064 6566   = True..    def
-00021930: 2073 6574 5f70 6f72 7472 6169 7428 7365   set_portrait(se
-00021940: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00021950: 0a20 2020 2020 2020 2053 6574 2074 6865  .        Set the
-00021960: 2070 6167 6520 6f72 6965 6e74 6174 696f   page orientatio
-00021970: 6e20 6173 2070 6f72 7472 6169 742e 0a0a  n as portrait...
-00021980: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
-00021990: 2020 2020 2020 2020 2020 4e6f 6e65 2e0a            None..
-000219a0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-000219b0: 3a0a 2020 2020 2020 2020 2020 2020 4e6f  :.            No
-000219c0: 7468 696e 672e 0a0a 2020 2020 2020 2020  thing...        
-000219d0: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
-000219e0: 2e6f 7269 656e 7461 7469 6f6e 203d 2031  .orientation = 1
-000219f0: 0a20 2020 2020 2020 2073 656c 662e 7061  .        self.pa
-00021a00: 6765 5f73 6574 7570 5f63 6861 6e67 6564  ge_setup_changed
-00021a10: 203d 2054 7275 650a 0a20 2020 2064 6566   = True..    def
-00021a20: 2073 6574 5f70 6167 655f 7669 6577 2873   set_page_view(s
-00021a30: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00021a40: 220a 2020 2020 2020 2020 5365 7420 7468  ".        Set th
-00021a50: 6520 7061 6765 2076 6965 7720 6d6f 6465  e page view mode
-00021a60: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
-00021a70: 0a20 2020 2020 2020 2020 2020 204e 6f6e  .            Non
-00021a80: 652e 0a0a 2020 2020 2020 2020 5265 7475  e...        Retu
-00021a90: 726e 733a 0a20 2020 2020 2020 2020 2020  rns:.           
-00021aa0: 204e 6f74 6869 6e67 2e0a 0a20 2020 2020   Nothing...     
-00021ab0: 2020 2022 2222 0a20 2020 2020 2020 2073     """.        s
-00021ac0: 656c 662e 7061 6765 5f76 6965 7720 3d20  elf.page_view = 
-00021ad0: 310a 0a20 2020 2064 6566 2073 6574 5f70  1..    def set_p
-00021ae0: 6170 6572 2873 656c 662c 2070 6170 6572  aper(self, paper
-00021af0: 5f73 697a 6529 3a0a 2020 2020 2020 2020  _size):.        
-00021b00: 2222 220a 2020 2020 2020 2020 5365 7420  """.        Set 
-00021b10: 7468 6520 7061 7065 7220 7479 7065 2e20  the paper type. 
-00021b20: 5553 204c 6574 7465 7220 3d20 312c 2041  US Letter = 1, A
-00021b30: 3420 3d20 392e 0a0a 2020 2020 2020 2020  4 = 9...        
-00021b40: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
-00021b50: 2020 7061 7065 725f 7369 7a65 3a20 5061    paper_size: Pa
-00021b60: 7065 7220 696e 6465 782e 0a0a 2020 2020  per index...    
-00021b70: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
-00021b80: 2020 2020 2020 2020 204e 6f74 6869 6e67           Nothing
-00021b90: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
-00021ba0: 2020 2020 2020 2069 6620 7061 7065 725f         if paper_
-00021bb0: 7369 7a65 3a0a 2020 2020 2020 2020 2020  size:.          
-00021bc0: 2020 7365 6c66 2e70 6170 6572 5f73 697a    self.paper_siz
-00021bd0: 6520 3d20 7061 7065 725f 7369 7a65 0a20  e = paper_size. 
-00021be0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00021bf0: 7061 6765 5f73 6574 7570 5f63 6861 6e67  page_setup_chang
-00021c00: 6564 203d 2054 7275 650a 0a20 2020 2064  ed = True..    d
-00021c10: 6566 2063 656e 7465 725f 686f 7269 7a6f  ef center_horizo
-00021c20: 6e74 616c 6c79 2873 656c 6629 3a0a 2020  ntally(self):.  
-00021c30: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00021c40: 2020 4365 6e74 6572 2074 6865 2070 6167    Center the pag
-00021c50: 6520 686f 7269 7a6f 6e74 616c 6c79 2e0a  e horizontally..
-00021c60: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
-00021c70: 2020 2020 2020 2020 2020 204e 6f6e 652e             None.
-00021c80: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-00021c90: 733a 0a20 2020 2020 2020 2020 2020 204e  s:.            N
-00021ca0: 6f74 6869 6e67 2e0a 0a20 2020 2020 2020  othing...       
-00021cb0: 2022 2222 0a20 2020 2020 2020 2073 656c   """.        sel
-00021cc0: 662e 7072 696e 745f 6f70 7469 6f6e 735f  f.print_options_
-00021cd0: 6368 616e 6765 6420 3d20 5472 7565 0a20  changed = True. 
-00021ce0: 2020 2020 2020 2073 656c 662e 6863 656e         self.hcen
-00021cf0: 7465 7220 3d20 310a 0a20 2020 2064 6566  ter = 1..    def
-00021d00: 2063 656e 7465 725f 7665 7274 6963 616c   center_vertical
-00021d10: 6c79 2873 656c 6629 3a0a 2020 2020 2020  ly(self):.      
-00021d20: 2020 2222 220a 2020 2020 2020 2020 4365    """.        Ce
-00021d30: 6e74 6572 2074 6865 2070 6167 6520 7665  nter the page ve
-00021d40: 7274 6963 616c 6c79 2e0a 0a20 2020 2020  rtically...     
-00021d50: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-00021d60: 2020 2020 204e 6f6e 652e 0a0a 2020 2020       None...    
-00021d70: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
-00021d80: 2020 2020 2020 2020 204e 6f74 6869 6e67           Nothing
-00021d90: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
-00021da0: 2020 2020 2020 2073 656c 662e 7072 696e         self.prin
-00021db0: 745f 6f70 7469 6f6e 735f 6368 616e 6765  t_options_change
-00021dc0: 6420 3d20 5472 7565 0a20 2020 2020 2020  d = True.       
-00021dd0: 2073 656c 662e 7663 656e 7465 7220 3d20   self.vcenter = 
-00021de0: 310a 0a20 2020 2064 6566 2073 6574 5f6d  1..    def set_m
-00021df0: 6172 6769 6e73 2873 656c 662c 206c 6566  argins(self, lef
-00021e00: 743d 302e 372c 2072 6967 6874 3d30 2e37  t=0.7, right=0.7
-00021e10: 2c20 746f 703d 302e 3735 2c20 626f 7474  , top=0.75, bott
-00021e20: 6f6d 3d30 2e37 3529 3a0a 2020 2020 2020  om=0.75):.      
-00021e30: 2020 2222 220a 2020 2020 2020 2020 5365    """.        Se
-00021e40: 7420 616c 6c20 7468 6520 7061 6765 206d  t all the page m
-00021e50: 6172 6769 6e73 2069 6e20 696e 6368 6573  argins in inches
-00021e60: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
-00021e70: 0a20 2020 2020 2020 2020 2020 206c 6566  .            lef
-00021e80: 743a 2020 204c 6566 7420 6d61 7267 696e  t:   Left margin
-00021e90: 2e0a 2020 2020 2020 2020 2020 2020 7269  ..            ri
-00021ea0: 6768 743a 2020 5269 6768 7420 6d61 7267  ght:  Right marg
-00021eb0: 696e 2e0a 2020 2020 2020 2020 2020 2020  in..            
-00021ec0: 746f 703a 2020 2020 546f 7020 6d61 7267  top:    Top marg
-00021ed0: 696e 2e0a 2020 2020 2020 2020 2020 2020  in..            
-00021ee0: 626f 7474 6f6d 3a20 426f 7474 6f6d 206d  bottom: Bottom m
-00021ef0: 6172 6769 6e2e 0a0a 2020 2020 2020 2020  argin...        
-00021f00: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
-00021f10: 2020 2020 204e 6f74 6869 6e67 2e0a 0a20       Nothing... 
-00021f20: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00021f30: 2020 2073 656c 662e 6d61 7267 696e 5f6c     self.margin_l
-00021f40: 6566 7420 3d20 6c65 6674 0a20 2020 2020  eft = left.     
-00021f50: 2020 2073 656c 662e 6d61 7267 696e 5f72     self.margin_r
-00021f60: 6967 6874 203d 2072 6967 6874 0a20 2020  ight = right.   
-00021f70: 2020 2020 2073 656c 662e 6d61 7267 696e       self.margin
-00021f80: 5f74 6f70 203d 2074 6f70 0a20 2020 2020  _top = top.     
-00021f90: 2020 2073 656c 662e 6d61 7267 696e 5f62     self.margin_b
-00021fa0: 6f74 746f 6d20 3d20 626f 7474 6f6d 0a0a  ottom = bottom..
-00021fb0: 2020 2020 6465 6620 7365 745f 6865 6164      def set_head
-00021fc0: 6572 2873 656c 662c 2068 6561 6465 723d  er(self, header=
-00021fd0: 2727 2c20 6f70 7469 6f6e 733d 4e6f 6e65  '', options=None
-00021fe0: 2c20 6d61 7267 696e 3d4e 6f6e 6529 3a0a  , margin=None):.
-00021ff0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00022000: 2020 2020 5365 7420 7468 6520 7061 6765      Set the page
-00022010: 2068 6561 6465 7220 6361 7074 696f 6e20   header caption 
-00022020: 616e 6420 6f70 7469 6f6e 616c 206d 6172  and optional mar
-00022030: 6769 6e2e 0a0a 2020 2020 2020 2020 4172  gin...        Ar
-00022040: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
-00022050: 6865 6164 6572 3a20 2048 6561 6465 7220  header:  Header 
-00022060: 7374 7269 6e67 2e0a 2020 2020 2020 2020  string..        
-00022070: 2020 2020 6d61 7267 696e 3a20 2048 6561      margin:  Hea
-00022080: 6465 7220 6d61 7267 696e 2e0a 2020 2020  der margin..    
-00022090: 2020 2020 2020 2020 6f70 7469 6f6e 733a          options:
-000220a0: 2048 6561 6465 7220 6f70 7469 6f6e 732c   Header options,
-000220b0: 206d 6169 6e6c 7920 666f 7220 696d 6167   mainly for imag
-000220c0: 6573 2e0a 0a20 2020 2020 2020 2052 6574  es...        Ret
-000220d0: 7572 6e73 3a0a 2020 2020 2020 2020 2020  urns:.          
-000220e0: 2020 4e6f 7468 696e 672e 0a0a 2020 2020    Nothing...    
-000220f0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00022100: 6865 6164 6572 5f6f 7269 6720 3d20 6865  header_orig = he
-00022110: 6164 6572 0a20 2020 2020 2020 2068 6561  ader.        hea
-00022120: 6465 7220 3d20 6865 6164 6572 2e72 6570  der = header.rep
-00022130: 6c61 6365 2827 265b 5069 6374 7572 655d  lace('&[Picture]
-00022140: 272c 2027 2647 2729 0a0a 2020 2020 2020  ', '&G')..      
-00022150: 2020 6966 206c 656e 2868 6561 6465 7229    if len(header)
-00022160: 203e 2032 3535 3a0a 2020 2020 2020 2020   > 255:.        
-00022170: 2020 2020 7761 726e 2822 4865 6164 6572      warn("Header
-00022180: 2073 7472 696e 6720 6361 6e6e 6f74 2062   string cannot b
-00022190: 6520 6c6f 6e67 6572 2074 6861 6e20 4578  e longer than Ex
-000221a0: 6365 6c27 7320 220a 2020 2020 2020 2020  cel's ".        
-000221b0: 2020 2020 2020 2020 2022 6c69 6d69 7420           "limit 
-000221c0: 6f66 2032 3535 2063 6861 7261 6374 6572  of 255 character
-000221d0: 7322 290a 2020 2020 2020 2020 2020 2020  s").            
-000221e0: 7265 7475 726e 0a0a 2020 2020 2020 2020  return..        
-000221f0: 6966 206f 7074 696f 6e73 2069 7320 6e6f  if options is no
-00022200: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00022210: 2020 2020 2320 466f 7220 6261 636b 7761      # For backwa
-00022220: 7264 2063 6f6d 7061 7469 6269 6c69 7479  rd compatibility
-00022230: 2061 6c6c 6f77 206f 7074 696f 6e73 2074   allow options t
-00022240: 6f20 6265 2074 6865 206d 6172 6769 6e2e  o be the margin.
-00022250: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00022260: 6e6f 7420 6973 696e 7374 616e 6365 286f  not isinstance(o
-00022270: 7074 696f 6e73 2c20 6469 6374 293a 0a20  ptions, dict):. 
-00022280: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00022290: 7074 696f 6e73 203d 207b 276d 6172 6769  ptions = {'margi
-000222a0: 6e27 3a20 6f70 7469 6f6e 737d 0a20 2020  n': options}.   
-000222b0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000222c0: 2020 2020 2020 206f 7074 696f 6e73 203d         options =
-000222d0: 207b 7d0a 0a20 2020 2020 2020 2023 2043   {}..        # C
-000222e0: 6f70 7920 7468 6520 7573 6572 2064 6566  opy the user def
-000222f0: 696e 6564 206f 7074 696f 6e73 2073 6f20  ined options so 
-00022300: 7468 6579 2061 7265 6e27 7420 6d6f 6469  they aren't modi
-00022310: 6669 6564 2e0a 2020 2020 2020 2020 6f70  fied..        op
-00022320: 7469 6f6e 7320 3d20 6f70 7469 6f6e 732e  tions = options.
-00022330: 636f 7079 2829 0a0a 2020 2020 2020 2020  copy()..        
-00022340: 2320 466f 7220 6261 636b 7761 7264 2063  # For backward c
-00022350: 6f6d 7061 7469 6269 6c69 7479 2e0a 2020  ompatibility..  
-00022360: 2020 2020 2020 6966 206d 6172 6769 6e20        if margin 
-00022370: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00022380: 2020 2020 2020 2020 206f 7074 696f 6e73           options
-00022390: 5b27 6d61 7267 696e 275d 203d 206d 6172  ['margin'] = mar
-000223a0: 6769 6e0a 0a20 2020 2020 2020 2023 2052  gin..        # R
-000223b0: 6573 6574 2074 6865 206c 6973 7420 696e  eset the list in
-000223c0: 2063 6173 6520 7468 6520 6675 6e63 7469   case the functi
-000223d0: 6f6e 2069 7320 6361 6c6c 6564 206d 6f72  on is called mor
-000223e0: 6520 7468 616e 206f 6e63 652e 0a20 2020  e than once..   
-000223f0: 2020 2020 2073 656c 662e 6865 6164 6572       self.header
-00022400: 5f69 6d61 6765 7320 3d20 5b5d 0a0a 2020  _images = []..  
-00022410: 2020 2020 2020 6966 206f 7074 696f 6e73        if options
-00022420: 2e67 6574 2827 696d 6167 655f 6c65 6674  .get('image_left
-00022430: 2729 3a0a 2020 2020 2020 2020 2020 2020  '):.            
-00022440: 7365 6c66 2e68 6561 6465 725f 696d 6167  self.header_imag
-00022450: 6573 2e61 7070 656e 6428 5b6f 7074 696f  es.append([optio
-00022460: 6e73 2e67 6574 2827 696d 6167 655f 6c65  ns.get('image_le
-00022470: 6674 2729 2c0a 2020 2020 2020 2020 2020  ft'),.          
-00022480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022490: 2020 2020 2020 2020 2020 2020 206f 7074               opt
-000224a0: 696f 6e73 2e67 6574 2827 696d 6167 655f  ions.get('image_
-000224b0: 6461 7461 5f6c 6566 7427 292c 0a20 2020  data_left'),.   
-000224c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000224d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000224e0: 2020 2020 274c 4827 5d29 0a0a 2020 2020      'LH'])..    
-000224f0: 2020 2020 6966 206f 7074 696f 6e73 2e67      if options.g
-00022500: 6574 2827 696d 6167 655f 6365 6e74 6572  et('image_center
-00022510: 2729 3a0a 2020 2020 2020 2020 2020 2020  '):.            
-00022520: 7365 6c66 2e68 6561 6465 725f 696d 6167  self.header_imag
-00022530: 6573 2e61 7070 656e 6428 5b6f 7074 696f  es.append([optio
-00022540: 6e73 2e67 6574 2827 696d 6167 655f 6365  ns.get('image_ce
-00022550: 6e74 6572 2729 2c0a 2020 2020 2020 2020  nter'),.        
-00022560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022570: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00022580: 7074 696f 6e73 2e67 6574 2827 696d 6167  ptions.get('imag
-00022590: 655f 6461 7461 5f63 656e 7465 7227 292c  e_data_center'),
-000225a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000225b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000225c0: 2020 2020 2020 2020 2743 4827 5d29 0a0a          'CH'])..
-000225d0: 2020 2020 2020 2020 6966 206f 7074 696f          if optio
-000225e0: 6e73 2e67 6574 2827 696d 6167 655f 7269  ns.get('image_ri
-000225f0: 6768 7427 293a 0a20 2020 2020 2020 2020  ght'):.         
-00022600: 2020 2073 656c 662e 6865 6164 6572 5f69     self.header_i
-00022610: 6d61 6765 732e 6170 7065 6e64 285b 6f70  mages.append([op
-00022620: 7469 6f6e 732e 6765 7428 2769 6d61 6765  tions.get('image
-00022630: 5f72 6967 6874 2729 2c0a 2020 2020 2020  _right'),.      
-00022640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022660: 206f 7074 696f 6e73 2e67 6574 2827 696d   options.get('im
-00022670: 6167 655f 6461 7461 5f72 6967 6874 2729  age_data_right')
-00022680: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00022690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000226a0: 2020 2020 2020 2020 2027 5248 275d 290a           'RH']).
-000226b0: 0a20 2020 2020 2020 2070 6c61 6365 686f  .        placeho
-000226c0: 6c64 6572 5f63 6f75 6e74 203d 2068 6561  lder_count = hea
-000226d0: 6465 722e 636f 756e 7428 2726 4727 290a  der.count('&G').
-000226e0: 2020 2020 2020 2020 696d 6167 655f 636f          image_co
-000226f0: 756e 7420 3d20 6c65 6e28 7365 6c66 2e68  unt = len(self.h
-00022700: 6561 6465 725f 696d 6167 6573 290a 0a20  eader_images).. 
-00022710: 2020 2020 2020 2069 6620 706c 6163 6568         if placeh
-00022720: 6f6c 6465 725f 636f 756e 7420 213d 2069  older_count != i
-00022730: 6d61 6765 5f63 6f75 6e74 3a0a 2020 2020  mage_count:.    
-00022740: 2020 2020 2020 2020 7761 726e 2822 4e75          warn("Nu
-00022750: 6d62 6572 206f 6620 6865 6164 6572 2069  mber of header i
-00022760: 6d61 6765 7320 2825 7329 2064 6f65 736e  mages (%s) doesn
-00022770: 2774 206d 6174 6368 2070 6c61 6365 686f  't match placeho
-00022780: 6c64 6572 2022 0a20 2020 2020 2020 2020  lder ".         
-00022790: 2020 2020 2020 2020 2263 6f75 6e74 2028          "count (
-000227a0: 2573 2920 696e 2073 7472 696e 673a 2025  %s) in string: %
-000227b0: 7322 0a20 2020 2020 2020 2020 2020 2020  s".             
-000227c0: 2020 2020 2520 2869 6d61 6765 5f63 6f75      % (image_cou
-000227d0: 6e74 2c20 706c 6163 6568 6f6c 6465 725f  nt, placeholder_
-000227e0: 636f 756e 742c 2068 6561 6465 725f 6f72  count, header_or
-000227f0: 6967 2929 0a20 2020 2020 2020 2020 2020  ig)).           
-00022800: 2073 656c 662e 6865 6164 6572 5f69 6d61   self.header_ima
-00022810: 6765 7320 3d20 5b5d 0a20 2020 2020 2020  ges = [].       
-00022820: 2020 2020 2072 6574 7572 6e0a 0a20 2020       return..   
-00022830: 2020 2020 2069 6620 2761 6c69 676e 5f77       if 'align_w
-00022840: 6974 685f 6d61 7267 696e 7327 2069 6e20  ith_margins' in 
-00022850: 6f70 7469 6f6e 733a 0a20 2020 2020 2020  options:.       
-00022860: 2020 2020 2073 656c 662e 6865 6164 6572       self.header
-00022870: 5f66 6f6f 7465 725f 616c 6967 6e73 203d  _footer_aligns =
-00022880: 206f 7074 696f 6e73 5b27 616c 6967 6e5f   options['align_
-00022890: 7769 7468 5f6d 6172 6769 6e73 275d 0a0a  with_margins']..
-000228a0: 2020 2020 2020 2020 6966 2027 7363 616c          if 'scal
-000228b0: 655f 7769 7468 5f64 6f63 2720 696e 206f  e_with_doc' in o
-000228c0: 7074 696f 6e73 3a0a 2020 2020 2020 2020  ptions:.        
-000228d0: 2020 2020 7365 6c66 2e68 6561 6465 725f      self.header_
-000228e0: 666f 6f74 6572 5f73 6361 6c65 7320 3d20  footer_scales = 
-000228f0: 6f70 7469 6f6e 735b 2773 6361 6c65 5f77  options['scale_w
-00022900: 6974 685f 646f 6327 5d0a 0a20 2020 2020  ith_doc']..     
-00022910: 2020 2073 656c 662e 6865 6164 6572 203d     self.header =
-00022920: 2068 6561 6465 720a 2020 2020 2020 2020   header.        
-00022930: 7365 6c66 2e6d 6172 6769 6e5f 6865 6164  self.margin_head
-00022940: 6572 203d 206f 7074 696f 6e73 2e67 6574  er = options.get
-00022950: 2827 6d61 7267 696e 272c 2030 2e33 290a  ('margin', 0.3).
-00022960: 2020 2020 2020 2020 7365 6c66 2e68 6561          self.hea
-00022970: 6465 725f 666f 6f74 6572 5f63 6861 6e67  der_footer_chang
-00022980: 6564 203d 2054 7275 650a 0a20 2020 2020  ed = True..     
-00022990: 2020 2069 6620 696d 6167 655f 636f 756e     if image_coun
-000229a0: 743a 0a20 2020 2020 2020 2020 2020 2073  t:.            s
-000229b0: 656c 662e 6861 735f 6865 6164 6572 5f76  elf.has_header_v
-000229c0: 6d6c 203d 2054 7275 650a 0a20 2020 2064  ml = True..    d
-000229d0: 6566 2073 6574 5f66 6f6f 7465 7228 7365  ef set_footer(se
-000229e0: 6c66 2c20 666f 6f74 6572 3d27 272c 206f  lf, footer='', o
-000229f0: 7074 696f 6e73 3d4e 6f6e 652c 206d 6172  ptions=None, mar
-00022a00: 6769 6e3d 4e6f 6e65 293a 0a20 2020 2020  gin=None):.     
-00022a10: 2020 2022 2222 0a20 2020 2020 2020 2053     """.        S
-00022a20: 6574 2074 6865 2070 6167 6520 666f 6f74  et the page foot
-00022a30: 6572 2063 6170 7469 6f6e 2061 6e64 206f  er caption and o
-00022a40: 7074 696f 6e61 6c20 6d61 7267 696e 2e0a  ptional margin..
-00022a50: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
-00022a60: 2020 2020 2020 2020 2020 2066 6f6f 7465             foote
-00022a70: 723a 2020 466f 6f74 6572 2073 7472 696e  r:  Footer strin
-00022a80: 672e 0a20 2020 2020 2020 2020 2020 206d  g..            m
-00022a90: 6172 6769 6e3a 2020 466f 6f74 6572 206d  argin:  Footer m
-00022aa0: 6172 6769 6e2e 0a20 2020 2020 2020 2020  argin..         
-00022ab0: 2020 206f 7074 696f 6e73 3a20 466f 6f74     options: Foot
-00022ac0: 6572 206f 7074 696f 6e73 2c20 6d61 696e  er options, main
-00022ad0: 6c79 2066 6f72 2069 6d61 6765 732e 0a0a  ly for images...
-00022ae0: 2020 2020 2020 2020 5265 7475 726e 733a          Returns:
-00022af0: 0a20 2020 2020 2020 2020 2020 204e 6f74  .            Not
-00022b00: 6869 6e67 2e0a 0a20 2020 2020 2020 2022  hing...        "
-00022b10: 2222 0a20 2020 2020 2020 2066 6f6f 7465  "".        foote
-00022b20: 725f 6f72 6967 203d 2066 6f6f 7465 720a  r_orig = footer.
-00022b30: 2020 2020 2020 2020 666f 6f74 6572 203d          footer =
-00022b40: 2066 6f6f 7465 722e 7265 706c 6163 6528   footer.replace(
-00022b50: 2726 5b50 6963 7475 7265 5d27 2c20 2726  '&[Picture]', '&
-00022b60: 4727 290a 0a20 2020 2020 2020 2069 6620  G')..        if 
-00022b70: 6c65 6e28 666f 6f74 6572 2920 3e20 3235  len(footer) > 25
-00022b80: 353a 0a20 2020 2020 2020 2020 2020 2077  5:.            w
-00022b90: 6172 6e28 2246 6f6f 7465 7220 7374 7269  arn("Footer stri
-00022ba0: 6e67 2063 616e 6e6f 7420 6265 206c 6f6e  ng cannot be lon
-00022bb0: 6765 7220 7468 616e 2045 7863 656c 2773  ger than Excel's
-00022bc0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-00022bd0: 2020 2020 226c 696d 6974 206f 6620 3235      "limit of 25
-00022be0: 3520 6368 6172 6163 7465 7273 2229 0a20  5 characters"). 
-00022bf0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00022c00: 6e0a 0a20 2020 2020 2020 2069 6620 6f70  n..        if op
-00022c10: 7469 6f6e 7320 6973 206e 6f74 204e 6f6e  tions is not Non
-00022c20: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
-00022c30: 2046 6f72 2062 6163 6b77 6172 6420 636f   For backward co
-00022c40: 6d70 6174 6962 696c 6974 7920 616c 6c6f  mpatibility allo
-00022c50: 7720 6f70 7469 6f6e 7320 746f 2062 6520  w options to be 
-00022c60: 7468 6520 6d61 7267 696e 2e0a 2020 2020  the margin..    
-00022c70: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
-00022c80: 7369 6e73 7461 6e63 6528 6f70 7469 6f6e  sinstance(option
-00022c90: 732c 2064 6963 7429 3a0a 2020 2020 2020  s, dict):.      
-00022ca0: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
-00022cb0: 7320 3d20 7b27 6d61 7267 696e 273a 206f  s = {'margin': o
-00022cc0: 7074 696f 6e73 7d0a 2020 2020 2020 2020  ptions}.        
-00022cd0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00022ce0: 2020 6f70 7469 6f6e 7320 3d20 7b7d 0a0a    options = {}..
-00022cf0: 2020 2020 2020 2020 2320 436f 7079 2074          # Copy t
-00022d00: 6865 2075 7365 7220 6465 6669 6e65 6420  he user defined 
-00022d10: 6f70 7469 6f6e 7320 736f 2074 6865 7920  options so they 
-00022d20: 6172 656e 2774 206d 6f64 6966 6965 642e  aren't modified.
-00022d30: 0a20 2020 2020 2020 206f 7074 696f 6e73  .        options
-00022d40: 203d 206f 7074 696f 6e73 2e63 6f70 7928   = options.copy(
-00022d50: 290a 0a20 2020 2020 2020 2023 2046 6f72  )..        # For
-00022d60: 2062 6163 6b77 6172 6420 636f 6d70 6174   backward compat
-00022d70: 6962 696c 6974 792e 0a20 2020 2020 2020  ibility..       
-00022d80: 2069 6620 6d61 7267 696e 2069 7320 6e6f   if margin is no
-00022d90: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00022da0: 2020 2020 6f70 7469 6f6e 735b 276d 6172      options['mar
-00022db0: 6769 6e27 5d20 3d20 6d61 7267 696e 0a0a  gin'] = margin..
-00022dc0: 2020 2020 2020 2020 2320 5265 7365 7420          # Reset 
-00022dd0: 7468 6520 6c69 7374 2069 6e20 6361 7365  the list in case
-00022de0: 2074 6865 2066 756e 6374 696f 6e20 6973   the function is
-00022df0: 2063 616c 6c65 6420 6d6f 7265 2074 6861   called more tha
-00022e00: 6e20 6f6e 6365 2e0a 2020 2020 2020 2020  n once..        
-00022e10: 7365 6c66 2e66 6f6f 7465 725f 696d 6167  self.footer_imag
-00022e20: 6573 203d 205b 5d0a 0a20 2020 2020 2020  es = []..       
-00022e30: 2069 6620 6f70 7469 6f6e 732e 6765 7428   if options.get(
-00022e40: 2769 6d61 6765 5f6c 6566 7427 293a 0a20  'image_left'):. 
-00022e50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00022e60: 666f 6f74 6572 5f69 6d61 6765 732e 6170  footer_images.ap
-00022e70: 7065 6e64 285b 6f70 7469 6f6e 732e 6765  pend([options.ge
-00022e80: 7428 2769 6d61 6765 5f6c 6566 7427 292c  t('image_left'),
-00022e90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022eb0: 2020 2020 2020 2020 6f70 7469 6f6e 732e          options.
-00022ec0: 6765 7428 2769 6d61 6765 5f64 6174 615f  get('image_data_
-00022ed0: 6c65 6674 2729 2c0a 2020 2020 2020 2020  left'),.        
-00022ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022ef0: 2020 2020 2020 2020 2020 2020 2020 2027                 '
-00022f00: 4c46 275d 290a 0a20 2020 2020 2020 2069  LF'])..        i
-00022f10: 6620 6f70 7469 6f6e 732e 6765 7428 2769  f options.get('i
-00022f20: 6d61 6765 5f63 656e 7465 7227 293a 0a20  mage_center'):. 
-00022f30: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00022f40: 666f 6f74 6572 5f69 6d61 6765 732e 6170  footer_images.ap
-00022f50: 7065 6e64 285b 6f70 7469 6f6e 732e 6765  pend([options.ge
-00022f60: 7428 2769 6d61 6765 5f63 656e 7465 7227  t('image_center'
-00022f70: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00022f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022f90: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
-00022fa0: 732e 6765 7428 2769 6d61 6765 5f64 6174  s.get('image_dat
-00022fb0: 615f 6365 6e74 6572 2729 2c0a 2020 2020  a_center'),.    
-00022fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022fe0: 2020 2027 4346 275d 290a 0a20 2020 2020     'CF'])..     
-00022ff0: 2020 2069 6620 6f70 7469 6f6e 732e 6765     if options.ge
-00023000: 7428 2769 6d61 6765 5f72 6967 6874 2729  t('image_right')
-00023010: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00023020: 6c66 2e66 6f6f 7465 725f 696d 6167 6573  lf.footer_images
-00023030: 2e61 7070 656e 6428 5b6f 7074 696f 6e73  .append([options
-00023040: 2e67 6574 2827 696d 6167 655f 7269 6768  .get('image_righ
-00023050: 7427 292c 0a20 2020 2020 2020 2020 2020  t'),.           
-00023060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023070: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
-00023080: 6f6e 732e 6765 7428 2769 6d61 6765 5f64  ons.get('image_d
-00023090: 6174 615f 7269 6768 7427 292c 0a20 2020  ata_right'),.   
-000230a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000230b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000230c0: 2020 2020 2752 4627 5d29 0a0a 2020 2020      'RF'])..    
-000230d0: 2020 2020 706c 6163 6568 6f6c 6465 725f      placeholder_
-000230e0: 636f 756e 7420 3d20 666f 6f74 6572 2e63  count = footer.c
-000230f0: 6f75 6e74 2827 2647 2729 0a20 2020 2020  ount('&G').     
-00023100: 2020 2069 6d61 6765 5f63 6f75 6e74 203d     image_count =
-00023110: 206c 656e 2873 656c 662e 666f 6f74 6572   len(self.footer
-00023120: 5f69 6d61 6765 7329 0a0a 2020 2020 2020  _images)..      
-00023130: 2020 6966 2070 6c61 6365 686f 6c64 6572    if placeholder
-00023140: 5f63 6f75 6e74 2021 3d20 696d 6167 655f  _count != image_
-00023150: 636f 756e 743a 0a20 2020 2020 2020 2020  count:.         
-00023160: 2020 2077 6172 6e28 224e 756d 6265 7220     warn("Number 
-00023170: 6f66 2066 6f6f 7465 7220 696d 6167 6573  of footer images
-00023180: 2028 2573 2920 646f 6573 6e27 7420 6d61   (%s) doesn't ma
-00023190: 7463 6820 706c 6163 6568 6f6c 6465 7220  tch placeholder 
-000231a0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-000231b0: 2020 2022 636f 756e 7420 2825 7329 2069     "count (%s) i
-000231c0: 6e20 7374 7269 6e67 3a20 2573 220a 2020  n string: %s".  
-000231d0: 2020 2020 2020 2020 2020 2020 2020 2025                 %
-000231e0: 2028 696d 6167 655f 636f 756e 742c 2070   (image_count, p
-000231f0: 6c61 6365 686f 6c64 6572 5f63 6f75 6e74  laceholder_count
-00023200: 2c20 666f 6f74 6572 5f6f 7269 6729 290a  , footer_orig)).
-00023210: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00023220: 2e66 6f6f 7465 725f 696d 6167 6573 203d  .footer_images =
-00023230: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
-00023240: 7265 7475 726e 0a0a 2020 2020 2020 2020  return..        
-00023250: 6966 2027 616c 6967 6e5f 7769 7468 5f6d  if 'align_with_m
-00023260: 6172 6769 6e73 2720 696e 206f 7074 696f  argins' in optio
-00023270: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
-00023280: 7365 6c66 2e68 6561 6465 725f 666f 6f74  self.header_foot
-00023290: 6572 5f61 6c69 676e 7320 3d20 6f70 7469  er_aligns = opti
-000232a0: 6f6e 735b 2761 6c69 676e 5f77 6974 685f  ons['align_with_
-000232b0: 6d61 7267 696e 7327 5d0a 0a20 2020 2020  margins']..     
-000232c0: 2020 2069 6620 2773 6361 6c65 5f77 6974     if 'scale_wit
-000232d0: 685f 646f 6327 2069 6e20 6f70 7469 6f6e  h_doc' in option
-000232e0: 733a 0a20 2020 2020 2020 2020 2020 2073  s:.            s
-000232f0: 656c 662e 6865 6164 6572 5f66 6f6f 7465  elf.header_foote
-00023300: 725f 7363 616c 6573 203d 206f 7074 696f  r_scales = optio
-00023310: 6e73 5b27 7363 616c 655f 7769 7468 5f64  ns['scale_with_d
-00023320: 6f63 275d 0a0a 2020 2020 2020 2020 7365  oc']..        se
-00023330: 6c66 2e66 6f6f 7465 7220 3d20 666f 6f74  lf.footer = foot
-00023340: 6572 0a20 2020 2020 2020 2073 656c 662e  er.        self.
-00023350: 6d61 7267 696e 5f66 6f6f 7465 7220 3d20  margin_footer = 
-00023360: 6f70 7469 6f6e 732e 6765 7428 276d 6172  options.get('mar
-00023370: 6769 6e27 2c20 302e 3329 0a20 2020 2020  gin', 0.3).     
-00023380: 2020 2073 656c 662e 6865 6164 6572 5f66     self.header_f
-00023390: 6f6f 7465 725f 6368 616e 6765 6420 3d20  ooter_changed = 
-000233a0: 5472 7565 0a0a 2020 2020 2020 2020 6966  True..        if
-000233b0: 2069 6d61 6765 5f63 6f75 6e74 3a0a 2020   image_count:.  
-000233c0: 2020 2020 2020 2020 2020 7365 6c66 2e68            self.h
-000233d0: 6173 5f68 6561 6465 725f 766d 6c20 3d20  as_header_vml = 
-000233e0: 5472 7565 0a0a 2020 2020 6465 6620 7265  True..    def re
-000233f0: 7065 6174 5f72 6f77 7328 7365 6c66 2c20  peat_rows(self, 
-00023400: 6669 7273 745f 726f 772c 206c 6173 745f  first_row, last_
-00023410: 726f 773d 4e6f 6e65 293a 0a20 2020 2020  row=None):.     
-00023420: 2020 2022 2222 0a20 2020 2020 2020 2053     """.        S
-00023430: 6574 2074 6865 2072 6f77 7320 746f 2072  et the rows to r
-00023440: 6570 6561 7420 6174 2074 6865 2074 6f70  epeat at the top
-00023450: 206f 6620 6561 6368 2070 7269 6e74 6564   of each printed
-00023460: 2070 6167 652e 0a0a 2020 2020 2020 2020   page...        
-00023470: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
-00023480: 2020 6669 7273 745f 726f 773a 2053 7461    first_row: Sta
-00023490: 7274 2072 6f77 2066 6f72 2072 616e 6765  rt row for range
-000234a0: 2e0a 2020 2020 2020 2020 2020 2020 6c61  ..            la
-000234b0: 7374 5f72 6f77 3a20 456e 6420 726f 7720  st_row: End row 
-000234c0: 666f 7220 7261 6e67 652e 0a0a 2020 2020  for range...    
-000234d0: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
-000234e0: 2020 2020 2020 2020 204e 6f74 6869 6e67           Nothing
-000234f0: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
-00023500: 2020 2020 2020 2069 6620 6c61 7374 5f72         if last_r
-00023510: 6f77 2069 7320 4e6f 6e65 3a0a 2020 2020  ow is None:.    
-00023520: 2020 2020 2020 2020 6c61 7374 5f72 6f77          last_row
-00023530: 203d 2066 6972 7374 5f72 6f77 0a0a 2020   = first_row..  
-00023540: 2020 2020 2020 2320 436f 6e76 6572 7420        # Convert 
-00023550: 726f 7773 2074 6f20 3120 6261 7365 642e  rows to 1 based.
-00023560: 0a20 2020 2020 2020 2066 6972 7374 5f72  .        first_r
-00023570: 6f77 202b 3d20 310a 2020 2020 2020 2020  ow += 1.        
-00023580: 6c61 7374 5f72 6f77 202b 3d20 310a 0a20  last_row += 1.. 
-00023590: 2020 2020 2020 2023 2043 7265 6174 6520         # Create 
-000235a0: 7468 6520 726f 7720 7261 6e67 6520 6172  the row range ar
-000235b0: 6561 206c 696b 653a 2024 313a 2432 2e0a  ea like: $1:$2..
-000235c0: 2020 2020 2020 2020 6172 6561 203d 2027          area = '
-000235d0: 2425 643a 2425 6427 2025 2028 6669 7273  $%d:$%d' % (firs
-000235e0: 745f 726f 772c 206c 6173 745f 726f 7729  t_row, last_row)
-000235f0: 0a0a 2020 2020 2020 2020 2320 4275 696c  ..        # Buil
-00023600: 6420 7570 2074 6865 2070 7269 6e74 2074  d up the print t
-00023610: 6974 6c65 7320 6172 6561 2022 5368 6565  itles area "Shee
-00023620: 7431 2124 313a 2432 220a 2020 2020 2020  t1!$1:$2".      
-00023630: 2020 7368 6565 746e 616d 6520 3d20 7175    sheetname = qu
-00023640: 6f74 655f 7368 6565 746e 616d 6528 7365  ote_sheetname(se
-00023650: 6c66 2e6e 616d 6529 0a20 2020 2020 2020  lf.name).       
-00023660: 2073 656c 662e 7265 7065 6174 5f72 6f77   self.repeat_row
-00023670: 5f72 616e 6765 203d 2073 6865 6574 6e61  _range = sheetna
-00023680: 6d65 202b 2027 2127 202b 2061 7265 610a  me + '!' + area.
-00023690: 0a20 2020 2040 636f 6e76 6572 745f 636f  .    @convert_co
-000236a0: 6c75 6d6e 5f61 7267 730a 2020 2020 6465  lumn_args.    de
-000236b0: 6620 7265 7065 6174 5f63 6f6c 756d 6e73  f repeat_columns
-000236c0: 2873 656c 662c 2066 6972 7374 5f63 6f6c  (self, first_col
-000236d0: 2c20 6c61 7374 5f63 6f6c 3d4e 6f6e 6529  , last_col=None)
-000236e0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-000236f0: 2020 2020 2020 5365 7420 7468 6520 636f        Set the co
-00023700: 6c75 6d6e 7320 746f 2072 6570 6561 7420  lumns to repeat 
-00023710: 6174 2074 6865 206c 6566 7420 6861 6e64  at the left hand
-00023720: 2073 6964 6520 6f66 2065 6163 6820 7072   side of each pr
-00023730: 696e 7465 6420 7061 6765 2e0a 0a20 2020  inted page...   
-00023740: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
-00023750: 2020 2020 2020 2066 6972 7374 5f63 6f6c         first_col
-00023760: 3a20 5374 6172 7420 636f 6c75 6d6e 2066  : Start column f
-00023770: 6f72 2072 616e 6765 2e0a 2020 2020 2020  or range..      
-00023780: 2020 2020 2020 6c61 7374 5f63 6f6c 3a20        last_col: 
-00023790: 456e 6420 636f 6c75 6d6e 2066 6f72 2072  End column for r
-000237a0: 616e 6765 2e0a 0a20 2020 2020 2020 2052  ange...        R
-000237b0: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
-000237c0: 2020 2020 4e6f 7468 696e 672e 0a0a 2020      Nothing...  
-000237d0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000237e0: 2020 6966 206c 6173 745f 636f 6c20 6973    if last_col is
-000237f0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00023800: 2020 206c 6173 745f 636f 6c20 3d20 6669     last_col = fi
-00023810: 7273 745f 636f 6c0a 0a20 2020 2020 2020  rst_col..       
-00023820: 2023 2043 6f6e 7665 7274 2074 6f20 4120   # Convert to A 
-00023830: 6e6f 7461 7469 6f6e 2e0a 2020 2020 2020  notation..      
-00023840: 2020 6669 7273 745f 636f 6c20 3d20 786c    first_col = xl
-00023850: 5f63 6f6c 5f74 6f5f 6e61 6d65 2866 6972  _col_to_name(fir
-00023860: 7374 5f63 6f6c 2c20 3129 0a20 2020 2020  st_col, 1).     
-00023870: 2020 206c 6173 745f 636f 6c20 3d20 786c     last_col = xl
-00023880: 5f63 6f6c 5f74 6f5f 6e61 6d65 286c 6173  _col_to_name(las
-00023890: 745f 636f 6c2c 2031 290a 0a20 2020 2020  t_col, 1)..     
-000238a0: 2020 2023 2043 7265 6174 6520 6120 636f     # Create a co
-000238b0: 6c75 6d6e 2072 616e 6765 206c 696b 6520  lumn range like 
-000238c0: 2443 3a24 442e 0a20 2020 2020 2020 2061  $C:$D..        a
-000238d0: 7265 6120 3d20 6669 7273 745f 636f 6c20  rea = first_col 
-000238e0: 2b20 273a 2720 2b20 6c61 7374 5f63 6f6c  + ':' + last_col
-000238f0: 0a0a 2020 2020 2020 2020 2320 4275 696c  ..        # Buil
-00023900: 6420 7570 2074 6865 2070 7269 6e74 2061  d up the print a
-00023910: 7265 6120 7261 6e67 6520 223d 5368 6565  rea range "=Shee
-00023920: 7432 2124 433a 2444 220a 2020 2020 2020  t2!$C:$D".      
-00023930: 2020 7368 6565 746e 616d 6520 3d20 7175    sheetname = qu
-00023940: 6f74 655f 7368 6565 746e 616d 6528 7365  ote_sheetname(se
-00023950: 6c66 2e6e 616d 6529 0a20 2020 2020 2020  lf.name).       
-00023960: 2073 656c 662e 7265 7065 6174 5f63 6f6c   self.repeat_col
-00023970: 5f72 616e 6765 203d 2073 6865 6574 6e61  _range = sheetna
-00023980: 6d65 202b 2022 2122 202b 2061 7265 610a  me + "!" + area.
-00023990: 0a20 2020 2064 6566 2068 6964 655f 6772  .    def hide_gr
-000239a0: 6964 6c69 6e65 7328 7365 6c66 2c20 6f70  idlines(self, op
-000239b0: 7469 6f6e 3d31 293a 0a20 2020 2020 2020  tion=1):.       
-000239c0: 2022 2222 0a20 2020 2020 2020 2053 6574   """.        Set
-000239d0: 2074 6865 206f 7074 696f 6e20 746f 2068   the option to h
-000239e0: 6964 6520 6772 6964 6c69 6e65 7320 6f6e  ide gridlines on
-000239f0: 2074 6865 2073 6372 6565 6e20 616e 6420   the screen and 
-00023a00: 7468 6520 7072 696e 7465 6420 7061 6765  the printed page
-00023a10: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
-00023a20: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
-00023a30: 696f 6e3a 2020 2020 3020 3a20 446f 6e27  ion:    0 : Don'
-00023a40: 7420 6869 6465 2067 7269 646c 696e 6573  t hide gridlines
-00023a50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023a60: 2020 2020 2020 2020 3120 3a20 4869 6465          1 : Hide
-00023a70: 2070 7269 6e74 6564 2067 7269 646c 696e   printed gridlin
-00023a80: 6573 206f 6e6c 790a 2020 2020 2020 2020  es only.        
-00023a90: 2020 2020 2020 2020 2020 2020 2020 2032                 2
-00023aa0: 203a 2048 6964 6520 7363 7265 656e 2061   : Hide screen a
-00023ab0: 6e64 2070 7269 6e74 6564 2067 7269 646c  nd printed gridl
-00023ac0: 696e 6573 0a0a 2020 2020 2020 2020 5265  ines..        Re
-00023ad0: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
-00023ae0: 2020 204e 6f74 6869 6e67 2e0a 0a20 2020     Nothing...   
-00023af0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00023b00: 2069 6620 6f70 7469 6f6e 203d 3d20 303a   if option == 0:
-00023b10: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00023b20: 662e 7072 696e 745f 6772 6964 6c69 6e65  f.print_gridline
-00023b30: 7320 3d20 310a 2020 2020 2020 2020 2020  s = 1.          
-00023b40: 2020 7365 6c66 2e73 6372 6565 6e5f 6772    self.screen_gr
-00023b50: 6964 6c69 6e65 7320 3d20 310a 2020 2020  idlines = 1.    
-00023b60: 2020 2020 2020 2020 7365 6c66 2e70 7269          self.pri
-00023b70: 6e74 5f6f 7074 696f 6e73 5f63 6861 6e67  nt_options_chang
-00023b80: 6564 203d 2054 7275 650a 2020 2020 2020  ed = True.      
-00023b90: 2020 656c 6966 206f 7074 696f 6e20 3d3d    elif option ==
-00023ba0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-00023bb0: 7365 6c66 2e70 7269 6e74 5f67 7269 646c  self.print_gridl
-00023bc0: 696e 6573 203d 2030 0a20 2020 2020 2020  ines = 0.       
-00023bd0: 2020 2020 2073 656c 662e 7363 7265 656e       self.screen
-00023be0: 5f67 7269 646c 696e 6573 203d 2031 0a20  _gridlines = 1. 
-00023bf0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00023c00: 2020 2020 2020 2020 2073 656c 662e 7072           self.pr
-00023c10: 696e 745f 6772 6964 6c69 6e65 7320 3d20  int_gridlines = 
-00023c20: 300a 2020 2020 2020 2020 2020 2020 7365  0.            se
-00023c30: 6c66 2e73 6372 6565 6e5f 6772 6964 6c69  lf.screen_gridli
-00023c40: 6e65 7320 3d20 300a 0a20 2020 2064 6566  nes = 0..    def
-00023c50: 2070 7269 6e74 5f72 6f77 5f63 6f6c 5f68   print_row_col_h
-00023c60: 6561 6465 7273 2873 656c 6629 3a0a 2020  eaders(self):.  
-00023c70: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00023c80: 2020 5365 7420 7468 6520 6f70 7469 6f6e    Set the option
-00023c90: 2074 6f20 7072 696e 7420 7468 6520 726f   to print the ro
-00023ca0: 7720 616e 6420 636f 6c75 6d6e 2068 6561  w and column hea
-00023cb0: 6465 7273 206f 6e20 7468 6520 7072 696e  ders on the prin
-00023cc0: 7465 6420 7061 6765 2e0a 0a20 2020 2020  ted page...     
-00023cd0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-00023ce0: 2020 2020 204e 6f6e 652e 0a0a 2020 2020       None...    
-00023cf0: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
-00023d00: 2020 2020 2020 2020 204e 6f74 6869 6e67           Nothing
-00023d10: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
-00023d20: 2020 2020 2020 2073 656c 662e 7072 696e         self.prin
-00023d30: 745f 6865 6164 6572 7320 3d20 5472 7565  t_headers = True
-00023d40: 0a20 2020 2020 2020 2073 656c 662e 7072  .        self.pr
-00023d50: 696e 745f 6f70 7469 6f6e 735f 6368 616e  int_options_chan
-00023d60: 6765 6420 3d20 5472 7565 0a0a 2020 2020  ged = True..    
-00023d70: 6465 6620 6869 6465 5f72 6f77 5f63 6f6c  def hide_row_col
-00023d80: 5f68 6561 6465 7273 2873 656c 6629 3a0a  _headers(self):.
-00023d90: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00023da0: 2020 2020 5365 7420 7468 6520 6f70 7469      Set the opti
-00023db0: 6f6e 2074 6f20 6869 6465 2074 6865 2072  on to hide the r
-00023dc0: 6f77 2061 6e64 2063 6f6c 756d 6e20 6865  ow and column he
-00023dd0: 6164 6572 7320 6f6e 2074 6865 2077 6f72  aders on the wor
-00023de0: 6b73 6865 6574 2e0a 0a20 2020 2020 2020  ksheet...       
-00023df0: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
-00023e00: 2020 204e 6f6e 652e 0a0a 2020 2020 2020     None...      
-00023e10: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
-00023e20: 2020 2020 2020 204e 6f74 6869 6e67 2e0a         Nothing..
-00023e30: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00023e40: 2020 2020 2073 656c 662e 726f 775f 636f       self.row_co
-00023e50: 6c5f 6865 6164 6572 7320 3d20 5472 7565  l_headers = True
-00023e60: 0a0a 2020 2020 4063 6f6e 7665 7274 5f72  ..    @convert_r
-00023e70: 616e 6765 5f61 7267 730a 2020 2020 6465  ange_args.    de
-00023e80: 6620 7072 696e 745f 6172 6561 2873 656c  f print_area(sel
-00023e90: 662c 2066 6972 7374 5f72 6f77 2c20 6669  f, first_row, fi
-00023ea0: 7273 745f 636f 6c2c 206c 6173 745f 726f  rst_col, last_ro
-00023eb0: 772c 206c 6173 745f 636f 6c29 3a0a 2020  w, last_col):.  
-00023ec0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00023ed0: 2020 5365 7420 7468 6520 7072 696e 7420    Set the print 
-00023ee0: 6172 6561 2069 6e20 7468 6520 6375 7272  area in the curr
-00023ef0: 656e 7420 776f 726b 7368 6565 742e 0a0a  ent worksheet...
-00023f00: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
-00023f10: 2020 2020 2020 2020 2020 6669 7273 745f            first_
-00023f20: 726f 773a 2020 2020 5468 6520 6669 7273  row:    The firs
-00023f30: 7420 726f 7720 6f66 2074 6865 2063 656c  t row of the cel
-00023f40: 6c20 7261 6e67 652e 2028 7a65 726f 2069  l range. (zero i
-00023f50: 6e64 6578 6564 292e 0a20 2020 2020 2020  ndexed)..       
-00023f60: 2020 2020 2066 6972 7374 5f63 6f6c 3a20       first_col: 
-00023f70: 2020 2054 6865 2066 6972 7374 2063 6f6c     The first col
-00023f80: 756d 6e20 6f66 2074 6865 2063 656c 6c20  umn of the cell 
-00023f90: 7261 6e67 652e 0a20 2020 2020 2020 2020  range..         
-00023fa0: 2020 206c 6173 745f 726f 773a 2020 2020     last_row:    
-00023fb0: 2054 6865 206c 6173 7420 726f 7720 6f66   The last row of
-00023fc0: 2074 6865 2063 656c 6c20 7261 6e67 652e   the cell range.
-00023fd0: 2028 7a65 726f 2069 6e64 6578 6564 292e   (zero indexed).
-00023fe0: 0a20 2020 2020 2020 2020 2020 206c 6173  .            las
-00023ff0: 745f 636f 6c3a 2020 2020 2054 6865 206c  t_col:     The l
-00024000: 6173 7420 636f 6c75 6d6e 206f 6620 7468  ast column of th
-00024010: 6520 6365 6c6c 2072 616e 6765 2e0a 0a20  e cell range... 
-00024020: 2020 2020 2020 2052 6574 7572 6e73 3a0a         Returns:.
-00024030: 2020 2020 2020 2020 2020 2020 303a 2020              0:  
-00024040: 5375 6363 6573 732e 0a20 2020 2020 2020  Success..       
-00024050: 2020 2020 202d 313a 2052 6f77 206f 7220       -1: Row or 
-00024060: 636f 6c75 6d6e 2069 7320 6f75 7420 6f66  column is out of
-00024070: 2077 6f72 6b73 6865 6574 2062 6f75 6e64   worksheet bound
-00024080: 732e 0a0a 2020 2020 2020 2020 2222 220a  s...        """.
-00024090: 2020 2020 2020 2020 2320 5365 7420 7468          # Set th
-000240a0: 6520 7072 696e 7420 6172 6561 2069 6e20  e print area in 
-000240b0: 7468 6520 6375 7272 656e 7420 776f 726b  the current work
-000240c0: 7368 6565 742e 0a0a 2020 2020 2020 2020  sheet...        
-000240d0: 2320 4967 6e6f 7265 206d 6178 2070 7269  # Ignore max pri
-000240e0: 6e74 2061 7265 6120 7369 6e63 6520 6974  nt area since it
-000240f0: 2069 7320 7468 6520 7361 6d65 2061 7320   is the same as 
-00024100: 6e6f 2020 6172 6561 2066 6f72 2045 7863  no  area for Exc
-00024110: 656c 2e0a 2020 2020 2020 2020 6966 2028  el..        if (
-00024120: 6669 7273 745f 726f 7720 3d3d 2030 2061  first_row == 0 a
-00024130: 6e64 2066 6972 7374 5f63 6f6c 203d 3d20  nd first_col == 
-00024140: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
-00024150: 2020 616e 6420 6c61 7374 5f72 6f77 203d    and last_row =
-00024160: 3d20 7365 6c66 2e78 6c73 5f72 6f77 6d61  = self.xls_rowma
-00024170: 7820 2d20 310a 2020 2020 2020 2020 2020  x - 1.          
-00024180: 2020 2020 2020 616e 6420 6c61 7374 5f63        and last_c
-00024190: 6f6c 203d 3d20 7365 6c66 2e78 6c73 5f63  ol == self.xls_c
-000241a0: 6f6c 6d61 7820 2d20 3129 3a0a 2020 2020  olmax - 1):.    
-000241b0: 2020 2020 2020 2020 7265 7475 726e 0a0a          return..
-000241c0: 2020 2020 2020 2020 2320 4275 696c 6420          # Build 
-000241d0: 7570 2074 6865 2070 7269 6e74 2061 7265  up the print are
-000241e0: 6120 7261 6e67 6520 2253 6865 6574 3121  a range "Sheet1!
-000241f0: 2441 2431 3a24 4324 3133 222e 0a20 2020  $A$1:$C$13"..   
-00024200: 2020 2020 2061 7265 6120 3d20 7365 6c66       area = self
-00024210: 2e5f 636f 6e76 6572 745f 6e61 6d65 5f61  ._convert_name_a
-00024220: 7265 6128 6669 7273 745f 726f 772c 2066  rea(first_row, f
-00024230: 6972 7374 5f63 6f6c 2c0a 2020 2020 2020  irst_col,.      
-00024240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024260: 206c 6173 745f 726f 772c 206c 6173 745f   last_row, last_
-00024270: 636f 6c29 0a20 2020 2020 2020 2073 656c  col).        sel
-00024280: 662e 7072 696e 745f 6172 6561 5f72 616e  f.print_area_ran
-00024290: 6765 203d 2061 7265 610a 0a20 2020 2020  ge = area..     
-000242a0: 2020 2072 6574 7572 6e20 300a 0a20 2020     return 0..   
-000242b0: 2064 6566 2070 7269 6e74 5f61 6372 6f73   def print_acros
-000242c0: 7328 7365 6c66 293a 0a20 2020 2020 2020  s(self):.       
-000242d0: 2022 2222 0a20 2020 2020 2020 2053 6574   """.        Set
-000242e0: 2074 6865 206f 7264 6572 2069 6e20 7768   the order in wh
-000242f0: 6963 6820 7061 6765 7320 6172 6520 7072  ich pages are pr
-00024300: 696e 7465 642e 0a0a 2020 2020 2020 2020  inted...        
-00024310: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
-00024320: 2020 4e6f 6e65 2e0a 0a20 2020 2020 2020    None...       
-00024330: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
-00024340: 2020 2020 2020 4e6f 7468 696e 672e 0a0a        Nothing...
-00024350: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00024360: 2020 2020 7365 6c66 2e70 6167 655f 6f72      self.page_or
-00024370: 6465 7220 3d20 310a 2020 2020 2020 2020  der = 1.        
-00024380: 7365 6c66 2e70 6167 655f 7365 7475 705f  self.page_setup_
-00024390: 6368 616e 6765 6420 3d20 5472 7565 0a0a  changed = True..
-000243a0: 2020 2020 6465 6620 6669 745f 746f 5f70      def fit_to_p
-000243b0: 6167 6573 2873 656c 662c 2077 6964 7468  ages(self, width
-000243c0: 2c20 6865 6967 6874 293a 0a20 2020 2020  , height):.     
-000243d0: 2020 2022 2222 0a20 2020 2020 2020 2046     """.        F
-000243e0: 6974 2074 6865 2070 7269 6e74 6564 2061  it the printed a
-000243f0: 7265 6120 746f 2061 2073 7065 6369 6669  rea to a specifi
-00024400: 6320 6e75 6d62 6572 206f 6620 7061 6765  c number of page
-00024410: 7320 626f 7468 2076 6572 7469 6361 6c6c  s both verticall
-00024420: 7920 616e 640a 2020 2020 2020 2020 686f  y and.        ho
-00024430: 7269 7a6f 6e74 616c 6c79 2e0a 0a20 2020  rizontally...   
-00024440: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
-00024450: 2020 2020 2020 2077 6964 7468 3a20 204e         width:  N
-00024460: 756d 6265 7220 6f66 2070 6167 6573 2068  umber of pages h
-00024470: 6f72 697a 6f6e 7461 6c6c 792e 0a20 2020  orizontally..   
-00024480: 2020 2020 2020 2020 2068 6569 6768 743a           height:
-00024490: 204e 756d 6265 7220 6f66 2070 6167 6573   Number of pages
-000244a0: 2076 6572 7469 6361 6c6c 792e 0a0a 2020   vertically...  
-000244b0: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
-000244c0: 2020 2020 2020 2020 2020 204e 6f74 6869             Nothi
-000244d0: 6e67 2e0a 0a20 2020 2020 2020 2022 2222  ng...        """
-000244e0: 0a20 2020 2020 2020 2073 656c 662e 6669  .        self.fi
-000244f0: 745f 7061 6765 203d 2031 0a20 2020 2020  t_page = 1.     
-00024500: 2020 2073 656c 662e 6669 745f 7769 6474     self.fit_widt
-00024510: 6820 3d20 7769 6474 680a 2020 2020 2020  h = width.      
-00024520: 2020 7365 6c66 2e66 6974 5f68 6569 6768    self.fit_heigh
-00024530: 7420 3d20 6865 6967 6874 0a20 2020 2020  t = height.     
-00024540: 2020 2073 656c 662e 7061 6765 5f73 6574     self.page_set
-00024550: 7570 5f63 6861 6e67 6564 203d 2054 7275  up_changed = Tru
-00024560: 650a 0a20 2020 2064 6566 2073 6574 5f73  e..    def set_s
-00024570: 7461 7274 5f70 6167 6528 7365 6c66 2c20  tart_page(self, 
-00024580: 7374 6172 745f 7061 6765 293a 0a20 2020  start_page):.   
-00024590: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000245a0: 2053 6574 2074 6865 2073 7461 7274 2070   Set the start p
-000245b0: 6167 6520 6e75 6d62 6572 2077 6865 6e20  age number when 
-000245c0: 7072 696e 7469 6e67 2e0a 0a20 2020 2020  printing...     
-000245d0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-000245e0: 2020 2020 2073 7461 7274 5f70 6167 653a       start_page:
-000245f0: 2053 7461 7274 2070 6167 6520 6e75 6d62   Start page numb
-00024600: 6572 2e0a 0a20 2020 2020 2020 2052 6574  er...        Ret
-00024610: 7572 6e73 3a0a 2020 2020 2020 2020 2020  urns:.          
-00024620: 2020 4e6f 7468 696e 672e 0a0a 2020 2020    Nothing...    
-00024630: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00024640: 7365 6c66 2e70 6167 655f 7374 6172 7420  self.page_start 
-00024650: 3d20 7374 6172 745f 7061 6765 0a0a 2020  = start_page..  
-00024660: 2020 6465 6620 7365 745f 7072 696e 745f    def set_print_
-00024670: 7363 616c 6528 7365 6c66 2c20 7363 616c  scale(self, scal
-00024680: 6529 3a0a 2020 2020 2020 2020 2222 220a  e):.        """.
-00024690: 2020 2020 2020 2020 5365 7420 7468 6520          Set the 
-000246a0: 7363 616c 6520 6661 6374 6f72 2066 6f72  scale factor for
-000246b0: 2074 6865 2070 7269 6e74 6564 2070 6167   the printed pag
-000246c0: 652e 0a0a 2020 2020 2020 2020 4172 6773  e...        Args
-000246d0: 3a0a 2020 2020 2020 2020 2020 2020 7363  :.            sc
-000246e0: 616c 653a 2050 7269 6e74 2073 6361 6c65  ale: Print scale
-000246f0: 2e20 3130 203c 3d20 7363 616c 6520 3c3d  . 10 <= scale <=
-00024700: 2034 3030 2e0a 0a20 2020 2020 2020 2052   400...        R
-00024710: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
-00024720: 2020 2020 4e6f 7468 696e 672e 0a0a 2020      Nothing...  
-00024730: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00024740: 2020 2320 436f 6e66 696e 6520 7468 6520    # Confine the 
-00024750: 7363 616c 6520 746f 2045 7863 656c 2773  scale to Excel's
-00024760: 2072 616e 6765 2e0a 2020 2020 2020 2020   range..        
-00024770: 6966 2073 6361 6c65 203c 2031 3020 6f72  if scale < 10 or
-00024780: 2073 6361 6c65 203e 2034 3030 3a0a 2020   scale > 400:.  
-00024790: 2020 2020 2020 2020 2020 7761 726e 2822            warn("
-000247a0: 5072 696e 7420 7363 616c 6520 2725 6427  Print scale '%d'
-000247b0: 206f 7574 7369 6465 2072 616e 6765 3a20   outside range: 
-000247c0: 3130 203c 3d20 7363 616c 6520 3c3d 2034  10 <= scale <= 4
-000247d0: 3030 2220 2520 7363 616c 6529 0a20 2020  00" % scale).   
-000247e0: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-000247f0: 0a20 2020 2020 2020 2023 2054 7572 6e20  .        # Turn 
-00024800: 6f66 6620 2266 6974 2074 6f20 7061 6765  off "fit to page
-00024810: 2220 6f70 7469 6f6e 2077 6865 6e20 7072  " option when pr
-00024820: 696e 7420 7363 616c 6520 6973 206f 6e2e  int scale is on.
-00024830: 0a20 2020 2020 2020 2073 656c 662e 6669  .        self.fi
-00024840: 745f 7061 6765 203d 2030 0a0a 2020 2020  t_page = 0..    
-00024850: 2020 2020 7365 6c66 2e70 7269 6e74 5f73      self.print_s
-00024860: 6361 6c65 203d 2069 6e74 2873 6361 6c65  cale = int(scale
-00024870: 290a 2020 2020 2020 2020 7365 6c66 2e70  ).        self.p
-00024880: 6167 655f 7365 7475 705f 6368 616e 6765  age_setup_change
-00024890: 6420 3d20 5472 7565 0a0a 2020 2020 6465  d = True..    de
-000248a0: 6620 7072 696e 745f 626c 6163 6b5f 616e  f print_black_an
-000248b0: 645f 7768 6974 6528 7365 6c66 293a 0a20  d_white(self):. 
-000248c0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000248d0: 2020 2053 6574 2074 6865 206f 7074 696f     Set the optio
-000248e0: 6e20 746f 2070 7269 6e74 2074 6865 2077  n to print the w
-000248f0: 6f72 6b73 6865 6574 2069 6e20 626c 6163  orksheet in blac
-00024900: 6b20 616e 6420 7768 6974 652e 0a0a 2020  k and white...  
-00024910: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
-00024920: 2020 2020 2020 2020 4e6f 6e65 2e0a 0a20          None... 
-00024930: 2020 2020 2020 2052 6574 7572 6e73 3a0a         Returns:.
-00024940: 2020 2020 2020 2020 2020 2020 4e6f 7468              Noth
-00024950: 696e 672e 0a0a 2020 2020 2020 2020 2222  ing...        ""
-00024960: 220a 2020 2020 2020 2020 7365 6c66 2e62  ".        self.b
-00024970: 6c61 636b 5f77 6869 7465 203d 2054 7275  lack_white = Tru
-00024980: 650a 2020 2020 2020 2020 7365 6c66 2e70  e.        self.p
-00024990: 6167 655f 7365 7475 705f 6368 616e 6765  age_setup_change
-000249a0: 6420 3d20 5472 7565 0a0a 2020 2020 6465  d = True..    de
-000249b0: 6620 7365 745f 685f 7061 6765 6272 6561  f set_h_pagebrea
-000249c0: 6b73 2873 656c 662c 2062 7265 616b 7329  ks(self, breaks)
-000249d0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-000249e0: 2020 2020 2020 5365 7420 7468 6520 686f        Set the ho
-000249f0: 7269 7a6f 6e74 616c 2070 6167 6520 6272  rizontal page br
-00024a00: 6561 6b73 206f 6e20 6120 776f 726b 7368  eaks on a worksh
-00024a10: 6565 742e 0a0a 2020 2020 2020 2020 4172  eet...        Ar
-00024a20: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
-00024a30: 6272 6561 6b73 3a20 4c69 7374 206f 6620  breaks: List of 
-00024a40: 726f 7773 2077 6865 7265 2074 6865 2070  rows where the p
-00024a50: 6167 6520 6272 6561 6b73 2073 686f 756c  age breaks shoul
-00024a60: 6420 6265 2061 6464 6564 2e0a 0a20 2020  d be added...   
-00024a70: 2020 2020 2052 6574 7572 6e73 3a0a 2020       Returns:.  
-00024a80: 2020 2020 2020 2020 2020 4e6f 7468 696e            Nothin
-00024a90: 672e 0a0a 2020 2020 2020 2020 2222 220a  g...        """.
-00024aa0: 2020 2020 2020 2020 7365 6c66 2e68 6272          self.hbr
-00024ab0: 6561 6b73 203d 2062 7265 616b 730a 0a20  eaks = breaks.. 
-00024ac0: 2020 2064 6566 2073 6574 5f76 5f70 6167     def set_v_pag
-00024ad0: 6562 7265 616b 7328 7365 6c66 2c20 6272  ebreaks(self, br
-00024ae0: 6561 6b73 293a 0a20 2020 2020 2020 2022  eaks):.        "
-00024af0: 2222 0a20 2020 2020 2020 2053 6574 2074  "".        Set t
-00024b00: 6865 2068 6f72 697a 6f6e 7461 6c20 7061  he horizontal pa
-00024b10: 6765 2062 7265 616b 7320 6f6e 2061 2077  ge breaks on a w
-00024b20: 6f72 6b73 6865 6574 2e0a 0a20 2020 2020  orksheet...     
-00024b30: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
-00024b40: 2020 2020 2062 7265 616b 733a 204c 6973       breaks: Lis
-00024b50: 7420 6f66 2063 6f6c 756d 6e73 2077 6865  t of columns whe
-00024b60: 7265 2074 6865 2070 6167 6520 6272 6561  re the page brea
-00024b70: 6b73 2073 686f 756c 6420 6265 2061 6464  ks should be add
-00024b80: 6564 2e0a 0a20 2020 2020 2020 2052 6574  ed...        Ret
-00024b90: 7572 6e73 3a0a 2020 2020 2020 2020 2020  urns:.          
-00024ba0: 2020 4e6f 7468 696e 672e 0a0a 2020 2020    Nothing...    
-00024bb0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00024bc0: 7365 6c66 2e76 6272 6561 6b73 203d 2062  self.vbreaks = b
-00024bd0: 7265 616b 730a 0a20 2020 2064 6566 2073  reaks..    def s
-00024be0: 6574 5f76 6261 5f6e 616d 6528 7365 6c66  et_vba_name(self
-00024bf0: 2c20 6e61 6d65 3d4e 6f6e 6529 3a0a 2020  , name=None):.  
-00024c00: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00024c10: 2020 5365 7420 7468 6520 5642 4120 6e61    Set the VBA na
-00024c20: 6d65 2066 6f72 2074 6865 2077 6f72 6b73  me for the works
-00024c30: 6865 6574 2e20 4279 2064 6566 6175 6c74  heet. By default
-00024c40: 2074 6869 7320 6973 2074 6865 0a20 2020   this is the.   
-00024c50: 2020 2020 2073 616d 6520 6173 2074 6865       same as the
-00024c60: 2073 6865 6574 206e 616d 653a 2069 2e65   sheet name: i.e
-00024c70: 2e2c 2053 6865 6574 3120 6574 632e 0a0a  ., Sheet1 etc...
-00024c80: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
-00024c90: 2020 2020 2020 2020 2020 6e61 6d65 3a20            name: 
-00024ca0: 5468 6520 5642 4120 6e61 6d65 2066 6f72  The VBA name for
-00024cb0: 2074 6865 2077 6f72 6b73 6865 6574 2e0a   the worksheet..
-00024cc0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00024cd0: 3a0a 2020 2020 2020 2020 2020 2020 4e6f  :.            No
-00024ce0: 7468 696e 672e 0a0a 2020 2020 2020 2020  thing...        
-00024cf0: 2222 220a 2020 2020 2020 2020 6966 206e  """.        if n
-00024d00: 616d 6520 6973 206e 6f74 204e 6f6e 653a  ame is not None:
-00024d10: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00024d20: 662e 7662 615f 636f 6465 6e61 6d65 203d  f.vba_codename =
-00024d30: 206e 616d 650a 2020 2020 2020 2020 656c   name.        el
-00024d40: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00024d50: 7365 6c66 2e76 6261 5f63 6f64 656e 616d  self.vba_codenam
-00024d60: 6520 3d20 2753 6865 6574 2720 2b20 7374  e = 'Sheet' + st
-00024d70: 7228 7365 6c66 2e69 6e64 6578 202b 2031  r(self.index + 1
-00024d80: 290a 0a20 2020 2064 6566 2069 676e 6f72  )..    def ignor
-00024d90: 655f 6572 726f 7273 2873 656c 662c 206f  e_errors(self, o
-00024da0: 7074 696f 6e73 3d4e 6f6e 6529 3a0a 2020  ptions=None):.  
-00024db0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00024dc0: 2020 4967 6e6f 7265 2076 6172 696f 7573    Ignore various
-00024dd0: 2045 7863 656c 2065 7272 6f72 732f 7761   Excel errors/wa
-00024de0: 726e 696e 6773 2069 6e20 6120 776f 726b  rnings in a work
-00024df0: 7368 6565 7420 666f 7220 7573 6572 2064  sheet for user d
-00024e00: 6566 696e 6564 0a20 2020 2020 2020 2072  efined.        r
-00024e10: 616e 6765 732e 0a0a 2020 2020 2020 2020  anges...        
-00024e20: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
-00024e30: 2020 6f70 7469 6f6e 733a 2041 2064 6963    options: A dic
-00024e40: 7420 6f66 2069 676e 6f72 6520 6572 726f  t of ignore erro
-00024e50: 7273 206b 6579 7320 7769 7468 2063 656c  rs keys with cel
-00024e60: 6c20 7261 6e67 6520 7661 6c75 6573 2e0a  l range values..
-00024e70: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00024e80: 3a0a 2020 2020 2020 2020 2020 2020 303a  :.            0:
-00024e90: 2053 7563 6365 7373 2e0a 2020 2020 2020   Success..      
-00024ea0: 2020 2020 202d 313a 2049 6e63 6f72 7265       -1: Incorre
-00024eb0: 6374 2070 6172 616d 6574 6572 206f 7220  ct parameter or 
-00024ec0: 6f70 7469 6f6e 2e0a 0a20 2020 2020 2020  option...       
-00024ed0: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-00024ee0: 6f70 7469 6f6e 7320 6973 204e 6f6e 653a  options is None:
-00024ef0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00024f00: 7572 6e20 2d31 0a20 2020 2020 2020 2065  urn -1.        e
-00024f10: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00024f20: 2023 2043 6f70 7920 7468 6520 7573 6572   # Copy the user
-00024f30: 2064 6566 696e 6564 206f 7074 696f 6e73   defined options
-00024f40: 2073 6f20 7468 6579 2061 7265 6e27 7420   so they aren't 
-00024f50: 6d6f 6469 6669 6564 2e0a 2020 2020 2020  modified..      
-00024f60: 2020 2020 2020 6f70 7469 6f6e 7320 3d20        options = 
-00024f70: 6f70 7469 6f6e 732e 636f 7079 2829 0a0a  options.copy()..
-00024f80: 2020 2020 2020 2020 2320 5661 6c69 6420          # Valid 
-00024f90: 696e 7075 7420 7061 7261 6d65 7465 7273  input parameters
-00024fa0: 2e0a 2020 2020 2020 2020 7661 6c69 645f  ..        valid_
-00024fb0: 7061 7261 6d65 7465 7273 203d 207b 0a20  parameters = {. 
-00024fc0: 2020 2020 2020 2020 2020 2027 6e75 6d62             'numb
-00024fd0: 6572 5f73 746f 7265 645f 6173 5f74 6578  er_stored_as_tex
-00024fe0: 7427 2c0a 2020 2020 2020 2020 2020 2020  t',.            
-00024ff0: 2765 7661 6c5f 6572 726f 7227 2c0a 2020  'eval_error',.  
-00025000: 2020 2020 2020 2020 2020 2766 6f72 6d75            'formu
-00025010: 6c61 5f64 6966 6665 7273 272c 0a20 2020  la_differs',.   
-00025020: 2020 2020 2020 2020 2027 666f 726d 756c           'formul
-00025030: 615f 7261 6e67 6527 2c0a 2020 2020 2020  a_range',.      
-00025040: 2020 2020 2020 2766 6f72 6d75 6c61 5f75        'formula_u
-00025050: 6e6c 6f63 6b65 6427 2c0a 2020 2020 2020  nlocked',.      
-00025060: 2020 2020 2020 2765 6d70 7479 5f63 656c        'empty_cel
-00025070: 6c5f 7265 6665 7265 6e63 6527 2c0a 2020  l_reference',.  
-00025080: 2020 2020 2020 2020 2020 276c 6973 745f            'list_
-00025090: 6461 7461 5f76 616c 6964 6174 696f 6e27  data_validation'
-000250a0: 2c0a 2020 2020 2020 2020 2020 2020 2763  ,.            'c
-000250b0: 616c 6375 6c61 7465 645f 636f 6c75 6d6e  alculated_column
-000250c0: 272c 0a20 2020 2020 2020 2020 2020 2027  ',.            '
-000250d0: 7477 6f5f 6469 6769 745f 7465 7874 5f79  two_digit_text_y
-000250e0: 6561 7227 2c0a 2020 2020 2020 2020 7d0a  ear',.        }.
-000250f0: 0a20 2020 2020 2020 2023 2043 6865 636b  .        # Check
-00025100: 2066 6f72 2076 616c 6964 2069 6e70 7574   for valid input
-00025110: 2070 6172 616d 6574 6572 732e 0a20 2020   parameters..   
-00025120: 2020 2020 2066 6f72 2070 6172 616d 5f6b       for param_k
-00025130: 6579 2069 6e20 6f70 7469 6f6e 732e 6b65  ey in options.ke
-00025140: 7973 2829 3a0a 2020 2020 2020 2020 2020  ys():.          
-00025150: 2020 6966 2070 6172 616d 5f6b 6579 206e    if param_key n
-00025160: 6f74 2069 6e20 7661 6c69 645f 7061 7261  ot in valid_para
-00025170: 6d65 7465 7273 3a0a 2020 2020 2020 2020  meters:.        
-00025180: 2020 2020 2020 2020 7761 726e 2822 556e          warn("Un
-00025190: 6b6e 6f77 6e20 7061 7261 6d65 7465 7220  known parameter 
-000251a0: 2725 7327 2069 6e20 6967 6e6f 7265 5f65  '%s' in ignore_e
-000251b0: 7272 6f72 7328 2922 2025 2070 6172 616d  rrors()" % param
-000251c0: 5f6b 6579 290a 2020 2020 2020 2020 2020  _key).          
-000251d0: 2020 2020 2020 7265 7475 726e 202d 310a        return -1.
-000251e0: 0a20 2020 2020 2020 2073 656c 662e 6967  .        self.ig
-000251f0: 6e6f 7265 645f 6572 726f 7273 203d 206f  nored_errors = o
-00025200: 7074 696f 6e73 0a0a 2020 2020 2020 2020  ptions..        
-00025210: 7265 7475 726e 2030 0a0a 2020 2020 2323  return 0..    ##
-00025220: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00025230: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00025240: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00025250: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00025260: 2323 2323 2323 2323 230a 2020 2020 230a  #########.    #.
-00025270: 2020 2020 2320 5072 6976 6174 6520 4150      # Private AP
-00025280: 492e 0a20 2020 2023 0a20 2020 2023 2323  I..    #.    ###
-00025290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000252a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000252b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000252c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000252d0: 2323 2323 2323 2323 0a20 2020 2064 6566  ########.    def
-000252e0: 205f 696e 6974 6961 6c69 7a65 2873 656c   _initialize(sel
-000252f0: 662c 2069 6e69 745f 6461 7461 293a 0a20  f, init_data):. 
-00025300: 2020 2020 2020 2073 656c 662e 6e61 6d65         self.name
-00025310: 203d 2069 6e69 745f 6461 7461 5b27 6e61   = init_data['na
-00025320: 6d65 275d 0a20 2020 2020 2020 2073 656c  me'].        sel
-00025330: 662e 696e 6465 7820 3d20 696e 6974 5f64  f.index = init_d
-00025340: 6174 615b 2769 6e64 6578 275d 0a20 2020  ata['index'].   
-00025350: 2020 2020 2073 656c 662e 7374 725f 7461       self.str_ta
-00025360: 626c 6520 3d20 696e 6974 5f64 6174 615b  ble = init_data[
-00025370: 2773 7472 5f74 6162 6c65 275d 0a20 2020  'str_table'].   
-00025380: 2020 2020 2073 656c 662e 776f 726b 7368       self.worksh
-00025390: 6565 745f 6d65 7461 203d 2069 6e69 745f  eet_meta = init_
-000253a0: 6461 7461 5b27 776f 726b 7368 6565 745f  data['worksheet_
-000253b0: 6d65 7461 275d 0a20 2020 2020 2020 2073  meta'].        s
-000253c0: 656c 662e 636f 6e73 7461 6e74 5f6d 656d  elf.constant_mem
-000253d0: 6f72 7920 3d20 696e 6974 5f64 6174 615b  ory = init_data[
-000253e0: 2763 6f6e 7374 616e 745f 6d65 6d6f 7279  'constant_memory
-000253f0: 275d 0a20 2020 2020 2020 2073 656c 662e  '].        self.
-00025400: 746d 7064 6972 203d 2069 6e69 745f 6461  tmpdir = init_da
-00025410: 7461 5b27 746d 7064 6972 275d 0a20 2020  ta['tmpdir'].   
-00025420: 2020 2020 2073 656c 662e 6461 7465 5f31       self.date_1
-00025430: 3930 3420 3d20 696e 6974 5f64 6174 615b  904 = init_data[
-00025440: 2764 6174 655f 3139 3034 275d 0a20 2020  'date_1904'].   
-00025450: 2020 2020 2073 656c 662e 7374 7269 6e67       self.string
-00025460: 735f 746f 5f6e 756d 6265 7273 203d 2069  s_to_numbers = i
-00025470: 6e69 745f 6461 7461 5b27 7374 7269 6e67  nit_data['string
-00025480: 735f 746f 5f6e 756d 6265 7273 275d 0a20  s_to_numbers']. 
-00025490: 2020 2020 2020 2073 656c 662e 7374 7269         self.stri
-000254a0: 6e67 735f 746f 5f66 6f72 6d75 6c61 7320  ngs_to_formulas 
-000254b0: 3d20 696e 6974 5f64 6174 615b 2773 7472  = init_data['str
-000254c0: 696e 6773 5f74 6f5f 666f 726d 756c 6173  ings_to_formulas
-000254d0: 275d 0a20 2020 2020 2020 2073 656c 662e  '].        self.
-000254e0: 7374 7269 6e67 735f 746f 5f75 726c 7320  strings_to_urls 
-000254f0: 3d20 696e 6974 5f64 6174 615b 2773 7472  = init_data['str
-00025500: 696e 6773 5f74 6f5f 7572 6c73 275d 0a20  ings_to_urls']. 
-00025510: 2020 2020 2020 2073 656c 662e 6e61 6e5f         self.nan_
-00025520: 696e 665f 746f 5f65 7272 6f72 7320 3d20  inf_to_errors = 
-00025530: 696e 6974 5f64 6174 615b 276e 616e 5f69  init_data['nan_i
-00025540: 6e66 5f74 6f5f 6572 726f 7273 275d 0a20  nf_to_errors']. 
-00025550: 2020 2020 2020 2073 656c 662e 6465 6661         self.defa
-00025560: 756c 745f 6461 7465 5f66 6f72 6d61 7420  ult_date_format 
-00025570: 3d20 696e 6974 5f64 6174 615b 2764 6566  = init_data['def
-00025580: 6175 6c74 5f64 6174 655f 666f 726d 6174  ault_date_format
-00025590: 275d 0a20 2020 2020 2020 2073 656c 662e  '].        self.
-000255a0: 6465 6661 756c 745f 7572 6c5f 666f 726d  default_url_form
-000255b0: 6174 203d 2069 6e69 745f 6461 7461 5b27  at = init_data['
-000255c0: 6465 6661 756c 745f 7572 6c5f 666f 726d  default_url_form
-000255d0: 6174 275d 0a20 2020 2020 2020 2073 656c  at'].        sel
-000255e0: 662e 6578 6365 6c32 3030 335f 7374 796c  f.excel2003_styl
-000255f0: 6520 3d20 696e 6974 5f64 6174 615b 2765  e = init_data['e
-00025600: 7863 656c 3230 3033 5f73 7479 6c65 275d  xcel2003_style']
-00025610: 0a20 2020 2020 2020 2073 656c 662e 7265  .        self.re
-00025620: 6d6f 7665 5f74 696d 657a 6f6e 6520 3d20  move_timezone = 
-00025630: 696e 6974 5f64 6174 615b 2772 656d 6f76  init_data['remov
-00025640: 655f 7469 6d65 7a6f 6e65 275d 0a20 2020  e_timezone'].   
-00025650: 2020 2020 2073 656c 662e 6d61 785f 7572       self.max_ur
-00025660: 6c5f 6c65 6e67 7468 203d 2069 6e69 745f  l_length = init_
-00025670: 6461 7461 5b27 6d61 785f 7572 6c5f 6c65  data['max_url_le
-00025680: 6e67 7468 275d 0a20 2020 2020 2020 2073  ngth'].        s
-00025690: 656c 662e 7573 655f 6675 7475 7265 5f66  elf.use_future_f
-000256a0: 756e 6374 696f 6e73 203d 2069 6e69 745f  unctions = init_
-000256b0: 6461 7461 5b27 7573 655f 6675 7475 7265  data['use_future
-000256c0: 5f66 756e 6374 696f 6e73 275d 0a0a 2020  _functions']..  
-000256d0: 2020 2020 2020 6966 2073 656c 662e 6578        if self.ex
-000256e0: 6365 6c32 3030 335f 7374 796c 653a 0a20  cel2003_style:. 
-000256f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00025700: 6f72 6967 696e 616c 5f72 6f77 5f68 6569  original_row_hei
-00025710: 6768 7420 3d20 3132 2e37 350a 2020 2020  ght = 12.75.    
-00025720: 2020 2020 2020 2020 7365 6c66 2e64 6566          self.def
-00025730: 6175 6c74 5f72 6f77 5f68 6569 6768 7420  ault_row_height 
-00025740: 3d20 3132 2e37 350a 2020 2020 2020 2020  = 12.75.        
-00025750: 2020 2020 7365 6c66 2e64 6566 6175 6c74      self.default
-00025760: 5f72 6f77 5f70 6978 656c 7320 3d20 3137  _row_pixels = 17
-00025770: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00025780: 662e 6d61 7267 696e 5f6c 6566 7420 3d20  f.margin_left = 
-00025790: 302e 3735 0a20 2020 2020 2020 2020 2020  0.75.           
-000257a0: 2073 656c 662e 6d61 7267 696e 5f72 6967   self.margin_rig
-000257b0: 6874 203d 2030 2e37 350a 2020 2020 2020  ht = 0.75.      
-000257c0: 2020 2020 2020 7365 6c66 2e6d 6172 6769        self.margi
-000257d0: 6e5f 746f 7020 3d20 310a 2020 2020 2020  n_top = 1.      
-000257e0: 2020 2020 2020 7365 6c66 2e6d 6172 6769        self.margi
-000257f0: 6e5f 626f 7474 6f6d 203d 2031 0a20 2020  n_bottom = 1.   
-00025800: 2020 2020 2020 2020 2073 656c 662e 6d61           self.ma
-00025810: 7267 696e 5f68 6561 6465 7220 3d20 302e  rgin_header = 0.
-00025820: 350a 2020 2020 2020 2020 2020 2020 7365  5.            se
-00025830: 6c66 2e6d 6172 6769 6e5f 666f 6f74 6572  lf.margin_footer
-00025840: 203d 2030 2e35 0a20 2020 2020 2020 2020   = 0.5.         
-00025850: 2020 2073 656c 662e 6865 6164 6572 5f66     self.header_f
-00025860: 6f6f 7465 725f 616c 6967 6e73 203d 2046  ooter_aligns = F
-00025870: 616c 7365 0a0a 2020 2020 2020 2020 2320  alse..        # 
-00025880: 4f70 656e 2061 2074 656d 7020 6669 6c65  Open a temp file
-00025890: 6861 6e64 6c65 2074 6f20 7374 6f72 6520  handle to store 
-000258a0: 726f 7720 6461 7461 2069 6e20 636f 6e73  row data in cons
-000258b0: 7461 6e74 5f6d 656d 6f72 7920 6d6f 6465  tant_memory mode
-000258c0: 2e0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-000258d0: 662e 636f 6e73 7461 6e74 5f6d 656d 6f72  f.constant_memor
-000258e0: 793a 0a20 2020 2020 2020 2020 2020 2023  y:.            #
-000258f0: 2054 6869 7320 6973 2073 7562 2d6f 7074   This is sub-opt
-00025900: 696d 616c 2062 7574 2077 6520 6e65 6564  imal but we need
-00025910: 2074 6f20 6372 6561 7465 2061 2074 656d   to create a tem
-00025920: 7020 6669 6c65 0a20 2020 2020 2020 2020  p file.         
-00025930: 2020 2023 2077 6974 6820 7574 6638 2065     # with utf8 e
-00025940: 6e63 6f64 696e 6720 696e 2050 7974 686f  ncoding in Pytho
-00025950: 6e20 3c20 332e 0a20 2020 2020 2020 2020  n < 3..         
-00025960: 2020 2028 6664 2c20 6669 6c65 6e61 6d65     (fd, filename
-00025970: 2920 3d20 7465 6d70 6669 6c65 2e6d 6b73  ) = tempfile.mks
-00025980: 7465 6d70 2864 6972 3d73 656c 662e 746d  temp(dir=self.tm
-00025990: 7064 6972 290a 2020 2020 2020 2020 2020  pdir).          
-000259a0: 2020 6f73 2e63 6c6f 7365 2866 6429 0a20    os.close(fd). 
-000259b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000259c0: 726f 775f 6461 7461 5f66 696c 656e 616d  row_data_filenam
-000259d0: 6520 3d20 6669 6c65 6e61 6d65 0a20 2020  e = filename.   
-000259e0: 2020 2020 2020 2020 2073 656c 662e 726f           self.ro
-000259f0: 775f 6461 7461 5f66 6820 3d20 6f70 656e  w_data_fh = open
-00025a00: 2866 696c 656e 616d 652c 206d 6f64 653d  (filename, mode=
-00025a10: 2777 2b27 2c20 656e 636f 6469 6e67 3d27  'w+', encoding='
-00025a20: 7574 662d 3827 290a 0a20 2020 2020 2020  utf-8')..       
-00025a30: 2020 2020 2023 2053 6574 2061 7320 7468       # Set as th
-00025a40: 6520 776f 726b 7368 6565 7420 6669 6c65  e worksheet file
-00025a50: 6861 6e64 6c65 2075 6e74 696c 2074 6865  handle until the
-00025a60: 2066 696c 6520 6973 2061 7373 656d 626c   file is assembl
-00025a70: 6564 2e0a 2020 2020 2020 2020 2020 2020  ed..            
-00025a80: 7365 6c66 2e66 6820 3d20 7365 6c66 2e72  self.fh = self.r
-00025a90: 6f77 5f64 6174 615f 6668 0a0a 2020 2020  ow_data_fh..    
-00025aa0: 6465 6620 5f61 7373 656d 626c 655f 786d  def _assemble_xm
-00025ab0: 6c5f 6669 6c65 2873 656c 6629 3a0a 2020  l_file(self):.  
-00025ac0: 2020 2020 2020 2320 4173 7365 6d62 6c65        # Assemble
-00025ad0: 2061 6e64 2077 7269 7465 2074 6865 2058   and write the X
-00025ae0: 4d4c 2066 696c 652e 0a0a 2020 2020 2020  ML file...      
-00025af0: 2020 2320 5772 6974 6520 7468 6520 584d    # Write the XM
-00025b00: 4c20 6465 636c 6172 6174 696f 6e2e 0a20  L declaration.. 
-00025b10: 2020 2020 2020 2073 656c 662e 5f78 6d6c         self._xml
-00025b20: 5f64 6563 6c61 7261 7469 6f6e 2829 0a0a  _declaration()..
-00025b30: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
-00025b40: 7468 6520 726f 6f74 2077 6f72 6b73 6865  the root workshe
-00025b50: 6574 2065 6c65 6d65 6e74 2e0a 2020 2020  et element..    
-00025b60: 2020 2020 7365 6c66 2e5f 7772 6974 655f      self._write_
-00025b70: 776f 726b 7368 6565 7428 290a 0a20 2020  worksheet()..   
-00025b80: 2020 2020 2023 2057 7269 7465 2074 6865       # Write the
-00025b90: 2077 6f72 6b73 6865 6574 2070 726f 7065   worksheet prope
-00025ba0: 7274 6965 732e 0a20 2020 2020 2020 2073  rties..        s
-00025bb0: 656c 662e 5f77 7269 7465 5f73 6865 6574  elf._write_sheet
-00025bc0: 5f70 7228 290a 0a20 2020 2020 2020 2023  _pr()..        #
-00025bd0: 2057 7269 7465 2074 6865 2077 6f72 6b73   Write the works
-00025be0: 6865 6574 2064 696d 656e 7369 6f6e 732e  heet dimensions.
-00025bf0: 0a20 2020 2020 2020 2073 656c 662e 5f77  .        self._w
-00025c00: 7269 7465 5f64 696d 656e 7369 6f6e 2829  rite_dimension()
-00025c10: 0a0a 2020 2020 2020 2020 2320 5772 6974  ..        # Writ
-00025c20: 6520 7468 6520 7368 6565 7420 7669 6577  e the sheet view
-00025c30: 2070 726f 7065 7274 6965 732e 0a20 2020   properties..   
-00025c40: 2020 2020 2073 656c 662e 5f77 7269 7465       self._write
-00025c50: 5f73 6865 6574 5f76 6965 7773 2829 0a0a  _sheet_views()..
-00025c60: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
-00025c70: 7468 6520 7368 6565 7420 666f 726d 6174  the sheet format
-00025c80: 2070 726f 7065 7274 6965 732e 0a20 2020   properties..   
-00025c90: 2020 2020 2073 656c 662e 5f77 7269 7465       self._write
-00025ca0: 5f73 6865 6574 5f66 6f72 6d61 745f 7072  _sheet_format_pr
-00025cb0: 2829 0a0a 2020 2020 2020 2020 2320 5772  ()..        # Wr
-00025cc0: 6974 6520 7468 6520 7368 6565 7420 636f  ite the sheet co
-00025cd0: 6c75 6d6e 2069 6e66 6f2e 0a20 2020 2020  lumn info..     
-00025ce0: 2020 2073 656c 662e 5f77 7269 7465 5f63     self._write_c
-00025cf0: 6f6c 7328 290a 0a20 2020 2020 2020 2023  ols()..        #
-00025d00: 2057 7269 7465 2074 6865 2077 6f72 6b73   Write the works
-00025d10: 6865 6574 2064 6174 6120 7375 6368 2061  heet data such a
-00025d20: 7320 726f 7773 2063 6f6c 756d 6e73 2061  s rows columns a
-00025d30: 6e64 2063 656c 6c73 2e0a 2020 2020 2020  nd cells..      
-00025d40: 2020 6966 206e 6f74 2073 656c 662e 636f    if not self.co
-00025d50: 6e73 7461 6e74 5f6d 656d 6f72 793a 0a20  nstant_memory:. 
-00025d60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00025d70: 5f77 7269 7465 5f73 6865 6574 5f64 6174  _write_sheet_dat
-00025d80: 6128 290a 2020 2020 2020 2020 656c 7365  a().        else
-00025d90: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00025da0: 6c66 2e5f 7772 6974 655f 6f70 7469 6d69  lf._write_optimi
-00025db0: 7a65 645f 7368 6565 745f 6461 7461 2829  zed_sheet_data()
-00025dc0: 0a0a 2020 2020 2020 2020 2320 5772 6974  ..        # Writ
-00025dd0: 6520 7468 6520 7368 6565 7450 726f 7465  e the sheetProte
-00025de0: 6374 696f 6e20 656c 656d 656e 742e 0a20  ction element.. 
-00025df0: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
-00025e00: 7465 5f73 6865 6574 5f70 726f 7465 6374  te_sheet_protect
-00025e10: 696f 6e28 290a 0a20 2020 2020 2020 2023  ion()..        #
-00025e20: 2057 7269 7465 2074 6865 2070 726f 7465   Write the prote
-00025e30: 6374 6564 5261 6e67 6573 2065 6c65 6d65  ctedRanges eleme
-00025e40: 6e74 2e0a 2020 2020 2020 2020 7365 6c66  nt..        self
-00025e50: 2e5f 7772 6974 655f 7072 6f74 6563 7465  ._write_protecte
-00025e60: 645f 7261 6e67 6573 2829 0a0a 2020 2020  d_ranges()..    
-00025e70: 2020 2020 2320 5772 6974 6520 7468 6520      # Write the 
-00025e80: 7068 6f6e 6574 6963 5072 2065 6c65 6d65  phoneticPr eleme
-00025e90: 6e74 2e0a 2020 2020 2020 2020 6966 2073  nt..        if s
-00025ea0: 656c 662e 6578 6365 6c32 3030 335f 7374  elf.excel2003_st
-00025eb0: 796c 653a 0a20 2020 2020 2020 2020 2020  yle:.           
-00025ec0: 2073 656c 662e 5f77 7269 7465 5f70 686f   self._write_pho
-00025ed0: 6e65 7469 635f 7072 2829 0a0a 2020 2020  netic_pr()..    
-00025ee0: 2020 2020 2320 5772 6974 6520 7468 6520      # Write the 
-00025ef0: 6175 746f 4669 6c74 6572 2065 6c65 6d65  autoFilter eleme
-00025f00: 6e74 2e0a 2020 2020 2020 2020 7365 6c66  nt..        self
-00025f10: 2e5f 7772 6974 655f 6175 746f 5f66 696c  ._write_auto_fil
-00025f20: 7465 7228 290a 0a20 2020 2020 2020 2023  ter()..        #
-00025f30: 2057 7269 7465 2074 6865 206d 6572 6765   Write the merge
-00025f40: 4365 6c6c 7320 656c 656d 656e 742e 0a20  Cells element.. 
-00025f50: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
-00025f60: 7465 5f6d 6572 6765 5f63 656c 6c73 2829  te_merge_cells()
-00025f70: 0a0a 2020 2020 2020 2020 2320 5772 6974  ..        # Writ
-00025f80: 6520 7468 6520 636f 6e64 6974 696f 6e61  e the conditiona
-00025f90: 6c20 666f 726d 6174 732e 0a20 2020 2020  l formats..     
-00025fa0: 2020 2073 656c 662e 5f77 7269 7465 5f63     self._write_c
-00025fb0: 6f6e 6469 7469 6f6e 616c 5f66 6f72 6d61  onditional_forma
-00025fc0: 7473 2829 0a0a 2020 2020 2020 2020 2320  ts()..        # 
-00025fd0: 5772 6974 6520 7468 6520 6461 7461 5661  Write the dataVa
-00025fe0: 6c69 6461 7469 6f6e 7320 656c 656d 656e  lidations elemen
-00025ff0: 742e 0a20 2020 2020 2020 2073 656c 662e  t..        self.
-00026000: 5f77 7269 7465 5f64 6174 615f 7661 6c69  _write_data_vali
-00026010: 6461 7469 6f6e 7328 290a 0a20 2020 2020  dations()..     
-00026020: 2020 2023 2057 7269 7465 2074 6865 2068     # Write the h
-00026030: 7970 6572 6c69 6e6b 2065 6c65 6d65 6e74  yperlink element
-00026040: 2e0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-00026050: 7772 6974 655f 6879 7065 726c 696e 6b73  write_hyperlinks
-00026060: 2829 0a0a 2020 2020 2020 2020 2320 5772  ()..        # Wr
-00026070: 6974 6520 7468 6520 7072 696e 744f 7074  ite the printOpt
-00026080: 696f 6e73 2065 6c65 6d65 6e74 2e0a 2020  ions element..  
-00026090: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
-000260a0: 655f 7072 696e 745f 6f70 7469 6f6e 7328  e_print_options(
-000260b0: 290a 0a20 2020 2020 2020 2023 2057 7269  )..        # Wri
-000260c0: 7465 2074 6865 2077 6f72 6b73 6865 6574  te the worksheet
-000260d0: 2070 6167 655f 6d61 7267 696e 732e 0a20   page_margins.. 
-000260e0: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
-000260f0: 7465 5f70 6167 655f 6d61 7267 696e 7328  te_page_margins(
-00026100: 290a 0a20 2020 2020 2020 2023 2057 7269  )..        # Wri
-00026110: 7465 2074 6865 2077 6f72 6b73 6865 6574  te the worksheet
-00026120: 2070 6167 6520 7365 7475 702e 0a20 2020   page setup..   
-00026130: 2020 2020 2073 656c 662e 5f77 7269 7465       self._write
-00026140: 5f70 6167 655f 7365 7475 7028 290a 0a20  _page_setup().. 
-00026150: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
-00026160: 6865 2068 6561 6465 7246 6f6f 7465 7220  he headerFooter 
-00026170: 656c 656d 656e 742e 0a20 2020 2020 2020  element..       
-00026180: 2073 656c 662e 5f77 7269 7465 5f68 6561   self._write_hea
-00026190: 6465 725f 666f 6f74 6572 2829 0a0a 2020  der_footer()..  
-000261a0: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
-000261b0: 6520 726f 7742 7265 616b 7320 656c 656d  e rowBreaks elem
-000261c0: 656e 742e 0a20 2020 2020 2020 2073 656c  ent..        sel
-000261d0: 662e 5f77 7269 7465 5f72 6f77 5f62 7265  f._write_row_bre
-000261e0: 616b 7328 290a 0a20 2020 2020 2020 2023  aks()..        #
-000261f0: 2057 7269 7465 2074 6865 2063 6f6c 4272   Write the colBr
-00026200: 6561 6b73 2065 6c65 6d65 6e74 2e0a 2020  eaks element..  
-00026210: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
-00026220: 655f 636f 6c5f 6272 6561 6b73 2829 0a0a  e_col_breaks()..
-00026230: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
-00026240: 7468 6520 6967 6e6f 7265 6445 7272 6f72  the ignoredError
-00026250: 7320 656c 656d 656e 742e 0a20 2020 2020  s element..     
-00026260: 2020 2073 656c 662e 5f77 7269 7465 5f69     self._write_i
-00026270: 676e 6f72 6564 5f65 7272 6f72 7328 290a  gnored_errors().
-00026280: 0a20 2020 2020 2020 2023 2057 7269 7465  .        # Write
-00026290: 2074 6865 2064 7261 7769 6e67 2065 6c65   the drawing ele
-000262a0: 6d65 6e74 2e0a 2020 2020 2020 2020 7365  ment..        se
-000262b0: 6c66 2e5f 7772 6974 655f 6472 6177 696e  lf._write_drawin
-000262c0: 6773 2829 0a0a 2020 2020 2020 2020 2320  gs()..        # 
-000262d0: 5772 6974 6520 7468 6520 6c65 6761 6379  Write the legacy
-000262e0: 4472 6177 696e 6720 656c 656d 656e 742e  Drawing element.
-000262f0: 0a20 2020 2020 2020 2073 656c 662e 5f77  .        self._w
-00026300: 7269 7465 5f6c 6567 6163 795f 6472 6177  rite_legacy_draw
-00026310: 696e 6728 290a 0a20 2020 2020 2020 2023  ing()..        #
-00026320: 2057 7269 7465 2074 6865 206c 6567 6163   Write the legac
-00026330: 7944 7261 7769 6e67 4846 2065 6c65 6d65  yDrawingHF eleme
-00026340: 6e74 2e0a 2020 2020 2020 2020 7365 6c66  nt..        self
-00026350: 2e5f 7772 6974 655f 6c65 6761 6379 5f64  ._write_legacy_d
-00026360: 7261 7769 6e67 5f68 6628 290a 0a20 2020  rawing_hf()..   
-00026370: 2020 2020 2023 2057 7269 7465 2074 6865       # Write the
-00026380: 2070 6963 7475 7265 2065 6c65 6d65 6e74   picture element
-00026390: 2c20 666f 7220 7468 6520 6261 636b 6772  , for the backgr
-000263a0: 6f75 6e64 2e0a 2020 2020 2020 2020 7365  ound..        se
-000263b0: 6c66 2e5f 7772 6974 655f 7069 6374 7572  lf._write_pictur
-000263c0: 6528 290a 0a20 2020 2020 2020 2023 2057  e()..        # W
-000263d0: 7269 7465 2074 6865 2074 6162 6c65 5061  rite the tablePa
-000263e0: 7274 7320 656c 656d 656e 742e 0a20 2020  rts element..   
-000263f0: 2020 2020 2073 656c 662e 5f77 7269 7465       self._write
-00026400: 5f74 6162 6c65 5f70 6172 7473 2829 0a0a  _table_parts()..
-00026410: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
-00026420: 7468 6520 6578 744c 7374 2065 6c65 6d65  the extLst eleme
-00026430: 6e74 732e 0a20 2020 2020 2020 2073 656c  nts..        sel
-00026440: 662e 5f77 7269 7465 5f65 7874 5f6c 6973  f._write_ext_lis
-00026450: 7428 290a 0a20 2020 2020 2020 2023 2043  t()..        # C
-00026460: 6c6f 7365 2074 6865 2077 6f72 6b73 6865  lose the workshe
-00026470: 6574 2074 6167 2e0a 2020 2020 2020 2020  et tag..        
-00026480: 7365 6c66 2e5f 786d 6c5f 656e 645f 7461  self._xml_end_ta
-00026490: 6728 2777 6f72 6b73 6865 6574 2729 0a0a  g('worksheet')..
-000264a0: 2020 2020 2020 2020 2320 436c 6f73 6520          # Close 
-000264b0: 7468 6520 6669 6c65 2e0a 2020 2020 2020  the file..      
-000264c0: 2020 7365 6c66 2e5f 786d 6c5f 636c 6f73    self._xml_clos
-000264d0: 6528 290a 0a20 2020 2064 6566 205f 6368  e()..    def _ch
-000264e0: 6563 6b5f 6469 6d65 6e73 696f 6e73 2873  eck_dimensions(s
-000264f0: 656c 662c 2072 6f77 2c20 636f 6c2c 2069  elf, row, col, i
-00026500: 676e 6f72 655f 726f 773d 4661 6c73 652c  gnore_row=False,
-00026510: 2069 676e 6f72 655f 636f 6c3d 4661 6c73   ignore_col=Fals
-00026520: 6529 3a0a 2020 2020 2020 2020 2320 4368  e):.        # Ch
-00026530: 6563 6b20 7468 6174 2072 6f77 2061 6e64  eck that row and
-00026540: 2063 6f6c 2061 7265 2076 616c 6964 2061   col are valid a
-00026550: 6e64 2073 746f 7265 2074 6865 206d 6178  nd store the max
-00026560: 2061 6e64 206d 696e 0a20 2020 2020 2020   and min.       
-00026570: 2023 2076 616c 7565 7320 666f 7220 7573   # values for us
-00026580: 6520 696e 206f 7468 6572 206d 6574 686f  e in other metho
-00026590: 6473 2f65 6c65 6d65 6e74 732e 2054 6865  ds/elements. The
-000265a0: 2069 676e 6f72 655f 726f 7720 2f0a 2020   ignore_row /.  
-000265b0: 2020 2020 2020 2320 6967 6e6f 7265 5f63        # ignore_c
-000265c0: 6f6c 2066 6c61 6773 2069 7320 7573 6564  ol flags is used
-000265d0: 2074 6f20 696e 6469 6361 7465 2074 6861   to indicate tha
-000265e0: 7420 7765 2077 6973 6820 746f 2070 6572  t we wish to per
-000265f0: 666f 726d 0a20 2020 2020 2020 2023 2074  form.        # t
-00026600: 6865 2064 696d 656e 7369 6f6e 2063 6865  he dimension che
-00026610: 636b 2077 6974 686f 7574 2073 746f 7269  ck without stori
-00026620: 6e67 2074 6865 2076 616c 7565 2e20 5468  ng the value. Th
-00026630: 6520 6967 6e6f 7265 0a20 2020 2020 2020  e ignore.       
-00026640: 2023 2066 6c61 6773 2061 7265 2075 7365   # flags are use
-00026650: 2062 7920 7365 745f 726f 7728 2920 616e   by set_row() an
-00026660: 6420 6461 7461 5f76 616c 6964 6174 652e  d data_validate.
-00026670: 0a0a 2020 2020 2020 2020 2320 4368 6563  ..        # Chec
-00026680: 6b20 7468 6174 2074 6865 2072 6f77 2f63  k that the row/c
-00026690: 6f6c 2061 7265 2077 6974 6869 6e20 7468  ol are within th
-000266a0: 6520 776f 726b 7368 6565 7420 626f 756e  e worksheet boun
-000266b0: 6473 2e0a 2020 2020 2020 2020 6966 2072  ds..        if r
-000266c0: 6f77 203c 2030 206f 7220 636f 6c20 3c20  ow < 0 or col < 
-000266d0: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
-000266e0: 6574 7572 6e20 2d31 0a20 2020 2020 2020  eturn -1.       
-000266f0: 2069 6620 726f 7720 3e3d 2073 656c 662e   if row >= self.
-00026700: 786c 735f 726f 776d 6178 206f 7220 636f  xls_rowmax or co
-00026710: 6c20 3e3d 2073 656c 662e 786c 735f 636f  l >= self.xls_co
-00026720: 6c6d 6178 3a0a 2020 2020 2020 2020 2020  lmax:.          
-00026730: 2020 7265 7475 726e 202d 310a 0a20 2020    return -1..   
-00026740: 2020 2020 2023 2049 6e20 636f 6e73 7461       # In consta
-00026750: 6e74 5f6d 656d 6f72 7920 6d6f 6465 2077  nt_memory mode w
-00026760: 6520 646f 6e27 7420 6368 616e 6765 2064  e don't change d
-00026770: 696d 656e 7369 6f6e 7320 666f 7220 726f  imensions for ro
-00026780: 7773 0a20 2020 2020 2020 2023 2074 6861  ws.        # tha
-00026790: 7420 6172 6520 616c 7265 6164 7920 7772  t are already wr
-000267a0: 6974 7465 6e2e 0a20 2020 2020 2020 2069  itten..        i
-000267b0: 6620 6e6f 7420 6967 6e6f 7265 5f72 6f77  f not ignore_row
-000267c0: 2061 6e64 206e 6f74 2069 676e 6f72 655f   and not ignore_
-000267d0: 636f 6c20 616e 6420 7365 6c66 2e63 6f6e  col and self.con
-000267e0: 7374 616e 745f 6d65 6d6f 7279 3a0a 2020  stant_memory:.  
-000267f0: 2020 2020 2020 2020 2020 6966 2072 6f77            if row
-00026800: 203c 2073 656c 662e 7072 6576 696f 7573   < self.previous
-00026810: 5f72 6f77 3a0a 2020 2020 2020 2020 2020  _row:.          
-00026820: 2020 2020 2020 7265 7475 726e 202d 320a        return -2.
-00026830: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00026840: 6967 6e6f 7265 5f72 6f77 3a0a 2020 2020  ignore_row:.    
-00026850: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00026860: 6469 6d5f 726f 776d 696e 2069 7320 4e6f  dim_rowmin is No
-00026870: 6e65 206f 7220 726f 7720 3c20 7365 6c66  ne or row < self
-00026880: 2e64 696d 5f72 6f77 6d69 6e3a 0a20 2020  .dim_rowmin:.   
-00026890: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000268a0: 662e 6469 6d5f 726f 776d 696e 203d 2072  f.dim_rowmin = r
-000268b0: 6f77 0a20 2020 2020 2020 2020 2020 2069  ow.            i
-000268c0: 6620 7365 6c66 2e64 696d 5f72 6f77 6d61  f self.dim_rowma
-000268d0: 7820 6973 204e 6f6e 6520 6f72 2072 6f77  x is None or row
-000268e0: 203e 2073 656c 662e 6469 6d5f 726f 776d   > self.dim_rowm
-000268f0: 6178 3a0a 2020 2020 2020 2020 2020 2020  ax:.            
-00026900: 2020 2020 7365 6c66 2e64 696d 5f72 6f77      self.dim_row
-00026910: 6d61 7820 3d20 726f 770a 0a20 2020 2020  max = row..     
-00026920: 2020 2069 6620 6e6f 7420 6967 6e6f 7265     if not ignore
-00026930: 5f63 6f6c 3a0a 2020 2020 2020 2020 2020  _col:.          
-00026940: 2020 6966 2073 656c 662e 6469 6d5f 636f    if self.dim_co
-00026950: 6c6d 696e 2069 7320 4e6f 6e65 206f 7220  lmin is None or 
-00026960: 636f 6c20 3c20 7365 6c66 2e64 696d 5f63  col < self.dim_c
-00026970: 6f6c 6d69 6e3a 0a20 2020 2020 2020 2020  olmin:.         
-00026980: 2020 2020 2020 2073 656c 662e 6469 6d5f         self.dim_
-00026990: 636f 6c6d 696e 203d 2063 6f6c 0a20 2020  colmin = col.   
-000269a0: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-000269b0: 2e64 696d 5f63 6f6c 6d61 7820 6973 204e  .dim_colmax is N
-000269c0: 6f6e 6520 6f72 2063 6f6c 203e 2073 656c  one or col > sel
-000269d0: 662e 6469 6d5f 636f 6c6d 6178 3a0a 2020  f.dim_colmax:.  
-000269e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000269f0: 6c66 2e64 696d 5f63 6f6c 6d61 7820 3d20  lf.dim_colmax = 
-00026a00: 636f 6c0a 0a20 2020 2020 2020 2072 6574  col..        ret
-00026a10: 7572 6e20 300a 0a20 2020 2064 6566 205f  urn 0..    def _
-00026a20: 636f 6e76 6572 745f 6461 7465 5f74 696d  convert_date_tim
-00026a30: 6528 7365 6c66 2c20 6474 5f6f 626a 293a  e(self, dt_obj):
-00026a40: 0a20 2020 2020 2020 2023 2043 6f6e 7665  .        # Conve
-00026a50: 7274 2061 2064 6174 6574 696d 6520 6f62  rt a datetime ob
-00026a60: 6a65 6374 2074 6f20 616e 2045 7863 656c  ject to an Excel
-00026a70: 2073 6572 6961 6c20 6461 7465 2061 6e64   serial date and
-00026a80: 2074 696d 652e 0a20 2020 2020 2020 2072   time..        r
-00026a90: 6574 7572 6e20 6461 7465 7469 6d65 5f74  eturn datetime_t
-00026aa0: 6f5f 6578 6365 6c5f 6461 7465 7469 6d65  o_excel_datetime
-00026ab0: 2864 745f 6f62 6a2c 0a20 2020 2020 2020  (dt_obj,.       
-00026ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026ae0: 2020 2073 656c 662e 6461 7465 5f31 3930     self.date_190
-00026af0: 342c 0a20 2020 2020 2020 2020 2020 2020  4,.             
-00026b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026b10: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00026b20: 662e 7265 6d6f 7665 5f74 696d 657a 6f6e  f.remove_timezon
-00026b30: 6529 0a0a 2020 2020 6465 6620 5f63 6f6e  e)..    def _con
-00026b40: 7665 7274 5f6e 616d 655f 6172 6561 2873  vert_name_area(s
-00026b50: 656c 662c 2072 6f77 5f6e 756d 5f31 2c20  elf, row_num_1, 
-00026b60: 636f 6c5f 6e75 6d5f 312c 2072 6f77 5f6e  col_num_1, row_n
-00026b70: 756d 5f32 2c20 636f 6c5f 6e75 6d5f 3229  um_2, col_num_2)
-00026b80: 3a0a 2020 2020 2020 2020 2320 436f 6e76  :.        # Conv
-00026b90: 6572 7420 7a65 726f 2069 6e64 6578 6564  ert zero indexed
-00026ba0: 2072 6f77 7320 616e 6420 636f 6c75 6d6e   rows and column
-00026bb0: 7320 746f 2074 6865 2066 6f72 6d61 7420  s to the format 
-00026bc0: 7265 7175 6972 6564 2062 790a 2020 2020  required by.    
-00026bd0: 2020 2020 2320 776f 726b 7368 6565 7420      # worksheet 
-00026be0: 6e61 6d65 6420 7261 6e67 6573 2c20 6567  named ranges, eg
-00026bf0: 2c20 2253 6865 6574 3121 2441 2431 3a24  , "Sheet1!$A$1:$
-00026c00: 4324 3133 222e 0a0a 2020 2020 2020 2020  C$13"...        
-00026c10: 7261 6e67 6531 203d 2027 270a 2020 2020  range1 = ''.    
-00026c20: 2020 2020 7261 6e67 6532 203d 2027 270a      range2 = ''.
-00026c30: 2020 2020 2020 2020 6172 6561 203d 2027          area = '
-00026c40: 270a 2020 2020 2020 2020 726f 775f 636f  '.        row_co
-00026c50: 6c5f 6f6e 6c79 203d 2030 0a0a 2020 2020  l_only = 0..    
-00026c60: 2020 2020 2320 436f 6e76 6572 7420 746f      # Convert to
-00026c70: 2041 3120 6e6f 7461 7469 6f6e 2e0a 2020   A1 notation..  
-00026c80: 2020 2020 2020 636f 6c5f 6368 6172 5f31        col_char_1
-00026c90: 203d 2078 6c5f 636f 6c5f 746f 5f6e 616d   = xl_col_to_nam
-00026ca0: 6528 636f 6c5f 6e75 6d5f 312c 2031 290a  e(col_num_1, 1).
-00026cb0: 2020 2020 2020 2020 636f 6c5f 6368 6172          col_char
-00026cc0: 5f32 203d 2078 6c5f 636f 6c5f 746f 5f6e  _2 = xl_col_to_n
-00026cd0: 616d 6528 636f 6c5f 6e75 6d5f 322c 2031  ame(col_num_2, 1
-00026ce0: 290a 2020 2020 2020 2020 726f 775f 6368  ).        row_ch
-00026cf0: 6172 5f31 203d 2027 2427 202b 2073 7472  ar_1 = '$' + str
-00026d00: 2872 6f77 5f6e 756d 5f31 202b 2031 290a  (row_num_1 + 1).
-00026d10: 2020 2020 2020 2020 726f 775f 6368 6172          row_char
-00026d20: 5f32 203d 2027 2427 202b 2073 7472 2872  _2 = '$' + str(r
-00026d30: 6f77 5f6e 756d 5f32 202b 2031 290a 0a20  ow_num_2 + 1).. 
-00026d40: 2020 2020 2020 2023 2057 6520 6e65 6564         # We need
-00026d50: 2074 6f20 6861 6e64 6c65 2073 7065 6369   to handle speci
-00026d60: 616c 2063 6173 6573 2074 6861 7420 7265  al cases that re
-00026d70: 6665 7220 746f 2072 6f77 7320 6f72 2063  fer to rows or c
-00026d80: 6f6c 756d 6e73 206f 6e6c 792e 0a20 2020  olumns only..   
-00026d90: 2020 2020 2069 6620 726f 775f 6e75 6d5f       if row_num_
-00026da0: 3120 3d3d 2030 2061 6e64 2072 6f77 5f6e  1 == 0 and row_n
-00026db0: 756d 5f32 203d 3d20 7365 6c66 2e78 6c73  um_2 == self.xls
-00026dc0: 5f72 6f77 6d61 7820 2d20 313a 0a20 2020  _rowmax - 1:.   
-00026dd0: 2020 2020 2020 2020 2072 616e 6765 3120           range1 
-00026de0: 3d20 636f 6c5f 6368 6172 5f31 0a20 2020  = col_char_1.   
-00026df0: 2020 2020 2020 2020 2072 616e 6765 3220           range2 
-00026e00: 3d20 636f 6c5f 6368 6172 5f32 0a20 2020  = col_char_2.   
-00026e10: 2020 2020 2020 2020 2072 6f77 5f63 6f6c           row_col
-00026e20: 5f6f 6e6c 7920 3d20 310a 2020 2020 2020  _only = 1.      
-00026e30: 2020 656c 6966 2063 6f6c 5f6e 756d 5f31    elif col_num_1
-00026e40: 203d 3d20 3020 616e 6420 636f 6c5f 6e75   == 0 and col_nu
-00026e50: 6d5f 3220 3d3d 2073 656c 662e 786c 735f  m_2 == self.xls_
-00026e60: 636f 6c6d 6178 202d 2031 3a0a 2020 2020  colmax - 1:.    
-00026e70: 2020 2020 2020 2020 7261 6e67 6531 203d          range1 =
-00026e80: 2072 6f77 5f63 6861 725f 310a 2020 2020   row_char_1.    
-00026e90: 2020 2020 2020 2020 7261 6e67 6532 203d          range2 =
-00026ea0: 2072 6f77 5f63 6861 725f 320a 2020 2020   row_char_2.    
-00026eb0: 2020 2020 2020 2020 726f 775f 636f 6c5f          row_col_
-00026ec0: 6f6e 6c79 203d 2031 0a20 2020 2020 2020  only = 1.       
-00026ed0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00026ee0: 2020 2072 616e 6765 3120 3d20 636f 6c5f     range1 = col_
-00026ef0: 6368 6172 5f31 202b 2072 6f77 5f63 6861  char_1 + row_cha
-00026f00: 725f 310a 2020 2020 2020 2020 2020 2020  r_1.            
-00026f10: 7261 6e67 6532 203d 2063 6f6c 5f63 6861  range2 = col_cha
-00026f20: 725f 3220 2b20 726f 775f 6368 6172 5f32  r_2 + row_char_2
-00026f30: 0a0a 2020 2020 2020 2020 2320 4120 7265  ..        # A re
-00026f40: 7065 6174 6564 2072 616e 6765 2069 7320  peated range is 
-00026f50: 6f6e 6c79 2077 7269 7474 656e 206f 6e63  only written onc
-00026f60: 6520 2869 6620 6974 2069 736e 2774 2061  e (if it isn't a
-00026f70: 2073 7065 6369 616c 2063 6173 6529 2e0a   special case)..
-00026f80: 2020 2020 2020 2020 6966 2072 616e 6765          if range
-00026f90: 3120 3d3d 2072 616e 6765 3220 616e 6420  1 == range2 and 
-00026fa0: 6e6f 7420 726f 775f 636f 6c5f 6f6e 6c79  not row_col_only
-00026fb0: 3a0a 2020 2020 2020 2020 2020 2020 6172  :.            ar
-00026fc0: 6561 203d 2072 616e 6765 310a 2020 2020  ea = range1.    
-00026fd0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00026fe0: 2020 2020 2020 6172 6561 203d 2072 616e        area = ran
-00026ff0: 6765 3120 2b20 273a 2720 2b20 7261 6e67  ge1 + ':' + rang
-00027000: 6532 0a0a 2020 2020 2020 2020 2320 4275  e2..        # Bu
-00027010: 696c 6420 7570 2074 6865 2070 7269 6e74  ild up the print
-00027020: 2061 7265 6120 7261 6e67 6520 2253 6865   area range "She
-00027030: 6574 3121 2441 2431 3a24 4324 3133 222e  et1!$A$1:$C$13".
-00027040: 0a20 2020 2020 2020 2073 6865 6574 6e61  .        sheetna
-00027050: 6d65 203d 2071 756f 7465 5f73 6865 6574  me = quote_sheet
-00027060: 6e61 6d65 2873 656c 662e 6e61 6d65 290a  name(self.name).
-00027070: 2020 2020 2020 2020 6172 6561 203d 2073          area = s
-00027080: 6865 6574 6e61 6d65 202b 2022 2122 202b  heetname + "!" +
-00027090: 2061 7265 610a 0a20 2020 2020 2020 2072   area..        r
-000270a0: 6574 7572 6e20 6172 6561 0a0a 2020 2020  eturn area..    
-000270b0: 6465 6620 5f73 6f72 745f 7061 6765 6272  def _sort_pagebr
-000270c0: 6561 6b73 2873 656c 662c 2062 7265 616b  eaks(self, break
-000270d0: 7329 3a0a 2020 2020 2020 2020 2320 5468  s):.        # Th
-000270e0: 6973 2069 7320 616e 2069 6e74 6572 6e61  is is an interna
-000270f0: 6c20 6d65 7468 6f64 2075 7365 6420 746f  l method used to
-00027100: 2066 696c 7465 7220 656c 656d 656e 7473   filter elements
-00027110: 206f 6620 6120 6c69 7374 206f 660a 2020   of a list of.  
-00027120: 2020 2020 2020 2320 7061 6765 6272 6561        # pagebrea
-00027130: 6b73 2075 7365 6420 696e 2074 6865 205f  ks used in the _
-00027140: 7374 6f72 655f 6862 7265 616b 2829 2061  store_hbreak() a
-00027150: 6e64 205f 7374 6f72 655f 7662 7265 616b  nd _store_vbreak
-00027160: 2829 206d 6574 686f 6473 2e0a 2020 2020  () methods..    
-00027170: 2020 2020 2320 4974 3a0a 2020 2020 2020      # It:.      
-00027180: 2020 2320 2020 312e 2052 656d 6f76 6573    #   1. Removes
-00027190: 2064 7570 6c69 6361 7465 2065 6e74 7269   duplicate entri
-000271a0: 6573 2066 726f 6d20 7468 6520 6c69 7374  es from the list
-000271b0: 2e0a 2020 2020 2020 2020 2320 2020 322e  ..        #   2.
-000271c0: 2053 6f72 7473 2074 6865 206c 6973 742e   Sorts the list.
-000271d0: 0a20 2020 2020 2020 2023 2020 2033 2e20  .        #   3. 
-000271e0: 5265 6d6f 7665 7320 3020 6672 6f6d 2074  Removes 0 from t
-000271f0: 6865 206c 6973 7420 6966 2070 7265 7365  he list if prese
-00027200: 6e74 2e0a 2020 2020 2020 2020 6966 206e  nt..        if n
-00027210: 6f74 2062 7265 616b 733a 0a20 2020 2020  ot breaks:.     
-00027220: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
-00027230: 2020 2020 2020 2062 7265 616b 735f 7365         breaks_se
-00027240: 7420 3d20 7365 7428 6272 6561 6b73 290a  t = set(breaks).
-00027250: 0a20 2020 2020 2020 2069 6620 3020 696e  .        if 0 in
-00027260: 2062 7265 616b 735f 7365 743a 0a20 2020   breaks_set:.   
-00027270: 2020 2020 2020 2020 2062 7265 616b 735f           breaks_
-00027280: 7365 742e 7265 6d6f 7665 2830 290a 0a20  set.remove(0).. 
-00027290: 2020 2020 2020 2062 7265 616b 735f 6c69         breaks_li
-000272a0: 7374 203d 206c 6973 7428 6272 6561 6b73  st = list(breaks
-000272b0: 5f73 6574 290a 2020 2020 2020 2020 6272  _set).        br
-000272c0: 6561 6b73 5f6c 6973 742e 736f 7274 2829  eaks_list.sort()
-000272d0: 0a0a 2020 2020 2020 2020 2320 5468 6520  ..        # The 
-000272e0: 4578 6365 6c20 3230 3037 2073 7065 6369  Excel 2007 speci
-000272f0: 6669 6361 7469 6f6e 2073 6179 7320 7468  fication says th
-00027300: 6174 2074 6865 206d 6178 696d 756d 206e  at the maximum n
-00027310: 756d 6265 7220 6f66 2070 6167 650a 2020  umber of page.  
-00027320: 2020 2020 2020 2320 6272 6561 6b73 2069        # breaks i
-00027330: 7320 3130 3236 2e20 486f 7765 7665 722c  s 1026. However,
-00027340: 2069 6e20 7072 6163 7469 6365 2069 7420   in practice it 
-00027350: 6973 2061 6374 7561 6c6c 7920 3130 3233  is actually 1023
-00027360: 2e0a 2020 2020 2020 2020 6d61 785f 6e75  ..        max_nu
-00027370: 6d5f 6272 6561 6b73 203d 2031 3032 330a  m_breaks = 1023.
-00027380: 2020 2020 2020 2020 6966 206c 656e 2862          if len(b
-00027390: 7265 616b 735f 6c69 7374 2920 3e20 6d61  reaks_list) > ma
-000273a0: 785f 6e75 6d5f 6272 6561 6b73 3a0a 2020  x_num_breaks:.  
-000273b0: 2020 2020 2020 2020 2020 6272 6561 6b73            breaks
-000273c0: 5f6c 6973 7420 3d20 6272 6561 6b73 5f6c  _list = breaks_l
-000273d0: 6973 745b 3a6d 6178 5f6e 756d 5f62 7265  ist[:max_num_bre
-000273e0: 616b 735d 0a0a 2020 2020 2020 2020 7265  aks]..        re
-000273f0: 7475 726e 2062 7265 616b 735f 6c69 7374  turn breaks_list
-00027400: 0a0a 2020 2020 6465 6620 5f65 7874 7261  ..    def _extra
-00027410: 6374 5f66 696c 7465 725f 746f 6b65 6e73  ct_filter_tokens
-00027420: 2873 656c 662c 2065 7870 7265 7373 696f  (self, expressio
-00027430: 6e29 3a0a 2020 2020 2020 2020 2320 4578  n):.        # Ex
-00027440: 7472 6163 7420 7468 6520 746f 6b65 6e73  tract the tokens
-00027450: 2066 726f 6d20 7468 6520 6669 6c74 6572   from the filter
-00027460: 2065 7870 7265 7373 696f 6e2e 2054 6865   expression. The
-00027470: 2074 6f6b 656e 7320 6172 6520 6d61 696e   tokens are main
-00027480: 6c79 0a20 2020 2020 2020 2023 206e 6f6e  ly.        # non
-00027490: 2d77 6869 7465 7370 6163 6520 6772 6f75  -whitespace grou
-000274a0: 7073 2e20 5468 6520 6f6e 6c79 2074 7269  ps. The only tri
-000274b0: 636b 7920 7061 7274 2069 7320 746f 2065  cky part is to e
-000274c0: 7874 7261 6374 2073 7472 696e 670a 2020  xtract string.  
-000274d0: 2020 2020 2020 2320 746f 6b65 6e73 2074        # tokens t
-000274e0: 6861 7420 636f 6e74 6169 6e20 7768 6974  hat contain whit
-000274f0: 6573 7061 6365 2061 6e64 2f6f 7220 7175  espace and/or qu
-00027500: 6f74 6564 2064 6f75 626c 6520 7175 6f74  oted double quot
-00027510: 6573 2028 4578 6365 6c27 730a 2020 2020  es (Excel's.    
-00027520: 2020 2020 2320 6573 6361 7065 6420 7175      # escaped qu
-00027530: 6f74 6573 292e 0a20 2020 2020 2020 2023  otes)..        #
-00027540: 0a20 2020 2020 2020 2023 2045 7861 6d70  .        # Examp
-00027550: 6c65 733a 2027 7820 3c20 2032 3030 3027  les: 'x <  2000'
-00027560: 0a20 2020 2020 2020 2023 2020 2020 2020  .        #      
-00027570: 2020 2020 2027 7820 3e20 2032 3030 3020       'x >  2000 
-00027580: 616e 6420 7820 3c20 2035 3030 3027 0a20  and x <  5000'. 
-00027590: 2020 2020 2020 2023 2020 2020 2020 2020         #        
-000275a0: 2020 2027 7820 3d20 2266 6f6f 2227 0a20     'x = "foo"'. 
-000275b0: 2020 2020 2020 2023 2020 2020 2020 2020         #        
-000275c0: 2020 2027 7820 3d20 2266 6f6f 2062 6172     'x = "foo bar
-000275d0: 2227 0a20 2020 2020 2020 2023 2020 2020  "'.        #    
-000275e0: 2020 2020 2020 2027 7820 3d20 2266 6f6f         'x = "foo
-000275f0: 2022 2220 6261 7222 270a 2020 2020 2020   "" bar"'.      
-00027600: 2020 230a 2020 2020 2020 2020 6966 206e    #.        if n
-00027610: 6f74 2065 7870 7265 7373 696f 6e3a 0a20  ot expression:. 
-00027620: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00027630: 6e20 5b5d 0a0a 2020 2020 2020 2020 746f  n []..        to
-00027640: 6b65 6e5f 7265 203d 2072 652e 636f 6d70  ken_re = re.comp
-00027650: 696c 6528 7227 2228 3f3a 5b5e 225d 7c22  ile(r'"(?:[^"]|"
-00027660: 2229 2a22 7c5c 532b 2729 0a20 2020 2020  ")*"|\S+').     
-00027670: 2020 2074 6f6b 656e 7320 3d20 746f 6b65     tokens = toke
-00027680: 6e5f 7265 2e66 696e 6461 6c6c 2865 7870  n_re.findall(exp
-00027690: 7265 7373 696f 6e29 0a0a 2020 2020 2020  ression)..      
-000276a0: 2020 6e65 775f 746f 6b65 6e73 203d 205b    new_tokens = [
-000276b0: 5d0a 2020 2020 2020 2020 2320 5265 6d6f  ].        # Remo
-000276c0: 7665 2073 696e 676c 6520 6c65 6164 696e  ve single leadin
-000276d0: 6720 616e 6420 7472 6169 6c69 6e67 2071  g and trailing q
-000276e0: 756f 7465 7320 616e 6420 756e 2d65 7363  uotes and un-esc
-000276f0: 6170 6520 6f74 6865 7220 7175 6f74 6573  ape other quotes
-00027700: 2e0a 2020 2020 2020 2020 666f 7220 746f  ..        for to
-00027710: 6b65 6e20 696e 2074 6f6b 656e 733a 0a20  ken in tokens:. 
-00027720: 2020 2020 2020 2020 2020 2069 6620 746f             if to
-00027730: 6b65 6e2e 7374 6172 7473 7769 7468 2827  ken.startswith('
-00027740: 2227 293a 0a20 2020 2020 2020 2020 2020  "'):.           
-00027750: 2020 2020 2074 6f6b 656e 203d 2074 6f6b       token = tok
-00027760: 656e 5b31 3a5d 0a0a 2020 2020 2020 2020  en[1:]..        
-00027770: 2020 2020 6966 2074 6f6b 656e 2e65 6e64      if token.end
-00027780: 7377 6974 6828 2722 2729 3a0a 2020 2020  swith('"'):.    
-00027790: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
-000277a0: 6e20 3d20 746f 6b65 6e5b 3a2d 315d 0a0a  n = token[:-1]..
-000277b0: 2020 2020 2020 2020 2020 2020 746f 6b65              toke
-000277c0: 6e20 3d20 746f 6b65 6e2e 7265 706c 6163  n = token.replac
-000277d0: 6528 2722 2227 2c20 2722 2729 0a0a 2020  e('""', '"')..  
-000277e0: 2020 2020 2020 2020 2020 6e65 775f 746f            new_to
-000277f0: 6b65 6e73 2e61 7070 656e 6428 746f 6b65  kens.append(toke
-00027800: 6e29 0a0a 2020 2020 2020 2020 7265 7475  n)..        retu
-00027810: 726e 206e 6577 5f74 6f6b 656e 730a 0a20  rn new_tokens.. 
-00027820: 2020 2064 6566 205f 7061 7273 655f 6669     def _parse_fi
-00027830: 6c74 6572 5f65 7870 7265 7373 696f 6e28  lter_expression(
-00027840: 7365 6c66 2c20 6578 7072 6573 7369 6f6e  self, expression
-00027850: 2c20 746f 6b65 6e73 293a 0a20 2020 2020  , tokens):.     
-00027860: 2020 2023 2043 6f6e 7665 7274 7320 7468     # Converts th
-00027870: 6520 746f 6b65 6e73 206f 6620 6120 706f  e tokens of a po
-00027880: 7373 6962 6c79 2063 6f6e 6469 7469 6f6e  ssibly condition
-00027890: 616c 2065 7870 7265 7373 696f 6e20 696e  al expression in
-000278a0: 746f 2031 206f 7220 320a 2020 2020 2020  to 1 or 2.      
-000278b0: 2020 2320 7375 6220 6578 7072 6573 7369    # sub expressi
-000278c0: 6f6e 7320 666f 7220 6675 7274 6865 7220  ons for further 
-000278d0: 7061 7273 696e 672e 0a20 2020 2020 2020  parsing..       
-000278e0: 2023 0a20 2020 2020 2020 2023 2045 7861   #.        # Exa
-000278f0: 6d70 6c65 733a 0a20 2020 2020 2020 2023  mples:.        #
-00027900: 2020 2020 2020 2020 2020 2827 7827 2c20            ('x', 
-00027910: 273d 3d27 2c20 3230 3030 2920 2d3e 2065  '==', 2000) -> e
-00027920: 7870 310a 2020 2020 2020 2020 2320 2020  xp1.        #   
-00027930: 2020 2020 2020 2028 2778 272c 2027 3e27         ('x', '>'
-00027940: 2c20 2032 3030 302c 2027 616e 6427 2c20  ,  2000, 'and', 
-00027950: 2778 272c 2027 3c27 2c20 3530 3030 2920  'x', '<', 5000) 
-00027960: 2d3e 2065 7870 3120 616e 6420 6578 7032  -> exp1 and exp2
-00027970: 0a0a 2020 2020 2020 2020 6966 206c 656e  ..        if len
-00027980: 2874 6f6b 656e 7329 203d 3d20 373a 0a20  (tokens) == 7:. 
-00027990: 2020 2020 2020 2020 2020 2023 2054 6865             # The
-000279a0: 206e 756d 6265 7220 6f66 2074 6f6b 656e   number of token
-000279b0: 7320 7769 6c6c 2062 6520 6569 7468 6572  s will be either
-000279c0: 2033 2028 666f 7220 3120 6578 7072 6573   3 (for 1 expres
-000279d0: 7369 6f6e 290a 2020 2020 2020 2020 2020  sion).          
-000279e0: 2020 2320 6f72 2037 2028 666f 7220 3220    # or 7 (for 2 
-000279f0: 2065 7870 7265 7373 696f 6e73 292e 0a20   expressions).. 
-00027a00: 2020 2020 2020 2020 2020 2063 6f6e 6469             condi
-00027a10: 7469 6f6e 616c 203d 2074 6f6b 656e 735b  tional = tokens[
-00027a20: 335d 0a0a 2020 2020 2020 2020 2020 2020  3]..            
-00027a30: 6966 2072 652e 6d61 7463 6828 2728 616e  if re.match('(an
-00027a40: 647c 2626 2927 2c20 636f 6e64 6974 696f  d|&&)', conditio
-00027a50: 6e61 6c29 3a0a 2020 2020 2020 2020 2020  nal):.          
-00027a60: 2020 2020 2020 636f 6e64 6974 696f 6e61        conditiona
-00027a70: 6c20 3d20 300a 2020 2020 2020 2020 2020  l = 0.          
-00027a80: 2020 656c 6966 2072 652e 6d61 7463 6828    elif re.match(
-00027a90: 7227 286f 727c 5c7c 5c7c 2927 2c20 636f  r'(or|\|\|)', co
-00027aa0: 6e64 6974 696f 6e61 6c29 3a0a 2020 2020  nditional):.    
-00027ab0: 2020 2020 2020 2020 2020 2020 636f 6e64              cond
-00027ac0: 6974 696f 6e61 6c20 3d20 310a 2020 2020  itional = 1.    
-00027ad0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00027ae0: 2020 2020 2020 2020 2020 2020 2020 7761                wa
-00027af0: 726e 2822 546f 6b65 6e20 2725 7327 2069  rn("Token '%s' i
-00027b00: 7320 6e6f 7420 6120 7661 6c69 6420 636f  s not a valid co
-00027b10: 6e64 6974 696f 6e61 6c20 220a 2020 2020  nditional ".    
-00027b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027b30: 2022 696e 2066 696c 7465 7220 6578 7072   "in filter expr
-00027b40: 6573 7369 6f6e 2027 2573 2722 2025 2028  ession '%s'" % (
-00027b50: 636f 6e64 6974 696f 6e61 6c2c 2065 7870  conditional, exp
-00027b60: 7265 7373 696f 6e29 290a 0a20 2020 2020  ression))..     
-00027b70: 2020 2020 2020 2065 7870 7265 7373 696f         expressio
-00027b80: 6e5f 3120 3d20 7365 6c66 2e5f 7061 7273  n_1 = self._pars
-00027b90: 655f 6669 6c74 6572 5f74 6f6b 656e 7328  e_filter_tokens(
-00027ba0: 6578 7072 6573 7369 6f6e 2c20 746f 6b65  expression, toke
-00027bb0: 6e73 5b30 3a33 5d29 0a20 2020 2020 2020  ns[0:3]).       
-00027bc0: 2020 2020 2065 7870 7265 7373 696f 6e5f       expression_
-00027bd0: 3220 3d20 7365 6c66 2e5f 7061 7273 655f  2 = self._parse_
-00027be0: 6669 6c74 6572 5f74 6f6b 656e 7328 6578  filter_tokens(ex
-00027bf0: 7072 6573 7369 6f6e 2c20 746f 6b65 6e73  pression, tokens
-00027c00: 5b34 3a37 5d29 0a0a 2020 2020 2020 2020  [4:7])..        
-00027c10: 2020 2020 7265 7475 726e 2065 7870 7265      return expre
-00027c20: 7373 696f 6e5f 3120 2b20 5b63 6f6e 6469  ssion_1 + [condi
-00027c30: 7469 6f6e 616c 5d20 2b20 6578 7072 6573  tional] + expres
-00027c40: 7369 6f6e 5f32 0a20 2020 2020 2020 2065  sion_2.        e
-00027c50: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00027c60: 2072 6574 7572 6e20 7365 6c66 2e5f 7061   return self._pa
-00027c70: 7273 655f 6669 6c74 6572 5f74 6f6b 656e  rse_filter_token
-00027c80: 7328 6578 7072 6573 7369 6f6e 2c20 746f  s(expression, to
-00027c90: 6b65 6e73 290a 0a20 2020 2064 6566 205f  kens)..    def _
-00027ca0: 7061 7273 655f 6669 6c74 6572 5f74 6f6b  parse_filter_tok
-00027cb0: 656e 7328 7365 6c66 2c20 6578 7072 6573  ens(self, expres
-00027cc0: 7369 6f6e 2c20 746f 6b65 6e73 293a 0a20  sion, tokens):. 
-00027cd0: 2020 2020 2020 2023 2050 6172 7365 2074         # Parse t
-00027ce0: 6865 2033 2074 6f6b 656e 7320 6f66 2061  he 3 tokens of a
-00027cf0: 2066 696c 7465 7220 6578 7072 6573 7369   filter expressi
-00027d00: 6f6e 2061 6e64 2072 6574 7572 6e20 7468  on and return th
-00027d10: 6520 6f70 6572 6174 6f72 0a20 2020 2020  e operator.     
-00027d20: 2020 2023 2061 6e64 2074 6f6b 656e 2e20     # and token. 
-00027d30: 5468 6520 7573 6520 6f66 206e 756d 6265  The use of numbe
-00027d40: 7273 2069 6e73 7465 6164 206f 6620 6f70  rs instead of op
-00027d50: 6572 6174 6f72 7320 6973 2061 206c 6567  erators is a leg
-00027d60: 6163 7920 6f66 0a20 2020 2020 2020 2023  acy of.        #
-00027d70: 2053 7072 6561 6473 6865 6574 3a3a 5772   Spreadsheet::Wr
-00027d80: 6974 6545 7863 656c 2e0a 2020 2020 2020  iteExcel..      
-00027d90: 2020 6f70 6572 6174 6f72 7320 3d20 7b0a    operators = {.
-00027da0: 2020 2020 2020 2020 2020 2020 273d 3d27              '=='
-00027db0: 3a20 322c 0a20 2020 2020 2020 2020 2020  : 2,.           
-00027dc0: 2027 3d27 3a20 322c 0a20 2020 2020 2020   '=': 2,.       
-00027dd0: 2020 2020 2027 3d7e 273a 2032 2c0a 2020       '=~': 2,.  
-00027de0: 2020 2020 2020 2020 2020 2765 7127 3a20            'eq': 
-00027df0: 322c 0a0a 2020 2020 2020 2020 2020 2020  2,..            
-00027e00: 2721 3d27 3a20 352c 0a20 2020 2020 2020  '!=': 5,.       
-00027e10: 2020 2020 2027 217e 273a 2035 2c0a 2020       '!~': 5,.  
-00027e20: 2020 2020 2020 2020 2020 276e 6527 3a20            'ne': 
-00027e30: 352c 0a20 2020 2020 2020 2020 2020 2027  5,.            '
-00027e40: 3c3e 273a 2035 2c0a 0a20 2020 2020 2020  <>': 5,..       
-00027e50: 2020 2020 2027 3c27 3a20 312c 0a20 2020       '<': 1,.   
-00027e60: 2020 2020 2020 2020 2027 3c3d 273a 2033           '<=': 3
-00027e70: 2c0a 2020 2020 2020 2020 2020 2020 273e  ,.            '>
-00027e80: 273a 2034 2c0a 2020 2020 2020 2020 2020  ': 4,.          
-00027e90: 2020 273e 3d27 3a20 362c 0a20 2020 2020    '>=': 6,.     
-00027ea0: 2020 207d 0a0a 2020 2020 2020 2020 6f70     }..        op
-00027eb0: 6572 6174 6f72 203d 206f 7065 7261 746f  erator = operato
-00027ec0: 7273 2e67 6574 2874 6f6b 656e 735b 315d  rs.get(tokens[1]
-00027ed0: 2c20 4e6f 6e65 290a 2020 2020 2020 2020  , None).        
-00027ee0: 746f 6b65 6e20 3d20 746f 6b65 6e73 5b32  token = tokens[2
-00027ef0: 5d0a 0a20 2020 2020 2020 2023 2053 7065  ]..        # Spe
-00027f00: 6369 616c 2068 616e 646c 696e 6720 6f66  cial handling of
-00027f10: 2022 546f 7022 2066 696c 7465 7220 6578   "Top" filter ex
-00027f20: 7072 6573 7369 6f6e 732e 0a20 2020 2020  pressions..     
-00027f30: 2020 2069 6620 7265 2e6d 6174 6368 2827     if re.match('
-00027f40: 746f 707c 626f 7474 6f6d 272c 2074 6f6b  top|bottom', tok
-00027f50: 656e 735b 305d 2e6c 6f77 6572 2829 293a  ens[0].lower()):
-00027f60: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
-00027f70: 7565 203d 2069 6e74 2874 6f6b 656e 735b  ue = int(tokens[
-00027f80: 315d 290a 0a20 2020 2020 2020 2020 2020  1])..           
-00027f90: 2069 6620 7661 6c75 6520 3c20 3120 6f72   if value < 1 or
-00027fa0: 2076 616c 7565 203e 2035 3030 3a0a 2020   value > 500:.  
-00027fb0: 2020 2020 2020 2020 2020 2020 2020 7761                wa
-00027fc0: 726e 2822 5468 6520 7661 6c75 6520 2725  rn("The value '%
-00027fd0: 6427 2069 6e20 6578 7072 6573 7369 6f6e  d' in expression
-00027fe0: 2027 2573 2720 220a 2020 2020 2020 2020   '%s' ".        
-00027ff0: 2020 2020 2020 2020 2020 2020 2022 6d75               "mu
-00028000: 7374 2062 6520 696e 2074 6865 2072 616e  st be in the ran
-00028010: 6765 2031 2074 6f20 3530 3022 2025 2028  ge 1 to 500" % (
-00028020: 7661 6c75 652c 2065 7870 7265 7373 696f  value, expressio
-00028030: 6e29 290a 0a20 2020 2020 2020 2020 2020  n))..           
-00028040: 2074 6f6b 656e 203d 2074 6f6b 656e 2e6c   token = token.l
-00028050: 6f77 6572 2829 0a0a 2020 2020 2020 2020  ower()..        
-00028060: 2020 2020 6966 2074 6f6b 656e 2021 3d20      if token != 
-00028070: 2769 7465 6d73 2720 616e 6420 746f 6b65  'items' and toke
-00028080: 6e20 213d 2027 2527 3a0a 2020 2020 2020  n != '%':.      
-00028090: 2020 2020 2020 2020 2020 7761 726e 2822            warn("
-000280a0: 5468 6520 7479 7065 2027 2573 2720 696e  The type '%s' in
-000280b0: 2065 7870 7265 7373 696f 6e20 2725 7327   expression '%s'
-000280c0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-000280d0: 2020 2020 2020 2020 226d 7573 7420 6265          "must be
-000280e0: 2065 6974 6865 7220 2769 7465 6d73 2720   either 'items' 
-000280f0: 6f72 2027 2525 2722 2025 2028 746f 6b65  or '%%'" % (toke
-00028100: 6e2c 2065 7870 7265 7373 696f 6e29 290a  n, expression)).
-00028110: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00028120: 746f 6b65 6e73 5b30 5d2e 6c6f 7765 7228  tokens[0].lower(
-00028130: 2920 3d3d 2027 746f 7027 3a0a 2020 2020  ) == 'top':.    
-00028140: 2020 2020 2020 2020 2020 2020 6f70 6572              oper
-00028150: 6174 6f72 203d 2033 300a 2020 2020 2020  ator = 30.      
-00028160: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00028170: 2020 2020 2020 2020 2020 2020 6f70 6572              oper
-00028180: 6174 6f72 203d 2033 320a 0a20 2020 2020  ator = 32..     
-00028190: 2020 2020 2020 2069 6620 746f 6b65 6e73         if tokens
-000281a0: 5b32 5d20 3d3d 2027 2527 3a0a 2020 2020  [2] == '%':.    
-000281b0: 2020 2020 2020 2020 2020 2020 6f70 6572              oper
-000281c0: 6174 6f72 202b 3d20 310a 0a20 2020 2020  ator += 1..     
-000281d0: 2020 2020 2020 2074 6f6b 656e 203d 2073         token = s
-000281e0: 7472 2876 616c 7565 290a 0a20 2020 2020  tr(value)..     
-000281f0: 2020 2069 6620 6e6f 7420 6f70 6572 6174     if not operat
-00028200: 6f72 2061 6e64 2074 6f6b 656e 735b 305d  or and tokens[0]
-00028210: 3a0a 2020 2020 2020 2020 2020 2020 7761  :.            wa
-00028220: 726e 2822 546f 6b65 6e20 2725 7327 2069  rn("Token '%s' i
-00028230: 7320 6e6f 7420 6120 7661 6c69 6420 6f70  s not a valid op
-00028240: 6572 6174 6f72 2022 0a20 2020 2020 2020  erator ".       
-00028250: 2020 2020 2020 2020 2020 2269 6e20 6669            "in fi
-00028260: 6c74 6572 2065 7870 7265 7373 696f 6e20  lter expression 
-00028270: 2725 7327 2220 2520 2874 6f6b 656e 5b30  '%s'" % (token[0
-00028280: 5d2c 2065 7870 7265 7373 696f 6e29 290a  ], expression)).
-00028290: 0a20 2020 2020 2020 2023 2053 7065 6369  .        # Speci
-000282a0: 616c 2068 616e 646c 696e 6720 666f 7220  al handling for 
-000282b0: 426c 616e 6b73 2f4e 6f6e 426c 616e 6b73  Blanks/NonBlanks
-000282c0: 2e0a 2020 2020 2020 2020 6966 2072 652e  ..        if re.
-000282d0: 6d61 7463 6828 2762 6c61 6e6b 737c 6e6f  match('blanks|no
-000282e0: 6e62 6c61 6e6b 7327 2c20 746f 6b65 6e2e  nblanks', token.
-000282f0: 6c6f 7765 7228 2929 3a0a 2020 2020 2020  lower()):.      
-00028300: 2020 2020 2020 2320 4f6e 6c79 2061 6c6c        # Only all
-00028310: 6f77 2045 7175 616c 7320 6f72 204e 6f74  ow Equals or Not
-00028320: 4571 7561 6c20 696e 2074 6869 7320 636f  Equal in this co
-00028330: 6e74 6578 742e 0a20 2020 2020 2020 2020  ntext..         
-00028340: 2020 2069 6620 6f70 6572 6174 6f72 2021     if operator !
-00028350: 3d20 3220 616e 6420 6f70 6572 6174 6f72  = 2 and operator
-00028360: 2021 3d20 353a 0a20 2020 2020 2020 2020   != 5:.         
-00028370: 2020 2020 2020 2077 6172 6e28 2254 6865         warn("The
-00028380: 206f 7065 7261 746f 7220 2725 7327 2069   operator '%s' i
-00028390: 6e20 6578 7072 6573 7369 6f6e 2027 2573  n expression '%s
-000283a0: 2720 220a 2020 2020 2020 2020 2020 2020  ' ".            
-000283b0: 2020 2020 2020 2020 2022 6973 206e 6f74           "is not
-000283c0: 2076 616c 6964 2069 6e20 7265 6c61 7469   valid in relati
-000283d0: 6f6e 2074 6f20 426c 616e 6b73 2f4e 6f6e  on to Blanks/Non
-000283e0: 426c 616e 6b73 2722 0a20 2020 2020 2020  Blanks'".       
-000283f0: 2020 2020 2020 2020 2020 2020 2020 2520                % 
-00028400: 2874 6f6b 656e 735b 315d 2c20 6578 7072  (tokens[1], expr
-00028410: 6573 7369 6f6e 2929 0a0a 2020 2020 2020  ession))..      
-00028420: 2020 2020 2020 746f 6b65 6e20 3d20 746f        token = to
-00028430: 6b65 6e2e 6c6f 7765 7228 290a 0a20 2020  ken.lower()..   
-00028440: 2020 2020 2020 2020 2023 2054 6865 206f           # The o
-00028450: 7065 7261 746f 7220 7368 6f75 6c64 2061  perator should a
-00028460: 6c77 6179 7320 6265 2032 2028 3d29 2074  lways be 2 (=) t
-00028470: 6f20 666c 6167 2061 2022 7369 6d70 6c65  o flag a "simple
-00028480: 2220 6571 7561 6c69 7479 0a20 2020 2020  " equality.     
-00028490: 2020 2020 2020 2023 2069 6e20 7468 6520         # in the 
-000284a0: 6269 6e61 7279 2072 6563 6f72 642e 2054  binary record. T
-000284b0: 6865 7265 666f 7265 2077 6520 636f 6e76  herefore we conv
-000284c0: 6572 7420 3c3e 2074 6f20 3d2e 0a20 2020  ert <> to =..   
-000284d0: 2020 2020 2020 2020 2069 6620 746f 6b65           if toke
-000284e0: 6e20 3d3d 2027 626c 616e 6b73 273a 0a20  n == 'blanks':. 
-000284f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00028500: 6620 6f70 6572 6174 6f72 203d 3d20 353a  f operator == 5:
-00028510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028520: 2020 2020 2074 6f6b 656e 203d 2027 2027       token = ' '
-00028530: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00028540: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00028550: 2020 2069 6620 6f70 6572 6174 6f72 203d     if operator =
-00028560: 3d20 353a 0a20 2020 2020 2020 2020 2020  = 5:.           
-00028570: 2020 2020 2020 2020 206f 7065 7261 746f           operato
-00028580: 7220 3d20 320a 2020 2020 2020 2020 2020  r = 2.          
-00028590: 2020 2020 2020 2020 2020 746f 6b65 6e20            token 
-000285a0: 3d20 2762 6c61 6e6b 7327 0a20 2020 2020  = 'blanks'.     
-000285b0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000285c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000285d0: 2020 2020 206f 7065 7261 746f 7220 3d20       operator = 
-000285e0: 350a 2020 2020 2020 2020 2020 2020 2020  5.              
-000285f0: 2020 2020 2020 746f 6b65 6e20 3d20 2720        token = ' 
-00028600: 270a 0a20 2020 2020 2020 2023 2069 6620  '..        # if 
-00028610: 7468 6520 7374 7269 6e67 2074 6f6b 656e  the string token
-00028620: 2063 6f6e 7461 696e 7320 616e 2045 7863   contains an Exc
-00028630: 656c 206d 6174 6368 2063 6861 7261 6374  el match charact
-00028640: 6572 2074 6865 6e20 6368 616e 6765 2074  er then change t
-00028650: 6865 0a20 2020 2020 2020 2023 206f 7065  he.        # ope
-00028660: 7261 746f 7220 7479 7065 2074 6f20 696e  rator type to in
-00028670: 6469 6361 7465 2061 206e 6f6e 2022 7369  dicate a non "si
-00028680: 6d70 6c65 2220 6571 7561 6c69 7479 2e0a  mple" equality..
-00028690: 2020 2020 2020 2020 6966 206f 7065 7261          if opera
-000286a0: 746f 7220 3d3d 2032 2061 6e64 2072 652e  tor == 2 and re.
-000286b0: 7365 6172 6368 2827 5b2a 3f5d 272c 2074  search('[*?]', t
-000286c0: 6f6b 656e 293a 0a20 2020 2020 2020 2020  oken):.         
-000286d0: 2020 206f 7065 7261 746f 7220 3d20 3232     operator = 22
-000286e0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000286f0: 205b 6f70 6572 6174 6f72 2c20 746f 6b65   [operator, toke
-00028700: 6e5d 0a0a 2020 2020 6465 6620 5f65 6e63  n]..    def _enc
-00028710: 6f64 655f 7061 7373 776f 7264 2873 656c  ode_password(sel
-00028720: 662c 2070 6173 7377 6f72 6429 3a0a 2020  f, password):.  
-00028730: 2020 2020 2020 2320 4861 7368 2061 2077        # Hash a w
-00028740: 6f72 6b73 6865 6574 2070 6173 7377 6f72  orksheet passwor
-00028750: 642e 2042 6173 6564 206f 6e20 7468 6520  d. Based on the 
-00028760: 616c 676f 7269 7468 6d20 696e 0a20 2020  algorithm in.   
-00028770: 2020 2020 2023 2045 434d 412d 3337 362d       # ECMA-376-
-00028780: 343a 3230 3136 2c20 4f66 6669 6365 204f  4:2016, Office O
-00028790: 7065 6e20 584d 4c20 4669 6c65 2046 6f72  pen XML File For
-000287a0: 6d61 7473 20e2 8094 2054 7261 6e73 6974  mats ... Transit
-000287b0: 696f 6e61 6c0a 2020 2020 2020 2020 2320  ional.        # 
-000287c0: 4d69 6772 6174 696f 6e20 4665 6174 7572  Migration Featur
-000287d0: 6573 2c20 4164 6469 7469 6f6e 616c 2061  es, Additional a
-000287e0: 7474 7269 6275 7465 7320 666f 7220 776f  ttributes for wo
-000287f0: 726b 626f 6f6b 5072 6f74 6563 7469 6f6e  rkbookProtection
-00028800: 0a20 2020 2020 2020 2023 2065 6c65 6d65  .        # eleme
-00028810: 6e74 2028 5061 7274 2031 2c20 c2a7 3138  nt (Part 1, ..18
-00028820: 2e32 2e32 3929 2e0a 2020 2020 2020 2020  .2.29)..        
-00028830: 6861 7368 203d 2030 7830 3030 300a 0a20  hash = 0x0000.. 
-00028840: 2020 2020 2020 2066 6f72 2063 6861 7220         for char 
-00028850: 696e 2070 6173 7377 6f72 645b 3a3a 2d31  in password[::-1
-00028860: 5d3a 0a20 2020 2020 2020 2020 2020 2068  ]:.            h
-00028870: 6173 6820 3d20 2828 6861 7368 203e 3e20  ash = ((hash >> 
-00028880: 3134 2920 2620 3078 3031 2920 7c20 2828  14) & 0x01) | ((
-00028890: 6861 7368 203c 3c20 3129 2026 2030 7837  hash << 1) & 0x7
-000288a0: 6666 6629 0a20 2020 2020 2020 2020 2020  fff).           
-000288b0: 2068 6173 6820 5e3d 206f 7264 2863 6861   hash ^= ord(cha
-000288c0: 7229 0a0a 2020 2020 2020 2020 6861 7368  r)..        hash
-000288d0: 203d 2028 2868 6173 6820 3e3e 2031 3429   = ((hash >> 14)
-000288e0: 2026 2030 7830 3129 207c 2028 2868 6173   & 0x01) | ((has
-000288f0: 6820 3c3c 2031 2920 2620 3078 3766 6666  h << 1) & 0x7fff
-00028900: 290a 2020 2020 2020 2020 6861 7368 205e  ).        hash ^
-00028910: 3d20 6c65 6e28 7061 7373 776f 7264 290a  = len(password).
-00028920: 2020 2020 2020 2020 6861 7368 205e 3d20          hash ^= 
-00028930: 3078 4345 3442 0a0a 2020 2020 2020 2020  0xCE4B..        
-00028940: 7265 7475 726e 2022 2558 2220 2520 6861  return "%X" % ha
-00028950: 7368 0a0a 2020 2020 6465 6620 5f70 7265  sh..    def _pre
-00028960: 7061 7265 5f69 6d61 6765 2873 656c 662c  pare_image(self,
-00028970: 2069 6e64 6578 2c20 696d 6167 655f 6964   index, image_id
-00028980: 2c20 6472 6177 696e 675f 6964 2c20 7769  , drawing_id, wi
-00028990: 6474 682c 2068 6569 6768 742c 0a20 2020  dth, height,.   
-000289a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000289b0: 2020 2020 6e61 6d65 2c20 696d 6167 655f      name, image_
-000289c0: 7479 7065 2c20 785f 6470 692c 2079 5f64  type, x_dpi, y_d
-000289d0: 7069 2c20 6469 6765 7374 293a 0a0a 2020  pi, digest):..  
-000289e0: 2020 2020 2020 2320 5365 7420 7570 2069        # Set up i
-000289f0: 6d61 6765 732f 6472 6177 696e 6773 2e0a  mages/drawings..
-00028a00: 2020 2020 2020 2020 6472 6177 696e 675f          drawing_
-00028a10: 7479 7065 203d 2032 0a20 2020 2020 2020  type = 2.       
-00028a20: 2028 726f 772c 2063 6f6c 2c20 5f2c 2078   (row, col, _, x
-00028a30: 5f6f 6666 7365 742c 2079 5f6f 6666 7365  _offset, y_offse
-00028a40: 742c 0a20 2020 2020 2020 2020 2020 2078  t,.            x
-00028a50: 5f73 6361 6c65 2c20 795f 7363 616c 652c  _scale, y_scale,
-00028a60: 2075 726c 2c20 7469 702c 2061 6e63 686f   url, tip, ancho
-00028a70: 722c 205f 2c0a 2020 2020 2020 2020 2020  r, _,.          
-00028a80: 2020 6465 7363 7269 7074 696f 6e2c 2064    description, d
-00028a90: 6563 6f72 6174 6976 6529 203d 2073 656c  ecorative) = sel
-00028aa0: 662e 696d 6167 6573 5b69 6e64 6578 5d0a  f.images[index].
-00028ab0: 0a20 2020 2020 2020 2077 6964 7468 202a  .        width *
-00028ac0: 3d20 785f 7363 616c 650a 2020 2020 2020  = x_scale.      
-00028ad0: 2020 6865 6967 6874 202a 3d20 795f 7363    height *= y_sc
-00028ae0: 616c 650a 0a20 2020 2020 2020 2023 2053  ale..        # S
-00028af0: 6361 6c65 2062 7920 6e6f 6e20 3936 6470  cale by non 96dp
-00028b00: 6920 7265 736f 6c75 7469 6f6e 732e 0a20  i resolutions.. 
-00028b10: 2020 2020 2020 2077 6964 7468 202a 3d20         width *= 
-00028b20: 3936 2e30 202f 2078 5f64 7069 0a20 2020  96.0 / x_dpi.   
-00028b30: 2020 2020 2068 6569 6768 7420 2a3d 2039       height *= 9
-00028b40: 362e 3020 2f20 795f 6470 690a 0a20 2020  6.0 / y_dpi..   
-00028b50: 2020 2020 2064 696d 656e 7369 6f6e 7320       dimensions 
-00028b60: 3d20 7365 6c66 2e5f 706f 7369 7469 6f6e  = self._position
-00028b70: 5f6f 626a 6563 745f 656d 7573 2863 6f6c  _object_emus(col
-00028b80: 2c20 726f 772c 2078 5f6f 6666 7365 742c  , row, x_offset,
-00028b90: 2079 5f6f 6666 7365 742c 0a20 2020 2020   y_offset,.     
-00028ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028bc0: 2020 2020 2020 2020 2020 2077 6964 7468             width
-00028bd0: 2c20 6865 6967 6874 2c20 616e 6368 6f72  , height, anchor
-00028be0: 290a 2020 2020 2020 2020 2320 436f 6e76  ).        # Conv
-00028bf0: 6572 7420 6672 6f6d 2070 6978 656c 7320  ert from pixels 
-00028c00: 746f 2065 6d75 732e 0a20 2020 2020 2020  to emus..       
-00028c10: 2077 6964 7468 203d 2069 6e74 2830 2e35   width = int(0.5
-00028c20: 202b 2028 7769 6474 6820 2a20 3935 3235   + (width * 9525
-00028c30: 2929 0a20 2020 2020 2020 2068 6569 6768  )).        heigh
-00028c40: 7420 3d20 696e 7428 302e 3520 2b20 2868  t = int(0.5 + (h
-00028c50: 6569 6768 7420 2a20 3935 3235 2929 0a0a  eight * 9525))..
-00028c60: 2020 2020 2020 2020 2320 4372 6561 7465          # Create
-00028c70: 2061 2044 7261 7769 6e67 206f 626a 2074   a Drawing obj t
-00028c80: 6f20 7573 6520 7769 7468 2077 6f72 6b73  o use with works
-00028c90: 6865 6574 2075 6e6c 6573 7320 6f6e 6520  heet unless one 
-00028ca0: 616c 7265 6164 7920 6578 6973 7473 2e0a  already exists..
-00028cb0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-00028cc0: 656c 662e 6472 6177 696e 673a 0a20 2020  elf.drawing:.   
-00028cd0: 2020 2020 2020 2020 2064 7261 7769 6e67           drawing
-00028ce0: 203d 2044 7261 7769 6e67 2829 0a20 2020   = Drawing().   
-00028cf0: 2020 2020 2020 2020 2064 7261 7769 6e67           drawing
-00028d00: 2e65 6d62 6564 6465 6420 3d20 310a 2020  .embedded = 1.  
-00028d10: 2020 2020 2020 2020 2020 7365 6c66 2e64            self.d
-00028d20: 7261 7769 6e67 203d 2064 7261 7769 6e67  rawing = drawing
-00028d30: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00028d40: 6c66 2e65 7874 6572 6e61 6c5f 6472 6177  lf.external_draw
-00028d50: 696e 675f 6c69 6e6b 732e 6170 7065 6e64  ing_links.append
-00028d60: 285b 272f 6472 6177 696e 6727 2c0a 2020  (['/drawing',.  
-00028d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028d90: 2020 2020 2020 2020 2020 2020 2020 272e                '.
-00028da0: 2e2f 6472 6177 696e 6773 2f64 7261 7769  ./drawings/drawi
-00028db0: 6e67 270a 2020 2020 2020 2020 2020 2020  ng'.            
-00028dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028de0: 2020 2020 2b20 7374 7228 6472 6177 696e      + str(drawin
-00028df0: 675f 6964 290a 2020 2020 2020 2020 2020  g_id).          
-00028e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028e20: 2020 2020 2020 2b20 272e 786d 6c27 2c20        + '.xml', 
-00028e30: 4e6f 6e65 5d29 0a20 2020 2020 2020 2065  None]).        e
-00028e40: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00028e50: 2064 7261 7769 6e67 203d 2073 656c 662e   drawing = self.
-00028e60: 6472 6177 696e 670a 0a20 2020 2020 2020  drawing..       
-00028e70: 2064 7261 7769 6e67 5f6f 626a 6563 7420   drawing_object 
-00028e80: 3d20 6472 6177 696e 672e 5f61 6464 5f64  = drawing._add_d
-00028e90: 7261 7769 6e67 5f6f 626a 6563 7428 290a  rawing_object().
-00028ea0: 2020 2020 2020 2020 6472 6177 696e 675f          drawing_
-00028eb0: 6f62 6a65 6374 5b27 7479 7065 275d 203d  object['type'] =
-00028ec0: 2064 7261 7769 6e67 5f74 7970 650a 2020   drawing_type.  
-00028ed0: 2020 2020 2020 6472 6177 696e 675f 6f62        drawing_ob
-00028ee0: 6a65 6374 5b27 6469 6d65 6e73 696f 6e73  ject['dimensions
-00028ef0: 275d 203d 2064 696d 656e 7369 6f6e 730a  '] = dimensions.
-00028f00: 2020 2020 2020 2020 6472 6177 696e 675f          drawing_
-00028f10: 6f62 6a65 6374 5b27 7769 6474 6827 5d20  object['width'] 
-00028f20: 3d20 7769 6474 680a 2020 2020 2020 2020  = width.        
-00028f30: 6472 6177 696e 675f 6f62 6a65 6374 5b27  drawing_object['
-00028f40: 6865 6967 6874 275d 203d 2068 6569 6768  height'] = heigh
-00028f50: 740a 2020 2020 2020 2020 6472 6177 696e  t.        drawin
-00028f60: 675f 6f62 6a65 6374 5b27 6465 7363 7269  g_object['descri
-00028f70: 7074 696f 6e27 5d20 3d20 6e61 6d65 0a20  ption'] = name. 
-00028f80: 2020 2020 2020 2064 7261 7769 6e67 5f6f         drawing_o
-00028f90: 626a 6563 745b 2773 6861 7065 275d 203d  bject['shape'] =
-00028fa0: 204e 6f6e 650a 2020 2020 2020 2020 6472   None.        dr
-00028fb0: 6177 696e 675f 6f62 6a65 6374 5b27 616e  awing_object['an
-00028fc0: 6368 6f72 275d 203d 2061 6e63 686f 720a  chor'] = anchor.
-00028fd0: 2020 2020 2020 2020 6472 6177 696e 675f          drawing_
-00028fe0: 6f62 6a65 6374 5b27 7265 6c5f 696e 6465  object['rel_inde
-00028ff0: 7827 5d20 3d20 300a 2020 2020 2020 2020  x'] = 0.        
-00029000: 6472 6177 696e 675f 6f62 6a65 6374 5b27  drawing_object['
-00029010: 7572 6c5f 7265 6c5f 696e 6465 7827 5d20  url_rel_index'] 
-00029020: 3d20 300a 2020 2020 2020 2020 6472 6177  = 0.        draw
-00029030: 696e 675f 6f62 6a65 6374 5b27 7469 7027  ing_object['tip'
-00029040: 5d20 3d20 7469 700a 2020 2020 2020 2020  ] = tip.        
-00029050: 6472 6177 696e 675f 6f62 6a65 6374 5b27  drawing_object['
-00029060: 6465 636f 7261 7469 7665 275d 203d 2064  decorative'] = d
-00029070: 6563 6f72 6174 6976 650a 0a20 2020 2020  ecorative..     
-00029080: 2020 2069 6620 6465 7363 7269 7074 696f     if descriptio
-00029090: 6e20 6973 206e 6f74 204e 6f6e 653a 0a20  n is not None:. 
-000290a0: 2020 2020 2020 2020 2020 2064 7261 7769             drawi
-000290b0: 6e67 5f6f 626a 6563 745b 2764 6573 6372  ng_object['descr
-000290c0: 6970 7469 6f6e 275d 203d 2064 6573 6372  iption'] = descr
-000290d0: 6970 7469 6f6e 0a0a 2020 2020 2020 2020  iption..        
-000290e0: 6966 2075 726c 3a0a 2020 2020 2020 2020  if url:.        
-000290f0: 2020 2020 7461 7267 6574 203d 204e 6f6e      target = Non
-00029100: 650a 2020 2020 2020 2020 2020 2020 7265  e.            re
-00029110: 6c5f 7479 7065 203d 2027 2f68 7970 6572  l_type = '/hyper
-00029120: 6c69 6e6b 270a 2020 2020 2020 2020 2020  link'.          
-00029130: 2020 7461 7267 6574 5f6d 6f64 6520 3d20    target_mode = 
-00029140: 2745 7874 6572 6e61 6c27 0a0a 2020 2020  'External'..    
-00029150: 2020 2020 2020 2020 6966 2072 652e 6d61          if re.ma
-00029160: 7463 6828 2728 6674 707c 6874 7470 2973  tch('(ftp|http)s
-00029170: 3f3a 2f2f 272c 2075 726c 293a 0a20 2020  ?://', url):.   
-00029180: 2020 2020 2020 2020 2020 2020 2074 6172               tar
-00029190: 6765 7420 3d20 7365 6c66 2e5f 6573 6361  get = self._esca
-000291a0: 7065 5f75 726c 2875 726c 290a 0a20 2020  pe_url(url)..   
-000291b0: 2020 2020 2020 2020 2069 6620 7265 2e6d           if re.m
-000291c0: 6174 6368 2827 5e6d 6169 6c74 6f3a 272c  atch('^mailto:',
-000291d0: 2075 726c 293a 0a20 2020 2020 2020 2020   url):.         
-000291e0: 2020 2020 2020 2074 6172 6765 7420 3d20         target = 
-000291f0: 7365 6c66 2e5f 6573 6361 7065 5f75 726c  self._escape_url
-00029200: 2875 726c 290a 0a20 2020 2020 2020 2020  (url)..         
-00029210: 2020 2069 6620 7265 2e6d 6174 6368 2827     if re.match('
-00029220: 6578 7465 726e 616c 3a27 2c20 7572 6c29  external:', url)
-00029230: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00029240: 2020 7461 7267 6574 203d 2075 726c 2e72    target = url.r
-00029250: 6570 6c61 6365 2827 6578 7465 726e 616c  eplace('external
-00029260: 3a27 2c20 2727 290a 2020 2020 2020 2020  :', '').        
-00029270: 2020 2020 2020 2020 7461 7267 6574 203d          target =
-00029280: 2073 656c 662e 5f65 7363 6170 655f 7572   self._escape_ur
-00029290: 6c28 7461 7267 6574 290a 2020 2020 2020  l(target).      
-000292a0: 2020 2020 2020 2020 2020 2320 4164 6469            # Addi
-000292b0: 7469 6f6e 616c 2065 7363 6170 6520 6e6f  tional escape no
-000292c0: 7420 7265 7175 6972 6564 2069 6e20 776f  t required in wo
-000292d0: 726b 7368 6565 7420 6879 7065 726c 696e  rksheet hyperlin
-000292e0: 6b73 2e0a 2020 2020 2020 2020 2020 2020  ks..            
-000292f0: 2020 2020 7461 7267 6574 203d 2074 6172      target = tar
-00029300: 6765 742e 7265 706c 6163 6528 2723 272c  get.replace('#',
-00029310: 2027 2532 3327 290a 0a20 2020 2020 2020   '%23')..       
-00029320: 2020 2020 2020 2020 2069 6620 7265 2e6d           if re.m
-00029330: 6174 6368 2872 275c 773a 272c 2074 6172  atch(r'\w:', tar
-00029340: 6765 7429 206f 7220 7265 2e6d 6174 6368  get) or re.match
-00029350: 2872 275c 5c27 2c20 7461 7267 6574 293a  (r'\\', target):
-00029360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029370: 2020 2020 2074 6172 6765 7420 3d20 2766       target = 'f
-00029380: 696c 653a 2f2f 2f27 202b 2074 6172 6765  ile:///' + targe
-00029390: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-000293a0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000293b0: 2020 2020 2020 2020 2020 2020 7461 7267              targ
-000293c0: 6574 203d 2074 6172 6765 742e 7265 706c  et = target.repl
-000293d0: 6163 6528 275c 5c27 2c20 272f 2729 0a0a  ace('\\', '/')..
-000293e0: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-000293f0: 652e 6d61 7463 6828 2769 6e74 6572 6e61  e.match('interna
-00029400: 6c3a 272c 2075 726c 293a 0a20 2020 2020  l:', url):.     
-00029410: 2020 2020 2020 2020 2020 2074 6172 6765             targe
-00029420: 7420 3d20 7572 6c2e 7265 706c 6163 6528  t = url.replace(
-00029430: 2769 6e74 6572 6e61 6c3a 272c 2027 2327  'internal:', '#'
-00029440: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00029450: 2020 7461 7267 6574 5f6d 6f64 6520 3d20    target_mode = 
-00029460: 4e6f 6e65 0a0a 2020 2020 2020 2020 2020  None..          
-00029470: 2020 6966 2074 6172 6765 7420 6973 206e    if target is n
-00029480: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00029490: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-000294a0: 7461 7267 6574 2920 3e20 7365 6c66 2e6d  target) > self.m
-000294b0: 6178 5f75 726c 5f6c 656e 6774 683a 0a20  ax_url_length:. 
-000294c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000294d0: 2020 2077 6172 6e28 2249 676e 6f72 696e     warn("Ignorin
-000294e0: 6720 5552 4c20 2725 7327 2077 6974 6820  g URL '%s' with 
-000294f0: 6c69 6e6b 2061 6e64 2f6f 7220 616e 6368  link and/or anch
-00029500: 6f72 203e 2025 6420 220a 2020 2020 2020  or > %d ".      
-00029510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029520: 2020 2022 6368 6172 6163 7465 7273 2073     "characters s
-00029530: 696e 6365 2069 7420 6578 6365 6564 7320  ince it exceeds 
-00029540: 4578 6365 6c27 7320 6c69 6d69 7420 666f  Excel's limit fo
-00029550: 7220 5552 4c53 2220 250a 2020 2020 2020  r URLS" %.      
-00029560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029570: 2020 2028 7572 6c2c 2073 656c 662e 6d61     (url, self.ma
-00029580: 785f 7572 6c5f 6c65 6e67 7468 2929 0a20  x_url_length)). 
-00029590: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000295a0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000295b0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-000295c0: 7365 6c66 2e64 7261 7769 6e67 5f72 656c  self.drawing_rel
-000295d0: 732e 6765 7428 7572 6c29 3a0a 2020 2020  s.get(url):.    
-000295e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000295f0: 2020 2020 7365 6c66 2e64 7261 7769 6e67      self.drawing
-00029600: 5f6c 696e 6b73 2e61 7070 656e 6428 5b72  _links.append([r
-00029610: 656c 5f74 7970 652c 2074 6172 6765 742c  el_type, target,
-00029620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029650: 2020 2020 7461 7267 6574 5f6d 6f64 655d      target_mode]
-00029660: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00029670: 2020 2020 2020 2064 7261 7769 6e67 5f6f         drawing_o
-00029680: 626a 6563 745b 2775 726c 5f72 656c 5f69  bject['url_rel_i
-00029690: 6e64 6578 275d 203d 205c 0a20 2020 2020  ndex'] = \.     
-000296a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000296b0: 2020 2073 656c 662e 5f67 6574 5f64 7261     self._get_dra
-000296c0: 7769 6e67 5f72 656c 5f69 6e64 6578 2875  wing_rel_index(u
-000296d0: 726c 290a 0a20 2020 2020 2020 2069 6620  rl)..        if 
-000296e0: 6e6f 7420 7365 6c66 2e64 7261 7769 6e67  not self.drawing
-000296f0: 5f72 656c 732e 6765 7428 6469 6765 7374  _rels.get(digest
-00029700: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
-00029710: 656c 662e 6472 6177 696e 675f 6c69 6e6b  elf.drawing_link
-00029720: 732e 6170 7065 6e64 285b 272f 696d 6167  s.append(['/imag
-00029730: 6527 2c0a 2020 2020 2020 2020 2020 2020  e',.            
-00029740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029750: 2020 2020 2020 2020 2020 2027 2e2e 2f6d             '../m
-00029760: 6564 6961 2f69 6d61 6765 270a 2020 2020  edia/image'.    
-00029770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029790: 2020 202b 2073 7472 2869 6d61 6765 5f69     + str(image_i
-000297a0: 6429 202b 2027 2e27 0a20 2020 2020 2020  d) + '.'.       
-000297b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000297c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000297d0: 2b20 696d 6167 655f 7479 7065 5d29 0a0a  + image_type])..
-000297e0: 2020 2020 2020 2020 6472 6177 696e 675f          drawing_
-000297f0: 6f62 6a65 6374 5b27 7265 6c5f 696e 6465  object['rel_inde
-00029800: 7827 5d20 3d20 7365 6c66 2e5f 6765 745f  x'] = self._get_
-00029810: 6472 6177 696e 675f 7265 6c5f 696e 6465  drawing_rel_inde
-00029820: 7828 6469 6765 7374 290a 0a20 2020 2064  x(digest)..    d
-00029830: 6566 205f 7072 6570 6172 655f 7368 6170  ef _prepare_shap
-00029840: 6528 7365 6c66 2c20 696e 6465 782c 2064  e(self, index, d
-00029850: 7261 7769 6e67 5f69 6429 3a0a 2020 2020  rawing_id):.    
-00029860: 2020 2020 2320 5365 7420 7570 2073 6861      # Set up sha
-00029870: 7065 732f 6472 6177 696e 6773 2e0a 2020  pes/drawings..  
-00029880: 2020 2020 2020 6472 6177 696e 675f 7479        drawing_ty
-00029890: 7065 203d 2033 0a0a 2020 2020 2020 2020  pe = 3..        
-000298a0: 2872 6f77 2c20 636f 6c2c 2078 5f6f 6666  (row, col, x_off
-000298b0: 7365 742c 2079 5f6f 6666 7365 742c 2078  set, y_offset, x
-000298c0: 5f73 6361 6c65 2c20 795f 7363 616c 652c  _scale, y_scale,
-000298d0: 2074 6578 742c 2061 6e63 686f 722c 206f   text, anchor, o
-000298e0: 7074 696f 6e73 2c0a 2020 2020 2020 2020  ptions,.        
-000298f0: 2064 6573 6372 6970 7469 6f6e 2c20 6465   description, de
-00029900: 636f 7261 7469 7665 2920 3d20 7365 6c66  corative) = self
-00029910: 2e73 6861 7065 735b 696e 6465 785d 0a0a  .shapes[index]..
-00029920: 2020 2020 2020 2020 7769 6474 6820 3d20          width = 
-00029930: 6f70 7469 6f6e 732e 6765 7428 2777 6964  options.get('wid
-00029940: 7468 272c 2073 656c 662e 6465 6661 756c  th', self.defaul
-00029950: 745f 636f 6c5f 7069 7865 6c73 202a 2033  t_col_pixels * 3
-00029960: 290a 2020 2020 2020 2020 6865 6967 6874  ).        height
-00029970: 203d 206f 7074 696f 6e73 2e67 6574 2827   = options.get('
-00029980: 6865 6967 6874 272c 2073 656c 662e 6465  height', self.de
-00029990: 6661 756c 745f 726f 775f 7069 7865 6c73  fault_row_pixels
-000299a0: 202a 2036 290a 0a20 2020 2020 2020 2077   * 6)..        w
-000299b0: 6964 7468 202a 3d20 785f 7363 616c 650a  idth *= x_scale.
-000299c0: 2020 2020 2020 2020 6865 6967 6874 202a          height *
-000299d0: 3d20 795f 7363 616c 650a 0a20 2020 2020  = y_scale..     
-000299e0: 2020 2064 696d 656e 7369 6f6e 7320 3d20     dimensions = 
-000299f0: 7365 6c66 2e5f 706f 7369 7469 6f6e 5f6f  self._position_o
-00029a00: 626a 6563 745f 656d 7573 2863 6f6c 2c20  bject_emus(col, 
-00029a10: 726f 772c 2078 5f6f 6666 7365 742c 2079  row, x_offset, y
-00029a20: 5f6f 6666 7365 742c 0a20 2020 2020 2020  _offset,.       
-00029a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029a50: 2020 2020 2020 2020 2077 6964 7468 2c20           width, 
-00029a60: 6865 6967 6874 2c20 616e 6368 6f72 290a  height, anchor).
-00029a70: 0a20 2020 2020 2020 2023 2043 6f6e 7665  .        # Conve
-00029a80: 7274 2066 726f 6d20 7069 7865 6c73 2074  rt from pixels t
-00029a90: 6f20 656d 7573 2e0a 2020 2020 2020 2020  o emus..        
-00029aa0: 7769 6474 6820 3d20 696e 7428 302e 3520  width = int(0.5 
-00029ab0: 2b20 2877 6964 7468 202a 2039 3532 3529  + (width * 9525)
-00029ac0: 290a 2020 2020 2020 2020 6865 6967 6874  ).        height
-00029ad0: 203d 2069 6e74 2830 2e35 202b 2028 6865   = int(0.5 + (he
-00029ae0: 6967 6874 202a 2039 3532 3529 290a 0a20  ight * 9525)).. 
-00029af0: 2020 2020 2020 2023 2043 7265 6174 6520         # Create 
-00029b00: 6120 4472 6177 696e 6720 6f62 6a20 746f  a Drawing obj to
-00029b10: 2075 7365 2077 6974 6820 776f 726b 7368   use with worksh
-00029b20: 6565 7420 756e 6c65 7373 206f 6e65 2061  eet unless one a
-00029b30: 6c72 6561 6479 2065 7869 7374 732e 0a20  lready exists.. 
-00029b40: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-00029b50: 6c66 2e64 7261 7769 6e67 3a0a 2020 2020  lf.drawing:.    
-00029b60: 2020 2020 2020 2020 6472 6177 696e 6720          drawing 
-00029b70: 3d20 4472 6177 696e 6728 290a 2020 2020  = Drawing().    
-00029b80: 2020 2020 2020 2020 6472 6177 696e 672e          drawing.
-00029b90: 656d 6265 6464 6564 203d 2031 0a20 2020  embedded = 1.   
-00029ba0: 2020 2020 2020 2020 2073 656c 662e 6472           self.dr
-00029bb0: 6177 696e 6720 3d20 6472 6177 696e 670a  awing = drawing.
-00029bc0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00029bd0: 662e 6578 7465 726e 616c 5f64 7261 7769  f.external_drawi
-00029be0: 6e67 5f6c 696e 6b73 2e61 7070 656e 6428  ng_links.append(
-00029bf0: 5b27 2f64 7261 7769 6e67 272c 0a20 2020  ['/drawing',.   
-00029c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029c20: 2020 2020 2020 2020 2020 2020 2027 2e2e               '..
-00029c30: 2f64 7261 7769 6e67 732f 6472 6177 696e  /drawings/drawin
-00029c40: 6727 0a20 2020 2020 2020 2020 2020 2020  g'.             
-00029c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029c70: 2020 202b 2073 7472 2864 7261 7769 6e67     + str(drawing
-00029c80: 5f69 6429 0a20 2020 2020 2020 2020 2020  _id).           
-00029c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029cb0: 2020 2020 202b 2027 2e78 6d6c 272c 204e       + '.xml', N
-00029cc0: 6f6e 655d 290a 2020 2020 2020 2020 656c  one]).        el
-00029cd0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00029ce0: 6472 6177 696e 6720 3d20 7365 6c66 2e64  drawing = self.d
-00029cf0: 7261 7769 6e67 0a0a 2020 2020 2020 2020  rawing..        
-00029d00: 7368 6170 6520 3d20 5368 6170 6528 2772  shape = Shape('r
-00029d10: 6563 7427 2c20 2754 6578 7442 6f78 272c  ect', 'TextBox',
-00029d20: 206f 7074 696f 6e73 290a 2020 2020 2020   options).      
-00029d30: 2020 7368 6170 652e 7465 7874 203d 2074    shape.text = t
-00029d40: 6578 740a 0a20 2020 2020 2020 2064 7261  ext..        dra
-00029d50: 7769 6e67 5f6f 626a 6563 7420 3d20 6472  wing_object = dr
-00029d60: 6177 696e 672e 5f61 6464 5f64 7261 7769  awing._add_drawi
-00029d70: 6e67 5f6f 626a 6563 7428 290a 2020 2020  ng_object().    
-00029d80: 2020 2020 6472 6177 696e 675f 6f62 6a65      drawing_obje
-00029d90: 6374 5b27 7479 7065 275d 203d 2064 7261  ct['type'] = dra
-00029da0: 7769 6e67 5f74 7970 650a 2020 2020 2020  wing_type.      
-00029db0: 2020 6472 6177 696e 675f 6f62 6a65 6374    drawing_object
-00029dc0: 5b27 6469 6d65 6e73 696f 6e73 275d 203d  ['dimensions'] =
-00029dd0: 2064 696d 656e 7369 6f6e 730a 2020 2020   dimensions.    
-00029de0: 2020 2020 6472 6177 696e 675f 6f62 6a65      drawing_obje
-00029df0: 6374 5b27 7769 6474 6827 5d20 3d20 7769  ct['width'] = wi
-00029e00: 6474 680a 2020 2020 2020 2020 6472 6177  dth.        draw
-00029e10: 696e 675f 6f62 6a65 6374 5b27 6865 6967  ing_object['heig
-00029e20: 6874 275d 203d 2068 6569 6768 740a 2020  ht'] = height.  
-00029e30: 2020 2020 2020 6472 6177 696e 675f 6f62        drawing_ob
-00029e40: 6a65 6374 5b27 6465 7363 7269 7074 696f  ject['descriptio
-00029e50: 6e27 5d20 3d20 6465 7363 7269 7074 696f  n'] = descriptio
-00029e60: 6e0a 2020 2020 2020 2020 6472 6177 696e  n.        drawin
-00029e70: 675f 6f62 6a65 6374 5b27 7368 6170 6527  g_object['shape'
-00029e80: 5d20 3d20 7368 6170 650a 2020 2020 2020  ] = shape.      
-00029e90: 2020 6472 6177 696e 675f 6f62 6a65 6374    drawing_object
-00029ea0: 5b27 616e 6368 6f72 275d 203d 2061 6e63  ['anchor'] = anc
-00029eb0: 686f 720a 2020 2020 2020 2020 6472 6177  hor.        draw
-00029ec0: 696e 675f 6f62 6a65 6374 5b27 7265 6c5f  ing_object['rel_
-00029ed0: 696e 6465 7827 5d20 3d20 300a 2020 2020  index'] = 0.    
-00029ee0: 2020 2020 6472 6177 696e 675f 6f62 6a65      drawing_obje
-00029ef0: 6374 5b27 7572 6c5f 7265 6c5f 696e 6465  ct['url_rel_inde
-00029f00: 7827 5d20 3d20 300a 2020 2020 2020 2020  x'] = 0.        
-00029f10: 6472 6177 696e 675f 6f62 6a65 6374 5b27  drawing_object['
-00029f20: 7469 7027 5d20 3d20 6f70 7469 6f6e 732e  tip'] = options.
-00029f30: 6765 7428 2774 6970 2729 0a20 2020 2020  get('tip').     
-00029f40: 2020 2064 7261 7769 6e67 5f6f 626a 6563     drawing_objec
-00029f50: 745b 2764 6563 6f72 6174 6976 6527 5d20  t['decorative'] 
-00029f60: 3d20 6465 636f 7261 7469 7665 0a0a 2020  = decorative..  
-00029f70: 2020 2020 2020 7572 6c20 3d20 6f70 7469        url = opti
-00029f80: 6f6e 732e 6765 7428 2775 726c 272c 204e  ons.get('url', N
-00029f90: 6f6e 6529 0a20 2020 2020 2020 2069 6620  one).        if 
-00029fa0: 7572 6c3a 0a20 2020 2020 2020 2020 2020  url:.           
-00029fb0: 2074 6172 6765 7420 3d20 4e6f 6e65 0a20   target = None. 
-00029fc0: 2020 2020 2020 2020 2020 2072 656c 5f74             rel_t
-00029fd0: 7970 6520 3d20 272f 6879 7065 726c 696e  ype = '/hyperlin
-00029fe0: 6b27 0a20 2020 2020 2020 2020 2020 2074  k'.            t
-00029ff0: 6172 6765 745f 6d6f 6465 203d 2027 4578  arget_mode = 'Ex
-0002a000: 7465 726e 616c 270a 0a20 2020 2020 2020  ternal'..       
-0002a010: 2020 2020 2069 6620 7265 2e6d 6174 6368       if re.match
-0002a020: 2827 2866 7470 7c68 7474 7029 733f 3a2f  ('(ftp|http)s?:/
-0002a030: 2f27 2c20 7572 6c29 3a0a 2020 2020 2020  /', url):.      
-0002a040: 2020 2020 2020 2020 2020 7461 7267 6574            target
-0002a050: 203d 2073 656c 662e 5f65 7363 6170 655f   = self._escape_
-0002a060: 7572 6c28 7572 6c29 0a0a 2020 2020 2020  url(url)..      
-0002a070: 2020 2020 2020 6966 2072 652e 6d61 7463        if re.matc
-0002a080: 6828 275e 6d61 696c 746f 3a27 2c20 7572  h('^mailto:', ur
-0002a090: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
-0002a0a0: 2020 2020 7461 7267 6574 203d 2073 656c      target = sel
-0002a0b0: 662e 5f65 7363 6170 655f 7572 6c28 7572  f._escape_url(ur
-0002a0c0: 6c29 0a0a 2020 2020 2020 2020 2020 2020  l)..            
-0002a0d0: 6966 2072 652e 6d61 7463 6828 2765 7874  if re.match('ext
-0002a0e0: 6572 6e61 6c3a 272c 2075 726c 293a 0a20  ernal:', url):. 
-0002a0f0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-0002a100: 6172 6765 7420 3d20 7572 6c2e 7265 706c  arget = url.repl
-0002a110: 6163 6528 2765 7874 6572 6e61 6c3a 272c  ace('external:',
-0002a120: 2027 6669 6c65 3a2f 2f2f 2729 0a20 2020   'file:///').   
-0002a130: 2020 2020 2020 2020 2020 2020 2074 6172               tar
-0002a140: 6765 7420 3d20 7365 6c66 2e5f 6573 6361  get = self._esca
-0002a150: 7065 5f75 726c 2874 6172 6765 7429 0a20  pe_url(target). 
-0002a160: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0002a170: 2041 6464 6974 696f 6e61 6c20 6573 6361   Additional esca
-0002a180: 7065 206e 6f74 2072 6571 7569 7265 6420  pe not required 
-0002a190: 696e 2077 6f72 6b73 6865 6574 2068 7970  in worksheet hyp
-0002a1a0: 6572 6c69 6e6b 732e 0a20 2020 2020 2020  erlinks..       
-0002a1b0: 2020 2020 2020 2020 2074 6172 6765 7420           target 
-0002a1c0: 3d20 7461 7267 6574 2e72 6570 6c61 6365  = target.replace
-0002a1d0: 2827 2327 2c20 2725 3233 2729 0a0a 2020  ('#', '%23')..  
-0002a1e0: 2020 2020 2020 2020 2020 6966 2072 652e            if re.
-0002a1f0: 6d61 7463 6828 2769 6e74 6572 6e61 6c3a  match('internal:
-0002a200: 272c 2075 726c 293a 0a20 2020 2020 2020  ', url):.       
-0002a210: 2020 2020 2020 2020 2074 6172 6765 7420           target 
-0002a220: 3d20 7572 6c2e 7265 706c 6163 6528 2769  = url.replace('i
-0002a230: 6e74 6572 6e61 6c3a 272c 2027 2327 290a  nternal:', '#').
-0002a240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a250: 7461 7267 6574 5f6d 6f64 6520 3d20 4e6f  target_mode = No
-0002a260: 6e65 0a0a 2020 2020 2020 2020 2020 2020  ne..            
-0002a270: 6966 2074 6172 6765 7420 6973 206e 6f74  if target is not
-0002a280: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0002a290: 2020 2020 2020 2069 6620 6c65 6e28 7461         if len(ta
-0002a2a0: 7267 6574 2920 3e20 7365 6c66 2e6d 6178  rget) > self.max
-0002a2b0: 5f75 726c 5f6c 656e 6774 683a 0a20 2020  _url_length:.   
-0002a2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a2d0: 2077 6172 6e28 2249 676e 6f72 696e 6720   warn("Ignoring 
-0002a2e0: 5552 4c20 2725 7327 2077 6974 6820 6c69  URL '%s' with li
-0002a2f0: 6e6b 2061 6e64 2f6f 7220 616e 6368 6f72  nk and/or anchor
-0002a300: 203e 2025 6420 220a 2020 2020 2020 2020   > %d ".        
-0002a310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a320: 2022 6368 6172 6163 7465 7273 2073 696e   "characters sin
-0002a330: 6365 2069 7420 6578 6365 6564 7320 4578  ce it exceeds Ex
-0002a340: 6365 6c27 7320 6c69 6d69 7420 666f 7220  cel's limit for 
-0002a350: 5552 4c53 2220 250a 2020 2020 2020 2020  URLS" %.        
-0002a360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a370: 2028 7572 6c2c 2073 656c 662e 6d61 785f   (url, self.max_
-0002a380: 7572 6c5f 6c65 6e67 7468 2929 0a20 2020  url_length)).   
-0002a390: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-0002a3a0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0002a3b0: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-0002a3c0: 6c66 2e64 7261 7769 6e67 5f72 656c 732e  lf.drawing_rels.
-0002a3d0: 6765 7428 7572 6c29 3a0a 2020 2020 2020  get(url):.      
-0002a3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a3f0: 2020 7365 6c66 2e64 7261 7769 6e67 5f6c    self.drawing_l
-0002a400: 696e 6b73 2e61 7070 656e 6428 5b72 656c  inks.append([rel
-0002a410: 5f74 7970 652c 2074 6172 6765 742c 0a20  _type, target,. 
-0002a420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d470: 2020 2020 2020 2020 666f 726d 756c 6120          formula 
+0001d480: 3d20 7365 6c66 2e5f 7461 626c 655f 6675  = self._table_fu
+0001d490: 6e63 7469 6f6e 5f74 6f5f 666f 726d 756c  nction_to_formul
+0001d4a0: 6128 0a20 2020 2020 2020 2020 2020 2020  a(.             
+0001d4b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0001d4c0: 756e 6374 696f 6e2c 2063 6f6c 5f64 6174  unction, col_dat
+0001d4d0: 615b 226e 616d 6522 5d0a 2020 2020 2020  a["name"].      
+0001d4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d4f0: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+0001d500: 2020 2020 2020 2020 2020 2020 2076 616c               val
+0001d510: 7565 203d 2075 7365 725f 6461 7461 2e67  ue = user_data.g
+0001d520: 6574 2822 746f 7461 6c5f 7661 6c75 6522  et("total_value"
+0001d530: 2c20 3029 0a0a 2020 2020 2020 2020 2020  , 0)..          
+0001d540: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001d550: 6c66 2e5f 7772 6974 655f 666f 726d 756c  lf._write_formul
+0001d560: 6128 6c61 7374 5f72 6f77 2c20 636f 6c5f  a(last_row, col_
+0001d570: 6e75 6d2c 2066 6f72 6d75 6c61 2c20 7866  num, formula, xf
+0001d580: 6f72 6d61 742c 2076 616c 7565 290a 0a20  ormat, value).. 
+0001d590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d5a0: 2020 2065 6c69 6620 7573 6572 5f64 6174     elif user_dat
+0001d5b0: 612e 6765 7428 2274 6f74 616c 5f73 7472  a.get("total_str
+0001d5c0: 696e 6722 293a 0a20 2020 2020 2020 2020  ing"):.         
+0001d5d0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0001d5e0: 2054 6f74 616c 206c 6162 656c 206f 6e6c   Total label onl
+0001d5f0: 7920 286e 6f74 2061 2066 756e 6374 696f  y (not a functio
+0001d600: 6e29 2e0a 2020 2020 2020 2020 2020 2020  n)..            
+0001d610: 2020 2020 2020 2020 2020 2020 746f 7461              tota
+0001d620: 6c5f 7374 7269 6e67 203d 2075 7365 725f  l_string = user_
+0001d630: 6461 7461 5b22 746f 7461 6c5f 7374 7269  data["total_stri
+0001d640: 6e67 225d 0a20 2020 2020 2020 2020 2020  ng"].           
+0001d650: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+0001d660: 5f64 6174 615b 2274 6f74 616c 5f73 7472  _data["total_str
+0001d670: 696e 6722 5d20 3d20 746f 7461 6c5f 7374  ing"] = total_st
+0001d680: 7269 6e67 0a0a 2020 2020 2020 2020 2020  ring..          
+0001d690: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001d6a0: 6c66 2e5f 7772 6974 655f 7374 7269 6e67  lf._write_string
+0001d6b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001d6c0: 2020 2020 2020 2020 2020 2020 2020 6c61                la
+0001d6d0: 7374 5f72 6f77 2c20 636f 6c5f 6e75 6d2c  st_row, col_num,
+0001d6e0: 2074 6f74 616c 5f73 7472 696e 672c 2075   total_string, u
+0001d6f0: 7365 725f 6461 7461 2e67 6574 2822 666f  ser_data.get("fo
+0001d700: 726d 6174 2229 0a20 2020 2020 2020 2020  rmat").         
+0001d710: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0001d720: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001d730: 2020 2020 2020 2320 4765 7420 7468 6520        # Get the 
+0001d740: 6478 6620 666f 726d 6174 2069 6e64 6578  dxf format index
+0001d750: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001d760: 2020 2020 2020 6966 2078 666f 726d 6174        if xformat
+0001d770: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+0001d780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d790: 2020 2020 2020 636f 6c5f 6461 7461 5b22        col_data["
+0001d7a0: 666f 726d 6174 225d 203d 2078 666f 726d  format"] = xform
+0001d7b0: 6174 2e5f 6765 745f 6478 665f 696e 6465  at._get_dxf_inde
+0001d7c0: 7828 290a 0a20 2020 2020 2020 2020 2020  x()..           
+0001d7d0: 2020 2020 2020 2020 2023 2053 746f 7265           # Store
+0001d7e0: 2074 6865 2063 6f6c 756d 6e20 666f 726d   the column form
+0001d7f0: 6174 2066 6f72 2077 7269 7469 6e67 2074  at for writing t
+0001d800: 6865 2063 656c 6c20 6461 7461 2e0a 2020  he cell data..  
+0001d810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d820: 2020 2320 4974 2064 6f65 736e 2774 206d    # It doesn't m
+0001d830: 6174 7465 7220 6966 2069 7420 6973 2075  atter if it is u
+0001d840: 6e64 6566 696e 6564 2e0a 2020 2020 2020  ndefined..      
+0001d850: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0001d860: 6c5f 666f 726d 6174 735b 636f 6c5f 6964  l_formats[col_id
+0001d870: 202d 2031 5d20 3d20 7866 6f72 6d61 740a   - 1] = xformat.
+0001d880: 0a20 2020 2020 2020 2020 2020 2023 2053  .            # S
+0001d890: 746f 7265 2074 6865 2063 6f6c 756d 6e20  tore the column 
+0001d8a0: 6461 7461 2e0a 2020 2020 2020 2020 2020  data..          
+0001d8b0: 2020 7461 626c 655b 2263 6f6c 756d 6e73    table["columns
+0001d8c0: 225d 2e61 7070 656e 6428 636f 6c5f 6461  "].append(col_da
+0001d8d0: 7461 290a 0a20 2020 2020 2020 2020 2020  ta)..           
+0001d8e0: 2023 2057 7269 7465 2074 6865 2063 6f6c   # Write the col
+0001d8f0: 756d 6e20 6865 6164 6572 7320 746f 2074  umn headers to t
+0001d900: 6865 2077 6f72 6b73 6865 6574 2e0a 2020  he worksheet..  
+0001d910: 2020 2020 2020 2020 2020 6966 206f 7074            if opt
+0001d920: 696f 6e73 5b22 6865 6164 6572 5f72 6f77  ions["header_row
+0001d930: 225d 3a0a 2020 2020 2020 2020 2020 2020  "]:.            
+0001d940: 2020 2020 7365 6c66 2e5f 7772 6974 655f      self._write_
+0001d950: 7374 7269 6e67 280a 2020 2020 2020 2020  string(.        
+0001d960: 2020 2020 2020 2020 2020 2020 6669 7273              firs
+0001d970: 745f 726f 772c 2063 6f6c 5f6e 756d 2c20  t_row, col_num, 
+0001d980: 636f 6c5f 6461 7461 5b22 6e61 6d65 225d  col_data["name"]
+0001d990: 2c20 636f 6c5f 6461 7461 5b22 6e61 6d65  , col_data["name
+0001d9a0: 5f66 6f72 6d61 7422 5d0a 2020 2020 2020  _format"].      
+0001d9b0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0001d9c0: 2020 2020 2020 2020 2063 6f6c 5f69 6420           col_id 
+0001d9d0: 2b3d 2031 0a0a 2020 2020 2020 2020 2320  += 1..        # 
+0001d9e0: 5772 6974 6520 7468 6520 6365 6c6c 2064  Write the cell d
+0001d9f0: 6174 6120 6966 2073 7570 706c 6965 642e  ata if supplied.
+0001da00: 0a20 2020 2020 2020 2069 6620 2264 6174  .        if "dat
+0001da10: 6122 2069 6e20 6f70 7469 6f6e 733a 0a20  a" in options:. 
+0001da20: 2020 2020 2020 2020 2020 2064 6174 6120             data 
+0001da30: 3d20 6f70 7469 6f6e 735b 2264 6174 6122  = options["data"
+0001da40: 5d0a 0a20 2020 2020 2020 2020 2020 2069  ]..            i
+0001da50: 203d 2030 2020 2320 466f 7220 696e 6465   = 0  # For inde
+0001da60: 7869 6e67 2074 6865 2072 6f77 2064 6174  xing the row dat
+0001da70: 612e 0a20 2020 2020 2020 2020 2020 2066  a..            f
+0001da80: 6f72 2072 6f77 2069 6e20 7261 6e67 6528  or row in range(
+0001da90: 6669 7273 745f 6461 7461 5f72 6f77 2c20  first_data_row, 
+0001daa0: 6c61 7374 5f64 6174 615f 726f 7720 2b20  last_data_row + 
+0001dab0: 3129 3a0a 2020 2020 2020 2020 2020 2020  1):.            
+0001dac0: 2020 2020 6a20 3d20 3020 2023 2046 6f72      j = 0  # For
+0001dad0: 2069 6e64 6578 696e 6720 7468 6520 636f   indexing the co
+0001dae0: 6c20 6461 7461 2e0a 2020 2020 2020 2020  l data..        
+0001daf0: 2020 2020 2020 2020 666f 7220 636f 6c20          for col 
+0001db00: 696e 2072 616e 6765 2866 6972 7374 5f63  in range(first_c
+0001db10: 6f6c 2c20 6c61 7374 5f63 6f6c 202b 2031  ol, last_col + 1
+0001db20: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0001db30: 2020 2020 2020 2069 6620 6920 3c20 6c65         if i < le
+0001db40: 6e28 6461 7461 2920 616e 6420 6a20 3c20  n(data) and j < 
+0001db50: 6c65 6e28 6461 7461 5b69 5d29 3a0a 2020  len(data[i]):.  
+0001db60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001db70: 2020 2020 2020 746f 6b65 6e20 3d20 6461        token = da
+0001db80: 7461 5b69 5d5b 6a5d 0a20 2020 2020 2020  ta[i][j].       
+0001db90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dba0: 2069 6620 6a20 696e 2063 6f6c 5f66 6f72   if j in col_for
+0001dbb0: 6d61 7473 3a0a 2020 2020 2020 2020 2020  mats:.          
+0001dbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dbd0: 2020 7365 6c66 2e5f 7772 6974 6528 726f    self._write(ro
+0001dbe0: 772c 2063 6f6c 2c20 746f 6b65 6e2c 2063  w, col, token, c
+0001dbf0: 6f6c 5f66 6f72 6d61 7473 5b6a 5d29 0a20  ol_formats[j]). 
+0001dc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dc10: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001dc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dc30: 2020 2020 2020 2020 2073 656c 662e 5f77           self._w
+0001dc40: 7269 7465 2872 6f77 2c20 636f 6c2c 2074  rite(row, col, t
+0001dc50: 6f6b 656e 2c20 4e6f 6e65 290a 2020 2020  oken, None).    
+0001dc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dc70: 6a20 2b3d 2031 0a20 2020 2020 2020 2020  j += 1.         
+0001dc80: 2020 2020 2020 2069 202b 3d20 310a 0a20         i += 1.. 
+0001dc90: 2020 2020 2020 2023 2053 746f 7265 2074         # Store t
+0001dca0: 6865 2074 6162 6c65 2064 6174 612e 0a20  he table data.. 
+0001dcb0: 2020 2020 2020 2073 656c 662e 7461 626c         self.tabl
+0001dcc0: 6573 2e61 7070 656e 6428 7461 626c 6529  es.append(table)
+0001dcd0: 0a0a 2020 2020 2020 2020 2320 5374 6f72  ..        # Stor
+0001dce0: 6520 7468 6520 6669 6c74 6572 2063 656c  e the filter cel
+0001dcf0: 6c20 706f 7369 7469 6f6e 7320 666f 7220  l positions for 
+0001dd00: 7573 6520 696e 2074 6865 2061 7574 6f66  use in the autof
+0001dd10: 6974 2063 616c 6375 6c61 7469 6f6e 2e0a  it calculation..
+0001dd20: 2020 2020 2020 2020 6966 206f 7074 696f          if optio
+0001dd30: 6e73 5b22 6175 746f 6669 6c74 6572 225d  ns["autofilter"]
+0001dd40: 3a0a 2020 2020 2020 2020 2020 2020 666f  :.            fo
+0001dd50: 7220 636f 6c20 696e 2072 616e 6765 2866  r col in range(f
+0001dd60: 6972 7374 5f63 6f6c 2c20 6c61 7374 5f63  irst_col, last_c
+0001dd70: 6f6c 202b 2031 293a 0a20 2020 2020 2020  ol + 1):.       
+0001dd80: 2020 2020 2020 2020 2073 656c 662e 6669           self.fi
+0001dd90: 6c74 6572 5f63 656c 6c73 5b28 6669 7273  lter_cells[(firs
+0001dda0: 745f 726f 772c 2063 6f6c 295d 203d 2054  t_row, col)] = T
+0001ddb0: 7275 650a 0a20 2020 2020 2020 2072 6574  rue..        ret
+0001ddc0: 7572 6e20 300a 0a20 2020 2040 636f 6e76  urn 0..    @conv
+0001ddd0: 6572 745f 6365 6c6c 5f61 7267 730a 2020  ert_cell_args.  
+0001dde0: 2020 6465 6620 6164 645f 7370 6172 6b6c    def add_sparkl
+0001ddf0: 696e 6528 7365 6c66 2c20 726f 772c 2063  ine(self, row, c
+0001de00: 6f6c 2c20 6f70 7469 6f6e 733d 4e6f 6e65  ol, options=None
+0001de10: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+0001de20: 2020 2020 2020 2041 6464 2073 7061 726b         Add spark
+0001de30: 6c69 6e65 7320 746f 2074 6865 2077 6f72  lines to the wor
+0001de40: 6b73 6865 6574 2e0a 0a20 2020 2020 2020  ksheet...       
+0001de50: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
+0001de60: 2020 2072 6f77 3a20 2020 2020 5468 6520     row:     The 
+0001de70: 6365 6c6c 2072 6f77 2028 7a65 726f 2069  cell row (zero i
+0001de80: 6e64 6578 6564 292e 0a20 2020 2020 2020  ndexed)..       
+0001de90: 2020 2020 2063 6f6c 3a20 2020 2020 5468       col:     Th
+0001dea0: 6520 6365 6c6c 2063 6f6c 756d 6e20 287a  e cell column (z
+0001deb0: 6572 6f20 696e 6465 7865 6429 2e0a 2020  ero indexed)..  
+0001dec0: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
+0001ded0: 733a 2053 7061 726b 6c69 6e65 2066 6f72  s: Sparkline for
+0001dee0: 6d61 7474 696e 6720 6f70 7469 6f6e 732e  matting options.
+0001def0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0001df00: 733a 0a20 2020 2020 2020 2020 2020 2030  s:.            0
+0001df10: 3a20 2053 7563 6365 7373 2e0a 2020 2020  :  Success..    
+0001df20: 2020 2020 2020 2020 2d31 3a20 526f 7720          -1: Row 
+0001df30: 6f72 2063 6f6c 756d 6e20 6973 206f 7574  or column is out
+0001df40: 206f 6620 776f 726b 7368 6565 7420 626f   of worksheet bo
+0001df50: 756e 6473 2e0a 2020 2020 2020 2020 2020  unds..          
+0001df60: 2020 2d32 3a20 496e 636f 7272 6563 7420    -2: Incorrect 
+0001df70: 7061 7261 6d65 7465 7220 6f72 206f 7074  parameter or opt
+0001df80: 696f 6e2e 0a0a 2020 2020 2020 2020 2222  ion...        ""
+0001df90: 220a 0a20 2020 2020 2020 2023 2043 6865  "..        # Che
+0001dfa0: 636b 2074 6861 7420 726f 7720 616e 6420  ck that row and 
+0001dfb0: 636f 6c20 6172 6520 7661 6c69 6420 7769  col are valid wi
+0001dfc0: 7468 6f75 7420 7374 6f72 696e 6720 7468  thout storing th
+0001dfd0: 6520 7661 6c75 6573 2e0a 2020 2020 2020  e values..      
+0001dfe0: 2020 6966 2073 656c 662e 5f63 6865 636b    if self._check
+0001dff0: 5f64 696d 656e 7369 6f6e 7328 726f 772c  _dimensions(row,
+0001e000: 2063 6f6c 2c20 5472 7565 2c20 5472 7565   col, True, True
+0001e010: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+0001e020: 6574 7572 6e20 2d31 0a0a 2020 2020 2020  eturn -1..      
+0001e030: 2020 7370 6172 6b6c 696e 6520 3d20 7b22    sparkline = {"
+0001e040: 6c6f 6361 7469 6f6e 7322 3a20 5b78 6c5f  locations": [xl_
+0001e050: 726f 7763 6f6c 5f74 6f5f 6365 6c6c 2872  rowcol_to_cell(r
+0001e060: 6f77 2c20 636f 6c29 5d7d 0a0a 2020 2020  ow, col)]}..    
+0001e070: 2020 2020 6966 206f 7074 696f 6e73 2069      if options i
+0001e080: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0001e090: 2020 2020 6f70 7469 6f6e 7320 3d20 7b7d      options = {}
+0001e0a0: 0a0a 2020 2020 2020 2020 2320 5661 6c69  ..        # Vali
+0001e0b0: 6420 696e 7075 7420 7061 7261 6d65 7465  d input paramete
+0001e0c0: 7273 2e0a 2020 2020 2020 2020 7661 6c69  rs..        vali
+0001e0d0: 645f 7061 7261 6d65 7465 7273 203d 207b  d_parameters = {
+0001e0e0: 0a20 2020 2020 2020 2020 2020 2022 6c6f  .            "lo
+0001e0f0: 6361 7469 6f6e 222c 0a20 2020 2020 2020  cation",.       
+0001e100: 2020 2020 2022 7261 6e67 6522 2c0a 2020       "range",.  
+0001e110: 2020 2020 2020 2020 2020 2274 7970 6522            "type"
+0001e120: 2c0a 2020 2020 2020 2020 2020 2020 2268  ,.            "h
+0001e130: 6967 685f 706f 696e 7422 2c0a 2020 2020  igh_point",.    
+0001e140: 2020 2020 2020 2020 226c 6f77 5f70 6f69          "low_poi
+0001e150: 6e74 222c 0a20 2020 2020 2020 2020 2020  nt",.           
+0001e160: 2022 6e65 6761 7469 7665 5f70 6f69 6e74   "negative_point
+0001e170: 7322 2c0a 2020 2020 2020 2020 2020 2020  s",.            
+0001e180: 2266 6972 7374 5f70 6f69 6e74 222c 0a20  "first_point",. 
+0001e190: 2020 2020 2020 2020 2020 2022 6c61 7374             "last
+0001e1a0: 5f70 6f69 6e74 222c 0a20 2020 2020 2020  _point",.       
+0001e1b0: 2020 2020 2022 6d61 726b 6572 7322 2c0a       "markers",.
+0001e1c0: 2020 2020 2020 2020 2020 2020 2273 7479              "sty
+0001e1d0: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
+0001e1e0: 2022 7365 7269 6573 5f63 6f6c 6f72 222c   "series_color",
+0001e1f0: 0a20 2020 2020 2020 2020 2020 2022 6e65  .            "ne
+0001e200: 6761 7469 7665 5f63 6f6c 6f72 222c 0a20  gative_color",. 
+0001e210: 2020 2020 2020 2020 2020 2022 6d61 726b             "mark
+0001e220: 6572 735f 636f 6c6f 7222 2c0a 2020 2020  ers_color",.    
+0001e230: 2020 2020 2020 2020 2266 6972 7374 5f63          "first_c
+0001e240: 6f6c 6f72 222c 0a20 2020 2020 2020 2020  olor",.         
+0001e250: 2020 2022 6c61 7374 5f63 6f6c 6f72 222c     "last_color",
+0001e260: 0a20 2020 2020 2020 2020 2020 2022 6869  .            "hi
+0001e270: 6768 5f63 6f6c 6f72 222c 0a20 2020 2020  gh_color",.     
+0001e280: 2020 2020 2020 2022 6c6f 775f 636f 6c6f         "low_colo
+0001e290: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
+0001e2a0: 226d 6178 222c 0a20 2020 2020 2020 2020  "max",.         
+0001e2b0: 2020 2022 6d69 6e22 2c0a 2020 2020 2020     "min",.      
+0001e2c0: 2020 2020 2020 2261 7869 7322 2c0a 2020        "axis",.  
+0001e2d0: 2020 2020 2020 2020 2020 2272 6576 6572            "rever
+0001e2e0: 7365 222c 0a20 2020 2020 2020 2020 2020  se",.           
+0001e2f0: 2022 656d 7074 795f 6365 6c6c 7322 2c0a   "empty_cells",.
+0001e300: 2020 2020 2020 2020 2020 2020 2273 686f              "sho
+0001e310: 775f 6869 6464 656e 222c 0a20 2020 2020  w_hidden",.     
+0001e320: 2020 2020 2020 2022 706c 6f74 5f68 6964         "plot_hid
+0001e330: 6465 6e22 2c0a 2020 2020 2020 2020 2020  den",.          
+0001e340: 2020 2264 6174 655f 6178 6973 222c 0a20    "date_axis",. 
+0001e350: 2020 2020 2020 2020 2020 2022 7765 6967             "weig
+0001e360: 6874 222c 0a20 2020 2020 2020 207d 0a0a  ht",.        }..
+0001e370: 2020 2020 2020 2020 2320 4368 6563 6b20          # Check 
+0001e380: 666f 7220 7661 6c69 6420 696e 7075 7420  for valid input 
+0001e390: 7061 7261 6d65 7465 7273 2e0a 2020 2020  parameters..    
+0001e3a0: 2020 2020 666f 7220 7061 7261 6d5f 6b65      for param_ke
+0001e3b0: 7920 696e 206f 7074 696f 6e73 2e6b 6579  y in options.key
+0001e3c0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+0001e3d0: 2069 6620 7061 7261 6d5f 6b65 7920 6e6f   if param_key no
+0001e3e0: 7420 696e 2076 616c 6964 5f70 6172 616d  t in valid_param
+0001e3f0: 6574 6572 733a 0a20 2020 2020 2020 2020  eters:.         
+0001e400: 2020 2020 2020 2077 6172 6e28 2255 6e6b         warn("Unk
+0001e410: 6e6f 776e 2070 6172 616d 6574 6572 2027  nown parameter '
+0001e420: 2573 2720 696e 2061 6464 5f73 7061 726b  %s' in add_spark
+0001e430: 6c69 6e65 2829 2220 2520 7061 7261 6d5f  line()" % param_
+0001e440: 6b65 7929 0a20 2020 2020 2020 2020 2020  key).           
+0001e450: 2020 2020 2072 6574 7572 6e20 2d31 0a0a       return -1..
+0001e460: 2020 2020 2020 2020 2320 2772 616e 6765          # 'range
+0001e470: 2720 6973 2061 2072 6571 7569 7265 6420  ' is a required 
+0001e480: 7061 7261 6d65 7465 722e 0a20 2020 2020  parameter..     
+0001e490: 2020 2069 6620 2272 616e 6765 2220 6e6f     if "range" no
+0001e4a0: 7420 696e 206f 7074 696f 6e73 3a0a 2020  t in options:.  
+0001e4b0: 2020 2020 2020 2020 2020 7761 726e 2822            warn("
+0001e4c0: 5061 7261 6d65 7465 7220 2772 616e 6765  Parameter 'range
+0001e4d0: 2720 6973 2072 6571 7569 7265 6420 696e  ' is required in
+0001e4e0: 2061 6464 5f73 7061 726b 6c69 6e65 2829   add_sparkline()
+0001e4f0: 2229 0a20 2020 2020 2020 2020 2020 2072  ").            r
+0001e500: 6574 7572 6e20 2d32 0a0a 2020 2020 2020  eturn -2..      
+0001e510: 2020 2320 4861 6e64 6c65 2074 6865 2073    # Handle the s
+0001e520: 7061 726b 6c69 6e65 2074 7970 652e 0a20  parkline type.. 
+0001e530: 2020 2020 2020 2073 7061 726b 5f74 7970         spark_typ
+0001e540: 6520 3d20 6f70 7469 6f6e 732e 6765 7428  e = options.get(
+0001e550: 2274 7970 6522 2c20 226c 696e 6522 290a  "type", "line").
+0001e560: 0a20 2020 2020 2020 2069 6620 7370 6172  .        if spar
+0001e570: 6b5f 7479 7065 206e 6f74 2069 6e20 2822  k_type not in ("
+0001e580: 6c69 6e65 222c 2022 636f 6c75 6d6e 222c  line", "column",
+0001e590: 2022 7769 6e5f 6c6f 7373 2229 3a0a 2020   "win_loss"):.  
+0001e5a0: 2020 2020 2020 2020 2020 7761 726e 280a            warn(.
+0001e5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e5c0: 2250 6172 616d 6574 6572 2027 7479 7065  "Parameter 'type
+0001e5d0: 2720 6d75 7374 2062 6520 276c 696e 6527  ' must be 'line'
+0001e5e0: 2c20 2763 6f6c 756d 6e27 2022 0a20 2020  , 'column' ".   
+0001e5f0: 2020 2020 2020 2020 2020 2020 2022 6f72               "or
+0001e600: 2027 7769 6e5f 6c6f 7373 2720 696e 2061   'win_loss' in a
+0001e610: 6464 5f73 7061 726b 6c69 6e65 2829 220a  dd_sparkline()".
+0001e620: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0001e630: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001e640: 202d 320a 0a20 2020 2020 2020 2069 6620   -2..        if 
+0001e650: 7370 6172 6b5f 7479 7065 203d 3d20 2277  spark_type == "w
+0001e660: 696e 5f6c 6f73 7322 3a0a 2020 2020 2020  in_loss":.      
+0001e670: 2020 2020 2020 7370 6172 6b5f 7479 7065        spark_type
+0001e680: 203d 2022 7374 6163 6b65 6422 0a20 2020   = "stacked".   
+0001e690: 2020 2020 2073 7061 726b 6c69 6e65 5b22       sparkline["
+0001e6a0: 7479 7065 225d 203d 2073 7061 726b 5f74  type"] = spark_t
+0001e6b0: 7970 650a 0a20 2020 2020 2020 2023 2057  ype..        # W
+0001e6c0: 6520 6861 6e64 6c65 2073 696e 676c 6520  e handle single 
+0001e6d0: 6c6f 6361 7469 6f6e 2f72 616e 6765 2076  location/range v
+0001e6e0: 616c 7565 7320 6f72 206c 6973 7420 6f66  alues or list of
+0001e6f0: 2076 616c 7565 732e 0a20 2020 2020 2020   values..       
+0001e700: 2069 6620 226c 6f63 6174 696f 6e22 2069   if "location" i
+0001e710: 6e20 6f70 7469 6f6e 733a 0a20 2020 2020  n options:.     
+0001e720: 2020 2020 2020 2069 6620 7479 7065 286f         if type(o
+0001e730: 7074 696f 6e73 5b22 6c6f 6361 7469 6f6e  ptions["location
+0001e740: 225d 2920 6973 206c 6973 743a 0a20 2020  "]) is list:.   
+0001e750: 2020 2020 2020 2020 2020 2020 2073 7061               spa
+0001e760: 726b 6c69 6e65 5b22 6c6f 6361 7469 6f6e  rkline["location
+0001e770: 7322 5d20 3d20 6f70 7469 6f6e 735b 226c  s"] = options["l
+0001e780: 6f63 6174 696f 6e22 5d0a 2020 2020 2020  ocation"].      
+0001e790: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001e7a0: 2020 2020 2020 2020 2020 2020 7370 6172              spar
+0001e7b0: 6b6c 696e 655b 226c 6f63 6174 696f 6e73  kline["locations
+0001e7c0: 225d 203d 205b 6f70 7469 6f6e 735b 226c  "] = [options["l
+0001e7d0: 6f63 6174 696f 6e22 5d5d 0a0a 2020 2020  ocation"]]..    
+0001e7e0: 2020 2020 6966 2074 7970 6528 6f70 7469      if type(opti
+0001e7f0: 6f6e 735b 2272 616e 6765 225d 2920 6973  ons["range"]) is
+0001e800: 206c 6973 743a 0a20 2020 2020 2020 2020   list:.         
+0001e810: 2020 2073 7061 726b 6c69 6e65 5b22 7261     sparkline["ra
+0001e820: 6e67 6573 225d 203d 206f 7074 696f 6e73  nges"] = options
+0001e830: 5b22 7261 6e67 6522 5d0a 2020 2020 2020  ["range"].      
+0001e840: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0001e850: 2020 2020 7370 6172 6b6c 696e 655b 2272      sparkline["r
+0001e860: 616e 6765 7322 5d20 3d20 5b6f 7074 696f  anges"] = [optio
+0001e870: 6e73 5b22 7261 6e67 6522 5d5d 0a0a 2020  ns["range"]]..  
+0001e880: 2020 2020 2020 7261 6e67 655f 636f 756e        range_coun
+0001e890: 7420 3d20 6c65 6e28 7370 6172 6b6c 696e  t = len(sparklin
+0001e8a0: 655b 2272 616e 6765 7322 5d29 0a20 2020  e["ranges"]).   
+0001e8b0: 2020 2020 206c 6f63 6174 696f 6e5f 636f       location_co
+0001e8c0: 756e 7420 3d20 6c65 6e28 7370 6172 6b6c  unt = len(sparkl
+0001e8d0: 696e 655b 226c 6f63 6174 696f 6e73 225d  ine["locations"]
+0001e8e0: 290a 0a20 2020 2020 2020 2023 2054 6865  )..        # The
+0001e8f0: 2072 616e 6765 7320 616e 6420 6c6f 6361   ranges and loca
+0001e900: 7469 6f6e 7320 6d75 7374 206d 6174 6368  tions must match
+0001e910: 2e0a 2020 2020 2020 2020 6966 2072 616e  ..        if ran
+0001e920: 6765 5f63 6f75 6e74 2021 3d20 6c6f 6361  ge_count != loca
+0001e930: 7469 6f6e 5f63 6f75 6e74 3a0a 2020 2020  tion_count:.    
+0001e940: 2020 2020 2020 2020 7761 726e 280a 2020          warn(.  
+0001e950: 2020 2020 2020 2020 2020 2020 2020 224d                "M
+0001e960: 7573 7420 6861 7665 2074 6865 2073 616d  ust have the sam
+0001e970: 6520 6e75 6d62 6572 206f 6620 6c6f 6361  e number of loca
+0001e980: 7469 6f6e 2061 6e64 2072 616e 6765 2022  tion and range "
+0001e990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e9a0: 2022 7061 7261 6d65 7465 7273 2069 6e20   "parameters in 
+0001e9b0: 6164 645f 7370 6172 6b6c 696e 6528 2922  add_sparkline()"
+0001e9c0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0001e9d0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0001e9e0: 6e20 2d32 0a0a 2020 2020 2020 2020 2320  n -2..        # 
+0001e9f0: 5374 6f72 6520 7468 6520 636f 756e 742e  Store the count.
+0001ea00: 0a20 2020 2020 2020 2073 7061 726b 6c69  .        sparkli
+0001ea10: 6e65 5b22 636f 756e 7422 5d20 3d20 6c65  ne["count"] = le
+0001ea20: 6e28 7370 6172 6b6c 696e 655b 226c 6f63  n(sparkline["loc
+0001ea30: 6174 696f 6e73 225d 290a 0a20 2020 2020  ations"])..     
+0001ea40: 2020 2023 2047 6574 2074 6865 2077 6f72     # Get the wor
+0001ea50: 6b73 6865 6574 206e 616d 6520 666f 7220  ksheet name for 
+0001ea60: 7468 6520 7261 6e67 6520 636f 6e76 6572  the range conver
+0001ea70: 7369 6f6e 2062 656c 6f77 2e0a 2020 2020  sion below..    
+0001ea80: 2020 2020 7368 6565 746e 616d 6520 3d20      sheetname = 
+0001ea90: 7175 6f74 655f 7368 6565 746e 616d 6528  quote_sheetname(
+0001eaa0: 7365 6c66 2e6e 616d 6529 0a0a 2020 2020  self.name)..    
+0001eab0: 2020 2020 2320 436c 6561 6e75 7020 7468      # Cleanup th
+0001eac0: 6520 696e 7075 7420 7261 6e67 6573 2e0a  e input ranges..
+0001ead0: 2020 2020 2020 2020 6e65 775f 7261 6e67          new_rang
+0001eae0: 6573 203d 205b 5d0a 2020 2020 2020 2020  es = [].        
+0001eaf0: 666f 7220 7370 6172 6b5f 7261 6e67 6520  for spark_range 
+0001eb00: 696e 2073 7061 726b 6c69 6e65 5b22 7261  in sparkline["ra
+0001eb10: 6e67 6573 225d 3a0a 2020 2020 2020 2020  nges"]:.        
+0001eb20: 2020 2020 2320 5265 6d6f 7665 2074 6865      # Remove the
+0001eb30: 2061 6273 6f6c 7574 6520 7265 6665 7265   absolute refere
+0001eb40: 6e63 6520 2420 7379 6d62 6f6c 732e 0a20  nce $ symbols.. 
+0001eb50: 2020 2020 2020 2020 2020 2073 7061 726b             spark
+0001eb60: 5f72 616e 6765 203d 2073 7061 726b 5f72  _range = spark_r
+0001eb70: 616e 6765 2e72 6570 6c61 6365 2822 2422  ange.replace("$"
+0001eb80: 2c20 2222 290a 0a20 2020 2020 2020 2020  , "")..         
+0001eb90: 2020 2023 2052 656d 6f76 6520 7468 6520     # Remove the 
+0001eba0: 3d20 6672 6f6d 2066 6f72 6d75 6c61 2e0a  = from formula..
+0001ebb0: 2020 2020 2020 2020 2020 2020 7370 6172              spar
+0001ebc0: 6b5f 7261 6e67 6520 3d20 7370 6172 6b5f  k_range = spark_
+0001ebd0: 7261 6e67 652e 6c73 7472 6970 2822 3d22  range.lstrip("="
+0001ebe0: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
+0001ebf0: 2043 6f6e 7665 7274 2061 2073 696d 706c   Convert a simpl
+0001ec00: 6520 7261 6e67 6520 696e 746f 2061 2066  e range into a f
+0001ec10: 756c 6c20 5368 6565 7431 2141 313a 4431  ull Sheet1!A1:D1
+0001ec20: 2072 616e 6765 2e0a 2020 2020 2020 2020   range..        
+0001ec30: 2020 2020 6966 2022 2122 206e 6f74 2069      if "!" not i
+0001ec40: 6e20 7370 6172 6b5f 7261 6e67 653a 0a20  n spark_range:. 
+0001ec50: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001ec60: 7061 726b 5f72 616e 6765 203d 2073 6865  park_range = she
+0001ec70: 6574 6e61 6d65 202b 2022 2122 202b 2073  etname + "!" + s
+0001ec80: 7061 726b 5f72 616e 6765 0a0a 2020 2020  park_range..    
+0001ec90: 2020 2020 2020 2020 6e65 775f 7261 6e67          new_rang
+0001eca0: 6573 2e61 7070 656e 6428 7370 6172 6b5f  es.append(spark_
+0001ecb0: 7261 6e67 6529 0a0a 2020 2020 2020 2020  range)..        
+0001ecc0: 7370 6172 6b6c 696e 655b 2272 616e 6765  sparkline["range
+0001ecd0: 7322 5d20 3d20 6e65 775f 7261 6e67 6573  s"] = new_ranges
+0001ece0: 0a0a 2020 2020 2020 2020 2320 436c 6561  ..        # Clea
+0001ecf0: 6e75 7020 7468 6520 696e 7075 7420 6c6f  nup the input lo
+0001ed00: 6361 7469 6f6e 732e 0a20 2020 2020 2020  cations..       
+0001ed10: 206e 6577 5f6c 6f63 6174 696f 6e73 203d   new_locations =
+0001ed20: 205b 5d0a 2020 2020 2020 2020 666f 7220   [].        for 
+0001ed30: 6c6f 6361 7469 6f6e 2069 6e20 7370 6172  location in spar
+0001ed40: 6b6c 696e 655b 226c 6f63 6174 696f 6e73  kline["locations
+0001ed50: 225d 3a0a 2020 2020 2020 2020 2020 2020  "]:.            
+0001ed60: 6c6f 6361 7469 6f6e 203d 206c 6f63 6174  location = locat
+0001ed70: 696f 6e2e 7265 706c 6163 6528 2224 222c  ion.replace("$",
+0001ed80: 2022 2229 0a20 2020 2020 2020 2020 2020   "").           
+0001ed90: 206e 6577 5f6c 6f63 6174 696f 6e73 2e61   new_locations.a
+0001eda0: 7070 656e 6428 6c6f 6361 7469 6f6e 290a  ppend(location).
+0001edb0: 0a20 2020 2020 2020 2073 7061 726b 6c69  .        sparkli
+0001edc0: 6e65 5b22 6c6f 6361 7469 6f6e 7322 5d20  ne["locations"] 
+0001edd0: 3d20 6e65 775f 6c6f 6361 7469 6f6e 730a  = new_locations.
+0001ede0: 0a20 2020 2020 2020 2023 204d 6170 206f  .        # Map o
+0001edf0: 7074 696f 6e73 2e0a 2020 2020 2020 2020  ptions..        
+0001ee00: 7370 6172 6b6c 696e 655b 2268 6967 6822  sparkline["high"
+0001ee10: 5d20 3d20 6f70 7469 6f6e 732e 6765 7428  ] = options.get(
+0001ee20: 2268 6967 685f 706f 696e 7422 290a 2020  "high_point").  
+0001ee30: 2020 2020 2020 7370 6172 6b6c 696e 655b        sparkline[
+0001ee40: 226c 6f77 225d 203d 206f 7074 696f 6e73  "low"] = options
+0001ee50: 2e67 6574 2822 6c6f 775f 706f 696e 7422  .get("low_point"
+0001ee60: 290a 2020 2020 2020 2020 7370 6172 6b6c  ).        sparkl
+0001ee70: 696e 655b 226e 6567 6174 6976 6522 5d20  ine["negative"] 
+0001ee80: 3d20 6f70 7469 6f6e 732e 6765 7428 226e  = options.get("n
+0001ee90: 6567 6174 6976 655f 706f 696e 7473 2229  egative_points")
+0001eea0: 0a20 2020 2020 2020 2073 7061 726b 6c69  .        sparkli
+0001eeb0: 6e65 5b22 6669 7273 7422 5d20 3d20 6f70  ne["first"] = op
+0001eec0: 7469 6f6e 732e 6765 7428 2266 6972 7374  tions.get("first
+0001eed0: 5f70 6f69 6e74 2229 0a20 2020 2020 2020  _point").       
+0001eee0: 2073 7061 726b 6c69 6e65 5b22 6c61 7374   sparkline["last
+0001eef0: 225d 203d 206f 7074 696f 6e73 2e67 6574  "] = options.get
+0001ef00: 2822 6c61 7374 5f70 6f69 6e74 2229 0a20  ("last_point"). 
+0001ef10: 2020 2020 2020 2073 7061 726b 6c69 6e65         sparkline
+0001ef20: 5b22 6d61 726b 6572 7322 5d20 3d20 6f70  ["markers"] = op
+0001ef30: 7469 6f6e 732e 6765 7428 226d 6172 6b65  tions.get("marke
+0001ef40: 7273 2229 0a20 2020 2020 2020 2073 7061  rs").        spa
+0001ef50: 726b 6c69 6e65 5b22 6d69 6e22 5d20 3d20  rkline["min"] = 
+0001ef60: 6f70 7469 6f6e 732e 6765 7428 226d 696e  options.get("min
+0001ef70: 2229 0a20 2020 2020 2020 2073 7061 726b  ").        spark
+0001ef80: 6c69 6e65 5b22 6d61 7822 5d20 3d20 6f70  line["max"] = op
+0001ef90: 7469 6f6e 732e 6765 7428 226d 6178 2229  tions.get("max")
+0001efa0: 0a20 2020 2020 2020 2073 7061 726b 6c69  .        sparkli
+0001efb0: 6e65 5b22 6178 6973 225d 203d 206f 7074  ne["axis"] = opt
+0001efc0: 696f 6e73 2e67 6574 2822 6178 6973 2229  ions.get("axis")
+0001efd0: 0a20 2020 2020 2020 2073 7061 726b 6c69  .        sparkli
+0001efe0: 6e65 5b22 7265 7665 7273 6522 5d20 3d20  ne["reverse"] = 
+0001eff0: 6f70 7469 6f6e 732e 6765 7428 2272 6576  options.get("rev
+0001f000: 6572 7365 2229 0a20 2020 2020 2020 2073  erse").        s
+0001f010: 7061 726b 6c69 6e65 5b22 6869 6464 656e  parkline["hidden
+0001f020: 225d 203d 206f 7074 696f 6e73 2e67 6574  "] = options.get
+0001f030: 2822 7368 6f77 5f68 6964 6465 6e22 290a  ("show_hidden").
+0001f040: 2020 2020 2020 2020 7370 6172 6b6c 696e          sparklin
+0001f050: 655b 2277 6569 6768 7422 5d20 3d20 6f70  e["weight"] = op
+0001f060: 7469 6f6e 732e 6765 7428 2277 6569 6768  tions.get("weigh
+0001f070: 7422 290a 0a20 2020 2020 2020 2023 204d  t")..        # M
+0001f080: 6170 2065 6d70 7479 2063 656c 6c73 206f  ap empty cells o
+0001f090: 7074 696f 6e73 2e0a 2020 2020 2020 2020  ptions..        
+0001f0a0: 656d 7074 7920 3d20 6f70 7469 6f6e 732e  empty = options.
+0001f0b0: 6765 7428 2265 6d70 7479 5f63 656c 6c73  get("empty_cells
+0001f0c0: 222c 2022 2229 0a0a 2020 2020 2020 2020  ", "")..        
+0001f0d0: 6966 2065 6d70 7479 203d 3d20 227a 6572  if empty == "zer
+0001f0e0: 6f22 3a0a 2020 2020 2020 2020 2020 2020  o":.            
+0001f0f0: 7370 6172 6b6c 696e 655b 2265 6d70 7479  sparkline["empty
+0001f100: 225d 203d 2030 0a20 2020 2020 2020 2065  "] = 0.        e
+0001f110: 6c69 6620 656d 7074 7920 3d3d 2022 636f  lif empty == "co
+0001f120: 6e6e 6563 7422 3a0a 2020 2020 2020 2020  nnect":.        
+0001f130: 2020 2020 7370 6172 6b6c 696e 655b 2265      sparkline["e
+0001f140: 6d70 7479 225d 203d 2022 7370 616e 220a  mpty"] = "span".
+0001f150: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001f160: 2020 2020 2020 2020 2020 7370 6172 6b6c            sparkl
+0001f170: 696e 655b 2265 6d70 7479 225d 203d 2022  ine["empty"] = "
+0001f180: 6761 7022 0a0a 2020 2020 2020 2020 2320  gap"..        # 
+0001f190: 4d61 7020 7468 6520 6461 7465 2061 7869  Map the date axi
+0001f1a0: 7320 7261 6e67 652e 0a20 2020 2020 2020  s range..       
+0001f1b0: 2064 6174 655f 7261 6e67 6520 3d20 6f70   date_range = op
+0001f1c0: 7469 6f6e 732e 6765 7428 2264 6174 655f  tions.get("date_
+0001f1d0: 6178 6973 2229 0a0a 2020 2020 2020 2020  axis")..        
+0001f1e0: 6966 2064 6174 655f 7261 6e67 6520 616e  if date_range an
+0001f1f0: 6420 2221 2220 6e6f 7420 696e 2064 6174  d "!" not in dat
+0001f200: 655f 7261 6e67 653a 0a20 2020 2020 2020  e_range:.       
+0001f210: 2020 2020 2064 6174 655f 7261 6e67 6520       date_range 
+0001f220: 3d20 7368 6565 746e 616d 6520 2b20 2221  = sheetname + "!
+0001f230: 2220 2b20 6461 7465 5f72 616e 6765 0a0a  " + date_range..
+0001f240: 2020 2020 2020 2020 7370 6172 6b6c 696e          sparklin
+0001f250: 655b 2264 6174 655f 6178 6973 225d 203d  e["date_axis"] =
+0001f260: 2064 6174 655f 7261 6e67 650a 0a20 2020   date_range..   
+0001f270: 2020 2020 2023 2053 6574 2074 6865 2073       # Set the s
+0001f280: 7061 726b 6c69 6e65 2073 7479 6c65 732e  parkline styles.
+0001f290: 0a20 2020 2020 2020 2073 7479 6c65 5f69  .        style_i
+0001f2a0: 6420 3d20 6f70 7469 6f6e 732e 6765 7428  d = options.get(
+0001f2b0: 2273 7479 6c65 222c 2030 290a 2020 2020  "style", 0).    
+0001f2c0: 2020 2020 7374 796c 6520 3d20 6765 745f      style = get_
+0001f2d0: 7370 6172 6b6c 696e 655f 7374 796c 6528  sparkline_style(
+0001f2e0: 7374 796c 655f 6964 290a 0a20 2020 2020  style_id)..     
+0001f2f0: 2020 2073 7061 726b 6c69 6e65 5b22 7365     sparkline["se
+0001f300: 7269 6573 5f63 6f6c 6f72 225d 203d 2073  ries_color"] = s
+0001f310: 7479 6c65 5b22 7365 7269 6573 225d 0a20  tyle["series"]. 
+0001f320: 2020 2020 2020 2073 7061 726b 6c69 6e65         sparkline
+0001f330: 5b22 6e65 6761 7469 7665 5f63 6f6c 6f72  ["negative_color
+0001f340: 225d 203d 2073 7479 6c65 5b22 6e65 6761  "] = style["nega
+0001f350: 7469 7665 225d 0a20 2020 2020 2020 2073  tive"].        s
+0001f360: 7061 726b 6c69 6e65 5b22 6d61 726b 6572  parkline["marker
+0001f370: 735f 636f 6c6f 7222 5d20 3d20 7374 796c  s_color"] = styl
+0001f380: 655b 226d 6172 6b65 7273 225d 0a20 2020  e["markers"].   
+0001f390: 2020 2020 2073 7061 726b 6c69 6e65 5b22       sparkline["
+0001f3a0: 6669 7273 745f 636f 6c6f 7222 5d20 3d20  first_color"] = 
+0001f3b0: 7374 796c 655b 2266 6972 7374 225d 0a20  style["first"]. 
+0001f3c0: 2020 2020 2020 2073 7061 726b 6c69 6e65         sparkline
+0001f3d0: 5b22 6c61 7374 5f63 6f6c 6f72 225d 203d  ["last_color"] =
+0001f3e0: 2073 7479 6c65 5b22 6c61 7374 225d 0a20   style["last"]. 
+0001f3f0: 2020 2020 2020 2073 7061 726b 6c69 6e65         sparkline
+0001f400: 5b22 6869 6768 5f63 6f6c 6f72 225d 203d  ["high_color"] =
+0001f410: 2073 7479 6c65 5b22 6869 6768 225d 0a20   style["high"]. 
+0001f420: 2020 2020 2020 2073 7061 726b 6c69 6e65         sparkline
+0001f430: 5b22 6c6f 775f 636f 6c6f 7222 5d20 3d20  ["low_color"] = 
+0001f440: 7374 796c 655b 226c 6f77 225d 0a0a 2020  style["low"]..  
+0001f450: 2020 2020 2020 2320 4f76 6572 7269 6465        # Override
+0001f460: 2074 6865 2073 7479 6c65 2063 6f6c 6f72   the style color
+0001f470: 7320 7769 7468 2075 7365 7220 6465 6669  s with user defi
+0001f480: 6e65 6420 636f 6c6f 7273 2e0a 2020 2020  ned colors..    
+0001f490: 2020 2020 7365 6c66 2e5f 7365 745f 7370      self._set_sp
+0001f4a0: 6172 6b5f 636f 6c6f 7228 7370 6172 6b6c  ark_color(sparkl
+0001f4b0: 696e 652c 206f 7074 696f 6e73 2c20 2273  ine, options, "s
+0001f4c0: 6572 6965 735f 636f 6c6f 7222 290a 2020  eries_color").  
+0001f4d0: 2020 2020 2020 7365 6c66 2e5f 7365 745f        self._set_
+0001f4e0: 7370 6172 6b5f 636f 6c6f 7228 7370 6172  spark_color(spar
+0001f4f0: 6b6c 696e 652c 206f 7074 696f 6e73 2c20  kline, options, 
+0001f500: 226e 6567 6174 6976 655f 636f 6c6f 7222  "negative_color"
+0001f510: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
+0001f520: 7365 745f 7370 6172 6b5f 636f 6c6f 7228  set_spark_color(
+0001f530: 7370 6172 6b6c 696e 652c 206f 7074 696f  sparkline, optio
+0001f540: 6e73 2c20 226d 6172 6b65 7273 5f63 6f6c  ns, "markers_col
+0001f550: 6f72 2229 0a20 2020 2020 2020 2073 656c  or").        sel
+0001f560: 662e 5f73 6574 5f73 7061 726b 5f63 6f6c  f._set_spark_col
+0001f570: 6f72 2873 7061 726b 6c69 6e65 2c20 6f70  or(sparkline, op
+0001f580: 7469 6f6e 732c 2022 6669 7273 745f 636f  tions, "first_co
+0001f590: 6c6f 7222 290a 2020 2020 2020 2020 7365  lor").        se
+0001f5a0: 6c66 2e5f 7365 745f 7370 6172 6b5f 636f  lf._set_spark_co
+0001f5b0: 6c6f 7228 7370 6172 6b6c 696e 652c 206f  lor(sparkline, o
+0001f5c0: 7074 696f 6e73 2c20 226c 6173 745f 636f  ptions, "last_co
+0001f5d0: 6c6f 7222 290a 2020 2020 2020 2020 7365  lor").        se
+0001f5e0: 6c66 2e5f 7365 745f 7370 6172 6b5f 636f  lf._set_spark_co
+0001f5f0: 6c6f 7228 7370 6172 6b6c 696e 652c 206f  lor(sparkline, o
+0001f600: 7074 696f 6e73 2c20 2268 6967 685f 636f  ptions, "high_co
+0001f610: 6c6f 7222 290a 2020 2020 2020 2020 7365  lor").        se
+0001f620: 6c66 2e5f 7365 745f 7370 6172 6b5f 636f  lf._set_spark_co
+0001f630: 6c6f 7228 7370 6172 6b6c 696e 652c 206f  lor(sparkline, o
+0001f640: 7074 696f 6e73 2c20 226c 6f77 5f63 6f6c  ptions, "low_col
+0001f650: 6f72 2229 0a0a 2020 2020 2020 2020 7365  or")..        se
+0001f660: 6c66 2e73 7061 726b 6c69 6e65 732e 6170  lf.sparklines.ap
+0001f670: 7065 6e64 2873 7061 726b 6c69 6e65 290a  pend(sparkline).
+0001f680: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001f690: 300a 0a20 2020 2040 636f 6e76 6572 745f  0..    @convert_
+0001f6a0: 7261 6e67 655f 6172 6773 0a20 2020 2064  range_args.    d
+0001f6b0: 6566 2073 6574 5f73 656c 6563 7469 6f6e  ef set_selection
+0001f6c0: 2873 656c 662c 2066 6972 7374 5f72 6f77  (self, first_row
+0001f6d0: 2c20 6669 7273 745f 636f 6c2c 206c 6173  , first_col, las
+0001f6e0: 745f 726f 772c 206c 6173 745f 636f 6c29  t_row, last_col)
+0001f6f0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0001f700: 2020 2020 2020 5365 7420 7468 6520 7365        Set the se
+0001f710: 6c65 6374 6564 2063 656c 6c20 6f72 2063  lected cell or c
+0001f720: 656c 6c73 2069 6e20 6120 776f 726b 7368  ells in a worksh
+0001f730: 6565 740a 0a20 2020 2020 2020 2041 7267  eet..        Arg
+0001f740: 733a 0a20 2020 2020 2020 2020 2020 2066  s:.            f
+0001f750: 6972 7374 5f72 6f77 3a20 2020 2054 6865  irst_row:    The
+0001f760: 2066 6972 7374 2072 6f77 206f 6620 7468   first row of th
+0001f770: 6520 6365 6c6c 2072 616e 6765 2e20 287a  e cell range. (z
+0001f780: 6572 6f20 696e 6465 7865 6429 2e0a 2020  ero indexed)..  
+0001f790: 2020 2020 2020 2020 2020 6669 7273 745f            first_
+0001f7a0: 636f 6c3a 2020 2020 5468 6520 6669 7273  col:    The firs
+0001f7b0: 7420 636f 6c75 6d6e 206f 6620 7468 6520  t column of the 
+0001f7c0: 6365 6c6c 2072 616e 6765 2e0a 2020 2020  cell range..    
+0001f7d0: 2020 2020 2020 2020 6c61 7374 5f72 6f77          last_row
+0001f7e0: 3a20 2020 2020 5468 6520 6c61 7374 2072  :     The last r
+0001f7f0: 6f77 206f 6620 7468 6520 6365 6c6c 2072  ow of the cell r
+0001f800: 616e 6765 2e20 287a 6572 6f20 696e 6465  ange. (zero inde
+0001f810: 7865 6429 2e0a 2020 2020 2020 2020 2020  xed)..          
+0001f820: 2020 6c61 7374 5f63 6f6c 3a20 2020 2020    last_col:     
+0001f830: 5468 6520 6c61 7374 2063 6f6c 756d 6e20  The last column 
+0001f840: 6f66 2074 6865 2063 656c 6c20 7261 6e67  of the cell rang
+0001f850: 652e 0a0a 2020 2020 2020 2020 5265 7475  e...        Retu
+0001f860: 726e 733a 0a20 2020 2020 2020 2020 2020  rns:.           
+0001f870: 2030 3a20 204e 6f74 6869 6e67 2e0a 2020   0:  Nothing..  
+0001f880: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001f890: 2020 7061 6e65 203d 204e 6f6e 650a 0a20    pane = None.. 
+0001f8a0: 2020 2020 2020 2023 2052 616e 6765 2073         # Range s
+0001f8b0: 656c 6563 7469 6f6e 2e20 446f 2074 6869  election. Do thi
+0001f8c0: 7320 6265 666f 7265 2073 7761 7070 696e  s before swappin
+0001f8d0: 6720 6d61 782f 6d69 6e20 746f 2061 6c6c  g max/min to all
+0001f8e0: 6f77 2074 6865 0a20 2020 2020 2020 2023  ow the.        #
+0001f8f0: 2073 656c 6563 7469 6f6e 2064 6972 6563   selection direc
+0001f900: 7469 6f6e 2074 6f20 6265 2072 6576 6572  tion to be rever
+0001f910: 7365 642e 0a20 2020 2020 2020 2061 6374  sed..        act
+0001f920: 6976 655f 6365 6c6c 203d 2078 6c5f 726f  ive_cell = xl_ro
+0001f930: 7763 6f6c 5f74 6f5f 6365 6c6c 2866 6972  wcol_to_cell(fir
+0001f940: 7374 5f72 6f77 2c20 6669 7273 745f 636f  st_row, first_co
+0001f950: 6c29 0a0a 2020 2020 2020 2020 2320 5377  l)..        # Sw
+0001f960: 6170 206c 6173 7420 726f 772f 636f 6c20  ap last row/col 
+0001f970: 666f 7220 6669 7273 7420 726f 772f 636f  for first row/co
+0001f980: 6c20 6966 206e 6563 6573 7361 7279 0a20  l if necessary. 
+0001f990: 2020 2020 2020 2069 6620 6669 7273 745f         if first_
+0001f9a0: 726f 7720 3e20 6c61 7374 5f72 6f77 3a0a  row > last_row:.
+0001f9b0: 2020 2020 2020 2020 2020 2020 2866 6972              (fir
+0001f9c0: 7374 5f72 6f77 2c20 6c61 7374 5f72 6f77  st_row, last_row
+0001f9d0: 2920 3d20 286c 6173 745f 726f 772c 2066  ) = (last_row, f
+0001f9e0: 6972 7374 5f72 6f77 290a 0a20 2020 2020  irst_row)..     
+0001f9f0: 2020 2069 6620 6669 7273 745f 636f 6c20     if first_col 
+0001fa00: 3e20 6c61 7374 5f63 6f6c 3a0a 2020 2020  > last_col:.    
+0001fa10: 2020 2020 2020 2020 2866 6972 7374 5f63          (first_c
+0001fa20: 6f6c 2c20 6c61 7374 5f63 6f6c 2920 3d20  ol, last_col) = 
+0001fa30: 286c 6173 745f 636f 6c2c 2066 6972 7374  (last_col, first
+0001fa40: 5f63 6f6c 290a 0a20 2020 2020 2020 2073  _col)..        s
+0001fa50: 7172 6566 203d 2078 6c5f 7261 6e67 6528  qref = xl_range(
+0001fa60: 6669 7273 745f 726f 772c 2066 6972 7374  first_row, first
+0001fa70: 5f63 6f6c 2c20 6c61 7374 5f72 6f77 2c20  _col, last_row, 
+0001fa80: 6c61 7374 5f63 6f6c 290a 0a20 2020 2020  last_col)..     
+0001fa90: 2020 2023 2053 656c 6563 7469 6f6e 2069     # Selection i
+0001faa0: 736e 2774 2073 6574 2066 6f72 2063 656c  sn't set for cel
+0001fab0: 6c20 4131 2e0a 2020 2020 2020 2020 6966  l A1..        if
+0001fac0: 2073 7172 6566 203d 3d20 2241 3122 3a0a   sqref == "A1":.
+0001fad0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0001fae0: 726e 0a0a 2020 2020 2020 2020 7365 6c66  rn..        self
+0001faf0: 2e73 656c 6563 7469 6f6e 7320 3d20 5b5b  .selections = [[
+0001fb00: 7061 6e65 2c20 6163 7469 7665 5f63 656c  pane, active_cel
+0001fb10: 6c2c 2073 7172 6566 5d5d 0a0a 2020 2020  l, sqref]]..    
+0001fb20: 4063 6f6e 7665 7274 5f63 656c 6c5f 6172  @convert_cell_ar
+0001fb30: 6773 0a20 2020 2064 6566 2073 6574 5f74  gs.    def set_t
+0001fb40: 6f70 5f6c 6566 745f 6365 6c6c 2873 656c  op_left_cell(sel
+0001fb50: 662c 2072 6f77 3d30 2c20 636f 6c3d 3029  f, row=0, col=0)
+0001fb60: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0001fb70: 2020 2020 2020 5365 7420 7468 6520 6669        Set the fi
+0001fb80: 7273 7420 7669 7369 626c 6520 6365 6c6c  rst visible cell
+0001fb90: 2061 7420 7468 6520 746f 7020 6c65 6674   at the top left
+0001fba0: 206f 6620 6120 776f 726b 7368 6565 742e   of a worksheet.
+0001fbb0: 0a0a 2020 2020 2020 2020 4172 6773 3a0a  ..        Args:.
+0001fbc0: 2020 2020 2020 2020 2020 2020 726f 773a              row:
+0001fbd0: 2054 6865 2063 656c 6c20 726f 7720 287a   The cell row (z
+0001fbe0: 6572 6f20 696e 6465 7865 6429 2e0a 2020  ero indexed)..  
+0001fbf0: 2020 2020 2020 2020 2020 636f 6c3a 2054            col: T
+0001fc00: 6865 2063 656c 6c20 636f 6c75 6d6e 2028  he cell column (
+0001fc10: 7a65 726f 2069 6e64 6578 6564 292e 0a0a  zero indexed)...
+0001fc20: 2020 2020 2020 2020 5265 7475 726e 733a          Returns:
+0001fc30: 0a20 2020 2020 2020 2020 2020 2030 3a20  .            0: 
+0001fc40: 204e 6f74 6869 6e67 2e0a 2020 2020 2020   Nothing..      
+0001fc50: 2020 2222 220a 0a20 2020 2020 2020 2069    """..        i
+0001fc60: 6620 726f 7720 3d3d 2030 2061 6e64 2063  f row == 0 and c
+0001fc70: 6f6c 203d 3d20 303a 0a20 2020 2020 2020  ol == 0:.       
+0001fc80: 2020 2020 2072 6574 7572 6e0a 0a20 2020       return..   
+0001fc90: 2020 2020 2073 656c 662e 746f 705f 6c65       self.top_le
+0001fca0: 6674 5f63 656c 6c20 3d20 786c 5f72 6f77  ft_cell = xl_row
+0001fcb0: 636f 6c5f 746f 5f63 656c 6c28 726f 772c  col_to_cell(row,
+0001fcc0: 2063 6f6c 290a 0a20 2020 2064 6566 206f   col)..    def o
+0001fcd0: 7574 6c69 6e65 5f73 6574 7469 6e67 7328  utline_settings(
+0001fce0: 0a20 2020 2020 2020 2073 656c 662c 2076  .        self, v
+0001fcf0: 6973 6962 6c65 3d31 2c20 7379 6d62 6f6c  isible=1, symbol
+0001fd00: 735f 6265 6c6f 773d 312c 2073 796d 626f  s_below=1, symbo
+0001fd10: 6c73 5f72 6967 6874 3d31 2c20 6175 746f  ls_right=1, auto
+0001fd20: 5f73 7479 6c65 3d30 0a20 2020 2029 3a0a  _style=0.    ):.
+0001fd30: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001fd40: 2020 2020 436f 6e74 726f 6c20 6f75 746c      Control outl
+0001fd50: 696e 6520 7365 7474 696e 6773 2e0a 0a20  ine settings... 
+0001fd60: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
+0001fd70: 2020 2020 2020 2020 2076 6973 6962 6c65           visible
+0001fd80: 3a20 2020 2020 2020 4f75 746c 696e 6573  :       Outlines
+0001fd90: 2061 7265 2076 6973 6962 6c65 2e20 4f70   are visible. Op
+0001fda0: 7469 6f6e 616c 2c20 6465 6661 756c 7473  tional, defaults
+0001fdb0: 2074 6f20 5472 7565 2e0a 2020 2020 2020   to True..      
+0001fdc0: 2020 2020 2020 7379 6d62 6f6c 735f 6265        symbols_be
+0001fdd0: 6c6f 773a 2053 686f 7720 726f 7720 6f75  low: Show row ou
+0001fde0: 746c 696e 6520 7379 6d62 6f6c 7320 6265  tline symbols be
+0001fdf0: 6c6f 7720 7468 6520 6f75 746c 696e 6520  low the outline 
+0001fe00: 6261 722e 0a20 2020 2020 2020 2020 2020  bar..           
+0001fe10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fe20: 4f70 7469 6f6e 616c 2c20 6465 6661 756c  Optional, defaul
+0001fe30: 7473 2074 6f20 5472 7565 2e0a 2020 2020  ts to True..    
+0001fe40: 2020 2020 2020 2020 7379 6d62 6f6c 735f          symbols_
+0001fe50: 7269 6768 743a 2053 686f 7720 636f 6c75  right: Show colu
+0001fe60: 6d6e 206f 7574 6c69 6e65 2073 796d 626f  mn outline symbo
+0001fe70: 6c73 2074 6f20 7468 6520 7269 6768 7420  ls to the right 
+0001fe80: 6f66 2074 6865 0a20 2020 2020 2020 2020  of the.         
+0001fe90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fea0: 2020 6f75 746c 696e 6520 6261 722e 204f    outline bar. O
+0001feb0: 7074 696f 6e61 6c2c 2064 6566 6175 6c74  ptional, default
+0001fec0: 7320 746f 2054 7275 652e 0a20 2020 2020  s to True..     
+0001fed0: 2020 2020 2020 2061 7574 6f5f 7374 796c         auto_styl
+0001fee0: 653a 2020 2020 5573 6520 4175 746f 6d61  e:    Use Automa
+0001fef0: 7469 6320 7374 796c 652e 204f 7074 696f  tic style. Optio
+0001ff00: 6e61 6c2c 2064 6566 6175 6c74 7320 746f  nal, defaults to
+0001ff10: 2046 616c 7365 2e0a 0a20 2020 2020 2020   False...       
+0001ff20: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
+0001ff30: 2020 2020 2020 303a 2020 4e6f 7468 696e        0:  Nothin
+0001ff40: 672e 0a20 2020 2020 2020 2022 2222 0a20  g..        """. 
+0001ff50: 2020 2020 2020 2073 656c 662e 6f75 746c         self.outl
+0001ff60: 696e 655f 6f6e 203d 2076 6973 6962 6c65  ine_on = visible
+0001ff70: 0a20 2020 2020 2020 2073 656c 662e 6f75  .        self.ou
+0001ff80: 746c 696e 655f 6265 6c6f 7720 3d20 7379  tline_below = sy
+0001ff90: 6d62 6f6c 735f 6265 6c6f 770a 2020 2020  mbols_below.    
+0001ffa0: 2020 2020 7365 6c66 2e6f 7574 6c69 6e65      self.outline
+0001ffb0: 5f72 6967 6874 203d 2073 796d 626f 6c73  _right = symbols
+0001ffc0: 5f72 6967 6874 0a20 2020 2020 2020 2073  _right.        s
+0001ffd0: 656c 662e 6f75 746c 696e 655f 7374 796c  elf.outline_styl
+0001ffe0: 6520 3d20 6175 746f 5f73 7479 6c65 0a0a  e = auto_style..
+0001fff0: 2020 2020 2020 2020 7365 6c66 2e6f 7574          self.out
+00020000: 6c69 6e65 5f63 6861 6e67 6564 203d 2054  line_changed = T
+00020010: 7275 650a 0a20 2020 2040 636f 6e76 6572  rue..    @conver
+00020020: 745f 6365 6c6c 5f61 7267 730a 2020 2020  t_cell_args.    
+00020030: 6465 6620 6672 6565 7a65 5f70 616e 6573  def freeze_panes
+00020040: 2873 656c 662c 2072 6f77 2c20 636f 6c2c  (self, row, col,
+00020050: 2074 6f70 5f72 6f77 3d4e 6f6e 652c 206c   top_row=None, l
+00020060: 6566 745f 636f 6c3d 4e6f 6e65 2c20 7061  eft_col=None, pa
+00020070: 6e65 5f74 7970 653d 3029 3a0a 2020 2020  ne_type=0):.    
+00020080: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00020090: 4372 6561 7465 2077 6f72 6b73 6865 6574  Create worksheet
+000200a0: 2070 616e 6573 2061 6e64 206d 6172 6b20   panes and mark 
+000200b0: 7468 656d 2061 7320 6672 6f7a 656e 2e0a  them as frozen..
+000200c0: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
+000200d0: 2020 2020 2020 2020 2020 2072 6f77 3a20             row: 
+000200e0: 2020 2020 2054 6865 2063 656c 6c20 726f       The cell ro
+000200f0: 7720 287a 6572 6f20 696e 6465 7865 6429  w (zero indexed)
+00020100: 2e0a 2020 2020 2020 2020 2020 2020 636f  ..            co
+00020110: 6c3a 2020 2020 2020 5468 6520 6365 6c6c  l:      The cell
+00020120: 2063 6f6c 756d 6e20 287a 6572 6f20 696e   column (zero in
+00020130: 6465 7865 6429 2e0a 2020 2020 2020 2020  dexed)..        
+00020140: 2020 2020 746f 705f 726f 773a 2020 546f      top_row:  To
+00020150: 706d 6f73 7420 7669 7369 626c 6520 726f  pmost visible ro
+00020160: 7720 696e 2073 6372 6f6c 6c69 6e67 2072  w in scrolling r
+00020170: 6567 696f 6e20 6f66 2070 616e 652e 0a20  egion of pane.. 
+00020180: 2020 2020 2020 2020 2020 206c 6566 745f             left_
+00020190: 636f 6c3a 204c 6566 746d 6f73 7420 7669  col: Leftmost vi
+000201a0: 7369 626c 6520 726f 7720 696e 2073 6372  sible row in scr
+000201b0: 6f6c 6c69 6e67 2072 6567 696f 6e20 6f66  olling region of
+000201c0: 2070 616e 652e 0a0a 2020 2020 2020 2020   pane...        
+000201d0: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
+000201e0: 2020 2020 2030 3a20 204e 6f74 6869 6e67       0:  Nothing
+000201f0: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
+00020200: 2020 2020 2020 2069 6620 746f 705f 726f         if top_ro
+00020210: 7720 6973 204e 6f6e 653a 0a20 2020 2020  w is None:.     
+00020220: 2020 2020 2020 2074 6f70 5f72 6f77 203d         top_row =
+00020230: 2072 6f77 0a0a 2020 2020 2020 2020 6966   row..        if
+00020240: 206c 6566 745f 636f 6c20 6973 204e 6f6e   left_col is Non
+00020250: 653a 0a20 2020 2020 2020 2020 2020 206c  e:.            l
+00020260: 6566 745f 636f 6c20 3d20 636f 6c0a 0a20  eft_col = col.. 
+00020270: 2020 2020 2020 2073 656c 662e 7061 6e65         self.pane
+00020280: 7320 3d20 5b72 6f77 2c20 636f 6c2c 2074  s = [row, col, t
+00020290: 6f70 5f72 6f77 2c20 6c65 6674 5f63 6f6c  op_row, left_col
+000202a0: 2c20 7061 6e65 5f74 7970 655d 0a0a 2020  , pane_type]..  
+000202b0: 2020 4063 6f6e 7665 7274 5f63 656c 6c5f    @convert_cell_
+000202c0: 6172 6773 0a20 2020 2064 6566 2073 706c  args.    def spl
+000202d0: 6974 5f70 616e 6573 2873 656c 662c 2078  it_panes(self, x
+000202e0: 2c20 792c 2074 6f70 5f72 6f77 3d4e 6f6e  , y, top_row=Non
+000202f0: 652c 206c 6566 745f 636f 6c3d 4e6f 6e65  e, left_col=None
+00020300: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00020310: 2020 2020 2020 2043 7265 6174 6520 776f         Create wo
+00020320: 726b 7368 6565 7420 7061 6e65 7320 616e  rksheet panes an
+00020330: 6420 6d61 726b 2074 6865 6d20 6173 2073  d mark them as s
+00020340: 706c 6974 2e0a 0a20 2020 2020 2020 2041  plit...        A
+00020350: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
+00020360: 2078 3a20 2020 2020 2020 2054 6865 2070   x:        The p
+00020370: 6f73 6974 696f 6e20 666f 7220 7468 6520  osition for the 
+00020380: 7665 7274 6963 616c 2073 706c 6974 2e0a  vertical split..
+00020390: 2020 2020 2020 2020 2020 2020 793a 2020              y:  
+000203a0: 2020 2020 2020 5468 6520 706f 7369 7469        The positi
+000203b0: 6f6e 2066 6f72 2074 6865 2068 6f72 697a  on for the horiz
+000203c0: 6f6e 7461 6c20 7370 6c69 742e 0a20 2020  ontal split..   
+000203d0: 2020 2020 2020 2020 2074 6f70 5f72 6f77           top_row
+000203e0: 3a20 2054 6f70 6d6f 7374 2076 6973 6962  :  Topmost visib
+000203f0: 6c65 2072 6f77 2069 6e20 7363 726f 6c6c  le row in scroll
+00020400: 696e 6720 7265 6769 6f6e 206f 6620 7061  ing region of pa
+00020410: 6e65 2e0a 2020 2020 2020 2020 2020 2020  ne..            
+00020420: 6c65 6674 5f63 6f6c 3a20 4c65 6674 6d6f  left_col: Leftmo
+00020430: 7374 2076 6973 6962 6c65 2072 6f77 2069  st visible row i
+00020440: 6e20 7363 726f 6c6c 696e 6720 7265 6769  n scrolling regi
+00020450: 6f6e 206f 6620 7061 6e65 2e0a 0a20 2020  on of pane...   
+00020460: 2020 2020 2052 6574 7572 6e73 3a0a 2020       Returns:.  
+00020470: 2020 2020 2020 2020 2020 303a 2020 4e6f            0:  No
+00020480: 7468 696e 672e 0a0a 2020 2020 2020 2020  thing...        
+00020490: 2222 220a 2020 2020 2020 2020 2320 5361  """.        # Sa
+000204a0: 6d65 2061 7320 6672 6565 7a65 2070 616e  me as freeze pan
+000204b0: 6573 2077 6974 6820 6120 6469 6666 6572  es with a differ
+000204c0: 656e 7420 7061 6e65 2074 7970 652e 0a20  ent pane type.. 
+000204d0: 2020 2020 2020 2073 656c 662e 6672 6565         self.free
+000204e0: 7a65 5f70 616e 6573 2878 2c20 792c 2074  ze_panes(x, y, t
+000204f0: 6f70 5f72 6f77 2c20 6c65 6674 5f63 6f6c  op_row, left_col
+00020500: 2c20 3229 0a0a 2020 2020 6465 6620 7365  , 2)..    def se
+00020510: 745f 7a6f 6f6d 2873 656c 662c 207a 6f6f  t_zoom(self, zoo
+00020520: 6d3d 3130 3029 3a0a 2020 2020 2020 2020  m=100):.        
+00020530: 2222 220a 2020 2020 2020 2020 5365 7420  """.        Set 
+00020540: 7468 6520 776f 726b 7368 6565 7420 7a6f  the worksheet zo
+00020550: 6f6d 2066 6163 746f 722e 0a0a 2020 2020  om factor...    
+00020560: 2020 2020 4172 6773 3a0a 2020 2020 2020      Args:.      
+00020570: 2020 2020 2020 7a6f 6f6d 3a20 5363 616c        zoom: Scal
+00020580: 6520 6661 6374 6f72 3a20 3130 203c 3d20  e factor: 10 <= 
+00020590: 7a6f 6f6d 203c 3d20 3430 302e 0a0a 2020  zoom <= 400...  
+000205a0: 2020 2020 2020 5265 7475 726e 733a 0a20        Returns:. 
+000205b0: 2020 2020 2020 2020 2020 204e 6f74 6869             Nothi
+000205c0: 6e67 2e0a 0a20 2020 2020 2020 2022 2222  ng...        """
+000205d0: 0a20 2020 2020 2020 2023 2045 6e73 7572  .        # Ensur
+000205e0: 6520 7468 6520 7a6f 6f6d 2073 6361 6c65  e the zoom scale
+000205f0: 2069 7320 696e 2045 7863 656c 2773 2072   is in Excel's r
+00020600: 616e 6765 2e0a 2020 2020 2020 2020 6966  ange..        if
+00020610: 207a 6f6f 6d20 3c20 3130 206f 7220 7a6f   zoom < 10 or zo
+00020620: 6f6d 203e 2034 3030 3a0a 2020 2020 2020  om > 400:.      
+00020630: 2020 2020 2020 7761 726e 2822 5a6f 6f6d        warn("Zoom
+00020640: 2066 6163 746f 7220 2564 206f 7574 7369   factor %d outsi
+00020650: 6465 2072 616e 6765 3a20 3130 203c 3d20  de range: 10 <= 
+00020660: 7a6f 6f6d 203c 3d20 3430 3022 2025 207a  zoom <= 400" % z
+00020670: 6f6f 6d29 0a20 2020 2020 2020 2020 2020  oom).           
+00020680: 207a 6f6f 6d20 3d20 3130 300a 0a20 2020   zoom = 100..   
+00020690: 2020 2020 2073 656c 662e 7a6f 6f6d 203d       self.zoom =
+000206a0: 2069 6e74 287a 6f6f 6d29 0a0a 2020 2020   int(zoom)..    
+000206b0: 6465 6620 7269 6768 745f 746f 5f6c 6566  def right_to_lef
+000206c0: 7428 7365 6c66 293a 0a20 2020 2020 2020  t(self):.       
+000206d0: 2022 2222 0a20 2020 2020 2020 2044 6973   """.        Dis
+000206e0: 706c 6179 2074 6865 2077 6f72 6b73 6865  play the workshe
+000206f0: 6574 2072 6967 6874 2074 6f20 6c65 6674  et right to left
+00020700: 2066 6f72 2073 6f6d 6520 7665 7273 696f   for some versio
+00020710: 6e73 206f 6620 4578 6365 6c2e 0a0a 2020  ns of Excel...  
+00020720: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
+00020730: 2020 2020 2020 2020 4e6f 6e65 2e0a 0a20          None... 
+00020740: 2020 2020 2020 2052 6574 7572 6e73 3a0a         Returns:.
+00020750: 2020 2020 2020 2020 2020 2020 4e6f 7468              Noth
+00020760: 696e 672e 0a0a 2020 2020 2020 2020 2222  ing...        ""
+00020770: 220a 2020 2020 2020 2020 7365 6c66 2e69  ".        self.i
+00020780: 735f 7269 6768 745f 746f 5f6c 6566 7420  s_right_to_left 
+00020790: 3d20 310a 0a20 2020 2064 6566 2068 6964  = 1..    def hid
+000207a0: 655f 7a65 726f 2873 656c 6629 3a0a 2020  e_zero(self):.  
+000207b0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000207c0: 2020 4869 6465 207a 6572 6f20 7661 6c75    Hide zero valu
+000207d0: 6573 2069 6e20 776f 726b 7368 6565 7420  es in worksheet 
+000207e0: 6365 6c6c 732e 0a0a 2020 2020 2020 2020  cells...        
+000207f0: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
+00020800: 2020 4e6f 6e65 2e0a 0a20 2020 2020 2020    None...       
+00020810: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
+00020820: 2020 2020 2020 4e6f 7468 696e 672e 0a0a        Nothing...
+00020830: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00020840: 2020 2020 7365 6c66 2e73 686f 775f 7a65      self.show_ze
+00020850: 726f 7320 3d20 300a 0a20 2020 2064 6566  ros = 0..    def
+00020860: 2073 6574 5f74 6162 5f63 6f6c 6f72 2873   set_tab_color(s
+00020870: 656c 662c 2063 6f6c 6f72 293a 0a20 2020  elf, color):.   
+00020880: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00020890: 2053 6574 2074 6865 2063 6f6c 6f72 206f   Set the color o
+000208a0: 6620 7468 6520 776f 726b 7368 6565 7420  f the worksheet 
+000208b0: 7461 622e 0a0a 2020 2020 2020 2020 4172  tab...        Ar
+000208c0: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+000208d0: 636f 6c6f 723a 2041 2023 5247 4220 636f  color: A #RGB co
+000208e0: 6c6f 7220 696e 6465 782e 0a0a 2020 2020  lor index...    
+000208f0: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
+00020900: 2020 2020 2020 2020 204e 6f74 6869 6e67           Nothing
+00020910: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
+00020920: 2020 2020 2020 2073 656c 662e 7461 625f         self.tab_
+00020930: 636f 6c6f 7220 3d20 786c 5f63 6f6c 6f72  color = xl_color
+00020940: 2863 6f6c 6f72 290a 0a20 2020 2064 6566  (color)..    def
+00020950: 2070 726f 7465 6374 2873 656c 662c 2070   protect(self, p
+00020960: 6173 7377 6f72 643d 2222 2c20 6f70 7469  assword="", opti
+00020970: 6f6e 733d 4e6f 6e65 293a 0a20 2020 2020  ons=None):.     
+00020980: 2020 2022 2222 0a20 2020 2020 2020 2053     """.        S
+00020990: 6574 2074 6865 2070 6173 7377 6f72 6420  et the password 
+000209a0: 616e 6420 7072 6f74 6563 7469 6f6e 206f  and protection o
+000209b0: 7074 696f 6e73 206f 6620 7468 6520 776f  ptions of the wo
+000209c0: 726b 7368 6565 742e 0a0a 2020 2020 2020  rksheet...      
+000209d0: 2020 4172 6773 3a0a 2020 2020 2020 2020    Args:.        
+000209e0: 2020 2020 7061 7373 776f 7264 3a20 416e      password: An
+000209f0: 206f 7074 696f 6e61 6c20 7061 7373 776f   optional passwo
+00020a00: 7264 2073 7472 696e 672e 0a20 2020 2020  rd string..     
+00020a10: 2020 2020 2020 206f 7074 696f 6e73 3a20         options: 
+00020a20: 2041 2064 6963 7469 6f6e 6172 7920 6f66   A dictionary of
+00020a30: 2077 6f72 6b73 6865 6574 206f 626a 6563   worksheet objec
+00020a40: 7473 2074 6f20 7072 6f74 6563 742e 0a0a  ts to protect...
+00020a50: 2020 2020 2020 2020 5265 7475 726e 733a          Returns:
+00020a60: 0a20 2020 2020 2020 2020 2020 204e 6f74  .            Not
+00020a70: 6869 6e67 2e0a 0a20 2020 2020 2020 2022  hing...        "
+00020a80: 2222 0a20 2020 2020 2020 2069 6620 7061  "".        if pa
+00020a90: 7373 776f 7264 2021 3d20 2222 3a0a 2020  ssword != "":.  
+00020aa0: 2020 2020 2020 2020 2020 7061 7373 776f            passwo
+00020ab0: 7264 203d 2073 656c 662e 5f65 6e63 6f64  rd = self._encod
+00020ac0: 655f 7061 7373 776f 7264 2870 6173 7377  e_password(passw
+00020ad0: 6f72 6429 0a0a 2020 2020 2020 2020 6966  ord)..        if
+00020ae0: 206e 6f74 206f 7074 696f 6e73 3a0a 2020   not options:.  
+00020af0: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
+00020b00: 7320 3d20 7b7d 0a0a 2020 2020 2020 2020  s = {}..        
+00020b10: 2320 4465 6661 756c 7420 7661 6c75 6573  # Default values
+00020b20: 2066 6f72 206f 626a 6563 7473 2074 6861   for objects tha
+00020b30: 7420 6361 6e20 6265 2070 726f 7465 6374  t can be protect
+00020b40: 6564 2e0a 2020 2020 2020 2020 6465 6661  ed..        defa
+00020b50: 756c 7473 203d 207b 0a20 2020 2020 2020  ults = {.       
+00020b60: 2020 2020 2022 7368 6565 7422 3a20 5472       "sheet": Tr
+00020b70: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
+00020b80: 2263 6f6e 7465 6e74 223a 2046 616c 7365  "content": False
+00020b90: 2c0a 2020 2020 2020 2020 2020 2020 226f  ,.            "o
+00020ba0: 626a 6563 7473 223a 2046 616c 7365 2c0a  bjects": False,.
+00020bb0: 2020 2020 2020 2020 2020 2020 2273 6365              "sce
+00020bc0: 6e61 7269 6f73 223a 2046 616c 7365 2c0a  narios": False,.
+00020bd0: 2020 2020 2020 2020 2020 2020 2266 6f72              "for
+00020be0: 6d61 745f 6365 6c6c 7322 3a20 4661 6c73  mat_cells": Fals
+00020bf0: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+00020c00: 666f 726d 6174 5f63 6f6c 756d 6e73 223a  format_columns":
+00020c10: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+00020c20: 2020 2020 2266 6f72 6d61 745f 726f 7773      "format_rows
+00020c30: 223a 2046 616c 7365 2c0a 2020 2020 2020  ": False,.      
+00020c40: 2020 2020 2020 2269 6e73 6572 745f 636f        "insert_co
+00020c50: 6c75 6d6e 7322 3a20 4661 6c73 652c 0a20  lumns": False,. 
+00020c60: 2020 2020 2020 2020 2020 2022 696e 7365             "inse
+00020c70: 7274 5f72 6f77 7322 3a20 4661 6c73 652c  rt_rows": False,
+00020c80: 0a20 2020 2020 2020 2020 2020 2022 696e  .            "in
+00020c90: 7365 7274 5f68 7970 6572 6c69 6e6b 7322  sert_hyperlinks"
+00020ca0: 3a20 4661 6c73 652c 0a20 2020 2020 2020  : False,.       
+00020cb0: 2020 2020 2022 6465 6c65 7465 5f63 6f6c       "delete_col
+00020cc0: 756d 6e73 223a 2046 616c 7365 2c0a 2020  umns": False,.  
+00020cd0: 2020 2020 2020 2020 2020 2264 656c 6574            "delet
+00020ce0: 655f 726f 7773 223a 2046 616c 7365 2c0a  e_rows": False,.
+00020cf0: 2020 2020 2020 2020 2020 2020 2273 656c              "sel
+00020d00: 6563 745f 6c6f 636b 6564 5f63 656c 6c73  ect_locked_cells
+00020d10: 223a 2054 7275 652c 0a20 2020 2020 2020  ": True,.       
+00020d20: 2020 2020 2022 736f 7274 223a 2046 616c       "sort": Fal
+00020d30: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
+00020d40: 2261 7574 6f66 696c 7465 7222 3a20 4661  "autofilter": Fa
+00020d50: 6c73 652c 0a20 2020 2020 2020 2020 2020  lse,.           
+00020d60: 2022 7069 766f 745f 7461 626c 6573 223a   "pivot_tables":
+00020d70: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+00020d80: 2020 2020 2273 656c 6563 745f 756e 6c6f      "select_unlo
+00020d90: 636b 6564 5f63 656c 6c73 223a 2054 7275  cked_cells": Tru
+00020da0: 652c 0a20 2020 2020 2020 207d 0a0a 2020  e,.        }..  
+00020db0: 2020 2020 2020 2320 4f76 6572 7772 6974        # Overwrit
+00020dc0: 6520 7468 6520 6465 6661 756c 7473 2077  e the defaults w
+00020dd0: 6974 6820 7573 6572 2073 7065 6369 6669  ith user specifi
+00020de0: 6564 2076 616c 7565 732e 0a20 2020 2020  ed values..     
+00020df0: 2020 2066 6f72 206b 6579 2069 6e20 6f70     for key in op
+00020e00: 7469 6f6e 732e 6b65 7973 2829 3a0a 2020  tions.keys():.  
+00020e10: 2020 2020 2020 2020 2020 6966 206b 6579            if key
+00020e20: 2069 6e20 6465 6661 756c 7473 3a0a 2020   in defaults:.  
+00020e30: 2020 2020 2020 2020 2020 2020 2020 6465                de
+00020e40: 6661 756c 7473 5b6b 6579 5d20 3d20 6f70  faults[key] = op
+00020e50: 7469 6f6e 735b 6b65 795d 0a20 2020 2020  tions[key].     
+00020e60: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00020e70: 2020 2020 2020 2020 2020 2020 2077 6172               war
+00020e80: 6e28 2255 6e6b 6e6f 776e 2070 726f 7465  n("Unknown prote
+00020e90: 6374 696f 6e20 6f62 6a65 6374 3a20 2725  ction object: '%
+00020ea0: 7327 2220 2520 6b65 7929 0a0a 2020 2020  s'" % key)..    
+00020eb0: 2020 2020 2320 5365 7420 7468 6520 7061      # Set the pa
+00020ec0: 7373 776f 7264 2061 6674 6572 2074 6865  ssword after the
+00020ed0: 2075 7365 7220 6465 6669 6e65 6420 7661   user defined va
+00020ee0: 6c75 6573 2e0a 2020 2020 2020 2020 6465  lues..        de
+00020ef0: 6661 756c 7473 5b22 7061 7373 776f 7264  faults["password
+00020f00: 225d 203d 2070 6173 7377 6f72 640a 0a20  "] = password.. 
+00020f10: 2020 2020 2020 2073 656c 662e 7072 6f74         self.prot
+00020f20: 6563 745f 6f70 7469 6f6e 7320 3d20 6465  ect_options = de
+00020f30: 6661 756c 7473 0a0a 2020 2020 6465 6620  faults..    def 
+00020f40: 756e 7072 6f74 6563 745f 7261 6e67 6528  unprotect_range(
+00020f50: 7365 6c66 2c20 6365 6c6c 5f72 616e 6765  self, cell_range
+00020f60: 2c20 7261 6e67 655f 6e61 6d65 3d4e 6f6e  , range_name=Non
+00020f70: 652c 2070 6173 7377 6f72 643d 4e6f 6e65  e, password=None
+00020f80: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00020f90: 2020 2020 2020 2055 6e70 726f 7465 6374         Unprotect
+00020fa0: 2072 616e 6765 7320 7769 7468 696e 2061   ranges within a
+00020fb0: 2070 726f 7465 6374 6564 2077 6f72 6b73   protected works
+00020fc0: 6865 6574 2e0a 0a20 2020 2020 2020 2041  heet...        A
+00020fd0: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
+00020fe0: 2063 656c 6c5f 7261 6e67 653a 2054 6865   cell_range: The
+00020ff0: 2063 656c 6c20 6f72 2063 656c 6c20 7261   cell or cell ra
+00021000: 6e67 6520 746f 2075 6e70 726f 7465 6374  nge to unprotect
+00021010: 2e0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+00021020: 6e67 655f 6e61 6d65 3a20 416e 206f 7074  nge_name: An opt
+00021030: 696f 6e61 6c20 6e61 6d65 2066 6f72 2074  ional name for t
+00021040: 6865 2072 616e 6765 2e0a 2020 2020 2020  he range..      
+00021050: 2020 2020 2020 7061 7373 776f 7264 3a20        password: 
+00021060: 2020 416e 206f 7074 696f 6e61 6c20 7061    An optional pa
+00021070: 7373 776f 7264 2073 7472 696e 672e 2028  ssword string. (
+00021080: 756e 646f 6375 6d65 6e74 6564 290a 0a20  undocumented).. 
+00021090: 2020 2020 2020 2052 6574 7572 6e73 3a0a         Returns:.
+000210a0: 2020 2020 2020 2020 2020 2020 4e6f 7468              Noth
+000210b0: 696e 672e 0a0a 2020 2020 2020 2020 2222  ing...        ""
+000210c0: 220a 2020 2020 2020 2020 6966 2063 656c  ".        if cel
+000210d0: 6c5f 7261 6e67 6520 6973 204e 6f6e 653a  l_range is None:
+000210e0: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
+000210f0: 6e28 2243 656c 6c20 7261 6e67 6520 6d75  n("Cell range mu
+00021100: 7374 2062 6520 7370 6563 6966 6965 6420  st be specified 
+00021110: 696e 2075 6e70 726f 7465 6374 5f72 616e  in unprotect_ran
+00021120: 6765 2829 2229 0a20 2020 2020 2020 2020  ge()").         
+00021130: 2020 2072 6574 7572 6e20 2d31 0a0a 2020     return -1..  
+00021140: 2020 2020 2020 2320 5361 6e69 7469 7a65        # Sanitize
+00021150: 2074 6865 2063 656c 6c20 7261 6e67 652e   the cell range.
+00021160: 0a20 2020 2020 2020 2063 656c 6c5f 7261  .        cell_ra
+00021170: 6e67 6520 3d20 6365 6c6c 5f72 616e 6765  nge = cell_range
+00021180: 2e6c 7374 7269 7028 223d 2229 0a20 2020  .lstrip("=").   
+00021190: 2020 2020 2063 656c 6c5f 7261 6e67 6520       cell_range 
+000211a0: 3d20 6365 6c6c 5f72 616e 6765 2e72 6570  = cell_range.rep
+000211b0: 6c61 6365 2822 2422 2c20 2222 290a 0a20  lace("$", "").. 
+000211c0: 2020 2020 2020 2073 656c 662e 6e75 6d5f         self.num_
+000211d0: 7072 6f74 6563 7465 645f 7261 6e67 6573  protected_ranges
+000211e0: 202b 3d20 310a 0a20 2020 2020 2020 2069   += 1..        i
+000211f0: 6620 7261 6e67 655f 6e61 6d65 2069 7320  f range_name is 
+00021200: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00021210: 2020 7261 6e67 655f 6e61 6d65 203d 2022    range_name = "
+00021220: 5261 6e67 6522 202b 2073 7472 2873 656c  Range" + str(sel
+00021230: 662e 6e75 6d5f 7072 6f74 6563 7465 645f  f.num_protected_
+00021240: 7261 6e67 6573 290a 0a20 2020 2020 2020  ranges)..       
+00021250: 2069 6620 7061 7373 776f 7264 3a0a 2020   if password:.  
+00021260: 2020 2020 2020 2020 2020 7061 7373 776f            passwo
+00021270: 7264 203d 2073 656c 662e 5f65 6e63 6f64  rd = self._encod
+00021280: 655f 7061 7373 776f 7264 2870 6173 7377  e_password(passw
+00021290: 6f72 6429 0a0a 2020 2020 2020 2020 7365  ord)..        se
+000212a0: 6c66 2e70 726f 7465 6374 6564 5f72 616e  lf.protected_ran
+000212b0: 6765 732e 6170 7065 6e64 2828 6365 6c6c  ges.append((cell
+000212c0: 5f72 616e 6765 2c20 7261 6e67 655f 6e61  _range, range_na
+000212d0: 6d65 2c20 7061 7373 776f 7264 2929 0a0a  me, password))..
+000212e0: 2020 2020 4063 6f6e 7665 7274 5f63 656c      @convert_cel
+000212f0: 6c5f 6172 6773 0a20 2020 2064 6566 2069  l_args.    def i
+00021300: 6e73 6572 745f 6275 7474 6f6e 2873 656c  nsert_button(sel
+00021310: 662c 2072 6f77 2c20 636f 6c2c 206f 7074  f, row, col, opt
+00021320: 696f 6e73 3d4e 6f6e 6529 3a0a 2020 2020  ions=None):.    
+00021330: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00021340: 496e 7365 7274 2061 2062 7574 746f 6e20  Insert a button 
+00021350: 666f 726d 206f 626a 6563 7420 696e 746f  form object into
+00021360: 2074 6865 2077 6f72 6b73 6865 6574 2e0a   the worksheet..
+00021370: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
+00021380: 2020 2020 2020 2020 2020 2072 6f77 3a20             row: 
+00021390: 2020 2020 5468 6520 6365 6c6c 2072 6f77      The cell row
+000213a0: 2028 7a65 726f 2069 6e64 6578 6564 292e   (zero indexed).
+000213b0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+000213c0: 3a20 2020 2020 5468 6520 6365 6c6c 2063  :     The cell c
+000213d0: 6f6c 756d 6e20 287a 6572 6f20 696e 6465  olumn (zero inde
+000213e0: 7865 6429 2e0a 2020 2020 2020 2020 2020  xed)..          
+000213f0: 2020 6f70 7469 6f6e 733a 2042 7574 746f    options: Butto
+00021400: 6e20 666f 726d 6174 7469 6e67 206f 7074  n formatting opt
+00021410: 696f 6e73 2e0a 0a20 2020 2020 2020 2052  ions...        R
+00021420: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
+00021430: 2020 2020 303a 2020 5375 6363 6573 732e      0:  Success.
+00021440: 0a20 2020 2020 2020 2020 2020 202d 313a  .            -1:
+00021450: 2052 6f77 206f 7220 636f 6c75 6d6e 2069   Row or column i
+00021460: 7320 6f75 7420 6f66 2077 6f72 6b73 6865  s out of workshe
+00021470: 6574 2062 6f75 6e64 732e 0a0a 2020 2020  et bounds...    
+00021480: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00021490: 2320 4368 6563 6b20 696e 7365 7274 2028  # Check insert (
+000214a0: 726f 772c 2063 6f6c 2920 7769 7468 6f75  row, col) withou
+000214b0: 7420 7374 6f72 696e 672e 0a20 2020 2020  t storing..     
+000214c0: 2020 2069 6620 7365 6c66 2e5f 6368 6563     if self._chec
+000214d0: 6b5f 6469 6d65 6e73 696f 6e73 2872 6f77  k_dimensions(row
+000214e0: 2c20 636f 6c2c 2054 7275 652c 2054 7275  , col, True, Tru
+000214f0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00021500: 7761 726e 2822 4361 6e6e 6f74 2069 6e73  warn("Cannot ins
+00021510: 6572 7420 6275 7474 6f6e 2061 7420 2825  ert button at (%
+00021520: 642c 2025 6429 2e22 2025 2028 726f 772c  d, %d)." % (row,
+00021530: 2063 6f6c 2929 0a20 2020 2020 2020 2020   col)).         
+00021540: 2020 2072 6574 7572 6e20 2d31 0a0a 2020     return -1..  
+00021550: 2020 2020 2020 6966 206f 7074 696f 6e73        if options
+00021560: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00021570: 2020 2020 2020 6f70 7469 6f6e 7320 3d20        options = 
+00021580: 7b7d 0a0a 2020 2020 2020 2020 6275 7474  {}..        butt
+00021590: 6f6e 203d 2073 656c 662e 5f62 7574 746f  on = self._butto
+000215a0: 6e5f 7061 7261 6d73 2872 6f77 2c20 636f  n_params(row, co
+000215b0: 6c2c 206f 7074 696f 6e73 290a 0a20 2020  l, options)..   
+000215c0: 2020 2020 2073 656c 662e 6275 7474 6f6e       self.button
+000215d0: 735f 6c69 7374 2e61 7070 656e 6428 6275  s_list.append(bu
+000215e0: 7474 6f6e 290a 0a20 2020 2020 2020 2073  tton)..        s
+000215f0: 656c 662e 6861 735f 766d 6c20 3d20 310a  elf.has_vml = 1.
+00021600: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00021610: 300a 0a20 2020 2023 2323 2323 2323 2323  0..    #########
+00021620: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00021630: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00021640: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00021650: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00021660: 2323 0a20 2020 2023 0a20 2020 2023 2050  ##.    #.    # P
+00021670: 7562 6c69 6320 4150 492e 2050 6167 6520  ublic API. Page 
+00021680: 5365 7475 7020 6d65 7468 6f64 732e 0a20  Setup methods.. 
+00021690: 2020 2023 0a20 2020 2023 2323 2323 2323     #.    #######
+000216a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000216b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000216c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000216d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000216e0: 2323 2323 0a20 2020 2064 6566 2073 6574  ####.    def set
+000216f0: 5f6c 616e 6473 6361 7065 2873 656c 6629  _landscape(self)
+00021700: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00021710: 2020 2020 2020 5365 7420 7468 6520 7061        Set the pa
+00021720: 6765 206f 7269 656e 7461 7469 6f6e 2061  ge orientation a
+00021730: 7320 6c61 6e64 7363 6170 652e 0a0a 2020  s landscape...  
+00021740: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
+00021750: 2020 2020 2020 2020 4e6f 6e65 2e0a 0a20          None... 
+00021760: 2020 2020 2020 2052 6574 7572 6e73 3a0a         Returns:.
+00021770: 2020 2020 2020 2020 2020 2020 4e6f 7468              Noth
+00021780: 696e 672e 0a0a 2020 2020 2020 2020 2222  ing...        ""
+00021790: 220a 2020 2020 2020 2020 7365 6c66 2e6f  ".        self.o
+000217a0: 7269 656e 7461 7469 6f6e 203d 2030 0a20  rientation = 0. 
+000217b0: 2020 2020 2020 2073 656c 662e 7061 6765         self.page
+000217c0: 5f73 6574 7570 5f63 6861 6e67 6564 203d  _setup_changed =
+000217d0: 2054 7275 650a 0a20 2020 2064 6566 2073   True..    def s
+000217e0: 6574 5f70 6f72 7472 6169 7428 7365 6c66  et_portrait(self
+000217f0: 293a 0a20 2020 2020 2020 2022 2222 0a20  ):.        """. 
+00021800: 2020 2020 2020 2053 6574 2074 6865 2070         Set the p
+00021810: 6167 6520 6f72 6965 6e74 6174 696f 6e20  age orientation 
+00021820: 6173 2070 6f72 7472 6169 742e 0a0a 2020  as portrait...  
+00021830: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
+00021840: 2020 2020 2020 2020 4e6f 6e65 2e0a 0a20          None... 
+00021850: 2020 2020 2020 2052 6574 7572 6e73 3a0a         Returns:.
+00021860: 2020 2020 2020 2020 2020 2020 4e6f 7468              Noth
+00021870: 696e 672e 0a0a 2020 2020 2020 2020 2222  ing...        ""
+00021880: 220a 2020 2020 2020 2020 7365 6c66 2e6f  ".        self.o
+00021890: 7269 656e 7461 7469 6f6e 203d 2031 0a20  rientation = 1. 
+000218a0: 2020 2020 2020 2073 656c 662e 7061 6765         self.page
+000218b0: 5f73 6574 7570 5f63 6861 6e67 6564 203d  _setup_changed =
+000218c0: 2054 7275 650a 0a20 2020 2064 6566 2073   True..    def s
+000218d0: 6574 5f70 6167 655f 7669 6577 2873 656c  et_page_view(sel
+000218e0: 6629 3a0a 2020 2020 2020 2020 2222 220a  f):.        """.
+000218f0: 2020 2020 2020 2020 5365 7420 7468 6520          Set the 
+00021900: 7061 6765 2076 6965 7720 6d6f 6465 2e0a  page view mode..
+00021910: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
+00021920: 2020 2020 2020 2020 2020 204e 6f6e 652e             None.
+00021930: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00021940: 733a 0a20 2020 2020 2020 2020 2020 204e  s:.            N
+00021950: 6f74 6869 6e67 2e0a 0a20 2020 2020 2020  othing...       
+00021960: 2022 2222 0a20 2020 2020 2020 2073 656c   """.        sel
+00021970: 662e 7061 6765 5f76 6965 7720 3d20 310a  f.page_view = 1.
+00021980: 0a20 2020 2064 6566 2073 6574 5f70 6170  .    def set_pap
+00021990: 6572 2873 656c 662c 2070 6170 6572 5f73  er(self, paper_s
+000219a0: 697a 6529 3a0a 2020 2020 2020 2020 2222  ize):.        ""
+000219b0: 220a 2020 2020 2020 2020 5365 7420 7468  ".        Set th
+000219c0: 6520 7061 7065 7220 7479 7065 2e20 5553  e paper type. US
+000219d0: 204c 6574 7465 7220 3d20 312c 2041 3420   Letter = 1, A4 
+000219e0: 3d20 392e 0a0a 2020 2020 2020 2020 4172  = 9...        Ar
+000219f0: 6773 3a0a 2020 2020 2020 2020 2020 2020  gs:.            
+00021a00: 7061 7065 725f 7369 7a65 3a20 5061 7065  paper_size: Pape
+00021a10: 7220 696e 6465 782e 0a0a 2020 2020 2020  r index...      
+00021a20: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
+00021a30: 2020 2020 2020 204e 6f74 6869 6e67 2e0a         Nothing..
+00021a40: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00021a50: 2020 2020 2069 6620 7061 7065 725f 7369       if paper_si
+00021a60: 7a65 3a0a 2020 2020 2020 2020 2020 2020  ze:.            
+00021a70: 7365 6c66 2e70 6170 6572 5f73 697a 6520  self.paper_size 
+00021a80: 3d20 7061 7065 725f 7369 7a65 0a20 2020  = paper_size.   
+00021a90: 2020 2020 2020 2020 2073 656c 662e 7061           self.pa
+00021aa0: 6765 5f73 6574 7570 5f63 6861 6e67 6564  ge_setup_changed
+00021ab0: 203d 2054 7275 650a 0a20 2020 2064 6566   = True..    def
+00021ac0: 2063 656e 7465 725f 686f 7269 7a6f 6e74   center_horizont
+00021ad0: 616c 6c79 2873 656c 6629 3a0a 2020 2020  ally(self):.    
+00021ae0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00021af0: 4365 6e74 6572 2074 6865 2070 6167 6520  Center the page 
+00021b00: 686f 7269 7a6f 6e74 616c 6c79 2e0a 0a20  horizontally... 
+00021b10: 2020 2020 2020 2041 7267 733a 0a20 2020         Args:.   
+00021b20: 2020 2020 2020 2020 204e 6f6e 652e 0a0a           None...
+00021b30: 2020 2020 2020 2020 5265 7475 726e 733a          Returns:
+00021b40: 0a20 2020 2020 2020 2020 2020 204e 6f74  .            Not
+00021b50: 6869 6e67 2e0a 0a20 2020 2020 2020 2022  hing...        "
+00021b60: 2222 0a20 2020 2020 2020 2073 656c 662e  "".        self.
+00021b70: 7072 696e 745f 6f70 7469 6f6e 735f 6368  print_options_ch
+00021b80: 616e 6765 6420 3d20 5472 7565 0a20 2020  anged = True.   
+00021b90: 2020 2020 2073 656c 662e 6863 656e 7465       self.hcente
+00021ba0: 7220 3d20 310a 0a20 2020 2064 6566 2063  r = 1..    def c
+00021bb0: 656e 7465 725f 7665 7274 6963 616c 6c79  enter_vertically
+00021bc0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00021bd0: 2222 220a 2020 2020 2020 2020 4365 6e74  """.        Cent
+00021be0: 6572 2074 6865 2070 6167 6520 7665 7274  er the page vert
+00021bf0: 6963 616c 6c79 2e0a 0a20 2020 2020 2020  ically...       
+00021c00: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
+00021c10: 2020 204e 6f6e 652e 0a0a 2020 2020 2020     None...      
+00021c20: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
+00021c30: 2020 2020 2020 204e 6f74 6869 6e67 2e0a         Nothing..
+00021c40: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00021c50: 2020 2020 2073 656c 662e 7072 696e 745f       self.print_
+00021c60: 6f70 7469 6f6e 735f 6368 616e 6765 6420  options_changed 
+00021c70: 3d20 5472 7565 0a20 2020 2020 2020 2073  = True.        s
+00021c80: 656c 662e 7663 656e 7465 7220 3d20 310a  elf.vcenter = 1.
+00021c90: 0a20 2020 2064 6566 2073 6574 5f6d 6172  .    def set_mar
+00021ca0: 6769 6e73 2873 656c 662c 206c 6566 743d  gins(self, left=
+00021cb0: 302e 372c 2072 6967 6874 3d30 2e37 2c20  0.7, right=0.7, 
+00021cc0: 746f 703d 302e 3735 2c20 626f 7474 6f6d  top=0.75, bottom
+00021cd0: 3d30 2e37 3529 3a0a 2020 2020 2020 2020  =0.75):.        
+00021ce0: 2222 220a 2020 2020 2020 2020 5365 7420  """.        Set 
+00021cf0: 616c 6c20 7468 6520 7061 6765 206d 6172  all the page mar
+00021d00: 6769 6e73 2069 6e20 696e 6368 6573 2e0a  gins in inches..
+00021d10: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
+00021d20: 2020 2020 2020 2020 2020 206c 6566 743a             left:
+00021d30: 2020 204c 6566 7420 6d61 7267 696e 2e0a     Left margin..
+00021d40: 2020 2020 2020 2020 2020 2020 7269 6768              righ
+00021d50: 743a 2020 5269 6768 7420 6d61 7267 696e  t:  Right margin
+00021d60: 2e0a 2020 2020 2020 2020 2020 2020 746f  ..            to
+00021d70: 703a 2020 2020 546f 7020 6d61 7267 696e  p:    Top margin
+00021d80: 2e0a 2020 2020 2020 2020 2020 2020 626f  ..            bo
+00021d90: 7474 6f6d 3a20 426f 7474 6f6d 206d 6172  ttom: Bottom mar
+00021da0: 6769 6e2e 0a0a 2020 2020 2020 2020 5265  gin...        Re
+00021db0: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
+00021dc0: 2020 204e 6f74 6869 6e67 2e0a 0a20 2020     Nothing...   
+00021dd0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00021de0: 2073 656c 662e 6d61 7267 696e 5f6c 6566   self.margin_lef
+00021df0: 7420 3d20 6c65 6674 0a20 2020 2020 2020  t = left.       
+00021e00: 2073 656c 662e 6d61 7267 696e 5f72 6967   self.margin_rig
+00021e10: 6874 203d 2072 6967 6874 0a20 2020 2020  ht = right.     
+00021e20: 2020 2073 656c 662e 6d61 7267 696e 5f74     self.margin_t
+00021e30: 6f70 203d 2074 6f70 0a20 2020 2020 2020  op = top.       
+00021e40: 2073 656c 662e 6d61 7267 696e 5f62 6f74   self.margin_bot
+00021e50: 746f 6d20 3d20 626f 7474 6f6d 0a0a 2020  tom = bottom..  
+00021e60: 2020 6465 6620 7365 745f 6865 6164 6572    def set_header
+00021e70: 2873 656c 662c 2068 6561 6465 723d 2222  (self, header=""
+00021e80: 2c20 6f70 7469 6f6e 733d 4e6f 6e65 2c20  , options=None, 
+00021e90: 6d61 7267 696e 3d4e 6f6e 6529 3a0a 2020  margin=None):.  
+00021ea0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00021eb0: 2020 5365 7420 7468 6520 7061 6765 2068    Set the page h
+00021ec0: 6561 6465 7220 6361 7074 696f 6e20 616e  eader caption an
+00021ed0: 6420 6f70 7469 6f6e 616c 206d 6172 6769  d optional margi
+00021ee0: 6e2e 0a0a 2020 2020 2020 2020 4172 6773  n...        Args
+00021ef0: 3a0a 2020 2020 2020 2020 2020 2020 6865  :.            he
+00021f00: 6164 6572 3a20 2048 6561 6465 7220 7374  ader:  Header st
+00021f10: 7269 6e67 2e0a 2020 2020 2020 2020 2020  ring..          
+00021f20: 2020 6d61 7267 696e 3a20 2048 6561 6465    margin:  Heade
+00021f30: 7220 6d61 7267 696e 2e0a 2020 2020 2020  r margin..      
+00021f40: 2020 2020 2020 6f70 7469 6f6e 733a 2048        options: H
+00021f50: 6561 6465 7220 6f70 7469 6f6e 732c 206d  eader options, m
+00021f60: 6169 6e6c 7920 666f 7220 696d 6167 6573  ainly for images
+00021f70: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+00021f80: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+00021f90: 4e6f 7468 696e 672e 0a0a 2020 2020 2020  Nothing...      
+00021fa0: 2020 2222 220a 2020 2020 2020 2020 6865    """.        he
+00021fb0: 6164 6572 5f6f 7269 6720 3d20 6865 6164  ader_orig = head
+00021fc0: 6572 0a20 2020 2020 2020 2068 6561 6465  er.        heade
+00021fd0: 7220 3d20 6865 6164 6572 2e72 6570 6c61  r = header.repla
+00021fe0: 6365 2822 265b 5069 6374 7572 655d 222c  ce("&[Picture]",
+00021ff0: 2022 2647 2229 0a0a 2020 2020 2020 2020   "&G")..        
+00022000: 6966 206c 656e 2868 6561 6465 7229 203e  if len(header) >
+00022010: 2032 3535 3a0a 2020 2020 2020 2020 2020   255:.          
+00022020: 2020 7761 726e 280a 2020 2020 2020 2020    warn(.        
+00022030: 2020 2020 2020 2020 2248 6561 6465 7220          "Header 
+00022040: 7374 7269 6e67 2063 616e 6e6f 7420 6265  string cannot be
+00022050: 206c 6f6e 6765 7220 7468 616e 2045 7863   longer than Exc
+00022060: 656c 2773 2022 2022 6c69 6d69 7420 6f66  el's " "limit of
+00022070: 2032 3535 2063 6861 7261 6374 6572 7322   255 characters"
+00022080: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00022090: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000220a0: 6e0a 0a20 2020 2020 2020 2069 6620 6f70  n..        if op
+000220b0: 7469 6f6e 7320 6973 206e 6f74 204e 6f6e  tions is not Non
+000220c0: 653a 0a20 2020 2020 2020 2020 2020 2023  e:.            #
+000220d0: 2046 6f72 2062 6163 6b77 6172 6420 636f   For backward co
+000220e0: 6d70 6174 6962 696c 6974 7920 616c 6c6f  mpatibility allo
+000220f0: 7720 6f70 7469 6f6e 7320 746f 2062 6520  w options to be 
+00022100: 7468 6520 6d61 7267 696e 2e0a 2020 2020  the margin..    
+00022110: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
+00022120: 7369 6e73 7461 6e63 6528 6f70 7469 6f6e  sinstance(option
+00022130: 732c 2064 6963 7429 3a0a 2020 2020 2020  s, dict):.      
+00022140: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
+00022150: 7320 3d20 7b22 6d61 7267 696e 223a 206f  s = {"margin": o
+00022160: 7074 696f 6e73 7d0a 2020 2020 2020 2020  ptions}.        
+00022170: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00022180: 2020 6f70 7469 6f6e 7320 3d20 7b7d 0a0a    options = {}..
+00022190: 2020 2020 2020 2020 2320 436f 7079 2074          # Copy t
+000221a0: 6865 2075 7365 7220 6465 6669 6e65 6420  he user defined 
+000221b0: 6f70 7469 6f6e 7320 736f 2074 6865 7920  options so they 
+000221c0: 6172 656e 2774 206d 6f64 6966 6965 642e  aren't modified.
+000221d0: 0a20 2020 2020 2020 206f 7074 696f 6e73  .        options
+000221e0: 203d 206f 7074 696f 6e73 2e63 6f70 7928   = options.copy(
+000221f0: 290a 0a20 2020 2020 2020 2023 2046 6f72  )..        # For
+00022200: 2062 6163 6b77 6172 6420 636f 6d70 6174   backward compat
+00022210: 6962 696c 6974 792e 0a20 2020 2020 2020  ibility..       
+00022220: 2069 6620 6d61 7267 696e 2069 7320 6e6f   if margin is no
+00022230: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00022240: 2020 2020 6f70 7469 6f6e 735b 226d 6172      options["mar
+00022250: 6769 6e22 5d20 3d20 6d61 7267 696e 0a0a  gin"] = margin..
+00022260: 2020 2020 2020 2020 2320 5265 7365 7420          # Reset 
+00022270: 7468 6520 6c69 7374 2069 6e20 6361 7365  the list in case
+00022280: 2074 6865 2066 756e 6374 696f 6e20 6973   the function is
+00022290: 2063 616c 6c65 6420 6d6f 7265 2074 6861   called more tha
+000222a0: 6e20 6f6e 6365 2e0a 2020 2020 2020 2020  n once..        
+000222b0: 7365 6c66 2e68 6561 6465 725f 696d 6167  self.header_imag
+000222c0: 6573 203d 205b 5d0a 0a20 2020 2020 2020  es = []..       
+000222d0: 2069 6620 6f70 7469 6f6e 732e 6765 7428   if options.get(
+000222e0: 2269 6d61 6765 5f6c 6566 7422 293a 0a20  "image_left"):. 
+000222f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00022300: 6865 6164 6572 5f69 6d61 6765 732e 6170  header_images.ap
+00022310: 7065 6e64 280a 2020 2020 2020 2020 2020  pend(.          
+00022320: 2020 2020 2020 5b6f 7074 696f 6e73 2e67        [options.g
+00022330: 6574 2822 696d 6167 655f 6c65 6674 2229  et("image_left")
+00022340: 2c20 6f70 7469 6f6e 732e 6765 7428 2269  , options.get("i
+00022350: 6d61 6765 5f64 6174 615f 6c65 6674 2229  mage_data_left")
+00022360: 2c20 224c 4822 5d0a 2020 2020 2020 2020  , "LH"].        
+00022370: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
+00022380: 6620 6f70 7469 6f6e 732e 6765 7428 2269  f options.get("i
+00022390: 6d61 6765 5f63 656e 7465 7222 293a 0a20  mage_center"):. 
+000223a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000223b0: 6865 6164 6572 5f69 6d61 6765 732e 6170  header_images.ap
+000223c0: 7065 6e64 280a 2020 2020 2020 2020 2020  pend(.          
+000223d0: 2020 2020 2020 5b6f 7074 696f 6e73 2e67        [options.g
+000223e0: 6574 2822 696d 6167 655f 6365 6e74 6572  et("image_center
+000223f0: 2229 2c20 6f70 7469 6f6e 732e 6765 7428  "), options.get(
+00022400: 2269 6d61 6765 5f64 6174 615f 6365 6e74  "image_data_cent
+00022410: 6572 2229 2c20 2243 4822 5d0a 2020 2020  er"), "CH"].    
+00022420: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00022430: 2020 2069 6620 6f70 7469 6f6e 732e 6765     if options.ge
+00022440: 7428 2269 6d61 6765 5f72 6967 6874 2229  t("image_right")
+00022450: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00022460: 6c66 2e68 6561 6465 725f 696d 6167 6573  lf.header_images
+00022470: 2e61 7070 656e 6428 0a20 2020 2020 2020  .append(.       
+00022480: 2020 2020 2020 2020 205b 6f70 7469 6f6e           [option
+00022490: 732e 6765 7428 2269 6d61 6765 5f72 6967  s.get("image_rig
+000224a0: 6874 2229 2c20 6f70 7469 6f6e 732e 6765  ht"), options.ge
+000224b0: 7428 2269 6d61 6765 5f64 6174 615f 7269  t("image_data_ri
+000224c0: 6768 7422 292c 2022 5248 225d 0a20 2020  ght"), "RH"].   
+000224d0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+000224e0: 2020 2020 706c 6163 6568 6f6c 6465 725f      placeholder_
+000224f0: 636f 756e 7420 3d20 6865 6164 6572 2e63  count = header.c
+00022500: 6f75 6e74 2822 2647 2229 0a20 2020 2020  ount("&G").     
+00022510: 2020 2069 6d61 6765 5f63 6f75 6e74 203d     image_count =
+00022520: 206c 656e 2873 656c 662e 6865 6164 6572   len(self.header
+00022530: 5f69 6d61 6765 7329 0a0a 2020 2020 2020  _images)..      
+00022540: 2020 6966 2070 6c61 6365 686f 6c64 6572    if placeholder
+00022550: 5f63 6f75 6e74 2021 3d20 696d 6167 655f  _count != image_
+00022560: 636f 756e 743a 0a20 2020 2020 2020 2020  count:.         
+00022570: 2020 2077 6172 6e28 0a20 2020 2020 2020     warn(.       
+00022580: 2020 2020 2020 2020 2022 4e75 6d62 6572           "Number
+00022590: 206f 6620 6865 6164 6572 2069 6d61 6765   of header image
+000225a0: 7320 2825 7329 2064 6f65 736e 2774 206d  s (%s) doesn't m
+000225b0: 6174 6368 2070 6c61 6365 686f 6c64 6572  atch placeholder
+000225c0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+000225d0: 2020 2022 636f 756e 7420 2825 7329 2069     "count (%s) i
+000225e0: 6e20 7374 7269 6e67 3a20 2573 220a 2020  n string: %s".  
+000225f0: 2020 2020 2020 2020 2020 2020 2020 2520                % 
+00022600: 2869 6d61 6765 5f63 6f75 6e74 2c20 706c  (image_count, pl
+00022610: 6163 6568 6f6c 6465 725f 636f 756e 742c  aceholder_count,
+00022620: 2068 6561 6465 725f 6f72 6967 290a 2020   header_orig).  
+00022630: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00022640: 2020 2020 2020 2020 7365 6c66 2e68 6561          self.hea
+00022650: 6465 725f 696d 6167 6573 203d 205b 5d0a  der_images = [].
+00022660: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00022670: 726e 0a0a 2020 2020 2020 2020 6966 2022  rn..        if "
+00022680: 616c 6967 6e5f 7769 7468 5f6d 6172 6769  align_with_margi
+00022690: 6e73 2220 696e 206f 7074 696f 6e73 3a0a  ns" in options:.
+000226a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000226b0: 2e68 6561 6465 725f 666f 6f74 6572 5f61  .header_footer_a
+000226c0: 6c69 676e 7320 3d20 6f70 7469 6f6e 735b  ligns = options[
+000226d0: 2261 6c69 676e 5f77 6974 685f 6d61 7267  "align_with_marg
+000226e0: 696e 7322 5d0a 0a20 2020 2020 2020 2069  ins"]..        i
+000226f0: 6620 2273 6361 6c65 5f77 6974 685f 646f  f "scale_with_do
+00022700: 6322 2069 6e20 6f70 7469 6f6e 733a 0a20  c" in options:. 
+00022710: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00022720: 6865 6164 6572 5f66 6f6f 7465 725f 7363  header_footer_sc
+00022730: 616c 6573 203d 206f 7074 696f 6e73 5b22  ales = options["
+00022740: 7363 616c 655f 7769 7468 5f64 6f63 225d  scale_with_doc"]
+00022750: 0a0a 2020 2020 2020 2020 7365 6c66 2e68  ..        self.h
+00022760: 6561 6465 7220 3d20 6865 6164 6572 0a20  eader = header. 
+00022770: 2020 2020 2020 2073 656c 662e 6d61 7267         self.marg
+00022780: 696e 5f68 6561 6465 7220 3d20 6f70 7469  in_header = opti
+00022790: 6f6e 732e 6765 7428 226d 6172 6769 6e22  ons.get("margin"
+000227a0: 2c20 302e 3329 0a20 2020 2020 2020 2073  , 0.3).        s
+000227b0: 656c 662e 6865 6164 6572 5f66 6f6f 7465  elf.header_foote
+000227c0: 725f 6368 616e 6765 6420 3d20 5472 7565  r_changed = True
+000227d0: 0a0a 2020 2020 2020 2020 6966 2069 6d61  ..        if ima
+000227e0: 6765 5f63 6f75 6e74 3a0a 2020 2020 2020  ge_count:.      
+000227f0: 2020 2020 2020 7365 6c66 2e68 6173 5f68        self.has_h
+00022800: 6561 6465 725f 766d 6c20 3d20 5472 7565  eader_vml = True
+00022810: 0a0a 2020 2020 6465 6620 7365 745f 666f  ..    def set_fo
+00022820: 6f74 6572 2873 656c 662c 2066 6f6f 7465  oter(self, foote
+00022830: 723d 2222 2c20 6f70 7469 6f6e 733d 4e6f  r="", options=No
+00022840: 6e65 2c20 6d61 7267 696e 3d4e 6f6e 6529  ne, margin=None)
+00022850: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00022860: 2020 2020 2020 5365 7420 7468 6520 7061        Set the pa
+00022870: 6765 2066 6f6f 7465 7220 6361 7074 696f  ge footer captio
+00022880: 6e20 616e 6420 6f70 7469 6f6e 616c 206d  n and optional m
+00022890: 6172 6769 6e2e 0a0a 2020 2020 2020 2020  argin...        
+000228a0: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
+000228b0: 2020 666f 6f74 6572 3a20 2046 6f6f 7465    footer:  Foote
+000228c0: 7220 7374 7269 6e67 2e0a 2020 2020 2020  r string..      
+000228d0: 2020 2020 2020 6d61 7267 696e 3a20 2046        margin:  F
+000228e0: 6f6f 7465 7220 6d61 7267 696e 2e0a 2020  ooter margin..  
+000228f0: 2020 2020 2020 2020 2020 6f70 7469 6f6e            option
+00022900: 733a 2046 6f6f 7465 7220 6f70 7469 6f6e  s: Footer option
+00022910: 732c 206d 6169 6e6c 7920 666f 7220 696d  s, mainly for im
+00022920: 6167 6573 2e0a 0a20 2020 2020 2020 2052  ages...        R
+00022930: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
+00022940: 2020 2020 4e6f 7468 696e 672e 0a0a 2020      Nothing...  
+00022950: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00022960: 2020 666f 6f74 6572 5f6f 7269 6720 3d20    footer_orig = 
+00022970: 666f 6f74 6572 0a20 2020 2020 2020 2066  footer.        f
+00022980: 6f6f 7465 7220 3d20 666f 6f74 6572 2e72  ooter = footer.r
+00022990: 6570 6c61 6365 2822 265b 5069 6374 7572  eplace("&[Pictur
+000229a0: 655d 222c 2022 2647 2229 0a0a 2020 2020  e]", "&G")..    
+000229b0: 2020 2020 6966 206c 656e 2866 6f6f 7465      if len(foote
+000229c0: 7229 203e 2032 3535 3a0a 2020 2020 2020  r) > 255:.      
+000229d0: 2020 2020 2020 7761 726e 280a 2020 2020        warn(.    
+000229e0: 2020 2020 2020 2020 2020 2020 2246 6f6f              "Foo
+000229f0: 7465 7220 7374 7269 6e67 2063 616e 6e6f  ter string canno
+00022a00: 7420 6265 206c 6f6e 6765 7220 7468 616e  t be longer than
+00022a10: 2045 7863 656c 2773 2022 2022 6c69 6d69   Excel's " "limi
+00022a20: 7420 6f66 2032 3535 2063 6861 7261 6374  t of 255 charact
+00022a30: 6572 7322 0a20 2020 2020 2020 2020 2020  ers".           
+00022a40: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
+00022a50: 6574 7572 6e0a 0a20 2020 2020 2020 2069  eturn..        i
+00022a60: 6620 6f70 7469 6f6e 7320 6973 206e 6f74  f options is not
+00022a70: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00022a80: 2020 2023 2046 6f72 2062 6163 6b77 6172     # For backwar
+00022a90: 6420 636f 6d70 6174 6962 696c 6974 7920  d compatibility 
+00022aa0: 616c 6c6f 7720 6f70 7469 6f6e 7320 746f  allow options to
+00022ab0: 2062 6520 7468 6520 6d61 7267 696e 2e0a   be the margin..
+00022ac0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00022ad0: 6f74 2069 7369 6e73 7461 6e63 6528 6f70  ot isinstance(op
+00022ae0: 7469 6f6e 732c 2064 6963 7429 3a0a 2020  tions, dict):.  
+00022af0: 2020 2020 2020 2020 2020 2020 2020 6f70                op
+00022b00: 7469 6f6e 7320 3d20 7b22 6d61 7267 696e  tions = {"margin
+00022b10: 223a 206f 7074 696f 6e73 7d0a 2020 2020  ": options}.    
+00022b20: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00022b30: 2020 2020 2020 6f70 7469 6f6e 7320 3d20        options = 
+00022b40: 7b7d 0a0a 2020 2020 2020 2020 2320 436f  {}..        # Co
+00022b50: 7079 2074 6865 2075 7365 7220 6465 6669  py the user defi
+00022b60: 6e65 6420 6f70 7469 6f6e 7320 736f 2074  ned options so t
+00022b70: 6865 7920 6172 656e 2774 206d 6f64 6966  hey aren't modif
+00022b80: 6965 642e 0a20 2020 2020 2020 206f 7074  ied..        opt
+00022b90: 696f 6e73 203d 206f 7074 696f 6e73 2e63  ions = options.c
+00022ba0: 6f70 7928 290a 0a20 2020 2020 2020 2023  opy()..        #
+00022bb0: 2046 6f72 2062 6163 6b77 6172 6420 636f   For backward co
+00022bc0: 6d70 6174 6962 696c 6974 792e 0a20 2020  mpatibility..   
+00022bd0: 2020 2020 2069 6620 6d61 7267 696e 2069       if margin i
+00022be0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00022bf0: 2020 2020 2020 2020 6f70 7469 6f6e 735b          options[
+00022c00: 226d 6172 6769 6e22 5d20 3d20 6d61 7267  "margin"] = marg
+00022c10: 696e 0a0a 2020 2020 2020 2020 2320 5265  in..        # Re
+00022c20: 7365 7420 7468 6520 6c69 7374 2069 6e20  set the list in 
+00022c30: 6361 7365 2074 6865 2066 756e 6374 696f  case the functio
+00022c40: 6e20 6973 2063 616c 6c65 6420 6d6f 7265  n is called more
+00022c50: 2074 6861 6e20 6f6e 6365 2e0a 2020 2020   than once..    
+00022c60: 2020 2020 7365 6c66 2e66 6f6f 7465 725f      self.footer_
+00022c70: 696d 6167 6573 203d 205b 5d0a 0a20 2020  images = []..   
+00022c80: 2020 2020 2069 6620 6f70 7469 6f6e 732e       if options.
+00022c90: 6765 7428 2269 6d61 6765 5f6c 6566 7422  get("image_left"
+00022ca0: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
+00022cb0: 656c 662e 666f 6f74 6572 5f69 6d61 6765  elf.footer_image
+00022cc0: 732e 6170 7065 6e64 280a 2020 2020 2020  s.append(.      
+00022cd0: 2020 2020 2020 2020 2020 5b6f 7074 696f            [optio
+00022ce0: 6e73 2e67 6574 2822 696d 6167 655f 6c65  ns.get("image_le
+00022cf0: 6674 2229 2c20 6f70 7469 6f6e 732e 6765  ft"), options.ge
+00022d00: 7428 2269 6d61 6765 5f64 6174 615f 6c65  t("image_data_le
+00022d10: 6674 2229 2c20 224c 4622 5d0a 2020 2020  ft"), "LF"].    
+00022d20: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00022d30: 2020 2069 6620 6f70 7469 6f6e 732e 6765     if options.ge
+00022d40: 7428 2269 6d61 6765 5f63 656e 7465 7222  t("image_center"
+00022d50: 293a 0a20 2020 2020 2020 2020 2020 2073  ):.            s
+00022d60: 656c 662e 666f 6f74 6572 5f69 6d61 6765  elf.footer_image
+00022d70: 732e 6170 7065 6e64 280a 2020 2020 2020  s.append(.      
+00022d80: 2020 2020 2020 2020 2020 5b6f 7074 696f            [optio
+00022d90: 6e73 2e67 6574 2822 696d 6167 655f 6365  ns.get("image_ce
+00022da0: 6e74 6572 2229 2c20 6f70 7469 6f6e 732e  nter"), options.
+00022db0: 6765 7428 2269 6d61 6765 5f64 6174 615f  get("image_data_
+00022dc0: 6365 6e74 6572 2229 2c20 2243 4622 5d0a  center"), "CF"].
+00022dd0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00022de0: 2020 2020 2020 2069 6620 6f70 7469 6f6e         if option
+00022df0: 732e 6765 7428 2269 6d61 6765 5f72 6967  s.get("image_rig
+00022e00: 6874 2229 3a0a 2020 2020 2020 2020 2020  ht"):.          
+00022e10: 2020 7365 6c66 2e66 6f6f 7465 725f 696d    self.footer_im
+00022e20: 6167 6573 2e61 7070 656e 6428 0a20 2020  ages.append(.   
+00022e30: 2020 2020 2020 2020 2020 2020 205b 6f70               [op
+00022e40: 7469 6f6e 732e 6765 7428 2269 6d61 6765  tions.get("image
+00022e50: 5f72 6967 6874 2229 2c20 6f70 7469 6f6e  _right"), option
+00022e60: 732e 6765 7428 2269 6d61 6765 5f64 6174  s.get("image_dat
+00022e70: 615f 7269 6768 7422 292c 2022 5246 225d  a_right"), "RF"]
+00022e80: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+00022e90: 2020 2020 2020 2020 706c 6163 6568 6f6c          placehol
+00022ea0: 6465 725f 636f 756e 7420 3d20 666f 6f74  der_count = foot
+00022eb0: 6572 2e63 6f75 6e74 2822 2647 2229 0a20  er.count("&G"). 
+00022ec0: 2020 2020 2020 2069 6d61 6765 5f63 6f75         image_cou
+00022ed0: 6e74 203d 206c 656e 2873 656c 662e 666f  nt = len(self.fo
+00022ee0: 6f74 6572 5f69 6d61 6765 7329 0a0a 2020  oter_images)..  
+00022ef0: 2020 2020 2020 6966 2070 6c61 6365 686f        if placeho
+00022f00: 6c64 6572 5f63 6f75 6e74 2021 3d20 696d  lder_count != im
+00022f10: 6167 655f 636f 756e 743a 0a20 2020 2020  age_count:.     
+00022f20: 2020 2020 2020 2077 6172 6e28 0a20 2020         warn(.   
+00022f30: 2020 2020 2020 2020 2020 2020 2022 4e75               "Nu
+00022f40: 6d62 6572 206f 6620 666f 6f74 6572 2069  mber of footer i
+00022f50: 6d61 6765 7320 2825 7329 2064 6f65 736e  mages (%s) doesn
+00022f60: 2774 206d 6174 6368 2070 6c61 6365 686f  't match placeho
+00022f70: 6c64 6572 2022 0a20 2020 2020 2020 2020  lder ".         
+00022f80: 2020 2020 2020 2022 636f 756e 7420 2825         "count (%
+00022f90: 7329 2069 6e20 7374 7269 6e67 3a20 2573  s) in string: %s
+00022fa0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00022fb0: 2020 2520 2869 6d61 6765 5f63 6f75 6e74    % (image_count
+00022fc0: 2c20 706c 6163 6568 6f6c 6465 725f 636f  , placeholder_co
+00022fd0: 756e 742c 2066 6f6f 7465 725f 6f72 6967  unt, footer_orig
+00022fe0: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
+00022ff0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00023000: 2e66 6f6f 7465 725f 696d 6167 6573 203d  .footer_images =
+00023010: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
+00023020: 7265 7475 726e 0a0a 2020 2020 2020 2020  return..        
+00023030: 6966 2022 616c 6967 6e5f 7769 7468 5f6d  if "align_with_m
+00023040: 6172 6769 6e73 2220 696e 206f 7074 696f  argins" in optio
+00023050: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+00023060: 7365 6c66 2e68 6561 6465 725f 666f 6f74  self.header_foot
+00023070: 6572 5f61 6c69 676e 7320 3d20 6f70 7469  er_aligns = opti
+00023080: 6f6e 735b 2261 6c69 676e 5f77 6974 685f  ons["align_with_
+00023090: 6d61 7267 696e 7322 5d0a 0a20 2020 2020  margins"]..     
+000230a0: 2020 2069 6620 2273 6361 6c65 5f77 6974     if "scale_wit
+000230b0: 685f 646f 6322 2069 6e20 6f70 7469 6f6e  h_doc" in option
+000230c0: 733a 0a20 2020 2020 2020 2020 2020 2073  s:.            s
+000230d0: 656c 662e 6865 6164 6572 5f66 6f6f 7465  elf.header_foote
+000230e0: 725f 7363 616c 6573 203d 206f 7074 696f  r_scales = optio
+000230f0: 6e73 5b22 7363 616c 655f 7769 7468 5f64  ns["scale_with_d
+00023100: 6f63 225d 0a0a 2020 2020 2020 2020 7365  oc"]..        se
+00023110: 6c66 2e66 6f6f 7465 7220 3d20 666f 6f74  lf.footer = foot
+00023120: 6572 0a20 2020 2020 2020 2073 656c 662e  er.        self.
+00023130: 6d61 7267 696e 5f66 6f6f 7465 7220 3d20  margin_footer = 
+00023140: 6f70 7469 6f6e 732e 6765 7428 226d 6172  options.get("mar
+00023150: 6769 6e22 2c20 302e 3329 0a20 2020 2020  gin", 0.3).     
+00023160: 2020 2073 656c 662e 6865 6164 6572 5f66     self.header_f
+00023170: 6f6f 7465 725f 6368 616e 6765 6420 3d20  ooter_changed = 
+00023180: 5472 7565 0a0a 2020 2020 2020 2020 6966  True..        if
+00023190: 2069 6d61 6765 5f63 6f75 6e74 3a0a 2020   image_count:.  
+000231a0: 2020 2020 2020 2020 2020 7365 6c66 2e68            self.h
+000231b0: 6173 5f68 6561 6465 725f 766d 6c20 3d20  as_header_vml = 
+000231c0: 5472 7565 0a0a 2020 2020 6465 6620 7265  True..    def re
+000231d0: 7065 6174 5f72 6f77 7328 7365 6c66 2c20  peat_rows(self, 
+000231e0: 6669 7273 745f 726f 772c 206c 6173 745f  first_row, last_
+000231f0: 726f 773d 4e6f 6e65 293a 0a20 2020 2020  row=None):.     
+00023200: 2020 2022 2222 0a20 2020 2020 2020 2053     """.        S
+00023210: 6574 2074 6865 2072 6f77 7320 746f 2072  et the rows to r
+00023220: 6570 6561 7420 6174 2074 6865 2074 6f70  epeat at the top
+00023230: 206f 6620 6561 6368 2070 7269 6e74 6564   of each printed
+00023240: 2070 6167 652e 0a0a 2020 2020 2020 2020   page...        
+00023250: 4172 6773 3a0a 2020 2020 2020 2020 2020  Args:.          
+00023260: 2020 6669 7273 745f 726f 773a 2053 7461    first_row: Sta
+00023270: 7274 2072 6f77 2066 6f72 2072 616e 6765  rt row for range
+00023280: 2e0a 2020 2020 2020 2020 2020 2020 6c61  ..            la
+00023290: 7374 5f72 6f77 3a20 456e 6420 726f 7720  st_row: End row 
+000232a0: 666f 7220 7261 6e67 652e 0a0a 2020 2020  for range...    
+000232b0: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
+000232c0: 2020 2020 2020 2020 204e 6f74 6869 6e67           Nothing
+000232d0: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
+000232e0: 2020 2020 2020 2069 6620 6c61 7374 5f72         if last_r
+000232f0: 6f77 2069 7320 4e6f 6e65 3a0a 2020 2020  ow is None:.    
+00023300: 2020 2020 2020 2020 6c61 7374 5f72 6f77          last_row
+00023310: 203d 2066 6972 7374 5f72 6f77 0a0a 2020   = first_row..  
+00023320: 2020 2020 2020 2320 436f 6e76 6572 7420        # Convert 
+00023330: 726f 7773 2074 6f20 3120 6261 7365 642e  rows to 1 based.
+00023340: 0a20 2020 2020 2020 2066 6972 7374 5f72  .        first_r
+00023350: 6f77 202b 3d20 310a 2020 2020 2020 2020  ow += 1.        
+00023360: 6c61 7374 5f72 6f77 202b 3d20 310a 0a20  last_row += 1.. 
+00023370: 2020 2020 2020 2023 2043 7265 6174 6520         # Create 
+00023380: 7468 6520 726f 7720 7261 6e67 6520 6172  the row range ar
+00023390: 6561 206c 696b 653a 2024 313a 2432 2e0a  ea like: $1:$2..
+000233a0: 2020 2020 2020 2020 6172 6561 203d 2022          area = "
+000233b0: 2425 643a 2425 6422 2025 2028 6669 7273  $%d:$%d" % (firs
+000233c0: 745f 726f 772c 206c 6173 745f 726f 7729  t_row, last_row)
+000233d0: 0a0a 2020 2020 2020 2020 2320 4275 696c  ..        # Buil
+000233e0: 6420 7570 2074 6865 2070 7269 6e74 2074  d up the print t
+000233f0: 6974 6c65 7320 6172 6561 2022 5368 6565  itles area "Shee
+00023400: 7431 2124 313a 2432 220a 2020 2020 2020  t1!$1:$2".      
+00023410: 2020 7368 6565 746e 616d 6520 3d20 7175    sheetname = qu
+00023420: 6f74 655f 7368 6565 746e 616d 6528 7365  ote_sheetname(se
+00023430: 6c66 2e6e 616d 6529 0a20 2020 2020 2020  lf.name).       
+00023440: 2073 656c 662e 7265 7065 6174 5f72 6f77   self.repeat_row
+00023450: 5f72 616e 6765 203d 2073 6865 6574 6e61  _range = sheetna
+00023460: 6d65 202b 2022 2122 202b 2061 7265 610a  me + "!" + area.
+00023470: 0a20 2020 2040 636f 6e76 6572 745f 636f  .    @convert_co
+00023480: 6c75 6d6e 5f61 7267 730a 2020 2020 6465  lumn_args.    de
+00023490: 6620 7265 7065 6174 5f63 6f6c 756d 6e73  f repeat_columns
+000234a0: 2873 656c 662c 2066 6972 7374 5f63 6f6c  (self, first_col
+000234b0: 2c20 6c61 7374 5f63 6f6c 3d4e 6f6e 6529  , last_col=None)
+000234c0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+000234d0: 2020 2020 2020 5365 7420 7468 6520 636f        Set the co
+000234e0: 6c75 6d6e 7320 746f 2072 6570 6561 7420  lumns to repeat 
+000234f0: 6174 2074 6865 206c 6566 7420 6861 6e64  at the left hand
+00023500: 2073 6964 6520 6f66 2065 6163 6820 7072   side of each pr
+00023510: 696e 7465 6420 7061 6765 2e0a 0a20 2020  inted page...   
+00023520: 2020 2020 2041 7267 733a 0a20 2020 2020       Args:.     
+00023530: 2020 2020 2020 2066 6972 7374 5f63 6f6c         first_col
+00023540: 3a20 5374 6172 7420 636f 6c75 6d6e 2066  : Start column f
+00023550: 6f72 2072 616e 6765 2e0a 2020 2020 2020  or range..      
+00023560: 2020 2020 2020 6c61 7374 5f63 6f6c 3a20        last_col: 
+00023570: 456e 6420 636f 6c75 6d6e 2066 6f72 2072  End column for r
+00023580: 616e 6765 2e0a 0a20 2020 2020 2020 2052  ange...        R
+00023590: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
+000235a0: 2020 2020 4e6f 7468 696e 672e 0a0a 2020      Nothing...  
+000235b0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000235c0: 2020 6966 206c 6173 745f 636f 6c20 6973    if last_col is
+000235d0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+000235e0: 2020 206c 6173 745f 636f 6c20 3d20 6669     last_col = fi
+000235f0: 7273 745f 636f 6c0a 0a20 2020 2020 2020  rst_col..       
+00023600: 2023 2043 6f6e 7665 7274 2074 6f20 4120   # Convert to A 
+00023610: 6e6f 7461 7469 6f6e 2e0a 2020 2020 2020  notation..      
+00023620: 2020 6669 7273 745f 636f 6c20 3d20 786c    first_col = xl
+00023630: 5f63 6f6c 5f74 6f5f 6e61 6d65 2866 6972  _col_to_name(fir
+00023640: 7374 5f63 6f6c 2c20 3129 0a20 2020 2020  st_col, 1).     
+00023650: 2020 206c 6173 745f 636f 6c20 3d20 786c     last_col = xl
+00023660: 5f63 6f6c 5f74 6f5f 6e61 6d65 286c 6173  _col_to_name(las
+00023670: 745f 636f 6c2c 2031 290a 0a20 2020 2020  t_col, 1)..     
+00023680: 2020 2023 2043 7265 6174 6520 6120 636f     # Create a co
+00023690: 6c75 6d6e 2072 616e 6765 206c 696b 6520  lumn range like 
+000236a0: 2443 3a24 442e 0a20 2020 2020 2020 2061  $C:$D..        a
+000236b0: 7265 6120 3d20 6669 7273 745f 636f 6c20  rea = first_col 
+000236c0: 2b20 223a 2220 2b20 6c61 7374 5f63 6f6c  + ":" + last_col
+000236d0: 0a0a 2020 2020 2020 2020 2320 4275 696c  ..        # Buil
+000236e0: 6420 7570 2074 6865 2070 7269 6e74 2061  d up the print a
+000236f0: 7265 6120 7261 6e67 6520 223d 5368 6565  rea range "=Shee
+00023700: 7432 2124 433a 2444 220a 2020 2020 2020  t2!$C:$D".      
+00023710: 2020 7368 6565 746e 616d 6520 3d20 7175    sheetname = qu
+00023720: 6f74 655f 7368 6565 746e 616d 6528 7365  ote_sheetname(se
+00023730: 6c66 2e6e 616d 6529 0a20 2020 2020 2020  lf.name).       
+00023740: 2073 656c 662e 7265 7065 6174 5f63 6f6c   self.repeat_col
+00023750: 5f72 616e 6765 203d 2073 6865 6574 6e61  _range = sheetna
+00023760: 6d65 202b 2022 2122 202b 2061 7265 610a  me + "!" + area.
+00023770: 0a20 2020 2064 6566 2068 6964 655f 6772  .    def hide_gr
+00023780: 6964 6c69 6e65 7328 7365 6c66 2c20 6f70  idlines(self, op
+00023790: 7469 6f6e 3d31 293a 0a20 2020 2020 2020  tion=1):.       
+000237a0: 2022 2222 0a20 2020 2020 2020 2053 6574   """.        Set
+000237b0: 2074 6865 206f 7074 696f 6e20 746f 2068   the option to h
+000237c0: 6964 6520 6772 6964 6c69 6e65 7320 6f6e  ide gridlines on
+000237d0: 2074 6865 2073 6372 6565 6e20 616e 6420   the screen and 
+000237e0: 7468 6520 7072 696e 7465 6420 7061 6765  the printed page
+000237f0: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
+00023800: 0a20 2020 2020 2020 2020 2020 206f 7074  .            opt
+00023810: 696f 6e3a 2020 2020 3020 3a20 446f 6e27  ion:    0 : Don'
+00023820: 7420 6869 6465 2067 7269 646c 696e 6573  t hide gridlines
+00023830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023840: 2020 2020 2020 2020 3120 3a20 4869 6465          1 : Hide
+00023850: 2070 7269 6e74 6564 2067 7269 646c 696e   printed gridlin
+00023860: 6573 206f 6e6c 790a 2020 2020 2020 2020  es only.        
+00023870: 2020 2020 2020 2020 2020 2020 2020 2032                 2
+00023880: 203a 2048 6964 6520 7363 7265 656e 2061   : Hide screen a
+00023890: 6e64 2070 7269 6e74 6564 2067 7269 646c  nd printed gridl
+000238a0: 696e 6573 0a0a 2020 2020 2020 2020 5265  ines..        Re
+000238b0: 7475 726e 733a 0a20 2020 2020 2020 2020  turns:.         
+000238c0: 2020 204e 6f74 6869 6e67 2e0a 0a20 2020     Nothing...   
+000238d0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000238e0: 2069 6620 6f70 7469 6f6e 203d 3d20 303a   if option == 0:
+000238f0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00023900: 662e 7072 696e 745f 6772 6964 6c69 6e65  f.print_gridline
+00023910: 7320 3d20 310a 2020 2020 2020 2020 2020  s = 1.          
+00023920: 2020 7365 6c66 2e73 6372 6565 6e5f 6772    self.screen_gr
+00023930: 6964 6c69 6e65 7320 3d20 310a 2020 2020  idlines = 1.    
+00023940: 2020 2020 2020 2020 7365 6c66 2e70 7269          self.pri
+00023950: 6e74 5f6f 7074 696f 6e73 5f63 6861 6e67  nt_options_chang
+00023960: 6564 203d 2054 7275 650a 2020 2020 2020  ed = True.      
+00023970: 2020 656c 6966 206f 7074 696f 6e20 3d3d    elif option ==
+00023980: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+00023990: 7365 6c66 2e70 7269 6e74 5f67 7269 646c  self.print_gridl
+000239a0: 696e 6573 203d 2030 0a20 2020 2020 2020  ines = 0.       
+000239b0: 2020 2020 2073 656c 662e 7363 7265 656e       self.screen
+000239c0: 5f67 7269 646c 696e 6573 203d 2031 0a20  _gridlines = 1. 
+000239d0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000239e0: 2020 2020 2020 2020 2073 656c 662e 7072           self.pr
+000239f0: 696e 745f 6772 6964 6c69 6e65 7320 3d20  int_gridlines = 
+00023a00: 300a 2020 2020 2020 2020 2020 2020 7365  0.            se
+00023a10: 6c66 2e73 6372 6565 6e5f 6772 6964 6c69  lf.screen_gridli
+00023a20: 6e65 7320 3d20 300a 0a20 2020 2064 6566  nes = 0..    def
+00023a30: 2070 7269 6e74 5f72 6f77 5f63 6f6c 5f68   print_row_col_h
+00023a40: 6561 6465 7273 2873 656c 6629 3a0a 2020  eaders(self):.  
+00023a50: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00023a60: 2020 5365 7420 7468 6520 6f70 7469 6f6e    Set the option
+00023a70: 2074 6f20 7072 696e 7420 7468 6520 726f   to print the ro
+00023a80: 7720 616e 6420 636f 6c75 6d6e 2068 6561  w and column hea
+00023a90: 6465 7273 206f 6e20 7468 6520 7072 696e  ders on the prin
+00023aa0: 7465 6420 7061 6765 2e0a 0a20 2020 2020  ted page...     
+00023ab0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+00023ac0: 2020 2020 204e 6f6e 652e 0a0a 2020 2020       None...    
+00023ad0: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
+00023ae0: 2020 2020 2020 2020 204e 6f74 6869 6e67           Nothing
+00023af0: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
+00023b00: 2020 2020 2020 2073 656c 662e 7072 696e         self.prin
+00023b10: 745f 6865 6164 6572 7320 3d20 5472 7565  t_headers = True
+00023b20: 0a20 2020 2020 2020 2073 656c 662e 7072  .        self.pr
+00023b30: 696e 745f 6f70 7469 6f6e 735f 6368 616e  int_options_chan
+00023b40: 6765 6420 3d20 5472 7565 0a0a 2020 2020  ged = True..    
+00023b50: 6465 6620 6869 6465 5f72 6f77 5f63 6f6c  def hide_row_col
+00023b60: 5f68 6561 6465 7273 2873 656c 6629 3a0a  _headers(self):.
+00023b70: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00023b80: 2020 2020 5365 7420 7468 6520 6f70 7469      Set the opti
+00023b90: 6f6e 2074 6f20 6869 6465 2074 6865 2072  on to hide the r
+00023ba0: 6f77 2061 6e64 2063 6f6c 756d 6e20 6865  ow and column he
+00023bb0: 6164 6572 7320 6f6e 2074 6865 2077 6f72  aders on the wor
+00023bc0: 6b73 6865 6574 2e0a 0a20 2020 2020 2020  ksheet...       
+00023bd0: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
+00023be0: 2020 204e 6f6e 652e 0a0a 2020 2020 2020     None...      
+00023bf0: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
+00023c00: 2020 2020 2020 204e 6f74 6869 6e67 2e0a         Nothing..
+00023c10: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00023c20: 2020 2020 2073 656c 662e 726f 775f 636f       self.row_co
+00023c30: 6c5f 6865 6164 6572 7320 3d20 5472 7565  l_headers = True
+00023c40: 0a0a 2020 2020 4063 6f6e 7665 7274 5f72  ..    @convert_r
+00023c50: 616e 6765 5f61 7267 730a 2020 2020 6465  ange_args.    de
+00023c60: 6620 7072 696e 745f 6172 6561 2873 656c  f print_area(sel
+00023c70: 662c 2066 6972 7374 5f72 6f77 2c20 6669  f, first_row, fi
+00023c80: 7273 745f 636f 6c2c 206c 6173 745f 726f  rst_col, last_ro
+00023c90: 772c 206c 6173 745f 636f 6c29 3a0a 2020  w, last_col):.  
+00023ca0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00023cb0: 2020 5365 7420 7468 6520 7072 696e 7420    Set the print 
+00023cc0: 6172 6561 2069 6e20 7468 6520 6375 7272  area in the curr
+00023cd0: 656e 7420 776f 726b 7368 6565 742e 0a0a  ent worksheet...
+00023ce0: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
+00023cf0: 2020 2020 2020 2020 2020 6669 7273 745f            first_
+00023d00: 726f 773a 2020 2020 5468 6520 6669 7273  row:    The firs
+00023d10: 7420 726f 7720 6f66 2074 6865 2063 656c  t row of the cel
+00023d20: 6c20 7261 6e67 652e 2028 7a65 726f 2069  l range. (zero i
+00023d30: 6e64 6578 6564 292e 0a20 2020 2020 2020  ndexed)..       
+00023d40: 2020 2020 2066 6972 7374 5f63 6f6c 3a20       first_col: 
+00023d50: 2020 2054 6865 2066 6972 7374 2063 6f6c     The first col
+00023d60: 756d 6e20 6f66 2074 6865 2063 656c 6c20  umn of the cell 
+00023d70: 7261 6e67 652e 0a20 2020 2020 2020 2020  range..         
+00023d80: 2020 206c 6173 745f 726f 773a 2020 2020     last_row:    
+00023d90: 2054 6865 206c 6173 7420 726f 7720 6f66   The last row of
+00023da0: 2074 6865 2063 656c 6c20 7261 6e67 652e   the cell range.
+00023db0: 2028 7a65 726f 2069 6e64 6578 6564 292e   (zero indexed).
+00023dc0: 0a20 2020 2020 2020 2020 2020 206c 6173  .            las
+00023dd0: 745f 636f 6c3a 2020 2020 2054 6865 206c  t_col:     The l
+00023de0: 6173 7420 636f 6c75 6d6e 206f 6620 7468  ast column of th
+00023df0: 6520 6365 6c6c 2072 616e 6765 2e0a 0a20  e cell range... 
+00023e00: 2020 2020 2020 2052 6574 7572 6e73 3a0a         Returns:.
+00023e10: 2020 2020 2020 2020 2020 2020 303a 2020              0:  
+00023e20: 5375 6363 6573 732e 0a20 2020 2020 2020  Success..       
+00023e30: 2020 2020 202d 313a 2052 6f77 206f 7220       -1: Row or 
+00023e40: 636f 6c75 6d6e 2069 7320 6f75 7420 6f66  column is out of
+00023e50: 2077 6f72 6b73 6865 6574 2062 6f75 6e64   worksheet bound
+00023e60: 732e 0a0a 2020 2020 2020 2020 2222 220a  s...        """.
+00023e70: 2020 2020 2020 2020 2320 5365 7420 7468          # Set th
+00023e80: 6520 7072 696e 7420 6172 6561 2069 6e20  e print area in 
+00023e90: 7468 6520 6375 7272 656e 7420 776f 726b  the current work
+00023ea0: 7368 6565 742e 0a0a 2020 2020 2020 2020  sheet...        
+00023eb0: 2320 4967 6e6f 7265 206d 6178 2070 7269  # Ignore max pri
+00023ec0: 6e74 2061 7265 6120 7369 6e63 6520 6974  nt area since it
+00023ed0: 2069 7320 7468 6520 7361 6d65 2061 7320   is the same as 
+00023ee0: 6e6f 2020 6172 6561 2066 6f72 2045 7863  no  area for Exc
+00023ef0: 656c 2e0a 2020 2020 2020 2020 6966 2028  el..        if (
+00023f00: 0a20 2020 2020 2020 2020 2020 2066 6972  .            fir
+00023f10: 7374 5f72 6f77 203d 3d20 300a 2020 2020  st_row == 0.    
+00023f20: 2020 2020 2020 2020 616e 6420 6669 7273          and firs
+00023f30: 745f 636f 6c20 3d3d 2030 0a20 2020 2020  t_col == 0.     
+00023f40: 2020 2020 2020 2061 6e64 206c 6173 745f         and last_
+00023f50: 726f 7720 3d3d 2073 656c 662e 786c 735f  row == self.xls_
+00023f60: 726f 776d 6178 202d 2031 0a20 2020 2020  rowmax - 1.     
+00023f70: 2020 2020 2020 2061 6e64 206c 6173 745f         and last_
+00023f80: 636f 6c20 3d3d 2073 656c 662e 786c 735f  col == self.xls_
+00023f90: 636f 6c6d 6178 202d 2031 0a20 2020 2020  colmax - 1.     
+00023fa0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00023fb0: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
+00023fc0: 2020 2320 4275 696c 6420 7570 2074 6865    # Build up the
+00023fd0: 2070 7269 6e74 2061 7265 6120 7261 6e67   print area rang
+00023fe0: 6520 2253 6865 6574 3121 2441 2431 3a24  e "Sheet1!$A$1:$
+00023ff0: 4324 3133 222e 0a20 2020 2020 2020 2061  C$13"..        a
+00024000: 7265 6120 3d20 7365 6c66 2e5f 636f 6e76  rea = self._conv
+00024010: 6572 745f 6e61 6d65 5f61 7265 6128 6669  ert_name_area(fi
+00024020: 7273 745f 726f 772c 2066 6972 7374 5f63  rst_row, first_c
+00024030: 6f6c 2c20 6c61 7374 5f72 6f77 2c20 6c61  ol, last_row, la
+00024040: 7374 5f63 6f6c 290a 2020 2020 2020 2020  st_col).        
+00024050: 7365 6c66 2e70 7269 6e74 5f61 7265 615f  self.print_area_
+00024060: 7261 6e67 6520 3d20 6172 6561 0a0a 2020  range = area..  
+00024070: 2020 2020 2020 7265 7475 726e 2030 0a0a        return 0..
+00024080: 2020 2020 6465 6620 7072 696e 745f 6163      def print_ac
+00024090: 726f 7373 2873 656c 6629 3a0a 2020 2020  ross(self):.    
+000240a0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000240b0: 5365 7420 7468 6520 6f72 6465 7220 696e  Set the order in
+000240c0: 2077 6869 6368 2070 6167 6573 2061 7265   which pages are
+000240d0: 2070 7269 6e74 6564 2e0a 0a20 2020 2020   printed...     
+000240e0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+000240f0: 2020 2020 204e 6f6e 652e 0a0a 2020 2020       None...    
+00024100: 2020 2020 5265 7475 726e 733a 0a20 2020      Returns:.   
+00024110: 2020 2020 2020 2020 204e 6f74 6869 6e67           Nothing
+00024120: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
+00024130: 2020 2020 2020 2073 656c 662e 7061 6765         self.page
+00024140: 5f6f 7264 6572 203d 2031 0a20 2020 2020  _order = 1.     
+00024150: 2020 2073 656c 662e 7061 6765 5f73 6574     self.page_set
+00024160: 7570 5f63 6861 6e67 6564 203d 2054 7275  up_changed = Tru
+00024170: 650a 0a20 2020 2064 6566 2066 6974 5f74  e..    def fit_t
+00024180: 6f5f 7061 6765 7328 7365 6c66 2c20 7769  o_pages(self, wi
+00024190: 6474 682c 2068 6569 6768 7429 3a0a 2020  dth, height):.  
+000241a0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000241b0: 2020 4669 7420 7468 6520 7072 696e 7465    Fit the printe
+000241c0: 6420 6172 6561 2074 6f20 6120 7370 6563  d area to a spec
+000241d0: 6966 6963 206e 756d 6265 7220 6f66 2070  ific number of p
+000241e0: 6167 6573 2062 6f74 6820 7665 7274 6963  ages both vertic
+000241f0: 616c 6c79 2061 6e64 0a20 2020 2020 2020  ally and.       
+00024200: 2068 6f72 697a 6f6e 7461 6c6c 792e 0a0a   horizontally...
+00024210: 2020 2020 2020 2020 4172 6773 3a0a 2020          Args:.  
+00024220: 2020 2020 2020 2020 2020 7769 6474 683a            width:
+00024230: 2020 4e75 6d62 6572 206f 6620 7061 6765    Number of page
+00024240: 7320 686f 7269 7a6f 6e74 616c 6c79 2e0a  s horizontally..
+00024250: 2020 2020 2020 2020 2020 2020 6865 6967              heig
+00024260: 6874 3a20 4e75 6d62 6572 206f 6620 7061  ht: Number of pa
+00024270: 6765 7320 7665 7274 6963 616c 6c79 2e0a  ges vertically..
+00024280: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00024290: 3a0a 2020 2020 2020 2020 2020 2020 4e6f  :.            No
+000242a0: 7468 696e 672e 0a0a 2020 2020 2020 2020  thing...        
+000242b0: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
+000242c0: 2e66 6974 5f70 6167 6520 3d20 310a 2020  .fit_page = 1.  
+000242d0: 2020 2020 2020 7365 6c66 2e66 6974 5f77        self.fit_w
+000242e0: 6964 7468 203d 2077 6964 7468 0a20 2020  idth = width.   
+000242f0: 2020 2020 2073 656c 662e 6669 745f 6865       self.fit_he
+00024300: 6967 6874 203d 2068 6569 6768 740a 2020  ight = height.  
+00024310: 2020 2020 2020 7365 6c66 2e70 6167 655f        self.page_
+00024320: 7365 7475 705f 6368 616e 6765 6420 3d20  setup_changed = 
+00024330: 5472 7565 0a0a 2020 2020 6465 6620 7365  True..    def se
+00024340: 745f 7374 6172 745f 7061 6765 2873 656c  t_start_page(sel
+00024350: 662c 2073 7461 7274 5f70 6167 6529 3a0a  f, start_page):.
+00024360: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00024370: 2020 2020 5365 7420 7468 6520 7374 6172      Set the star
+00024380: 7420 7061 6765 206e 756d 6265 7220 7768  t page number wh
+00024390: 656e 2070 7269 6e74 696e 672e 0a0a 2020  en printing...  
+000243a0: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
+000243b0: 2020 2020 2020 2020 7374 6172 745f 7061          start_pa
+000243c0: 6765 3a20 5374 6172 7420 7061 6765 206e  ge: Start page n
+000243d0: 756d 6265 722e 0a0a 2020 2020 2020 2020  umber...        
+000243e0: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
+000243f0: 2020 2020 204e 6f74 6869 6e67 2e0a 0a20       Nothing... 
+00024400: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00024410: 2020 2073 656c 662e 7061 6765 5f73 7461     self.page_sta
+00024420: 7274 203d 2073 7461 7274 5f70 6167 650a  rt = start_page.
+00024430: 0a20 2020 2064 6566 2073 6574 5f70 7269  .    def set_pri
+00024440: 6e74 5f73 6361 6c65 2873 656c 662c 2073  nt_scale(self, s
+00024450: 6361 6c65 293a 0a20 2020 2020 2020 2022  cale):.        "
+00024460: 2222 0a20 2020 2020 2020 2053 6574 2074  "".        Set t
+00024470: 6865 2073 6361 6c65 2066 6163 746f 7220  he scale factor 
+00024480: 666f 7220 7468 6520 7072 696e 7465 6420  for the printed 
+00024490: 7061 6765 2e0a 0a20 2020 2020 2020 2041  page...        A
+000244a0: 7267 733a 0a20 2020 2020 2020 2020 2020  rgs:.           
+000244b0: 2073 6361 6c65 3a20 5072 696e 7420 7363   scale: Print sc
+000244c0: 616c 652e 2031 3020 3c3d 2073 6361 6c65  ale. 10 <= scale
+000244d0: 203c 3d20 3430 302e 0a0a 2020 2020 2020   <= 400...      
+000244e0: 2020 5265 7475 726e 733a 0a20 2020 2020    Returns:.     
+000244f0: 2020 2020 2020 204e 6f74 6869 6e67 2e0a         Nothing..
+00024500: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00024510: 2020 2020 2023 2043 6f6e 6669 6e65 2074       # Confine t
+00024520: 6865 2073 6361 6c65 2074 6f20 4578 6365  he scale to Exce
+00024530: 6c27 7320 7261 6e67 652e 0a20 2020 2020  l's range..     
+00024540: 2020 2069 6620 7363 616c 6520 3c20 3130     if scale < 10
+00024550: 206f 7220 7363 616c 6520 3e20 3430 303a   or scale > 400:
+00024560: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
+00024570: 6e28 2250 7269 6e74 2073 6361 6c65 2027  n("Print scale '
+00024580: 2564 2720 6f75 7473 6964 6520 7261 6e67  %d' outside rang
+00024590: 653a 2031 3020 3c3d 2073 6361 6c65 203c  e: 10 <= scale <
+000245a0: 3d20 3430 3022 2025 2073 6361 6c65 290a  = 400" % scale).
+000245b0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000245c0: 726e 0a0a 2020 2020 2020 2020 2320 5475  rn..        # Tu
+000245d0: 726e 206f 6666 2022 6669 7420 746f 2070  rn off "fit to p
+000245e0: 6167 6522 206f 7074 696f 6e20 7768 656e  age" option when
+000245f0: 2070 7269 6e74 2073 6361 6c65 2069 7320   print scale is 
+00024600: 6f6e 2e0a 2020 2020 2020 2020 7365 6c66  on..        self
+00024610: 2e66 6974 5f70 6167 6520 3d20 300a 0a20  .fit_page = 0.. 
+00024620: 2020 2020 2020 2073 656c 662e 7072 696e         self.prin
+00024630: 745f 7363 616c 6520 3d20 696e 7428 7363  t_scale = int(sc
+00024640: 616c 6529 0a20 2020 2020 2020 2073 656c  ale).        sel
+00024650: 662e 7061 6765 5f73 6574 7570 5f63 6861  f.page_setup_cha
+00024660: 6e67 6564 203d 2054 7275 650a 0a20 2020  nged = True..   
+00024670: 2064 6566 2070 7269 6e74 5f62 6c61 636b   def print_black
+00024680: 5f61 6e64 5f77 6869 7465 2873 656c 6629  _and_white(self)
+00024690: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+000246a0: 2020 2020 2020 5365 7420 7468 6520 6f70        Set the op
+000246b0: 7469 6f6e 2074 6f20 7072 696e 7420 7468  tion to print th
+000246c0: 6520 776f 726b 7368 6565 7420 696e 2062  e worksheet in b
+000246d0: 6c61 636b 2061 6e64 2077 6869 7465 2e0a  lack and white..
+000246e0: 0a20 2020 2020 2020 2041 7267 733a 0a20  .        Args:. 
+000246f0: 2020 2020 2020 2020 2020 204e 6f6e 652e             None.
+00024700: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00024710: 733a 0a20 2020 2020 2020 2020 2020 204e  s:.            N
+00024720: 6f74 6869 6e67 2e0a 0a20 2020 2020 2020  othing...       
+00024730: 2022 2222 0a20 2020 2020 2020 2073 656c   """.        sel
+00024740: 662e 626c 6163 6b5f 7768 6974 6520 3d20  f.black_white = 
+00024750: 5472 7565 0a20 2020 2020 2020 2073 656c  True.        sel
+00024760: 662e 7061 6765 5f73 6574 7570 5f63 6861  f.page_setup_cha
+00024770: 6e67 6564 203d 2054 7275 650a 0a20 2020  nged = True..   
+00024780: 2064 6566 2073 6574 5f68 5f70 6167 6562   def set_h_pageb
+00024790: 7265 616b 7328 7365 6c66 2c20 6272 6561  reaks(self, brea
+000247a0: 6b73 293a 0a20 2020 2020 2020 2022 2222  ks):.        """
+000247b0: 0a20 2020 2020 2020 2053 6574 2074 6865  .        Set the
+000247c0: 2068 6f72 697a 6f6e 7461 6c20 7061 6765   horizontal page
+000247d0: 2062 7265 616b 7320 6f6e 2061 2077 6f72   breaks on a wor
+000247e0: 6b73 6865 6574 2e0a 0a20 2020 2020 2020  ksheet...       
+000247f0: 2041 7267 733a 0a20 2020 2020 2020 2020   Args:.         
+00024800: 2020 2062 7265 616b 733a 204c 6973 7420     breaks: List 
+00024810: 6f66 2072 6f77 7320 7768 6572 6520 7468  of rows where th
+00024820: 6520 7061 6765 2062 7265 616b 7320 7368  e page breaks sh
+00024830: 6f75 6c64 2062 6520 6164 6465 642e 0a0a  ould be added...
+00024840: 2020 2020 2020 2020 5265 7475 726e 733a          Returns:
+00024850: 0a20 2020 2020 2020 2020 2020 204e 6f74  .            Not
+00024860: 6869 6e67 2e0a 0a20 2020 2020 2020 2022  hing...        "
+00024870: 2222 0a20 2020 2020 2020 2073 656c 662e  "".        self.
+00024880: 6862 7265 616b 7320 3d20 6272 6561 6b73  hbreaks = breaks
+00024890: 0a0a 2020 2020 6465 6620 7365 745f 765f  ..    def set_v_
+000248a0: 7061 6765 6272 6561 6b73 2873 656c 662c  pagebreaks(self,
+000248b0: 2062 7265 616b 7329 3a0a 2020 2020 2020   breaks):.      
+000248c0: 2020 2222 220a 2020 2020 2020 2020 5365    """.        Se
+000248d0: 7420 7468 6520 686f 7269 7a6f 6e74 616c  t the horizontal
+000248e0: 2070 6167 6520 6272 6561 6b73 206f 6e20   page breaks on 
+000248f0: 6120 776f 726b 7368 6565 742e 0a0a 2020  a worksheet...  
+00024900: 2020 2020 2020 4172 6773 3a0a 2020 2020        Args:.    
+00024910: 2020 2020 2020 2020 6272 6561 6b73 3a20          breaks: 
+00024920: 4c69 7374 206f 6620 636f 6c75 6d6e 7320  List of columns 
+00024930: 7768 6572 6520 7468 6520 7061 6765 2062  where the page b
+00024940: 7265 616b 7320 7368 6f75 6c64 2062 6520  reaks should be 
+00024950: 6164 6465 642e 0a0a 2020 2020 2020 2020  added...        
+00024960: 5265 7475 726e 733a 0a20 2020 2020 2020  Returns:.       
+00024970: 2020 2020 204e 6f74 6869 6e67 2e0a 0a20       Nothing... 
+00024980: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00024990: 2020 2073 656c 662e 7662 7265 616b 7320     self.vbreaks 
+000249a0: 3d20 6272 6561 6b73 0a0a 2020 2020 6465  = breaks..    de
+000249b0: 6620 7365 745f 7662 615f 6e61 6d65 2873  f set_vba_name(s
+000249c0: 656c 662c 206e 616d 653d 4e6f 6e65 293a  elf, name=None):
+000249d0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000249e0: 2020 2020 2053 6574 2074 6865 2056 4241       Set the VBA
+000249f0: 206e 616d 6520 666f 7220 7468 6520 776f   name for the wo
+00024a00: 726b 7368 6565 742e 2042 7920 6465 6661  rksheet. By defa
+00024a10: 756c 7420 7468 6973 2069 7320 7468 650a  ult this is the.
+00024a20: 2020 2020 2020 2020 7361 6d65 2061 7320          same as 
+00024a30: 7468 6520 7368 6565 7420 6e61 6d65 3a20  the sheet name: 
+00024a40: 692e 652e 2c20 5368 6565 7431 2065 7463  i.e., Sheet1 etc
+00024a50: 2e0a 0a20 2020 2020 2020 2041 7267 733a  ...        Args:
+00024a60: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
+00024a70: 653a 2054 6865 2056 4241 206e 616d 6520  e: The VBA name 
+00024a80: 666f 7220 7468 6520 776f 726b 7368 6565  for the workshee
+00024a90: 742e 0a0a 2020 2020 2020 2020 5265 7475  t...        Retu
+00024aa0: 726e 733a 0a20 2020 2020 2020 2020 2020  rns:.           
+00024ab0: 204e 6f74 6869 6e67 2e0a 0a20 2020 2020   Nothing...     
+00024ac0: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+00024ad0: 6620 6e61 6d65 2069 7320 6e6f 7420 4e6f  f name is not No
+00024ae0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00024af0: 7365 6c66 2e76 6261 5f63 6f64 656e 616d  self.vba_codenam
+00024b00: 6520 3d20 6e61 6d65 0a20 2020 2020 2020  e = name.       
+00024b10: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00024b20: 2020 2073 656c 662e 7662 615f 636f 6465     self.vba_code
+00024b30: 6e61 6d65 203d 2022 5368 6565 7422 202b  name = "Sheet" +
+00024b40: 2073 7472 2873 656c 662e 696e 6465 7820   str(self.index 
+00024b50: 2b20 3129 0a0a 2020 2020 6465 6620 6967  + 1)..    def ig
+00024b60: 6e6f 7265 5f65 7272 6f72 7328 7365 6c66  nore_errors(self
+00024b70: 2c20 6f70 7469 6f6e 733d 4e6f 6e65 293a  , options=None):
+00024b80: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00024b90: 2020 2020 2049 676e 6f72 6520 7661 7269       Ignore vari
+00024ba0: 6f75 7320 4578 6365 6c20 6572 726f 7273  ous Excel errors
+00024bb0: 2f77 6172 6e69 6e67 7320 696e 2061 2077  /warnings in a w
+00024bc0: 6f72 6b73 6865 6574 2066 6f72 2075 7365  orksheet for use
+00024bd0: 7220 6465 6669 6e65 640a 2020 2020 2020  r defined.      
+00024be0: 2020 7261 6e67 6573 2e0a 0a20 2020 2020    ranges...     
+00024bf0: 2020 2041 7267 733a 0a20 2020 2020 2020     Args:.       
+00024c00: 2020 2020 206f 7074 696f 6e73 3a20 4120       options: A 
+00024c10: 6469 6374 206f 6620 6967 6e6f 7265 2065  dict of ignore e
+00024c20: 7272 6f72 7320 6b65 7973 2077 6974 6820  rrors keys with 
+00024c30: 6365 6c6c 2072 616e 6765 2076 616c 7565  cell range value
+00024c40: 732e 0a0a 2020 2020 2020 2020 5265 7475  s...        Retu
+00024c50: 726e 733a 0a20 2020 2020 2020 2020 2020  rns:.           
+00024c60: 2030 3a20 5375 6363 6573 732e 0a20 2020   0: Success..   
+00024c70: 2020 2020 2020 2020 2d31 3a20 496e 636f          -1: Inco
+00024c80: 7272 6563 7420 7061 7261 6d65 7465 7220  rrect parameter 
+00024c90: 6f72 206f 7074 696f 6e2e 0a0a 2020 2020  or option...    
+00024ca0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00024cb0: 6966 206f 7074 696f 6e73 2069 7320 4e6f  if options is No
+00024cc0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00024cd0: 7265 7475 726e 202d 310a 2020 2020 2020  return -1.      
+00024ce0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00024cf0: 2020 2020 2320 436f 7079 2074 6865 2075      # Copy the u
+00024d00: 7365 7220 6465 6669 6e65 6420 6f70 7469  ser defined opti
+00024d10: 6f6e 7320 736f 2074 6865 7920 6172 656e  ons so they aren
+00024d20: 2774 206d 6f64 6966 6965 642e 0a20 2020  't modified..   
+00024d30: 2020 2020 2020 2020 206f 7074 696f 6e73           options
+00024d40: 203d 206f 7074 696f 6e73 2e63 6f70 7928   = options.copy(
+00024d50: 290a 0a20 2020 2020 2020 2023 2056 616c  )..        # Val
+00024d60: 6964 2069 6e70 7574 2070 6172 616d 6574  id input paramet
+00024d70: 6572 732e 0a20 2020 2020 2020 2076 616c  ers..        val
+00024d80: 6964 5f70 6172 616d 6574 6572 7320 3d20  id_parameters = 
+00024d90: 7b0a 2020 2020 2020 2020 2020 2020 226e  {.            "n
+00024da0: 756d 6265 725f 7374 6f72 6564 5f61 735f  umber_stored_as_
+00024db0: 7465 7874 222c 0a20 2020 2020 2020 2020  text",.         
+00024dc0: 2020 2022 6576 616c 5f65 7272 6f72 222c     "eval_error",
+00024dd0: 0a20 2020 2020 2020 2020 2020 2022 666f  .            "fo
+00024de0: 726d 756c 615f 6469 6666 6572 7322 2c0a  rmula_differs",.
+00024df0: 2020 2020 2020 2020 2020 2020 2266 6f72              "for
+00024e00: 6d75 6c61 5f72 616e 6765 222c 0a20 2020  mula_range",.   
+00024e10: 2020 2020 2020 2020 2022 666f 726d 756c           "formul
+00024e20: 615f 756e 6c6f 636b 6564 222c 0a20 2020  a_unlocked",.   
+00024e30: 2020 2020 2020 2020 2022 656d 7074 795f           "empty_
+00024e40: 6365 6c6c 5f72 6566 6572 656e 6365 222c  cell_reference",
+00024e50: 0a20 2020 2020 2020 2020 2020 2022 6c69  .            "li
+00024e60: 7374 5f64 6174 615f 7661 6c69 6461 7469  st_data_validati
+00024e70: 6f6e 222c 0a20 2020 2020 2020 2020 2020  on",.           
+00024e80: 2022 6361 6c63 756c 6174 6564 5f63 6f6c   "calculated_col
+00024e90: 756d 6e22 2c0a 2020 2020 2020 2020 2020  umn",.          
+00024ea0: 2020 2274 776f 5f64 6967 6974 5f74 6578    "two_digit_tex
+00024eb0: 745f 7965 6172 222c 0a20 2020 2020 2020  t_year",.       
+00024ec0: 207d 0a0a 2020 2020 2020 2020 2320 4368   }..        # Ch
+00024ed0: 6563 6b20 666f 7220 7661 6c69 6420 696e  eck for valid in
+00024ee0: 7075 7420 7061 7261 6d65 7465 7273 2e0a  put parameters..
+00024ef0: 2020 2020 2020 2020 666f 7220 7061 7261          for para
+00024f00: 6d5f 6b65 7920 696e 206f 7074 696f 6e73  m_key in options
+00024f10: 2e6b 6579 7328 293a 0a20 2020 2020 2020  .keys():.       
+00024f20: 2020 2020 2069 6620 7061 7261 6d5f 6b65       if param_ke
+00024f30: 7920 6e6f 7420 696e 2076 616c 6964 5f70  y not in valid_p
+00024f40: 6172 616d 6574 6572 733a 0a20 2020 2020  arameters:.     
+00024f50: 2020 2020 2020 2020 2020 2077 6172 6e28             warn(
+00024f60: 2255 6e6b 6e6f 776e 2070 6172 616d 6574  "Unknown paramet
+00024f70: 6572 2027 2573 2720 696e 2069 676e 6f72  er '%s' in ignor
+00024f80: 655f 6572 726f 7273 2829 2220 2520 7061  e_errors()" % pa
+00024f90: 7261 6d5f 6b65 7929 0a20 2020 2020 2020  ram_key).       
+00024fa0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00024fb0: 2d31 0a0a 2020 2020 2020 2020 7365 6c66  -1..        self
+00024fc0: 2e69 676e 6f72 6564 5f65 7272 6f72 7320  .ignored_errors 
+00024fd0: 3d20 6f70 7469 6f6e 730a 0a20 2020 2020  = options..     
+00024fe0: 2020 2072 6574 7572 6e20 300a 0a20 2020     return 0..   
+00024ff0: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
+00025000: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00025010: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00025020: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00025030: 2323 2323 2323 2323 2323 2323 0a20 2020  ############.   
+00025040: 2023 0a20 2020 2023 2050 7269 7661 7465   #.    # Private
+00025050: 2041 5049 2e0a 2020 2020 230a 2020 2020   API..    #.    
+00025060: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00025070: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00025080: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00025090: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000250a0: 2323 2323 2323 2323 2323 230a 2020 2020  ###########.    
+000250b0: 6465 6620 5f69 6e69 7469 616c 697a 6528  def _initialize(
+000250c0: 7365 6c66 2c20 696e 6974 5f64 6174 6129  self, init_data)
+000250d0: 3a0a 2020 2020 2020 2020 7365 6c66 2e6e  :.        self.n
+000250e0: 616d 6520 3d20 696e 6974 5f64 6174 615b  ame = init_data[
+000250f0: 226e 616d 6522 5d0a 2020 2020 2020 2020  "name"].        
+00025100: 7365 6c66 2e69 6e64 6578 203d 2069 6e69  self.index = ini
+00025110: 745f 6461 7461 5b22 696e 6465 7822 5d0a  t_data["index"].
+00025120: 2020 2020 2020 2020 7365 6c66 2e73 7472          self.str
+00025130: 5f74 6162 6c65 203d 2069 6e69 745f 6461  _table = init_da
+00025140: 7461 5b22 7374 725f 7461 626c 6522 5d0a  ta["str_table"].
+00025150: 2020 2020 2020 2020 7365 6c66 2e77 6f72          self.wor
+00025160: 6b73 6865 6574 5f6d 6574 6120 3d20 696e  ksheet_meta = in
+00025170: 6974 5f64 6174 615b 2277 6f72 6b73 6865  it_data["workshe
+00025180: 6574 5f6d 6574 6122 5d0a 2020 2020 2020  et_meta"].      
+00025190: 2020 7365 6c66 2e63 6f6e 7374 616e 745f    self.constant_
+000251a0: 6d65 6d6f 7279 203d 2069 6e69 745f 6461  memory = init_da
+000251b0: 7461 5b22 636f 6e73 7461 6e74 5f6d 656d  ta["constant_mem
+000251c0: 6f72 7922 5d0a 2020 2020 2020 2020 7365  ory"].        se
+000251d0: 6c66 2e74 6d70 6469 7220 3d20 696e 6974  lf.tmpdir = init
+000251e0: 5f64 6174 615b 2274 6d70 6469 7222 5d0a  _data["tmpdir"].
+000251f0: 2020 2020 2020 2020 7365 6c66 2e64 6174          self.dat
+00025200: 655f 3139 3034 203d 2069 6e69 745f 6461  e_1904 = init_da
+00025210: 7461 5b22 6461 7465 5f31 3930 3422 5d0a  ta["date_1904"].
+00025220: 2020 2020 2020 2020 7365 6c66 2e73 7472          self.str
+00025230: 696e 6773 5f74 6f5f 6e75 6d62 6572 7320  ings_to_numbers 
+00025240: 3d20 696e 6974 5f64 6174 615b 2273 7472  = init_data["str
+00025250: 696e 6773 5f74 6f5f 6e75 6d62 6572 7322  ings_to_numbers"
+00025260: 5d0a 2020 2020 2020 2020 7365 6c66 2e73  ].        self.s
+00025270: 7472 696e 6773 5f74 6f5f 666f 726d 756c  trings_to_formul
+00025280: 6173 203d 2069 6e69 745f 6461 7461 5b22  as = init_data["
+00025290: 7374 7269 6e67 735f 746f 5f66 6f72 6d75  strings_to_formu
+000252a0: 6c61 7322 5d0a 2020 2020 2020 2020 7365  las"].        se
+000252b0: 6c66 2e73 7472 696e 6773 5f74 6f5f 7572  lf.strings_to_ur
+000252c0: 6c73 203d 2069 6e69 745f 6461 7461 5b22  ls = init_data["
+000252d0: 7374 7269 6e67 735f 746f 5f75 726c 7322  strings_to_urls"
+000252e0: 5d0a 2020 2020 2020 2020 7365 6c66 2e6e  ].        self.n
+000252f0: 616e 5f69 6e66 5f74 6f5f 6572 726f 7273  an_inf_to_errors
+00025300: 203d 2069 6e69 745f 6461 7461 5b22 6e61   = init_data["na
+00025310: 6e5f 696e 665f 746f 5f65 7272 6f72 7322  n_inf_to_errors"
+00025320: 5d0a 2020 2020 2020 2020 7365 6c66 2e64  ].        self.d
+00025330: 6566 6175 6c74 5f64 6174 655f 666f 726d  efault_date_form
+00025340: 6174 203d 2069 6e69 745f 6461 7461 5b22  at = init_data["
+00025350: 6465 6661 756c 745f 6461 7465 5f66 6f72  default_date_for
+00025360: 6d61 7422 5d0a 2020 2020 2020 2020 7365  mat"].        se
+00025370: 6c66 2e64 6566 6175 6c74 5f75 726c 5f66  lf.default_url_f
+00025380: 6f72 6d61 7420 3d20 696e 6974 5f64 6174  ormat = init_dat
+00025390: 615b 2264 6566 6175 6c74 5f75 726c 5f66  a["default_url_f
+000253a0: 6f72 6d61 7422 5d0a 2020 2020 2020 2020  ormat"].        
+000253b0: 7365 6c66 2e65 7863 656c 3230 3033 5f73  self.excel2003_s
+000253c0: 7479 6c65 203d 2069 6e69 745f 6461 7461  tyle = init_data
+000253d0: 5b22 6578 6365 6c32 3030 335f 7374 796c  ["excel2003_styl
+000253e0: 6522 5d0a 2020 2020 2020 2020 7365 6c66  e"].        self
+000253f0: 2e72 656d 6f76 655f 7469 6d65 7a6f 6e65  .remove_timezone
+00025400: 203d 2069 6e69 745f 6461 7461 5b22 7265   = init_data["re
+00025410: 6d6f 7665 5f74 696d 657a 6f6e 6522 5d0a  move_timezone"].
+00025420: 2020 2020 2020 2020 7365 6c66 2e6d 6178          self.max
+00025430: 5f75 726c 5f6c 656e 6774 6820 3d20 696e  _url_length = in
+00025440: 6974 5f64 6174 615b 226d 6178 5f75 726c  it_data["max_url
+00025450: 5f6c 656e 6774 6822 5d0a 2020 2020 2020  _length"].      
+00025460: 2020 7365 6c66 2e75 7365 5f66 7574 7572    self.use_futur
+00025470: 655f 6675 6e63 7469 6f6e 7320 3d20 696e  e_functions = in
+00025480: 6974 5f64 6174 615b 2275 7365 5f66 7574  it_data["use_fut
+00025490: 7572 655f 6675 6e63 7469 6f6e 7322 5d0a  ure_functions"].
+000254a0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+000254b0: 2e65 7863 656c 3230 3033 5f73 7479 6c65  .excel2003_style
+000254c0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+000254d0: 6c66 2e6f 7269 6769 6e61 6c5f 726f 775f  lf.original_row_
+000254e0: 6865 6967 6874 203d 2031 322e 3735 0a20  height = 12.75. 
+000254f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00025500: 6465 6661 756c 745f 726f 775f 6865 6967  default_row_heig
+00025510: 6874 203d 2031 322e 3735 0a20 2020 2020  ht = 12.75.     
+00025520: 2020 2020 2020 2073 656c 662e 6465 6661         self.defa
+00025530: 756c 745f 726f 775f 7069 7865 6c73 203d  ult_row_pixels =
+00025540: 2031 370a 2020 2020 2020 2020 2020 2020   17.            
+00025550: 7365 6c66 2e6d 6172 6769 6e5f 6c65 6674  self.margin_left
+00025560: 203d 2030 2e37 350a 2020 2020 2020 2020   = 0.75.        
+00025570: 2020 2020 7365 6c66 2e6d 6172 6769 6e5f      self.margin_
+00025580: 7269 6768 7420 3d20 302e 3735 0a20 2020  right = 0.75.   
+00025590: 2020 2020 2020 2020 2073 656c 662e 6d61           self.ma
+000255a0: 7267 696e 5f74 6f70 203d 2031 0a20 2020  rgin_top = 1.   
+000255b0: 2020 2020 2020 2020 2073 656c 662e 6d61           self.ma
+000255c0: 7267 696e 5f62 6f74 746f 6d20 3d20 310a  rgin_bottom = 1.
+000255d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000255e0: 2e6d 6172 6769 6e5f 6865 6164 6572 203d  .margin_header =
+000255f0: 2030 2e35 0a20 2020 2020 2020 2020 2020   0.5.           
+00025600: 2073 656c 662e 6d61 7267 696e 5f66 6f6f   self.margin_foo
+00025610: 7465 7220 3d20 302e 350a 2020 2020 2020  ter = 0.5.      
+00025620: 2020 2020 2020 7365 6c66 2e68 6561 6465        self.heade
+00025630: 725f 666f 6f74 6572 5f61 6c69 676e 7320  r_footer_aligns 
+00025640: 3d20 4661 6c73 650a 0a20 2020 2020 2020  = False..       
+00025650: 2023 204f 7065 6e20 6120 7465 6d70 2066   # Open a temp f
+00025660: 696c 6568 616e 646c 6520 746f 2073 746f  ilehandle to sto
+00025670: 7265 2072 6f77 2064 6174 6120 696e 2063  re row data in c
+00025680: 6f6e 7374 616e 745f 6d65 6d6f 7279 206d  onstant_memory m
+00025690: 6f64 652e 0a20 2020 2020 2020 2069 6620  ode..        if 
+000256a0: 7365 6c66 2e63 6f6e 7374 616e 745f 6d65  self.constant_me
+000256b0: 6d6f 7279 3a0a 2020 2020 2020 2020 2020  mory:.          
+000256c0: 2020 2320 5468 6973 2069 7320 7375 622d    # This is sub-
+000256d0: 6f70 7469 6d61 6c20 6275 7420 7765 206e  optimal but we n
+000256e0: 6565 6420 746f 2063 7265 6174 6520 6120  eed to create a 
+000256f0: 7465 6d70 2066 696c 650a 2020 2020 2020  temp file.      
+00025700: 2020 2020 2020 2320 7769 7468 2075 7466        # with utf
+00025710: 3820 656e 636f 6469 6e67 2069 6e20 5079  8 encoding in Py
+00025720: 7468 6f6e 203c 2033 2e0a 2020 2020 2020  thon < 3..      
+00025730: 2020 2020 2020 2866 642c 2066 696c 656e        (fd, filen
+00025740: 616d 6529 203d 2074 656d 7066 696c 652e  ame) = tempfile.
+00025750: 6d6b 7374 656d 7028 6469 723d 7365 6c66  mkstemp(dir=self
+00025760: 2e74 6d70 6469 7229 0a20 2020 2020 2020  .tmpdir).       
+00025770: 2020 2020 206f 732e 636c 6f73 6528 6664       os.close(fd
+00025780: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+00025790: 6c66 2e72 6f77 5f64 6174 615f 6669 6c65  lf.row_data_file
+000257a0: 6e61 6d65 203d 2066 696c 656e 616d 650a  name = filename.
+000257b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000257c0: 2e72 6f77 5f64 6174 615f 6668 203d 206f  .row_data_fh = o
+000257d0: 7065 6e28 6669 6c65 6e61 6d65 2c20 6d6f  pen(filename, mo
+000257e0: 6465 3d22 772b 222c 2065 6e63 6f64 696e  de="w+", encodin
+000257f0: 673d 2275 7466 2d38 2229 0a0a 2020 2020  g="utf-8")..    
+00025800: 2020 2020 2020 2020 2320 5365 7420 6173          # Set as
+00025810: 2074 6865 2077 6f72 6b73 6865 6574 2066   the worksheet f
+00025820: 696c 6568 616e 646c 6520 756e 7469 6c20  ilehandle until 
+00025830: 7468 6520 6669 6c65 2069 7320 6173 7365  the file is asse
+00025840: 6d62 6c65 642e 0a20 2020 2020 2020 2020  mbled..         
+00025850: 2020 2073 656c 662e 6668 203d 2073 656c     self.fh = sel
+00025860: 662e 726f 775f 6461 7461 5f66 680a 0a20  f.row_data_fh.. 
+00025870: 2020 2064 6566 205f 6173 7365 6d62 6c65     def _assemble
+00025880: 5f78 6d6c 5f66 696c 6528 7365 6c66 293a  _xml_file(self):
+00025890: 0a20 2020 2020 2020 2023 2041 7373 656d  .        # Assem
+000258a0: 626c 6520 616e 6420 7772 6974 6520 7468  ble and write th
+000258b0: 6520 584d 4c20 6669 6c65 2e0a 0a20 2020  e XML file...   
+000258c0: 2020 2020 2023 2057 7269 7465 2074 6865       # Write the
+000258d0: 2058 4d4c 2064 6563 6c61 7261 7469 6f6e   XML declaration
+000258e0: 2e0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+000258f0: 786d 6c5f 6465 636c 6172 6174 696f 6e28  xml_declaration(
+00025900: 290a 0a20 2020 2020 2020 2023 2057 7269  )..        # Wri
+00025910: 7465 2074 6865 2072 6f6f 7420 776f 726b  te the root work
+00025920: 7368 6565 7420 656c 656d 656e 742e 0a20  sheet element.. 
+00025930: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
+00025940: 7465 5f77 6f72 6b73 6865 6574 2829 0a0a  te_worksheet()..
+00025950: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
+00025960: 7468 6520 776f 726b 7368 6565 7420 7072  the worksheet pr
+00025970: 6f70 6572 7469 6573 2e0a 2020 2020 2020  operties..      
+00025980: 2020 7365 6c66 2e5f 7772 6974 655f 7368    self._write_sh
+00025990: 6565 745f 7072 2829 0a0a 2020 2020 2020  eet_pr()..      
+000259a0: 2020 2320 5772 6974 6520 7468 6520 776f    # Write the wo
+000259b0: 726b 7368 6565 7420 6469 6d65 6e73 696f  rksheet dimensio
+000259c0: 6e73 2e0a 2020 2020 2020 2020 7365 6c66  ns..        self
+000259d0: 2e5f 7772 6974 655f 6469 6d65 6e73 696f  ._write_dimensio
+000259e0: 6e28 290a 0a20 2020 2020 2020 2023 2057  n()..        # W
+000259f0: 7269 7465 2074 6865 2073 6865 6574 2076  rite the sheet v
+00025a00: 6965 7720 7072 6f70 6572 7469 6573 2e0a  iew properties..
+00025a10: 2020 2020 2020 2020 7365 6c66 2e5f 7772          self._wr
+00025a20: 6974 655f 7368 6565 745f 7669 6577 7328  ite_sheet_views(
+00025a30: 290a 0a20 2020 2020 2020 2023 2057 7269  )..        # Wri
+00025a40: 7465 2074 6865 2073 6865 6574 2066 6f72  te the sheet for
+00025a50: 6d61 7420 7072 6f70 6572 7469 6573 2e0a  mat properties..
+00025a60: 2020 2020 2020 2020 7365 6c66 2e5f 7772          self._wr
+00025a70: 6974 655f 7368 6565 745f 666f 726d 6174  ite_sheet_format
+00025a80: 5f70 7228 290a 0a20 2020 2020 2020 2023  _pr()..        #
+00025a90: 2057 7269 7465 2074 6865 2073 6865 6574   Write the sheet
+00025aa0: 2063 6f6c 756d 6e20 696e 666f 2e0a 2020   column info..  
+00025ab0: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
+00025ac0: 655f 636f 6c73 2829 0a0a 2020 2020 2020  e_cols()..      
+00025ad0: 2020 2320 5772 6974 6520 7468 6520 776f    # Write the wo
+00025ae0: 726b 7368 6565 7420 6461 7461 2073 7563  rksheet data suc
+00025af0: 6820 6173 2072 6f77 7320 636f 6c75 6d6e  h as rows column
+00025b00: 7320 616e 6420 6365 6c6c 732e 0a20 2020  s and cells..   
+00025b10: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+00025b20: 2e63 6f6e 7374 616e 745f 6d65 6d6f 7279  .constant_memory
+00025b30: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00025b40: 6c66 2e5f 7772 6974 655f 7368 6565 745f  lf._write_sheet_
+00025b50: 6461 7461 2829 0a20 2020 2020 2020 2065  data().        e
+00025b60: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00025b70: 2073 656c 662e 5f77 7269 7465 5f6f 7074   self._write_opt
+00025b80: 696d 697a 6564 5f73 6865 6574 5f64 6174  imized_sheet_dat
+00025b90: 6128 290a 0a20 2020 2020 2020 2023 2057  a()..        # W
+00025ba0: 7269 7465 2074 6865 2073 6865 6574 5072  rite the sheetPr
+00025bb0: 6f74 6563 7469 6f6e 2065 6c65 6d65 6e74  otection element
+00025bc0: 2e0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+00025bd0: 7772 6974 655f 7368 6565 745f 7072 6f74  write_sheet_prot
+00025be0: 6563 7469 6f6e 2829 0a0a 2020 2020 2020  ection()..      
+00025bf0: 2020 2320 5772 6974 6520 7468 6520 7072    # Write the pr
+00025c00: 6f74 6563 7465 6452 616e 6765 7320 656c  otectedRanges el
+00025c10: 656d 656e 742e 0a20 2020 2020 2020 2073  ement..        s
+00025c20: 656c 662e 5f77 7269 7465 5f70 726f 7465  elf._write_prote
+00025c30: 6374 6564 5f72 616e 6765 7328 290a 0a20  cted_ranges().. 
+00025c40: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
+00025c50: 6865 2070 686f 6e65 7469 6350 7220 656c  he phoneticPr el
+00025c60: 656d 656e 742e 0a20 2020 2020 2020 2069  ement..        i
+00025c70: 6620 7365 6c66 2e65 7863 656c 3230 3033  f self.excel2003
+00025c80: 5f73 7479 6c65 3a0a 2020 2020 2020 2020  _style:.        
+00025c90: 2020 2020 7365 6c66 2e5f 7772 6974 655f      self._write_
+00025ca0: 7068 6f6e 6574 6963 5f70 7228 290a 0a20  phonetic_pr().. 
+00025cb0: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
+00025cc0: 6865 2061 7574 6f46 696c 7465 7220 656c  he autoFilter el
+00025cd0: 656d 656e 742e 0a20 2020 2020 2020 2073  ement..        s
+00025ce0: 656c 662e 5f77 7269 7465 5f61 7574 6f5f  elf._write_auto_
+00025cf0: 6669 6c74 6572 2829 0a0a 2020 2020 2020  filter()..      
+00025d00: 2020 2320 5772 6974 6520 7468 6520 6d65    # Write the me
+00025d10: 7267 6543 656c 6c73 2065 6c65 6d65 6e74  rgeCells element
+00025d20: 2e0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+00025d30: 7772 6974 655f 6d65 7267 655f 6365 6c6c  write_merge_cell
+00025d40: 7328 290a 0a20 2020 2020 2020 2023 2057  s()..        # W
+00025d50: 7269 7465 2074 6865 2063 6f6e 6469 7469  rite the conditi
+00025d60: 6f6e 616c 2066 6f72 6d61 7473 2e0a 2020  onal formats..  
+00025d70: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
+00025d80: 655f 636f 6e64 6974 696f 6e61 6c5f 666f  e_conditional_fo
+00025d90: 726d 6174 7328 290a 0a20 2020 2020 2020  rmats()..       
+00025da0: 2023 2057 7269 7465 2074 6865 2064 6174   # Write the dat
+00025db0: 6156 616c 6964 6174 696f 6e73 2065 6c65  aValidations ele
+00025dc0: 6d65 6e74 2e0a 2020 2020 2020 2020 7365  ment..        se
+00025dd0: 6c66 2e5f 7772 6974 655f 6461 7461 5f76  lf._write_data_v
+00025de0: 616c 6964 6174 696f 6e73 2829 0a0a 2020  alidations()..  
+00025df0: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
+00025e00: 6520 6879 7065 726c 696e 6b20 656c 656d  e hyperlink elem
+00025e10: 656e 742e 0a20 2020 2020 2020 2073 656c  ent..        sel
+00025e20: 662e 5f77 7269 7465 5f68 7970 6572 6c69  f._write_hyperli
+00025e30: 6e6b 7328 290a 0a20 2020 2020 2020 2023  nks()..        #
+00025e40: 2057 7269 7465 2074 6865 2070 7269 6e74   Write the print
+00025e50: 4f70 7469 6f6e 7320 656c 656d 656e 742e  Options element.
+00025e60: 0a20 2020 2020 2020 2073 656c 662e 5f77  .        self._w
+00025e70: 7269 7465 5f70 7269 6e74 5f6f 7074 696f  rite_print_optio
+00025e80: 6e73 2829 0a0a 2020 2020 2020 2020 2320  ns()..        # 
+00025e90: 5772 6974 6520 7468 6520 776f 726b 7368  Write the worksh
+00025ea0: 6565 7420 7061 6765 5f6d 6172 6769 6e73  eet page_margins
+00025eb0: 2e0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+00025ec0: 7772 6974 655f 7061 6765 5f6d 6172 6769  write_page_margi
+00025ed0: 6e73 2829 0a0a 2020 2020 2020 2020 2320  ns()..        # 
+00025ee0: 5772 6974 6520 7468 6520 776f 726b 7368  Write the worksh
+00025ef0: 6565 7420 7061 6765 2073 6574 7570 2e0a  eet page setup..
+00025f00: 2020 2020 2020 2020 7365 6c66 2e5f 7772          self._wr
+00025f10: 6974 655f 7061 6765 5f73 6574 7570 2829  ite_page_setup()
+00025f20: 0a0a 2020 2020 2020 2020 2320 5772 6974  ..        # Writ
+00025f30: 6520 7468 6520 6865 6164 6572 466f 6f74  e the headerFoot
+00025f40: 6572 2065 6c65 6d65 6e74 2e0a 2020 2020  er element..    
+00025f50: 2020 2020 7365 6c66 2e5f 7772 6974 655f      self._write_
+00025f60: 6865 6164 6572 5f66 6f6f 7465 7228 290a  header_footer().
+00025f70: 0a20 2020 2020 2020 2023 2057 7269 7465  .        # Write
+00025f80: 2074 6865 2072 6f77 4272 6561 6b73 2065   the rowBreaks e
+00025f90: 6c65 6d65 6e74 2e0a 2020 2020 2020 2020  lement..        
+00025fa0: 7365 6c66 2e5f 7772 6974 655f 726f 775f  self._write_row_
+00025fb0: 6272 6561 6b73 2829 0a0a 2020 2020 2020  breaks()..      
+00025fc0: 2020 2320 5772 6974 6520 7468 6520 636f    # Write the co
+00025fd0: 6c42 7265 616b 7320 656c 656d 656e 742e  lBreaks element.
+00025fe0: 0a20 2020 2020 2020 2073 656c 662e 5f77  .        self._w
+00025ff0: 7269 7465 5f63 6f6c 5f62 7265 616b 7328  rite_col_breaks(
+00026000: 290a 0a20 2020 2020 2020 2023 2057 7269  )..        # Wri
+00026010: 7465 2074 6865 2069 676e 6f72 6564 4572  te the ignoredEr
+00026020: 726f 7273 2065 6c65 6d65 6e74 2e0a 2020  rors element..  
+00026030: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
+00026040: 655f 6967 6e6f 7265 645f 6572 726f 7273  e_ignored_errors
+00026050: 2829 0a0a 2020 2020 2020 2020 2320 5772  ()..        # Wr
+00026060: 6974 6520 7468 6520 6472 6177 696e 6720  ite the drawing 
+00026070: 656c 656d 656e 742e 0a20 2020 2020 2020  element..       
+00026080: 2073 656c 662e 5f77 7269 7465 5f64 7261   self._write_dra
+00026090: 7769 6e67 7328 290a 0a20 2020 2020 2020  wings()..       
+000260a0: 2023 2057 7269 7465 2074 6865 206c 6567   # Write the leg
+000260b0: 6163 7944 7261 7769 6e67 2065 6c65 6d65  acyDrawing eleme
+000260c0: 6e74 2e0a 2020 2020 2020 2020 7365 6c66  nt..        self
+000260d0: 2e5f 7772 6974 655f 6c65 6761 6379 5f64  ._write_legacy_d
+000260e0: 7261 7769 6e67 2829 0a0a 2020 2020 2020  rawing()..      
+000260f0: 2020 2320 5772 6974 6520 7468 6520 6c65    # Write the le
+00026100: 6761 6379 4472 6177 696e 6748 4620 656c  gacyDrawingHF el
+00026110: 656d 656e 742e 0a20 2020 2020 2020 2073  ement..        s
+00026120: 656c 662e 5f77 7269 7465 5f6c 6567 6163  elf._write_legac
+00026130: 795f 6472 6177 696e 675f 6866 2829 0a0a  y_drawing_hf()..
+00026140: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
+00026150: 7468 6520 7069 6374 7572 6520 656c 656d  the picture elem
+00026160: 656e 742c 2066 6f72 2074 6865 2062 6163  ent, for the bac
+00026170: 6b67 726f 756e 642e 0a20 2020 2020 2020  kground..       
+00026180: 2073 656c 662e 5f77 7269 7465 5f70 6963   self._write_pic
+00026190: 7475 7265 2829 0a0a 2020 2020 2020 2020  ture()..        
+000261a0: 2320 5772 6974 6520 7468 6520 7461 626c  # Write the tabl
+000261b0: 6550 6172 7473 2065 6c65 6d65 6e74 2e0a  eParts element..
+000261c0: 2020 2020 2020 2020 7365 6c66 2e5f 7772          self._wr
+000261d0: 6974 655f 7461 626c 655f 7061 7274 7328  ite_table_parts(
+000261e0: 290a 0a20 2020 2020 2020 2023 2057 7269  )..        # Wri
+000261f0: 7465 2074 6865 2065 7874 4c73 7420 656c  te the extLst el
+00026200: 656d 656e 7473 2e0a 2020 2020 2020 2020  ements..        
+00026210: 7365 6c66 2e5f 7772 6974 655f 6578 745f  self._write_ext_
+00026220: 6c69 7374 2829 0a0a 2020 2020 2020 2020  list()..        
+00026230: 2320 436c 6f73 6520 7468 6520 776f 726b  # Close the work
+00026240: 7368 6565 7420 7461 672e 0a20 2020 2020  sheet tag..     
+00026250: 2020 2073 656c 662e 5f78 6d6c 5f65 6e64     self._xml_end
+00026260: 5f74 6167 2822 776f 726b 7368 6565 7422  _tag("worksheet"
+00026270: 290a 0a20 2020 2020 2020 2023 2043 6c6f  )..        # Clo
+00026280: 7365 2074 6865 2066 696c 652e 0a20 2020  se the file..   
+00026290: 2020 2020 2073 656c 662e 5f78 6d6c 5f63       self._xml_c
+000262a0: 6c6f 7365 2829 0a0a 2020 2020 6465 6620  lose()..    def 
+000262b0: 5f63 6865 636b 5f64 696d 656e 7369 6f6e  _check_dimension
+000262c0: 7328 7365 6c66 2c20 726f 772c 2063 6f6c  s(self, row, col
+000262d0: 2c20 6967 6e6f 7265 5f72 6f77 3d46 616c  , ignore_row=Fal
+000262e0: 7365 2c20 6967 6e6f 7265 5f63 6f6c 3d46  se, ignore_col=F
+000262f0: 616c 7365 293a 0a20 2020 2020 2020 2023  alse):.        #
+00026300: 2043 6865 636b 2074 6861 7420 726f 7720   Check that row 
+00026310: 616e 6420 636f 6c20 6172 6520 7661 6c69  and col are vali
+00026320: 6420 616e 6420 7374 6f72 6520 7468 6520  d and store the 
+00026330: 6d61 7820 616e 6420 6d69 6e0a 2020 2020  max and min.    
+00026340: 2020 2020 2320 7661 6c75 6573 2066 6f72      # values for
+00026350: 2075 7365 2069 6e20 6f74 6865 7220 6d65   use in other me
+00026360: 7468 6f64 732f 656c 656d 656e 7473 2e20  thods/elements. 
+00026370: 5468 6520 6967 6e6f 7265 5f72 6f77 202f  The ignore_row /
+00026380: 0a20 2020 2020 2020 2023 2069 676e 6f72  .        # ignor
+00026390: 655f 636f 6c20 666c 6167 7320 6973 2075  e_col flags is u
+000263a0: 7365 6420 746f 2069 6e64 6963 6174 6520  sed to indicate 
+000263b0: 7468 6174 2077 6520 7769 7368 2074 6f20  that we wish to 
+000263c0: 7065 7266 6f72 6d0a 2020 2020 2020 2020  perform.        
+000263d0: 2320 7468 6520 6469 6d65 6e73 696f 6e20  # the dimension 
+000263e0: 6368 6563 6b20 7769 7468 6f75 7420 7374  check without st
+000263f0: 6f72 696e 6720 7468 6520 7661 6c75 652e  oring the value.
+00026400: 2054 6865 2069 676e 6f72 650a 2020 2020   The ignore.    
+00026410: 2020 2020 2320 666c 6167 7320 6172 6520      # flags are 
+00026420: 7573 6520 6279 2073 6574 5f72 6f77 2829  use by set_row()
+00026430: 2061 6e64 2064 6174 615f 7661 6c69 6461   and data_valida
+00026440: 7465 2e0a 0a20 2020 2020 2020 2023 2043  te...        # C
+00026450: 6865 636b 2074 6861 7420 7468 6520 726f  heck that the ro
+00026460: 772f 636f 6c20 6172 6520 7769 7468 696e  w/col are within
+00026470: 2074 6865 2077 6f72 6b73 6865 6574 2062   the worksheet b
+00026480: 6f75 6e64 732e 0a20 2020 2020 2020 2069  ounds..        i
+00026490: 6620 726f 7720 3c20 3020 6f72 2063 6f6c  f row < 0 or col
+000264a0: 203c 2030 3a0a 2020 2020 2020 2020 2020   < 0:.          
+000264b0: 2020 7265 7475 726e 202d 310a 2020 2020    return -1.    
+000264c0: 2020 2020 6966 2072 6f77 203e 3d20 7365      if row >= se
+000264d0: 6c66 2e78 6c73 5f72 6f77 6d61 7820 6f72  lf.xls_rowmax or
+000264e0: 2063 6f6c 203e 3d20 7365 6c66 2e78 6c73   col >= self.xls
+000264f0: 5f63 6f6c 6d61 783a 0a20 2020 2020 2020  _colmax:.       
+00026500: 2020 2020 2072 6574 7572 6e20 2d31 0a0a       return -1..
+00026510: 2020 2020 2020 2020 2320 496e 2063 6f6e          # In con
+00026520: 7374 616e 745f 6d65 6d6f 7279 206d 6f64  stant_memory mod
+00026530: 6520 7765 2064 6f6e 2774 2063 6861 6e67  e we don't chang
+00026540: 6520 6469 6d65 6e73 696f 6e73 2066 6f72  e dimensions for
+00026550: 2072 6f77 730a 2020 2020 2020 2020 2320   rows.        # 
+00026560: 7468 6174 2061 7265 2061 6c72 6561 6479  that are already
+00026570: 2077 7269 7474 656e 2e0a 2020 2020 2020   written..      
+00026580: 2020 6966 206e 6f74 2069 676e 6f72 655f    if not ignore_
+00026590: 726f 7720 616e 6420 6e6f 7420 6967 6e6f  row and not igno
+000265a0: 7265 5f63 6f6c 2061 6e64 2073 656c 662e  re_col and self.
+000265b0: 636f 6e73 7461 6e74 5f6d 656d 6f72 793a  constant_memory:
+000265c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000265d0: 726f 7720 3c20 7365 6c66 2e70 7265 7669  row < self.previ
+000265e0: 6f75 735f 726f 773a 0a20 2020 2020 2020  ous_row:.       
+000265f0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00026600: 2d32 0a0a 2020 2020 2020 2020 6966 206e  -2..        if n
+00026610: 6f74 2069 676e 6f72 655f 726f 773a 0a20  ot ignore_row:. 
+00026620: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+00026630: 6c66 2e64 696d 5f72 6f77 6d69 6e20 6973  lf.dim_rowmin is
+00026640: 204e 6f6e 6520 6f72 2072 6f77 203c 2073   None or row < s
+00026650: 656c 662e 6469 6d5f 726f 776d 696e 3a0a  elf.dim_rowmin:.
+00026660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026670: 7365 6c66 2e64 696d 5f72 6f77 6d69 6e20  self.dim_rowmin 
+00026680: 3d20 726f 770a 2020 2020 2020 2020 2020  = row.          
+00026690: 2020 6966 2073 656c 662e 6469 6d5f 726f    if self.dim_ro
+000266a0: 776d 6178 2069 7320 4e6f 6e65 206f 7220  wmax is None or 
+000266b0: 726f 7720 3e20 7365 6c66 2e64 696d 5f72  row > self.dim_r
+000266c0: 6f77 6d61 783a 0a20 2020 2020 2020 2020  owmax:.         
+000266d0: 2020 2020 2020 2073 656c 662e 6469 6d5f         self.dim_
+000266e0: 726f 776d 6178 203d 2072 6f77 0a0a 2020  rowmax = row..  
+000266f0: 2020 2020 2020 6966 206e 6f74 2069 676e        if not ign
+00026700: 6f72 655f 636f 6c3a 0a20 2020 2020 2020  ore_col:.       
+00026710: 2020 2020 2069 6620 7365 6c66 2e64 696d       if self.dim
+00026720: 5f63 6f6c 6d69 6e20 6973 204e 6f6e 6520  _colmin is None 
+00026730: 6f72 2063 6f6c 203c 2073 656c 662e 6469  or col < self.di
+00026740: 6d5f 636f 6c6d 696e 3a0a 2020 2020 2020  m_colmin:.      
+00026750: 2020 2020 2020 2020 2020 7365 6c66 2e64            self.d
+00026760: 696d 5f63 6f6c 6d69 6e20 3d20 636f 6c0a  im_colmin = col.
+00026770: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00026780: 656c 662e 6469 6d5f 636f 6c6d 6178 2069  elf.dim_colmax i
+00026790: 7320 4e6f 6e65 206f 7220 636f 6c20 3e20  s None or col > 
+000267a0: 7365 6c66 2e64 696d 5f63 6f6c 6d61 783a  self.dim_colmax:
+000267b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000267c0: 2073 656c 662e 6469 6d5f 636f 6c6d 6178   self.dim_colmax
+000267d0: 203d 2063 6f6c 0a0a 2020 2020 2020 2020   = col..        
+000267e0: 7265 7475 726e 2030 0a0a 2020 2020 6465  return 0..    de
+000267f0: 6620 5f63 6f6e 7665 7274 5f64 6174 655f  f _convert_date_
+00026800: 7469 6d65 2873 656c 662c 2064 745f 6f62  time(self, dt_ob
+00026810: 6a29 3a0a 2020 2020 2020 2020 2320 436f  j):.        # Co
+00026820: 6e76 6572 7420 6120 6461 7465 7469 6d65  nvert a datetime
+00026830: 206f 626a 6563 7420 746f 2061 6e20 4578   object to an Ex
+00026840: 6365 6c20 7365 7269 616c 2064 6174 6520  cel serial date 
+00026850: 616e 6420 7469 6d65 2e0a 2020 2020 2020  and time..      
+00026860: 2020 7265 7475 726e 2064 6174 6574 696d    return datetim
+00026870: 655f 746f 5f65 7863 656c 5f64 6174 6574  e_to_excel_datet
+00026880: 696d 6528 6474 5f6f 626a 2c20 7365 6c66  ime(dt_obj, self
+00026890: 2e64 6174 655f 3139 3034 2c20 7365 6c66  .date_1904, self
+000268a0: 2e72 656d 6f76 655f 7469 6d65 7a6f 6e65  .remove_timezone
+000268b0: 290a 0a20 2020 2064 6566 205f 636f 6e76  )..    def _conv
+000268c0: 6572 745f 6e61 6d65 5f61 7265 6128 7365  ert_name_area(se
+000268d0: 6c66 2c20 726f 775f 6e75 6d5f 312c 2063  lf, row_num_1, c
+000268e0: 6f6c 5f6e 756d 5f31 2c20 726f 775f 6e75  ol_num_1, row_nu
+000268f0: 6d5f 322c 2063 6f6c 5f6e 756d 5f32 293a  m_2, col_num_2):
+00026900: 0a20 2020 2020 2020 2023 2043 6f6e 7665  .        # Conve
+00026910: 7274 207a 6572 6f20 696e 6465 7865 6420  rt zero indexed 
+00026920: 726f 7773 2061 6e64 2063 6f6c 756d 6e73  rows and columns
+00026930: 2074 6f20 7468 6520 666f 726d 6174 2072   to the format r
+00026940: 6571 7569 7265 6420 6279 0a20 2020 2020  equired by.     
+00026950: 2020 2023 2077 6f72 6b73 6865 6574 206e     # worksheet n
+00026960: 616d 6564 2072 616e 6765 732c 2065 672c  amed ranges, eg,
+00026970: 2022 5368 6565 7431 2124 4124 313a 2443   "Sheet1!$A$1:$C
+00026980: 2431 3322 2e0a 0a20 2020 2020 2020 2072  $13"...        r
+00026990: 616e 6765 3120 3d20 2222 0a20 2020 2020  ange1 = "".     
+000269a0: 2020 2072 616e 6765 3220 3d20 2222 0a20     range2 = "". 
+000269b0: 2020 2020 2020 2061 7265 6120 3d20 2222         area = ""
+000269c0: 0a20 2020 2020 2020 2072 6f77 5f63 6f6c  .        row_col
+000269d0: 5f6f 6e6c 7920 3d20 300a 0a20 2020 2020  _only = 0..     
+000269e0: 2020 2023 2043 6f6e 7665 7274 2074 6f20     # Convert to 
+000269f0: 4131 206e 6f74 6174 696f 6e2e 0a20 2020  A1 notation..   
+00026a00: 2020 2020 2063 6f6c 5f63 6861 725f 3120       col_char_1 
+00026a10: 3d20 786c 5f63 6f6c 5f74 6f5f 6e61 6d65  = xl_col_to_name
+00026a20: 2863 6f6c 5f6e 756d 5f31 2c20 3129 0a20  (col_num_1, 1). 
+00026a30: 2020 2020 2020 2063 6f6c 5f63 6861 725f         col_char_
+00026a40: 3220 3d20 786c 5f63 6f6c 5f74 6f5f 6e61  2 = xl_col_to_na
+00026a50: 6d65 2863 6f6c 5f6e 756d 5f32 2c20 3129  me(col_num_2, 1)
+00026a60: 0a20 2020 2020 2020 2072 6f77 5f63 6861  .        row_cha
+00026a70: 725f 3120 3d20 2224 2220 2b20 7374 7228  r_1 = "$" + str(
+00026a80: 726f 775f 6e75 6d5f 3120 2b20 3129 0a20  row_num_1 + 1). 
+00026a90: 2020 2020 2020 2072 6f77 5f63 6861 725f         row_char_
+00026aa0: 3220 3d20 2224 2220 2b20 7374 7228 726f  2 = "$" + str(ro
+00026ab0: 775f 6e75 6d5f 3220 2b20 3129 0a0a 2020  w_num_2 + 1)..  
+00026ac0: 2020 2020 2020 2320 5765 206e 6565 6420        # We need 
+00026ad0: 746f 2068 616e 646c 6520 7370 6563 6961  to handle specia
+00026ae0: 6c20 6361 7365 7320 7468 6174 2072 6566  l cases that ref
+00026af0: 6572 2074 6f20 726f 7773 206f 7220 636f  er to rows or co
+00026b00: 6c75 6d6e 7320 6f6e 6c79 2e0a 2020 2020  lumns only..    
+00026b10: 2020 2020 6966 2072 6f77 5f6e 756d 5f31      if row_num_1
+00026b20: 203d 3d20 3020 616e 6420 726f 775f 6e75   == 0 and row_nu
+00026b30: 6d5f 3220 3d3d 2073 656c 662e 786c 735f  m_2 == self.xls_
+00026b40: 726f 776d 6178 202d 2031 3a0a 2020 2020  rowmax - 1:.    
+00026b50: 2020 2020 2020 2020 7261 6e67 6531 203d          range1 =
+00026b60: 2063 6f6c 5f63 6861 725f 310a 2020 2020   col_char_1.    
+00026b70: 2020 2020 2020 2020 7261 6e67 6532 203d          range2 =
+00026b80: 2063 6f6c 5f63 6861 725f 320a 2020 2020   col_char_2.    
+00026b90: 2020 2020 2020 2020 726f 775f 636f 6c5f          row_col_
+00026ba0: 6f6e 6c79 203d 2031 0a20 2020 2020 2020  only = 1.       
+00026bb0: 2065 6c69 6620 636f 6c5f 6e75 6d5f 3120   elif col_num_1 
+00026bc0: 3d3d 2030 2061 6e64 2063 6f6c 5f6e 756d  == 0 and col_num
+00026bd0: 5f32 203d 3d20 7365 6c66 2e78 6c73 5f63  _2 == self.xls_c
+00026be0: 6f6c 6d61 7820 2d20 313a 0a20 2020 2020  olmax - 1:.     
+00026bf0: 2020 2020 2020 2072 616e 6765 3120 3d20         range1 = 
+00026c00: 726f 775f 6368 6172 5f31 0a20 2020 2020  row_char_1.     
+00026c10: 2020 2020 2020 2072 616e 6765 3220 3d20         range2 = 
+00026c20: 726f 775f 6368 6172 5f32 0a20 2020 2020  row_char_2.     
+00026c30: 2020 2020 2020 2072 6f77 5f63 6f6c 5f6f         row_col_o
+00026c40: 6e6c 7920 3d20 310a 2020 2020 2020 2020  nly = 1.        
+00026c50: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00026c60: 2020 7261 6e67 6531 203d 2063 6f6c 5f63    range1 = col_c
+00026c70: 6861 725f 3120 2b20 726f 775f 6368 6172  har_1 + row_char
+00026c80: 5f31 0a20 2020 2020 2020 2020 2020 2072  _1.            r
+00026c90: 616e 6765 3220 3d20 636f 6c5f 6368 6172  ange2 = col_char
+00026ca0: 5f32 202b 2072 6f77 5f63 6861 725f 320a  _2 + row_char_2.
+00026cb0: 0a20 2020 2020 2020 2023 2041 2072 6570  .        # A rep
+00026cc0: 6561 7465 6420 7261 6e67 6520 6973 206f  eated range is o
+00026cd0: 6e6c 7920 7772 6974 7465 6e20 6f6e 6365  nly written once
+00026ce0: 2028 6966 2069 7420 6973 6e27 7420 6120   (if it isn't a 
+00026cf0: 7370 6563 6961 6c20 6361 7365 292e 0a20  special case).. 
+00026d00: 2020 2020 2020 2069 6620 7261 6e67 6531         if range1
+00026d10: 203d 3d20 7261 6e67 6532 2061 6e64 206e   == range2 and n
+00026d20: 6f74 2072 6f77 5f63 6f6c 5f6f 6e6c 793a  ot row_col_only:
+00026d30: 0a20 2020 2020 2020 2020 2020 2061 7265  .            are
+00026d40: 6120 3d20 7261 6e67 6531 0a20 2020 2020  a = range1.     
+00026d50: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00026d60: 2020 2020 2061 7265 6120 3d20 7261 6e67       area = rang
+00026d70: 6531 202b 2022 3a22 202b 2072 616e 6765  e1 + ":" + range
+00026d80: 320a 0a20 2020 2020 2020 2023 2042 7569  2..        # Bui
+00026d90: 6c64 2075 7020 7468 6520 7072 696e 7420  ld up the print 
+00026da0: 6172 6561 2072 616e 6765 2022 5368 6565  area range "Shee
+00026db0: 7431 2124 4124 313a 2443 2431 3322 2e0a  t1!$A$1:$C$13"..
+00026dc0: 2020 2020 2020 2020 7368 6565 746e 616d          sheetnam
+00026dd0: 6520 3d20 7175 6f74 655f 7368 6565 746e  e = quote_sheetn
+00026de0: 616d 6528 7365 6c66 2e6e 616d 6529 0a20  ame(self.name). 
+00026df0: 2020 2020 2020 2061 7265 6120 3d20 7368         area = sh
+00026e00: 6565 746e 616d 6520 2b20 2221 2220 2b20  eetname + "!" + 
+00026e10: 6172 6561 0a0a 2020 2020 2020 2020 7265  area..        re
+00026e20: 7475 726e 2061 7265 610a 0a20 2020 2064  turn area..    d
+00026e30: 6566 205f 736f 7274 5f70 6167 6562 7265  ef _sort_pagebre
+00026e40: 616b 7328 7365 6c66 2c20 6272 6561 6b73  aks(self, breaks
+00026e50: 293a 0a20 2020 2020 2020 2023 2054 6869  ):.        # Thi
+00026e60: 7320 6973 2061 6e20 696e 7465 726e 616c  s is an internal
+00026e70: 206d 6574 686f 6420 7573 6564 2074 6f20   method used to 
+00026e80: 6669 6c74 6572 2065 6c65 6d65 6e74 7320  filter elements 
+00026e90: 6f66 2061 206c 6973 7420 6f66 0a20 2020  of a list of.   
+00026ea0: 2020 2020 2023 2070 6167 6562 7265 616b       # pagebreak
+00026eb0: 7320 7573 6564 2069 6e20 7468 6520 5f73  s used in the _s
+00026ec0: 746f 7265 5f68 6272 6561 6b28 2920 616e  tore_hbreak() an
+00026ed0: 6420 5f73 746f 7265 5f76 6272 6561 6b28  d _store_vbreak(
+00026ee0: 2920 6d65 7468 6f64 732e 0a20 2020 2020  ) methods..     
+00026ef0: 2020 2023 2049 743a 0a20 2020 2020 2020     # It:.       
+00026f00: 2023 2020 2031 2e20 5265 6d6f 7665 7320   #   1. Removes 
+00026f10: 6475 706c 6963 6174 6520 656e 7472 6965  duplicate entrie
+00026f20: 7320 6672 6f6d 2074 6865 206c 6973 742e  s from the list.
+00026f30: 0a20 2020 2020 2020 2023 2020 2032 2e20  .        #   2. 
+00026f40: 536f 7274 7320 7468 6520 6c69 7374 2e0a  Sorts the list..
+00026f50: 2020 2020 2020 2020 2320 2020 332e 2052          #   3. R
+00026f60: 656d 6f76 6573 2030 2066 726f 6d20 7468  emoves 0 from th
+00026f70: 6520 6c69 7374 2069 6620 7072 6573 656e  e list if presen
+00026f80: 742e 0a20 2020 2020 2020 2069 6620 6e6f  t..        if no
+00026f90: 7420 6272 6561 6b73 3a0a 2020 2020 2020  t breaks:.      
+00026fa0: 2020 2020 2020 7265 7475 726e 0a0a 2020        return..  
+00026fb0: 2020 2020 2020 6272 6561 6b73 5f73 6574        breaks_set
+00026fc0: 203d 2073 6574 2862 7265 616b 7329 0a0a   = set(breaks)..
+00026fd0: 2020 2020 2020 2020 6966 2030 2069 6e20          if 0 in 
+00026fe0: 6272 6561 6b73 5f73 6574 3a0a 2020 2020  breaks_set:.    
+00026ff0: 2020 2020 2020 2020 6272 6561 6b73 5f73          breaks_s
+00027000: 6574 2e72 656d 6f76 6528 3029 0a0a 2020  et.remove(0)..  
+00027010: 2020 2020 2020 6272 6561 6b73 5f6c 6973        breaks_lis
+00027020: 7420 3d20 6c69 7374 2862 7265 616b 735f  t = list(breaks_
+00027030: 7365 7429 0a20 2020 2020 2020 2062 7265  set).        bre
+00027040: 616b 735f 6c69 7374 2e73 6f72 7428 290a  aks_list.sort().
+00027050: 0a20 2020 2020 2020 2023 2054 6865 2045  .        # The E
+00027060: 7863 656c 2032 3030 3720 7370 6563 6966  xcel 2007 specif
+00027070: 6963 6174 696f 6e20 7361 7973 2074 6861  ication says tha
+00027080: 7420 7468 6520 6d61 7869 6d75 6d20 6e75  t the maximum nu
+00027090: 6d62 6572 206f 6620 7061 6765 0a20 2020  mber of page.   
+000270a0: 2020 2020 2023 2062 7265 616b 7320 6973       # breaks is
+000270b0: 2031 3032 362e 2048 6f77 6576 6572 2c20   1026. However, 
+000270c0: 696e 2070 7261 6374 6963 6520 6974 2069  in practice it i
+000270d0: 7320 6163 7475 616c 6c79 2031 3032 332e  s actually 1023.
+000270e0: 0a20 2020 2020 2020 206d 6178 5f6e 756d  .        max_num
+000270f0: 5f62 7265 616b 7320 3d20 3130 3233 0a20  _breaks = 1023. 
+00027100: 2020 2020 2020 2069 6620 6c65 6e28 6272         if len(br
+00027110: 6561 6b73 5f6c 6973 7429 203e 206d 6178  eaks_list) > max
+00027120: 5f6e 756d 5f62 7265 616b 733a 0a20 2020  _num_breaks:.   
+00027130: 2020 2020 2020 2020 2062 7265 616b 735f           breaks_
+00027140: 6c69 7374 203d 2062 7265 616b 735f 6c69  list = breaks_li
+00027150: 7374 5b3a 6d61 785f 6e75 6d5f 6272 6561  st[:max_num_brea
+00027160: 6b73 5d0a 0a20 2020 2020 2020 2072 6574  ks]..        ret
+00027170: 7572 6e20 6272 6561 6b73 5f6c 6973 740a  urn breaks_list.
+00027180: 0a20 2020 2064 6566 205f 6578 7472 6163  .    def _extrac
+00027190: 745f 6669 6c74 6572 5f74 6f6b 656e 7328  t_filter_tokens(
+000271a0: 7365 6c66 2c20 6578 7072 6573 7369 6f6e  self, expression
+000271b0: 293a 0a20 2020 2020 2020 2023 2045 7874  ):.        # Ext
+000271c0: 7261 6374 2074 6865 2074 6f6b 656e 7320  ract the tokens 
+000271d0: 6672 6f6d 2074 6865 2066 696c 7465 7220  from the filter 
+000271e0: 6578 7072 6573 7369 6f6e 2e20 5468 6520  expression. The 
+000271f0: 746f 6b65 6e73 2061 7265 206d 6169 6e6c  tokens are mainl
+00027200: 790a 2020 2020 2020 2020 2320 6e6f 6e2d  y.        # non-
+00027210: 7768 6974 6573 7061 6365 2067 726f 7570  whitespace group
+00027220: 732e 2054 6865 206f 6e6c 7920 7472 6963  s. The only tric
+00027230: 6b79 2070 6172 7420 6973 2074 6f20 6578  ky part is to ex
+00027240: 7472 6163 7420 7374 7269 6e67 0a20 2020  tract string.   
+00027250: 2020 2020 2023 2074 6f6b 656e 7320 7468       # tokens th
+00027260: 6174 2063 6f6e 7461 696e 2077 6869 7465  at contain white
+00027270: 7370 6163 6520 616e 642f 6f72 2071 756f  space and/or quo
+00027280: 7465 6420 646f 7562 6c65 2071 756f 7465  ted double quote
+00027290: 7320 2845 7863 656c 2773 0a20 2020 2020  s (Excel's.     
+000272a0: 2020 2023 2065 7363 6170 6564 2071 756f     # escaped quo
+000272b0: 7465 7329 2e0a 2020 2020 2020 2020 230a  tes)..        #.
+000272c0: 2020 2020 2020 2020 2320 4578 616d 706c          # Exampl
+000272d0: 6573 3a20 2778 203c 2020 3230 3030 270a  es: 'x <  2000'.
+000272e0: 2020 2020 2020 2020 2320 2020 2020 2020          #       
+000272f0: 2020 2020 2778 203e 2020 3230 3030 2061      'x >  2000 a
+00027300: 6e64 2078 203c 2020 3530 3030 270a 2020  nd x <  5000'.  
+00027310: 2020 2020 2020 2320 2020 2020 2020 2020        #         
+00027320: 2020 2778 203d 2022 666f 6f22 270a 2020    'x = "foo"'.  
+00027330: 2020 2020 2020 2320 2020 2020 2020 2020        #         
+00027340: 2020 2778 203d 2022 666f 6f20 6261 7222    'x = "foo bar"
+00027350: 270a 2020 2020 2020 2020 2320 2020 2020  '.        #     
+00027360: 2020 2020 2020 2778 203d 2022 666f 6f20        'x = "foo 
+00027370: 2222 2062 6172 2227 0a20 2020 2020 2020  "" bar"'.       
+00027380: 2023 0a20 2020 2020 2020 2069 6620 6e6f   #.        if no
+00027390: 7420 6578 7072 6573 7369 6f6e 3a0a 2020  t expression:.  
+000273a0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000273b0: 205b 5d0a 0a20 2020 2020 2020 2074 6f6b   []..        tok
+000273c0: 656e 5f72 6520 3d20 7265 2e63 6f6d 7069  en_re = re.compi
+000273d0: 6c65 2872 2722 283f 3a5b 5e22 5d7c 2222  le(r'"(?:[^"]|""
+000273e0: 292a 227c 5c53 2b27 290a 2020 2020 2020  )*"|\S+').      
+000273f0: 2020 746f 6b65 6e73 203d 2074 6f6b 656e    tokens = token
+00027400: 5f72 652e 6669 6e64 616c 6c28 6578 7072  _re.findall(expr
+00027410: 6573 7369 6f6e 290a 0a20 2020 2020 2020  ession)..       
+00027420: 206e 6577 5f74 6f6b 656e 7320 3d20 5b5d   new_tokens = []
+00027430: 0a20 2020 2020 2020 2023 2052 656d 6f76  .        # Remov
+00027440: 6520 7369 6e67 6c65 206c 6561 6469 6e67  e single leading
+00027450: 2061 6e64 2074 7261 696c 696e 6720 7175   and trailing qu
+00027460: 6f74 6573 2061 6e64 2075 6e2d 6573 6361  otes and un-esca
+00027470: 7065 206f 7468 6572 2071 756f 7465 732e  pe other quotes.
+00027480: 0a20 2020 2020 2020 2066 6f72 2074 6f6b  .        for tok
+00027490: 656e 2069 6e20 746f 6b65 6e73 3a0a 2020  en in tokens:.  
+000274a0: 2020 2020 2020 2020 2020 6966 2074 6f6b            if tok
+000274b0: 656e 2e73 7461 7274 7377 6974 6828 2722  en.startswith('"
+000274c0: 2729 3a0a 2020 2020 2020 2020 2020 2020  '):.            
+000274d0: 2020 2020 746f 6b65 6e20 3d20 746f 6b65      token = toke
+000274e0: 6e5b 313a 5d0a 0a20 2020 2020 2020 2020  n[1:]..         
+000274f0: 2020 2069 6620 746f 6b65 6e2e 656e 6473     if token.ends
+00027500: 7769 7468 2827 2227 293a 0a20 2020 2020  with('"'):.     
+00027510: 2020 2020 2020 2020 2020 2074 6f6b 656e             token
+00027520: 203d 2074 6f6b 656e 5b3a 2d31 5d0a 0a20   = token[:-1].. 
+00027530: 2020 2020 2020 2020 2020 2074 6f6b 656e             token
+00027540: 203d 2074 6f6b 656e 2e72 6570 6c61 6365   = token.replace
+00027550: 2827 2222 272c 2027 2227 290a 0a20 2020  ('""', '"')..   
+00027560: 2020 2020 2020 2020 206e 6577 5f74 6f6b           new_tok
+00027570: 656e 732e 6170 7065 6e64 2874 6f6b 656e  ens.append(token
+00027580: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00027590: 6e20 6e65 775f 746f 6b65 6e73 0a0a 2020  n new_tokens..  
+000275a0: 2020 6465 6620 5f70 6172 7365 5f66 696c    def _parse_fil
+000275b0: 7465 725f 6578 7072 6573 7369 6f6e 2873  ter_expression(s
+000275c0: 656c 662c 2065 7870 7265 7373 696f 6e2c  elf, expression,
+000275d0: 2074 6f6b 656e 7329 3a0a 2020 2020 2020   tokens):.      
+000275e0: 2020 2320 436f 6e76 6572 7473 2074 6865    # Converts the
+000275f0: 2074 6f6b 656e 7320 6f66 2061 2070 6f73   tokens of a pos
+00027600: 7369 626c 7920 636f 6e64 6974 696f 6e61  sibly conditiona
+00027610: 6c20 6578 7072 6573 7369 6f6e 2069 6e74  l expression int
+00027620: 6f20 3120 6f72 2032 0a20 2020 2020 2020  o 1 or 2.       
+00027630: 2023 2073 7562 2065 7870 7265 7373 696f   # sub expressio
+00027640: 6e73 2066 6f72 2066 7572 7468 6572 2070  ns for further p
+00027650: 6172 7369 6e67 2e0a 2020 2020 2020 2020  arsing..        
+00027660: 230a 2020 2020 2020 2020 2320 4578 616d  #.        # Exam
+00027670: 706c 6573 3a0a 2020 2020 2020 2020 2320  ples:.        # 
+00027680: 2020 2020 2020 2020 2028 2778 272c 2027           ('x', '
+00027690: 3d3d 272c 2032 3030 3029 202d 3e20 6578  ==', 2000) -> ex
+000276a0: 7031 0a20 2020 2020 2020 2023 2020 2020  p1.        #    
+000276b0: 2020 2020 2020 2827 7827 2c20 273e 272c        ('x', '>',
+000276c0: 2020 3230 3030 2c20 2761 6e64 272c 2027    2000, 'and', '
+000276d0: 7827 2c20 273c 272c 2035 3030 3029 202d  x', '<', 5000) -
+000276e0: 3e20 6578 7031 2061 6e64 2065 7870 320a  > exp1 and exp2.
+000276f0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+00027700: 746f 6b65 6e73 2920 3d3d 2037 3a0a 2020  tokens) == 7:.  
+00027710: 2020 2020 2020 2020 2020 2320 5468 6520            # The 
+00027720: 6e75 6d62 6572 206f 6620 746f 6b65 6e73  number of tokens
+00027730: 2077 696c 6c20 6265 2065 6974 6865 7220   will be either 
+00027740: 3320 2866 6f72 2031 2065 7870 7265 7373  3 (for 1 express
+00027750: 696f 6e29 0a20 2020 2020 2020 2020 2020  ion).           
+00027760: 2023 206f 7220 3720 2866 6f72 2032 2020   # or 7 (for 2  
+00027770: 6578 7072 6573 7369 6f6e 7329 2e0a 2020  expressions)..  
+00027780: 2020 2020 2020 2020 2020 636f 6e64 6974            condit
+00027790: 696f 6e61 6c20 3d20 746f 6b65 6e73 5b33  ional = tokens[3
+000277a0: 5d0a 0a20 2020 2020 2020 2020 2020 2069  ]..            i
+000277b0: 6620 7265 2e6d 6174 6368 2822 2861 6e64  f re.match("(and
+000277c0: 7c26 2629 222c 2063 6f6e 6469 7469 6f6e  |&&)", condition
+000277d0: 616c 293a 0a20 2020 2020 2020 2020 2020  al):.           
+000277e0: 2020 2020 2063 6f6e 6469 7469 6f6e 616c       conditional
+000277f0: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
+00027800: 2065 6c69 6620 7265 2e6d 6174 6368 2872   elif re.match(r
+00027810: 2228 6f72 7c5c 7c5c 7c29 222c 2063 6f6e  "(or|\|\|)", con
+00027820: 6469 7469 6f6e 616c 293a 0a20 2020 2020  ditional):.     
+00027830: 2020 2020 2020 2020 2020 2063 6f6e 6469             condi
+00027840: 7469 6f6e 616c 203d 2031 0a20 2020 2020  tional = 1.     
+00027850: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00027860: 2020 2020 2020 2020 2020 2020 2077 6172               war
+00027870: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+00027880: 2020 2020 2020 2022 546f 6b65 6e20 2725         "Token '%
+00027890: 7327 2069 7320 6e6f 7420 6120 7661 6c69  s' is not a vali
+000278a0: 6420 636f 6e64 6974 696f 6e61 6c20 220a  d conditional ".
+000278b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000278c0: 2020 2020 2269 6e20 6669 6c74 6572 2065      "in filter e
+000278d0: 7870 7265 7373 696f 6e20 2725 7327 2220  xpression '%s'" 
+000278e0: 2520 2863 6f6e 6469 7469 6f6e 616c 2c20  % (conditional, 
+000278f0: 6578 7072 6573 7369 6f6e 290a 2020 2020  expression).    
+00027900: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00027910: 2020 2020 2020 2020 2020 2065 7870 7265             expre
+00027920: 7373 696f 6e5f 3120 3d20 7365 6c66 2e5f  ssion_1 = self._
+00027930: 7061 7273 655f 6669 6c74 6572 5f74 6f6b  parse_filter_tok
+00027940: 656e 7328 6578 7072 6573 7369 6f6e 2c20  ens(expression, 
+00027950: 746f 6b65 6e73 5b30 3a33 5d29 0a20 2020  tokens[0:3]).   
+00027960: 2020 2020 2020 2020 2065 7870 7265 7373           express
+00027970: 696f 6e5f 3220 3d20 7365 6c66 2e5f 7061  ion_2 = self._pa
+00027980: 7273 655f 6669 6c74 6572 5f74 6f6b 656e  rse_filter_token
+00027990: 7328 6578 7072 6573 7369 6f6e 2c20 746f  s(expression, to
+000279a0: 6b65 6e73 5b34 3a37 5d29 0a0a 2020 2020  kens[4:7])..    
+000279b0: 2020 2020 2020 2020 7265 7475 726e 2065          return e
+000279c0: 7870 7265 7373 696f 6e5f 3120 2b20 5b63  xpression_1 + [c
+000279d0: 6f6e 6469 7469 6f6e 616c 5d20 2b20 6578  onditional] + ex
+000279e0: 7072 6573 7369 6f6e 5f32 0a20 2020 2020  pression_2.     
+000279f0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00027a00: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00027a10: 2e5f 7061 7273 655f 6669 6c74 6572 5f74  ._parse_filter_t
+00027a20: 6f6b 656e 7328 6578 7072 6573 7369 6f6e  okens(expression
+00027a30: 2c20 746f 6b65 6e73 290a 0a20 2020 2064  , tokens)..    d
+00027a40: 6566 205f 7061 7273 655f 6669 6c74 6572  ef _parse_filter
+00027a50: 5f74 6f6b 656e 7328 7365 6c66 2c20 6578  _tokens(self, ex
+00027a60: 7072 6573 7369 6f6e 2c20 746f 6b65 6e73  pression, tokens
+00027a70: 293a 0a20 2020 2020 2020 2023 2050 6172  ):.        # Par
+00027a80: 7365 2074 6865 2033 2074 6f6b 656e 7320  se the 3 tokens 
+00027a90: 6f66 2061 2066 696c 7465 7220 6578 7072  of a filter expr
+00027aa0: 6573 7369 6f6e 2061 6e64 2072 6574 7572  ession and retur
+00027ab0: 6e20 7468 6520 6f70 6572 6174 6f72 0a20  n the operator. 
+00027ac0: 2020 2020 2020 2023 2061 6e64 2074 6f6b         # and tok
+00027ad0: 656e 2e20 5468 6520 7573 6520 6f66 206e  en. The use of n
+00027ae0: 756d 6265 7273 2069 6e73 7465 6164 206f  umbers instead o
+00027af0: 6620 6f70 6572 6174 6f72 7320 6973 2061  f operators is a
+00027b00: 206c 6567 6163 7920 6f66 0a20 2020 2020   legacy of.     
+00027b10: 2020 2023 2053 7072 6561 6473 6865 6574     # Spreadsheet
+00027b20: 3a3a 5772 6974 6545 7863 656c 2e0a 2020  ::WriteExcel..  
+00027b30: 2020 2020 2020 6f70 6572 6174 6f72 7320        operators 
+00027b40: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+00027b50: 223d 3d22 3a20 322c 0a20 2020 2020 2020  "==": 2,.       
+00027b60: 2020 2020 2022 3d22 3a20 322c 0a20 2020       "=": 2,.   
+00027b70: 2020 2020 2020 2020 2022 3d7e 223a 2032           "=~": 2
+00027b80: 2c0a 2020 2020 2020 2020 2020 2020 2265  ,.            "e
+00027b90: 7122 3a20 322c 0a20 2020 2020 2020 2020  q": 2,.         
+00027ba0: 2020 2022 213d 223a 2035 2c0a 2020 2020     "!=": 5,.    
+00027bb0: 2020 2020 2020 2020 2221 7e22 3a20 352c          "!~": 5,
+00027bc0: 0a20 2020 2020 2020 2020 2020 2022 6e65  .            "ne
+00027bd0: 223a 2035 2c0a 2020 2020 2020 2020 2020  ": 5,.          
+00027be0: 2020 223c 3e22 3a20 352c 0a20 2020 2020    "<>": 5,.     
+00027bf0: 2020 2020 2020 2022 3c22 3a20 312c 0a20         "<": 1,. 
+00027c00: 2020 2020 2020 2020 2020 2022 3c3d 223a             "<=":
+00027c10: 2033 2c0a 2020 2020 2020 2020 2020 2020   3,.            
+00027c20: 223e 223a 2034 2c0a 2020 2020 2020 2020  ">": 4,.        
+00027c30: 2020 2020 223e 3d22 3a20 362c 0a20 2020      ">=": 6,.   
+00027c40: 2020 2020 207d 0a0a 2020 2020 2020 2020       }..        
+00027c50: 6f70 6572 6174 6f72 203d 206f 7065 7261  operator = opera
+00027c60: 746f 7273 2e67 6574 2874 6f6b 656e 735b  tors.get(tokens[
+00027c70: 315d 2c20 4e6f 6e65 290a 2020 2020 2020  1], None).      
+00027c80: 2020 746f 6b65 6e20 3d20 746f 6b65 6e73    token = tokens
+00027c90: 5b32 5d0a 0a20 2020 2020 2020 2023 2053  [2]..        # S
+00027ca0: 7065 6369 616c 2068 616e 646c 696e 6720  pecial handling 
+00027cb0: 6f66 2022 546f 7022 2066 696c 7465 7220  of "Top" filter 
+00027cc0: 6578 7072 6573 7369 6f6e 732e 0a20 2020  expressions..   
+00027cd0: 2020 2020 2069 6620 7265 2e6d 6174 6368       if re.match
+00027ce0: 2822 746f 707c 626f 7474 6f6d 222c 2074  ("top|bottom", t
+00027cf0: 6f6b 656e 735b 305d 2e6c 6f77 6572 2829  okens[0].lower()
+00027d00: 293a 0a20 2020 2020 2020 2020 2020 2076  ):.            v
+00027d10: 616c 7565 203d 2069 6e74 2874 6f6b 656e  alue = int(token
+00027d20: 735b 315d 290a 0a20 2020 2020 2020 2020  s[1])..         
+00027d30: 2020 2069 6620 7661 6c75 6520 3c20 3120     if value < 1 
+00027d40: 6f72 2076 616c 7565 203e 2035 3030 3a0a  or value > 500:.
+00027d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027d60: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
+00027d70: 2020 2020 2020 2020 2020 2254 6865 2076            "The v
+00027d80: 616c 7565 2027 2564 2720 696e 2065 7870  alue '%d' in exp
+00027d90: 7265 7373 696f 6e20 2725 7327 2022 0a20  ression '%s' ". 
+00027da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027db0: 2020 2022 6d75 7374 2062 6520 696e 2074     "must be in t
+00027dc0: 6865 2072 616e 6765 2031 2074 6f20 3530  he range 1 to 50
+00027dd0: 3022 2025 2028 7661 6c75 652c 2065 7870  0" % (value, exp
+00027de0: 7265 7373 696f 6e29 0a20 2020 2020 2020  ression).       
+00027df0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00027e00: 2020 2020 2020 2020 746f 6b65 6e20 3d20          token = 
+00027e10: 746f 6b65 6e2e 6c6f 7765 7228 290a 0a20  token.lower().. 
+00027e20: 2020 2020 2020 2020 2020 2069 6620 746f             if to
+00027e30: 6b65 6e20 213d 2022 6974 656d 7322 2061  ken != "items" a
+00027e40: 6e64 2074 6f6b 656e 2021 3d20 2225 223a  nd token != "%":
+00027e50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027e60: 2077 6172 6e28 0a20 2020 2020 2020 2020   warn(.         
+00027e70: 2020 2020 2020 2020 2020 2022 5468 6520             "The 
+00027e80: 7479 7065 2027 2573 2720 696e 2065 7870  type '%s' in exp
+00027e90: 7265 7373 696f 6e20 2725 7327 2022 0a20  ression '%s' ". 
+00027ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027eb0: 2020 2022 6d75 7374 2062 6520 6569 7468     "must be eith
+00027ec0: 6572 2027 6974 656d 7327 206f 7220 2725  er 'items' or '%
+00027ed0: 2527 2220 2520 2874 6f6b 656e 2c20 6578  %'" % (token, ex
+00027ee0: 7072 6573 7369 6f6e 290a 2020 2020 2020  pression).      
+00027ef0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00027f00: 2020 2020 2020 2020 2069 6620 746f 6b65           if toke
+00027f10: 6e73 5b30 5d2e 6c6f 7765 7228 2920 3d3d  ns[0].lower() ==
+00027f20: 2022 746f 7022 3a0a 2020 2020 2020 2020   "top":.        
+00027f30: 2020 2020 2020 2020 6f70 6572 6174 6f72          operator
+00027f40: 203d 2033 300a 2020 2020 2020 2020 2020   = 30.          
+00027f50: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00027f60: 2020 2020 2020 2020 6f70 6572 6174 6f72          operator
+00027f70: 203d 2033 320a 0a20 2020 2020 2020 2020   = 32..         
+00027f80: 2020 2069 6620 746f 6b65 6e73 5b32 5d20     if tokens[2] 
+00027f90: 3d3d 2022 2522 3a0a 2020 2020 2020 2020  == "%":.        
+00027fa0: 2020 2020 2020 2020 6f70 6572 6174 6f72          operator
+00027fb0: 202b 3d20 310a 0a20 2020 2020 2020 2020   += 1..         
+00027fc0: 2020 2074 6f6b 656e 203d 2073 7472 2876     token = str(v
+00027fd0: 616c 7565 290a 0a20 2020 2020 2020 2069  alue)..        i
+00027fe0: 6620 6e6f 7420 6f70 6572 6174 6f72 2061  f not operator a
+00027ff0: 6e64 2074 6f6b 656e 735b 305d 3a0a 2020  nd tokens[0]:.  
+00028000: 2020 2020 2020 2020 2020 7761 726e 280a            warn(.
+00028010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028020: 2254 6f6b 656e 2027 2573 2720 6973 206e  "Token '%s' is n
+00028030: 6f74 2061 2076 616c 6964 206f 7065 7261  ot a valid opera
+00028040: 746f 7220 220a 2020 2020 2020 2020 2020  tor ".          
+00028050: 2020 2020 2020 2269 6e20 6669 6c74 6572        "in filter
+00028060: 2065 7870 7265 7373 696f 6e20 2725 7327   expression '%s'
+00028070: 2220 2520 2874 6f6b 656e 5b30 5d2c 2065  " % (token[0], e
+00028080: 7870 7265 7373 696f 6e29 0a20 2020 2020  xpression).     
+00028090: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+000280a0: 2020 2320 5370 6563 6961 6c20 6861 6e64    # Special hand
+000280b0: 6c69 6e67 2066 6f72 2042 6c61 6e6b 732f  ling for Blanks/
+000280c0: 4e6f 6e42 6c61 6e6b 732e 0a20 2020 2020  NonBlanks..     
+000280d0: 2020 2069 6620 7265 2e6d 6174 6368 2822     if re.match("
+000280e0: 626c 616e 6b73 7c6e 6f6e 626c 616e 6b73  blanks|nonblanks
+000280f0: 222c 2074 6f6b 656e 2e6c 6f77 6572 2829  ", token.lower()
+00028100: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
+00028110: 204f 6e6c 7920 616c 6c6f 7720 4571 7561   Only allow Equa
+00028120: 6c73 206f 7220 4e6f 7445 7175 616c 2069  ls or NotEqual i
+00028130: 6e20 7468 6973 2063 6f6e 7465 7874 2e0a  n this context..
+00028140: 2020 2020 2020 2020 2020 2020 6966 206f              if o
+00028150: 7065 7261 746f 7220 213d 2032 2061 6e64  perator != 2 and
+00028160: 206f 7065 7261 746f 7220 213d 2035 3a0a   operator != 5:.
+00028170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028180: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
+00028190: 2020 2020 2020 2020 2020 2254 6865 206f            "The o
+000281a0: 7065 7261 746f 7220 2725 7327 2069 6e20  perator '%s' in 
+000281b0: 6578 7072 6573 7369 6f6e 2027 2573 2720  expression '%s' 
+000281c0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+000281d0: 2020 2020 2020 2269 7320 6e6f 7420 7661        "is not va
+000281e0: 6c69 6420 696e 2072 656c 6174 696f 6e20  lid in relation 
+000281f0: 746f 2042 6c61 6e6b 732f 4e6f 6e42 6c61  to Blanks/NonBla
+00028200: 6e6b 7327 220a 2020 2020 2020 2020 2020  nks'".          
+00028210: 2020 2020 2020 2020 2020 2520 2874 6f6b            % (tok
+00028220: 656e 735b 315d 2c20 6578 7072 6573 7369  ens[1], expressi
+00028230: 6f6e 290a 2020 2020 2020 2020 2020 2020  on).            
+00028240: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+00028250: 2020 2074 6f6b 656e 203d 2074 6f6b 656e     token = token
+00028260: 2e6c 6f77 6572 2829 0a0a 2020 2020 2020  .lower()..      
+00028270: 2020 2020 2020 2320 5468 6520 6f70 6572        # The oper
+00028280: 6174 6f72 2073 686f 756c 6420 616c 7761  ator should alwa
+00028290: 7973 2062 6520 3220 283d 2920 746f 2066  ys be 2 (=) to f
+000282a0: 6c61 6720 6120 2273 696d 706c 6522 2065  lag a "simple" e
+000282b0: 7175 616c 6974 790a 2020 2020 2020 2020  quality.        
+000282c0: 2020 2020 2320 696e 2074 6865 2062 696e      # in the bin
+000282d0: 6172 7920 7265 636f 7264 2e20 5468 6572  ary record. Ther
+000282e0: 6566 6f72 6520 7765 2063 6f6e 7665 7274  efore we convert
+000282f0: 203c 3e20 746f 203d 2e0a 2020 2020 2020   <> to =..      
+00028300: 2020 2020 2020 6966 2074 6f6b 656e 203d        if token =
+00028310: 3d20 2262 6c61 6e6b 7322 3a0a 2020 2020  = "blanks":.    
+00028320: 2020 2020 2020 2020 2020 2020 6966 206f              if o
+00028330: 7065 7261 746f 7220 3d3d 2035 3a0a 2020  perator == 5:.  
+00028340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028350: 2020 746f 6b65 6e20 3d20 2220 220a 2020    token = " ".  
+00028360: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00028370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028380: 6966 206f 7065 7261 746f 7220 3d3d 2035  if operator == 5
+00028390: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000283a0: 2020 2020 2020 6f70 6572 6174 6f72 203d        operator =
+000283b0: 2032 0a20 2020 2020 2020 2020 2020 2020   2.             
+000283c0: 2020 2020 2020 2074 6f6b 656e 203d 2022         token = "
+000283d0: 626c 616e 6b73 220a 2020 2020 2020 2020  blanks".        
+000283e0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000283f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028400: 2020 6f70 6572 6174 6f72 203d 2035 0a20    operator = 5. 
+00028410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028420: 2020 2074 6f6b 656e 203d 2022 2022 0a0a     token = " "..
+00028430: 2020 2020 2020 2020 2320 6966 2074 6865          # if the
+00028440: 2073 7472 696e 6720 746f 6b65 6e20 636f   string token co
+00028450: 6e74 6169 6e73 2061 6e20 4578 6365 6c20  ntains an Excel 
+00028460: 6d61 7463 6820 6368 6172 6163 7465 7220  match character 
+00028470: 7468 656e 2063 6861 6e67 6520 7468 650a  then change the.
+00028480: 2020 2020 2020 2020 2320 6f70 6572 6174          # operat
+00028490: 6f72 2074 7970 6520 746f 2069 6e64 6963  or type to indic
+000284a0: 6174 6520 6120 6e6f 6e20 2273 696d 706c  ate a non "simpl
+000284b0: 6522 2065 7175 616c 6974 792e 0a20 2020  e" equality..   
+000284c0: 2020 2020 2069 6620 6f70 6572 6174 6f72       if operator
+000284d0: 203d 3d20 3220 616e 6420 7265 2e73 6561   == 2 and re.sea
+000284e0: 7263 6828 225b 2a3f 5d22 2c20 746f 6b65  rch("[*?]", toke
+000284f0: 6e29 3a0a 2020 2020 2020 2020 2020 2020  n):.            
+00028500: 6f70 6572 6174 6f72 203d 2032 320a 0a20  operator = 22.. 
+00028510: 2020 2020 2020 2072 6574 7572 6e20 5b6f         return [o
+00028520: 7065 7261 746f 722c 2074 6f6b 656e 5d0a  perator, token].
+00028530: 0a20 2020 2064 6566 205f 656e 636f 6465  .    def _encode
+00028540: 5f70 6173 7377 6f72 6428 7365 6c66 2c20  _password(self, 
+00028550: 7061 7373 776f 7264 293a 0a20 2020 2020  password):.     
+00028560: 2020 2023 2048 6173 6820 6120 776f 726b     # Hash a work
+00028570: 7368 6565 7420 7061 7373 776f 7264 2e20  sheet password. 
+00028580: 4261 7365 6420 6f6e 2074 6865 2061 6c67  Based on the alg
+00028590: 6f72 6974 686d 2069 6e0a 2020 2020 2020  orithm in.      
+000285a0: 2020 2320 4543 4d41 2d33 3736 2d34 3a32    # ECMA-376-4:2
+000285b0: 3031 362c 204f 6666 6963 6520 4f70 656e  016, Office Open
+000285c0: 2058 4d4c 2046 696c 6520 466f 726d 6174   XML File Format
+000285d0: 7320 e280 9420 5472 616e 7369 7469 6f6e  s ... Transition
+000285e0: 616c 0a20 2020 2020 2020 2023 204d 6967  al.        # Mig
+000285f0: 7261 7469 6f6e 2046 6561 7475 7265 732c  ration Features,
+00028600: 2041 6464 6974 696f 6e61 6c20 6174 7472   Additional attr
+00028610: 6962 7574 6573 2066 6f72 2077 6f72 6b62  ibutes for workb
+00028620: 6f6f 6b50 726f 7465 6374 696f 6e0a 2020  ookProtection.  
+00028630: 2020 2020 2020 2320 656c 656d 656e 7420        # element 
+00028640: 2850 6172 7420 312c 20c2 a731 382e 322e  (Part 1, ..18.2.
+00028650: 3239 292e 0a20 2020 2020 2020 2068 6173  29)..        has
+00028660: 6820 3d20 3078 3030 3030 0a0a 2020 2020  h = 0x0000..    
+00028670: 2020 2020 666f 7220 6368 6172 2069 6e20      for char in 
+00028680: 7061 7373 776f 7264 5b3a 3a2d 315d 3a0a  password[::-1]:.
+00028690: 2020 2020 2020 2020 2020 2020 6861 7368              hash
+000286a0: 203d 2028 2868 6173 6820 3e3e 2031 3429   = ((hash >> 14)
+000286b0: 2026 2030 7830 3129 207c 2028 2868 6173   & 0x01) | ((has
+000286c0: 6820 3c3c 2031 2920 2620 3078 3746 4646  h << 1) & 0x7FFF
+000286d0: 290a 2020 2020 2020 2020 2020 2020 6861  ).            ha
+000286e0: 7368 205e 3d20 6f72 6428 6368 6172 290a  sh ^= ord(char).
+000286f0: 0a20 2020 2020 2020 2068 6173 6820 3d20  .        hash = 
+00028700: 2828 6861 7368 203e 3e20 3134 2920 2620  ((hash >> 14) & 
+00028710: 3078 3031 2920 7c20 2828 6861 7368 203c  0x01) | ((hash <
+00028720: 3c20 3129 2026 2030 7837 4646 4629 0a20  < 1) & 0x7FFF). 
+00028730: 2020 2020 2020 2068 6173 6820 5e3d 206c         hash ^= l
+00028740: 656e 2870 6173 7377 6f72 6429 0a20 2020  en(password).   
+00028750: 2020 2020 2068 6173 6820 5e3d 2030 7843       hash ^= 0xC
+00028760: 4534 420a 0a20 2020 2020 2020 2072 6574  E4B..        ret
+00028770: 7572 6e20 2225 5822 2025 2068 6173 680a  urn "%X" % hash.
+00028780: 0a20 2020 2064 6566 205f 7072 6570 6172  .    def _prepar
+00028790: 655f 696d 6167 6528 0a20 2020 2020 2020  e_image(.       
+000287a0: 2073 656c 662c 0a20 2020 2020 2020 2069   self,.        i
+000287b0: 6e64 6578 2c0a 2020 2020 2020 2020 696d  ndex,.        im
+000287c0: 6167 655f 6964 2c0a 2020 2020 2020 2020  age_id,.        
+000287d0: 6472 6177 696e 675f 6964 2c0a 2020 2020  drawing_id,.    
+000287e0: 2020 2020 7769 6474 682c 0a20 2020 2020      width,.     
+000287f0: 2020 2068 6569 6768 742c 0a20 2020 2020     height,.     
+00028800: 2020 206e 616d 652c 0a20 2020 2020 2020     name,.       
+00028810: 2069 6d61 6765 5f74 7970 652c 0a20 2020   image_type,.   
+00028820: 2020 2020 2078 5f64 7069 2c0a 2020 2020       x_dpi,.    
+00028830: 2020 2020 795f 6470 692c 0a20 2020 2020      y_dpi,.     
+00028840: 2020 2064 6967 6573 742c 0a20 2020 2029     digest,.    )
+00028850: 3a0a 2020 2020 2020 2020 2320 5365 7420  :.        # Set 
+00028860: 7570 2069 6d61 6765 732f 6472 6177 696e  up images/drawin
+00028870: 6773 2e0a 2020 2020 2020 2020 6472 6177  gs..        draw
+00028880: 696e 675f 7479 7065 203d 2032 0a20 2020  ing_type = 2.   
+00028890: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
+000288a0: 2020 2072 6f77 2c0a 2020 2020 2020 2020     row,.        
+000288b0: 2020 2020 636f 6c2c 0a20 2020 2020 2020      col,.       
+000288c0: 2020 2020 205f 2c0a 2020 2020 2020 2020       _,.        
+000288d0: 2020 2020 785f 6f66 6673 6574 2c0a 2020      x_offset,.  
+000288e0: 2020 2020 2020 2020 2020 795f 6f66 6673            y_offs
+000288f0: 6574 2c0a 2020 2020 2020 2020 2020 2020  et,.            
+00028900: 785f 7363 616c 652c 0a20 2020 2020 2020  x_scale,.       
+00028910: 2020 2020 2079 5f73 6361 6c65 2c0a 2020       y_scale,.  
+00028920: 2020 2020 2020 2020 2020 7572 6c2c 0a20            url,. 
+00028930: 2020 2020 2020 2020 2020 2074 6970 2c0a             tip,.
+00028940: 2020 2020 2020 2020 2020 2020 616e 6368              anch
+00028950: 6f72 2c0a 2020 2020 2020 2020 2020 2020  or,.            
+00028960: 5f2c 0a20 2020 2020 2020 2020 2020 2064  _,.            d
+00028970: 6573 6372 6970 7469 6f6e 2c0a 2020 2020  escription,.    
+00028980: 2020 2020 2020 2020 6465 636f 7261 7469          decorati
+00028990: 7665 2c0a 2020 2020 2020 2020 2920 3d20  ve,.        ) = 
+000289a0: 7365 6c66 2e69 6d61 6765 735b 696e 6465  self.images[inde
+000289b0: 785d 0a0a 2020 2020 2020 2020 7769 6474  x]..        widt
+000289c0: 6820 2a3d 2078 5f73 6361 6c65 0a20 2020  h *= x_scale.   
+000289d0: 2020 2020 2068 6569 6768 7420 2a3d 2079       height *= y
+000289e0: 5f73 6361 6c65 0a0a 2020 2020 2020 2020  _scale..        
+000289f0: 2320 5363 616c 6520 6279 206e 6f6e 2039  # Scale by non 9
+00028a00: 3664 7069 2072 6573 6f6c 7574 696f 6e73  6dpi resolutions
+00028a10: 2e0a 2020 2020 2020 2020 7769 6474 6820  ..        width 
+00028a20: 2a3d 2039 362e 3020 2f20 785f 6470 690a  *= 96.0 / x_dpi.
+00028a30: 2020 2020 2020 2020 6865 6967 6874 202a          height *
+00028a40: 3d20 3936 2e30 202f 2079 5f64 7069 0a0a  = 96.0 / y_dpi..
+00028a50: 2020 2020 2020 2020 6469 6d65 6e73 696f          dimensio
+00028a60: 6e73 203d 2073 656c 662e 5f70 6f73 6974  ns = self._posit
+00028a70: 696f 6e5f 6f62 6a65 6374 5f65 6d75 7328  ion_object_emus(
+00028a80: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+00028a90: 2c20 726f 772c 2078 5f6f 6666 7365 742c  , row, x_offset,
+00028aa0: 2079 5f6f 6666 7365 742c 2077 6964 7468   y_offset, width
+00028ab0: 2c20 6865 6967 6874 2c20 616e 6368 6f72  , height, anchor
+00028ac0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00028ad0: 2020 2023 2043 6f6e 7665 7274 2066 726f     # Convert fro
+00028ae0: 6d20 7069 7865 6c73 2074 6f20 656d 7573  m pixels to emus
+00028af0: 2e0a 2020 2020 2020 2020 7769 6474 6820  ..        width 
+00028b00: 3d20 696e 7428 302e 3520 2b20 2877 6964  = int(0.5 + (wid
+00028b10: 7468 202a 2039 3532 3529 290a 2020 2020  th * 9525)).    
+00028b20: 2020 2020 6865 6967 6874 203d 2069 6e74      height = int
+00028b30: 2830 2e35 202b 2028 6865 6967 6874 202a  (0.5 + (height *
+00028b40: 2039 3532 3529 290a 0a20 2020 2020 2020   9525))..       
+00028b50: 2023 2043 7265 6174 6520 6120 4472 6177   # Create a Draw
+00028b60: 696e 6720 6f62 6a20 746f 2075 7365 2077  ing obj to use w
+00028b70: 6974 6820 776f 726b 7368 6565 7420 756e  ith worksheet un
+00028b80: 6c65 7373 206f 6e65 2061 6c72 6561 6479  less one already
+00028b90: 2065 7869 7374 732e 0a20 2020 2020 2020   exists..       
+00028ba0: 2069 6620 6e6f 7420 7365 6c66 2e64 7261   if not self.dra
+00028bb0: 7769 6e67 3a0a 2020 2020 2020 2020 2020  wing:.          
+00028bc0: 2020 6472 6177 696e 6720 3d20 4472 6177    drawing = Draw
+00028bd0: 696e 6728 290a 2020 2020 2020 2020 2020  ing().          
+00028be0: 2020 6472 6177 696e 672e 656d 6265 6464    drawing.embedd
+00028bf0: 6564 203d 2031 0a20 2020 2020 2020 2020  ed = 1.         
+00028c00: 2020 2073 656c 662e 6472 6177 696e 6720     self.drawing 
+00028c10: 3d20 6472 6177 696e 670a 0a20 2020 2020  = drawing..     
+00028c20: 2020 2020 2020 2073 656c 662e 6578 7465         self.exte
+00028c30: 726e 616c 5f64 7261 7769 6e67 5f6c 696e  rnal_drawing_lin
+00028c40: 6b73 2e61 7070 656e 6428 0a20 2020 2020  ks.append(.     
+00028c50: 2020 2020 2020 2020 2020 205b 222f 6472             ["/dr
+00028c60: 6177 696e 6722 2c20 222e 2e2f 6472 6177  awing", "../draw
+00028c70: 696e 6773 2f64 7261 7769 6e67 2220 2b20  ings/drawing" + 
+00028c80: 7374 7228 6472 6177 696e 675f 6964 2920  str(drawing_id) 
+00028c90: 2b20 222e 786d 6c22 2c20 4e6f 6e65 5d0a  + ".xml", None].
+00028ca0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00028cb0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00028cc0: 2020 2020 2020 2020 6472 6177 696e 6720          drawing 
+00028cd0: 3d20 7365 6c66 2e64 7261 7769 6e67 0a0a  = self.drawing..
+00028ce0: 2020 2020 2020 2020 6472 6177 696e 675f          drawing_
+00028cf0: 6f62 6a65 6374 203d 2064 7261 7769 6e67  object = drawing
+00028d00: 2e5f 6164 645f 6472 6177 696e 675f 6f62  ._add_drawing_ob
+00028d10: 6a65 6374 2829 0a20 2020 2020 2020 2064  ject().        d
+00028d20: 7261 7769 6e67 5f6f 626a 6563 745b 2274  rawing_object["t
+00028d30: 7970 6522 5d20 3d20 6472 6177 696e 675f  ype"] = drawing_
+00028d40: 7479 7065 0a20 2020 2020 2020 2064 7261  type.        dra
+00028d50: 7769 6e67 5f6f 626a 6563 745b 2264 696d  wing_object["dim
+00028d60: 656e 7369 6f6e 7322 5d20 3d20 6469 6d65  ensions"] = dime
+00028d70: 6e73 696f 6e73 0a20 2020 2020 2020 2064  nsions.        d
+00028d80: 7261 7769 6e67 5f6f 626a 6563 745b 2277  rawing_object["w
+00028d90: 6964 7468 225d 203d 2077 6964 7468 0a20  idth"] = width. 
+00028da0: 2020 2020 2020 2064 7261 7769 6e67 5f6f         drawing_o
+00028db0: 626a 6563 745b 2268 6569 6768 7422 5d20  bject["height"] 
+00028dc0: 3d20 6865 6967 6874 0a20 2020 2020 2020  = height.       
+00028dd0: 2064 7261 7769 6e67 5f6f 626a 6563 745b   drawing_object[
+00028de0: 2264 6573 6372 6970 7469 6f6e 225d 203d  "description"] =
+00028df0: 206e 616d 650a 2020 2020 2020 2020 6472   name.        dr
+00028e00: 6177 696e 675f 6f62 6a65 6374 5b22 7368  awing_object["sh
+00028e10: 6170 6522 5d20 3d20 4e6f 6e65 0a20 2020  ape"] = None.   
+00028e20: 2020 2020 2064 7261 7769 6e67 5f6f 626a       drawing_obj
+00028e30: 6563 745b 2261 6e63 686f 7222 5d20 3d20  ect["anchor"] = 
+00028e40: 616e 6368 6f72 0a20 2020 2020 2020 2064  anchor.        d
+00028e50: 7261 7769 6e67 5f6f 626a 6563 745b 2272  rawing_object["r
+00028e60: 656c 5f69 6e64 6578 225d 203d 2030 0a20  el_index"] = 0. 
+00028e70: 2020 2020 2020 2064 7261 7769 6e67 5f6f         drawing_o
+00028e80: 626a 6563 745b 2275 726c 5f72 656c 5f69  bject["url_rel_i
+00028e90: 6e64 6578 225d 203d 2030 0a20 2020 2020  ndex"] = 0.     
+00028ea0: 2020 2064 7261 7769 6e67 5f6f 626a 6563     drawing_objec
+00028eb0: 745b 2274 6970 225d 203d 2074 6970 0a20  t["tip"] = tip. 
+00028ec0: 2020 2020 2020 2064 7261 7769 6e67 5f6f         drawing_o
+00028ed0: 626a 6563 745b 2264 6563 6f72 6174 6976  bject["decorativ
+00028ee0: 6522 5d20 3d20 6465 636f 7261 7469 7665  e"] = decorative
+00028ef0: 0a0a 2020 2020 2020 2020 6966 2064 6573  ..        if des
+00028f00: 6372 6970 7469 6f6e 2069 7320 6e6f 7420  cription is not 
+00028f10: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00028f20: 2020 6472 6177 696e 675f 6f62 6a65 6374    drawing_object
+00028f30: 5b22 6465 7363 7269 7074 696f 6e22 5d20  ["description"] 
+00028f40: 3d20 6465 7363 7269 7074 696f 6e0a 0a20  = description.. 
+00028f50: 2020 2020 2020 2069 6620 7572 6c3a 0a20         if url:. 
+00028f60: 2020 2020 2020 2020 2020 2074 6172 6765             targe
+00028f70: 7420 3d20 4e6f 6e65 0a20 2020 2020 2020  t = None.       
+00028f80: 2020 2020 2072 656c 5f74 7970 6520 3d20       rel_type = 
+00028f90: 222f 6879 7065 726c 696e 6b22 0a20 2020  "/hyperlink".   
+00028fa0: 2020 2020 2020 2020 2074 6172 6765 745f           target_
+00028fb0: 6d6f 6465 203d 2022 4578 7465 726e 616c  mode = "External
+00028fc0: 220a 0a20 2020 2020 2020 2020 2020 2069  "..            i
+00028fd0: 6620 7265 2e6d 6174 6368 2822 2866 7470  f re.match("(ftp
+00028fe0: 7c68 7474 7029 733f 3a2f 2f22 2c20 7572  |http)s?://", ur
+00028ff0: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
+00029000: 2020 2020 7461 7267 6574 203d 2073 656c      target = sel
+00029010: 662e 5f65 7363 6170 655f 7572 6c28 7572  f._escape_url(ur
+00029020: 6c29 0a0a 2020 2020 2020 2020 2020 2020  l)..            
+00029030: 6966 2072 652e 6d61 7463 6828 225e 6d61  if re.match("^ma
+00029040: 696c 746f 3a22 2c20 7572 6c29 3a0a 2020  ilto:", url):.  
+00029050: 2020 2020 2020 2020 2020 2020 2020 7461                ta
+00029060: 7267 6574 203d 2073 656c 662e 5f65 7363  rget = self._esc
+00029070: 6170 655f 7572 6c28 7572 6c29 0a0a 2020  ape_url(url)..  
+00029080: 2020 2020 2020 2020 2020 6966 2072 652e            if re.
+00029090: 6d61 7463 6828 2265 7874 6572 6e61 6c3a  match("external:
+000290a0: 222c 2075 726c 293a 0a20 2020 2020 2020  ", url):.       
+000290b0: 2020 2020 2020 2020 2074 6172 6765 7420           target 
+000290c0: 3d20 7572 6c2e 7265 706c 6163 6528 2265  = url.replace("e
+000290d0: 7874 6572 6e61 6c3a 222c 2022 2229 0a20  xternal:", ""). 
+000290e0: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+000290f0: 6172 6765 7420 3d20 7365 6c66 2e5f 6573  arget = self._es
+00029100: 6361 7065 5f75 726c 2874 6172 6765 7429  cape_url(target)
+00029110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00029120: 2023 2041 6464 6974 696f 6e61 6c20 6573   # Additional es
+00029130: 6361 7065 206e 6f74 2072 6571 7569 7265  cape not require
+00029140: 6420 696e 2077 6f72 6b73 6865 6574 2068  d in worksheet h
+00029150: 7970 6572 6c69 6e6b 732e 0a20 2020 2020  yperlinks..     
+00029160: 2020 2020 2020 2020 2020 2074 6172 6765             targe
+00029170: 7420 3d20 7461 7267 6574 2e72 6570 6c61  t = target.repla
+00029180: 6365 2822 2322 2c20 2225 3233 2229 0a0a  ce("#", "%23")..
+00029190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000291a0: 6966 2072 652e 6d61 7463 6828 7222 5c77  if re.match(r"\w
+000291b0: 3a22 2c20 7461 7267 6574 2920 6f72 2072  :", target) or r
+000291c0: 652e 6d61 7463 6828 7222 5c5c 222c 2074  e.match(r"\\", t
+000291d0: 6172 6765 7429 3a0a 2020 2020 2020 2020  arget):.        
+000291e0: 2020 2020 2020 2020 2020 2020 7461 7267              targ
+000291f0: 6574 203d 2022 6669 6c65 3a2f 2f2f 2220  et = "file:///" 
+00029200: 2b20 7461 7267 6574 0a20 2020 2020 2020  + target.       
+00029210: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00029220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029230: 2020 2074 6172 6765 7420 3d20 7461 7267     target = targ
+00029240: 6574 2e72 6570 6c61 6365 2822 5c5c 222c  et.replace("\\",
+00029250: 2022 2f22 290a 0a20 2020 2020 2020 2020   "/")..         
+00029260: 2020 2069 6620 7265 2e6d 6174 6368 2822     if re.match("
+00029270: 696e 7465 726e 616c 3a22 2c20 7572 6c29  internal:", url)
+00029280: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00029290: 2020 7461 7267 6574 203d 2075 726c 2e72    target = url.r
+000292a0: 6570 6c61 6365 2822 696e 7465 726e 616c  eplace("internal
+000292b0: 3a22 2c20 2223 2229 0a20 2020 2020 2020  :", "#").       
+000292c0: 2020 2020 2020 2020 2074 6172 6765 745f           target_
+000292d0: 6d6f 6465 203d 204e 6f6e 650a 0a20 2020  mode = None..   
+000292e0: 2020 2020 2020 2020 2069 6620 7461 7267           if targ
+000292f0: 6574 2069 7320 6e6f 7420 4e6f 6e65 3a0a  et is not None:.
+00029300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029310: 6966 206c 656e 2874 6172 6765 7429 203e  if len(target) >
+00029320: 2073 656c 662e 6d61 785f 7572 6c5f 6c65   self.max_url_le
+00029330: 6e67 7468 3a0a 2020 2020 2020 2020 2020  ngth:.          
+00029340: 2020 2020 2020 2020 2020 7761 726e 280a            warn(.
+00029350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029360: 2020 2020 2020 2020 2249 676e 6f72 696e          "Ignorin
+00029370: 6720 5552 4c20 2725 7327 2077 6974 6820  g URL '%s' with 
+00029380: 6c69 6e6b 2061 6e64 2f6f 7220 616e 6368  link and/or anch
+00029390: 6f72 203e 2025 6420 220a 2020 2020 2020  or > %d ".      
+000293a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000293b0: 2020 2263 6861 7261 6374 6572 7320 7369    "characters si
+000293c0: 6e63 6520 6974 2065 7863 6565 6473 2045  nce it exceeds E
+000293d0: 7863 656c 2773 206c 696d 6974 2066 6f72  xcel's limit for
+000293e0: 2055 524c 5322 0a20 2020 2020 2020 2020   URLS".         
+000293f0: 2020 2020 2020 2020 2020 2020 2020 2025                 %
+00029400: 2028 7572 6c2c 2073 656c 662e 6d61 785f   (url, self.max_
+00029410: 7572 6c5f 6c65 6e67 7468 290a 2020 2020  url_length).    
+00029420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029430: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00029440: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00029450: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00029460: 6f74 2073 656c 662e 6472 6177 696e 675f  ot self.drawing_
+00029470: 7265 6c73 2e67 6574 2875 726c 293a 0a20  rels.get(url):. 
+00029480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029490: 2020 2020 2020 2073 656c 662e 6472 6177         self.draw
+000294a0: 696e 675f 6c69 6e6b 732e 6170 7065 6e64  ing_links.append
+000294b0: 285b 7265 6c5f 7479 7065 2c20 7461 7267  ([rel_type, targ
+000294c0: 6574 2c20 7461 7267 6574 5f6d 6f64 655d  et, target_mode]
+000294d0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+000294e0: 2020 2020 2020 2064 7261 7769 6e67 5f6f         drawing_o
+000294f0: 626a 6563 745b 2275 726c 5f72 656c 5f69  bject["url_rel_i
+00029500: 6e64 6578 225d 203d 2073 656c 662e 5f67  ndex"] = self._g
+00029510: 6574 5f64 7261 7769 6e67 5f72 656c 5f69  et_drawing_rel_i
+00029520: 6e64 6578 2875 726c 290a 0a20 2020 2020  ndex(url)..     
+00029530: 2020 2069 6620 6e6f 7420 7365 6c66 2e64     if not self.d
+00029540: 7261 7769 6e67 5f72 656c 732e 6765 7428  rawing_rels.get(
+00029550: 6469 6765 7374 293a 0a20 2020 2020 2020  digest):.       
+00029560: 2020 2020 2073 656c 662e 6472 6177 696e       self.drawin
+00029570: 675f 6c69 6e6b 732e 6170 7065 6e64 280a  g_links.append(.
+00029580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029590: 5b22 2f69 6d61 6765 222c 2022 2e2e 2f6d  ["/image", "../m
+000295a0: 6564 6961 2f69 6d61 6765 2220 2b20 7374  edia/image" + st
+000295b0: 7228 696d 6167 655f 6964 2920 2b20 222e  r(image_id) + ".
+000295c0: 2220 2b20 696d 6167 655f 7479 7065 5d0a  " + image_type].
+000295d0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+000295e0: 2020 2020 2020 2064 7261 7769 6e67 5f6f         drawing_o
+000295f0: 626a 6563 745b 2272 656c 5f69 6e64 6578  bject["rel_index
+00029600: 225d 203d 2073 656c 662e 5f67 6574 5f64  "] = self._get_d
+00029610: 7261 7769 6e67 5f72 656c 5f69 6e64 6578  rawing_rel_index
+00029620: 2864 6967 6573 7429 0a0a 2020 2020 6465  (digest)..    de
+00029630: 6620 5f70 7265 7061 7265 5f73 6861 7065  f _prepare_shape
+00029640: 2873 656c 662c 2069 6e64 6578 2c20 6472  (self, index, dr
+00029650: 6177 696e 675f 6964 293a 0a20 2020 2020  awing_id):.     
+00029660: 2020 2023 2053 6574 2075 7020 7368 6170     # Set up shap
+00029670: 6573 2f64 7261 7769 6e67 732e 0a20 2020  es/drawings..   
+00029680: 2020 2020 2064 7261 7769 6e67 5f74 7970       drawing_typ
+00029690: 6520 3d20 330a 0a20 2020 2020 2020 2028  e = 3..        (
+000296a0: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
+000296b0: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
+000296c0: 6c2c 0a20 2020 2020 2020 2020 2020 2078  l,.            x
+000296d0: 5f6f 6666 7365 742c 0a20 2020 2020 2020  _offset,.       
+000296e0: 2020 2020 2079 5f6f 6666 7365 742c 0a20       y_offset,. 
+000296f0: 2020 2020 2020 2020 2020 2078 5f73 6361             x_sca
+00029700: 6c65 2c0a 2020 2020 2020 2020 2020 2020  le,.            
+00029710: 795f 7363 616c 652c 0a20 2020 2020 2020  y_scale,.       
+00029720: 2020 2020 2074 6578 742c 0a20 2020 2020       text,.     
+00029730: 2020 2020 2020 2061 6e63 686f 722c 0a20         anchor,. 
+00029740: 2020 2020 2020 2020 2020 206f 7074 696f             optio
+00029750: 6e73 2c0a 2020 2020 2020 2020 2020 2020  ns,.            
+00029760: 6465 7363 7269 7074 696f 6e2c 0a20 2020  description,.   
+00029770: 2020 2020 2020 2020 2064 6563 6f72 6174           decorat
+00029780: 6976 652c 0a20 2020 2020 2020 2029 203d  ive,.        ) =
+00029790: 2073 656c 662e 7368 6170 6573 5b69 6e64   self.shapes[ind
+000297a0: 6578 5d0a 0a20 2020 2020 2020 2077 6964  ex]..        wid
+000297b0: 7468 203d 206f 7074 696f 6e73 2e67 6574  th = options.get
+000297c0: 2822 7769 6474 6822 2c20 7365 6c66 2e64  ("width", self.d
+000297d0: 6566 6175 6c74 5f63 6f6c 5f70 6978 656c  efault_col_pixel
+000297e0: 7320 2a20 3329 0a20 2020 2020 2020 2068  s * 3).        h
+000297f0: 6569 6768 7420 3d20 6f70 7469 6f6e 732e  eight = options.
+00029800: 6765 7428 2268 6569 6768 7422 2c20 7365  get("height", se
+00029810: 6c66 2e64 6566 6175 6c74 5f72 6f77 5f70  lf.default_row_p
+00029820: 6978 656c 7320 2a20 3629 0a0a 2020 2020  ixels * 6)..    
+00029830: 2020 2020 7769 6474 6820 2a3d 2078 5f73      width *= x_s
+00029840: 6361 6c65 0a20 2020 2020 2020 2068 6569  cale.        hei
+00029850: 6768 7420 2a3d 2079 5f73 6361 6c65 0a0a  ght *= y_scale..
+00029860: 2020 2020 2020 2020 6469 6d65 6e73 696f          dimensio
+00029870: 6e73 203d 2073 656c 662e 5f70 6f73 6974  ns = self._posit
+00029880: 696f 6e5f 6f62 6a65 6374 5f65 6d75 7328  ion_object_emus(
+00029890: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+000298a0: 2c20 726f 772c 2078 5f6f 6666 7365 742c  , row, x_offset,
+000298b0: 2079 5f6f 6666 7365 742c 2077 6964 7468   y_offset, width
+000298c0: 2c20 6865 6967 6874 2c20 616e 6368 6f72  , height, anchor
+000298d0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+000298e0: 2020 2020 2320 436f 6e76 6572 7420 6672      # Convert fr
+000298f0: 6f6d 2070 6978 656c 7320 746f 2065 6d75  om pixels to emu
+00029900: 732e 0a20 2020 2020 2020 2077 6964 7468  s..        width
+00029910: 203d 2069 6e74 2830 2e35 202b 2028 7769   = int(0.5 + (wi
+00029920: 6474 6820 2a20 3935 3235 2929 0a20 2020  dth * 9525)).   
+00029930: 2020 2020 2068 6569 6768 7420 3d20 696e       height = in
+00029940: 7428 302e 3520 2b20 2868 6569 6768 7420  t(0.5 + (height 
+00029950: 2a20 3935 3235 2929 0a0a 2020 2020 2020  * 9525))..      
+00029960: 2020 2320 4372 6561 7465 2061 2044 7261    # Create a Dra
+00029970: 7769 6e67 206f 626a 2074 6f20 7573 6520  wing obj to use 
+00029980: 7769 7468 2077 6f72 6b73 6865 6574 2075  with worksheet u
+00029990: 6e6c 6573 7320 6f6e 6520 616c 7265 6164  nless one alread
+000299a0: 7920 6578 6973 7473 2e0a 2020 2020 2020  y exists..      
+000299b0: 2020 6966 206e 6f74 2073 656c 662e 6472    if not self.dr
+000299c0: 6177 696e 673a 0a20 2020 2020 2020 2020  awing:.         
+000299d0: 2020 2064 7261 7769 6e67 203d 2044 7261     drawing = Dra
+000299e0: 7769 6e67 2829 0a20 2020 2020 2020 2020  wing().         
+000299f0: 2020 2064 7261 7769 6e67 2e65 6d62 6564     drawing.embed
+00029a00: 6465 6420 3d20 310a 2020 2020 2020 2020  ded = 1.        
+00029a10: 2020 2020 7365 6c66 2e64 7261 7769 6e67      self.drawing
+00029a20: 203d 2064 7261 7769 6e67 0a0a 2020 2020   = drawing..    
+00029a30: 2020 2020 2020 2020 7365 6c66 2e65 7874          self.ext
+00029a40: 6572 6e61 6c5f 6472 6177 696e 675f 6c69  ernal_drawing_li
+00029a50: 6e6b 732e 6170 7065 6e64 280a 2020 2020  nks.append(.    
+00029a60: 2020 2020 2020 2020 2020 2020 5b22 2f64              ["/d
+00029a70: 7261 7769 6e67 222c 2022 2e2e 2f64 7261  rawing", "../dra
+00029a80: 7769 6e67 732f 6472 6177 696e 6722 202b  wings/drawing" +
+00029a90: 2073 7472 2864 7261 7769 6e67 5f69 6429   str(drawing_id)
+00029aa0: 202b 2022 2e78 6d6c 222c 204e 6f6e 655d   + ".xml", None]
+00029ab0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00029ac0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00029ad0: 2020 2020 2020 2020 2064 7261 7769 6e67           drawing
+00029ae0: 203d 2073 656c 662e 6472 6177 696e 670a   = self.drawing.
+00029af0: 0a20 2020 2020 2020 2073 6861 7065 203d  .        shape =
+00029b00: 2053 6861 7065 2822 7265 6374 222c 2022   Shape("rect", "
+00029b10: 5465 7874 426f 7822 2c20 6f70 7469 6f6e  TextBox", option
+00029b20: 7329 0a20 2020 2020 2020 2073 6861 7065  s).        shape
+00029b30: 2e74 6578 7420 3d20 7465 7874 0a0a 2020  .text = text..  
+00029b40: 2020 2020 2020 6472 6177 696e 675f 6f62        drawing_ob
+00029b50: 6a65 6374 203d 2064 7261 7769 6e67 2e5f  ject = drawing._
+00029b60: 6164 645f 6472 6177 696e 675f 6f62 6a65  add_drawing_obje
+00029b70: 6374 2829 0a20 2020 2020 2020 2064 7261  ct().        dra
+00029b80: 7769 6e67 5f6f 626a 6563 745b 2274 7970  wing_object["typ
+00029b90: 6522 5d20 3d20 6472 6177 696e 675f 7479  e"] = drawing_ty
+00029ba0: 7065 0a20 2020 2020 2020 2064 7261 7769  pe.        drawi
+00029bb0: 6e67 5f6f 626a 6563 745b 2264 696d 656e  ng_object["dimen
+00029bc0: 7369 6f6e 7322 5d20 3d20 6469 6d65 6e73  sions"] = dimens
+00029bd0: 696f 6e73 0a20 2020 2020 2020 2064 7261  ions.        dra
+00029be0: 7769 6e67 5f6f 626a 6563 745b 2277 6964  wing_object["wid
+00029bf0: 7468 225d 203d 2077 6964 7468 0a20 2020  th"] = width.   
+00029c00: 2020 2020 2064 7261 7769 6e67 5f6f 626a       drawing_obj
+00029c10: 6563 745b 2268 6569 6768 7422 5d20 3d20  ect["height"] = 
+00029c20: 6865 6967 6874 0a20 2020 2020 2020 2064  height.        d
+00029c30: 7261 7769 6e67 5f6f 626a 6563 745b 2264  rawing_object["d
+00029c40: 6573 6372 6970 7469 6f6e 225d 203d 2064  escription"] = d
+00029c50: 6573 6372 6970 7469 6f6e 0a20 2020 2020  escription.     
+00029c60: 2020 2064 7261 7769 6e67 5f6f 626a 6563     drawing_objec
+00029c70: 745b 2273 6861 7065 225d 203d 2073 6861  t["shape"] = sha
+00029c80: 7065 0a20 2020 2020 2020 2064 7261 7769  pe.        drawi
+00029c90: 6e67 5f6f 626a 6563 745b 2261 6e63 686f  ng_object["ancho
+00029ca0: 7222 5d20 3d20 616e 6368 6f72 0a20 2020  r"] = anchor.   
+00029cb0: 2020 2020 2064 7261 7769 6e67 5f6f 626a       drawing_obj
+00029cc0: 6563 745b 2272 656c 5f69 6e64 6578 225d  ect["rel_index"]
+00029cd0: 203d 2030 0a20 2020 2020 2020 2064 7261   = 0.        dra
+00029ce0: 7769 6e67 5f6f 626a 6563 745b 2275 726c  wing_object["url
+00029cf0: 5f72 656c 5f69 6e64 6578 225d 203d 2030  _rel_index"] = 0
+00029d00: 0a20 2020 2020 2020 2064 7261 7769 6e67  .        drawing
+00029d10: 5f6f 626a 6563 745b 2274 6970 225d 203d  _object["tip"] =
+00029d20: 206f 7074 696f 6e73 2e67 6574 2822 7469   options.get("ti
+00029d30: 7022 290a 2020 2020 2020 2020 6472 6177  p").        draw
+00029d40: 696e 675f 6f62 6a65 6374 5b22 6465 636f  ing_object["deco
+00029d50: 7261 7469 7665 225d 203d 2064 6563 6f72  rative"] = decor
+00029d60: 6174 6976 650a 0a20 2020 2020 2020 2075  ative..        u
+00029d70: 726c 203d 206f 7074 696f 6e73 2e67 6574  rl = options.get
+00029d80: 2822 7572 6c22 2c20 4e6f 6e65 290a 2020  ("url", None).  
+00029d90: 2020 2020 2020 6966 2075 726c 3a0a 2020        if url:.  
+00029da0: 2020 2020 2020 2020 2020 7461 7267 6574            target
+00029db0: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+00029dc0: 2020 2020 7265 6c5f 7479 7065 203d 2022      rel_type = "
+00029dd0: 2f68 7970 6572 6c69 6e6b 220a 2020 2020  /hyperlink".    
+00029de0: 2020 2020 2020 2020 7461 7267 6574 5f6d          target_m
+00029df0: 6f64 6520 3d20 2245 7874 6572 6e61 6c22  ode = "External"
+00029e00: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00029e10: 2072 652e 6d61 7463 6828 2228 6674 707c   re.match("(ftp|
+00029e20: 6874 7470 2973 3f3a 2f2f 222c 2075 726c  http)s?://", url
+00029e30: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00029e40: 2020 2074 6172 6765 7420 3d20 7365 6c66     target = self
+00029e50: 2e5f 6573 6361 7065 5f75 726c 2875 726c  ._escape_url(url
+00029e60: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
+00029e70: 6620 7265 2e6d 6174 6368 2822 5e6d 6169  f re.match("^mai
+00029e80: 6c74 6f3a 222c 2075 726c 293a 0a20 2020  lto:", url):.   
+00029e90: 2020 2020 2020 2020 2020 2020 2074 6172               tar
+00029ea0: 6765 7420 3d20 7365 6c66 2e5f 6573 6361  get = self._esca
+00029eb0: 7065 5f75 726c 2875 726c 290a 0a20 2020  pe_url(url)..   
+00029ec0: 2020 2020 2020 2020 2069 6620 7265 2e6d           if re.m
+00029ed0: 6174 6368 2822 6578 7465 726e 616c 3a22  atch("external:"
+00029ee0: 2c20 7572 6c29 3a0a 2020 2020 2020 2020  , url):.        
+00029ef0: 2020 2020 2020 2020 7461 7267 6574 203d          target =
+00029f00: 2075 726c 2e72 6570 6c61 6365 2822 6578   url.replace("ex
+00029f10: 7465 726e 616c 3a22 2c20 2266 696c 653a  ternal:", "file:
+00029f20: 2f2f 2f22 290a 2020 2020 2020 2020 2020  ///").          
+00029f30: 2020 2020 2020 7461 7267 6574 203d 2073        target = s
+00029f40: 656c 662e 5f65 7363 6170 655f 7572 6c28  elf._escape_url(
+00029f50: 7461 7267 6574 290a 2020 2020 2020 2020  target).        
+00029f60: 2020 2020 2020 2020 2320 4164 6469 7469          # Additi
+00029f70: 6f6e 616c 2065 7363 6170 6520 6e6f 7420  onal escape not 
+00029f80: 7265 7175 6972 6564 2069 6e20 776f 726b  required in work
+00029f90: 7368 6565 7420 6879 7065 726c 696e 6b73  sheet hyperlinks
+00029fa0: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00029fb0: 2020 7461 7267 6574 203d 2074 6172 6765    target = targe
+00029fc0: 742e 7265 706c 6163 6528 2223 222c 2022  t.replace("#", "
+00029fd0: 2532 3322 290a 0a20 2020 2020 2020 2020  %23")..         
+00029fe0: 2020 2069 6620 7265 2e6d 6174 6368 2822     if re.match("
+00029ff0: 696e 7465 726e 616c 3a22 2c20 7572 6c29  internal:", url)
+0002a000: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002a010: 2020 7461 7267 6574 203d 2075 726c 2e72    target = url.r
+0002a020: 6570 6c61 6365 2822 696e 7465 726e 616c  eplace("internal
+0002a030: 3a22 2c20 2223 2229 0a20 2020 2020 2020  :", "#").       
+0002a040: 2020 2020 2020 2020 2074 6172 6765 745f           target_
+0002a050: 6d6f 6465 203d 204e 6f6e 650a 0a20 2020  mode = None..   
+0002a060: 2020 2020 2020 2020 2069 6620 7461 7267           if targ
+0002a070: 6574 2069 7320 6e6f 7420 4e6f 6e65 3a0a  et is not None:.
+0002a080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a090: 6966 206c 656e 2874 6172 6765 7429 203e  if len(target) >
+0002a0a0: 2073 656c 662e 6d61 785f 7572 6c5f 6c65   self.max_url_le
+0002a0b0: 6e67 7468 3a0a 2020 2020 2020 2020 2020  ngth:.          
+0002a0c0: 2020 2020 2020 2020 2020 7761 726e 280a            warn(.
+0002a0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a0e0: 2020 2020 2020 2020 2249 676e 6f72 696e          "Ignorin
+0002a0f0: 6720 5552 4c20 2725 7327 2077 6974 6820  g URL '%s' with 
+0002a100: 6c69 6e6b 2061 6e64 2f6f 7220 616e 6368  link and/or anch
+0002a110: 6f72 203e 2025 6420 220a 2020 2020 2020  or > %d ".      
+0002a120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a130: 2020 2263 6861 7261 6374 6572 7320 7369    "characters si
+0002a140: 6e63 6520 6974 2065 7863 6565 6473 2045  nce it exceeds E
+0002a150: 7863 656c 2773 206c 696d 6974 2066 6f72  xcel's limit for
+0002a160: 2055 524c 5322 0a20 2020 2020 2020 2020   URLS".         
+0002a170: 2020 2020 2020 2020 2020 2020 2020 2025                 %
+0002a180: 2028 7572 6c2c 2073 656c 662e 6d61 785f   (url, self.max_
+0002a190: 7572 6c5f 6c65 6e67 7468 290a 2020 2020  url_length).    
+0002a1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a1b0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0002a1c0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0002a1d0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+0002a1e0: 6f74 2073 656c 662e 6472 6177 696e 675f  ot self.drawing_
+0002a1f0: 7265 6c73 2e67 6574 2875 726c 293a 0a20  rels.get(url):. 
+0002a200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a210: 2020 2020 2020 2073 656c 662e 6472 6177         self.draw
+0002a220: 696e 675f 6c69 6e6b 732e 6170 7065 6e64  ing_links.append
+0002a230: 285b 7265 6c5f 7479 7065 2c20 7461 7267  ([rel_type, targ
+0002a240: 6574 2c20 7461 7267 6574 5f6d 6f64 655d  et, target_mode]
+0002a250: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+0002a260: 2020 2020 2020 2064 7261 7769 6e67 5f6f         drawing_o
+0002a270: 626a 6563 745b 2275 726c 5f72 656c 5f69  bject["url_rel_i
+0002a280: 6e64 6578 225d 203d 2073 656c 662e 5f67  ndex"] = self._g
+0002a290: 6574 5f64 7261 7769 6e67 5f72 656c 5f69  et_drawing_rel_i
+0002a2a0: 6e64 6578 2875 726c 290a 0a20 2020 2064  ndex(url)..    d
+0002a2b0: 6566 205f 7072 6570 6172 655f 6865 6164  ef _prepare_head
+0002a2c0: 6572 5f69 6d61 6765 280a 2020 2020 2020  er_image(.      
+0002a2d0: 2020 7365 6c66 2c20 696d 6167 655f 6964    self, image_id
+0002a2e0: 2c20 7769 6474 682c 2068 6569 6768 742c  , width, height,
+0002a2f0: 206e 616d 652c 2069 6d61 6765 5f74 7970   name, image_typ
+0002a300: 652c 2070 6f73 6974 696f 6e2c 2078 5f64  e, position, x_d
+0002a310: 7069 2c20 795f 6470 692c 2064 6967 6573  pi, y_dpi, diges
+0002a320: 740a 2020 2020 293a 0a20 2020 2020 2020  t.    ):.       
+0002a330: 2023 2053 6574 2075 7020 616e 2069 6d61   # Set up an ima
+0002a340: 6765 2077 6974 686f 7574 2061 2064 7261  ge without a dra
+0002a350: 7769 6e67 206f 626a 6563 7420 666f 7220  wing object for 
+0002a360: 6865 6164 6572 2f66 6f6f 7465 7220 696d  header/footer im
+0002a370: 6167 6573 2e0a 0a20 2020 2020 2020 2023  ages...        #
+0002a380: 2053 7472 6970 2074 6865 2065 7874 656e   Strip the exten
+0002a390: 7369 6f6e 2066 726f 6d20 7468 6520 6669  sion from the fi
+0002a3a0: 6c65 6e61 6d65 2e0a 2020 2020 2020 2020  lename..        
+0002a3b0: 6e61 6d65 203d 2072 652e 7375 6228 7222  name = re.sub(r"
+0002a3c0: 5c2e 2e2a 2422 2c20 2222 2c20 6e61 6d65  \..*$", "", name
+0002a3d0: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
+0002a3e0: 7420 7365 6c66 2e76 6d6c 5f64 7261 7769  t self.vml_drawi
+0002a3f0: 6e67 5f72 656c 732e 6765 7428 6469 6765  ng_rels.get(dige
+0002a400: 7374 293a 0a20 2020 2020 2020 2020 2020  st):.           
+0002a410: 2073 656c 662e 766d 6c5f 6472 6177 696e   self.vml_drawin
+0002a420: 675f 6c69 6e6b 732e 6170 7065 6e64 280a  g_links.append(.
 0002a430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a450: 2020 7461 7267 6574 5f6d 6f64 655d 290a    target_mode]).
-0002a460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a470: 2020 2020 2064 7261 7769 6e67 5f6f 626a       drawing_obj
-0002a480: 6563 745b 2775 726c 5f72 656c 5f69 6e64  ect['url_rel_ind
-0002a490: 6578 275d 203d 205c 0a20 2020 2020 2020  ex'] = \.       
-0002a4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a4b0: 2073 656c 662e 5f67 6574 5f64 7261 7769   self._get_drawi
-0002a4c0: 6e67 5f72 656c 5f69 6e64 6578 2875 726c  ng_rel_index(url
-0002a4d0: 290a 0a20 2020 2064 6566 205f 7072 6570  )..    def _prep
-0002a4e0: 6172 655f 6865 6164 6572 5f69 6d61 6765  are_header_image
-0002a4f0: 2873 656c 662c 2069 6d61 6765 5f69 642c  (self, image_id,
-0002a500: 2077 6964 7468 2c20 6865 6967 6874 2c20   width, height, 
-0002a510: 6e61 6d65 2c20 696d 6167 655f 7479 7065  name, image_type
-0002a520: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002a530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a540: 706f 7369 7469 6f6e 2c20 785f 6470 692c  position, x_dpi,
-0002a550: 2079 5f64 7069 2c20 6469 6765 7374 293a   y_dpi, digest):
-0002a560: 0a0a 2020 2020 2020 2020 2320 5365 7420  ..        # Set 
-0002a570: 7570 2061 6e20 696d 6167 6520 7769 7468  up an image with
-0002a580: 6f75 7420 6120 6472 6177 696e 6720 6f62  out a drawing ob
-0002a590: 6a65 6374 2066 6f72 2068 6561 6465 722f  ject for header/
-0002a5a0: 666f 6f74 6572 2069 6d61 6765 732e 0a0a  footer images...
-0002a5b0: 2020 2020 2020 2020 2320 5374 7269 7020          # Strip 
-0002a5c0: 7468 6520 6578 7465 6e73 696f 6e20 6672  the extension fr
-0002a5d0: 6f6d 2074 6865 2066 696c 656e 616d 652e  om the filename.
-0002a5e0: 0a20 2020 2020 2020 206e 616d 6520 3d20  .        name = 
-0002a5f0: 7265 2e73 7562 2872 275c 2e2e 2a24 272c  re.sub(r'\..*$',
-0002a600: 2027 272c 206e 616d 6529 0a0a 2020 2020   '', name)..    
-0002a610: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
-0002a620: 766d 6c5f 6472 6177 696e 675f 7265 6c73  vml_drawing_rels
-0002a630: 2e67 6574 2864 6967 6573 7429 3a0a 2020  .get(digest):.  
-0002a640: 2020 2020 2020 2020 2020 7365 6c66 2e76            self.v
-0002a650: 6d6c 5f64 7261 7769 6e67 5f6c 696e 6b73  ml_drawing_links
-0002a660: 2e61 7070 656e 6428 5b27 2f69 6d61 6765  .append(['/image
-0002a670: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-0002a680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a690: 2020 2020 2020 2020 2020 2020 2020 272e                '.
-0002a6a0: 2e2f 6d65 6469 612f 696d 6167 6527 0a20  ./media/image'. 
-0002a6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a6d0: 2020 2020 2020 2020 2020 2b20 7374 7228            + str(
-0002a6e0: 696d 6167 655f 6964 2920 2b20 272e 270a  image_id) + '.'.
-0002a6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a710: 2020 2020 2020 2020 2020 202b 2069 6d61             + ima
-0002a720: 6765 5f74 7970 655d 290a 0a20 2020 2020  ge_type])..     
-0002a730: 2020 2072 6566 5f69 6420 3d20 7365 6c66     ref_id = self
-0002a740: 2e5f 6765 745f 766d 6c5f 6472 6177 696e  ._get_vml_drawin
-0002a750: 675f 7265 6c5f 696e 6465 7828 6469 6765  g_rel_index(dige
-0002a760: 7374 290a 0a20 2020 2020 2020 2073 656c  st)..        sel
-0002a770: 662e 6865 6164 6572 5f69 6d61 6765 735f  f.header_images_
-0002a780: 6c69 7374 2e61 7070 656e 6428 5b77 6964  list.append([wid
-0002a790: 7468 2c20 6865 6967 6874 2c20 6e61 6d65  th, height, name
-0002a7a0: 2c20 706f 7369 7469 6f6e 2c0a 2020 2020  , position,.    
-0002a7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a7d0: 2020 2020 785f 6470 692c 2079 5f64 7069      x_dpi, y_dpi
-0002a7e0: 2c20 7265 665f 6964 5d29 0a0a 2020 2020  , ref_id])..    
-0002a7f0: 6465 6620 5f70 7265 7061 7265 5f62 6163  def _prepare_bac
-0002a800: 6b67 726f 756e 6428 7365 6c66 2c20 696d  kground(self, im
-0002a810: 6167 655f 6964 2c20 696d 6167 655f 7479  age_id, image_ty
-0002a820: 7065 293a 0a20 2020 2020 2020 2023 2053  pe):.        # S
-0002a830: 6574 2075 7020 616e 2069 6d61 6765 2077  et up an image w
-0002a840: 6974 686f 7574 2061 2064 7261 7769 6e67  ithout a drawing
-0002a850: 206f 626a 6563 7420 666f 7220 6261 636b   object for back
-0002a860: 6772 6f75 6e64 732e 0a20 2020 2020 2020  grounds..       
-0002a870: 2073 656c 662e 6578 7465 726e 616c 5f62   self.external_b
-0002a880: 6163 6b67 726f 756e 645f 6c69 6e6b 732e  ackground_links.
-0002a890: 6170 7065 6e64 285b 272f 696d 6167 6527  append(['/image'
-0002a8a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002a8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a8d0: 2027 2e2e 2f6d 6564 6961 2f69 6d61 6765   '../media/image
-0002a8e0: 270a 2020 2020 2020 2020 2020 2020 2020  '.              
-0002a8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a910: 202b 2073 7472 2869 6d61 6765 5f69 6429   + str(image_id)
-0002a920: 202b 2027 2e27 0a20 2020 2020 2020 2020   + '.'.         
-0002a930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a950: 2020 2020 2020 2b20 696d 6167 655f 7479        + image_ty
-0002a960: 7065 5d29 0a0a 2020 2020 6465 6620 5f70  pe])..    def _p
-0002a970: 7265 7061 7265 5f63 6861 7274 2873 656c  repare_chart(sel
-0002a980: 662c 2069 6e64 6578 2c20 6368 6172 745f  f, index, chart_
-0002a990: 6964 2c20 6472 6177 696e 675f 6964 293a  id, drawing_id):
-0002a9a0: 0a20 2020 2020 2020 2023 2053 6574 2075  .        # Set u
-0002a9b0: 7020 6368 6172 742f 6472 6177 696e 6773  p chart/drawings
-0002a9c0: 2e0a 2020 2020 2020 2020 6472 6177 696e  ..        drawin
-0002a9d0: 675f 7479 7065 203d 2031 0a0a 2020 2020  g_type = 1..    
-0002a9e0: 2020 2020 2872 6f77 2c20 636f 6c2c 2063      (row, col, c
-0002a9f0: 6861 7274 2c20 785f 6f66 6673 6574 2c20  hart, x_offset, 
-0002aa00: 795f 6f66 6673 6574 2c20 785f 7363 616c  y_offset, x_scal
-0002aa10: 652c 2079 5f73 6361 6c65 2c20 616e 6368  e, y_scale, anch
-0002aa20: 6f72 2c0a 2020 2020 2020 2020 2064 6573  or,.         des
-0002aa30: 6372 6970 7469 6f6e 2c20 6465 636f 7261  cription, decora
-0002aa40: 7469 7665 2920 3d20 7365 6c66 2e63 6861  tive) = self.cha
-0002aa50: 7274 735b 696e 6465 785d 0a0a 2020 2020  rts[index]..    
-0002aa60: 2020 2020 6368 6172 742e 6964 203d 2063      chart.id = c
-0002aa70: 6861 7274 5f69 6420 2d20 310a 0a20 2020  hart_id - 1..   
-0002aa80: 2020 2020 2023 2055 7365 2075 7365 7220       # Use user 
-0002aa90: 7370 6563 6966 6965 6420 6469 6d65 6e73  specified dimens
-0002aaa0: 696f 6e73 2c20 6966 2061 6e79 2e0a 2020  ions, if any..  
-0002aab0: 2020 2020 2020 7769 6474 6820 3d20 696e        width = in
-0002aac0: 7428 302e 3520 2b20 2863 6861 7274 2e77  t(0.5 + (chart.w
-0002aad0: 6964 7468 202a 2078 5f73 6361 6c65 2929  idth * x_scale))
-0002aae0: 0a20 2020 2020 2020 2068 6569 6768 7420  .        height 
-0002aaf0: 3d20 696e 7428 302e 3520 2b20 2863 6861  = int(0.5 + (cha
-0002ab00: 7274 2e68 6569 6768 7420 2a20 795f 7363  rt.height * y_sc
-0002ab10: 616c 6529 290a 0a20 2020 2020 2020 2064  ale))..        d
-0002ab20: 696d 656e 7369 6f6e 7320 3d20 7365 6c66  imensions = self
-0002ab30: 2e5f 706f 7369 7469 6f6e 5f6f 626a 6563  ._position_objec
-0002ab40: 745f 656d 7573 2863 6f6c 2c20 726f 772c  t_emus(col, row,
-0002ab50: 2078 5f6f 6666 7365 742c 2079 5f6f 6666   x_offset, y_off
-0002ab60: 7365 742c 0a20 2020 2020 2020 2020 2020  set,.           
-0002ab70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ab80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ab90: 2020 2020 2077 6964 7468 2c20 6865 6967       width, heig
-0002aba0: 6874 2c20 616e 6368 6f72 290a 0a20 2020  ht, anchor)..   
-0002abb0: 2020 2020 2023 2053 6574 2074 6865 2063       # Set the c
-0002abc0: 6861 7274 206e 616d 6520 666f 7220 7468  hart name for th
-0002abd0: 6520 656d 6265 6464 6564 206f 626a 6563  e embedded objec
-0002abe0: 7420 6966 2069 7420 6861 7320 6265 656e  t if it has been
-0002abf0: 2073 7065 6369 6669 6564 2e0a 2020 2020   specified..    
-0002ac00: 2020 2020 6e61 6d65 203d 2063 6861 7274      name = chart
-0002ac10: 2e63 6861 7274 5f6e 616d 650a 0a20 2020  .chart_name..   
-0002ac20: 2020 2020 2023 2043 7265 6174 6520 6120       # Create a 
-0002ac30: 4472 6177 696e 6720 6f62 6a20 746f 2075  Drawing obj to u
-0002ac40: 7365 2077 6974 6820 776f 726b 7368 6565  se with workshee
-0002ac50: 7420 756e 6c65 7373 206f 6e65 2061 6c72  t unless one alr
-0002ac60: 6561 6479 2065 7869 7374 732e 0a20 2020  eady exists..   
-0002ac70: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
-0002ac80: 2e64 7261 7769 6e67 3a0a 2020 2020 2020  .drawing:.      
-0002ac90: 2020 2020 2020 6472 6177 696e 6720 3d20        drawing = 
-0002aca0: 4472 6177 696e 6728 290a 2020 2020 2020  Drawing().      
-0002acb0: 2020 2020 2020 6472 6177 696e 672e 656d        drawing.em
-0002acc0: 6265 6464 6564 203d 2031 0a20 2020 2020  bedded = 1.     
-0002acd0: 2020 2020 2020 2073 656c 662e 6472 6177         self.draw
-0002ace0: 696e 6720 3d20 6472 6177 696e 670a 0a20  ing = drawing.. 
-0002acf0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0002ad00: 6578 7465 726e 616c 5f64 7261 7769 6e67  external_drawing
-0002ad10: 5f6c 696e 6b73 2e61 7070 656e 6428 5b27  _links.append(['
-0002ad20: 2f64 7261 7769 6e67 272c 0a20 2020 2020  /drawing',.     
-0002ad30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ad40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ad50: 2020 2020 2020 2020 2020 2027 2e2e 2f64             '../d
-0002ad60: 7261 7769 6e67 732f 6472 6177 696e 6727  rawings/drawing'
-0002ad70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ad80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ad90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ada0: 202b 2073 7472 2864 7261 7769 6e67 5f69   + str(drawing_i
-0002adb0: 6429 0a20 2020 2020 2020 2020 2020 2020  d).             
-0002adc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002add0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ade0: 2020 202b 2027 2e78 6d6c 275d 290a 2020     + '.xml']).  
-0002adf0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0002ae00: 2020 2020 2020 2020 6472 6177 696e 6720          drawing 
-0002ae10: 3d20 7365 6c66 2e64 7261 7769 6e67 0a0a  = self.drawing..
-0002ae20: 2020 2020 2020 2020 6472 6177 696e 675f          drawing_
-0002ae30: 6f62 6a65 6374 203d 2064 7261 7769 6e67  object = drawing
-0002ae40: 2e5f 6164 645f 6472 6177 696e 675f 6f62  ._add_drawing_ob
-0002ae50: 6a65 6374 2829 0a20 2020 2020 2020 2064  ject().        d
-0002ae60: 7261 7769 6e67 5f6f 626a 6563 745b 2774  rawing_object['t
-0002ae70: 7970 6527 5d20 3d20 6472 6177 696e 675f  ype'] = drawing_
-0002ae80: 7479 7065 0a20 2020 2020 2020 2064 7261  type.        dra
-0002ae90: 7769 6e67 5f6f 626a 6563 745b 2764 696d  wing_object['dim
-0002aea0: 656e 7369 6f6e 7327 5d20 3d20 6469 6d65  ensions'] = dime
-0002aeb0: 6e73 696f 6e73 0a20 2020 2020 2020 2064  nsions.        d
-0002aec0: 7261 7769 6e67 5f6f 626a 6563 745b 2777  rawing_object['w
-0002aed0: 6964 7468 275d 203d 2077 6964 7468 0a20  idth'] = width. 
-0002aee0: 2020 2020 2020 2064 7261 7769 6e67 5f6f         drawing_o
-0002aef0: 626a 6563 745b 2768 6569 6768 7427 5d20  bject['height'] 
-0002af00: 3d20 6865 6967 6874 0a20 2020 2020 2020  = height.       
-0002af10: 2064 7261 7769 6e67 5f6f 626a 6563 745b   drawing_object[
-0002af20: 276e 616d 6527 5d20 3d20 6e61 6d65 0a20  'name'] = name. 
-0002af30: 2020 2020 2020 2064 7261 7769 6e67 5f6f         drawing_o
-0002af40: 626a 6563 745b 2773 6861 7065 275d 203d  bject['shape'] =
-0002af50: 204e 6f6e 650a 2020 2020 2020 2020 6472   None.        dr
-0002af60: 6177 696e 675f 6f62 6a65 6374 5b27 616e  awing_object['an
-0002af70: 6368 6f72 275d 203d 2061 6e63 686f 720a  chor'] = anchor.
-0002af80: 2020 2020 2020 2020 6472 6177 696e 675f          drawing_
-0002af90: 6f62 6a65 6374 5b27 7265 6c5f 696e 6465  object['rel_inde
-0002afa0: 7827 5d20 3d20 7365 6c66 2e5f 6765 745f  x'] = self._get_
-0002afb0: 6472 6177 696e 675f 7265 6c5f 696e 6465  drawing_rel_inde
-0002afc0: 7828 290a 2020 2020 2020 2020 6472 6177  x().        draw
-0002afd0: 696e 675f 6f62 6a65 6374 5b27 7572 6c5f  ing_object['url_
-0002afe0: 7265 6c5f 696e 6465 7827 5d20 3d20 300a  rel_index'] = 0.
-0002aff0: 2020 2020 2020 2020 6472 6177 696e 675f          drawing_
-0002b000: 6f62 6a65 6374 5b27 7469 7027 5d20 3d20  object['tip'] = 
-0002b010: 4e6f 6e65 0a20 2020 2020 2020 2064 7261  None.        dra
-0002b020: 7769 6e67 5f6f 626a 6563 745b 2764 6573  wing_object['des
-0002b030: 6372 6970 7469 6f6e 275d 203d 2064 6573  cription'] = des
-0002b040: 6372 6970 7469 6f6e 0a20 2020 2020 2020  cription.       
-0002b050: 2064 7261 7769 6e67 5f6f 626a 6563 745b   drawing_object[
-0002b060: 2764 6563 6f72 6174 6976 6527 5d20 3d20  'decorative'] = 
-0002b070: 6465 636f 7261 7469 7665 0a0a 2020 2020  decorative..    
-0002b080: 2020 2020 7365 6c66 2e64 7261 7769 6e67      self.drawing
-0002b090: 5f6c 696e 6b73 2e61 7070 656e 6428 5b27  _links.append(['
-0002b0a0: 2f63 6861 7274 272c 0a20 2020 2020 2020  /chart',.       
-0002b0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b0c0: 2020 2020 2020 2020 2020 2020 272e 2e2f              '../
-0002b0d0: 6368 6172 7473 2f63 6861 7274 270a 2020  charts/chart'.  
-0002b0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b100: 202b 2073 7472 2863 6861 7274 5f69 6429   + str(chart_id)
-0002b110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002b120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b130: 2020 2020 2b20 272e 786d 6c27 5d29 0a0a      + '.xml'])..
-0002b140: 2020 2020 6465 6620 5f70 6f73 6974 696f      def _positio
-0002b150: 6e5f 6f62 6a65 6374 5f65 6d75 7328 7365  n_object_emus(se
-0002b160: 6c66 2c20 636f 6c5f 7374 6172 742c 2072  lf, col_start, r
-0002b170: 6f77 5f73 7461 7274 2c20 7831 2c20 7931  ow_start, x1, y1
-0002b180: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002b190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b1a0: 7769 6474 682c 2068 6569 6768 742c 2061  width, height, a
-0002b1b0: 6e63 686f 7229 3a0a 2020 2020 2020 2020  nchor):.        
-0002b1c0: 2320 4361 6c63 756c 6174 6520 7468 6520  # Calculate the 
-0002b1d0: 7665 7274 6963 6573 2074 6861 7420 6465  vertices that de
-0002b1e0: 6669 6e65 2074 6865 2070 6f73 6974 696f  fine the positio
-0002b1f0: 6e20 6f66 2061 2067 7261 7068 6963 616c  n of a graphical
-0002b200: 0a20 2020 2020 2020 2023 206f 626a 6563  .        # objec
-0002b210: 7420 7769 7468 696e 2074 6865 2077 6f72  t within the wor
-0002b220: 6b73 6865 6574 2069 6e20 454d 5573 2e0a  ksheet in EMUs..
-0002b230: 2020 2020 2020 2020 230a 2020 2020 2020          #.      
-0002b240: 2020 2320 5468 6520 7665 7274 6963 6573    # The vertices
-0002b250: 2061 7265 2065 7870 7265 7373 6564 2061   are expressed a
-0002b260: 7320 456e 676c 6973 6820 4d65 7472 6963  s English Metric
-0002b270: 2055 6e69 7473 2028 454d 5573 292e 2054   Units (EMUs). T
-0002b280: 6865 7265 2061 7265 0a20 2020 2020 2020  here are.       
-0002b290: 2023 2031 322c 3730 3020 454d 5573 2070   # 12,700 EMUs p
-0002b2a0: 6572 2070 6f69 6e74 2e20 5468 6572 6566  er point. Theref
-0002b2b0: 6f72 652c 2031 322c 3730 3020 2a20 3320  ore, 12,700 * 3 
-0002b2c0: 2f34 203d 2039 2c35 3235 2045 4d55 7320  /4 = 9,525 EMUs 
-0002b2d0: 7065 720a 2020 2020 2020 2020 2320 7069  per.        # pi
-0002b2e0: 7865 6c0a 2020 2020 2020 2020 2863 6f6c  xel.        (col
-0002b2f0: 5f73 7461 7274 2c20 726f 775f 7374 6172  _start, row_star
-0002b300: 742c 2078 312c 2079 312c 0a20 2020 2020  t, x1, y1,.     
-0002b310: 2020 2020 636f 6c5f 656e 642c 2072 6f77      col_end, row
-0002b320: 5f65 6e64 2c20 7832 2c20 7932 2c20 785f  _end, x2, y2, x_
-0002b330: 6162 732c 2079 5f61 6273 2920 3d20 5c0a  abs, y_abs) = \.
-0002b340: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0002b350: 2e5f 706f 7369 7469 6f6e 5f6f 626a 6563  ._position_objec
-0002b360: 745f 7069 7865 6c73 2863 6f6c 5f73 7461  t_pixels(col_sta
-0002b370: 7274 2c20 726f 775f 7374 6172 742c 2078  rt, row_start, x
-0002b380: 312c 2079 312c 0a20 2020 2020 2020 2020  1, y1,.         
-0002b390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b3b0: 7769 6474 682c 2068 6569 6768 742c 2061  width, height, a
-0002b3c0: 6e63 686f 7229 0a0a 2020 2020 2020 2020  nchor)..        
-0002b3d0: 2320 436f 6e76 6572 7420 7468 6520 7069  # Convert the pi
-0002b3e0: 7865 6c20 7661 6c75 6573 2074 6f20 454d  xel values to EM
-0002b3f0: 5573 2e20 5365 6520 6162 6f76 652e 0a20  Us. See above.. 
-0002b400: 2020 2020 2020 2078 3120 3d20 696e 7428         x1 = int(
-0002b410: 302e 3520 2b20 3935 3235 202a 2078 3129  0.5 + 9525 * x1)
-0002b420: 0a20 2020 2020 2020 2079 3120 3d20 696e  .        y1 = in
-0002b430: 7428 302e 3520 2b20 3935 3235 202a 2079  t(0.5 + 9525 * y
-0002b440: 3129 0a20 2020 2020 2020 2078 3220 3d20  1).        x2 = 
-0002b450: 696e 7428 302e 3520 2b20 3935 3235 202a  int(0.5 + 9525 *
-0002b460: 2078 3229 0a20 2020 2020 2020 2079 3220   x2).        y2 
-0002b470: 3d20 696e 7428 302e 3520 2b20 3935 3235  = int(0.5 + 9525
-0002b480: 202a 2079 3229 0a20 2020 2020 2020 2078   * y2).        x
-0002b490: 5f61 6273 203d 2069 6e74 2830 2e35 202b  _abs = int(0.5 +
-0002b4a0: 2039 3532 3520 2a20 785f 6162 7329 0a20   9525 * x_abs). 
-0002b4b0: 2020 2020 2020 2079 5f61 6273 203d 2069         y_abs = i
-0002b4c0: 6e74 2830 2e35 202b 2039 3532 3520 2a20  nt(0.5 + 9525 * 
-0002b4d0: 795f 6162 7329 0a0a 2020 2020 2020 2020  y_abs)..        
-0002b4e0: 7265 7475 726e 2028 636f 6c5f 7374 6172  return (col_star
-0002b4f0: 742c 2072 6f77 5f73 7461 7274 2c20 7831  t, row_start, x1
-0002b500: 2c20 7931 2c20 636f 6c5f 656e 642c 2072  , y1, col_end, r
-0002b510: 6f77 5f65 6e64 2c20 7832 2c20 7932 2c0a  ow_end, x2, y2,.
-0002b520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b530: 785f 6162 732c 2079 5f61 6273 290a 0a20  x_abs, y_abs).. 
-0002b540: 2020 2023 2043 616c 6375 6c61 7465 2074     # Calculate t
-0002b550: 6865 2076 6572 7469 6365 7320 7468 6174  he vertices that
-0002b560: 2064 6566 696e 6520 7468 6520 706f 7369   define the posi
-0002b570: 7469 6f6e 206f 6620 6120 6772 6170 6869  tion of a graphi
-0002b580: 6361 6c20 6f62 6a65 6374 0a20 2020 2023  cal object.    #
-0002b590: 2077 6974 6869 6e20 7468 6520 776f 726b   within the work
-0002b5a0: 7368 6565 7420 696e 2070 6978 656c 732e  sheet in pixels.
-0002b5b0: 0a20 2020 2023 0a20 2020 2023 2020 2020  .    #.    #    
-0002b5c0: 2020 2020 202b 2d2d 2d2d 2d2d 2d2d 2d2d       +----------
-0002b5d0: 2d2d 2b2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2b  --+------------+
-0002b5e0: 0a20 2020 2023 2020 2020 2020 2020 207c  .    #         |
-0002b5f0: 2020 2020 2041 2020 2020 2020 7c20 2020       A      |   
-0002b600: 2020 2042 2020 2020 207c 0a20 2020 2023     B     |.    #
-0002b610: 2020 202b 2d2d 2d2d 2d2b 2d2d 2d2d 2d2d     +-----+------
-0002b620: 2d2d 2d2d 2d2d 2b2d 2d2d 2d2d 2d2d 2d2d  ------+---------
-0002b630: 2d2d 2d2b 0a20 2020 2023 2020 207c 2020  ---+.    #   |  
-0002b640: 2020 207c 2878 312c 7931 2920 2020 2020     |(x1,y1)     
-0002b650: 7c20 2020 2020 2020 2020 2020 207c 0a20  |            |. 
-0002b660: 2020 2023 2020 207c 2020 3120 207c 2841     #   |  1  |(A
-0002b670: 3129 2e5f 5f5f 5f5f 5f5f 7c5f 5f5f 5f5f  1)._______|_____
-0002b680: 5f20 2020 2020 207c 0a20 2020 2023 2020  _      |.    #  
-0002b690: 207c 2020 2020 207c 2020 2020 7c20 2020   |     |    |   
-0002b6a0: 2020 2020 2020 2020 2020 207c 2020 2020             |    
-0002b6b0: 207c 0a20 2020 2023 2020 207c 2020 2020   |.    #   |    
-0002b6c0: 207c 2020 2020 7c20 2020 2020 2020 2020   |    |         
-0002b6d0: 2020 2020 207c 2020 2020 207c 0a20 2020       |     |.   
-0002b6e0: 2023 2020 202b 2d2d 2d2d 2d2b 2d2d 2d2d   #   +-----+----
-0002b6f0: 7c20 2020 204f 424a 4543 5420 2020 207c  |    OBJECT    |
-0002b700: 2d2d 2d2d 2d2b 0a20 2020 2023 2020 207c  -----+.    #   |
-0002b710: 2020 2020 207c 2020 2020 7c20 2020 2020       |    |     
-0002b720: 2020 2020 2020 2020 207c 2020 2020 207c           |     |
-0002b730: 0a20 2020 2023 2020 207c 2020 3220 207c  .    #   |  2  |
-0002b740: 2020 2020 7c5f 5f5f 5f5f 5f5f 5f5f 5f5f      |___________
-0002b750: 5f5f 5f2e 2020 2020 207c 0a20 2020 2023  ___.     |.    #
-0002b760: 2020 207c 2020 2020 207c 2020 2020 2020     |     |      
-0002b770: 2020 2020 2020 7c20 2020 2020 2020 2028        |        (
-0002b780: 4232 297c 0a20 2020 2023 2020 207c 2020  B2)|.    #   |  
-0002b790: 2020 207c 2020 2020 2020 2020 2020 2020     |            
-0002b7a0: 7c20 2020 2020 2878 322c 7932 297c 0a20  |     (x2,y2)|. 
-0002b7b0: 2020 2023 2020 202b 2d2d 2d2d 202b 2d2d     #   +---- +--
-0002b7c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2b2d 2d2d 2d2d  ----------+-----
-0002b7d0: 2d2d 2d2d 2d2d 2d2b 0a20 2020 2023 0a20  -------+.    #. 
-0002b7e0: 2020 2023 2045 7861 6d70 6c65 206f 6620     # Example of 
-0002b7f0: 616e 206f 626a 6563 7420 7468 6174 2063  an object that c
-0002b800: 6f76 6572 7320 736f 6d65 206f 6620 7468  overs some of th
-0002b810: 6520 6172 6561 2066 726f 6d20 6365 6c6c  e area from cell
-0002b820: 2041 3120 746f 2020 4232 2e0a 2020 2020   A1 to  B2..    
-0002b830: 230a 2020 2020 2320 4261 7365 6420 6f6e  #.    # Based on
-0002b840: 2074 6865 2077 6964 7468 2061 6e64 2068   the width and h
-0002b850: 6569 6768 7420 6f66 2074 6865 206f 626a  eight of the obj
-0002b860: 6563 7420 7765 206e 6565 6420 746f 2063  ect we need to c
-0002b870: 616c 6375 6c61 7465 2038 2076 6172 733a  alculate 8 vars:
-0002b880: 0a20 2020 2023 0a20 2020 2023 2020 2020  .    #.    #    
-0002b890: 2063 6f6c 5f73 7461 7274 2c20 726f 775f   col_start, row_
-0002b8a0: 7374 6172 742c 2063 6f6c 5f65 6e64 2c20  start, col_end, 
-0002b8b0: 726f 775f 656e 642c 2078 312c 2079 312c  row_end, x1, y1,
-0002b8c0: 2078 322c 2079 322e 0a20 2020 2023 0a20   x2, y2..    #. 
-0002b8d0: 2020 2023 2057 6520 616c 736f 2063 616c     # We also cal
-0002b8e0: 6375 6c61 7465 2074 6865 2061 6273 6f6c  culate the absol
-0002b8f0: 7574 6520 7820 616e 6420 7920 706f 7369  ute x and y posi
-0002b900: 7469 6f6e 206f 6620 7468 6520 746f 7020  tion of the top 
-0002b910: 6c65 6674 2076 6572 7465 7820 6f66 0a20  left vertex of. 
-0002b920: 2020 2023 2074 6865 206f 626a 6563 742e     # the object.
-0002b930: 2054 6869 7320 6973 2072 6571 7569 7265   This is require
-0002b940: 6420 666f 7220 696d 6167 6573 2e0a 2020  d for images..  
-0002b950: 2020 230a 2020 2020 2320 5468 6520 7769    #.    # The wi
-0002b960: 6474 6820 616e 6420 6865 6967 6874 206f  dth and height o
-0002b970: 6620 7468 6520 6365 6c6c 7320 7468 6174  f the cells that
-0002b980: 2074 6865 206f 626a 6563 7420 6f63 6375   the object occu
-0002b990: 7069 6573 2063 616e 2062 650a 2020 2020  pies can be.    
-0002b9a0: 2320 7661 7269 6162 6c65 2061 6e64 2068  # variable and h
-0002b9b0: 6176 6520 746f 2062 6520 7461 6b65 6e20  ave to be taken 
-0002b9c0: 696e 746f 2061 6363 6f75 6e74 2e0a 2020  into account..  
-0002b9d0: 2020 230a 2020 2020 2320 5468 6520 7661    #.    # The va
-0002b9e0: 6c75 6573 206f 6620 636f 6c5f 7374 6172  lues of col_star
-0002b9f0: 7420 616e 6420 726f 775f 7374 6172 7420  t and row_start 
-0002ba00: 6172 6520 7061 7373 6564 2069 6e20 6672  are passed in fr
-0002ba10: 6f6d 2074 6865 2063 616c 6c69 6e67 0a20  om the calling. 
-0002ba20: 2020 2023 2066 756e 6374 696f 6e2e 2054     # function. T
-0002ba30: 6865 2076 616c 7565 7320 6f66 2063 6f6c  he values of col
-0002ba40: 5f65 6e64 2061 6e64 2072 6f77 5f65 6e64  _end and row_end
-0002ba50: 2061 7265 2063 616c 6375 6c61 7465 6420   are calculated 
-0002ba60: 6279 0a20 2020 2023 2073 7562 7472 6163  by.    # subtrac
-0002ba70: 7469 6e67 2074 6865 2077 6964 7468 2061  ting the width a
-0002ba80: 6e64 2068 6569 6768 7420 6f66 2074 6865  nd height of the
-0002ba90: 206f 626a 6563 7420 6672 6f6d 2074 6865   object from the
-0002baa0: 2077 6964 7468 2061 6e64 0a20 2020 2023   width and.    #
-0002bab0: 2068 6569 6768 7420 6f66 2074 6865 2075   height of the u
-0002bac0: 6e64 6572 6c79 696e 6720 6365 6c6c 732e  nderlying cells.
-0002bad0: 0a20 2020 2023 0a20 2020 2064 6566 205f  .    #.    def _
-0002bae0: 706f 7369 7469 6f6e 5f6f 626a 6563 745f  position_object_
-0002baf0: 7069 7865 6c73 2873 656c 662c 2063 6f6c  pixels(self, col
-0002bb00: 5f73 7461 7274 2c20 726f 775f 7374 6172  _start, row_star
-0002bb10: 742c 2078 312c 2079 312c 0a20 2020 2020  t, x1, y1,.     
-0002bb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bb30: 2020 2020 2020 2020 2020 2077 6964 7468             width
-0002bb40: 2c20 6865 6967 6874 2c20 616e 6368 6f72  , height, anchor
-0002bb50: 293a 0a20 2020 2020 2020 2023 2063 6f6c  ):.        # col
-0002bb60: 5f73 7461 7274 2020 2020 2020 2023 2043  _start       # C
-0002bb70: 6f6c 2063 6f6e 7461 696e 696e 6720 7570  ol containing up
-0002bb80: 7065 7220 6c65 6674 2063 6f72 6e65 7220  per left corner 
-0002bb90: 6f66 206f 626a 6563 742e 0a20 2020 2020  of object..     
-0002bba0: 2020 2023 2078 3120 2020 2020 2020 2020     # x1         
-0002bbb0: 2020 2020 2023 2044 6973 7461 6e63 6520       # Distance 
-0002bbc0: 746f 206c 6566 7420 7369 6465 206f 6620  to left side of 
-0002bbd0: 6f62 6a65 6374 2e0a 2020 2020 2020 2020  object..        
-0002bbe0: 230a 2020 2020 2020 2020 2320 726f 775f  #.        # row_
-0002bbf0: 7374 6172 7420 2020 2020 2020 2320 526f  start       # Ro
-0002bc00: 7720 636f 6e74 6169 6e69 6e67 2074 6f70  w containing top
-0002bc10: 206c 6566 7420 636f 726e 6572 206f 6620   left corner of 
-0002bc20: 6f62 6a65 6374 2e0a 2020 2020 2020 2020  object..        
-0002bc30: 2320 7931 2020 2020 2020 2020 2020 2020  # y1            
-0002bc40: 2020 2320 4469 7374 616e 6365 2074 6f20    # Distance to 
-0002bc50: 746f 7020 6f66 206f 626a 6563 742e 0a20  top of object.. 
-0002bc60: 2020 2020 2020 2023 0a20 2020 2020 2020         #.       
-0002bc70: 2023 2063 6f6c 5f65 6e64 2020 2020 2020   # col_end      
-0002bc80: 2020 2023 2043 6f6c 2063 6f6e 7461 696e     # Col contain
-0002bc90: 696e 6720 6c6f 7765 7220 7269 6768 7420  ing lower right 
-0002bca0: 636f 726e 6572 206f 6620 6f62 6a65 6374  corner of object
-0002bcb0: 2e0a 2020 2020 2020 2020 2320 7832 2020  ..        # x2  
-0002bcc0: 2020 2020 2020 2020 2020 2020 2320 4469              # Di
-0002bcd0: 7374 616e 6365 2074 6f20 7269 6768 7420  stance to right 
-0002bce0: 7369 6465 206f 6620 6f62 6a65 6374 2e0a  side of object..
-0002bcf0: 2020 2020 2020 2020 230a 2020 2020 2020          #.      
-0002bd00: 2020 2320 726f 775f 656e 6420 2020 2020    # row_end     
-0002bd10: 2020 2020 2320 526f 7720 636f 6e74 6169      # Row contai
-0002bd20: 6e69 6e67 2062 6f74 746f 6d20 7269 6768  ning bottom righ
-0002bd30: 7420 636f 726e 6572 206f 6620 6f62 6a65  t corner of obje
-0002bd40: 6374 2e0a 2020 2020 2020 2020 2320 7932  ct..        # y2
-0002bd50: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0002bd60: 4469 7374 616e 6365 2074 6f20 626f 7474  Distance to bott
-0002bd70: 6f6d 206f 6620 6f62 6a65 6374 2e0a 2020  om of object..  
-0002bd80: 2020 2020 2020 230a 2020 2020 2020 2020        #.        
-0002bd90: 2320 7769 6474 6820 2020 2020 2020 2020  # width         
-0002bda0: 2020 2320 5769 6474 6820 6f66 206f 626a    # Width of obj
-0002bdb0: 6563 7420 6672 616d 652e 0a20 2020 2020  ect frame..     
-0002bdc0: 2020 2023 2068 6569 6768 7420 2020 2020     # height     
-0002bdd0: 2020 2020 2023 2048 6569 6768 7420 6f66       # Height of
-0002bde0: 206f 626a 6563 7420 6672 616d 652e 0a20   object frame.. 
-0002bdf0: 2020 2020 2020 2023 0a20 2020 2020 2020         #.       
-0002be00: 2023 2078 5f61 6273 2020 2020 2020 2020   # x_abs        
-0002be10: 2020 2023 2041 6273 6f6c 7574 6520 6469     # Absolute di
-0002be20: 7374 616e 6365 2074 6f20 6c65 6674 2073  stance to left s
-0002be30: 6964 6520 6f66 206f 626a 6563 742e 0a20  ide of object.. 
-0002be40: 2020 2020 2020 2023 2079 5f61 6273 2020         # y_abs  
-0002be50: 2020 2020 2020 2020 2023 2041 6273 6f6c           # Absol
-0002be60: 7574 6520 6469 7374 616e 6365 2074 6f20  ute distance to 
-0002be70: 746f 7020 7369 6465 206f 6620 6f62 6a65  top side of obje
-0002be80: 6374 2e0a 2020 2020 2020 2020 785f 6162  ct..        x_ab
-0002be90: 7320 3d20 300a 2020 2020 2020 2020 795f  s = 0.        y_
-0002bea0: 6162 7320 3d20 300a 0a20 2020 2020 2020  abs = 0..       
-0002beb0: 2023 2041 646a 7573 7420 7374 6172 7420   # Adjust start 
-0002bec0: 636f 6c75 6d6e 2066 6f72 206e 6567 6174  column for negat
-0002bed0: 6976 6520 6f66 6673 6574 732e 0a20 2020  ive offsets..   
-0002bee0: 2020 2020 2077 6869 6c65 2078 3120 3c20       while x1 < 
-0002bef0: 3020 616e 6420 636f 6c5f 7374 6172 7420  0 and col_start 
-0002bf00: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
-0002bf10: 2078 3120 2b3d 2073 656c 662e 5f73 697a   x1 += self._siz
-0002bf20: 655f 636f 6c28 636f 6c5f 7374 6172 7420  e_col(col_start 
-0002bf30: 2d20 3129 0a20 2020 2020 2020 2020 2020  - 1).           
-0002bf40: 2063 6f6c 5f73 7461 7274 202d 3d20 310a   col_start -= 1.
-0002bf50: 0a20 2020 2020 2020 2023 2041 646a 7573  .        # Adjus
-0002bf60: 7420 7374 6172 7420 726f 7720 666f 7220  t start row for 
-0002bf70: 6e65 6761 7469 7665 206f 6666 7365 7473  negative offsets
-0002bf80: 2e0a 2020 2020 2020 2020 7768 696c 6520  ..        while 
-0002bf90: 7931 203c 2030 2061 6e64 2072 6f77 5f73  y1 < 0 and row_s
-0002bfa0: 7461 7274 203e 2030 3a0a 2020 2020 2020  tart > 0:.      
-0002bfb0: 2020 2020 2020 7931 202b 3d20 7365 6c66        y1 += self
-0002bfc0: 2e5f 7369 7a65 5f72 6f77 2872 6f77 5f73  ._size_row(row_s
-0002bfd0: 7461 7274 202d 2031 290a 2020 2020 2020  tart - 1).      
-0002bfe0: 2020 2020 2020 726f 775f 7374 6172 7420        row_start 
-0002bff0: 2d3d 2031 0a0a 2020 2020 2020 2020 2320  -= 1..        # 
-0002c000: 456e 7375 7265 2074 6861 7420 7468 6520  Ensure that the 
-0002c010: 696d 6167 6520 6973 6e27 7420 7368 6966  image isn't shif
-0002c020: 7465 6420 6f66 6620 7468 6520 7061 6765  ted off the page
-0002c030: 2061 7420 746f 7020 6c65 6674 2e0a 2020   at top left..  
-0002c040: 2020 2020 2020 6966 2078 3120 3c20 303a        if x1 < 0:
-0002c050: 0a20 2020 2020 2020 2020 2020 2078 3120  .            x1 
-0002c060: 3d20 300a 0a20 2020 2020 2020 2069 6620  = 0..        if 
-0002c070: 7931 203c 2030 3a0a 2020 2020 2020 2020  y1 < 0:.        
-0002c080: 2020 2020 7931 203d 2030 0a0a 2020 2020      y1 = 0..    
-0002c090: 2020 2020 2320 4361 6c63 756c 6174 6520      # Calculate 
-0002c0a0: 7468 6520 6162 736f 6c75 7465 2078 206f  the absolute x o
-0002c0b0: 6666 7365 7420 6f66 2074 6865 2074 6f70  ffset of the top
-0002c0c0: 2d6c 6566 7420 7665 7274 6578 2e0a 2020  -left vertex..  
-0002c0d0: 2020 2020 2020 6966 2073 656c 662e 636f        if self.co
-0002c0e0: 6c5f 7369 7a65 5f63 6861 6e67 6564 3a0a  l_size_changed:.
-0002c0f0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0002c100: 636f 6c5f 6964 2069 6e20 7261 6e67 6528  col_id in range(
-0002c110: 636f 6c5f 7374 6172 7429 3a0a 2020 2020  col_start):.    
-0002c120: 2020 2020 2020 2020 2020 2020 785f 6162              x_ab
-0002c130: 7320 2b3d 2073 656c 662e 5f73 697a 655f  s += self._size_
-0002c140: 636f 6c28 636f 6c5f 6964 290a 2020 2020  col(col_id).    
-0002c150: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0002c160: 2020 2020 2020 2320 4f70 7469 6d69 7a61        # Optimiza
-0002c170: 7469 6f6e 2066 6f72 2077 6865 6e20 7468  tion for when th
-0002c180: 6520 636f 6c75 6d6e 2077 6964 7468 7320  e column widths 
-0002c190: 6861 7665 6e27 7420 6368 616e 6765 642e  haven't changed.
-0002c1a0: 0a20 2020 2020 2020 2020 2020 2078 5f61  .            x_a
-0002c1b0: 6273 202b 3d20 7365 6c66 2e64 6566 6175  bs += self.defau
-0002c1c0: 6c74 5f63 6f6c 5f70 6978 656c 7320 2a20  lt_col_pixels * 
-0002c1d0: 636f 6c5f 7374 6172 740a 0a20 2020 2020  col_start..     
-0002c1e0: 2020 2078 5f61 6273 202b 3d20 7831 0a0a     x_abs += x1..
-0002c1f0: 2020 2020 2020 2020 2320 4361 6c63 756c          # Calcul
-0002c200: 6174 6520 7468 6520 6162 736f 6c75 7465  ate the absolute
-0002c210: 2079 206f 6666 7365 7420 6f66 2074 6865   y offset of the
-0002c220: 2074 6f70 2d6c 6566 7420 7665 7274 6578   top-left vertex
-0002c230: 2e0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-0002c240: 662e 726f 775f 7369 7a65 5f63 6861 6e67  f.row_size_chang
-0002c250: 6564 3a0a 2020 2020 2020 2020 2020 2020  ed:.            
-0002c260: 666f 7220 726f 775f 6964 2069 6e20 7261  for row_id in ra
-0002c270: 6e67 6528 726f 775f 7374 6172 7429 3a0a  nge(row_start):.
-0002c280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c290: 795f 6162 7320 2b3d 2073 656c 662e 5f73  y_abs += self._s
-0002c2a0: 697a 655f 726f 7728 726f 775f 6964 290a  ize_row(row_id).
-0002c2b0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0002c2c0: 2020 2020 2020 2020 2020 2320 4f70 7469            # Opti
-0002c2d0: 6d69 7a61 7469 6f6e 2066 6f72 2077 6865  mization for whe
-0002c2e0: 6e20 7468 6520 726f 7720 6865 6967 6874  n the row height
-0002c2f0: 7320 6861 7665 6e27 7420 6368 616e 6765  s haven't change
-0002c300: 642e 0a20 2020 2020 2020 2020 2020 2079  d..            y
-0002c310: 5f61 6273 202b 3d20 7365 6c66 2e64 6566  _abs += self.def
-0002c320: 6175 6c74 5f72 6f77 5f70 6978 656c 7320  ault_row_pixels 
-0002c330: 2a20 726f 775f 7374 6172 740a 0a20 2020  * row_start..   
-0002c340: 2020 2020 2079 5f61 6273 202b 3d20 7931       y_abs += y1
-0002c350: 0a0a 2020 2020 2020 2020 2320 4164 6a75  ..        # Adju
-0002c360: 7374 2073 7461 7274 2063 6f6c 756d 6e20  st start column 
-0002c370: 666f 7220 6f66 6673 6574 7320 7468 6174  for offsets that
-0002c380: 2061 7265 2067 7265 6174 6572 2074 6861   are greater tha
-0002c390: 6e20 7468 6520 636f 6c20 7769 6474 682e  n the col width.
-0002c3a0: 0a20 2020 2020 2020 2077 6869 6c65 2078  .        while x
-0002c3b0: 3120 3e3d 2073 656c 662e 5f73 697a 655f  1 >= self._size_
-0002c3c0: 636f 6c28 636f 6c5f 7374 6172 742c 2061  col(col_start, a
-0002c3d0: 6e63 686f 7229 3a0a 2020 2020 2020 2020  nchor):.        
-0002c3e0: 2020 2020 7831 202d 3d20 7365 6c66 2e5f      x1 -= self._
-0002c3f0: 7369 7a65 5f63 6f6c 2863 6f6c 5f73 7461  size_col(col_sta
-0002c400: 7274 290a 2020 2020 2020 2020 2020 2020  rt).            
-0002c410: 636f 6c5f 7374 6172 7420 2b3d 2031 0a0a  col_start += 1..
-0002c420: 2020 2020 2020 2020 2320 4164 6a75 7374          # Adjust
-0002c430: 2073 7461 7274 2072 6f77 2066 6f72 206f   start row for o
-0002c440: 6666 7365 7473 2074 6861 7420 6172 6520  ffsets that are 
-0002c450: 6772 6561 7465 7220 7468 616e 2074 6865  greater than the
-0002c460: 2072 6f77 2068 6569 6768 742e 0a20 2020   row height..   
-0002c470: 2020 2020 2077 6869 6c65 2079 3120 3e3d       while y1 >=
-0002c480: 2073 656c 662e 5f73 697a 655f 726f 7728   self._size_row(
-0002c490: 726f 775f 7374 6172 742c 2061 6e63 686f  row_start, ancho
-0002c4a0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-0002c4b0: 7931 202d 3d20 7365 6c66 2e5f 7369 7a65  y1 -= self._size
-0002c4c0: 5f72 6f77 2872 6f77 5f73 7461 7274 290a  _row(row_start).
-0002c4d0: 2020 2020 2020 2020 2020 2020 726f 775f              row_
-0002c4e0: 7374 6172 7420 2b3d 2031 0a0a 2020 2020  start += 1..    
-0002c4f0: 2020 2020 2320 496e 6974 6961 6c69 7a65      # Initialize
-0002c500: 2065 6e64 2063 656c 6c20 746f 2074 6865   end cell to the
-0002c510: 2073 616d 6520 6173 2074 6865 2073 7461   same as the sta
-0002c520: 7274 2063 656c 6c2e 0a20 2020 2020 2020  rt cell..       
-0002c530: 2063 6f6c 5f65 6e64 203d 2063 6f6c 5f73   col_end = col_s
-0002c540: 7461 7274 0a20 2020 2020 2020 2072 6f77  tart.        row
-0002c550: 5f65 6e64 203d 2072 6f77 5f73 7461 7274  _end = row_start
-0002c560: 0a0a 2020 2020 2020 2020 2320 446f 6e27  ..        # Don'
-0002c570: 7420 6f66 6673 6574 2074 6865 2069 6d61  t offset the ima
-0002c580: 6765 2069 6e20 7468 6520 6365 6c6c 2069  ge in the cell i
-0002c590: 6620 7468 6520 726f 772f 636f 6c20 6973  f the row/col is
-0002c5a0: 2068 6964 6465 6e2e 0a20 2020 2020 2020   hidden..       
-0002c5b0: 2069 6620 7365 6c66 2e5f 7369 7a65 5f63   if self._size_c
-0002c5c0: 6f6c 2863 6f6c 5f73 7461 7274 2c20 616e  ol(col_start, an
-0002c5d0: 6368 6f72 2920 3e20 303a 0a20 2020 2020  chor) > 0:.     
-0002c5e0: 2020 2020 2020 2077 6964 7468 203d 2077         width = w
-0002c5f0: 6964 7468 202b 2078 310a 2020 2020 2020  idth + x1.      
-0002c600: 2020 6966 2073 656c 662e 5f73 697a 655f    if self._size_
-0002c610: 726f 7728 726f 775f 7374 6172 742c 2061  row(row_start, a
-0002c620: 6e63 686f 7229 203e 2030 3a0a 2020 2020  nchor) > 0:.    
-0002c630: 2020 2020 2020 2020 6865 6967 6874 203d          height =
-0002c640: 2068 6569 6768 7420 2b20 7931 0a0a 2020   height + y1..  
-0002c650: 2020 2020 2020 2320 5375 6274 7261 6374        # Subtract
-0002c660: 2074 6865 2075 6e64 6572 6c79 696e 6720   the underlying 
-0002c670: 6365 6c6c 2077 6964 7468 7320 746f 2066  cell widths to f
-0002c680: 696e 6420 656e 6420 6365 6c6c 206f 6620  ind end cell of 
-0002c690: 7468 6520 6f62 6a65 6374 2e0a 2020 2020  the object..    
-0002c6a0: 2020 2020 7768 696c 6520 7769 6474 6820      while width 
-0002c6b0: 3e3d 2073 656c 662e 5f73 697a 655f 636f  >= self._size_co
-0002c6c0: 6c28 636f 6c5f 656e 642c 2061 6e63 686f  l(col_end, ancho
-0002c6d0: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-0002c6e0: 7769 6474 6820 2d3d 2073 656c 662e 5f73  width -= self._s
-0002c6f0: 697a 655f 636f 6c28 636f 6c5f 656e 642c  ize_col(col_end,
-0002c700: 2061 6e63 686f 7229 0a20 2020 2020 2020   anchor).       
-0002c710: 2020 2020 2063 6f6c 5f65 6e64 202b 3d20       col_end += 
-0002c720: 310a 0a20 2020 2020 2020 2023 2053 7562  1..        # Sub
-0002c730: 7472 6163 7420 7468 6520 756e 6465 726c  tract the underl
-0002c740: 7969 6e67 2063 656c 6c20 6865 6967 6874  ying cell height
-0002c750: 7320 746f 2066 696e 6420 656e 6420 6365  s to find end ce
-0002c760: 6c6c 206f 6620 7468 6520 6f62 6a65 6374  ll of the object
-0002c770: 2e0a 2020 2020 2020 2020 7768 696c 6520  ..        while 
-0002c780: 6865 6967 6874 203e 3d20 7365 6c66 2e5f  height >= self._
-0002c790: 7369 7a65 5f72 6f77 2872 6f77 5f65 6e64  size_row(row_end
-0002c7a0: 2c20 616e 6368 6f72 293a 0a20 2020 2020  , anchor):.     
-0002c7b0: 2020 2020 2020 2068 6569 6768 7420 2d3d         height -=
-0002c7c0: 2073 656c 662e 5f73 697a 655f 726f 7728   self._size_row(
-0002c7d0: 726f 775f 656e 642c 2061 6e63 686f 7229  row_end, anchor)
-0002c7e0: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
-0002c7f0: 5f65 6e64 202b 3d20 310a 0a20 2020 2020  _end += 1..     
-0002c800: 2020 2023 2054 6865 2065 6e64 2076 6572     # The end ver
-0002c810: 7469 6365 7320 6172 6520 7768 6174 6576  tices are whatev
-0002c820: 6572 2069 7320 6c65 6674 2066 726f 6d20  er is left from 
-0002c830: 7468 6520 7769 6474 6820 616e 6420 6865  the width and he
-0002c840: 6967 6874 2e0a 2020 2020 2020 2020 7832  ight..        x2
-0002c850: 203d 2077 6964 7468 0a20 2020 2020 2020   = width.       
-0002c860: 2079 3220 3d20 6865 6967 6874 0a0a 2020   y2 = height..  
-0002c870: 2020 2020 2020 7265 7475 726e 2028 5b63        return ([c
-0002c880: 6f6c 5f73 7461 7274 2c20 726f 775f 7374  ol_start, row_st
-0002c890: 6172 742c 2078 312c 2079 312c 2063 6f6c  art, x1, y1, col
-0002c8a0: 5f65 6e64 2c20 726f 775f 656e 642c 2078  _end, row_end, x
-0002c8b0: 322c 2079 322c 0a20 2020 2020 2020 2020  2, y2,.         
-0002c8c0: 2020 2020 2020 2078 5f61 6273 2c20 795f         x_abs, y_
-0002c8d0: 6162 735d 290a 0a20 2020 2064 6566 205f  abs])..    def _
-0002c8e0: 7369 7a65 5f63 6f6c 2873 656c 662c 2063  size_col(self, c
-0002c8f0: 6f6c 2c20 616e 6368 6f72 3d30 293a 0a20  ol, anchor=0):. 
-0002c900: 2020 2020 2020 2023 2043 6f6e 7665 7274         # Convert
-0002c910: 2074 6865 2077 6964 7468 206f 6620 6120   the width of a 
-0002c920: 6365 6c6c 2066 726f 6d20 6368 6172 6163  cell from charac
-0002c930: 7465 7220 756e 6974 7320 746f 2070 6978  ter units to pix
-0002c940: 656c 732e 2045 7863 656c 0a20 2020 2020  els. Excel.     
-0002c950: 2020 2023 2072 6f75 6e64 7320 7468 6520     # rounds the 
-0002c960: 636f 6c75 6d6e 2077 6964 7468 2074 6f20  column width to 
-0002c970: 7468 6520 6e65 6172 6573 7420 7069 7865  the nearest pixe
-0002c980: 6c2e 2049 6620 7468 6520 7769 6474 6820  l. If the width 
-0002c990: 6861 736e 2774 0a20 2020 2020 2020 2023  hasn't.        #
-0002c9a0: 2062 6565 6e20 7365 7420 6279 2074 6865   been set by the
-0002c9b0: 2075 7365 7220 7765 2075 7365 2074 6865   user we use the
-0002c9c0: 2064 6566 6175 6c74 2076 616c 7565 2e20   default value. 
-0002c9d0: 4120 6869 6464 656e 2063 6f6c 756d 6e20  A hidden column 
-0002c9e0: 6973 0a20 2020 2020 2020 2023 2074 7265  is.        # tre
-0002c9f0: 6174 6564 2061 7320 6861 7669 6e67 2061  ated as having a
-0002ca00: 2077 6964 7468 206f 6620 7a65 726f 2075   width of zero u
-0002ca10: 6e6c 6573 7320 6974 2068 6173 2074 6865  nless it has the
-0002ca20: 2073 7065 6369 616c 0a20 2020 2020 2020   special.       
-0002ca30: 2023 2022 6f62 6a65 6374 5f70 6f73 6974   # "object_posit
-0002ca40: 696f 6e22 206f 6620 3420 2873 697a 6520  ion" of 4 (size 
-0002ca50: 7769 7468 2063 656c 6c73 292e 0a20 2020  with cells)..   
-0002ca60: 2020 2020 206d 6178 5f64 6967 6974 5f77       max_digit_w
-0002ca70: 6964 7468 203d 2037 2020 2320 466f 7220  idth = 7  # For 
-0002ca80: 4361 6c69 6272 6920 3131 2e0a 2020 2020  Calibri 11..    
-0002ca90: 2020 2020 7061 6464 696e 6720 3d20 350a      padding = 5.
-0002caa0: 2020 2020 2020 2020 7069 7865 6c73 203d          pixels =
-0002cab0: 2030 0a0a 2020 2020 2020 2020 2320 4c6f   0..        # Lo
-0002cac0: 6f6b 2075 7020 7468 6520 6365 6c6c 2076  ok up the cell v
-0002cad0: 616c 7565 2074 6f20 7365 6520 6966 2069  alue to see if i
-0002cae0: 7420 6861 7320 6265 656e 2063 6861 6e67  t has been chang
-0002caf0: 6564 2e0a 2020 2020 2020 2020 6966 2063  ed..        if c
-0002cb00: 6f6c 2069 6e20 7365 6c66 2e63 6f6c 5f69  ol in self.col_i
-0002cb10: 6e66 6f3a 0a20 2020 2020 2020 2020 2020  nfo:.           
-0002cb20: 2077 6964 7468 203d 2073 656c 662e 636f   width = self.co
-0002cb30: 6c5f 696e 666f 5b63 6f6c 5d5b 305d 0a20  l_info[col][0]. 
-0002cb40: 2020 2020 2020 2020 2020 2068 6964 6465             hidde
-0002cb50: 6e20 3d20 7365 6c66 2e63 6f6c 5f69 6e66  n = self.col_inf
-0002cb60: 6f5b 636f 6c5d 5b32 5d0a 0a20 2020 2020  o[col][2]..     
-0002cb70: 2020 2020 2020 2069 6620 7769 6474 6820         if width 
-0002cb80: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-0002cb90: 2020 2020 2020 2020 2077 6964 7468 203d           width =
-0002cba0: 2073 656c 662e 6465 6661 756c 745f 636f   self.default_co
-0002cbb0: 6c5f 7769 6474 680a 0a20 2020 2020 2020  l_width..       
-0002cbc0: 2020 2020 2023 2043 6f6e 7665 7274 2074       # Convert t
-0002cbd0: 6f20 7069 7865 6c73 2e0a 2020 2020 2020  o pixels..      
-0002cbe0: 2020 2020 2020 6966 2068 6964 6465 6e20        if hidden 
-0002cbf0: 616e 6420 616e 6368 6f72 2021 3d20 343a  and anchor != 4:
-0002cc00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002cc10: 2070 6978 656c 7320 3d20 300a 2020 2020   pixels = 0.    
-0002cc20: 2020 2020 2020 2020 656c 6966 2077 6964          elif wid
-0002cc30: 7468 203c 2031 3a0a 2020 2020 2020 2020  th < 1:.        
-0002cc40: 2020 2020 2020 2020 7069 7865 6c73 203d          pixels =
-0002cc50: 2069 6e74 2877 6964 7468 202a 2028 6d61   int(width * (ma
-0002cc60: 785f 6469 6769 745f 7769 6474 6820 2b20  x_digit_width + 
-0002cc70: 7061 6464 696e 6729 202b 2030 2e35 290a  padding) + 0.5).
-0002cc80: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0002cc90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002cca0: 2020 7069 7865 6c73 203d 2069 6e74 2877    pixels = int(w
-0002ccb0: 6964 7468 202a 206d 6178 5f64 6967 6974  idth * max_digit
-0002ccc0: 5f77 6964 7468 202b 2030 2e35 2920 2b20  _width + 0.5) + 
-0002ccd0: 7061 6464 696e 670a 2020 2020 2020 2020  padding.        
-0002cce0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0002ccf0: 2020 7069 7865 6c73 203d 2073 656c 662e    pixels = self.
-0002cd00: 6465 6661 756c 745f 636f 6c5f 7069 7865  default_col_pixe
-0002cd10: 6c73 0a0a 2020 2020 2020 2020 7265 7475  ls..        retu
-0002cd20: 726e 2070 6978 656c 730a 0a20 2020 2064  rn pixels..    d
-0002cd30: 6566 205f 7369 7a65 5f72 6f77 2873 656c  ef _size_row(sel
-0002cd40: 662c 2072 6f77 2c20 616e 6368 6f72 3d30  f, row, anchor=0
-0002cd50: 293a 0a20 2020 2020 2020 2023 2043 6f6e  ):.        # Con
-0002cd60: 7665 7274 2074 6865 2068 6569 6768 7420  vert the height 
-0002cd70: 6f66 2061 2063 656c 6c20 6672 6f6d 2063  of a cell from c
-0002cd80: 6861 7261 6374 6572 2075 6e69 7473 2074  haracter units t
-0002cd90: 6f20 7069 7865 6c73 2e20 4966 2074 6865  o pixels. If the
-0002cda0: 0a20 2020 2020 2020 2023 2068 6569 6768  .        # heigh
-0002cdb0: 7420 6861 736e 2774 2062 6565 6e20 7365  t hasn't been se
-0002cdc0: 7420 6279 2074 6865 2075 7365 7220 7765  t by the user we
-0002cdd0: 2075 7365 2074 6865 2064 6566 6175 6c74   use the default
-0002cde0: 2076 616c 7565 2e20 410a 2020 2020 2020   value. A.      
-0002cdf0: 2020 2320 6869 6464 656e 2072 6f77 2069    # hidden row i
-0002ce00: 7320 7472 6561 7465 6420 6173 2068 6176  s treated as hav
-0002ce10: 696e 6720 6120 6865 6967 6874 206f 6620  ing a height of 
-0002ce20: 7a65 726f 2075 6e6c 6573 7320 6974 2068  zero unless it h
-0002ce30: 6173 2074 6865 0a20 2020 2020 2020 2023  as the.        #
-0002ce40: 2073 7065 6369 616c 2022 6f62 6a65 6374   special "object
-0002ce50: 5f70 6f73 6974 696f 6e22 206f 6620 3420  _position" of 4 
-0002ce60: 2873 697a 6520 7769 7468 2063 656c 6c73  (size with cells
-0002ce70: 292e 0a20 2020 2020 2020 2070 6978 656c  )..        pixel
-0002ce80: 7320 3d20 300a 0a20 2020 2020 2020 2023  s = 0..        #
-0002ce90: 204c 6f6f 6b20 7570 2074 6865 2063 656c   Look up the cel
-0002cea0: 6c20 7661 6c75 6520 746f 2073 6565 2069  l value to see i
-0002ceb0: 6620 6974 2068 6173 2062 6565 6e20 6368  f it has been ch
-0002cec0: 616e 6765 640a 2020 2020 2020 2020 6966  anged.        if
-0002ced0: 2072 6f77 2069 6e20 7365 6c66 2e72 6f77   row in self.row
-0002cee0: 5f73 697a 6573 3a0a 2020 2020 2020 2020  _sizes:.        
-0002cef0: 2020 2020 6865 6967 6874 203d 2073 656c      height = sel
-0002cf00: 662e 726f 775f 7369 7a65 735b 726f 775d  f.row_sizes[row]
-0002cf10: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
-0002cf20: 6869 6464 656e 203d 2073 656c 662e 726f  hidden = self.ro
-0002cf30: 775f 7369 7a65 735b 726f 775d 5b31 5d0a  w_sizes[row][1].
-0002cf40: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0002cf50: 6869 6464 656e 2061 6e64 2061 6e63 686f  hidden and ancho
-0002cf60: 7220 213d 2034 3a0a 2020 2020 2020 2020  r != 4:.        
-0002cf70: 2020 2020 2020 2020 7069 7865 6c73 203d          pixels =
-0002cf80: 2030 0a20 2020 2020 2020 2020 2020 2065   0.            e
-0002cf90: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0002cfa0: 2020 2020 2070 6978 656c 7320 3d20 696e       pixels = in
-0002cfb0: 7428 342e 3020 2f20 332e 3020 2a20 6865  t(4.0 / 3.0 * he
-0002cfc0: 6967 6874 290a 2020 2020 2020 2020 656c  ight).        el
-0002cfd0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0002cfe0: 7069 7865 6c73 203d 2069 6e74 2834 2e30  pixels = int(4.0
-0002cff0: 202f 2033 2e30 202a 2073 656c 662e 6465   / 3.0 * self.de
-0002d000: 6661 756c 745f 726f 775f 6865 6967 6874  fault_row_height
-0002d010: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-0002d020: 6e20 7069 7865 6c73 0a0a 2020 2020 6465  n pixels..    de
-0002d030: 6620 5f70 6978 656c 735f 746f 5f77 6964  f _pixels_to_wid
-0002d040: 7468 2873 656c 662c 2070 6978 656c 7329  th(self, pixels)
-0002d050: 3a0a 2020 2020 2020 2020 2320 436f 6e76  :.        # Conv
-0002d060: 6572 7420 7468 6520 7769 6474 6820 6f66  ert the width of
-0002d070: 2061 2063 656c 6c20 6672 6f6d 2070 6978   a cell from pix
-0002d080: 656c 7320 746f 2063 6861 7261 6374 6572  els to character
-0002d090: 2075 6e69 7473 2e0a 2020 2020 2020 2020   units..        
-0002d0a0: 6d61 785f 6469 6769 745f 7769 6474 6820  max_digit_width 
-0002d0b0: 3d20 372e 3020 2023 2046 6f72 2043 616c  = 7.0  # For Cal
-0002d0c0: 6162 7269 2031 312e 0a20 2020 2020 2020  abri 11..       
-0002d0d0: 2070 6164 6469 6e67 203d 2035 2e30 0a0a   padding = 5.0..
-0002d0e0: 2020 2020 2020 2020 6966 2070 6978 656c          if pixel
-0002d0f0: 7320 3c3d 2031 323a 0a20 2020 2020 2020  s <= 12:.       
-0002d100: 2020 2020 2077 6964 7468 203d 2070 6978       width = pix
-0002d110: 656c 7320 2f20 286d 6178 5f64 6967 6974  els / (max_digit
-0002d120: 5f77 6964 7468 202b 2070 6164 6469 6e67  _width + padding
-0002d130: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-0002d140: 2020 2020 2020 2020 2020 2020 7769 6474              widt
-0002d150: 6820 3d20 2870 6978 656c 7320 2d20 7061  h = (pixels - pa
-0002d160: 6464 696e 6729 202f 206d 6178 5f64 6967  dding) / max_dig
-0002d170: 6974 5f77 6964 7468 0a0a 2020 2020 2020  it_width..      
-0002d180: 2020 7265 7475 726e 2077 6964 7468 0a0a    return width..
-0002d190: 2020 2020 6465 6620 5f70 6978 656c 735f      def _pixels_
-0002d1a0: 746f 5f68 6569 6768 7428 7365 6c66 2c20  to_height(self, 
-0002d1b0: 7069 7865 6c73 293a 0a20 2020 2020 2020  pixels):.       
-0002d1c0: 2023 2043 6f6e 7665 7274 2074 6865 2068   # Convert the h
-0002d1d0: 6569 6768 7420 6f66 2061 2063 656c 6c20  eight of a cell 
-0002d1e0: 6672 6f6d 2070 6978 656c 7320 746f 2063  from pixels to c
-0002d1f0: 6861 7261 6374 6572 2075 6e69 7473 2e0a  haracter units..
-0002d200: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
-0002d210: 2e37 3520 2a20 7069 7865 6c73 0a0a 2020  .75 * pixels..  
-0002d220: 2020 6465 6620 5f63 6f6d 6d65 6e74 5f70    def _comment_p
-0002d230: 6172 616d 7328 7365 6c66 2c20 726f 772c  arams(self, row,
-0002d240: 2063 6f6c 2c20 7374 7269 6e67 2c20 6f70   col, string, op
-0002d250: 7469 6f6e 7329 3a0a 2020 2020 2020 2020  tions):.        
-0002d260: 2320 5468 6973 206d 6574 686f 6420 6861  # This method ha
-0002d270: 6e64 6c65 7320 7468 6520 6164 6469 7469  ndles the additi
-0002d280: 6f6e 616c 206f 7074 696f 6e61 6c20 7061  onal optional pa
-0002d290: 7261 6d65 7465 7273 2074 6f0a 2020 2020  rameters to.    
-0002d2a0: 2020 2020 2320 7772 6974 655f 636f 6d6d      # write_comm
-0002d2b0: 656e 7428 2920 6173 2077 656c 6c20 6173  ent() as well as
-0002d2c0: 2063 616c 6375 6c61 7469 6e67 2074 6865   calculating the
-0002d2d0: 2063 6f6d 6d65 6e74 206f 626a 6563 740a   comment object.
-0002d2e0: 2020 2020 2020 2020 2320 706f 7369 7469          # positi
-0002d2f0: 6f6e 2061 6e64 2076 6572 7469 6365 732e  on and vertices.
-0002d300: 0a20 2020 2020 2020 2064 6566 6175 6c74  .        default
-0002d310: 5f77 6964 7468 203d 2031 3238 0a20 2020  _width = 128.   
-0002d320: 2020 2020 2064 6566 6175 6c74 5f68 6569       default_hei
-0002d330: 6768 7420 3d20 3734 0a20 2020 2020 2020  ght = 74.       
-0002d340: 2061 6e63 686f 7220 3d20 300a 0a20 2020   anchor = 0..   
-0002d350: 2020 2020 2070 6172 616d 7320 3d20 7b0a       params = {.
-0002d360: 2020 2020 2020 2020 2020 2020 2761 7574              'aut
-0002d370: 686f 7227 3a20 4e6f 6e65 2c0a 2020 2020  hor': None,.    
-0002d380: 2020 2020 2020 2020 2763 6f6c 6f72 273a          'color':
-0002d390: 2027 2366 6666 6665 3127 2c0a 2020 2020   '#ffffe1',.    
-0002d3a0: 2020 2020 2020 2020 2773 7461 7274 5f63          'start_c
-0002d3b0: 656c 6c27 3a20 4e6f 6e65 2c0a 2020 2020  ell': None,.    
-0002d3c0: 2020 2020 2020 2020 2773 7461 7274 5f63          'start_c
-0002d3d0: 6f6c 273a 204e 6f6e 652c 0a20 2020 2020  ol': None,.     
-0002d3e0: 2020 2020 2020 2027 7374 6172 745f 726f         'start_ro
-0002d3f0: 7727 3a20 4e6f 6e65 2c0a 2020 2020 2020  w': None,.      
-0002d400: 2020 2020 2020 2776 6973 6962 6c65 273a        'visible':
-0002d410: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-0002d420: 2020 2027 7769 6474 6827 3a20 6465 6661     'width': defa
-0002d430: 756c 745f 7769 6474 682c 0a20 2020 2020  ult_width,.     
-0002d440: 2020 2020 2020 2027 6865 6967 6874 273a         'height':
-0002d450: 2064 6566 6175 6c74 5f68 6569 6768 742c   default_height,
-0002d460: 0a20 2020 2020 2020 2020 2020 2027 785f  .            'x_
-0002d470: 6f66 6673 6574 273a 204e 6f6e 652c 0a20  offset': None,. 
-0002d480: 2020 2020 2020 2020 2020 2027 785f 7363             'x_sc
-0002d490: 616c 6527 3a20 312c 0a20 2020 2020 2020  ale': 1,.       
-0002d4a0: 2020 2020 2027 795f 6f66 6673 6574 273a       'y_offset':
-0002d4b0: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
-0002d4c0: 2020 2027 795f 7363 616c 6527 3a20 312c     'y_scale': 1,
-0002d4d0: 0a20 2020 2020 2020 2020 2020 2027 666f  .            'fo
-0002d4e0: 6e74 5f6e 616d 6527 3a20 2754 6168 6f6d  nt_name': 'Tahom
-0002d4f0: 6127 2c0a 2020 2020 2020 2020 2020 2020  a',.            
-0002d500: 2766 6f6e 745f 7369 7a65 273a 2038 2c0a  'font_size': 8,.
-0002d510: 2020 2020 2020 2020 2020 2020 2766 6f6e              'fon
-0002d520: 745f 6661 6d69 6c79 273a 2032 2c0a 2020  t_family': 2,.  
-0002d530: 2020 2020 2020 7d0a 0a20 2020 2020 2020        }..       
-0002d540: 2023 204f 7665 7277 7269 7465 2074 6865   # Overwrite the
-0002d550: 2064 6566 6175 6c74 7320 7769 7468 2061   defaults with a
-0002d560: 6e79 2075 7365 7220 7375 7070 6c69 6564  ny user supplied
-0002d570: 2076 616c 7565 732e 2049 6e63 6f72 7265   values. Incorre
-0002d580: 6374 206f 720a 2020 2020 2020 2020 2320  ct or.        # 
-0002d590: 6d69 7373 7065 6c6c 6564 2070 6172 616d  misspelled param
-0002d5a0: 6574 6572 7320 6172 6520 7369 6c65 6e74  eters are silent
-0002d5b0: 6c79 2069 676e 6f72 6564 2e0a 2020 2020  ly ignored..    
-0002d5c0: 2020 2020 666f 7220 6b65 7920 696e 206f      for key in o
-0002d5d0: 7074 696f 6e73 2e6b 6579 7328 293a 0a20  ptions.keys():. 
-0002d5e0: 2020 2020 2020 2020 2020 2070 6172 616d             param
-0002d5f0: 735b 6b65 795d 203d 206f 7074 696f 6e73  s[key] = options
-0002d600: 5b6b 6579 5d0a 0a20 2020 2020 2020 2023  [key]..        #
-0002d610: 2045 6e73 7572 6520 7468 6174 2061 2077   Ensure that a w
-0002d620: 6964 7468 2061 6e64 2068 6569 6768 7420  idth and height 
-0002d630: 6861 7665 2062 6565 6e20 7365 742e 0a20  have been set.. 
-0002d640: 2020 2020 2020 2069 6620 6e6f 7420 7061         if not pa
-0002d650: 7261 6d73 5b27 7769 6474 6827 5d3a 0a20  rams['width']:. 
-0002d660: 2020 2020 2020 2020 2020 2070 6172 616d             param
-0002d670: 735b 2777 6964 7468 275d 203d 2064 6566  s['width'] = def
-0002d680: 6175 6c74 5f77 6964 7468 0a20 2020 2020  ault_width.     
-0002d690: 2020 2069 6620 6e6f 7420 7061 7261 6d73     if not params
-0002d6a0: 5b27 6865 6967 6874 275d 3a0a 2020 2020  ['height']:.    
-0002d6b0: 2020 2020 2020 2020 7061 7261 6d73 5b27          params['
-0002d6c0: 6865 6967 6874 275d 203d 2064 6566 6175  height'] = defau
-0002d6d0: 6c74 5f68 6569 6768 740a 0a20 2020 2020  lt_height..     
-0002d6e0: 2020 2023 2053 6574 2074 6865 2063 6f6d     # Set the com
-0002d6f0: 6d65 6e74 2062 6163 6b67 726f 756e 6420  ment background 
-0002d700: 636f 6c6f 722e 0a20 2020 2020 2020 2070  color..        p
-0002d710: 6172 616d 735b 2763 6f6c 6f72 275d 203d  arams['color'] =
-0002d720: 2078 6c5f 636f 6c6f 7228 7061 7261 6d73   xl_color(params
-0002d730: 5b27 636f 6c6f 7227 5d29 2e6c 6f77 6572  ['color']).lower
-0002d740: 2829 0a0a 2020 2020 2020 2020 2320 436f  ()..        # Co
-0002d750: 6e76 6572 7420 6672 6f6d 2045 7863 656c  nvert from Excel
-0002d760: 2058 4d4c 2073 7479 6c65 2063 6f6c 6f72   XML style color
-0002d770: 2074 6f20 584d 4c20 6874 6d6c 2073 7479   to XML html sty
-0002d780: 6c65 2063 6f6c 6f72 2e0a 2020 2020 2020  le color..      
-0002d790: 2020 7061 7261 6d73 5b27 636f 6c6f 7227    params['color'
-0002d7a0: 5d20 3d20 7061 7261 6d73 5b27 636f 6c6f  ] = params['colo
-0002d7b0: 7227 5d2e 7265 706c 6163 6528 2766 6627  r'].replace('ff'
-0002d7c0: 2c20 2723 272c 2031 290a 0a20 2020 2020  , '#', 1)..     
-0002d7d0: 2020 2023 2043 6f6e 7665 7274 2061 2063     # Convert a c
-0002d7e0: 656c 6c20 7265 6665 7265 6e63 6520 746f  ell reference to
-0002d7f0: 2061 2072 6f77 2061 6e64 2063 6f6c 756d   a row and colum
-0002d800: 6e2e 0a20 2020 2020 2020 2069 6620 7061  n..        if pa
-0002d810: 7261 6d73 5b27 7374 6172 745f 6365 6c6c  rams['start_cell
-0002d820: 275d 2069 7320 6e6f 7420 4e6f 6e65 3a0a  '] is not None:.
-0002d830: 2020 2020 2020 2020 2020 2020 2873 7461              (sta
-0002d840: 7274 5f72 6f77 2c20 7374 6172 745f 636f  rt_row, start_co
-0002d850: 6c29 203d 2078 6c5f 6365 6c6c 5f74 6f5f  l) = xl_cell_to_
-0002d860: 726f 7763 6f6c 2870 6172 616d 735b 2773  rowcol(params['s
-0002d870: 7461 7274 5f63 656c 6c27 5d29 0a20 2020  tart_cell']).   
-0002d880: 2020 2020 2020 2020 2070 6172 616d 735b           params[
-0002d890: 2773 7461 7274 5f72 6f77 275d 203d 2073  'start_row'] = s
-0002d8a0: 7461 7274 5f72 6f77 0a20 2020 2020 2020  tart_row.       
-0002d8b0: 2020 2020 2070 6172 616d 735b 2773 7461       params['sta
-0002d8c0: 7274 5f63 6f6c 275d 203d 2073 7461 7274  rt_col'] = start
-0002d8d0: 5f63 6f6c 0a0a 2020 2020 2020 2020 2320  _col..        # 
-0002d8e0: 5365 7420 7468 6520 6465 6661 756c 7420  Set the default 
-0002d8f0: 7374 6172 7420 6365 6c6c 2061 6e64 206f  start cell and o
-0002d900: 6666 7365 7473 2066 6f72 2074 6865 2063  ffsets for the c
-0002d910: 6f6d 6d65 6e74 2e20 5468 6573 6520 6172  omment. These ar
-0002d920: 650a 2020 2020 2020 2020 2320 6765 6e65  e.        # gene
-0002d930: 7261 6c6c 7920 6669 7865 6420 696e 2072  rally fixed in r
-0002d940: 656c 6174 696f 6e20 746f 2074 6865 2070  elation to the p
-0002d950: 6172 656e 7420 6365 6c6c 2e20 486f 7765  arent cell. Howe
-0002d960: 7665 7220 7468 6572 6520 6172 650a 2020  ver there are.  
-0002d970: 2020 2020 2020 2320 736f 6d65 2065 6467        # some edg
-0002d980: 6520 6361 7365 7320 666f 7220 6365 6c6c  e cases for cell
-0002d990: 7320 6174 2074 6865 2c20 6572 2c20 6564  s at the, er, ed
-0002d9a0: 6765 732e 0a20 2020 2020 2020 2072 6f77  ges..        row
-0002d9b0: 5f6d 6178 203d 2073 656c 662e 786c 735f  _max = self.xls_
-0002d9c0: 726f 776d 6178 0a20 2020 2020 2020 2063  rowmax.        c
-0002d9d0: 6f6c 5f6d 6178 203d 2073 656c 662e 786c  ol_max = self.xl
-0002d9e0: 735f 636f 6c6d 6178 0a0a 2020 2020 2020  s_colmax..      
-0002d9f0: 2020 6966 2070 6172 616d 735b 2773 7461    if params['sta
-0002da00: 7274 5f72 6f77 275d 2069 7320 4e6f 6e65  rt_row'] is None
-0002da10: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-0002da20: 2072 6f77 203d 3d20 303a 0a20 2020 2020   row == 0:.     
-0002da30: 2020 2020 2020 2020 2020 2070 6172 616d             param
-0002da40: 735b 2773 7461 7274 5f72 6f77 275d 203d  s['start_row'] =
-0002da50: 2030 0a20 2020 2020 2020 2020 2020 2065   0.            e
-0002da60: 6c69 6620 726f 7720 3d3d 2072 6f77 5f6d  lif row == row_m
-0002da70: 6178 202d 2033 3a0a 2020 2020 2020 2020  ax - 3:.        
-0002da80: 2020 2020 2020 2020 7061 7261 6d73 5b27          params['
-0002da90: 7374 6172 745f 726f 7727 5d20 3d20 726f  start_row'] = ro
-0002daa0: 775f 6d61 7820 2d20 370a 2020 2020 2020  w_max - 7.      
-0002dab0: 2020 2020 2020 656c 6966 2072 6f77 203d        elif row =
-0002dac0: 3d20 726f 775f 6d61 7820 2d20 323a 0a20  = row_max - 2:. 
-0002dad0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0002dae0: 6172 616d 735b 2773 7461 7274 5f72 6f77  arams['start_row
-0002daf0: 275d 203d 2072 6f77 5f6d 6178 202d 2036  '] = row_max - 6
-0002db00: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-0002db10: 6620 726f 7720 3d3d 2072 6f77 5f6d 6178  f row == row_max
-0002db20: 202d 2031 3a0a 2020 2020 2020 2020 2020   - 1:.          
-0002db30: 2020 2020 2020 7061 7261 6d73 5b27 7374        params['st
-0002db40: 6172 745f 726f 7727 5d20 3d20 726f 775f  art_row'] = row_
-0002db50: 6d61 7820 2d20 350a 2020 2020 2020 2020  max - 5.        
-0002db60: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0002db70: 2020 2020 2020 2020 2020 7061 7261 6d73            params
-0002db80: 5b27 7374 6172 745f 726f 7727 5d20 3d20  ['start_row'] = 
-0002db90: 726f 7720 2d20 310a 0a20 2020 2020 2020  row - 1..       
-0002dba0: 2069 6620 7061 7261 6d73 5b27 795f 6f66   if params['y_of
-0002dbb0: 6673 6574 275d 2069 7320 4e6f 6e65 3a0a  fset'] is None:.
-0002dbc0: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-0002dbd0: 6f77 203d 3d20 303a 0a20 2020 2020 2020  ow == 0:.       
-0002dbe0: 2020 2020 2020 2020 2070 6172 616d 735b           params[
-0002dbf0: 2779 5f6f 6666 7365 7427 5d20 3d20 320a  'y_offset'] = 2.
-0002dc00: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0002dc10: 2072 6f77 203d 3d20 726f 775f 6d61 7820   row == row_max 
-0002dc20: 2d20 333a 0a20 2020 2020 2020 2020 2020  - 3:.           
-0002dc30: 2020 2020 2070 6172 616d 735b 2779 5f6f       params['y_o
-0002dc40: 6666 7365 7427 5d20 3d20 3136 0a20 2020  ffset'] = 16.   
-0002dc50: 2020 2020 2020 2020 2065 6c69 6620 726f           elif ro
-0002dc60: 7720 3d3d 2072 6f77 5f6d 6178 202d 2032  w == row_max - 2
-0002dc70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002dc80: 2020 7061 7261 6d73 5b27 795f 6f66 6673    params['y_offs
-0002dc90: 6574 275d 203d 2031 360a 2020 2020 2020  et'] = 16.      
-0002dca0: 2020 2020 2020 656c 6966 2072 6f77 203d        elif row =
-0002dcb0: 3d20 726f 775f 6d61 7820 2d20 313a 0a20  = row_max - 1:. 
-0002dcc0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0002dcd0: 6172 616d 735b 2779 5f6f 6666 7365 7427  arams['y_offset'
-0002dce0: 5d20 3d20 3134 0a20 2020 2020 2020 2020  ] = 14.         
-0002dcf0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0002dd00: 2020 2020 2020 2020 2070 6172 616d 735b           params[
-0002dd10: 2779 5f6f 6666 7365 7427 5d20 3d20 3130  'y_offset'] = 10
-0002dd20: 0a0a 2020 2020 2020 2020 6966 2070 6172  ..        if par
-0002dd30: 616d 735b 2773 7461 7274 5f63 6f6c 275d  ams['start_col']
-0002dd40: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0002dd50: 2020 2020 2020 6966 2063 6f6c 203d 3d20        if col == 
-0002dd60: 636f 6c5f 6d61 7820 2d20 333a 0a20 2020  col_max - 3:.   
-0002dd70: 2020 2020 2020 2020 2020 2020 2070 6172               par
-0002dd80: 616d 735b 2773 7461 7274 5f63 6f6c 275d  ams['start_col']
-0002dd90: 203d 2063 6f6c 5f6d 6178 202d 2036 0a20   = col_max - 6. 
-0002dda0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-0002ddb0: 636f 6c20 3d3d 2063 6f6c 5f6d 6178 202d  col == col_max -
-0002ddc0: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
-0002ddd0: 2020 2020 7061 7261 6d73 5b27 7374 6172      params['star
-0002dde0: 745f 636f 6c27 5d20 3d20 636f 6c5f 6d61  t_col'] = col_ma
-0002ddf0: 7820 2d20 350a 2020 2020 2020 2020 2020  x - 5.          
-0002de00: 2020 656c 6966 2063 6f6c 203d 3d20 636f    elif col == co
-0002de10: 6c5f 6d61 7820 2d20 313a 0a20 2020 2020  l_max - 1:.     
-0002de20: 2020 2020 2020 2020 2020 2070 6172 616d             param
-0002de30: 735b 2773 7461 7274 5f63 6f6c 275d 203d  s['start_col'] =
-0002de40: 2063 6f6c 5f6d 6178 202d 2034 0a20 2020   col_max - 4.   
-0002de50: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0002de60: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0002de70: 6172 616d 735b 2773 7461 7274 5f63 6f6c  arams['start_col
-0002de80: 275d 203d 2063 6f6c 202b 2031 0a0a 2020  '] = col + 1..  
-0002de90: 2020 2020 2020 6966 2070 6172 616d 735b        if params[
-0002dea0: 2778 5f6f 6666 7365 7427 5d20 6973 204e  'x_offset'] is N
-0002deb0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0002dec0: 2069 6620 636f 6c20 3d3d 2063 6f6c 5f6d   if col == col_m
-0002ded0: 6178 202d 2033 3a0a 2020 2020 2020 2020  ax - 3:.        
-0002dee0: 2020 2020 2020 2020 7061 7261 6d73 5b27          params['
-0002def0: 785f 6f66 6673 6574 275d 203d 2034 390a  x_offset'] = 49.
-0002df00: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0002df10: 2063 6f6c 203d 3d20 636f 6c5f 6d61 7820   col == col_max 
-0002df20: 2d20 323a 0a20 2020 2020 2020 2020 2020  - 2:.           
-0002df30: 2020 2020 2070 6172 616d 735b 2778 5f6f       params['x_o
-0002df40: 6666 7365 7427 5d20 3d20 3439 0a20 2020  ffset'] = 49.   
-0002df50: 2020 2020 2020 2020 2065 6c69 6620 636f           elif co
-0002df60: 6c20 3d3d 2063 6f6c 5f6d 6178 202d 2031  l == col_max - 1
-0002df70: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002df80: 2020 7061 7261 6d73 5b27 785f 6f66 6673    params['x_offs
-0002df90: 6574 275d 203d 2034 390a 2020 2020 2020  et'] = 49.      
-0002dfa0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0002dfb0: 2020 2020 2020 2020 2020 2020 7061 7261              para
-0002dfc0: 6d73 5b27 785f 6f66 6673 6574 275d 203d  ms['x_offset'] =
-0002dfd0: 2031 350a 0a20 2020 2020 2020 2023 2053   15..        # S
-0002dfe0: 6361 6c65 2074 6865 2073 697a 6520 6f66  cale the size of
-0002dff0: 2074 6865 2063 6f6d 6d65 6e74 2062 6f78   the comment box
-0002e000: 2069 6620 7265 7175 6972 6564 2e0a 2020   if required..  
-0002e010: 2020 2020 2020 6966 2070 6172 616d 735b        if params[
-0002e020: 2778 5f73 6361 6c65 275d 3a0a 2020 2020  'x_scale']:.    
-0002e030: 2020 2020 2020 2020 7061 7261 6d73 5b27          params['
-0002e040: 7769 6474 6827 5d20 3d20 7061 7261 6d73  width'] = params
-0002e050: 5b27 7769 6474 6827 5d20 2a20 7061 7261  ['width'] * para
-0002e060: 6d73 5b27 785f 7363 616c 6527 5d0a 0a20  ms['x_scale'].. 
-0002e070: 2020 2020 2020 2069 6620 7061 7261 6d73         if params
-0002e080: 5b27 795f 7363 616c 6527 5d3a 0a20 2020  ['y_scale']:.   
-0002e090: 2020 2020 2020 2020 2070 6172 616d 735b           params[
-0002e0a0: 2768 6569 6768 7427 5d20 3d20 7061 7261  'height'] = para
-0002e0b0: 6d73 5b27 6865 6967 6874 275d 202a 2070  ms['height'] * p
-0002e0c0: 6172 616d 735b 2779 5f73 6361 6c65 275d  arams['y_scale']
-0002e0d0: 0a0a 2020 2020 2020 2020 2320 526f 756e  ..        # Roun
-0002e0e0: 6420 7468 6520 6469 6d65 6e73 696f 6e73  d the dimensions
-0002e0f0: 2074 6f20 7468 6520 6e65 6172 6573 7420   to the nearest 
-0002e100: 7069 7865 6c2e 0a20 2020 2020 2020 2070  pixel..        p
-0002e110: 6172 616d 735b 2777 6964 7468 275d 203d  arams['width'] =
-0002e120: 2069 6e74 2830 2e35 202b 2070 6172 616d   int(0.5 + param
-0002e130: 735b 2777 6964 7468 275d 290a 2020 2020  s['width']).    
-0002e140: 2020 2020 7061 7261 6d73 5b27 6865 6967      params['heig
-0002e150: 6874 275d 203d 2069 6e74 2830 2e35 202b  ht'] = int(0.5 +
-0002e160: 2070 6172 616d 735b 2768 6569 6768 7427   params['height'
-0002e170: 5d29 0a0a 2020 2020 2020 2020 2320 4361  ])..        # Ca
-0002e180: 6c63 756c 6174 6520 7468 6520 706f 7369  lculate the posi
-0002e190: 7469 6f6e 7320 6f66 2074 6865 2063 6f6d  tions of the com
-0002e1a0: 6d65 6e74 206f 626a 6563 742e 0a20 2020  ment object..   
-0002e1b0: 2020 2020 2076 6572 7469 6365 7320 3d20       vertices = 
-0002e1c0: 7365 6c66 2e5f 706f 7369 7469 6f6e 5f6f  self._position_o
-0002e1d0: 626a 6563 745f 7069 7865 6c73 280a 2020  bject_pixels(.  
-0002e1e0: 2020 2020 2020 2020 2020 7061 7261 6d73            params
-0002e1f0: 5b27 7374 6172 745f 636f 6c27 5d2c 2070  ['start_col'], p
-0002e200: 6172 616d 735b 2773 7461 7274 5f72 6f77  arams['start_row
-0002e210: 275d 2c20 7061 7261 6d73 5b27 785f 6f66  '], params['x_of
-0002e220: 6673 6574 275d 2c0a 2020 2020 2020 2020  fset'],.        
-0002e230: 2020 2020 7061 7261 6d73 5b27 795f 6f66      params['y_of
-0002e240: 6673 6574 275d 2c20 7061 7261 6d73 5b27  fset'], params['
-0002e250: 7769 6474 6827 5d2c 2070 6172 616d 735b  width'], params[
-0002e260: 2768 6569 6768 7427 5d2c 2061 6e63 686f  'height'], ancho
-0002e270: 7229 0a0a 2020 2020 2020 2020 2320 4164  r)..        # Ad
-0002e280: 6420 7468 6520 7769 6474 6820 616e 6420  d the width and 
-0002e290: 6865 6967 6874 2066 6f72 2056 4d4c 2e0a  height for VML..
-0002e2a0: 2020 2020 2020 2020 7665 7274 6963 6573          vertices
-0002e2b0: 2e61 7070 656e 6428 7061 7261 6d73 5b27  .append(params['
-0002e2c0: 7769 6474 6827 5d29 0a20 2020 2020 2020  width']).       
-0002e2d0: 2076 6572 7469 6365 732e 6170 7065 6e64   vertices.append
-0002e2e0: 2870 6172 616d 735b 2768 6569 6768 7427  (params['height'
-0002e2f0: 5d29 0a0a 2020 2020 2020 2020 7265 7475  ])..        retu
-0002e300: 726e 2028 5b72 6f77 2c20 636f 6c2c 2073  rn ([row, col, s
-0002e310: 7472 696e 672c 2070 6172 616d 735b 2761  tring, params['a
-0002e320: 7574 686f 7227 5d2c 0a20 2020 2020 2020  uthor'],.       
-0002e330: 2020 2020 2020 2020 2020 7061 7261 6d73            params
-0002e340: 5b27 7669 7369 626c 6527 5d2c 2070 6172  ['visible'], par
-0002e350: 616d 735b 2763 6f6c 6f72 275d 2c0a 2020  ams['color'],.  
-0002e360: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0002e370: 6172 616d 735b 2766 6f6e 745f 6e61 6d65  arams['font_name
-0002e380: 275d 2c20 7061 7261 6d73 5b27 666f 6e74  '], params['font
-0002e390: 5f73 697a 6527 5d2c 0a20 2020 2020 2020  _size'],.       
-0002e3a0: 2020 2020 2020 2020 2020 7061 7261 6d73            params
-0002e3b0: 5b27 666f 6e74 5f66 616d 696c 7927 5d5d  ['font_family']]
-0002e3c0: 202b 205b 7665 7274 6963 6573 5d29 0a0a   + [vertices])..
-0002e3d0: 2020 2020 6465 6620 5f62 7574 746f 6e5f      def _button_
-0002e3e0: 7061 7261 6d73 2873 656c 662c 2072 6f77  params(self, row
-0002e3f0: 2c20 636f 6c2c 206f 7074 696f 6e73 293a  , col, options):
-0002e400: 0a20 2020 2020 2020 2023 2054 6869 7320  .        # This 
-0002e410: 6d65 7468 6f64 2068 616e 646c 6573 2074  method handles t
-0002e420: 6865 2070 6172 616d 6574 6572 7320 7061  he parameters pa
-0002e430: 7373 6564 2074 6f20 696e 7365 7274 5f62  ssed to insert_b
-0002e440: 7574 746f 6e28 2920 6173 2077 656c 6c0a  utton() as well.
-0002e450: 2020 2020 2020 2020 2320 6173 2063 616c          # as cal
-0002e460: 6375 6c61 7469 6e67 2074 6865 2062 7574  culating the but
-0002e470: 746f 6e20 6f62 6a65 6374 2070 6f73 6974  ton object posit
-0002e480: 696f 6e20 616e 6420 7665 7274 6963 6573  ion and vertices
-0002e490: 2e0a 0a20 2020 2020 2020 2064 6566 6175  ...        defau
-0002e4a0: 6c74 5f68 6569 6768 7420 3d20 7365 6c66  lt_height = self
-0002e4b0: 2e64 6566 6175 6c74 5f72 6f77 5f70 6978  .default_row_pix
-0002e4c0: 656c 730a 2020 2020 2020 2020 6465 6661  els.        defa
-0002e4d0: 756c 745f 7769 6474 6820 3d20 7365 6c66  ult_width = self
-0002e4e0: 2e64 6566 6175 6c74 5f63 6f6c 5f70 6978  .default_col_pix
-0002e4f0: 656c 730a 2020 2020 2020 2020 616e 6368  els.        anch
-0002e500: 6f72 203d 2030 0a0a 2020 2020 2020 2020  or = 0..        
-0002e510: 6275 7474 6f6e 5f6e 756d 6265 7220 3d20  button_number = 
-0002e520: 3120 2b20 6c65 6e28 7365 6c66 2e62 7574  1 + len(self.but
-0002e530: 746f 6e73 5f6c 6973 7429 0a20 2020 2020  tons_list).     
-0002e540: 2020 2062 7574 746f 6e20 3d20 7b27 726f     button = {'ro
-0002e550: 7727 3a20 726f 772c 2027 636f 6c27 3a20  w': row, 'col': 
-0002e560: 636f 6c2c 2027 666f 6e74 273a 207b 7d7d  col, 'font': {}}
-0002e570: 0a20 2020 2020 2020 2070 6172 616d 7320  .        params 
-0002e580: 3d20 7b7d 0a0a 2020 2020 2020 2020 2320  = {}..        # 
-0002e590: 4f76 6572 7772 6974 6520 7468 6520 6465  Overwrite the de
-0002e5a0: 6661 756c 7473 2077 6974 6820 616e 7920  faults with any 
-0002e5b0: 7573 6572 2073 7570 706c 6965 6420 7661  user supplied va
-0002e5c0: 6c75 6573 2e20 496e 636f 7272 6563 7420  lues. Incorrect 
-0002e5d0: 6f72 0a20 2020 2020 2020 2023 206d 6973  or.        # mis
-0002e5e0: 7370 656c 6c65 6420 7061 7261 6d65 7465  spelled paramete
-0002e5f0: 7273 2061 7265 2073 696c 656e 746c 7920  rs are silently 
-0002e600: 6967 6e6f 7265 642e 0a20 2020 2020 2020  ignored..       
-0002e610: 2066 6f72 206b 6579 2069 6e20 6f70 7469   for key in opti
-0002e620: 6f6e 732e 6b65 7973 2829 3a0a 2020 2020  ons.keys():.    
-0002e630: 2020 2020 2020 2020 7061 7261 6d73 5b6b          params[k
-0002e640: 6579 5d20 3d20 6f70 7469 6f6e 735b 6b65  ey] = options[ke
-0002e650: 795d 0a0a 2020 2020 2020 2020 2320 5365  y]..        # Se
-0002e660: 7420 7468 6520 6275 7474 6f6e 2063 6170  t the button cap
-0002e670: 7469 6f6e 2e0a 2020 2020 2020 2020 6361  tion..        ca
-0002e680: 7074 696f 6e20 3d20 7061 7261 6d73 2e67  ption = params.g
-0002e690: 6574 2827 6361 7074 696f 6e27 290a 0a20  et('caption').. 
-0002e6a0: 2020 2020 2020 2023 2053 6574 2061 2064         # Set a d
-0002e6b0: 6566 6175 6c74 2063 6170 7469 6f6e 2069  efault caption i
-0002e6c0: 6620 6e6f 6e65 2077 6173 2073 7065 6369  f none was speci
-0002e6d0: 6669 6564 2062 7920 7573 6572 2e0a 2020  fied by user..  
-0002e6e0: 2020 2020 2020 6966 2063 6170 7469 6f6e        if caption
-0002e6f0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0002e700: 2020 2020 2020 6361 7074 696f 6e20 3d20        caption = 
-0002e710: 2742 7574 746f 6e20 2564 2720 2520 6275  'Button %d' % bu
-0002e720: 7474 6f6e 5f6e 756d 6265 720a 0a20 2020  tton_number..   
-0002e730: 2020 2020 2062 7574 746f 6e5b 2766 6f6e       button['fon
-0002e740: 7427 5d5b 2763 6170 7469 6f6e 275d 203d  t']['caption'] =
-0002e750: 2063 6170 7469 6f6e 0a0a 2020 2020 2020   caption..      
-0002e760: 2020 2320 5365 7420 7468 6520 6d61 6372    # Set the macr
-0002e770: 6f20 6e61 6d65 2e0a 2020 2020 2020 2020  o name..        
-0002e780: 6966 2070 6172 616d 732e 6765 7428 276d  if params.get('m
-0002e790: 6163 726f 2729 3a0a 2020 2020 2020 2020  acro'):.        
-0002e7a0: 2020 2020 6275 7474 6f6e 5b27 6d61 6372      button['macr
-0002e7b0: 6f27 5d20 3d20 275b 305d 2127 202b 2070  o'] = '[0]!' + p
-0002e7c0: 6172 616d 735b 276d 6163 726f 275d 0a20  arams['macro']. 
-0002e7d0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0002e7e0: 2020 2020 2020 2020 2062 7574 746f 6e5b           button[
-0002e7f0: 276d 6163 726f 275d 203d 2027 5b30 5d21  'macro'] = '[0]!
-0002e800: 4275 7474 6f6e 2564 5f43 6c69 636b 2720  Button%d_Click' 
-0002e810: 2520 6275 7474 6f6e 5f6e 756d 6265 720a  % button_number.
-0002e820: 0a20 2020 2020 2020 2023 2053 6574 2074  .        # Set t
-0002e830: 6865 2061 6c74 2074 6578 7420 666f 7220  he alt text for 
-0002e840: 7468 6520 6275 7474 6f6e 2e0a 2020 2020  the button..    
-0002e850: 2020 2020 6275 7474 6f6e 5b27 6465 7363      button['desc
-0002e860: 7269 7074 696f 6e27 5d20 3d20 7061 7261  ription'] = para
-0002e870: 6d73 2e67 6574 2827 6465 7363 7269 7074  ms.get('descript
-0002e880: 696f 6e27 290a 0a20 2020 2020 2020 2023  ion')..        #
-0002e890: 2045 6e73 7572 6520 7468 6174 2061 2077   Ensure that a w
-0002e8a0: 6964 7468 2061 6e64 2068 6569 6768 7420  idth and height 
-0002e8b0: 6861 7665 2062 6565 6e20 7365 742e 0a20  have been set.. 
-0002e8c0: 2020 2020 2020 2070 6172 616d 735b 2777         params['w
-0002e8d0: 6964 7468 275d 203d 2070 6172 616d 732e  idth'] = params.
-0002e8e0: 6765 7428 2777 6964 7468 272c 2064 6566  get('width', def
-0002e8f0: 6175 6c74 5f77 6964 7468 290a 2020 2020  ault_width).    
-0002e900: 2020 2020 7061 7261 6d73 5b27 6865 6967      params['heig
-0002e910: 6874 275d 203d 2070 6172 616d 732e 6765  ht'] = params.ge
-0002e920: 7428 2768 6569 6768 7427 2c20 6465 6661  t('height', defa
-0002e930: 756c 745f 6865 6967 6874 290a 0a20 2020  ult_height)..   
-0002e940: 2020 2020 2023 2053 6574 2074 6865 2078       # Set the x
-0002e950: 2f79 206f 6666 7365 7473 2e0a 2020 2020  /y offsets..    
-0002e960: 2020 2020 7061 7261 6d73 5b27 785f 6f66      params['x_of
-0002e970: 6673 6574 275d 203d 2070 6172 616d 732e  fset'] = params.
-0002e980: 6765 7428 2778 5f6f 6666 7365 7427 2c20  get('x_offset', 
-0002e990: 3029 0a20 2020 2020 2020 2070 6172 616d  0).        param
-0002e9a0: 735b 2779 5f6f 6666 7365 7427 5d20 3d20  s['y_offset'] = 
-0002e9b0: 7061 7261 6d73 2e67 6574 2827 795f 6f66  params.get('y_of
-0002e9c0: 6673 6574 272c 2030 290a 0a20 2020 2020  fset', 0)..     
-0002e9d0: 2020 2023 2053 6361 6c65 2074 6865 2073     # Scale the s
-0002e9e0: 697a 6520 6f66 2074 6865 2062 7574 746f  ize of the butto
-0002e9f0: 6e20 6966 2072 6571 7569 7265 642e 0a20  n if required.. 
-0002ea00: 2020 2020 2020 2070 6172 616d 735b 2777         params['w
-0002ea10: 6964 7468 275d 203d 2070 6172 616d 735b  idth'] = params[
-0002ea20: 2777 6964 7468 275d 202a 2070 6172 616d  'width'] * param
-0002ea30: 732e 6765 7428 2778 5f73 6361 6c65 272c  s.get('x_scale',
-0002ea40: 2031 290a 2020 2020 2020 2020 7061 7261   1).        para
-0002ea50: 6d73 5b27 6865 6967 6874 275d 203d 2070  ms['height'] = p
-0002ea60: 6172 616d 735b 2768 6569 6768 7427 5d20  arams['height'] 
-0002ea70: 2a20 7061 7261 6d73 2e67 6574 2827 795f  * params.get('y_
-0002ea80: 7363 616c 6527 2c20 3129 0a0a 2020 2020  scale', 1)..    
-0002ea90: 2020 2020 2320 526f 756e 6420 7468 6520      # Round the 
-0002eaa0: 6469 6d65 6e73 696f 6e73 2074 6f20 7468  dimensions to th
-0002eab0: 6520 6e65 6172 6573 7420 7069 7865 6c2e  e nearest pixel.
-0002eac0: 0a20 2020 2020 2020 2070 6172 616d 735b  .        params[
-0002ead0: 2777 6964 7468 275d 203d 2069 6e74 2830  'width'] = int(0
-0002eae0: 2e35 202b 2070 6172 616d 735b 2777 6964  .5 + params['wid
-0002eaf0: 7468 275d 290a 2020 2020 2020 2020 7061  th']).        pa
-0002eb00: 7261 6d73 5b27 6865 6967 6874 275d 203d  rams['height'] =
-0002eb10: 2069 6e74 2830 2e35 202b 2070 6172 616d   int(0.5 + param
-0002eb20: 735b 2768 6569 6768 7427 5d29 0a0a 2020  s['height'])..  
-0002eb30: 2020 2020 2020 7061 7261 6d73 5b27 7374        params['st
-0002eb40: 6172 745f 726f 7727 5d20 3d20 726f 770a  art_row'] = row.
-0002eb50: 2020 2020 2020 2020 7061 7261 6d73 5b27          params['
-0002eb60: 7374 6172 745f 636f 6c27 5d20 3d20 636f  start_col'] = co
-0002eb70: 6c0a 0a20 2020 2020 2020 2023 2043 616c  l..        # Cal
-0002eb80: 6375 6c61 7465 2074 6865 2070 6f73 6974  culate the posit
-0002eb90: 696f 6e73 206f 6620 7468 6520 6275 7474  ions of the butt
-0002eba0: 6f6e 206f 626a 6563 742e 0a20 2020 2020  on object..     
-0002ebb0: 2020 2076 6572 7469 6365 7320 3d20 7365     vertices = se
-0002ebc0: 6c66 2e5f 706f 7369 7469 6f6e 5f6f 626a  lf._position_obj
-0002ebd0: 6563 745f 7069 7865 6c73 280a 2020 2020  ect_pixels(.    
-0002ebe0: 2020 2020 2020 2020 7061 7261 6d73 5b27          params['
-0002ebf0: 7374 6172 745f 636f 6c27 5d2c 2070 6172  start_col'], par
-0002ec00: 616d 735b 2773 7461 7274 5f72 6f77 275d  ams['start_row']
-0002ec10: 2c20 7061 7261 6d73 5b27 785f 6f66 6673  , params['x_offs
-0002ec20: 6574 275d 2c0a 2020 2020 2020 2020 2020  et'],.          
-0002ec30: 2020 7061 7261 6d73 5b27 795f 6f66 6673    params['y_offs
-0002ec40: 6574 275d 2c20 7061 7261 6d73 5b27 7769  et'], params['wi
-0002ec50: 6474 6827 5d2c 2070 6172 616d 735b 2768  dth'], params['h
-0002ec60: 6569 6768 7427 5d2c 2061 6e63 686f 7229  eight'], anchor)
-0002ec70: 0a0a 2020 2020 2020 2020 2320 4164 6420  ..        # Add 
-0002ec80: 7468 6520 7769 6474 6820 616e 6420 6865  the width and he
-0002ec90: 6967 6874 2066 6f72 2056 4d4c 2e0a 2020  ight for VML..  
-0002eca0: 2020 2020 2020 7665 7274 6963 6573 2e61        vertices.a
-0002ecb0: 7070 656e 6428 7061 7261 6d73 5b27 7769  ppend(params['wi
-0002ecc0: 6474 6827 5d29 0a20 2020 2020 2020 2076  dth']).        v
-0002ecd0: 6572 7469 6365 732e 6170 7065 6e64 2870  ertices.append(p
-0002ece0: 6172 616d 735b 2768 6569 6768 7427 5d29  arams['height'])
-0002ecf0: 0a0a 2020 2020 2020 2020 6275 7474 6f6e  ..        button
-0002ed00: 5b27 7665 7274 6963 6573 275d 203d 2076  ['vertices'] = v
-0002ed10: 6572 7469 6365 730a 0a20 2020 2020 2020  ertices..       
-0002ed20: 2072 6574 7572 6e20 6275 7474 6f6e 0a0a   return button..
-0002ed30: 2020 2020 6465 6620 5f70 7265 7061 7265      def _prepare
-0002ed40: 5f76 6d6c 5f6f 626a 6563 7473 2873 656c  _vml_objects(sel
-0002ed50: 662c 2076 6d6c 5f64 6174 615f 6964 2c20  f, vml_data_id, 
-0002ed60: 766d 6c5f 7368 6170 655f 6964 2c20 766d  vml_shape_id, vm
-0002ed70: 6c5f 6472 6177 696e 675f 6964 2c0a 2020  l_drawing_id,.  
-0002ed80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ed90: 2020 2020 2020 2020 2020 2063 6f6d 6d65             comme
-0002eda0: 6e74 5f69 6429 3a0a 2020 2020 2020 2020  nt_id):.        
-0002edb0: 636f 6d6d 656e 7473 203d 205b 5d0a 2020  comments = [].  
-0002edc0: 2020 2020 2020 2320 536f 7274 2074 6865        # Sort the
-0002edd0: 2063 6f6d 6d65 6e74 7320 696e 746f 2072   comments into r
-0002ede0: 6f77 2f63 6f6c 756d 6e20 6f72 6465 7220  ow/column order 
-0002edf0: 666f 7220 6561 7369 6572 2063 6f6d 7061  for easier compa
-0002ee00: 7269 736f 6e0a 2020 2020 2020 2020 2320  rison.        # 
-0002ee10: 7465 7374 696e 6720 616e 6420 7365 7420  testing and set 
-0002ee20: 7468 6520 6578 7465 726e 616c 206c 696e  the external lin
-0002ee30: 6b73 2066 6f72 2063 6f6d 6d65 6e74 7320  ks for comments 
-0002ee40: 616e 6420 6275 7474 6f6e 732e 0a20 2020  and buttons..   
-0002ee50: 2020 2020 2072 6f77 5f6e 756d 7320 3d20       row_nums = 
-0002ee60: 736f 7274 6564 2873 656c 662e 636f 6d6d  sorted(self.comm
-0002ee70: 656e 7473 2e6b 6579 7328 2929 0a0a 2020  ents.keys())..  
-0002ee80: 2020 2020 2020 666f 7220 726f 7720 696e        for row in
-0002ee90: 2072 6f77 5f6e 756d 733a 0a20 2020 2020   row_nums:.     
-0002eea0: 2020 2020 2020 2063 6f6c 5f6e 756d 7320         col_nums 
-0002eeb0: 3d20 736f 7274 6564 2873 656c 662e 636f  = sorted(self.co
-0002eec0: 6d6d 656e 7473 5b72 6f77 5d2e 6b65 7973  mments[row].keys
-0002eed0: 2829 290a 0a20 2020 2020 2020 2020 2020  ())..           
-0002eee0: 2066 6f72 2063 6f6c 2069 6e20 636f 6c5f   for col in col_
-0002eef0: 6e75 6d73 3a0a 2020 2020 2020 2020 2020  nums:.          
-0002ef00: 2020 2020 2020 7573 6572 5f6f 7074 696f        user_optio
-0002ef10: 6e73 203d 2073 656c 662e 636f 6d6d 656e  ns = self.commen
-0002ef20: 7473 5b72 6f77 5d5b 636f 6c5d 0a20 2020  ts[row][col].   
-0002ef30: 2020 2020 2020 2020 2020 2020 2070 6172               par
-0002ef40: 616d 7320 3d20 7365 6c66 2e5f 636f 6d6d  ams = self._comm
-0002ef50: 656e 745f 7061 7261 6d73 282a 7573 6572  ent_params(*user
-0002ef60: 5f6f 7074 696f 6e73 290a 2020 2020 2020  _options).      
+0002a440: 5b22 2f69 6d61 6765 222c 2022 2e2e 2f6d  ["/image", "../m
+0002a450: 6564 6961 2f69 6d61 6765 2220 2b20 7374  edia/image" + st
+0002a460: 7228 696d 6167 655f 6964 2920 2b20 222e  r(image_id) + ".
+0002a470: 2220 2b20 696d 6167 655f 7479 7065 5d0a  " + image_type].
+0002a480: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+0002a490: 2020 2020 2020 2072 6566 5f69 6420 3d20         ref_id = 
+0002a4a0: 7365 6c66 2e5f 6765 745f 766d 6c5f 6472  self._get_vml_dr
+0002a4b0: 6177 696e 675f 7265 6c5f 696e 6465 7828  awing_rel_index(
+0002a4c0: 6469 6765 7374 290a 0a20 2020 2020 2020  digest)..       
+0002a4d0: 2073 656c 662e 6865 6164 6572 5f69 6d61   self.header_ima
+0002a4e0: 6765 735f 6c69 7374 2e61 7070 656e 6428  ges_list.append(
+0002a4f0: 0a20 2020 2020 2020 2020 2020 205b 7769  .            [wi
+0002a500: 6474 682c 2068 6569 6768 742c 206e 616d  dth, height, nam
+0002a510: 652c 2070 6f73 6974 696f 6e2c 2078 5f64  e, position, x_d
+0002a520: 7069 2c20 795f 6470 692c 2072 6566 5f69  pi, y_dpi, ref_i
+0002a530: 645d 0a20 2020 2020 2020 2029 0a0a 2020  d].        )..  
+0002a540: 2020 6465 6620 5f70 7265 7061 7265 5f62    def _prepare_b
+0002a550: 6163 6b67 726f 756e 6428 7365 6c66 2c20  ackground(self, 
+0002a560: 696d 6167 655f 6964 2c20 696d 6167 655f  image_id, image_
+0002a570: 7479 7065 293a 0a20 2020 2020 2020 2023  type):.        #
+0002a580: 2053 6574 2075 7020 616e 2069 6d61 6765   Set up an image
+0002a590: 2077 6974 686f 7574 2061 2064 7261 7769   without a drawi
+0002a5a0: 6e67 206f 626a 6563 7420 666f 7220 6261  ng object for ba
+0002a5b0: 636b 6772 6f75 6e64 732e 0a20 2020 2020  ckgrounds..     
+0002a5c0: 2020 2073 656c 662e 6578 7465 726e 616c     self.external
+0002a5d0: 5f62 6163 6b67 726f 756e 645f 6c69 6e6b  _background_link
+0002a5e0: 732e 6170 7065 6e64 280a 2020 2020 2020  s.append(.      
+0002a5f0: 2020 2020 2020 5b22 2f69 6d61 6765 222c        ["/image",
+0002a600: 2022 2e2e 2f6d 6564 6961 2f69 6d61 6765   "../media/image
+0002a610: 2220 2b20 7374 7228 696d 6167 655f 6964  " + str(image_id
+0002a620: 2920 2b20 222e 2220 2b20 696d 6167 655f  ) + "." + image_
+0002a630: 7479 7065 5d0a 2020 2020 2020 2020 290a  type].        ).
+0002a640: 0a20 2020 2064 6566 205f 7072 6570 6172  .    def _prepar
+0002a650: 655f 6368 6172 7428 7365 6c66 2c20 696e  e_chart(self, in
+0002a660: 6465 782c 2063 6861 7274 5f69 642c 2064  dex, chart_id, d
+0002a670: 7261 7769 6e67 5f69 6429 3a0a 2020 2020  rawing_id):.    
+0002a680: 2020 2020 2320 5365 7420 7570 2063 6861      # Set up cha
+0002a690: 7274 2f64 7261 7769 6e67 732e 0a20 2020  rt/drawings..   
+0002a6a0: 2020 2020 2064 7261 7769 6e67 5f74 7970       drawing_typ
+0002a6b0: 6520 3d20 310a 0a20 2020 2020 2020 2028  e = 1..        (
+0002a6c0: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
+0002a6d0: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
+0002a6e0: 6c2c 0a20 2020 2020 2020 2020 2020 2063  l,.            c
+0002a6f0: 6861 7274 2c0a 2020 2020 2020 2020 2020  hart,.          
+0002a700: 2020 785f 6f66 6673 6574 2c0a 2020 2020    x_offset,.    
+0002a710: 2020 2020 2020 2020 795f 6f66 6673 6574          y_offset
+0002a720: 2c0a 2020 2020 2020 2020 2020 2020 785f  ,.            x_
+0002a730: 7363 616c 652c 0a20 2020 2020 2020 2020  scale,.         
+0002a740: 2020 2079 5f73 6361 6c65 2c0a 2020 2020     y_scale,.    
+0002a750: 2020 2020 2020 2020 616e 6368 6f72 2c0a          anchor,.
+0002a760: 2020 2020 2020 2020 2020 2020 6465 7363              desc
+0002a770: 7269 7074 696f 6e2c 0a20 2020 2020 2020  ription,.       
+0002a780: 2020 2020 2064 6563 6f72 6174 6976 652c       decorative,
+0002a790: 0a20 2020 2020 2020 2029 203d 2073 656c  .        ) = sel
+0002a7a0: 662e 6368 6172 7473 5b69 6e64 6578 5d0a  f.charts[index].
+0002a7b0: 0a20 2020 2020 2020 2063 6861 7274 2e69  .        chart.i
+0002a7c0: 6420 3d20 6368 6172 745f 6964 202d 2031  d = chart_id - 1
+0002a7d0: 0a0a 2020 2020 2020 2020 2320 5573 6520  ..        # Use 
+0002a7e0: 7573 6572 2073 7065 6369 6669 6564 2064  user specified d
+0002a7f0: 696d 656e 7369 6f6e 732c 2069 6620 616e  imensions, if an
+0002a800: 792e 0a20 2020 2020 2020 2077 6964 7468  y..        width
+0002a810: 203d 2069 6e74 2830 2e35 202b 2028 6368   = int(0.5 + (ch
+0002a820: 6172 742e 7769 6474 6820 2a20 785f 7363  art.width * x_sc
+0002a830: 616c 6529 290a 2020 2020 2020 2020 6865  ale)).        he
+0002a840: 6967 6874 203d 2069 6e74 2830 2e35 202b  ight = int(0.5 +
+0002a850: 2028 6368 6172 742e 6865 6967 6874 202a   (chart.height *
+0002a860: 2079 5f73 6361 6c65 2929 0a0a 2020 2020   y_scale))..    
+0002a870: 2020 2020 6469 6d65 6e73 696f 6e73 203d      dimensions =
+0002a880: 2073 656c 662e 5f70 6f73 6974 696f 6e5f   self._position_
+0002a890: 6f62 6a65 6374 5f65 6d75 7328 0a20 2020  object_emus(.   
+0002a8a0: 2020 2020 2020 2020 2063 6f6c 2c20 726f           col, ro
+0002a8b0: 772c 2078 5f6f 6666 7365 742c 2079 5f6f  w, x_offset, y_o
+0002a8c0: 6666 7365 742c 2077 6964 7468 2c20 6865  ffset, width, he
+0002a8d0: 6967 6874 2c20 616e 6368 6f72 0a20 2020  ight, anchor.   
+0002a8e0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0002a8f0: 2320 5365 7420 7468 6520 6368 6172 7420  # Set the chart 
+0002a900: 6e61 6d65 2066 6f72 2074 6865 2065 6d62  name for the emb
+0002a910: 6564 6465 6420 6f62 6a65 6374 2069 6620  edded object if 
+0002a920: 6974 2068 6173 2062 6565 6e20 7370 6563  it has been spec
+0002a930: 6966 6965 642e 0a20 2020 2020 2020 206e  ified..        n
+0002a940: 616d 6520 3d20 6368 6172 742e 6368 6172  ame = chart.char
+0002a950: 745f 6e61 6d65 0a0a 2020 2020 2020 2020  t_name..        
+0002a960: 2320 4372 6561 7465 2061 2044 7261 7769  # Create a Drawi
+0002a970: 6e67 206f 626a 2074 6f20 7573 6520 7769  ng obj to use wi
+0002a980: 7468 2077 6f72 6b73 6865 6574 2075 6e6c  th worksheet unl
+0002a990: 6573 7320 6f6e 6520 616c 7265 6164 7920  ess one already 
+0002a9a0: 6578 6973 7473 2e0a 2020 2020 2020 2020  exists..        
+0002a9b0: 6966 206e 6f74 2073 656c 662e 6472 6177  if not self.draw
+0002a9c0: 696e 673a 0a20 2020 2020 2020 2020 2020  ing:.           
+0002a9d0: 2064 7261 7769 6e67 203d 2044 7261 7769   drawing = Drawi
+0002a9e0: 6e67 2829 0a20 2020 2020 2020 2020 2020  ng().           
+0002a9f0: 2064 7261 7769 6e67 2e65 6d62 6564 6465   drawing.embedde
+0002aa00: 6420 3d20 310a 2020 2020 2020 2020 2020  d = 1.          
+0002aa10: 2020 7365 6c66 2e64 7261 7769 6e67 203d    self.drawing =
+0002aa20: 2064 7261 7769 6e67 0a0a 2020 2020 2020   drawing..      
+0002aa30: 2020 2020 2020 7365 6c66 2e65 7874 6572        self.exter
+0002aa40: 6e61 6c5f 6472 6177 696e 675f 6c69 6e6b  nal_drawing_link
+0002aa50: 732e 6170 7065 6e64 280a 2020 2020 2020  s.append(.      
+0002aa60: 2020 2020 2020 2020 2020 5b22 2f64 7261            ["/dra
+0002aa70: 7769 6e67 222c 2022 2e2e 2f64 7261 7769  wing", "../drawi
+0002aa80: 6e67 732f 6472 6177 696e 6722 202b 2073  ngs/drawing" + s
+0002aa90: 7472 2864 7261 7769 6e67 5f69 6429 202b  tr(drawing_id) +
+0002aaa0: 2022 2e78 6d6c 225d 0a20 2020 2020 2020   ".xml"].       
+0002aab0: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+0002aac0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0002aad0: 2064 7261 7769 6e67 203d 2073 656c 662e   drawing = self.
+0002aae0: 6472 6177 696e 670a 0a20 2020 2020 2020  drawing..       
+0002aaf0: 2064 7261 7769 6e67 5f6f 626a 6563 7420   drawing_object 
+0002ab00: 3d20 6472 6177 696e 672e 5f61 6464 5f64  = drawing._add_d
+0002ab10: 7261 7769 6e67 5f6f 626a 6563 7428 290a  rawing_object().
+0002ab20: 2020 2020 2020 2020 6472 6177 696e 675f          drawing_
+0002ab30: 6f62 6a65 6374 5b22 7479 7065 225d 203d  object["type"] =
+0002ab40: 2064 7261 7769 6e67 5f74 7970 650a 2020   drawing_type.  
+0002ab50: 2020 2020 2020 6472 6177 696e 675f 6f62        drawing_ob
+0002ab60: 6a65 6374 5b22 6469 6d65 6e73 696f 6e73  ject["dimensions
+0002ab70: 225d 203d 2064 696d 656e 7369 6f6e 730a  "] = dimensions.
+0002ab80: 2020 2020 2020 2020 6472 6177 696e 675f          drawing_
+0002ab90: 6f62 6a65 6374 5b22 7769 6474 6822 5d20  object["width"] 
+0002aba0: 3d20 7769 6474 680a 2020 2020 2020 2020  = width.        
+0002abb0: 6472 6177 696e 675f 6f62 6a65 6374 5b22  drawing_object["
+0002abc0: 6865 6967 6874 225d 203d 2068 6569 6768  height"] = heigh
+0002abd0: 740a 2020 2020 2020 2020 6472 6177 696e  t.        drawin
+0002abe0: 675f 6f62 6a65 6374 5b22 6e61 6d65 225d  g_object["name"]
+0002abf0: 203d 206e 616d 650a 2020 2020 2020 2020   = name.        
+0002ac00: 6472 6177 696e 675f 6f62 6a65 6374 5b22  drawing_object["
+0002ac10: 7368 6170 6522 5d20 3d20 4e6f 6e65 0a20  shape"] = None. 
+0002ac20: 2020 2020 2020 2064 7261 7769 6e67 5f6f         drawing_o
+0002ac30: 626a 6563 745b 2261 6e63 686f 7222 5d20  bject["anchor"] 
+0002ac40: 3d20 616e 6368 6f72 0a20 2020 2020 2020  = anchor.       
+0002ac50: 2064 7261 7769 6e67 5f6f 626a 6563 745b   drawing_object[
+0002ac60: 2272 656c 5f69 6e64 6578 225d 203d 2073  "rel_index"] = s
+0002ac70: 656c 662e 5f67 6574 5f64 7261 7769 6e67  elf._get_drawing
+0002ac80: 5f72 656c 5f69 6e64 6578 2829 0a20 2020  _rel_index().   
+0002ac90: 2020 2020 2064 7261 7769 6e67 5f6f 626a       drawing_obj
+0002aca0: 6563 745b 2275 726c 5f72 656c 5f69 6e64  ect["url_rel_ind
+0002acb0: 6578 225d 203d 2030 0a20 2020 2020 2020  ex"] = 0.       
+0002acc0: 2064 7261 7769 6e67 5f6f 626a 6563 745b   drawing_object[
+0002acd0: 2274 6970 225d 203d 204e 6f6e 650a 2020  "tip"] = None.  
+0002ace0: 2020 2020 2020 6472 6177 696e 675f 6f62        drawing_ob
+0002acf0: 6a65 6374 5b22 6465 7363 7269 7074 696f  ject["descriptio
+0002ad00: 6e22 5d20 3d20 6465 7363 7269 7074 696f  n"] = descriptio
+0002ad10: 6e0a 2020 2020 2020 2020 6472 6177 696e  n.        drawin
+0002ad20: 675f 6f62 6a65 6374 5b22 6465 636f 7261  g_object["decora
+0002ad30: 7469 7665 225d 203d 2064 6563 6f72 6174  tive"] = decorat
+0002ad40: 6976 650a 0a20 2020 2020 2020 2073 656c  ive..        sel
+0002ad50: 662e 6472 6177 696e 675f 6c69 6e6b 732e  f.drawing_links.
+0002ad60: 6170 7065 6e64 280a 2020 2020 2020 2020  append(.        
+0002ad70: 2020 2020 5b22 2f63 6861 7274 222c 2022      ["/chart", "
+0002ad80: 2e2e 2f63 6861 7274 732f 6368 6172 7422  ../charts/chart"
+0002ad90: 202b 2073 7472 2863 6861 7274 5f69 6429   + str(chart_id)
+0002ada0: 202b 2022 2e78 6d6c 225d 0a20 2020 2020   + ".xml"].     
+0002adb0: 2020 2029 0a0a 2020 2020 6465 6620 5f70     )..    def _p
+0002adc0: 6f73 6974 696f 6e5f 6f62 6a65 6374 5f65  osition_object_e
+0002add0: 6d75 7328 0a20 2020 2020 2020 2073 656c  mus(.        sel
+0002ade0: 662c 2063 6f6c 5f73 7461 7274 2c20 726f  f, col_start, ro
+0002adf0: 775f 7374 6172 742c 2078 312c 2079 312c  w_start, x1, y1,
+0002ae00: 2077 6964 7468 2c20 6865 6967 6874 2c20   width, height, 
+0002ae10: 616e 6368 6f72 0a20 2020 2029 3a0a 2020  anchor.    ):.  
+0002ae20: 2020 2020 2020 2320 4361 6c63 756c 6174        # Calculat
+0002ae30: 6520 7468 6520 7665 7274 6963 6573 2074  e the vertices t
+0002ae40: 6861 7420 6465 6669 6e65 2074 6865 2070  hat define the p
+0002ae50: 6f73 6974 696f 6e20 6f66 2061 2067 7261  osition of a gra
+0002ae60: 7068 6963 616c 0a20 2020 2020 2020 2023  phical.        #
+0002ae70: 206f 626a 6563 7420 7769 7468 696e 2074   object within t
+0002ae80: 6865 2077 6f72 6b73 6865 6574 2069 6e20  he worksheet in 
+0002ae90: 454d 5573 2e0a 2020 2020 2020 2020 230a  EMUs..        #.
+0002aea0: 2020 2020 2020 2020 2320 5468 6520 7665          # The ve
+0002aeb0: 7274 6963 6573 2061 7265 2065 7870 7265  rtices are expre
+0002aec0: 7373 6564 2061 7320 456e 676c 6973 6820  ssed as English 
+0002aed0: 4d65 7472 6963 2055 6e69 7473 2028 454d  Metric Units (EM
+0002aee0: 5573 292e 2054 6865 7265 2061 7265 0a20  Us). There are. 
+0002aef0: 2020 2020 2020 2023 2031 322c 3730 3020         # 12,700 
+0002af00: 454d 5573 2070 6572 2070 6f69 6e74 2e20  EMUs per point. 
+0002af10: 5468 6572 6566 6f72 652c 2031 322c 3730  Therefore, 12,70
+0002af20: 3020 2a20 3320 2f34 203d 2039 2c35 3235  0 * 3 /4 = 9,525
+0002af30: 2045 4d55 7320 7065 720a 2020 2020 2020   EMUs per.      
+0002af40: 2020 2320 7069 7865 6c0a 2020 2020 2020    # pixel.      
+0002af50: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
+0002af60: 636f 6c5f 7374 6172 742c 0a20 2020 2020  col_start,.     
+0002af70: 2020 2020 2020 2072 6f77 5f73 7461 7274         row_start
+0002af80: 2c0a 2020 2020 2020 2020 2020 2020 7831  ,.            x1
+0002af90: 2c0a 2020 2020 2020 2020 2020 2020 7931  ,.            y1
+0002afa0: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
+0002afb0: 6c5f 656e 642c 0a20 2020 2020 2020 2020  l_end,.         
+0002afc0: 2020 2072 6f77 5f65 6e64 2c0a 2020 2020     row_end,.    
+0002afd0: 2020 2020 2020 2020 7832 2c0a 2020 2020          x2,.    
+0002afe0: 2020 2020 2020 2020 7932 2c0a 2020 2020          y2,.    
+0002aff0: 2020 2020 2020 2020 785f 6162 732c 0a20          x_abs,. 
+0002b000: 2020 2020 2020 2020 2020 2079 5f61 6273             y_abs
+0002b010: 2c0a 2020 2020 2020 2020 2920 3d20 7365  ,.        ) = se
+0002b020: 6c66 2e5f 706f 7369 7469 6f6e 5f6f 626a  lf._position_obj
+0002b030: 6563 745f 7069 7865 6c73 280a 2020 2020  ect_pixels(.    
+0002b040: 2020 2020 2020 2020 636f 6c5f 7374 6172          col_star
+0002b050: 742c 2072 6f77 5f73 7461 7274 2c20 7831  t, row_start, x1
+0002b060: 2c20 7931 2c20 7769 6474 682c 2068 6569  , y1, width, hei
+0002b070: 6768 742c 2061 6e63 686f 720a 2020 2020  ght, anchor.    
+0002b080: 2020 2020 290a 0a20 2020 2020 2020 2023      )..        #
+0002b090: 2043 6f6e 7665 7274 2074 6865 2070 6978   Convert the pix
+0002b0a0: 656c 2076 616c 7565 7320 746f 2045 4d55  el values to EMU
+0002b0b0: 732e 2053 6565 2061 626f 7665 2e0a 2020  s. See above..  
+0002b0c0: 2020 2020 2020 7831 203d 2069 6e74 2830        x1 = int(0
+0002b0d0: 2e35 202b 2039 3532 3520 2a20 7831 290a  .5 + 9525 * x1).
+0002b0e0: 2020 2020 2020 2020 7931 203d 2069 6e74          y1 = int
+0002b0f0: 2830 2e35 202b 2039 3532 3520 2a20 7931  (0.5 + 9525 * y1
+0002b100: 290a 2020 2020 2020 2020 7832 203d 2069  ).        x2 = i
+0002b110: 6e74 2830 2e35 202b 2039 3532 3520 2a20  nt(0.5 + 9525 * 
+0002b120: 7832 290a 2020 2020 2020 2020 7932 203d  x2).        y2 =
+0002b130: 2069 6e74 2830 2e35 202b 2039 3532 3520   int(0.5 + 9525 
+0002b140: 2a20 7932 290a 2020 2020 2020 2020 785f  * y2).        x_
+0002b150: 6162 7320 3d20 696e 7428 302e 3520 2b20  abs = int(0.5 + 
+0002b160: 3935 3235 202a 2078 5f61 6273 290a 2020  9525 * x_abs).  
+0002b170: 2020 2020 2020 795f 6162 7320 3d20 696e        y_abs = in
+0002b180: 7428 302e 3520 2b20 3935 3235 202a 2079  t(0.5 + 9525 * y
+0002b190: 5f61 6273 290a 0a20 2020 2020 2020 2072  _abs)..        r
+0002b1a0: 6574 7572 6e20 2863 6f6c 5f73 7461 7274  eturn (col_start
+0002b1b0: 2c20 726f 775f 7374 6172 742c 2078 312c  , row_start, x1,
+0002b1c0: 2079 312c 2063 6f6c 5f65 6e64 2c20 726f   y1, col_end, ro
+0002b1d0: 775f 656e 642c 2078 322c 2079 322c 2078  w_end, x2, y2, x
+0002b1e0: 5f61 6273 2c20 795f 6162 7329 0a0a 2020  _abs, y_abs)..  
+0002b1f0: 2020 2320 4361 6c63 756c 6174 6520 7468    # Calculate th
+0002b200: 6520 7665 7274 6963 6573 2074 6861 7420  e vertices that 
+0002b210: 6465 6669 6e65 2074 6865 2070 6f73 6974  define the posit
+0002b220: 696f 6e20 6f66 2061 2067 7261 7068 6963  ion of a graphic
+0002b230: 616c 206f 626a 6563 740a 2020 2020 2320  al object.    # 
+0002b240: 7769 7468 696e 2074 6865 2077 6f72 6b73  within the works
+0002b250: 6865 6574 2069 6e20 7069 7865 6c73 2e0a  heet in pixels..
+0002b260: 2020 2020 230a 2020 2020 2320 2020 2020      #.    #     
+0002b270: 2020 2020 2b2d 2d2d 2d2d 2d2d 2d2d 2d2d      +-----------
+0002b280: 2d2b 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2b0a  -+------------+.
+0002b290: 2020 2020 2320 2020 2020 2020 2020 7c20      #         | 
+0002b2a0: 2020 2020 4120 2020 2020 207c 2020 2020      A      |    
+0002b2b0: 2020 4220 2020 2020 7c0a 2020 2020 2320    B     |.    # 
+0002b2c0: 2020 2b2d 2d2d 2d2d 2b2d 2d2d 2d2d 2d2d    +-----+-------
+0002b2d0: 2d2d 2d2d 2d2b 2d2d 2d2d 2d2d 2d2d 2d2d  -----+----------
+0002b2e0: 2d2d 2b0a 2020 2020 2320 2020 7c20 2020  --+.    #   |   
+0002b2f0: 2020 7c28 7831 2c79 3129 2020 2020 207c    |(x1,y1)     |
+0002b300: 2020 2020 2020 2020 2020 2020 7c0a 2020              |.  
+0002b310: 2020 2320 2020 7c20 2031 2020 7c28 4131    #   |  1  |(A1
+0002b320: 292e 5f5f 5f5f 5f5f 5f7c 5f5f 5f5f 5f5f  )._______|______
+0002b330: 2020 2020 2020 7c0a 2020 2020 2320 2020        |.    #   
+0002b340: 7c20 2020 2020 7c20 2020 207c 2020 2020  |     |    |    
+0002b350: 2020 2020 2020 2020 2020 7c20 2020 2020            |     
+0002b360: 7c0a 2020 2020 2320 2020 7c20 2020 2020  |.    #   |     
+0002b370: 7c20 2020 207c 2020 2020 2020 2020 2020  |    |          
+0002b380: 2020 2020 7c20 2020 2020 7c0a 2020 2020      |     |.    
+0002b390: 2320 2020 2b2d 2d2d 2d2d 2b2d 2d2d 2d7c  #   +-----+----|
+0002b3a0: 2020 2020 4f42 4a45 4354 2020 2020 7c2d      OBJECT    |-
+0002b3b0: 2d2d 2d2d 2b0a 2020 2020 2320 2020 7c20  ----+.    #   | 
+0002b3c0: 2020 2020 7c20 2020 207c 2020 2020 2020      |    |      
+0002b3d0: 2020 2020 2020 2020 7c20 2020 2020 7c0a          |     |.
+0002b3e0: 2020 2020 2320 2020 7c20 2032 2020 7c20      #   |  2  | 
+0002b3f0: 2020 207c 5f5f 5f5f 5f5f 5f5f 5f5f 5f5f     |____________
+0002b400: 5f5f 2e20 2020 2020 7c0a 2020 2020 2320  __.     |.    # 
+0002b410: 2020 7c20 2020 2020 7c20 2020 2020 2020    |     |       
+0002b420: 2020 2020 207c 2020 2020 2020 2020 2842       |        (B
+0002b430: 3229 7c0a 2020 2020 2320 2020 7c20 2020  2)|.    #   |   
+0002b440: 2020 7c20 2020 2020 2020 2020 2020 207c    |            |
+0002b450: 2020 2020 2028 7832 2c79 3229 7c0a 2020       (x2,y2)|.  
+0002b460: 2020 2320 2020 2b2d 2d2d 2d20 2b2d 2d2d    #   +---- +---
+0002b470: 2d2d 2d2d 2d2d 2d2d 2d2b 2d2d 2d2d 2d2d  ---------+------
+0002b480: 2d2d 2d2d 2d2d 2b0a 2020 2020 230a 2020  ------+.    #.  
+0002b490: 2020 2320 4578 616d 706c 6520 6f66 2061    # Example of a
+0002b4a0: 6e20 6f62 6a65 6374 2074 6861 7420 636f  n object that co
+0002b4b0: 7665 7273 2073 6f6d 6520 6f66 2074 6865  vers some of the
+0002b4c0: 2061 7265 6120 6672 6f6d 2063 656c 6c20   area from cell 
+0002b4d0: 4131 2074 6f20 2042 322e 0a20 2020 2023  A1 to  B2..    #
+0002b4e0: 0a20 2020 2023 2042 6173 6564 206f 6e20  .    # Based on 
+0002b4f0: 7468 6520 7769 6474 6820 616e 6420 6865  the width and he
+0002b500: 6967 6874 206f 6620 7468 6520 6f62 6a65  ight of the obje
+0002b510: 6374 2077 6520 6e65 6564 2074 6f20 6361  ct we need to ca
+0002b520: 6c63 756c 6174 6520 3820 7661 7273 3a0a  lculate 8 vars:.
+0002b530: 2020 2020 230a 2020 2020 2320 2020 2020      #.    #     
+0002b540: 636f 6c5f 7374 6172 742c 2072 6f77 5f73  col_start, row_s
+0002b550: 7461 7274 2c20 636f 6c5f 656e 642c 2072  tart, col_end, r
+0002b560: 6f77 5f65 6e64 2c20 7831 2c20 7931 2c20  ow_end, x1, y1, 
+0002b570: 7832 2c20 7932 2e0a 2020 2020 230a 2020  x2, y2..    #.  
+0002b580: 2020 2320 5765 2061 6c73 6f20 6361 6c63    # We also calc
+0002b590: 756c 6174 6520 7468 6520 6162 736f 6c75  ulate the absolu
+0002b5a0: 7465 2078 2061 6e64 2079 2070 6f73 6974  te x and y posit
+0002b5b0: 696f 6e20 6f66 2074 6865 2074 6f70 206c  ion of the top l
+0002b5c0: 6566 7420 7665 7274 6578 206f 660a 2020  eft vertex of.  
+0002b5d0: 2020 2320 7468 6520 6f62 6a65 6374 2e20    # the object. 
+0002b5e0: 5468 6973 2069 7320 7265 7175 6972 6564  This is required
+0002b5f0: 2066 6f72 2069 6d61 6765 732e 0a20 2020   for images..   
+0002b600: 2023 0a20 2020 2023 2054 6865 2077 6964   #.    # The wid
+0002b610: 7468 2061 6e64 2068 6569 6768 7420 6f66  th and height of
+0002b620: 2074 6865 2063 656c 6c73 2074 6861 7420   the cells that 
+0002b630: 7468 6520 6f62 6a65 6374 206f 6363 7570  the object occup
+0002b640: 6965 7320 6361 6e20 6265 0a20 2020 2023  ies can be.    #
+0002b650: 2076 6172 6961 626c 6520 616e 6420 6861   variable and ha
+0002b660: 7665 2074 6f20 6265 2074 616b 656e 2069  ve to be taken i
+0002b670: 6e74 6f20 6163 636f 756e 742e 0a20 2020  nto account..   
+0002b680: 2023 0a20 2020 2023 2054 6865 2076 616c   #.    # The val
+0002b690: 7565 7320 6f66 2063 6f6c 5f73 7461 7274  ues of col_start
+0002b6a0: 2061 6e64 2072 6f77 5f73 7461 7274 2061   and row_start a
+0002b6b0: 7265 2070 6173 7365 6420 696e 2066 726f  re passed in fro
+0002b6c0: 6d20 7468 6520 6361 6c6c 696e 670a 2020  m the calling.  
+0002b6d0: 2020 2320 6675 6e63 7469 6f6e 2e20 5468    # function. Th
+0002b6e0: 6520 7661 6c75 6573 206f 6620 636f 6c5f  e values of col_
+0002b6f0: 656e 6420 616e 6420 726f 775f 656e 6420  end and row_end 
+0002b700: 6172 6520 6361 6c63 756c 6174 6564 2062  are calculated b
+0002b710: 790a 2020 2020 2320 7375 6274 7261 6374  y.    # subtract
+0002b720: 696e 6720 7468 6520 7769 6474 6820 616e  ing the width an
+0002b730: 6420 6865 6967 6874 206f 6620 7468 6520  d height of the 
+0002b740: 6f62 6a65 6374 2066 726f 6d20 7468 6520  object from the 
+0002b750: 7769 6474 6820 616e 640a 2020 2020 2320  width and.    # 
+0002b760: 6865 6967 6874 206f 6620 7468 6520 756e  height of the un
+0002b770: 6465 726c 7969 6e67 2063 656c 6c73 2e0a  derlying cells..
+0002b780: 2020 2020 230a 2020 2020 6465 6620 5f70      #.    def _p
+0002b790: 6f73 6974 696f 6e5f 6f62 6a65 6374 5f70  osition_object_p
+0002b7a0: 6978 656c 7328 0a20 2020 2020 2020 2073  ixels(.        s
+0002b7b0: 656c 662c 2063 6f6c 5f73 7461 7274 2c20  elf, col_start, 
+0002b7c0: 726f 775f 7374 6172 742c 2078 312c 2079  row_start, x1, y
+0002b7d0: 312c 2077 6964 7468 2c20 6865 6967 6874  1, width, height
+0002b7e0: 2c20 616e 6368 6f72 0a20 2020 2029 3a0a  , anchor.    ):.
+0002b7f0: 2020 2020 2020 2020 2320 636f 6c5f 7374          # col_st
+0002b800: 6172 7420 2020 2020 2020 2320 436f 6c20  art       # Col 
+0002b810: 636f 6e74 6169 6e69 6e67 2075 7070 6572  containing upper
+0002b820: 206c 6566 7420 636f 726e 6572 206f 6620   left corner of 
+0002b830: 6f62 6a65 6374 2e0a 2020 2020 2020 2020  object..        
+0002b840: 2320 7831 2020 2020 2020 2020 2020 2020  # x1            
+0002b850: 2020 2320 4469 7374 616e 6365 2074 6f20    # Distance to 
+0002b860: 6c65 6674 2073 6964 6520 6f66 206f 626a  left side of obj
+0002b870: 6563 742e 0a20 2020 2020 2020 2023 0a20  ect..        #. 
+0002b880: 2020 2020 2020 2023 2072 6f77 5f73 7461         # row_sta
+0002b890: 7274 2020 2020 2020 2023 2052 6f77 2063  rt       # Row c
+0002b8a0: 6f6e 7461 696e 696e 6720 746f 7020 6c65  ontaining top le
+0002b8b0: 6674 2063 6f72 6e65 7220 6f66 206f 626a  ft corner of obj
+0002b8c0: 6563 742e 0a20 2020 2020 2020 2023 2079  ect..        # y
+0002b8d0: 3120 2020 2020 2020 2020 2020 2020 2023  1              #
+0002b8e0: 2044 6973 7461 6e63 6520 746f 2074 6f70   Distance to top
+0002b8f0: 206f 6620 6f62 6a65 6374 2e0a 2020 2020   of object..    
+0002b900: 2020 2020 230a 2020 2020 2020 2020 2320      #.        # 
+0002b910: 636f 6c5f 656e 6420 2020 2020 2020 2020  col_end         
+0002b920: 2320 436f 6c20 636f 6e74 6169 6e69 6e67  # Col containing
+0002b930: 206c 6f77 6572 2072 6967 6874 2063 6f72   lower right cor
+0002b940: 6e65 7220 6f66 206f 626a 6563 742e 0a20  ner of object.. 
+0002b950: 2020 2020 2020 2023 2078 3220 2020 2020         # x2     
+0002b960: 2020 2020 2020 2020 2023 2044 6973 7461           # Dista
+0002b970: 6e63 6520 746f 2072 6967 6874 2073 6964  nce to right sid
+0002b980: 6520 6f66 206f 626a 6563 742e 0a20 2020  e of object..   
+0002b990: 2020 2020 2023 0a20 2020 2020 2020 2023       #.        #
+0002b9a0: 2072 6f77 5f65 6e64 2020 2020 2020 2020   row_end        
+0002b9b0: 2023 2052 6f77 2063 6f6e 7461 696e 696e   # Row containin
+0002b9c0: 6720 626f 7474 6f6d 2072 6967 6874 2063  g bottom right c
+0002b9d0: 6f72 6e65 7220 6f66 206f 626a 6563 742e  orner of object.
+0002b9e0: 0a20 2020 2020 2020 2023 2079 3220 2020  .        # y2   
+0002b9f0: 2020 2020 2020 2020 2020 2023 2044 6973             # Dis
+0002ba00: 7461 6e63 6520 746f 2062 6f74 746f 6d20  tance to bottom 
+0002ba10: 6f66 206f 626a 6563 742e 0a20 2020 2020  of object..     
+0002ba20: 2020 2023 0a20 2020 2020 2020 2023 2077     #.        # w
+0002ba30: 6964 7468 2020 2020 2020 2020 2020 2023  idth           #
+0002ba40: 2057 6964 7468 206f 6620 6f62 6a65 6374   Width of object
+0002ba50: 2066 7261 6d65 2e0a 2020 2020 2020 2020   frame..        
+0002ba60: 2320 6865 6967 6874 2020 2020 2020 2020  # height        
+0002ba70: 2020 2320 4865 6967 6874 206f 6620 6f62    # Height of ob
+0002ba80: 6a65 6374 2066 7261 6d65 2e0a 2020 2020  ject frame..    
+0002ba90: 2020 2020 230a 2020 2020 2020 2020 2320      #.        # 
+0002baa0: 785f 6162 7320 2020 2020 2020 2020 2020  x_abs           
+0002bab0: 2320 4162 736f 6c75 7465 2064 6973 7461  # Absolute dista
+0002bac0: 6e63 6520 746f 206c 6566 7420 7369 6465  nce to left side
+0002bad0: 206f 6620 6f62 6a65 6374 2e0a 2020 2020   of object..    
+0002bae0: 2020 2020 2320 795f 6162 7320 2020 2020      # y_abs     
+0002baf0: 2020 2020 2020 2320 4162 736f 6c75 7465        # Absolute
+0002bb00: 2064 6973 7461 6e63 6520 746f 2074 6f70   distance to top
+0002bb10: 2073 6964 6520 6f66 206f 626a 6563 742e   side of object.
+0002bb20: 0a20 2020 2020 2020 2078 5f61 6273 203d  .        x_abs =
+0002bb30: 2030 0a20 2020 2020 2020 2079 5f61 6273   0.        y_abs
+0002bb40: 203d 2030 0a0a 2020 2020 2020 2020 2320   = 0..        # 
+0002bb50: 4164 6a75 7374 2073 7461 7274 2063 6f6c  Adjust start col
+0002bb60: 756d 6e20 666f 7220 6e65 6761 7469 7665  umn for negative
+0002bb70: 206f 6666 7365 7473 2e0a 2020 2020 2020   offsets..      
+0002bb80: 2020 7768 696c 6520 7831 203c 2030 2061    while x1 < 0 a
+0002bb90: 6e64 2063 6f6c 5f73 7461 7274 203e 2030  nd col_start > 0
+0002bba0: 3a0a 2020 2020 2020 2020 2020 2020 7831  :.            x1
+0002bbb0: 202b 3d20 7365 6c66 2e5f 7369 7a65 5f63   += self._size_c
+0002bbc0: 6f6c 2863 6f6c 5f73 7461 7274 202d 2031  ol(col_start - 1
+0002bbd0: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
+0002bbe0: 6c5f 7374 6172 7420 2d3d 2031 0a0a 2020  l_start -= 1..  
+0002bbf0: 2020 2020 2020 2320 4164 6a75 7374 2073        # Adjust s
+0002bc00: 7461 7274 2072 6f77 2066 6f72 206e 6567  tart row for neg
+0002bc10: 6174 6976 6520 6f66 6673 6574 732e 0a20  ative offsets.. 
+0002bc20: 2020 2020 2020 2077 6869 6c65 2079 3120         while y1 
+0002bc30: 3c20 3020 616e 6420 726f 775f 7374 6172  < 0 and row_star
+0002bc40: 7420 3e20 303a 0a20 2020 2020 2020 2020  t > 0:.         
+0002bc50: 2020 2079 3120 2b3d 2073 656c 662e 5f73     y1 += self._s
+0002bc60: 697a 655f 726f 7728 726f 775f 7374 6172  ize_row(row_star
+0002bc70: 7420 2d20 3129 0a20 2020 2020 2020 2020  t - 1).         
+0002bc80: 2020 2072 6f77 5f73 7461 7274 202d 3d20     row_start -= 
+0002bc90: 310a 0a20 2020 2020 2020 2023 2045 6e73  1..        # Ens
+0002bca0: 7572 6520 7468 6174 2074 6865 2069 6d61  ure that the ima
+0002bcb0: 6765 2069 736e 2774 2073 6869 6674 6564  ge isn't shifted
+0002bcc0: 206f 6666 2074 6865 2070 6167 6520 6174   off the page at
+0002bcd0: 2074 6f70 206c 6566 742e 0a20 2020 2020   top left..     
+0002bce0: 2020 2069 6620 7831 203c 2030 3a0a 2020     if x1 < 0:.  
+0002bcf0: 2020 2020 2020 2020 2020 7831 203d 2030            x1 = 0
+0002bd00: 0a0a 2020 2020 2020 2020 6966 2079 3120  ..        if y1 
+0002bd10: 3c20 303a 0a20 2020 2020 2020 2020 2020  < 0:.           
+0002bd20: 2079 3120 3d20 300a 0a20 2020 2020 2020   y1 = 0..       
+0002bd30: 2023 2043 616c 6375 6c61 7465 2074 6865   # Calculate the
+0002bd40: 2061 6273 6f6c 7574 6520 7820 6f66 6673   absolute x offs
+0002bd50: 6574 206f 6620 7468 6520 746f 702d 6c65  et of the top-le
+0002bd60: 6674 2076 6572 7465 782e 0a20 2020 2020  ft vertex..     
+0002bd70: 2020 2069 6620 7365 6c66 2e63 6f6c 5f73     if self.col_s
+0002bd80: 697a 655f 6368 616e 6765 643a 0a20 2020  ize_changed:.   
+0002bd90: 2020 2020 2020 2020 2066 6f72 2063 6f6c           for col
+0002bda0: 5f69 6420 696e 2072 616e 6765 2863 6f6c  _id in range(col
+0002bdb0: 5f73 7461 7274 293a 0a20 2020 2020 2020  _start):.       
+0002bdc0: 2020 2020 2020 2020 2078 5f61 6273 202b           x_abs +
+0002bdd0: 3d20 7365 6c66 2e5f 7369 7a65 5f63 6f6c  = self._size_col
+0002bde0: 2863 6f6c 5f69 6429 0a20 2020 2020 2020  (col_id).       
+0002bdf0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0002be00: 2020 2023 204f 7074 696d 697a 6174 696f     # Optimizatio
+0002be10: 6e20 666f 7220 7768 656e 2074 6865 2063  n for when the c
+0002be20: 6f6c 756d 6e20 7769 6474 6873 2068 6176  olumn widths hav
+0002be30: 656e 2774 2063 6861 6e67 6564 2e0a 2020  en't changed..  
+0002be40: 2020 2020 2020 2020 2020 785f 6162 7320            x_abs 
+0002be50: 2b3d 2073 656c 662e 6465 6661 756c 745f  += self.default_
+0002be60: 636f 6c5f 7069 7865 6c73 202a 2063 6f6c  col_pixels * col
+0002be70: 5f73 7461 7274 0a0a 2020 2020 2020 2020  _start..        
+0002be80: 785f 6162 7320 2b3d 2078 310a 0a20 2020  x_abs += x1..   
+0002be90: 2020 2020 2023 2043 616c 6375 6c61 7465       # Calculate
+0002bea0: 2074 6865 2061 6273 6f6c 7574 6520 7920   the absolute y 
+0002beb0: 6f66 6673 6574 206f 6620 7468 6520 746f  offset of the to
+0002bec0: 702d 6c65 6674 2076 6572 7465 782e 0a20  p-left vertex.. 
+0002bed0: 2020 2020 2020 2069 6620 7365 6c66 2e72         if self.r
+0002bee0: 6f77 5f73 697a 655f 6368 616e 6765 643a  ow_size_changed:
+0002bef0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0002bf00: 2072 6f77 5f69 6420 696e 2072 616e 6765   row_id in range
+0002bf10: 2872 6f77 5f73 7461 7274 293a 0a20 2020  (row_start):.   
+0002bf20: 2020 2020 2020 2020 2020 2020 2079 5f61               y_a
+0002bf30: 6273 202b 3d20 7365 6c66 2e5f 7369 7a65  bs += self._size
+0002bf40: 5f72 6f77 2872 6f77 5f69 6429 0a20 2020  _row(row_id).   
+0002bf50: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0002bf60: 2020 2020 2020 2023 204f 7074 696d 697a         # Optimiz
+0002bf70: 6174 696f 6e20 666f 7220 7768 656e 2074  ation for when t
+0002bf80: 6865 2072 6f77 2068 6569 6768 7473 2068  he row heights h
+0002bf90: 6176 656e 2774 2063 6861 6e67 6564 2e0a  aven't changed..
+0002bfa0: 2020 2020 2020 2020 2020 2020 795f 6162              y_ab
+0002bfb0: 7320 2b3d 2073 656c 662e 6465 6661 756c  s += self.defaul
+0002bfc0: 745f 726f 775f 7069 7865 6c73 202a 2072  t_row_pixels * r
+0002bfd0: 6f77 5f73 7461 7274 0a0a 2020 2020 2020  ow_start..      
+0002bfe0: 2020 795f 6162 7320 2b3d 2079 310a 0a20    y_abs += y1.. 
+0002bff0: 2020 2020 2020 2023 2041 646a 7573 7420         # Adjust 
+0002c000: 7374 6172 7420 636f 6c75 6d6e 2066 6f72  start column for
+0002c010: 206f 6666 7365 7473 2074 6861 7420 6172   offsets that ar
+0002c020: 6520 6772 6561 7465 7220 7468 616e 2074  e greater than t
+0002c030: 6865 2063 6f6c 2077 6964 7468 2e0a 2020  he col width..  
+0002c040: 2020 2020 2020 7768 696c 6520 7831 203e        while x1 >
+0002c050: 3d20 7365 6c66 2e5f 7369 7a65 5f63 6f6c  = self._size_col
+0002c060: 2863 6f6c 5f73 7461 7274 2c20 616e 6368  (col_start, anch
+0002c070: 6f72 293a 0a20 2020 2020 2020 2020 2020  or):.           
+0002c080: 2078 3120 2d3d 2073 656c 662e 5f73 697a   x1 -= self._siz
+0002c090: 655f 636f 6c28 636f 6c5f 7374 6172 7429  e_col(col_start)
+0002c0a0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+0002c0b0: 5f73 7461 7274 202b 3d20 310a 0a20 2020  _start += 1..   
+0002c0c0: 2020 2020 2023 2041 646a 7573 7420 7374       # Adjust st
+0002c0d0: 6172 7420 726f 7720 666f 7220 6f66 6673  art row for offs
+0002c0e0: 6574 7320 7468 6174 2061 7265 2067 7265  ets that are gre
+0002c0f0: 6174 6572 2074 6861 6e20 7468 6520 726f  ater than the ro
+0002c100: 7720 6865 6967 6874 2e0a 2020 2020 2020  w height..      
+0002c110: 2020 7768 696c 6520 7931 203e 3d20 7365    while y1 >= se
+0002c120: 6c66 2e5f 7369 7a65 5f72 6f77 2872 6f77  lf._size_row(row
+0002c130: 5f73 7461 7274 2c20 616e 6368 6f72 293a  _start, anchor):
+0002c140: 0a20 2020 2020 2020 2020 2020 2079 3120  .            y1 
+0002c150: 2d3d 2073 656c 662e 5f73 697a 655f 726f  -= self._size_ro
+0002c160: 7728 726f 775f 7374 6172 7429 0a20 2020  w(row_start).   
+0002c170: 2020 2020 2020 2020 2072 6f77 5f73 7461           row_sta
+0002c180: 7274 202b 3d20 310a 0a20 2020 2020 2020  rt += 1..       
+0002c190: 2023 2049 6e69 7469 616c 697a 6520 656e   # Initialize en
+0002c1a0: 6420 6365 6c6c 2074 6f20 7468 6520 7361  d cell to the sa
+0002c1b0: 6d65 2061 7320 7468 6520 7374 6172 7420  me as the start 
+0002c1c0: 6365 6c6c 2e0a 2020 2020 2020 2020 636f  cell..        co
+0002c1d0: 6c5f 656e 6420 3d20 636f 6c5f 7374 6172  l_end = col_star
+0002c1e0: 740a 2020 2020 2020 2020 726f 775f 656e  t.        row_en
+0002c1f0: 6420 3d20 726f 775f 7374 6172 740a 0a20  d = row_start.. 
+0002c200: 2020 2020 2020 2023 2044 6f6e 2774 206f         # Don't o
+0002c210: 6666 7365 7420 7468 6520 696d 6167 6520  ffset the image 
+0002c220: 696e 2074 6865 2063 656c 6c20 6966 2074  in the cell if t
+0002c230: 6865 2072 6f77 2f63 6f6c 2069 7320 6869  he row/col is hi
+0002c240: 6464 656e 2e0a 2020 2020 2020 2020 6966  dden..        if
+0002c250: 2073 656c 662e 5f73 697a 655f 636f 6c28   self._size_col(
+0002c260: 636f 6c5f 7374 6172 742c 2061 6e63 686f  col_start, ancho
+0002c270: 7229 203e 2030 3a0a 2020 2020 2020 2020  r) > 0:.        
+0002c280: 2020 2020 7769 6474 6820 3d20 7769 6474      width = widt
+0002c290: 6820 2b20 7831 0a20 2020 2020 2020 2069  h + x1.        i
+0002c2a0: 6620 7365 6c66 2e5f 7369 7a65 5f72 6f77  f self._size_row
+0002c2b0: 2872 6f77 5f73 7461 7274 2c20 616e 6368  (row_start, anch
+0002c2c0: 6f72 2920 3e20 303a 0a20 2020 2020 2020  or) > 0:.       
+0002c2d0: 2020 2020 2068 6569 6768 7420 3d20 6865       height = he
+0002c2e0: 6967 6874 202b 2079 310a 0a20 2020 2020  ight + y1..     
+0002c2f0: 2020 2023 2053 7562 7472 6163 7420 7468     # Subtract th
+0002c300: 6520 756e 6465 726c 7969 6e67 2063 656c  e underlying cel
+0002c310: 6c20 7769 6474 6873 2074 6f20 6669 6e64  l widths to find
+0002c320: 2065 6e64 2063 656c 6c20 6f66 2074 6865   end cell of the
+0002c330: 206f 626a 6563 742e 0a20 2020 2020 2020   object..       
+0002c340: 2077 6869 6c65 2077 6964 7468 203e 3d20   while width >= 
+0002c350: 7365 6c66 2e5f 7369 7a65 5f63 6f6c 2863  self._size_col(c
+0002c360: 6f6c 5f65 6e64 2c20 616e 6368 6f72 293a  ol_end, anchor):
+0002c370: 0a20 2020 2020 2020 2020 2020 2077 6964  .            wid
+0002c380: 7468 202d 3d20 7365 6c66 2e5f 7369 7a65  th -= self._size
+0002c390: 5f63 6f6c 2863 6f6c 5f65 6e64 2c20 616e  _col(col_end, an
+0002c3a0: 6368 6f72 290a 2020 2020 2020 2020 2020  chor).          
+0002c3b0: 2020 636f 6c5f 656e 6420 2b3d 2031 0a0a    col_end += 1..
+0002c3c0: 2020 2020 2020 2020 2320 5375 6274 7261          # Subtra
+0002c3d0: 6374 2074 6865 2075 6e64 6572 6c79 696e  ct the underlyin
+0002c3e0: 6720 6365 6c6c 2068 6569 6768 7473 2074  g cell heights t
+0002c3f0: 6f20 6669 6e64 2065 6e64 2063 656c 6c20  o find end cell 
+0002c400: 6f66 2074 6865 206f 626a 6563 742e 0a20  of the object.. 
+0002c410: 2020 2020 2020 2077 6869 6c65 2068 6569         while hei
+0002c420: 6768 7420 3e3d 2073 656c 662e 5f73 697a  ght >= self._siz
+0002c430: 655f 726f 7728 726f 775f 656e 642c 2061  e_row(row_end, a
+0002c440: 6e63 686f 7229 3a0a 2020 2020 2020 2020  nchor):.        
+0002c450: 2020 2020 6865 6967 6874 202d 3d20 7365      height -= se
+0002c460: 6c66 2e5f 7369 7a65 5f72 6f77 2872 6f77  lf._size_row(row
+0002c470: 5f65 6e64 2c20 616e 6368 6f72 290a 2020  _end, anchor).  
+0002c480: 2020 2020 2020 2020 2020 726f 775f 656e            row_en
+0002c490: 6420 2b3d 2031 0a0a 2020 2020 2020 2020  d += 1..        
+0002c4a0: 2320 5468 6520 656e 6420 7665 7274 6963  # The end vertic
+0002c4b0: 6573 2061 7265 2077 6861 7465 7665 7220  es are whatever 
+0002c4c0: 6973 206c 6566 7420 6672 6f6d 2074 6865  is left from the
+0002c4d0: 2077 6964 7468 2061 6e64 2068 6569 6768   width and heigh
+0002c4e0: 742e 0a20 2020 2020 2020 2078 3220 3d20  t..        x2 = 
+0002c4f0: 7769 6474 680a 2020 2020 2020 2020 7932  width.        y2
+0002c500: 203d 2068 6569 6768 740a 0a20 2020 2020   = height..     
+0002c510: 2020 2072 6574 7572 6e20 5b63 6f6c 5f73     return [col_s
+0002c520: 7461 7274 2c20 726f 775f 7374 6172 742c  tart, row_start,
+0002c530: 2078 312c 2079 312c 2063 6f6c 5f65 6e64   x1, y1, col_end
+0002c540: 2c20 726f 775f 656e 642c 2078 322c 2079  , row_end, x2, y
+0002c550: 322c 2078 5f61 6273 2c20 795f 6162 735d  2, x_abs, y_abs]
+0002c560: 0a0a 2020 2020 6465 6620 5f73 697a 655f  ..    def _size_
+0002c570: 636f 6c28 7365 6c66 2c20 636f 6c2c 2061  col(self, col, a
+0002c580: 6e63 686f 723d 3029 3a0a 2020 2020 2020  nchor=0):.      
+0002c590: 2020 2320 436f 6e76 6572 7420 7468 6520    # Convert the 
+0002c5a0: 7769 6474 6820 6f66 2061 2063 656c 6c20  width of a cell 
+0002c5b0: 6672 6f6d 2063 6861 7261 6374 6572 2075  from character u
+0002c5c0: 6e69 7473 2074 6f20 7069 7865 6c73 2e20  nits to pixels. 
+0002c5d0: 4578 6365 6c0a 2020 2020 2020 2020 2320  Excel.        # 
+0002c5e0: 726f 756e 6473 2074 6865 2063 6f6c 756d  rounds the colum
+0002c5f0: 6e20 7769 6474 6820 746f 2074 6865 206e  n width to the n
+0002c600: 6561 7265 7374 2070 6978 656c 2e20 4966  earest pixel. If
+0002c610: 2074 6865 2077 6964 7468 2068 6173 6e27   the width hasn'
+0002c620: 740a 2020 2020 2020 2020 2320 6265 656e  t.        # been
+0002c630: 2073 6574 2062 7920 7468 6520 7573 6572   set by the user
+0002c640: 2077 6520 7573 6520 7468 6520 6465 6661   we use the defa
+0002c650: 756c 7420 7661 6c75 652e 2041 2068 6964  ult value. A hid
+0002c660: 6465 6e20 636f 6c75 6d6e 2069 730a 2020  den column is.  
+0002c670: 2020 2020 2020 2320 7472 6561 7465 6420        # treated 
+0002c680: 6173 2068 6176 696e 6720 6120 7769 6474  as having a widt
+0002c690: 6820 6f66 207a 6572 6f20 756e 6c65 7373  h of zero unless
+0002c6a0: 2069 7420 6861 7320 7468 6520 7370 6563   it has the spec
+0002c6b0: 6961 6c0a 2020 2020 2020 2020 2320 226f  ial.        # "o
+0002c6c0: 626a 6563 745f 706f 7369 7469 6f6e 2220  bject_position" 
+0002c6d0: 6f66 2034 2028 7369 7a65 2077 6974 6820  of 4 (size with 
+0002c6e0: 6365 6c6c 7329 2e0a 2020 2020 2020 2020  cells)..        
+0002c6f0: 6d61 785f 6469 6769 745f 7769 6474 6820  max_digit_width 
+0002c700: 3d20 3720 2023 2046 6f72 2043 616c 6962  = 7  # For Calib
+0002c710: 7269 2031 312e 0a20 2020 2020 2020 2070  ri 11..        p
+0002c720: 6164 6469 6e67 203d 2035 0a20 2020 2020  adding = 5.     
+0002c730: 2020 2070 6978 656c 7320 3d20 300a 0a20     pixels = 0.. 
+0002c740: 2020 2020 2020 2023 204c 6f6f 6b20 7570         # Look up
+0002c750: 2074 6865 2063 656c 6c20 7661 6c75 6520   the cell value 
+0002c760: 746f 2073 6565 2069 6620 6974 2068 6173  to see if it has
+0002c770: 2062 6565 6e20 6368 616e 6765 642e 0a20   been changed.. 
+0002c780: 2020 2020 2020 2069 6620 636f 6c20 696e         if col in
+0002c790: 2073 656c 662e 636f 6c5f 696e 666f 3a0a   self.col_info:.
+0002c7a0: 2020 2020 2020 2020 2020 2020 7769 6474              widt
+0002c7b0: 6820 3d20 7365 6c66 2e63 6f6c 5f69 6e66  h = self.col_inf
+0002c7c0: 6f5b 636f 6c5d 5b30 5d0a 2020 2020 2020  o[col][0].      
+0002c7d0: 2020 2020 2020 6869 6464 656e 203d 2073        hidden = s
+0002c7e0: 656c 662e 636f 6c5f 696e 666f 5b63 6f6c  elf.col_info[col
+0002c7f0: 5d5b 325d 0a0a 2020 2020 2020 2020 2020  ][2]..          
+0002c800: 2020 6966 2077 6964 7468 2069 7320 4e6f    if width is No
+0002c810: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0002c820: 2020 2020 7769 6474 6820 3d20 7365 6c66      width = self
+0002c830: 2e64 6566 6175 6c74 5f63 6f6c 5f77 6964  .default_col_wid
+0002c840: 7468 0a0a 2020 2020 2020 2020 2020 2020  th..            
+0002c850: 2320 436f 6e76 6572 7420 746f 2070 6978  # Convert to pix
+0002c860: 656c 732e 0a20 2020 2020 2020 2020 2020  els..           
+0002c870: 2069 6620 6869 6464 656e 2061 6e64 2061   if hidden and a
+0002c880: 6e63 686f 7220 213d 2034 3a0a 2020 2020  nchor != 4:.    
+0002c890: 2020 2020 2020 2020 2020 2020 7069 7865              pixe
+0002c8a0: 6c73 203d 2030 0a20 2020 2020 2020 2020  ls = 0.         
+0002c8b0: 2020 2065 6c69 6620 7769 6474 6820 3c20     elif width < 
+0002c8c0: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
+0002c8d0: 2020 2070 6978 656c 7320 3d20 696e 7428     pixels = int(
+0002c8e0: 7769 6474 6820 2a20 286d 6178 5f64 6967  width * (max_dig
+0002c8f0: 6974 5f77 6964 7468 202b 2070 6164 6469  it_width + paddi
+0002c900: 6e67 2920 2b20 302e 3529 0a20 2020 2020  ng) + 0.5).     
+0002c910: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0002c920: 2020 2020 2020 2020 2020 2020 2070 6978               pix
+0002c930: 656c 7320 3d20 696e 7428 7769 6474 6820  els = int(width 
+0002c940: 2a20 6d61 785f 6469 6769 745f 7769 6474  * max_digit_widt
+0002c950: 6820 2b20 302e 3529 202b 2070 6164 6469  h + 0.5) + paddi
+0002c960: 6e67 0a20 2020 2020 2020 2065 6c73 653a  ng.        else:
+0002c970: 0a20 2020 2020 2020 2020 2020 2070 6978  .            pix
+0002c980: 656c 7320 3d20 7365 6c66 2e64 6566 6175  els = self.defau
+0002c990: 6c74 5f63 6f6c 5f70 6978 656c 730a 0a20  lt_col_pixels.. 
+0002c9a0: 2020 2020 2020 2072 6574 7572 6e20 7069         return pi
+0002c9b0: 7865 6c73 0a0a 2020 2020 6465 6620 5f73  xels..    def _s
+0002c9c0: 697a 655f 726f 7728 7365 6c66 2c20 726f  ize_row(self, ro
+0002c9d0: 772c 2061 6e63 686f 723d 3029 3a0a 2020  w, anchor=0):.  
+0002c9e0: 2020 2020 2020 2320 436f 6e76 6572 7420        # Convert 
+0002c9f0: 7468 6520 6865 6967 6874 206f 6620 6120  the height of a 
+0002ca00: 6365 6c6c 2066 726f 6d20 6368 6172 6163  cell from charac
+0002ca10: 7465 7220 756e 6974 7320 746f 2070 6978  ter units to pix
+0002ca20: 656c 732e 2049 6620 7468 650a 2020 2020  els. If the.    
+0002ca30: 2020 2020 2320 6865 6967 6874 2068 6173      # height has
+0002ca40: 6e27 7420 6265 656e 2073 6574 2062 7920  n't been set by 
+0002ca50: 7468 6520 7573 6572 2077 6520 7573 6520  the user we use 
+0002ca60: 7468 6520 6465 6661 756c 7420 7661 6c75  the default valu
+0002ca70: 652e 2041 0a20 2020 2020 2020 2023 2068  e. A.        # h
+0002ca80: 6964 6465 6e20 726f 7720 6973 2074 7265  idden row is tre
+0002ca90: 6174 6564 2061 7320 6861 7669 6e67 2061  ated as having a
+0002caa0: 2068 6569 6768 7420 6f66 207a 6572 6f20   height of zero 
+0002cab0: 756e 6c65 7373 2069 7420 6861 7320 7468  unless it has th
+0002cac0: 650a 2020 2020 2020 2020 2320 7370 6563  e.        # spec
+0002cad0: 6961 6c20 226f 626a 6563 745f 706f 7369  ial "object_posi
+0002cae0: 7469 6f6e 2220 6f66 2034 2028 7369 7a65  tion" of 4 (size
+0002caf0: 2077 6974 6820 6365 6c6c 7329 2e0a 2020   with cells)..  
+0002cb00: 2020 2020 2020 7069 7865 6c73 203d 2030        pixels = 0
+0002cb10: 0a0a 2020 2020 2020 2020 2320 4c6f 6f6b  ..        # Look
+0002cb20: 2075 7020 7468 6520 6365 6c6c 2076 616c   up the cell val
+0002cb30: 7565 2074 6f20 7365 6520 6966 2069 7420  ue to see if it 
+0002cb40: 6861 7320 6265 656e 2063 6861 6e67 6564  has been changed
+0002cb50: 0a20 2020 2020 2020 2069 6620 726f 7720  .        if row 
+0002cb60: 696e 2073 656c 662e 726f 775f 7369 7a65  in self.row_size
+0002cb70: 733a 0a20 2020 2020 2020 2020 2020 2068  s:.            h
+0002cb80: 6569 6768 7420 3d20 7365 6c66 2e72 6f77  eight = self.row
+0002cb90: 5f73 697a 6573 5b72 6f77 5d5b 305d 0a20  _sizes[row][0]. 
+0002cba0: 2020 2020 2020 2020 2020 2068 6964 6465             hidde
+0002cbb0: 6e20 3d20 7365 6c66 2e72 6f77 5f73 697a  n = self.row_siz
+0002cbc0: 6573 5b72 6f77 5d5b 315d 0a0a 2020 2020  es[row][1]..    
+0002cbd0: 2020 2020 2020 2020 6966 2068 6964 6465          if hidde
+0002cbe0: 6e20 616e 6420 616e 6368 6f72 2021 3d20  n and anchor != 
+0002cbf0: 343a 0a20 2020 2020 2020 2020 2020 2020  4:.             
+0002cc00: 2020 2070 6978 656c 7320 3d20 300a 2020     pixels = 0.  
+0002cc10: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0002cc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cc30: 7069 7865 6c73 203d 2069 6e74 2834 2e30  pixels = int(4.0
+0002cc40: 202f 2033 2e30 202a 2068 6569 6768 7429   / 3.0 * height)
+0002cc50: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0002cc60: 2020 2020 2020 2020 2020 2070 6978 656c             pixel
+0002cc70: 7320 3d20 696e 7428 342e 3020 2f20 332e  s = int(4.0 / 3.
+0002cc80: 3020 2a20 7365 6c66 2e64 6566 6175 6c74  0 * self.default
+0002cc90: 5f72 6f77 5f68 6569 6768 7429 0a0a 2020  _row_height)..  
+0002cca0: 2020 2020 2020 7265 7475 726e 2070 6978        return pix
+0002ccb0: 656c 730a 0a20 2020 2064 6566 205f 7069  els..    def _pi
+0002ccc0: 7865 6c73 5f74 6f5f 7769 6474 6828 7365  xels_to_width(se
+0002ccd0: 6c66 2c20 7069 7865 6c73 293a 0a20 2020  lf, pixels):.   
+0002cce0: 2020 2020 2023 2043 6f6e 7665 7274 2074       # Convert t
+0002ccf0: 6865 2077 6964 7468 206f 6620 6120 6365  he width of a ce
+0002cd00: 6c6c 2066 726f 6d20 7069 7865 6c73 2074  ll from pixels t
+0002cd10: 6f20 6368 6172 6163 7465 7220 756e 6974  o character unit
+0002cd20: 732e 0a20 2020 2020 2020 206d 6178 5f64  s..        max_d
+0002cd30: 6967 6974 5f77 6964 7468 203d 2037 2e30  igit_width = 7.0
+0002cd40: 2020 2320 466f 7220 4361 6c61 6272 6920    # For Calabri 
+0002cd50: 3131 2e0a 2020 2020 2020 2020 7061 6464  11..        padd
+0002cd60: 696e 6720 3d20 352e 300a 0a20 2020 2020  ing = 5.0..     
+0002cd70: 2020 2069 6620 7069 7865 6c73 203c 3d20     if pixels <= 
+0002cd80: 3132 3a0a 2020 2020 2020 2020 2020 2020  12:.            
+0002cd90: 7769 6474 6820 3d20 7069 7865 6c73 202f  width = pixels /
+0002cda0: 2028 6d61 785f 6469 6769 745f 7769 6474   (max_digit_widt
+0002cdb0: 6820 2b20 7061 6464 696e 6729 0a20 2020  h + padding).   
+0002cdc0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0002cdd0: 2020 2020 2020 2077 6964 7468 203d 2028         width = (
+0002cde0: 7069 7865 6c73 202d 2070 6164 6469 6e67  pixels - padding
+0002cdf0: 2920 2f20 6d61 785f 6469 6769 745f 7769  ) / max_digit_wi
+0002ce00: 6474 680a 0a20 2020 2020 2020 2072 6574  dth..        ret
+0002ce10: 7572 6e20 7769 6474 680a 0a20 2020 2064  urn width..    d
+0002ce20: 6566 205f 7069 7865 6c73 5f74 6f5f 6865  ef _pixels_to_he
+0002ce30: 6967 6874 2873 656c 662c 2070 6978 656c  ight(self, pixel
+0002ce40: 7329 3a0a 2020 2020 2020 2020 2320 436f  s):.        # Co
+0002ce50: 6e76 6572 7420 7468 6520 6865 6967 6874  nvert the height
+0002ce60: 206f 6620 6120 6365 6c6c 2066 726f 6d20   of a cell from 
+0002ce70: 7069 7865 6c73 2074 6f20 6368 6172 6163  pixels to charac
+0002ce80: 7465 7220 756e 6974 732e 0a20 2020 2020  ter units..     
+0002ce90: 2020 2072 6574 7572 6e20 302e 3735 202a     return 0.75 *
+0002cea0: 2070 6978 656c 730a 0a20 2020 2064 6566   pixels..    def
+0002ceb0: 205f 636f 6d6d 656e 745f 7061 7261 6d73   _comment_params
+0002cec0: 2873 656c 662c 2072 6f77 2c20 636f 6c2c  (self, row, col,
+0002ced0: 2073 7472 696e 672c 206f 7074 696f 6e73   string, options
+0002cee0: 293a 0a20 2020 2020 2020 2023 2054 6869  ):.        # Thi
+0002cef0: 7320 6d65 7468 6f64 2068 616e 646c 6573  s method handles
+0002cf00: 2074 6865 2061 6464 6974 696f 6e61 6c20   the additional 
+0002cf10: 6f70 7469 6f6e 616c 2070 6172 616d 6574  optional paramet
+0002cf20: 6572 7320 746f 0a20 2020 2020 2020 2023  ers to.        #
+0002cf30: 2077 7269 7465 5f63 6f6d 6d65 6e74 2829   write_comment()
+0002cf40: 2061 7320 7765 6c6c 2061 7320 6361 6c63   as well as calc
+0002cf50: 756c 6174 696e 6720 7468 6520 636f 6d6d  ulating the comm
+0002cf60: 656e 7420 6f62 6a65 6374 0a20 2020 2020  ent object.     
+0002cf70: 2020 2023 2070 6f73 6974 696f 6e20 616e     # position an
+0002cf80: 6420 7665 7274 6963 6573 2e0a 2020 2020  d vertices..    
+0002cf90: 2020 2020 6465 6661 756c 745f 7769 6474      default_widt
+0002cfa0: 6820 3d20 3132 380a 2020 2020 2020 2020  h = 128.        
+0002cfb0: 6465 6661 756c 745f 6865 6967 6874 203d  default_height =
+0002cfc0: 2037 340a 2020 2020 2020 2020 616e 6368   74.        anch
+0002cfd0: 6f72 203d 2030 0a0a 2020 2020 2020 2020  or = 0..        
+0002cfe0: 7061 7261 6d73 203d 207b 0a20 2020 2020  params = {.     
+0002cff0: 2020 2020 2020 2022 6175 7468 6f72 223a         "author":
+0002d000: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+0002d010: 2020 2022 636f 6c6f 7222 3a20 2223 6666     "color": "#ff
+0002d020: 6666 6531 222c 0a20 2020 2020 2020 2020  ffe1",.         
+0002d030: 2020 2022 7374 6172 745f 6365 6c6c 223a     "start_cell":
+0002d040: 204e 6f6e 652c 0a20 2020 2020 2020 2020   None,.         
+0002d050: 2020 2022 7374 6172 745f 636f 6c22 3a20     "start_col": 
+0002d060: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+0002d070: 2020 2273 7461 7274 5f72 6f77 223a 204e    "start_row": N
+0002d080: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
+0002d090: 2022 7669 7369 626c 6522 3a20 4e6f 6e65   "visible": None
+0002d0a0: 2c0a 2020 2020 2020 2020 2020 2020 2277  ,.            "w
+0002d0b0: 6964 7468 223a 2064 6566 6175 6c74 5f77  idth": default_w
+0002d0c0: 6964 7468 2c0a 2020 2020 2020 2020 2020  idth,.          
+0002d0d0: 2020 2268 6569 6768 7422 3a20 6465 6661    "height": defa
+0002d0e0: 756c 745f 6865 6967 6874 2c0a 2020 2020  ult_height,.    
+0002d0f0: 2020 2020 2020 2020 2278 5f6f 6666 7365          "x_offse
+0002d100: 7422 3a20 4e6f 6e65 2c0a 2020 2020 2020  t": None,.      
+0002d110: 2020 2020 2020 2278 5f73 6361 6c65 223a        "x_scale":
+0002d120: 2031 2c0a 2020 2020 2020 2020 2020 2020   1,.            
+0002d130: 2279 5f6f 6666 7365 7422 3a20 4e6f 6e65  "y_offset": None
+0002d140: 2c0a 2020 2020 2020 2020 2020 2020 2279  ,.            "y
+0002d150: 5f73 6361 6c65 223a 2031 2c0a 2020 2020  _scale": 1,.    
+0002d160: 2020 2020 2020 2020 2266 6f6e 745f 6e61          "font_na
+0002d170: 6d65 223a 2022 5461 686f 6d61 222c 0a20  me": "Tahoma",. 
+0002d180: 2020 2020 2020 2020 2020 2022 666f 6e74             "font
+0002d190: 5f73 697a 6522 3a20 382c 0a20 2020 2020  _size": 8,.     
+0002d1a0: 2020 2020 2020 2022 666f 6e74 5f66 616d         "font_fam
+0002d1b0: 696c 7922 3a20 322c 0a20 2020 2020 2020  ily": 2,.       
+0002d1c0: 207d 0a0a 2020 2020 2020 2020 2320 4f76   }..        # Ov
+0002d1d0: 6572 7772 6974 6520 7468 6520 6465 6661  erwrite the defa
+0002d1e0: 756c 7473 2077 6974 6820 616e 7920 7573  ults with any us
+0002d1f0: 6572 2073 7570 706c 6965 6420 7661 6c75  er supplied valu
+0002d200: 6573 2e20 496e 636f 7272 6563 7420 6f72  es. Incorrect or
+0002d210: 0a20 2020 2020 2020 2023 206d 6973 7370  .        # missp
+0002d220: 656c 6c65 6420 7061 7261 6d65 7465 7273  elled parameters
+0002d230: 2061 7265 2073 696c 656e 746c 7920 6967   are silently ig
+0002d240: 6e6f 7265 642e 0a20 2020 2020 2020 2066  nored..        f
+0002d250: 6f72 206b 6579 2069 6e20 6f70 7469 6f6e  or key in option
+0002d260: 732e 6b65 7973 2829 3a0a 2020 2020 2020  s.keys():.      
+0002d270: 2020 2020 2020 7061 7261 6d73 5b6b 6579        params[key
+0002d280: 5d20 3d20 6f70 7469 6f6e 735b 6b65 795d  ] = options[key]
+0002d290: 0a0a 2020 2020 2020 2020 2320 456e 7375  ..        # Ensu
+0002d2a0: 7265 2074 6861 7420 6120 7769 6474 6820  re that a width 
+0002d2b0: 616e 6420 6865 6967 6874 2068 6176 6520  and height have 
+0002d2c0: 6265 656e 2073 6574 2e0a 2020 2020 2020  been set..      
+0002d2d0: 2020 6966 206e 6f74 2070 6172 616d 735b    if not params[
+0002d2e0: 2277 6964 7468 225d 3a0a 2020 2020 2020  "width"]:.      
+0002d2f0: 2020 2020 2020 7061 7261 6d73 5b22 7769        params["wi
+0002d300: 6474 6822 5d20 3d20 6465 6661 756c 745f  dth"] = default_
+0002d310: 7769 6474 680a 2020 2020 2020 2020 6966  width.        if
+0002d320: 206e 6f74 2070 6172 616d 735b 2268 6569   not params["hei
+0002d330: 6768 7422 5d3a 0a20 2020 2020 2020 2020  ght"]:.         
+0002d340: 2020 2070 6172 616d 735b 2268 6569 6768     params["heigh
+0002d350: 7422 5d20 3d20 6465 6661 756c 745f 6865  t"] = default_he
+0002d360: 6967 6874 0a0a 2020 2020 2020 2020 2320  ight..        # 
+0002d370: 5365 7420 7468 6520 636f 6d6d 656e 7420  Set the comment 
+0002d380: 6261 636b 6772 6f75 6e64 2063 6f6c 6f72  background color
+0002d390: 2e0a 2020 2020 2020 2020 7061 7261 6d73  ..        params
+0002d3a0: 5b22 636f 6c6f 7222 5d20 3d20 786c 5f63  ["color"] = xl_c
+0002d3b0: 6f6c 6f72 2870 6172 616d 735b 2263 6f6c  olor(params["col
+0002d3c0: 6f72 225d 292e 6c6f 7765 7228 290a 0a20  or"]).lower().. 
+0002d3d0: 2020 2020 2020 2023 2043 6f6e 7665 7274         # Convert
+0002d3e0: 2066 726f 6d20 4578 6365 6c20 584d 4c20   from Excel XML 
+0002d3f0: 7374 796c 6520 636f 6c6f 7220 746f 2058  style color to X
+0002d400: 4d4c 2068 746d 6c20 7374 796c 6520 636f  ML html style co
+0002d410: 6c6f 722e 0a20 2020 2020 2020 2070 6172  lor..        par
+0002d420: 616d 735b 2263 6f6c 6f72 225d 203d 2070  ams["color"] = p
+0002d430: 6172 616d 735b 2263 6f6c 6f72 225d 2e72  arams["color"].r
+0002d440: 6570 6c61 6365 2822 6666 222c 2022 2322  eplace("ff", "#"
+0002d450: 2c20 3129 0a0a 2020 2020 2020 2020 2320  , 1)..        # 
+0002d460: 436f 6e76 6572 7420 6120 6365 6c6c 2072  Convert a cell r
+0002d470: 6566 6572 656e 6365 2074 6f20 6120 726f  eference to a ro
+0002d480: 7720 616e 6420 636f 6c75 6d6e 2e0a 2020  w and column..  
+0002d490: 2020 2020 2020 6966 2070 6172 616d 735b        if params[
+0002d4a0: 2273 7461 7274 5f63 656c 6c22 5d20 6973  "start_cell"] is
+0002d4b0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0002d4c0: 2020 2020 2020 2028 7374 6172 745f 726f         (start_ro
+0002d4d0: 772c 2073 7461 7274 5f63 6f6c 2920 3d20  w, start_col) = 
+0002d4e0: 786c 5f63 656c 6c5f 746f 5f72 6f77 636f  xl_cell_to_rowco
+0002d4f0: 6c28 7061 7261 6d73 5b22 7374 6172 745f  l(params["start_
+0002d500: 6365 6c6c 225d 290a 2020 2020 2020 2020  cell"]).        
+0002d510: 2020 2020 7061 7261 6d73 5b22 7374 6172      params["star
+0002d520: 745f 726f 7722 5d20 3d20 7374 6172 745f  t_row"] = start_
+0002d530: 726f 770a 2020 2020 2020 2020 2020 2020  row.            
+0002d540: 7061 7261 6d73 5b22 7374 6172 745f 636f  params["start_co
+0002d550: 6c22 5d20 3d20 7374 6172 745f 636f 6c0a  l"] = start_col.
+0002d560: 0a20 2020 2020 2020 2023 2053 6574 2074  .        # Set t
+0002d570: 6865 2064 6566 6175 6c74 2073 7461 7274  he default start
+0002d580: 2063 656c 6c20 616e 6420 6f66 6673 6574   cell and offset
+0002d590: 7320 666f 7220 7468 6520 636f 6d6d 656e  s for the commen
+0002d5a0: 742e 2054 6865 7365 2061 7265 0a20 2020  t. These are.   
+0002d5b0: 2020 2020 2023 2067 656e 6572 616c 6c79       # generally
+0002d5c0: 2066 6978 6564 2069 6e20 7265 6c61 7469   fixed in relati
+0002d5d0: 6f6e 2074 6f20 7468 6520 7061 7265 6e74  on to the parent
+0002d5e0: 2063 656c 6c2e 2048 6f77 6576 6572 2074   cell. However t
+0002d5f0: 6865 7265 2061 7265 0a20 2020 2020 2020  here are.       
+0002d600: 2023 2073 6f6d 6520 6564 6765 2063 6173   # some edge cas
+0002d610: 6573 2066 6f72 2063 656c 6c73 2061 7420  es for cells at 
+0002d620: 7468 652c 2065 722c 2065 6467 6573 2e0a  the, er, edges..
+0002d630: 2020 2020 2020 2020 726f 775f 6d61 7820          row_max 
+0002d640: 3d20 7365 6c66 2e78 6c73 5f72 6f77 6d61  = self.xls_rowma
+0002d650: 780a 2020 2020 2020 2020 636f 6c5f 6d61  x.        col_ma
+0002d660: 7820 3d20 7365 6c66 2e78 6c73 5f63 6f6c  x = self.xls_col
+0002d670: 6d61 780a 0a20 2020 2020 2020 2069 6620  max..        if 
+0002d680: 7061 7261 6d73 5b22 7374 6172 745f 726f  params["start_ro
+0002d690: 7722 5d20 6973 204e 6f6e 653a 0a20 2020  w"] is None:.   
+0002d6a0: 2020 2020 2020 2020 2069 6620 726f 7720           if row 
+0002d6b0: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
+0002d6c0: 2020 2020 2020 7061 7261 6d73 5b22 7374        params["st
+0002d6d0: 6172 745f 726f 7722 5d20 3d20 300a 2020  art_row"] = 0.  
+0002d6e0: 2020 2020 2020 2020 2020 656c 6966 2072            elif r
+0002d6f0: 6f77 203d 3d20 726f 775f 6d61 7820 2d20  ow == row_max - 
+0002d700: 333a 0a20 2020 2020 2020 2020 2020 2020  3:.             
+0002d710: 2020 2070 6172 616d 735b 2273 7461 7274     params["start
+0002d720: 5f72 6f77 225d 203d 2072 6f77 5f6d 6178  _row"] = row_max
+0002d730: 202d 2037 0a20 2020 2020 2020 2020 2020   - 7.           
+0002d740: 2065 6c69 6620 726f 7720 3d3d 2072 6f77   elif row == row
+0002d750: 5f6d 6178 202d 2032 3a0a 2020 2020 2020  _max - 2:.      
+0002d760: 2020 2020 2020 2020 2020 7061 7261 6d73            params
+0002d770: 5b22 7374 6172 745f 726f 7722 5d20 3d20  ["start_row"] = 
+0002d780: 726f 775f 6d61 7820 2d20 360a 2020 2020  row_max - 6.    
+0002d790: 2020 2020 2020 2020 656c 6966 2072 6f77          elif row
+0002d7a0: 203d 3d20 726f 775f 6d61 7820 2d20 313a   == row_max - 1:
+0002d7b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d7c0: 2070 6172 616d 735b 2273 7461 7274 5f72   params["start_r
+0002d7d0: 6f77 225d 203d 2072 6f77 5f6d 6178 202d  ow"] = row_max -
+0002d7e0: 2035 0a20 2020 2020 2020 2020 2020 2065   5.            e
+0002d7f0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0002d800: 2020 2020 2070 6172 616d 735b 2273 7461       params["sta
+0002d810: 7274 5f72 6f77 225d 203d 2072 6f77 202d  rt_row"] = row -
+0002d820: 2031 0a0a 2020 2020 2020 2020 6966 2070   1..        if p
+0002d830: 6172 616d 735b 2279 5f6f 6666 7365 7422  arams["y_offset"
+0002d840: 5d20 6973 204e 6f6e 653a 0a20 2020 2020  ] is None:.     
+0002d850: 2020 2020 2020 2069 6620 726f 7720 3d3d         if row ==
+0002d860: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+0002d870: 2020 2020 7061 7261 6d73 5b22 795f 6f66      params["y_of
+0002d880: 6673 6574 225d 203d 2032 0a20 2020 2020  fset"] = 2.     
+0002d890: 2020 2020 2020 2065 6c69 6620 726f 7720         elif row 
+0002d8a0: 3d3d 2072 6f77 5f6d 6178 202d 2033 3a0a  == row_max - 3:.
+0002d8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d8c0: 7061 7261 6d73 5b22 795f 6f66 6673 6574  params["y_offset
+0002d8d0: 225d 203d 2031 360a 2020 2020 2020 2020  "] = 16.        
+0002d8e0: 2020 2020 656c 6966 2072 6f77 203d 3d20      elif row == 
+0002d8f0: 726f 775f 6d61 7820 2d20 323a 0a20 2020  row_max - 2:.   
+0002d900: 2020 2020 2020 2020 2020 2020 2070 6172               par
+0002d910: 616d 735b 2279 5f6f 6666 7365 7422 5d20  ams["y_offset"] 
+0002d920: 3d20 3136 0a20 2020 2020 2020 2020 2020  = 16.           
+0002d930: 2065 6c69 6620 726f 7720 3d3d 2072 6f77   elif row == row
+0002d940: 5f6d 6178 202d 2031 3a0a 2020 2020 2020  _max - 1:.      
+0002d950: 2020 2020 2020 2020 2020 7061 7261 6d73            params
+0002d960: 5b22 795f 6f66 6673 6574 225d 203d 2031  ["y_offset"] = 1
+0002d970: 340a 2020 2020 2020 2020 2020 2020 656c  4.            el
+0002d980: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0002d990: 2020 2020 7061 7261 6d73 5b22 795f 6f66      params["y_of
+0002d9a0: 6673 6574 225d 203d 2031 300a 0a20 2020  fset"] = 10..   
+0002d9b0: 2020 2020 2069 6620 7061 7261 6d73 5b22       if params["
+0002d9c0: 7374 6172 745f 636f 6c22 5d20 6973 204e  start_col"] is N
+0002d9d0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0002d9e0: 2069 6620 636f 6c20 3d3d 2063 6f6c 5f6d   if col == col_m
+0002d9f0: 6178 202d 2033 3a0a 2020 2020 2020 2020  ax - 3:.        
+0002da00: 2020 2020 2020 2020 7061 7261 6d73 5b22          params["
+0002da10: 7374 6172 745f 636f 6c22 5d20 3d20 636f  start_col"] = co
+0002da20: 6c5f 6d61 7820 2d20 360a 2020 2020 2020  l_max - 6.      
+0002da30: 2020 2020 2020 656c 6966 2063 6f6c 203d        elif col =
+0002da40: 3d20 636f 6c5f 6d61 7820 2d20 323a 0a20  = col_max - 2:. 
+0002da50: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0002da60: 6172 616d 735b 2273 7461 7274 5f63 6f6c  arams["start_col
+0002da70: 225d 203d 2063 6f6c 5f6d 6178 202d 2035  "] = col_max - 5
+0002da80: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+0002da90: 6620 636f 6c20 3d3d 2063 6f6c 5f6d 6178  f col == col_max
+0002daa0: 202d 2031 3a0a 2020 2020 2020 2020 2020   - 1:.          
+0002dab0: 2020 2020 2020 7061 7261 6d73 5b22 7374        params["st
+0002dac0: 6172 745f 636f 6c22 5d20 3d20 636f 6c5f  art_col"] = col_
+0002dad0: 6d61 7820 2d20 340a 2020 2020 2020 2020  max - 4.        
+0002dae0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002daf0: 2020 2020 2020 2020 2020 7061 7261 6d73            params
+0002db00: 5b22 7374 6172 745f 636f 6c22 5d20 3d20  ["start_col"] = 
+0002db10: 636f 6c20 2b20 310a 0a20 2020 2020 2020  col + 1..       
+0002db20: 2069 6620 7061 7261 6d73 5b22 785f 6f66   if params["x_of
+0002db30: 6673 6574 225d 2069 7320 4e6f 6e65 3a0a  fset"] is None:.
+0002db40: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+0002db50: 6f6c 203d 3d20 636f 6c5f 6d61 7820 2d20  ol == col_max - 
+0002db60: 333a 0a20 2020 2020 2020 2020 2020 2020  3:.             
+0002db70: 2020 2070 6172 616d 735b 2278 5f6f 6666     params["x_off
+0002db80: 7365 7422 5d20 3d20 3439 0a20 2020 2020  set"] = 49.     
+0002db90: 2020 2020 2020 2065 6c69 6620 636f 6c20         elif col 
+0002dba0: 3d3d 2063 6f6c 5f6d 6178 202d 2032 3a0a  == col_max - 2:.
+0002dbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dbc0: 7061 7261 6d73 5b22 785f 6f66 6673 6574  params["x_offset
+0002dbd0: 225d 203d 2034 390a 2020 2020 2020 2020  "] = 49.        
+0002dbe0: 2020 2020 656c 6966 2063 6f6c 203d 3d20      elif col == 
+0002dbf0: 636f 6c5f 6d61 7820 2d20 313a 0a20 2020  col_max - 1:.   
+0002dc00: 2020 2020 2020 2020 2020 2020 2070 6172               par
+0002dc10: 616d 735b 2278 5f6f 6666 7365 7422 5d20  ams["x_offset"] 
+0002dc20: 3d20 3439 0a20 2020 2020 2020 2020 2020  = 49.           
+0002dc30: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0002dc40: 2020 2020 2020 2070 6172 616d 735b 2278         params["x
+0002dc50: 5f6f 6666 7365 7422 5d20 3d20 3135 0a0a  _offset"] = 15..
+0002dc60: 2020 2020 2020 2020 2320 5363 616c 6520          # Scale 
+0002dc70: 7468 6520 7369 7a65 206f 6620 7468 6520  the size of the 
+0002dc80: 636f 6d6d 656e 7420 626f 7820 6966 2072  comment box if r
+0002dc90: 6571 7569 7265 642e 0a20 2020 2020 2020  equired..       
+0002dca0: 2069 6620 7061 7261 6d73 5b22 785f 7363   if params["x_sc
+0002dcb0: 616c 6522 5d3a 0a20 2020 2020 2020 2020  ale"]:.         
+0002dcc0: 2020 2070 6172 616d 735b 2277 6964 7468     params["width
+0002dcd0: 225d 203d 2070 6172 616d 735b 2277 6964  "] = params["wid
+0002dce0: 7468 225d 202a 2070 6172 616d 735b 2278  th"] * params["x
+0002dcf0: 5f73 6361 6c65 225d 0a0a 2020 2020 2020  _scale"]..      
+0002dd00: 2020 6966 2070 6172 616d 735b 2279 5f73    if params["y_s
+0002dd10: 6361 6c65 225d 3a0a 2020 2020 2020 2020  cale"]:.        
+0002dd20: 2020 2020 7061 7261 6d73 5b22 6865 6967      params["heig
+0002dd30: 6874 225d 203d 2070 6172 616d 735b 2268  ht"] = params["h
+0002dd40: 6569 6768 7422 5d20 2a20 7061 7261 6d73  eight"] * params
+0002dd50: 5b22 795f 7363 616c 6522 5d0a 0a20 2020  ["y_scale"]..   
+0002dd60: 2020 2020 2023 2052 6f75 6e64 2074 6865       # Round the
+0002dd70: 2064 696d 656e 7369 6f6e 7320 746f 2074   dimensions to t
+0002dd80: 6865 206e 6561 7265 7374 2070 6978 656c  he nearest pixel
+0002dd90: 2e0a 2020 2020 2020 2020 7061 7261 6d73  ..        params
+0002dda0: 5b22 7769 6474 6822 5d20 3d20 696e 7428  ["width"] = int(
+0002ddb0: 302e 3520 2b20 7061 7261 6d73 5b22 7769  0.5 + params["wi
+0002ddc0: 6474 6822 5d29 0a20 2020 2020 2020 2070  dth"]).        p
+0002ddd0: 6172 616d 735b 2268 6569 6768 7422 5d20  arams["height"] 
+0002dde0: 3d20 696e 7428 302e 3520 2b20 7061 7261  = int(0.5 + para
+0002ddf0: 6d73 5b22 6865 6967 6874 225d 290a 0a20  ms["height"]).. 
+0002de00: 2020 2020 2020 2023 2043 616c 6375 6c61         # Calcula
+0002de10: 7465 2074 6865 2070 6f73 6974 696f 6e73  te the positions
+0002de20: 206f 6620 7468 6520 636f 6d6d 656e 7420   of the comment 
+0002de30: 6f62 6a65 6374 2e0a 2020 2020 2020 2020  object..        
+0002de40: 7665 7274 6963 6573 203d 2073 656c 662e  vertices = self.
+0002de50: 5f70 6f73 6974 696f 6e5f 6f62 6a65 6374  _position_object
+0002de60: 5f70 6978 656c 7328 0a20 2020 2020 2020  _pixels(.       
+0002de70: 2020 2020 2070 6172 616d 735b 2273 7461       params["sta
+0002de80: 7274 5f63 6f6c 225d 2c0a 2020 2020 2020  rt_col"],.      
+0002de90: 2020 2020 2020 7061 7261 6d73 5b22 7374        params["st
+0002dea0: 6172 745f 726f 7722 5d2c 0a20 2020 2020  art_row"],.     
+0002deb0: 2020 2020 2020 2070 6172 616d 735b 2278         params["x
+0002dec0: 5f6f 6666 7365 7422 5d2c 0a20 2020 2020  _offset"],.     
+0002ded0: 2020 2020 2020 2070 6172 616d 735b 2279         params["y
+0002dee0: 5f6f 6666 7365 7422 5d2c 0a20 2020 2020  _offset"],.     
+0002def0: 2020 2020 2020 2070 6172 616d 735b 2277         params["w
+0002df00: 6964 7468 225d 2c0a 2020 2020 2020 2020  idth"],.        
+0002df10: 2020 2020 7061 7261 6d73 5b22 6865 6967      params["heig
+0002df20: 6874 225d 2c0a 2020 2020 2020 2020 2020  ht"],.          
+0002df30: 2020 616e 6368 6f72 2c0a 2020 2020 2020    anchor,.      
+0002df40: 2020 290a 0a20 2020 2020 2020 2023 2041    )..        # A
+0002df50: 6464 2074 6865 2077 6964 7468 2061 6e64  dd the width and
+0002df60: 2068 6569 6768 7420 666f 7220 564d 4c2e   height for VML.
+0002df70: 0a20 2020 2020 2020 2076 6572 7469 6365  .        vertice
+0002df80: 732e 6170 7065 6e64 2870 6172 616d 735b  s.append(params[
+0002df90: 2277 6964 7468 225d 290a 2020 2020 2020  "width"]).      
+0002dfa0: 2020 7665 7274 6963 6573 2e61 7070 656e    vertices.appen
+0002dfb0: 6428 7061 7261 6d73 5b22 6865 6967 6874  d(params["height
+0002dfc0: 225d 290a 0a20 2020 2020 2020 2072 6574  "])..        ret
+0002dfd0: 7572 6e20 5b0a 2020 2020 2020 2020 2020  urn [.          
+0002dfe0: 2020 726f 772c 0a20 2020 2020 2020 2020    row,.         
+0002dff0: 2020 2063 6f6c 2c0a 2020 2020 2020 2020     col,.        
+0002e000: 2020 2020 7374 7269 6e67 2c0a 2020 2020      string,.    
+0002e010: 2020 2020 2020 2020 7061 7261 6d73 5b22          params["
+0002e020: 6175 7468 6f72 225d 2c0a 2020 2020 2020  author"],.      
+0002e030: 2020 2020 2020 7061 7261 6d73 5b22 7669        params["vi
+0002e040: 7369 626c 6522 5d2c 0a20 2020 2020 2020  sible"],.       
+0002e050: 2020 2020 2070 6172 616d 735b 2263 6f6c       params["col
+0002e060: 6f72 225d 2c0a 2020 2020 2020 2020 2020  or"],.          
+0002e070: 2020 7061 7261 6d73 5b22 666f 6e74 5f6e    params["font_n
+0002e080: 616d 6522 5d2c 0a20 2020 2020 2020 2020  ame"],.         
+0002e090: 2020 2070 6172 616d 735b 2266 6f6e 745f     params["font_
+0002e0a0: 7369 7a65 225d 2c0a 2020 2020 2020 2020  size"],.        
+0002e0b0: 2020 2020 7061 7261 6d73 5b22 666f 6e74      params["font
+0002e0c0: 5f66 616d 696c 7922 5d2c 0a20 2020 2020  _family"],.     
+0002e0d0: 2020 205d 202b 205b 7665 7274 6963 6573     ] + [vertices
+0002e0e0: 5d0a 0a20 2020 2064 6566 205f 6275 7474  ]..    def _butt
+0002e0f0: 6f6e 5f70 6172 616d 7328 7365 6c66 2c20  on_params(self, 
+0002e100: 726f 772c 2063 6f6c 2c20 6f70 7469 6f6e  row, col, option
+0002e110: 7329 3a0a 2020 2020 2020 2020 2320 5468  s):.        # Th
+0002e120: 6973 206d 6574 686f 6420 6861 6e64 6c65  is method handle
+0002e130: 7320 7468 6520 7061 7261 6d65 7465 7273  s the parameters
+0002e140: 2070 6173 7365 6420 746f 2069 6e73 6572   passed to inser
+0002e150: 745f 6275 7474 6f6e 2829 2061 7320 7765  t_button() as we
+0002e160: 6c6c 0a20 2020 2020 2020 2023 2061 7320  ll.        # as 
+0002e170: 6361 6c63 756c 6174 696e 6720 7468 6520  calculating the 
+0002e180: 6275 7474 6f6e 206f 626a 6563 7420 706f  button object po
+0002e190: 7369 7469 6f6e 2061 6e64 2076 6572 7469  sition and verti
+0002e1a0: 6365 732e 0a0a 2020 2020 2020 2020 6465  ces...        de
+0002e1b0: 6661 756c 745f 6865 6967 6874 203d 2073  fault_height = s
+0002e1c0: 656c 662e 6465 6661 756c 745f 726f 775f  elf.default_row_
+0002e1d0: 7069 7865 6c73 0a20 2020 2020 2020 2064  pixels.        d
+0002e1e0: 6566 6175 6c74 5f77 6964 7468 203d 2073  efault_width = s
+0002e1f0: 656c 662e 6465 6661 756c 745f 636f 6c5f  elf.default_col_
+0002e200: 7069 7865 6c73 0a20 2020 2020 2020 2061  pixels.        a
+0002e210: 6e63 686f 7220 3d20 300a 0a20 2020 2020  nchor = 0..     
+0002e220: 2020 2062 7574 746f 6e5f 6e75 6d62 6572     button_number
+0002e230: 203d 2031 202b 206c 656e 2873 656c 662e   = 1 + len(self.
+0002e240: 6275 7474 6f6e 735f 6c69 7374 290a 2020  buttons_list).  
+0002e250: 2020 2020 2020 6275 7474 6f6e 203d 207b        button = {
+0002e260: 2272 6f77 223a 2072 6f77 2c20 2263 6f6c  "row": row, "col
+0002e270: 223a 2063 6f6c 2c20 2266 6f6e 7422 3a20  ": col, "font": 
+0002e280: 7b7d 7d0a 2020 2020 2020 2020 7061 7261  {}}.        para
+0002e290: 6d73 203d 207b 7d0a 0a20 2020 2020 2020  ms = {}..       
+0002e2a0: 2023 204f 7665 7277 7269 7465 2074 6865   # Overwrite the
+0002e2b0: 2064 6566 6175 6c74 7320 7769 7468 2061   defaults with a
+0002e2c0: 6e79 2075 7365 7220 7375 7070 6c69 6564  ny user supplied
+0002e2d0: 2076 616c 7565 732e 2049 6e63 6f72 7265   values. Incorre
+0002e2e0: 6374 206f 720a 2020 2020 2020 2020 2320  ct or.        # 
+0002e2f0: 6d69 7373 7065 6c6c 6564 2070 6172 616d  misspelled param
+0002e300: 6574 6572 7320 6172 6520 7369 6c65 6e74  eters are silent
+0002e310: 6c79 2069 676e 6f72 6564 2e0a 2020 2020  ly ignored..    
+0002e320: 2020 2020 666f 7220 6b65 7920 696e 206f      for key in o
+0002e330: 7074 696f 6e73 2e6b 6579 7328 293a 0a20  ptions.keys():. 
+0002e340: 2020 2020 2020 2020 2020 2070 6172 616d             param
+0002e350: 735b 6b65 795d 203d 206f 7074 696f 6e73  s[key] = options
+0002e360: 5b6b 6579 5d0a 0a20 2020 2020 2020 2023  [key]..        #
+0002e370: 2053 6574 2074 6865 2062 7574 746f 6e20   Set the button 
+0002e380: 6361 7074 696f 6e2e 0a20 2020 2020 2020  caption..       
+0002e390: 2063 6170 7469 6f6e 203d 2070 6172 616d   caption = param
+0002e3a0: 732e 6765 7428 2263 6170 7469 6f6e 2229  s.get("caption")
+0002e3b0: 0a0a 2020 2020 2020 2020 2320 5365 7420  ..        # Set 
+0002e3c0: 6120 6465 6661 756c 7420 6361 7074 696f  a default captio
+0002e3d0: 6e20 6966 206e 6f6e 6520 7761 7320 7370  n if none was sp
+0002e3e0: 6563 6966 6965 6420 6279 2075 7365 722e  ecified by user.
+0002e3f0: 0a20 2020 2020 2020 2069 6620 6361 7074  .        if capt
+0002e400: 696f 6e20 6973 204e 6f6e 653a 0a20 2020  ion is None:.   
+0002e410: 2020 2020 2020 2020 2063 6170 7469 6f6e           caption
+0002e420: 203d 2022 4275 7474 6f6e 2025 6422 2025   = "Button %d" %
+0002e430: 2062 7574 746f 6e5f 6e75 6d62 6572 0a0a   button_number..
+0002e440: 2020 2020 2020 2020 6275 7474 6f6e 5b22          button["
+0002e450: 666f 6e74 225d 5b22 6361 7074 696f 6e22  font"]["caption"
+0002e460: 5d20 3d20 6361 7074 696f 6e0a 0a20 2020  ] = caption..   
+0002e470: 2020 2020 2023 2053 6574 2074 6865 206d       # Set the m
+0002e480: 6163 726f 206e 616d 652e 0a20 2020 2020  acro name..     
+0002e490: 2020 2069 6620 7061 7261 6d73 2e67 6574     if params.get
+0002e4a0: 2822 6d61 6372 6f22 293a 0a20 2020 2020  ("macro"):.     
+0002e4b0: 2020 2020 2020 2062 7574 746f 6e5b 226d         button["m
+0002e4c0: 6163 726f 225d 203d 2022 5b30 5d21 2220  acro"] = "[0]!" 
+0002e4d0: 2b20 7061 7261 6d73 5b22 6d61 6372 6f22  + params["macro"
+0002e4e0: 5d0a 2020 2020 2020 2020 656c 7365 3a0a  ].        else:.
+0002e4f0: 2020 2020 2020 2020 2020 2020 6275 7474              butt
+0002e500: 6f6e 5b22 6d61 6372 6f22 5d20 3d20 225b  on["macro"] = "[
+0002e510: 305d 2142 7574 746f 6e25 645f 436c 6963  0]!Button%d_Clic
+0002e520: 6b22 2025 2062 7574 746f 6e5f 6e75 6d62  k" % button_numb
+0002e530: 6572 0a0a 2020 2020 2020 2020 2320 5365  er..        # Se
+0002e540: 7420 7468 6520 616c 7420 7465 7874 2066  t the alt text f
+0002e550: 6f72 2074 6865 2062 7574 746f 6e2e 0a20  or the button.. 
+0002e560: 2020 2020 2020 2062 7574 746f 6e5b 2264         button["d
+0002e570: 6573 6372 6970 7469 6f6e 225d 203d 2070  escription"] = p
+0002e580: 6172 616d 732e 6765 7428 2264 6573 6372  arams.get("descr
+0002e590: 6970 7469 6f6e 2229 0a0a 2020 2020 2020  iption")..      
+0002e5a0: 2020 2320 456e 7375 7265 2074 6861 7420    # Ensure that 
+0002e5b0: 6120 7769 6474 6820 616e 6420 6865 6967  a width and heig
+0002e5c0: 6874 2068 6176 6520 6265 656e 2073 6574  ht have been set
+0002e5d0: 2e0a 2020 2020 2020 2020 7061 7261 6d73  ..        params
+0002e5e0: 5b22 7769 6474 6822 5d20 3d20 7061 7261  ["width"] = para
+0002e5f0: 6d73 2e67 6574 2822 7769 6474 6822 2c20  ms.get("width", 
+0002e600: 6465 6661 756c 745f 7769 6474 6829 0a20  default_width). 
+0002e610: 2020 2020 2020 2070 6172 616d 735b 2268         params["h
+0002e620: 6569 6768 7422 5d20 3d20 7061 7261 6d73  eight"] = params
+0002e630: 2e67 6574 2822 6865 6967 6874 222c 2064  .get("height", d
+0002e640: 6566 6175 6c74 5f68 6569 6768 7429 0a0a  efault_height)..
+0002e650: 2020 2020 2020 2020 2320 5365 7420 7468          # Set th
+0002e660: 6520 782f 7920 6f66 6673 6574 732e 0a20  e x/y offsets.. 
+0002e670: 2020 2020 2020 2070 6172 616d 735b 2278         params["x
+0002e680: 5f6f 6666 7365 7422 5d20 3d20 7061 7261  _offset"] = para
+0002e690: 6d73 2e67 6574 2822 785f 6f66 6673 6574  ms.get("x_offset
+0002e6a0: 222c 2030 290a 2020 2020 2020 2020 7061  ", 0).        pa
+0002e6b0: 7261 6d73 5b22 795f 6f66 6673 6574 225d  rams["y_offset"]
+0002e6c0: 203d 2070 6172 616d 732e 6765 7428 2279   = params.get("y
+0002e6d0: 5f6f 6666 7365 7422 2c20 3029 0a0a 2020  _offset", 0)..  
+0002e6e0: 2020 2020 2020 2320 5363 616c 6520 7468        # Scale th
+0002e6f0: 6520 7369 7a65 206f 6620 7468 6520 6275  e size of the bu
+0002e700: 7474 6f6e 2069 6620 7265 7175 6972 6564  tton if required
+0002e710: 2e0a 2020 2020 2020 2020 7061 7261 6d73  ..        params
+0002e720: 5b22 7769 6474 6822 5d20 3d20 7061 7261  ["width"] = para
+0002e730: 6d73 5b22 7769 6474 6822 5d20 2a20 7061  ms["width"] * pa
+0002e740: 7261 6d73 2e67 6574 2822 785f 7363 616c  rams.get("x_scal
+0002e750: 6522 2c20 3129 0a20 2020 2020 2020 2070  e", 1).        p
+0002e760: 6172 616d 735b 2268 6569 6768 7422 5d20  arams["height"] 
+0002e770: 3d20 7061 7261 6d73 5b22 6865 6967 6874  = params["height
+0002e780: 225d 202a 2070 6172 616d 732e 6765 7428  "] * params.get(
+0002e790: 2279 5f73 6361 6c65 222c 2031 290a 0a20  "y_scale", 1).. 
+0002e7a0: 2020 2020 2020 2023 2052 6f75 6e64 2074         # Round t
+0002e7b0: 6865 2064 696d 656e 7369 6f6e 7320 746f  he dimensions to
+0002e7c0: 2074 6865 206e 6561 7265 7374 2070 6978   the nearest pix
+0002e7d0: 656c 2e0a 2020 2020 2020 2020 7061 7261  el..        para
+0002e7e0: 6d73 5b22 7769 6474 6822 5d20 3d20 696e  ms["width"] = in
+0002e7f0: 7428 302e 3520 2b20 7061 7261 6d73 5b22  t(0.5 + params["
+0002e800: 7769 6474 6822 5d29 0a20 2020 2020 2020  width"]).       
+0002e810: 2070 6172 616d 735b 2268 6569 6768 7422   params["height"
+0002e820: 5d20 3d20 696e 7428 302e 3520 2b20 7061  ] = int(0.5 + pa
+0002e830: 7261 6d73 5b22 6865 6967 6874 225d 290a  rams["height"]).
+0002e840: 0a20 2020 2020 2020 2070 6172 616d 735b  .        params[
+0002e850: 2273 7461 7274 5f72 6f77 225d 203d 2072  "start_row"] = r
+0002e860: 6f77 0a20 2020 2020 2020 2070 6172 616d  ow.        param
+0002e870: 735b 2273 7461 7274 5f63 6f6c 225d 203d  s["start_col"] =
+0002e880: 2063 6f6c 0a0a 2020 2020 2020 2020 2320   col..        # 
+0002e890: 4361 6c63 756c 6174 6520 7468 6520 706f  Calculate the po
+0002e8a0: 7369 7469 6f6e 7320 6f66 2074 6865 2062  sitions of the b
+0002e8b0: 7574 746f 6e20 6f62 6a65 6374 2e0a 2020  utton object..  
+0002e8c0: 2020 2020 2020 7665 7274 6963 6573 203d        vertices =
+0002e8d0: 2073 656c 662e 5f70 6f73 6974 696f 6e5f   self._position_
+0002e8e0: 6f62 6a65 6374 5f70 6978 656c 7328 0a20  object_pixels(. 
+0002e8f0: 2020 2020 2020 2020 2020 2070 6172 616d             param
+0002e900: 735b 2273 7461 7274 5f63 6f6c 225d 2c0a  s["start_col"],.
+0002e910: 2020 2020 2020 2020 2020 2020 7061 7261              para
+0002e920: 6d73 5b22 7374 6172 745f 726f 7722 5d2c  ms["start_row"],
+0002e930: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+0002e940: 616d 735b 2278 5f6f 6666 7365 7422 5d2c  ams["x_offset"],
+0002e950: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+0002e960: 616d 735b 2279 5f6f 6666 7365 7422 5d2c  ams["y_offset"],
+0002e970: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+0002e980: 616d 735b 2277 6964 7468 225d 2c0a 2020  ams["width"],.  
+0002e990: 2020 2020 2020 2020 2020 7061 7261 6d73            params
+0002e9a0: 5b22 6865 6967 6874 225d 2c0a 2020 2020  ["height"],.    
+0002e9b0: 2020 2020 2020 2020 616e 6368 6f72 2c0a          anchor,.
+0002e9c0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0002e9d0: 2020 2023 2041 6464 2074 6865 2077 6964     # Add the wid
+0002e9e0: 7468 2061 6e64 2068 6569 6768 7420 666f  th and height fo
+0002e9f0: 7220 564d 4c2e 0a20 2020 2020 2020 2076  r VML..        v
+0002ea00: 6572 7469 6365 732e 6170 7065 6e64 2870  ertices.append(p
+0002ea10: 6172 616d 735b 2277 6964 7468 225d 290a  arams["width"]).
+0002ea20: 2020 2020 2020 2020 7665 7274 6963 6573          vertices
+0002ea30: 2e61 7070 656e 6428 7061 7261 6d73 5b22  .append(params["
+0002ea40: 6865 6967 6874 225d 290a 0a20 2020 2020  height"])..     
+0002ea50: 2020 2062 7574 746f 6e5b 2276 6572 7469     button["verti
+0002ea60: 6365 7322 5d20 3d20 7665 7274 6963 6573  ces"] = vertices
+0002ea70: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0002ea80: 2062 7574 746f 6e0a 0a20 2020 2064 6566   button..    def
+0002ea90: 205f 7072 6570 6172 655f 766d 6c5f 6f62   _prepare_vml_ob
+0002eaa0: 6a65 6374 7328 0a20 2020 2020 2020 2073  jects(.        s
+0002eab0: 656c 662c 2076 6d6c 5f64 6174 615f 6964  elf, vml_data_id
+0002eac0: 2c20 766d 6c5f 7368 6170 655f 6964 2c20  , vml_shape_id, 
+0002ead0: 766d 6c5f 6472 6177 696e 675f 6964 2c20  vml_drawing_id, 
+0002eae0: 636f 6d6d 656e 745f 6964 0a20 2020 2029  comment_id.    )
+0002eaf0: 3a0a 2020 2020 2020 2020 636f 6d6d 656e  :.        commen
+0002eb00: 7473 203d 205b 5d0a 2020 2020 2020 2020  ts = [].        
+0002eb10: 2320 536f 7274 2074 6865 2063 6f6d 6d65  # Sort the comme
+0002eb20: 6e74 7320 696e 746f 2072 6f77 2f63 6f6c  nts into row/col
+0002eb30: 756d 6e20 6f72 6465 7220 666f 7220 6561  umn order for ea
+0002eb40: 7369 6572 2063 6f6d 7061 7269 736f 6e0a  sier comparison.
+0002eb50: 2020 2020 2020 2020 2320 7465 7374 696e          # testin
+0002eb60: 6720 616e 6420 7365 7420 7468 6520 6578  g and set the ex
+0002eb70: 7465 726e 616c 206c 696e 6b73 2066 6f72  ternal links for
+0002eb80: 2063 6f6d 6d65 6e74 7320 616e 6420 6275   comments and bu
+0002eb90: 7474 6f6e 732e 0a20 2020 2020 2020 2072  ttons..        r
+0002eba0: 6f77 5f6e 756d 7320 3d20 736f 7274 6564  ow_nums = sorted
+0002ebb0: 2873 656c 662e 636f 6d6d 656e 7473 2e6b  (self.comments.k
+0002ebc0: 6579 7328 2929 0a0a 2020 2020 2020 2020  eys())..        
+0002ebd0: 666f 7220 726f 7720 696e 2072 6f77 5f6e  for row in row_n
+0002ebe0: 756d 733a 0a20 2020 2020 2020 2020 2020  ums:.           
+0002ebf0: 2063 6f6c 5f6e 756d 7320 3d20 736f 7274   col_nums = sort
+0002ec00: 6564 2873 656c 662e 636f 6d6d 656e 7473  ed(self.comments
+0002ec10: 5b72 6f77 5d2e 6b65 7973 2829 290a 0a20  [row].keys()).. 
+0002ec20: 2020 2020 2020 2020 2020 2066 6f72 2063             for c
+0002ec30: 6f6c 2069 6e20 636f 6c5f 6e75 6d73 3a0a  ol in col_nums:.
+0002ec40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ec50: 7573 6572 5f6f 7074 696f 6e73 203d 2073  user_options = s
+0002ec60: 656c 662e 636f 6d6d 656e 7473 5b72 6f77  elf.comments[row
+0002ec70: 5d5b 636f 6c5d 0a20 2020 2020 2020 2020  ][col].         
+0002ec80: 2020 2020 2020 2070 6172 616d 7320 3d20         params = 
+0002ec90: 7365 6c66 2e5f 636f 6d6d 656e 745f 7061  self._comment_pa
+0002eca0: 7261 6d73 282a 7573 6572 5f6f 7074 696f  rams(*user_optio
+0002ecb0: 6e73 290a 2020 2020 2020 2020 2020 2020  ns).            
+0002ecc0: 2020 2020 7365 6c66 2e63 6f6d 6d65 6e74      self.comment
+0002ecd0: 735b 726f 775d 5b63 6f6c 5d20 3d20 7061  s[row][col] = pa
+0002ece0: 7261 6d73 0a0a 2020 2020 2020 2020 2020  rams..          
+0002ecf0: 2020 2020 2020 2320 5365 7420 636f 6d6d        # Set comm
+0002ed00: 656e 7420 7669 7369 6269 6c69 7479 2069  ent visibility i
+0002ed10: 6620 7265 7175 6972 6564 2061 6e64 206e  f required and n
+0002ed20: 6f74 2075 7365 7220 6465 6669 6e65 642e  ot user defined.
+0002ed30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ed40: 2069 6620 7365 6c66 2e63 6f6d 6d65 6e74   if self.comment
+0002ed50: 735f 7669 7369 626c 653a 0a20 2020 2020  s_visible:.     
+0002ed60: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002ed70: 6620 7365 6c66 2e63 6f6d 6d65 6e74 735b  f self.comments[
+0002ed80: 726f 775d 5b63 6f6c 5d5b 345d 2069 7320  row][col][4] is 
+0002ed90: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0002eda0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0002edb0: 6c66 2e63 6f6d 6d65 6e74 735b 726f 775d  lf.comments[row]
+0002edc0: 5b63 6f6c 5d5b 345d 203d 2031 0a0a 2020  [col][4] = 1..  
+0002edd0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0002ede0: 5365 7420 636f 6d6d 656e 7420 6175 7468  Set comment auth
+0002edf0: 6f72 2069 6620 6e6f 7420 616c 7265 6164  or if not alread
+0002ee00: 7920 7573 6572 2064 6566 696e 6564 2e0a  y user defined..
+0002ee10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ee20: 6966 2073 656c 662e 636f 6d6d 656e 7473  if self.comments
+0002ee30: 5b72 6f77 5d5b 636f 6c5d 5b33 5d20 6973  [row][col][3] is
+0002ee40: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0002ee50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0002ee60: 636f 6d6d 656e 7473 5b72 6f77 5d5b 636f  comments[row][co
+0002ee70: 6c5d 5b33 5d20 3d20 7365 6c66 2e63 6f6d  l][3] = self.com
+0002ee80: 6d65 6e74 735f 6175 7468 6f72 0a0a 2020  ments_author..  
+0002ee90: 2020 2020 2020 2020 2020 2020 2020 636f                co
+0002eea0: 6d6d 656e 7473 2e61 7070 656e 6428 7365  mments.append(se
+0002eeb0: 6c66 2e63 6f6d 6d65 6e74 735b 726f 775d  lf.comments[row]
+0002eec0: 5b63 6f6c 5d29 0a0a 2020 2020 2020 2020  [col])..        
+0002eed0: 7365 6c66 2e65 7874 6572 6e61 6c5f 766d  self.external_vm
+0002eee0: 6c5f 6c69 6e6b 732e 6170 7065 6e64 280a  l_links.append(.
+0002eef0: 2020 2020 2020 2020 2020 2020 5b22 2f76              ["/v
+0002ef00: 6d6c 4472 6177 696e 6722 2c20 222e 2e2f  mlDrawing", "../
+0002ef10: 6472 6177 696e 6773 2f76 6d6c 4472 6177  drawings/vmlDraw
+0002ef20: 696e 6722 202b 2073 7472 2876 6d6c 5f64  ing" + str(vml_d
+0002ef30: 7261 7769 6e67 5f69 6429 202b 2022 2e76  rawing_id) + ".v
+0002ef40: 6d6c 225d 0a20 2020 2020 2020 2029 0a0a  ml"].        )..
+0002ef50: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0002ef60: 6861 735f 636f 6d6d 656e 7473 3a0a 2020  has_comments:.  
 0002ef70: 2020 2020 2020 2020 2020 7365 6c66 2e63            self.c
-0002ef80: 6f6d 6d65 6e74 735b 726f 775d 5b63 6f6c  omments[row][col
-0002ef90: 5d20 3d20 7061 7261 6d73 0a0a 2020 2020  ] = params..    
-0002efa0: 2020 2020 2020 2020 2020 2020 2320 5365              # Se
-0002efb0: 7420 636f 6d6d 656e 7420 7669 7369 6269  t comment visibi
-0002efc0: 6c69 7479 2069 6620 7265 7175 6972 6564  lity if required
-0002efd0: 2061 6e64 206e 6f74 2075 7365 7220 6465   and not user de
-0002efe0: 6669 6e65 642e 0a20 2020 2020 2020 2020  fined..         
-0002eff0: 2020 2020 2020 2069 6620 7365 6c66 2e63         if self.c
-0002f000: 6f6d 6d65 6e74 735f 7669 7369 626c 653a  omments_visible:
-0002f010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002f020: 2020 2020 2069 6620 7365 6c66 2e63 6f6d       if self.com
-0002f030: 6d65 6e74 735b 726f 775d 5b63 6f6c 5d5b  ments[row][col][
-0002f040: 345d 2069 7320 4e6f 6e65 3a0a 2020 2020  4] is None:.    
-0002f050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f060: 2020 2020 7365 6c66 2e63 6f6d 6d65 6e74      self.comment
-0002f070: 735b 726f 775d 5b63 6f6c 5d5b 345d 203d  s[row][col][4] =
-0002f080: 2031 0a0a 2020 2020 2020 2020 2020 2020   1..            
-0002f090: 2020 2020 2320 5365 7420 636f 6d6d 656e      # Set commen
-0002f0a0: 7420 6175 7468 6f72 2069 6620 6e6f 7420  t author if not 
-0002f0b0: 616c 7265 6164 7920 7573 6572 2064 6566  already user def
-0002f0c0: 696e 6564 2e0a 2020 2020 2020 2020 2020  ined..          
-0002f0d0: 2020 2020 2020 6966 2073 656c 662e 636f        if self.co
-0002f0e0: 6d6d 656e 7473 5b72 6f77 5d5b 636f 6c5d  mments[row][col]
-0002f0f0: 5b33 5d20 6973 204e 6f6e 653a 0a20 2020  [3] is None:.   
-0002f100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f110: 2073 656c 662e 636f 6d6d 656e 7473 5b72   self.comments[r
-0002f120: 6f77 5d5b 636f 6c5d 5b33 5d20 3d20 7365  ow][col][3] = se
-0002f130: 6c66 2e63 6f6d 6d65 6e74 735f 6175 7468  lf.comments_auth
-0002f140: 6f72 0a0a 2020 2020 2020 2020 2020 2020  or..            
-0002f150: 2020 2020 636f 6d6d 656e 7473 2e61 7070      comments.app
-0002f160: 656e 6428 7365 6c66 2e63 6f6d 6d65 6e74  end(self.comment
-0002f170: 735b 726f 775d 5b63 6f6c 5d29 0a0a 2020  s[row][col])..  
-0002f180: 2020 2020 2020 7365 6c66 2e65 7874 6572        self.exter
-0002f190: 6e61 6c5f 766d 6c5f 6c69 6e6b 732e 6170  nal_vml_links.ap
-0002f1a0: 7065 6e64 285b 272f 766d 6c44 7261 7769  pend(['/vmlDrawi
-0002f1b0: 6e67 272c 0a20 2020 2020 2020 2020 2020  ng',.           
-0002f1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f1d0: 2020 2020 2020 2020 2020 2020 2027 2e2e               '..
-0002f1e0: 2f64 7261 7769 6e67 732f 766d 6c44 7261  /drawings/vmlDra
-0002f1f0: 7769 6e67 270a 2020 2020 2020 2020 2020  wing'.          
-0002f200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f210: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
-0002f220: 7374 7228 766d 6c5f 6472 6177 696e 675f  str(vml_drawing_
-0002f230: 6964 290a 2020 2020 2020 2020 2020 2020  id).            
-0002f240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f250: 2020 2020 2020 2020 2020 2020 2b20 272e              + '.
-0002f260: 766d 6c27 5d29 0a0a 2020 2020 2020 2020  vml'])..        
-0002f270: 6966 2073 656c 662e 6861 735f 636f 6d6d  if self.has_comm
-0002f280: 656e 7473 3a0a 2020 2020 2020 2020 2020  ents:.          
-0002f290: 2020 7365 6c66 2e63 6f6d 6d65 6e74 735f    self.comments_
-0002f2a0: 6c69 7374 203d 2063 6f6d 6d65 6e74 730a  list = comments.
-0002f2b0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0002f2c0: 662e 6578 7465 726e 616c 5f63 6f6d 6d65  f.external_comme
-0002f2d0: 6e74 5f6c 696e 6b73 2e61 7070 656e 6428  nt_links.append(
-0002f2e0: 5b27 2f63 6f6d 6d65 6e74 7327 2c0a 2020  ['/comments',.  
-0002f2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f310: 2020 2020 2020 2020 2020 2020 2020 272e                '.
-0002f320: 2e2f 636f 6d6d 656e 7473 270a 2020 2020  ./comments'.    
-0002f330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f350: 2020 2020 2020 2020 2020 2020 2b20 7374              + st
-0002f360: 7228 636f 6d6d 656e 745f 6964 290a 2020  r(comment_id).  
-0002f370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f390: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
-0002f3a0: 272e 786d 6c27 5d29 0a0a 2020 2020 2020  '.xml'])..      
-0002f3b0: 2020 636f 756e 7420 3d20 6c65 6e28 636f    count = len(co
-0002f3c0: 6d6d 656e 7473 290a 2020 2020 2020 2020  mments).        
-0002f3d0: 7374 6172 745f 6461 7461 5f69 6420 3d20  start_data_id = 
-0002f3e0: 766d 6c5f 6461 7461 5f69 640a 0a20 2020  vml_data_id..   
-0002f3f0: 2020 2020 2023 2054 6865 2056 4d4c 206f       # The VML o
-0002f400: 3a69 646d 6170 2064 6174 6120 6964 2063  :idmap data id c
-0002f410: 6f6e 7461 696e 7320 6120 636f 6d6d 6120  ontains a comma 
-0002f420: 7365 7061 7261 7465 6420 7261 6e67 6520  separated range 
-0002f430: 7768 656e 2074 6865 7265 0a20 2020 2020  when there.     
-0002f440: 2020 2023 2069 7320 6d6f 7265 2074 6861     # is more tha
-0002f450: 6e20 6f6e 6520 3130 3234 2062 6c6f 636b  n one 1024 block
-0002f460: 206f 6620 636f 6d6d 656e 7473 2c20 6c69   of comments, li
-0002f470: 6b65 2074 6869 733a 2064 6174 613d 2231  ke this: data="1
-0002f480: 2c32 222e 0a20 2020 2020 2020 2066 6f72  ,2"..        for
-0002f490: 2069 2069 6e20 7261 6e67 6528 696e 7428   i in range(int(
-0002f4a0: 636f 756e 7420 2f20 3130 3234 2929 3a0a  count / 1024)):.
-0002f4b0: 2020 2020 2020 2020 2020 2020 766d 6c5f              vml_
-0002f4c0: 6461 7461 5f69 6420 3d20 2725 732c 2564  data_id = '%s,%d
-0002f4d0: 2720 2520 2876 6d6c 5f64 6174 615f 6964  ' % (vml_data_id
-0002f4e0: 2c20 7374 6172 745f 6461 7461 5f69 6420  , start_data_id 
-0002f4f0: 2b20 6920 2b20 3129 0a0a 2020 2020 2020  + i + 1)..      
-0002f500: 2020 7365 6c66 2e76 6d6c 5f64 6174 615f    self.vml_data_
-0002f510: 6964 203d 2076 6d6c 5f64 6174 615f 6964  id = vml_data_id
-0002f520: 0a20 2020 2020 2020 2073 656c 662e 766d  .        self.vm
-0002f530: 6c5f 7368 6170 655f 6964 203d 2076 6d6c  l_shape_id = vml
-0002f540: 5f73 6861 7065 5f69 640a 0a20 2020 2020  _shape_id..     
-0002f550: 2020 2072 6574 7572 6e20 636f 756e 740a     return count.
-0002f560: 0a20 2020 2064 6566 205f 7072 6570 6172  .    def _prepar
-0002f570: 655f 6865 6164 6572 5f76 6d6c 5f6f 626a  e_header_vml_obj
-0002f580: 6563 7473 2873 656c 662c 2076 6d6c 5f68  ects(self, vml_h
-0002f590: 6561 6465 725f 6964 2c20 766d 6c5f 6472  eader_id, vml_dr
-0002f5a0: 6177 696e 675f 6964 293a 0a20 2020 2020  awing_id):.     
-0002f5b0: 2020 2023 2053 6574 2075 7020 6578 7465     # Set up exte
-0002f5c0: 726e 616c 206c 696e 6b61 6765 2066 6f72  rnal linkage for
-0002f5d0: 2056 4d4c 2068 6561 6465 722f 666f 6f74   VML header/foot
-0002f5e0: 6572 2069 6d61 6765 732e 0a0a 2020 2020  er images...    
-0002f5f0: 2020 2020 7365 6c66 2e76 6d6c 5f68 6561      self.vml_hea
-0002f600: 6465 725f 6964 203d 2076 6d6c 5f68 6561  der_id = vml_hea
-0002f610: 6465 725f 6964 0a0a 2020 2020 2020 2020  der_id..        
-0002f620: 7365 6c66 2e65 7874 6572 6e61 6c5f 766d  self.external_vm
-0002f630: 6c5f 6c69 6e6b 732e 6170 7065 6e64 285b  l_links.append([
-0002f640: 272f 766d 6c44 7261 7769 6e67 272c 0a20  '/vmlDrawing',. 
-0002f650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f670: 2020 2020 2020 2027 2e2e 2f64 7261 7769         '../drawi
-0002f680: 6e67 732f 766d 6c44 7261 7769 6e67 270a  ngs/vmlDrawing'.
-0002f690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f6b0: 2020 2020 2020 2020 2b20 7374 7228 766d          + str(vm
-0002f6c0: 6c5f 6472 6177 696e 675f 6964 2920 2b20  l_drawing_id) + 
-0002f6d0: 272e 766d 6c27 5d29 0a0a 2020 2020 6465  '.vml'])..    de
-0002f6e0: 6620 5f70 7265 7061 7265 5f74 6162 6c65  f _prepare_table
-0002f6f0: 7328 7365 6c66 2c20 7461 626c 655f 6964  s(self, table_id
-0002f700: 2c20 7365 656e 293a 0a20 2020 2020 2020  , seen):.       
-0002f710: 2023 2053 6574 2074 6865 2074 6162 6c65   # Set the table
-0002f720: 2069 6473 2066 6f72 2074 6865 2077 6f72   ids for the wor
-0002f730: 6b73 6865 6574 2074 6162 6c65 732e 0a20  ksheet tables.. 
-0002f740: 2020 2020 2020 2066 6f72 2074 6162 6c65         for table
-0002f750: 2069 6e20 7365 6c66 2e74 6162 6c65 733a   in self.tables:
-0002f760: 0a20 2020 2020 2020 2020 2020 2074 6162  .            tab
-0002f770: 6c65 5b27 6964 275d 203d 2074 6162 6c65  le['id'] = table
-0002f780: 5f69 640a 0a20 2020 2020 2020 2020 2020  _id..           
-0002f790: 2069 6620 7461 626c 652e 6765 7428 276e   if table.get('n
-0002f7a0: 616d 6527 2920 6973 204e 6f6e 653a 0a20  ame') is None:. 
-0002f7b0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0002f7c0: 2053 6574 2061 2064 6566 6175 6c74 206e   Set a default n
-0002f7d0: 616d 652e 0a20 2020 2020 2020 2020 2020  ame..           
-0002f7e0: 2020 2020 2074 6162 6c65 5b27 6e61 6d65       table['name
-0002f7f0: 275d 203d 2027 5461 626c 6527 202b 2073  '] = 'Table' + s
-0002f800: 7472 2874 6162 6c65 5f69 6429 0a0a 2020  tr(table_id)..  
-0002f810: 2020 2020 2020 2020 2020 2320 4368 6563            # Chec
-0002f820: 6b20 666f 7220 6475 706c 6963 6174 6520  k for duplicate 
-0002f830: 7461 626c 6520 6e61 6d65 732e 0a20 2020  table names..   
-0002f840: 2020 2020 2020 2020 206e 616d 6520 3d20           name = 
-0002f850: 7461 626c 655b 276e 616d 6527 5d2e 6c6f  table['name'].lo
-0002f860: 7765 7228 290a 0a20 2020 2020 2020 2020  wer()..         
-0002f870: 2020 2069 6620 6e61 6d65 2069 6e20 7365     if name in se
-0002f880: 656e 3a0a 2020 2020 2020 2020 2020 2020  en:.            
-0002f890: 2020 2020 7261 6973 6520 4475 706c 6963      raise Duplic
-0002f8a0: 6174 6554 6162 6c65 4e61 6d65 280a 2020  ateTableName(.  
-0002f8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f8c0: 2020 2244 7570 6c69 6361 7465 206e 616d    "Duplicate nam
-0002f8d0: 6520 2725 7327 2075 7365 6420 696e 2077  e '%s' used in w
-0002f8e0: 6f72 6b73 6865 6574 2e61 6464 5f74 6162  orksheet.add_tab
-0002f8f0: 6c65 2829 2e22 2025 0a20 2020 2020 2020  le()." %.       
-0002f900: 2020 2020 2020 2020 2020 2020 2074 6162               tab
-0002f910: 6c65 5b27 6e61 6d65 275d 290a 2020 2020  le['name']).    
-0002f920: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0002f930: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0002f940: 656e 5b6e 616d 655d 203d 2054 7275 650a  en[name] = True.
-0002f950: 0a20 2020 2020 2020 2020 2020 2023 2053  .            # S
-0002f960: 746f 7265 2074 6865 206c 696e 6b20 7573  tore the link us
-0002f970: 6564 2066 6f72 2074 6865 2072 656c 7320  ed for the rels 
-0002f980: 6669 6c65 2e0a 2020 2020 2020 2020 2020  file..          
-0002f990: 2020 7365 6c66 2e65 7874 6572 6e61 6c5f    self.external_
-0002f9a0: 7461 626c 655f 6c69 6e6b 732e 6170 7065  table_links.appe
-0002f9b0: 6e64 285b 272f 7461 626c 6527 2c0a 2020  nd(['/table',.  
-0002f9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f9e0: 2020 2020 2020 2020 2020 2020 272e 2e2f              '../
-0002f9f0: 7461 626c 6573 2f74 6162 6c65 270a 2020  tables/table'.  
-0002fa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fa20: 2020 2020 2020 2020 2020 2020 2b20 7374              + st
-0002fa30: 7228 7461 626c 655f 6964 290a 2020 2020  r(table_id).    
-0002fa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fa50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fa60: 2020 2020 2020 2020 2020 2b20 272e 786d            + '.xm
-0002fa70: 6c27 5d29 0a20 2020 2020 2020 2020 2020  l']).           
-0002fa80: 2074 6162 6c65 5f69 6420 2b3d 2031 0a0a   table_id += 1..
-0002fa90: 2020 2020 6465 6620 5f74 6162 6c65 5f66      def _table_f
-0002faa0: 756e 6374 696f 6e5f 746f 5f66 6f72 6d75  unction_to_formu
-0002fab0: 6c61 2873 656c 662c 2066 756e 6374 696f  la(self, functio
-0002fac0: 6e2c 2063 6f6c 5f6e 616d 6529 3a0a 2020  n, col_name):.  
-0002fad0: 2020 2020 2020 2320 436f 6e76 6572 7420        # Convert 
-0002fae0: 6120 7461 626c 6520 746f 7461 6c20 6675  a table total fu
-0002faf0: 6e63 7469 6f6e 2074 6f20 6120 776f 726b  nction to a work
-0002fb00: 7368 6565 7420 666f 726d 756c 612e 0a20  sheet formula.. 
-0002fb10: 2020 2020 2020 2066 6f72 6d75 6c61 203d         formula =
-0002fb20: 2027 270a 0a20 2020 2020 2020 2023 2045   ''..        # E
-0002fb30: 7363 6170 6520 7370 6563 6961 6c20 6368  scape special ch
-0002fb40: 6172 6163 7465 7273 2c20 6173 2072 6571  aracters, as req
-0002fb50: 7569 7265 6420 6279 2045 7863 656c 2e0a  uired by Excel..
-0002fb60: 2020 2020 2020 2020 636f 6c5f 6e61 6d65          col_name
-0002fb70: 203d 2063 6f6c 5f6e 616d 652e 7265 706c   = col_name.repl
-0002fb80: 6163 6528 2227 222c 2022 2727 2229 0a20  ace("'", "''"). 
-0002fb90: 2020 2020 2020 2063 6f6c 5f6e 616d 6520         col_name 
-0002fba0: 3d20 636f 6c5f 6e61 6d65 2e72 6570 6c61  = col_name.repla
-0002fbb0: 6365 2822 2322 2c20 2227 2322 290a 2020  ce("#", "'#").  
-0002fbc0: 2020 2020 2020 636f 6c5f 6e61 6d65 203d        col_name =
-0002fbd0: 2063 6f6c 5f6e 616d 652e 7265 706c 6163   col_name.replac
-0002fbe0: 6528 225d 222c 2022 275d 2229 0a20 2020  e("]", "']").   
-0002fbf0: 2020 2020 2063 6f6c 5f6e 616d 6520 3d20       col_name = 
-0002fc00: 636f 6c5f 6e61 6d65 2e72 6570 6c61 6365  col_name.replace
-0002fc10: 2822 5b22 2c20 2227 5b22 290a 0a20 2020  ("[", "'[")..   
-0002fc20: 2020 2020 2073 7562 746f 7461 6c73 203d       subtotals =
-0002fc30: 207b 0a20 2020 2020 2020 2020 2020 2027   {.            '
-0002fc40: 6176 6572 6167 6527 3a20 3130 312c 0a20  average': 101,. 
-0002fc50: 2020 2020 2020 2020 2020 2027 636f 756e             'coun
-0002fc60: 744e 756d 7327 3a20 3130 322c 0a20 2020  tNums': 102,.   
-0002fc70: 2020 2020 2020 2020 2027 636f 756e 7427           'count'
-0002fc80: 3a20 3130 332c 0a20 2020 2020 2020 2020  : 103,.         
-0002fc90: 2020 2027 6d61 7827 3a20 3130 342c 0a20     'max': 104,. 
-0002fca0: 2020 2020 2020 2020 2020 2027 6d69 6e27             'min'
-0002fcb0: 3a20 3130 352c 0a20 2020 2020 2020 2020  : 105,.         
-0002fcc0: 2020 2027 7374 6444 6576 273a 2031 3037     'stdDev': 107
-0002fcd0: 2c0a 2020 2020 2020 2020 2020 2020 2773  ,.            's
-0002fce0: 756d 273a 2031 3039 2c0a 2020 2020 2020  um': 109,.      
-0002fcf0: 2020 2020 2020 2776 6172 273a 2031 3130        'var': 110
-0002fd00: 2c0a 2020 2020 2020 2020 7d0a 0a20 2020  ,.        }..   
-0002fd10: 2020 2020 2069 6620 6675 6e63 7469 6f6e       if function
-0002fd20: 2069 6e20 7375 6274 6f74 616c 733a 0a20   in subtotals:. 
-0002fd30: 2020 2020 2020 2020 2020 2066 756e 635f             func_
-0002fd40: 6e75 6d20 3d20 7375 6274 6f74 616c 735b  num = subtotals[
-0002fd50: 6675 6e63 7469 6f6e 5d0a 2020 2020 2020  function].      
-0002fd60: 2020 2020 2020 666f 726d 756c 6120 3d20        formula = 
-0002fd70: 2253 5542 544f 5441 4c28 2573 2c5b 2573  "SUBTOTAL(%s,[%s
-0002fd80: 5d29 2220 2520 2866 756e 635f 6e75 6d2c  ])" % (func_num,
-0002fd90: 2063 6f6c 5f6e 616d 6529 0a20 2020 2020   col_name).     
-0002fda0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0002fdb0: 2020 2020 2077 6172 6e28 2255 6e73 7570       warn("Unsup
-0002fdc0: 706f 7274 6564 2066 756e 6374 696f 6e20  ported function 
-0002fdd0: 2725 7327 2069 6e20 6164 645f 7461 626c  '%s' in add_tabl
-0002fde0: 6528 2922 2025 2066 756e 6374 696f 6e29  e()" % function)
-0002fdf0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0002fe00: 2066 6f72 6d75 6c61 0a0a 2020 2020 6465   formula..    de
-0002fe10: 6620 5f73 6574 5f73 7061 726b 5f63 6f6c  f _set_spark_col
-0002fe20: 6f72 2873 656c 662c 2073 7061 726b 6c69  or(self, sparkli
-0002fe30: 6e65 2c20 6f70 7469 6f6e 732c 2075 7365  ne, options, use
-0002fe40: 725f 636f 6c6f 7229 3a0a 2020 2020 2020  r_color):.      
-0002fe50: 2020 2320 5365 7420 7468 6520 7370 6172    # Set the spar
-0002fe60: 6b6c 696e 6520 636f 6c6f 722e 0a20 2020  kline color..   
-0002fe70: 2020 2020 2069 6620 7573 6572 5f63 6f6c       if user_col
-0002fe80: 6f72 206e 6f74 2069 6e20 6f70 7469 6f6e  or not in option
-0002fe90: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
-0002fea0: 6574 7572 6e0a 0a20 2020 2020 2020 2073  eturn..        s
-0002feb0: 7061 726b 6c69 6e65 5b75 7365 725f 636f  parkline[user_co
-0002fec0: 6c6f 725d 203d 207b 2772 6762 273a 2078  lor] = {'rgb': x
-0002fed0: 6c5f 636f 6c6f 7228 6f70 7469 6f6e 735b  l_color(options[
-0002fee0: 7573 6572 5f63 6f6c 6f72 5d29 7d0a 0a20  user_color])}.. 
-0002fef0: 2020 2064 6566 205f 6765 745f 7261 6e67     def _get_rang
-0002ff00: 655f 6461 7461 2873 656c 662c 2072 6f77  e_data(self, row
-0002ff10: 5f73 7461 7274 2c20 636f 6c5f 7374 6172  _start, col_star
-0002ff20: 742c 2072 6f77 5f65 6e64 2c20 636f 6c5f  t, row_end, col_
-0002ff30: 656e 6429 3a0a 2020 2020 2020 2020 2320  end):.        # 
-0002ff40: 5265 7475 726e 7320 6120 7261 6e67 6520  Returns a range 
-0002ff50: 6f66 2064 6174 6120 6672 6f6d 2074 6865  of data from the
-0002ff60: 2077 6f72 6b73 6865 6574 205f 7461 626c   worksheet _tabl
-0002ff70: 6520 746f 2062 6520 7573 6564 2069 6e0a  e to be used in.
-0002ff80: 2020 2020 2020 2020 2320 6368 6172 7420          # chart 
-0002ff90: 6361 6368 6564 2064 6174 612e 2053 7472  cached data. Str
-0002ffa0: 696e 6773 2061 7265 2072 6574 7572 6e65  ings are returne
-0002ffb0: 6420 6173 2053 5354 2069 6473 2061 6e64  d as SST ids and
-0002ffc0: 2064 6563 6f64 6564 0a20 2020 2020 2020   decoded.       
-0002ffd0: 2023 2069 6e20 7468 6520 776f 726b 626f   # in the workbo
-0002ffe0: 6f6b 2e20 5265 7475 726e 204e 6f6e 6520  ok. Return None 
-0002fff0: 666f 7220 6461 7461 2074 6861 7420 646f  for data that do
-00030000: 6573 6e27 7420 6578 6973 7420 7369 6e63  esn't exist sinc
-00030010: 650a 2020 2020 2020 2020 2320 4578 6365  e.        # Exce
-00030020: 6c20 6361 6e20 6368 6172 7420 7365 7269  l can chart seri
-00030030: 6573 2077 6974 6820 6461 7461 206d 6973  es with data mis
-00030040: 7369 6e67 2e0a 0a20 2020 2020 2020 2069  sing...        i
-00030050: 6620 7365 6c66 2e63 6f6e 7374 616e 745f  f self.constant_
-00030060: 6d65 6d6f 7279 3a0a 2020 2020 2020 2020  memory:.        
-00030070: 2020 2020 7265 7475 726e 2028 290a 0a20      return ().. 
-00030080: 2020 2020 2020 2064 6174 6120 3d20 5b5d         data = []
-00030090: 0a0a 2020 2020 2020 2020 2320 4974 6572  ..        # Iter
-000300a0: 6174 6520 7468 726f 7567 6820 7468 6520  ate through the 
-000300b0: 7461 626c 6520 6461 7461 2e0a 2020 2020  table data..    
-000300c0: 2020 2020 666f 7220 726f 775f 6e75 6d20      for row_num 
-000300d0: 696e 2072 616e 6765 2872 6f77 5f73 7461  in range(row_sta
-000300e0: 7274 2c20 726f 775f 656e 6420 2b20 3129  rt, row_end + 1)
-000300f0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-00030100: 5374 6f72 6520 4e6f 6e65 2069 6620 726f  Store None if ro
-00030110: 7720 646f 6573 6e27 7420 6578 6973 742e  w doesn't exist.
-00030120: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00030130: 726f 775f 6e75 6d20 6e6f 7420 696e 2073  row_num not in s
-00030140: 656c 662e 7461 626c 653a 0a20 2020 2020  elf.table:.     
-00030150: 2020 2020 2020 2020 2020 2064 6174 612e             data.
-00030160: 6170 7065 6e64 284e 6f6e 6529 0a20 2020  append(None).   
-00030170: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
-00030180: 7469 6e75 650a 0a20 2020 2020 2020 2020  tinue..         
-00030190: 2020 2066 6f72 2063 6f6c 5f6e 756d 2069     for col_num i
-000301a0: 6e20 7261 6e67 6528 636f 6c5f 7374 6172  n range(col_star
-000301b0: 742c 2063 6f6c 5f65 6e64 202b 2031 293a  t, col_end + 1):
-000301c0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000301d0: 2020 6966 2063 6f6c 5f6e 756d 2069 6e20    if col_num in 
-000301e0: 7365 6c66 2e74 6162 6c65 5b72 6f77 5f6e  self.table[row_n
-000301f0: 756d 5d3a 0a20 2020 2020 2020 2020 2020  um]:.           
-00030200: 2020 2020 2020 2020 2063 656c 6c20 3d20           cell = 
-00030210: 7365 6c66 2e74 6162 6c65 5b72 6f77 5f6e  self.table[row_n
-00030220: 756d 5d5b 636f 6c5f 6e75 6d5d 0a0a 2020  um][col_num]..  
-00030230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030240: 2020 6365 6c6c 5f74 7970 6520 3d20 6365    cell_type = ce
-00030250: 6c6c 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  ll.__class__.__n
-00030260: 616d 655f 5f0a 0a20 2020 2020 2020 2020  ame__..         
-00030270: 2020 2020 2020 2020 2020 2069 6620 6365             if ce
-00030280: 6c6c 5f74 7970 6520 696e 2028 274e 756d  ll_type in ('Num
-00030290: 6265 7227 2c20 2744 6174 6574 696d 6527  ber', 'Datetime'
-000302a0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-000302b0: 2020 2020 2020 2020 2020 2023 2052 6574             # Ret
-000302c0: 7572 6e20 6120 6e75 6d62 6572 2077 6974  urn a number wit
-000302d0: 6820 4578 6365 6c27 7320 7072 6563 6973  h Excel's precis
-000302e0: 696f 6e2e 0a20 2020 2020 2020 2020 2020  ion..           
-000302f0: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-00030300: 612e 6170 7065 6e64 2822 252e 3136 6722  a.append("%.16g"
-00030310: 2025 2063 656c 6c2e 6e75 6d62 6572 290a   % cell.number).
-00030320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00030330: 2020 2020 2065 6c69 6620 6365 6c6c 5f74       elif cell_t
-00030340: 7970 6520 3d3d 2027 5374 7269 6e67 273a  ype == 'String':
-00030350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00030360: 2020 2020 2020 2020 2023 2052 6574 7572           # Retur
-00030370: 6e20 6120 7374 7269 6e67 2066 726f 6d20  n a string from 
-00030380: 6974 2773 2073 6861 7265 6420 7374 7269  it's shared stri
-00030390: 6e67 2069 6e64 6578 2e0a 2020 2020 2020  ng index..      
-000303a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000303b0: 2020 696e 6465 7820 3d20 6365 6c6c 2e73    index = cell.s
-000303c0: 7472 696e 670a 2020 2020 2020 2020 2020  tring.          
-000303d0: 2020 2020 2020 2020 2020 2020 2020 7374                st
-000303e0: 7269 6e67 203d 2073 656c 662e 7374 725f  ring = self.str_
-000303f0: 7461 626c 652e 5f67 6574 5f73 6861 7265  table._get_share
-00030400: 645f 7374 7269 6e67 2869 6e64 6578 290a  d_string(index).
-00030410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00030420: 2020 2020 2020 2020 2064 6174 612e 6170           data.ap
-00030430: 7065 6e64 2873 7472 696e 6729 0a0a 2020  pend(string)..  
-00030440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030450: 2020 656c 6966 2063 656c 6c5f 7479 7065    elif cell_type
-00030460: 2069 6e20 2827 466f 726d 756c 6127 2c20   in ('Formula', 
-00030470: 2741 7272 6179 466f 726d 756c 6127 293a  'ArrayFormula'):
-00030480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00030490: 2020 2020 2020 2020 2023 2052 6574 7572           # Retur
-000304a0: 6e20 7468 6520 666f 726d 756c 6120 7661  n the formula va
-000304b0: 6c75 652e 0a20 2020 2020 2020 2020 2020  lue..           
-000304c0: 2020 2020 2020 2020 2020 2020 2076 616c               val
-000304d0: 7565 203d 2063 656c 6c2e 7661 6c75 650a  ue = cell.value.
-000304e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000304f0: 2020 2020 2020 2020 2069 6620 7661 6c75           if valu
-00030500: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
-00030510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030520: 2020 2020 2020 2076 616c 7565 203d 2030         value = 0
-00030530: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00030540: 2020 2020 2020 2020 2020 6461 7461 2e61            data.a
-00030550: 7070 656e 6428 7661 6c75 6529 0a0a 2020  ppend(value)..  
-00030560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030570: 2020 656c 6966 2063 656c 6c5f 7479 7065    elif cell_type
-00030580: 203d 3d20 2742 6c61 6e6b 273a 0a20 2020   == 'Blank':.   
-00030590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000305a0: 2020 2020 2023 2052 6574 7572 6e20 6120       # Return a 
-000305b0: 656d 7074 7920 6365 6c6c 2e0a 2020 2020  empty cell..    
-000305c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000305d0: 2020 2020 6461 7461 2e61 7070 656e 6428      data.append(
-000305e0: 2727 290a 2020 2020 2020 2020 2020 2020  '').            
-000305f0: 2020 2020 656c 7365 3a0a 0a20 2020 2020      else:..     
-00030600: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00030610: 2053 746f 7265 204e 6f6e 6520 6966 2063   Store None if c
-00030620: 6f6c 756d 6e20 646f 6573 6e27 7420 6578  olumn doesn't ex
-00030630: 6973 742e 0a20 2020 2020 2020 2020 2020  ist..           
-00030640: 2020 2020 2020 2020 2064 6174 612e 6170           data.ap
-00030650: 7065 6e64 284e 6f6e 6529 0a0a 2020 2020  pend(None)..    
-00030660: 2020 2020 7265 7475 726e 2064 6174 610a      return data.
-00030670: 0a20 2020 2064 6566 205f 6373 765f 6a6f  .    def _csv_jo
-00030680: 696e 2873 656c 662c 202a 6974 656d 7329  in(self, *items)
-00030690: 3a0a 2020 2020 2020 2020 2320 4372 6561  :.        # Crea
-000306a0: 7465 2061 2063 7376 2073 7472 696e 6720  te a csv string 
-000306b0: 666f 7220 7573 6520 7769 7468 2064 6174  for use with dat
-000306c0: 6120 7661 6c69 6461 7469 6f6e 2066 6f72  a validation for
-000306d0: 6d75 6c61 7320 616e 6420 6c69 7374 732e  mulas and lists.
-000306e0: 0a0a 2020 2020 2020 2020 2320 436f 6e76  ..        # Conv
-000306f0: 6572 7420 6e6f 6e20 7374 7269 6e67 2074  ert non string t
-00030700: 7970 6573 2074 6f20 7374 7269 6e67 2e0a  ypes to string..
-00030710: 2020 2020 2020 2020 6974 656d 7320 3d20          items = 
-00030720: 5b73 7472 2869 7465 6d29 2069 6620 6e6f  [str(item) if no
-00030730: 7420 6973 696e 7374 616e 6365 2869 7465  t isinstance(ite
-00030740: 6d2c 2073 7472 2920 656c 7365 2069 7465  m, str) else ite
-00030750: 6d0a 2020 2020 2020 2020 2020 2020 2020  m.              
-00030760: 2020 2066 6f72 2069 7465 6d20 696e 2069     for item in i
-00030770: 7465 6d73 5d0a 0a20 2020 2020 2020 2072  tems]..        r
-00030780: 6574 7572 6e20 272c 272e 6a6f 696e 2869  eturn ','.join(i
-00030790: 7465 6d73 290a 0a20 2020 2064 6566 205f  tems)..    def _
-000307a0: 6573 6361 7065 5f75 726c 2873 656c 662c  escape_url(self,
-000307b0: 2075 726c 293a 0a20 2020 2020 2020 2023   url):.        #
-000307c0: 2044 6f6e 2774 2065 7363 6170 6520 5552   Don't escape UR
-000307d0: 4c20 6966 2069 7420 6c6f 6f6b 7320 616c  L if it looks al
-000307e0: 7265 6164 7920 6573 6361 7065 642e 0a20  ready escaped.. 
-000307f0: 2020 2020 2020 2069 6620 7265 2e73 6561         if re.sea
-00030800: 7263 6828 2725 5b30 2d39 612d 6641 2d46  rch('%[0-9a-fA-F
-00030810: 5d7b 327d 272c 2075 726c 293a 0a20 2020  ]{2}', url):.   
-00030820: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00030830: 7572 6c0a 0a20 2020 2020 2020 2023 2043  url..        # C
-00030840: 616e 2774 2075 7365 2075 726c 2e71 756f  an't use url.quo
-00030850: 7465 2829 2068 6572 6520 6265 6361 7573  te() here becaus
-00030860: 6520 6974 2064 6f65 736e 2774 206d 6174  e it doesn't mat
-00030870: 6368 2045 7863 656c 2e0a 2020 2020 2020  ch Excel..      
-00030880: 2020 7572 6c20 3d20 7572 6c2e 7265 706c    url = url.repl
-00030890: 6163 6528 2725 272c 2027 2532 3527 290a  ace('%', '%25').
-000308a0: 2020 2020 2020 2020 7572 6c20 3d20 7572          url = ur
-000308b0: 6c2e 7265 706c 6163 6528 2722 272c 2027  l.replace('"', '
-000308c0: 2532 3227 290a 2020 2020 2020 2020 7572  %22').        ur
-000308d0: 6c20 3d20 7572 6c2e 7265 706c 6163 6528  l = url.replace(
-000308e0: 2720 272c 2027 2532 3027 290a 2020 2020  ' ', '%20').    
-000308f0: 2020 2020 7572 6c20 3d20 7572 6c2e 7265      url = url.re
-00030900: 706c 6163 6528 273c 272c 2027 2533 6327  place('<', '%3c'
-00030910: 290a 2020 2020 2020 2020 7572 6c20 3d20  ).        url = 
-00030920: 7572 6c2e 7265 706c 6163 6528 273e 272c  url.replace('>',
-00030930: 2027 2533 6527 290a 2020 2020 2020 2020   '%3e').        
-00030940: 7572 6c20 3d20 7572 6c2e 7265 706c 6163  url = url.replac
-00030950: 6528 275b 272c 2027 2535 6227 290a 2020  e('[', '%5b').  
-00030960: 2020 2020 2020 7572 6c20 3d20 7572 6c2e        url = url.
-00030970: 7265 706c 6163 6528 275d 272c 2027 2535  replace(']', '%5
-00030980: 6427 290a 2020 2020 2020 2020 7572 6c20  d').        url 
-00030990: 3d20 7572 6c2e 7265 706c 6163 6528 275e  = url.replace('^
-000309a0: 272c 2027 2535 6527 290a 2020 2020 2020  ', '%5e').      
-000309b0: 2020 7572 6c20 3d20 7572 6c2e 7265 706c    url = url.repl
-000309c0: 6163 6528 2760 272c 2027 2536 3027 290a  ace('`', '%60').
-000309d0: 2020 2020 2020 2020 7572 6c20 3d20 7572          url = ur
-000309e0: 6c2e 7265 706c 6163 6528 277b 272c 2027  l.replace('{', '
-000309f0: 2537 6227 290a 2020 2020 2020 2020 7572  %7b').        ur
-00030a00: 6c20 3d20 7572 6c2e 7265 706c 6163 6528  l = url.replace(
-00030a10: 277d 272c 2027 2537 6427 290a 0a20 2020  '}', '%7d')..   
-00030a20: 2020 2020 2072 6574 7572 6e20 7572 6c0a       return url.
-00030a30: 0a20 2020 2064 6566 205f 6765 745f 6472  .    def _get_dr
-00030a40: 6177 696e 675f 7265 6c5f 696e 6465 7828  awing_rel_index(
-00030a50: 7365 6c66 2c20 7461 7267 6574 3d4e 6f6e  self, target=Non
-00030a60: 6529 3a0a 2020 2020 2020 2020 2320 4765  e):.        # Ge
-00030a70: 7420 7468 6520 696e 6465 7820 7573 6564  t the index used
-00030a80: 2074 6f20 6164 6472 6573 7320 6120 6472   to address a dr
-00030a90: 6177 696e 6720 7265 6c20 6c69 6e6b 2e0a  awing rel link..
-00030aa0: 2020 2020 2020 2020 6966 2074 6172 6765          if targe
-00030ab0: 7420 6973 204e 6f6e 653a 0a20 2020 2020  t is None:.     
-00030ac0: 2020 2020 2020 2073 656c 662e 6472 6177         self.draw
-00030ad0: 696e 675f 7265 6c73 5f69 6420 2b3d 2031  ing_rels_id += 1
-00030ae0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00030af0: 7572 6e20 7365 6c66 2e64 7261 7769 6e67  urn self.drawing
-00030b00: 5f72 656c 735f 6964 0a20 2020 2020 2020  _rels_id.       
-00030b10: 2065 6c69 6620 7365 6c66 2e64 7261 7769   elif self.drawi
-00030b20: 6e67 5f72 656c 732e 6765 7428 7461 7267  ng_rels.get(targ
-00030b30: 6574 293a 0a20 2020 2020 2020 2020 2020  et):.           
-00030b40: 2072 6574 7572 6e20 7365 6c66 2e64 7261   return self.dra
-00030b50: 7769 6e67 5f72 656c 735b 7461 7267 6574  wing_rels[target
-00030b60: 5d0a 2020 2020 2020 2020 656c 7365 3a0a  ].        else:.
-00030b70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00030b80: 2e64 7261 7769 6e67 5f72 656c 735f 6964  .drawing_rels_id
-00030b90: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
-00030ba0: 2020 7365 6c66 2e64 7261 7769 6e67 5f72    self.drawing_r
-00030bb0: 656c 735b 7461 7267 6574 5d20 3d20 7365  els[target] = se
-00030bc0: 6c66 2e64 7261 7769 6e67 5f72 656c 735f  lf.drawing_rels_
-00030bd0: 6964 0a20 2020 2020 2020 2020 2020 2072  id.            r
-00030be0: 6574 7572 6e20 7365 6c66 2e64 7261 7769  eturn self.drawi
-00030bf0: 6e67 5f72 656c 735f 6964 0a0a 2020 2020  ng_rels_id..    
-00030c00: 6465 6620 5f67 6574 5f76 6d6c 5f64 7261  def _get_vml_dra
-00030c10: 7769 6e67 5f72 656c 5f69 6e64 6578 2873  wing_rel_index(s
-00030c20: 656c 662c 2074 6172 6765 743d 4e6f 6e65  elf, target=None
-00030c30: 293a 0a20 2020 2020 2020 2023 2047 6574  ):.        # Get
-00030c40: 2074 6865 2069 6e64 6578 2075 7365 6420   the index used 
-00030c50: 746f 2061 6464 7265 7373 2061 2076 6d6c  to address a vml
-00030c60: 2064 7261 7769 6e67 2072 656c 206c 696e   drawing rel lin
-00030c70: 6b2e 0a20 2020 2020 2020 2069 6620 7365  k..        if se
-00030c80: 6c66 2e76 6d6c 5f64 7261 7769 6e67 5f72  lf.vml_drawing_r
-00030c90: 656c 732e 6765 7428 7461 7267 6574 293a  els.get(target):
-00030ca0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00030cb0: 7572 6e20 7365 6c66 2e76 6d6c 5f64 7261  urn self.vml_dra
-00030cc0: 7769 6e67 5f72 656c 735b 7461 7267 6574  wing_rels[target
-00030cd0: 5d0a 2020 2020 2020 2020 656c 7365 3a0a  ].        else:.
-00030ce0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00030cf0: 2e76 6d6c 5f64 7261 7769 6e67 5f72 656c  .vml_drawing_rel
-00030d00: 735f 6964 202b 3d20 310a 2020 2020 2020  s_id += 1.      
-00030d10: 2020 2020 2020 7365 6c66 2e76 6d6c 5f64        self.vml_d
-00030d20: 7261 7769 6e67 5f72 656c 735b 7461 7267  rawing_rels[targ
-00030d30: 6574 5d20 3d20 7365 6c66 2e76 6d6c 5f64  et] = self.vml_d
-00030d40: 7261 7769 6e67 5f72 656c 735f 6964 0a20  rawing_rels_id. 
-00030d50: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00030d60: 6e20 7365 6c66 2e76 6d6c 5f64 7261 7769  n self.vml_drawi
-00030d70: 6e67 5f72 656c 735f 6964 0a0a 2020 2020  ng_rels_id..    
-00030d80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00030d90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00030da0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00030db0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00030dc0: 2323 2323 2323 2323 2323 230a 2020 2020  ###########.    
-00030dd0: 230a 2020 2020 2320 5468 6520 666f 6c6c  #.    # The foll
-00030de0: 6f77 696e 6720 666f 6e74 206d 6574 686f  owing font metho
-00030df0: 6473 2061 7265 2c20 6d6f 7265 206f 7220  ds are, more or 
-00030e00: 6c65 7373 2c20 6475 706c 6963 6174 6564  less, duplicated
-00030e10: 2066 726f 6d20 7468 650a 2020 2020 2320   from the.    # 
-00030e20: 5374 796c 6573 2063 6c61 7373 2e20 4e6f  Styles class. No
-00030e30: 7420 7468 6520 636c 6561 6e65 7374 2076  t the cleanest v
-00030e40: 6572 7369 6f6e 206f 6620 7265 7573 6520  ersion of reuse 
-00030e50: 6275 7420 776f 726b 7320 666f 7220 6e6f  but works for no
-00030e60: 772e 0a20 2020 2023 0a20 2020 2023 2323  w..    #.    ###
-00030e70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00030e80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00030e90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00030ea0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00030eb0: 2323 2323 2323 2323 0a20 2020 2064 6566  ########.    def
-00030ec0: 205f 7772 6974 655f 666f 6e74 2873 656c   _write_font(sel
-00030ed0: 662c 2078 665f 666f 726d 6174 293a 0a20  f, xf_format):. 
-00030ee0: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
-00030ef0: 6865 203c 666f 6e74 3e20 656c 656d 656e  he <font> elemen
-00030f00: 742e 0a20 2020 2020 2020 2078 6d6c 5f77  t..        xml_w
-00030f10: 7269 7465 7220 3d20 7365 6c66 2e72 7374  riter = self.rst
-00030f20: 7269 6e67 0a0a 2020 2020 2020 2020 786d  ring..        xm
-00030f30: 6c5f 7772 6974 6572 2e5f 786d 6c5f 7374  l_writer._xml_st
-00030f40: 6172 745f 7461 6728 2772 5072 2729 0a0a  art_tag('rPr')..
-00030f50: 2020 2020 2020 2020 2320 4861 6e64 6c65          # Handle
-00030f60: 2074 6865 206d 6169 6e20 666f 6e74 2070   the main font p
-00030f70: 726f 7065 7274 6965 732e 0a20 2020 2020  roperties..     
-00030f80: 2020 2069 6620 7866 5f66 6f72 6d61 742e     if xf_format.
-00030f90: 626f 6c64 3a0a 2020 2020 2020 2020 2020  bold:.          
-00030fa0: 2020 786d 6c5f 7772 6974 6572 2e5f 786d    xml_writer._xm
-00030fb0: 6c5f 656d 7074 795f 7461 6728 2762 2729  l_empty_tag('b')
-00030fc0: 0a20 2020 2020 2020 2069 6620 7866 5f66  .        if xf_f
-00030fd0: 6f72 6d61 742e 6974 616c 6963 3a0a 2020  ormat.italic:.  
-00030fe0: 2020 2020 2020 2020 2020 786d 6c5f 7772            xml_wr
-00030ff0: 6974 6572 2e5f 786d 6c5f 656d 7074 795f  iter._xml_empty_
-00031000: 7461 6728 2769 2729 0a20 2020 2020 2020  tag('i').       
-00031010: 2069 6620 7866 5f66 6f72 6d61 742e 666f   if xf_format.fo
-00031020: 6e74 5f73 7472 696b 656f 7574 3a0a 2020  nt_strikeout:.  
-00031030: 2020 2020 2020 2020 2020 786d 6c5f 7772            xml_wr
-00031040: 6974 6572 2e5f 786d 6c5f 656d 7074 795f  iter._xml_empty_
-00031050: 7461 6728 2773 7472 696b 6527 290a 2020  tag('strike').  
-00031060: 2020 2020 2020 6966 2078 665f 666f 726d        if xf_form
-00031070: 6174 2e66 6f6e 745f 6f75 746c 696e 653a  at.font_outline:
-00031080: 0a20 2020 2020 2020 2020 2020 2078 6d6c  .            xml
-00031090: 5f77 7269 7465 722e 5f78 6d6c 5f65 6d70  _writer._xml_emp
-000310a0: 7479 5f74 6167 2827 6f75 746c 696e 6527  ty_tag('outline'
-000310b0: 290a 2020 2020 2020 2020 6966 2078 665f  ).        if xf_
-000310c0: 666f 726d 6174 2e66 6f6e 745f 7368 6164  format.font_shad
-000310d0: 6f77 3a0a 2020 2020 2020 2020 2020 2020  ow:.            
-000310e0: 786d 6c5f 7772 6974 6572 2e5f 786d 6c5f  xml_writer._xml_
-000310f0: 656d 7074 795f 7461 6728 2773 6861 646f  empty_tag('shado
-00031100: 7727 290a 0a20 2020 2020 2020 2023 2048  w')..        # H
-00031110: 616e 646c 6520 7468 6520 756e 6465 726c  andle the underl
-00031120: 696e 6520 7661 7269 616e 7473 2e0a 2020  ine variants..  
-00031130: 2020 2020 2020 6966 2078 665f 666f 726d        if xf_form
-00031140: 6174 2e75 6e64 6572 6c69 6e65 3a0a 2020  at.underline:.  
-00031150: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00031160: 7772 6974 655f 756e 6465 726c 696e 6528  write_underline(
-00031170: 7866 5f66 6f72 6d61 742e 756e 6465 726c  xf_format.underl
-00031180: 696e 6529 0a0a 2020 2020 2020 2020 2320  ine)..        # 
-00031190: 4861 6e64 6c65 2073 7570 6572 2f73 7562  Handle super/sub
-000311a0: 7363 7269 7074 2e0a 2020 2020 2020 2020  script..        
-000311b0: 6966 2078 665f 666f 726d 6174 2e66 6f6e  if xf_format.fon
-000311c0: 745f 7363 7269 7074 203d 3d20 313a 0a20  t_script == 1:. 
-000311d0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000311e0: 5f77 7269 7465 5f76 6572 745f 616c 6967  _write_vert_alig
-000311f0: 6e28 2773 7570 6572 7363 7269 7074 2729  n('superscript')
-00031200: 0a20 2020 2020 2020 2069 6620 7866 5f66  .        if xf_f
-00031210: 6f72 6d61 742e 666f 6e74 5f73 6372 6970  ormat.font_scrip
-00031220: 7420 3d3d 2032 3a0a 2020 2020 2020 2020  t == 2:.        
-00031230: 2020 2020 7365 6c66 2e5f 7772 6974 655f      self._write_
-00031240: 7665 7274 5f61 6c69 676e 2827 7375 6273  vert_align('subs
-00031250: 6372 6970 7427 290a 0a20 2020 2020 2020  cript')..       
-00031260: 2023 2057 7269 7465 2074 6865 2066 6f6e   # Write the fon
-00031270: 7420 7369 7a65 0a20 2020 2020 2020 2078  t size.        x
-00031280: 6d6c 5f77 7269 7465 722e 5f78 6d6c 5f65  ml_writer._xml_e
-00031290: 6d70 7479 5f74 6167 2827 737a 272c 205b  mpty_tag('sz', [
-000312a0: 2827 7661 6c27 2c20 7866 5f66 6f72 6d61  ('val', xf_forma
-000312b0: 742e 666f 6e74 5f73 697a 6529 5d29 0a0a  t.font_size)])..
-000312c0: 2020 2020 2020 2020 2320 4861 6e64 6c65          # Handle
-000312d0: 2063 6f6c 6f72 732e 0a20 2020 2020 2020   colors..       
-000312e0: 2069 6620 7866 5f66 6f72 6d61 742e 7468   if xf_format.th
-000312f0: 656d 6520 3d3d 202d 313a 0a20 2020 2020  eme == -1:.     
-00031300: 2020 2020 2020 2023 2049 676e 6f72 6520         # Ignore 
-00031310: 666f 7220 6578 6365 6c32 3030 335f 7374  for excel2003_st
-00031320: 796c 652e 0a20 2020 2020 2020 2020 2020  yle..           
-00031330: 2070 6173 730a 2020 2020 2020 2020 656c   pass.        el
-00031340: 6966 2078 665f 666f 726d 6174 2e74 6865  if xf_format.the
-00031350: 6d65 3a0a 2020 2020 2020 2020 2020 2020  me:.            
-00031360: 7365 6c66 2e5f 7772 6974 655f 636f 6c6f  self._write_colo
-00031370: 7228 2774 6865 6d65 272c 2078 665f 666f  r('theme', xf_fo
-00031380: 726d 6174 2e74 6865 6d65 290a 2020 2020  rmat.theme).    
-00031390: 2020 2020 656c 6966 2078 665f 666f 726d      elif xf_form
-000313a0: 6174 2e63 6f6c 6f72 5f69 6e64 6578 6564  at.color_indexed
-000313b0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-000313c0: 6c66 2e5f 7772 6974 655f 636f 6c6f 7228  lf._write_color(
-000313d0: 2769 6e64 6578 6564 272c 2078 665f 666f  'indexed', xf_fo
-000313e0: 726d 6174 2e63 6f6c 6f72 5f69 6e64 6578  rmat.color_index
-000313f0: 6564 290a 2020 2020 2020 2020 656c 6966  ed).        elif
-00031400: 2078 665f 666f 726d 6174 2e66 6f6e 745f   xf_format.font_
-00031410: 636f 6c6f 723a 0a20 2020 2020 2020 2020  color:.         
-00031420: 2020 2063 6f6c 6f72 203d 2073 656c 662e     color = self.
-00031430: 5f67 6574 5f70 616c 6574 7465 5f63 6f6c  _get_palette_col
-00031440: 6f72 2878 665f 666f 726d 6174 2e66 6f6e  or(xf_format.fon
-00031450: 745f 636f 6c6f 7229 0a20 2020 2020 2020  t_color).       
-00031460: 2020 2020 2073 656c 662e 5f77 7269 7465       self._write
-00031470: 5f72 7374 7269 6e67 5f63 6f6c 6f72 2827  _rstring_color('
-00031480: 7267 6227 2c20 636f 6c6f 7229 0a20 2020  rgb', color).   
-00031490: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000314a0: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
-000314b0: 7465 5f72 7374 7269 6e67 5f63 6f6c 6f72  te_rstring_color
-000314c0: 2827 7468 656d 6527 2c20 3129 0a0a 2020  ('theme', 1)..  
-000314d0: 2020 2020 2020 2320 5772 6974 6520 736f        # Write so
-000314e0: 6d65 206f 7468 6572 2066 6f6e 7420 7072  me other font pr
-000314f0: 6f70 6572 7469 6573 2072 656c 6174 6564  operties related
-00031500: 2074 6f20 666f 6e74 2066 616d 696c 6965   to font familie
-00031510: 732e 0a20 2020 2020 2020 2078 6d6c 5f77  s..        xml_w
-00031520: 7269 7465 722e 5f78 6d6c 5f65 6d70 7479  riter._xml_empty
-00031530: 5f74 6167 2827 7246 6f6e 7427 2c20 5b28  _tag('rFont', [(
-00031540: 2776 616c 272c 2078 665f 666f 726d 6174  'val', xf_format
-00031550: 2e66 6f6e 745f 6e61 6d65 295d 290a 2020  .font_name)]).  
-00031560: 2020 2020 2020 786d 6c5f 7772 6974 6572        xml_writer
-00031570: 2e5f 786d 6c5f 656d 7074 795f 7461 6728  ._xml_empty_tag(
-00031580: 2766 616d 696c 7927 2c20 5b28 2776 616c  'family', [('val
-00031590: 272c 2078 665f 666f 726d 6174 2e66 6f6e  ', xf_format.fon
-000315a0: 745f 6661 6d69 6c79 295d 290a 0a20 2020  t_family)])..   
-000315b0: 2020 2020 2069 6620 7866 5f66 6f72 6d61       if xf_forma
-000315c0: 742e 666f 6e74 5f6e 616d 6520 3d3d 2027  t.font_name == '
-000315d0: 4361 6c69 6272 6927 2061 6e64 206e 6f74  Calibri' and not
-000315e0: 2078 665f 666f 726d 6174 2e68 7970 6572   xf_format.hyper
-000315f0: 6c69 6e6b 3a0a 2020 2020 2020 2020 2020  link:.          
-00031600: 2020 786d 6c5f 7772 6974 6572 2e5f 786d    xml_writer._xm
-00031610: 6c5f 656d 7074 795f 7461 6728 2773 6368  l_empty_tag('sch
-00031620: 656d 6527 2c0a 2020 2020 2020 2020 2020  eme',.          
-00031630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031640: 2020 2020 2020 2020 2020 2020 5b28 2776              [('v
-00031650: 616c 272c 2078 665f 666f 726d 6174 2e66  al', xf_format.f
-00031660: 6f6e 745f 7363 6865 6d65 295d 290a 0a20  ont_scheme)]).. 
-00031670: 2020 2020 2020 2078 6d6c 5f77 7269 7465         xml_write
-00031680: 722e 5f78 6d6c 5f65 6e64 5f74 6167 2827  r._xml_end_tag('
-00031690: 7250 7227 290a 0a20 2020 2064 6566 205f  rPr')..    def _
-000316a0: 7772 6974 655f 756e 6465 726c 696e 6528  write_underline(
-000316b0: 7365 6c66 2c20 756e 6465 726c 696e 6529  self, underline)
-000316c0: 3a0a 2020 2020 2020 2020 2320 5772 6974  :.        # Writ
-000316d0: 6520 7468 6520 756e 6465 726c 696e 6520  e the underline 
-000316e0: 666f 6e74 2065 6c65 6d65 6e74 2e0a 2020  font element..  
-000316f0: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-00031700: 203d 205b 5d0a 0a20 2020 2020 2020 2023   = []..        #
-00031710: 2048 616e 646c 6520 7468 6520 756e 6465   Handle the unde
-00031720: 726c 696e 6520 7661 7269 616e 7473 2e0a  rline variants..
-00031730: 2020 2020 2020 2020 6966 2075 6e64 6572          if under
-00031740: 6c69 6e65 203d 3d20 323a 0a20 2020 2020  line == 2:.     
-00031750: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
-00031760: 7320 3d20 5b28 2776 616c 272c 2027 646f  s = [('val', 'do
-00031770: 7562 6c65 2729 5d0a 2020 2020 2020 2020  uble')].        
-00031780: 656c 6966 2075 6e64 6572 6c69 6e65 203d  elif underline =
-00031790: 3d20 3333 3a0a 2020 2020 2020 2020 2020  = 33:.          
-000317a0: 2020 6174 7472 6962 7574 6573 203d 205b    attributes = [
-000317b0: 2827 7661 6c27 2c20 2773 696e 676c 6541  ('val', 'singleA
-000317c0: 6363 6f75 6e74 696e 6727 295d 0a20 2020  ccounting')].   
-000317d0: 2020 2020 2065 6c69 6620 756e 6465 726c       elif underl
-000317e0: 696e 6520 3d3d 2033 343a 0a20 2020 2020  ine == 34:.     
-000317f0: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
-00031800: 7320 3d20 5b28 2776 616c 272c 2027 646f  s = [('val', 'do
-00031810: 7562 6c65 4163 636f 756e 7469 6e67 2729  ubleAccounting')
-00031820: 5d0a 0a20 2020 2020 2020 2073 656c 662e  ]..        self.
-00031830: 7273 7472 696e 672e 5f78 6d6c 5f65 6d70  rstring._xml_emp
-00031840: 7479 5f74 6167 2827 7527 2c20 6174 7472  ty_tag('u', attr
-00031850: 6962 7574 6573 290a 0a20 2020 2064 6566  ibutes)..    def
-00031860: 205f 7772 6974 655f 7665 7274 5f61 6c69   _write_vert_ali
-00031870: 676e 2873 656c 662c 2076 616c 293a 0a20  gn(self, val):. 
-00031880: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
-00031890: 6865 203c 7665 7274 416c 6967 6e3e 2066  he <vertAlign> f
-000318a0: 6f6e 7420 7375 622d 656c 656d 656e 742e  ont sub-element.
-000318b0: 0a20 2020 2020 2020 2061 7474 7269 6275  .        attribu
-000318c0: 7465 7320 3d20 5b28 2776 616c 272c 2076  tes = [('val', v
-000318d0: 616c 295d 0a0a 2020 2020 2020 2020 7365  al)]..        se
-000318e0: 6c66 2e72 7374 7269 6e67 2e5f 786d 6c5f  lf.rstring._xml_
-000318f0: 656d 7074 795f 7461 6728 2776 6572 7441  empty_tag('vertA
-00031900: 6c69 676e 272c 2061 7474 7269 6275 7465  lign', attribute
-00031910: 7329 0a0a 2020 2020 6465 6620 5f77 7269  s)..    def _wri
-00031920: 7465 5f72 7374 7269 6e67 5f63 6f6c 6f72  te_rstring_color
-00031930: 2873 656c 662c 206e 616d 652c 2076 616c  (self, name, val
-00031940: 7565 293a 0a20 2020 2020 2020 2023 2057  ue):.        # W
-00031950: 7269 7465 2074 6865 203c 636f 6c6f 723e  rite the <color>
-00031960: 2065 6c65 6d65 6e74 2e0a 2020 2020 2020   element..      
-00031970: 2020 6174 7472 6962 7574 6573 203d 205b    attributes = [
-00031980: 286e 616d 652c 2076 616c 7565 295d 0a0a  (name, value)]..
-00031990: 2020 2020 2020 2020 7365 6c66 2e72 7374          self.rst
-000319a0: 7269 6e67 2e5f 786d 6c5f 656d 7074 795f  ring._xml_empty_
-000319b0: 7461 6728 2763 6f6c 6f72 272c 2061 7474  tag('color', att
-000319c0: 7269 6275 7465 7329 0a0a 2020 2020 6465  ributes)..    de
-000319d0: 6620 5f67 6574 5f70 616c 6574 7465 5f63  f _get_palette_c
-000319e0: 6f6c 6f72 2873 656c 662c 2063 6f6c 6f72  olor(self, color
-000319f0: 293a 0a20 2020 2020 2020 2023 2043 6f6e  ):.        # Con
-00031a00: 7665 7274 2074 6865 2052 4742 2063 6f6c  vert the RGB col
-00031a10: 6f72 2e0a 2020 2020 2020 2020 6966 2063  or..        if c
-00031a20: 6f6c 6f72 5b30 5d20 3d3d 2027 2327 3a0a  olor[0] == '#':.
-00031a30: 2020 2020 2020 2020 2020 2020 636f 6c6f              colo
-00031a40: 7220 3d20 636f 6c6f 725b 313a 5d0a 0a20  r = color[1:].. 
-00031a50: 2020 2020 2020 2072 6574 7572 6e20 2246         return "F
-00031a60: 4622 202b 2063 6f6c 6f72 2e75 7070 6572  F" + color.upper
-00031a70: 2829 0a0a 2020 2020 6465 6620 5f6f 7074  ()..    def _opt
-00031a80: 5f63 6c6f 7365 2873 656c 6629 3a0a 2020  _close(self):.  
-00031a90: 2020 2020 2020 2320 436c 6f73 6520 7468        # Close th
-00031aa0: 6520 726f 7720 6461 7461 2066 696c 6568  e row data fileh
-00031ab0: 616e 646c 6520 696e 2063 6f6e 7374 616e  andle in constan
-00031ac0: 745f 6d65 6d6f 7279 206d 6f64 652e 0a20  t_memory mode.. 
-00031ad0: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-00031ae0: 6c66 2e72 6f77 5f64 6174 615f 6668 5f63  lf.row_data_fh_c
-00031af0: 6c6f 7365 643a 0a20 2020 2020 2020 2020  losed:.         
-00031b00: 2020 2073 656c 662e 726f 775f 6461 7461     self.row_data
-00031b10: 5f66 682e 636c 6f73 6528 290a 2020 2020  _fh.close().    
-00031b20: 2020 2020 2020 2020 7365 6c66 2e72 6f77          self.row
-00031b30: 5f64 6174 615f 6668 5f63 6c6f 7365 6420  _data_fh_closed 
-00031b40: 3d20 5472 7565 0a0a 2020 2020 6465 6620  = True..    def 
-00031b50: 5f6f 7074 5f72 656f 7065 6e28 7365 6c66  _opt_reopen(self
-00031b60: 293a 0a20 2020 2020 2020 2023 2052 656f  ):.        # Reo
-00031b70: 7065 6e20 7468 6520 726f 7720 6461 7461  pen the row data
-00031b80: 2066 696c 6568 616e 646c 6520 696e 2063   filehandle in c
-00031b90: 6f6e 7374 616e 745f 6d65 6d6f 7279 206d  onstant_memory m
-00031ba0: 6f64 652e 0a20 2020 2020 2020 2069 6620  ode..        if 
-00031bb0: 7365 6c66 2e72 6f77 5f64 6174 615f 6668  self.row_data_fh
-00031bc0: 5f63 6c6f 7365 643a 0a20 2020 2020 2020  _closed:.       
-00031bd0: 2020 2020 2066 696c 656e 616d 6520 3d20       filename = 
-00031be0: 7365 6c66 2e72 6f77 5f64 6174 615f 6669  self.row_data_fi
-00031bf0: 6c65 6e61 6d65 0a20 2020 2020 2020 2020  lename.         
-00031c00: 2020 2073 656c 662e 726f 775f 6461 7461     self.row_data
-00031c10: 5f66 6820 3d20 6f70 656e 2866 696c 656e  _fh = open(filen
-00031c20: 616d 652c 206d 6f64 653d 2761 2b27 2c20  ame, mode='a+', 
-00031c30: 656e 636f 6469 6e67 3d27 7574 662d 3827  encoding='utf-8'
-00031c40: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00031c50: 6c66 2e72 6f77 5f64 6174 615f 6668 5f63  lf.row_data_fh_c
-00031c60: 6c6f 7365 6420 3d20 4661 6c73 650a 2020  losed = False.  
-00031c70: 2020 2020 2020 2020 2020 7365 6c66 2e66            self.f
-00031c80: 6820 3d20 7365 6c66 2e72 6f77 5f64 6174  h = self.row_dat
-00031c90: 615f 6668 0a0a 2020 2020 6465 6620 5f73  a_fh..    def _s
-00031ca0: 6574 5f69 636f 6e5f 7072 6f70 7328 7365  et_icon_props(se
-00031cb0: 6c66 2c20 746f 7461 6c5f 6963 6f6e 732c  lf, total_icons,
-00031cc0: 2075 7365 725f 7072 6f70 733d 4e6f 6e65   user_props=None
-00031cd0: 293a 0a20 2020 2020 2020 2023 2053 6574  ):.        # Set
-00031ce0: 2074 6865 2073 7562 2d70 726f 7065 7274   the sub-propert
-00031cf0: 6965 7320 666f 7220 6963 6f6e 732e 0a20  ies for icons.. 
-00031d00: 2020 2020 2020 2070 726f 7073 203d 205b         props = [
-00031d10: 5d0a 0a20 2020 2020 2020 2023 2053 6574  ]..        # Set
-00031d20: 2074 6865 2064 6566 6175 6c74 732e 0a20   the defaults.. 
-00031d30: 2020 2020 2020 2066 6f72 205f 2069 6e20         for _ in 
-00031d40: 7261 6e67 6528 746f 7461 6c5f 6963 6f6e  range(total_icon
-00031d50: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00031d60: 7072 6f70 732e 6170 7065 6e64 287b 2763  props.append({'c
-00031d70: 7269 7465 7269 6127 3a20 4661 6c73 652c  riteria': False,
-00031d80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00031d90: 2020 2020 2020 2020 2020 2027 7661 6c75             'valu
-00031da0: 6527 3a20 302c 0a20 2020 2020 2020 2020  e': 0,.         
-00031db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031dc0: 2027 7479 7065 273a 2027 7065 7263 656e   'type': 'percen
-00031dd0: 7427 7d29 0a0a 2020 2020 2020 2020 2320  t'})..        # 
-00031de0: 5365 7420 7468 6520 6465 6661 756c 7420  Set the default 
-00031df0: 6963 6f6e 2076 616c 7565 7320 6261 7365  icon values base
-00031e00: 6420 6f6e 2074 6865 206e 756d 6265 7220  d on the number 
-00031e10: 6f66 2069 636f 6e73 2e0a 2020 2020 2020  of icons..      
-00031e20: 2020 6966 2074 6f74 616c 5f69 636f 6e73    if total_icons
-00031e30: 203d 3d20 333a 0a20 2020 2020 2020 2020   == 3:.         
-00031e40: 2020 2070 726f 7073 5b30 5d5b 2776 616c     props[0]['val
-00031e50: 7565 275d 203d 2036 370a 2020 2020 2020  ue'] = 67.      
-00031e60: 2020 2020 2020 7072 6f70 735b 315d 5b27        props[1]['
-00031e70: 7661 6c75 6527 5d20 3d20 3333 0a0a 2020  value'] = 33..  
-00031e80: 2020 2020 2020 6966 2074 6f74 616c 5f69        if total_i
-00031e90: 636f 6e73 203d 3d20 343a 0a20 2020 2020  cons == 4:.     
-00031ea0: 2020 2020 2020 2070 726f 7073 5b30 5d5b         props[0][
-00031eb0: 2776 616c 7565 275d 203d 2037 350a 2020  'value'] = 75.  
-00031ec0: 2020 2020 2020 2020 2020 7072 6f70 735b            props[
-00031ed0: 315d 5b27 7661 6c75 6527 5d20 3d20 3530  1]['value'] = 50
-00031ee0: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
-00031ef0: 7073 5b32 5d5b 2776 616c 7565 275d 203d  ps[2]['value'] =
-00031f00: 2032 350a 0a20 2020 2020 2020 2069 6620   25..        if 
-00031f10: 746f 7461 6c5f 6963 6f6e 7320 3d3d 2035  total_icons == 5
-00031f20: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
-00031f30: 6f70 735b 305d 5b27 7661 6c75 6527 5d20  ops[0]['value'] 
-00031f40: 3d20 3830 0a20 2020 2020 2020 2020 2020  = 80.           
-00031f50: 2070 726f 7073 5b31 5d5b 2776 616c 7565   props[1]['value
-00031f60: 275d 203d 2036 300a 2020 2020 2020 2020  '] = 60.        
-00031f70: 2020 2020 7072 6f70 735b 325d 5b27 7661      props[2]['va
-00031f80: 6c75 6527 5d20 3d20 3430 0a20 2020 2020  lue'] = 40.     
-00031f90: 2020 2020 2020 2070 726f 7073 5b33 5d5b         props[3][
-00031fa0: 2776 616c 7565 275d 203d 2032 300a 0a20  'value'] = 20.. 
-00031fb0: 2020 2020 2020 2023 204f 7665 7277 7269         # Overwri
-00031fc0: 7465 2064 6566 6175 6c74 2070 726f 7065  te default prope
-00031fd0: 7274 6965 7320 7769 7468 2075 7365 7220  rties with user 
-00031fe0: 6465 6669 6e65 6420 7072 6f70 6572 7469  defined properti
-00031ff0: 6573 2e0a 2020 2020 2020 2020 6966 2075  es..        if u
-00032000: 7365 725f 7072 6f70 733a 0a0a 2020 2020  ser_props:..    
-00032010: 2020 2020 2020 2020 2320 456e 7375 7265          # Ensure
-00032020: 2077 6520 646f 6e27 7420 7365 7420 7573   we don't set us
-00032030: 6572 2070 726f 7065 7274 6965 7320 666f  er properties fo
-00032040: 7220 6c6f 7765 7374 2069 636f 6e2e 0a20  r lowest icon.. 
-00032050: 2020 2020 2020 2020 2020 206d 6178 5f64             max_d
-00032060: 6174 6120 3d20 6c65 6e28 7573 6572 5f70  ata = len(user_p
-00032070: 726f 7073 290a 2020 2020 2020 2020 2020  rops).          
-00032080: 2020 6966 206d 6178 5f64 6174 6120 3e3d    if max_data >=
-00032090: 2074 6f74 616c 5f69 636f 6e73 3a0a 2020   total_icons:.  
-000320a0: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
-000320b0: 785f 6461 7461 203d 2074 6f74 616c 5f69  x_data = total_i
-000320c0: 636f 6e73 202d 2031 0a0a 2020 2020 2020  cons - 1..      
-000320d0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-000320e0: 616e 6765 286d 6178 5f64 6174 6129 3a0a  ange(max_data):.
-000320f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032100: 2023 2053 6574 2074 6865 2075 7365 7220   # Set the user 
-00032110: 6465 6669 6e65 6420 2776 616c 7565 2720  defined 'value' 
-00032120: 7072 6f70 6572 7479 2e0a 2020 2020 2020  property..      
-00032130: 2020 2020 2020 2020 2020 6966 2075 7365            if use
-00032140: 725f 7072 6f70 735b 695d 2e67 6574 2827  r_props[i].get('
-00032150: 7661 6c75 6527 2920 6973 206e 6f74 204e  value') is not N
-00032160: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00032170: 2020 2020 2020 2020 2070 726f 7073 5b69           props[i
-00032180: 5d5b 2776 616c 7565 275d 203d 2075 7365  ]['value'] = use
-00032190: 725f 7072 6f70 735b 695d 5b27 7661 6c75  r_props[i]['valu
-000321a0: 6527 5d0a 0a20 2020 2020 2020 2020 2020  e']..           
-000321b0: 2020 2020 2020 2020 2023 2052 656d 6f76           # Remov
-000321c0: 6520 7468 6520 666f 726d 756c 6120 273d  e the formula '=
-000321d0: 2720 7369 676e 2069 6620 6974 2065 7869  ' sign if it exi
-000321e0: 7374 732e 0a20 2020 2020 2020 2020 2020  sts..           
-000321f0: 2020 2020 2020 2020 2074 6d70 203d 2070           tmp = p
-00032200: 726f 7073 5b69 5d5b 2776 616c 7565 275d  rops[i]['value']
-00032210: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032220: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00032230: 6365 2874 6d70 2c20 7374 7229 2061 6e64  ce(tmp, str) and
-00032240: 2074 6d70 2e73 7461 7274 7377 6974 6828   tmp.startswith(
-00032250: 273d 2729 3a0a 2020 2020 2020 2020 2020  '='):.          
-00032260: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-00032270: 6f70 735b 695d 5b27 7661 6c75 6527 5d20  ops[i]['value'] 
-00032280: 3d20 746d 702e 6c73 7472 6970 2827 3d27  = tmp.lstrip('='
-00032290: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-000322a0: 2020 2023 2053 6574 2074 6865 2075 7365     # Set the use
-000322b0: 7220 6465 6669 6e65 6420 2774 7970 6527  r defined 'type'
-000322c0: 2070 726f 7065 7274 792e 0a20 2020 2020   property..     
-000322d0: 2020 2020 2020 2020 2020 2069 6620 7573             if us
-000322e0: 6572 5f70 726f 7073 5b69 5d2e 6765 7428  er_props[i].get(
-000322f0: 2774 7970 6527 293a 0a20 2020 2020 2020  'type'):.       
-00032300: 2020 2020 2020 2020 2020 2020 2076 616c               val
-00032310: 6964 5f74 7970 6573 203d 2028 2770 6572  id_types = ('per
-00032320: 6365 6e74 272c 0a20 2020 2020 2020 2020  cent',.         
-00032330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032340: 2020 2020 2020 2020 2020 2770 6572 6365            'perce
-00032350: 6e74 696c 6527 2c0a 2020 2020 2020 2020  ntile',.        
-00032360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032370: 2020 2020 2020 2020 2020 2027 6e75 6d62             'numb
-00032380: 6572 272c 0a20 2020 2020 2020 2020 2020  er',.           
-00032390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000323a0: 2020 2020 2020 2020 2766 6f72 6d75 6c61          'formula
-000323b0: 2729 0a0a 2020 2020 2020 2020 2020 2020  ')..            
-000323c0: 2020 2020 2020 2020 6966 2075 7365 725f          if user_
-000323d0: 7072 6f70 735b 695d 5b27 7479 7065 275d  props[i]['type']
-000323e0: 206e 6f74 2069 6e20 7661 6c69 645f 7479   not in valid_ty
-000323f0: 7065 733a 0a20 2020 2020 2020 2020 2020  pes:.           
-00032400: 2020 2020 2020 2020 2020 2020 2077 6172               war
-00032410: 6e28 2255 6e6b 6e6f 776e 2069 636f 6e20  n("Unknown icon 
-00032420: 7072 6f70 6572 7479 2074 7970 6520 2725  property type '%
-00032430: 7327 2066 6f72 2073 7562 2d22 0a20 2020  s' for sub-".   
-00032440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032450: 2020 2020 2020 2020 2020 2270 726f 7065            "prope
-00032460: 7274 7920 2774 7970 6527 2069 6e20 636f  rty 'type' in co
-00032470: 6e64 6974 696f 6e61 6c5f 666f 726d 6174  nditional_format
-00032480: 2829 2220 250a 2020 2020 2020 2020 2020  ()" %.          
-00032490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000324a0: 2020 2075 7365 725f 7072 6f70 735b 695d     user_props[i]
-000324b0: 5b27 7479 7065 275d 290a 2020 2020 2020  ['type']).      
-000324c0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-000324d0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000324e0: 2020 2020 2020 2020 2020 2020 7072 6f70              prop
-000324f0: 735b 695d 5b27 7479 7065 275d 203d 2075  s[i]['type'] = u
-00032500: 7365 725f 7072 6f70 735b 695d 5b27 7479  ser_props[i]['ty
-00032510: 7065 275d 0a0a 2020 2020 2020 2020 2020  pe']..          
-00032520: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00032530: 2070 726f 7073 5b69 5d5b 2774 7970 6527   props[i]['type'
-00032540: 5d20 3d3d 2027 6e75 6d62 6572 273a 0a20  ] == 'number':. 
-00032550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032560: 2020 2020 2020 2020 2020 2070 726f 7073             props
-00032570: 5b69 5d5b 2774 7970 6527 5d20 3d20 276e  [i]['type'] = 'n
-00032580: 756d 270a 0a20 2020 2020 2020 2020 2020  um'..           
-00032590: 2020 2020 2023 2053 6574 2074 6865 2075       # Set the u
-000325a0: 7365 7220 6465 6669 6e65 6420 2763 7269  ser defined 'cri
-000325b0: 7465 7269 6127 2070 726f 7065 7274 792e  teria' property.
-000325c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000325d0: 2063 7269 7465 7269 6120 3d20 7573 6572   criteria = user
-000325e0: 5f70 726f 7073 5b69 5d2e 6765 7428 2763  _props[i].get('c
-000325f0: 7269 7465 7269 6127 290a 2020 2020 2020  riteria').      
-00032600: 2020 2020 2020 2020 2020 6966 2063 7269            if cri
-00032610: 7465 7269 6120 616e 6420 6372 6974 6572  teria and criter
-00032620: 6961 203d 3d20 273e 273a 0a20 2020 2020  ia == '>':.     
-00032630: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00032640: 726f 7073 5b69 5d5b 2763 7269 7465 7269  rops[i]['criteri
-00032650: 6127 5d20 3d20 5472 7565 0a0a 2020 2020  a'] = True..    
-00032660: 2020 2020 7265 7475 726e 2070 726f 7073      return props
-00032670: 0a0a 2020 2020 2323 2323 2323 2323 2323  ..    ##########
-00032680: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00032690: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000326a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000326b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000326c0: 230a 2020 2020 230a 2020 2020 2320 584d  #.    #.    # XM
-000326d0: 4c20 6d65 7468 6f64 732e 0a20 2020 2023  L methods..    #
-000326e0: 0a20 2020 2023 2323 2323 2323 2323 2323  .    ###########
-000326f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00032700: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00032710: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00032720: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00032730: 0a0a 2020 2020 6465 6620 5f77 7269 7465  ..    def _write
-00032740: 5f77 6f72 6b73 6865 6574 2873 656c 6629  _worksheet(self)
-00032750: 3a0a 2020 2020 2020 2020 2320 5772 6974  :.        # Writ
-00032760: 6520 7468 6520 3c77 6f72 6b73 6865 6574  e the <worksheet
-00032770: 3e20 656c 656d 656e 742e 2054 6869 7320  > element. This 
-00032780: 6973 2074 6865 2072 6f6f 7420 656c 656d  is the root elem
-00032790: 656e 742e 0a0a 2020 2020 2020 2020 7363  ent...        sc
-000327a0: 6865 6d61 203d 2027 6874 7470 3a2f 2f73  hema = 'http://s
-000327b0: 6368 656d 6173 2e6f 7065 6e78 6d6c 666f  chemas.openxmlfo
-000327c0: 726d 6174 732e 6f72 672f 270a 2020 2020  rmats.org/'.    
-000327d0: 2020 2020 786d 6c6e 7320 3d20 7363 6865      xmlns = sche
-000327e0: 6d61 202b 2027 7370 7265 6164 7368 6565  ma + 'spreadshee
-000327f0: 746d 6c2f 3230 3036 2f6d 6169 6e27 0a20  tml/2006/main'. 
-00032800: 2020 2020 2020 2078 6d6c 6e73 5f72 203d         xmlns_r =
-00032810: 2073 6368 656d 6120 2b20 276f 6666 6963   schema + 'offic
-00032820: 6544 6f63 756d 656e 742f 3230 3036 2f72  eDocument/2006/r
-00032830: 656c 6174 696f 6e73 6869 7073 270a 2020  elationships'.  
-00032840: 2020 2020 2020 786d 6c6e 735f 6d63 203d        xmlns_mc =
-00032850: 2073 6368 656d 6120 2b20 276d 6172 6b75   schema + 'marku
-00032860: 702d 636f 6d70 6174 6962 696c 6974 792f  p-compatibility/
-00032870: 3230 3036 270a 2020 2020 2020 2020 6d73  2006'.        ms
-00032880: 5f73 6368 656d 6120 3d20 2768 7474 703a  _schema = 'http:
-00032890: 2f2f 7363 6865 6d61 732e 6d69 6372 6f73  //schemas.micros
-000328a0: 6f66 742e 636f 6d2f 270a 2020 2020 2020  oft.com/'.      
-000328b0: 2020 786d 6c6e 735f 7831 3461 6320 3d20    xmlns_x14ac = 
-000328c0: 6d73 5f73 6368 656d 6120 2b20 276f 6666  ms_schema + 'off
-000328d0: 6963 652f 7370 7265 6164 7368 6565 746d  ice/spreadsheetm
-000328e0: 6c2f 3230 3039 2f39 2f61 6327 0a0a 2020  l/2009/9/ac'..  
-000328f0: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-00032900: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
-00032910: 2028 2778 6d6c 6e73 272c 2078 6d6c 6e73   ('xmlns', xmlns
-00032920: 292c 0a20 2020 2020 2020 2020 2020 2028  ),.            (
-00032930: 2778 6d6c 6e73 3a72 272c 2078 6d6c 6e73  'xmlns:r', xmlns
-00032940: 5f72 295d 0a0a 2020 2020 2020 2020 2320  _r)]..        # 
-00032950: 4164 6420 736f 6d65 2065 7874 7261 2061  Add some extra a
-00032960: 7474 7269 6275 7465 7320 666f 7220 4578  ttributes for Ex
-00032970: 6365 6c20 3230 3130 2e20 4d61 696e 6c79  cel 2010. Mainly
-00032980: 2066 6f72 2073 7061 726b 6c69 6e65 732e   for sparklines.
-00032990: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-000329a0: 2e65 7863 656c 5f76 6572 7369 6f6e 203d  .excel_version =
-000329b0: 3d20 3230 3130 3a0a 2020 2020 2020 2020  = 2010:.        
-000329c0: 2020 2020 6174 7472 6962 7574 6573 2e61      attributes.a
-000329d0: 7070 656e 6428 2827 786d 6c6e 733a 6d63  ppend(('xmlns:mc
-000329e0: 272c 2078 6d6c 6e73 5f6d 6329 290a 2020  ', xmlns_mc)).  
-000329f0: 2020 2020 2020 2020 2020 6174 7472 6962            attrib
-00032a00: 7574 6573 2e61 7070 656e 6428 2827 786d  utes.append(('xm
-00032a10: 6c6e 733a 7831 3461 6327 2c20 786d 6c6e  lns:x14ac', xmln
-00032a20: 735f 7831 3461 6329 290a 2020 2020 2020  s_x14ac)).      
-00032a30: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-00032a40: 2e61 7070 656e 6428 2827 6d63 3a49 676e  .append(('mc:Ign
-00032a50: 6f72 6162 6c65 272c 2027 7831 3461 6327  orable', 'x14ac'
-00032a60: 2929 0a0a 2020 2020 2020 2020 7365 6c66  ))..        self
-00032a70: 2e5f 786d 6c5f 7374 6172 745f 7461 6728  ._xml_start_tag(
-00032a80: 2777 6f72 6b73 6865 6574 272c 2061 7474  'worksheet', att
-00032a90: 7269 6275 7465 7329 0a0a 2020 2020 6465  ributes)..    de
-00032aa0: 6620 5f77 7269 7465 5f64 696d 656e 7369  f _write_dimensi
-00032ab0: 6f6e 2873 656c 6629 3a0a 2020 2020 2020  on(self):.      
-00032ac0: 2020 2320 5772 6974 6520 7468 6520 3c64    # Write the <d
-00032ad0: 696d 656e 7369 6f6e 3e20 656c 656d 656e  imension> elemen
-00032ae0: 742e 2054 6869 7320 7370 6563 6966 6965  t. This specifie
-00032af0: 7320 7468 6520 7261 6e67 6520 6f66 0a20  s the range of. 
-00032b00: 2020 2020 2020 2023 2063 656c 6c73 2069         # cells i
-00032b10: 6e20 7468 6520 776f 726b 7368 6565 742e  n the worksheet.
-00032b20: 2041 7320 6120 7370 6563 6961 6c20 6361   As a special ca
-00032b30: 7365 2c20 656d 7074 790a 2020 2020 2020  se, empty.      
-00032b40: 2020 2320 7370 7265 6164 7368 6565 7473    # spreadsheets
-00032b50: 2075 7365 2027 4131 2720 6173 2061 2072   use 'A1' as a r
-00032b60: 616e 6765 2e0a 0a20 2020 2020 2020 2069  ange...        i
-00032b70: 6620 7365 6c66 2e64 696d 5f72 6f77 6d69  f self.dim_rowmi
-00032b80: 6e20 6973 204e 6f6e 6520 616e 6420 7365  n is None and se
-00032b90: 6c66 2e64 696d 5f63 6f6c 6d69 6e20 6973  lf.dim_colmin is
-00032ba0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00032bb0: 2020 2023 2049 6620 7468 6520 6d69 6e20     # If the min 
-00032bc0: 6469 6d65 6e73 696f 6e73 2061 7265 206e  dimensions are n
-00032bd0: 6f74 2064 6566 696e 6564 2074 6865 6e20  ot defined then 
-00032be0: 6e6f 2064 696d 656e 7369 6f6e 730a 2020  no dimensions.  
-00032bf0: 2020 2020 2020 2020 2020 2320 6861 7665            # have
-00032c00: 2062 6565 6e20 7365 7420 616e 6420 7765   been set and we
-00032c10: 2075 7365 2074 6865 2064 6566 6175 6c74   use the default
-00032c20: 2027 4131 272e 0a20 2020 2020 2020 2020   'A1'..         
-00032c30: 2020 2072 6566 203d 2027 4131 270a 0a20     ref = 'A1'.. 
-00032c40: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
-00032c50: 2e64 696d 5f72 6f77 6d69 6e20 6973 204e  .dim_rowmin is N
-00032c60: 6f6e 6520 616e 6420 7365 6c66 2e64 696d  one and self.dim
-00032c70: 5f63 6f6c 6d69 6e20 6973 206e 6f74 204e  _colmin is not N
-00032c80: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00032c90: 2023 2049 6620 7468 6520 726f 7720 6469   # If the row di
-00032ca0: 6d65 6e73 696f 6e73 2061 7265 6e27 7420  mensions aren't 
-00032cb0: 7365 7420 6275 7420 7468 6520 636f 6c75  set but the colu
-00032cc0: 6d6e 0a20 2020 2020 2020 2020 2020 2023  mn.            #
-00032cd0: 2064 696d 656e 7369 6f6e 7320 6172 6520   dimensions are 
-00032ce0: 7365 7420 7468 656e 2074 6865 7920 6861  set then they ha
-00032cf0: 7665 2062 6565 6e20 6368 616e 6765 6420  ve been changed 
-00032d00: 7669 610a 2020 2020 2020 2020 2020 2020  via.            
-00032d10: 2320 7365 745f 636f 6c75 6d6e 2829 2e0a  # set_column()..
-00032d20: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00032d30: 7365 6c66 2e64 696d 5f63 6f6c 6d69 6e20  self.dim_colmin 
-00032d40: 3d3d 2073 656c 662e 6469 6d5f 636f 6c6d  == self.dim_colm
-00032d50: 6178 3a0a 2020 2020 2020 2020 2020 2020  ax:.            
-00032d60: 2020 2020 2320 5468 6520 6469 6d65 6e73      # The dimens
-00032d70: 696f 6e73 2061 7265 2061 2073 696e 676c  ions are a singl
-00032d80: 6520 6365 6c6c 2061 6e64 206e 6f74 2061  e cell and not a
-00032d90: 2072 616e 6765 2e0a 2020 2020 2020 2020   range..        
-00032da0: 2020 2020 2020 2020 7265 6620 3d20 786c          ref = xl
-00032db0: 5f72 6f77 636f 6c5f 746f 5f63 656c 6c28  _rowcol_to_cell(
-00032dc0: 302c 2073 656c 662e 6469 6d5f 636f 6c6d  0, self.dim_colm
-00032dd0: 696e 290a 2020 2020 2020 2020 2020 2020  in).            
-00032de0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00032df0: 2020 2020 2020 2320 5468 6520 6469 6d65        # The dime
-00032e00: 6e73 696f 6e73 2061 7265 2061 2063 656c  nsions are a cel
-00032e10: 6c20 7261 6e67 652e 0a20 2020 2020 2020  l range..       
-00032e20: 2020 2020 2020 2020 2063 656c 6c5f 3120           cell_1 
-00032e30: 3d20 786c 5f72 6f77 636f 6c5f 746f 5f63  = xl_rowcol_to_c
-00032e40: 656c 6c28 302c 2073 656c 662e 6469 6d5f  ell(0, self.dim_
-00032e50: 636f 6c6d 696e 290a 2020 2020 2020 2020  colmin).        
-00032e60: 2020 2020 2020 2020 6365 6c6c 5f32 203d          cell_2 =
-00032e70: 2078 6c5f 726f 7763 6f6c 5f74 6f5f 6365   xl_rowcol_to_ce
-00032e80: 6c6c 2830 2c20 7365 6c66 2e64 696d 5f63  ll(0, self.dim_c
-00032e90: 6f6c 6d61 7829 0a20 2020 2020 2020 2020  olmax).         
-00032ea0: 2020 2020 2020 2072 6566 203d 2063 656c         ref = cel
-00032eb0: 6c5f 3120 2b20 273a 2720 2b20 6365 6c6c  l_1 + ':' + cell
-00032ec0: 5f32 0a0a 2020 2020 2020 2020 656c 6966  _2..        elif
-00032ed0: 2028 7365 6c66 2e64 696d 5f72 6f77 6d69   (self.dim_rowmi
-00032ee0: 6e20 3d3d 2073 656c 662e 6469 6d5f 726f  n == self.dim_ro
-00032ef0: 776d 6178 2061 6e64 0a20 2020 2020 2020  wmax and.       
-00032f00: 2020 2020 2020 2073 656c 662e 6469 6d5f         self.dim_
-00032f10: 636f 6c6d 696e 203d 3d20 7365 6c66 2e64  colmin == self.d
-00032f20: 696d 5f63 6f6c 6d61 7829 3a0a 2020 2020  im_colmax):.    
-00032f30: 2020 2020 2020 2020 2320 5468 6520 6469          # The di
-00032f40: 6d65 6e73 696f 6e73 2061 7265 2061 2073  mensions are a s
-00032f50: 696e 676c 6520 6365 6c6c 2061 6e64 206e  ingle cell and n
-00032f60: 6f74 2061 2072 616e 6765 2e0a 2020 2020  ot a range..    
-00032f70: 2020 2020 2020 2020 7265 6620 3d20 786c          ref = xl
-00032f80: 5f72 6f77 636f 6c5f 746f 5f63 656c 6c28  _rowcol_to_cell(
-00032f90: 7365 6c66 2e64 696d 5f72 6f77 6d69 6e2c  self.dim_rowmin,
-00032fa0: 2073 656c 662e 6469 6d5f 636f 6c6d 696e   self.dim_colmin
-00032fb0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00032fc0: 2020 2020 2020 2020 2020 2020 2320 5468              # Th
-00032fd0: 6520 6469 6d65 6e73 696f 6e73 2061 7265  e dimensions are
-00032fe0: 2061 2063 656c 6c20 7261 6e67 652e 0a20   a cell range.. 
-00032ff0: 2020 2020 2020 2020 2020 2063 656c 6c5f             cell_
-00033000: 3120 3d20 786c 5f72 6f77 636f 6c5f 746f  1 = xl_rowcol_to
-00033010: 5f63 656c 6c28 7365 6c66 2e64 696d 5f72  _cell(self.dim_r
-00033020: 6f77 6d69 6e2c 2073 656c 662e 6469 6d5f  owmin, self.dim_
-00033030: 636f 6c6d 696e 290a 2020 2020 2020 2020  colmin).        
-00033040: 2020 2020 6365 6c6c 5f32 203d 2078 6c5f      cell_2 = xl_
-00033050: 726f 7763 6f6c 5f74 6f5f 6365 6c6c 2873  rowcol_to_cell(s
-00033060: 656c 662e 6469 6d5f 726f 776d 6178 2c20  elf.dim_rowmax, 
-00033070: 7365 6c66 2e64 696d 5f63 6f6c 6d61 7829  self.dim_colmax)
-00033080: 0a20 2020 2020 2020 2020 2020 2072 6566  .            ref
-00033090: 203d 2063 656c 6c5f 3120 2b20 273a 2720   = cell_1 + ':' 
-000330a0: 2b20 6365 6c6c 5f32 0a0a 2020 2020 2020  + cell_2..      
-000330b0: 2020 7365 6c66 2e5f 786d 6c5f 656d 7074    self._xml_empt
-000330c0: 795f 7461 6728 2764 696d 656e 7369 6f6e  y_tag('dimension
-000330d0: 272c 205b 2827 7265 6627 2c20 7265 6629  ', [('ref', ref)
-000330e0: 5d29 0a0a 2020 2020 6465 6620 5f77 7269  ])..    def _wri
-000330f0: 7465 5f73 6865 6574 5f76 6965 7773 2873  te_sheet_views(s
-00033100: 656c 6629 3a0a 2020 2020 2020 2020 2320  elf):.        # 
-00033110: 5772 6974 6520 7468 6520 3c73 6865 6574  Write the <sheet
-00033120: 5669 6577 733e 2065 6c65 6d65 6e74 2e0a  Views> element..
-00033130: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
-00033140: 6c5f 7374 6172 745f 7461 6728 2773 6865  l_start_tag('she
-00033150: 6574 5669 6577 7327 290a 0a20 2020 2020  etViews')..     
-00033160: 2020 2023 2057 7269 7465 2074 6865 2073     # Write the s
-00033170: 6865 6574 5669 6577 2065 6c65 6d65 6e74  heetView element
-00033180: 2e0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-00033190: 7772 6974 655f 7368 6565 745f 7669 6577  write_sheet_view
-000331a0: 2829 0a0a 2020 2020 2020 2020 7365 6c66  ()..        self
-000331b0: 2e5f 786d 6c5f 656e 645f 7461 6728 2773  ._xml_end_tag('s
-000331c0: 6865 6574 5669 6577 7327 290a 0a20 2020  heetViews')..   
-000331d0: 2064 6566 205f 7772 6974 655f 7368 6565   def _write_shee
-000331e0: 745f 7669 6577 2873 656c 6629 3a0a 2020  t_view(self):.  
-000331f0: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
-00033200: 6520 3c73 6865 6574 5669 6577 733e 2065  e <sheetViews> e
-00033210: 6c65 6d65 6e74 2e0a 2020 2020 2020 2020  lement..        
-00033220: 6174 7472 6962 7574 6573 203d 205b 5d0a  attributes = [].
-00033230: 0a20 2020 2020 2020 2023 2048 6964 6520  .        # Hide 
-00033240: 7363 7265 656e 2067 7269 646c 696e 6573  screen gridlines
-00033250: 2069 6620 7265 7175 6972 6564 2e0a 2020   if required..  
-00033260: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
-00033270: 662e 7363 7265 656e 5f67 7269 646c 696e  f.screen_gridlin
-00033280: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-00033290: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
-000332a0: 6428 2827 7368 6f77 4772 6964 4c69 6e65  d(('showGridLine
-000332b0: 7327 2c20 3029 290a 0a20 2020 2020 2020  s', 0))..       
-000332c0: 2023 2048 6964 6520 7363 7265 656e 2072   # Hide screen r
-000332d0: 6f77 2f63 6f6c 756d 6e20 6865 6164 6572  ow/column header
-000332e0: 732e 0a20 2020 2020 2020 2069 6620 7365  s..        if se
-000332f0: 6c66 2e72 6f77 5f63 6f6c 5f68 6561 6465  lf.row_col_heade
-00033300: 7273 3a0a 2020 2020 2020 2020 2020 2020  rs:.            
-00033310: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
-00033320: 6428 2827 7368 6f77 526f 7743 6f6c 4865  d(('showRowColHe
-00033330: 6164 6572 7327 2c20 3029 290a 0a20 2020  aders', 0))..   
-00033340: 2020 2020 2023 2048 6964 6520 7a65 726f       # Hide zero
-00033350: 6573 2069 6e20 6365 6c6c 732e 0a20 2020  es in cells..   
-00033360: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
-00033370: 2e73 686f 775f 7a65 726f 733a 0a20 2020  .show_zeros:.   
-00033380: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
-00033390: 7465 732e 6170 7065 6e64 2828 2773 686f  tes.append(('sho
-000333a0: 775a 6572 6f73 272c 2030 2929 0a0a 2020  wZeros', 0))..  
-000333b0: 2020 2020 2020 2320 4469 7370 6c61 7920        # Display 
-000333c0: 776f 726b 7368 6565 7420 7269 6768 7420  worksheet right 
-000333d0: 746f 206c 6566 7420 666f 7220 4865 6272  to left for Hebr
-000333e0: 6577 2c20 4172 6162 6963 2061 6e64 206f  ew, Arabic and o
-000333f0: 7468 6572 732e 0a20 2020 2020 2020 2069  thers..        i
-00033400: 6620 7365 6c66 2e69 735f 7269 6768 745f  f self.is_right_
-00033410: 746f 5f6c 6566 743a 0a20 2020 2020 2020  to_left:.       
-00033420: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
-00033430: 6170 7065 6e64 2828 2772 6967 6874 546f  append(('rightTo
-00033440: 4c65 6674 272c 2031 2929 0a0a 2020 2020  Left', 1))..    
-00033450: 2020 2020 2320 5368 6f77 2074 6861 7420      # Show that 
-00033460: 7468 6520 7368 6565 7420 7461 6220 6973  the sheet tab is
-00033470: 2073 656c 6563 7465 642e 0a20 2020 2020   selected..     
-00033480: 2020 2069 6620 7365 6c66 2e73 656c 6563     if self.selec
-00033490: 7465 643a 0a20 2020 2020 2020 2020 2020  ted:.           
-000334a0: 2061 7474 7269 6275 7465 732e 6170 7065   attributes.appe
-000334b0: 6e64 2828 2774 6162 5365 6c65 6374 6564  nd(('tabSelected
-000334c0: 272c 2031 2929 0a0a 2020 2020 2020 2020  ', 1))..        
-000334d0: 2320 5475 726e 206f 7574 6c69 6e65 7320  # Turn outlines 
-000334e0: 6f66 662e 2041 6c73 6f20 7265 7175 6972  off. Also requir
-000334f0: 6564 2069 6e20 7468 6520 6f75 746c 696e  ed in the outlin
-00033500: 6550 7220 656c 656d 656e 742e 0a20 2020  ePr element..   
-00033510: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
-00033520: 2e6f 7574 6c69 6e65 5f6f 6e3a 0a20 2020  .outline_on:.   
-00033530: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
-00033540: 7465 732e 6170 7065 6e64 2828 2273 686f  tes.append(("sho
-00033550: 774f 7574 6c69 6e65 5379 6d62 6f6c 7322  wOutlineSymbols"
-00033560: 2c20 3029 290a 0a20 2020 2020 2020 2023  , 0))..        #
-00033570: 2053 6574 2074 6865 2070 6167 6520 7669   Set the page vi
-00033580: 6577 2f6c 6179 6f75 7420 6d6f 6465 2069  ew/layout mode i
-00033590: 6620 7265 7175 6972 6564 2e0a 2020 2020  f required..    
-000335a0: 2020 2020 6966 2073 656c 662e 7061 6765      if self.page
-000335b0: 5f76 6965 773a 0a20 2020 2020 2020 2020  _view:.         
-000335c0: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
-000335d0: 7065 6e64 2828 2776 6965 7727 2c20 2770  pend(('view', 'p
-000335e0: 6167 654c 6179 6f75 7427 2929 0a0a 2020  ageLayout'))..  
-000335f0: 2020 2020 2020 2320 5365 7420 7468 6520        # Set the 
-00033600: 6669 7273 7420 7669 7369 626c 6520 6365  first visible ce
-00033610: 6c6c 2e0a 2020 2020 2020 2020 6966 2073  ll..        if s
-00033620: 656c 662e 746f 705f 6c65 6674 5f63 656c  elf.top_left_cel
-00033630: 6c20 213d 2027 273a 0a20 2020 2020 2020  l != '':.       
-00033640: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
-00033650: 6170 7065 6e64 2828 2774 6f70 4c65 6674  append(('topLeft
-00033660: 4365 6c6c 272c 2073 656c 662e 746f 705f  Cell', self.top_
-00033670: 6c65 6674 5f63 656c 6c29 290a 0a20 2020  left_cell))..   
-00033680: 2020 2020 2023 2053 6574 2074 6865 207a       # Set the z
-00033690: 6f6f 6d20 6c65 7665 6c2e 0a20 2020 2020  oom level..     
-000336a0: 2020 2069 6620 7365 6c66 2e7a 6f6f 6d20     if self.zoom 
-000336b0: 213d 2031 3030 3a0a 2020 2020 2020 2020  != 100:.        
-000336c0: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
-000336d0: 7061 6765 5f76 6965 773a 0a20 2020 2020  page_view:.     
-000336e0: 2020 2020 2020 2020 2020 2061 7474 7269             attri
-000336f0: 6275 7465 732e 6170 7065 6e64 2828 277a  butes.append(('z
-00033700: 6f6f 6d53 6361 6c65 272c 2073 656c 662e  oomScale', self.
-00033710: 7a6f 6f6d 2929 0a20 2020 2020 2020 2020  zoom)).         
-00033720: 2020 2020 2020 2069 6620 7365 6c66 2e7a         if self.z
-00033730: 6f6f 6d5f 7363 616c 655f 6e6f 726d 616c  oom_scale_normal
-00033740: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00033750: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-00033760: 2e61 7070 656e 6428 2827 7a6f 6f6d 5363  .append(('zoomSc
-00033770: 616c 654e 6f72 6d61 6c27 2c20 7365 6c66  aleNormal', self
-00033780: 2e7a 6f6f 6d29 290a 0a20 2020 2020 2020  .zoom))..       
-00033790: 2061 7474 7269 6275 7465 732e 6170 7065   attributes.appe
-000337a0: 6e64 2828 2777 6f72 6b62 6f6f 6b56 6965  nd(('workbookVie
-000337b0: 7749 6427 2c20 3029 290a 0a20 2020 2020  wId', 0))..     
-000337c0: 2020 2069 6620 7365 6c66 2e70 616e 6573     if self.panes
-000337d0: 206f 7220 6c65 6e28 7365 6c66 2e73 656c   or len(self.sel
-000337e0: 6563 7469 6f6e 7329 3a0a 2020 2020 2020  ections):.      
-000337f0: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
-00033800: 7374 6172 745f 7461 6728 2773 6865 6574  start_tag('sheet
-00033810: 5669 6577 272c 2061 7474 7269 6275 7465  View', attribute
-00033820: 7329 0a20 2020 2020 2020 2020 2020 2073  s).            s
-00033830: 656c 662e 5f77 7269 7465 5f70 616e 6573  elf._write_panes
-00033840: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
-00033850: 656c 662e 5f77 7269 7465 5f73 656c 6563  elf._write_selec
-00033860: 7469 6f6e 7328 290a 2020 2020 2020 2020  tions().        
-00033870: 2020 2020 7365 6c66 2e5f 786d 6c5f 656e      self._xml_en
-00033880: 645f 7461 6728 2773 6865 6574 5669 6577  d_tag('sheetView
-00033890: 2729 0a20 2020 2020 2020 2065 6c73 653a  ').        else:
-000338a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-000338b0: 662e 5f78 6d6c 5f65 6d70 7479 5f74 6167  f._xml_empty_tag
-000338c0: 2827 7368 6565 7456 6965 7727 2c20 6174  ('sheetView', at
-000338d0: 7472 6962 7574 6573 290a 0a20 2020 2064  tributes)..    d
-000338e0: 6566 205f 7772 6974 655f 7368 6565 745f  ef _write_sheet_
-000338f0: 666f 726d 6174 5f70 7228 7365 6c66 293a  format_pr(self):
-00033900: 0a20 2020 2020 2020 2023 2057 7269 7465  .        # Write
-00033910: 2074 6865 203c 7368 6565 7446 6f72 6d61   the <sheetForma
-00033920: 7450 723e 2065 6c65 6d65 6e74 2e0a 2020  tPr> element..  
-00033930: 2020 2020 2020 6465 6661 756c 745f 726f        default_ro
-00033940: 775f 6865 6967 6874 203d 2073 656c 662e  w_height = self.
-00033950: 6465 6661 756c 745f 726f 775f 6865 6967  default_row_heig
-00033960: 6874 0a20 2020 2020 2020 2072 6f77 5f6c  ht.        row_l
-00033970: 6576 656c 203d 2073 656c 662e 6f75 746c  evel = self.outl
-00033980: 696e 655f 726f 775f 6c65 7665 6c0a 2020  ine_row_level.  
-00033990: 2020 2020 2020 636f 6c5f 6c65 7665 6c20        col_level 
-000339a0: 3d20 7365 6c66 2e6f 7574 6c69 6e65 5f63  = self.outline_c
-000339b0: 6f6c 5f6c 6576 656c 0a0a 2020 2020 2020  ol_level..      
-000339c0: 2020 6174 7472 6962 7574 6573 203d 205b    attributes = [
-000339d0: 2827 6465 6661 756c 7452 6f77 4865 6967  ('defaultRowHeig
-000339e0: 6874 272c 2064 6566 6175 6c74 5f72 6f77  ht', default_row
-000339f0: 5f68 6569 6768 7429 5d0a 0a20 2020 2020  _height)]..     
-00033a00: 2020 2069 6620 7365 6c66 2e64 6566 6175     if self.defau
-00033a10: 6c74 5f72 6f77 5f68 6569 6768 7420 213d  lt_row_height !=
-00033a20: 2073 656c 662e 6f72 6967 696e 616c 5f72   self.original_r
-00033a30: 6f77 5f68 6569 6768 743a 0a20 2020 2020  ow_height:.     
-00033a40: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
-00033a50: 732e 6170 7065 6e64 2828 2763 7573 746f  s.append(('custo
-00033a60: 6d48 6569 6768 7427 2c20 3129 290a 0a20  mHeight', 1)).. 
-00033a70: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
-00033a80: 6566 6175 6c74 5f72 6f77 5f7a 6572 6f65  efault_row_zeroe
-00033a90: 643a 0a20 2020 2020 2020 2020 2020 2061  d:.            a
-00033aa0: 7474 7269 6275 7465 732e 6170 7065 6e64  ttributes.append
-00033ab0: 2828 277a 6572 6f48 6569 6768 7427 2c20  (('zeroHeight', 
-00033ac0: 3129 290a 0a20 2020 2020 2020 2069 6620  1))..        if 
-00033ad0: 726f 775f 6c65 7665 6c3a 0a20 2020 2020  row_level:.     
-00033ae0: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
-00033af0: 732e 6170 7065 6e64 2828 276f 7574 6c69  s.append(('outli
-00033b00: 6e65 4c65 7665 6c52 6f77 272c 2072 6f77  neLevelRow', row
-00033b10: 5f6c 6576 656c 2929 0a20 2020 2020 2020  _level)).       
-00033b20: 2069 6620 636f 6c5f 6c65 7665 6c3a 0a20   if col_level:. 
-00033b30: 2020 2020 2020 2020 2020 2061 7474 7269             attri
-00033b40: 6275 7465 732e 6170 7065 6e64 2828 276f  butes.append(('o
-00033b50: 7574 6c69 6e65 4c65 7665 6c43 6f6c 272c  utlineLevelCol',
-00033b60: 2063 6f6c 5f6c 6576 656c 2929 0a0a 2020   col_level))..  
-00033b70: 2020 2020 2020 6966 2073 656c 662e 6578        if self.ex
-00033b80: 6365 6c5f 7665 7273 696f 6e20 3d3d 2032  cel_version == 2
-00033b90: 3031 303a 0a20 2020 2020 2020 2020 2020  010:.           
-00033ba0: 2061 7474 7269 6275 7465 732e 6170 7065   attributes.appe
-00033bb0: 6e64 2828 2778 3134 6163 3a64 7944 6573  nd(('x14ac:dyDes
-00033bc0: 6365 6e74 272c 2027 302e 3235 2729 290a  cent', '0.25')).
-00033bd0: 0a20 2020 2020 2020 2073 656c 662e 5f78  .        self._x
-00033be0: 6d6c 5f65 6d70 7479 5f74 6167 2827 7368  ml_empty_tag('sh
-00033bf0: 6565 7446 6f72 6d61 7450 7227 2c20 6174  eetFormatPr', at
-00033c00: 7472 6962 7574 6573 290a 0a20 2020 2064  tributes)..    d
-00033c10: 6566 205f 7772 6974 655f 636f 6c73 2873  ef _write_cols(s
-00033c20: 656c 6629 3a0a 2020 2020 2020 2020 2320  elf):.        # 
-00033c30: 5772 6974 6520 7468 6520 3c63 6f6c 733e  Write the <cols>
-00033c40: 2065 6c65 6d65 6e74 2061 6e64 203c 636f   element and <co
-00033c50: 6c3e 2073 7562 2065 6c65 6d65 6e74 732e  l> sub elements.
-00033c60: 0a0a 2020 2020 2020 2020 2320 4578 6974  ..        # Exit
-00033c70: 2075 6e6c 6573 7320 736f 6d65 2063 6f6c   unless some col
-00033c80: 756d 6e20 6861 7665 2062 6565 6e20 666f  umn have been fo
-00033c90: 726d 6174 7465 642e 0a20 2020 2020 2020  rmatted..       
-00033ca0: 2069 6620 6e6f 7420 7365 6c66 2e63 6f6c   if not self.col
-00033cb0: 5f69 6e66 6f3a 0a20 2020 2020 2020 2020  _info:.         
-00033cc0: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
-00033cd0: 2020 2073 656c 662e 5f78 6d6c 5f73 7461     self._xml_sta
-00033ce0: 7274 5f74 6167 2827 636f 6c73 2729 0a0a  rt_tag('cols')..
-00033cf0: 2020 2020 2020 2020 2320 5573 6520 7468          # Use th
-00033d00: 6520 6669 7273 7420 656c 656d 656e 7420  e first element 
-00033d10: 6f66 2074 6865 2063 6f6c 756d 6e20 696e  of the column in
-00033d20: 666f 726d 6174 696f 6e20 7374 7275 6374  formation struct
-00033d30: 7572 6573 2074 6f20 7365 740a 2020 2020  ures to set.    
-00033d40: 2020 2020 2320 7468 6520 696e 6974 6961      # the initia
-00033d50: 6c2f 7072 6576 696f 7573 2070 726f 7065  l/previous prope
-00033d60: 7274 6965 732e 0a20 2020 2020 2020 2066  rties..        f
-00033d70: 6972 7374 5f63 6f6c 203d 2028 736f 7274  irst_col = (sort
-00033d80: 6564 2873 656c 662e 636f 6c5f 696e 666f  ed(self.col_info
-00033d90: 2e6b 6579 7328 2929 295b 305d 0a20 2020  .keys()))[0].   
-00033da0: 2020 2020 206c 6173 745f 636f 6c20 3d20       last_col = 
-00033db0: 6669 7273 745f 636f 6c0a 2020 2020 2020  first_col.      
-00033dc0: 2020 7072 6576 5f63 6f6c 5f6f 7074 696f    prev_col_optio
-00033dd0: 6e73 203d 2073 656c 662e 636f 6c5f 696e  ns = self.col_in
-00033de0: 666f 5b66 6972 7374 5f63 6f6c 5d0a 2020  fo[first_col].  
-00033df0: 2020 2020 2020 6465 6c20 7365 6c66 2e63        del self.c
-00033e00: 6f6c 5f69 6e66 6f5b 6669 7273 745f 636f  ol_info[first_co
-00033e10: 6c5d 0a20 2020 2020 2020 2064 656c 6574  l].        delet
-00033e20: 6564 5f63 6f6c 203d 2066 6972 7374 5f63  ed_col = first_c
-00033e30: 6f6c 0a20 2020 2020 2020 2064 656c 6574  ol.        delet
-00033e40: 6564 5f63 6f6c 5f6f 7074 696f 6e73 203d  ed_col_options =
-00033e50: 2070 7265 765f 636f 6c5f 6f70 7469 6f6e   prev_col_option
-00033e60: 730a 0a20 2020 2020 2020 2066 6f72 2063  s..        for c
-00033e70: 6f6c 2069 6e20 736f 7274 6564 2873 656c  ol in sorted(sel
-00033e80: 662e 636f 6c5f 696e 666f 2e6b 6579 7328  f.col_info.keys(
-00033e90: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-00033ea0: 636f 6c5f 6f70 7469 6f6e 7320 3d20 7365  col_options = se
-00033eb0: 6c66 2e63 6f6c 5f69 6e66 6f5b 636f 6c5d  lf.col_info[col]
-00033ec0: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
-00033ed0: 6865 636b 2069 6620 7468 6520 636f 6c75  heck if the colu
-00033ee0: 6d6e 206e 756d 6265 7220 6973 2063 6f6e  mn number is con
-00033ef0: 7469 6775 6f75 7320 7769 7468 2074 6865  tiguous with the
-00033f00: 2070 7265 7669 6f75 730a 2020 2020 2020   previous.      
-00033f10: 2020 2020 2020 2320 636f 6c75 6d6e 2061        # column a
-00033f20: 6e64 2069 6620 7468 6520 7072 6f70 6572  nd if the proper
-00033f30: 7469 6573 2061 7265 2074 6865 2073 616d  ties are the sam
-00033f40: 652e 0a20 2020 2020 2020 2020 2020 2069  e..            i
-00033f50: 6620 636f 6c20 3d3d 206c 6173 745f 636f  f col == last_co
-00033f60: 6c20 2b20 3120 616e 6420 636f 6c5f 6f70  l + 1 and col_op
-00033f70: 7469 6f6e 7320 3d3d 2070 7265 765f 636f  tions == prev_co
-00033f80: 6c5f 6f70 7469 6f6e 733a 0a20 2020 2020  l_options:.     
-00033f90: 2020 2020 2020 2020 2020 206c 6173 745f             last_
-00033fa0: 636f 6c20 3d20 636f 6c0a 2020 2020 2020  col = col.      
-00033fb0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00033fc0: 2020 2020 2020 2020 2020 2020 2320 4966              # If
-00033fd0: 206e 6f74 2063 6f6e 7469 6775 6f75 732f   not contiguous/
-00033fe0: 6571 7561 6c20 7468 656e 2077 6520 7772  equal then we wr
-00033ff0: 6974 6520 6f75 7420 7468 6520 6375 7272  ite out the curr
-00034000: 656e 7420 7261 6e67 650a 2020 2020 2020  ent range.      
-00034010: 2020 2020 2020 2020 2020 2320 6f66 2063            # of c
-00034020: 6f6c 756d 6e73 2061 6e64 2073 7461 7274  olumns and start
-00034030: 2061 6761 696e 2e0a 2020 2020 2020 2020   again..        
-00034040: 2020 2020 2020 2020 7365 6c66 2e5f 7772          self._wr
-00034050: 6974 655f 636f 6c5f 696e 666f 2866 6972  ite_col_info(fir
-00034060: 7374 5f63 6f6c 2c20 6c61 7374 5f63 6f6c  st_col, last_col
-00034070: 2c20 7072 6576 5f63 6f6c 5f6f 7074 696f  , prev_col_optio
-00034080: 6e73 290a 2020 2020 2020 2020 2020 2020  ns).            
-00034090: 2020 2020 6669 7273 745f 636f 6c20 3d20      first_col = 
-000340a0: 636f 6c0a 2020 2020 2020 2020 2020 2020  col.            
-000340b0: 2020 2020 6c61 7374 5f63 6f6c 203d 2066      last_col = f
-000340c0: 6972 7374 5f63 6f6c 0a20 2020 2020 2020  irst_col.       
-000340d0: 2020 2020 2020 2020 2070 7265 765f 636f           prev_co
-000340e0: 6c5f 6f70 7469 6f6e 7320 3d20 636f 6c5f  l_options = col_
-000340f0: 6f70 7469 6f6e 730a 0a20 2020 2020 2020  options..       
-00034100: 2023 2057 6520 7769 6c6c 2065 7869 7420   # We will exit 
-00034110: 7468 6520 7072 6576 696f 7573 206c 6f6f  the previous loo
-00034120: 7020 7769 7468 206f 6e65 2075 6e68 616e  p with one unhan
-00034130: 646c 6564 2063 6f6c 756d 6e20 7261 6e67  dled column rang
-00034140: 652e 0a20 2020 2020 2020 2073 656c 662e  e..        self.
-00034150: 5f77 7269 7465 5f63 6f6c 5f69 6e66 6f28  _write_col_info(
-00034160: 6669 7273 745f 636f 6c2c 206c 6173 745f  first_col, last_
-00034170: 636f 6c2c 2070 7265 765f 636f 6c5f 6f70  col, prev_col_op
-00034180: 7469 6f6e 7329 0a0a 2020 2020 2020 2020  tions)..        
-00034190: 2320 5075 7420 6261 636b 2074 6865 2064  # Put back the d
-000341a0: 656c 6574 6564 2066 6972 7374 2063 6f6c  eleted first col
-000341b0: 756d 6e20 696e 666f 726d 6174 696f 6e20  umn information 
-000341c0: 7374 7275 6374 7572 652e 0a20 2020 2020  structure..     
-000341d0: 2020 2073 656c 662e 636f 6c5f 696e 666f     self.col_info
-000341e0: 5b64 656c 6574 6564 5f63 6f6c 5d20 3d20  [deleted_col] = 
-000341f0: 6465 6c65 7465 645f 636f 6c5f 6f70 7469  deleted_col_opti
-00034200: 6f6e 730a 0a20 2020 2020 2020 2073 656c  ons..        sel
-00034210: 662e 5f78 6d6c 5f65 6e64 5f74 6167 2827  f._xml_end_tag('
-00034220: 636f 6c73 2729 0a0a 2020 2020 6465 6620  cols')..    def 
-00034230: 5f77 7269 7465 5f63 6f6c 5f69 6e66 6f28  _write_col_info(
-00034240: 7365 6c66 2c20 636f 6c5f 6d69 6e2c 2063  self, col_min, c
-00034250: 6f6c 5f6d 6178 2c20 636f 6c5f 696e 666f  ol_max, col_info
-00034260: 293a 0a20 2020 2020 2020 2023 2057 7269  ):.        # Wri
-00034270: 7465 2074 6865 203c 636f 6c3e 2065 6c65  te the <col> ele
-00034280: 6d65 6e74 2e0a 2020 2020 2020 2020 2877  ment..        (w
-00034290: 6964 7468 2c20 6365 6c6c 5f66 6f72 6d61  idth, cell_forma
-000342a0: 742c 2068 6964 6465 6e2c 206c 6576 656c  t, hidden, level
-000342b0: 2c20 636f 6c6c 6170 7365 642c 2061 7574  , collapsed, aut
-000342c0: 6f66 6974 2920 3d20 636f 6c5f 696e 666f  ofit) = col_info
-000342d0: 0a0a 2020 2020 2020 2020 6375 7374 6f6d  ..        custom
-000342e0: 5f77 6964 7468 203d 2031 0a20 2020 2020  _width = 1.     
-000342f0: 2020 2078 665f 696e 6465 7820 3d20 300a     xf_index = 0.
-00034300: 0a20 2020 2020 2020 2023 2047 6574 2074  .        # Get t
-00034310: 6865 2063 656c 6c5f 666f 726d 6174 2069  he cell_format i
-00034320: 6e64 6578 2e0a 2020 2020 2020 2020 6966  ndex..        if
-00034330: 2063 656c 6c5f 666f 726d 6174 3a0a 2020   cell_format:.  
-00034340: 2020 2020 2020 2020 2020 7866 5f69 6e64            xf_ind
-00034350: 6578 203d 2063 656c 6c5f 666f 726d 6174  ex = cell_format
-00034360: 2e5f 6765 745f 7866 5f69 6e64 6578 2829  ._get_xf_index()
-00034370: 0a0a 2020 2020 2020 2020 2320 5365 7420  ..        # Set 
-00034380: 7468 6520 4578 6365 6c20 6465 6661 756c  the Excel defaul
-00034390: 7420 636f 6c75 6d6e 2077 6964 7468 2e0a  t column width..
-000343a0: 2020 2020 2020 2020 6966 2077 6964 7468          if width
-000343b0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-000343c0: 2020 2020 2020 6966 206e 6f74 2068 6964        if not hid
-000343d0: 6465 6e3a 0a20 2020 2020 2020 2020 2020  den:.           
-000343e0: 2020 2020 2077 6964 7468 203d 2038 2e34       width = 8.4
-000343f0: 330a 2020 2020 2020 2020 2020 2020 2020  3.              
-00034400: 2020 6375 7374 6f6d 5f77 6964 7468 203d    custom_width =
-00034410: 2030 0a20 2020 2020 2020 2020 2020 2065   0.            e
-00034420: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00034430: 2020 2020 2077 6964 7468 203d 2030 0a20       width = 0. 
-00034440: 2020 2020 2020 2065 6c69 6620 7769 6474         elif widt
-00034450: 6820 3d3d 2038 2e34 333a 0a20 2020 2020  h == 8.43:.     
-00034460: 2020 2020 2020 2023 2057 6964 7468 2069         # Width i
-00034470: 7320 6465 6669 6e65 6420 6275 7420 7361  s defined but sa
-00034480: 6d65 2061 7320 6465 6661 756c 742e 0a20  me as default.. 
-00034490: 2020 2020 2020 2020 2020 2063 7573 746f             custo
-000344a0: 6d5f 7769 6474 6820 3d20 300a 0a20 2020  m_width = 0..   
-000344b0: 2020 2020 2023 2043 6f6e 7665 7274 2063       # Convert c
-000344c0: 6f6c 756d 6e20 7769 6474 6820 6672 6f6d  olumn width from
-000344d0: 2075 7365 7220 756e 6974 7320 746f 2063   user units to c
-000344e0: 6861 7261 6374 6572 2077 6964 7468 2e0a  haracter width..
-000344f0: 2020 2020 2020 2020 6966 2077 6964 7468          if width
-00034500: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
-00034510: 2020 2320 466f 7220 4361 6c61 6272 6920    # For Calabri 
-00034520: 3131 2e0a 2020 2020 2020 2020 2020 2020  11..            
-00034530: 6d61 785f 6469 6769 745f 7769 6474 6820  max_digit_width 
-00034540: 3d20 370a 2020 2020 2020 2020 2020 2020  = 7.            
-00034550: 7061 6464 696e 6720 3d20 350a 0a20 2020  padding = 5..   
-00034560: 2020 2020 2020 2020 2069 6620 7769 6474           if widt
-00034570: 6820 3c20 313a 0a20 2020 2020 2020 2020  h < 1:.         
-00034580: 2020 2020 2020 2077 6964 7468 203d 2069         width = i
-00034590: 6e74 2828 696e 7428 7769 6474 6820 2a20  nt((int(width * 
-000345a0: 286d 6178 5f64 6967 6974 5f77 6964 7468  (max_digit_width
-000345b0: 202b 2070 6164 6469 6e67 2920 2b20 302e   + padding) + 0.
-000345c0: 3529 290a 2020 2020 2020 2020 2020 2020  5)).            
-000345d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000345e0: 2f20 666c 6f61 7428 6d61 785f 6469 6769  / float(max_digi
-000345f0: 745f 7769 6474 6829 202a 2032 3536 2e30  t_width) * 256.0
-00034600: 2920 2f20 3235 362e 300a 2020 2020 2020  ) / 256.0.      
-00034610: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00034620: 2020 2020 2020 2020 2020 2020 7769 6474              widt
-00034630: 6820 3d20 696e 7428 2869 6e74 2877 6964  h = int((int(wid
-00034640: 7468 202a 206d 6178 5f64 6967 6974 5f77  th * max_digit_w
-00034650: 6964 7468 202b 2030 2e35 2920 2b20 7061  idth + 0.5) + pa
-00034660: 6464 696e 6729 0a20 2020 2020 2020 2020  dding).         
-00034670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034680: 2020 202f 2066 6c6f 6174 286d 6178 5f64     / float(max_d
-00034690: 6967 6974 5f77 6964 7468 2920 2a20 3235  igit_width) * 25
-000346a0: 362e 3029 202f 2032 3536 2e30 0a0a 2020  6.0) / 256.0..  
-000346b0: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-000346c0: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
-000346d0: 2028 276d 696e 272c 2063 6f6c 5f6d 696e   ('min', col_min
-000346e0: 202b 2031 292c 0a20 2020 2020 2020 2020   + 1),.         
-000346f0: 2020 2028 276d 6178 272c 2063 6f6c 5f6d     ('max', col_m
-00034700: 6178 202b 2031 292c 0a20 2020 2020 2020  ax + 1),.       
-00034710: 2020 2020 2028 2777 6964 7468 272c 2022       ('width', "
-00034720: 252e 3136 6722 2025 2077 6964 7468 295d  %.16g" % width)]
-00034730: 0a0a 2020 2020 2020 2020 6966 2078 665f  ..        if xf_
-00034740: 696e 6465 783a 0a20 2020 2020 2020 2020  index:.         
-00034750: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
-00034760: 7065 6e64 2828 2773 7479 6c65 272c 2078  pend(('style', x
-00034770: 665f 696e 6465 7829 290a 2020 2020 2020  f_index)).      
-00034780: 2020 6966 2068 6964 6465 6e3a 0a20 2020    if hidden:.   
-00034790: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
-000347a0: 7465 732e 6170 7065 6e64 2828 2768 6964  tes.append(('hid
-000347b0: 6465 6e27 2c20 2731 2729 290a 2020 2020  den', '1')).    
-000347c0: 2020 2020 6966 2061 7574 6f66 6974 3a0a      if autofit:.
-000347d0: 2020 2020 2020 2020 2020 2020 6174 7472              attr
-000347e0: 6962 7574 6573 2e61 7070 656e 6428 2827  ibutes.append(('
-000347f0: 6265 7374 4669 7427 2c20 2731 2729 290a  bestFit', '1')).
-00034800: 2020 2020 2020 2020 6966 2063 7573 746f          if custo
-00034810: 6d5f 7769 6474 683a 0a20 2020 2020 2020  m_width:.       
-00034820: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
-00034830: 6170 7065 6e64 2828 2763 7573 746f 6d57  append(('customW
-00034840: 6964 7468 272c 2027 3127 2929 0a20 2020  idth', '1')).   
-00034850: 2020 2020 2069 6620 6c65 7665 6c3a 0a20       if level:. 
-00034860: 2020 2020 2020 2020 2020 2061 7474 7269             attri
-00034870: 6275 7465 732e 6170 7065 6e64 2828 276f  butes.append(('o
-00034880: 7574 6c69 6e65 4c65 7665 6c27 2c20 6c65  utlineLevel', le
-00034890: 7665 6c29 290a 2020 2020 2020 2020 6966  vel)).        if
-000348a0: 2063 6f6c 6c61 7073 6564 3a0a 2020 2020   collapsed:.    
-000348b0: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
-000348c0: 6573 2e61 7070 656e 6428 2827 636f 6c6c  es.append(('coll
-000348d0: 6170 7365 6427 2c20 2731 2729 290a 0a20  apsed', '1')).. 
-000348e0: 2020 2020 2020 2073 656c 662e 5f78 6d6c         self._xml
-000348f0: 5f65 6d70 7479 5f74 6167 2827 636f 6c27  _empty_tag('col'
-00034900: 2c20 6174 7472 6962 7574 6573 290a 0a20  , attributes).. 
-00034910: 2020 2064 6566 205f 7772 6974 655f 7368     def _write_sh
-00034920: 6565 745f 6461 7461 2873 656c 6629 3a0a  eet_data(self):.
-00034930: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
-00034940: 7468 6520 3c73 6865 6574 4461 7461 3e20  the <sheetData> 
-00034950: 656c 656d 656e 742e 0a0a 2020 2020 2020  element...      
-00034960: 2020 6966 2073 656c 662e 6469 6d5f 726f    if self.dim_ro
-00034970: 776d 696e 2069 7320 4e6f 6e65 3a0a 2020  wmin is None:.  
-00034980: 2020 2020 2020 2020 2020 2320 4966 2074            # If t
-00034990: 6865 2064 696d 656e 7369 6f6e 7320 6172  he dimensions ar
-000349a0: 656e 2774 2064 6566 696e 6564 2074 6865  en't defined the
-000349b0: 7265 2069 7320 6e6f 2064 6174 6120 746f  re is no data to
-000349c0: 2077 7269 7465 2e0a 2020 2020 2020 2020   write..        
-000349d0: 2020 2020 7365 6c66 2e5f 786d 6c5f 656d      self._xml_em
-000349e0: 7074 795f 7461 6728 2773 6865 6574 4461  pty_tag('sheetDa
-000349f0: 7461 2729 0a20 2020 2020 2020 2065 6c73  ta').        els
-00034a00: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-00034a10: 656c 662e 5f78 6d6c 5f73 7461 7274 5f74  elf._xml_start_t
-00034a20: 6167 2827 7368 6565 7444 6174 6127 290a  ag('sheetData').
-00034a30: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00034a40: 2e5f 7772 6974 655f 726f 7773 2829 0a20  ._write_rows(). 
-00034a50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00034a60: 5f78 6d6c 5f65 6e64 5f74 6167 2827 7368  _xml_end_tag('sh
-00034a70: 6565 7444 6174 6127 290a 0a20 2020 2064  eetData')..    d
-00034a80: 6566 205f 7772 6974 655f 6f70 7469 6d69  ef _write_optimi
-00034a90: 7a65 645f 7368 6565 745f 6461 7461 2873  zed_sheet_data(s
-00034aa0: 656c 6629 3a0a 2020 2020 2020 2020 2320  elf):.        # 
-00034ab0: 5772 6974 6520 7468 6520 3c73 6865 6574  Write the <sheet
-00034ac0: 4461 7461 3e20 656c 656d 656e 7420 7768  Data> element wh
-00034ad0: 656e 2063 6f6e 7374 616e 745f 6d65 6d6f  en constant_memo
-00034ae0: 7279 2069 7320 6f6e 2e20 496e 2074 6869  ry is on. In thi
-00034af0: 730a 2020 2020 2020 2020 2320 6361 7365  s.        # case
-00034b00: 2077 6520 7265 6164 2074 6865 2064 6174   we read the dat
-00034b10: 6120 7374 6f72 6564 2069 6e20 7468 6520  a stored in the 
-00034b20: 7465 6d70 2066 696c 6520 616e 6420 7265  temp file and re
-00034b30: 7772 6974 6520 6974 2074 6f20 7468 650a  write it to the.
-00034b40: 2020 2020 2020 2020 2320 584d 4c20 7368          # XML sh
-00034b50: 6565 7420 6669 6c65 2e0a 2020 2020 2020  eet file..      
-00034b60: 2020 6966 2073 656c 662e 6469 6d5f 726f    if self.dim_ro
-00034b70: 776d 696e 2069 7320 4e6f 6e65 3a0a 2020  wmin is None:.  
-00034b80: 2020 2020 2020 2020 2020 2320 4966 2074            # If t
-00034b90: 6865 2064 696d 656e 7369 6f6e 7320 6172  he dimensions ar
-00034ba0: 656e 2774 2064 6566 696e 6564 2074 6865  en't defined the
-00034bb0: 6e20 7468 6572 6520 6973 206e 6f20 6461  n there is no da
-00034bc0: 7461 2074 6f20 7772 6974 652e 0a20 2020  ta to write..   
-00034bd0: 2020 2020 2020 2020 2073 656c 662e 5f78           self._x
-00034be0: 6d6c 5f65 6d70 7479 5f74 6167 2827 7368  ml_empty_tag('sh
-00034bf0: 6565 7444 6174 6127 290a 2020 2020 2020  eetData').      
-00034c00: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00034c10: 2020 2020 7365 6c66 2e5f 786d 6c5f 7374      self._xml_st
-00034c20: 6172 745f 7461 6728 2773 6865 6574 4461  art_tag('sheetDa
-00034c30: 7461 2729 0a0a 2020 2020 2020 2020 2020  ta')..          
-00034c40: 2020 2320 5265 7769 6e64 2074 6865 2066    # Rewind the f
-00034c50: 696c 6568 616e 646c 6520 7468 6174 2077  ilehandle that w
-00034c60: 6173 2075 7365 6420 666f 7220 7465 6d70  as used for temp
-00034c70: 2072 6f77 2064 6174 612e 0a20 2020 2020   row data..     
-00034c80: 2020 2020 2020 2062 7566 665f 7369 7a65         buff_size
-00034c90: 203d 2036 3535 3336 0a20 2020 2020 2020   = 65536.       
-00034ca0: 2020 2020 2073 656c 662e 726f 775f 6461       self.row_da
-00034cb0: 7461 5f66 682e 7365 656b 2830 290a 2020  ta_fh.seek(0).  
-00034cc0: 2020 2020 2020 2020 2020 6461 7461 203d            data =
-00034cd0: 2073 656c 662e 726f 775f 6461 7461 5f66   self.row_data_f
-00034ce0: 682e 7265 6164 2862 7566 665f 7369 7a65  h.read(buff_size
-00034cf0: 290a 0a20 2020 2020 2020 2020 2020 2077  )..            w
-00034d00: 6869 6c65 2064 6174 613a 0a20 2020 2020  hile data:.     
-00034d10: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00034d20: 6668 2e77 7269 7465 2864 6174 6129 0a20  fh.write(data). 
-00034d30: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00034d40: 6174 6120 3d20 7365 6c66 2e72 6f77 5f64  ata = self.row_d
-00034d50: 6174 615f 6668 2e72 6561 6428 6275 6666  ata_fh.read(buff
-00034d60: 5f73 697a 6529 0a0a 2020 2020 2020 2020  _size)..        
-00034d70: 2020 2020 7365 6c66 2e72 6f77 5f64 6174      self.row_dat
-00034d80: 615f 6668 2e63 6c6f 7365 2829 0a20 2020  a_fh.close().   
-00034d90: 2020 2020 2020 2020 206f 732e 756e 6c69           os.unli
-00034da0: 6e6b 2873 656c 662e 726f 775f 6461 7461  nk(self.row_data
-00034db0: 5f66 696c 656e 616d 6529 0a0a 2020 2020  _filename)..    
-00034dc0: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
-00034dd0: 6c5f 656e 645f 7461 6728 2773 6865 6574  l_end_tag('sheet
-00034de0: 4461 7461 2729 0a0a 2020 2020 6465 6620  Data')..    def 
-00034df0: 5f77 7269 7465 5f70 6167 655f 6d61 7267  _write_page_marg
-00034e00: 696e 7328 7365 6c66 293a 0a20 2020 2020  ins(self):.     
-00034e10: 2020 2023 2057 7269 7465 2074 6865 203c     # Write the <
-00034e20: 7061 6765 4d61 7267 696e 733e 2065 6c65  pageMargins> ele
-00034e30: 6d65 6e74 2e0a 2020 2020 2020 2020 6174  ment..        at
-00034e40: 7472 6962 7574 6573 203d 205b 0a20 2020  tributes = [.   
-00034e50: 2020 2020 2020 2020 2028 276c 6566 7427           ('left'
-00034e60: 2c20 7365 6c66 2e6d 6172 6769 6e5f 6c65  , self.margin_le
-00034e70: 6674 292c 0a20 2020 2020 2020 2020 2020  ft),.           
-00034e80: 2028 2772 6967 6874 272c 2073 656c 662e   ('right', self.
-00034e90: 6d61 7267 696e 5f72 6967 6874 292c 0a20  margin_right),. 
-00034ea0: 2020 2020 2020 2020 2020 2028 2774 6f70             ('top
-00034eb0: 272c 2073 656c 662e 6d61 7267 696e 5f74  ', self.margin_t
-00034ec0: 6f70 292c 0a20 2020 2020 2020 2020 2020  op),.           
-00034ed0: 2028 2762 6f74 746f 6d27 2c20 7365 6c66   ('bottom', self
-00034ee0: 2e6d 6172 6769 6e5f 626f 7474 6f6d 292c  .margin_bottom),
-00034ef0: 0a20 2020 2020 2020 2020 2020 2028 2768  .            ('h
-00034f00: 6561 6465 7227 2c20 7365 6c66 2e6d 6172  eader', self.mar
-00034f10: 6769 6e5f 6865 6164 6572 292c 0a20 2020  gin_header),.   
-00034f20: 2020 2020 2020 2020 2028 2766 6f6f 7465           ('foote
-00034f30: 7227 2c20 7365 6c66 2e6d 6172 6769 6e5f  r', self.margin_
-00034f40: 666f 6f74 6572 295d 0a0a 2020 2020 2020  footer)]..      
-00034f50: 2020 7365 6c66 2e5f 786d 6c5f 656d 7074    self._xml_empt
-00034f60: 795f 7461 6728 2770 6167 654d 6172 6769  y_tag('pageMargi
-00034f70: 6e73 272c 2061 7474 7269 6275 7465 7329  ns', attributes)
-00034f80: 0a0a 2020 2020 6465 6620 5f77 7269 7465  ..    def _write
-00034f90: 5f70 6167 655f 7365 7475 7028 7365 6c66  _page_setup(self
-00034fa0: 293a 0a20 2020 2020 2020 2023 2057 7269  ):.        # Wri
-00034fb0: 7465 2074 6865 203c 7061 6765 5365 7475  te the <pageSetu
-00034fc0: 703e 2065 6c65 6d65 6e74 2e0a 2020 2020  p> element..    
-00034fd0: 2020 2020 230a 2020 2020 2020 2020 2320      #.        # 
-00034fe0: 5468 6520 666f 6c6c 6f77 696e 6720 6973  The following is
-00034ff0: 2061 6e20 6578 616d 706c 6520 7461 6b65   an example take
-00035000: 6e20 6672 6f6d 2045 7863 656c 2e0a 2020  n from Excel..  
-00035010: 2020 2020 2020 230a 2020 2020 2020 2020        #.        
-00035020: 2320 3c70 6167 6553 6574 7570 0a20 2020  # <pageSetup.   
-00035030: 2020 2020 2023 2020 2020 2070 6170 6572       #     paper
-00035040: 5369 7a65 3d22 3922 0a20 2020 2020 2020  Size="9".       
-00035050: 2023 2020 2020 2073 6361 6c65 3d22 3131   #     scale="11
-00035060: 3022 0a20 2020 2020 2020 2023 2020 2020  0".        #    
-00035070: 2066 6974 546f 5769 6474 683d 2232 220a   fitToWidth="2".
-00035080: 2020 2020 2020 2020 2320 2020 2020 6669          #     fi
-00035090: 7454 6f48 6569 6768 743d 2232 220a 2020  tToHeight="2".  
-000350a0: 2020 2020 2020 2320 2020 2020 7061 6765        #     page
-000350b0: 4f72 6465 723d 226f 7665 7254 6865 6e44  Order="overThenD
-000350c0: 6f77 6e22 0a20 2020 2020 2020 2023 2020  own".        #  
-000350d0: 2020 206f 7269 656e 7461 7469 6f6e 3d22     orientation="
-000350e0: 706f 7274 7261 6974 220a 2020 2020 2020  portrait".      
-000350f0: 2020 2320 2020 2020 626c 6163 6b41 6e64    #     blackAnd
-00035100: 5768 6974 653d 2231 220a 2020 2020 2020  White="1".      
-00035110: 2020 2320 2020 2020 6472 6166 743d 2231    #     draft="1
-00035120: 220a 2020 2020 2020 2020 2320 2020 2020  ".        #     
-00035130: 686f 7269 7a6f 6e74 616c 4470 693d 2232  horizontalDpi="2
-00035140: 3030 220a 2020 2020 2020 2020 2320 2020  00".        #   
-00035150: 2020 7665 7274 6963 616c 4470 693d 2232    verticalDpi="2
-00035160: 3030 220a 2020 2020 2020 2020 2320 2020  00".        #   
-00035170: 2020 723a 6964 3d22 7249 6431 220a 2020    r:id="rId1".  
-00035180: 2020 2020 2020 2320 2f3e 0a20 2020 2020        # />.     
-00035190: 2020 2023 0a20 2020 2020 2020 2061 7474     #.        att
-000351a0: 7269 6275 7465 7320 3d20 5b5d 0a0a 2020  ributes = []..  
-000351b0: 2020 2020 2020 2320 536b 6970 2074 6869        # Skip thi
-000351c0: 7320 656c 656d 656e 7420 6966 206e 6f20  s element if no 
-000351d0: 7061 6765 2073 6574 7570 2068 6173 2063  page setup has c
-000351e0: 6861 6e67 6564 2e0a 2020 2020 2020 2020  hanged..        
-000351f0: 6966 206e 6f74 2073 656c 662e 7061 6765  if not self.page
-00035200: 5f73 6574 7570 5f63 6861 6e67 6564 3a0a  _setup_changed:.
-00035210: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00035220: 726e 0a0a 2020 2020 2020 2020 2320 5365  rn..        # Se
-00035230: 7420 7061 7065 7220 7369 7a65 2e0a 2020  t paper size..  
-00035240: 2020 2020 2020 6966 2073 656c 662e 7061        if self.pa
-00035250: 7065 725f 7369 7a65 3a0a 2020 2020 2020  per_size:.      
+0002ef80: 6f6d 6d65 6e74 735f 6c69 7374 203d 2063  omments_list = c
+0002ef90: 6f6d 6d65 6e74 730a 0a20 2020 2020 2020  omments..       
+0002efa0: 2020 2020 2073 656c 662e 6578 7465 726e       self.extern
+0002efb0: 616c 5f63 6f6d 6d65 6e74 5f6c 696e 6b73  al_comment_links
+0002efc0: 2e61 7070 656e 6428 0a20 2020 2020 2020  .append(.       
+0002efd0: 2020 2020 2020 2020 205b 222f 636f 6d6d           ["/comm
+0002efe0: 656e 7473 222c 2022 2e2e 2f63 6f6d 6d65  ents", "../comme
+0002eff0: 6e74 7322 202b 2073 7472 2863 6f6d 6d65  nts" + str(comme
+0002f000: 6e74 5f69 6429 202b 2022 2e78 6d6c 225d  nt_id) + ".xml"]
+0002f010: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+0002f020: 2020 2020 2020 2020 636f 756e 7420 3d20          count = 
+0002f030: 6c65 6e28 636f 6d6d 656e 7473 290a 2020  len(comments).  
+0002f040: 2020 2020 2020 7374 6172 745f 6461 7461        start_data
+0002f050: 5f69 6420 3d20 766d 6c5f 6461 7461 5f69  _id = vml_data_i
+0002f060: 640a 0a20 2020 2020 2020 2023 2054 6865  d..        # The
+0002f070: 2056 4d4c 206f 3a69 646d 6170 2064 6174   VML o:idmap dat
+0002f080: 6120 6964 2063 6f6e 7461 696e 7320 6120  a id contains a 
+0002f090: 636f 6d6d 6120 7365 7061 7261 7465 6420  comma separated 
+0002f0a0: 7261 6e67 6520 7768 656e 2074 6865 7265  range when there
+0002f0b0: 0a20 2020 2020 2020 2023 2069 7320 6d6f  .        # is mo
+0002f0c0: 7265 2074 6861 6e20 6f6e 6520 3130 3234  re than one 1024
+0002f0d0: 2062 6c6f 636b 206f 6620 636f 6d6d 656e   block of commen
+0002f0e0: 7473 2c20 6c69 6b65 2074 6869 733a 2064  ts, like this: d
+0002f0f0: 6174 613d 2231 2c32 222e 0a20 2020 2020  ata="1,2"..     
+0002f100: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+0002f110: 6528 696e 7428 636f 756e 7420 2f20 3130  e(int(count / 10
+0002f120: 3234 2929 3a0a 2020 2020 2020 2020 2020  24)):.          
+0002f130: 2020 766d 6c5f 6461 7461 5f69 6420 3d20    vml_data_id = 
+0002f140: 2225 732c 2564 2220 2520 2876 6d6c 5f64  "%s,%d" % (vml_d
+0002f150: 6174 615f 6964 2c20 7374 6172 745f 6461  ata_id, start_da
+0002f160: 7461 5f69 6420 2b20 6920 2b20 3129 0a0a  ta_id + i + 1)..
+0002f170: 2020 2020 2020 2020 7365 6c66 2e76 6d6c          self.vml
+0002f180: 5f64 6174 615f 6964 203d 2076 6d6c 5f64  _data_id = vml_d
+0002f190: 6174 615f 6964 0a20 2020 2020 2020 2073  ata_id.        s
+0002f1a0: 656c 662e 766d 6c5f 7368 6170 655f 6964  elf.vml_shape_id
+0002f1b0: 203d 2076 6d6c 5f73 6861 7065 5f69 640a   = vml_shape_id.
+0002f1c0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002f1d0: 636f 756e 740a 0a20 2020 2064 6566 205f  count..    def _
+0002f1e0: 7072 6570 6172 655f 6865 6164 6572 5f76  prepare_header_v
+0002f1f0: 6d6c 5f6f 626a 6563 7473 2873 656c 662c  ml_objects(self,
+0002f200: 2076 6d6c 5f68 6561 6465 725f 6964 2c20   vml_header_id, 
+0002f210: 766d 6c5f 6472 6177 696e 675f 6964 293a  vml_drawing_id):
+0002f220: 0a20 2020 2020 2020 2023 2053 6574 2075  .        # Set u
+0002f230: 7020 6578 7465 726e 616c 206c 696e 6b61  p external linka
+0002f240: 6765 2066 6f72 2056 4d4c 2068 6561 6465  ge for VML heade
+0002f250: 722f 666f 6f74 6572 2069 6d61 6765 732e  r/footer images.
+0002f260: 0a0a 2020 2020 2020 2020 7365 6c66 2e76  ..        self.v
+0002f270: 6d6c 5f68 6561 6465 725f 6964 203d 2076  ml_header_id = v
+0002f280: 6d6c 5f68 6561 6465 725f 6964 0a0a 2020  ml_header_id..  
+0002f290: 2020 2020 2020 7365 6c66 2e65 7874 6572        self.exter
+0002f2a0: 6e61 6c5f 766d 6c5f 6c69 6e6b 732e 6170  nal_vml_links.ap
+0002f2b0: 7065 6e64 280a 2020 2020 2020 2020 2020  pend(.          
+0002f2c0: 2020 5b22 2f76 6d6c 4472 6177 696e 6722    ["/vmlDrawing"
+0002f2d0: 2c20 222e 2e2f 6472 6177 696e 6773 2f76  , "../drawings/v
+0002f2e0: 6d6c 4472 6177 696e 6722 202b 2073 7472  mlDrawing" + str
+0002f2f0: 2876 6d6c 5f64 7261 7769 6e67 5f69 6429  (vml_drawing_id)
+0002f300: 202b 2022 2e76 6d6c 225d 0a20 2020 2020   + ".vml"].     
+0002f310: 2020 2029 0a0a 2020 2020 6465 6620 5f70     )..    def _p
+0002f320: 7265 7061 7265 5f74 6162 6c65 7328 7365  repare_tables(se
+0002f330: 6c66 2c20 7461 626c 655f 6964 2c20 7365  lf, table_id, se
+0002f340: 656e 293a 0a20 2020 2020 2020 2023 2053  en):.        # S
+0002f350: 6574 2074 6865 2074 6162 6c65 2069 6473  et the table ids
+0002f360: 2066 6f72 2074 6865 2077 6f72 6b73 6865   for the workshe
+0002f370: 6574 2074 6162 6c65 732e 0a20 2020 2020  et tables..     
+0002f380: 2020 2066 6f72 2074 6162 6c65 2069 6e20     for table in 
+0002f390: 7365 6c66 2e74 6162 6c65 733a 0a20 2020  self.tables:.   
+0002f3a0: 2020 2020 2020 2020 2074 6162 6c65 5b22           table["
+0002f3b0: 6964 225d 203d 2074 6162 6c65 5f69 640a  id"] = table_id.
+0002f3c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0002f3d0: 7461 626c 652e 6765 7428 226e 616d 6522  table.get("name"
+0002f3e0: 2920 6973 204e 6f6e 653a 0a20 2020 2020  ) is None:.     
+0002f3f0: 2020 2020 2020 2020 2020 2023 2053 6574             # Set
+0002f400: 2061 2064 6566 6175 6c74 206e 616d 652e   a default name.
+0002f410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f420: 2074 6162 6c65 5b22 6e61 6d65 225d 203d   table["name"] =
+0002f430: 2022 5461 626c 6522 202b 2073 7472 2874   "Table" + str(t
+0002f440: 6162 6c65 5f69 6429 0a0a 2020 2020 2020  able_id)..      
+0002f450: 2020 2020 2020 2320 4368 6563 6b20 666f        # Check fo
+0002f460: 7220 6475 706c 6963 6174 6520 7461 626c  r duplicate tabl
+0002f470: 6520 6e61 6d65 732e 0a20 2020 2020 2020  e names..       
+0002f480: 2020 2020 206e 616d 6520 3d20 7461 626c       name = tabl
+0002f490: 655b 226e 616d 6522 5d2e 6c6f 7765 7228  e["name"].lower(
+0002f4a0: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
+0002f4b0: 6620 6e61 6d65 2069 6e20 7365 656e 3a0a  f name in seen:.
+0002f4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f4d0: 7261 6973 6520 4475 706c 6963 6174 6554  raise DuplicateT
+0002f4e0: 6162 6c65 4e61 6d65 280a 2020 2020 2020  ableName(.      
+0002f4f0: 2020 2020 2020 2020 2020 2020 2020 2244                "D
+0002f500: 7570 6c69 6361 7465 206e 616d 6520 2725  uplicate name '%
+0002f510: 7327 2075 7365 6420 696e 2077 6f72 6b73  s' used in works
+0002f520: 6865 6574 2e61 6464 5f74 6162 6c65 2829  heet.add_table()
+0002f530: 2e22 2025 2074 6162 6c65 5b22 6e61 6d65  ." % table["name
+0002f540: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
+0002f550: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0002f560: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0002f570: 2020 2020 2020 2073 6565 6e5b 6e61 6d65         seen[name
+0002f580: 5d20 3d20 5472 7565 0a0a 2020 2020 2020  ] = True..      
+0002f590: 2020 2020 2020 2320 5374 6f72 6520 7468        # Store th
+0002f5a0: 6520 6c69 6e6b 2075 7365 6420 666f 7220  e link used for 
+0002f5b0: 7468 6520 7265 6c73 2066 696c 652e 0a20  the rels file.. 
+0002f5c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0002f5d0: 6578 7465 726e 616c 5f74 6162 6c65 5f6c  external_table_l
+0002f5e0: 696e 6b73 2e61 7070 656e 6428 0a20 2020  inks.append(.   
+0002f5f0: 2020 2020 2020 2020 2020 2020 205b 222f               ["/
+0002f600: 7461 626c 6522 2c20 222e 2e2f 7461 626c  table", "../tabl
+0002f610: 6573 2f74 6162 6c65 2220 2b20 7374 7228  es/table" + str(
+0002f620: 7461 626c 655f 6964 2920 2b20 222e 786d  table_id) + ".xm
+0002f630: 6c22 5d0a 2020 2020 2020 2020 2020 2020  l"].            
+0002f640: 290a 2020 2020 2020 2020 2020 2020 7461  ).            ta
+0002f650: 626c 655f 6964 202b 3d20 310a 0a20 2020  ble_id += 1..   
+0002f660: 2064 6566 205f 7461 626c 655f 6675 6e63   def _table_func
+0002f670: 7469 6f6e 5f74 6f5f 666f 726d 756c 6128  tion_to_formula(
+0002f680: 7365 6c66 2c20 6675 6e63 7469 6f6e 2c20  self, function, 
+0002f690: 636f 6c5f 6e61 6d65 293a 0a20 2020 2020  col_name):.     
+0002f6a0: 2020 2023 2043 6f6e 7665 7274 2061 2074     # Convert a t
+0002f6b0: 6162 6c65 2074 6f74 616c 2066 756e 6374  able total funct
+0002f6c0: 696f 6e20 746f 2061 2077 6f72 6b73 6865  ion to a workshe
+0002f6d0: 6574 2066 6f72 6d75 6c61 2e0a 2020 2020  et formula..    
+0002f6e0: 2020 2020 666f 726d 756c 6120 3d20 2222      formula = ""
+0002f6f0: 0a0a 2020 2020 2020 2020 2320 4573 6361  ..        # Esca
+0002f700: 7065 2073 7065 6369 616c 2063 6861 7261  pe special chara
+0002f710: 6374 6572 732c 2061 7320 7265 7175 6972  cters, as requir
+0002f720: 6564 2062 7920 4578 6365 6c2e 0a20 2020  ed by Excel..   
+0002f730: 2020 2020 2063 6f6c 5f6e 616d 6520 3d20       col_name = 
+0002f740: 636f 6c5f 6e61 6d65 2e72 6570 6c61 6365  col_name.replace
+0002f750: 2822 2722 2c20 2227 2722 290a 2020 2020  ("'", "''").    
+0002f760: 2020 2020 636f 6c5f 6e61 6d65 203d 2063      col_name = c
+0002f770: 6f6c 5f6e 616d 652e 7265 706c 6163 6528  ol_name.replace(
+0002f780: 2223 222c 2022 2723 2229 0a20 2020 2020  "#", "'#").     
+0002f790: 2020 2063 6f6c 5f6e 616d 6520 3d20 636f     col_name = co
+0002f7a0: 6c5f 6e61 6d65 2e72 6570 6c61 6365 2822  l_name.replace("
+0002f7b0: 5d22 2c20 2227 5d22 290a 2020 2020 2020  ]", "']").      
+0002f7c0: 2020 636f 6c5f 6e61 6d65 203d 2063 6f6c    col_name = col
+0002f7d0: 5f6e 616d 652e 7265 706c 6163 6528 225b  _name.replace("[
+0002f7e0: 222c 2022 275b 2229 0a0a 2020 2020 2020  ", "'[")..      
+0002f7f0: 2020 7375 6274 6f74 616c 7320 3d20 7b0a    subtotals = {.
+0002f800: 2020 2020 2020 2020 2020 2020 2261 7665              "ave
+0002f810: 7261 6765 223a 2031 3031 2c0a 2020 2020  rage": 101,.    
+0002f820: 2020 2020 2020 2020 2263 6f75 6e74 4e75          "countNu
+0002f830: 6d73 223a 2031 3032 2c0a 2020 2020 2020  ms": 102,.      
+0002f840: 2020 2020 2020 2263 6f75 6e74 223a 2031        "count": 1
+0002f850: 3033 2c0a 2020 2020 2020 2020 2020 2020  03,.            
+0002f860: 226d 6178 223a 2031 3034 2c0a 2020 2020  "max": 104,.    
+0002f870: 2020 2020 2020 2020 226d 696e 223a 2031          "min": 1
+0002f880: 3035 2c0a 2020 2020 2020 2020 2020 2020  05,.            
+0002f890: 2273 7464 4465 7622 3a20 3130 372c 0a20  "stdDev": 107,. 
+0002f8a0: 2020 2020 2020 2020 2020 2022 7375 6d22             "sum"
+0002f8b0: 3a20 3130 392c 0a20 2020 2020 2020 2020  : 109,.         
+0002f8c0: 2020 2022 7661 7222 3a20 3131 302c 0a20     "var": 110,. 
+0002f8d0: 2020 2020 2020 207d 0a0a 2020 2020 2020         }..      
+0002f8e0: 2020 6966 2066 756e 6374 696f 6e20 696e    if function in
+0002f8f0: 2073 7562 746f 7461 6c73 3a0a 2020 2020   subtotals:.    
+0002f900: 2020 2020 2020 2020 6675 6e63 5f6e 756d          func_num
+0002f910: 203d 2073 7562 746f 7461 6c73 5b66 756e   = subtotals[fun
+0002f920: 6374 696f 6e5d 0a20 2020 2020 2020 2020  ction].         
+0002f930: 2020 2066 6f72 6d75 6c61 203d 2022 5355     formula = "SU
+0002f940: 4254 4f54 414c 2825 732c 5b25 735d 2922  BTOTAL(%s,[%s])"
+0002f950: 2025 2028 6675 6e63 5f6e 756d 2c20 636f   % (func_num, co
+0002f960: 6c5f 6e61 6d65 290a 2020 2020 2020 2020  l_name).        
+0002f970: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0002f980: 2020 7761 726e 2822 556e 7375 7070 6f72    warn("Unsuppor
+0002f990: 7465 6420 6675 6e63 7469 6f6e 2027 2573  ted function '%s
+0002f9a0: 2720 696e 2061 6464 5f74 6162 6c65 2829  ' in add_table()
+0002f9b0: 2220 2520 6675 6e63 7469 6f6e 290a 0a20  " % function).. 
+0002f9c0: 2020 2020 2020 2072 6574 7572 6e20 666f         return fo
+0002f9d0: 726d 756c 610a 0a20 2020 2064 6566 205f  rmula..    def _
+0002f9e0: 7365 745f 7370 6172 6b5f 636f 6c6f 7228  set_spark_color(
+0002f9f0: 7365 6c66 2c20 7370 6172 6b6c 696e 652c  self, sparkline,
+0002fa00: 206f 7074 696f 6e73 2c20 7573 6572 5f63   options, user_c
+0002fa10: 6f6c 6f72 293a 0a20 2020 2020 2020 2023  olor):.        #
+0002fa20: 2053 6574 2074 6865 2073 7061 726b 6c69   Set the sparkli
+0002fa30: 6e65 2063 6f6c 6f72 2e0a 2020 2020 2020  ne color..      
+0002fa40: 2020 6966 2075 7365 725f 636f 6c6f 7220    if user_color 
+0002fa50: 6e6f 7420 696e 206f 7074 696f 6e73 3a0a  not in options:.
+0002fa60: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0002fa70: 726e 0a0a 2020 2020 2020 2020 7370 6172  rn..        spar
+0002fa80: 6b6c 696e 655b 7573 6572 5f63 6f6c 6f72  kline[user_color
+0002fa90: 5d20 3d20 7b22 7267 6222 3a20 786c 5f63  ] = {"rgb": xl_c
+0002faa0: 6f6c 6f72 286f 7074 696f 6e73 5b75 7365  olor(options[use
+0002fab0: 725f 636f 6c6f 725d 297d 0a0a 2020 2020  r_color])}..    
+0002fac0: 6465 6620 5f67 6574 5f72 616e 6765 5f64  def _get_range_d
+0002fad0: 6174 6128 7365 6c66 2c20 726f 775f 7374  ata(self, row_st
+0002fae0: 6172 742c 2063 6f6c 5f73 7461 7274 2c20  art, col_start, 
+0002faf0: 726f 775f 656e 642c 2063 6f6c 5f65 6e64  row_end, col_end
+0002fb00: 293a 0a20 2020 2020 2020 2023 2052 6574  ):.        # Ret
+0002fb10: 7572 6e73 2061 2072 616e 6765 206f 6620  urns a range of 
+0002fb20: 6461 7461 2066 726f 6d20 7468 6520 776f  data from the wo
+0002fb30: 726b 7368 6565 7420 5f74 6162 6c65 2074  rksheet _table t
+0002fb40: 6f20 6265 2075 7365 6420 696e 0a20 2020  o be used in.   
+0002fb50: 2020 2020 2023 2063 6861 7274 2063 6163       # chart cac
+0002fb60: 6865 6420 6461 7461 2e20 5374 7269 6e67  hed data. String
+0002fb70: 7320 6172 6520 7265 7475 726e 6564 2061  s are returned a
+0002fb80: 7320 5353 5420 6964 7320 616e 6420 6465  s SST ids and de
+0002fb90: 636f 6465 640a 2020 2020 2020 2020 2320  coded.        # 
+0002fba0: 696e 2074 6865 2077 6f72 6b62 6f6f 6b2e  in the workbook.
+0002fbb0: 2052 6574 7572 6e20 4e6f 6e65 2066 6f72   Return None for
+0002fbc0: 2064 6174 6120 7468 6174 2064 6f65 736e   data that doesn
+0002fbd0: 2774 2065 7869 7374 2073 696e 6365 0a20  't exist since. 
+0002fbe0: 2020 2020 2020 2023 2045 7863 656c 2063         # Excel c
+0002fbf0: 616e 2063 6861 7274 2073 6572 6965 7320  an chart series 
+0002fc00: 7769 7468 2064 6174 6120 6d69 7373 696e  with data missin
+0002fc10: 672e 0a0a 2020 2020 2020 2020 6966 2073  g...        if s
+0002fc20: 656c 662e 636f 6e73 7461 6e74 5f6d 656d  elf.constant_mem
+0002fc30: 6f72 793a 0a20 2020 2020 2020 2020 2020  ory:.           
+0002fc40: 2072 6574 7572 6e20 2829 0a0a 2020 2020   return ()..    
+0002fc50: 2020 2020 6461 7461 203d 205b 5d0a 0a20      data = [].. 
+0002fc60: 2020 2020 2020 2023 2049 7465 7261 7465         # Iterate
+0002fc70: 2074 6872 6f75 6768 2074 6865 2074 6162   through the tab
+0002fc80: 6c65 2064 6174 612e 0a20 2020 2020 2020  le data..       
+0002fc90: 2066 6f72 2072 6f77 5f6e 756d 2069 6e20   for row_num in 
+0002fca0: 7261 6e67 6528 726f 775f 7374 6172 742c  range(row_start,
+0002fcb0: 2072 6f77 5f65 6e64 202b 2031 293a 0a20   row_end + 1):. 
+0002fcc0: 2020 2020 2020 2020 2020 2023 2053 746f             # Sto
+0002fcd0: 7265 204e 6f6e 6520 6966 2072 6f77 2064  re None if row d
+0002fce0: 6f65 736e 2774 2065 7869 7374 2e0a 2020  oesn't exist..  
+0002fcf0: 2020 2020 2020 2020 2020 6966 2072 6f77            if row
+0002fd00: 5f6e 756d 206e 6f74 2069 6e20 7365 6c66  _num not in self
+0002fd10: 2e74 6162 6c65 3a0a 2020 2020 2020 2020  .table:.        
+0002fd20: 2020 2020 2020 2020 6461 7461 2e61 7070          data.app
+0002fd30: 656e 6428 4e6f 6e65 290a 2020 2020 2020  end(None).      
+0002fd40: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
+0002fd50: 7565 0a0a 2020 2020 2020 2020 2020 2020  ue..            
+0002fd60: 666f 7220 636f 6c5f 6e75 6d20 696e 2072  for col_num in r
+0002fd70: 616e 6765 2863 6f6c 5f73 7461 7274 2c20  ange(col_start, 
+0002fd80: 636f 6c5f 656e 6420 2b20 3129 3a0a 2020  col_end + 1):.  
+0002fd90: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0002fda0: 2063 6f6c 5f6e 756d 2069 6e20 7365 6c66   col_num in self
+0002fdb0: 2e74 6162 6c65 5b72 6f77 5f6e 756d 5d3a  .table[row_num]:
+0002fdc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002fdd0: 2020 2020 2063 656c 6c20 3d20 7365 6c66       cell = self
+0002fde0: 2e74 6162 6c65 5b72 6f77 5f6e 756d 5d5b  .table[row_num][
+0002fdf0: 636f 6c5f 6e75 6d5d 0a0a 2020 2020 2020  col_num]..      
+0002fe00: 2020 2020 2020 2020 2020 2020 2020 6365                ce
+0002fe10: 6c6c 5f74 7970 6520 3d20 6365 6c6c 2e5f  ll_type = cell._
+0002fe20: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
+0002fe30: 5f0a 0a20 2020 2020 2020 2020 2020 2020  _..             
+0002fe40: 2020 2020 2020 2069 6620 6365 6c6c 5f74         if cell_t
+0002fe50: 7970 6520 696e 2028 224e 756d 6265 7222  ype in ("Number"
+0002fe60: 2c20 2244 6174 6574 696d 6522 293a 0a20  , "Datetime"):. 
+0002fe70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fe80: 2020 2020 2020 2023 2052 6574 7572 6e20         # Return 
+0002fe90: 6120 6e75 6d62 6572 2077 6974 6820 4578  a number with Ex
+0002fea0: 6365 6c27 7320 7072 6563 6973 696f 6e2e  cel's precision.
+0002feb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002fec0: 2020 2020 2020 2020 2064 6174 612e 6170           data.ap
+0002fed0: 7065 6e64 2822 252e 3136 6722 2025 2063  pend("%.16g" % c
+0002fee0: 656c 6c2e 6e75 6d62 6572 290a 0a20 2020  ell.number)..   
+0002fef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ff00: 2065 6c69 6620 6365 6c6c 5f74 7970 6520   elif cell_type 
+0002ff10: 3d3d 2022 5374 7269 6e67 223a 0a20 2020  == "String":.   
+0002ff20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ff30: 2020 2020 2023 2052 6574 7572 6e20 6120       # Return a 
+0002ff40: 7374 7269 6e67 2066 726f 6d20 6974 2773  string from it's
+0002ff50: 2073 6861 7265 6420 7374 7269 6e67 2069   shared string i
+0002ff60: 6e64 6578 2e0a 2020 2020 2020 2020 2020  ndex..          
+0002ff70: 2020 2020 2020 2020 2020 2020 2020 696e                in
+0002ff80: 6465 7820 3d20 6365 6c6c 2e73 7472 696e  dex = cell.strin
+0002ff90: 670a 2020 2020 2020 2020 2020 2020 2020  g.              
+0002ffa0: 2020 2020 2020 2020 2020 7374 7269 6e67            string
+0002ffb0: 203d 2073 656c 662e 7374 725f 7461 626c   = self.str_tabl
+0002ffc0: 652e 5f67 6574 5f73 6861 7265 645f 7374  e._get_shared_st
+0002ffd0: 7269 6e67 2869 6e64 6578 290a 0a20 2020  ring(index)..   
+0002ffe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002fff0: 2020 2020 2064 6174 612e 6170 7065 6e64       data.append
+00030000: 2873 7472 696e 6729 0a0a 2020 2020 2020  (string)..      
+00030010: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00030020: 6966 2063 656c 6c5f 7479 7065 2069 6e20  if cell_type in 
+00030030: 2822 466f 726d 756c 6122 2c20 2241 7272  ("Formula", "Arr
+00030040: 6179 466f 726d 756c 6122 293a 0a20 2020  ayFormula"):.   
+00030050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030060: 2020 2020 2023 2052 6574 7572 6e20 7468       # Return th
+00030070: 6520 666f 726d 756c 6120 7661 6c75 652e  e formula value.
+00030080: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00030090: 2020 2020 2020 2020 2076 616c 7565 203d           value =
+000300a0: 2063 656c 6c2e 7661 6c75 650a 0a20 2020   cell.value..   
+000300b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000300c0: 2020 2020 2069 6620 7661 6c75 6520 6973       if value is
+000300d0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+000300e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000300f0: 2020 2076 616c 7565 203d 2030 0a0a 2020     value = 0..  
+00030100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030110: 2020 2020 2020 6461 7461 2e61 7070 656e        data.appen
+00030120: 6428 7661 6c75 6529 0a0a 2020 2020 2020  d(value)..      
+00030130: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00030140: 6966 2063 656c 6c5f 7479 7065 203d 3d20  if cell_type == 
+00030150: 2242 6c61 6e6b 223a 0a20 2020 2020 2020  "Blank":.       
+00030160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030170: 2023 2052 6574 7572 6e20 6120 656d 7074   # Return a empt
+00030180: 7920 6365 6c6c 2e0a 2020 2020 2020 2020  y cell..        
+00030190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000301a0: 6461 7461 2e61 7070 656e 6428 2222 290a  data.append("").
+000301b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000301c0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000301d0: 2020 2020 2020 2020 2020 2320 5374 6f72            # Stor
+000301e0: 6520 4e6f 6e65 2069 6620 636f 6c75 6d6e  e None if column
+000301f0: 2064 6f65 736e 2774 2065 7869 7374 2e0a   doesn't exist..
+00030200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030210: 2020 2020 6461 7461 2e61 7070 656e 6428      data.append(
+00030220: 4e6f 6e65 290a 0a20 2020 2020 2020 2072  None)..        r
+00030230: 6574 7572 6e20 6461 7461 0a0a 2020 2020  eturn data..    
+00030240: 6465 6620 5f63 7376 5f6a 6f69 6e28 7365  def _csv_join(se
+00030250: 6c66 2c20 2a69 7465 6d73 293a 0a20 2020  lf, *items):.   
+00030260: 2020 2020 2023 2043 7265 6174 6520 6120       # Create a 
+00030270: 6373 7620 7374 7269 6e67 2066 6f72 2075  csv string for u
+00030280: 7365 2077 6974 6820 6461 7461 2076 616c  se with data val
+00030290: 6964 6174 696f 6e20 666f 726d 756c 6173  idation formulas
+000302a0: 2061 6e64 206c 6973 7473 2e0a 0a20 2020   and lists...   
+000302b0: 2020 2020 2023 2043 6f6e 7665 7274 206e       # Convert n
+000302c0: 6f6e 2073 7472 696e 6720 7479 7065 7320  on string types 
+000302d0: 746f 2073 7472 696e 672e 0a20 2020 2020  to string..     
+000302e0: 2020 2069 7465 6d73 203d 205b 7374 7228     items = [str(
+000302f0: 6974 656d 2920 6966 206e 6f74 2069 7369  item) if not isi
+00030300: 6e73 7461 6e63 6528 6974 656d 2c20 7374  nstance(item, st
+00030310: 7229 2065 6c73 6520 6974 656d 2066 6f72  r) else item for
+00030320: 2069 7465 6d20 696e 2069 7465 6d73 5d0a   item in items].
+00030330: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00030340: 222c 222e 6a6f 696e 2869 7465 6d73 290a  ",".join(items).
+00030350: 0a20 2020 2064 6566 205f 6573 6361 7065  .    def _escape
+00030360: 5f75 726c 2873 656c 662c 2075 726c 293a  _url(self, url):
+00030370: 0a20 2020 2020 2020 2023 2044 6f6e 2774  .        # Don't
+00030380: 2065 7363 6170 6520 5552 4c20 6966 2069   escape URL if i
+00030390: 7420 6c6f 6f6b 7320 616c 7265 6164 7920  t looks already 
+000303a0: 6573 6361 7065 642e 0a20 2020 2020 2020  escaped..       
+000303b0: 2069 6620 7265 2e73 6561 7263 6828 2225   if re.search("%
+000303c0: 5b30 2d39 612d 6641 2d46 5d7b 327d 222c  [0-9a-fA-F]{2}",
+000303d0: 2075 726c 293a 0a20 2020 2020 2020 2020   url):.         
+000303e0: 2020 2072 6574 7572 6e20 7572 6c0a 0a20     return url.. 
+000303f0: 2020 2020 2020 2023 2043 616e 2774 2075         # Can't u
+00030400: 7365 2075 726c 2e71 756f 7465 2829 2068  se url.quote() h
+00030410: 6572 6520 6265 6361 7573 6520 6974 2064  ere because it d
+00030420: 6f65 736e 2774 206d 6174 6368 2045 7863  oesn't match Exc
+00030430: 656c 2e0a 2020 2020 2020 2020 7572 6c20  el..        url 
+00030440: 3d20 7572 6c2e 7265 706c 6163 6528 2225  = url.replace("%
+00030450: 222c 2022 2532 3522 290a 2020 2020 2020  ", "%25").      
+00030460: 2020 7572 6c20 3d20 7572 6c2e 7265 706c    url = url.repl
+00030470: 6163 6528 2722 272c 2022 2532 3222 290a  ace('"', "%22").
+00030480: 2020 2020 2020 2020 7572 6c20 3d20 7572          url = ur
+00030490: 6c2e 7265 706c 6163 6528 2220 222c 2022  l.replace(" ", "
+000304a0: 2532 3022 290a 2020 2020 2020 2020 7572  %20").        ur
+000304b0: 6c20 3d20 7572 6c2e 7265 706c 6163 6528  l = url.replace(
+000304c0: 223c 222c 2022 2533 6322 290a 2020 2020  "<", "%3c").    
+000304d0: 2020 2020 7572 6c20 3d20 7572 6c2e 7265      url = url.re
+000304e0: 706c 6163 6528 223e 222c 2022 2533 6522  place(">", "%3e"
+000304f0: 290a 2020 2020 2020 2020 7572 6c20 3d20  ).        url = 
+00030500: 7572 6c2e 7265 706c 6163 6528 225b 222c  url.replace("[",
+00030510: 2022 2535 6222 290a 2020 2020 2020 2020   "%5b").        
+00030520: 7572 6c20 3d20 7572 6c2e 7265 706c 6163  url = url.replac
+00030530: 6528 225d 222c 2022 2535 6422 290a 2020  e("]", "%5d").  
+00030540: 2020 2020 2020 7572 6c20 3d20 7572 6c2e        url = url.
+00030550: 7265 706c 6163 6528 225e 222c 2022 2535  replace("^", "%5
+00030560: 6522 290a 2020 2020 2020 2020 7572 6c20  e").        url 
+00030570: 3d20 7572 6c2e 7265 706c 6163 6528 2260  = url.replace("`
+00030580: 222c 2022 2536 3022 290a 2020 2020 2020  ", "%60").      
+00030590: 2020 7572 6c20 3d20 7572 6c2e 7265 706c    url = url.repl
+000305a0: 6163 6528 227b 222c 2022 2537 6222 290a  ace("{", "%7b").
+000305b0: 2020 2020 2020 2020 7572 6c20 3d20 7572          url = ur
+000305c0: 6c2e 7265 706c 6163 6528 227d 222c 2022  l.replace("}", "
+000305d0: 2537 6422 290a 0a20 2020 2020 2020 2072  %7d")..        r
+000305e0: 6574 7572 6e20 7572 6c0a 0a20 2020 2064  eturn url..    d
+000305f0: 6566 205f 6765 745f 6472 6177 696e 675f  ef _get_drawing_
+00030600: 7265 6c5f 696e 6465 7828 7365 6c66 2c20  rel_index(self, 
+00030610: 7461 7267 6574 3d4e 6f6e 6529 3a0a 2020  target=None):.  
+00030620: 2020 2020 2020 2320 4765 7420 7468 6520        # Get the 
+00030630: 696e 6465 7820 7573 6564 2074 6f20 6164  index used to ad
+00030640: 6472 6573 7320 6120 6472 6177 696e 6720  dress a drawing 
+00030650: 7265 6c20 6c69 6e6b 2e0a 2020 2020 2020  rel link..      
+00030660: 2020 6966 2074 6172 6765 7420 6973 204e    if target is N
+00030670: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00030680: 2073 656c 662e 6472 6177 696e 675f 7265   self.drawing_re
+00030690: 6c73 5f69 6420 2b3d 2031 0a20 2020 2020  ls_id += 1.     
+000306a0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+000306b0: 6c66 2e64 7261 7769 6e67 5f72 656c 735f  lf.drawing_rels_
+000306c0: 6964 0a20 2020 2020 2020 2065 6c69 6620  id.        elif 
+000306d0: 7365 6c66 2e64 7261 7769 6e67 5f72 656c  self.drawing_rel
+000306e0: 732e 6765 7428 7461 7267 6574 293a 0a20  s.get(target):. 
+000306f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00030700: 6e20 7365 6c66 2e64 7261 7769 6e67 5f72  n self.drawing_r
+00030710: 656c 735b 7461 7267 6574 5d0a 2020 2020  els[target].    
+00030720: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00030730: 2020 2020 2020 7365 6c66 2e64 7261 7769        self.drawi
+00030740: 6e67 5f72 656c 735f 6964 202b 3d20 310a  ng_rels_id += 1.
+00030750: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00030760: 2e64 7261 7769 6e67 5f72 656c 735b 7461  .drawing_rels[ta
+00030770: 7267 6574 5d20 3d20 7365 6c66 2e64 7261  rget] = self.dra
+00030780: 7769 6e67 5f72 656c 735f 6964 0a20 2020  wing_rels_id.   
+00030790: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000307a0: 7365 6c66 2e64 7261 7769 6e67 5f72 656c  self.drawing_rel
+000307b0: 735f 6964 0a0a 2020 2020 6465 6620 5f67  s_id..    def _g
+000307c0: 6574 5f76 6d6c 5f64 7261 7769 6e67 5f72  et_vml_drawing_r
+000307d0: 656c 5f69 6e64 6578 2873 656c 662c 2074  el_index(self, t
+000307e0: 6172 6765 743d 4e6f 6e65 293a 0a20 2020  arget=None):.   
+000307f0: 2020 2020 2023 2047 6574 2074 6865 2069       # Get the i
+00030800: 6e64 6578 2075 7365 6420 746f 2061 6464  ndex used to add
+00030810: 7265 7373 2061 2076 6d6c 2064 7261 7769  ress a vml drawi
+00030820: 6e67 2072 656c 206c 696e 6b2e 0a20 2020  ng rel link..   
+00030830: 2020 2020 2069 6620 7365 6c66 2e76 6d6c       if self.vml
+00030840: 5f64 7261 7769 6e67 5f72 656c 732e 6765  _drawing_rels.ge
+00030850: 7428 7461 7267 6574 293a 0a20 2020 2020  t(target):.     
+00030860: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00030870: 6c66 2e76 6d6c 5f64 7261 7769 6e67 5f72  lf.vml_drawing_r
+00030880: 656c 735b 7461 7267 6574 5d0a 2020 2020  els[target].    
+00030890: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000308a0: 2020 2020 2020 7365 6c66 2e76 6d6c 5f64        self.vml_d
+000308b0: 7261 7769 6e67 5f72 656c 735f 6964 202b  rawing_rels_id +
+000308c0: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+000308d0: 7365 6c66 2e76 6d6c 5f64 7261 7769 6e67  self.vml_drawing
+000308e0: 5f72 656c 735b 7461 7267 6574 5d20 3d20  _rels[target] = 
+000308f0: 7365 6c66 2e76 6d6c 5f64 7261 7769 6e67  self.vml_drawing
+00030900: 5f72 656c 735f 6964 0a20 2020 2020 2020  _rels_id.       
+00030910: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00030920: 2e76 6d6c 5f64 7261 7769 6e67 5f72 656c  .vml_drawing_rel
+00030930: 735f 6964 0a0a 2020 2020 2323 2323 2323  s_id..    ######
+00030940: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00030950: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00030960: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00030970: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00030980: 2323 2323 230a 2020 2020 230a 2020 2020  #####.    #.    
+00030990: 2320 5468 6520 666f 6c6c 6f77 696e 6720  # The following 
+000309a0: 666f 6e74 206d 6574 686f 6473 2061 7265  font methods are
+000309b0: 2c20 6d6f 7265 206f 7220 6c65 7373 2c20  , more or less, 
+000309c0: 6475 706c 6963 6174 6564 2066 726f 6d20  duplicated from 
+000309d0: 7468 650a 2020 2020 2320 5374 796c 6573  the.    # Styles
+000309e0: 2063 6c61 7373 2e20 4e6f 7420 7468 6520   class. Not the 
+000309f0: 636c 6561 6e65 7374 2076 6572 7369 6f6e  cleanest version
+00030a00: 206f 6620 7265 7573 6520 6275 7420 776f   of reuse but wo
+00030a10: 726b 7320 666f 7220 6e6f 772e 0a20 2020  rks for now..   
+00030a20: 2023 0a20 2020 2023 2323 2323 2323 2323   #.    #########
+00030a30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00030a40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00030a50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00030a60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00030a70: 2323 0a20 2020 2064 6566 205f 7772 6974  ##.    def _writ
+00030a80: 655f 666f 6e74 2873 656c 662c 2078 665f  e_font(self, xf_
+00030a90: 666f 726d 6174 293a 0a20 2020 2020 2020  format):.       
+00030aa0: 2023 2057 7269 7465 2074 6865 203c 666f   # Write the <fo
+00030ab0: 6e74 3e20 656c 656d 656e 742e 0a20 2020  nt> element..   
+00030ac0: 2020 2020 2078 6d6c 5f77 7269 7465 7220       xml_writer 
+00030ad0: 3d20 7365 6c66 2e72 7374 7269 6e67 0a0a  = self.rstring..
+00030ae0: 2020 2020 2020 2020 786d 6c5f 7772 6974          xml_writ
+00030af0: 6572 2e5f 786d 6c5f 7374 6172 745f 7461  er._xml_start_ta
+00030b00: 6728 2272 5072 2229 0a0a 2020 2020 2020  g("rPr")..      
+00030b10: 2020 2320 4861 6e64 6c65 2074 6865 206d    # Handle the m
+00030b20: 6169 6e20 666f 6e74 2070 726f 7065 7274  ain font propert
+00030b30: 6965 732e 0a20 2020 2020 2020 2069 6620  ies..        if 
+00030b40: 7866 5f66 6f72 6d61 742e 626f 6c64 3a0a  xf_format.bold:.
+00030b50: 2020 2020 2020 2020 2020 2020 786d 6c5f              xml_
+00030b60: 7772 6974 6572 2e5f 786d 6c5f 656d 7074  writer._xml_empt
+00030b70: 795f 7461 6728 2262 2229 0a20 2020 2020  y_tag("b").     
+00030b80: 2020 2069 6620 7866 5f66 6f72 6d61 742e     if xf_format.
+00030b90: 6974 616c 6963 3a0a 2020 2020 2020 2020  italic:.        
+00030ba0: 2020 2020 786d 6c5f 7772 6974 6572 2e5f      xml_writer._
+00030bb0: 786d 6c5f 656d 7074 795f 7461 6728 2269  xml_empty_tag("i
+00030bc0: 2229 0a20 2020 2020 2020 2069 6620 7866  ").        if xf
+00030bd0: 5f66 6f72 6d61 742e 666f 6e74 5f73 7472  _format.font_str
+00030be0: 696b 656f 7574 3a0a 2020 2020 2020 2020  ikeout:.        
+00030bf0: 2020 2020 786d 6c5f 7772 6974 6572 2e5f      xml_writer._
+00030c00: 786d 6c5f 656d 7074 795f 7461 6728 2273  xml_empty_tag("s
+00030c10: 7472 696b 6522 290a 2020 2020 2020 2020  trike").        
+00030c20: 6966 2078 665f 666f 726d 6174 2e66 6f6e  if xf_format.fon
+00030c30: 745f 6f75 746c 696e 653a 0a20 2020 2020  t_outline:.     
+00030c40: 2020 2020 2020 2078 6d6c 5f77 7269 7465         xml_write
+00030c50: 722e 5f78 6d6c 5f65 6d70 7479 5f74 6167  r._xml_empty_tag
+00030c60: 2822 6f75 746c 696e 6522 290a 2020 2020  ("outline").    
+00030c70: 2020 2020 6966 2078 665f 666f 726d 6174      if xf_format
+00030c80: 2e66 6f6e 745f 7368 6164 6f77 3a0a 2020  .font_shadow:.  
+00030c90: 2020 2020 2020 2020 2020 786d 6c5f 7772            xml_wr
+00030ca0: 6974 6572 2e5f 786d 6c5f 656d 7074 795f  iter._xml_empty_
+00030cb0: 7461 6728 2273 6861 646f 7722 290a 0a20  tag("shadow").. 
+00030cc0: 2020 2020 2020 2023 2048 616e 646c 6520         # Handle 
+00030cd0: 7468 6520 756e 6465 726c 696e 6520 7661  the underline va
+00030ce0: 7269 616e 7473 2e0a 2020 2020 2020 2020  riants..        
+00030cf0: 6966 2078 665f 666f 726d 6174 2e75 6e64  if xf_format.und
+00030d00: 6572 6c69 6e65 3a0a 2020 2020 2020 2020  erline:.        
+00030d10: 2020 2020 7365 6c66 2e5f 7772 6974 655f      self._write_
+00030d20: 756e 6465 726c 696e 6528 7866 5f66 6f72  underline(xf_for
+00030d30: 6d61 742e 756e 6465 726c 696e 6529 0a0a  mat.underline)..
+00030d40: 2020 2020 2020 2020 2320 4861 6e64 6c65          # Handle
+00030d50: 2073 7570 6572 2f73 7562 7363 7269 7074   super/subscript
+00030d60: 2e0a 2020 2020 2020 2020 6966 2078 665f  ..        if xf_
+00030d70: 666f 726d 6174 2e66 6f6e 745f 7363 7269  format.font_scri
+00030d80: 7074 203d 3d20 313a 0a20 2020 2020 2020  pt == 1:.       
+00030d90: 2020 2020 2073 656c 662e 5f77 7269 7465       self._write
+00030da0: 5f76 6572 745f 616c 6967 6e28 2273 7570  _vert_align("sup
+00030db0: 6572 7363 7269 7074 2229 0a20 2020 2020  erscript").     
+00030dc0: 2020 2069 6620 7866 5f66 6f72 6d61 742e     if xf_format.
+00030dd0: 666f 6e74 5f73 6372 6970 7420 3d3d 2032  font_script == 2
+00030de0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00030df0: 6c66 2e5f 7772 6974 655f 7665 7274 5f61  lf._write_vert_a
+00030e00: 6c69 676e 2822 7375 6273 6372 6970 7422  lign("subscript"
+00030e10: 290a 0a20 2020 2020 2020 2023 2057 7269  )..        # Wri
+00030e20: 7465 2074 6865 2066 6f6e 7420 7369 7a65  te the font size
+00030e30: 0a20 2020 2020 2020 2078 6d6c 5f77 7269  .        xml_wri
+00030e40: 7465 722e 5f78 6d6c 5f65 6d70 7479 5f74  ter._xml_empty_t
+00030e50: 6167 2822 737a 222c 205b 2822 7661 6c22  ag("sz", [("val"
+00030e60: 2c20 7866 5f66 6f72 6d61 742e 666f 6e74  , xf_format.font
+00030e70: 5f73 697a 6529 5d29 0a0a 2020 2020 2020  _size)])..      
+00030e80: 2020 2320 4861 6e64 6c65 2063 6f6c 6f72    # Handle color
+00030e90: 732e 0a20 2020 2020 2020 2069 6620 7866  s..        if xf
+00030ea0: 5f66 6f72 6d61 742e 7468 656d 6520 3d3d  _format.theme ==
+00030eb0: 202d 313a 0a20 2020 2020 2020 2020 2020   -1:.           
+00030ec0: 2023 2049 676e 6f72 6520 666f 7220 6578   # Ignore for ex
+00030ed0: 6365 6c32 3030 335f 7374 796c 652e 0a20  cel2003_style.. 
+00030ee0: 2020 2020 2020 2020 2020 2070 6173 730a             pass.
+00030ef0: 2020 2020 2020 2020 656c 6966 2078 665f          elif xf_
+00030f00: 666f 726d 6174 2e74 6865 6d65 3a0a 2020  format.theme:.  
+00030f10: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00030f20: 7772 6974 655f 636f 6c6f 7228 2274 6865  write_color("the
+00030f30: 6d65 222c 2078 665f 666f 726d 6174 2e74  me", xf_format.t
+00030f40: 6865 6d65 290a 2020 2020 2020 2020 656c  heme).        el
+00030f50: 6966 2078 665f 666f 726d 6174 2e63 6f6c  if xf_format.col
+00030f60: 6f72 5f69 6e64 6578 6564 3a0a 2020 2020  or_indexed:.    
+00030f70: 2020 2020 2020 2020 7365 6c66 2e5f 7772          self._wr
+00030f80: 6974 655f 636f 6c6f 7228 2269 6e64 6578  ite_color("index
+00030f90: 6564 222c 2078 665f 666f 726d 6174 2e63  ed", xf_format.c
+00030fa0: 6f6c 6f72 5f69 6e64 6578 6564 290a 2020  olor_indexed).  
+00030fb0: 2020 2020 2020 656c 6966 2078 665f 666f        elif xf_fo
+00030fc0: 726d 6174 2e66 6f6e 745f 636f 6c6f 723a  rmat.font_color:
+00030fd0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
+00030fe0: 6f72 203d 2073 656c 662e 5f67 6574 5f70  or = self._get_p
+00030ff0: 616c 6574 7465 5f63 6f6c 6f72 2878 665f  alette_color(xf_
+00031000: 666f 726d 6174 2e66 6f6e 745f 636f 6c6f  format.font_colo
+00031010: 7229 0a20 2020 2020 2020 2020 2020 2073  r).            s
+00031020: 656c 662e 5f77 7269 7465 5f72 7374 7269  elf._write_rstri
+00031030: 6e67 5f63 6f6c 6f72 2822 7267 6222 2c20  ng_color("rgb", 
+00031040: 636f 6c6f 7229 0a20 2020 2020 2020 2065  color).        e
+00031050: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00031060: 2073 656c 662e 5f77 7269 7465 5f72 7374   self._write_rst
+00031070: 7269 6e67 5f63 6f6c 6f72 2822 7468 656d  ring_color("them
+00031080: 6522 2c20 3129 0a0a 2020 2020 2020 2020  e", 1)..        
+00031090: 2320 5772 6974 6520 736f 6d65 206f 7468  # Write some oth
+000310a0: 6572 2066 6f6e 7420 7072 6f70 6572 7469  er font properti
+000310b0: 6573 2072 656c 6174 6564 2074 6f20 666f  es related to fo
+000310c0: 6e74 2066 616d 696c 6965 732e 0a20 2020  nt families..   
+000310d0: 2020 2020 2078 6d6c 5f77 7269 7465 722e       xml_writer.
+000310e0: 5f78 6d6c 5f65 6d70 7479 5f74 6167 2822  _xml_empty_tag("
+000310f0: 7246 6f6e 7422 2c20 5b28 2276 616c 222c  rFont", [("val",
+00031100: 2078 665f 666f 726d 6174 2e66 6f6e 745f   xf_format.font_
+00031110: 6e61 6d65 295d 290a 2020 2020 2020 2020  name)]).        
+00031120: 786d 6c5f 7772 6974 6572 2e5f 786d 6c5f  xml_writer._xml_
+00031130: 656d 7074 795f 7461 6728 2266 616d 696c  empty_tag("famil
+00031140: 7922 2c20 5b28 2276 616c 222c 2078 665f  y", [("val", xf_
+00031150: 666f 726d 6174 2e66 6f6e 745f 6661 6d69  format.font_fami
+00031160: 6c79 295d 290a 0a20 2020 2020 2020 2069  ly)])..        i
+00031170: 6620 7866 5f66 6f72 6d61 742e 666f 6e74  f xf_format.font
+00031180: 5f6e 616d 6520 3d3d 2022 4361 6c69 6272  _name == "Calibr
+00031190: 6922 2061 6e64 206e 6f74 2078 665f 666f  i" and not xf_fo
+000311a0: 726d 6174 2e68 7970 6572 6c69 6e6b 3a0a  rmat.hyperlink:.
+000311b0: 2020 2020 2020 2020 2020 2020 786d 6c5f              xml_
+000311c0: 7772 6974 6572 2e5f 786d 6c5f 656d 7074  writer._xml_empt
+000311d0: 795f 7461 6728 2273 6368 656d 6522 2c20  y_tag("scheme", 
+000311e0: 5b28 2276 616c 222c 2078 665f 666f 726d  [("val", xf_form
+000311f0: 6174 2e66 6f6e 745f 7363 6865 6d65 295d  at.font_scheme)]
+00031200: 290a 0a20 2020 2020 2020 2078 6d6c 5f77  )..        xml_w
+00031210: 7269 7465 722e 5f78 6d6c 5f65 6e64 5f74  riter._xml_end_t
+00031220: 6167 2822 7250 7222 290a 0a20 2020 2064  ag("rPr")..    d
+00031230: 6566 205f 7772 6974 655f 756e 6465 726c  ef _write_underl
+00031240: 696e 6528 7365 6c66 2c20 756e 6465 726c  ine(self, underl
+00031250: 696e 6529 3a0a 2020 2020 2020 2020 2320  ine):.        # 
+00031260: 5772 6974 6520 7468 6520 756e 6465 726c  Write the underl
+00031270: 696e 6520 666f 6e74 2065 6c65 6d65 6e74  ine font element
+00031280: 2e0a 2020 2020 2020 2020 6174 7472 6962  ..        attrib
+00031290: 7574 6573 203d 205b 5d0a 0a20 2020 2020  utes = []..     
+000312a0: 2020 2023 2048 616e 646c 6520 7468 6520     # Handle the 
+000312b0: 756e 6465 726c 696e 6520 7661 7269 616e  underline varian
+000312c0: 7473 2e0a 2020 2020 2020 2020 6966 2075  ts..        if u
+000312d0: 6e64 6572 6c69 6e65 203d 3d20 323a 0a20  nderline == 2:. 
+000312e0: 2020 2020 2020 2020 2020 2061 7474 7269             attri
+000312f0: 6275 7465 7320 3d20 5b28 2276 616c 222c  butes = [("val",
+00031300: 2022 646f 7562 6c65 2229 5d0a 2020 2020   "double")].    
+00031310: 2020 2020 656c 6966 2075 6e64 6572 6c69      elif underli
+00031320: 6e65 203d 3d20 3333 3a0a 2020 2020 2020  ne == 33:.      
+00031330: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
+00031340: 203d 205b 2822 7661 6c22 2c20 2273 696e   = [("val", "sin
+00031350: 676c 6541 6363 6f75 6e74 696e 6722 295d  gleAccounting")]
+00031360: 0a20 2020 2020 2020 2065 6c69 6620 756e  .        elif un
+00031370: 6465 726c 696e 6520 3d3d 2033 343a 0a20  derline == 34:. 
+00031380: 2020 2020 2020 2020 2020 2061 7474 7269             attri
+00031390: 6275 7465 7320 3d20 5b28 2276 616c 222c  butes = [("val",
+000313a0: 2022 646f 7562 6c65 4163 636f 756e 7469   "doubleAccounti
+000313b0: 6e67 2229 5d0a 0a20 2020 2020 2020 2073  ng")]..        s
+000313c0: 656c 662e 7273 7472 696e 672e 5f78 6d6c  elf.rstring._xml
+000313d0: 5f65 6d70 7479 5f74 6167 2822 7522 2c20  _empty_tag("u", 
+000313e0: 6174 7472 6962 7574 6573 290a 0a20 2020  attributes)..   
+000313f0: 2064 6566 205f 7772 6974 655f 7665 7274   def _write_vert
+00031400: 5f61 6c69 676e 2873 656c 662c 2076 616c  _align(self, val
+00031410: 293a 0a20 2020 2020 2020 2023 2057 7269  ):.        # Wri
+00031420: 7465 2074 6865 203c 7665 7274 416c 6967  te the <vertAlig
+00031430: 6e3e 2066 6f6e 7420 7375 622d 656c 656d  n> font sub-elem
+00031440: 656e 742e 0a20 2020 2020 2020 2061 7474  ent..        att
+00031450: 7269 6275 7465 7320 3d20 5b28 2276 616c  ributes = [("val
+00031460: 222c 2076 616c 295d 0a0a 2020 2020 2020  ", val)]..      
+00031470: 2020 7365 6c66 2e72 7374 7269 6e67 2e5f    self.rstring._
+00031480: 786d 6c5f 656d 7074 795f 7461 6728 2276  xml_empty_tag("v
+00031490: 6572 7441 6c69 676e 222c 2061 7474 7269  ertAlign", attri
+000314a0: 6275 7465 7329 0a0a 2020 2020 6465 6620  butes)..    def 
+000314b0: 5f77 7269 7465 5f72 7374 7269 6e67 5f63  _write_rstring_c
+000314c0: 6f6c 6f72 2873 656c 662c 206e 616d 652c  olor(self, name,
+000314d0: 2076 616c 7565 293a 0a20 2020 2020 2020   value):.       
+000314e0: 2023 2057 7269 7465 2074 6865 203c 636f   # Write the <co
+000314f0: 6c6f 723e 2065 6c65 6d65 6e74 2e0a 2020  lor> element..  
+00031500: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
+00031510: 203d 205b 286e 616d 652c 2076 616c 7565   = [(name, value
+00031520: 295d 0a0a 2020 2020 2020 2020 7365 6c66  )]..        self
+00031530: 2e72 7374 7269 6e67 2e5f 786d 6c5f 656d  .rstring._xml_em
+00031540: 7074 795f 7461 6728 2263 6f6c 6f72 222c  pty_tag("color",
+00031550: 2061 7474 7269 6275 7465 7329 0a0a 2020   attributes)..  
+00031560: 2020 6465 6620 5f67 6574 5f70 616c 6574    def _get_palet
+00031570: 7465 5f63 6f6c 6f72 2873 656c 662c 2063  te_color(self, c
+00031580: 6f6c 6f72 293a 0a20 2020 2020 2020 2023  olor):.        #
+00031590: 2043 6f6e 7665 7274 2074 6865 2052 4742   Convert the RGB
+000315a0: 2063 6f6c 6f72 2e0a 2020 2020 2020 2020   color..        
+000315b0: 6966 2063 6f6c 6f72 5b30 5d20 3d3d 2022  if color[0] == "
+000315c0: 2322 3a0a 2020 2020 2020 2020 2020 2020  #":.            
+000315d0: 636f 6c6f 7220 3d20 636f 6c6f 725b 313a  color = color[1:
+000315e0: 5d0a 0a20 2020 2020 2020 2072 6574 7572  ]..        retur
+000315f0: 6e20 2246 4622 202b 2063 6f6c 6f72 2e75  n "FF" + color.u
+00031600: 7070 6572 2829 0a0a 2020 2020 6465 6620  pper()..    def 
+00031610: 5f6f 7074 5f63 6c6f 7365 2873 656c 6629  _opt_close(self)
+00031620: 3a0a 2020 2020 2020 2020 2320 436c 6f73  :.        # Clos
+00031630: 6520 7468 6520 726f 7720 6461 7461 2066  e the row data f
+00031640: 696c 6568 616e 646c 6520 696e 2063 6f6e  ilehandle in con
+00031650: 7374 616e 745f 6d65 6d6f 7279 206d 6f64  stant_memory mod
+00031660: 652e 0a20 2020 2020 2020 2069 6620 6e6f  e..        if no
+00031670: 7420 7365 6c66 2e72 6f77 5f64 6174 615f  t self.row_data_
+00031680: 6668 5f63 6c6f 7365 643a 0a20 2020 2020  fh_closed:.     
+00031690: 2020 2020 2020 2073 656c 662e 726f 775f         self.row_
+000316a0: 6461 7461 5f66 682e 636c 6f73 6528 290a  data_fh.close().
+000316b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000316c0: 2e72 6f77 5f64 6174 615f 6668 5f63 6c6f  .row_data_fh_clo
+000316d0: 7365 6420 3d20 5472 7565 0a0a 2020 2020  sed = True..    
+000316e0: 6465 6620 5f6f 7074 5f72 656f 7065 6e28  def _opt_reopen(
+000316f0: 7365 6c66 293a 0a20 2020 2020 2020 2023  self):.        #
+00031700: 2052 656f 7065 6e20 7468 6520 726f 7720   Reopen the row 
+00031710: 6461 7461 2066 696c 6568 616e 646c 6520  data filehandle 
+00031720: 696e 2063 6f6e 7374 616e 745f 6d65 6d6f  in constant_memo
+00031730: 7279 206d 6f64 652e 0a20 2020 2020 2020  ry mode..       
+00031740: 2069 6620 7365 6c66 2e72 6f77 5f64 6174   if self.row_dat
+00031750: 615f 6668 5f63 6c6f 7365 643a 0a20 2020  a_fh_closed:.   
+00031760: 2020 2020 2020 2020 2066 696c 656e 616d           filenam
+00031770: 6520 3d20 7365 6c66 2e72 6f77 5f64 6174  e = self.row_dat
+00031780: 615f 6669 6c65 6e61 6d65 0a20 2020 2020  a_filename.     
+00031790: 2020 2020 2020 2073 656c 662e 726f 775f         self.row_
+000317a0: 6461 7461 5f66 6820 3d20 6f70 656e 2866  data_fh = open(f
+000317b0: 696c 656e 616d 652c 206d 6f64 653d 2261  ilename, mode="a
+000317c0: 2b22 2c20 656e 636f 6469 6e67 3d22 7574  +", encoding="ut
+000317d0: 662d 3822 290a 2020 2020 2020 2020 2020  f-8").          
+000317e0: 2020 7365 6c66 2e72 6f77 5f64 6174 615f    self.row_data_
+000317f0: 6668 5f63 6c6f 7365 6420 3d20 4661 6c73  fh_closed = Fals
+00031800: 650a 2020 2020 2020 2020 2020 2020 7365  e.            se
+00031810: 6c66 2e66 6820 3d20 7365 6c66 2e72 6f77  lf.fh = self.row
+00031820: 5f64 6174 615f 6668 0a0a 2020 2020 6465  _data_fh..    de
+00031830: 6620 5f73 6574 5f69 636f 6e5f 7072 6f70  f _set_icon_prop
+00031840: 7328 7365 6c66 2c20 746f 7461 6c5f 6963  s(self, total_ic
+00031850: 6f6e 732c 2075 7365 725f 7072 6f70 733d  ons, user_props=
+00031860: 4e6f 6e65 293a 0a20 2020 2020 2020 2023  None):.        #
+00031870: 2053 6574 2074 6865 2073 7562 2d70 726f   Set the sub-pro
+00031880: 7065 7274 6965 7320 666f 7220 6963 6f6e  perties for icon
+00031890: 732e 0a20 2020 2020 2020 2070 726f 7073  s..        props
+000318a0: 203d 205b 5d0a 0a20 2020 2020 2020 2023   = []..        #
+000318b0: 2053 6574 2074 6865 2064 6566 6175 6c74   Set the default
+000318c0: 732e 0a20 2020 2020 2020 2066 6f72 205f  s..        for _
+000318d0: 2069 6e20 7261 6e67 6528 746f 7461 6c5f   in range(total_
+000318e0: 6963 6f6e 7329 3a0a 2020 2020 2020 2020  icons):.        
+000318f0: 2020 2020 7072 6f70 732e 6170 7065 6e64      props.append
+00031900: 287b 2263 7269 7465 7269 6122 3a20 4661  ({"criteria": Fa
+00031910: 6c73 652c 2022 7661 6c75 6522 3a20 302c  lse, "value": 0,
+00031920: 2022 7479 7065 223a 2022 7065 7263 656e   "type": "percen
+00031930: 7422 7d29 0a0a 2020 2020 2020 2020 2320  t"})..        # 
+00031940: 5365 7420 7468 6520 6465 6661 756c 7420  Set the default 
+00031950: 6963 6f6e 2076 616c 7565 7320 6261 7365  icon values base
+00031960: 6420 6f6e 2074 6865 206e 756d 6265 7220  d on the number 
+00031970: 6f66 2069 636f 6e73 2e0a 2020 2020 2020  of icons..      
+00031980: 2020 6966 2074 6f74 616c 5f69 636f 6e73    if total_icons
+00031990: 203d 3d20 333a 0a20 2020 2020 2020 2020   == 3:.         
+000319a0: 2020 2070 726f 7073 5b30 5d5b 2276 616c     props[0]["val
+000319b0: 7565 225d 203d 2036 370a 2020 2020 2020  ue"] = 67.      
+000319c0: 2020 2020 2020 7072 6f70 735b 315d 5b22        props[1]["
+000319d0: 7661 6c75 6522 5d20 3d20 3333 0a0a 2020  value"] = 33..  
+000319e0: 2020 2020 2020 6966 2074 6f74 616c 5f69        if total_i
+000319f0: 636f 6e73 203d 3d20 343a 0a20 2020 2020  cons == 4:.     
+00031a00: 2020 2020 2020 2070 726f 7073 5b30 5d5b         props[0][
+00031a10: 2276 616c 7565 225d 203d 2037 350a 2020  "value"] = 75.  
+00031a20: 2020 2020 2020 2020 2020 7072 6f70 735b            props[
+00031a30: 315d 5b22 7661 6c75 6522 5d20 3d20 3530  1]["value"] = 50
+00031a40: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
+00031a50: 7073 5b32 5d5b 2276 616c 7565 225d 203d  ps[2]["value"] =
+00031a60: 2032 350a 0a20 2020 2020 2020 2069 6620   25..        if 
+00031a70: 746f 7461 6c5f 6963 6f6e 7320 3d3d 2035  total_icons == 5
+00031a80: 3a0a 2020 2020 2020 2020 2020 2020 7072  :.            pr
+00031a90: 6f70 735b 305d 5b22 7661 6c75 6522 5d20  ops[0]["value"] 
+00031aa0: 3d20 3830 0a20 2020 2020 2020 2020 2020  = 80.           
+00031ab0: 2070 726f 7073 5b31 5d5b 2276 616c 7565   props[1]["value
+00031ac0: 225d 203d 2036 300a 2020 2020 2020 2020  "] = 60.        
+00031ad0: 2020 2020 7072 6f70 735b 325d 5b22 7661      props[2]["va
+00031ae0: 6c75 6522 5d20 3d20 3430 0a20 2020 2020  lue"] = 40.     
+00031af0: 2020 2020 2020 2070 726f 7073 5b33 5d5b         props[3][
+00031b00: 2276 616c 7565 225d 203d 2032 300a 0a20  "value"] = 20.. 
+00031b10: 2020 2020 2020 2023 204f 7665 7277 7269         # Overwri
+00031b20: 7465 2064 6566 6175 6c74 2070 726f 7065  te default prope
+00031b30: 7274 6965 7320 7769 7468 2075 7365 7220  rties with user 
+00031b40: 6465 6669 6e65 6420 7072 6f70 6572 7469  defined properti
+00031b50: 6573 2e0a 2020 2020 2020 2020 6966 2075  es..        if u
+00031b60: 7365 725f 7072 6f70 733a 0a20 2020 2020  ser_props:.     
+00031b70: 2020 2020 2020 2023 2045 6e73 7572 6520         # Ensure 
+00031b80: 7765 2064 6f6e 2774 2073 6574 2075 7365  we don't set use
+00031b90: 7220 7072 6f70 6572 7469 6573 2066 6f72  r properties for
+00031ba0: 206c 6f77 6573 7420 6963 6f6e 2e0a 2020   lowest icon..  
+00031bb0: 2020 2020 2020 2020 2020 6d61 785f 6461            max_da
+00031bc0: 7461 203d 206c 656e 2875 7365 725f 7072  ta = len(user_pr
+00031bd0: 6f70 7329 0a20 2020 2020 2020 2020 2020  ops).           
+00031be0: 2069 6620 6d61 785f 6461 7461 203e 3d20   if max_data >= 
+00031bf0: 746f 7461 6c5f 6963 6f6e 733a 0a20 2020  total_icons:.   
+00031c00: 2020 2020 2020 2020 2020 2020 206d 6178               max
+00031c10: 5f64 6174 6120 3d20 746f 7461 6c5f 6963  _data = total_ic
+00031c20: 6f6e 7320 2d20 310a 0a20 2020 2020 2020  ons - 1..       
+00031c30: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
+00031c40: 6e67 6528 6d61 785f 6461 7461 293a 0a20  nge(max_data):. 
+00031c50: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00031c60: 2053 6574 2074 6865 2075 7365 7220 6465   Set the user de
+00031c70: 6669 6e65 6420 2776 616c 7565 2720 7072  fined 'value' pr
+00031c80: 6f70 6572 7479 2e0a 2020 2020 2020 2020  operty..        
+00031c90: 2020 2020 2020 2020 6966 2075 7365 725f          if user_
+00031ca0: 7072 6f70 735b 695d 2e67 6574 2822 7661  props[i].get("va
+00031cb0: 6c75 6522 2920 6973 206e 6f74 204e 6f6e  lue") is not Non
+00031cc0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00031cd0: 2020 2020 2020 2070 726f 7073 5b69 5d5b         props[i][
+00031ce0: 2276 616c 7565 225d 203d 2075 7365 725f  "value"] = user_
+00031cf0: 7072 6f70 735b 695d 5b22 7661 6c75 6522  props[i]["value"
+00031d00: 5d0a 0a20 2020 2020 2020 2020 2020 2020  ]..             
+00031d10: 2020 2020 2020 2023 2052 656d 6f76 6520         # Remove 
+00031d20: 7468 6520 666f 726d 756c 6120 273d 2720  the formula '=' 
+00031d30: 7369 676e 2069 6620 6974 2065 7869 7374  sign if it exist
+00031d40: 732e 0a20 2020 2020 2020 2020 2020 2020  s..             
+00031d50: 2020 2020 2020 2074 6d70 203d 2070 726f         tmp = pro
+00031d60: 7073 5b69 5d5b 2276 616c 7565 225d 0a20  ps[i]["value"]. 
+00031d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031d80: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00031d90: 2874 6d70 2c20 7374 7229 2061 6e64 2074  (tmp, str) and t
+00031da0: 6d70 2e73 7461 7274 7377 6974 6828 223d  mp.startswith("=
+00031db0: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+00031dc0: 2020 2020 2020 2020 2020 2020 7072 6f70              prop
+00031dd0: 735b 695d 5b22 7661 6c75 6522 5d20 3d20  s[i]["value"] = 
+00031de0: 746d 702e 6c73 7472 6970 2822 3d22 290a  tmp.lstrip("=").
+00031df0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031e00: 2023 2053 6574 2074 6865 2075 7365 7220   # Set the user 
+00031e10: 6465 6669 6e65 6420 2774 7970 6527 2070  defined 'type' p
+00031e20: 726f 7065 7274 792e 0a20 2020 2020 2020  roperty..       
+00031e30: 2020 2020 2020 2020 2069 6620 7573 6572           if user
+00031e40: 5f70 726f 7073 5b69 5d2e 6765 7428 2274  _props[i].get("t
+00031e50: 7970 6522 293a 0a20 2020 2020 2020 2020  ype"):.         
+00031e60: 2020 2020 2020 2020 2020 2076 616c 6964             valid
+00031e70: 5f74 7970 6573 203d 2028 2270 6572 6365  _types = ("perce
+00031e80: 6e74 222c 2022 7065 7263 656e 7469 6c65  nt", "percentile
+00031e90: 222c 2022 6e75 6d62 6572 222c 2022 666f  ", "number", "fo
+00031ea0: 726d 756c 6122 290a 0a20 2020 2020 2020  rmula")..       
+00031eb0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00031ec0: 7573 6572 5f70 726f 7073 5b69 5d5b 2274  user_props[i]["t
+00031ed0: 7970 6522 5d20 6e6f 7420 696e 2076 616c  ype"] not in val
+00031ee0: 6964 5f74 7970 6573 3a0a 2020 2020 2020  id_types:.      
+00031ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031f00: 2020 7761 726e 280a 2020 2020 2020 2020    warn(.        
+00031f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031f20: 2020 2020 2255 6e6b 6e6f 776e 2069 636f      "Unknown ico
+00031f30: 6e20 7072 6f70 6572 7479 2074 7970 6520  n property type 
+00031f40: 2725 7327 2066 6f72 2073 7562 2d22 0a20  '%s' for sub-". 
+00031f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031f60: 2020 2020 2020 2020 2020 2022 7072 6f70             "prop
+00031f70: 6572 7479 2027 7479 7065 2720 696e 2063  erty 'type' in c
+00031f80: 6f6e 6469 7469 6f6e 616c 5f66 6f72 6d61  onditional_forma
+00031f90: 7428 2922 0a20 2020 2020 2020 2020 2020  t()".           
+00031fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031fb0: 2025 2075 7365 725f 7072 6f70 735b 695d   % user_props[i]
+00031fc0: 5b22 7479 7065 225d 0a20 2020 2020 2020  ["type"].       
+00031fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031fe0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+00031ff0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00032000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032010: 2020 2020 2070 726f 7073 5b69 5d5b 2274       props[i]["t
+00032020: 7970 6522 5d20 3d20 7573 6572 5f70 726f  ype"] = user_pro
+00032030: 7073 5b69 5d5b 2274 7970 6522 5d0a 0a20  ps[i]["type"].. 
+00032040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032050: 2020 2020 2020 2069 6620 7072 6f70 735b         if props[
+00032060: 695d 5b22 7479 7065 225d 203d 3d20 226e  i]["type"] == "n
+00032070: 756d 6265 7222 3a0a 2020 2020 2020 2020  umber":.        
+00032080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032090: 2020 2020 7072 6f70 735b 695d 5b22 7479      props[i]["ty
+000320a0: 7065 225d 203d 2022 6e75 6d22 0a0a 2020  pe"] = "num"..  
+000320b0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+000320c0: 5365 7420 7468 6520 7573 6572 2064 6566  Set the user def
+000320d0: 696e 6564 2027 6372 6974 6572 6961 2720  ined 'criteria' 
+000320e0: 7072 6f70 6572 7479 2e0a 2020 2020 2020  property..      
+000320f0: 2020 2020 2020 2020 2020 6372 6974 6572            criter
+00032100: 6961 203d 2075 7365 725f 7072 6f70 735b  ia = user_props[
+00032110: 695d 2e67 6574 2822 6372 6974 6572 6961  i].get("criteria
+00032120: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+00032130: 2020 2069 6620 6372 6974 6572 6961 2061     if criteria a
+00032140: 6e64 2063 7269 7465 7269 6120 3d3d 2022  nd criteria == "
+00032150: 3e22 3a0a 2020 2020 2020 2020 2020 2020  >":.            
+00032160: 2020 2020 2020 2020 7072 6f70 735b 695d          props[i]
+00032170: 5b22 6372 6974 6572 6961 225d 203d 2054  ["criteria"] = T
+00032180: 7275 650a 0a20 2020 2020 2020 2072 6574  rue..        ret
+00032190: 7572 6e20 7072 6f70 730a 0a20 2020 2023  urn props..    #
+000321a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000321b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000321c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000321d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000321e0: 2323 2323 2323 2323 2323 0a20 2020 2023  ##########.    #
+000321f0: 0a20 2020 2023 2058 4d4c 206d 6574 686f  .    # XML metho
+00032200: 6473 2e0a 2020 2020 230a 2020 2020 2323  ds..    #.    ##
+00032210: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00032220: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00032230: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00032240: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00032250: 2323 2323 2323 2323 230a 0a20 2020 2064  #########..    d
+00032260: 6566 205f 7772 6974 655f 776f 726b 7368  ef _write_worksh
+00032270: 6565 7428 7365 6c66 293a 0a20 2020 2020  eet(self):.     
+00032280: 2020 2023 2057 7269 7465 2074 6865 203c     # Write the <
+00032290: 776f 726b 7368 6565 743e 2065 6c65 6d65  worksheet> eleme
+000322a0: 6e74 2e20 5468 6973 2069 7320 7468 6520  nt. This is the 
+000322b0: 726f 6f74 2065 6c65 6d65 6e74 2e0a 0a20  root element... 
+000322c0: 2020 2020 2020 2073 6368 656d 6120 3d20         schema = 
+000322d0: 2268 7474 703a 2f2f 7363 6865 6d61 732e  "http://schemas.
+000322e0: 6f70 656e 786d 6c66 6f72 6d61 7473 2e6f  openxmlformats.o
+000322f0: 7267 2f22 0a20 2020 2020 2020 2078 6d6c  rg/".        xml
+00032300: 6e73 203d 2073 6368 656d 6120 2b20 2273  ns = schema + "s
+00032310: 7072 6561 6473 6865 6574 6d6c 2f32 3030  preadsheetml/200
+00032320: 362f 6d61 696e 220a 2020 2020 2020 2020  6/main".        
+00032330: 786d 6c6e 735f 7220 3d20 7363 6865 6d61  xmlns_r = schema
+00032340: 202b 2022 6f66 6669 6365 446f 6375 6d65   + "officeDocume
+00032350: 6e74 2f32 3030 362f 7265 6c61 7469 6f6e  nt/2006/relation
+00032360: 7368 6970 7322 0a20 2020 2020 2020 2078  ships".        x
+00032370: 6d6c 6e73 5f6d 6320 3d20 7363 6865 6d61  mlns_mc = schema
+00032380: 202b 2022 6d61 726b 7570 2d63 6f6d 7061   + "markup-compa
+00032390: 7469 6269 6c69 7479 2f32 3030 3622 0a20  tibility/2006". 
+000323a0: 2020 2020 2020 206d 735f 7363 6865 6d61         ms_schema
+000323b0: 203d 2022 6874 7470 3a2f 2f73 6368 656d   = "http://schem
+000323c0: 6173 2e6d 6963 726f 736f 6674 2e63 6f6d  as.microsoft.com
+000323d0: 2f22 0a20 2020 2020 2020 2078 6d6c 6e73  /".        xmlns
+000323e0: 5f78 3134 6163 203d 206d 735f 7363 6865  _x14ac = ms_sche
+000323f0: 6d61 202b 2022 6f66 6669 6365 2f73 7072  ma + "office/spr
+00032400: 6561 6473 6865 6574 6d6c 2f32 3030 392f  eadsheetml/2009/
+00032410: 392f 6163 220a 0a20 2020 2020 2020 2061  9/ac"..        a
+00032420: 7474 7269 6275 7465 7320 3d20 5b28 2278  ttributes = [("x
+00032430: 6d6c 6e73 222c 2078 6d6c 6e73 292c 2028  mlns", xmlns), (
+00032440: 2278 6d6c 6e73 3a72 222c 2078 6d6c 6e73  "xmlns:r", xmlns
+00032450: 5f72 295d 0a0a 2020 2020 2020 2020 2320  _r)]..        # 
+00032460: 4164 6420 736f 6d65 2065 7874 7261 2061  Add some extra a
+00032470: 7474 7269 6275 7465 7320 666f 7220 4578  ttributes for Ex
+00032480: 6365 6c20 3230 3130 2e20 4d61 696e 6c79  cel 2010. Mainly
+00032490: 2066 6f72 2073 7061 726b 6c69 6e65 732e   for sparklines.
+000324a0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+000324b0: 2e65 7863 656c 5f76 6572 7369 6f6e 203d  .excel_version =
+000324c0: 3d20 3230 3130 3a0a 2020 2020 2020 2020  = 2010:.        
+000324d0: 2020 2020 6174 7472 6962 7574 6573 2e61      attributes.a
+000324e0: 7070 656e 6428 2822 786d 6c6e 733a 6d63  ppend(("xmlns:mc
+000324f0: 222c 2078 6d6c 6e73 5f6d 6329 290a 2020  ", xmlns_mc)).  
+00032500: 2020 2020 2020 2020 2020 6174 7472 6962            attrib
+00032510: 7574 6573 2e61 7070 656e 6428 2822 786d  utes.append(("xm
+00032520: 6c6e 733a 7831 3461 6322 2c20 786d 6c6e  lns:x14ac", xmln
+00032530: 735f 7831 3461 6329 290a 2020 2020 2020  s_x14ac)).      
+00032540: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
+00032550: 2e61 7070 656e 6428 2822 6d63 3a49 676e  .append(("mc:Ign
+00032560: 6f72 6162 6c65 222c 2022 7831 3461 6322  orable", "x14ac"
+00032570: 2929 0a0a 2020 2020 2020 2020 7365 6c66  ))..        self
+00032580: 2e5f 786d 6c5f 7374 6172 745f 7461 6728  ._xml_start_tag(
+00032590: 2277 6f72 6b73 6865 6574 222c 2061 7474  "worksheet", att
+000325a0: 7269 6275 7465 7329 0a0a 2020 2020 6465  ributes)..    de
+000325b0: 6620 5f77 7269 7465 5f64 696d 656e 7369  f _write_dimensi
+000325c0: 6f6e 2873 656c 6629 3a0a 2020 2020 2020  on(self):.      
+000325d0: 2020 2320 5772 6974 6520 7468 6520 3c64    # Write the <d
+000325e0: 696d 656e 7369 6f6e 3e20 656c 656d 656e  imension> elemen
+000325f0: 742e 2054 6869 7320 7370 6563 6966 6965  t. This specifie
+00032600: 7320 7468 6520 7261 6e67 6520 6f66 0a20  s the range of. 
+00032610: 2020 2020 2020 2023 2063 656c 6c73 2069         # cells i
+00032620: 6e20 7468 6520 776f 726b 7368 6565 742e  n the worksheet.
+00032630: 2041 7320 6120 7370 6563 6961 6c20 6361   As a special ca
+00032640: 7365 2c20 656d 7074 790a 2020 2020 2020  se, empty.      
+00032650: 2020 2320 7370 7265 6164 7368 6565 7473    # spreadsheets
+00032660: 2075 7365 2027 4131 2720 6173 2061 2072   use 'A1' as a r
+00032670: 616e 6765 2e0a 0a20 2020 2020 2020 2069  ange...        i
+00032680: 6620 7365 6c66 2e64 696d 5f72 6f77 6d69  f self.dim_rowmi
+00032690: 6e20 6973 204e 6f6e 6520 616e 6420 7365  n is None and se
+000326a0: 6c66 2e64 696d 5f63 6f6c 6d69 6e20 6973  lf.dim_colmin is
+000326b0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+000326c0: 2020 2023 2049 6620 7468 6520 6d69 6e20     # If the min 
+000326d0: 6469 6d65 6e73 696f 6e73 2061 7265 206e  dimensions are n
+000326e0: 6f74 2064 6566 696e 6564 2074 6865 6e20  ot defined then 
+000326f0: 6e6f 2064 696d 656e 7369 6f6e 730a 2020  no dimensions.  
+00032700: 2020 2020 2020 2020 2020 2320 6861 7665            # have
+00032710: 2062 6565 6e20 7365 7420 616e 6420 7765   been set and we
+00032720: 2075 7365 2074 6865 2064 6566 6175 6c74   use the default
+00032730: 2027 4131 272e 0a20 2020 2020 2020 2020   'A1'..         
+00032740: 2020 2072 6566 203d 2022 4131 220a 0a20     ref = "A1".. 
+00032750: 2020 2020 2020 2065 6c69 6620 7365 6c66         elif self
+00032760: 2e64 696d 5f72 6f77 6d69 6e20 6973 204e  .dim_rowmin is N
+00032770: 6f6e 6520 616e 6420 7365 6c66 2e64 696d  one and self.dim
+00032780: 5f63 6f6c 6d69 6e20 6973 206e 6f74 204e  _colmin is not N
+00032790: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000327a0: 2023 2049 6620 7468 6520 726f 7720 6469   # If the row di
+000327b0: 6d65 6e73 696f 6e73 2061 7265 6e27 7420  mensions aren't 
+000327c0: 7365 7420 6275 7420 7468 6520 636f 6c75  set but the colu
+000327d0: 6d6e 0a20 2020 2020 2020 2020 2020 2023  mn.            #
+000327e0: 2064 696d 656e 7369 6f6e 7320 6172 6520   dimensions are 
+000327f0: 7365 7420 7468 656e 2074 6865 7920 6861  set then they ha
+00032800: 7665 2062 6565 6e20 6368 616e 6765 6420  ve been changed 
+00032810: 7669 610a 2020 2020 2020 2020 2020 2020  via.            
+00032820: 2320 7365 745f 636f 6c75 6d6e 2829 2e0a  # set_column()..
+00032830: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00032840: 7365 6c66 2e64 696d 5f63 6f6c 6d69 6e20  self.dim_colmin 
+00032850: 3d3d 2073 656c 662e 6469 6d5f 636f 6c6d  == self.dim_colm
+00032860: 6178 3a0a 2020 2020 2020 2020 2020 2020  ax:.            
+00032870: 2020 2020 2320 5468 6520 6469 6d65 6e73      # The dimens
+00032880: 696f 6e73 2061 7265 2061 2073 696e 676c  ions are a singl
+00032890: 6520 6365 6c6c 2061 6e64 206e 6f74 2061  e cell and not a
+000328a0: 2072 616e 6765 2e0a 2020 2020 2020 2020   range..        
+000328b0: 2020 2020 2020 2020 7265 6620 3d20 786c          ref = xl
+000328c0: 5f72 6f77 636f 6c5f 746f 5f63 656c 6c28  _rowcol_to_cell(
+000328d0: 302c 2073 656c 662e 6469 6d5f 636f 6c6d  0, self.dim_colm
+000328e0: 696e 290a 2020 2020 2020 2020 2020 2020  in).            
+000328f0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00032900: 2020 2020 2020 2320 5468 6520 6469 6d65        # The dime
+00032910: 6e73 696f 6e73 2061 7265 2061 2063 656c  nsions are a cel
+00032920: 6c20 7261 6e67 652e 0a20 2020 2020 2020  l range..       
+00032930: 2020 2020 2020 2020 2063 656c 6c5f 3120           cell_1 
+00032940: 3d20 786c 5f72 6f77 636f 6c5f 746f 5f63  = xl_rowcol_to_c
+00032950: 656c 6c28 302c 2073 656c 662e 6469 6d5f  ell(0, self.dim_
+00032960: 636f 6c6d 696e 290a 2020 2020 2020 2020  colmin).        
+00032970: 2020 2020 2020 2020 6365 6c6c 5f32 203d          cell_2 =
+00032980: 2078 6c5f 726f 7763 6f6c 5f74 6f5f 6365   xl_rowcol_to_ce
+00032990: 6c6c 2830 2c20 7365 6c66 2e64 696d 5f63  ll(0, self.dim_c
+000329a0: 6f6c 6d61 7829 0a20 2020 2020 2020 2020  olmax).         
+000329b0: 2020 2020 2020 2072 6566 203d 2063 656c         ref = cel
+000329c0: 6c5f 3120 2b20 223a 2220 2b20 6365 6c6c  l_1 + ":" + cell
+000329d0: 5f32 0a0a 2020 2020 2020 2020 656c 6966  _2..        elif
+000329e0: 2073 656c 662e 6469 6d5f 726f 776d 696e   self.dim_rowmin
+000329f0: 203d 3d20 7365 6c66 2e64 696d 5f72 6f77   == self.dim_row
+00032a00: 6d61 7820 616e 6420 7365 6c66 2e64 696d  max and self.dim
+00032a10: 5f63 6f6c 6d69 6e20 3d3d 2073 656c 662e  _colmin == self.
+00032a20: 6469 6d5f 636f 6c6d 6178 3a0a 2020 2020  dim_colmax:.    
+00032a30: 2020 2020 2020 2020 2320 5468 6520 6469          # The di
+00032a40: 6d65 6e73 696f 6e73 2061 7265 2061 2073  mensions are a s
+00032a50: 696e 676c 6520 6365 6c6c 2061 6e64 206e  ingle cell and n
+00032a60: 6f74 2061 2072 616e 6765 2e0a 2020 2020  ot a range..    
+00032a70: 2020 2020 2020 2020 7265 6620 3d20 786c          ref = xl
+00032a80: 5f72 6f77 636f 6c5f 746f 5f63 656c 6c28  _rowcol_to_cell(
+00032a90: 7365 6c66 2e64 696d 5f72 6f77 6d69 6e2c  self.dim_rowmin,
+00032aa0: 2073 656c 662e 6469 6d5f 636f 6c6d 696e   self.dim_colmin
+00032ab0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+00032ac0: 2020 2020 2020 2020 2020 2020 2320 5468              # Th
+00032ad0: 6520 6469 6d65 6e73 696f 6e73 2061 7265  e dimensions are
+00032ae0: 2061 2063 656c 6c20 7261 6e67 652e 0a20   a cell range.. 
+00032af0: 2020 2020 2020 2020 2020 2063 656c 6c5f             cell_
+00032b00: 3120 3d20 786c 5f72 6f77 636f 6c5f 746f  1 = xl_rowcol_to
+00032b10: 5f63 656c 6c28 7365 6c66 2e64 696d 5f72  _cell(self.dim_r
+00032b20: 6f77 6d69 6e2c 2073 656c 662e 6469 6d5f  owmin, self.dim_
+00032b30: 636f 6c6d 696e 290a 2020 2020 2020 2020  colmin).        
+00032b40: 2020 2020 6365 6c6c 5f32 203d 2078 6c5f      cell_2 = xl_
+00032b50: 726f 7763 6f6c 5f74 6f5f 6365 6c6c 2873  rowcol_to_cell(s
+00032b60: 656c 662e 6469 6d5f 726f 776d 6178 2c20  elf.dim_rowmax, 
+00032b70: 7365 6c66 2e64 696d 5f63 6f6c 6d61 7829  self.dim_colmax)
+00032b80: 0a20 2020 2020 2020 2020 2020 2072 6566  .            ref
+00032b90: 203d 2063 656c 6c5f 3120 2b20 223a 2220   = cell_1 + ":" 
+00032ba0: 2b20 6365 6c6c 5f32 0a0a 2020 2020 2020  + cell_2..      
+00032bb0: 2020 7365 6c66 2e5f 786d 6c5f 656d 7074    self._xml_empt
+00032bc0: 795f 7461 6728 2264 696d 656e 7369 6f6e  y_tag("dimension
+00032bd0: 222c 205b 2822 7265 6622 2c20 7265 6629  ", [("ref", ref)
+00032be0: 5d29 0a0a 2020 2020 6465 6620 5f77 7269  ])..    def _wri
+00032bf0: 7465 5f73 6865 6574 5f76 6965 7773 2873  te_sheet_views(s
+00032c00: 656c 6629 3a0a 2020 2020 2020 2020 2320  elf):.        # 
+00032c10: 5772 6974 6520 7468 6520 3c73 6865 6574  Write the <sheet
+00032c20: 5669 6577 733e 2065 6c65 6d65 6e74 2e0a  Views> element..
+00032c30: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
+00032c40: 6c5f 7374 6172 745f 7461 6728 2273 6865  l_start_tag("she
+00032c50: 6574 5669 6577 7322 290a 0a20 2020 2020  etViews")..     
+00032c60: 2020 2023 2057 7269 7465 2074 6865 2073     # Write the s
+00032c70: 6865 6574 5669 6577 2065 6c65 6d65 6e74  heetView element
+00032c80: 2e0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+00032c90: 7772 6974 655f 7368 6565 745f 7669 6577  write_sheet_view
+00032ca0: 2829 0a0a 2020 2020 2020 2020 7365 6c66  ()..        self
+00032cb0: 2e5f 786d 6c5f 656e 645f 7461 6728 2273  ._xml_end_tag("s
+00032cc0: 6865 6574 5669 6577 7322 290a 0a20 2020  heetViews")..   
+00032cd0: 2064 6566 205f 7772 6974 655f 7368 6565   def _write_shee
+00032ce0: 745f 7669 6577 2873 656c 6629 3a0a 2020  t_view(self):.  
+00032cf0: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
+00032d00: 6520 3c73 6865 6574 5669 6577 733e 2065  e <sheetViews> e
+00032d10: 6c65 6d65 6e74 2e0a 2020 2020 2020 2020  lement..        
+00032d20: 6174 7472 6962 7574 6573 203d 205b 5d0a  attributes = [].
+00032d30: 0a20 2020 2020 2020 2023 2048 6964 6520  .        # Hide 
+00032d40: 7363 7265 656e 2067 7269 646c 696e 6573  screen gridlines
+00032d50: 2069 6620 7265 7175 6972 6564 2e0a 2020   if required..  
+00032d60: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+00032d70: 662e 7363 7265 656e 5f67 7269 646c 696e  f.screen_gridlin
+00032d80: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+00032d90: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
+00032da0: 6428 2822 7368 6f77 4772 6964 4c69 6e65  d(("showGridLine
+00032db0: 7322 2c20 3029 290a 0a20 2020 2020 2020  s", 0))..       
+00032dc0: 2023 2048 6964 6520 7363 7265 656e 2072   # Hide screen r
+00032dd0: 6f77 2f63 6f6c 756d 6e20 6865 6164 6572  ow/column header
+00032de0: 732e 0a20 2020 2020 2020 2069 6620 7365  s..        if se
+00032df0: 6c66 2e72 6f77 5f63 6f6c 5f68 6561 6465  lf.row_col_heade
+00032e00: 7273 3a0a 2020 2020 2020 2020 2020 2020  rs:.            
+00032e10: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
+00032e20: 6428 2822 7368 6f77 526f 7743 6f6c 4865  d(("showRowColHe
+00032e30: 6164 6572 7322 2c20 3029 290a 0a20 2020  aders", 0))..   
+00032e40: 2020 2020 2023 2048 6964 6520 7a65 726f       # Hide zero
+00032e50: 6573 2069 6e20 6365 6c6c 732e 0a20 2020  es in cells..   
+00032e60: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+00032e70: 2e73 686f 775f 7a65 726f 733a 0a20 2020  .show_zeros:.   
+00032e80: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+00032e90: 7465 732e 6170 7065 6e64 2828 2273 686f  tes.append(("sho
+00032ea0: 775a 6572 6f73 222c 2030 2929 0a0a 2020  wZeros", 0))..  
+00032eb0: 2020 2020 2020 2320 4469 7370 6c61 7920        # Display 
+00032ec0: 776f 726b 7368 6565 7420 7269 6768 7420  worksheet right 
+00032ed0: 746f 206c 6566 7420 666f 7220 4865 6272  to left for Hebr
+00032ee0: 6577 2c20 4172 6162 6963 2061 6e64 206f  ew, Arabic and o
+00032ef0: 7468 6572 732e 0a20 2020 2020 2020 2069  thers..        i
+00032f00: 6620 7365 6c66 2e69 735f 7269 6768 745f  f self.is_right_
+00032f10: 746f 5f6c 6566 743a 0a20 2020 2020 2020  to_left:.       
+00032f20: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
+00032f30: 6170 7065 6e64 2828 2272 6967 6874 546f  append(("rightTo
+00032f40: 4c65 6674 222c 2031 2929 0a0a 2020 2020  Left", 1))..    
+00032f50: 2020 2020 2320 5368 6f77 2074 6861 7420      # Show that 
+00032f60: 7468 6520 7368 6565 7420 7461 6220 6973  the sheet tab is
+00032f70: 2073 656c 6563 7465 642e 0a20 2020 2020   selected..     
+00032f80: 2020 2069 6620 7365 6c66 2e73 656c 6563     if self.selec
+00032f90: 7465 643a 0a20 2020 2020 2020 2020 2020  ted:.           
+00032fa0: 2061 7474 7269 6275 7465 732e 6170 7065   attributes.appe
+00032fb0: 6e64 2828 2274 6162 5365 6c65 6374 6564  nd(("tabSelected
+00032fc0: 222c 2031 2929 0a0a 2020 2020 2020 2020  ", 1))..        
+00032fd0: 2320 5475 726e 206f 7574 6c69 6e65 7320  # Turn outlines 
+00032fe0: 6f66 662e 2041 6c73 6f20 7265 7175 6972  off. Also requir
+00032ff0: 6564 2069 6e20 7468 6520 6f75 746c 696e  ed in the outlin
+00033000: 6550 7220 656c 656d 656e 742e 0a20 2020  ePr element..   
+00033010: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+00033020: 2e6f 7574 6c69 6e65 5f6f 6e3a 0a20 2020  .outline_on:.   
+00033030: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+00033040: 7465 732e 6170 7065 6e64 2828 2273 686f  tes.append(("sho
+00033050: 774f 7574 6c69 6e65 5379 6d62 6f6c 7322  wOutlineSymbols"
+00033060: 2c20 3029 290a 0a20 2020 2020 2020 2023  , 0))..        #
+00033070: 2053 6574 2074 6865 2070 6167 6520 7669   Set the page vi
+00033080: 6577 2f6c 6179 6f75 7420 6d6f 6465 2069  ew/layout mode i
+00033090: 6620 7265 7175 6972 6564 2e0a 2020 2020  f required..    
+000330a0: 2020 2020 6966 2073 656c 662e 7061 6765      if self.page
+000330b0: 5f76 6965 773a 0a20 2020 2020 2020 2020  _view:.         
+000330c0: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
+000330d0: 7065 6e64 2828 2276 6965 7722 2c20 2270  pend(("view", "p
+000330e0: 6167 654c 6179 6f75 7422 2929 0a0a 2020  ageLayout"))..  
+000330f0: 2020 2020 2020 2320 5365 7420 7468 6520        # Set the 
+00033100: 6669 7273 7420 7669 7369 626c 6520 6365  first visible ce
+00033110: 6c6c 2e0a 2020 2020 2020 2020 6966 2073  ll..        if s
+00033120: 656c 662e 746f 705f 6c65 6674 5f63 656c  elf.top_left_cel
+00033130: 6c20 213d 2022 223a 0a20 2020 2020 2020  l != "":.       
+00033140: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
+00033150: 6170 7065 6e64 2828 2274 6f70 4c65 6674  append(("topLeft
+00033160: 4365 6c6c 222c 2073 656c 662e 746f 705f  Cell", self.top_
+00033170: 6c65 6674 5f63 656c 6c29 290a 0a20 2020  left_cell))..   
+00033180: 2020 2020 2023 2053 6574 2074 6865 207a       # Set the z
+00033190: 6f6f 6d20 6c65 7665 6c2e 0a20 2020 2020  oom level..     
+000331a0: 2020 2069 6620 7365 6c66 2e7a 6f6f 6d20     if self.zoom 
+000331b0: 213d 2031 3030 3a0a 2020 2020 2020 2020  != 100:.        
+000331c0: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+000331d0: 7061 6765 5f76 6965 773a 0a20 2020 2020  page_view:.     
+000331e0: 2020 2020 2020 2020 2020 2061 7474 7269             attri
+000331f0: 6275 7465 732e 6170 7065 6e64 2828 227a  butes.append(("z
+00033200: 6f6f 6d53 6361 6c65 222c 2073 656c 662e  oomScale", self.
+00033210: 7a6f 6f6d 2929 0a20 2020 2020 2020 2020  zoom)).         
+00033220: 2020 2020 2020 2069 6620 7365 6c66 2e7a         if self.z
+00033230: 6f6f 6d5f 7363 616c 655f 6e6f 726d 616c  oom_scale_normal
+00033240: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00033250: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
+00033260: 2e61 7070 656e 6428 2822 7a6f 6f6d 5363  .append(("zoomSc
+00033270: 616c 654e 6f72 6d61 6c22 2c20 7365 6c66  aleNormal", self
+00033280: 2e7a 6f6f 6d29 290a 0a20 2020 2020 2020  .zoom))..       
+00033290: 2061 7474 7269 6275 7465 732e 6170 7065   attributes.appe
+000332a0: 6e64 2828 2277 6f72 6b62 6f6f 6b56 6965  nd(("workbookVie
+000332b0: 7749 6422 2c20 3029 290a 0a20 2020 2020  wId", 0))..     
+000332c0: 2020 2069 6620 7365 6c66 2e70 616e 6573     if self.panes
+000332d0: 206f 7220 6c65 6e28 7365 6c66 2e73 656c   or len(self.sel
+000332e0: 6563 7469 6f6e 7329 3a0a 2020 2020 2020  ections):.      
+000332f0: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
+00033300: 7374 6172 745f 7461 6728 2273 6865 6574  start_tag("sheet
+00033310: 5669 6577 222c 2061 7474 7269 6275 7465  View", attribute
+00033320: 7329 0a20 2020 2020 2020 2020 2020 2073  s).            s
+00033330: 656c 662e 5f77 7269 7465 5f70 616e 6573  elf._write_panes
+00033340: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
+00033350: 656c 662e 5f77 7269 7465 5f73 656c 6563  elf._write_selec
+00033360: 7469 6f6e 7328 290a 2020 2020 2020 2020  tions().        
+00033370: 2020 2020 7365 6c66 2e5f 786d 6c5f 656e      self._xml_en
+00033380: 645f 7461 6728 2273 6865 6574 5669 6577  d_tag("sheetView
+00033390: 2229 0a20 2020 2020 2020 2065 6c73 653a  ").        else:
+000333a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000333b0: 662e 5f78 6d6c 5f65 6d70 7479 5f74 6167  f._xml_empty_tag
+000333c0: 2822 7368 6565 7456 6965 7722 2c20 6174  ("sheetView", at
+000333d0: 7472 6962 7574 6573 290a 0a20 2020 2064  tributes)..    d
+000333e0: 6566 205f 7772 6974 655f 7368 6565 745f  ef _write_sheet_
+000333f0: 666f 726d 6174 5f70 7228 7365 6c66 293a  format_pr(self):
+00033400: 0a20 2020 2020 2020 2023 2057 7269 7465  .        # Write
+00033410: 2074 6865 203c 7368 6565 7446 6f72 6d61   the <sheetForma
+00033420: 7450 723e 2065 6c65 6d65 6e74 2e0a 2020  tPr> element..  
+00033430: 2020 2020 2020 6465 6661 756c 745f 726f        default_ro
+00033440: 775f 6865 6967 6874 203d 2073 656c 662e  w_height = self.
+00033450: 6465 6661 756c 745f 726f 775f 6865 6967  default_row_heig
+00033460: 6874 0a20 2020 2020 2020 2072 6f77 5f6c  ht.        row_l
+00033470: 6576 656c 203d 2073 656c 662e 6f75 746c  evel = self.outl
+00033480: 696e 655f 726f 775f 6c65 7665 6c0a 2020  ine_row_level.  
+00033490: 2020 2020 2020 636f 6c5f 6c65 7665 6c20        col_level 
+000334a0: 3d20 7365 6c66 2e6f 7574 6c69 6e65 5f63  = self.outline_c
+000334b0: 6f6c 5f6c 6576 656c 0a0a 2020 2020 2020  ol_level..      
+000334c0: 2020 6174 7472 6962 7574 6573 203d 205b    attributes = [
+000334d0: 2822 6465 6661 756c 7452 6f77 4865 6967  ("defaultRowHeig
+000334e0: 6874 222c 2064 6566 6175 6c74 5f72 6f77  ht", default_row
+000334f0: 5f68 6569 6768 7429 5d0a 0a20 2020 2020  _height)]..     
+00033500: 2020 2069 6620 7365 6c66 2e64 6566 6175     if self.defau
+00033510: 6c74 5f72 6f77 5f68 6569 6768 7420 213d  lt_row_height !=
+00033520: 2073 656c 662e 6f72 6967 696e 616c 5f72   self.original_r
+00033530: 6f77 5f68 6569 6768 743a 0a20 2020 2020  ow_height:.     
+00033540: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
+00033550: 732e 6170 7065 6e64 2828 2263 7573 746f  s.append(("custo
+00033560: 6d48 6569 6768 7422 2c20 3129 290a 0a20  mHeight", 1)).. 
+00033570: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
+00033580: 6566 6175 6c74 5f72 6f77 5f7a 6572 6f65  efault_row_zeroe
+00033590: 643a 0a20 2020 2020 2020 2020 2020 2061  d:.            a
+000335a0: 7474 7269 6275 7465 732e 6170 7065 6e64  ttributes.append
+000335b0: 2828 227a 6572 6f48 6569 6768 7422 2c20  (("zeroHeight", 
+000335c0: 3129 290a 0a20 2020 2020 2020 2069 6620  1))..        if 
+000335d0: 726f 775f 6c65 7665 6c3a 0a20 2020 2020  row_level:.     
+000335e0: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
+000335f0: 732e 6170 7065 6e64 2828 226f 7574 6c69  s.append(("outli
+00033600: 6e65 4c65 7665 6c52 6f77 222c 2072 6f77  neLevelRow", row
+00033610: 5f6c 6576 656c 2929 0a20 2020 2020 2020  _level)).       
+00033620: 2069 6620 636f 6c5f 6c65 7665 6c3a 0a20   if col_level:. 
+00033630: 2020 2020 2020 2020 2020 2061 7474 7269             attri
+00033640: 6275 7465 732e 6170 7065 6e64 2828 226f  butes.append(("o
+00033650: 7574 6c69 6e65 4c65 7665 6c43 6f6c 222c  utlineLevelCol",
+00033660: 2063 6f6c 5f6c 6576 656c 2929 0a0a 2020   col_level))..  
+00033670: 2020 2020 2020 6966 2073 656c 662e 6578        if self.ex
+00033680: 6365 6c5f 7665 7273 696f 6e20 3d3d 2032  cel_version == 2
+00033690: 3031 303a 0a20 2020 2020 2020 2020 2020  010:.           
+000336a0: 2061 7474 7269 6275 7465 732e 6170 7065   attributes.appe
+000336b0: 6e64 2828 2278 3134 6163 3a64 7944 6573  nd(("x14ac:dyDes
+000336c0: 6365 6e74 222c 2022 302e 3235 2229 290a  cent", "0.25")).
+000336d0: 0a20 2020 2020 2020 2073 656c 662e 5f78  .        self._x
+000336e0: 6d6c 5f65 6d70 7479 5f74 6167 2822 7368  ml_empty_tag("sh
+000336f0: 6565 7446 6f72 6d61 7450 7222 2c20 6174  eetFormatPr", at
+00033700: 7472 6962 7574 6573 290a 0a20 2020 2064  tributes)..    d
+00033710: 6566 205f 7772 6974 655f 636f 6c73 2873  ef _write_cols(s
+00033720: 656c 6629 3a0a 2020 2020 2020 2020 2320  elf):.        # 
+00033730: 5772 6974 6520 7468 6520 3c63 6f6c 733e  Write the <cols>
+00033740: 2065 6c65 6d65 6e74 2061 6e64 203c 636f   element and <co
+00033750: 6c3e 2073 7562 2065 6c65 6d65 6e74 732e  l> sub elements.
+00033760: 0a0a 2020 2020 2020 2020 2320 4578 6974  ..        # Exit
+00033770: 2075 6e6c 6573 7320 736f 6d65 2063 6f6c   unless some col
+00033780: 756d 6e20 6861 7665 2062 6565 6e20 666f  umn have been fo
+00033790: 726d 6174 7465 642e 0a20 2020 2020 2020  rmatted..       
+000337a0: 2069 6620 6e6f 7420 7365 6c66 2e63 6f6c   if not self.col
+000337b0: 5f69 6e66 6f3a 0a20 2020 2020 2020 2020  _info:.         
+000337c0: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
+000337d0: 2020 2073 656c 662e 5f78 6d6c 5f73 7461     self._xml_sta
+000337e0: 7274 5f74 6167 2822 636f 6c73 2229 0a0a  rt_tag("cols")..
+000337f0: 2020 2020 2020 2020 2320 5573 6520 7468          # Use th
+00033800: 6520 6669 7273 7420 656c 656d 656e 7420  e first element 
+00033810: 6f66 2074 6865 2063 6f6c 756d 6e20 696e  of the column in
+00033820: 666f 726d 6174 696f 6e20 7374 7275 6374  formation struct
+00033830: 7572 6573 2074 6f20 7365 740a 2020 2020  ures to set.    
+00033840: 2020 2020 2320 7468 6520 696e 6974 6961      # the initia
+00033850: 6c2f 7072 6576 696f 7573 2070 726f 7065  l/previous prope
+00033860: 7274 6965 732e 0a20 2020 2020 2020 2066  rties..        f
+00033870: 6972 7374 5f63 6f6c 203d 2028 736f 7274  irst_col = (sort
+00033880: 6564 2873 656c 662e 636f 6c5f 696e 666f  ed(self.col_info
+00033890: 2e6b 6579 7328 2929 295b 305d 0a20 2020  .keys()))[0].   
+000338a0: 2020 2020 206c 6173 745f 636f 6c20 3d20       last_col = 
+000338b0: 6669 7273 745f 636f 6c0a 2020 2020 2020  first_col.      
+000338c0: 2020 7072 6576 5f63 6f6c 5f6f 7074 696f    prev_col_optio
+000338d0: 6e73 203d 2073 656c 662e 636f 6c5f 696e  ns = self.col_in
+000338e0: 666f 5b66 6972 7374 5f63 6f6c 5d0a 2020  fo[first_col].  
+000338f0: 2020 2020 2020 6465 6c20 7365 6c66 2e63        del self.c
+00033900: 6f6c 5f69 6e66 6f5b 6669 7273 745f 636f  ol_info[first_co
+00033910: 6c5d 0a20 2020 2020 2020 2064 656c 6574  l].        delet
+00033920: 6564 5f63 6f6c 203d 2066 6972 7374 5f63  ed_col = first_c
+00033930: 6f6c 0a20 2020 2020 2020 2064 656c 6574  ol.        delet
+00033940: 6564 5f63 6f6c 5f6f 7074 696f 6e73 203d  ed_col_options =
+00033950: 2070 7265 765f 636f 6c5f 6f70 7469 6f6e   prev_col_option
+00033960: 730a 0a20 2020 2020 2020 2066 6f72 2063  s..        for c
+00033970: 6f6c 2069 6e20 736f 7274 6564 2873 656c  ol in sorted(sel
+00033980: 662e 636f 6c5f 696e 666f 2e6b 6579 7328  f.col_info.keys(
+00033990: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+000339a0: 636f 6c5f 6f70 7469 6f6e 7320 3d20 7365  col_options = se
+000339b0: 6c66 2e63 6f6c 5f69 6e66 6f5b 636f 6c5d  lf.col_info[col]
+000339c0: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
+000339d0: 6865 636b 2069 6620 7468 6520 636f 6c75  heck if the colu
+000339e0: 6d6e 206e 756d 6265 7220 6973 2063 6f6e  mn number is con
+000339f0: 7469 6775 6f75 7320 7769 7468 2074 6865  tiguous with the
+00033a00: 2070 7265 7669 6f75 730a 2020 2020 2020   previous.      
+00033a10: 2020 2020 2020 2320 636f 6c75 6d6e 2061        # column a
+00033a20: 6e64 2069 6620 7468 6520 7072 6f70 6572  nd if the proper
+00033a30: 7469 6573 2061 7265 2074 6865 2073 616d  ties are the sam
+00033a40: 652e 0a20 2020 2020 2020 2020 2020 2069  e..            i
+00033a50: 6620 636f 6c20 3d3d 206c 6173 745f 636f  f col == last_co
+00033a60: 6c20 2b20 3120 616e 6420 636f 6c5f 6f70  l + 1 and col_op
+00033a70: 7469 6f6e 7320 3d3d 2070 7265 765f 636f  tions == prev_co
+00033a80: 6c5f 6f70 7469 6f6e 733a 0a20 2020 2020  l_options:.     
+00033a90: 2020 2020 2020 2020 2020 206c 6173 745f             last_
+00033aa0: 636f 6c20 3d20 636f 6c0a 2020 2020 2020  col = col.      
+00033ab0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00033ac0: 2020 2020 2020 2020 2020 2020 2320 4966              # If
+00033ad0: 206e 6f74 2063 6f6e 7469 6775 6f75 732f   not contiguous/
+00033ae0: 6571 7561 6c20 7468 656e 2077 6520 7772  equal then we wr
+00033af0: 6974 6520 6f75 7420 7468 6520 6375 7272  ite out the curr
+00033b00: 656e 7420 7261 6e67 650a 2020 2020 2020  ent range.      
+00033b10: 2020 2020 2020 2020 2020 2320 6f66 2063            # of c
+00033b20: 6f6c 756d 6e73 2061 6e64 2073 7461 7274  olumns and start
+00033b30: 2061 6761 696e 2e0a 2020 2020 2020 2020   again..        
+00033b40: 2020 2020 2020 2020 7365 6c66 2e5f 7772          self._wr
+00033b50: 6974 655f 636f 6c5f 696e 666f 2866 6972  ite_col_info(fir
+00033b60: 7374 5f63 6f6c 2c20 6c61 7374 5f63 6f6c  st_col, last_col
+00033b70: 2c20 7072 6576 5f63 6f6c 5f6f 7074 696f  , prev_col_optio
+00033b80: 6e73 290a 2020 2020 2020 2020 2020 2020  ns).            
+00033b90: 2020 2020 6669 7273 745f 636f 6c20 3d20      first_col = 
+00033ba0: 636f 6c0a 2020 2020 2020 2020 2020 2020  col.            
+00033bb0: 2020 2020 6c61 7374 5f63 6f6c 203d 2066      last_col = f
+00033bc0: 6972 7374 5f63 6f6c 0a20 2020 2020 2020  irst_col.       
+00033bd0: 2020 2020 2020 2020 2070 7265 765f 636f           prev_co
+00033be0: 6c5f 6f70 7469 6f6e 7320 3d20 636f 6c5f  l_options = col_
+00033bf0: 6f70 7469 6f6e 730a 0a20 2020 2020 2020  options..       
+00033c00: 2023 2057 6520 7769 6c6c 2065 7869 7420   # We will exit 
+00033c10: 7468 6520 7072 6576 696f 7573 206c 6f6f  the previous loo
+00033c20: 7020 7769 7468 206f 6e65 2075 6e68 616e  p with one unhan
+00033c30: 646c 6564 2063 6f6c 756d 6e20 7261 6e67  dled column rang
+00033c40: 652e 0a20 2020 2020 2020 2073 656c 662e  e..        self.
+00033c50: 5f77 7269 7465 5f63 6f6c 5f69 6e66 6f28  _write_col_info(
+00033c60: 6669 7273 745f 636f 6c2c 206c 6173 745f  first_col, last_
+00033c70: 636f 6c2c 2070 7265 765f 636f 6c5f 6f70  col, prev_col_op
+00033c80: 7469 6f6e 7329 0a0a 2020 2020 2020 2020  tions)..        
+00033c90: 2320 5075 7420 6261 636b 2074 6865 2064  # Put back the d
+00033ca0: 656c 6574 6564 2066 6972 7374 2063 6f6c  eleted first col
+00033cb0: 756d 6e20 696e 666f 726d 6174 696f 6e20  umn information 
+00033cc0: 7374 7275 6374 7572 652e 0a20 2020 2020  structure..     
+00033cd0: 2020 2073 656c 662e 636f 6c5f 696e 666f     self.col_info
+00033ce0: 5b64 656c 6574 6564 5f63 6f6c 5d20 3d20  [deleted_col] = 
+00033cf0: 6465 6c65 7465 645f 636f 6c5f 6f70 7469  deleted_col_opti
+00033d00: 6f6e 730a 0a20 2020 2020 2020 2073 656c  ons..        sel
+00033d10: 662e 5f78 6d6c 5f65 6e64 5f74 6167 2822  f._xml_end_tag("
+00033d20: 636f 6c73 2229 0a0a 2020 2020 6465 6620  cols")..    def 
+00033d30: 5f77 7269 7465 5f63 6f6c 5f69 6e66 6f28  _write_col_info(
+00033d40: 7365 6c66 2c20 636f 6c5f 6d69 6e2c 2063  self, col_min, c
+00033d50: 6f6c 5f6d 6178 2c20 636f 6c5f 696e 666f  ol_max, col_info
+00033d60: 293a 0a20 2020 2020 2020 2023 2057 7269  ):.        # Wri
+00033d70: 7465 2074 6865 203c 636f 6c3e 2065 6c65  te the <col> ele
+00033d80: 6d65 6e74 2e0a 2020 2020 2020 2020 2877  ment..        (w
+00033d90: 6964 7468 2c20 6365 6c6c 5f66 6f72 6d61  idth, cell_forma
+00033da0: 742c 2068 6964 6465 6e2c 206c 6576 656c  t, hidden, level
+00033db0: 2c20 636f 6c6c 6170 7365 642c 2061 7574  , collapsed, aut
+00033dc0: 6f66 6974 2920 3d20 636f 6c5f 696e 666f  ofit) = col_info
+00033dd0: 0a0a 2020 2020 2020 2020 6375 7374 6f6d  ..        custom
+00033de0: 5f77 6964 7468 203d 2031 0a20 2020 2020  _width = 1.     
+00033df0: 2020 2078 665f 696e 6465 7820 3d20 300a     xf_index = 0.
+00033e00: 0a20 2020 2020 2020 2023 2047 6574 2074  .        # Get t
+00033e10: 6865 2063 656c 6c5f 666f 726d 6174 2069  he cell_format i
+00033e20: 6e64 6578 2e0a 2020 2020 2020 2020 6966  ndex..        if
+00033e30: 2063 656c 6c5f 666f 726d 6174 3a0a 2020   cell_format:.  
+00033e40: 2020 2020 2020 2020 2020 7866 5f69 6e64            xf_ind
+00033e50: 6578 203d 2063 656c 6c5f 666f 726d 6174  ex = cell_format
+00033e60: 2e5f 6765 745f 7866 5f69 6e64 6578 2829  ._get_xf_index()
+00033e70: 0a0a 2020 2020 2020 2020 2320 5365 7420  ..        # Set 
+00033e80: 7468 6520 4578 6365 6c20 6465 6661 756c  the Excel defaul
+00033e90: 7420 636f 6c75 6d6e 2077 6964 7468 2e0a  t column width..
+00033ea0: 2020 2020 2020 2020 6966 2077 6964 7468          if width
+00033eb0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00033ec0: 2020 2020 2020 6966 206e 6f74 2068 6964        if not hid
+00033ed0: 6465 6e3a 0a20 2020 2020 2020 2020 2020  den:.           
+00033ee0: 2020 2020 2077 6964 7468 203d 2038 2e34       width = 8.4
+00033ef0: 330a 2020 2020 2020 2020 2020 2020 2020  3.              
+00033f00: 2020 6375 7374 6f6d 5f77 6964 7468 203d    custom_width =
+00033f10: 2030 0a20 2020 2020 2020 2020 2020 2065   0.            e
+00033f20: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00033f30: 2020 2020 2077 6964 7468 203d 2030 0a20       width = 0. 
+00033f40: 2020 2020 2020 2065 6c69 6620 7769 6474         elif widt
+00033f50: 6820 3d3d 2038 2e34 333a 0a20 2020 2020  h == 8.43:.     
+00033f60: 2020 2020 2020 2023 2057 6964 7468 2069         # Width i
+00033f70: 7320 6465 6669 6e65 6420 6275 7420 7361  s defined but sa
+00033f80: 6d65 2061 7320 6465 6661 756c 742e 0a20  me as default.. 
+00033f90: 2020 2020 2020 2020 2020 2063 7573 746f             custo
+00033fa0: 6d5f 7769 6474 6820 3d20 300a 0a20 2020  m_width = 0..   
+00033fb0: 2020 2020 2023 2043 6f6e 7665 7274 2063       # Convert c
+00033fc0: 6f6c 756d 6e20 7769 6474 6820 6672 6f6d  olumn width from
+00033fd0: 2075 7365 7220 756e 6974 7320 746f 2063   user units to c
+00033fe0: 6861 7261 6374 6572 2077 6964 7468 2e0a  haracter width..
+00033ff0: 2020 2020 2020 2020 6966 2077 6964 7468          if width
+00034000: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
+00034010: 2020 2320 466f 7220 4361 6c61 6272 6920    # For Calabri 
+00034020: 3131 2e0a 2020 2020 2020 2020 2020 2020  11..            
+00034030: 6d61 785f 6469 6769 745f 7769 6474 6820  max_digit_width 
+00034040: 3d20 370a 2020 2020 2020 2020 2020 2020  = 7.            
+00034050: 7061 6464 696e 6720 3d20 350a 0a20 2020  padding = 5..   
+00034060: 2020 2020 2020 2020 2069 6620 7769 6474           if widt
+00034070: 6820 3c20 313a 0a20 2020 2020 2020 2020  h < 1:.         
+00034080: 2020 2020 2020 2077 6964 7468 203d 2028         width = (
+00034090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000340a0: 2020 2020 2069 6e74 280a 2020 2020 2020       int(.      
+000340b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000340c0: 2020 2869 6e74 2877 6964 7468 202a 2028    (int(width * (
+000340d0: 6d61 785f 6469 6769 745f 7769 6474 6820  max_digit_width 
+000340e0: 2b20 7061 6464 696e 6729 202b 2030 2e35  + padding) + 0.5
+000340f0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+00034100: 2020 2020 2020 2020 2020 202f 2066 6c6f             / flo
+00034110: 6174 286d 6178 5f64 6967 6974 5f77 6964  at(max_digit_wid
+00034120: 7468 290a 2020 2020 2020 2020 2020 2020  th).            
+00034130: 2020 2020 2020 2020 2020 2020 2a20 3235              * 25
+00034140: 362e 300a 2020 2020 2020 2020 2020 2020  6.0.            
+00034150: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00034160: 2020 2020 2020 2020 2020 2020 2020 2f20                / 
+00034170: 3235 362e 300a 2020 2020 2020 2020 2020  256.0.          
+00034180: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00034190: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000341a0: 2020 2020 2020 2020 2020 7769 6474 6820            width 
+000341b0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+000341c0: 2020 2020 2020 2020 696e 7428 0a20 2020          int(.   
+000341d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000341e0: 2020 2020 2028 696e 7428 7769 6474 6820       (int(width 
+000341f0: 2a20 6d61 785f 6469 6769 745f 7769 6474  * max_digit_widt
+00034200: 6820 2b20 302e 3529 202b 2070 6164 6469  h + 0.5) + paddi
+00034210: 6e67 290a 2020 2020 2020 2020 2020 2020  ng).            
+00034220: 2020 2020 2020 2020 2020 2020 2f20 666c              / fl
+00034230: 6f61 7428 6d61 785f 6469 6769 745f 7769  oat(max_digit_wi
+00034240: 6474 6829 0a20 2020 2020 2020 2020 2020  dth).           
+00034250: 2020 2020 2020 2020 2020 2020 202a 2032               * 2
+00034260: 3536 2e30 0a20 2020 2020 2020 2020 2020  56.0.           
+00034270: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00034280: 2020 2020 2020 2020 2020 2020 2020 202f                 /
+00034290: 2032 3536 2e30 0a20 2020 2020 2020 2020   256.0.         
+000342a0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+000342b0: 2020 6174 7472 6962 7574 6573 203d 205b    attributes = [
+000342c0: 0a20 2020 2020 2020 2020 2020 2028 226d  .            ("m
+000342d0: 696e 222c 2063 6f6c 5f6d 696e 202b 2031  in", col_min + 1
+000342e0: 292c 0a20 2020 2020 2020 2020 2020 2028  ),.            (
+000342f0: 226d 6178 222c 2063 6f6c 5f6d 6178 202b  "max", col_max +
+00034300: 2031 292c 0a20 2020 2020 2020 2020 2020   1),.           
+00034310: 2028 2277 6964 7468 222c 2022 252e 3136   ("width", "%.16
+00034320: 6722 2025 2077 6964 7468 292c 0a20 2020  g" % width),.   
+00034330: 2020 2020 205d 0a0a 2020 2020 2020 2020       ]..        
+00034340: 6966 2078 665f 696e 6465 783a 0a20 2020  if xf_index:.   
+00034350: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+00034360: 7465 732e 6170 7065 6e64 2828 2273 7479  tes.append(("sty
+00034370: 6c65 222c 2078 665f 696e 6465 7829 290a  le", xf_index)).
+00034380: 2020 2020 2020 2020 6966 2068 6964 6465          if hidde
+00034390: 6e3a 0a20 2020 2020 2020 2020 2020 2061  n:.            a
+000343a0: 7474 7269 6275 7465 732e 6170 7065 6e64  ttributes.append
+000343b0: 2828 2268 6964 6465 6e22 2c20 2231 2229  (("hidden", "1")
+000343c0: 290a 2020 2020 2020 2020 6966 2061 7574  ).        if aut
+000343d0: 6f66 6974 3a0a 2020 2020 2020 2020 2020  ofit:.          
+000343e0: 2020 6174 7472 6962 7574 6573 2e61 7070    attributes.app
+000343f0: 656e 6428 2822 6265 7374 4669 7422 2c20  end(("bestFit", 
+00034400: 2231 2229 290a 2020 2020 2020 2020 6966  "1")).        if
+00034410: 2063 7573 746f 6d5f 7769 6474 683a 0a20   custom_width:. 
+00034420: 2020 2020 2020 2020 2020 2061 7474 7269             attri
+00034430: 6275 7465 732e 6170 7065 6e64 2828 2263  butes.append(("c
+00034440: 7573 746f 6d57 6964 7468 222c 2022 3122  ustomWidth", "1"
+00034450: 2929 0a20 2020 2020 2020 2069 6620 6c65  )).        if le
+00034460: 7665 6c3a 0a20 2020 2020 2020 2020 2020  vel:.           
+00034470: 2061 7474 7269 6275 7465 732e 6170 7065   attributes.appe
+00034480: 6e64 2828 226f 7574 6c69 6e65 4c65 7665  nd(("outlineLeve
+00034490: 6c22 2c20 6c65 7665 6c29 290a 2020 2020  l", level)).    
+000344a0: 2020 2020 6966 2063 6f6c 6c61 7073 6564      if collapsed
+000344b0: 3a0a 2020 2020 2020 2020 2020 2020 6174  :.            at
+000344c0: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
+000344d0: 2822 636f 6c6c 6170 7365 6422 2c20 2231  ("collapsed", "1
+000344e0: 2229 290a 0a20 2020 2020 2020 2073 656c  "))..        sel
+000344f0: 662e 5f78 6d6c 5f65 6d70 7479 5f74 6167  f._xml_empty_tag
+00034500: 2822 636f 6c22 2c20 6174 7472 6962 7574  ("col", attribut
+00034510: 6573 290a 0a20 2020 2064 6566 205f 7772  es)..    def _wr
+00034520: 6974 655f 7368 6565 745f 6461 7461 2873  ite_sheet_data(s
+00034530: 656c 6629 3a0a 2020 2020 2020 2020 2320  elf):.        # 
+00034540: 5772 6974 6520 7468 6520 3c73 6865 6574  Write the <sheet
+00034550: 4461 7461 3e20 656c 656d 656e 742e 0a0a  Data> element...
+00034560: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00034570: 6469 6d5f 726f 776d 696e 2069 7320 4e6f  dim_rowmin is No
+00034580: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00034590: 2320 4966 2074 6865 2064 696d 656e 7369  # If the dimensi
+000345a0: 6f6e 7320 6172 656e 2774 2064 6566 696e  ons aren't defin
+000345b0: 6564 2074 6865 7265 2069 7320 6e6f 2064  ed there is no d
+000345c0: 6174 6120 746f 2077 7269 7465 2e0a 2020  ata to write..  
+000345d0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+000345e0: 786d 6c5f 656d 7074 795f 7461 6728 2273  xml_empty_tag("s
+000345f0: 6865 6574 4461 7461 2229 0a20 2020 2020  heetData").     
+00034600: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00034610: 2020 2020 2073 656c 662e 5f78 6d6c 5f73       self._xml_s
+00034620: 7461 7274 5f74 6167 2822 7368 6565 7444  tart_tag("sheetD
+00034630: 6174 6122 290a 2020 2020 2020 2020 2020  ata").          
+00034640: 2020 7365 6c66 2e5f 7772 6974 655f 726f    self._write_ro
+00034650: 7773 2829 0a20 2020 2020 2020 2020 2020  ws().           
+00034660: 2073 656c 662e 5f78 6d6c 5f65 6e64 5f74   self._xml_end_t
+00034670: 6167 2822 7368 6565 7444 6174 6122 290a  ag("sheetData").
+00034680: 0a20 2020 2064 6566 205f 7772 6974 655f  .    def _write_
+00034690: 6f70 7469 6d69 7a65 645f 7368 6565 745f  optimized_sheet_
+000346a0: 6461 7461 2873 656c 6629 3a0a 2020 2020  data(self):.    
+000346b0: 2020 2020 2320 5772 6974 6520 7468 6520      # Write the 
+000346c0: 3c73 6865 6574 4461 7461 3e20 656c 656d  <sheetData> elem
+000346d0: 656e 7420 7768 656e 2063 6f6e 7374 616e  ent when constan
+000346e0: 745f 6d65 6d6f 7279 2069 7320 6f6e 2e20  t_memory is on. 
+000346f0: 496e 2074 6869 730a 2020 2020 2020 2020  In this.        
+00034700: 2320 6361 7365 2077 6520 7265 6164 2074  # case we read t
+00034710: 6865 2064 6174 6120 7374 6f72 6564 2069  he data stored i
+00034720: 6e20 7468 6520 7465 6d70 2066 696c 6520  n the temp file 
+00034730: 616e 6420 7265 7772 6974 6520 6974 2074  and rewrite it t
+00034740: 6f20 7468 650a 2020 2020 2020 2020 2320  o the.        # 
+00034750: 584d 4c20 7368 6565 7420 6669 6c65 2e0a  XML sheet file..
+00034760: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00034770: 6469 6d5f 726f 776d 696e 2069 7320 4e6f  dim_rowmin is No
+00034780: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00034790: 2320 4966 2074 6865 2064 696d 656e 7369  # If the dimensi
+000347a0: 6f6e 7320 6172 656e 2774 2064 6566 696e  ons aren't defin
+000347b0: 6564 2074 6865 6e20 7468 6572 6520 6973  ed then there is
+000347c0: 206e 6f20 6461 7461 2074 6f20 7772 6974   no data to writ
+000347d0: 652e 0a20 2020 2020 2020 2020 2020 2073  e..            s
+000347e0: 656c 662e 5f78 6d6c 5f65 6d70 7479 5f74  elf._xml_empty_t
+000347f0: 6167 2822 7368 6565 7444 6174 6122 290a  ag("sheetData").
+00034800: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00034810: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00034820: 786d 6c5f 7374 6172 745f 7461 6728 2273  xml_start_tag("s
+00034830: 6865 6574 4461 7461 2229 0a0a 2020 2020  heetData")..    
+00034840: 2020 2020 2020 2020 2320 5265 7769 6e64          # Rewind
+00034850: 2074 6865 2066 696c 6568 616e 646c 6520   the filehandle 
+00034860: 7468 6174 2077 6173 2075 7365 6420 666f  that was used fo
+00034870: 7220 7465 6d70 2072 6f77 2064 6174 612e  r temp row data.
+00034880: 0a20 2020 2020 2020 2020 2020 2062 7566  .            buf
+00034890: 665f 7369 7a65 203d 2036 3535 3336 0a20  f_size = 65536. 
+000348a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000348b0: 726f 775f 6461 7461 5f66 682e 7365 656b  row_data_fh.seek
+000348c0: 2830 290a 2020 2020 2020 2020 2020 2020  (0).            
+000348d0: 6461 7461 203d 2073 656c 662e 726f 775f  data = self.row_
+000348e0: 6461 7461 5f66 682e 7265 6164 2862 7566  data_fh.read(buf
+000348f0: 665f 7369 7a65 290a 0a20 2020 2020 2020  f_size)..       
+00034900: 2020 2020 2077 6869 6c65 2064 6174 613a       while data:
+00034910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034920: 2073 656c 662e 6668 2e77 7269 7465 2864   self.fh.write(d
+00034930: 6174 6129 0a20 2020 2020 2020 2020 2020  ata).           
+00034940: 2020 2020 2064 6174 6120 3d20 7365 6c66       data = self
+00034950: 2e72 6f77 5f64 6174 615f 6668 2e72 6561  .row_data_fh.rea
+00034960: 6428 6275 6666 5f73 697a 6529 0a0a 2020  d(buff_size)..  
+00034970: 2020 2020 2020 2020 2020 7365 6c66 2e72            self.r
+00034980: 6f77 5f64 6174 615f 6668 2e63 6c6f 7365  ow_data_fh.close
+00034990: 2829 0a20 2020 2020 2020 2020 2020 206f  ().            o
+000349a0: 732e 756e 6c69 6e6b 2873 656c 662e 726f  s.unlink(self.ro
+000349b0: 775f 6461 7461 5f66 696c 656e 616d 6529  w_data_filename)
+000349c0: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+000349d0: 6c66 2e5f 786d 6c5f 656e 645f 7461 6728  lf._xml_end_tag(
+000349e0: 2273 6865 6574 4461 7461 2229 0a0a 2020  "sheetData")..  
+000349f0: 2020 6465 6620 5f77 7269 7465 5f70 6167    def _write_pag
+00034a00: 655f 6d61 7267 696e 7328 7365 6c66 293a  e_margins(self):
+00034a10: 0a20 2020 2020 2020 2023 2057 7269 7465  .        # Write
+00034a20: 2074 6865 203c 7061 6765 4d61 7267 696e   the <pageMargin
+00034a30: 733e 2065 6c65 6d65 6e74 2e0a 2020 2020  s> element..    
+00034a40: 2020 2020 6174 7472 6962 7574 6573 203d      attributes =
+00034a50: 205b 0a20 2020 2020 2020 2020 2020 2028   [.            (
+00034a60: 226c 6566 7422 2c20 7365 6c66 2e6d 6172  "left", self.mar
+00034a70: 6769 6e5f 6c65 6674 292c 0a20 2020 2020  gin_left),.     
+00034a80: 2020 2020 2020 2028 2272 6967 6874 222c         ("right",
+00034a90: 2073 656c 662e 6d61 7267 696e 5f72 6967   self.margin_rig
+00034aa0: 6874 292c 0a20 2020 2020 2020 2020 2020  ht),.           
+00034ab0: 2028 2274 6f70 222c 2073 656c 662e 6d61   ("top", self.ma
+00034ac0: 7267 696e 5f74 6f70 292c 0a20 2020 2020  rgin_top),.     
+00034ad0: 2020 2020 2020 2028 2262 6f74 746f 6d22         ("bottom"
+00034ae0: 2c20 7365 6c66 2e6d 6172 6769 6e5f 626f  , self.margin_bo
+00034af0: 7474 6f6d 292c 0a20 2020 2020 2020 2020  ttom),.         
+00034b00: 2020 2028 2268 6561 6465 7222 2c20 7365     ("header", se
+00034b10: 6c66 2e6d 6172 6769 6e5f 6865 6164 6572  lf.margin_header
+00034b20: 292c 0a20 2020 2020 2020 2020 2020 2028  ),.            (
+00034b30: 2266 6f6f 7465 7222 2c20 7365 6c66 2e6d  "footer", self.m
+00034b40: 6172 6769 6e5f 666f 6f74 6572 292c 0a20  argin_footer),. 
+00034b50: 2020 2020 2020 205d 0a0a 2020 2020 2020         ]..      
+00034b60: 2020 7365 6c66 2e5f 786d 6c5f 656d 7074    self._xml_empt
+00034b70: 795f 7461 6728 2270 6167 654d 6172 6769  y_tag("pageMargi
+00034b80: 6e73 222c 2061 7474 7269 6275 7465 7329  ns", attributes)
+00034b90: 0a0a 2020 2020 6465 6620 5f77 7269 7465  ..    def _write
+00034ba0: 5f70 6167 655f 7365 7475 7028 7365 6c66  _page_setup(self
+00034bb0: 293a 0a20 2020 2020 2020 2023 2057 7269  ):.        # Wri
+00034bc0: 7465 2074 6865 203c 7061 6765 5365 7475  te the <pageSetu
+00034bd0: 703e 2065 6c65 6d65 6e74 2e0a 2020 2020  p> element..    
+00034be0: 2020 2020 230a 2020 2020 2020 2020 2320      #.        # 
+00034bf0: 5468 6520 666f 6c6c 6f77 696e 6720 6973  The following is
+00034c00: 2061 6e20 6578 616d 706c 6520 7461 6b65   an example take
+00034c10: 6e20 6672 6f6d 2045 7863 656c 2e0a 2020  n from Excel..  
+00034c20: 2020 2020 2020 230a 2020 2020 2020 2020        #.        
+00034c30: 2320 3c70 6167 6553 6574 7570 0a20 2020  # <pageSetup.   
+00034c40: 2020 2020 2023 2020 2020 2070 6170 6572       #     paper
+00034c50: 5369 7a65 3d22 3922 0a20 2020 2020 2020  Size="9".       
+00034c60: 2023 2020 2020 2073 6361 6c65 3d22 3131   #     scale="11
+00034c70: 3022 0a20 2020 2020 2020 2023 2020 2020  0".        #    
+00034c80: 2066 6974 546f 5769 6474 683d 2232 220a   fitToWidth="2".
+00034c90: 2020 2020 2020 2020 2320 2020 2020 6669          #     fi
+00034ca0: 7454 6f48 6569 6768 743d 2232 220a 2020  tToHeight="2".  
+00034cb0: 2020 2020 2020 2320 2020 2020 7061 6765        #     page
+00034cc0: 4f72 6465 723d 226f 7665 7254 6865 6e44  Order="overThenD
+00034cd0: 6f77 6e22 0a20 2020 2020 2020 2023 2020  own".        #  
+00034ce0: 2020 206f 7269 656e 7461 7469 6f6e 3d22     orientation="
+00034cf0: 706f 7274 7261 6974 220a 2020 2020 2020  portrait".      
+00034d00: 2020 2320 2020 2020 626c 6163 6b41 6e64    #     blackAnd
+00034d10: 5768 6974 653d 2231 220a 2020 2020 2020  White="1".      
+00034d20: 2020 2320 2020 2020 6472 6166 743d 2231    #     draft="1
+00034d30: 220a 2020 2020 2020 2020 2320 2020 2020  ".        #     
+00034d40: 686f 7269 7a6f 6e74 616c 4470 693d 2232  horizontalDpi="2
+00034d50: 3030 220a 2020 2020 2020 2020 2320 2020  00".        #   
+00034d60: 2020 7665 7274 6963 616c 4470 693d 2232    verticalDpi="2
+00034d70: 3030 220a 2020 2020 2020 2020 2320 2020  00".        #   
+00034d80: 2020 723a 6964 3d22 7249 6431 220a 2020    r:id="rId1".  
+00034d90: 2020 2020 2020 2320 2f3e 0a20 2020 2020        # />.     
+00034da0: 2020 2023 0a20 2020 2020 2020 2061 7474     #.        att
+00034db0: 7269 6275 7465 7320 3d20 5b5d 0a0a 2020  ributes = []..  
+00034dc0: 2020 2020 2020 2320 536b 6970 2074 6869        # Skip thi
+00034dd0: 7320 656c 656d 656e 7420 6966 206e 6f20  s element if no 
+00034de0: 7061 6765 2073 6574 7570 2068 6173 2063  page setup has c
+00034df0: 6861 6e67 6564 2e0a 2020 2020 2020 2020  hanged..        
+00034e00: 6966 206e 6f74 2073 656c 662e 7061 6765  if not self.page
+00034e10: 5f73 6574 7570 5f63 6861 6e67 6564 3a0a  _setup_changed:.
+00034e20: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00034e30: 726e 0a0a 2020 2020 2020 2020 2320 5365  rn..        # Se
+00034e40: 7420 7061 7065 7220 7369 7a65 2e0a 2020  t paper size..  
+00034e50: 2020 2020 2020 6966 2073 656c 662e 7061        if self.pa
+00034e60: 7065 725f 7369 7a65 3a0a 2020 2020 2020  per_size:.      
+00034e70: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
+00034e80: 2e61 7070 656e 6428 2822 7061 7065 7253  .append(("paperS
+00034e90: 697a 6522 2c20 7365 6c66 2e70 6170 6572  ize", self.paper
+00034ea0: 5f73 697a 6529 290a 0a20 2020 2020 2020  _size))..       
+00034eb0: 2023 2053 6574 2074 6865 2070 7269 6e74   # Set the print
+00034ec0: 5f73 6361 6c65 2e0a 2020 2020 2020 2020  _scale..        
+00034ed0: 6966 2073 656c 662e 7072 696e 745f 7363  if self.print_sc
+00034ee0: 616c 6520 213d 2031 3030 3a0a 2020 2020  ale != 100:.    
+00034ef0: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
+00034f00: 6573 2e61 7070 656e 6428 2822 7363 616c  es.append(("scal
+00034f10: 6522 2c20 7365 6c66 2e70 7269 6e74 5f73  e", self.print_s
+00034f20: 6361 6c65 2929 0a0a 2020 2020 2020 2020  cale))..        
+00034f30: 2320 5365 7420 7468 6520 2246 6974 2074  # Set the "Fit t
+00034f40: 6f20 7061 6765 2220 7072 6f70 6572 7469  o page" properti
+00034f50: 6573 2e0a 2020 2020 2020 2020 6966 2073  es..        if s
+00034f60: 656c 662e 6669 745f 7061 6765 2061 6e64  elf.fit_page and
+00034f70: 2073 656c 662e 6669 745f 7769 6474 6820   self.fit_width 
+00034f80: 213d 2031 3a0a 2020 2020 2020 2020 2020  != 1:.          
+00034f90: 2020 6174 7472 6962 7574 6573 2e61 7070    attributes.app
+00034fa0: 656e 6428 2822 6669 7454 6f57 6964 7468  end(("fitToWidth
+00034fb0: 222c 2073 656c 662e 6669 745f 7769 6474  ", self.fit_widt
+00034fc0: 6829 290a 0a20 2020 2020 2020 2069 6620  h))..        if 
+00034fd0: 7365 6c66 2e66 6974 5f70 6167 6520 616e  self.fit_page an
+00034fe0: 6420 7365 6c66 2e66 6974 5f68 6569 6768  d self.fit_heigh
+00034ff0: 7420 213d 2031 3a0a 2020 2020 2020 2020  t != 1:.        
+00035000: 2020 2020 6174 7472 6962 7574 6573 2e61      attributes.a
+00035010: 7070 656e 6428 2822 6669 7454 6f48 6569  ppend(("fitToHei
+00035020: 6768 7422 2c20 7365 6c66 2e66 6974 5f68  ght", self.fit_h
+00035030: 6569 6768 7429 290a 0a20 2020 2020 2020  eight))..       
+00035040: 2023 2053 6574 2074 6865 2070 6167 6520   # Set the page 
+00035050: 7072 696e 7420 6469 7265 6374 696f 6e2e  print direction.
+00035060: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00035070: 2e70 6167 655f 6f72 6465 723a 0a20 2020  .page_order:.   
+00035080: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+00035090: 7465 732e 6170 7065 6e64 2828 2270 6167  tes.append(("pag
+000350a0: 654f 7264 6572 222c 2022 6f76 6572 5468  eOrder", "overTh
+000350b0: 656e 446f 776e 2229 290a 0a20 2020 2020  enDown"))..     
+000350c0: 2020 2023 2053 6574 2073 7461 7274 2070     # Set start p
+000350d0: 6167 6520 666f 7220 7072 696e 7469 6e67  age for printing
+000350e0: 2e0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+000350f0: 662e 7061 6765 5f73 7461 7274 203e 2031  f.page_start > 1
+00035100: 3a0a 2020 2020 2020 2020 2020 2020 6174  :.            at
+00035110: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
+00035120: 2822 6669 7273 7450 6167 654e 756d 6265  ("firstPageNumbe
+00035130: 7222 2c20 7365 6c66 2e70 6167 655f 7374  r", self.page_st
+00035140: 6172 7429 290a 0a20 2020 2020 2020 2023  art))..        #
+00035150: 2053 6574 2070 6167 6520 6f72 6965 6e74   Set page orient
+00035160: 6174 696f 6e2e 0a20 2020 2020 2020 2069  ation..        i
+00035170: 6620 7365 6c66 2e6f 7269 656e 7461 7469  f self.orientati
+00035180: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
+00035190: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
+000351a0: 6428 2822 6f72 6965 6e74 6174 696f 6e22  d(("orientation"
+000351b0: 2c20 2270 6f72 7472 6169 7422 2929 0a20  , "portrait")). 
+000351c0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000351d0: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+000351e0: 7465 732e 6170 7065 6e64 2828 226f 7269  tes.append(("ori
+000351f0: 656e 7461 7469 6f6e 222c 2022 6c61 6e64  entation", "land
+00035200: 7363 6170 6522 2929 0a0a 2020 2020 2020  scape"))..      
+00035210: 2020 2320 5365 7420 7468 6520 7072 696e    # Set the prin
+00035220: 7420 696e 2062 6c61 636b 2061 6e64 2077  t in black and w
+00035230: 6869 7465 206f 7074 696f 6e2e 0a20 2020  hite option..   
+00035240: 2020 2020 2069 6620 7365 6c66 2e62 6c61       if self.bla
+00035250: 636b 5f77 6869 7465 3a0a 2020 2020 2020  ck_white:.      
 00035260: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-00035270: 2e61 7070 656e 6428 2827 7061 7065 7253  .append(('paperS
-00035280: 697a 6527 2c20 7365 6c66 2e70 6170 6572  ize', self.paper
-00035290: 5f73 697a 6529 290a 0a20 2020 2020 2020  _size))..       
-000352a0: 2023 2053 6574 2074 6865 2070 7269 6e74   # Set the print
-000352b0: 5f73 6361 6c65 2e0a 2020 2020 2020 2020  _scale..        
-000352c0: 6966 2073 656c 662e 7072 696e 745f 7363  if self.print_sc
-000352d0: 616c 6520 213d 2031 3030 3a0a 2020 2020  ale != 100:.    
-000352e0: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
-000352f0: 6573 2e61 7070 656e 6428 2827 7363 616c  es.append(('scal
-00035300: 6527 2c20 7365 6c66 2e70 7269 6e74 5f73  e', self.print_s
-00035310: 6361 6c65 2929 0a0a 2020 2020 2020 2020  cale))..        
-00035320: 2320 5365 7420 7468 6520 2246 6974 2074  # Set the "Fit t
-00035330: 6f20 7061 6765 2220 7072 6f70 6572 7469  o page" properti
-00035340: 6573 2e0a 2020 2020 2020 2020 6966 2073  es..        if s
-00035350: 656c 662e 6669 745f 7061 6765 2061 6e64  elf.fit_page and
-00035360: 2073 656c 662e 6669 745f 7769 6474 6820   self.fit_width 
-00035370: 213d 2031 3a0a 2020 2020 2020 2020 2020  != 1:.          
-00035380: 2020 6174 7472 6962 7574 6573 2e61 7070    attributes.app
-00035390: 656e 6428 2827 6669 7454 6f57 6964 7468  end(('fitToWidth
-000353a0: 272c 2073 656c 662e 6669 745f 7769 6474  ', self.fit_widt
-000353b0: 6829 290a 0a20 2020 2020 2020 2069 6620  h))..        if 
-000353c0: 7365 6c66 2e66 6974 5f70 6167 6520 616e  self.fit_page an
-000353d0: 6420 7365 6c66 2e66 6974 5f68 6569 6768  d self.fit_heigh
-000353e0: 7420 213d 2031 3a0a 2020 2020 2020 2020  t != 1:.        
-000353f0: 2020 2020 6174 7472 6962 7574 6573 2e61      attributes.a
-00035400: 7070 656e 6428 2827 6669 7454 6f48 6569  ppend(('fitToHei
-00035410: 6768 7427 2c20 7365 6c66 2e66 6974 5f68  ght', self.fit_h
-00035420: 6569 6768 7429 290a 0a20 2020 2020 2020  eight))..       
-00035430: 2023 2053 6574 2074 6865 2070 6167 6520   # Set the page 
-00035440: 7072 696e 7420 6469 7265 6374 696f 6e2e  print direction.
-00035450: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00035460: 2e70 6167 655f 6f72 6465 723a 0a20 2020  .page_order:.   
-00035470: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
-00035480: 7465 732e 6170 7065 6e64 2828 2770 6167  tes.append(('pag
-00035490: 654f 7264 6572 272c 2022 6f76 6572 5468  eOrder', "overTh
-000354a0: 656e 446f 776e 2229 290a 0a20 2020 2020  enDown"))..     
-000354b0: 2020 2023 2053 6574 2073 7461 7274 2070     # Set start p
-000354c0: 6167 6520 666f 7220 7072 696e 7469 6e67  age for printing
-000354d0: 2e0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-000354e0: 662e 7061 6765 5f73 7461 7274 203e 2031  f.page_start > 1
-000354f0: 3a0a 2020 2020 2020 2020 2020 2020 6174  :.            at
-00035500: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
-00035510: 2827 6669 7273 7450 6167 654e 756d 6265  ('firstPageNumbe
-00035520: 7227 2c20 7365 6c66 2e70 6167 655f 7374  r', self.page_st
-00035530: 6172 7429 290a 0a20 2020 2020 2020 2023  art))..        #
-00035540: 2053 6574 2070 6167 6520 6f72 6965 6e74   Set page orient
-00035550: 6174 696f 6e2e 0a20 2020 2020 2020 2069  ation..        i
-00035560: 6620 7365 6c66 2e6f 7269 656e 7461 7469  f self.orientati
-00035570: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
-00035580: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
-00035590: 6428 2827 6f72 6965 6e74 6174 696f 6e27  d(('orientation'
-000355a0: 2c20 2770 6f72 7472 6169 7427 2929 0a20  , 'portrait')). 
-000355b0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000355c0: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
-000355d0: 7465 732e 6170 7065 6e64 2828 276f 7269  tes.append(('ori
-000355e0: 656e 7461 7469 6f6e 272c 2027 6c61 6e64  entation', 'land
-000355f0: 7363 6170 6527 2929 0a0a 2020 2020 2020  scape'))..      
-00035600: 2020 2320 5365 7420 7468 6520 7072 696e    # Set the prin
-00035610: 7420 696e 2062 6c61 636b 2061 6e64 2077  t in black and w
-00035620: 6869 7465 206f 7074 696f 6e2e 0a20 2020  hite option..   
-00035630: 2020 2020 2069 6620 7365 6c66 2e62 6c61       if self.bla
-00035640: 636b 5f77 6869 7465 3a0a 2020 2020 2020  ck_white:.      
-00035650: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-00035660: 2e61 7070 656e 6428 2827 626c 6163 6b41  .append(('blackA
-00035670: 6e64 5768 6974 6527 2c20 2731 2729 290a  ndWhite', '1')).
-00035680: 0a20 2020 2020 2020 2023 2053 6574 2073  .        # Set s
-00035690: 7461 7274 2070 6167 6520 666f 7220 7072  tart page for pr
-000356a0: 696e 7469 6e67 2e0a 2020 2020 2020 2020  inting..        
-000356b0: 6966 2073 656c 662e 7061 6765 5f73 7461  if self.page_sta
-000356c0: 7274 2021 3d20 303a 0a20 2020 2020 2020  rt != 0:.       
-000356d0: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
-000356e0: 6170 7065 6e64 2828 2775 7365 4669 7273  append(('useFirs
-000356f0: 7450 6167 654e 756d 6265 7227 2c20 2731  tPageNumber', '1
-00035700: 2729 290a 0a20 2020 2020 2020 2023 2053  '))..        # S
-00035710: 6574 2074 6865 2044 5049 2e20 4d61 696e  et the DPI. Main
-00035720: 6c79 206f 6e6c 7920 666f 7220 7465 7374  ly only for test
-00035730: 696e 672e 0a20 2020 2020 2020 2069 6620  ing..        if 
-00035740: 7365 6c66 2e69 735f 6368 6172 7473 6865  self.is_chartshe
-00035750: 6574 3a0a 2020 2020 2020 2020 2020 2020  et:.            
-00035760: 6966 2073 656c 662e 686f 7269 7a6f 6e74  if self.horizont
-00035770: 616c 5f64 7069 3a0a 2020 2020 2020 2020  al_dpi:.        
-00035780: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
-00035790: 6573 2e61 7070 656e 6428 2827 686f 7269  es.append(('hori
-000357a0: 7a6f 6e74 616c 4470 6927 2c20 7365 6c66  zontalDpi', self
-000357b0: 2e68 6f72 697a 6f6e 7461 6c5f 6470 6929  .horizontal_dpi)
-000357c0: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
-000357d0: 6620 7365 6c66 2e76 6572 7469 6361 6c5f  f self.vertical_
-000357e0: 6470 693a 0a20 2020 2020 2020 2020 2020  dpi:.           
-000357f0: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
-00035800: 6170 7065 6e64 2828 2776 6572 7469 6361  append(('vertica
-00035810: 6c44 7069 272c 2073 656c 662e 7665 7274  lDpi', self.vert
-00035820: 6963 616c 5f64 7069 2929 0a20 2020 2020  ical_dpi)).     
-00035830: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00035840: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
-00035850: 7469 6361 6c5f 6470 693a 0a20 2020 2020  tical_dpi:.     
-00035860: 2020 2020 2020 2020 2020 2061 7474 7269             attri
-00035870: 6275 7465 732e 6170 7065 6e64 2828 2776  butes.append(('v
-00035880: 6572 7469 6361 6c44 7069 272c 2073 656c  erticalDpi', sel
-00035890: 662e 7665 7274 6963 616c 5f64 7069 2929  f.vertical_dpi))
-000358a0: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-000358b0: 2073 656c 662e 686f 7269 7a6f 6e74 616c   self.horizontal
-000358c0: 5f64 7069 3a0a 2020 2020 2020 2020 2020  _dpi:.          
-000358d0: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-000358e0: 2e61 7070 656e 6428 2827 686f 7269 7a6f  .append(('horizo
-000358f0: 6e74 616c 4470 6927 2c20 7365 6c66 2e68  ntalDpi', self.h
-00035900: 6f72 697a 6f6e 7461 6c5f 6470 6929 290a  orizontal_dpi)).
-00035910: 0a20 2020 2020 2020 2073 656c 662e 5f78  .        self._x
-00035920: 6d6c 5f65 6d70 7479 5f74 6167 2827 7061  ml_empty_tag('pa
-00035930: 6765 5365 7475 7027 2c20 6174 7472 6962  geSetup', attrib
-00035940: 7574 6573 290a 0a20 2020 2064 6566 205f  utes)..    def _
-00035950: 7772 6974 655f 7072 696e 745f 6f70 7469  write_print_opti
-00035960: 6f6e 7328 7365 6c66 293a 0a20 2020 2020  ons(self):.     
-00035970: 2020 2023 2057 7269 7465 2074 6865 203c     # Write the <
-00035980: 7072 696e 744f 7074 696f 6e73 3e20 656c  printOptions> el
-00035990: 656d 656e 742e 0a20 2020 2020 2020 2061  ement..        a
-000359a0: 7474 7269 6275 7465 7320 3d20 5b5d 0a0a  ttributes = []..
-000359b0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
-000359c0: 656c 662e 7072 696e 745f 6f70 7469 6f6e  elf.print_option
-000359d0: 735f 6368 616e 6765 643a 0a20 2020 2020  s_changed:.     
-000359e0: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
-000359f0: 2020 2020 2020 2023 2053 6574 2068 6f72         # Set hor
-00035a00: 697a 6f6e 7461 6c20 6365 6e74 6572 696e  izontal centerin
-00035a10: 672e 0a20 2020 2020 2020 2069 6620 7365  g..        if se
-00035a20: 6c66 2e68 6365 6e74 6572 3a0a 2020 2020  lf.hcenter:.    
-00035a30: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
-00035a40: 6573 2e61 7070 656e 6428 2827 686f 7269  es.append(('hori
-00035a50: 7a6f 6e74 616c 4365 6e74 6572 6564 272c  zontalCentered',
-00035a60: 2031 2929 0a0a 2020 2020 2020 2020 2320   1))..        # 
-00035a70: 5365 7420 7665 7274 6963 616c 2063 656e  Set vertical cen
-00035a80: 7465 7269 6e67 2e0a 2020 2020 2020 2020  tering..        
-00035a90: 6966 2073 656c 662e 7663 656e 7465 723a  if self.vcenter:
-00035aa0: 0a20 2020 2020 2020 2020 2020 2061 7474  .            att
-00035ab0: 7269 6275 7465 732e 6170 7065 6e64 2828  ributes.append((
-00035ac0: 2776 6572 7469 6361 6c43 656e 7465 7265  'verticalCentere
-00035ad0: 6427 2c20 3129 290a 0a20 2020 2020 2020  d', 1))..       
-00035ae0: 2023 2045 6e61 626c 6520 726f 7720 616e   # Enable row an
-00035af0: 6420 636f 6c75 6d6e 2068 6561 6465 7273  d column headers
-00035b00: 2e0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-00035b10: 662e 7072 696e 745f 6865 6164 6572 733a  f.print_headers:
-00035b20: 0a20 2020 2020 2020 2020 2020 2061 7474  .            att
-00035b30: 7269 6275 7465 732e 6170 7065 6e64 2828  ributes.append((
-00035b40: 2768 6561 6469 6e67 7327 2c20 3129 290a  'headings', 1)).
-00035b50: 0a20 2020 2020 2020 2023 2053 6574 2070  .        # Set p
-00035b60: 7269 6e74 6564 2067 7269 646c 696e 6573  rinted gridlines
-00035b70: 2e0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-00035b80: 662e 7072 696e 745f 6772 6964 6c69 6e65  f.print_gridline
-00035b90: 733a 0a20 2020 2020 2020 2020 2020 2061  s:.            a
-00035ba0: 7474 7269 6275 7465 732e 6170 7065 6e64  ttributes.append
-00035bb0: 2828 2767 7269 644c 696e 6573 272c 2031  (('gridLines', 1
-00035bc0: 2929 0a0a 2020 2020 2020 2020 7365 6c66  ))..        self
-00035bd0: 2e5f 786d 6c5f 656d 7074 795f 7461 6728  ._xml_empty_tag(
-00035be0: 2770 7269 6e74 4f70 7469 6f6e 7327 2c20  'printOptions', 
-00035bf0: 6174 7472 6962 7574 6573 290a 0a20 2020  attributes)..   
-00035c00: 2064 6566 205f 7772 6974 655f 6865 6164   def _write_head
-00035c10: 6572 5f66 6f6f 7465 7228 7365 6c66 293a  er_footer(self):
-00035c20: 0a20 2020 2020 2020 2023 2057 7269 7465  .        # Write
-00035c30: 2074 6865 203c 6865 6164 6572 466f 6f74   the <headerFoot
-00035c40: 6572 3e20 656c 656d 656e 742e 0a20 2020  er> element..   
-00035c50: 2020 2020 2061 7474 7269 6275 7465 7320       attributes 
-00035c60: 3d20 5b5d 0a0a 2020 2020 2020 2020 6966  = []..        if
-00035c70: 206e 6f74 2073 656c 662e 6865 6164 6572   not self.header
-00035c80: 5f66 6f6f 7465 725f 7363 616c 6573 3a0a  _footer_scales:.
-00035c90: 2020 2020 2020 2020 2020 2020 6174 7472              attr
-00035ca0: 6962 7574 6573 2e61 7070 656e 6428 2827  ibutes.append(('
-00035cb0: 7363 616c 6557 6974 6844 6f63 272c 2030  scaleWithDoc', 0
-00035cc0: 2929 0a0a 2020 2020 2020 2020 6966 206e  ))..        if n
-00035cd0: 6f74 2073 656c 662e 6865 6164 6572 5f66  ot self.header_f
-00035ce0: 6f6f 7465 725f 616c 6967 6e73 3a0a 2020  ooter_aligns:.  
-00035cf0: 2020 2020 2020 2020 2020 6174 7472 6962            attrib
-00035d00: 7574 6573 2e61 7070 656e 6428 2827 616c  utes.append(('al
-00035d10: 6967 6e57 6974 684d 6172 6769 6e73 272c  ignWithMargins',
-00035d20: 2030 2929 0a0a 2020 2020 2020 2020 6966   0))..        if
-00035d30: 2073 656c 662e 6865 6164 6572 5f66 6f6f   self.header_foo
-00035d40: 7465 725f 6368 616e 6765 643a 0a20 2020  ter_changed:.   
-00035d50: 2020 2020 2020 2020 2073 656c 662e 5f78           self._x
-00035d60: 6d6c 5f73 7461 7274 5f74 6167 2827 6865  ml_start_tag('he
-00035d70: 6164 6572 466f 6f74 6572 272c 2061 7474  aderFooter', att
-00035d80: 7269 6275 7465 7329 0a20 2020 2020 2020  ributes).       
-00035d90: 2020 2020 2069 6620 7365 6c66 2e68 6561       if self.hea
-00035da0: 6465 723a 0a20 2020 2020 2020 2020 2020  der:.           
-00035db0: 2020 2020 2073 656c 662e 5f77 7269 7465       self._write
-00035dc0: 5f6f 6464 5f68 6561 6465 7228 290a 2020  _odd_header().  
-00035dd0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
-00035de0: 662e 666f 6f74 6572 3a0a 2020 2020 2020  f.footer:.      
-00035df0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00035e00: 7772 6974 655f 6f64 645f 666f 6f74 6572  write_odd_footer
-00035e10: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
-00035e20: 656c 662e 5f78 6d6c 5f65 6e64 5f74 6167  elf._xml_end_tag
-00035e30: 2827 6865 6164 6572 466f 6f74 6572 2729  ('headerFooter')
-00035e40: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
-00035e50: 6c66 2e65 7863 656c 3230 3033 5f73 7479  lf.excel2003_sty
-00035e60: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
-00035e70: 7365 6c66 2e5f 786d 6c5f 656d 7074 795f  self._xml_empty_
-00035e80: 7461 6728 2768 6561 6465 7246 6f6f 7465  tag('headerFoote
-00035e90: 7227 2c20 6174 7472 6962 7574 6573 290a  r', attributes).
-00035ea0: 0a20 2020 2064 6566 205f 7772 6974 655f  .    def _write_
-00035eb0: 6f64 645f 6865 6164 6572 2873 656c 6629  odd_header(self)
-00035ec0: 3a0a 2020 2020 2020 2020 2320 5772 6974  :.        # Writ
-00035ed0: 6520 7468 6520 3c68 6561 6465 7246 6f6f  e the <headerFoo
-00035ee0: 7465 723e 2065 6c65 6d65 6e74 2e0a 2020  ter> element..  
-00035ef0: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
-00035f00: 6461 7461 5f65 6c65 6d65 6e74 2827 6f64  data_element('od
-00035f10: 6448 6561 6465 7227 2c20 7365 6c66 2e68  dHeader', self.h
-00035f20: 6561 6465 7229 0a0a 2020 2020 6465 6620  eader)..    def 
-00035f30: 5f77 7269 7465 5f6f 6464 5f66 6f6f 7465  _write_odd_foote
-00035f40: 7228 7365 6c66 293a 0a20 2020 2020 2020  r(self):.       
-00035f50: 2023 2057 7269 7465 2074 6865 203c 6865   # Write the <he
-00035f60: 6164 6572 466f 6f74 6572 3e20 656c 656d  aderFooter> elem
-00035f70: 656e 742e 0a20 2020 2020 2020 2073 656c  ent..        sel
-00035f80: 662e 5f78 6d6c 5f64 6174 615f 656c 656d  f._xml_data_elem
-00035f90: 656e 7428 276f 6464 466f 6f74 6572 272c  ent('oddFooter',
-00035fa0: 2073 656c 662e 666f 6f74 6572 290a 0a20   self.footer).. 
-00035fb0: 2020 2064 6566 205f 7772 6974 655f 726f     def _write_ro
-00035fc0: 7773 2873 656c 6629 3a0a 2020 2020 2020  ws(self):.      
-00035fd0: 2020 2320 5772 6974 6520 6f75 7420 7468    # Write out th
-00035fe0: 6520 776f 726b 7368 6565 7420 6461 7461  e worksheet data
-00035ff0: 2061 7320 6120 7365 7269 6573 206f 6620   as a series of 
-00036000: 726f 7773 2061 6e64 2063 656c 6c73 2e0a  rows and cells..
-00036010: 2020 2020 2020 2020 7365 6c66 2e5f 6361          self._ca
-00036020: 6c63 756c 6174 655f 7370 616e 7328 290a  lculate_spans().
-00036030: 0a20 2020 2020 2020 2066 6f72 2072 6f77  .        for row
-00036040: 5f6e 756d 2069 6e20 7261 6e67 6528 7365  _num in range(se
-00036050: 6c66 2e64 696d 5f72 6f77 6d69 6e2c 2073  lf.dim_rowmin, s
-00036060: 656c 662e 6469 6d5f 726f 776d 6178 202b  elf.dim_rowmax +
-00036070: 2031 293a 0a0a 2020 2020 2020 2020 2020   1):..          
-00036080: 2020 6966 2028 726f 775f 6e75 6d20 696e    if (row_num in
-00036090: 2073 656c 662e 7365 745f 726f 7773 206f   self.set_rows o
-000360a0: 7220 726f 775f 6e75 6d20 696e 2073 656c  r row_num in sel
-000360b0: 662e 636f 6d6d 656e 7473 0a20 2020 2020  f.comments.     
-000360c0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-000360d0: 7220 7365 6c66 2e74 6162 6c65 5b72 6f77  r self.table[row
-000360e0: 5f6e 756d 5d29 3a0a 2020 2020 2020 2020  _num]):.        
-000360f0: 2020 2020 2020 2020 2320 4f6e 6c79 2070          # Only p
-00036100: 726f 6365 7373 2072 6f77 7320 7769 7468  rocess rows with
-00036110: 2066 6f72 6d61 7474 696e 672c 2063 656c   formatting, cel
-00036120: 6c20 6461 7461 2061 6e64 2f6f 7220 636f  l data and/or co
-00036130: 6d6d 656e 7473 2e0a 0a20 2020 2020 2020  mments...       
-00036140: 2020 2020 2020 2020 2073 7061 6e5f 696e           span_in
-00036150: 6465 7820 3d20 696e 7428 726f 775f 6e75  dex = int(row_nu
-00036160: 6d20 2f20 3136 290a 0a20 2020 2020 2020  m / 16)..       
-00036170: 2020 2020 2020 2020 2069 6620 7370 616e           if span
-00036180: 5f69 6e64 6578 2069 6e20 7365 6c66 2e72  _index in self.r
-00036190: 6f77 5f73 7061 6e73 3a0a 2020 2020 2020  ow_spans:.      
-000361a0: 2020 2020 2020 2020 2020 2020 2020 7370                sp
-000361b0: 616e 203d 2073 656c 662e 726f 775f 7370  an = self.row_sp
-000361c0: 616e 735b 7370 616e 5f69 6e64 6578 5d0a  ans[span_index].
-000361d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000361e0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000361f0: 2020 2020 2020 2020 2020 7370 616e 203d            span =
-00036200: 204e 6f6e 650a 0a20 2020 2020 2020 2020   None..         
-00036210: 2020 2020 2020 2069 6620 7365 6c66 2e74         if self.t
-00036220: 6162 6c65 5b72 6f77 5f6e 756d 5d3a 0a20  able[row_num]:. 
-00036230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036240: 2020 2023 2057 7269 7465 2074 6865 2063     # Write the c
-00036250: 656c 6c73 2069 6620 7468 6520 726f 7720  ells if the row 
-00036260: 636f 6e74 6169 6e73 2064 6174 612e 0a20  contains data.. 
-00036270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036280: 2020 2069 6620 726f 775f 6e75 6d20 6e6f     if row_num no
-00036290: 7420 696e 2073 656c 662e 7365 745f 726f  t in self.set_ro
-000362a0: 7773 3a0a 2020 2020 2020 2020 2020 2020  ws:.            
-000362b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000362c0: 2e5f 7772 6974 655f 726f 7728 726f 775f  ._write_row(row_
-000362d0: 6e75 6d2c 2073 7061 6e29 0a20 2020 2020  num, span).     
-000362e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000362f0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00036300: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00036310: 662e 5f77 7269 7465 5f72 6f77 2872 6f77  f._write_row(row
-00036320: 5f6e 756d 2c20 7370 616e 2c20 7365 6c66  _num, span, self
-00036330: 2e73 6574 5f72 6f77 735b 726f 775f 6e75  .set_rows[row_nu
-00036340: 6d5d 290a 0a20 2020 2020 2020 2020 2020  m])..           
-00036350: 2020 2020 2020 2020 2066 6f72 2063 6f6c           for col
-00036360: 5f6e 756d 2069 6e20 7261 6e67 6528 7365  _num in range(se
-00036370: 6c66 2e64 696d 5f63 6f6c 6d69 6e2c 2073  lf.dim_colmin, s
-00036380: 656c 662e 6469 6d5f 636f 6c6d 6178 202b  elf.dim_colmax +
-00036390: 2031 293a 0a20 2020 2020 2020 2020 2020   1):.           
-000363a0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000363b0: 636f 6c5f 6e75 6d20 696e 2073 656c 662e  col_num in self.
-000363c0: 7461 626c 655b 726f 775f 6e75 6d5d 3a0a  table[row_num]:.
-000363d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000363e0: 2020 2020 2020 2020 2020 2020 636f 6c5f              col_
-000363f0: 7265 6620 3d20 7365 6c66 2e74 6162 6c65  ref = self.table
-00036400: 5b72 6f77 5f6e 756d 5d5b 636f 6c5f 6e75  [row_num][col_nu
-00036410: 6d5d 0a20 2020 2020 2020 2020 2020 2020  m].             
-00036420: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00036430: 656c 662e 5f77 7269 7465 5f63 656c 6c28  elf._write_cell(
-00036440: 726f 775f 6e75 6d2c 2063 6f6c 5f6e 756d  row_num, col_num
-00036450: 2c20 636f 6c5f 7265 6629 0a0a 2020 2020  , col_ref)..    
-00036460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036470: 7365 6c66 2e5f 786d 6c5f 656e 645f 7461  self._xml_end_ta
-00036480: 6728 2772 6f77 2729 0a0a 2020 2020 2020  g('row')..      
-00036490: 2020 2020 2020 2020 2020 656c 6966 2072            elif r
-000364a0: 6f77 5f6e 756d 2069 6e20 7365 6c66 2e63  ow_num in self.c
-000364b0: 6f6d 6d65 6e74 733a 0a20 2020 2020 2020  omments:.       
-000364c0: 2020 2020 2020 2020 2020 2020 2023 2052               # R
-000364d0: 6f77 2077 6974 6820 636f 6d6d 656e 7473  ow with comments
-000364e0: 2069 6e20 6365 6c6c 732e 0a20 2020 2020   in cells..     
-000364f0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00036500: 656c 662e 5f77 7269 7465 5f65 6d70 7479  elf._write_empty
-00036510: 5f72 6f77 2872 6f77 5f6e 756d 2c20 7370  _row(row_num, sp
-00036520: 616e 2c0a 2020 2020 2020 2020 2020 2020  an,.            
-00036530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036540: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00036550: 6c66 2e73 6574 5f72 6f77 735b 726f 775f  lf.set_rows[row_
-00036560: 6e75 6d5d 290a 2020 2020 2020 2020 2020  num]).          
-00036570: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00036580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036590: 2320 426c 616e 6b20 726f 7720 7769 7468  # Blank row with
-000365a0: 2061 7474 7269 6275 7465 7320 6f6e 6c79   attributes only
-000365b0: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000365c0: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
-000365d0: 655f 656d 7074 795f 726f 7728 726f 775f  e_empty_row(row_
-000365e0: 6e75 6d2c 2073 7061 6e2c 0a20 2020 2020  num, span,.     
+00035270: 2e61 7070 656e 6428 2822 626c 6163 6b41  .append(("blackA
+00035280: 6e64 5768 6974 6522 2c20 2231 2229 290a  ndWhite", "1")).
+00035290: 0a20 2020 2020 2020 2023 2053 6574 2073  .        # Set s
+000352a0: 7461 7274 2070 6167 6520 666f 7220 7072  tart page for pr
+000352b0: 696e 7469 6e67 2e0a 2020 2020 2020 2020  inting..        
+000352c0: 6966 2073 656c 662e 7061 6765 5f73 7461  if self.page_sta
+000352d0: 7274 2021 3d20 303a 0a20 2020 2020 2020  rt != 0:.       
+000352e0: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
+000352f0: 6170 7065 6e64 2828 2275 7365 4669 7273  append(("useFirs
+00035300: 7450 6167 654e 756d 6265 7222 2c20 2231  tPageNumber", "1
+00035310: 2229 290a 0a20 2020 2020 2020 2023 2053  "))..        # S
+00035320: 6574 2074 6865 2044 5049 2e20 4d61 696e  et the DPI. Main
+00035330: 6c79 206f 6e6c 7920 666f 7220 7465 7374  ly only for test
+00035340: 696e 672e 0a20 2020 2020 2020 2069 6620  ing..        if 
+00035350: 7365 6c66 2e69 735f 6368 6172 7473 6865  self.is_chartshe
+00035360: 6574 3a0a 2020 2020 2020 2020 2020 2020  et:.            
+00035370: 6966 2073 656c 662e 686f 7269 7a6f 6e74  if self.horizont
+00035380: 616c 5f64 7069 3a0a 2020 2020 2020 2020  al_dpi:.        
+00035390: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
+000353a0: 6573 2e61 7070 656e 6428 2822 686f 7269  es.append(("hori
+000353b0: 7a6f 6e74 616c 4470 6922 2c20 7365 6c66  zontalDpi", self
+000353c0: 2e68 6f72 697a 6f6e 7461 6c5f 6470 6929  .horizontal_dpi)
+000353d0: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
+000353e0: 6620 7365 6c66 2e76 6572 7469 6361 6c5f  f self.vertical_
+000353f0: 6470 693a 0a20 2020 2020 2020 2020 2020  dpi:.           
+00035400: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
+00035410: 6170 7065 6e64 2828 2276 6572 7469 6361  append(("vertica
+00035420: 6c44 7069 222c 2073 656c 662e 7665 7274  lDpi", self.vert
+00035430: 6963 616c 5f64 7069 2929 0a20 2020 2020  ical_dpi)).     
+00035440: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00035450: 2020 2020 2069 6620 7365 6c66 2e76 6572       if self.ver
+00035460: 7469 6361 6c5f 6470 693a 0a20 2020 2020  tical_dpi:.     
+00035470: 2020 2020 2020 2020 2020 2061 7474 7269             attri
+00035480: 6275 7465 732e 6170 7065 6e64 2828 2276  butes.append(("v
+00035490: 6572 7469 6361 6c44 7069 222c 2073 656c  erticalDpi", sel
+000354a0: 662e 7665 7274 6963 616c 5f64 7069 2929  f.vertical_dpi))
+000354b0: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+000354c0: 2073 656c 662e 686f 7269 7a6f 6e74 616c   self.horizontal
+000354d0: 5f64 7069 3a0a 2020 2020 2020 2020 2020  _dpi:.          
+000354e0: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
+000354f0: 2e61 7070 656e 6428 2822 686f 7269 7a6f  .append(("horizo
+00035500: 6e74 616c 4470 6922 2c20 7365 6c66 2e68  ntalDpi", self.h
+00035510: 6f72 697a 6f6e 7461 6c5f 6470 6929 290a  orizontal_dpi)).
+00035520: 0a20 2020 2020 2020 2073 656c 662e 5f78  .        self._x
+00035530: 6d6c 5f65 6d70 7479 5f74 6167 2822 7061  ml_empty_tag("pa
+00035540: 6765 5365 7475 7022 2c20 6174 7472 6962  geSetup", attrib
+00035550: 7574 6573 290a 0a20 2020 2064 6566 205f  utes)..    def _
+00035560: 7772 6974 655f 7072 696e 745f 6f70 7469  write_print_opti
+00035570: 6f6e 7328 7365 6c66 293a 0a20 2020 2020  ons(self):.     
+00035580: 2020 2023 2057 7269 7465 2074 6865 203c     # Write the <
+00035590: 7072 696e 744f 7074 696f 6e73 3e20 656c  printOptions> el
+000355a0: 656d 656e 742e 0a20 2020 2020 2020 2061  ement..        a
+000355b0: 7474 7269 6275 7465 7320 3d20 5b5d 0a0a  ttributes = []..
+000355c0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+000355d0: 656c 662e 7072 696e 745f 6f70 7469 6f6e  elf.print_option
+000355e0: 735f 6368 616e 6765 643a 0a20 2020 2020  s_changed:.     
+000355f0: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
+00035600: 2020 2020 2020 2023 2053 6574 2068 6f72         # Set hor
+00035610: 697a 6f6e 7461 6c20 6365 6e74 6572 696e  izontal centerin
+00035620: 672e 0a20 2020 2020 2020 2069 6620 7365  g..        if se
+00035630: 6c66 2e68 6365 6e74 6572 3a0a 2020 2020  lf.hcenter:.    
+00035640: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
+00035650: 6573 2e61 7070 656e 6428 2822 686f 7269  es.append(("hori
+00035660: 7a6f 6e74 616c 4365 6e74 6572 6564 222c  zontalCentered",
+00035670: 2031 2929 0a0a 2020 2020 2020 2020 2320   1))..        # 
+00035680: 5365 7420 7665 7274 6963 616c 2063 656e  Set vertical cen
+00035690: 7465 7269 6e67 2e0a 2020 2020 2020 2020  tering..        
+000356a0: 6966 2073 656c 662e 7663 656e 7465 723a  if self.vcenter:
+000356b0: 0a20 2020 2020 2020 2020 2020 2061 7474  .            att
+000356c0: 7269 6275 7465 732e 6170 7065 6e64 2828  ributes.append((
+000356d0: 2276 6572 7469 6361 6c43 656e 7465 7265  "verticalCentere
+000356e0: 6422 2c20 3129 290a 0a20 2020 2020 2020  d", 1))..       
+000356f0: 2023 2045 6e61 626c 6520 726f 7720 616e   # Enable row an
+00035700: 6420 636f 6c75 6d6e 2068 6561 6465 7273  d column headers
+00035710: 2e0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+00035720: 662e 7072 696e 745f 6865 6164 6572 733a  f.print_headers:
+00035730: 0a20 2020 2020 2020 2020 2020 2061 7474  .            att
+00035740: 7269 6275 7465 732e 6170 7065 6e64 2828  ributes.append((
+00035750: 2268 6561 6469 6e67 7322 2c20 3129 290a  "headings", 1)).
+00035760: 0a20 2020 2020 2020 2023 2053 6574 2070  .        # Set p
+00035770: 7269 6e74 6564 2067 7269 646c 696e 6573  rinted gridlines
+00035780: 2e0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+00035790: 662e 7072 696e 745f 6772 6964 6c69 6e65  f.print_gridline
+000357a0: 733a 0a20 2020 2020 2020 2020 2020 2061  s:.            a
+000357b0: 7474 7269 6275 7465 732e 6170 7065 6e64  ttributes.append
+000357c0: 2828 2267 7269 644c 696e 6573 222c 2031  (("gridLines", 1
+000357d0: 2929 0a0a 2020 2020 2020 2020 7365 6c66  ))..        self
+000357e0: 2e5f 786d 6c5f 656d 7074 795f 7461 6728  ._xml_empty_tag(
+000357f0: 2270 7269 6e74 4f70 7469 6f6e 7322 2c20  "printOptions", 
+00035800: 6174 7472 6962 7574 6573 290a 0a20 2020  attributes)..   
+00035810: 2064 6566 205f 7772 6974 655f 6865 6164   def _write_head
+00035820: 6572 5f66 6f6f 7465 7228 7365 6c66 293a  er_footer(self):
+00035830: 0a20 2020 2020 2020 2023 2057 7269 7465  .        # Write
+00035840: 2074 6865 203c 6865 6164 6572 466f 6f74   the <headerFoot
+00035850: 6572 3e20 656c 656d 656e 742e 0a20 2020  er> element..   
+00035860: 2020 2020 2061 7474 7269 6275 7465 7320       attributes 
+00035870: 3d20 5b5d 0a0a 2020 2020 2020 2020 6966  = []..        if
+00035880: 206e 6f74 2073 656c 662e 6865 6164 6572   not self.header
+00035890: 5f66 6f6f 7465 725f 7363 616c 6573 3a0a  _footer_scales:.
+000358a0: 2020 2020 2020 2020 2020 2020 6174 7472              attr
+000358b0: 6962 7574 6573 2e61 7070 656e 6428 2822  ibutes.append(("
+000358c0: 7363 616c 6557 6974 6844 6f63 222c 2030  scaleWithDoc", 0
+000358d0: 2929 0a0a 2020 2020 2020 2020 6966 206e  ))..        if n
+000358e0: 6f74 2073 656c 662e 6865 6164 6572 5f66  ot self.header_f
+000358f0: 6f6f 7465 725f 616c 6967 6e73 3a0a 2020  ooter_aligns:.  
+00035900: 2020 2020 2020 2020 2020 6174 7472 6962            attrib
+00035910: 7574 6573 2e61 7070 656e 6428 2822 616c  utes.append(("al
+00035920: 6967 6e57 6974 684d 6172 6769 6e73 222c  ignWithMargins",
+00035930: 2030 2929 0a0a 2020 2020 2020 2020 6966   0))..        if
+00035940: 2073 656c 662e 6865 6164 6572 5f66 6f6f   self.header_foo
+00035950: 7465 725f 6368 616e 6765 643a 0a20 2020  ter_changed:.   
+00035960: 2020 2020 2020 2020 2073 656c 662e 5f78           self._x
+00035970: 6d6c 5f73 7461 7274 5f74 6167 2822 6865  ml_start_tag("he
+00035980: 6164 6572 466f 6f74 6572 222c 2061 7474  aderFooter", att
+00035990: 7269 6275 7465 7329 0a20 2020 2020 2020  ributes).       
+000359a0: 2020 2020 2069 6620 7365 6c66 2e68 6561       if self.hea
+000359b0: 6465 723a 0a20 2020 2020 2020 2020 2020  der:.           
+000359c0: 2020 2020 2073 656c 662e 5f77 7269 7465       self._write
+000359d0: 5f6f 6464 5f68 6561 6465 7228 290a 2020  _odd_header().  
+000359e0: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+000359f0: 662e 666f 6f74 6572 3a0a 2020 2020 2020  f.footer:.      
+00035a00: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00035a10: 7772 6974 655f 6f64 645f 666f 6f74 6572  write_odd_footer
+00035a20: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
+00035a30: 656c 662e 5f78 6d6c 5f65 6e64 5f74 6167  elf._xml_end_tag
+00035a40: 2822 6865 6164 6572 466f 6f74 6572 2229  ("headerFooter")
+00035a50: 0a20 2020 2020 2020 2065 6c69 6620 7365  .        elif se
+00035a60: 6c66 2e65 7863 656c 3230 3033 5f73 7479  lf.excel2003_sty
+00035a70: 6c65 3a0a 2020 2020 2020 2020 2020 2020  le:.            
+00035a80: 7365 6c66 2e5f 786d 6c5f 656d 7074 795f  self._xml_empty_
+00035a90: 7461 6728 2268 6561 6465 7246 6f6f 7465  tag("headerFoote
+00035aa0: 7222 2c20 6174 7472 6962 7574 6573 290a  r", attributes).
+00035ab0: 0a20 2020 2064 6566 205f 7772 6974 655f  .    def _write_
+00035ac0: 6f64 645f 6865 6164 6572 2873 656c 6629  odd_header(self)
+00035ad0: 3a0a 2020 2020 2020 2020 2320 5772 6974  :.        # Writ
+00035ae0: 6520 7468 6520 3c68 6561 6465 7246 6f6f  e the <headerFoo
+00035af0: 7465 723e 2065 6c65 6d65 6e74 2e0a 2020  ter> element..  
+00035b00: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
+00035b10: 6461 7461 5f65 6c65 6d65 6e74 2822 6f64  data_element("od
+00035b20: 6448 6561 6465 7222 2c20 7365 6c66 2e68  dHeader", self.h
+00035b30: 6561 6465 7229 0a0a 2020 2020 6465 6620  eader)..    def 
+00035b40: 5f77 7269 7465 5f6f 6464 5f66 6f6f 7465  _write_odd_foote
+00035b50: 7228 7365 6c66 293a 0a20 2020 2020 2020  r(self):.       
+00035b60: 2023 2057 7269 7465 2074 6865 203c 6865   # Write the <he
+00035b70: 6164 6572 466f 6f74 6572 3e20 656c 656d  aderFooter> elem
+00035b80: 656e 742e 0a20 2020 2020 2020 2073 656c  ent..        sel
+00035b90: 662e 5f78 6d6c 5f64 6174 615f 656c 656d  f._xml_data_elem
+00035ba0: 656e 7428 226f 6464 466f 6f74 6572 222c  ent("oddFooter",
+00035bb0: 2073 656c 662e 666f 6f74 6572 290a 0a20   self.footer).. 
+00035bc0: 2020 2064 6566 205f 7772 6974 655f 726f     def _write_ro
+00035bd0: 7773 2873 656c 6629 3a0a 2020 2020 2020  ws(self):.      
+00035be0: 2020 2320 5772 6974 6520 6f75 7420 7468    # Write out th
+00035bf0: 6520 776f 726b 7368 6565 7420 6461 7461  e worksheet data
+00035c00: 2061 7320 6120 7365 7269 6573 206f 6620   as a series of 
+00035c10: 726f 7773 2061 6e64 2063 656c 6c73 2e0a  rows and cells..
+00035c20: 2020 2020 2020 2020 7365 6c66 2e5f 6361          self._ca
+00035c30: 6c63 756c 6174 655f 7370 616e 7328 290a  lculate_spans().
+00035c40: 0a20 2020 2020 2020 2066 6f72 2072 6f77  .        for row
+00035c50: 5f6e 756d 2069 6e20 7261 6e67 6528 7365  _num in range(se
+00035c60: 6c66 2e64 696d 5f72 6f77 6d69 6e2c 2073  lf.dim_rowmin, s
+00035c70: 656c 662e 6469 6d5f 726f 776d 6178 202b  elf.dim_rowmax +
+00035c80: 2031 293a 0a20 2020 2020 2020 2020 2020   1):.           
+00035c90: 2069 6620 280a 2020 2020 2020 2020 2020   if (.          
+00035ca0: 2020 2020 2020 726f 775f 6e75 6d20 696e        row_num in
+00035cb0: 2073 656c 662e 7365 745f 726f 7773 0a20   self.set_rows. 
+00035cc0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00035cd0: 7220 726f 775f 6e75 6d20 696e 2073 656c  r row_num in sel
+00035ce0: 662e 636f 6d6d 656e 7473 0a20 2020 2020  f.comments.     
+00035cf0: 2020 2020 2020 2020 2020 206f 7220 7365             or se
+00035d00: 6c66 2e74 6162 6c65 5b72 6f77 5f6e 756d  lf.table[row_num
+00035d10: 5d0a 2020 2020 2020 2020 2020 2020 293a  ].            ):
+00035d20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035d30: 2023 204f 6e6c 7920 7072 6f63 6573 7320   # Only process 
+00035d40: 726f 7773 2077 6974 6820 666f 726d 6174  rows with format
+00035d50: 7469 6e67 2c20 6365 6c6c 2064 6174 6120  ting, cell data 
+00035d60: 616e 642f 6f72 2063 6f6d 6d65 6e74 732e  and/or comments.
+00035d70: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00035d80: 2020 7370 616e 5f69 6e64 6578 203d 2069    span_index = i
+00035d90: 6e74 2872 6f77 5f6e 756d 202f 2031 3629  nt(row_num / 16)
+00035da0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00035db0: 2020 6966 2073 7061 6e5f 696e 6465 7820    if span_index 
+00035dc0: 696e 2073 656c 662e 726f 775f 7370 616e  in self.row_span
+00035dd0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00035de0: 2020 2020 2020 2073 7061 6e20 3d20 7365         span = se
+00035df0: 6c66 2e72 6f77 5f73 7061 6e73 5b73 7061  lf.row_spans[spa
+00035e00: 6e5f 696e 6465 785d 0a20 2020 2020 2020  n_index].       
+00035e10: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00035e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035e30: 2020 2073 7061 6e20 3d20 4e6f 6e65 0a0a     span = None..
+00035e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035e50: 6966 2073 656c 662e 7461 626c 655b 726f  if self.table[ro
+00035e60: 775f 6e75 6d5d 3a0a 2020 2020 2020 2020  w_num]:.        
+00035e70: 2020 2020 2020 2020 2020 2020 2320 5772              # Wr
+00035e80: 6974 6520 7468 6520 6365 6c6c 7320 6966  ite the cells if
+00035e90: 2074 6865 2072 6f77 2063 6f6e 7461 696e   the row contain
+00035ea0: 7320 6461 7461 2e0a 2020 2020 2020 2020  s data..        
+00035eb0: 2020 2020 2020 2020 2020 2020 6966 2072              if r
+00035ec0: 6f77 5f6e 756d 206e 6f74 2069 6e20 7365  ow_num not in se
+00035ed0: 6c66 2e73 6574 5f72 6f77 733a 0a20 2020  lf.set_rows:.   
+00035ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035ef0: 2020 2020 2073 656c 662e 5f77 7269 7465       self._write
+00035f00: 5f72 6f77 2872 6f77 5f6e 756d 2c20 7370  _row(row_num, sp
+00035f10: 616e 290a 2020 2020 2020 2020 2020 2020  an).            
+00035f20: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00035f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035f40: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
+00035f50: 655f 726f 7728 726f 775f 6e75 6d2c 2073  e_row(row_num, s
+00035f60: 7061 6e2c 2073 656c 662e 7365 745f 726f  pan, self.set_ro
+00035f70: 7773 5b72 6f77 5f6e 756d 5d29 0a0a 2020  ws[row_num])..  
+00035f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035f90: 2020 666f 7220 636f 6c5f 6e75 6d20 696e    for col_num in
+00035fa0: 2072 616e 6765 2873 656c 662e 6469 6d5f   range(self.dim_
+00035fb0: 636f 6c6d 696e 2c20 7365 6c66 2e64 696d  colmin, self.dim
+00035fc0: 5f63 6f6c 6d61 7820 2b20 3129 3a0a 2020  _colmax + 1):.  
+00035fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035fe0: 2020 2020 2020 6966 2063 6f6c 5f6e 756d        if col_num
+00035ff0: 2069 6e20 7365 6c66 2e74 6162 6c65 5b72   in self.table[r
+00036000: 6f77 5f6e 756d 5d3a 0a20 2020 2020 2020  ow_num]:.       
+00036010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036020: 2020 2020 2063 6f6c 5f72 6566 203d 2073       col_ref = s
+00036030: 656c 662e 7461 626c 655b 726f 775f 6e75  elf.table[row_nu
+00036040: 6d5d 5b63 6f6c 5f6e 756d 5d0a 2020 2020  m][col_num].    
+00036050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036060: 2020 2020 2020 2020 7365 6c66 2e5f 7772          self._wr
+00036070: 6974 655f 6365 6c6c 2872 6f77 5f6e 756d  ite_cell(row_num
+00036080: 2c20 636f 6c5f 6e75 6d2c 2063 6f6c 5f72  , col_num, col_r
+00036090: 6566 290a 0a20 2020 2020 2020 2020 2020  ef)..           
+000360a0: 2020 2020 2020 2020 2073 656c 662e 5f78           self._x
+000360b0: 6d6c 5f65 6e64 5f74 6167 2822 726f 7722  ml_end_tag("row"
+000360c0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+000360d0: 2020 2065 6c69 6620 726f 775f 6e75 6d20     elif row_num 
+000360e0: 696e 2073 656c 662e 636f 6d6d 656e 7473  in self.comments
+000360f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00036100: 2020 2020 2020 2320 526f 7720 7769 7468        # Row with
+00036110: 2063 6f6d 6d65 6e74 7320 696e 2063 656c   comments in cel
+00036120: 6c73 2e0a 2020 2020 2020 2020 2020 2020  ls..            
+00036130: 2020 2020 2020 2020 7365 6c66 2e5f 7772          self._wr
+00036140: 6974 655f 656d 7074 795f 726f 7728 726f  ite_empty_row(ro
+00036150: 775f 6e75 6d2c 2073 7061 6e2c 2073 656c  w_num, span, sel
+00036160: 662e 7365 745f 726f 7773 5b72 6f77 5f6e  f.set_rows[row_n
+00036170: 756d 5d29 0a20 2020 2020 2020 2020 2020  um]).           
+00036180: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00036190: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+000361a0: 2042 6c61 6e6b 2072 6f77 2077 6974 6820   Blank row with 
+000361b0: 6174 7472 6962 7574 6573 206f 6e6c 792e  attributes only.
+000361c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000361d0: 2020 2020 2073 656c 662e 5f77 7269 7465       self._write
+000361e0: 5f65 6d70 7479 5f72 6f77 2872 6f77 5f6e  _empty_row(row_n
+000361f0: 756d 2c20 7370 616e 2c20 7365 6c66 2e73  um, span, self.s
+00036200: 6574 5f72 6f77 735b 726f 775f 6e75 6d5d  et_rows[row_num]
+00036210: 290a 0a20 2020 2064 6566 205f 7772 6974  )..    def _writ
+00036220: 655f 7369 6e67 6c65 5f72 6f77 2873 656c  e_single_row(sel
+00036230: 662c 2063 7572 7265 6e74 5f72 6f77 5f6e  f, current_row_n
+00036240: 756d 3d30 293a 0a20 2020 2020 2020 2023  um=0):.        #
+00036250: 2057 7269 7465 206f 7574 2074 6865 2077   Write out the w
+00036260: 6f72 6b73 6865 6574 2064 6174 6120 6173  orksheet data as
+00036270: 2061 2073 696e 676c 6520 726f 7720 7769   a single row wi
+00036280: 7468 2063 656c 6c73 2e0a 2020 2020 2020  th cells..      
+00036290: 2020 2320 5468 6973 206d 6574 686f 6420    # This method 
+000362a0: 6973 2075 7365 6420 7768 656e 2063 6f6e  is used when con
+000362b0: 7374 616e 745f 6d65 6d6f 7279 2069 7320  stant_memory is 
+000362c0: 6f6e 2e20 4120 7369 6e67 6c65 0a20 2020  on. A single.   
+000362d0: 2020 2020 2023 2072 6f77 2069 7320 7772       # row is wr
+000362e0: 6974 7465 6e20 616e 6420 7468 6520 6461  itten and the da
+000362f0: 7461 2074 6162 6c65 2069 7320 7265 7365  ta table is rese
+00036300: 742e 2054 6861 7420 7761 7920 6f6e 6c79  t. That way only
+00036310: 0a20 2020 2020 2020 2023 206f 6e65 2072  .        # one r
+00036320: 6f77 206f 6620 6461 7461 2069 7320 6b65  ow of data is ke
+00036330: 7074 2069 6e20 6d65 6d6f 7279 2061 7420  pt in memory at 
+00036340: 616e 7920 6f6e 6520 7469 6d65 2e20 5765  any one time. We
+00036350: 2064 6f6e 2774 0a20 2020 2020 2020 2023   don't.        #
+00036360: 2077 7269 7465 2073 7061 6e20 6461 7461   write span data
+00036370: 2069 6e20 7468 6520 6f70 7469 6d69 7a65   in the optimize
+00036380: 6420 6361 7365 2073 696e 6365 2069 7420  d case since it 
+00036390: 6973 206f 7074 696f 6e61 6c2e 0a0a 2020  is optional...  
+000363a0: 2020 2020 2020 2320 5365 7420 7468 6520        # Set the 
+000363b0: 6e65 7720 7072 6576 696f 7573 2072 6f77  new previous row
+000363c0: 2061 7320 7468 6520 6375 7272 656e 7420   as the current 
+000363d0: 726f 772e 0a20 2020 2020 2020 2072 6f77  row..        row
+000363e0: 5f6e 756d 203d 2073 656c 662e 7072 6576  _num = self.prev
+000363f0: 696f 7573 5f72 6f77 0a20 2020 2020 2020  ious_row.       
+00036400: 2073 656c 662e 7072 6576 696f 7573 5f72   self.previous_r
+00036410: 6f77 203d 2063 7572 7265 6e74 5f72 6f77  ow = current_row
+00036420: 5f6e 756d 0a0a 2020 2020 2020 2020 6966  _num..        if
+00036430: 2072 6f77 5f6e 756d 2069 6e20 7365 6c66   row_num in self
+00036440: 2e73 6574 5f72 6f77 7320 6f72 2072 6f77  .set_rows or row
+00036450: 5f6e 756d 2069 6e20 7365 6c66 2e63 6f6d  _num in self.com
+00036460: 6d65 6e74 7320 6f72 2073 656c 662e 7461  ments or self.ta
+00036470: 626c 655b 726f 775f 6e75 6d5d 3a0a 2020  ble[row_num]:.  
+00036480: 2020 2020 2020 2020 2020 2320 4f6e 6c79            # Only
+00036490: 2070 726f 6365 7373 2072 6f77 7320 7769   process rows wi
+000364a0: 7468 2066 6f72 6d61 7474 696e 672c 2063  th formatting, c
+000364b0: 656c 6c20 6461 7461 2061 6e64 2f6f 7220  ell data and/or 
+000364c0: 636f 6d6d 656e 7473 2e0a 0a20 2020 2020  comments...     
+000364d0: 2020 2020 2020 2023 204e 6f20 7370 616e         # No span
+000364e0: 2064 6174 6120 696e 206f 7074 696d 697a   data in optimiz
+000364f0: 6564 206d 6f64 652e 0a20 2020 2020 2020  ed mode..       
+00036500: 2020 2020 2073 7061 6e20 3d20 4e6f 6e65       span = None
+00036510: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00036520: 2073 656c 662e 7461 626c 655b 726f 775f   self.table[row_
+00036530: 6e75 6d5d 3a0a 2020 2020 2020 2020 2020  num]:.          
+00036540: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
+00036550: 6520 6365 6c6c 7320 6966 2074 6865 2072  e cells if the r
+00036560: 6f77 2063 6f6e 7461 696e 7320 6461 7461  ow contains data
+00036570: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00036580: 2020 6966 2072 6f77 5f6e 756d 206e 6f74    if row_num not
+00036590: 2069 6e20 7365 6c66 2e73 6574 5f72 6f77   in self.set_row
+000365a0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+000365b0: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
+000365c0: 7465 5f72 6f77 2872 6f77 5f6e 756d 2c20  te_row(row_num, 
+000365d0: 7370 616e 290a 2020 2020 2020 2020 2020  span).          
+000365e0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
 000365f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036610: 2020 2020 2073 656c 662e 7365 745f 726f       self.set_ro
-00036620: 7773 5b72 6f77 5f6e 756d 5d29 0a0a 2020  ws[row_num])..  
-00036630: 2020 6465 6620 5f77 7269 7465 5f73 696e    def _write_sin
-00036640: 676c 655f 726f 7728 7365 6c66 2c20 6375  gle_row(self, cu
-00036650: 7272 656e 745f 726f 775f 6e75 6d3d 3029  rrent_row_num=0)
-00036660: 3a0a 2020 2020 2020 2020 2320 5772 6974  :.        # Writ
-00036670: 6520 6f75 7420 7468 6520 776f 726b 7368  e out the worksh
-00036680: 6565 7420 6461 7461 2061 7320 6120 7369  eet data as a si
-00036690: 6e67 6c65 2072 6f77 2077 6974 6820 6365  ngle row with ce
-000366a0: 6c6c 732e 0a20 2020 2020 2020 2023 2054  lls..        # T
-000366b0: 6869 7320 6d65 7468 6f64 2069 7320 7573  his method is us
-000366c0: 6564 2077 6865 6e20 636f 6e73 7461 6e74  ed when constant
-000366d0: 5f6d 656d 6f72 7920 6973 206f 6e2e 2041  _memory is on. A
-000366e0: 2073 696e 676c 650a 2020 2020 2020 2020   single.        
-000366f0: 2320 726f 7720 6973 2077 7269 7474 656e  # row is written
-00036700: 2061 6e64 2074 6865 2064 6174 6120 7461   and the data ta
-00036710: 626c 6520 6973 2072 6573 6574 2e20 5468  ble is reset. Th
-00036720: 6174 2077 6179 206f 6e6c 790a 2020 2020  at way only.    
-00036730: 2020 2020 2320 6f6e 6520 726f 7720 6f66      # one row of
-00036740: 2064 6174 6120 6973 206b 6570 7420 696e   data is kept in
-00036750: 206d 656d 6f72 7920 6174 2061 6e79 206f   memory at any o
-00036760: 6e65 2074 696d 652e 2057 6520 646f 6e27  ne time. We don'
-00036770: 740a 2020 2020 2020 2020 2320 7772 6974  t.        # writ
-00036780: 6520 7370 616e 2064 6174 6120 696e 2074  e span data in t
-00036790: 6865 206f 7074 696d 697a 6564 2063 6173  he optimized cas
-000367a0: 6520 7369 6e63 6520 6974 2069 7320 6f70  e since it is op
-000367b0: 7469 6f6e 616c 2e0a 0a20 2020 2020 2020  tional...       
-000367c0: 2023 2053 6574 2074 6865 206e 6577 2070   # Set the new p
-000367d0: 7265 7669 6f75 7320 726f 7720 6173 2074  revious row as t
-000367e0: 6865 2063 7572 7265 6e74 2072 6f77 2e0a  he current row..
-000367f0: 2020 2020 2020 2020 726f 775f 6e75 6d20          row_num 
-00036800: 3d20 7365 6c66 2e70 7265 7669 6f75 735f  = self.previous_
-00036810: 726f 770a 2020 2020 2020 2020 7365 6c66  row.        self
-00036820: 2e70 7265 7669 6f75 735f 726f 7720 3d20  .previous_row = 
-00036830: 6375 7272 656e 745f 726f 775f 6e75 6d0a  current_row_num.
-00036840: 0a20 2020 2020 2020 2069 6620 2872 6f77  .        if (row
-00036850: 5f6e 756d 2069 6e20 7365 6c66 2e73 6574  _num in self.set
-00036860: 5f72 6f77 7320 6f72 2072 6f77 5f6e 756d  _rows or row_num
-00036870: 2069 6e20 7365 6c66 2e63 6f6d 6d65 6e74   in self.comment
-00036880: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-00036890: 2020 6f72 2073 656c 662e 7461 626c 655b    or self.table[
-000368a0: 726f 775f 6e75 6d5d 293a 0a20 2020 2020  row_num]):.     
-000368b0: 2020 2020 2020 2023 204f 6e6c 7920 7072         # Only pr
-000368c0: 6f63 6573 7320 726f 7773 2077 6974 6820  ocess rows with 
-000368d0: 666f 726d 6174 7469 6e67 2c20 6365 6c6c  formatting, cell
-000368e0: 2064 6174 6120 616e 642f 6f72 2063 6f6d   data and/or com
-000368f0: 6d65 6e74 732e 0a0a 2020 2020 2020 2020  ments...        
-00036900: 2020 2020 2320 4e6f 2073 7061 6e20 6461      # No span da
-00036910: 7461 2069 6e20 6f70 7469 6d69 7a65 6420  ta in optimized 
-00036920: 6d6f 6465 2e0a 2020 2020 2020 2020 2020  mode..          
-00036930: 2020 7370 616e 203d 204e 6f6e 650a 0a20    span = None.. 
-00036940: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-00036950: 6c66 2e74 6162 6c65 5b72 6f77 5f6e 756d  lf.table[row_num
-00036960: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
-00036970: 2020 2023 2057 7269 7465 2074 6865 2063     # Write the c
-00036980: 656c 6c73 2069 6620 7468 6520 726f 7720  ells if the row 
-00036990: 636f 6e74 6169 6e73 2064 6174 612e 0a20  contains data.. 
-000369a0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000369b0: 6620 726f 775f 6e75 6d20 6e6f 7420 696e  f row_num not in
-000369c0: 2073 656c 662e 7365 745f 726f 7773 3a0a   self.set_rows:.
-000369d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000369e0: 2020 2020 7365 6c66 2e5f 7772 6974 655f      self._write_
-000369f0: 726f 7728 726f 775f 6e75 6d2c 2073 7061  row(row_num, spa
-00036a00: 6e29 0a20 2020 2020 2020 2020 2020 2020  n).             
-00036a10: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00036a20: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00036a30: 662e 5f77 7269 7465 5f72 6f77 2872 6f77  f._write_row(row
-00036a40: 5f6e 756d 2c20 7370 616e 2c20 7365 6c66  _num, span, self
-00036a50: 2e73 6574 5f72 6f77 735b 726f 775f 6e75  .set_rows[row_nu
-00036a60: 6d5d 290a 0a20 2020 2020 2020 2020 2020  m])..           
-00036a70: 2020 2020 2066 6f72 2063 6f6c 5f6e 756d       for col_num
-00036a80: 2069 6e20 7261 6e67 6528 7365 6c66 2e64   in range(self.d
-00036a90: 696d 5f63 6f6c 6d69 6e2c 2073 656c 662e  im_colmin, self.
-00036aa0: 6469 6d5f 636f 6c6d 6178 202b 2031 293a  dim_colmax + 1):
-00036ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00036ac0: 2020 2020 2069 6620 636f 6c5f 6e75 6d20       if col_num 
-00036ad0: 696e 2073 656c 662e 7461 626c 655b 726f  in self.table[ro
-00036ae0: 775f 6e75 6d5d 3a0a 2020 2020 2020 2020  w_num]:.        
-00036af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036b00: 636f 6c5f 7265 6620 3d20 7365 6c66 2e74  col_ref = self.t
-00036b10: 6162 6c65 5b72 6f77 5f6e 756d 5d5b 636f  able[row_num][co
-00036b20: 6c5f 6e75 6d5d 0a20 2020 2020 2020 2020  l_num].         
-00036b30: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00036b40: 656c 662e 5f77 7269 7465 5f63 656c 6c28  elf._write_cell(
-00036b50: 726f 775f 6e75 6d2c 2063 6f6c 5f6e 756d  row_num, col_num
-00036b60: 2c20 636f 6c5f 7265 6629 0a0a 2020 2020  , col_ref)..    
-00036b70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00036b80: 2e5f 786d 6c5f 656e 645f 7461 6728 2772  ._xml_end_tag('r
-00036b90: 6f77 2729 0a20 2020 2020 2020 2020 2020  ow').           
-00036ba0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00036bb0: 2020 2020 2020 2023 2052 6f77 2061 7474         # Row att
-00036bc0: 7269 6275 7465 7320 6f72 2063 6f6d 6d65  ributes or comme
-00036bd0: 6e74 7320 6f6e 6c79 2e0a 2020 2020 2020  nts only..      
-00036be0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00036bf0: 7772 6974 655f 656d 7074 795f 726f 7728  write_empty_row(
-00036c00: 726f 775f 6e75 6d2c 2073 7061 6e2c 2073  row_num, span, s
-00036c10: 656c 662e 7365 745f 726f 7773 5b72 6f77  elf.set_rows[row
-00036c20: 5f6e 756d 5d29 0a0a 2020 2020 2020 2020  _num])..        
-00036c30: 2320 5265 7365 7420 7461 626c 652e 0a20  # Reset table.. 
-00036c40: 2020 2020 2020 2073 656c 662e 7461 626c         self.tabl
-00036c50: 652e 636c 6561 7228 290a 0a20 2020 2064  e.clear()..    d
-00036c60: 6566 205f 6361 6c63 756c 6174 655f 7370  ef _calculate_sp
-00036c70: 616e 7328 7365 6c66 293a 0a20 2020 2020  ans(self):.     
-00036c80: 2020 2023 2043 616c 6375 6c61 7465 2074     # Calculate t
-00036c90: 6865 2022 7370 616e 7322 2061 7474 7269  he "spans" attri
-00036ca0: 6275 7465 206f 6620 7468 6520 3c72 6f77  bute of the <row
-00036cb0: 3e20 7461 672e 2054 6869 7320 6973 2061  > tag. This is a
-00036cc0: 6e0a 2020 2020 2020 2020 2320 584c 5358  n.        # XLSX
-00036cd0: 206f 7074 696d 697a 6174 696f 6e20 616e   optimization an
-00036ce0: 6420 6973 6e27 7420 7374 7269 6374 6c79  d isn't strictly
-00036cf0: 2072 6571 7569 7265 642e 2048 6f77 6576   required. Howev
-00036d00: 6572 2c20 6974 0a20 2020 2020 2020 2023  er, it.        #
-00036d10: 206d 616b 6573 2063 6f6d 7061 7269 6e67   makes comparing
-00036d20: 2066 696c 6573 2065 6173 6965 722e 2054   files easier. T
-00036d30: 6865 2073 7061 6e20 6973 2074 6865 2073  he span is the s
-00036d40: 616d 6520 666f 7220 6561 6368 0a20 2020  ame for each.   
-00036d50: 2020 2020 2023 2062 6c6f 636b 206f 6620       # block of 
-00036d60: 3136 2072 6f77 732e 0a20 2020 2020 2020  16 rows..       
-00036d70: 2073 7061 6e73 203d 207b 7d0a 2020 2020   spans = {}.    
-00036d80: 2020 2020 7370 616e 5f6d 696e 203d 204e      span_min = N
-00036d90: 6f6e 650a 2020 2020 2020 2020 7370 616e  one.        span
-00036da0: 5f6d 6178 203d 204e 6f6e 650a 0a20 2020  _max = None..   
-00036db0: 2020 2020 2066 6f72 2072 6f77 5f6e 756d       for row_num
-00036dc0: 2069 6e20 7261 6e67 6528 7365 6c66 2e64   in range(self.d
-00036dd0: 696d 5f72 6f77 6d69 6e2c 2073 656c 662e  im_rowmin, self.
-00036de0: 6469 6d5f 726f 776d 6178 202b 2031 293a  dim_rowmax + 1):
-00036df0: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00036e00: 2072 6f77 5f6e 756d 2069 6e20 7365 6c66   row_num in self
-00036e10: 2e74 6162 6c65 3a0a 2020 2020 2020 2020  .table:.        
-00036e20: 2020 2020 2020 2020 2320 4361 6c63 756c          # Calcul
-00036e30: 6174 6520 7370 616e 7320 666f 7220 6365  ate spans for ce
-00036e40: 6c6c 2064 6174 612e 0a20 2020 2020 2020  ll data..       
-00036e50: 2020 2020 2020 2020 2066 6f72 2063 6f6c           for col
-00036e60: 5f6e 756d 2069 6e20 7261 6e67 6528 7365  _num in range(se
-00036e70: 6c66 2e64 696d 5f63 6f6c 6d69 6e2c 2073  lf.dim_colmin, s
-00036e80: 656c 662e 6469 6d5f 636f 6c6d 6178 202b  elf.dim_colmax +
-00036e90: 2031 293a 0a20 2020 2020 2020 2020 2020   1):.           
-00036ea0: 2020 2020 2020 2020 2069 6620 636f 6c5f           if col_
-00036eb0: 6e75 6d20 696e 2073 656c 662e 7461 626c  num in self.tabl
-00036ec0: 655b 726f 775f 6e75 6d5d 3a0a 2020 2020  e[row_num]:.    
-00036ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036ee0: 2020 2020 6966 2073 7061 6e5f 6d69 6e20      if span_min 
-00036ef0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00036f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036f10: 2020 2020 2073 7061 6e5f 6d69 6e20 3d20       span_min = 
-00036f20: 636f 6c5f 6e75 6d0a 2020 2020 2020 2020  col_num.        
-00036f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036f40: 2020 2020 7370 616e 5f6d 6178 203d 2063      span_max = c
-00036f50: 6f6c 5f6e 756d 0a20 2020 2020 2020 2020  ol_num.         
-00036f60: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00036f70: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00036f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036f90: 2069 6620 636f 6c5f 6e75 6d20 3c20 7370   if col_num < sp
-00036fa0: 616e 5f6d 696e 3a0a 2020 2020 2020 2020  an_min:.        
-00036fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036fc0: 2020 2020 2020 2020 7370 616e 5f6d 696e          span_min
-00036fd0: 203d 2063 6f6c 5f6e 756d 0a20 2020 2020   = col_num.     
-00036fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036ff0: 2020 2020 2020 2069 6620 636f 6c5f 6e75         if col_nu
-00037000: 6d20 3e20 7370 616e 5f6d 6178 3a0a 2020  m > span_max:.  
-00037010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037020: 2020 2020 2020 2020 2020 2020 2020 7370                sp
-00037030: 616e 5f6d 6178 203d 2063 6f6c 5f6e 756d  an_max = col_num
-00037040: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00037050: 2072 6f77 5f6e 756d 2069 6e20 7365 6c66   row_num in self
-00037060: 2e63 6f6d 6d65 6e74 733a 0a20 2020 2020  .comments:.     
-00037070: 2020 2020 2020 2020 2020 2023 2043 616c             # Cal
-00037080: 6375 6c61 7465 2073 7061 6e73 2066 6f72  culate spans for
-00037090: 2063 6f6d 6d65 6e74 732e 0a20 2020 2020   comments..     
-000370a0: 2020 2020 2020 2020 2020 2066 6f72 2063             for c
-000370b0: 6f6c 5f6e 756d 2069 6e20 7261 6e67 6528  ol_num in range(
-000370c0: 7365 6c66 2e64 696d 5f63 6f6c 6d69 6e2c  self.dim_colmin,
-000370d0: 2073 656c 662e 6469 6d5f 636f 6c6d 6178   self.dim_colmax
-000370e0: 202b 2031 293a 0a20 2020 2020 2020 2020   + 1):.         
-000370f0: 2020 2020 2020 2020 2020 2069 6620 2872             if (r
-00037100: 6f77 5f6e 756d 2069 6e20 7365 6c66 2e63  ow_num in self.c
-00037110: 6f6d 6d65 6e74 730a 2020 2020 2020 2020  omments.        
-00037120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037130: 2020 2020 616e 6420 636f 6c5f 6e75 6d20      and col_num 
-00037140: 696e 2073 656c 662e 636f 6d6d 656e 7473  in self.comments
-00037150: 5b72 6f77 5f6e 756d 5d29 3a0a 2020 2020  [row_num]):.    
-00037160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037170: 2020 2020 6966 2073 7061 6e5f 6d69 6e20      if span_min 
-00037180: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00037190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000371a0: 2020 2020 2073 7061 6e5f 6d69 6e20 3d20       span_min = 
-000371b0: 636f 6c5f 6e75 6d0a 2020 2020 2020 2020  col_num.        
-000371c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000371d0: 2020 2020 7370 616e 5f6d 6178 203d 2063      span_max = c
-000371e0: 6f6c 5f6e 756d 0a20 2020 2020 2020 2020  ol_num.         
-000371f0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00037200: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00037210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037220: 2069 6620 636f 6c5f 6e75 6d20 3c20 7370   if col_num < sp
-00037230: 616e 5f6d 696e 3a0a 2020 2020 2020 2020  an_min:.        
-00037240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037250: 2020 2020 2020 2020 7370 616e 5f6d 696e          span_min
-00037260: 203d 2063 6f6c 5f6e 756d 0a20 2020 2020   = col_num.     
-00037270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037280: 2020 2020 2020 2069 6620 636f 6c5f 6e75         if col_nu
-00037290: 6d20 3e20 7370 616e 5f6d 6178 3a0a 2020  m > span_max:.  
-000372a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000372b0: 2020 2020 2020 2020 2020 2020 2020 7370                sp
-000372c0: 616e 5f6d 6178 203d 2063 6f6c 5f6e 756d  an_max = col_num
-000372d0: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-000372e0: 2028 2872 6f77 5f6e 756d 202b 2031 2920   ((row_num + 1) 
-000372f0: 2520 3136 203d 3d20 3029 206f 7220 726f  % 16 == 0) or ro
-00037300: 775f 6e75 6d20 3d3d 2073 656c 662e 6469  w_num == self.di
-00037310: 6d5f 726f 776d 6178 3a0a 2020 2020 2020  m_rowmax:.      
-00037320: 2020 2020 2020 2020 2020 7370 616e 5f69            span_i
-00037330: 6e64 6578 203d 2069 6e74 2872 6f77 5f6e  ndex = int(row_n
-00037340: 756d 202f 2031 3629 0a0a 2020 2020 2020  um / 16)..      
-00037350: 2020 2020 2020 2020 2020 6966 2073 7061            if spa
-00037360: 6e5f 6d69 6e20 6973 206e 6f74 204e 6f6e  n_min is not Non
-00037370: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00037380: 2020 2020 2020 2073 7061 6e5f 6d69 6e20         span_min 
-00037390: 2b3d 2031 0a20 2020 2020 2020 2020 2020  += 1.           
-000373a0: 2020 2020 2020 2020 2073 7061 6e5f 6d61           span_ma
-000373b0: 7820 2b3d 2031 0a20 2020 2020 2020 2020  x += 1.         
-000373c0: 2020 2020 2020 2020 2020 2073 7061 6e73             spans
-000373d0: 5b73 7061 6e5f 696e 6465 785d 203d 2022  [span_index] = "
-000373e0: 2573 3a25 7322 2025 2028 7370 616e 5f6d  %s:%s" % (span_m
-000373f0: 696e 2c20 7370 616e 5f6d 6178 290a 2020  in, span_max).  
-00037400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037410: 2020 7370 616e 5f6d 696e 203d 204e 6f6e    span_min = Non
-00037420: 650a 0a20 2020 2020 2020 2073 656c 662e  e..        self.
-00037430: 726f 775f 7370 616e 7320 3d20 7370 616e  row_spans = span
-00037440: 730a 0a20 2020 2064 6566 205f 7772 6974  s..    def _writ
-00037450: 655f 726f 7728 7365 6c66 2c20 726f 772c  e_row(self, row,
-00037460: 2073 7061 6e73 2c20 7072 6f70 6572 7469   spans, properti
-00037470: 6573 3d4e 6f6e 652c 2065 6d70 7479 5f72  es=None, empty_r
-00037480: 6f77 3d46 616c 7365 293a 0a20 2020 2020  ow=False):.     
-00037490: 2020 2023 2057 7269 7465 2074 6865 203c     # Write the <
-000374a0: 726f 773e 2065 6c65 6d65 6e74 2e0a 2020  row> element..  
-000374b0: 2020 2020 2020 7866 5f69 6e64 6578 203d        xf_index =
-000374c0: 2030 0a0a 2020 2020 2020 2020 6966 2070   0..        if p
-000374d0: 726f 7065 7274 6965 733a 0a20 2020 2020  roperties:.     
-000374e0: 2020 2020 2020 2068 6569 6768 742c 2063         height, c
-000374f0: 656c 6c5f 666f 726d 6174 2c20 6869 6464  ell_format, hidd
-00037500: 656e 2c20 6c65 7665 6c2c 2063 6f6c 6c61  en, level, colla
-00037510: 7073 6564 203d 2070 726f 7065 7274 6965  psed = propertie
-00037520: 730a 2020 2020 2020 2020 656c 7365 3a0a  s.        else:.
-00037530: 2020 2020 2020 2020 2020 2020 6865 6967              heig
-00037540: 6874 2c20 6365 6c6c 5f66 6f72 6d61 742c  ht, cell_format,
-00037550: 2068 6964 6465 6e2c 206c 6576 656c 2c20   hidden, level, 
-00037560: 636f 6c6c 6170 7365 6420 3d20 4e6f 6e65  collapsed = None
-00037570: 2c20 4e6f 6e65 2c20 302c 2030 2c20 300a  , None, 0, 0, 0.
-00037580: 0a20 2020 2020 2020 2069 6620 6865 6967  .        if heig
-00037590: 6874 2069 7320 4e6f 6e65 3a0a 2020 2020  ht is None:.    
-000375a0: 2020 2020 2020 2020 6865 6967 6874 203d          height =
-000375b0: 2073 656c 662e 6465 6661 756c 745f 726f   self.default_ro
-000375c0: 775f 6865 6967 6874 0a0a 2020 2020 2020  w_height..      
-000375d0: 2020 6174 7472 6962 7574 6573 203d 205b    attributes = [
-000375e0: 2827 7227 2c20 726f 7720 2b20 3129 5d0a  ('r', row + 1)].
-000375f0: 0a20 2020 2020 2020 2023 2047 6574 2074  .        # Get t
-00037600: 6865 2063 656c 6c5f 666f 726d 6174 2069  he cell_format i
-00037610: 6e64 6578 2e0a 2020 2020 2020 2020 6966  ndex..        if
-00037620: 2063 656c 6c5f 666f 726d 6174 3a0a 2020   cell_format:.  
-00037630: 2020 2020 2020 2020 2020 7866 5f69 6e64            xf_ind
-00037640: 6578 203d 2063 656c 6c5f 666f 726d 6174  ex = cell_format
-00037650: 2e5f 6765 745f 7866 5f69 6e64 6578 2829  ._get_xf_index()
-00037660: 0a0a 2020 2020 2020 2020 2320 4164 6420  ..        # Add 
-00037670: 726f 7720 6174 7472 6962 7574 6573 2077  row attributes w
-00037680: 6865 7265 2061 7070 6c69 6361 626c 652e  here applicable.
-00037690: 0a20 2020 2020 2020 2069 6620 7370 616e  .        if span
-000376a0: 733a 0a20 2020 2020 2020 2020 2020 2061  s:.            a
-000376b0: 7474 7269 6275 7465 732e 6170 7065 6e64  ttributes.append
-000376c0: 2828 2773 7061 6e73 272c 2073 7061 6e73  (('spans', spans
-000376d0: 2929 0a0a 2020 2020 2020 2020 6966 2078  ))..        if x
-000376e0: 665f 696e 6465 783a 0a20 2020 2020 2020  f_index:.       
-000376f0: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
-00037700: 6170 7065 6e64 2828 2773 272c 2078 665f  append(('s', xf_
-00037710: 696e 6465 7829 290a 0a20 2020 2020 2020  index))..       
-00037720: 2069 6620 6365 6c6c 5f66 6f72 6d61 743a   if cell_format:
-00037730: 0a20 2020 2020 2020 2020 2020 2061 7474  .            att
-00037740: 7269 6275 7465 732e 6170 7065 6e64 2828  ributes.append((
-00037750: 2763 7573 746f 6d46 6f72 6d61 7427 2c20  'customFormat', 
-00037760: 3129 290a 0a20 2020 2020 2020 2069 6620  1))..        if 
-00037770: 6865 6967 6874 2021 3d20 7365 6c66 2e6f  height != self.o
-00037780: 7269 6769 6e61 6c5f 726f 775f 6865 6967  riginal_row_heig
-00037790: 6874 3a0a 2020 2020 2020 2020 2020 2020  ht:.            
-000377a0: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
-000377b0: 6428 2827 6874 272c 2022 2567 2220 2520  d(('ht', "%g" % 
-000377c0: 6865 6967 6874 2929 0a0a 2020 2020 2020  height))..      
-000377d0: 2020 6966 2068 6964 6465 6e3a 0a20 2020    if hidden:.   
-000377e0: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
-000377f0: 7465 732e 6170 7065 6e64 2828 2768 6964  tes.append(('hid
-00037800: 6465 6e27 2c20 3129 290a 0a20 2020 2020  den', 1))..     
-00037810: 2020 2069 6620 6865 6967 6874 2021 3d20     if height != 
-00037820: 7365 6c66 2e6f 7269 6769 6e61 6c5f 726f  self.original_ro
-00037830: 775f 6865 6967 6874 3a0a 2020 2020 2020  w_height:.      
-00037840: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-00037850: 2e61 7070 656e 6428 2827 6375 7374 6f6d  .append(('custom
-00037860: 4865 6967 6874 272c 2031 2929 0a0a 2020  Height', 1))..  
-00037870: 2020 2020 2020 6966 206c 6576 656c 3a0a        if level:.
+00036600: 7365 6c66 2e5f 7772 6974 655f 726f 7728  self._write_row(
+00036610: 726f 775f 6e75 6d2c 2073 7061 6e2c 2073  row_num, span, s
+00036620: 656c 662e 7365 745f 726f 7773 5b72 6f77  elf.set_rows[row
+00036630: 5f6e 756d 5d29 0a0a 2020 2020 2020 2020  _num])..        
+00036640: 2020 2020 2020 2020 666f 7220 636f 6c5f          for col_
+00036650: 6e75 6d20 696e 2072 616e 6765 2873 656c  num in range(sel
+00036660: 662e 6469 6d5f 636f 6c6d 696e 2c20 7365  f.dim_colmin, se
+00036670: 6c66 2e64 696d 5f63 6f6c 6d61 7820 2b20  lf.dim_colmax + 
+00036680: 3129 3a0a 2020 2020 2020 2020 2020 2020  1):.            
+00036690: 2020 2020 2020 2020 6966 2063 6f6c 5f6e          if col_n
+000366a0: 756d 2069 6e20 7365 6c66 2e74 6162 6c65  um in self.table
+000366b0: 5b72 6f77 5f6e 756d 5d3a 0a20 2020 2020  [row_num]:.     
+000366c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000366d0: 2020 2063 6f6c 5f72 6566 203d 2073 656c     col_ref = sel
+000366e0: 662e 7461 626c 655b 726f 775f 6e75 6d5d  f.table[row_num]
+000366f0: 5b63 6f6c 5f6e 756d 5d0a 2020 2020 2020  [col_num].      
+00036700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036710: 2020 7365 6c66 2e5f 7772 6974 655f 6365    self._write_ce
+00036720: 6c6c 2872 6f77 5f6e 756d 2c20 636f 6c5f  ll(row_num, col_
+00036730: 6e75 6d2c 2063 6f6c 5f72 6566 290a 0a20  num, col_ref).. 
+00036740: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00036750: 656c 662e 5f78 6d6c 5f65 6e64 5f74 6167  elf._xml_end_tag
+00036760: 2822 726f 7722 290a 2020 2020 2020 2020  ("row").        
+00036770: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00036780: 2020 2020 2020 2020 2020 2320 526f 7720            # Row 
+00036790: 6174 7472 6962 7574 6573 206f 7220 636f  attributes or co
+000367a0: 6d6d 656e 7473 206f 6e6c 792e 0a20 2020  mments only..   
+000367b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000367c0: 662e 5f77 7269 7465 5f65 6d70 7479 5f72  f._write_empty_r
+000367d0: 6f77 2872 6f77 5f6e 756d 2c20 7370 616e  ow(row_num, span
+000367e0: 2c20 7365 6c66 2e73 6574 5f72 6f77 735b  , self.set_rows[
+000367f0: 726f 775f 6e75 6d5d 290a 0a20 2020 2020  row_num])..     
+00036800: 2020 2023 2052 6573 6574 2074 6162 6c65     # Reset table
+00036810: 2e0a 2020 2020 2020 2020 7365 6c66 2e74  ..        self.t
+00036820: 6162 6c65 2e63 6c65 6172 2829 0a0a 2020  able.clear()..  
+00036830: 2020 6465 6620 5f63 616c 6375 6c61 7465    def _calculate
+00036840: 5f73 7061 6e73 2873 656c 6629 3a0a 2020  _spans(self):.  
+00036850: 2020 2020 2020 2320 4361 6c63 756c 6174        # Calculat
+00036860: 6520 7468 6520 2273 7061 6e73 2220 6174  e the "spans" at
+00036870: 7472 6962 7574 6520 6f66 2074 6865 203c  tribute of the <
+00036880: 726f 773e 2074 6167 2e20 5468 6973 2069  row> tag. This i
+00036890: 7320 616e 0a20 2020 2020 2020 2023 2058  s an.        # X
+000368a0: 4c53 5820 6f70 7469 6d69 7a61 7469 6f6e  LSX optimization
+000368b0: 2061 6e64 2069 736e 2774 2073 7472 6963   and isn't stric
+000368c0: 746c 7920 7265 7175 6972 6564 2e20 486f  tly required. Ho
+000368d0: 7765 7665 722c 2069 740a 2020 2020 2020  wever, it.      
+000368e0: 2020 2320 6d61 6b65 7320 636f 6d70 6172    # makes compar
+000368f0: 696e 6720 6669 6c65 7320 6561 7369 6572  ing files easier
+00036900: 2e20 5468 6520 7370 616e 2069 7320 7468  . The span is th
+00036910: 6520 7361 6d65 2066 6f72 2065 6163 680a  e same for each.
+00036920: 2020 2020 2020 2020 2320 626c 6f63 6b20          # block 
+00036930: 6f66 2031 3620 726f 7773 2e0a 2020 2020  of 16 rows..    
+00036940: 2020 2020 7370 616e 7320 3d20 7b7d 0a20      spans = {}. 
+00036950: 2020 2020 2020 2073 7061 6e5f 6d69 6e20         span_min 
+00036960: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
+00036970: 7061 6e5f 6d61 7820 3d20 4e6f 6e65 0a0a  pan_max = None..
+00036980: 2020 2020 2020 2020 666f 7220 726f 775f          for row_
+00036990: 6e75 6d20 696e 2072 616e 6765 2873 656c  num in range(sel
+000369a0: 662e 6469 6d5f 726f 776d 696e 2c20 7365  f.dim_rowmin, se
+000369b0: 6c66 2e64 696d 5f72 6f77 6d61 7820 2b20  lf.dim_rowmax + 
+000369c0: 3129 3a0a 2020 2020 2020 2020 2020 2020  1):.            
+000369d0: 6966 2072 6f77 5f6e 756d 2069 6e20 7365  if row_num in se
+000369e0: 6c66 2e74 6162 6c65 3a0a 2020 2020 2020  lf.table:.      
+000369f0: 2020 2020 2020 2020 2020 2320 4361 6c63            # Calc
+00036a00: 756c 6174 6520 7370 616e 7320 666f 7220  ulate spans for 
+00036a10: 6365 6c6c 2064 6174 612e 0a20 2020 2020  cell data..     
+00036a20: 2020 2020 2020 2020 2020 2066 6f72 2063             for c
+00036a30: 6f6c 5f6e 756d 2069 6e20 7261 6e67 6528  ol_num in range(
+00036a40: 7365 6c66 2e64 696d 5f63 6f6c 6d69 6e2c  self.dim_colmin,
+00036a50: 2073 656c 662e 6469 6d5f 636f 6c6d 6178   self.dim_colmax
+00036a60: 202b 2031 293a 0a20 2020 2020 2020 2020   + 1):.         
+00036a70: 2020 2020 2020 2020 2020 2069 6620 636f             if co
+00036a80: 6c5f 6e75 6d20 696e 2073 656c 662e 7461  l_num in self.ta
+00036a90: 626c 655b 726f 775f 6e75 6d5d 3a0a 2020  ble[row_num]:.  
+00036aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036ab0: 2020 2020 2020 6966 2073 7061 6e5f 6d69        if span_mi
+00036ac0: 6e20 6973 204e 6f6e 653a 0a20 2020 2020  n is None:.     
+00036ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036ae0: 2020 2020 2020 2073 7061 6e5f 6d69 6e20         span_min 
+00036af0: 3d20 636f 6c5f 6e75 6d0a 2020 2020 2020  = col_num.      
+00036b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036b10: 2020 2020 2020 7370 616e 5f6d 6178 203d        span_max =
+00036b20: 2063 6f6c 5f6e 756d 0a20 2020 2020 2020   col_num.       
+00036b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036b40: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00036b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036b60: 2020 2069 6620 636f 6c5f 6e75 6d20 3c20     if col_num < 
+00036b70: 7370 616e 5f6d 696e 3a0a 2020 2020 2020  span_min:.      
+00036b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036b90: 2020 2020 2020 2020 2020 7370 616e 5f6d            span_m
+00036ba0: 696e 203d 2063 6f6c 5f6e 756d 0a20 2020  in = col_num.   
+00036bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036bc0: 2020 2020 2020 2020 2069 6620 636f 6c5f           if col_
+00036bd0: 6e75 6d20 3e20 7370 616e 5f6d 6178 3a0a  num > span_max:.
+00036be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036c00: 7370 616e 5f6d 6178 203d 2063 6f6c 5f6e  span_max = col_n
+00036c10: 756d 0a0a 2020 2020 2020 2020 2020 2020  um..            
+00036c20: 6966 2072 6f77 5f6e 756d 2069 6e20 7365  if row_num in se
+00036c30: 6c66 2e63 6f6d 6d65 6e74 733a 0a20 2020  lf.comments:.   
+00036c40: 2020 2020 2020 2020 2020 2020 2023 2043               # C
+00036c50: 616c 6375 6c61 7465 2073 7061 6e73 2066  alculate spans f
+00036c60: 6f72 2063 6f6d 6d65 6e74 732e 0a20 2020  or comments..   
+00036c70: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00036c80: 2063 6f6c 5f6e 756d 2069 6e20 7261 6e67   col_num in rang
+00036c90: 6528 7365 6c66 2e64 696d 5f63 6f6c 6d69  e(self.dim_colmi
+00036ca0: 6e2c 2073 656c 662e 6469 6d5f 636f 6c6d  n, self.dim_colm
+00036cb0: 6178 202b 2031 293a 0a20 2020 2020 2020  ax + 1):.       
+00036cc0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00036cd0: 726f 775f 6e75 6d20 696e 2073 656c 662e  row_num in self.
+00036ce0: 636f 6d6d 656e 7473 2061 6e64 2063 6f6c  comments and col
+00036cf0: 5f6e 756d 2069 6e20 7365 6c66 2e63 6f6d  _num in self.com
+00036d00: 6d65 6e74 735b 726f 775f 6e75 6d5d 3a0a  ments[row_num]:.
+00036d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036d20: 2020 2020 2020 2020 6966 2073 7061 6e5f          if span_
+00036d30: 6d69 6e20 6973 204e 6f6e 653a 0a20 2020  min is None:.   
+00036d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036d50: 2020 2020 2020 2020 2073 7061 6e5f 6d69           span_mi
+00036d60: 6e20 3d20 636f 6c5f 6e75 6d0a 2020 2020  n = col_num.    
+00036d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036d80: 2020 2020 2020 2020 7370 616e 5f6d 6178          span_max
+00036d90: 203d 2063 6f6c 5f6e 756d 0a20 2020 2020   = col_num.     
+00036da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036db0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00036dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036dd0: 2020 2020 2069 6620 636f 6c5f 6e75 6d20       if col_num 
+00036de0: 3c20 7370 616e 5f6d 696e 3a0a 2020 2020  < span_min:.    
+00036df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036e00: 2020 2020 2020 2020 2020 2020 7370 616e              span
+00036e10: 5f6d 696e 203d 2063 6f6c 5f6e 756d 0a20  _min = col_num. 
+00036e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036e30: 2020 2020 2020 2020 2020 2069 6620 636f             if co
+00036e40: 6c5f 6e75 6d20 3e20 7370 616e 5f6d 6178  l_num > span_max
+00036e50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00036e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036e70: 2020 7370 616e 5f6d 6178 203d 2063 6f6c    span_max = col
+00036e80: 5f6e 756d 0a0a 2020 2020 2020 2020 2020  _num..          
+00036e90: 2020 6966 2028 2872 6f77 5f6e 756d 202b    if ((row_num +
+00036ea0: 2031 2920 2520 3136 203d 3d20 3029 206f   1) % 16 == 0) o
+00036eb0: 7220 726f 775f 6e75 6d20 3d3d 2073 656c  r row_num == sel
+00036ec0: 662e 6469 6d5f 726f 776d 6178 3a0a 2020  f.dim_rowmax:.  
+00036ed0: 2020 2020 2020 2020 2020 2020 2020 7370                sp
+00036ee0: 616e 5f69 6e64 6578 203d 2069 6e74 2872  an_index = int(r
+00036ef0: 6f77 5f6e 756d 202f 2031 3629 0a0a 2020  ow_num / 16)..  
+00036f00: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00036f10: 2073 7061 6e5f 6d69 6e20 6973 206e 6f74   span_min is not
+00036f20: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00036f30: 2020 2020 2020 2020 2020 2073 7061 6e5f             span_
+00036f40: 6d69 6e20 2b3d 2031 0a20 2020 2020 2020  min += 1.       
+00036f50: 2020 2020 2020 2020 2020 2020 2073 7061               spa
+00036f60: 6e5f 6d61 7820 2b3d 2031 0a20 2020 2020  n_max += 1.     
+00036f70: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00036f80: 7061 6e73 5b73 7061 6e5f 696e 6465 785d  pans[span_index]
+00036f90: 203d 2022 2573 3a25 7322 2025 2028 7370   = "%s:%s" % (sp
+00036fa0: 616e 5f6d 696e 2c20 7370 616e 5f6d 6178  an_min, span_max
+00036fb0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00036fc0: 2020 2020 2020 7370 616e 5f6d 696e 203d        span_min =
+00036fd0: 204e 6f6e 650a 0a20 2020 2020 2020 2073   None..        s
+00036fe0: 656c 662e 726f 775f 7370 616e 7320 3d20  elf.row_spans = 
+00036ff0: 7370 616e 730a 0a20 2020 2064 6566 205f  spans..    def _
+00037000: 7772 6974 655f 726f 7728 7365 6c66 2c20  write_row(self, 
+00037010: 726f 772c 2073 7061 6e73 2c20 7072 6f70  row, spans, prop
+00037020: 6572 7469 6573 3d4e 6f6e 652c 2065 6d70  erties=None, emp
+00037030: 7479 5f72 6f77 3d46 616c 7365 293a 0a20  ty_row=False):. 
+00037040: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
+00037050: 6865 203c 726f 773e 2065 6c65 6d65 6e74  he <row> element
+00037060: 2e0a 2020 2020 2020 2020 7866 5f69 6e64  ..        xf_ind
+00037070: 6578 203d 2030 0a0a 2020 2020 2020 2020  ex = 0..        
+00037080: 6966 2070 726f 7065 7274 6965 733a 0a20  if properties:. 
+00037090: 2020 2020 2020 2020 2020 2068 6569 6768             heigh
+000370a0: 742c 2063 656c 6c5f 666f 726d 6174 2c20  t, cell_format, 
+000370b0: 6869 6464 656e 2c20 6c65 7665 6c2c 2063  hidden, level, c
+000370c0: 6f6c 6c61 7073 6564 203d 2070 726f 7065  ollapsed = prope
+000370d0: 7274 6965 730a 2020 2020 2020 2020 656c  rties.        el
+000370e0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+000370f0: 6865 6967 6874 2c20 6365 6c6c 5f66 6f72  height, cell_for
+00037100: 6d61 742c 2068 6964 6465 6e2c 206c 6576  mat, hidden, lev
+00037110: 656c 2c20 636f 6c6c 6170 7365 6420 3d20  el, collapsed = 
+00037120: 4e6f 6e65 2c20 4e6f 6e65 2c20 302c 2030  None, None, 0, 0
+00037130: 2c20 300a 0a20 2020 2020 2020 2069 6620  , 0..        if 
+00037140: 6865 6967 6874 2069 7320 4e6f 6e65 3a0a  height is None:.
+00037150: 2020 2020 2020 2020 2020 2020 6865 6967              heig
+00037160: 6874 203d 2073 656c 662e 6465 6661 756c  ht = self.defaul
+00037170: 745f 726f 775f 6865 6967 6874 0a0a 2020  t_row_height..  
+00037180: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
+00037190: 203d 205b 2822 7222 2c20 726f 7720 2b20   = [("r", row + 
+000371a0: 3129 5d0a 0a20 2020 2020 2020 2023 2047  1)]..        # G
+000371b0: 6574 2074 6865 2063 656c 6c5f 666f 726d  et the cell_form
+000371c0: 6174 2069 6e64 6578 2e0a 2020 2020 2020  at index..      
+000371d0: 2020 6966 2063 656c 6c5f 666f 726d 6174    if cell_format
+000371e0: 3a0a 2020 2020 2020 2020 2020 2020 7866  :.            xf
+000371f0: 5f69 6e64 6578 203d 2063 656c 6c5f 666f  _index = cell_fo
+00037200: 726d 6174 2e5f 6765 745f 7866 5f69 6e64  rmat._get_xf_ind
+00037210: 6578 2829 0a0a 2020 2020 2020 2020 2320  ex()..        # 
+00037220: 4164 6420 726f 7720 6174 7472 6962 7574  Add row attribut
+00037230: 6573 2077 6865 7265 2061 7070 6c69 6361  es where applica
+00037240: 626c 652e 0a20 2020 2020 2020 2069 6620  ble..        if 
+00037250: 7370 616e 733a 0a20 2020 2020 2020 2020  spans:.         
+00037260: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
+00037270: 7065 6e64 2828 2273 7061 6e73 222c 2073  pend(("spans", s
+00037280: 7061 6e73 2929 0a0a 2020 2020 2020 2020  pans))..        
+00037290: 6966 2078 665f 696e 6465 783a 0a20 2020  if xf_index:.   
+000372a0: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+000372b0: 7465 732e 6170 7065 6e64 2828 2273 222c  tes.append(("s",
+000372c0: 2078 665f 696e 6465 7829 290a 0a20 2020   xf_index))..   
+000372d0: 2020 2020 2069 6620 6365 6c6c 5f66 6f72       if cell_for
+000372e0: 6d61 743a 0a20 2020 2020 2020 2020 2020  mat:.           
+000372f0: 2061 7474 7269 6275 7465 732e 6170 7065   attributes.appe
+00037300: 6e64 2828 2263 7573 746f 6d46 6f72 6d61  nd(("customForma
+00037310: 7422 2c20 3129 290a 0a20 2020 2020 2020  t", 1))..       
+00037320: 2069 6620 6865 6967 6874 2021 3d20 7365   if height != se
+00037330: 6c66 2e6f 7269 6769 6e61 6c5f 726f 775f  lf.original_row_
+00037340: 6865 6967 6874 3a0a 2020 2020 2020 2020  height:.        
+00037350: 2020 2020 6174 7472 6962 7574 6573 2e61      attributes.a
+00037360: 7070 656e 6428 2822 6874 222c 2022 2567  ppend(("ht", "%g
+00037370: 2220 2520 6865 6967 6874 2929 0a0a 2020  " % height))..  
+00037380: 2020 2020 2020 6966 2068 6964 6465 6e3a        if hidden:
+00037390: 0a20 2020 2020 2020 2020 2020 2061 7474  .            att
+000373a0: 7269 6275 7465 732e 6170 7065 6e64 2828  ributes.append((
+000373b0: 2268 6964 6465 6e22 2c20 3129 290a 0a20  "hidden", 1)).. 
+000373c0: 2020 2020 2020 2069 6620 6865 6967 6874         if height
+000373d0: 2021 3d20 7365 6c66 2e6f 7269 6769 6e61   != self.origina
+000373e0: 6c5f 726f 775f 6865 6967 6874 3a0a 2020  l_row_height:.  
+000373f0: 2020 2020 2020 2020 2020 6174 7472 6962            attrib
+00037400: 7574 6573 2e61 7070 656e 6428 2822 6375  utes.append(("cu
+00037410: 7374 6f6d 4865 6967 6874 222c 2031 2929  stomHeight", 1))
+00037420: 0a0a 2020 2020 2020 2020 6966 206c 6576  ..        if lev
+00037430: 656c 3a0a 2020 2020 2020 2020 2020 2020  el:.            
+00037440: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
+00037450: 6428 2822 6f75 746c 696e 654c 6576 656c  d(("outlineLevel
+00037460: 222c 206c 6576 656c 2929 0a0a 2020 2020  ", level))..    
+00037470: 2020 2020 6966 2063 6f6c 6c61 7073 6564      if collapsed
+00037480: 3a0a 2020 2020 2020 2020 2020 2020 6174  :.            at
+00037490: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
+000374a0: 2822 636f 6c6c 6170 7365 6422 2c20 3129  ("collapsed", 1)
+000374b0: 290a 0a20 2020 2020 2020 2069 6620 7365  )..        if se
+000374c0: 6c66 2e65 7863 656c 5f76 6572 7369 6f6e  lf.excel_version
+000374d0: 203d 3d20 3230 3130 3a0a 2020 2020 2020   == 2010:.      
+000374e0: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
+000374f0: 2e61 7070 656e 6428 2822 7831 3461 633a  .append(("x14ac:
+00037500: 6479 4465 7363 656e 7422 2c20 2230 2e32  dyDescent", "0.2
+00037510: 3522 2929 0a0a 2020 2020 2020 2020 6966  5"))..        if
+00037520: 2065 6d70 7479 5f72 6f77 3a0a 2020 2020   empty_row:.    
+00037530: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
+00037540: 6c5f 656d 7074 795f 7461 675f 756e 656e  l_empty_tag_unen
+00037550: 636f 6465 6428 2272 6f77 222c 2061 7474  coded("row", att
+00037560: 7269 6275 7465 7329 0a20 2020 2020 2020  ributes).       
+00037570: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00037580: 2020 2073 656c 662e 5f78 6d6c 5f73 7461     self._xml_sta
+00037590: 7274 5f74 6167 5f75 6e65 6e63 6f64 6564  rt_tag_unencoded
+000375a0: 2822 726f 7722 2c20 6174 7472 6962 7574  ("row", attribut
+000375b0: 6573 290a 0a20 2020 2064 6566 205f 7772  es)..    def _wr
+000375c0: 6974 655f 656d 7074 795f 726f 7728 7365  ite_empty_row(se
+000375d0: 6c66 2c20 726f 772c 2073 7061 6e73 2c20  lf, row, spans, 
+000375e0: 7072 6f70 6572 7469 6573 3d4e 6f6e 6529  properties=None)
+000375f0: 3a0a 2020 2020 2020 2020 2320 5772 6974  :.        # Writ
+00037600: 6520 616e 6420 656d 7074 7920 3c72 6f77  e and empty <row
+00037610: 3e20 656c 656d 656e 742e 0a20 2020 2020  > element..     
+00037620: 2020 2073 656c 662e 5f77 7269 7465 5f72     self._write_r
+00037630: 6f77 2872 6f77 2c20 7370 616e 732c 2070  ow(row, spans, p
+00037640: 726f 7065 7274 6965 732c 2065 6d70 7479  roperties, empty
+00037650: 5f72 6f77 3d54 7275 6529 0a0a 2020 2020  _row=True)..    
+00037660: 6465 6620 5f77 7269 7465 5f63 656c 6c28  def _write_cell(
+00037670: 7365 6c66 2c20 726f 772c 2063 6f6c 2c20  self, row, col, 
+00037680: 6365 6c6c 293a 0a20 2020 2020 2020 2023  cell):.        #
+00037690: 2057 7269 7465 2074 6865 203c 6365 6c6c   Write the <cell
+000376a0: 3e20 656c 656d 656e 742e 0a20 2020 2020  > element..     
+000376b0: 2020 2023 204e 6f74 652e 2054 6869 7320     # Note. This 
+000376c0: 6973 2074 6865 2069 6e6e 6572 6d6f 7374  is the innermost
+000376d0: 206c 6f6f 7020 736f 2065 6666 6963 6965   loop so efficie
+000376e0: 6e63 7920 6973 2069 6d70 6f72 7461 6e74  ncy is important
+000376f0: 2e0a 0a20 2020 2020 2020 2063 656c 6c5f  ...        cell_
+00037700: 7261 6e67 6520 3d20 786c 5f72 6f77 636f  range = xl_rowco
+00037710: 6c5f 746f 5f63 656c 6c5f 6661 7374 2872  l_to_cell_fast(r
+00037720: 6f77 2c20 636f 6c29 0a20 2020 2020 2020  ow, col).       
+00037730: 2061 7474 7269 6275 7465 7320 3d20 5b28   attributes = [(
+00037740: 2272 222c 2063 656c 6c5f 7261 6e67 6529  "r", cell_range)
+00037750: 5d0a 0a20 2020 2020 2020 2069 6620 6365  ]..        if ce
+00037760: 6c6c 2e66 6f72 6d61 743a 0a20 2020 2020  ll.format:.     
+00037770: 2020 2020 2020 2023 2041 6464 2074 6865         # Add the
+00037780: 2063 656c 6c20 666f 726d 6174 2069 6e64   cell format ind
+00037790: 6578 2e0a 2020 2020 2020 2020 2020 2020  ex..            
+000377a0: 7866 5f69 6e64 6578 203d 2063 656c 6c2e  xf_index = cell.
+000377b0: 666f 726d 6174 2e5f 6765 745f 7866 5f69  format._get_xf_i
+000377c0: 6e64 6578 2829 0a20 2020 2020 2020 2020  ndex().         
+000377d0: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
+000377e0: 7065 6e64 2828 2273 222c 2078 665f 696e  pend(("s", xf_in
+000377f0: 6465 7829 290a 2020 2020 2020 2020 656c  dex)).        el
+00037800: 6966 2072 6f77 2069 6e20 7365 6c66 2e73  if row in self.s
+00037810: 6574 5f72 6f77 7320 616e 6420 7365 6c66  et_rows and self
+00037820: 2e73 6574 5f72 6f77 735b 726f 775d 5b31  .set_rows[row][1
+00037830: 5d3a 0a20 2020 2020 2020 2020 2020 2023  ]:.            #
+00037840: 2041 6464 2074 6865 2072 6f77 2066 6f72   Add the row for
+00037850: 6d61 742e 0a20 2020 2020 2020 2020 2020  mat..           
+00037860: 2072 6f77 5f78 6620 3d20 7365 6c66 2e73   row_xf = self.s
+00037870: 6574 5f72 6f77 735b 726f 775d 5b31 5d0a  et_rows[row][1].
 00037880: 2020 2020 2020 2020 2020 2020 6174 7472              attr
-00037890: 6962 7574 6573 2e61 7070 656e 6428 2827  ibutes.append(('
-000378a0: 6f75 746c 696e 654c 6576 656c 272c 206c  outlineLevel', l
-000378b0: 6576 656c 2929 0a0a 2020 2020 2020 2020  evel))..        
-000378c0: 6966 2063 6f6c 6c61 7073 6564 3a0a 2020  if collapsed:.  
-000378d0: 2020 2020 2020 2020 2020 6174 7472 6962            attrib
-000378e0: 7574 6573 2e61 7070 656e 6428 2827 636f  utes.append(('co
-000378f0: 6c6c 6170 7365 6427 2c20 3129 290a 0a20  llapsed', 1)).. 
-00037900: 2020 2020 2020 2069 6620 7365 6c66 2e65         if self.e
-00037910: 7863 656c 5f76 6572 7369 6f6e 203d 3d20  xcel_version == 
-00037920: 3230 3130 3a0a 2020 2020 2020 2020 2020  2010:.          
-00037930: 2020 6174 7472 6962 7574 6573 2e61 7070    attributes.app
-00037940: 656e 6428 2827 7831 3461 633a 6479 4465  end(('x14ac:dyDe
-00037950: 7363 656e 7427 2c20 2730 2e32 3527 2929  scent', '0.25'))
-00037960: 0a0a 2020 2020 2020 2020 6966 2065 6d70  ..        if emp
-00037970: 7479 5f72 6f77 3a0a 2020 2020 2020 2020  ty_row:.        
-00037980: 2020 2020 7365 6c66 2e5f 786d 6c5f 656d      self._xml_em
-00037990: 7074 795f 7461 675f 756e 656e 636f 6465  pty_tag_unencode
-000379a0: 6428 2772 6f77 272c 2061 7474 7269 6275  d('row', attribu
-000379b0: 7465 7329 0a20 2020 2020 2020 2065 6c73  tes).        els
-000379c0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-000379d0: 656c 662e 5f78 6d6c 5f73 7461 7274 5f74  elf._xml_start_t
-000379e0: 6167 5f75 6e65 6e63 6f64 6564 2827 726f  ag_unencoded('ro
-000379f0: 7727 2c20 6174 7472 6962 7574 6573 290a  w', attributes).
-00037a00: 0a20 2020 2064 6566 205f 7772 6974 655f  .    def _write_
-00037a10: 656d 7074 795f 726f 7728 7365 6c66 2c20  empty_row(self, 
-00037a20: 726f 772c 2073 7061 6e73 2c20 7072 6f70  row, spans, prop
-00037a30: 6572 7469 6573 3d4e 6f6e 6529 3a0a 2020  erties=None):.  
-00037a40: 2020 2020 2020 2320 5772 6974 6520 616e        # Write an
-00037a50: 6420 656d 7074 7920 3c72 6f77 3e20 656c  d empty <row> el
-00037a60: 656d 656e 742e 0a20 2020 2020 2020 2073  ement..        s
-00037a70: 656c 662e 5f77 7269 7465 5f72 6f77 2872  elf._write_row(r
-00037a80: 6f77 2c20 7370 616e 732c 2070 726f 7065  ow, spans, prope
-00037a90: 7274 6965 732c 2065 6d70 7479 5f72 6f77  rties, empty_row
-00037aa0: 3d54 7275 6529 0a0a 2020 2020 6465 6620  =True)..    def 
-00037ab0: 5f77 7269 7465 5f63 656c 6c28 7365 6c66  _write_cell(self
-00037ac0: 2c20 726f 772c 2063 6f6c 2c20 6365 6c6c  , row, col, cell
-00037ad0: 293a 0a20 2020 2020 2020 2023 2057 7269  ):.        # Wri
-00037ae0: 7465 2074 6865 203c 6365 6c6c 3e20 656c  te the <cell> el
-00037af0: 656d 656e 742e 0a20 2020 2020 2020 2023  ement..        #
-00037b00: 204e 6f74 652e 2054 6869 7320 6973 2074   Note. This is t
-00037b10: 6865 2069 6e6e 6572 6d6f 7374 206c 6f6f  he innermost loo
-00037b20: 7020 736f 2065 6666 6963 6965 6e63 7920  p so efficiency 
-00037b30: 6973 2069 6d70 6f72 7461 6e74 2e0a 0a20  is important... 
-00037b40: 2020 2020 2020 2063 656c 6c5f 7261 6e67         cell_rang
-00037b50: 6520 3d20 786c 5f72 6f77 636f 6c5f 746f  e = xl_rowcol_to
-00037b60: 5f63 656c 6c5f 6661 7374 2872 6f77 2c20  _cell_fast(row, 
-00037b70: 636f 6c29 0a20 2020 2020 2020 2061 7474  col).        att
-00037b80: 7269 6275 7465 7320 3d20 5b28 2772 272c  ributes = [('r',
-00037b90: 2063 656c 6c5f 7261 6e67 6529 5d0a 0a20   cell_range)].. 
-00037ba0: 2020 2020 2020 2069 6620 6365 6c6c 2e66         if cell.f
-00037bb0: 6f72 6d61 743a 0a20 2020 2020 2020 2020  ormat:.         
-00037bc0: 2020 2023 2041 6464 2074 6865 2063 656c     # Add the cel
-00037bd0: 6c20 666f 726d 6174 2069 6e64 6578 2e0a  l format index..
-00037be0: 2020 2020 2020 2020 2020 2020 7866 5f69              xf_i
-00037bf0: 6e64 6578 203d 2063 656c 6c2e 666f 726d  ndex = cell.form
-00037c00: 6174 2e5f 6765 745f 7866 5f69 6e64 6578  at._get_xf_index
-00037c10: 2829 0a20 2020 2020 2020 2020 2020 2061  ().            a
-00037c20: 7474 7269 6275 7465 732e 6170 7065 6e64  ttributes.append
-00037c30: 2828 2773 272c 2078 665f 696e 6465 7829  (('s', xf_index)
-00037c40: 290a 2020 2020 2020 2020 656c 6966 2072  ).        elif r
-00037c50: 6f77 2069 6e20 7365 6c66 2e73 6574 5f72  ow in self.set_r
-00037c60: 6f77 7320 616e 6420 7365 6c66 2e73 6574  ows and self.set
-00037c70: 5f72 6f77 735b 726f 775d 5b31 5d3a 0a20  _rows[row][1]:. 
-00037c80: 2020 2020 2020 2020 2020 2023 2041 6464             # Add
-00037c90: 2074 6865 2072 6f77 2066 6f72 6d61 742e   the row format.
-00037ca0: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
-00037cb0: 5f78 6620 3d20 7365 6c66 2e73 6574 5f72  _xf = self.set_r
-00037cc0: 6f77 735b 726f 775d 5b31 5d0a 2020 2020  ows[row][1].    
-00037cd0: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
-00037ce0: 6573 2e61 7070 656e 6428 2827 7327 2c20  es.append(('s', 
-00037cf0: 726f 775f 7866 2e5f 6765 745f 7866 5f69  row_xf._get_xf_i
-00037d00: 6e64 6578 2829 2929 0a20 2020 2020 2020  ndex())).       
-00037d10: 2065 6c69 6620 636f 6c20 696e 2073 656c   elif col in sel
-00037d20: 662e 636f 6c5f 696e 666f 3a0a 2020 2020  f.col_info:.    
-00037d30: 2020 2020 2020 2020 2320 4164 6420 7468          # Add th
-00037d40: 6520 636f 6c75 6d6e 2066 6f72 6d61 742e  e column format.
-00037d50: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-00037d60: 5f78 6620 3d20 7365 6c66 2e63 6f6c 5f69  _xf = self.col_i
-00037d70: 6e66 6f5b 636f 6c5d 5b31 5d0a 2020 2020  nfo[col][1].    
-00037d80: 2020 2020 2020 2020 6966 2063 6f6c 5f78          if col_x
-00037d90: 6620 6973 206e 6f74 204e 6f6e 653a 0a20  f is not None:. 
-00037da0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00037db0: 7474 7269 6275 7465 732e 6170 7065 6e64  ttributes.append
-00037dc0: 2828 2773 272c 2063 6f6c 5f78 662e 5f67  (('s', col_xf._g
-00037dd0: 6574 5f78 665f 696e 6465 7828 2929 290a  et_xf_index())).
-00037de0: 0a20 2020 2020 2020 2074 7970 655f 6365  .        type_ce
-00037df0: 6c6c 5f6e 616d 6520 3d20 6365 6c6c 2e5f  ll_name = cell._
-00037e00: 5f63 6c61 7373 5f5f 2e5f 5f6e 616d 655f  _class__.__name_
-00037e10: 5f0a 0a20 2020 2020 2020 2023 2057 7269  _..        # Wri
-00037e20: 7465 2074 6865 2076 6172 696f 7573 2063  te the various c
-00037e30: 656c 6c20 7479 7065 732e 0a20 2020 2020  ell types..     
-00037e40: 2020 2069 6620 7479 7065 5f63 656c 6c5f     if type_cell_
-00037e50: 6e61 6d65 2069 6e20 2827 4e75 6d62 6572  name in ('Number
-00037e60: 272c 2027 4461 7465 7469 6d65 2729 3a0a  ', 'Datetime'):.
-00037e70: 2020 2020 2020 2020 2020 2020 2320 5772              # Wr
-00037e80: 6974 6520 6120 6e75 6d62 6572 2e0a 2020  ite a number..  
-00037e90: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00037ea0: 786d 6c5f 6e75 6d62 6572 5f65 6c65 6d65  xml_number_eleme
-00037eb0: 6e74 2863 656c 6c2e 6e75 6d62 6572 2c20  nt(cell.number, 
-00037ec0: 6174 7472 6962 7574 6573 290a 0a20 2020  attributes)..   
-00037ed0: 2020 2020 2065 6c69 6620 7479 7065 5f63       elif type_c
-00037ee0: 656c 6c5f 6e61 6d65 2069 6e20 2827 5374  ell_name in ('St
-00037ef0: 7269 6e67 272c 2027 5269 6368 5374 7269  ring', 'RichStri
-00037f00: 6e67 2729 3a0a 2020 2020 2020 2020 2020  ng'):.          
-00037f10: 2020 2320 5772 6974 6520 6120 7374 7269    # Write a stri
-00037f20: 6e67 2e0a 2020 2020 2020 2020 2020 2020  ng..            
-00037f30: 7374 7269 6e67 203d 2063 656c 6c2e 7374  string = cell.st
-00037f40: 7269 6e67 0a0a 2020 2020 2020 2020 2020  ring..          
-00037f50: 2020 6966 206e 6f74 2073 656c 662e 636f    if not self.co
-00037f60: 6e73 7461 6e74 5f6d 656d 6f72 793a 0a20  nstant_memory:. 
-00037f70: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00037f80: 2057 7269 7465 2061 2073 6861 7265 6420   Write a shared 
-00037f90: 7374 7269 6e67 2e0a 2020 2020 2020 2020  string..        
-00037fa0: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
-00037fb0: 6c5f 7374 7269 6e67 5f65 6c65 6d65 6e74  l_string_element
-00037fc0: 2873 7472 696e 672c 2061 7474 7269 6275  (string, attribu
-00037fd0: 7465 7329 0a20 2020 2020 2020 2020 2020  tes).           
-00037fe0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00037ff0: 2020 2020 2020 2023 2057 7269 7465 2061         # Write a
-00038000: 6e20 6f70 7469 6d69 7a65 6420 696e 2d6c  n optimized in-l
-00038010: 696e 6520 7374 7269 6e67 2e0a 0a20 2020  ine string...   
-00038020: 2020 2020 2020 2020 2020 2020 2023 2045               # E
-00038030: 7363 6170 6520 636f 6e74 726f 6c20 6368  scape control ch
-00038040: 6172 6163 7465 7273 2e20 5365 6520 5368  aracters. See Sh
-00038050: 6172 6564 5374 7269 6e67 2e70 6d20 666f  aredString.pm fo
-00038060: 7220 6465 7461 696c 732e 0a20 2020 2020  r details..     
-00038070: 2020 2020 2020 2020 2020 2073 7472 696e             strin
-00038080: 6720 3d20 7265 5f63 6f6e 7472 6f6c 5f63  g = re_control_c
-00038090: 6861 7273 5f31 2e73 7562 2872 275f 7830  hars_1.sub(r'_x0
-000380a0: 3035 465c 3127 2c20 7374 7269 6e67 290a  05F\1', string).
-000380b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000380c0: 7374 7269 6e67 203d 2072 655f 636f 6e74  string = re_cont
-000380d0: 726f 6c5f 6368 6172 735f 322e 7375 6228  rol_chars_2.sub(
-000380e0: 6c61 6d62 6461 206d 6174 6368 3a20 225f  lambda match: "_
-000380f0: 7825 3034 585f 2220 250a 2020 2020 2020  x%04X_" %.      
+00037890: 6962 7574 6573 2e61 7070 656e 6428 2822  ibutes.append(("
+000378a0: 7322 2c20 726f 775f 7866 2e5f 6765 745f  s", row_xf._get_
+000378b0: 7866 5f69 6e64 6578 2829 2929 0a20 2020  xf_index())).   
+000378c0: 2020 2020 2065 6c69 6620 636f 6c20 696e       elif col in
+000378d0: 2073 656c 662e 636f 6c5f 696e 666f 3a0a   self.col_info:.
+000378e0: 2020 2020 2020 2020 2020 2020 2320 4164              # Ad
+000378f0: 6420 7468 6520 636f 6c75 6d6e 2066 6f72  d the column for
+00037900: 6d61 742e 0a20 2020 2020 2020 2020 2020  mat..           
+00037910: 2063 6f6c 5f78 6620 3d20 7365 6c66 2e63   col_xf = self.c
+00037920: 6f6c 5f69 6e66 6f5b 636f 6c5d 5b31 5d0a  ol_info[col][1].
+00037930: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+00037940: 6f6c 5f78 6620 6973 206e 6f74 204e 6f6e  ol_xf is not Non
+00037950: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00037960: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
+00037970: 7065 6e64 2828 2273 222c 2063 6f6c 5f78  pend(("s", col_x
+00037980: 662e 5f67 6574 5f78 665f 696e 6465 7828  f._get_xf_index(
+00037990: 2929 290a 0a20 2020 2020 2020 2074 7970  )))..        typ
+000379a0: 655f 6365 6c6c 5f6e 616d 6520 3d20 6365  e_cell_name = ce
+000379b0: 6c6c 2e5f 5f63 6c61 7373 5f5f 2e5f 5f6e  ll.__class__.__n
+000379c0: 616d 655f 5f0a 0a20 2020 2020 2020 2023  ame__..        #
+000379d0: 2057 7269 7465 2074 6865 2076 6172 696f   Write the vario
+000379e0: 7573 2063 656c 6c20 7479 7065 732e 0a20  us cell types.. 
+000379f0: 2020 2020 2020 2069 6620 7479 7065 5f63         if type_c
+00037a00: 656c 6c5f 6e61 6d65 2069 6e20 2822 4e75  ell_name in ("Nu
+00037a10: 6d62 6572 222c 2022 4461 7465 7469 6d65  mber", "Datetime
+00037a20: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+00037a30: 2320 5772 6974 6520 6120 6e75 6d62 6572  # Write a number
+00037a40: 2e0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00037a50: 6c66 2e5f 786d 6c5f 6e75 6d62 6572 5f65  lf._xml_number_e
+00037a60: 6c65 6d65 6e74 2863 656c 6c2e 6e75 6d62  lement(cell.numb
+00037a70: 6572 2c20 6174 7472 6962 7574 6573 290a  er, attributes).
+00037a80: 0a20 2020 2020 2020 2065 6c69 6620 7479  .        elif ty
+00037a90: 7065 5f63 656c 6c5f 6e61 6d65 2069 6e20  pe_cell_name in 
+00037aa0: 2822 5374 7269 6e67 222c 2022 5269 6368  ("String", "Rich
+00037ab0: 5374 7269 6e67 2229 3a0a 2020 2020 2020  String"):.      
+00037ac0: 2020 2020 2020 2320 5772 6974 6520 6120        # Write a 
+00037ad0: 7374 7269 6e67 2e0a 2020 2020 2020 2020  string..        
+00037ae0: 2020 2020 7374 7269 6e67 203d 2063 656c      string = cel
+00037af0: 6c2e 7374 7269 6e67 0a0a 2020 2020 2020  l.string..      
+00037b00: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+00037b10: 662e 636f 6e73 7461 6e74 5f6d 656d 6f72  f.constant_memor
+00037b20: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+00037b30: 2020 2023 2057 7269 7465 2061 2073 6861     # Write a sha
+00037b40: 7265 6420 7374 7269 6e67 2e0a 2020 2020  red string..    
+00037b50: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00037b60: 2e5f 786d 6c5f 7374 7269 6e67 5f65 6c65  ._xml_string_ele
+00037b70: 6d65 6e74 2873 7472 696e 672c 2061 7474  ment(string, att
+00037b80: 7269 6275 7465 7329 0a20 2020 2020 2020  ributes).       
+00037b90: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00037ba0: 2020 2020 2020 2020 2020 2023 2057 7269             # Wri
+00037bb0: 7465 2061 6e20 6f70 7469 6d69 7a65 6420  te an optimized 
+00037bc0: 696e 2d6c 696e 6520 7374 7269 6e67 2e0a  in-line string..
+00037bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037be0: 2023 2045 7363 6170 6520 636f 6e74 726f   # Escape contro
+00037bf0: 6c20 6368 6172 6163 7465 7273 2e20 5365  l characters. Se
+00037c00: 6520 5368 6172 6564 5374 7269 6e67 2e70  e SharedString.p
+00037c10: 6d20 666f 7220 6465 7461 696c 732e 0a20  m for details.. 
+00037c20: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00037c30: 7472 696e 6720 3d20 7265 5f63 6f6e 7472  tring = re_contr
+00037c40: 6f6c 5f63 6861 7273 5f31 2e73 7562 2872  ol_chars_1.sub(r
+00037c50: 225f 7830 3035 465c 3122 2c20 7374 7269  "_x005F\1", stri
+00037c60: 6e67 290a 2020 2020 2020 2020 2020 2020  ng).            
+00037c70: 2020 2020 7374 7269 6e67 203d 2072 655f      string = re_
+00037c80: 636f 6e74 726f 6c5f 6368 6172 735f 322e  control_chars_2.
+00037c90: 7375 6228 0a20 2020 2020 2020 2020 2020  sub(.           
+00037ca0: 2020 2020 2020 2020 206c 616d 6264 6120           lambda 
+00037cb0: 6d61 7463 683a 2022 5f78 2530 3458 5f22  match: "_x%04X_"
+00037cc0: 2025 206f 7264 286d 6174 6368 2e67 726f   % ord(match.gro
+00037cd0: 7570 2831 2929 2c20 7374 7269 6e67 0a20  up(1)), string. 
+00037ce0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00037cf0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00037d00: 2020 2320 4573 6361 7065 7320 6e6f 6e20    # Escapes non 
+00037d10: 6368 6172 6163 7465 7273 2069 6e20 7374  characters in st
+00037d20: 7269 6e67 732e 0a20 2020 2020 2020 2020  rings..         
+00037d30: 2020 2020 2020 2073 7472 696e 6720 3d20         string = 
+00037d40: 7374 7269 6e67 2e72 6570 6c61 6365 2822  string.replace("
+00037d50: 5c75 4646 4645 222c 2022 5f78 4646 4645  \uFFFE", "_xFFFE
+00037d60: 5f22 290a 2020 2020 2020 2020 2020 2020  _").            
+00037d70: 2020 2020 7374 7269 6e67 203d 2073 7472      string = str
+00037d80: 696e 672e 7265 706c 6163 6528 225c 7546  ing.replace("\uF
+00037d90: 4646 4622 2c20 225f 7846 4646 465f 2229  FFF", "_xFFFF_")
+00037da0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00037db0: 2020 2320 5772 6974 6520 616e 7920 7269    # Write any ri
+00037dc0: 6368 2073 7472 696e 6773 2077 6974 686f  ch strings witho
+00037dd0: 7574 2066 7572 7468 6572 2074 6167 732e  ut further tags.
+00037de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037df0: 2069 6620 7374 7269 6e67 2e73 7461 7274   if string.start
+00037e00: 7377 6974 6828 223c 723e 2229 2061 6e64  swith("<r>") and
+00037e10: 2073 7472 696e 672e 656e 6473 7769 7468   string.endswith
+00037e20: 2822 3c2f 723e 2229 3a0a 2020 2020 2020  ("</r>"):.      
+00037e30: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00037e40: 6c66 2e5f 786d 6c5f 7269 6368 5f69 6e6c  lf._xml_rich_inl
+00037e50: 696e 655f 7374 7269 6e67 2873 7472 696e  ine_string(strin
+00037e60: 672c 2061 7474 7269 6275 7465 7329 0a20  g, attributes). 
+00037e70: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00037e80: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00037e90: 2020 2020 2020 2020 2023 2041 6464 2061           # Add a
+00037ea0: 7474 7269 6275 7465 2074 6f20 7072 6573  ttribute to pres
+00037eb0: 6572 7665 206c 6561 6469 6e67 206f 7220  erve leading or 
+00037ec0: 7472 6169 6c69 6e67 2077 6869 7465 7370  trailing whitesp
+00037ed0: 6163 652e 0a20 2020 2020 2020 2020 2020  ace..           
+00037ee0: 2020 2020 2020 2020 2070 7265 7365 7276           preserv
+00037ef0: 6520 3d20 7072 6573 6572 7665 5f77 6869  e = preserve_whi
+00037f00: 7465 7370 6163 6528 7374 7269 6e67 290a  tespace(string).
+00037f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037f20: 2020 2020 7365 6c66 2e5f 786d 6c5f 696e      self._xml_in
+00037f30: 6c69 6e65 5f73 7472 696e 6728 7374 7269  line_string(stri
+00037f40: 6e67 2c20 7072 6573 6572 7665 2c20 6174  ng, preserve, at
+00037f50: 7472 6962 7574 6573 290a 0a20 2020 2020  tributes)..     
+00037f60: 2020 2065 6c69 6620 7479 7065 5f63 656c     elif type_cel
+00037f70: 6c5f 6e61 6d65 203d 3d20 2246 6f72 6d75  l_name == "Formu
+00037f80: 6c61 223a 0a20 2020 2020 2020 2020 2020  la":.           
+00037f90: 2023 2057 7269 7465 2061 2066 6f72 6d75   # Write a formu
+00037fa0: 6c61 2e20 4669 7273 7420 6368 6563 6b20  la. First check 
+00037fb0: 7468 6520 666f 726d 756c 6120 7661 6c75  the formula valu
+00037fc0: 6520 7479 7065 2e0a 2020 2020 2020 2020  e type..        
+00037fd0: 2020 2020 7661 6c75 6520 3d20 6365 6c6c      value = cell
+00037fe0: 2e76 616c 7565 0a20 2020 2020 2020 2020  .value.         
+00037ff0: 2020 2069 6620 7479 7065 2863 656c 6c2e     if type(cell.
+00038000: 7661 6c75 6529 203d 3d20 626f 6f6c 3a0a  value) == bool:.
+00038010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038020: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
+00038030: 6428 2822 7422 2c20 2262 2229 290a 2020  d(("t", "b")).  
+00038040: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00038050: 2063 656c 6c2e 7661 6c75 653a 0a20 2020   cell.value:.   
+00038060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038070: 2076 616c 7565 203d 2031 0a20 2020 2020   value = 1.     
+00038080: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00038090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000380a0: 2020 2020 2076 616c 7565 203d 2030 0a0a       value = 0..
+000380b0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+000380c0: 2069 7369 6e73 7461 6e63 6528 6365 6c6c   isinstance(cell
+000380d0: 2e76 616c 7565 2c20 7374 7229 3a0a 2020  .value, str):.  
+000380e0: 2020 2020 2020 2020 2020 2020 2020 6572                er
+000380f0: 726f 725f 636f 6465 7320 3d20 280a 2020  ror_codes = (.  
 00038100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038120: 2020 2020 2020 2020 2020 6f72 6428 6d61            ord(ma
-00038130: 7463 682e 6772 6f75 7028 3129 292c 2073  tch.group(1)), s
-00038140: 7472 696e 6729 0a0a 2020 2020 2020 2020  tring)..        
-00038150: 2020 2020 2020 2020 2320 4573 6361 7065          # Escape
-00038160: 7320 6e6f 6e20 6368 6172 6163 7465 7273  s non characters
-00038170: 2069 6e20 7374 7269 6e67 732e 0a20 2020   in strings..   
-00038180: 2020 2020 2020 2020 2020 2020 2073 7472               str
-00038190: 696e 6720 3d20 7374 7269 6e67 2e72 6570  ing = string.rep
-000381a0: 6c61 6365 2827 5c75 4646 4645 272c 2027  lace('\uFFFE', '
-000381b0: 5f78 4646 4645 5f27 290a 2020 2020 2020  _xFFFE_').      
-000381c0: 2020 2020 2020 2020 2020 7374 7269 6e67            string
-000381d0: 203d 2073 7472 696e 672e 7265 706c 6163   = string.replac
-000381e0: 6528 275c 7546 4646 4627 2c20 275f 7846  e('\uFFFF', '_xF
-000381f0: 4646 465f 2729 0a0a 2020 2020 2020 2020  FFF_')..        
-00038200: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
-00038210: 616e 7920 7269 6368 2073 7472 696e 6773  any rich strings
-00038220: 2077 6974 686f 7574 2066 7572 7468 6572   without further
-00038230: 2074 6167 732e 0a20 2020 2020 2020 2020   tags..         
-00038240: 2020 2020 2020 2069 6620 7374 7269 6e67         if string
-00038250: 2e73 7461 7274 7377 6974 6828 273c 723e  .startswith('<r>
-00038260: 2729 2061 6e64 2073 7472 696e 672e 656e  ') and string.en
-00038270: 6473 7769 7468 2827 3c2f 723e 2729 3a0a  dswith('</r>'):.
-00038280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038290: 2020 2020 7365 6c66 2e5f 786d 6c5f 7269      self._xml_ri
-000382a0: 6368 5f69 6e6c 696e 655f 7374 7269 6e67  ch_inline_string
-000382b0: 2873 7472 696e 672c 2061 7474 7269 6275  (string, attribu
-000382c0: 7465 7329 0a20 2020 2020 2020 2020 2020  tes).           
-000382d0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000382e0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-000382f0: 2041 6464 2061 7474 7269 6275 7465 2074   Add attribute t
-00038300: 6f20 7072 6573 6572 7665 206c 6561 6469  o preserve leadi
-00038310: 6e67 206f 7220 7472 6169 6c69 6e67 2077  ng or trailing w
-00038320: 6869 7465 7370 6163 652e 0a20 2020 2020  hitespace..     
-00038330: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00038340: 7265 7365 7276 6520 3d20 7072 6573 6572  reserve = preser
-00038350: 7665 5f77 6869 7465 7370 6163 6528 7374  ve_whitespace(st
-00038360: 7269 6e67 290a 2020 2020 2020 2020 2020  ring).          
-00038370: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00038380: 786d 6c5f 696e 6c69 6e65 5f73 7472 696e  xml_inline_strin
-00038390: 6728 7374 7269 6e67 2c20 7072 6573 6572  g(string, preser
-000383a0: 7665 2c20 6174 7472 6962 7574 6573 290a  ve, attributes).
-000383b0: 0a20 2020 2020 2020 2065 6c69 6620 7479  .        elif ty
-000383c0: 7065 5f63 656c 6c5f 6e61 6d65 203d 3d20  pe_cell_name == 
-000383d0: 2746 6f72 6d75 6c61 273a 0a20 2020 2020  'Formula':.     
-000383e0: 2020 2020 2020 2023 2057 7269 7465 2061         # Write a
-000383f0: 2066 6f72 6d75 6c61 2e20 4669 7273 7420   formula. First 
-00038400: 6368 6563 6b20 7468 6520 666f 726d 756c  check the formul
-00038410: 6120 7661 6c75 6520 7479 7065 2e0a 2020  a value type..  
-00038420: 2020 2020 2020 2020 2020 7661 6c75 6520            value 
-00038430: 3d20 6365 6c6c 2e76 616c 7565 0a20 2020  = cell.value.   
-00038440: 2020 2020 2020 2020 2069 6620 7479 7065           if type
-00038450: 2863 656c 6c2e 7661 6c75 6529 203d 3d20  (cell.value) == 
-00038460: 626f 6f6c 3a0a 2020 2020 2020 2020 2020  bool:.          
-00038470: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-00038480: 2e61 7070 656e 6428 2827 7427 2c20 2762  .append(('t', 'b
-00038490: 2729 290a 2020 2020 2020 2020 2020 2020  ')).            
-000384a0: 2020 2020 6966 2063 656c 6c2e 7661 6c75      if cell.valu
-000384b0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000384c0: 2020 2020 2020 2076 616c 7565 203d 2031         value = 1
-000384d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000384e0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000384f0: 2020 2020 2020 2020 2020 2076 616c 7565             value
-00038500: 203d 2030 0a0a 2020 2020 2020 2020 2020   = 0..          
-00038510: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-00038520: 6528 6365 6c6c 2e76 616c 7565 2c20 7374  e(cell.value, st
-00038530: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-00038540: 2020 2020 6572 726f 725f 636f 6465 7320      error_codes 
-00038550: 3d20 2827 2344 4956 2f30 2127 2c20 2723  = ('#DIV/0!', '#
-00038560: 4e2f 4127 2c20 2723 4e41 4d45 3f27 2c20  N/A', '#NAME?', 
-00038570: 2723 4e55 4c4c 2127 2c0a 2020 2020 2020  '#NULL!',.      
-00038580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038590: 2020 2020 2020 2020 2027 234e 554d 2127           '#NUM!'
-000385a0: 2c20 2723 5245 4621 272c 2027 2356 414c  , '#REF!', '#VAL
-000385b0: 5545 2127 290a 0a20 2020 2020 2020 2020  UE!')..         
-000385c0: 2020 2020 2020 2069 6620 6365 6c6c 2e76         if cell.v
-000385d0: 616c 7565 203d 3d20 2727 3a0a 2020 2020  alue == '':.    
-000385e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000385f0: 2320 416c 6c6f 7720 626c 616e 6b20 746f  # Allow blank to
-00038600: 2066 6f72 6365 2072 6563 616c 6320 696e   force recalc in
-00038610: 2073 6f6d 6520 7468 6972 6420 7061 7274   some third part
-00038620: 7920 6170 7073 2e0a 2020 2020 2020 2020  y apps..        
-00038630: 2020 2020 2020 2020 2020 2020 7061 7373              pass
-00038640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038650: 2065 6c69 6620 6365 6c6c 2e76 616c 7565   elif cell.value
-00038660: 2069 6e20 6572 726f 725f 636f 6465 733a   in error_codes:
-00038670: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038680: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
-00038690: 6170 7065 6e64 2828 2774 272c 2027 6527  append(('t', 'e'
-000386a0: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-000386b0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000386c0: 2020 2020 2020 2020 2020 2020 2061 7474               att
-000386d0: 7269 6275 7465 732e 6170 7065 6e64 2828  ributes.append((
-000386e0: 2774 272c 2027 7374 7227 2929 0a0a 2020  't', 'str'))..  
-000386f0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00038700: 786d 6c5f 666f 726d 756c 615f 656c 656d  xml_formula_elem
-00038710: 656e 7428 6365 6c6c 2e66 6f72 6d75 6c61  ent(cell.formula
-00038720: 2c20 7661 6c75 652c 2061 7474 7269 6275  , value, attribu
-00038730: 7465 7329 0a0a 2020 2020 2020 2020 656c  tes)..        el
-00038740: 6966 2074 7970 655f 6365 6c6c 5f6e 616d  if type_cell_nam
-00038750: 6520 3d3d 2027 4172 7261 7946 6f72 6d75  e == 'ArrayFormu
-00038760: 6c61 273a 0a20 2020 2020 2020 2020 2020  la':.           
-00038770: 2023 2057 7269 7465 2061 2061 7272 6179   # Write a array
-00038780: 2066 6f72 6d75 6c61 2e0a 0a20 2020 2020   formula...     
-00038790: 2020 2020 2020 2069 6620 6365 6c6c 2e61         if cell.a
-000387a0: 7479 7065 203d 3d20 2764 796e 616d 6963  type == 'dynamic
-000387b0: 273a 0a20 2020 2020 2020 2020 2020 2020  ':.             
-000387c0: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
-000387d0: 7065 6e64 2828 2763 6d27 2c20 3129 290a  pend(('cm', 1)).
-000387e0: 0a20 2020 2020 2020 2020 2020 2023 2046  .            # F
-000387f0: 6972 7374 2063 6865 636b 2069 6620 7468  irst check if th
-00038800: 6520 666f 726d 756c 6120 7661 6c75 6520  e formula value 
-00038810: 6973 2061 2073 7472 696e 672e 0a20 2020  is a string..   
-00038820: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
-00038830: 2020 2020 2020 2020 2020 2020 2020 666c                fl
-00038840: 6f61 7428 6365 6c6c 2e76 616c 7565 290a  oat(cell.value).
-00038850: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-00038860: 7074 2056 616c 7565 4572 726f 723a 0a20  pt ValueError:. 
-00038870: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00038880: 7474 7269 6275 7465 732e 6170 7065 6e64  ttributes.append
-00038890: 2828 2774 272c 2027 7374 7227 2929 0a0a  (('t', 'str'))..
-000388a0: 2020 2020 2020 2020 2020 2020 2320 5772              # Wr
-000388b0: 6974 6520 616e 2061 7272 6179 2066 6f72  ite an array for
-000388c0: 6d75 6c61 2e0a 2020 2020 2020 2020 2020  mula..          
-000388d0: 2020 7365 6c66 2e5f 786d 6c5f 7374 6172    self._xml_star
-000388e0: 745f 7461 6728 2763 272c 2061 7474 7269  t_tag('c', attri
-000388f0: 6275 7465 7329 0a0a 2020 2020 2020 2020  butes)..        
-00038900: 2020 2020 7365 6c66 2e5f 7772 6974 655f      self._write_
-00038910: 6365 6c6c 5f61 7272 6179 5f66 6f72 6d75  cell_array_formu
-00038920: 6c61 2863 656c 6c2e 666f 726d 756c 612c  la(cell.formula,
-00038930: 2063 656c 6c2e 7261 6e67 6529 0a20 2020   cell.range).   
-00038940: 2020 2020 2020 2020 2073 656c 662e 5f77           self._w
-00038950: 7269 7465 5f63 656c 6c5f 7661 6c75 6528  rite_cell_value(
-00038960: 6365 6c6c 2e76 616c 7565 290a 2020 2020  cell.value).    
-00038970: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
-00038980: 6c5f 656e 645f 7461 6728 2763 2729 0a0a  l_end_tag('c')..
-00038990: 2020 2020 2020 2020 656c 6966 2074 7970          elif typ
-000389a0: 655f 6365 6c6c 5f6e 616d 6520 3d3d 2027  e_cell_name == '
-000389b0: 426c 616e 6b27 3a0a 2020 2020 2020 2020  Blank':.        
-000389c0: 2020 2020 2320 5772 6974 6520 6120 656d      # Write a em
-000389d0: 7074 7920 6365 6c6c 2e0a 2020 2020 2020  pty cell..      
-000389e0: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
-000389f0: 656d 7074 795f 7461 6728 2763 272c 2061  empty_tag('c', a
-00038a00: 7474 7269 6275 7465 7329 0a0a 2020 2020  ttributes)..    
-00038a10: 2020 2020 656c 6966 2074 7970 655f 6365      elif type_ce
-00038a20: 6c6c 5f6e 616d 6520 3d3d 2027 426f 6f6c  ll_name == 'Bool
-00038a30: 6561 6e27 3a0a 2020 2020 2020 2020 2020  ean':.          
-00038a40: 2020 2320 5772 6974 6520 6120 626f 6f6c    # Write a bool
-00038a50: 6561 6e20 6365 6c6c 2e0a 2020 2020 2020  ean cell..      
-00038a60: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-00038a70: 2e61 7070 656e 6428 2827 7427 2c20 2762  .append(('t', 'b
-00038a80: 2729 290a 2020 2020 2020 2020 2020 2020  ')).            
-00038a90: 7365 6c66 2e5f 786d 6c5f 7374 6172 745f  self._xml_start_
-00038aa0: 7461 6728 2763 272c 2061 7474 7269 6275  tag('c', attribu
-00038ab0: 7465 7329 0a20 2020 2020 2020 2020 2020  tes).           
-00038ac0: 2073 656c 662e 5f77 7269 7465 5f63 656c   self._write_cel
-00038ad0: 6c5f 7661 6c75 6528 6365 6c6c 2e62 6f6f  l_value(cell.boo
-00038ae0: 6c65 616e 290a 2020 2020 2020 2020 2020  lean).          
-00038af0: 2020 7365 6c66 2e5f 786d 6c5f 656e 645f    self._xml_end_
-00038b00: 7461 6728 2763 2729 0a0a 2020 2020 6465  tag('c')..    de
-00038b10: 6620 5f77 7269 7465 5f63 656c 6c5f 7661  f _write_cell_va
-00038b20: 6c75 6528 7365 6c66 2c20 7661 6c75 6529  lue(self, value)
-00038b30: 3a0a 2020 2020 2020 2020 2320 5772 6974  :.        # Writ
-00038b40: 6520 7468 6520 6365 6c6c 2076 616c 7565  e the cell value
-00038b50: 203c 763e 2065 6c65 6d65 6e74 2e0a 2020   <v> element..  
-00038b60: 2020 2020 2020 6966 2076 616c 7565 2069        if value i
-00038b70: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00038b80: 2020 2020 7661 6c75 6520 3d20 2727 0a0a      value = ''..
-00038b90: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
-00038ba0: 6c5f 6461 7461 5f65 6c65 6d65 6e74 2827  l_data_element('
-00038bb0: 7627 2c20 7661 6c75 6529 0a0a 2020 2020  v', value)..    
-00038bc0: 6465 6620 5f77 7269 7465 5f63 656c 6c5f  def _write_cell_
-00038bd0: 6172 7261 795f 666f 726d 756c 6128 7365  array_formula(se
-00038be0: 6c66 2c20 666f 726d 756c 612c 2063 656c  lf, formula, cel
-00038bf0: 6c5f 7261 6e67 6529 3a0a 2020 2020 2020  l_range):.      
-00038c00: 2020 2320 5772 6974 6520 7468 6520 6365    # Write the ce
-00038c10: 6c6c 2061 7272 6179 2066 6f72 6d75 6c61  ll array formula
-00038c20: 203c 663e 2065 6c65 6d65 6e74 2e0a 2020   <f> element..  
-00038c30: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-00038c40: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
-00038c50: 2028 2774 272c 2027 6172 7261 7927 292c   ('t', 'array'),
-00038c60: 0a20 2020 2020 2020 2020 2020 2028 2772  .            ('r
-00038c70: 6566 272c 2063 656c 6c5f 7261 6e67 6529  ef', cell_range)
-00038c80: 0a20 2020 2020 2020 205d 0a0a 2020 2020  .        ]..    
-00038c90: 2020 2020 7365 6c66 2e5f 786d 6c5f 6461      self._xml_da
-00038ca0: 7461 5f65 6c65 6d65 6e74 2827 6627 2c20  ta_element('f', 
-00038cb0: 666f 726d 756c 612c 2061 7474 7269 6275  formula, attribu
-00038cc0: 7465 7329 0a0a 2020 2020 6465 6620 5f77  tes)..    def _w
-00038cd0: 7269 7465 5f73 6865 6574 5f70 7228 7365  rite_sheet_pr(se
-00038ce0: 6c66 293a 0a20 2020 2020 2020 2023 2057  lf):.        # W
-00038cf0: 7269 7465 2074 6865 203c 7368 6565 7450  rite the <sheetP
-00038d00: 723e 2065 6c65 6d65 6e74 2066 6f72 2053  r> element for S
-00038d10: 6865 6574 206c 6576 656c 2070 726f 7065  heet level prope
-00038d20: 7274 6965 732e 0a20 2020 2020 2020 2061  rties..        a
-00038d30: 7474 7269 6275 7465 7320 3d20 5b5d 0a0a  ttributes = []..
-00038d40: 2020 2020 2020 2020 6966 2028 6e6f 7420          if (not 
-00038d50: 7365 6c66 2e66 6974 5f70 6167 650a 2020  self.fit_page.  
-00038d60: 2020 2020 2020 2020 2020 2020 2020 616e                an
-00038d70: 6420 6e6f 7420 7365 6c66 2e66 696c 7465  d not self.filte
-00038d80: 725f 6f6e 0a20 2020 2020 2020 2020 2020  r_on.           
-00038d90: 2020 2020 2061 6e64 206e 6f74 2073 656c       and not sel
-00038da0: 662e 7461 625f 636f 6c6f 720a 2020 2020  f.tab_color.    
-00038db0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00038dc0: 6e6f 7420 7365 6c66 2e6f 7574 6c69 6e65  not self.outline
-00038dd0: 5f63 6861 6e67 6564 0a20 2020 2020 2020  _changed.       
-00038de0: 2020 2020 2020 2020 2061 6e64 206e 6f74           and not
-00038df0: 2073 656c 662e 7662 615f 636f 6465 6e61   self.vba_codena
-00038e00: 6d65 293a 0a20 2020 2020 2020 2020 2020  me):.           
-00038e10: 2072 6574 7572 6e0a 0a20 2020 2020 2020   return..       
-00038e20: 2069 6620 7365 6c66 2e76 6261 5f63 6f64   if self.vba_cod
-00038e30: 656e 616d 653a 0a20 2020 2020 2020 2020  ename:.         
-00038e40: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
-00038e50: 7065 6e64 2828 2763 6f64 654e 616d 6527  pend(('codeName'
-00038e60: 2c20 7365 6c66 2e76 6261 5f63 6f64 656e  , self.vba_coden
-00038e70: 616d 6529 290a 0a20 2020 2020 2020 2069  ame))..        i
-00038e80: 6620 7365 6c66 2e66 696c 7465 725f 6f6e  f self.filter_on
-00038e90: 3a0a 2020 2020 2020 2020 2020 2020 6174  :.            at
-00038ea0: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
-00038eb0: 2827 6669 6c74 6572 4d6f 6465 272c 2031  ('filterMode', 1
-00038ec0: 2929 0a0a 2020 2020 2020 2020 6966 2028  ))..        if (
-00038ed0: 7365 6c66 2e66 6974 5f70 6167 650a 2020  self.fit_page.  
-00038ee0: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-00038ef0: 2073 656c 662e 7461 625f 636f 6c6f 720a   self.tab_color.
-00038f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038f10: 6f72 2073 656c 662e 6f75 746c 696e 655f  or self.outline_
-00038f20: 6368 616e 6765 6429 3a0a 2020 2020 2020  changed):.      
-00038f30: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
-00038f40: 7374 6172 745f 7461 6728 2773 6865 6574  start_tag('sheet
-00038f50: 5072 272c 2061 7474 7269 6275 7465 7329  Pr', attributes)
-00038f60: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00038f70: 662e 5f77 7269 7465 5f74 6162 5f63 6f6c  f._write_tab_col
-00038f80: 6f72 2829 0a20 2020 2020 2020 2020 2020  or().           
-00038f90: 2073 656c 662e 5f77 7269 7465 5f6f 7574   self._write_out
-00038fa0: 6c69 6e65 5f70 7228 290a 2020 2020 2020  line_pr().      
-00038fb0: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
-00038fc0: 655f 7061 6765 5f73 6574 5f75 705f 7072  e_page_set_up_pr
-00038fd0: 2829 0a20 2020 2020 2020 2020 2020 2073  ().            s
-00038fe0: 656c 662e 5f78 6d6c 5f65 6e64 5f74 6167  elf._xml_end_tag
-00038ff0: 2827 7368 6565 7450 7227 290a 2020 2020  ('sheetPr').    
-00039000: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00039010: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
-00039020: 656d 7074 795f 7461 6728 2773 6865 6574  empty_tag('sheet
-00039030: 5072 272c 2061 7474 7269 6275 7465 7329  Pr', attributes)
-00039040: 0a0a 2020 2020 6465 6620 5f77 7269 7465  ..    def _write
-00039050: 5f70 6167 655f 7365 745f 7570 5f70 7228  _page_set_up_pr(
-00039060: 7365 6c66 293a 0a20 2020 2020 2020 2023  self):.        #
-00039070: 2057 7269 7465 2074 6865 203c 7061 6765   Write the <page
-00039080: 5365 7455 7050 723e 2065 6c65 6d65 6e74  SetUpPr> element
-00039090: 2e0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-000390a0: 2073 656c 662e 6669 745f 7061 6765 3a0a   self.fit_page:.
-000390b0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000390c0: 726e 0a0a 2020 2020 2020 2020 6174 7472  rn..        attr
-000390d0: 6962 7574 6573 203d 205b 2827 6669 7454  ibutes = [('fitT
-000390e0: 6f50 6167 6527 2c20 3129 5d0a 2020 2020  oPage', 1)].    
-000390f0: 2020 2020 7365 6c66 2e5f 786d 6c5f 656d      self._xml_em
-00039100: 7074 795f 7461 6728 2770 6167 6553 6574  pty_tag('pageSet
-00039110: 5570 5072 272c 2061 7474 7269 6275 7465  UpPr', attribute
-00039120: 7329 0a0a 2020 2020 6465 6620 5f77 7269  s)..    def _wri
-00039130: 7465 5f74 6162 5f63 6f6c 6f72 2873 656c  te_tab_color(sel
-00039140: 6629 3a0a 2020 2020 2020 2020 2320 5772  f):.        # Wr
-00039150: 6974 6520 7468 6520 3c74 6162 436f 6c6f  ite the <tabColo
-00039160: 723e 2065 6c65 6d65 6e74 2e0a 2020 2020  r> element..    
-00039170: 2020 2020 636f 6c6f 7220 3d20 7365 6c66      color = self
-00039180: 2e74 6162 5f63 6f6c 6f72 0a0a 2020 2020  .tab_color..    
-00039190: 2020 2020 6966 206e 6f74 2063 6f6c 6f72      if not color
-000391a0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-000391b0: 7475 726e 0a0a 2020 2020 2020 2020 6174  turn..        at
-000391c0: 7472 6962 7574 6573 203d 205b 2827 7267  tributes = [('rg
-000391d0: 6227 2c20 636f 6c6f 7229 5d0a 0a20 2020  b', color)]..   
-000391e0: 2020 2020 2073 656c 662e 5f78 6d6c 5f65       self._xml_e
-000391f0: 6d70 7479 5f74 6167 2827 7461 6243 6f6c  mpty_tag('tabCol
-00039200: 6f72 272c 2061 7474 7269 6275 7465 7329  or', attributes)
-00039210: 0a0a 2020 2020 6465 6620 5f77 7269 7465  ..    def _write
-00039220: 5f6f 7574 6c69 6e65 5f70 7228 7365 6c66  _outline_pr(self
-00039230: 293a 0a20 2020 2020 2020 2023 2057 7269  ):.        # Wri
-00039240: 7465 2074 6865 203c 6f75 746c 696e 6550  te the <outlineP
-00039250: 723e 2065 6c65 6d65 6e74 2e0a 2020 2020  r> element..    
-00039260: 2020 2020 6174 7472 6962 7574 6573 203d      attributes =
-00039270: 205b 5d0a 0a20 2020 2020 2020 2069 6620   []..        if 
-00039280: 6e6f 7420 7365 6c66 2e6f 7574 6c69 6e65  not self.outline
-00039290: 5f63 6861 6e67 6564 3a0a 2020 2020 2020  _changed:.      
-000392a0: 2020 2020 2020 7265 7475 726e 0a0a 2020        return..  
-000392b0: 2020 2020 2020 6966 2073 656c 662e 6f75        if self.ou
-000392c0: 746c 696e 655f 7374 796c 653a 0a20 2020  tline_style:.   
-000392d0: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
-000392e0: 7465 732e 6170 7065 6e64 2828 2261 7070  tes.append(("app
-000392f0: 6c79 5374 796c 6573 222c 2031 2929 0a20  lyStyles", 1)). 
-00039300: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-00039310: 6c66 2e6f 7574 6c69 6e65 5f62 656c 6f77  lf.outline_below
-00039320: 3a0a 2020 2020 2020 2020 2020 2020 6174  :.            at
-00039330: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
-00039340: 2822 7375 6d6d 6172 7942 656c 6f77 222c  ("summaryBelow",
-00039350: 2030 2929 0a20 2020 2020 2020 2069 6620   0)).        if 
-00039360: 6e6f 7420 7365 6c66 2e6f 7574 6c69 6e65  not self.outline
-00039370: 5f72 6967 6874 3a0a 2020 2020 2020 2020  _right:.        
-00039380: 2020 2020 6174 7472 6962 7574 6573 2e61      attributes.a
-00039390: 7070 656e 6428 2822 7375 6d6d 6172 7952  ppend(("summaryR
-000393a0: 6967 6874 222c 2030 2929 0a20 2020 2020  ight", 0)).     
-000393b0: 2020 2069 6620 6e6f 7420 7365 6c66 2e6f     if not self.o
-000393c0: 7574 6c69 6e65 5f6f 6e3a 0a20 2020 2020  utline_on:.     
-000393d0: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
-000393e0: 732e 6170 7065 6e64 2828 2273 686f 774f  s.append(("showO
-000393f0: 7574 6c69 6e65 5379 6d62 6f6c 7322 2c20  utlineSymbols", 
-00039400: 3029 290a 0a20 2020 2020 2020 2073 656c  0))..        sel
-00039410: 662e 5f78 6d6c 5f65 6d70 7479 5f74 6167  f._xml_empty_tag
-00039420: 2827 6f75 746c 696e 6550 7227 2c20 6174  ('outlinePr', at
-00039430: 7472 6962 7574 6573 290a 0a20 2020 2064  tributes)..    d
-00039440: 6566 205f 7772 6974 655f 726f 775f 6272  ef _write_row_br
-00039450: 6561 6b73 2873 656c 6629 3a0a 2020 2020  eaks(self):.    
-00039460: 2020 2020 2320 5772 6974 6520 7468 6520      # Write the 
-00039470: 3c72 6f77 4272 6561 6b73 3e20 656c 656d  <rowBreaks> elem
-00039480: 656e 742e 0a20 2020 2020 2020 2070 6167  ent..        pag
-00039490: 655f 6272 6561 6b73 203d 2073 656c 662e  e_breaks = self.
-000394a0: 5f73 6f72 745f 7061 6765 6272 6561 6b73  _sort_pagebreaks
-000394b0: 2873 656c 662e 6862 7265 616b 7329 0a0a  (self.hbreaks)..
-000394c0: 2020 2020 2020 2020 6966 206e 6f74 2070          if not p
-000394d0: 6167 655f 6272 6561 6b73 3a0a 2020 2020  age_breaks:.    
-000394e0: 2020 2020 2020 2020 7265 7475 726e 0a0a          return..
-000394f0: 2020 2020 2020 2020 636f 756e 7420 3d20          count = 
-00039500: 6c65 6e28 7061 6765 5f62 7265 616b 7329  len(page_breaks)
-00039510: 0a0a 2020 2020 2020 2020 6174 7472 6962  ..        attrib
-00039520: 7574 6573 203d 205b 0a20 2020 2020 2020  utes = [.       
-00039530: 2020 2020 2028 2763 6f75 6e74 272c 2063       ('count', c
-00039540: 6f75 6e74 292c 0a20 2020 2020 2020 2020  ount),.         
-00039550: 2020 2028 276d 616e 7561 6c42 7265 616b     ('manualBreak
-00039560: 436f 756e 7427 2c20 636f 756e 7429 2c0a  Count', count),.
-00039570: 2020 2020 2020 2020 5d0a 0a20 2020 2020          ]..     
-00039580: 2020 2073 656c 662e 5f78 6d6c 5f73 7461     self._xml_sta
-00039590: 7274 5f74 6167 2827 726f 7742 7265 616b  rt_tag('rowBreak
-000395a0: 7327 2c20 6174 7472 6962 7574 6573 290a  s', attributes).
-000395b0: 0a20 2020 2020 2020 2066 6f72 2072 6f77  .        for row
-000395c0: 5f6e 756d 2069 6e20 7061 6765 5f62 7265  _num in page_bre
-000395d0: 616b 733a 0a20 2020 2020 2020 2020 2020  aks:.           
-000395e0: 2073 656c 662e 5f77 7269 7465 5f62 726b   self._write_brk
-000395f0: 2872 6f77 5f6e 756d 2c20 3136 3338 3329  (row_num, 16383)
-00039600: 0a0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-00039610: 786d 6c5f 656e 645f 7461 6728 2772 6f77  xml_end_tag('row
-00039620: 4272 6561 6b73 2729 0a0a 2020 2020 6465  Breaks')..    de
-00039630: 6620 5f77 7269 7465 5f63 6f6c 5f62 7265  f _write_col_bre
-00039640: 616b 7328 7365 6c66 293a 0a20 2020 2020  aks(self):.     
-00039650: 2020 2023 2057 7269 7465 2074 6865 203c     # Write the <
-00039660: 636f 6c42 7265 616b 733e 2065 6c65 6d65  colBreaks> eleme
-00039670: 6e74 2e0a 2020 2020 2020 2020 7061 6765  nt..        page
-00039680: 5f62 7265 616b 7320 3d20 7365 6c66 2e5f  _breaks = self._
-00039690: 736f 7274 5f70 6167 6562 7265 616b 7328  sort_pagebreaks(
-000396a0: 7365 6c66 2e76 6272 6561 6b73 290a 0a20  self.vbreaks).. 
-000396b0: 2020 2020 2020 2069 6620 6e6f 7420 7061         if not pa
-000396c0: 6765 5f62 7265 616b 733a 0a20 2020 2020  ge_breaks:.     
-000396d0: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
-000396e0: 2020 2020 2020 2063 6f75 6e74 203d 206c         count = l
-000396f0: 656e 2870 6167 655f 6272 6561 6b73 290a  en(page_breaks).
-00039700: 0a20 2020 2020 2020 2061 7474 7269 6275  .        attribu
-00039710: 7465 7320 3d20 5b0a 2020 2020 2020 2020  tes = [.        
-00039720: 2020 2020 2827 636f 756e 7427 2c20 636f      ('count', co
-00039730: 756e 7429 2c0a 2020 2020 2020 2020 2020  unt),.          
-00039740: 2020 2827 6d61 6e75 616c 4272 6561 6b43    ('manualBreakC
-00039750: 6f75 6e74 272c 2063 6f75 6e74 292c 0a20  ount', count),. 
-00039760: 2020 2020 2020 205d 0a0a 2020 2020 2020         ]..      
-00039770: 2020 7365 6c66 2e5f 786d 6c5f 7374 6172    self._xml_star
-00039780: 745f 7461 6728 2763 6f6c 4272 6561 6b73  t_tag('colBreaks
-00039790: 272c 2061 7474 7269 6275 7465 7329 0a0a  ', attributes)..
-000397a0: 2020 2020 2020 2020 666f 7220 636f 6c5f          for col_
-000397b0: 6e75 6d20 696e 2070 6167 655f 6272 6561  num in page_brea
-000397c0: 6b73 3a0a 2020 2020 2020 2020 2020 2020  ks:.            
-000397d0: 7365 6c66 2e5f 7772 6974 655f 6272 6b28  self._write_brk(
-000397e0: 636f 6c5f 6e75 6d2c 2031 3034 3835 3735  col_num, 1048575
-000397f0: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-00039800: 5f78 6d6c 5f65 6e64 5f74 6167 2827 636f  _xml_end_tag('co
-00039810: 6c42 7265 616b 7327 290a 0a20 2020 2064  lBreaks')..    d
-00039820: 6566 205f 7772 6974 655f 6272 6b28 7365  ef _write_brk(se
-00039830: 6c66 2c20 6272 6b5f 6964 2c20 6272 6b5f  lf, brk_id, brk_
-00039840: 6d61 7829 3a0a 2020 2020 2020 2020 2320  max):.        # 
-00039850: 5772 6974 6520 7468 6520 3c62 726b 3e20  Write the <brk> 
-00039860: 656c 656d 656e 742e 0a20 2020 2020 2020  element..       
-00039870: 2061 7474 7269 6275 7465 7320 3d20 5b0a   attributes = [.
-00039880: 2020 2020 2020 2020 2020 2020 2827 6964              ('id
-00039890: 272c 2062 726b 5f69 6429 2c0a 2020 2020  ', brk_id),.    
-000398a0: 2020 2020 2020 2020 2827 6d61 7827 2c20          ('max', 
-000398b0: 6272 6b5f 6d61 7829 2c0a 2020 2020 2020  brk_max),.      
-000398c0: 2020 2020 2020 2827 6d61 6e27 2c20 3129        ('man', 1)
-000398d0: 5d0a 0a20 2020 2020 2020 2073 656c 662e  ]..        self.
-000398e0: 5f78 6d6c 5f65 6d70 7479 5f74 6167 2827  _xml_empty_tag('
-000398f0: 6272 6b27 2c20 6174 7472 6962 7574 6573  brk', attributes
-00039900: 290a 0a20 2020 2064 6566 205f 7772 6974  )..    def _writ
-00039910: 655f 6d65 7267 655f 6365 6c6c 7328 7365  e_merge_cells(se
-00039920: 6c66 293a 0a20 2020 2020 2020 2023 2057  lf):.        # W
-00039930: 7269 7465 2074 6865 203c 6d65 7267 6543  rite the <mergeC
-00039940: 656c 6c73 3e20 656c 656d 656e 742e 0a20  ells> element.. 
-00039950: 2020 2020 2020 206d 6572 6765 645f 6365         merged_ce
-00039960: 6c6c 7320 3d20 7365 6c66 2e6d 6572 6765  lls = self.merge
-00039970: 0a20 2020 2020 2020 2063 6f75 6e74 203d  .        count =
-00039980: 206c 656e 286d 6572 6765 645f 6365 6c6c   len(merged_cell
-00039990: 7329 0a0a 2020 2020 2020 2020 6966 206e  s)..        if n
-000399a0: 6f74 2063 6f75 6e74 3a0a 2020 2020 2020  ot count:.      
-000399b0: 2020 2020 2020 7265 7475 726e 0a0a 2020        return..  
-000399c0: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-000399d0: 203d 205b 2827 636f 756e 7427 2c20 636f   = [('count', co
-000399e0: 756e 7429 5d0a 0a20 2020 2020 2020 2073  unt)]..        s
-000399f0: 656c 662e 5f78 6d6c 5f73 7461 7274 5f74  elf._xml_start_t
-00039a00: 6167 2827 6d65 7267 6543 656c 6c73 272c  ag('mergeCells',
-00039a10: 2061 7474 7269 6275 7465 7329 0a0a 2020   attributes)..  
-00039a20: 2020 2020 2020 666f 7220 6d65 7267 6564        for merged
-00039a30: 5f72 616e 6765 2069 6e20 6d65 7267 6564  _range in merged
-00039a40: 5f63 656c 6c73 3a0a 0a20 2020 2020 2020  _cells:..       
-00039a50: 2020 2020 2023 2057 7269 7465 2074 6865       # Write the
-00039a60: 206d 6572 6765 4365 6c6c 2065 6c65 6d65   mergeCell eleme
-00039a70: 6e74 2e0a 2020 2020 2020 2020 2020 2020  nt..            
-00039a80: 7365 6c66 2e5f 7772 6974 655f 6d65 7267  self._write_merg
-00039a90: 655f 6365 6c6c 286d 6572 6765 645f 7261  e_cell(merged_ra
-00039aa0: 6e67 6529 0a0a 2020 2020 2020 2020 7365  nge)..        se
-00039ab0: 6c66 2e5f 786d 6c5f 656e 645f 7461 6728  lf._xml_end_tag(
-00039ac0: 276d 6572 6765 4365 6c6c 7327 290a 0a20  'mergeCells').. 
-00039ad0: 2020 2064 6566 205f 7772 6974 655f 6d65     def _write_me
-00039ae0: 7267 655f 6365 6c6c 2873 656c 662c 206d  rge_cell(self, m
-00039af0: 6572 6765 645f 7261 6e67 6529 3a0a 2020  erged_range):.  
-00039b00: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
-00039b10: 6520 3c6d 6572 6765 4365 6c6c 3e20 656c  e <mergeCell> el
-00039b20: 656d 656e 742e 0a20 2020 2020 2020 2028  ement..        (
-00039b30: 726f 775f 6d69 6e2c 2063 6f6c 5f6d 696e  row_min, col_min
-00039b40: 2c20 726f 775f 6d61 782c 2063 6f6c 5f6d  , row_max, col_m
-00039b50: 6178 2920 3d20 6d65 7267 6564 5f72 616e  ax) = merged_ran
-00039b60: 6765 0a0a 2020 2020 2020 2020 2320 436f  ge..        # Co
-00039b70: 6e76 6572 7420 7468 6520 6d65 7267 6520  nvert the merge 
-00039b80: 6469 6d65 6e73 696f 6e73 2074 6f20 6120  dimensions to a 
-00039b90: 6365 6c6c 2072 616e 6765 2e0a 2020 2020  cell range..    
-00039ba0: 2020 2020 6365 6c6c 5f31 203d 2078 6c5f      cell_1 = xl_
-00039bb0: 726f 7763 6f6c 5f74 6f5f 6365 6c6c 2872  rowcol_to_cell(r
-00039bc0: 6f77 5f6d 696e 2c20 636f 6c5f 6d69 6e29  ow_min, col_min)
-00039bd0: 0a20 2020 2020 2020 2063 656c 6c5f 3220  .        cell_2 
-00039be0: 3d20 786c 5f72 6f77 636f 6c5f 746f 5f63  = xl_rowcol_to_c
-00039bf0: 656c 6c28 726f 775f 6d61 782c 2063 6f6c  ell(row_max, col
-00039c00: 5f6d 6178 290a 2020 2020 2020 2020 7265  _max).        re
-00039c10: 6620 3d20 6365 6c6c 5f31 202b 2027 3a27  f = cell_1 + ':'
-00039c20: 202b 2063 656c 6c5f 320a 0a20 2020 2020   + cell_2..     
-00039c30: 2020 2061 7474 7269 6275 7465 7320 3d20     attributes = 
-00039c40: 5b28 2772 6566 272c 2072 6566 295d 0a0a  [('ref', ref)]..
-00039c50: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
-00039c60: 6c5f 656d 7074 795f 7461 6728 276d 6572  l_empty_tag('mer
-00039c70: 6765 4365 6c6c 272c 2061 7474 7269 6275  geCell', attribu
-00039c80: 7465 7329 0a0a 2020 2020 6465 6620 5f77  tes)..    def _w
-00039c90: 7269 7465 5f68 7970 6572 6c69 6e6b 7328  rite_hyperlinks(
-00039ca0: 7365 6c66 293a 0a20 2020 2020 2020 2023  self):.        #
-00039cb0: 2050 726f 6365 7373 2061 6e79 2073 746f   Process any sto
-00039cc0: 7265 6420 6879 7065 726c 696e 6b73 2069  red hyperlinks i
-00039cd0: 6e20 726f 772f 636f 6c20 6f72 6465 7220  n row/col order 
-00039ce0: 616e 6420 7772 6974 6520 7468 650a 2020  and write the.  
-00039cf0: 2020 2020 2020 2320 3c68 7970 6572 6c69        # <hyperli
-00039d00: 6e6b 733e 2065 6c65 6d65 6e74 2e20 5468  nks> element. Th
-00039d10: 6520 6174 7472 6962 7574 6573 2061 7265  e attributes are
-00039d20: 2064 6966 6665 7265 6e74 2066 6f72 2069   different for i
-00039d30: 6e74 6572 6e61 6c0a 2020 2020 2020 2020  nternal.        
-00039d40: 2320 616e 6420 6578 7465 726e 616c 206c  # and external l
-00039d50: 696e 6b73 2e0a 2020 2020 2020 2020 686c  inks..        hl
-00039d60: 696e 6b5f 7265 6673 203d 205b 5d0a 2020  ink_refs = [].  
-00039d70: 2020 2020 2020 6469 7370 6c61 7920 3d20        display = 
-00039d80: 4e6f 6e65 0a0a 2020 2020 2020 2020 2320  None..        # 
-00039d90: 536f 7274 2074 6865 2068 7970 6572 6c69  Sort the hyperli
-00039da0: 6e6b 7320 696e 746f 2072 6f77 206f 7264  nks into row ord
-00039db0: 6572 2e0a 2020 2020 2020 2020 726f 775f  er..        row_
-00039dc0: 6e75 6d73 203d 2073 6f72 7465 6428 7365  nums = sorted(se
-00039dd0: 6c66 2e68 7970 6572 6c69 6e6b 732e 6b65  lf.hyperlinks.ke
-00039de0: 7973 2829 290a 0a20 2020 2020 2020 2023  ys())..        #
-00039df0: 2045 7869 7420 6966 2074 6865 7265 2061   Exit if there a
-00039e00: 7265 206e 6f20 6879 7065 726c 696e 6b73  re no hyperlinks
-00039e10: 2074 6f20 7072 6f63 6573 732e 0a20 2020   to process..   
-00039e20: 2020 2020 2069 6620 6e6f 7420 726f 775f       if not row_
-00039e30: 6e75 6d73 3a0a 2020 2020 2020 2020 2020  nums:.          
-00039e40: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
-00039e50: 2020 2320 4974 6572 6174 6520 6f76 6572    # Iterate over
-00039e60: 2074 6865 2072 6f77 732e 0a20 2020 2020   the rows..     
-00039e70: 2020 2066 6f72 2072 6f77 5f6e 756d 2069     for row_num i
-00039e80: 6e20 726f 775f 6e75 6d73 3a0a 2020 2020  n row_nums:.    
-00039e90: 2020 2020 2020 2020 2320 536f 7274 2074          # Sort t
-00039ea0: 6865 2068 7970 6572 6c69 6e6b 7320 696e  he hyperlinks in
-00039eb0: 746f 2063 6f6c 756d 6e20 6f72 6465 722e  to column order.
-00039ec0: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-00039ed0: 5f6e 756d 7320 3d20 736f 7274 6564 2873  _nums = sorted(s
-00039ee0: 656c 662e 6879 7065 726c 696e 6b73 5b72  elf.hyperlinks[r
-00039ef0: 6f77 5f6e 756d 5d2e 6b65 7973 2829 290a  ow_num].keys()).
-00039f00: 0a20 2020 2020 2020 2020 2020 2023 2049  .            # I
-00039f10: 7465 7261 7465 206f 7665 7220 7468 6520  terate over the 
-00039f20: 636f 6c75 6d6e 732e 0a20 2020 2020 2020  columns..       
-00039f30: 2020 2020 2066 6f72 2063 6f6c 5f6e 756d       for col_num
-00039f40: 2069 6e20 636f 6c5f 6e75 6d73 3a0a 2020   in col_nums:.  
-00039f50: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00039f60: 4765 7420 7468 6520 6c69 6e6b 2064 6174  Get the link dat
-00039f70: 6120 666f 7220 7468 6973 2063 656c 6c2e  a for this cell.
-00039f80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00039f90: 206c 696e 6b20 3d20 7365 6c66 2e68 7970   link = self.hyp
-00039fa0: 6572 6c69 6e6b 735b 726f 775f 6e75 6d5d  erlinks[row_num]
-00039fb0: 5b63 6f6c 5f6e 756d 5d0a 2020 2020 2020  [col_num].      
-00039fc0: 2020 2020 2020 2020 2020 6c69 6e6b 5f74            link_t
-00039fd0: 7970 6520 3d20 6c69 6e6b 5b27 6c69 6e6b  ype = link['link
-00039fe0: 5f74 7970 6527 5d0a 0a20 2020 2020 2020  _type']..       
-00039ff0: 2020 2020 2020 2020 2023 2049 6620 7468           # If th
-0003a000: 6520 6365 6c6c 2069 736e 2774 2061 2073  e cell isn't a s
-0003a010: 7472 696e 6720 7468 656e 2077 6520 6861  tring then we ha
-0003a020: 7665 2074 6f20 6164 6420 7468 6520 7572  ve to add the ur
-0003a030: 6c20 6173 0a20 2020 2020 2020 2020 2020  l as.           
-0003a040: 2020 2020 2023 2074 6865 2073 7472 696e       # the strin
-0003a050: 6720 746f 2064 6973 706c 6179 2e0a 2020  g to display..  
-0003a060: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0003a070: 2028 7365 6c66 2e74 6162 6c65 0a20 2020   (self.table.   
-0003a080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a090: 2020 2020 2061 6e64 2073 656c 662e 7461       and self.ta
-0003a0a0: 626c 655b 726f 775f 6e75 6d5d 0a20 2020  ble[row_num].   
+00038110: 2020 2223 4449 562f 3021 222c 0a20 2020    "#DIV/0!",.   
+00038120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038130: 2022 234e 2f41 222c 0a20 2020 2020 2020   "#N/A",.       
+00038140: 2020 2020 2020 2020 2020 2020 2022 234e               "#N
+00038150: 414d 453f 222c 0a20 2020 2020 2020 2020  AME?",.         
+00038160: 2020 2020 2020 2020 2020 2022 234e 554c             "#NUL
+00038170: 4c21 222c 0a20 2020 2020 2020 2020 2020  L!",.           
+00038180: 2020 2020 2020 2020 2022 234e 554d 2122           "#NUM!"
+00038190: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000381a0: 2020 2020 2020 2223 5245 4621 222c 0a20        "#REF!",. 
+000381b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000381c0: 2020 2022 2356 414c 5545 2122 2c0a 2020     "#VALUE!",.  
+000381d0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+000381e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000381f0: 2069 6620 6365 6c6c 2e76 616c 7565 203d   if cell.value =
+00038200: 3d20 2222 3a0a 2020 2020 2020 2020 2020  = "":.          
+00038210: 2020 2020 2020 2020 2020 2320 416c 6c6f            # Allo
+00038220: 7720 626c 616e 6b20 746f 2066 6f72 6365  w blank to force
+00038230: 2072 6563 616c 6320 696e 2073 6f6d 6520   recalc in some 
+00038240: 7468 6972 6420 7061 7274 7920 6170 7073  third party apps
+00038250: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00038260: 2020 2020 2020 7061 7373 0a20 2020 2020        pass.     
+00038270: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00038280: 6365 6c6c 2e76 616c 7565 2069 6e20 6572  cell.value in er
+00038290: 726f 725f 636f 6465 733a 0a20 2020 2020  ror_codes:.     
+000382a0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000382b0: 7474 7269 6275 7465 732e 6170 7065 6e64  ttributes.append
+000382c0: 2828 2274 222c 2022 6522 2929 0a20 2020  (("t", "e")).   
+000382d0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+000382e0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000382f0: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
+00038300: 732e 6170 7065 6e64 2828 2274 222c 2022  s.append(("t", "
+00038310: 7374 7222 2929 0a0a 2020 2020 2020 2020  str"))..        
+00038320: 2020 2020 7365 6c66 2e5f 786d 6c5f 666f      self._xml_fo
+00038330: 726d 756c 615f 656c 656d 656e 7428 6365  rmula_element(ce
+00038340: 6c6c 2e66 6f72 6d75 6c61 2c20 7661 6c75  ll.formula, valu
+00038350: 652c 2061 7474 7269 6275 7465 7329 0a0a  e, attributes)..
+00038360: 2020 2020 2020 2020 656c 6966 2074 7970          elif typ
+00038370: 655f 6365 6c6c 5f6e 616d 6520 3d3d 2022  e_cell_name == "
+00038380: 4172 7261 7946 6f72 6d75 6c61 223a 0a20  ArrayFormula":. 
+00038390: 2020 2020 2020 2020 2020 2023 2057 7269             # Wri
+000383a0: 7465 2061 2061 7272 6179 2066 6f72 6d75  te a array formu
+000383b0: 6c61 2e0a 0a20 2020 2020 2020 2020 2020  la...           
+000383c0: 2069 6620 6365 6c6c 2e61 7479 7065 203d   if cell.atype =
+000383d0: 3d20 2264 796e 616d 6963 223a 0a20 2020  = "dynamic":.   
+000383e0: 2020 2020 2020 2020 2020 2020 2061 7474               att
+000383f0: 7269 6275 7465 732e 6170 7065 6e64 2828  ributes.append((
+00038400: 2263 6d22 2c20 3129 290a 0a20 2020 2020  "cm", 1))..     
+00038410: 2020 2020 2020 2023 2046 6972 7374 2063         # First c
+00038420: 6865 636b 2069 6620 7468 6520 666f 726d  heck if the form
+00038430: 756c 6120 7661 6c75 6520 6973 2061 2073  ula value is a s
+00038440: 7472 696e 672e 0a20 2020 2020 2020 2020  tring..         
+00038450: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+00038460: 2020 2020 2020 2020 666c 6f61 7428 6365          float(ce
+00038470: 6c6c 2e76 616c 7565 290a 2020 2020 2020  ll.value).      
+00038480: 2020 2020 2020 6578 6365 7074 2056 616c        except Val
+00038490: 7565 4572 726f 723a 0a20 2020 2020 2020  ueError:.       
+000384a0: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+000384b0: 7465 732e 6170 7065 6e64 2828 2274 222c  tes.append(("t",
+000384c0: 2022 7374 7222 2929 0a0a 2020 2020 2020   "str"))..      
+000384d0: 2020 2020 2020 2320 5772 6974 6520 616e        # Write an
+000384e0: 2061 7272 6179 2066 6f72 6d75 6c61 2e0a   array formula..
+000384f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00038500: 2e5f 786d 6c5f 7374 6172 745f 7461 6728  ._xml_start_tag(
+00038510: 2263 222c 2061 7474 7269 6275 7465 7329  "c", attributes)
+00038520: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00038530: 6c66 2e5f 7772 6974 655f 6365 6c6c 5f61  lf._write_cell_a
+00038540: 7272 6179 5f66 6f72 6d75 6c61 2863 656c  rray_formula(cel
+00038550: 6c2e 666f 726d 756c 612c 2063 656c 6c2e  l.formula, cell.
+00038560: 7261 6e67 6529 0a20 2020 2020 2020 2020  range).         
+00038570: 2020 2073 656c 662e 5f77 7269 7465 5f63     self._write_c
+00038580: 656c 6c5f 7661 6c75 6528 6365 6c6c 2e76  ell_value(cell.v
+00038590: 616c 7565 290a 2020 2020 2020 2020 2020  alue).          
+000385a0: 2020 7365 6c66 2e5f 786d 6c5f 656e 645f    self._xml_end_
+000385b0: 7461 6728 2263 2229 0a0a 2020 2020 2020  tag("c")..      
+000385c0: 2020 656c 6966 2074 7970 655f 6365 6c6c    elif type_cell
+000385d0: 5f6e 616d 6520 3d3d 2022 426c 616e 6b22  _name == "Blank"
+000385e0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+000385f0: 5772 6974 6520 6120 656d 7074 7920 6365  Write a empty ce
+00038600: 6c6c 2e0a 2020 2020 2020 2020 2020 2020  ll..            
+00038610: 7365 6c66 2e5f 786d 6c5f 656d 7074 795f  self._xml_empty_
+00038620: 7461 6728 2263 222c 2061 7474 7269 6275  tag("c", attribu
+00038630: 7465 7329 0a0a 2020 2020 2020 2020 656c  tes)..        el
+00038640: 6966 2074 7970 655f 6365 6c6c 5f6e 616d  if type_cell_nam
+00038650: 6520 3d3d 2022 426f 6f6c 6561 6e22 3a0a  e == "Boolean":.
+00038660: 2020 2020 2020 2020 2020 2020 2320 5772              # Wr
+00038670: 6974 6520 6120 626f 6f6c 6561 6e20 6365  ite a boolean ce
+00038680: 6c6c 2e0a 2020 2020 2020 2020 2020 2020  ll..            
+00038690: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
+000386a0: 6428 2822 7422 2c20 2262 2229 290a 2020  d(("t", "b")).  
+000386b0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+000386c0: 786d 6c5f 7374 6172 745f 7461 6728 2263  xml_start_tag("c
+000386d0: 222c 2061 7474 7269 6275 7465 7329 0a20  ", attributes). 
+000386e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000386f0: 5f77 7269 7465 5f63 656c 6c5f 7661 6c75  _write_cell_valu
+00038700: 6528 6365 6c6c 2e62 6f6f 6c65 616e 290a  e(cell.boolean).
+00038710: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00038720: 2e5f 786d 6c5f 656e 645f 7461 6728 2263  ._xml_end_tag("c
+00038730: 2229 0a0a 2020 2020 6465 6620 5f77 7269  ")..    def _wri
+00038740: 7465 5f63 656c 6c5f 7661 6c75 6528 7365  te_cell_value(se
+00038750: 6c66 2c20 7661 6c75 6529 3a0a 2020 2020  lf, value):.    
+00038760: 2020 2020 2320 5772 6974 6520 7468 6520      # Write the 
+00038770: 6365 6c6c 2076 616c 7565 203c 763e 2065  cell value <v> e
+00038780: 6c65 6d65 6e74 2e0a 2020 2020 2020 2020  lement..        
+00038790: 6966 2076 616c 7565 2069 7320 4e6f 6e65  if value is None
+000387a0: 3a0a 2020 2020 2020 2020 2020 2020 7661  :.            va
+000387b0: 6c75 6520 3d20 2222 0a0a 2020 2020 2020  lue = ""..      
+000387c0: 2020 7365 6c66 2e5f 786d 6c5f 6461 7461    self._xml_data
+000387d0: 5f65 6c65 6d65 6e74 2822 7622 2c20 7661  _element("v", va
+000387e0: 6c75 6529 0a0a 2020 2020 6465 6620 5f77  lue)..    def _w
+000387f0: 7269 7465 5f63 656c 6c5f 6172 7261 795f  rite_cell_array_
+00038800: 666f 726d 756c 6128 7365 6c66 2c20 666f  formula(self, fo
+00038810: 726d 756c 612c 2063 656c 6c5f 7261 6e67  rmula, cell_rang
+00038820: 6529 3a0a 2020 2020 2020 2020 2320 5772  e):.        # Wr
+00038830: 6974 6520 7468 6520 6365 6c6c 2061 7272  ite the cell arr
+00038840: 6179 2066 6f72 6d75 6c61 203c 663e 2065  ay formula <f> e
+00038850: 6c65 6d65 6e74 2e0a 2020 2020 2020 2020  lement..        
+00038860: 6174 7472 6962 7574 6573 203d 205b 2822  attributes = [("
+00038870: 7422 2c20 2261 7272 6179 2229 2c20 2822  t", "array"), ("
+00038880: 7265 6622 2c20 6365 6c6c 5f72 616e 6765  ref", cell_range
+00038890: 295d 0a0a 2020 2020 2020 2020 7365 6c66  )]..        self
+000388a0: 2e5f 786d 6c5f 6461 7461 5f65 6c65 6d65  ._xml_data_eleme
+000388b0: 6e74 2822 6622 2c20 666f 726d 756c 612c  nt("f", formula,
+000388c0: 2061 7474 7269 6275 7465 7329 0a0a 2020   attributes)..  
+000388d0: 2020 6465 6620 5f77 7269 7465 5f73 6865    def _write_she
+000388e0: 6574 5f70 7228 7365 6c66 293a 0a20 2020  et_pr(self):.   
+000388f0: 2020 2020 2023 2057 7269 7465 2074 6865       # Write the
+00038900: 203c 7368 6565 7450 723e 2065 6c65 6d65   <sheetPr> eleme
+00038910: 6e74 2066 6f72 2053 6865 6574 206c 6576  nt for Sheet lev
+00038920: 656c 2070 726f 7065 7274 6965 732e 0a20  el properties.. 
+00038930: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
+00038940: 7320 3d20 5b5d 0a0a 2020 2020 2020 2020  s = []..        
+00038950: 6966 2028 0a20 2020 2020 2020 2020 2020  if (.           
+00038960: 206e 6f74 2073 656c 662e 6669 745f 7061   not self.fit_pa
+00038970: 6765 0a20 2020 2020 2020 2020 2020 2061  ge.            a
+00038980: 6e64 206e 6f74 2073 656c 662e 6669 6c74  nd not self.filt
+00038990: 6572 5f6f 6e0a 2020 2020 2020 2020 2020  er_on.          
+000389a0: 2020 616e 6420 6e6f 7420 7365 6c66 2e74    and not self.t
+000389b0: 6162 5f63 6f6c 6f72 0a20 2020 2020 2020  ab_color.       
+000389c0: 2020 2020 2061 6e64 206e 6f74 2073 656c       and not sel
+000389d0: 662e 6f75 746c 696e 655f 6368 616e 6765  f.outline_change
+000389e0: 640a 2020 2020 2020 2020 2020 2020 616e  d.            an
+000389f0: 6420 6e6f 7420 7365 6c66 2e76 6261 5f63  d not self.vba_c
+00038a00: 6f64 656e 616d 650a 2020 2020 2020 2020  odename.        
+00038a10: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00038a20: 6574 7572 6e0a 0a20 2020 2020 2020 2069  eturn..        i
+00038a30: 6620 7365 6c66 2e76 6261 5f63 6f64 656e  f self.vba_coden
+00038a40: 616d 653a 0a20 2020 2020 2020 2020 2020  ame:.           
+00038a50: 2061 7474 7269 6275 7465 732e 6170 7065   attributes.appe
+00038a60: 6e64 2828 2263 6f64 654e 616d 6522 2c20  nd(("codeName", 
+00038a70: 7365 6c66 2e76 6261 5f63 6f64 656e 616d  self.vba_codenam
+00038a80: 6529 290a 0a20 2020 2020 2020 2069 6620  e))..        if 
+00038a90: 7365 6c66 2e66 696c 7465 725f 6f6e 3a0a  self.filter_on:.
+00038aa0: 2020 2020 2020 2020 2020 2020 6174 7472              attr
+00038ab0: 6962 7574 6573 2e61 7070 656e 6428 2822  ibutes.append(("
+00038ac0: 6669 6c74 6572 4d6f 6465 222c 2031 2929  filterMode", 1))
+00038ad0: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+00038ae0: 662e 6669 745f 7061 6765 206f 7220 7365  f.fit_page or se
+00038af0: 6c66 2e74 6162 5f63 6f6c 6f72 206f 7220  lf.tab_color or 
+00038b00: 7365 6c66 2e6f 7574 6c69 6e65 5f63 6861  self.outline_cha
+00038b10: 6e67 6564 3a0a 2020 2020 2020 2020 2020  nged:.          
+00038b20: 2020 7365 6c66 2e5f 786d 6c5f 7374 6172    self._xml_star
+00038b30: 745f 7461 6728 2273 6865 6574 5072 222c  t_tag("sheetPr",
+00038b40: 2061 7474 7269 6275 7465 7329 0a20 2020   attributes).   
+00038b50: 2020 2020 2020 2020 2073 656c 662e 5f77           self._w
+00038b60: 7269 7465 5f74 6162 5f63 6f6c 6f72 2829  rite_tab_color()
+00038b70: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00038b80: 662e 5f77 7269 7465 5f6f 7574 6c69 6e65  f._write_outline
+00038b90: 5f70 7228 290a 2020 2020 2020 2020 2020  _pr().          
+00038ba0: 2020 7365 6c66 2e5f 7772 6974 655f 7061    self._write_pa
+00038bb0: 6765 5f73 6574 5f75 705f 7072 2829 0a20  ge_set_up_pr(). 
+00038bc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00038bd0: 5f78 6d6c 5f65 6e64 5f74 6167 2822 7368  _xml_end_tag("sh
+00038be0: 6565 7450 7222 290a 2020 2020 2020 2020  eetPr").        
+00038bf0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00038c00: 2020 7365 6c66 2e5f 786d 6c5f 656d 7074    self._xml_empt
+00038c10: 795f 7461 6728 2273 6865 6574 5072 222c  y_tag("sheetPr",
+00038c20: 2061 7474 7269 6275 7465 7329 0a0a 2020   attributes)..  
+00038c30: 2020 6465 6620 5f77 7269 7465 5f70 6167    def _write_pag
+00038c40: 655f 7365 745f 7570 5f70 7228 7365 6c66  e_set_up_pr(self
+00038c50: 293a 0a20 2020 2020 2020 2023 2057 7269  ):.        # Wri
+00038c60: 7465 2074 6865 203c 7061 6765 5365 7455  te the <pageSetU
+00038c70: 7050 723e 2065 6c65 6d65 6e74 2e0a 2020  pPr> element..  
+00038c80: 2020 2020 2020 6966 206e 6f74 2073 656c        if not sel
+00038c90: 662e 6669 745f 7061 6765 3a0a 2020 2020  f.fit_page:.    
+00038ca0: 2020 2020 2020 2020 7265 7475 726e 0a0a          return..
+00038cb0: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
+00038cc0: 6573 203d 205b 2822 6669 7454 6f50 6167  es = [("fitToPag
+00038cd0: 6522 2c20 3129 5d0a 2020 2020 2020 2020  e", 1)].        
+00038ce0: 7365 6c66 2e5f 786d 6c5f 656d 7074 795f  self._xml_empty_
+00038cf0: 7461 6728 2270 6167 6553 6574 5570 5072  tag("pageSetUpPr
+00038d00: 222c 2061 7474 7269 6275 7465 7329 0a0a  ", attributes)..
+00038d10: 2020 2020 6465 6620 5f77 7269 7465 5f74      def _write_t
+00038d20: 6162 5f63 6f6c 6f72 2873 656c 6629 3a0a  ab_color(self):.
+00038d30: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
+00038d40: 7468 6520 3c74 6162 436f 6c6f 723e 2065  the <tabColor> e
+00038d50: 6c65 6d65 6e74 2e0a 2020 2020 2020 2020  lement..        
+00038d60: 636f 6c6f 7220 3d20 7365 6c66 2e74 6162  color = self.tab
+00038d70: 5f63 6f6c 6f72 0a0a 2020 2020 2020 2020  _color..        
+00038d80: 6966 206e 6f74 2063 6f6c 6f72 3a0a 2020  if not color:.  
+00038d90: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00038da0: 0a0a 2020 2020 2020 2020 6174 7472 6962  ..        attrib
+00038db0: 7574 6573 203d 205b 2822 7267 6222 2c20  utes = [("rgb", 
+00038dc0: 636f 6c6f 7229 5d0a 0a20 2020 2020 2020  color)]..       
+00038dd0: 2073 656c 662e 5f78 6d6c 5f65 6d70 7479   self._xml_empty
+00038de0: 5f74 6167 2822 7461 6243 6f6c 6f72 222c  _tag("tabColor",
+00038df0: 2061 7474 7269 6275 7465 7329 0a0a 2020   attributes)..  
+00038e00: 2020 6465 6620 5f77 7269 7465 5f6f 7574    def _write_out
+00038e10: 6c69 6e65 5f70 7228 7365 6c66 293a 0a20  line_pr(self):. 
+00038e20: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
+00038e30: 6865 203c 6f75 746c 696e 6550 723e 2065  he <outlinePr> e
+00038e40: 6c65 6d65 6e74 2e0a 2020 2020 2020 2020  lement..        
+00038e50: 6174 7472 6962 7574 6573 203d 205b 5d0a  attributes = [].
+00038e60: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00038e70: 7365 6c66 2e6f 7574 6c69 6e65 5f63 6861  self.outline_cha
+00038e80: 6e67 6564 3a0a 2020 2020 2020 2020 2020  nged:.          
+00038e90: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
+00038ea0: 2020 6966 2073 656c 662e 6f75 746c 696e    if self.outlin
+00038eb0: 655f 7374 796c 653a 0a20 2020 2020 2020  e_style:.       
+00038ec0: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
+00038ed0: 6170 7065 6e64 2828 2261 7070 6c79 5374  append(("applySt
+00038ee0: 796c 6573 222c 2031 2929 0a20 2020 2020  yles", 1)).     
+00038ef0: 2020 2069 6620 6e6f 7420 7365 6c66 2e6f     if not self.o
+00038f00: 7574 6c69 6e65 5f62 656c 6f77 3a0a 2020  utline_below:.  
+00038f10: 2020 2020 2020 2020 2020 6174 7472 6962            attrib
+00038f20: 7574 6573 2e61 7070 656e 6428 2822 7375  utes.append(("su
+00038f30: 6d6d 6172 7942 656c 6f77 222c 2030 2929  mmaryBelow", 0))
+00038f40: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00038f50: 7365 6c66 2e6f 7574 6c69 6e65 5f72 6967  self.outline_rig
+00038f60: 6874 3a0a 2020 2020 2020 2020 2020 2020  ht:.            
+00038f70: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
+00038f80: 6428 2822 7375 6d6d 6172 7952 6967 6874  d(("summaryRight
+00038f90: 222c 2030 2929 0a20 2020 2020 2020 2069  ", 0)).        i
+00038fa0: 6620 6e6f 7420 7365 6c66 2e6f 7574 6c69  f not self.outli
+00038fb0: 6e65 5f6f 6e3a 0a20 2020 2020 2020 2020  ne_on:.         
+00038fc0: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
+00038fd0: 7065 6e64 2828 2273 686f 774f 7574 6c69  pend(("showOutli
+00038fe0: 6e65 5379 6d62 6f6c 7322 2c20 3029 290a  neSymbols", 0)).
+00038ff0: 0a20 2020 2020 2020 2073 656c 662e 5f78  .        self._x
+00039000: 6d6c 5f65 6d70 7479 5f74 6167 2822 6f75  ml_empty_tag("ou
+00039010: 746c 696e 6550 7222 2c20 6174 7472 6962  tlinePr", attrib
+00039020: 7574 6573 290a 0a20 2020 2064 6566 205f  utes)..    def _
+00039030: 7772 6974 655f 726f 775f 6272 6561 6b73  write_row_breaks
+00039040: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00039050: 2320 5772 6974 6520 7468 6520 3c72 6f77  # Write the <row
+00039060: 4272 6561 6b73 3e20 656c 656d 656e 742e  Breaks> element.
+00039070: 0a20 2020 2020 2020 2070 6167 655f 6272  .        page_br
+00039080: 6561 6b73 203d 2073 656c 662e 5f73 6f72  eaks = self._sor
+00039090: 745f 7061 6765 6272 6561 6b73 2873 656c  t_pagebreaks(sel
+000390a0: 662e 6862 7265 616b 7329 0a0a 2020 2020  f.hbreaks)..    
+000390b0: 2020 2020 6966 206e 6f74 2070 6167 655f      if not page_
+000390c0: 6272 6561 6b73 3a0a 2020 2020 2020 2020  breaks:.        
+000390d0: 2020 2020 7265 7475 726e 0a0a 2020 2020      return..    
+000390e0: 2020 2020 636f 756e 7420 3d20 6c65 6e28      count = len(
+000390f0: 7061 6765 5f62 7265 616b 7329 0a0a 2020  page_breaks)..  
+00039100: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
+00039110: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
+00039120: 2028 2263 6f75 6e74 222c 2063 6f75 6e74   ("count", count
+00039130: 292c 0a20 2020 2020 2020 2020 2020 2028  ),.            (
+00039140: 226d 616e 7561 6c42 7265 616b 436f 756e  "manualBreakCoun
+00039150: 7422 2c20 636f 756e 7429 2c0a 2020 2020  t", count),.    
+00039160: 2020 2020 5d0a 0a20 2020 2020 2020 2073      ]..        s
+00039170: 656c 662e 5f78 6d6c 5f73 7461 7274 5f74  elf._xml_start_t
+00039180: 6167 2822 726f 7742 7265 616b 7322 2c20  ag("rowBreaks", 
+00039190: 6174 7472 6962 7574 6573 290a 0a20 2020  attributes)..   
+000391a0: 2020 2020 2066 6f72 2072 6f77 5f6e 756d       for row_num
+000391b0: 2069 6e20 7061 6765 5f62 7265 616b 733a   in page_breaks:
+000391c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000391d0: 662e 5f77 7269 7465 5f62 726b 2872 6f77  f._write_brk(row
+000391e0: 5f6e 756d 2c20 3136 3338 3329 0a0a 2020  _num, 16383)..  
+000391f0: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
+00039200: 656e 645f 7461 6728 2272 6f77 4272 6561  end_tag("rowBrea
+00039210: 6b73 2229 0a0a 2020 2020 6465 6620 5f77  ks")..    def _w
+00039220: 7269 7465 5f63 6f6c 5f62 7265 616b 7328  rite_col_breaks(
+00039230: 7365 6c66 293a 0a20 2020 2020 2020 2023  self):.        #
+00039240: 2057 7269 7465 2074 6865 203c 636f 6c42   Write the <colB
+00039250: 7265 616b 733e 2065 6c65 6d65 6e74 2e0a  reaks> element..
+00039260: 2020 2020 2020 2020 7061 6765 5f62 7265          page_bre
+00039270: 616b 7320 3d20 7365 6c66 2e5f 736f 7274  aks = self._sort
+00039280: 5f70 6167 6562 7265 616b 7328 7365 6c66  _pagebreaks(self
+00039290: 2e76 6272 6561 6b73 290a 0a20 2020 2020  .vbreaks)..     
+000392a0: 2020 2069 6620 6e6f 7420 7061 6765 5f62     if not page_b
+000392b0: 7265 616b 733a 0a20 2020 2020 2020 2020  reaks:.         
+000392c0: 2020 2072 6574 7572 6e0a 0a20 2020 2020     return..     
+000392d0: 2020 2063 6f75 6e74 203d 206c 656e 2870     count = len(p
+000392e0: 6167 655f 6272 6561 6b73 290a 0a20 2020  age_breaks)..   
+000392f0: 2020 2020 2061 7474 7269 6275 7465 7320       attributes 
+00039300: 3d20 5b0a 2020 2020 2020 2020 2020 2020  = [.            
+00039310: 2822 636f 756e 7422 2c20 636f 756e 7429  ("count", count)
+00039320: 2c0a 2020 2020 2020 2020 2020 2020 2822  ,.            ("
+00039330: 6d61 6e75 616c 4272 6561 6b43 6f75 6e74  manualBreakCount
+00039340: 222c 2063 6f75 6e74 292c 0a20 2020 2020  ", count),.     
+00039350: 2020 205d 0a0a 2020 2020 2020 2020 7365     ]..        se
+00039360: 6c66 2e5f 786d 6c5f 7374 6172 745f 7461  lf._xml_start_ta
+00039370: 6728 2263 6f6c 4272 6561 6b73 222c 2061  g("colBreaks", a
+00039380: 7474 7269 6275 7465 7329 0a0a 2020 2020  ttributes)..    
+00039390: 2020 2020 666f 7220 636f 6c5f 6e75 6d20      for col_num 
+000393a0: 696e 2070 6167 655f 6272 6561 6b73 3a0a  in page_breaks:.
+000393b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000393c0: 2e5f 7772 6974 655f 6272 6b28 636f 6c5f  ._write_brk(col_
+000393d0: 6e75 6d2c 2031 3034 3835 3735 290a 0a20  num, 1048575).. 
+000393e0: 2020 2020 2020 2073 656c 662e 5f78 6d6c         self._xml
+000393f0: 5f65 6e64 5f74 6167 2822 636f 6c42 7265  _end_tag("colBre
+00039400: 616b 7322 290a 0a20 2020 2064 6566 205f  aks")..    def _
+00039410: 7772 6974 655f 6272 6b28 7365 6c66 2c20  write_brk(self, 
+00039420: 6272 6b5f 6964 2c20 6272 6b5f 6d61 7829  brk_id, brk_max)
+00039430: 3a0a 2020 2020 2020 2020 2320 5772 6974  :.        # Writ
+00039440: 6520 7468 6520 3c62 726b 3e20 656c 656d  e the <brk> elem
+00039450: 656e 742e 0a20 2020 2020 2020 2061 7474  ent..        att
+00039460: 7269 6275 7465 7320 3d20 5b28 2269 6422  ributes = [("id"
+00039470: 2c20 6272 6b5f 6964 292c 2028 226d 6178  , brk_id), ("max
+00039480: 222c 2062 726b 5f6d 6178 292c 2028 226d  ", brk_max), ("m
+00039490: 616e 222c 2031 295d 0a0a 2020 2020 2020  an", 1)]..      
+000394a0: 2020 7365 6c66 2e5f 786d 6c5f 656d 7074    self._xml_empt
+000394b0: 795f 7461 6728 2262 726b 222c 2061 7474  y_tag("brk", att
+000394c0: 7269 6275 7465 7329 0a0a 2020 2020 6465  ributes)..    de
+000394d0: 6620 5f77 7269 7465 5f6d 6572 6765 5f63  f _write_merge_c
+000394e0: 656c 6c73 2873 656c 6629 3a0a 2020 2020  ells(self):.    
+000394f0: 2020 2020 2320 5772 6974 6520 7468 6520      # Write the 
+00039500: 3c6d 6572 6765 4365 6c6c 733e 2065 6c65  <mergeCells> ele
+00039510: 6d65 6e74 2e0a 2020 2020 2020 2020 6d65  ment..        me
+00039520: 7267 6564 5f63 656c 6c73 203d 2073 656c  rged_cells = sel
+00039530: 662e 6d65 7267 650a 2020 2020 2020 2020  f.merge.        
+00039540: 636f 756e 7420 3d20 6c65 6e28 6d65 7267  count = len(merg
+00039550: 6564 5f63 656c 6c73 290a 0a20 2020 2020  ed_cells)..     
+00039560: 2020 2069 6620 6e6f 7420 636f 756e 743a     if not count:
+00039570: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00039580: 7572 6e0a 0a20 2020 2020 2020 2061 7474  urn..        att
+00039590: 7269 6275 7465 7320 3d20 5b28 2263 6f75  ributes = [("cou
+000395a0: 6e74 222c 2063 6f75 6e74 295d 0a0a 2020  nt", count)]..  
+000395b0: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
+000395c0: 7374 6172 745f 7461 6728 226d 6572 6765  start_tag("merge
+000395d0: 4365 6c6c 7322 2c20 6174 7472 6962 7574  Cells", attribut
+000395e0: 6573 290a 0a20 2020 2020 2020 2066 6f72  es)..        for
+000395f0: 206d 6572 6765 645f 7261 6e67 6520 696e   merged_range in
+00039600: 206d 6572 6765 645f 6365 6c6c 733a 0a20   merged_cells:. 
+00039610: 2020 2020 2020 2020 2020 2023 2057 7269             # Wri
+00039620: 7465 2074 6865 206d 6572 6765 4365 6c6c  te the mergeCell
+00039630: 2065 6c65 6d65 6e74 2e0a 2020 2020 2020   element..      
+00039640: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
+00039650: 655f 6d65 7267 655f 6365 6c6c 286d 6572  e_merge_cell(mer
+00039660: 6765 645f 7261 6e67 6529 0a0a 2020 2020  ged_range)..    
+00039670: 2020 2020 7365 6c66 2e5f 786d 6c5f 656e      self._xml_en
+00039680: 645f 7461 6728 226d 6572 6765 4365 6c6c  d_tag("mergeCell
+00039690: 7322 290a 0a20 2020 2064 6566 205f 7772  s")..    def _wr
+000396a0: 6974 655f 6d65 7267 655f 6365 6c6c 2873  ite_merge_cell(s
+000396b0: 656c 662c 206d 6572 6765 645f 7261 6e67  elf, merged_rang
+000396c0: 6529 3a0a 2020 2020 2020 2020 2320 5772  e):.        # Wr
+000396d0: 6974 6520 7468 6520 3c6d 6572 6765 4365  ite the <mergeCe
+000396e0: 6c6c 3e20 656c 656d 656e 742e 0a20 2020  ll> element..   
+000396f0: 2020 2020 2028 726f 775f 6d69 6e2c 2063       (row_min, c
+00039700: 6f6c 5f6d 696e 2c20 726f 775f 6d61 782c  ol_min, row_max,
+00039710: 2063 6f6c 5f6d 6178 2920 3d20 6d65 7267   col_max) = merg
+00039720: 6564 5f72 616e 6765 0a0a 2020 2020 2020  ed_range..      
+00039730: 2020 2320 436f 6e76 6572 7420 7468 6520    # Convert the 
+00039740: 6d65 7267 6520 6469 6d65 6e73 696f 6e73  merge dimensions
+00039750: 2074 6f20 6120 6365 6c6c 2072 616e 6765   to a cell range
+00039760: 2e0a 2020 2020 2020 2020 6365 6c6c 5f31  ..        cell_1
+00039770: 203d 2078 6c5f 726f 7763 6f6c 5f74 6f5f   = xl_rowcol_to_
+00039780: 6365 6c6c 2872 6f77 5f6d 696e 2c20 636f  cell(row_min, co
+00039790: 6c5f 6d69 6e29 0a20 2020 2020 2020 2063  l_min).        c
+000397a0: 656c 6c5f 3220 3d20 786c 5f72 6f77 636f  ell_2 = xl_rowco
+000397b0: 6c5f 746f 5f63 656c 6c28 726f 775f 6d61  l_to_cell(row_ma
+000397c0: 782c 2063 6f6c 5f6d 6178 290a 2020 2020  x, col_max).    
+000397d0: 2020 2020 7265 6620 3d20 6365 6c6c 5f31      ref = cell_1
+000397e0: 202b 2022 3a22 202b 2063 656c 6c5f 320a   + ":" + cell_2.
+000397f0: 0a20 2020 2020 2020 2061 7474 7269 6275  .        attribu
+00039800: 7465 7320 3d20 5b28 2272 6566 222c 2072  tes = [("ref", r
+00039810: 6566 295d 0a0a 2020 2020 2020 2020 7365  ef)]..        se
+00039820: 6c66 2e5f 786d 6c5f 656d 7074 795f 7461  lf._xml_empty_ta
+00039830: 6728 226d 6572 6765 4365 6c6c 222c 2061  g("mergeCell", a
+00039840: 7474 7269 6275 7465 7329 0a0a 2020 2020  ttributes)..    
+00039850: 6465 6620 5f77 7269 7465 5f68 7970 6572  def _write_hyper
+00039860: 6c69 6e6b 7328 7365 6c66 293a 0a20 2020  links(self):.   
+00039870: 2020 2020 2023 2050 726f 6365 7373 2061       # Process a
+00039880: 6e79 2073 746f 7265 6420 6879 7065 726c  ny stored hyperl
+00039890: 696e 6b73 2069 6e20 726f 772f 636f 6c20  inks in row/col 
+000398a0: 6f72 6465 7220 616e 6420 7772 6974 6520  order and write 
+000398b0: 7468 650a 2020 2020 2020 2020 2320 3c68  the.        # <h
+000398c0: 7970 6572 6c69 6e6b 733e 2065 6c65 6d65  yperlinks> eleme
+000398d0: 6e74 2e20 5468 6520 6174 7472 6962 7574  nt. The attribut
+000398e0: 6573 2061 7265 2064 6966 6665 7265 6e74  es are different
+000398f0: 2066 6f72 2069 6e74 6572 6e61 6c0a 2020   for internal.  
+00039900: 2020 2020 2020 2320 616e 6420 6578 7465        # and exte
+00039910: 726e 616c 206c 696e 6b73 2e0a 2020 2020  rnal links..    
+00039920: 2020 2020 686c 696e 6b5f 7265 6673 203d      hlink_refs =
+00039930: 205b 5d0a 2020 2020 2020 2020 6469 7370   [].        disp
+00039940: 6c61 7920 3d20 4e6f 6e65 0a0a 2020 2020  lay = None..    
+00039950: 2020 2020 2320 536f 7274 2074 6865 2068      # Sort the h
+00039960: 7970 6572 6c69 6e6b 7320 696e 746f 2072  yperlinks into r
+00039970: 6f77 206f 7264 6572 2e0a 2020 2020 2020  ow order..      
+00039980: 2020 726f 775f 6e75 6d73 203d 2073 6f72    row_nums = sor
+00039990: 7465 6428 7365 6c66 2e68 7970 6572 6c69  ted(self.hyperli
+000399a0: 6e6b 732e 6b65 7973 2829 290a 0a20 2020  nks.keys())..   
+000399b0: 2020 2020 2023 2045 7869 7420 6966 2074       # Exit if t
+000399c0: 6865 7265 2061 7265 206e 6f20 6879 7065  here are no hype
+000399d0: 726c 696e 6b73 2074 6f20 7072 6f63 6573  rlinks to proces
+000399e0: 732e 0a20 2020 2020 2020 2069 6620 6e6f  s..        if no
+000399f0: 7420 726f 775f 6e75 6d73 3a0a 2020 2020  t row_nums:.    
+00039a00: 2020 2020 2020 2020 7265 7475 726e 0a0a          return..
+00039a10: 2020 2020 2020 2020 2320 4974 6572 6174          # Iterat
+00039a20: 6520 6f76 6572 2074 6865 2072 6f77 732e  e over the rows.
+00039a30: 0a20 2020 2020 2020 2066 6f72 2072 6f77  .        for row
+00039a40: 5f6e 756d 2069 6e20 726f 775f 6e75 6d73  _num in row_nums
+00039a50: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00039a60: 536f 7274 2074 6865 2068 7970 6572 6c69  Sort the hyperli
+00039a70: 6e6b 7320 696e 746f 2063 6f6c 756d 6e20  nks into column 
+00039a80: 6f72 6465 722e 0a20 2020 2020 2020 2020  order..         
+00039a90: 2020 2063 6f6c 5f6e 756d 7320 3d20 736f     col_nums = so
+00039aa0: 7274 6564 2873 656c 662e 6879 7065 726c  rted(self.hyperl
+00039ab0: 696e 6b73 5b72 6f77 5f6e 756d 5d2e 6b65  inks[row_num].ke
+00039ac0: 7973 2829 290a 0a20 2020 2020 2020 2020  ys())..         
+00039ad0: 2020 2023 2049 7465 7261 7465 206f 7665     # Iterate ove
+00039ae0: 7220 7468 6520 636f 6c75 6d6e 732e 0a20  r the columns.. 
+00039af0: 2020 2020 2020 2020 2020 2066 6f72 2063             for c
+00039b00: 6f6c 5f6e 756d 2069 6e20 636f 6c5f 6e75  ol_num in col_nu
+00039b10: 6d73 3a0a 2020 2020 2020 2020 2020 2020  ms:.            
+00039b20: 2020 2020 2320 4765 7420 7468 6520 6c69      # Get the li
+00039b30: 6e6b 2064 6174 6120 666f 7220 7468 6973  nk data for this
+00039b40: 2063 656c 6c2e 0a20 2020 2020 2020 2020   cell..         
+00039b50: 2020 2020 2020 206c 696e 6b20 3d20 7365         link = se
+00039b60: 6c66 2e68 7970 6572 6c69 6e6b 735b 726f  lf.hyperlinks[ro
+00039b70: 775f 6e75 6d5d 5b63 6f6c 5f6e 756d 5d0a  w_num][col_num].
+00039b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039b90: 6c69 6e6b 5f74 7970 6520 3d20 6c69 6e6b  link_type = link
+00039ba0: 5b22 6c69 6e6b 5f74 7970 6522 5d0a 0a20  ["link_type"].. 
+00039bb0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00039bc0: 2049 6620 7468 6520 6365 6c6c 2069 736e   If the cell isn
+00039bd0: 2774 2061 2073 7472 696e 6720 7468 656e  't a string then
+00039be0: 2077 6520 6861 7665 2074 6f20 6164 6420   we have to add 
+00039bf0: 7468 6520 7572 6c20 6173 0a20 2020 2020  the url as.     
+00039c00: 2020 2020 2020 2020 2020 2023 2074 6865             # the
+00039c10: 2073 7472 696e 6720 746f 2064 6973 706c   string to displ
+00039c20: 6179 2e0a 2020 2020 2020 2020 2020 2020  ay..            
+00039c30: 2020 2020 6966 2073 656c 662e 7461 626c      if self.tabl
+00039c40: 6520 616e 6420 7365 6c66 2e74 6162 6c65  e and self.table
+00039c50: 5b72 6f77 5f6e 756d 5d20 616e 6420 7365  [row_num] and se
+00039c60: 6c66 2e74 6162 6c65 5b72 6f77 5f6e 756d  lf.table[row_num
+00039c70: 5d5b 636f 6c5f 6e75 6d5d 3a0a 2020 2020  ][col_num]:.    
+00039c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039c90: 6365 6c6c 203d 2073 656c 662e 7461 626c  cell = self.tabl
+00039ca0: 655b 726f 775f 6e75 6d5d 5b63 6f6c 5f6e  e[row_num][col_n
+00039cb0: 756d 5d0a 2020 2020 2020 2020 2020 2020  um].            
+00039cc0: 2020 2020 2020 2020 6966 2063 656c 6c2e          if cell.
+00039cd0: 5f5f 636c 6173 735f 5f2e 5f5f 6e61 6d65  __class__.__name
+00039ce0: 5f5f 2021 3d20 2253 7472 696e 6722 3a0a  __ != "String":.
+00039cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039d00: 2020 2020 2020 2020 6469 7370 6c61 7920          display 
+00039d10: 3d20 6c69 6e6b 5b22 7572 6c22 5d0a 0a20  = link["url"].. 
+00039d20: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00039d30: 6620 6c69 6e6b 5f74 7970 6520 3d3d 2031  f link_type == 1
+00039d40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00039d50: 2020 2020 2020 2320 4578 7465 726e 616c        # External
+00039d60: 206c 696e 6b20 7769 7468 2072 656c 2066   link with rel f
+00039d70: 696c 6520 7265 6c61 7469 6f6e 7368 6970  ile relationship
+00039d80: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00039d90: 2020 2020 2020 7365 6c66 2e72 656c 5f63        self.rel_c
+00039da0: 6f75 6e74 202b 3d20 310a 0a20 2020 2020  ount += 1..     
+00039db0: 2020 2020 2020 2020 2020 2020 2020 2068                 h
+00039dc0: 6c69 6e6b 5f72 6566 732e 6170 7065 6e64  link_refs.append
+00039dd0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00039de0: 2020 2020 2020 2020 2020 5b0a 2020 2020            [.    
+00039df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039e00: 2020 2020 2020 2020 6c69 6e6b 5f74 7970          link_typ
+00039e10: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00039e20: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00039e30: 6f77 5f6e 756d 2c0a 2020 2020 2020 2020  ow_num,.        
+00039e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039e50: 2020 2020 636f 6c5f 6e75 6d2c 0a20 2020      col_num,.   
+00039e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039e70: 2020 2020 2020 2020 2073 656c 662e 7265           self.re
+00039e80: 6c5f 636f 756e 742c 0a20 2020 2020 2020  l_count,.       
+00039e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039ea0: 2020 2020 206c 696e 6b5b 2273 7472 225d       link["str"]
+00039eb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00039ec0: 2020 2020 2020 2020 2020 2020 2020 6469                di
+00039ed0: 7370 6c61 792c 0a20 2020 2020 2020 2020  splay,.         
+00039ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039ef0: 2020 206c 696e 6b5b 2274 6970 225d 2c0a     link["tip"],.
+00039f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039f10: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
+00039f20: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00039f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039f40: 2020 2020 2023 204c 696e 6b73 2066 6f72       # Links for
+00039f50: 2075 7365 2062 7920 7468 6520 7061 636b   use by the pack
+00039f60: 6167 6572 2e0a 2020 2020 2020 2020 2020  ager..          
+00039f70: 2020 2020 2020 2020 2020 7365 6c66 2e65            self.e
+00039f80: 7874 6572 6e61 6c5f 6879 7065 725f 6c69  xternal_hyper_li
+00039f90: 6e6b 732e 6170 7065 6e64 280a 2020 2020  nks.append(.    
+00039fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039fb0: 2020 2020 5b22 2f68 7970 6572 6c69 6e6b      ["/hyperlink
+00039fc0: 222c 206c 696e 6b5b 2275 726c 225d 2c20  ", link["url"], 
+00039fd0: 2245 7874 6572 6e61 6c22 5d0a 2020 2020  "External"].    
+00039fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039ff0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0003a000: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0003a010: 2020 2020 2020 2020 2020 2020 2320 496e              # In
+0003a020: 7465 726e 616c 206c 696e 6b20 7769 7468  ternal link with
+0003a030: 2072 656c 2066 696c 6520 7265 6c61 7469   rel file relati
+0003a040: 6f6e 7368 6970 2e0a 2020 2020 2020 2020  onship..        
+0003a050: 2020 2020 2020 2020 2020 2020 686c 696e              hlin
+0003a060: 6b5f 7265 6673 2e61 7070 656e 6428 0a20  k_refs.append(. 
+0003a070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a080: 2020 2020 2020 205b 0a20 2020 2020 2020         [.       
+0003a090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a0a0: 2020 2020 206c 696e 6b5f 7479 7065 2c0a       link_type,.
 0003a0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a0c0: 2020 2020 2061 6e64 2073 656c 662e 7461       and self.ta
-0003a0d0: 626c 655b 726f 775f 6e75 6d5d 5b63 6f6c  ble[row_num][col
-0003a0e0: 5f6e 756d 5d29 3a0a 2020 2020 2020 2020  _num]):.        
-0003a0f0: 2020 2020 2020 2020 2020 2020 6365 6c6c              cell
-0003a100: 203d 2073 656c 662e 7461 626c 655b 726f   = self.table[ro
-0003a110: 775f 6e75 6d5d 5b63 6f6c 5f6e 756d 5d0a  w_num][col_num].
-0003a120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a130: 2020 2020 6966 2063 656c 6c2e 5f5f 636c      if cell.__cl
-0003a140: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 2021  ass__.__name__ !
-0003a150: 3d20 2753 7472 696e 6727 3a0a 2020 2020  = 'String':.    
-0003a160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a170: 2020 2020 6469 7370 6c61 7920 3d20 6c69      display = li
-0003a180: 6e6b 5b27 7572 6c27 5d0a 0a20 2020 2020  nk['url']..     
-0003a190: 2020 2020 2020 2020 2020 2069 6620 6c69             if li
-0003a1a0: 6e6b 5f74 7970 6520 3d3d 2031 3a0a 2020  nk_type == 1:.  
-0003a1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a1c0: 2020 2320 4578 7465 726e 616c 206c 696e    # External lin
-0003a1d0: 6b20 7769 7468 2072 656c 2066 696c 6520  k with rel file 
-0003a1e0: 7265 6c61 7469 6f6e 7368 6970 2e0a 2020  relationship..  
-0003a1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a200: 2020 7365 6c66 2e72 656c 5f63 6f75 6e74    self.rel_count
-0003a210: 202b 3d20 310a 0a20 2020 2020 2020 2020   += 1..         
-0003a220: 2020 2020 2020 2020 2020 2068 6c69 6e6b             hlink
-0003a230: 5f72 6566 732e 6170 7065 6e64 285b 6c69  _refs.append([li
-0003a240: 6e6b 5f74 7970 652c 0a20 2020 2020 2020  nk_type,.       
-0003a250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a270: 726f 775f 6e75 6d2c 0a20 2020 2020 2020  row_num,.       
-0003a280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a2a0: 636f 6c5f 6e75 6d2c 0a20 2020 2020 2020  col_num,.       
-0003a2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a2d0: 7365 6c66 2e72 656c 5f63 6f75 6e74 2c0a  self.rel_count,.
-0003a2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a300: 2020 2020 2020 206c 696e 6b5b 2773 7472         link['str
-0003a310: 275d 2c0a 2020 2020 2020 2020 2020 2020  '],.            
-0003a320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a330: 2020 2020 2020 2020 2020 2064 6973 706c             displ
-0003a340: 6179 2c0a 2020 2020 2020 2020 2020 2020  ay,.            
-0003a350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a360: 2020 2020 2020 2020 2020 206c 696e 6b5b             link[
-0003a370: 2774 6970 275d 5d29 0a0a 2020 2020 2020  'tip']])..      
-0003a380: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0003a390: 4c69 6e6b 7320 666f 7220 7573 6520 6279  Links for use by
-0003a3a0: 2074 6865 2070 6163 6b61 6765 722e 0a20   the packager.. 
-0003a3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a3c0: 2020 2073 656c 662e 6578 7465 726e 616c     self.external
-0003a3d0: 5f68 7970 6572 5f6c 696e 6b73 2e61 7070  _hyper_links.app
-0003a3e0: 656e 6428 5b27 2f68 7970 6572 6c69 6e6b  end(['/hyperlink
-0003a3f0: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-0003a400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a420: 2020 2020 2020 2020 206c 696e 6b5b 2775           link['u
-0003a430: 726c 275d 2c20 2745 7874 6572 6e61 6c27  rl'], 'External'
-0003a440: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
-0003a450: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0003a460: 2020 2020 2020 2020 2020 2020 2023 2049               # I
-0003a470: 6e74 6572 6e61 6c20 6c69 6e6b 2077 6974  nternal link wit
-0003a480: 6820 7265 6c20 6669 6c65 2072 656c 6174  h rel file relat
-0003a490: 696f 6e73 6869 702e 0a20 2020 2020 2020  ionship..       
-0003a4a0: 2020 2020 2020 2020 2020 2020 2068 6c69               hli
-0003a4b0: 6e6b 5f72 6566 732e 6170 7065 6e64 285b  nk_refs.append([
-0003a4c0: 6c69 6e6b 5f74 7970 652c 0a20 2020 2020  link_type,.     
-0003a4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a4f0: 2020 726f 775f 6e75 6d2c 0a20 2020 2020    row_num,.     
-0003a500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a520: 2020 636f 6c5f 6e75 6d2c 0a20 2020 2020    col_num,.     
-0003a530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a550: 2020 6c69 6e6b 5b27 7572 6c27 5d2c 0a20    link['url'],. 
-0003a560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a580: 2020 2020 2020 6c69 6e6b 5b27 7374 7227        link['str'
-0003a590: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-0003a5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a5b0: 2020 2020 2020 2020 2020 6c69 6e6b 5b27            link['
-0003a5c0: 7469 7027 5d5d 290a 0a20 2020 2020 2020  tip']])..       
-0003a5d0: 2023 2057 7269 7465 2074 6865 2068 7970   # Write the hyp
-0003a5e0: 6572 6c69 6e6b 2065 6c65 6d65 6e74 732e  erlink elements.
-0003a5f0: 0a20 2020 2020 2020 2073 656c 662e 5f78  .        self._x
-0003a600: 6d6c 5f73 7461 7274 5f74 6167 2827 6879  ml_start_tag('hy
-0003a610: 7065 726c 696e 6b73 2729 0a0a 2020 2020  perlinks')..    
-0003a620: 2020 2020 666f 7220 6172 6773 2069 6e20      for args in 
-0003a630: 686c 696e 6b5f 7265 6673 3a0a 2020 2020  hlink_refs:.    
-0003a640: 2020 2020 2020 2020 6c69 6e6b 5f74 7970          link_typ
-0003a650: 6520 3d20 6172 6773 2e70 6f70 2830 290a  e = args.pop(0).
-0003a660: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0003a670: 6c69 6e6b 5f74 7970 6520 3d3d 2031 3a0a  link_type == 1:.
-0003a680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a690: 7365 6c66 2e5f 7772 6974 655f 6879 7065  self._write_hype
-0003a6a0: 726c 696e 6b5f 6578 7465 726e 616c 282a  rlink_external(*
-0003a6b0: 6172 6773 290a 2020 2020 2020 2020 2020  args).          
-0003a6c0: 2020 656c 6966 206c 696e 6b5f 7479 7065    elif link_type
-0003a6d0: 203d 3d20 323a 0a20 2020 2020 2020 2020   == 2:.         
-0003a6e0: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
-0003a6f0: 7465 5f68 7970 6572 6c69 6e6b 5f69 6e74  te_hyperlink_int
-0003a700: 6572 6e61 6c28 2a61 7267 7329 0a0a 2020  ernal(*args)..  
-0003a710: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
-0003a720: 656e 645f 7461 6728 2768 7970 6572 6c69  end_tag('hyperli
-0003a730: 6e6b 7327 290a 0a20 2020 2064 6566 205f  nks')..    def _
-0003a740: 7772 6974 655f 6879 7065 726c 696e 6b5f  write_hyperlink_
-0003a750: 6578 7465 726e 616c 2873 656c 662c 2072  external(self, r
-0003a760: 6f77 2c20 636f 6c2c 2069 645f 6e75 6d2c  ow, col, id_num,
-0003a770: 206c 6f63 6174 696f 6e3d 4e6f 6e65 2c0a   location=None,.
-0003a780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a7a0: 2020 6469 7370 6c61 793d 4e6f 6e65 2c20    display=None, 
-0003a7b0: 746f 6f6c 7469 703d 4e6f 6e65 293a 0a20  tooltip=None):. 
-0003a7c0: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
-0003a7d0: 6865 203c 6879 7065 726c 696e 6b3e 2065  he <hyperlink> e
-0003a7e0: 6c65 6d65 6e74 2066 6f72 2065 7874 6572  lement for exter
-0003a7f0: 6e61 6c20 6c69 6e6b 732e 0a20 2020 2020  nal links..     
-0003a800: 2020 2072 6566 203d 2078 6c5f 726f 7763     ref = xl_rowc
-0003a810: 6f6c 5f74 6f5f 6365 6c6c 2872 6f77 2c20  ol_to_cell(row, 
-0003a820: 636f 6c29 0a20 2020 2020 2020 2072 5f69  col).        r_i
-0003a830: 6420 3d20 2772 4964 2720 2b20 7374 7228  d = 'rId' + str(
-0003a840: 6964 5f6e 756d 290a 0a20 2020 2020 2020  id_num)..       
-0003a850: 2061 7474 7269 6275 7465 7320 3d20 5b0a   attributes = [.
-0003a860: 2020 2020 2020 2020 2020 2020 2827 7265              ('re
-0003a870: 6627 2c20 7265 6629 2c0a 2020 2020 2020  f', ref),.      
-0003a880: 2020 2020 2020 2827 723a 6964 272c 2072        ('r:id', r
-0003a890: 5f69 6429 5d0a 0a20 2020 2020 2020 2069  _id)]..        i
-0003a8a0: 6620 6c6f 6361 7469 6f6e 2069 7320 6e6f  f location is no
-0003a8b0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0003a8c0: 2020 2020 6174 7472 6962 7574 6573 2e61      attributes.a
-0003a8d0: 7070 656e 6428 2827 6c6f 6361 7469 6f6e  ppend(('location
-0003a8e0: 272c 206c 6f63 6174 696f 6e29 290a 2020  ', location)).  
-0003a8f0: 2020 2020 2020 6966 2064 6973 706c 6179        if display
-0003a900: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0003a910: 2020 2020 2020 2020 2020 6174 7472 6962            attrib
-0003a920: 7574 6573 2e61 7070 656e 6428 2827 6469  utes.append(('di
-0003a930: 7370 6c61 7927 2c20 6469 7370 6c61 7929  splay', display)
-0003a940: 290a 2020 2020 2020 2020 6966 2074 6f6f  ).        if too
-0003a950: 6c74 6970 2069 7320 6e6f 7420 4e6f 6e65  ltip is not None
-0003a960: 3a0a 2020 2020 2020 2020 2020 2020 6174  :.            at
-0003a970: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
-0003a980: 2827 746f 6f6c 7469 7027 2c20 746f 6f6c  ('tooltip', tool
-0003a990: 7469 7029 290a 0a20 2020 2020 2020 2073  tip))..        s
-0003a9a0: 656c 662e 5f78 6d6c 5f65 6d70 7479 5f74  elf._xml_empty_t
-0003a9b0: 6167 2827 6879 7065 726c 696e 6b27 2c20  ag('hyperlink', 
-0003a9c0: 6174 7472 6962 7574 6573 290a 0a20 2020  attributes)..   
-0003a9d0: 2064 6566 205f 7772 6974 655f 6879 7065   def _write_hype
-0003a9e0: 726c 696e 6b5f 696e 7465 726e 616c 2873  rlink_internal(s
-0003a9f0: 656c 662c 2072 6f77 2c20 636f 6c2c 206c  elf, row, col, l
-0003aa00: 6f63 6174 696f 6e3d 4e6f 6e65 2c20 6469  ocation=None, di
-0003aa10: 7370 6c61 793d 4e6f 6e65 2c0a 2020 2020  splay=None,.    
-0003aa20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003aa30: 2020 2020 2020 2020 2020 2020 2020 746f                to
-0003aa40: 6f6c 7469 703d 4e6f 6e65 293a 0a20 2020  oltip=None):.   
-0003aa50: 2020 2020 2023 2057 7269 7465 2074 6865       # Write the
-0003aa60: 203c 6879 7065 726c 696e 6b3e 2065 6c65   <hyperlink> ele
-0003aa70: 6d65 6e74 2066 6f72 2069 6e74 6572 6e61  ment for interna
-0003aa80: 6c20 6c69 6e6b 732e 0a20 2020 2020 2020  l links..       
-0003aa90: 2072 6566 203d 2078 6c5f 726f 7763 6f6c   ref = xl_rowcol
-0003aaa0: 5f74 6f5f 6365 6c6c 2872 6f77 2c20 636f  _to_cell(row, co
-0003aab0: 6c29 0a0a 2020 2020 2020 2020 6174 7472  l)..        attr
-0003aac0: 6962 7574 6573 203d 205b 0a20 2020 2020  ibutes = [.     
-0003aad0: 2020 2020 2020 2028 2772 6566 272c 2072         ('ref', r
-0003aae0: 6566 292c 0a20 2020 2020 2020 2020 2020  ef),.           
-0003aaf0: 2028 276c 6f63 6174 696f 6e27 2c20 6c6f   ('location', lo
-0003ab00: 6361 7469 6f6e 295d 0a0a 2020 2020 2020  cation)]..      
-0003ab10: 2020 6966 2074 6f6f 6c74 6970 2069 7320    if tooltip is 
-0003ab20: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0003ab30: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-0003ab40: 2e61 7070 656e 6428 2827 746f 6f6c 7469  .append(('toolti
-0003ab50: 7027 2c20 746f 6f6c 7469 7029 290a 2020  p', tooltip)).  
-0003ab60: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-0003ab70: 2e61 7070 656e 6428 2827 6469 7370 6c61  .append(('displa
-0003ab80: 7927 2c20 6469 7370 6c61 7929 290a 0a20  y', display)).. 
-0003ab90: 2020 2020 2020 2073 656c 662e 5f78 6d6c         self._xml
-0003aba0: 5f65 6d70 7479 5f74 6167 2827 6879 7065  _empty_tag('hype
-0003abb0: 726c 696e 6b27 2c20 6174 7472 6962 7574  rlink', attribut
-0003abc0: 6573 290a 0a20 2020 2064 6566 205f 7772  es)..    def _wr
-0003abd0: 6974 655f 6175 746f 5f66 696c 7465 7228  ite_auto_filter(
-0003abe0: 7365 6c66 293a 0a20 2020 2020 2020 2023  self):.        #
-0003abf0: 2057 7269 7465 2074 6865 203c 6175 746f   Write the <auto
-0003ac00: 4669 6c74 6572 3e20 656c 656d 656e 742e  Filter> element.
-0003ac10: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-0003ac20: 7365 6c66 2e61 7574 6f66 696c 7465 725f  self.autofilter_
-0003ac30: 7265 663a 0a20 2020 2020 2020 2020 2020  ref:.           
-0003ac40: 2072 6574 7572 6e0a 0a20 2020 2020 2020   return..       
-0003ac50: 2061 7474 7269 6275 7465 7320 3d20 5b28   attributes = [(
-0003ac60: 2772 6566 272c 2073 656c 662e 6175 746f  'ref', self.auto
-0003ac70: 6669 6c74 6572 5f72 6566 295d 0a0a 2020  filter_ref)]..  
-0003ac80: 2020 2020 2020 6966 2073 656c 662e 6669        if self.fi
-0003ac90: 6c74 6572 5f6f 6e3a 0a20 2020 2020 2020  lter_on:.       
-0003aca0: 2020 2020 2023 2041 7574 6f66 696c 7465       # Autofilte
-0003acb0: 7220 6465 6669 6e65 6420 6163 7469 7665  r defined active
-0003acc0: 2066 696c 7465 7273 2e0a 2020 2020 2020   filters..      
-0003acd0: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
-0003ace0: 7374 6172 745f 7461 6728 2761 7574 6f46  start_tag('autoF
-0003acf0: 696c 7465 7227 2c20 6174 7472 6962 7574  ilter', attribut
-0003ad00: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
-0003ad10: 7365 6c66 2e5f 7772 6974 655f 6175 746f  self._write_auto
-0003ad20: 6669 6c74 6572 7328 290a 2020 2020 2020  filters().      
-0003ad30: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
-0003ad40: 656e 645f 7461 6728 2761 7574 6f46 696c  end_tag('autoFil
-0003ad50: 7465 7227 290a 0a20 2020 2020 2020 2065  ter')..        e
-0003ad60: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0003ad70: 2023 2041 7574 6f66 696c 7465 7220 6465   # Autofilter de
-0003ad80: 6669 6e65 6420 7769 7468 6f75 7420 6163  fined without ac
-0003ad90: 7469 7665 2066 696c 7465 7273 2e0a 2020  tive filters..  
-0003ada0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0003adb0: 786d 6c5f 656d 7074 795f 7461 6728 2761  xml_empty_tag('a
-0003adc0: 7574 6f46 696c 7465 7227 2c20 6174 7472  utoFilter', attr
-0003add0: 6962 7574 6573 290a 0a20 2020 2064 6566  ibutes)..    def
-0003ade0: 205f 7772 6974 655f 6175 746f 6669 6c74   _write_autofilt
-0003adf0: 6572 7328 7365 6c66 293a 0a20 2020 2020  ers(self):.     
-0003ae00: 2020 2023 2046 756e 6374 696f 6e20 746f     # Function to
-0003ae10: 2069 7465 7261 7465 2074 6872 6f75 6768   iterate through
-0003ae20: 2074 6865 2063 6f6c 756d 6e73 2074 6861   the columns tha
-0003ae30: 7420 666f 726d 2070 6172 7420 6f66 2061  t form part of a
-0003ae40: 6e0a 2020 2020 2020 2020 2320 6175 746f  n.        # auto
-0003ae50: 6669 6c74 6572 2072 616e 6765 2061 6e64  filter range and
-0003ae60: 2077 7269 7465 2074 6865 2061 7070 726f   write the appro
-0003ae70: 7072 6961 7465 2066 696c 7465 7273 2e0a  priate filters..
-0003ae80: 2020 2020 2020 2020 2863 6f6c 312c 2063          (col1, c
-0003ae90: 6f6c 3229 203d 2073 656c 662e 6669 6c74  ol2) = self.filt
-0003aea0: 6572 5f72 616e 6765 0a0a 2020 2020 2020  er_range..      
-0003aeb0: 2020 666f 7220 636f 6c20 696e 2072 616e    for col in ran
-0003aec0: 6765 2863 6f6c 312c 2063 6f6c 3220 2b20  ge(col1, col2 + 
-0003aed0: 3129 3a0a 2020 2020 2020 2020 2020 2020  1):.            
-0003aee0: 2320 536b 6970 2069 6620 636f 6c75 6d6e  # Skip if column
-0003aef0: 2064 6f65 736e 2774 2068 6176 6520 616e   doesn't have an
-0003af00: 2061 6374 6976 6520 6669 6c74 6572 2e0a   active filter..
-0003af10: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-0003af20: 6f6c 206e 6f74 2069 6e20 7365 6c66 2e66  ol not in self.f
-0003af30: 696c 7465 725f 636f 6c73 3a0a 2020 2020  ilter_cols:.    
-0003af40: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-0003af50: 696e 7565 0a0a 2020 2020 2020 2020 2020  inue..          
-0003af60: 2020 2320 5265 7472 6965 7665 2074 6865    # Retrieve the
-0003af70: 2066 696c 7465 7220 746f 6b65 6e73 2061   filter tokens a
-0003af80: 6e64 2077 7269 7465 2074 6865 2061 7574  nd write the aut
-0003af90: 6f66 696c 7465 7220 7265 636f 7264 732e  ofilter records.
-0003afa0: 0a20 2020 2020 2020 2020 2020 2074 6f6b  .            tok
-0003afb0: 656e 7320 3d20 7365 6c66 2e66 696c 7465  ens = self.filte
-0003afc0: 725f 636f 6c73 5b63 6f6c 5d0a 2020 2020  r_cols[col].    
-0003afd0: 2020 2020 2020 2020 6669 6c74 6572 5f74          filter_t
-0003afe0: 7970 6520 3d20 7365 6c66 2e66 696c 7465  ype = self.filte
-0003aff0: 725f 7479 7065 5b63 6f6c 5d0a 0a20 2020  r_type[col]..   
-0003b000: 2020 2020 2020 2020 2023 2046 696c 7465           # Filte
-0003b010: 7273 2061 7265 2072 656c 6174 6976 6520  rs are relative 
-0003b020: 746f 2066 6972 7374 2063 6f6c 756d 6e20  to first column 
-0003b030: 696e 2074 6865 2061 7574 6f66 696c 7465  in the autofilte
-0003b040: 722e 0a20 2020 2020 2020 2020 2020 2073  r..            s
-0003b050: 656c 662e 5f77 7269 7465 5f66 696c 7465  elf._write_filte
-0003b060: 725f 636f 6c75 6d6e 2863 6f6c 202d 2063  r_column(col - c
-0003b070: 6f6c 312c 2066 696c 7465 725f 7479 7065  ol1, filter_type
-0003b080: 2c20 746f 6b65 6e73 290a 0a20 2020 2064  , tokens)..    d
-0003b090: 6566 205f 7772 6974 655f 6669 6c74 6572  ef _write_filter
-0003b0a0: 5f63 6f6c 756d 6e28 7365 6c66 2c20 636f  _column(self, co
-0003b0b0: 6c5f 6964 2c20 6669 6c74 6572 5f74 7970  l_id, filter_typ
-0003b0c0: 652c 2066 696c 7465 7273 293a 0a20 2020  e, filters):.   
-0003b0d0: 2020 2020 2023 2057 7269 7465 2074 6865       # Write the
-0003b0e0: 203c 6669 6c74 6572 436f 6c75 6d6e 3e20   <filterColumn> 
-0003b0f0: 656c 656d 656e 742e 0a20 2020 2020 2020  element..       
-0003b100: 2061 7474 7269 6275 7465 7320 3d20 5b28   attributes = [(
-0003b110: 2763 6f6c 4964 272c 2063 6f6c 5f69 6429  'colId', col_id)
-0003b120: 5d0a 0a20 2020 2020 2020 2073 656c 662e  ]..        self.
-0003b130: 5f78 6d6c 5f73 7461 7274 5f74 6167 2827  _xml_start_tag('
-0003b140: 6669 6c74 6572 436f 6c75 6d6e 272c 2061  filterColumn', a
-0003b150: 7474 7269 6275 7465 7329 0a0a 2020 2020  ttributes)..    
-0003b160: 2020 2020 6966 2066 696c 7465 725f 7479      if filter_ty
-0003b170: 7065 203d 3d20 313a 0a20 2020 2020 2020  pe == 1:.       
-0003b180: 2020 2020 2023 2054 7970 6520 3d3d 2031       # Type == 1
-0003b190: 2069 7320 7468 6520 6e65 7720 584c 5358   is the new XLSX
-0003b1a0: 2073 7479 6c65 2066 696c 7465 722e 0a20   style filter.. 
-0003b1b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0003b1c0: 5f77 7269 7465 5f66 696c 7465 7273 2866  _write_filters(f
-0003b1d0: 696c 7465 7273 290a 2020 2020 2020 2020  ilters).        
-0003b1e0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0003b1f0: 2020 2320 5479 7065 203d 3d20 3020 6973    # Type == 0 is
-0003b200: 2074 6865 2063 6c61 7373 6963 2022 6375   the classic "cu
-0003b210: 7374 6f6d 2220 6669 6c74 6572 2e0a 2020  stom" filter..  
-0003b220: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0003b230: 7772 6974 655f 6375 7374 6f6d 5f66 696c  write_custom_fil
-0003b240: 7465 7273 2866 696c 7465 7273 290a 0a20  ters(filters).. 
-0003b250: 2020 2020 2020 2073 656c 662e 5f78 6d6c         self._xml
-0003b260: 5f65 6e64 5f74 6167 2827 6669 6c74 6572  _end_tag('filter
-0003b270: 436f 6c75 6d6e 2729 0a0a 2020 2020 6465  Column')..    de
-0003b280: 6620 5f77 7269 7465 5f66 696c 7465 7273  f _write_filters
-0003b290: 2873 656c 662c 2066 696c 7465 7273 293a  (self, filters):
-0003b2a0: 0a20 2020 2020 2020 2023 2057 7269 7465  .        # Write
-0003b2b0: 2074 6865 203c 6669 6c74 6572 733e 2065   the <filters> e
-0003b2c0: 6c65 6d65 6e74 2e0a 2020 2020 2020 2020  lement..        
-0003b2d0: 6e6f 6e5f 626c 616e 6b73 203d 205b 6669  non_blanks = [fi
-0003b2e0: 6c74 6572 2066 6f72 2066 696c 7465 7220  lter for filter 
-0003b2f0: 696e 2066 696c 7465 7273 0a20 2020 2020  in filters.     
-0003b300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b310: 2069 6620 7374 7228 6669 6c74 6572 292e   if str(filter).
-0003b320: 6c6f 7765 7228 2920 213d 2027 626c 616e  lower() != 'blan
-0003b330: 6b73 275d 0a20 2020 2020 2020 2061 7474  ks'].        att
-0003b340: 7269 6275 7465 7320 3d20 5b5d 0a0a 2020  ributes = []..  
-0003b350: 2020 2020 2020 6966 206c 656e 2866 696c        if len(fil
-0003b360: 7465 7273 2920 213d 206c 656e 286e 6f6e  ters) != len(non
-0003b370: 5f62 6c61 6e6b 7329 3a0a 2020 2020 2020  _blanks):.      
-0003b380: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-0003b390: 203d 205b 2827 626c 616e 6b27 2c20 3129   = [('blank', 1)
-0003b3a0: 5d0a 0a20 2020 2020 2020 2069 6620 6c65  ]..        if le
-0003b3b0: 6e28 6669 6c74 6572 7329 203d 3d20 3120  n(filters) == 1 
-0003b3c0: 616e 6420 6c65 6e28 6e6f 6e5f 626c 616e  and len(non_blan
-0003b3d0: 6b73 2920 3d3d 2030 3a0a 2020 2020 2020  ks) == 0:.      
-0003b3e0: 2020 2020 2020 2320 5370 6563 6961 6c20        # Special 
-0003b3f0: 6361 7365 2066 6f72 2062 6c61 6e6b 2063  case for blank c
-0003b400: 656c 6c73 206f 6e6c 792e 0a20 2020 2020  ells only..     
-0003b410: 2020 2020 2020 2073 656c 662e 5f78 6d6c         self._xml
-0003b420: 5f65 6d70 7479 5f74 6167 2827 6669 6c74  _empty_tag('filt
-0003b430: 6572 7327 2c20 6174 7472 6962 7574 6573  ers', attributes
-0003b440: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-0003b450: 2020 2020 2020 2020 2020 2020 2320 4765              # Ge
-0003b460: 6e65 7261 6c20 6361 7365 2e0a 2020 2020  neral case..    
-0003b470: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
-0003b480: 6c5f 7374 6172 745f 7461 6728 2766 696c  l_start_tag('fil
-0003b490: 7465 7273 272c 2061 7474 7269 6275 7465  ters', attribute
-0003b4a0: 7329 0a0a 2020 2020 2020 2020 2020 2020  s)..            
-0003b4b0: 666f 7220 6175 746f 6669 6c74 6572 2069  for autofilter i
-0003b4c0: 6e20 736f 7274 6564 286e 6f6e 5f62 6c61  n sorted(non_bla
-0003b4d0: 6e6b 7329 3a0a 2020 2020 2020 2020 2020  nks):.          
-0003b4e0: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
-0003b4f0: 655f 6669 6c74 6572 2861 7574 6f66 696c  e_filter(autofil
-0003b500: 7465 7229 0a0a 2020 2020 2020 2020 2020  ter)..          
-0003b510: 2020 7365 6c66 2e5f 786d 6c5f 656e 645f    self._xml_end_
-0003b520: 7461 6728 2766 696c 7465 7273 2729 0a0a  tag('filters')..
-0003b530: 2020 2020 6465 6620 5f77 7269 7465 5f66      def _write_f
-0003b540: 696c 7465 7228 7365 6c66 2c20 7661 6c29  ilter(self, val)
-0003b550: 3a0a 2020 2020 2020 2020 2320 5772 6974  :.        # Writ
-0003b560: 6520 7468 6520 3c66 696c 7465 723e 2065  e the <filter> e
-0003b570: 6c65 6d65 6e74 2e0a 2020 2020 2020 2020  lement..        
-0003b580: 6174 7472 6962 7574 6573 203d 205b 2827  attributes = [('
-0003b590: 7661 6c27 2c20 7661 6c29 5d0a 0a20 2020  val', val)]..   
-0003b5a0: 2020 2020 2073 656c 662e 5f78 6d6c 5f65       self._xml_e
-0003b5b0: 6d70 7479 5f74 6167 2827 6669 6c74 6572  mpty_tag('filter
-0003b5c0: 272c 2061 7474 7269 6275 7465 7329 0a0a  ', attributes)..
-0003b5d0: 2020 2020 6465 6620 5f77 7269 7465 5f63      def _write_c
-0003b5e0: 7573 746f 6d5f 6669 6c74 6572 7328 7365  ustom_filters(se
-0003b5f0: 6c66 2c20 746f 6b65 6e73 293a 0a20 2020  lf, tokens):.   
-0003b600: 2020 2020 2023 2057 7269 7465 2074 6865       # Write the
-0003b610: 203c 6375 7374 6f6d 4669 6c74 6572 733e   <customFilters>
-0003b620: 2065 6c65 6d65 6e74 2e0a 2020 2020 2020   element..      
-0003b630: 2020 6966 206c 656e 2874 6f6b 656e 7329    if len(tokens)
-0003b640: 203d 3d20 323a 0a20 2020 2020 2020 2020   == 2:.         
-0003b650: 2020 2023 204f 6e65 2066 696c 7465 7220     # One filter 
-0003b660: 6578 7072 6573 7369 6f6e 206f 6e6c 792e  expression only.
-0003b670: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0003b680: 662e 5f78 6d6c 5f73 7461 7274 5f74 6167  f._xml_start_tag
-0003b690: 2827 6375 7374 6f6d 4669 6c74 6572 7327  ('customFilters'
-0003b6a0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0003b6b0: 6c66 2e5f 7772 6974 655f 6375 7374 6f6d  lf._write_custom
-0003b6c0: 5f66 696c 7465 7228 2a74 6f6b 656e 7329  _filter(*tokens)
-0003b6d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0003b6e0: 662e 5f78 6d6c 5f65 6e64 5f74 6167 2827  f._xml_end_tag('
-0003b6f0: 6375 7374 6f6d 4669 6c74 6572 7327 290a  customFilters').
-0003b700: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0003b710: 2020 2020 2020 2020 2020 2320 5477 6f20            # Two 
-0003b720: 6669 6c74 6572 2065 7870 7265 7373 696f  filter expressio
-0003b730: 6e73 2e0a 2020 2020 2020 2020 2020 2020  ns..            
-0003b740: 6174 7472 6962 7574 6573 203d 205b 5d0a  attributes = [].
-0003b750: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
-0003b760: 6865 636b 2069 6620 7468 6520 226a 6f69  heck if the "joi
-0003b770: 6e22 206f 7065 7261 6e64 2069 7320 2261  n" operand is "a
-0003b780: 6e64 2220 6f72 2022 6f72 222e 0a20 2020  nd" or "or"..   
-0003b790: 2020 2020 2020 2020 2069 6620 746f 6b65           if toke
-0003b7a0: 6e73 5b32 5d20 3d3d 2030 3a0a 2020 2020  ns[2] == 0:.    
-0003b7b0: 2020 2020 2020 2020 2020 2020 6174 7472              attr
-0003b7c0: 6962 7574 6573 203d 205b 2827 616e 6427  ibutes = [('and'
-0003b7d0: 2c20 3129 5d0a 2020 2020 2020 2020 2020  , 1)].          
-0003b7e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0003b7f0: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
-0003b800: 6573 203d 205b 2827 616e 6427 2c20 3029  es = [('and', 0)
-0003b810: 5d0a 0a20 2020 2020 2020 2020 2020 2023  ]..            #
-0003b820: 2057 7269 7465 2074 6865 2074 776f 2063   Write the two c
-0003b830: 7573 746f 6d20 6669 6c74 6572 732e 0a20  ustom filters.. 
-0003b840: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0003b850: 5f78 6d6c 5f73 7461 7274 5f74 6167 2827  _xml_start_tag('
-0003b860: 6375 7374 6f6d 4669 6c74 6572 7327 2c20  customFilters', 
-0003b870: 6174 7472 6962 7574 6573 290a 2020 2020  attributes).    
-0003b880: 2020 2020 2020 2020 7365 6c66 2e5f 7772          self._wr
-0003b890: 6974 655f 6375 7374 6f6d 5f66 696c 7465  ite_custom_filte
-0003b8a0: 7228 746f 6b65 6e73 5b30 5d2c 2074 6f6b  r(tokens[0], tok
-0003b8b0: 656e 735b 315d 290a 2020 2020 2020 2020  ens[1]).        
-0003b8c0: 2020 2020 7365 6c66 2e5f 7772 6974 655f      self._write_
-0003b8d0: 6375 7374 6f6d 5f66 696c 7465 7228 746f  custom_filter(to
-0003b8e0: 6b65 6e73 5b33 5d2c 2074 6f6b 656e 735b  kens[3], tokens[
-0003b8f0: 345d 290a 2020 2020 2020 2020 2020 2020  4]).            
-0003b900: 7365 6c66 2e5f 786d 6c5f 656e 645f 7461  self._xml_end_ta
-0003b910: 6728 2763 7573 746f 6d46 696c 7465 7273  g('customFilters
-0003b920: 2729 0a0a 2020 2020 6465 6620 5f77 7269  ')..    def _wri
-0003b930: 7465 5f63 7573 746f 6d5f 6669 6c74 6572  te_custom_filter
-0003b940: 2873 656c 662c 206f 7065 7261 746f 722c  (self, operator,
-0003b950: 2076 616c 293a 0a20 2020 2020 2020 2023   val):.        #
-0003b960: 2057 7269 7465 2074 6865 203c 6375 7374   Write the <cust
-0003b970: 6f6d 4669 6c74 6572 3e20 656c 656d 656e  omFilter> elemen
-0003b980: 742e 0a20 2020 2020 2020 2061 7474 7269  t..        attri
-0003b990: 6275 7465 7320 3d20 5b5d 0a0a 2020 2020  butes = []..    
-0003b9a0: 2020 2020 6f70 6572 6174 6f72 7320 3d20      operators = 
-0003b9b0: 7b0a 2020 2020 2020 2020 2020 2020 313a  {.            1:
-0003b9c0: 2027 6c65 7373 5468 616e 272c 0a20 2020   'lessThan',.   
-0003b9d0: 2020 2020 2020 2020 2032 3a20 2765 7175           2: 'equ
-0003b9e0: 616c 272c 0a20 2020 2020 2020 2020 2020  al',.           
-0003b9f0: 2033 3a20 276c 6573 7354 6861 6e4f 7245   3: 'lessThanOrE
-0003ba00: 7175 616c 272c 0a20 2020 2020 2020 2020  qual',.         
-0003ba10: 2020 2034 3a20 2767 7265 6174 6572 5468     4: 'greaterTh
-0003ba20: 616e 272c 0a20 2020 2020 2020 2020 2020  an',.           
-0003ba30: 2035 3a20 276e 6f74 4571 7561 6c27 2c0a   5: 'notEqual',.
-0003ba40: 2020 2020 2020 2020 2020 2020 363a 2027              6: '
-0003ba50: 6772 6561 7465 7254 6861 6e4f 7245 7175  greaterThanOrEqu
-0003ba60: 616c 272c 0a20 2020 2020 2020 2020 2020  al',.           
-0003ba70: 2032 323a 2027 6571 7561 6c27 2c0a 2020   22: 'equal',.  
-0003ba80: 2020 2020 2020 7d0a 0a20 2020 2020 2020        }..       
-0003ba90: 2023 2043 6f6e 7665 7274 2074 6865 206f   # Convert the o
-0003baa0: 7065 7261 746f 7220 6672 6f6d 2061 206e  perator from a n
-0003bab0: 756d 6265 7220 746f 2061 2064 6573 6372  umber to a descr
-0003bac0: 6970 7469 7665 2073 7472 696e 672e 0a20  iptive string.. 
-0003bad0: 2020 2020 2020 2069 6620 6f70 6572 6174         if operat
-0003bae0: 6f72 735b 6f70 6572 6174 6f72 5d20 6973  ors[operator] is
-0003baf0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-0003bb00: 2020 2020 2020 206f 7065 7261 746f 7220         operator 
-0003bb10: 3d20 6f70 6572 6174 6f72 735b 6f70 6572  = operators[oper
-0003bb20: 6174 6f72 5d0a 2020 2020 2020 2020 656c  ator].        el
-0003bb30: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0003bb40: 7761 726e 2822 556e 6b6e 6f77 6e20 6f70  warn("Unknown op
-0003bb50: 6572 6174 6f72 203d 2025 7322 2025 206f  erator = %s" % o
-0003bb60: 7065 7261 746f 7229 0a0a 2020 2020 2020  perator)..      
-0003bb70: 2020 2320 5468 6520 2765 7175 616c 2720    # The 'equal' 
-0003bb80: 6f70 6572 6174 6f72 2069 7320 7468 6520  operator is the 
-0003bb90: 6465 6661 756c 7420 6174 7472 6962 7574  default attribut
-0003bba0: 6520 616e 6420 6973 6e27 7420 7374 6f72  e and isn't stor
-0003bbb0: 6564 2e0a 2020 2020 2020 2020 6966 206e  ed..        if n
-0003bbc0: 6f74 206f 7065 7261 746f 7220 3d3d 2027  ot operator == '
-0003bbd0: 6571 7561 6c27 3a0a 2020 2020 2020 2020  equal':.        
-0003bbe0: 2020 2020 6174 7472 6962 7574 6573 2e61      attributes.a
-0003bbf0: 7070 656e 6428 2827 6f70 6572 6174 6f72  ppend(('operator
-0003bc00: 272c 206f 7065 7261 746f 7229 290a 2020  ', operator)).  
-0003bc10: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-0003bc20: 2e61 7070 656e 6428 2827 7661 6c27 2c20  .append(('val', 
-0003bc30: 7661 6c29 290a 0a20 2020 2020 2020 2073  val))..        s
-0003bc40: 656c 662e 5f78 6d6c 5f65 6d70 7479 5f74  elf._xml_empty_t
-0003bc50: 6167 2827 6375 7374 6f6d 4669 6c74 6572  ag('customFilter
-0003bc60: 272c 2061 7474 7269 6275 7465 7329 0a0a  ', attributes)..
-0003bc70: 2020 2020 6465 6620 5f77 7269 7465 5f73      def _write_s
-0003bc80: 6865 6574 5f70 726f 7465 6374 696f 6e28  heet_protection(
-0003bc90: 7365 6c66 293a 0a20 2020 2020 2020 2023  self):.        #
-0003bca0: 2057 7269 7465 2074 6865 203c 7368 6565   Write the <shee
-0003bcb0: 7450 726f 7465 6374 696f 6e3e 2065 6c65  tProtection> ele
-0003bcc0: 6d65 6e74 2e0a 2020 2020 2020 2020 6174  ment..        at
-0003bcd0: 7472 6962 7574 6573 203d 205b 5d0a 0a20  tributes = [].. 
-0003bce0: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-0003bcf0: 6c66 2e70 726f 7465 6374 5f6f 7074 696f  lf.protect_optio
-0003bd00: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
-0003bd10: 7265 7475 726e 0a0a 2020 2020 2020 2020  return..        
-0003bd20: 6f70 7469 6f6e 7320 3d20 7365 6c66 2e70  options = self.p
-0003bd30: 726f 7465 6374 5f6f 7074 696f 6e73 0a0a  rotect_options..
-0003bd40: 2020 2020 2020 2020 6966 206f 7074 696f          if optio
-0003bd50: 6e73 5b27 7061 7373 776f 7264 275d 3a0a  ns['password']:.
-0003bd60: 2020 2020 2020 2020 2020 2020 6174 7472              attr
-0003bd70: 6962 7574 6573 2e61 7070 656e 6428 2827  ibutes.append(('
-0003bd80: 7061 7373 776f 7264 272c 206f 7074 696f  password', optio
-0003bd90: 6e73 5b27 7061 7373 776f 7264 275d 2929  ns['password']))
-0003bda0: 0a20 2020 2020 2020 2069 6620 6f70 7469  .        if opti
-0003bdb0: 6f6e 735b 2773 6865 6574 275d 3a0a 2020  ons['sheet']:.  
-0003bdc0: 2020 2020 2020 2020 2020 6174 7472 6962            attrib
-0003bdd0: 7574 6573 2e61 7070 656e 6428 2827 7368  utes.append(('sh
-0003bde0: 6565 7427 2c20 3129 290a 2020 2020 2020  eet', 1)).      
-0003bdf0: 2020 6966 206f 7074 696f 6e73 5b27 636f    if options['co
-0003be00: 6e74 656e 7427 5d3a 0a20 2020 2020 2020  ntent']:.       
-0003be10: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
-0003be20: 6170 7065 6e64 2828 2763 6f6e 7465 6e74  append(('content
-0003be30: 272c 2031 2929 0a20 2020 2020 2020 2069  ', 1)).        i
-0003be40: 6620 6e6f 7420 6f70 7469 6f6e 735b 276f  f not options['o
-0003be50: 626a 6563 7473 275d 3a0a 2020 2020 2020  bjects']:.      
-0003be60: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-0003be70: 2e61 7070 656e 6428 2827 6f62 6a65 6374  .append(('object
-0003be80: 7327 2c20 3129 290a 2020 2020 2020 2020  s', 1)).        
-0003be90: 6966 206e 6f74 206f 7074 696f 6e73 5b27  if not options['
-0003bea0: 7363 656e 6172 696f 7327 5d3a 0a20 2020  scenarios']:.   
-0003beb0: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
-0003bec0: 7465 732e 6170 7065 6e64 2828 2773 6365  tes.append(('sce
-0003bed0: 6e61 7269 6f73 272c 2031 2929 0a20 2020  narios', 1)).   
-0003bee0: 2020 2020 2069 6620 6f70 7469 6f6e 735b       if options[
-0003bef0: 2766 6f72 6d61 745f 6365 6c6c 7327 5d3a  'format_cells']:
-0003bf00: 0a20 2020 2020 2020 2020 2020 2061 7474  .            att
-0003bf10: 7269 6275 7465 732e 6170 7065 6e64 2828  ributes.append((
-0003bf20: 2766 6f72 6d61 7443 656c 6c73 272c 2030  'formatCells', 0
-0003bf30: 2929 0a20 2020 2020 2020 2069 6620 6f70  )).        if op
-0003bf40: 7469 6f6e 735b 2766 6f72 6d61 745f 636f  tions['format_co
-0003bf50: 6c75 6d6e 7327 5d3a 0a20 2020 2020 2020  lumns']:.       
-0003bf60: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
-0003bf70: 6170 7065 6e64 2828 2766 6f72 6d61 7443  append(('formatC
-0003bf80: 6f6c 756d 6e73 272c 2030 2929 0a20 2020  olumns', 0)).   
-0003bf90: 2020 2020 2069 6620 6f70 7469 6f6e 735b       if options[
-0003bfa0: 2766 6f72 6d61 745f 726f 7773 275d 3a0a  'format_rows']:.
-0003bfb0: 2020 2020 2020 2020 2020 2020 6174 7472              attr
-0003bfc0: 6962 7574 6573 2e61 7070 656e 6428 2827  ibutes.append(('
-0003bfd0: 666f 726d 6174 526f 7773 272c 2030 2929  formatRows', 0))
-0003bfe0: 0a20 2020 2020 2020 2069 6620 6f70 7469  .        if opti
-0003bff0: 6f6e 735b 2769 6e73 6572 745f 636f 6c75  ons['insert_colu
-0003c000: 6d6e 7327 5d3a 0a20 2020 2020 2020 2020  mns']:.         
-0003c010: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
-0003c020: 7065 6e64 2828 2769 6e73 6572 7443 6f6c  pend(('insertCol
-0003c030: 756d 6e73 272c 2030 2929 0a20 2020 2020  umns', 0)).     
-0003c040: 2020 2069 6620 6f70 7469 6f6e 735b 2769     if options['i
-0003c050: 6e73 6572 745f 726f 7773 275d 3a0a 2020  nsert_rows']:.  
-0003c060: 2020 2020 2020 2020 2020 6174 7472 6962            attrib
-0003c070: 7574 6573 2e61 7070 656e 6428 2827 696e  utes.append(('in
-0003c080: 7365 7274 526f 7773 272c 2030 2929 0a20  sertRows', 0)). 
-0003c090: 2020 2020 2020 2069 6620 6f70 7469 6f6e         if option
-0003c0a0: 735b 2769 6e73 6572 745f 6879 7065 726c  s['insert_hyperl
-0003c0b0: 696e 6b73 275d 3a0a 2020 2020 2020 2020  inks']:.        
-0003c0c0: 2020 2020 6174 7472 6962 7574 6573 2e61      attributes.a
-0003c0d0: 7070 656e 6428 2827 696e 7365 7274 4879  ppend(('insertHy
-0003c0e0: 7065 726c 696e 6b73 272c 2030 2929 0a20  perlinks', 0)). 
-0003c0f0: 2020 2020 2020 2069 6620 6f70 7469 6f6e         if option
-0003c100: 735b 2764 656c 6574 655f 636f 6c75 6d6e  s['delete_column
-0003c110: 7327 5d3a 0a20 2020 2020 2020 2020 2020  s']:.           
-0003c120: 2061 7474 7269 6275 7465 732e 6170 7065   attributes.appe
-0003c130: 6e64 2828 2764 656c 6574 6543 6f6c 756d  nd(('deleteColum
-0003c140: 6e73 272c 2030 2929 0a20 2020 2020 2020  ns', 0)).       
-0003c150: 2069 6620 6f70 7469 6f6e 735b 2764 656c   if options['del
-0003c160: 6574 655f 726f 7773 275d 3a0a 2020 2020  ete_rows']:.    
-0003c170: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
-0003c180: 6573 2e61 7070 656e 6428 2827 6465 6c65  es.append(('dele
-0003c190: 7465 526f 7773 272c 2030 2929 0a20 2020  teRows', 0)).   
-0003c1a0: 2020 2020 2069 6620 6e6f 7420 6f70 7469       if not opti
-0003c1b0: 6f6e 735b 2773 656c 6563 745f 6c6f 636b  ons['select_lock
-0003c1c0: 6564 5f63 656c 6c73 275d 3a0a 2020 2020  ed_cells']:.    
-0003c1d0: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
-0003c1e0: 6573 2e61 7070 656e 6428 2827 7365 6c65  es.append(('sele
-0003c1f0: 6374 4c6f 636b 6564 4365 6c6c 7327 2c20  ctLockedCells', 
-0003c200: 3129 290a 2020 2020 2020 2020 6966 206f  1)).        if o
-0003c210: 7074 696f 6e73 5b27 736f 7274 275d 3a0a  ptions['sort']:.
-0003c220: 2020 2020 2020 2020 2020 2020 6174 7472              attr
-0003c230: 6962 7574 6573 2e61 7070 656e 6428 2827  ibutes.append(('
-0003c240: 736f 7274 272c 2030 2929 0a20 2020 2020  sort', 0)).     
-0003c250: 2020 2069 6620 6f70 7469 6f6e 735b 2761     if options['a
-0003c260: 7574 6f66 696c 7465 7227 5d3a 0a20 2020  utofilter']:.   
-0003c270: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
-0003c280: 7465 732e 6170 7065 6e64 2828 2761 7574  tes.append(('aut
-0003c290: 6f46 696c 7465 7227 2c20 3029 290a 2020  oFilter', 0)).  
-0003c2a0: 2020 2020 2020 6966 206f 7074 696f 6e73        if options
-0003c2b0: 5b27 7069 766f 745f 7461 626c 6573 275d  ['pivot_tables']
-0003c2c0: 3a0a 2020 2020 2020 2020 2020 2020 6174  :.            at
-0003c2d0: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
-0003c2e0: 2827 7069 766f 7454 6162 6c65 7327 2c20  ('pivotTables', 
-0003c2f0: 3029 290a 2020 2020 2020 2020 6966 206e  0)).        if n
-0003c300: 6f74 206f 7074 696f 6e73 5b27 7365 6c65  ot options['sele
-0003c310: 6374 5f75 6e6c 6f63 6b65 645f 6365 6c6c  ct_unlocked_cell
-0003c320: 7327 5d3a 0a20 2020 2020 2020 2020 2020  s']:.           
-0003c330: 2061 7474 7269 6275 7465 732e 6170 7065   attributes.appe
-0003c340: 6e64 2828 2773 656c 6563 7455 6e6c 6f63  nd(('selectUnloc
-0003c350: 6b65 6443 656c 6c73 272c 2031 2929 0a0a  kedCells', 1))..
-0003c360: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
-0003c370: 6c5f 656d 7074 795f 7461 6728 2773 6865  l_empty_tag('she
-0003c380: 6574 5072 6f74 6563 7469 6f6e 272c 2061  etProtection', a
-0003c390: 7474 7269 6275 7465 7329 0a0a 2020 2020  ttributes)..    
-0003c3a0: 6465 6620 5f77 7269 7465 5f70 726f 7465  def _write_prote
-0003c3b0: 6374 6564 5f72 616e 6765 7328 7365 6c66  cted_ranges(self
-0003c3c0: 293a 0a20 2020 2020 2020 2023 2057 7269  ):.        # Wri
-0003c3d0: 7465 2074 6865 203c 7072 6f74 6563 7465  te the <protecte
-0003c3e0: 6452 616e 6765 733e 2065 6c65 6d65 6e74  dRanges> element
-0003c3f0: 2e0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-0003c400: 662e 6e75 6d5f 7072 6f74 6563 7465 645f  f.num_protected_
-0003c410: 7261 6e67 6573 203d 3d20 303a 0a20 2020  ranges == 0:.   
-0003c420: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-0003c430: 0a20 2020 2020 2020 2073 656c 662e 5f78  .        self._x
-0003c440: 6d6c 5f73 7461 7274 5f74 6167 2827 7072  ml_start_tag('pr
-0003c450: 6f74 6563 7465 6452 616e 6765 7327 290a  otectedRanges').
-0003c460: 0a20 2020 2020 2020 2066 6f72 2028 6365  .        for (ce
-0003c470: 6c6c 5f72 616e 6765 2c20 7261 6e67 655f  ll_range, range_
-0003c480: 6e61 6d65 2c20 7061 7373 776f 7264 2920  name, password) 
-0003c490: 696e 2073 656c 662e 7072 6f74 6563 7465  in self.protecte
-0003c4a0: 645f 7261 6e67 6573 3a0a 2020 2020 2020  d_ranges:.      
-0003c4b0: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
-0003c4c0: 655f 7072 6f74 6563 7465 645f 7261 6e67  e_protected_rang
-0003c4d0: 6528 6365 6c6c 5f72 616e 6765 2c20 7261  e(cell_range, ra
-0003c4e0: 6e67 655f 6e61 6d65 2c20 7061 7373 776f  nge_name, passwo
-0003c4f0: 7264 290a 0a20 2020 2020 2020 2073 656c  rd)..        sel
-0003c500: 662e 5f78 6d6c 5f65 6e64 5f74 6167 2827  f._xml_end_tag('
-0003c510: 7072 6f74 6563 7465 6452 616e 6765 7327  protectedRanges'
-0003c520: 290a 0a20 2020 2064 6566 205f 7772 6974  )..    def _writ
-0003c530: 655f 7072 6f74 6563 7465 645f 7261 6e67  e_protected_rang
-0003c540: 6528 7365 6c66 2c20 6365 6c6c 5f72 616e  e(self, cell_ran
-0003c550: 6765 2c20 7261 6e67 655f 6e61 6d65 2c20  ge, range_name, 
-0003c560: 7061 7373 776f 7264 293a 0a20 2020 2020  password):.     
-0003c570: 2020 2023 2057 7269 7465 2074 6865 203c     # Write the <
-0003c580: 7072 6f74 6563 7465 6452 616e 6765 3e20  protectedRange> 
-0003c590: 656c 656d 656e 742e 0a20 2020 2020 2020  element..       
-0003c5a0: 2061 7474 7269 6275 7465 7320 3d20 5b5d   attributes = []
-0003c5b0: 0a0a 2020 2020 2020 2020 6966 2070 6173  ..        if pas
-0003c5c0: 7377 6f72 643a 0a20 2020 2020 2020 2020  sword:.         
-0003c5d0: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
-0003c5e0: 7065 6e64 2828 2770 6173 7377 6f72 6427  pend(('password'
-0003c5f0: 2c20 7061 7373 776f 7264 2929 0a0a 2020  , password))..  
-0003c600: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-0003c610: 2e61 7070 656e 6428 2827 7371 7265 6627  .append(('sqref'
-0003c620: 2c20 6365 6c6c 5f72 616e 6765 2929 0a20  , cell_range)). 
-0003c630: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
-0003c640: 732e 6170 7065 6e64 2828 276e 616d 6527  s.append(('name'
-0003c650: 2c20 7261 6e67 655f 6e61 6d65 2929 0a0a  , range_name))..
-0003c660: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
-0003c670: 6c5f 656d 7074 795f 7461 6728 2770 726f  l_empty_tag('pro
-0003c680: 7465 6374 6564 5261 6e67 6527 2c20 6174  tectedRange', at
-0003c690: 7472 6962 7574 6573 290a 0a20 2020 2064  tributes)..    d
-0003c6a0: 6566 205f 7772 6974 655f 6472 6177 696e  ef _write_drawin
-0003c6b0: 6773 2873 656c 6629 3a0a 2020 2020 2020  gs(self):.      
-0003c6c0: 2020 2320 5772 6974 6520 7468 6520 3c64    # Write the <d
-0003c6d0: 7261 7769 6e67 3e20 656c 656d 656e 7473  rawing> elements
-0003c6e0: 2e0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-0003c6f0: 2073 656c 662e 6472 6177 696e 673a 0a20   self.drawing:. 
-0003c700: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0003c710: 6e0a 0a20 2020 2020 2020 2073 656c 662e  n..        self.
-0003c720: 7265 6c5f 636f 756e 7420 2b3d 2031 0a20  rel_count += 1. 
-0003c730: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
-0003c740: 7465 5f64 7261 7769 6e67 2873 656c 662e  te_drawing(self.
-0003c750: 7265 6c5f 636f 756e 7429 0a0a 2020 2020  rel_count)..    
-0003c760: 6465 6620 5f77 7269 7465 5f64 7261 7769  def _write_drawi
-0003c770: 6e67 2873 656c 662c 2064 7261 7769 6e67  ng(self, drawing
-0003c780: 5f69 6429 3a0a 2020 2020 2020 2020 2320  _id):.        # 
-0003c790: 5772 6974 6520 7468 6520 3c64 7261 7769  Write the <drawi
-0003c7a0: 6e67 3e20 656c 656d 656e 742e 0a20 2020  ng> element..   
-0003c7b0: 2020 2020 2072 5f69 6420 3d20 2772 4964       r_id = 'rId
-0003c7c0: 2720 2b20 7374 7228 6472 6177 696e 675f  ' + str(drawing_
-0003c7d0: 6964 290a 0a20 2020 2020 2020 2061 7474  id)..        att
-0003c7e0: 7269 6275 7465 7320 3d20 5b28 2772 3a69  ributes = [('r:i
-0003c7f0: 6427 2c20 725f 6964 295d 0a0a 2020 2020  d', r_id)]..    
-0003c800: 2020 2020 7365 6c66 2e5f 786d 6c5f 656d      self._xml_em
-0003c810: 7074 795f 7461 6728 2764 7261 7769 6e67  pty_tag('drawing
-0003c820: 272c 2061 7474 7269 6275 7465 7329 0a0a  ', attributes)..
-0003c830: 2020 2020 6465 6620 5f77 7269 7465 5f6c      def _write_l
-0003c840: 6567 6163 795f 6472 6177 696e 6728 7365  egacy_drawing(se
-0003c850: 6c66 293a 0a20 2020 2020 2020 2023 2057  lf):.        # W
-0003c860: 7269 7465 2074 6865 203c 6c65 6761 6379  rite the <legacy
-0003c870: 4472 6177 696e 673e 2065 6c65 6d65 6e74  Drawing> element
-0003c880: 2e0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-0003c890: 2073 656c 662e 6861 735f 766d 6c3a 0a20   self.has_vml:. 
-0003c8a0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0003c8b0: 6e0a 0a20 2020 2020 2020 2023 2049 6e63  n..        # Inc
-0003c8c0: 7265 6d65 6e74 2074 6865 2072 656c 6174  rement the relat
-0003c8d0: 696f 6e73 6869 7020 6964 2066 6f72 2061  ionship id for a
-0003c8e0: 6e79 2064 7261 7769 6e67 7320 6f72 2063  ny drawings or c
-0003c8f0: 6f6d 6d65 6e74 732e 0a20 2020 2020 2020  omments..       
-0003c900: 2073 656c 662e 7265 6c5f 636f 756e 7420   self.rel_count 
-0003c910: 2b3d 2031 0a20 2020 2020 2020 2072 5f69  += 1.        r_i
-0003c920: 6420 3d20 2772 4964 2720 2b20 7374 7228  d = 'rId' + str(
-0003c930: 7365 6c66 2e72 656c 5f63 6f75 6e74 290a  self.rel_count).
-0003c940: 0a20 2020 2020 2020 2061 7474 7269 6275  .        attribu
-0003c950: 7465 7320 3d20 5b28 2772 3a69 6427 2c20  tes = [('r:id', 
-0003c960: 725f 6964 295d 0a0a 2020 2020 2020 2020  r_id)]..        
-0003c970: 7365 6c66 2e5f 786d 6c5f 656d 7074 795f  self._xml_empty_
-0003c980: 7461 6728 276c 6567 6163 7944 7261 7769  tag('legacyDrawi
-0003c990: 6e67 272c 2061 7474 7269 6275 7465 7329  ng', attributes)
-0003c9a0: 0a0a 2020 2020 6465 6620 5f77 7269 7465  ..    def _write
-0003c9b0: 5f6c 6567 6163 795f 6472 6177 696e 675f  _legacy_drawing_
-0003c9c0: 6866 2873 656c 6629 3a0a 2020 2020 2020  hf(self):.      
-0003c9d0: 2020 2320 5772 6974 6520 7468 6520 3c6c    # Write the <l
-0003c9e0: 6567 6163 7944 7261 7769 6e67 4846 3e20  egacyDrawingHF> 
-0003c9f0: 656c 656d 656e 742e 0a20 2020 2020 2020  element..       
-0003ca00: 2069 6620 6e6f 7420 7365 6c66 2e68 6173   if not self.has
-0003ca10: 5f68 6561 6465 725f 766d 6c3a 0a20 2020  _header_vml:.   
-0003ca20: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-0003ca30: 0a20 2020 2020 2020 2023 2049 6e63 7265  .        # Incre
-0003ca40: 6d65 6e74 2074 6865 2072 656c 6174 696f  ment the relatio
-0003ca50: 6e73 6869 7020 6964 2066 6f72 2061 6e79  nship id for any
-0003ca60: 2064 7261 7769 6e67 7320 6f72 2063 6f6d   drawings or com
-0003ca70: 6d65 6e74 732e 0a20 2020 2020 2020 2073  ments..        s
-0003ca80: 656c 662e 7265 6c5f 636f 756e 7420 2b3d  elf.rel_count +=
-0003ca90: 2031 0a20 2020 2020 2020 2072 5f69 6420   1.        r_id 
-0003caa0: 3d20 2772 4964 2720 2b20 7374 7228 7365  = 'rId' + str(se
-0003cab0: 6c66 2e72 656c 5f63 6f75 6e74 290a 0a20  lf.rel_count).. 
-0003cac0: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
-0003cad0: 7320 3d20 5b28 2772 3a69 6427 2c20 725f  s = [('r:id', r_
-0003cae0: 6964 295d 0a0a 2020 2020 2020 2020 7365  id)]..        se
-0003caf0: 6c66 2e5f 786d 6c5f 656d 7074 795f 7461  lf._xml_empty_ta
-0003cb00: 6728 276c 6567 6163 7944 7261 7769 6e67  g('legacyDrawing
-0003cb10: 4846 272c 2061 7474 7269 6275 7465 7329  HF', attributes)
-0003cb20: 0a0a 2020 2020 6465 6620 5f77 7269 7465  ..    def _write
-0003cb30: 5f70 6963 7475 7265 2873 656c 6629 3a0a  _picture(self):.
-0003cb40: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
-0003cb50: 7468 6520 3c70 6963 7475 7265 3e20 656c  the <picture> el
-0003cb60: 656d 656e 742e 0a20 2020 2020 2020 2069  ement..        i
-0003cb70: 6620 6e6f 7420 7365 6c66 2e62 6163 6b67  f not self.backg
-0003cb80: 726f 756e 645f 696d 6167 653a 0a20 2020  round_image:.   
-0003cb90: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-0003cba0: 0a20 2020 2020 2020 2023 2049 6e63 7265  .        # Incre
-0003cbb0: 6d65 6e74 2074 6865 2072 656c 6174 696f  ment the relatio
-0003cbc0: 6e73 6869 7020 6964 2e0a 2020 2020 2020  nship id..      
-0003cbd0: 2020 7365 6c66 2e72 656c 5f63 6f75 6e74    self.rel_count
-0003cbe0: 202b 3d20 310a 2020 2020 2020 2020 725f   += 1.        r_
-0003cbf0: 6964 203d 2027 7249 6427 202b 2073 7472  id = 'rId' + str
-0003cc00: 2873 656c 662e 7265 6c5f 636f 756e 7429  (self.rel_count)
-0003cc10: 0a0a 2020 2020 2020 2020 6174 7472 6962  ..        attrib
-0003cc20: 7574 6573 203d 205b 2827 723a 6964 272c  utes = [('r:id',
-0003cc30: 2072 5f69 6429 5d0a 0a20 2020 2020 2020   r_id)]..       
-0003cc40: 2073 656c 662e 5f78 6d6c 5f65 6d70 7479   self._xml_empty
-0003cc50: 5f74 6167 2827 7069 6374 7572 6527 2c20  _tag('picture', 
-0003cc60: 6174 7472 6962 7574 6573 290a 0a20 2020  attributes)..   
-0003cc70: 2064 6566 205f 7772 6974 655f 6461 7461   def _write_data
-0003cc80: 5f76 616c 6964 6174 696f 6e73 2873 656c  _validations(sel
-0003cc90: 6629 3a0a 2020 2020 2020 2020 2320 5772  f):.        # Wr
-0003cca0: 6974 6520 7468 6520 3c64 6174 6156 616c  ite the <dataVal
-0003ccb0: 6964 6174 696f 6e73 3e20 656c 656d 656e  idations> elemen
-0003ccc0: 742e 0a20 2020 2020 2020 2076 616c 6964  t..        valid
-0003ccd0: 6174 696f 6e73 203d 2073 656c 662e 7661  ations = self.va
-0003cce0: 6c69 6461 7469 6f6e 730a 2020 2020 2020  lidations.      
-0003ccf0: 2020 636f 756e 7420 3d20 6c65 6e28 7661    count = len(va
-0003cd00: 6c69 6461 7469 6f6e 7329 0a0a 2020 2020  lidations)..    
-0003cd10: 2020 2020 6966 206e 6f74 2063 6f75 6e74      if not count
-0003cd20: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0003cd30: 7475 726e 0a0a 2020 2020 2020 2020 6174  turn..        at
-0003cd40: 7472 6962 7574 6573 203d 205b 2827 636f  tributes = [('co
-0003cd50: 756e 7427 2c20 636f 756e 7429 5d0a 0a20  unt', count)].. 
-0003cd60: 2020 2020 2020 2073 656c 662e 5f78 6d6c         self._xml
-0003cd70: 5f73 7461 7274 5f74 6167 2827 6461 7461  _start_tag('data
-0003cd80: 5661 6c69 6461 7469 6f6e 7327 2c20 6174  Validations', at
-0003cd90: 7472 6962 7574 6573 290a 0a20 2020 2020  tributes)..     
-0003cda0: 2020 2066 6f72 2076 616c 6964 6174 696f     for validatio
-0003cdb0: 6e20 696e 2076 616c 6964 6174 696f 6e73  n in validations
-0003cdc0: 3a0a 0a20 2020 2020 2020 2020 2020 2023  :..            #
-0003cdd0: 2057 7269 7465 2074 6865 2064 6174 6156   Write the dataV
-0003cde0: 616c 6964 6174 696f 6e20 656c 656d 656e  alidation elemen
-0003cdf0: 742e 0a20 2020 2020 2020 2020 2020 2073  t..            s
-0003ce00: 656c 662e 5f77 7269 7465 5f64 6174 615f  elf._write_data_
-0003ce10: 7661 6c69 6461 7469 6f6e 2876 616c 6964  validation(valid
-0003ce20: 6174 696f 6e29 0a0a 2020 2020 2020 2020  ation)..        
-0003ce30: 7365 6c66 2e5f 786d 6c5f 656e 645f 7461  self._xml_end_ta
-0003ce40: 6728 2764 6174 6156 616c 6964 6174 696f  g('dataValidatio
-0003ce50: 6e73 2729 0a0a 2020 2020 6465 6620 5f77  ns')..    def _w
-0003ce60: 7269 7465 5f64 6174 615f 7661 6c69 6461  rite_data_valida
-0003ce70: 7469 6f6e 2873 656c 662c 206f 7074 696f  tion(self, optio
-0003ce80: 6e73 293a 0a20 2020 2020 2020 2023 2057  ns):.        # W
-0003ce90: 7269 7465 2074 6865 203c 6461 7461 5661  rite the <dataVa
-0003cea0: 6c69 6461 7469 6f6e 3e20 656c 656d 656e  lidation> elemen
-0003ceb0: 742e 0a20 2020 2020 2020 2073 7172 6566  t..        sqref
-0003cec0: 203d 2027 270a 2020 2020 2020 2020 6174   = ''.        at
-0003ced0: 7472 6962 7574 6573 203d 205b 5d0a 0a20  tributes = [].. 
-0003cee0: 2020 2020 2020 2023 2053 6574 2074 6865         # Set the
-0003cef0: 2063 656c 6c20 7261 6e67 6528 7329 2066   cell range(s) f
-0003cf00: 6f72 2074 6865 2064 6174 6120 7661 6c69  or the data vali
-0003cf10: 6461 7469 6f6e 2e0a 2020 2020 2020 2020  dation..        
-0003cf20: 666f 7220 6365 6c6c 7320 696e 206f 7074  for cells in opt
-0003cf30: 696f 6e73 5b27 6365 6c6c 7327 5d3a 0a0a  ions['cells']:..
-0003cf40: 2020 2020 2020 2020 2020 2020 2320 4164              # Ad
-0003cf50: 6420 6120 7370 6163 6520 6265 7477 6565  d a space betwee
-0003cf60: 6e20 6d75 6c74 6970 6c65 2063 656c 6c20  n multiple cell 
-0003cf70: 7261 6e67 6573 2e0a 2020 2020 2020 2020  ranges..        
-0003cf80: 2020 2020 6966 2073 7172 6566 2021 3d20      if sqref != 
-0003cf90: 2727 3a0a 2020 2020 2020 2020 2020 2020  '':.            
-0003cfa0: 2020 2020 7371 7265 6620 2b3d 2027 2027      sqref += ' '
-0003cfb0: 0a0a 2020 2020 2020 2020 2020 2020 2872  ..            (r
-0003cfc0: 6f77 5f66 6972 7374 2c20 636f 6c5f 6669  ow_first, col_fi
-0003cfd0: 7273 742c 2072 6f77 5f6c 6173 742c 2063  rst, row_last, c
-0003cfe0: 6f6c 5f6c 6173 7429 203d 2063 656c 6c73  ol_last) = cells
-0003cff0: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-0003d000: 5377 6170 206c 6173 7420 726f 772f 636f  Swap last row/co
-0003d010: 6c20 666f 7220 6669 7273 7420 726f 772f  l for first row/
-0003d020: 636f 6c20 6173 206e 6563 6573 7361 7279  col as necessary
-0003d030: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0003d040: 726f 775f 6669 7273 7420 3e20 726f 775f  row_first > row_
-0003d050: 6c61 7374 3a0a 2020 2020 2020 2020 2020  last:.          
-0003d060: 2020 2020 2020 2872 6f77 5f66 6972 7374        (row_first
-0003d070: 2c20 726f 775f 6c61 7374 2920 3d20 2872  , row_last) = (r
-0003d080: 6f77 5f6c 6173 742c 2072 6f77 5f66 6972  ow_last, row_fir
-0003d090: 7374 290a 0a20 2020 2020 2020 2020 2020  st)..           
-0003d0a0: 2069 6620 636f 6c5f 6669 7273 7420 3e20   if col_first > 
-0003d0b0: 636f 6c5f 6c61 7374 3a0a 2020 2020 2020  col_last:.      
-0003d0c0: 2020 2020 2020 2020 2020 2863 6f6c 5f66            (col_f
-0003d0d0: 6972 7374 2c20 636f 6c5f 6c61 7374 2920  irst, col_last) 
-0003d0e0: 3d20 2863 6f6c 5f6c 6173 742c 2063 6f6c  = (col_last, col
-0003d0f0: 5f66 6972 7374 290a 0a20 2020 2020 2020  _first)..       
-0003d100: 2020 2020 2073 7172 6566 202b 3d20 786c       sqref += xl
-0003d110: 5f72 616e 6765 2872 6f77 5f66 6972 7374  _range(row_first
-0003d120: 2c20 636f 6c5f 6669 7273 742c 2072 6f77  , col_first, row
-0003d130: 5f6c 6173 742c 2063 6f6c 5f6c 6173 7429  _last, col_last)
-0003d140: 0a0a 2020 2020 2020 2020 6966 206f 7074  ..        if opt
-0003d150: 696f 6e73 2e67 6574 2827 6d75 6c74 695f  ions.get('multi_
-0003d160: 7261 6e67 6527 293a 0a20 2020 2020 2020  range'):.       
-0003d170: 2020 2020 2073 7172 6566 203d 206f 7074       sqref = opt
-0003d180: 696f 6e73 5b27 6d75 6c74 695f 7261 6e67  ions['multi_rang
-0003d190: 6527 5d0a 0a20 2020 2020 2020 2069 6620  e']..        if 
-0003d1a0: 6f70 7469 6f6e 735b 2776 616c 6964 6174  options['validat
-0003d1b0: 6527 5d20 213d 2027 6e6f 6e65 273a 0a20  e'] != 'none':. 
-0003d1c0: 2020 2020 2020 2020 2020 2061 7474 7269             attri
-0003d1d0: 6275 7465 732e 6170 7065 6e64 2828 2774  butes.append(('t
-0003d1e0: 7970 6527 2c20 6f70 7469 6f6e 735b 2776  ype', options['v
-0003d1f0: 616c 6964 6174 6527 5d29 290a 0a20 2020  alidate']))..   
-0003d200: 2020 2020 2020 2020 2069 6620 6f70 7469           if opti
-0003d210: 6f6e 735b 2763 7269 7465 7269 6127 5d20  ons['criteria'] 
-0003d220: 213d 2027 6265 7477 6565 6e27 3a0a 2020  != 'between':.  
-0003d230: 2020 2020 2020 2020 2020 2020 2020 6174                at
-0003d240: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
-0003d250: 2827 6f70 6572 6174 6f72 272c 206f 7074  ('operator', opt
-0003d260: 696f 6e73 5b27 6372 6974 6572 6961 275d  ions['criteria']
-0003d270: 2929 0a0a 2020 2020 2020 2020 6966 2027  ))..        if '
-0003d280: 6572 726f 725f 7479 7065 2720 696e 206f  error_type' in o
-0003d290: 7074 696f 6e73 3a0a 2020 2020 2020 2020  ptions:.        
-0003d2a0: 2020 2020 6966 206f 7074 696f 6e73 5b27      if options['
-0003d2b0: 6572 726f 725f 7479 7065 275d 203d 3d20  error_type'] == 
-0003d2c0: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
-0003d2d0: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
-0003d2e0: 7065 6e64 2828 2765 7272 6f72 5374 796c  pend(('errorStyl
-0003d2f0: 6527 2c20 2777 6172 6e69 6e67 2729 290a  e', 'warning')).
-0003d300: 2020 2020 2020 2020 2020 2020 6966 206f              if o
-0003d310: 7074 696f 6e73 5b27 6572 726f 725f 7479  ptions['error_ty
-0003d320: 7065 275d 203d 3d20 323a 0a20 2020 2020  pe'] == 2:.     
-0003d330: 2020 2020 2020 2020 2020 2061 7474 7269             attri
-0003d340: 6275 7465 732e 6170 7065 6e64 2828 2765  butes.append(('e
-0003d350: 7272 6f72 5374 796c 6527 2c20 2769 6e66  rrorStyle', 'inf
-0003d360: 6f72 6d61 7469 6f6e 2729 290a 0a20 2020  ormation'))..   
-0003d370: 2020 2020 2069 6620 6f70 7469 6f6e 735b       if options[
-0003d380: 2769 676e 6f72 655f 626c 616e 6b27 5d3a  'ignore_blank']:
-0003d390: 0a20 2020 2020 2020 2020 2020 2061 7474  .            att
-0003d3a0: 7269 6275 7465 732e 6170 7065 6e64 2828  ributes.append((
-0003d3b0: 2761 6c6c 6f77 426c 616e 6b27 2c20 3129  'allowBlank', 1)
-0003d3c0: 290a 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
-0003d3d0: 7420 6f70 7469 6f6e 735b 2764 726f 7064  t options['dropd
-0003d3e0: 6f77 6e27 5d3a 0a20 2020 2020 2020 2020  own']:.         
-0003d3f0: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
-0003d400: 7065 6e64 2828 2773 686f 7744 726f 7044  pend(('showDropD
-0003d410: 6f77 6e27 2c20 3129 290a 0a20 2020 2020  own', 1))..     
-0003d420: 2020 2069 6620 6f70 7469 6f6e 735b 2773     if options['s
-0003d430: 686f 775f 696e 7075 7427 5d3a 0a20 2020  how_input']:.   
-0003d440: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
-0003d450: 7465 732e 6170 7065 6e64 2828 2773 686f  tes.append(('sho
-0003d460: 7749 6e70 7574 4d65 7373 6167 6527 2c20  wInputMessage', 
-0003d470: 3129 290a 0a20 2020 2020 2020 2069 6620  1))..        if 
-0003d480: 6f70 7469 6f6e 735b 2773 686f 775f 6572  options['show_er
-0003d490: 726f 7227 5d3a 0a20 2020 2020 2020 2020  ror']:.         
-0003d4a0: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
-0003d4b0: 7065 6e64 2828 2773 686f 7745 7272 6f72  pend(('showError
-0003d4c0: 4d65 7373 6167 6527 2c20 3129 290a 0a20  Message', 1)).. 
-0003d4d0: 2020 2020 2020 2069 6620 2765 7272 6f72         if 'error
-0003d4e0: 5f74 6974 6c65 2720 696e 206f 7074 696f  _title' in optio
-0003d4f0: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
-0003d500: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
-0003d510: 6428 2827 6572 726f 7254 6974 6c65 272c  d(('errorTitle',
-0003d520: 206f 7074 696f 6e73 5b27 6572 726f 725f   options['error_
-0003d530: 7469 746c 6527 5d29 290a 0a20 2020 2020  title']))..     
-0003d540: 2020 2069 6620 2765 7272 6f72 5f6d 6573     if 'error_mes
-0003d550: 7361 6765 2720 696e 206f 7074 696f 6e73  sage' in options
-0003d560: 3a0a 2020 2020 2020 2020 2020 2020 6174  :.            at
-0003d570: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
-0003d580: 2827 6572 726f 7227 2c20 6f70 7469 6f6e  ('error', option
-0003d590: 735b 2765 7272 6f72 5f6d 6573 7361 6765  s['error_message
-0003d5a0: 275d 2929 0a0a 2020 2020 2020 2020 6966  ']))..        if
-0003d5b0: 2027 696e 7075 745f 7469 746c 6527 2069   'input_title' i
-0003d5c0: 6e20 6f70 7469 6f6e 733a 0a20 2020 2020  n options:.     
-0003d5d0: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
-0003d5e0: 732e 6170 7065 6e64 2828 2770 726f 6d70  s.append(('promp
-0003d5f0: 7454 6974 6c65 272c 206f 7074 696f 6e73  tTitle', options
-0003d600: 5b27 696e 7075 745f 7469 746c 6527 5d29  ['input_title'])
-0003d610: 290a 0a20 2020 2020 2020 2069 6620 2769  )..        if 'i
-0003d620: 6e70 7574 5f6d 6573 7361 6765 2720 696e  nput_message' in
-0003d630: 206f 7074 696f 6e73 3a0a 2020 2020 2020   options:.      
-0003d640: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-0003d650: 2e61 7070 656e 6428 2827 7072 6f6d 7074  .append(('prompt
-0003d660: 272c 206f 7074 696f 6e73 5b27 696e 7075  ', options['inpu
-0003d670: 745f 6d65 7373 6167 6527 5d29 290a 0a20  t_message'])).. 
-0003d680: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
-0003d690: 732e 6170 7065 6e64 2828 2773 7172 6566  s.append(('sqref
-0003d6a0: 272c 2073 7172 6566 2929 0a0a 2020 2020  ', sqref))..    
-0003d6b0: 2020 2020 6966 206f 7074 696f 6e73 5b27      if options['
-0003d6c0: 7661 6c69 6461 7465 275d 203d 3d20 276e  validate'] == 'n
-0003d6d0: 6f6e 6527 3a0a 2020 2020 2020 2020 2020  one':.          
-0003d6e0: 2020 7365 6c66 2e5f 786d 6c5f 656d 7074    self._xml_empt
-0003d6f0: 795f 7461 6728 2764 6174 6156 616c 6964  y_tag('dataValid
-0003d700: 6174 696f 6e27 2c20 6174 7472 6962 7574  ation', attribut
-0003d710: 6573 290a 2020 2020 2020 2020 656c 7365  es).        else
-0003d720: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0003d730: 6c66 2e5f 786d 6c5f 7374 6172 745f 7461  lf._xml_start_ta
-0003d740: 6728 2764 6174 6156 616c 6964 6174 696f  g('dataValidatio
-0003d750: 6e27 2c20 6174 7472 6962 7574 6573 290a  n', attributes).
-0003d760: 0a20 2020 2020 2020 2020 2020 2023 2057  .            # W
-0003d770: 7269 7465 2074 6865 2066 6f72 6d75 6c61  rite the formula
-0003d780: 3120 656c 656d 656e 742e 0a20 2020 2020  1 element..     
-0003d790: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
-0003d7a0: 7465 5f66 6f72 6d75 6c61 5f31 286f 7074  te_formula_1(opt
-0003d7b0: 696f 6e73 5b27 7661 6c75 6527 5d29 0a0a  ions['value'])..
-0003d7c0: 2020 2020 2020 2020 2020 2020 2320 5772              # Wr
-0003d7d0: 6974 6520 7468 6520 666f 726d 756c 6132  ite the formula2
-0003d7e0: 2065 6c65 6d65 6e74 2e0a 2020 2020 2020   element..      
-0003d7f0: 2020 2020 2020 6966 206f 7074 696f 6e73        if options
-0003d800: 5b27 6d61 7869 6d75 6d27 5d20 6973 206e  ['maximum'] is n
-0003d810: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0003d820: 2020 2020 2020 2020 2073 656c 662e 5f77           self._w
-0003d830: 7269 7465 5f66 6f72 6d75 6c61 5f32 286f  rite_formula_2(o
-0003d840: 7074 696f 6e73 5b27 6d61 7869 6d75 6d27  ptions['maximum'
-0003d850: 5d29 0a0a 2020 2020 2020 2020 2020 2020  ])..            
-0003d860: 7365 6c66 2e5f 786d 6c5f 656e 645f 7461  self._xml_end_ta
-0003d870: 6728 2764 6174 6156 616c 6964 6174 696f  g('dataValidatio
-0003d880: 6e27 290a 0a20 2020 2064 6566 205f 7772  n')..    def _wr
-0003d890: 6974 655f 666f 726d 756c 615f 3128 7365  ite_formula_1(se
-0003d8a0: 6c66 2c20 666f 726d 756c 6129 3a0a 2020  lf, formula):.  
-0003d8b0: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
-0003d8c0: 6520 3c66 6f72 6d75 6c61 313e 2065 6c65  e <formula1> ele
-0003d8d0: 6d65 6e74 2e0a 0a20 2020 2020 2020 2069  ment...        i
-0003d8e0: 6620 7479 7065 2866 6f72 6d75 6c61 2920  f type(formula) 
-0003d8f0: 6973 206c 6973 743a 0a20 2020 2020 2020  is list:.       
-0003d900: 2020 2020 2066 6f72 6d75 6c61 203d 2073       formula = s
-0003d910: 656c 662e 5f63 7376 5f6a 6f69 6e28 2a66  elf._csv_join(*f
-0003d920: 6f72 6d75 6c61 290a 2020 2020 2020 2020  ormula).        
-0003d930: 2020 2020 666f 726d 756c 6120 3d20 2722      formula = '"
-0003d940: 2573 2227 2025 2066 6f72 6d75 6c61 0a20  %s"' % formula. 
-0003d950: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0003d960: 2020 2020 2020 2020 2023 2043 6865 636b           # Check
-0003d970: 2069 6620 7468 6520 666f 726d 756c 6120   if the formula 
-0003d980: 6973 2061 206e 756d 6265 722e 0a20 2020  is a number..   
-0003d990: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
-0003d9a0: 2020 2020 2020 2020 2020 2020 2020 666c                fl
-0003d9b0: 6f61 7428 666f 726d 756c 6129 0a20 2020  oat(formula).   
-0003d9c0: 2020 2020 2020 2020 2065 7863 6570 7420           except 
-0003d9d0: 5661 6c75 6545 7272 6f72 3a0a 2020 2020  ValueError:.    
-0003d9e0: 2020 2020 2020 2020 2020 2020 2320 4e6f              # No
-0003d9f0: 7420 6120 6e75 6d62 6572 2e20 5265 6d6f  t a number. Remo
-0003da00: 7665 2074 6865 2066 6f72 6d75 6c61 2027  ve the formula '
-0003da10: 3d27 2073 6967 6e20 6966 2069 7420 6578  =' sign if it ex
-0003da20: 6973 7473 2e0a 2020 2020 2020 2020 2020  ists..          
-0003da30: 2020 2020 2020 6966 2066 6f72 6d75 6c61        if formula
-0003da40: 2e73 7461 7274 7377 6974 6828 273d 2729  .startswith('=')
-0003da50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0003da60: 2020 2020 2020 666f 726d 756c 6120 3d20        formula = 
-0003da70: 666f 726d 756c 612e 6c73 7472 6970 2827  formula.lstrip('
-0003da80: 3d27 290a 0a20 2020 2020 2020 2073 656c  =')..        sel
-0003da90: 662e 5f78 6d6c 5f64 6174 615f 656c 656d  f._xml_data_elem
-0003daa0: 656e 7428 2766 6f72 6d75 6c61 3127 2c20  ent('formula1', 
-0003dab0: 666f 726d 756c 6129 0a0a 2020 2020 6465  formula)..    de
-0003dac0: 6620 5f77 7269 7465 5f66 6f72 6d75 6c61  f _write_formula
-0003dad0: 5f32 2873 656c 662c 2066 6f72 6d75 6c61  _2(self, formula
-0003dae0: 293a 0a20 2020 2020 2020 2023 2057 7269  ):.        # Wri
-0003daf0: 7465 2074 6865 203c 666f 726d 756c 6132  te the <formula2
-0003db00: 3e20 656c 656d 656e 742e 0a0a 2020 2020  > element...    
-0003db10: 2020 2020 2320 4368 6563 6b20 6966 2074      # Check if t
-0003db20: 6865 2066 6f72 6d75 6c61 2069 7320 6120  he formula is a 
-0003db30: 6e75 6d62 6572 2e0a 2020 2020 2020 2020  number..        
-0003db40: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
-0003db50: 2066 6c6f 6174 2866 6f72 6d75 6c61 290a   float(formula).
-0003db60: 2020 2020 2020 2020 6578 6365 7074 2056          except V
-0003db70: 616c 7565 4572 726f 723a 0a20 2020 2020  alueError:.     
-0003db80: 2020 2020 2020 2023 204e 6f74 2061 206e         # Not a n
-0003db90: 756d 6265 722e 2052 656d 6f76 6520 7468  umber. Remove th
-0003dba0: 6520 666f 726d 756c 6120 273d 2720 7369  e formula '=' si
-0003dbb0: 676e 2069 6620 6974 2065 7869 7374 732e  gn if it exists.
-0003dbc0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0003dbd0: 666f 726d 756c 612e 7374 6172 7473 7769  formula.startswi
-0003dbe0: 7468 2827 3d27 293a 0a20 2020 2020 2020  th('='):.       
-0003dbf0: 2020 2020 2020 2020 2066 6f72 6d75 6c61           formula
-0003dc00: 203d 2066 6f72 6d75 6c61 2e6c 7374 7269   = formula.lstri
-0003dc10: 7028 273d 2729 0a0a 2020 2020 2020 2020  p('=')..        
-0003dc20: 7365 6c66 2e5f 786d 6c5f 6461 7461 5f65  self._xml_data_e
-0003dc30: 6c65 6d65 6e74 2827 666f 726d 756c 6132  lement('formula2
-0003dc40: 272c 2066 6f72 6d75 6c61 290a 0a20 2020  ', formula)..   
-0003dc50: 2064 6566 205f 7772 6974 655f 636f 6e64   def _write_cond
-0003dc60: 6974 696f 6e61 6c5f 666f 726d 6174 7328  itional_formats(
-0003dc70: 7365 6c66 293a 0a20 2020 2020 2020 2023  self):.        #
-0003dc80: 2057 7269 7465 2074 6865 2057 6f72 6b73   Write the Works
-0003dc90: 6865 6574 2063 6f6e 6469 7469 6f6e 616c  heet conditional
-0003dca0: 2066 6f72 6d61 7473 2e0a 2020 2020 2020   formats..      
-0003dcb0: 2020 7261 6e67 6573 203d 2073 6f72 7465    ranges = sorte
-0003dcc0: 6428 7365 6c66 2e63 6f6e 645f 666f 726d  d(self.cond_form
-0003dcd0: 6174 732e 6b65 7973 2829 290a 0a20 2020  ats.keys())..   
-0003dce0: 2020 2020 2069 6620 6e6f 7420 7261 6e67       if not rang
-0003dcf0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-0003dd00: 7265 7475 726e 0a0a 2020 2020 2020 2020  return..        
-0003dd10: 666f 7220 636f 6e64 5f72 616e 6765 2069  for cond_range i
-0003dd20: 6e20 7261 6e67 6573 3a0a 2020 2020 2020  n ranges:.      
-0003dd30: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
-0003dd40: 655f 636f 6e64 6974 696f 6e61 6c5f 666f  e_conditional_fo
-0003dd50: 726d 6174 7469 6e67 2863 6f6e 645f 7261  rmatting(cond_ra
-0003dd60: 6e67 652c 0a20 2020 2020 2020 2020 2020  nge,.           
-0003dd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dd90: 2020 2020 7365 6c66 2e63 6f6e 645f 666f      self.cond_fo
-0003dda0: 726d 6174 735b 636f 6e64 5f72 616e 6765  rmats[cond_range
-0003ddb0: 5d29 0a0a 2020 2020 6465 6620 5f77 7269  ])..    def _wri
-0003ddc0: 7465 5f63 6f6e 6469 7469 6f6e 616c 5f66  te_conditional_f
-0003ddd0: 6f72 6d61 7474 696e 6728 7365 6c66 2c20  ormatting(self, 
-0003dde0: 636f 6e64 5f72 616e 6765 2c20 7061 7261  cond_range, para
-0003ddf0: 6d73 293a 0a20 2020 2020 2020 2023 2057  ms):.        # W
-0003de00: 7269 7465 2074 6865 203c 636f 6e64 6974  rite the <condit
-0003de10: 696f 6e61 6c46 6f72 6d61 7474 696e 673e  ionalFormatting>
-0003de20: 2065 6c65 6d65 6e74 2e0a 2020 2020 2020   element..      
-0003de30: 2020 6174 7472 6962 7574 6573 203d 205b    attributes = [
-0003de40: 2827 7371 7265 6627 2c20 636f 6e64 5f72  ('sqref', cond_r
-0003de50: 616e 6765 295d 0a20 2020 2020 2020 2073  ange)].        s
-0003de60: 656c 662e 5f78 6d6c 5f73 7461 7274 5f74  elf._xml_start_t
-0003de70: 6167 2827 636f 6e64 6974 696f 6e61 6c46  ag('conditionalF
-0003de80: 6f72 6d61 7474 696e 6727 2c20 6174 7472  ormatting', attr
-0003de90: 6962 7574 6573 290a 2020 2020 2020 2020  ibutes).        
-0003dea0: 666f 7220 7061 7261 6d20 696e 2070 6172  for param in par
-0003deb0: 616d 733a 0a20 2020 2020 2020 2020 2020  ams:.           
-0003dec0: 2023 2057 7269 7465 2074 6865 2063 6652   # Write the cfR
-0003ded0: 756c 6520 656c 656d 656e 742e 0a20 2020  ule element..   
-0003dee0: 2020 2020 2020 2020 2073 656c 662e 5f77           self._w
-0003def0: 7269 7465 5f63 665f 7275 6c65 2870 6172  rite_cf_rule(par
-0003df00: 616d 290a 2020 2020 2020 2020 7365 6c66  am).        self
-0003df10: 2e5f 786d 6c5f 656e 645f 7461 6728 2763  ._xml_end_tag('c
-0003df20: 6f6e 6469 7469 6f6e 616c 466f 726d 6174  onditionalFormat
-0003df30: 7469 6e67 2729 0a0a 2020 2020 6465 6620  ting')..    def 
-0003df40: 5f77 7269 7465 5f63 665f 7275 6c65 2873  _write_cf_rule(s
-0003df50: 656c 662c 2070 6172 616d 7329 3a0a 2020  elf, params):.  
-0003df60: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
-0003df70: 6520 3c63 6652 756c 653e 2065 6c65 6d65  e <cfRule> eleme
-0003df80: 6e74 2e0a 2020 2020 2020 2020 6174 7472  nt..        attr
-0003df90: 6962 7574 6573 203d 205b 2827 7479 7065  ibutes = [('type
-0003dfa0: 272c 2070 6172 616d 735b 2774 7970 6527  ', params['type'
-0003dfb0: 5d29 5d0a 0a20 2020 2020 2020 2069 6620  ])]..        if 
-0003dfc0: 2766 6f72 6d61 7427 2069 6e20 7061 7261  'format' in para
-0003dfd0: 6d73 2061 6e64 2070 6172 616d 735b 2766  ms and params['f
-0003dfe0: 6f72 6d61 7427 5d20 6973 206e 6f74 204e  ormat'] is not N
-0003dff0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0003e000: 2061 7474 7269 6275 7465 732e 6170 7065   attributes.appe
-0003e010: 6e64 2828 2764 7866 4964 272c 2070 6172  nd(('dxfId', par
-0003e020: 616d 735b 2766 6f72 6d61 7427 5d29 290a  ams['format'])).
-0003e030: 0a20 2020 2020 2020 2061 7474 7269 6275  .        attribu
-0003e040: 7465 732e 6170 7065 6e64 2828 2770 7269  tes.append(('pri
-0003e050: 6f72 6974 7927 2c20 7061 7261 6d73 5b27  ority', params['
-0003e060: 7072 696f 7269 7479 275d 2929 0a0a 2020  priority']))..  
-0003e070: 2020 2020 2020 6966 2070 6172 616d 732e        if params.
-0003e080: 6765 7428 2773 746f 705f 6966 5f74 7275  get('stop_if_tru
-0003e090: 6527 293a 0a20 2020 2020 2020 2020 2020  e'):.           
-0003e0a0: 2061 7474 7269 6275 7465 732e 6170 7065   attributes.appe
-0003e0b0: 6e64 2828 2773 746f 7049 6654 7275 6527  nd(('stopIfTrue'
-0003e0c0: 2c20 3129 290a 0a20 2020 2020 2020 2069  , 1))..        i
-0003e0d0: 6620 7061 7261 6d73 5b27 7479 7065 275d  f params['type']
-0003e0e0: 203d 3d20 2763 656c 6c49 7327 3a0a 2020   == 'cellIs':.  
-0003e0f0: 2020 2020 2020 2020 2020 6174 7472 6962            attrib
-0003e100: 7574 6573 2e61 7070 656e 6428 2827 6f70  utes.append(('op
-0003e110: 6572 6174 6f72 272c 2070 6172 616d 735b  erator', params[
-0003e120: 2763 7269 7465 7269 6127 5d29 290a 0a20  'criteria'])).. 
-0003e130: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0003e140: 5f78 6d6c 5f73 7461 7274 5f74 6167 2827  _xml_start_tag('
-0003e150: 6366 5275 6c65 272c 2061 7474 7269 6275  cfRule', attribu
-0003e160: 7465 7329 0a0a 2020 2020 2020 2020 2020  tes)..          
-0003e170: 2020 6966 2027 6d69 6e69 6d75 6d27 2069    if 'minimum' i
-0003e180: 6e20 7061 7261 6d73 2061 6e64 2027 6d61  n params and 'ma
-0003e190: 7869 6d75 6d27 2069 6e20 7061 7261 6d73  ximum' in params
-0003e1a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0003e1b0: 2020 7365 6c66 2e5f 7772 6974 655f 666f    self._write_fo
-0003e1c0: 726d 756c 615f 656c 656d 656e 7428 7061  rmula_element(pa
-0003e1d0: 7261 6d73 5b27 6d69 6e69 6d75 6d27 5d29  rams['minimum'])
-0003e1e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003e1f0: 2073 656c 662e 5f77 7269 7465 5f66 6f72   self._write_for
-0003e200: 6d75 6c61 5f65 6c65 6d65 6e74 2870 6172  mula_element(par
-0003e210: 616d 735b 276d 6178 696d 756d 275d 290a  ams['maximum']).
-0003e220: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0003e230: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0003e240: 2020 7365 6c66 2e5f 7772 6974 655f 666f    self._write_fo
-0003e250: 726d 756c 615f 656c 656d 656e 7428 7061  rmula_element(pa
-0003e260: 7261 6d73 5b27 7661 6c75 6527 5d29 0a0a  rams['value'])..
-0003e270: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003e280: 2e5f 786d 6c5f 656e 645f 7461 6728 2763  ._xml_end_tag('c
-0003e290: 6652 756c 6527 290a 0a20 2020 2020 2020  fRule')..       
-0003e2a0: 2065 6c69 6620 7061 7261 6d73 5b27 7479   elif params['ty
-0003e2b0: 7065 275d 203d 3d20 2761 626f 7665 4176  pe'] == 'aboveAv
-0003e2c0: 6572 6167 6527 3a0a 2020 2020 2020 2020  erage':.        
-0003e2d0: 2020 2020 6966 2072 652e 7365 6172 6368      if re.search
-0003e2e0: 2827 6265 6c6f 7727 2c20 7061 7261 6d73  ('below', params
-0003e2f0: 5b27 6372 6974 6572 6961 275d 293a 0a20  ['criteria']):. 
-0003e300: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0003e310: 7474 7269 6275 7465 732e 6170 7065 6e64  ttributes.append
-0003e320: 2828 2761 626f 7665 4176 6572 6167 6527  (('aboveAverage'
-0003e330: 2c20 3029 290a 0a20 2020 2020 2020 2020  , 0))..         
-0003e340: 2020 2069 6620 7265 2e73 6561 7263 6828     if re.search(
-0003e350: 2765 7175 616c 272c 2070 6172 616d 735b  'equal', params[
-0003e360: 2763 7269 7465 7269 6127 5d29 3a0a 2020  'criteria']):.  
-0003e370: 2020 2020 2020 2020 2020 2020 2020 6174                at
-0003e380: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
-0003e390: 2827 6571 7561 6c41 7665 7261 6765 272c  ('equalAverage',
-0003e3a0: 2031 2929 0a0a 2020 2020 2020 2020 2020   1))..          
-0003e3b0: 2020 6966 2072 652e 7365 6172 6368 2827    if re.search('
-0003e3c0: 5b31 3233 5d20 7374 6420 6465 7627 2c20  [123] std dev', 
-0003e3d0: 7061 7261 6d73 5b27 6372 6974 6572 6961  params['criteria
-0003e3e0: 275d 293a 0a20 2020 2020 2020 2020 2020  ']):.           
-0003e3f0: 2020 2020 206d 6174 6368 203d 2072 652e       match = re.
-0003e400: 7365 6172 6368 2827 285b 3132 335d 2920  search('([123]) 
-0003e410: 7374 6420 6465 7627 2c20 7061 7261 6d73  std dev', params
-0003e420: 5b27 6372 6974 6572 6961 275d 290a 2020  ['criteria']).  
-0003e430: 2020 2020 2020 2020 2020 2020 2020 6174                at
-0003e440: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
-0003e450: 2827 7374 6444 6576 272c 206d 6174 6368  ('stdDev', match
-0003e460: 2e67 726f 7570 2831 2929 290a 0a20 2020  .group(1)))..   
-0003e470: 2020 2020 2020 2020 2073 656c 662e 5f78           self._x
-0003e480: 6d6c 5f65 6d70 7479 5f74 6167 2827 6366  ml_empty_tag('cf
-0003e490: 5275 6c65 272c 2061 7474 7269 6275 7465  Rule', attribute
-0003e4a0: 7329 0a0a 2020 2020 2020 2020 656c 6966  s)..        elif
-0003e4b0: 2070 6172 616d 735b 2774 7970 6527 5d20   params['type'] 
-0003e4c0: 3d3d 2027 746f 7031 3027 3a0a 2020 2020  == 'top10':.    
-0003e4d0: 2020 2020 2020 2020 6966 2027 6372 6974          if 'crit
-0003e4e0: 6572 6961 2720 696e 2070 6172 616d 7320  eria' in params 
-0003e4f0: 616e 6420 7061 7261 6d73 5b27 6372 6974  and params['crit
-0003e500: 6572 6961 275d 203d 3d20 2725 273a 0a20  eria'] == '%':. 
-0003e510: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0003e520: 7474 7269 6275 7465 732e 6170 7065 6e64  ttributes.append
-0003e530: 2828 2770 6572 6365 6e74 272c 2031 2929  (('percent', 1))
-0003e540: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0003e550: 2027 6469 7265 6374 696f 6e27 2069 6e20   'direction' in 
-0003e560: 7061 7261 6d73 3a0a 2020 2020 2020 2020  params:.        
-0003e570: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
-0003e580: 6573 2e61 7070 656e 6428 2827 626f 7474  es.append(('bott
-0003e590: 6f6d 272c 2031 2929 0a0a 2020 2020 2020  om', 1))..      
-0003e5a0: 2020 2020 2020 7261 6e6b 203d 2070 6172        rank = par
-0003e5b0: 616d 735b 2776 616c 7565 275d 206f 7220  ams['value'] or 
-0003e5c0: 3130 0a20 2020 2020 2020 2020 2020 2061  10.            a
-0003e5d0: 7474 7269 6275 7465 732e 6170 7065 6e64  ttributes.append
-0003e5e0: 2828 2772 616e 6b27 2c20 7261 6e6b 2929  (('rank', rank))
-0003e5f0: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-0003e600: 6c66 2e5f 786d 6c5f 656d 7074 795f 7461  lf._xml_empty_ta
-0003e610: 6728 2763 6652 756c 6527 2c20 6174 7472  g('cfRule', attr
-0003e620: 6962 7574 6573 290a 0a20 2020 2020 2020  ibutes)..       
-0003e630: 2065 6c69 6620 7061 7261 6d73 5b27 7479   elif params['ty
-0003e640: 7065 275d 203d 3d20 2764 7570 6c69 6361  pe'] == 'duplica
-0003e650: 7465 5661 6c75 6573 273a 0a20 2020 2020  teValues':.     
-0003e660: 2020 2020 2020 2073 656c 662e 5f78 6d6c         self._xml
-0003e670: 5f65 6d70 7479 5f74 6167 2827 6366 5275  _empty_tag('cfRu
-0003e680: 6c65 272c 2061 7474 7269 6275 7465 7329  le', attributes)
-0003e690: 0a0a 2020 2020 2020 2020 656c 6966 2070  ..        elif p
-0003e6a0: 6172 616d 735b 2774 7970 6527 5d20 3d3d  arams['type'] ==
-0003e6b0: 2027 756e 6971 7565 5661 6c75 6573 273a   'uniqueValues':
-0003e6c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0003e6d0: 662e 5f78 6d6c 5f65 6d70 7479 5f74 6167  f._xml_empty_tag
-0003e6e0: 2827 6366 5275 6c65 272c 2061 7474 7269  ('cfRule', attri
-0003e6f0: 6275 7465 7329 0a0a 2020 2020 2020 2020  butes)..        
-0003e700: 656c 6966 2028 7061 7261 6d73 5b27 7479  elif (params['ty
-0003e710: 7065 275d 203d 3d20 2763 6f6e 7461 696e  pe'] == 'contain
-0003e720: 7354 6578 7427 0a20 2020 2020 2020 2020  sText'.         
-0003e730: 2020 2020 206f 7220 7061 7261 6d73 5b27       or params['
-0003e740: 7479 7065 275d 203d 3d20 276e 6f74 436f  type'] == 'notCo
-0003e750: 6e74 6169 6e73 5465 7874 270a 2020 2020  ntainsText'.    
-0003e760: 2020 2020 2020 2020 2020 6f72 2070 6172            or par
-0003e770: 616d 735b 2774 7970 6527 5d20 3d3d 2027  ams['type'] == '
-0003e780: 6265 6769 6e73 5769 7468 270a 2020 2020  beginsWith'.    
-0003e790: 2020 2020 2020 2020 2020 6f72 2070 6172            or par
-0003e7a0: 616d 735b 2774 7970 6527 5d20 3d3d 2027  ams['type'] == '
-0003e7b0: 656e 6473 5769 7468 2729 3a0a 2020 2020  endsWith'):.    
-0003e7c0: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
-0003e7d0: 6573 2e61 7070 656e 6428 2827 6f70 6572  es.append(('oper
-0003e7e0: 6174 6f72 272c 2070 6172 616d 735b 2763  ator', params['c
-0003e7f0: 7269 7465 7269 6127 5d29 290a 2020 2020  riteria'])).    
-0003e800: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
-0003e810: 6573 2e61 7070 656e 6428 2827 7465 7874  es.append(('text
-0003e820: 272c 2070 6172 616d 735b 2776 616c 7565  ', params['value
-0003e830: 275d 2929 0a20 2020 2020 2020 2020 2020  '])).           
-0003e840: 2073 656c 662e 5f78 6d6c 5f73 7461 7274   self._xml_start
-0003e850: 5f74 6167 2827 6366 5275 6c65 272c 2061  _tag('cfRule', a
-0003e860: 7474 7269 6275 7465 7329 0a20 2020 2020  ttributes).     
-0003e870: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
-0003e880: 7465 5f66 6f72 6d75 6c61 5f65 6c65 6d65  te_formula_eleme
-0003e890: 6e74 2870 6172 616d 735b 2766 6f72 6d75  nt(params['formu
-0003e8a0: 6c61 275d 290a 2020 2020 2020 2020 2020  la']).          
-0003e8b0: 2020 7365 6c66 2e5f 786d 6c5f 656e 645f    self._xml_end_
-0003e8c0: 7461 6728 2763 6652 756c 6527 290a 0a20  tag('cfRule').. 
-0003e8d0: 2020 2020 2020 2065 6c69 6620 7061 7261         elif para
-0003e8e0: 6d73 5b27 7479 7065 275d 203d 3d20 2774  ms['type'] == 't
-0003e8f0: 696d 6550 6572 696f 6427 3a0a 2020 2020  imePeriod':.    
-0003e900: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
-0003e910: 6573 2e61 7070 656e 6428 2827 7469 6d65  es.append(('time
-0003e920: 5065 7269 6f64 272c 2070 6172 616d 735b  Period', params[
-0003e930: 2763 7269 7465 7269 6127 5d29 290a 2020  'criteria'])).  
-0003e940: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0003e950: 786d 6c5f 7374 6172 745f 7461 6728 2763  xml_start_tag('c
-0003e960: 6652 756c 6527 2c20 6174 7472 6962 7574  fRule', attribut
-0003e970: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
-0003e980: 7365 6c66 2e5f 7772 6974 655f 666f 726d  self._write_form
-0003e990: 756c 615f 656c 656d 656e 7428 7061 7261  ula_element(para
-0003e9a0: 6d73 5b27 666f 726d 756c 6127 5d29 0a20  ms['formula']). 
-0003e9b0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0003e9c0: 5f78 6d6c 5f65 6e64 5f74 6167 2827 6366  _xml_end_tag('cf
-0003e9d0: 5275 6c65 2729 0a0a 2020 2020 2020 2020  Rule')..        
-0003e9e0: 656c 6966 2028 7061 7261 6d73 5b27 7479  elif (params['ty
-0003e9f0: 7065 275d 203d 3d20 2763 6f6e 7461 696e  pe'] == 'contain
-0003ea00: 7342 6c61 6e6b 7327 0a20 2020 2020 2020  sBlanks'.       
-0003ea10: 2020 2020 2020 206f 7220 7061 7261 6d73         or params
-0003ea20: 5b27 7479 7065 275d 203d 3d20 276e 6f74  ['type'] == 'not
-0003ea30: 436f 6e74 6169 6e73 426c 616e 6b73 270a  ContainsBlanks'.
-0003ea40: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-0003ea50: 2070 6172 616d 735b 2774 7970 6527 5d20   params['type'] 
-0003ea60: 3d3d 2027 636f 6e74 6169 6e73 4572 726f  == 'containsErro
-0003ea70: 7273 270a 2020 2020 2020 2020 2020 2020  rs'.            
-0003ea80: 2020 6f72 2070 6172 616d 735b 2774 7970    or params['typ
-0003ea90: 6527 5d20 3d3d 2027 6e6f 7443 6f6e 7461  e'] == 'notConta
-0003eaa0: 696e 7345 7272 6f72 7327 293a 0a20 2020  insErrors'):.   
-0003eab0: 2020 2020 2020 2020 2073 656c 662e 5f78           self._x
-0003eac0: 6d6c 5f73 7461 7274 5f74 6167 2827 6366  ml_start_tag('cf
-0003ead0: 5275 6c65 272c 2061 7474 7269 6275 7465  Rule', attribute
-0003eae0: 7329 0a20 2020 2020 2020 2020 2020 2073  s).            s
-0003eaf0: 656c 662e 5f77 7269 7465 5f66 6f72 6d75  elf._write_formu
-0003eb00: 6c61 5f65 6c65 6d65 6e74 2870 6172 616d  la_element(param
-0003eb10: 735b 2766 6f72 6d75 6c61 275d 290a 2020  s['formula']).  
-0003eb20: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0003eb30: 786d 6c5f 656e 645f 7461 6728 2763 6652  xml_end_tag('cfR
-0003eb40: 756c 6527 290a 0a20 2020 2020 2020 2065  ule')..        e
-0003eb50: 6c69 6620 7061 7261 6d73 5b27 7479 7065  lif params['type
-0003eb60: 275d 203d 3d20 2763 6f6c 6f72 5363 616c  '] == 'colorScal
-0003eb70: 6527 3a0a 2020 2020 2020 2020 2020 2020  e':.            
-0003eb80: 7365 6c66 2e5f 786d 6c5f 7374 6172 745f  self._xml_start_
-0003eb90: 7461 6728 2763 6652 756c 6527 2c20 6174  tag('cfRule', at
-0003eba0: 7472 6962 7574 6573 290a 2020 2020 2020  tributes).      
-0003ebb0: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
-0003ebc0: 655f 636f 6c6f 725f 7363 616c 6528 7061  e_color_scale(pa
-0003ebd0: 7261 6d73 290a 2020 2020 2020 2020 2020  rams).          
-0003ebe0: 2020 7365 6c66 2e5f 786d 6c5f 656e 645f    self._xml_end_
-0003ebf0: 7461 6728 2763 6652 756c 6527 290a 0a20  tag('cfRule').. 
-0003ec00: 2020 2020 2020 2065 6c69 6620 7061 7261         elif para
-0003ec10: 6d73 5b27 7479 7065 275d 203d 3d20 2764  ms['type'] == 'd
-0003ec20: 6174 6142 6172 273a 0a20 2020 2020 2020  ataBar':.       
-0003ec30: 2020 2020 2073 656c 662e 5f78 6d6c 5f73       self._xml_s
-0003ec40: 7461 7274 5f74 6167 2827 6366 5275 6c65  tart_tag('cfRule
-0003ec50: 272c 2061 7474 7269 6275 7465 7329 0a20  ', attributes). 
-0003ec60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0003ec70: 5f77 7269 7465 5f64 6174 615f 6261 7228  _write_data_bar(
-0003ec80: 7061 7261 6d73 290a 0a20 2020 2020 2020  params)..       
-0003ec90: 2020 2020 2069 6620 7061 7261 6d73 2e67       if params.g
-0003eca0: 6574 2827 6973 5f64 6174 615f 6261 725f  et('is_data_bar_
-0003ecb0: 3230 3130 2729 3a0a 2020 2020 2020 2020  2010'):.        
-0003ecc0: 2020 2020 2020 2020 7365 6c66 2e5f 7772          self._wr
-0003ecd0: 6974 655f 6461 7461 5f62 6172 5f65 7874  ite_data_bar_ext
-0003ece0: 2870 6172 616d 7329 0a0a 2020 2020 2020  (params)..      
-0003ecf0: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
-0003ed00: 656e 645f 7461 6728 2763 6652 756c 6527  end_tag('cfRule'
-0003ed10: 290a 0a20 2020 2020 2020 2065 6c69 6620  )..        elif 
-0003ed20: 7061 7261 6d73 5b27 7479 7065 275d 203d  params['type'] =
-0003ed30: 3d20 2765 7870 7265 7373 696f 6e27 3a0a  = 'expression':.
-0003ed40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003ed50: 2e5f 786d 6c5f 7374 6172 745f 7461 6728  ._xml_start_tag(
-0003ed60: 2763 6652 756c 6527 2c20 6174 7472 6962  'cfRule', attrib
-0003ed70: 7574 6573 290a 2020 2020 2020 2020 2020  utes).          
-0003ed80: 2020 7365 6c66 2e5f 7772 6974 655f 666f    self._write_fo
-0003ed90: 726d 756c 615f 656c 656d 656e 7428 7061  rmula_element(pa
-0003eda0: 7261 6d73 5b27 6372 6974 6572 6961 275d  rams['criteria']
-0003edb0: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0003edc0: 6c66 2e5f 786d 6c5f 656e 645f 7461 6728  lf._xml_end_tag(
-0003edd0: 2763 6652 756c 6527 290a 0a20 2020 2020  'cfRule')..     
-0003ede0: 2020 2065 6c69 6620 7061 7261 6d73 5b27     elif params['
-0003edf0: 7479 7065 275d 203d 3d20 2769 636f 6e53  type'] == 'iconS
-0003ee00: 6574 273a 0a20 2020 2020 2020 2020 2020  et':.           
-0003ee10: 2073 656c 662e 5f78 6d6c 5f73 7461 7274   self._xml_start
-0003ee20: 5f74 6167 2827 6366 5275 6c65 272c 2061  _tag('cfRule', a
-0003ee30: 7474 7269 6275 7465 7329 0a20 2020 2020  ttributes).     
-0003ee40: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
-0003ee50: 7465 5f69 636f 6e5f 7365 7428 7061 7261  te_icon_set(para
-0003ee60: 6d73 290a 2020 2020 2020 2020 2020 2020  ms).            
-0003ee70: 7365 6c66 2e5f 786d 6c5f 656e 645f 7461  self._xml_end_ta
-0003ee80: 6728 2763 6652 756c 6527 290a 0a20 2020  g('cfRule')..   
-0003ee90: 2064 6566 205f 7772 6974 655f 666f 726d   def _write_form
-0003eea0: 756c 615f 656c 656d 656e 7428 7365 6c66  ula_element(self
-0003eeb0: 2c20 666f 726d 756c 6129 3a0a 2020 2020  , formula):.    
-0003eec0: 2020 2020 2320 5772 6974 6520 7468 6520      # Write the 
-0003eed0: 3c66 6f72 6d75 6c61 3e20 656c 656d 656e  <formula> elemen
-0003eee0: 742e 0a0a 2020 2020 2020 2020 2320 4368  t...        # Ch
-0003eef0: 6563 6b20 6966 2074 6865 2066 6f72 6d75  eck if the formu
-0003ef00: 6c61 2069 7320 6120 6e75 6d62 6572 2e0a  la is a number..
-0003ef10: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-0003ef20: 2020 2020 2020 2020 2066 6c6f 6174 2866           float(f
-0003ef30: 6f72 6d75 6c61 290a 2020 2020 2020 2020  ormula).        
-0003ef40: 6578 6365 7074 2056 616c 7565 4572 726f  except ValueErro
-0003ef50: 723a 0a20 2020 2020 2020 2020 2020 2023  r:.            #
-0003ef60: 204e 6f74 2061 206e 756d 6265 722e 2052   Not a number. R
-0003ef70: 656d 6f76 6520 7468 6520 666f 726d 756c  emove the formul
-0003ef80: 6120 273d 2720 7369 676e 2069 6620 6974  a '=' sign if it
-0003ef90: 2065 7869 7374 732e 0a20 2020 2020 2020   exists..       
-0003efa0: 2020 2020 2069 6620 666f 726d 756c 612e       if formula.
-0003efb0: 7374 6172 7473 7769 7468 2827 3d27 293a  startswith('='):
-0003efc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003efd0: 2066 6f72 6d75 6c61 203d 2066 6f72 6d75   formula = formu
-0003efe0: 6c61 2e6c 7374 7269 7028 273d 2729 0a0a  la.lstrip('=')..
-0003eff0: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
-0003f000: 6c5f 6461 7461 5f65 6c65 6d65 6e74 2827  l_data_element('
-0003f010: 666f 726d 756c 6127 2c20 666f 726d 756c  formula', formul
-0003f020: 6129 0a0a 2020 2020 6465 6620 5f77 7269  a)..    def _wri
-0003f030: 7465 5f63 6f6c 6f72 5f73 6361 6c65 2873  te_color_scale(s
-0003f040: 656c 662c 2070 6172 616d 293a 0a20 2020  elf, param):.   
-0003f050: 2020 2020 2023 2057 7269 7465 2074 6865       # Write the
-0003f060: 203c 636f 6c6f 7253 6361 6c65 3e20 656c   <colorScale> el
-0003f070: 656d 656e 742e 0a0a 2020 2020 2020 2020  ement...        
-0003f080: 7365 6c66 2e5f 786d 6c5f 7374 6172 745f  self._xml_start_
-0003f090: 7461 6728 2763 6f6c 6f72 5363 616c 6527  tag('colorScale'
-0003f0a0: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-0003f0b0: 5f77 7269 7465 5f63 6676 6f28 7061 7261  _write_cfvo(para
-0003f0c0: 6d5b 276d 696e 5f74 7970 6527 5d2c 2070  m['min_type'], p
-0003f0d0: 6172 616d 5b27 6d69 6e5f 7661 6c75 6527  aram['min_value'
-0003f0e0: 5d29 0a0a 2020 2020 2020 2020 6966 2070  ])..        if p
-0003f0f0: 6172 616d 5b27 6d69 645f 7479 7065 275d  aram['mid_type']
-0003f100: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0003f110: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-0003f120: 7772 6974 655f 6366 766f 2870 6172 616d  write_cfvo(param
-0003f130: 5b27 6d69 645f 7479 7065 275d 2c20 7061  ['mid_type'], pa
-0003f140: 7261 6d5b 276d 6964 5f76 616c 7565 275d  ram['mid_value']
-0003f150: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-0003f160: 5f77 7269 7465 5f63 6676 6f28 7061 7261  _write_cfvo(para
-0003f170: 6d5b 276d 6178 5f74 7970 6527 5d2c 2070  m['max_type'], p
-0003f180: 6172 616d 5b27 6d61 785f 7661 6c75 6527  aram['max_value'
-0003f190: 5d29 0a0a 2020 2020 2020 2020 7365 6c66  ])..        self
-0003f1a0: 2e5f 7772 6974 655f 636f 6c6f 7228 2772  ._write_color('r
-0003f1b0: 6762 272c 2070 6172 616d 5b27 6d69 6e5f  gb', param['min_
-0003f1c0: 636f 6c6f 7227 5d29 0a0a 2020 2020 2020  color'])..      
-0003f1d0: 2020 6966 2070 6172 616d 5b27 6d69 645f    if param['mid_
-0003f1e0: 636f 6c6f 7227 5d20 6973 206e 6f74 204e  color'] is not N
-0003f1f0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0003f200: 2073 656c 662e 5f77 7269 7465 5f63 6f6c   self._write_col
-0003f210: 6f72 2827 7267 6227 2c20 7061 7261 6d5b  or('rgb', param[
-0003f220: 276d 6964 5f63 6f6c 6f72 275d 290a 0a20  'mid_color']).. 
-0003f230: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
-0003f240: 7465 5f63 6f6c 6f72 2827 7267 6227 2c20  te_color('rgb', 
-0003f250: 7061 7261 6d5b 276d 6178 5f63 6f6c 6f72  param['max_color
-0003f260: 275d 290a 0a20 2020 2020 2020 2073 656c  '])..        sel
-0003f270: 662e 5f78 6d6c 5f65 6e64 5f74 6167 2827  f._xml_end_tag('
-0003f280: 636f 6c6f 7253 6361 6c65 2729 0a0a 2020  colorScale')..  
-0003f290: 2020 6465 6620 5f77 7269 7465 5f64 6174    def _write_dat
-0003f2a0: 615f 6261 7228 7365 6c66 2c20 7061 7261  a_bar(self, para
-0003f2b0: 6d29 3a0a 2020 2020 2020 2020 2320 5772  m):.        # Wr
-0003f2c0: 6974 6520 7468 6520 3c64 6174 6142 6172  ite the <dataBar
-0003f2d0: 3e20 656c 656d 656e 742e 0a20 2020 2020  > element..     
-0003f2e0: 2020 2061 7474 7269 6275 7465 7320 3d20     attributes = 
-0003f2f0: 5b5d 0a0a 2020 2020 2020 2020 2320 4d69  []..        # Mi
-0003f300: 6e20 616e 6420 6d61 7820 6261 7220 6c65  n and max bar le
-0003f310: 6e67 7468 7320 696e 2069 6e20 7468 6520  ngths in in the 
-0003f320: 7370 6563 2062 7574 206e 6f74 2073 7570  spec but not sup
-0003f330: 706f 7274 6564 2064 6972 6563 746c 7920  ported directly 
-0003f340: 6279 0a20 2020 2020 2020 2023 2045 7863  by.        # Exc
-0003f350: 656c 2e0a 2020 2020 2020 2020 6966 2070  el..        if p
-0003f360: 6172 616d 2e67 6574 2827 6d69 6e5f 6c65  aram.get('min_le
-0003f370: 6e67 7468 2729 3a0a 2020 2020 2020 2020  ngth'):.        
-0003f380: 2020 2020 6174 7472 6962 7574 6573 2e61      attributes.a
-0003f390: 7070 656e 6428 2827 6d69 6e4c 656e 6774  ppend(('minLengt
-0003f3a0: 6827 2c20 7061 7261 6d5b 276d 696e 5f6c  h', param['min_l
-0003f3b0: 656e 6774 6827 5d29 290a 0a20 2020 2020  ength']))..     
-0003f3c0: 2020 2069 6620 7061 7261 6d2e 6765 7428     if param.get(
-0003f3d0: 276d 6178 5f6c 656e 6774 6827 293a 0a20  'max_length'):. 
-0003f3e0: 2020 2020 2020 2020 2020 2061 7474 7269             attri
-0003f3f0: 6275 7465 732e 6170 7065 6e64 2828 276d  butes.append(('m
-0003f400: 6178 4c65 6e67 7468 272c 2070 6172 616d  axLength', param
-0003f410: 5b27 6d61 785f 6c65 6e67 7468 275d 2929  ['max_length']))
-0003f420: 0a0a 2020 2020 2020 2020 6966 2070 6172  ..        if par
-0003f430: 616d 2e67 6574 2827 6261 725f 6f6e 6c79  am.get('bar_only
-0003f440: 2729 3a0a 2020 2020 2020 2020 2020 2020  '):.            
-0003f450: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
-0003f460: 6428 2827 7368 6f77 5661 6c75 6527 2c20  d(('showValue', 
-0003f470: 3029 290a 0a20 2020 2020 2020 2073 656c  0))..        sel
-0003f480: 662e 5f78 6d6c 5f73 7461 7274 5f74 6167  f._xml_start_tag
-0003f490: 2827 6461 7461 4261 7227 2c20 6174 7472  ('dataBar', attr
-0003f4a0: 6962 7574 6573 290a 0a20 2020 2020 2020  ibutes)..       
-0003f4b0: 2073 656c 662e 5f77 7269 7465 5f63 6676   self._write_cfv
-0003f4c0: 6f28 7061 7261 6d5b 276d 696e 5f74 7970  o(param['min_typ
-0003f4d0: 6527 5d2c 2070 6172 616d 5b27 6d69 6e5f  e'], param['min_
-0003f4e0: 7661 6c75 6527 5d29 0a20 2020 2020 2020  value']).       
-0003f4f0: 2073 656c 662e 5f77 7269 7465 5f63 6676   self._write_cfv
-0003f500: 6f28 7061 7261 6d5b 276d 6178 5f74 7970  o(param['max_typ
-0003f510: 6527 5d2c 2070 6172 616d 5b27 6d61 785f  e'], param['max_
-0003f520: 7661 6c75 6527 5d29 0a20 2020 2020 2020  value']).       
-0003f530: 2073 656c 662e 5f77 7269 7465 5f63 6f6c   self._write_col
-0003f540: 6f72 2827 7267 6227 2c20 7061 7261 6d5b  or('rgb', param[
-0003f550: 2762 6172 5f63 6f6c 6f72 275d 290a 0a20  'bar_color']).. 
-0003f560: 2020 2020 2020 2073 656c 662e 5f78 6d6c         self._xml
-0003f570: 5f65 6e64 5f74 6167 2827 6461 7461 4261  _end_tag('dataBa
-0003f580: 7227 290a 0a20 2020 2064 6566 205f 7772  r')..    def _wr
-0003f590: 6974 655f 6461 7461 5f62 6172 5f65 7874  ite_data_bar_ext
-0003f5a0: 2873 656c 662c 2070 6172 616d 293a 0a20  (self, param):. 
-0003f5b0: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
-0003f5c0: 6865 203c 6578 744c 7374 3e20 6461 7461  he <extLst> data
-0003f5d0: 4261 7220 6578 7465 6e73 696f 6e20 656c  Bar extension el
-0003f5e0: 656d 656e 742e 0a0a 2020 2020 2020 2020  ement...        
-0003f5f0: 2320 4372 6561 7465 2061 2070 7365 7564  # Create a pseud
-0003f600: 6f20 4755 4944 2066 6f72 2065 6163 6820  o GUID for each 
-0003f610: 756e 6971 7565 2045 7863 656c 2032 3031  unique Excel 201
-0003f620: 3020 6461 7461 2062 6172 2e0a 2020 2020  0 data bar..    
-0003f630: 2020 2020 776f 726b 7368 6565 745f 636f      worksheet_co
-0003f640: 756e 7420 3d20 7365 6c66 2e69 6e64 6578  unt = self.index
-0003f650: 202b 2031 0a20 2020 2020 2020 2064 6174   + 1.        dat
-0003f660: 615f 6261 725f 636f 756e 7420 3d20 6c65  a_bar_count = le
-0003f670: 6e28 7365 6c66 2e64 6174 615f 6261 7273  n(self.data_bars
-0003f680: 5f32 3031 3029 202b 2031 0a20 2020 2020  _2010) + 1.     
-0003f690: 2020 2067 7569 6420 3d20 227b 4441 3741     guid = "{DA7A
-0003f6a0: 4241 3531 2d41 4141 412d 4242 4242 2d25  BA51-AAAA-BBBB-%
-0003f6b0: 3034 582d 2530 3132 587d 2220 2520 2877  04X-%012X}" % (w
-0003f6c0: 6f72 6b73 6865 6574 5f63 6f75 6e74 2c0a  orksheet_count,.
-0003f6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f700: 2020 2020 6461 7461 5f62 6172 5f63 6f75      data_bar_cou
-0003f710: 6e74 290a 0a20 2020 2020 2020 2023 2053  nt)..        # S
-0003f720: 746f 7265 2074 6865 2032 3031 3020 6461  tore the 2010 da
-0003f730: 7461 2062 6172 2070 6172 616d 6574 6572  ta bar parameter
-0003f740: 7320 746f 2077 7269 7465 2074 6865 2065  s to write the e
-0003f750: 7874 4c73 7420 656c 656d 656e 7473 2e0a  xtLst elements..
-0003f760: 2020 2020 2020 2020 7061 7261 6d5b 2767          param['g
-0003f770: 7569 6427 5d20 3d20 6775 6964 0a20 2020  uid'] = guid.   
-0003f780: 2020 2020 2073 656c 662e 6461 7461 5f62       self.data_b
-0003f790: 6172 735f 3230 3130 2e61 7070 656e 6428  ars_2010.append(
-0003f7a0: 7061 7261 6d29 0a0a 2020 2020 2020 2020  param)..        
-0003f7b0: 7365 6c66 2e5f 786d 6c5f 7374 6172 745f  self._xml_start_
-0003f7c0: 7461 6728 2765 7874 4c73 7427 290a 2020  tag('extLst').  
-0003f7d0: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
-0003f7e0: 655f 6578 7428 277b 4230 3235 4639 3337  e_ext('{B025F937
-0003f7f0: 2d43 3742 312d 3437 4433 2d42 3637 462d  -C7B1-47D3-B67F-
-0003f800: 4136 3245 4646 3636 3645 3345 7d27 290a  A62EFF666E3E}').
-0003f810: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
-0003f820: 6c5f 6461 7461 5f65 6c65 6d65 6e74 2827  l_data_element('
-0003f830: 7831 343a 6964 272c 2067 7569 6429 0a20  x14:id', guid). 
+0003a0c0: 2020 2020 2020 2020 2020 2020 726f 775f              row_
+0003a0d0: 6e75 6d2c 0a20 2020 2020 2020 2020 2020  num,.           
+0003a0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a0f0: 2063 6f6c 5f6e 756d 2c0a 2020 2020 2020   col_num,.      
+0003a100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a110: 2020 2020 2020 6c69 6e6b 5b22 7572 6c22        link["url"
+0003a120: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0003a130: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0003a140: 696e 6b5b 2273 7472 225d 2c0a 2020 2020  ink["str"],.    
+0003a150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a160: 2020 2020 2020 2020 6c69 6e6b 5b22 7469          link["ti
+0003a170: 7022 5d2c 0a20 2020 2020 2020 2020 2020  p"],.           
+0003a180: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+0003a190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a1a0: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
+0003a1b0: 5772 6974 6520 7468 6520 6879 7065 726c  Write the hyperl
+0003a1c0: 696e 6b20 656c 656d 656e 7473 2e0a 2020  ink elements..  
+0003a1d0: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
+0003a1e0: 7374 6172 745f 7461 6728 2268 7970 6572  start_tag("hyper
+0003a1f0: 6c69 6e6b 7322 290a 0a20 2020 2020 2020  links")..       
+0003a200: 2066 6f72 2061 7267 7320 696e 2068 6c69   for args in hli
+0003a210: 6e6b 5f72 6566 733a 0a20 2020 2020 2020  nk_refs:.       
+0003a220: 2020 2020 206c 696e 6b5f 7479 7065 203d       link_type =
+0003a230: 2061 7267 732e 706f 7028 3029 0a0a 2020   args.pop(0)..  
+0003a240: 2020 2020 2020 2020 2020 6966 206c 696e            if lin
+0003a250: 6b5f 7479 7065 203d 3d20 313a 0a20 2020  k_type == 1:.   
+0003a260: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0003a270: 662e 5f77 7269 7465 5f68 7970 6572 6c69  f._write_hyperli
+0003a280: 6e6b 5f65 7874 6572 6e61 6c28 2a61 7267  nk_external(*arg
+0003a290: 7329 0a20 2020 2020 2020 2020 2020 2065  s).            e
+0003a2a0: 6c69 6620 6c69 6e6b 5f74 7970 6520 3d3d  lif link_type ==
+0003a2b0: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
+0003a2c0: 2020 2020 7365 6c66 2e5f 7772 6974 655f      self._write_
+0003a2d0: 6879 7065 726c 696e 6b5f 696e 7465 726e  hyperlink_intern
+0003a2e0: 616c 282a 6172 6773 290a 0a20 2020 2020  al(*args)..     
+0003a2f0: 2020 2073 656c 662e 5f78 6d6c 5f65 6e64     self._xml_end
+0003a300: 5f74 6167 2822 6879 7065 726c 696e 6b73  _tag("hyperlinks
+0003a310: 2229 0a0a 2020 2020 6465 6620 5f77 7269  ")..    def _wri
+0003a320: 7465 5f68 7970 6572 6c69 6e6b 5f65 7874  te_hyperlink_ext
+0003a330: 6572 6e61 6c28 0a20 2020 2020 2020 2073  ernal(.        s
+0003a340: 656c 662c 2072 6f77 2c20 636f 6c2c 2069  elf, row, col, i
+0003a350: 645f 6e75 6d2c 206c 6f63 6174 696f 6e3d  d_num, location=
+0003a360: 4e6f 6e65 2c20 6469 7370 6c61 793d 4e6f  None, display=No
+0003a370: 6e65 2c20 746f 6f6c 7469 703d 4e6f 6e65  ne, tooltip=None
+0003a380: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+0003a390: 2320 5772 6974 6520 7468 6520 3c68 7970  # Write the <hyp
+0003a3a0: 6572 6c69 6e6b 3e20 656c 656d 656e 7420  erlink> element 
+0003a3b0: 666f 7220 6578 7465 726e 616c 206c 696e  for external lin
+0003a3c0: 6b73 2e0a 2020 2020 2020 2020 7265 6620  ks..        ref 
+0003a3d0: 3d20 786c 5f72 6f77 636f 6c5f 746f 5f63  = xl_rowcol_to_c
+0003a3e0: 656c 6c28 726f 772c 2063 6f6c 290a 2020  ell(row, col).  
+0003a3f0: 2020 2020 2020 725f 6964 203d 2022 7249        r_id = "rI
+0003a400: 6422 202b 2073 7472 2869 645f 6e75 6d29  d" + str(id_num)
+0003a410: 0a0a 2020 2020 2020 2020 6174 7472 6962  ..        attrib
+0003a420: 7574 6573 203d 205b 2822 7265 6622 2c20  utes = [("ref", 
+0003a430: 7265 6629 2c20 2822 723a 6964 222c 2072  ref), ("r:id", r
+0003a440: 5f69 6429 5d0a 0a20 2020 2020 2020 2069  _id)]..        i
+0003a450: 6620 6c6f 6361 7469 6f6e 2069 7320 6e6f  f location is no
+0003a460: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0003a470: 2020 2020 6174 7472 6962 7574 6573 2e61      attributes.a
+0003a480: 7070 656e 6428 2822 6c6f 6361 7469 6f6e  ppend(("location
+0003a490: 222c 206c 6f63 6174 696f 6e29 290a 2020  ", location)).  
+0003a4a0: 2020 2020 2020 6966 2064 6973 706c 6179        if display
+0003a4b0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+0003a4c0: 2020 2020 2020 2020 2020 6174 7472 6962            attrib
+0003a4d0: 7574 6573 2e61 7070 656e 6428 2822 6469  utes.append(("di
+0003a4e0: 7370 6c61 7922 2c20 6469 7370 6c61 7929  splay", display)
+0003a4f0: 290a 2020 2020 2020 2020 6966 2074 6f6f  ).        if too
+0003a500: 6c74 6970 2069 7320 6e6f 7420 4e6f 6e65  ltip is not None
+0003a510: 3a0a 2020 2020 2020 2020 2020 2020 6174  :.            at
+0003a520: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
+0003a530: 2822 746f 6f6c 7469 7022 2c20 746f 6f6c  ("tooltip", tool
+0003a540: 7469 7029 290a 0a20 2020 2020 2020 2073  tip))..        s
+0003a550: 656c 662e 5f78 6d6c 5f65 6d70 7479 5f74  elf._xml_empty_t
+0003a560: 6167 2822 6879 7065 726c 696e 6b22 2c20  ag("hyperlink", 
+0003a570: 6174 7472 6962 7574 6573 290a 0a20 2020  attributes)..   
+0003a580: 2064 6566 205f 7772 6974 655f 6879 7065   def _write_hype
+0003a590: 726c 696e 6b5f 696e 7465 726e 616c 280a  rlink_internal(.
+0003a5a0: 2020 2020 2020 2020 7365 6c66 2c20 726f          self, ro
+0003a5b0: 772c 2063 6f6c 2c20 6c6f 6361 7469 6f6e  w, col, location
+0003a5c0: 3d4e 6f6e 652c 2064 6973 706c 6179 3d4e  =None, display=N
+0003a5d0: 6f6e 652c 2074 6f6f 6c74 6970 3d4e 6f6e  one, tooltip=Non
+0003a5e0: 650a 2020 2020 293a 0a20 2020 2020 2020  e.    ):.       
+0003a5f0: 2023 2057 7269 7465 2074 6865 203c 6879   # Write the <hy
+0003a600: 7065 726c 696e 6b3e 2065 6c65 6d65 6e74  perlink> element
+0003a610: 2066 6f72 2069 6e74 6572 6e61 6c20 6c69   for internal li
+0003a620: 6e6b 732e 0a20 2020 2020 2020 2072 6566  nks..        ref
+0003a630: 203d 2078 6c5f 726f 7763 6f6c 5f74 6f5f   = xl_rowcol_to_
+0003a640: 6365 6c6c 2872 6f77 2c20 636f 6c29 0a0a  cell(row, col)..
+0003a650: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
+0003a660: 6573 203d 205b 2822 7265 6622 2c20 7265  es = [("ref", re
+0003a670: 6629 2c20 2822 6c6f 6361 7469 6f6e 222c  f), ("location",
+0003a680: 206c 6f63 6174 696f 6e29 5d0a 0a20 2020   location)]..   
+0003a690: 2020 2020 2069 6620 746f 6f6c 7469 7020       if tooltip 
+0003a6a0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0003a6b0: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+0003a6c0: 7465 732e 6170 7065 6e64 2828 2274 6f6f  tes.append(("too
+0003a6d0: 6c74 6970 222c 2074 6f6f 6c74 6970 2929  ltip", tooltip))
+0003a6e0: 0a20 2020 2020 2020 2061 7474 7269 6275  .        attribu
+0003a6f0: 7465 732e 6170 7065 6e64 2828 2264 6973  tes.append(("dis
+0003a700: 706c 6179 222c 2064 6973 706c 6179 2929  play", display))
+0003a710: 0a0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+0003a720: 786d 6c5f 656d 7074 795f 7461 6728 2268  xml_empty_tag("h
+0003a730: 7970 6572 6c69 6e6b 222c 2061 7474 7269  yperlink", attri
+0003a740: 6275 7465 7329 0a0a 2020 2020 6465 6620  butes)..    def 
+0003a750: 5f77 7269 7465 5f61 7574 6f5f 6669 6c74  _write_auto_filt
+0003a760: 6572 2873 656c 6629 3a0a 2020 2020 2020  er(self):.      
+0003a770: 2020 2320 5772 6974 6520 7468 6520 3c61    # Write the <a
+0003a780: 7574 6f46 696c 7465 723e 2065 6c65 6d65  utoFilter> eleme
+0003a790: 6e74 2e0a 2020 2020 2020 2020 6966 206e  nt..        if n
+0003a7a0: 6f74 2073 656c 662e 6175 746f 6669 6c74  ot self.autofilt
+0003a7b0: 6572 5f72 6566 3a0a 2020 2020 2020 2020  er_ref:.        
+0003a7c0: 2020 2020 7265 7475 726e 0a0a 2020 2020      return..    
+0003a7d0: 2020 2020 6174 7472 6962 7574 6573 203d      attributes =
+0003a7e0: 205b 2822 7265 6622 2c20 7365 6c66 2e61   [("ref", self.a
+0003a7f0: 7574 6f66 696c 7465 725f 7265 6629 5d0a  utofilter_ref)].
+0003a800: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+0003a810: 2e66 696c 7465 725f 6f6e 3a0a 2020 2020  .filter_on:.    
+0003a820: 2020 2020 2020 2020 2320 4175 746f 6669          # Autofi
+0003a830: 6c74 6572 2064 6566 696e 6564 2061 6374  lter defined act
+0003a840: 6976 6520 6669 6c74 6572 732e 0a20 2020  ive filters..   
+0003a850: 2020 2020 2020 2020 2073 656c 662e 5f78           self._x
+0003a860: 6d6c 5f73 7461 7274 5f74 6167 2822 6175  ml_start_tag("au
+0003a870: 746f 4669 6c74 6572 222c 2061 7474 7269  toFilter", attri
+0003a880: 6275 7465 7329 0a20 2020 2020 2020 2020  butes).         
+0003a890: 2020 2073 656c 662e 5f77 7269 7465 5f61     self._write_a
+0003a8a0: 7574 6f66 696c 7465 7273 2829 0a20 2020  utofilters().   
+0003a8b0: 2020 2020 2020 2020 2073 656c 662e 5f78           self._x
+0003a8c0: 6d6c 5f65 6e64 5f74 6167 2822 6175 746f  ml_end_tag("auto
+0003a8d0: 4669 6c74 6572 2229 0a0a 2020 2020 2020  Filter")..      
+0003a8e0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0003a8f0: 2020 2020 2320 4175 746f 6669 6c74 6572      # Autofilter
+0003a900: 2064 6566 696e 6564 2077 6974 686f 7574   defined without
+0003a910: 2061 6374 6976 6520 6669 6c74 6572 732e   active filters.
+0003a920: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0003a930: 662e 5f78 6d6c 5f65 6d70 7479 5f74 6167  f._xml_empty_tag
+0003a940: 2822 6175 746f 4669 6c74 6572 222c 2061  ("autoFilter", a
+0003a950: 7474 7269 6275 7465 7329 0a0a 2020 2020  ttributes)..    
+0003a960: 6465 6620 5f77 7269 7465 5f61 7574 6f66  def _write_autof
+0003a970: 696c 7465 7273 2873 656c 6629 3a0a 2020  ilters(self):.  
+0003a980: 2020 2020 2020 2320 4675 6e63 7469 6f6e        # Function
+0003a990: 2074 6f20 6974 6572 6174 6520 7468 726f   to iterate thro
+0003a9a0: 7567 6820 7468 6520 636f 6c75 6d6e 7320  ugh the columns 
+0003a9b0: 7468 6174 2066 6f72 6d20 7061 7274 206f  that form part o
+0003a9c0: 6620 616e 0a20 2020 2020 2020 2023 2061  f an.        # a
+0003a9d0: 7574 6f66 696c 7465 7220 7261 6e67 6520  utofilter range 
+0003a9e0: 616e 6420 7772 6974 6520 7468 6520 6170  and write the ap
+0003a9f0: 7072 6f70 7269 6174 6520 6669 6c74 6572  propriate filter
+0003aa00: 732e 0a20 2020 2020 2020 2028 636f 6c31  s..        (col1
+0003aa10: 2c20 636f 6c32 2920 3d20 7365 6c66 2e66  , col2) = self.f
+0003aa20: 696c 7465 725f 7261 6e67 650a 0a20 2020  ilter_range..   
+0003aa30: 2020 2020 2066 6f72 2063 6f6c 2069 6e20       for col in 
+0003aa40: 7261 6e67 6528 636f 6c31 2c20 636f 6c32  range(col1, col2
+0003aa50: 202b 2031 293a 0a20 2020 2020 2020 2020   + 1):.         
+0003aa60: 2020 2023 2053 6b69 7020 6966 2063 6f6c     # Skip if col
+0003aa70: 756d 6e20 646f 6573 6e27 7420 6861 7665  umn doesn't have
+0003aa80: 2061 6e20 6163 7469 7665 2066 696c 7465   an active filte
+0003aa90: 722e 0a20 2020 2020 2020 2020 2020 2069  r..            i
+0003aaa0: 6620 636f 6c20 6e6f 7420 696e 2073 656c  f col not in sel
+0003aab0: 662e 6669 6c74 6572 5f63 6f6c 733a 0a20  f.filter_cols:. 
+0003aac0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0003aad0: 6f6e 7469 6e75 650a 0a20 2020 2020 2020  ontinue..       
+0003aae0: 2020 2020 2023 2052 6574 7269 6576 6520       # Retrieve 
+0003aaf0: 7468 6520 6669 6c74 6572 2074 6f6b 656e  the filter token
+0003ab00: 7320 616e 6420 7772 6974 6520 7468 6520  s and write the 
+0003ab10: 6175 746f 6669 6c74 6572 2072 6563 6f72  autofilter recor
+0003ab20: 6473 2e0a 2020 2020 2020 2020 2020 2020  ds..            
+0003ab30: 746f 6b65 6e73 203d 2073 656c 662e 6669  tokens = self.fi
+0003ab40: 6c74 6572 5f63 6f6c 735b 636f 6c5d 0a20  lter_cols[col]. 
+0003ab50: 2020 2020 2020 2020 2020 2066 696c 7465             filte
+0003ab60: 725f 7479 7065 203d 2073 656c 662e 6669  r_type = self.fi
+0003ab70: 6c74 6572 5f74 7970 655b 636f 6c5d 0a0a  lter_type[col]..
+0003ab80: 2020 2020 2020 2020 2020 2020 2320 4669              # Fi
+0003ab90: 6c74 6572 7320 6172 6520 7265 6c61 7469  lters are relati
+0003aba0: 7665 2074 6f20 6669 7273 7420 636f 6c75  ve to first colu
+0003abb0: 6d6e 2069 6e20 7468 6520 6175 746f 6669  mn in the autofi
+0003abc0: 6c74 6572 2e0a 2020 2020 2020 2020 2020  lter..          
+0003abd0: 2020 7365 6c66 2e5f 7772 6974 655f 6669    self._write_fi
+0003abe0: 6c74 6572 5f63 6f6c 756d 6e28 636f 6c20  lter_column(col 
+0003abf0: 2d20 636f 6c31 2c20 6669 6c74 6572 5f74  - col1, filter_t
+0003ac00: 7970 652c 2074 6f6b 656e 7329 0a0a 2020  ype, tokens)..  
+0003ac10: 2020 6465 6620 5f77 7269 7465 5f66 696c    def _write_fil
+0003ac20: 7465 725f 636f 6c75 6d6e 2873 656c 662c  ter_column(self,
+0003ac30: 2063 6f6c 5f69 642c 2066 696c 7465 725f   col_id, filter_
+0003ac40: 7479 7065 2c20 6669 6c74 6572 7329 3a0a  type, filters):.
+0003ac50: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
+0003ac60: 7468 6520 3c66 696c 7465 7243 6f6c 756d  the <filterColum
+0003ac70: 6e3e 2065 6c65 6d65 6e74 2e0a 2020 2020  n> element..    
+0003ac80: 2020 2020 6174 7472 6962 7574 6573 203d      attributes =
+0003ac90: 205b 2822 636f 6c49 6422 2c20 636f 6c5f   [("colId", col_
+0003aca0: 6964 295d 0a0a 2020 2020 2020 2020 7365  id)]..        se
+0003acb0: 6c66 2e5f 786d 6c5f 7374 6172 745f 7461  lf._xml_start_ta
+0003acc0: 6728 2266 696c 7465 7243 6f6c 756d 6e22  g("filterColumn"
+0003acd0: 2c20 6174 7472 6962 7574 6573 290a 0a20  , attributes).. 
+0003ace0: 2020 2020 2020 2069 6620 6669 6c74 6572         if filter
+0003acf0: 5f74 7970 6520 3d3d 2031 3a0a 2020 2020  _type == 1:.    
+0003ad00: 2020 2020 2020 2020 2320 5479 7065 203d          # Type =
+0003ad10: 3d20 3120 6973 2074 6865 206e 6577 2058  = 1 is the new X
+0003ad20: 4c53 5820 7374 796c 6520 6669 6c74 6572  LSX style filter
+0003ad30: 2e0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+0003ad40: 6c66 2e5f 7772 6974 655f 6669 6c74 6572  lf._write_filter
+0003ad50: 7328 6669 6c74 6572 7329 0a20 2020 2020  s(filters).     
+0003ad60: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0003ad70: 2020 2020 2023 2054 7970 6520 3d3d 2030       # Type == 0
+0003ad80: 2069 7320 7468 6520 636c 6173 7369 6320   is the classic 
+0003ad90: 2263 7573 746f 6d22 2066 696c 7465 722e  "custom" filter.
+0003ada0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0003adb0: 662e 5f77 7269 7465 5f63 7573 746f 6d5f  f._write_custom_
+0003adc0: 6669 6c74 6572 7328 6669 6c74 6572 7329  filters(filters)
+0003add0: 0a0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+0003ade0: 786d 6c5f 656e 645f 7461 6728 2266 696c  xml_end_tag("fil
+0003adf0: 7465 7243 6f6c 756d 6e22 290a 0a20 2020  terColumn")..   
+0003ae00: 2064 6566 205f 7772 6974 655f 6669 6c74   def _write_filt
+0003ae10: 6572 7328 7365 6c66 2c20 6669 6c74 6572  ers(self, filter
+0003ae20: 7329 3a0a 2020 2020 2020 2020 2320 5772  s):.        # Wr
+0003ae30: 6974 6520 7468 6520 3c66 696c 7465 7273  ite the <filters
+0003ae40: 3e20 656c 656d 656e 742e 0a20 2020 2020  > element..     
+0003ae50: 2020 206e 6f6e 5f62 6c61 6e6b 7320 3d20     non_blanks = 
+0003ae60: 5b66 696c 7465 7220 666f 7220 6669 6c74  [filter for filt
+0003ae70: 6572 2069 6e20 6669 6c74 6572 7320 6966  er in filters if
+0003ae80: 2073 7472 2866 696c 7465 7229 2e6c 6f77   str(filter).low
+0003ae90: 6572 2829 2021 3d20 2262 6c61 6e6b 7322  er() != "blanks"
+0003aea0: 5d0a 2020 2020 2020 2020 6174 7472 6962  ].        attrib
+0003aeb0: 7574 6573 203d 205b 5d0a 0a20 2020 2020  utes = []..     
+0003aec0: 2020 2069 6620 6c65 6e28 6669 6c74 6572     if len(filter
+0003aed0: 7329 2021 3d20 6c65 6e28 6e6f 6e5f 626c  s) != len(non_bl
+0003aee0: 616e 6b73 293a 0a20 2020 2020 2020 2020  anks):.         
+0003aef0: 2020 2061 7474 7269 6275 7465 7320 3d20     attributes = 
+0003af00: 5b28 2262 6c61 6e6b 222c 2031 295d 0a0a  [("blank", 1)]..
+0003af10: 2020 2020 2020 2020 6966 206c 656e 2866          if len(f
+0003af20: 696c 7465 7273 2920 3d3d 2031 2061 6e64  ilters) == 1 and
+0003af30: 206c 656e 286e 6f6e 5f62 6c61 6e6b 7329   len(non_blanks)
+0003af40: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+0003af50: 2020 2023 2053 7065 6369 616c 2063 6173     # Special cas
+0003af60: 6520 666f 7220 626c 616e 6b20 6365 6c6c  e for blank cell
+0003af70: 7320 6f6e 6c79 2e0a 2020 2020 2020 2020  s only..        
+0003af80: 2020 2020 7365 6c66 2e5f 786d 6c5f 656d      self._xml_em
+0003af90: 7074 795f 7461 6728 2266 696c 7465 7273  pty_tag("filters
+0003afa0: 222c 2061 7474 7269 6275 7465 7329 0a20  ", attributes). 
+0003afb0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0003afc0: 2020 2020 2020 2020 2023 2047 656e 6572           # Gener
+0003afd0: 616c 2063 6173 652e 0a20 2020 2020 2020  al case..       
+0003afe0: 2020 2020 2073 656c 662e 5f78 6d6c 5f73       self._xml_s
+0003aff0: 7461 7274 5f74 6167 2822 6669 6c74 6572  tart_tag("filter
+0003b000: 7322 2c20 6174 7472 6962 7574 6573 290a  s", attributes).
+0003b010: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0003b020: 2061 7574 6f66 696c 7465 7220 696e 2073   autofilter in s
+0003b030: 6f72 7465 6428 6e6f 6e5f 626c 616e 6b73  orted(non_blanks
+0003b040: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0003b050: 2020 2073 656c 662e 5f77 7269 7465 5f66     self._write_f
+0003b060: 696c 7465 7228 6175 746f 6669 6c74 6572  ilter(autofilter
+0003b070: 290a 0a20 2020 2020 2020 2020 2020 2073  )..            s
+0003b080: 656c 662e 5f78 6d6c 5f65 6e64 5f74 6167  elf._xml_end_tag
+0003b090: 2822 6669 6c74 6572 7322 290a 0a20 2020  ("filters")..   
+0003b0a0: 2064 6566 205f 7772 6974 655f 6669 6c74   def _write_filt
+0003b0b0: 6572 2873 656c 662c 2076 616c 293a 0a20  er(self, val):. 
+0003b0c0: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
+0003b0d0: 6865 203c 6669 6c74 6572 3e20 656c 656d  he <filter> elem
+0003b0e0: 656e 742e 0a20 2020 2020 2020 2061 7474  ent..        att
+0003b0f0: 7269 6275 7465 7320 3d20 5b28 2276 616c  ributes = [("val
+0003b100: 222c 2076 616c 295d 0a0a 2020 2020 2020  ", val)]..      
+0003b110: 2020 7365 6c66 2e5f 786d 6c5f 656d 7074    self._xml_empt
+0003b120: 795f 7461 6728 2266 696c 7465 7222 2c20  y_tag("filter", 
+0003b130: 6174 7472 6962 7574 6573 290a 0a20 2020  attributes)..   
+0003b140: 2064 6566 205f 7772 6974 655f 6375 7374   def _write_cust
+0003b150: 6f6d 5f66 696c 7465 7273 2873 656c 662c  om_filters(self,
+0003b160: 2074 6f6b 656e 7329 3a0a 2020 2020 2020   tokens):.      
+0003b170: 2020 2320 5772 6974 6520 7468 6520 3c63    # Write the <c
+0003b180: 7573 746f 6d46 696c 7465 7273 3e20 656c  ustomFilters> el
+0003b190: 656d 656e 742e 0a20 2020 2020 2020 2069  ement..        i
+0003b1a0: 6620 6c65 6e28 746f 6b65 6e73 2920 3d3d  f len(tokens) ==
+0003b1b0: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
+0003b1c0: 2320 4f6e 6520 6669 6c74 6572 2065 7870  # One filter exp
+0003b1d0: 7265 7373 696f 6e20 6f6e 6c79 2e0a 2020  ression only..  
+0003b1e0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0003b1f0: 786d 6c5f 7374 6172 745f 7461 6728 2263  xml_start_tag("c
+0003b200: 7573 746f 6d46 696c 7465 7273 2229 0a20  ustomFilters"). 
+0003b210: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0003b220: 5f77 7269 7465 5f63 7573 746f 6d5f 6669  _write_custom_fi
+0003b230: 6c74 6572 282a 746f 6b65 6e73 290a 2020  lter(*tokens).  
+0003b240: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0003b250: 786d 6c5f 656e 645f 7461 6728 2263 7573  xml_end_tag("cus
+0003b260: 746f 6d46 696c 7465 7273 2229 0a20 2020  tomFilters").   
+0003b270: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0003b280: 2020 2020 2020 2023 2054 776f 2066 696c         # Two fil
+0003b290: 7465 7220 6578 7072 6573 7369 6f6e 732e  ter expressions.
+0003b2a0: 0a20 2020 2020 2020 2020 2020 2061 7474  .            att
+0003b2b0: 7269 6275 7465 7320 3d20 5b5d 0a0a 2020  ributes = []..  
+0003b2c0: 2020 2020 2020 2020 2020 2320 4368 6563            # Chec
+0003b2d0: 6b20 6966 2074 6865 2022 6a6f 696e 2220  k if the "join" 
+0003b2e0: 6f70 6572 616e 6420 6973 2022 616e 6422  operand is "and"
+0003b2f0: 206f 7220 226f 7222 2e0a 2020 2020 2020   or "or"..      
+0003b300: 2020 2020 2020 6966 2074 6f6b 656e 735b        if tokens[
+0003b310: 325d 203d 3d20 303a 0a20 2020 2020 2020  2] == 0:.       
+0003b320: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+0003b330: 7465 7320 3d20 5b28 2261 6e64 222c 2031  tes = [("and", 1
+0003b340: 295d 0a20 2020 2020 2020 2020 2020 2065  )].            e
+0003b350: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0003b360: 2020 2020 2061 7474 7269 6275 7465 7320       attributes 
+0003b370: 3d20 5b28 2261 6e64 222c 2030 295d 0a0a  = [("and", 0)]..
+0003b380: 2020 2020 2020 2020 2020 2020 2320 5772              # Wr
+0003b390: 6974 6520 7468 6520 7477 6f20 6375 7374  ite the two cust
+0003b3a0: 6f6d 2066 696c 7465 7273 2e0a 2020 2020  om filters..    
+0003b3b0: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
+0003b3c0: 6c5f 7374 6172 745f 7461 6728 2263 7573  l_start_tag("cus
+0003b3d0: 746f 6d46 696c 7465 7273 222c 2061 7474  tomFilters", att
+0003b3e0: 7269 6275 7465 7329 0a20 2020 2020 2020  ributes).       
+0003b3f0: 2020 2020 2073 656c 662e 5f77 7269 7465       self._write
+0003b400: 5f63 7573 746f 6d5f 6669 6c74 6572 2874  _custom_filter(t
+0003b410: 6f6b 656e 735b 305d 2c20 746f 6b65 6e73  okens[0], tokens
+0003b420: 5b31 5d29 0a20 2020 2020 2020 2020 2020  [1]).           
+0003b430: 2073 656c 662e 5f77 7269 7465 5f63 7573   self._write_cus
+0003b440: 746f 6d5f 6669 6c74 6572 2874 6f6b 656e  tom_filter(token
+0003b450: 735b 335d 2c20 746f 6b65 6e73 5b34 5d29  s[3], tokens[4])
+0003b460: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0003b470: 662e 5f78 6d6c 5f65 6e64 5f74 6167 2822  f._xml_end_tag("
+0003b480: 6375 7374 6f6d 4669 6c74 6572 7322 290a  customFilters").
+0003b490: 0a20 2020 2064 6566 205f 7772 6974 655f  .    def _write_
+0003b4a0: 6375 7374 6f6d 5f66 696c 7465 7228 7365  custom_filter(se
+0003b4b0: 6c66 2c20 6f70 6572 6174 6f72 2c20 7661  lf, operator, va
+0003b4c0: 6c29 3a0a 2020 2020 2020 2020 2320 5772  l):.        # Wr
+0003b4d0: 6974 6520 7468 6520 3c63 7573 746f 6d46  ite the <customF
+0003b4e0: 696c 7465 723e 2065 6c65 6d65 6e74 2e0a  ilter> element..
+0003b4f0: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
+0003b500: 6573 203d 205b 5d0a 0a20 2020 2020 2020  es = []..       
+0003b510: 206f 7065 7261 746f 7273 203d 207b 0a20   operators = {. 
+0003b520: 2020 2020 2020 2020 2020 2031 3a20 226c             1: "l
+0003b530: 6573 7354 6861 6e22 2c0a 2020 2020 2020  essThan",.      
+0003b540: 2020 2020 2020 323a 2022 6571 7561 6c22        2: "equal"
+0003b550: 2c0a 2020 2020 2020 2020 2020 2020 333a  ,.            3:
+0003b560: 2022 6c65 7373 5468 616e 4f72 4571 7561   "lessThanOrEqua
+0003b570: 6c22 2c0a 2020 2020 2020 2020 2020 2020  l",.            
+0003b580: 343a 2022 6772 6561 7465 7254 6861 6e22  4: "greaterThan"
+0003b590: 2c0a 2020 2020 2020 2020 2020 2020 353a  ,.            5:
+0003b5a0: 2022 6e6f 7445 7175 616c 222c 0a20 2020   "notEqual",.   
+0003b5b0: 2020 2020 2020 2020 2036 3a20 2267 7265           6: "gre
+0003b5c0: 6174 6572 5468 616e 4f72 4571 7561 6c22  aterThanOrEqual"
+0003b5d0: 2c0a 2020 2020 2020 2020 2020 2020 3232  ,.            22
+0003b5e0: 3a20 2265 7175 616c 222c 0a20 2020 2020  : "equal",.     
+0003b5f0: 2020 207d 0a0a 2020 2020 2020 2020 2320     }..        # 
+0003b600: 436f 6e76 6572 7420 7468 6520 6f70 6572  Convert the oper
+0003b610: 6174 6f72 2066 726f 6d20 6120 6e75 6d62  ator from a numb
+0003b620: 6572 2074 6f20 6120 6465 7363 7269 7074  er to a descript
+0003b630: 6976 6520 7374 7269 6e67 2e0a 2020 2020  ive string..    
+0003b640: 2020 2020 6966 206f 7065 7261 746f 7273      if operators
+0003b650: 5b6f 7065 7261 746f 725d 2069 7320 6e6f  [operator] is no
+0003b660: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0003b670: 2020 2020 6f70 6572 6174 6f72 203d 206f      operator = o
+0003b680: 7065 7261 746f 7273 5b6f 7065 7261 746f  perators[operato
+0003b690: 725d 0a20 2020 2020 2020 2065 6c73 653a  r].        else:
+0003b6a0: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
+0003b6b0: 6e28 2255 6e6b 6e6f 776e 206f 7065 7261  n("Unknown opera
+0003b6c0: 746f 7220 3d20 2573 2220 2520 6f70 6572  tor = %s" % oper
+0003b6d0: 6174 6f72 290a 0a20 2020 2020 2020 2023  ator)..        #
+0003b6e0: 2054 6865 2027 6571 7561 6c27 206f 7065   The 'equal' ope
+0003b6f0: 7261 746f 7220 6973 2074 6865 2064 6566  rator is the def
+0003b700: 6175 6c74 2061 7474 7269 6275 7465 2061  ault attribute a
+0003b710: 6e64 2069 736e 2774 2073 746f 7265 642e  nd isn't stored.
+0003b720: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+0003b730: 6f70 6572 6174 6f72 203d 3d20 2265 7175  operator == "equ
+0003b740: 616c 223a 0a20 2020 2020 2020 2020 2020  al":.           
+0003b750: 2061 7474 7269 6275 7465 732e 6170 7065   attributes.appe
+0003b760: 6e64 2828 226f 7065 7261 746f 7222 2c20  nd(("operator", 
+0003b770: 6f70 6572 6174 6f72 2929 0a20 2020 2020  operator)).     
+0003b780: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
+0003b790: 7065 6e64 2828 2276 616c 222c 2076 616c  pend(("val", val
+0003b7a0: 2929 0a0a 2020 2020 2020 2020 7365 6c66  ))..        self
+0003b7b0: 2e5f 786d 6c5f 656d 7074 795f 7461 6728  ._xml_empty_tag(
+0003b7c0: 2263 7573 746f 6d46 696c 7465 7222 2c20  "customFilter", 
+0003b7d0: 6174 7472 6962 7574 6573 290a 0a20 2020  attributes)..   
+0003b7e0: 2064 6566 205f 7772 6974 655f 7368 6565   def _write_shee
+0003b7f0: 745f 7072 6f74 6563 7469 6f6e 2873 656c  t_protection(sel
+0003b800: 6629 3a0a 2020 2020 2020 2020 2320 5772  f):.        # Wr
+0003b810: 6974 6520 7468 6520 3c73 6865 6574 5072  ite the <sheetPr
+0003b820: 6f74 6563 7469 6f6e 3e20 656c 656d 656e  otection> elemen
+0003b830: 742e 0a20 2020 2020 2020 2061 7474 7269  t..        attri
+0003b840: 6275 7465 7320 3d20 5b5d 0a0a 2020 2020  butes = []..    
+0003b850: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
+0003b860: 7072 6f74 6563 745f 6f70 7469 6f6e 733a  protect_options:
+0003b870: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0003b880: 7572 6e0a 0a20 2020 2020 2020 206f 7074  urn..        opt
+0003b890: 696f 6e73 203d 2073 656c 662e 7072 6f74  ions = self.prot
+0003b8a0: 6563 745f 6f70 7469 6f6e 730a 0a20 2020  ect_options..   
+0003b8b0: 2020 2020 2069 6620 6f70 7469 6f6e 735b       if options[
+0003b8c0: 2270 6173 7377 6f72 6422 5d3a 0a20 2020  "password"]:.   
+0003b8d0: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+0003b8e0: 7465 732e 6170 7065 6e64 2828 2270 6173  tes.append(("pas
+0003b8f0: 7377 6f72 6422 2c20 6f70 7469 6f6e 735b  sword", options[
+0003b900: 2270 6173 7377 6f72 6422 5d29 290a 2020  "password"])).  
+0003b910: 2020 2020 2020 6966 206f 7074 696f 6e73        if options
+0003b920: 5b22 7368 6565 7422 5d3a 0a20 2020 2020  ["sheet"]:.     
+0003b930: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
+0003b940: 732e 6170 7065 6e64 2828 2273 6865 6574  s.append(("sheet
+0003b950: 222c 2031 2929 0a20 2020 2020 2020 2069  ", 1)).        i
+0003b960: 6620 6f70 7469 6f6e 735b 2263 6f6e 7465  f options["conte
+0003b970: 6e74 225d 3a0a 2020 2020 2020 2020 2020  nt"]:.          
+0003b980: 2020 6174 7472 6962 7574 6573 2e61 7070    attributes.app
+0003b990: 656e 6428 2822 636f 6e74 656e 7422 2c20  end(("content", 
+0003b9a0: 3129 290a 2020 2020 2020 2020 6966 206e  1)).        if n
+0003b9b0: 6f74 206f 7074 696f 6e73 5b22 6f62 6a65  ot options["obje
+0003b9c0: 6374 7322 5d3a 0a20 2020 2020 2020 2020  cts"]:.         
+0003b9d0: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
+0003b9e0: 7065 6e64 2828 226f 626a 6563 7473 222c  pend(("objects",
+0003b9f0: 2031 2929 0a20 2020 2020 2020 2069 6620   1)).        if 
+0003ba00: 6e6f 7420 6f70 7469 6f6e 735b 2273 6365  not options["sce
+0003ba10: 6e61 7269 6f73 225d 3a0a 2020 2020 2020  narios"]:.      
+0003ba20: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
+0003ba30: 2e61 7070 656e 6428 2822 7363 656e 6172  .append(("scenar
+0003ba40: 696f 7322 2c20 3129 290a 2020 2020 2020  ios", 1)).      
+0003ba50: 2020 6966 206f 7074 696f 6e73 5b22 666f    if options["fo
+0003ba60: 726d 6174 5f63 656c 6c73 225d 3a0a 2020  rmat_cells"]:.  
+0003ba70: 2020 2020 2020 2020 2020 6174 7472 6962            attrib
+0003ba80: 7574 6573 2e61 7070 656e 6428 2822 666f  utes.append(("fo
+0003ba90: 726d 6174 4365 6c6c 7322 2c20 3029 290a  rmatCells", 0)).
+0003baa0: 2020 2020 2020 2020 6966 206f 7074 696f          if optio
+0003bab0: 6e73 5b22 666f 726d 6174 5f63 6f6c 756d  ns["format_colum
+0003bac0: 6e73 225d 3a0a 2020 2020 2020 2020 2020  ns"]:.          
+0003bad0: 2020 6174 7472 6962 7574 6573 2e61 7070    attributes.app
+0003bae0: 656e 6428 2822 666f 726d 6174 436f 6c75  end(("formatColu
+0003baf0: 6d6e 7322 2c20 3029 290a 2020 2020 2020  mns", 0)).      
+0003bb00: 2020 6966 206f 7074 696f 6e73 5b22 666f    if options["fo
+0003bb10: 726d 6174 5f72 6f77 7322 5d3a 0a20 2020  rmat_rows"]:.   
+0003bb20: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+0003bb30: 7465 732e 6170 7065 6e64 2828 2266 6f72  tes.append(("for
+0003bb40: 6d61 7452 6f77 7322 2c20 3029 290a 2020  matRows", 0)).  
+0003bb50: 2020 2020 2020 6966 206f 7074 696f 6e73        if options
+0003bb60: 5b22 696e 7365 7274 5f63 6f6c 756d 6e73  ["insert_columns
+0003bb70: 225d 3a0a 2020 2020 2020 2020 2020 2020  "]:.            
+0003bb80: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
+0003bb90: 6428 2822 696e 7365 7274 436f 6c75 6d6e  d(("insertColumn
+0003bba0: 7322 2c20 3029 290a 2020 2020 2020 2020  s", 0)).        
+0003bbb0: 6966 206f 7074 696f 6e73 5b22 696e 7365  if options["inse
+0003bbc0: 7274 5f72 6f77 7322 5d3a 0a20 2020 2020  rt_rows"]:.     
+0003bbd0: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
+0003bbe0: 732e 6170 7065 6e64 2828 2269 6e73 6572  s.append(("inser
+0003bbf0: 7452 6f77 7322 2c20 3029 290a 2020 2020  tRows", 0)).    
+0003bc00: 2020 2020 6966 206f 7074 696f 6e73 5b22      if options["
+0003bc10: 696e 7365 7274 5f68 7970 6572 6c69 6e6b  insert_hyperlink
+0003bc20: 7322 5d3a 0a20 2020 2020 2020 2020 2020  s"]:.           
+0003bc30: 2061 7474 7269 6275 7465 732e 6170 7065   attributes.appe
+0003bc40: 6e64 2828 2269 6e73 6572 7448 7970 6572  nd(("insertHyper
+0003bc50: 6c69 6e6b 7322 2c20 3029 290a 2020 2020  links", 0)).    
+0003bc60: 2020 2020 6966 206f 7074 696f 6e73 5b22      if options["
+0003bc70: 6465 6c65 7465 5f63 6f6c 756d 6e73 225d  delete_columns"]
+0003bc80: 3a0a 2020 2020 2020 2020 2020 2020 6174  :.            at
+0003bc90: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
+0003bca0: 2822 6465 6c65 7465 436f 6c75 6d6e 7322  ("deleteColumns"
+0003bcb0: 2c20 3029 290a 2020 2020 2020 2020 6966  , 0)).        if
+0003bcc0: 206f 7074 696f 6e73 5b22 6465 6c65 7465   options["delete
+0003bcd0: 5f72 6f77 7322 5d3a 0a20 2020 2020 2020  _rows"]:.       
+0003bce0: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
+0003bcf0: 6170 7065 6e64 2828 2264 656c 6574 6552  append(("deleteR
+0003bd00: 6f77 7322 2c20 3029 290a 2020 2020 2020  ows", 0)).      
+0003bd10: 2020 6966 206e 6f74 206f 7074 696f 6e73    if not options
+0003bd20: 5b22 7365 6c65 6374 5f6c 6f63 6b65 645f  ["select_locked_
+0003bd30: 6365 6c6c 7322 5d3a 0a20 2020 2020 2020  cells"]:.       
+0003bd40: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
+0003bd50: 6170 7065 6e64 2828 2273 656c 6563 744c  append(("selectL
+0003bd60: 6f63 6b65 6443 656c 6c73 222c 2031 2929  ockedCells", 1))
+0003bd70: 0a20 2020 2020 2020 2069 6620 6f70 7469  .        if opti
+0003bd80: 6f6e 735b 2273 6f72 7422 5d3a 0a20 2020  ons["sort"]:.   
+0003bd90: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+0003bda0: 7465 732e 6170 7065 6e64 2828 2273 6f72  tes.append(("sor
+0003bdb0: 7422 2c20 3029 290a 2020 2020 2020 2020  t", 0)).        
+0003bdc0: 6966 206f 7074 696f 6e73 5b22 6175 746f  if options["auto
+0003bdd0: 6669 6c74 6572 225d 3a0a 2020 2020 2020  filter"]:.      
+0003bde0: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
+0003bdf0: 2e61 7070 656e 6428 2822 6175 746f 4669  .append(("autoFi
+0003be00: 6c74 6572 222c 2030 2929 0a20 2020 2020  lter", 0)).     
+0003be10: 2020 2069 6620 6f70 7469 6f6e 735b 2270     if options["p
+0003be20: 6976 6f74 5f74 6162 6c65 7322 5d3a 0a20  ivot_tables"]:. 
+0003be30: 2020 2020 2020 2020 2020 2061 7474 7269             attri
+0003be40: 6275 7465 732e 6170 7065 6e64 2828 2270  butes.append(("p
+0003be50: 6976 6f74 5461 626c 6573 222c 2030 2929  ivotTables", 0))
+0003be60: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+0003be70: 6f70 7469 6f6e 735b 2273 656c 6563 745f  options["select_
+0003be80: 756e 6c6f 636b 6564 5f63 656c 6c73 225d  unlocked_cells"]
+0003be90: 3a0a 2020 2020 2020 2020 2020 2020 6174  :.            at
+0003bea0: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
+0003beb0: 2822 7365 6c65 6374 556e 6c6f 636b 6564  ("selectUnlocked
+0003bec0: 4365 6c6c 7322 2c20 3129 290a 0a20 2020  Cells", 1))..   
+0003bed0: 2020 2020 2073 656c 662e 5f78 6d6c 5f65       self._xml_e
+0003bee0: 6d70 7479 5f74 6167 2822 7368 6565 7450  mpty_tag("sheetP
+0003bef0: 726f 7465 6374 696f 6e22 2c20 6174 7472  rotection", attr
+0003bf00: 6962 7574 6573 290a 0a20 2020 2064 6566  ibutes)..    def
+0003bf10: 205f 7772 6974 655f 7072 6f74 6563 7465   _write_protecte
+0003bf20: 645f 7261 6e67 6573 2873 656c 6629 3a0a  d_ranges(self):.
+0003bf30: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
+0003bf40: 7468 6520 3c70 726f 7465 6374 6564 5261  the <protectedRa
+0003bf50: 6e67 6573 3e20 656c 656d 656e 742e 0a20  nges> element.. 
+0003bf60: 2020 2020 2020 2069 6620 7365 6c66 2e6e         if self.n
+0003bf70: 756d 5f70 726f 7465 6374 6564 5f72 616e  um_protected_ran
+0003bf80: 6765 7320 3d3d 2030 3a0a 2020 2020 2020  ges == 0:.      
+0003bf90: 2020 2020 2020 7265 7475 726e 0a0a 2020        return..  
+0003bfa0: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
+0003bfb0: 7374 6172 745f 7461 6728 2270 726f 7465  start_tag("prote
+0003bfc0: 6374 6564 5261 6e67 6573 2229 0a0a 2020  ctedRanges")..  
+0003bfd0: 2020 2020 2020 666f 7220 6365 6c6c 5f72        for cell_r
+0003bfe0: 616e 6765 2c20 7261 6e67 655f 6e61 6d65  ange, range_name
+0003bff0: 2c20 7061 7373 776f 7264 2069 6e20 7365  , password in se
+0003c000: 6c66 2e70 726f 7465 6374 6564 5f72 616e  lf.protected_ran
+0003c010: 6765 733a 0a20 2020 2020 2020 2020 2020  ges:.           
+0003c020: 2073 656c 662e 5f77 7269 7465 5f70 726f   self._write_pro
+0003c030: 7465 6374 6564 5f72 616e 6765 2863 656c  tected_range(cel
+0003c040: 6c5f 7261 6e67 652c 2072 616e 6765 5f6e  l_range, range_n
+0003c050: 616d 652c 2070 6173 7377 6f72 6429 0a0a  ame, password)..
+0003c060: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
+0003c070: 6c5f 656e 645f 7461 6728 2270 726f 7465  l_end_tag("prote
+0003c080: 6374 6564 5261 6e67 6573 2229 0a0a 2020  ctedRanges")..  
+0003c090: 2020 6465 6620 5f77 7269 7465 5f70 726f    def _write_pro
+0003c0a0: 7465 6374 6564 5f72 616e 6765 2873 656c  tected_range(sel
+0003c0b0: 662c 2063 656c 6c5f 7261 6e67 652c 2072  f, cell_range, r
+0003c0c0: 616e 6765 5f6e 616d 652c 2070 6173 7377  ange_name, passw
+0003c0d0: 6f72 6429 3a0a 2020 2020 2020 2020 2320  ord):.        # 
+0003c0e0: 5772 6974 6520 7468 6520 3c70 726f 7465  Write the <prote
+0003c0f0: 6374 6564 5261 6e67 653e 2065 6c65 6d65  ctedRange> eleme
+0003c100: 6e74 2e0a 2020 2020 2020 2020 6174 7472  nt..        attr
+0003c110: 6962 7574 6573 203d 205b 5d0a 0a20 2020  ibutes = []..   
+0003c120: 2020 2020 2069 6620 7061 7373 776f 7264       if password
+0003c130: 3a0a 2020 2020 2020 2020 2020 2020 6174  :.            at
+0003c140: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
+0003c150: 2822 7061 7373 776f 7264 222c 2070 6173  ("password", pas
+0003c160: 7377 6f72 6429 290a 0a20 2020 2020 2020  sword))..       
+0003c170: 2061 7474 7269 6275 7465 732e 6170 7065   attributes.appe
+0003c180: 6e64 2828 2273 7172 6566 222c 2063 656c  nd(("sqref", cel
+0003c190: 6c5f 7261 6e67 6529 290a 2020 2020 2020  l_range)).      
+0003c1a0: 2020 6174 7472 6962 7574 6573 2e61 7070    attributes.app
+0003c1b0: 656e 6428 2822 6e61 6d65 222c 2072 616e  end(("name", ran
+0003c1c0: 6765 5f6e 616d 6529 290a 0a20 2020 2020  ge_name))..     
+0003c1d0: 2020 2073 656c 662e 5f78 6d6c 5f65 6d70     self._xml_emp
+0003c1e0: 7479 5f74 6167 2822 7072 6f74 6563 7465  ty_tag("protecte
+0003c1f0: 6452 616e 6765 222c 2061 7474 7269 6275  dRange", attribu
+0003c200: 7465 7329 0a0a 2020 2020 6465 6620 5f77  tes)..    def _w
+0003c210: 7269 7465 5f64 7261 7769 6e67 7328 7365  rite_drawings(se
+0003c220: 6c66 293a 0a20 2020 2020 2020 2023 2057  lf):.        # W
+0003c230: 7269 7465 2074 6865 203c 6472 6177 696e  rite the <drawin
+0003c240: 673e 2065 6c65 6d65 6e74 732e 0a20 2020  g> elements..   
+0003c250: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+0003c260: 2e64 7261 7769 6e67 3a0a 2020 2020 2020  .drawing:.      
+0003c270: 2020 2020 2020 7265 7475 726e 0a0a 2020        return..  
+0003c280: 2020 2020 2020 7365 6c66 2e72 656c 5f63        self.rel_c
+0003c290: 6f75 6e74 202b 3d20 310a 2020 2020 2020  ount += 1.      
+0003c2a0: 2020 7365 6c66 2e5f 7772 6974 655f 6472    self._write_dr
+0003c2b0: 6177 696e 6728 7365 6c66 2e72 656c 5f63  awing(self.rel_c
+0003c2c0: 6f75 6e74 290a 0a20 2020 2064 6566 205f  ount)..    def _
+0003c2d0: 7772 6974 655f 6472 6177 696e 6728 7365  write_drawing(se
+0003c2e0: 6c66 2c20 6472 6177 696e 675f 6964 293a  lf, drawing_id):
+0003c2f0: 0a20 2020 2020 2020 2023 2057 7269 7465  .        # Write
+0003c300: 2074 6865 203c 6472 6177 696e 673e 2065   the <drawing> e
+0003c310: 6c65 6d65 6e74 2e0a 2020 2020 2020 2020  lement..        
+0003c320: 725f 6964 203d 2022 7249 6422 202b 2073  r_id = "rId" + s
+0003c330: 7472 2864 7261 7769 6e67 5f69 6429 0a0a  tr(drawing_id)..
+0003c340: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
+0003c350: 6573 203d 205b 2822 723a 6964 222c 2072  es = [("r:id", r
+0003c360: 5f69 6429 5d0a 0a20 2020 2020 2020 2073  _id)]..        s
+0003c370: 656c 662e 5f78 6d6c 5f65 6d70 7479 5f74  elf._xml_empty_t
+0003c380: 6167 2822 6472 6177 696e 6722 2c20 6174  ag("drawing", at
+0003c390: 7472 6962 7574 6573 290a 0a20 2020 2064  tributes)..    d
+0003c3a0: 6566 205f 7772 6974 655f 6c65 6761 6379  ef _write_legacy
+0003c3b0: 5f64 7261 7769 6e67 2873 656c 6629 3a0a  _drawing(self):.
+0003c3c0: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
+0003c3d0: 7468 6520 3c6c 6567 6163 7944 7261 7769  the <legacyDrawi
+0003c3e0: 6e67 3e20 656c 656d 656e 742e 0a20 2020  ng> element..   
+0003c3f0: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+0003c400: 2e68 6173 5f76 6d6c 3a0a 2020 2020 2020  .has_vml:.      
+0003c410: 2020 2020 2020 7265 7475 726e 0a0a 2020        return..  
+0003c420: 2020 2020 2020 2320 496e 6372 656d 656e        # Incremen
+0003c430: 7420 7468 6520 7265 6c61 7469 6f6e 7368  t the relationsh
+0003c440: 6970 2069 6420 666f 7220 616e 7920 6472  ip id for any dr
+0003c450: 6177 696e 6773 206f 7220 636f 6d6d 656e  awings or commen
+0003c460: 7473 2e0a 2020 2020 2020 2020 7365 6c66  ts..        self
+0003c470: 2e72 656c 5f63 6f75 6e74 202b 3d20 310a  .rel_count += 1.
+0003c480: 2020 2020 2020 2020 725f 6964 203d 2022          r_id = "
+0003c490: 7249 6422 202b 2073 7472 2873 656c 662e  rId" + str(self.
+0003c4a0: 7265 6c5f 636f 756e 7429 0a0a 2020 2020  rel_count)..    
+0003c4b0: 2020 2020 6174 7472 6962 7574 6573 203d      attributes =
+0003c4c0: 205b 2822 723a 6964 222c 2072 5f69 6429   [("r:id", r_id)
+0003c4d0: 5d0a 0a20 2020 2020 2020 2073 656c 662e  ]..        self.
+0003c4e0: 5f78 6d6c 5f65 6d70 7479 5f74 6167 2822  _xml_empty_tag("
+0003c4f0: 6c65 6761 6379 4472 6177 696e 6722 2c20  legacyDrawing", 
+0003c500: 6174 7472 6962 7574 6573 290a 0a20 2020  attributes)..   
+0003c510: 2064 6566 205f 7772 6974 655f 6c65 6761   def _write_lega
+0003c520: 6379 5f64 7261 7769 6e67 5f68 6628 7365  cy_drawing_hf(se
+0003c530: 6c66 293a 0a20 2020 2020 2020 2023 2057  lf):.        # W
+0003c540: 7269 7465 2074 6865 203c 6c65 6761 6379  rite the <legacy
+0003c550: 4472 6177 696e 6748 463e 2065 6c65 6d65  DrawingHF> eleme
+0003c560: 6e74 2e0a 2020 2020 2020 2020 6966 206e  nt..        if n
+0003c570: 6f74 2073 656c 662e 6861 735f 6865 6164  ot self.has_head
+0003c580: 6572 5f76 6d6c 3a0a 2020 2020 2020 2020  er_vml:.        
+0003c590: 2020 2020 7265 7475 726e 0a0a 2020 2020      return..    
+0003c5a0: 2020 2020 2320 496e 6372 656d 656e 7420      # Increment 
+0003c5b0: 7468 6520 7265 6c61 7469 6f6e 7368 6970  the relationship
+0003c5c0: 2069 6420 666f 7220 616e 7920 6472 6177   id for any draw
+0003c5d0: 696e 6773 206f 7220 636f 6d6d 656e 7473  ings or comments
+0003c5e0: 2e0a 2020 2020 2020 2020 7365 6c66 2e72  ..        self.r
+0003c5f0: 656c 5f63 6f75 6e74 202b 3d20 310a 2020  el_count += 1.  
+0003c600: 2020 2020 2020 725f 6964 203d 2022 7249        r_id = "rI
+0003c610: 6422 202b 2073 7472 2873 656c 662e 7265  d" + str(self.re
+0003c620: 6c5f 636f 756e 7429 0a0a 2020 2020 2020  l_count)..      
+0003c630: 2020 6174 7472 6962 7574 6573 203d 205b    attributes = [
+0003c640: 2822 723a 6964 222c 2072 5f69 6429 5d0a  ("r:id", r_id)].
+0003c650: 0a20 2020 2020 2020 2073 656c 662e 5f78  .        self._x
+0003c660: 6d6c 5f65 6d70 7479 5f74 6167 2822 6c65  ml_empty_tag("le
+0003c670: 6761 6379 4472 6177 696e 6748 4622 2c20  gacyDrawingHF", 
+0003c680: 6174 7472 6962 7574 6573 290a 0a20 2020  attributes)..   
+0003c690: 2064 6566 205f 7772 6974 655f 7069 6374   def _write_pict
+0003c6a0: 7572 6528 7365 6c66 293a 0a20 2020 2020  ure(self):.     
+0003c6b0: 2020 2023 2057 7269 7465 2074 6865 203c     # Write the <
+0003c6c0: 7069 6374 7572 653e 2065 6c65 6d65 6e74  picture> element
+0003c6d0: 2e0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+0003c6e0: 2073 656c 662e 6261 636b 6772 6f75 6e64   self.background
+0003c6f0: 5f69 6d61 6765 3a0a 2020 2020 2020 2020  _image:.        
+0003c700: 2020 2020 7265 7475 726e 0a0a 2020 2020      return..    
+0003c710: 2020 2020 2320 496e 6372 656d 656e 7420      # Increment 
+0003c720: 7468 6520 7265 6c61 7469 6f6e 7368 6970  the relationship
+0003c730: 2069 642e 0a20 2020 2020 2020 2073 656c   id..        sel
+0003c740: 662e 7265 6c5f 636f 756e 7420 2b3d 2031  f.rel_count += 1
+0003c750: 0a20 2020 2020 2020 2072 5f69 6420 3d20  .        r_id = 
+0003c760: 2272 4964 2220 2b20 7374 7228 7365 6c66  "rId" + str(self
+0003c770: 2e72 656c 5f63 6f75 6e74 290a 0a20 2020  .rel_count)..   
+0003c780: 2020 2020 2061 7474 7269 6275 7465 7320       attributes 
+0003c790: 3d20 5b28 2272 3a69 6422 2c20 725f 6964  = [("r:id", r_id
+0003c7a0: 295d 0a0a 2020 2020 2020 2020 7365 6c66  )]..        self
+0003c7b0: 2e5f 786d 6c5f 656d 7074 795f 7461 6728  ._xml_empty_tag(
+0003c7c0: 2270 6963 7475 7265 222c 2061 7474 7269  "picture", attri
+0003c7d0: 6275 7465 7329 0a0a 2020 2020 6465 6620  butes)..    def 
+0003c7e0: 5f77 7269 7465 5f64 6174 615f 7661 6c69  _write_data_vali
+0003c7f0: 6461 7469 6f6e 7328 7365 6c66 293a 0a20  dations(self):. 
+0003c800: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
+0003c810: 6865 203c 6461 7461 5661 6c69 6461 7469  he <dataValidati
+0003c820: 6f6e 733e 2065 6c65 6d65 6e74 2e0a 2020  ons> element..  
+0003c830: 2020 2020 2020 7661 6c69 6461 7469 6f6e        validation
+0003c840: 7320 3d20 7365 6c66 2e76 616c 6964 6174  s = self.validat
+0003c850: 696f 6e73 0a20 2020 2020 2020 2063 6f75  ions.        cou
+0003c860: 6e74 203d 206c 656e 2876 616c 6964 6174  nt = len(validat
+0003c870: 696f 6e73 290a 0a20 2020 2020 2020 2069  ions)..        i
+0003c880: 6620 6e6f 7420 636f 756e 743a 0a20 2020  f not count:.   
+0003c890: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
+0003c8a0: 0a20 2020 2020 2020 2061 7474 7269 6275  .        attribu
+0003c8b0: 7465 7320 3d20 5b28 2263 6f75 6e74 222c  tes = [("count",
+0003c8c0: 2063 6f75 6e74 295d 0a0a 2020 2020 2020   count)]..      
+0003c8d0: 2020 7365 6c66 2e5f 786d 6c5f 7374 6172    self._xml_star
+0003c8e0: 745f 7461 6728 2264 6174 6156 616c 6964  t_tag("dataValid
+0003c8f0: 6174 696f 6e73 222c 2061 7474 7269 6275  ations", attribu
+0003c900: 7465 7329 0a0a 2020 2020 2020 2020 666f  tes)..        fo
+0003c910: 7220 7661 6c69 6461 7469 6f6e 2069 6e20  r validation in 
+0003c920: 7661 6c69 6461 7469 6f6e 733a 0a20 2020  validations:.   
+0003c930: 2020 2020 2020 2020 2023 2057 7269 7465           # Write
+0003c940: 2074 6865 2064 6174 6156 616c 6964 6174   the dataValidat
+0003c950: 696f 6e20 656c 656d 656e 742e 0a20 2020  ion element..   
+0003c960: 2020 2020 2020 2020 2073 656c 662e 5f77           self._w
+0003c970: 7269 7465 5f64 6174 615f 7661 6c69 6461  rite_data_valida
+0003c980: 7469 6f6e 2876 616c 6964 6174 696f 6e29  tion(validation)
+0003c990: 0a0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+0003c9a0: 786d 6c5f 656e 645f 7461 6728 2264 6174  xml_end_tag("dat
+0003c9b0: 6156 616c 6964 6174 696f 6e73 2229 0a0a  aValidations")..
+0003c9c0: 2020 2020 6465 6620 5f77 7269 7465 5f64      def _write_d
+0003c9d0: 6174 615f 7661 6c69 6461 7469 6f6e 2873  ata_validation(s
+0003c9e0: 656c 662c 206f 7074 696f 6e73 293a 0a20  elf, options):. 
+0003c9f0: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
+0003ca00: 6865 203c 6461 7461 5661 6c69 6461 7469  he <dataValidati
+0003ca10: 6f6e 3e20 656c 656d 656e 742e 0a20 2020  on> element..   
+0003ca20: 2020 2020 2073 7172 6566 203d 2022 220a       sqref = "".
+0003ca30: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
+0003ca40: 6573 203d 205b 5d0a 0a20 2020 2020 2020  es = []..       
+0003ca50: 2023 2053 6574 2074 6865 2063 656c 6c20   # Set the cell 
+0003ca60: 7261 6e67 6528 7329 2066 6f72 2074 6865  range(s) for the
+0003ca70: 2064 6174 6120 7661 6c69 6461 7469 6f6e   data validation
+0003ca80: 2e0a 2020 2020 2020 2020 666f 7220 6365  ..        for ce
+0003ca90: 6c6c 7320 696e 206f 7074 696f 6e73 5b22  lls in options["
+0003caa0: 6365 6c6c 7322 5d3a 0a20 2020 2020 2020  cells"]:.       
+0003cab0: 2020 2020 2023 2041 6464 2061 2073 7061       # Add a spa
+0003cac0: 6365 2062 6574 7765 656e 206d 756c 7469  ce between multi
+0003cad0: 706c 6520 6365 6c6c 2072 616e 6765 732e  ple cell ranges.
+0003cae0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0003caf0: 7371 7265 6620 213d 2022 223a 0a20 2020  sqref != "":.   
+0003cb00: 2020 2020 2020 2020 2020 2020 2073 7172               sqr
+0003cb10: 6566 202b 3d20 2220 220a 0a20 2020 2020  ef += " "..     
+0003cb20: 2020 2020 2020 2028 726f 775f 6669 7273         (row_firs
+0003cb30: 742c 2063 6f6c 5f66 6972 7374 2c20 726f  t, col_first, ro
+0003cb40: 775f 6c61 7374 2c20 636f 6c5f 6c61 7374  w_last, col_last
+0003cb50: 2920 3d20 6365 6c6c 730a 0a20 2020 2020  ) = cells..     
+0003cb60: 2020 2020 2020 2023 2053 7761 7020 6c61         # Swap la
+0003cb70: 7374 2072 6f77 2f63 6f6c 2066 6f72 2066  st row/col for f
+0003cb80: 6972 7374 2072 6f77 2f63 6f6c 2061 7320  irst row/col as 
+0003cb90: 6e65 6365 7373 6172 790a 2020 2020 2020  necessary.      
+0003cba0: 2020 2020 2020 6966 2072 6f77 5f66 6972        if row_fir
+0003cbb0: 7374 203e 2072 6f77 5f6c 6173 743a 0a20  st > row_last:. 
+0003cbc0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+0003cbd0: 726f 775f 6669 7273 742c 2072 6f77 5f6c  row_first, row_l
+0003cbe0: 6173 7429 203d 2028 726f 775f 6c61 7374  ast) = (row_last
+0003cbf0: 2c20 726f 775f 6669 7273 7429 0a0a 2020  , row_first)..  
+0003cc00: 2020 2020 2020 2020 2020 6966 2063 6f6c            if col
+0003cc10: 5f66 6972 7374 203e 2063 6f6c 5f6c 6173  _first > col_las
+0003cc20: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+0003cc30: 2020 2028 636f 6c5f 6669 7273 742c 2063     (col_first, c
+0003cc40: 6f6c 5f6c 6173 7429 203d 2028 636f 6c5f  ol_last) = (col_
+0003cc50: 6c61 7374 2c20 636f 6c5f 6669 7273 7429  last, col_first)
+0003cc60: 0a0a 2020 2020 2020 2020 2020 2020 7371  ..            sq
+0003cc70: 7265 6620 2b3d 2078 6c5f 7261 6e67 6528  ref += xl_range(
+0003cc80: 726f 775f 6669 7273 742c 2063 6f6c 5f66  row_first, col_f
+0003cc90: 6972 7374 2c20 726f 775f 6c61 7374 2c20  irst, row_last, 
+0003cca0: 636f 6c5f 6c61 7374 290a 0a20 2020 2020  col_last)..     
+0003ccb0: 2020 2069 6620 6f70 7469 6f6e 732e 6765     if options.ge
+0003ccc0: 7428 226d 756c 7469 5f72 616e 6765 2229  t("multi_range")
+0003ccd0: 3a0a 2020 2020 2020 2020 2020 2020 7371  :.            sq
+0003cce0: 7265 6620 3d20 6f70 7469 6f6e 735b 226d  ref = options["m
+0003ccf0: 756c 7469 5f72 616e 6765 225d 0a0a 2020  ulti_range"]..  
+0003cd00: 2020 2020 2020 6966 206f 7074 696f 6e73        if options
+0003cd10: 5b22 7661 6c69 6461 7465 225d 2021 3d20  ["validate"] != 
+0003cd20: 226e 6f6e 6522 3a0a 2020 2020 2020 2020  "none":.        
+0003cd30: 2020 2020 6174 7472 6962 7574 6573 2e61      attributes.a
+0003cd40: 7070 656e 6428 2822 7479 7065 222c 206f  ppend(("type", o
+0003cd50: 7074 696f 6e73 5b22 7661 6c69 6461 7465  ptions["validate
+0003cd60: 225d 2929 0a0a 2020 2020 2020 2020 2020  "]))..          
+0003cd70: 2020 6966 206f 7074 696f 6e73 5b22 6372    if options["cr
+0003cd80: 6974 6572 6961 225d 2021 3d20 2262 6574  iteria"] != "bet
+0003cd90: 7765 656e 223a 0a20 2020 2020 2020 2020  ween":.         
+0003cda0: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
+0003cdb0: 732e 6170 7065 6e64 2828 226f 7065 7261  s.append(("opera
+0003cdc0: 746f 7222 2c20 6f70 7469 6f6e 735b 2263  tor", options["c
+0003cdd0: 7269 7465 7269 6122 5d29 290a 0a20 2020  riteria"]))..   
+0003cde0: 2020 2020 2069 6620 2265 7272 6f72 5f74       if "error_t
+0003cdf0: 7970 6522 2069 6e20 6f70 7469 6f6e 733a  ype" in options:
+0003ce00: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0003ce10: 6f70 7469 6f6e 735b 2265 7272 6f72 5f74  options["error_t
+0003ce20: 7970 6522 5d20 3d3d 2031 3a0a 2020 2020  ype"] == 1:.    
+0003ce30: 2020 2020 2020 2020 2020 2020 6174 7472              attr
+0003ce40: 6962 7574 6573 2e61 7070 656e 6428 2822  ibutes.append(("
+0003ce50: 6572 726f 7253 7479 6c65 222c 2022 7761  errorStyle", "wa
+0003ce60: 726e 696e 6722 2929 0a20 2020 2020 2020  rning")).       
+0003ce70: 2020 2020 2069 6620 6f70 7469 6f6e 735b       if options[
+0003ce80: 2265 7272 6f72 5f74 7970 6522 5d20 3d3d  "error_type"] ==
+0003ce90: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
+0003cea0: 2020 2020 6174 7472 6962 7574 6573 2e61      attributes.a
+0003ceb0: 7070 656e 6428 2822 6572 726f 7253 7479  ppend(("errorSty
+0003cec0: 6c65 222c 2022 696e 666f 726d 6174 696f  le", "informatio
+0003ced0: 6e22 2929 0a0a 2020 2020 2020 2020 6966  n"))..        if
+0003cee0: 206f 7074 696f 6e73 5b22 6967 6e6f 7265   options["ignore
+0003cef0: 5f62 6c61 6e6b 225d 3a0a 2020 2020 2020  _blank"]:.      
+0003cf00: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
+0003cf10: 2e61 7070 656e 6428 2822 616c 6c6f 7742  .append(("allowB
+0003cf20: 6c61 6e6b 222c 2031 2929 0a0a 2020 2020  lank", 1))..    
+0003cf30: 2020 2020 6966 206e 6f74 206f 7074 696f      if not optio
+0003cf40: 6e73 5b22 6472 6f70 646f 776e 225d 3a0a  ns["dropdown"]:.
+0003cf50: 2020 2020 2020 2020 2020 2020 6174 7472              attr
+0003cf60: 6962 7574 6573 2e61 7070 656e 6428 2822  ibutes.append(("
+0003cf70: 7368 6f77 4472 6f70 446f 776e 222c 2031  showDropDown", 1
+0003cf80: 2929 0a0a 2020 2020 2020 2020 6966 206f  ))..        if o
+0003cf90: 7074 696f 6e73 5b22 7368 6f77 5f69 6e70  ptions["show_inp
+0003cfa0: 7574 225d 3a0a 2020 2020 2020 2020 2020  ut"]:.          
+0003cfb0: 2020 6174 7472 6962 7574 6573 2e61 7070    attributes.app
+0003cfc0: 656e 6428 2822 7368 6f77 496e 7075 744d  end(("showInputM
+0003cfd0: 6573 7361 6765 222c 2031 2929 0a0a 2020  essage", 1))..  
+0003cfe0: 2020 2020 2020 6966 206f 7074 696f 6e73        if options
+0003cff0: 5b22 7368 6f77 5f65 7272 6f72 225d 3a0a  ["show_error"]:.
+0003d000: 2020 2020 2020 2020 2020 2020 6174 7472              attr
+0003d010: 6962 7574 6573 2e61 7070 656e 6428 2822  ibutes.append(("
+0003d020: 7368 6f77 4572 726f 724d 6573 7361 6765  showErrorMessage
+0003d030: 222c 2031 2929 0a0a 2020 2020 2020 2020  ", 1))..        
+0003d040: 6966 2022 6572 726f 725f 7469 746c 6522  if "error_title"
+0003d050: 2069 6e20 6f70 7469 6f6e 733a 0a20 2020   in options:.   
+0003d060: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+0003d070: 7465 732e 6170 7065 6e64 2828 2265 7272  tes.append(("err
+0003d080: 6f72 5469 746c 6522 2c20 6f70 7469 6f6e  orTitle", option
+0003d090: 735b 2265 7272 6f72 5f74 6974 6c65 225d  s["error_title"]
+0003d0a0: 2929 0a0a 2020 2020 2020 2020 6966 2022  ))..        if "
+0003d0b0: 6572 726f 725f 6d65 7373 6167 6522 2069  error_message" i
+0003d0c0: 6e20 6f70 7469 6f6e 733a 0a20 2020 2020  n options:.     
+0003d0d0: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
+0003d0e0: 732e 6170 7065 6e64 2828 2265 7272 6f72  s.append(("error
+0003d0f0: 222c 206f 7074 696f 6e73 5b22 6572 726f  ", options["erro
+0003d100: 725f 6d65 7373 6167 6522 5d29 290a 0a20  r_message"])).. 
+0003d110: 2020 2020 2020 2069 6620 2269 6e70 7574         if "input
+0003d120: 5f74 6974 6c65 2220 696e 206f 7074 696f  _title" in optio
+0003d130: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+0003d140: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
+0003d150: 6428 2822 7072 6f6d 7074 5469 746c 6522  d(("promptTitle"
+0003d160: 2c20 6f70 7469 6f6e 735b 2269 6e70 7574  , options["input
+0003d170: 5f74 6974 6c65 225d 2929 0a0a 2020 2020  _title"]))..    
+0003d180: 2020 2020 6966 2022 696e 7075 745f 6d65      if "input_me
+0003d190: 7373 6167 6522 2069 6e20 6f70 7469 6f6e  ssage" in option
+0003d1a0: 733a 0a20 2020 2020 2020 2020 2020 2061  s:.            a
+0003d1b0: 7474 7269 6275 7465 732e 6170 7065 6e64  ttributes.append
+0003d1c0: 2828 2270 726f 6d70 7422 2c20 6f70 7469  (("prompt", opti
+0003d1d0: 6f6e 735b 2269 6e70 7574 5f6d 6573 7361  ons["input_messa
+0003d1e0: 6765 225d 2929 0a0a 2020 2020 2020 2020  ge"]))..        
+0003d1f0: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
+0003d200: 6428 2822 7371 7265 6622 2c20 7371 7265  d(("sqref", sqre
+0003d210: 6629 290a 0a20 2020 2020 2020 2069 6620  f))..        if 
+0003d220: 6f70 7469 6f6e 735b 2276 616c 6964 6174  options["validat
+0003d230: 6522 5d20 3d3d 2022 6e6f 6e65 223a 0a20  e"] == "none":. 
+0003d240: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0003d250: 5f78 6d6c 5f65 6d70 7479 5f74 6167 2822  _xml_empty_tag("
+0003d260: 6461 7461 5661 6c69 6461 7469 6f6e 222c  dataValidation",
+0003d270: 2061 7474 7269 6275 7465 7329 0a20 2020   attributes).   
+0003d280: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0003d290: 2020 2020 2020 2073 656c 662e 5f78 6d6c         self._xml
+0003d2a0: 5f73 7461 7274 5f74 6167 2822 6461 7461  _start_tag("data
+0003d2b0: 5661 6c69 6461 7469 6f6e 222c 2061 7474  Validation", att
+0003d2c0: 7269 6275 7465 7329 0a0a 2020 2020 2020  ributes)..      
+0003d2d0: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
+0003d2e0: 6520 666f 726d 756c 6131 2065 6c65 6d65  e formula1 eleme
+0003d2f0: 6e74 2e0a 2020 2020 2020 2020 2020 2020  nt..            
+0003d300: 7365 6c66 2e5f 7772 6974 655f 666f 726d  self._write_form
+0003d310: 756c 615f 3128 6f70 7469 6f6e 735b 2276  ula_1(options["v
+0003d320: 616c 7565 225d 290a 0a20 2020 2020 2020  alue"])..       
+0003d330: 2020 2020 2023 2057 7269 7465 2074 6865       # Write the
+0003d340: 2066 6f72 6d75 6c61 3220 656c 656d 656e   formula2 elemen
+0003d350: 742e 0a20 2020 2020 2020 2020 2020 2069  t..            i
+0003d360: 6620 6f70 7469 6f6e 735b 226d 6178 696d  f options["maxim
+0003d370: 756d 225d 2069 7320 6e6f 7420 4e6f 6e65  um"] is not None
+0003d380: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0003d390: 2020 7365 6c66 2e5f 7772 6974 655f 666f    self._write_fo
+0003d3a0: 726d 756c 615f 3228 6f70 7469 6f6e 735b  rmula_2(options[
+0003d3b0: 226d 6178 696d 756d 225d 290a 0a20 2020  "maximum"])..   
+0003d3c0: 2020 2020 2020 2020 2073 656c 662e 5f78           self._x
+0003d3d0: 6d6c 5f65 6e64 5f74 6167 2822 6461 7461  ml_end_tag("data
+0003d3e0: 5661 6c69 6461 7469 6f6e 2229 0a0a 2020  Validation")..  
+0003d3f0: 2020 6465 6620 5f77 7269 7465 5f66 6f72    def _write_for
+0003d400: 6d75 6c61 5f31 2873 656c 662c 2066 6f72  mula_1(self, for
+0003d410: 6d75 6c61 293a 0a20 2020 2020 2020 2023  mula):.        #
+0003d420: 2057 7269 7465 2074 6865 203c 666f 726d   Write the <form
+0003d430: 756c 6131 3e20 656c 656d 656e 742e 0a0a  ula1> element...
+0003d440: 2020 2020 2020 2020 6966 2074 7970 6528          if type(
+0003d450: 666f 726d 756c 6129 2069 7320 6c69 7374  formula) is list
+0003d460: 3a0a 2020 2020 2020 2020 2020 2020 666f  :.            fo
+0003d470: 726d 756c 6120 3d20 7365 6c66 2e5f 6373  rmula = self._cs
+0003d480: 765f 6a6f 696e 282a 666f 726d 756c 6129  v_join(*formula)
+0003d490: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0003d4a0: 6d75 6c61 203d 2027 2225 7322 2720 2520  mula = '"%s"' % 
+0003d4b0: 666f 726d 756c 610a 2020 2020 2020 2020  formula.        
+0003d4c0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0003d4d0: 2020 2320 4368 6563 6b20 6966 2074 6865    # Check if the
+0003d4e0: 2066 6f72 6d75 6c61 2069 7320 6120 6e75   formula is a nu
+0003d4f0: 6d62 6572 2e0a 2020 2020 2020 2020 2020  mber..          
+0003d500: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+0003d510: 2020 2020 2020 2066 6c6f 6174 2866 6f72         float(for
+0003d520: 6d75 6c61 290a 2020 2020 2020 2020 2020  mula).          
+0003d530: 2020 6578 6365 7074 2056 616c 7565 4572    except ValueEr
+0003d540: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
+0003d550: 2020 2020 2023 204e 6f74 2061 206e 756d       # Not a num
+0003d560: 6265 722e 2052 656d 6f76 6520 7468 6520  ber. Remove the 
+0003d570: 666f 726d 756c 6120 273d 2720 7369 676e  formula '=' sign
+0003d580: 2069 6620 6974 2065 7869 7374 732e 0a20   if it exists.. 
+0003d590: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0003d5a0: 6620 666f 726d 756c 612e 7374 6172 7473  f formula.starts
+0003d5b0: 7769 7468 2822 3d22 293a 0a20 2020 2020  with("="):.     
+0003d5c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0003d5d0: 6f72 6d75 6c61 203d 2066 6f72 6d75 6c61  ormula = formula
+0003d5e0: 2e6c 7374 7269 7028 223d 2229 0a0a 2020  .lstrip("=")..  
+0003d5f0: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
+0003d600: 6461 7461 5f65 6c65 6d65 6e74 2822 666f  data_element("fo
+0003d610: 726d 756c 6131 222c 2066 6f72 6d75 6c61  rmula1", formula
+0003d620: 290a 0a20 2020 2064 6566 205f 7772 6974  )..    def _writ
+0003d630: 655f 666f 726d 756c 615f 3228 7365 6c66  e_formula_2(self
+0003d640: 2c20 666f 726d 756c 6129 3a0a 2020 2020  , formula):.    
+0003d650: 2020 2020 2320 5772 6974 6520 7468 6520      # Write the 
+0003d660: 3c66 6f72 6d75 6c61 323e 2065 6c65 6d65  <formula2> eleme
+0003d670: 6e74 2e0a 0a20 2020 2020 2020 2023 2043  nt...        # C
+0003d680: 6865 636b 2069 6620 7468 6520 666f 726d  heck if the form
+0003d690: 756c 6120 6973 2061 206e 756d 6265 722e  ula is a number.
+0003d6a0: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
+0003d6b0: 2020 2020 2020 2020 2020 666c 6f61 7428            float(
+0003d6c0: 666f 726d 756c 6129 0a20 2020 2020 2020  formula).       
+0003d6d0: 2065 7863 6570 7420 5661 6c75 6545 7272   except ValueErr
+0003d6e0: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+0003d6f0: 2320 4e6f 7420 6120 6e75 6d62 6572 2e20  # Not a number. 
+0003d700: 5265 6d6f 7665 2074 6865 2066 6f72 6d75  Remove the formu
+0003d710: 6c61 2027 3d27 2073 6967 6e20 6966 2069  la '=' sign if i
+0003d720: 7420 6578 6973 7473 2e0a 2020 2020 2020  t exists..      
+0003d730: 2020 2020 2020 6966 2066 6f72 6d75 6c61        if formula
+0003d740: 2e73 7461 7274 7377 6974 6828 223d 2229  .startswith("=")
+0003d750: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0003d760: 2020 666f 726d 756c 6120 3d20 666f 726d    formula = form
+0003d770: 756c 612e 6c73 7472 6970 2822 3d22 290a  ula.lstrip("=").
+0003d780: 0a20 2020 2020 2020 2073 656c 662e 5f78  .        self._x
+0003d790: 6d6c 5f64 6174 615f 656c 656d 656e 7428  ml_data_element(
+0003d7a0: 2266 6f72 6d75 6c61 3222 2c20 666f 726d  "formula2", form
+0003d7b0: 756c 6129 0a0a 2020 2020 6465 6620 5f77  ula)..    def _w
+0003d7c0: 7269 7465 5f63 6f6e 6469 7469 6f6e 616c  rite_conditional
+0003d7d0: 5f66 6f72 6d61 7473 2873 656c 6629 3a0a  _formats(self):.
+0003d7e0: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
+0003d7f0: 7468 6520 576f 726b 7368 6565 7420 636f  the Worksheet co
+0003d800: 6e64 6974 696f 6e61 6c20 666f 726d 6174  nditional format
+0003d810: 732e 0a20 2020 2020 2020 2072 616e 6765  s..        range
+0003d820: 7320 3d20 736f 7274 6564 2873 656c 662e  s = sorted(self.
+0003d830: 636f 6e64 5f66 6f72 6d61 7473 2e6b 6579  cond_formats.key
+0003d840: 7328 2929 0a0a 2020 2020 2020 2020 6966  s())..        if
+0003d850: 206e 6f74 2072 616e 6765 733a 0a20 2020   not ranges:.   
+0003d860: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
+0003d870: 0a20 2020 2020 2020 2066 6f72 2063 6f6e  .        for con
+0003d880: 645f 7261 6e67 6520 696e 2072 616e 6765  d_range in range
+0003d890: 733a 0a20 2020 2020 2020 2020 2020 2073  s:.            s
+0003d8a0: 656c 662e 5f77 7269 7465 5f63 6f6e 6469  elf._write_condi
+0003d8b0: 7469 6f6e 616c 5f66 6f72 6d61 7474 696e  tional_formattin
+0003d8c0: 6728 0a20 2020 2020 2020 2020 2020 2020  g(.             
+0003d8d0: 2020 2063 6f6e 645f 7261 6e67 652c 2073     cond_range, s
+0003d8e0: 656c 662e 636f 6e64 5f66 6f72 6d61 7473  elf.cond_formats
+0003d8f0: 5b63 6f6e 645f 7261 6e67 655d 0a20 2020  [cond_range].   
+0003d900: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0003d910: 6465 6620 5f77 7269 7465 5f63 6f6e 6469  def _write_condi
+0003d920: 7469 6f6e 616c 5f66 6f72 6d61 7474 696e  tional_formattin
+0003d930: 6728 7365 6c66 2c20 636f 6e64 5f72 616e  g(self, cond_ran
+0003d940: 6765 2c20 7061 7261 6d73 293a 0a20 2020  ge, params):.   
+0003d950: 2020 2020 2023 2057 7269 7465 2074 6865       # Write the
+0003d960: 203c 636f 6e64 6974 696f 6e61 6c46 6f72   <conditionalFor
+0003d970: 6d61 7474 696e 673e 2065 6c65 6d65 6e74  matting> element
+0003d980: 2e0a 2020 2020 2020 2020 6174 7472 6962  ..        attrib
+0003d990: 7574 6573 203d 205b 2822 7371 7265 6622  utes = [("sqref"
+0003d9a0: 2c20 636f 6e64 5f72 616e 6765 295d 0a20  , cond_range)]. 
+0003d9b0: 2020 2020 2020 2073 656c 662e 5f78 6d6c         self._xml
+0003d9c0: 5f73 7461 7274 5f74 6167 2822 636f 6e64  _start_tag("cond
+0003d9d0: 6974 696f 6e61 6c46 6f72 6d61 7474 696e  itionalFormattin
+0003d9e0: 6722 2c20 6174 7472 6962 7574 6573 290a  g", attributes).
+0003d9f0: 2020 2020 2020 2020 666f 7220 7061 7261          for para
+0003da00: 6d20 696e 2070 6172 616d 733a 0a20 2020  m in params:.   
+0003da10: 2020 2020 2020 2020 2023 2057 7269 7465           # Write
+0003da20: 2074 6865 2063 6652 756c 6520 656c 656d   the cfRule elem
+0003da30: 656e 742e 0a20 2020 2020 2020 2020 2020  ent..           
+0003da40: 2073 656c 662e 5f77 7269 7465 5f63 665f   self._write_cf_
+0003da50: 7275 6c65 2870 6172 616d 290a 2020 2020  rule(param).    
+0003da60: 2020 2020 7365 6c66 2e5f 786d 6c5f 656e      self._xml_en
+0003da70: 645f 7461 6728 2263 6f6e 6469 7469 6f6e  d_tag("condition
+0003da80: 616c 466f 726d 6174 7469 6e67 2229 0a0a  alFormatting")..
+0003da90: 2020 2020 6465 6620 5f77 7269 7465 5f63      def _write_c
+0003daa0: 665f 7275 6c65 2873 656c 662c 2070 6172  f_rule(self, par
+0003dab0: 616d 7329 3a0a 2020 2020 2020 2020 2320  ams):.        # 
+0003dac0: 5772 6974 6520 7468 6520 3c63 6652 756c  Write the <cfRul
+0003dad0: 653e 2065 6c65 6d65 6e74 2e0a 2020 2020  e> element..    
+0003dae0: 2020 2020 6174 7472 6962 7574 6573 203d      attributes =
+0003daf0: 205b 2822 7479 7065 222c 2070 6172 616d   [("type", param
+0003db00: 735b 2274 7970 6522 5d29 5d0a 0a20 2020  s["type"])]..   
+0003db10: 2020 2020 2069 6620 2266 6f72 6d61 7422       if "format"
+0003db20: 2069 6e20 7061 7261 6d73 2061 6e64 2070   in params and p
+0003db30: 6172 616d 735b 2266 6f72 6d61 7422 5d20  arams["format"] 
+0003db40: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0003db50: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+0003db60: 7465 732e 6170 7065 6e64 2828 2264 7866  tes.append(("dxf
+0003db70: 4964 222c 2070 6172 616d 735b 2266 6f72  Id", params["for
+0003db80: 6d61 7422 5d29 290a 0a20 2020 2020 2020  mat"]))..       
+0003db90: 2061 7474 7269 6275 7465 732e 6170 7065   attributes.appe
+0003dba0: 6e64 2828 2270 7269 6f72 6974 7922 2c20  nd(("priority", 
+0003dbb0: 7061 7261 6d73 5b22 7072 696f 7269 7479  params["priority
+0003dbc0: 225d 2929 0a0a 2020 2020 2020 2020 6966  "]))..        if
+0003dbd0: 2070 6172 616d 732e 6765 7428 2273 746f   params.get("sto
+0003dbe0: 705f 6966 5f74 7275 6522 293a 0a20 2020  p_if_true"):.   
+0003dbf0: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+0003dc00: 7465 732e 6170 7065 6e64 2828 2273 746f  tes.append(("sto
+0003dc10: 7049 6654 7275 6522 2c20 3129 290a 0a20  pIfTrue", 1)).. 
+0003dc20: 2020 2020 2020 2069 6620 7061 7261 6d73         if params
+0003dc30: 5b22 7479 7065 225d 203d 3d20 2263 656c  ["type"] == "cel
+0003dc40: 6c49 7322 3a0a 2020 2020 2020 2020 2020  lIs":.          
+0003dc50: 2020 6174 7472 6962 7574 6573 2e61 7070    attributes.app
+0003dc60: 656e 6428 2822 6f70 6572 6174 6f72 222c  end(("operator",
+0003dc70: 2070 6172 616d 735b 2263 7269 7465 7269   params["criteri
+0003dc80: 6122 5d29 290a 0a20 2020 2020 2020 2020  a"]))..         
+0003dc90: 2020 2073 656c 662e 5f78 6d6c 5f73 7461     self._xml_sta
+0003dca0: 7274 5f74 6167 2822 6366 5275 6c65 222c  rt_tag("cfRule",
+0003dcb0: 2061 7474 7269 6275 7465 7329 0a0a 2020   attributes)..  
+0003dcc0: 2020 2020 2020 2020 2020 6966 2022 6d69            if "mi
+0003dcd0: 6e69 6d75 6d22 2069 6e20 7061 7261 6d73  nimum" in params
+0003dce0: 2061 6e64 2022 6d61 7869 6d75 6d22 2069   and "maximum" i
+0003dcf0: 6e20 7061 7261 6d73 3a0a 2020 2020 2020  n params:.      
+0003dd00: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0003dd10: 7772 6974 655f 666f 726d 756c 615f 656c  write_formula_el
+0003dd20: 656d 656e 7428 7061 7261 6d73 5b22 6d69  ement(params["mi
+0003dd30: 6e69 6d75 6d22 5d29 0a20 2020 2020 2020  nimum"]).       
+0003dd40: 2020 2020 2020 2020 2073 656c 662e 5f77           self._w
+0003dd50: 7269 7465 5f66 6f72 6d75 6c61 5f65 6c65  rite_formula_ele
+0003dd60: 6d65 6e74 2870 6172 616d 735b 226d 6178  ment(params["max
+0003dd70: 696d 756d 225d 290a 2020 2020 2020 2020  imum"]).        
+0003dd80: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0003dd90: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0003dda0: 7772 6974 655f 666f 726d 756c 615f 656c  write_formula_el
+0003ddb0: 656d 656e 7428 7061 7261 6d73 5b22 7661  ement(params["va
+0003ddc0: 6c75 6522 5d29 0a0a 2020 2020 2020 2020  lue"])..        
+0003ddd0: 2020 2020 7365 6c66 2e5f 786d 6c5f 656e      self._xml_en
+0003dde0: 645f 7461 6728 2263 6652 756c 6522 290a  d_tag("cfRule").
+0003ddf0: 0a20 2020 2020 2020 2065 6c69 6620 7061  .        elif pa
+0003de00: 7261 6d73 5b22 7479 7065 225d 203d 3d20  rams["type"] == 
+0003de10: 2261 626f 7665 4176 6572 6167 6522 3a0a  "aboveAverage":.
+0003de20: 2020 2020 2020 2020 2020 2020 6966 2072              if r
+0003de30: 652e 7365 6172 6368 2822 6265 6c6f 7722  e.search("below"
+0003de40: 2c20 7061 7261 6d73 5b22 6372 6974 6572  , params["criter
+0003de50: 6961 225d 293a 0a20 2020 2020 2020 2020  ia"]):.         
+0003de60: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
+0003de70: 732e 6170 7065 6e64 2828 2261 626f 7665  s.append(("above
+0003de80: 4176 6572 6167 6522 2c20 3029 290a 0a20  Average", 0)).. 
+0003de90: 2020 2020 2020 2020 2020 2069 6620 7265             if re
+0003dea0: 2e73 6561 7263 6828 2265 7175 616c 222c  .search("equal",
+0003deb0: 2070 6172 616d 735b 2263 7269 7465 7269   params["criteri
+0003dec0: 6122 5d29 3a0a 2020 2020 2020 2020 2020  a"]):.          
+0003ded0: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
+0003dee0: 2e61 7070 656e 6428 2822 6571 7561 6c41  .append(("equalA
+0003def0: 7665 7261 6765 222c 2031 2929 0a0a 2020  verage", 1))..  
+0003df00: 2020 2020 2020 2020 2020 6966 2072 652e            if re.
+0003df10: 7365 6172 6368 2822 5b31 3233 5d20 7374  search("[123] st
+0003df20: 6420 6465 7622 2c20 7061 7261 6d73 5b22  d dev", params["
+0003df30: 6372 6974 6572 6961 225d 293a 0a20 2020  criteria"]):.   
+0003df40: 2020 2020 2020 2020 2020 2020 206d 6174               mat
+0003df50: 6368 203d 2072 652e 7365 6172 6368 2822  ch = re.search("
+0003df60: 285b 3132 335d 2920 7374 6420 6465 7622  ([123]) std dev"
+0003df70: 2c20 7061 7261 6d73 5b22 6372 6974 6572  , params["criter
+0003df80: 6961 225d 290a 2020 2020 2020 2020 2020  ia"]).          
+0003df90: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
+0003dfa0: 2e61 7070 656e 6428 2822 7374 6444 6576  .append(("stdDev
+0003dfb0: 222c 206d 6174 6368 2e67 726f 7570 2831  ", match.group(1
+0003dfc0: 2929 290a 0a20 2020 2020 2020 2020 2020  )))..           
+0003dfd0: 2073 656c 662e 5f78 6d6c 5f65 6d70 7479   self._xml_empty
+0003dfe0: 5f74 6167 2822 6366 5275 6c65 222c 2061  _tag("cfRule", a
+0003dff0: 7474 7269 6275 7465 7329 0a0a 2020 2020  ttributes)..    
+0003e000: 2020 2020 656c 6966 2070 6172 616d 735b      elif params[
+0003e010: 2274 7970 6522 5d20 3d3d 2022 746f 7031  "type"] == "top1
+0003e020: 3022 3a0a 2020 2020 2020 2020 2020 2020  0":.            
+0003e030: 6966 2022 6372 6974 6572 6961 2220 696e  if "criteria" in
+0003e040: 2070 6172 616d 7320 616e 6420 7061 7261   params and para
+0003e050: 6d73 5b22 6372 6974 6572 6961 225d 203d  ms["criteria"] =
+0003e060: 3d20 2225 223a 0a20 2020 2020 2020 2020  = "%":.         
+0003e070: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
+0003e080: 732e 6170 7065 6e64 2828 2270 6572 6365  s.append(("perce
+0003e090: 6e74 222c 2031 2929 0a0a 2020 2020 2020  nt", 1))..      
+0003e0a0: 2020 2020 2020 6966 2022 6469 7265 6374        if "direct
+0003e0b0: 696f 6e22 2069 6e20 7061 7261 6d73 3a0a  ion" in params:.
+0003e0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e0d0: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
+0003e0e0: 6428 2822 626f 7474 6f6d 222c 2031 2929  d(("bottom", 1))
+0003e0f0: 0a0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+0003e100: 6e6b 203d 2070 6172 616d 735b 2276 616c  nk = params["val
+0003e110: 7565 225d 206f 7220 3130 0a20 2020 2020  ue"] or 10.     
+0003e120: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
+0003e130: 732e 6170 7065 6e64 2828 2272 616e 6b22  s.append(("rank"
+0003e140: 2c20 7261 6e6b 2929 0a0a 2020 2020 2020  , rank))..      
+0003e150: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
+0003e160: 656d 7074 795f 7461 6728 2263 6652 756c  empty_tag("cfRul
+0003e170: 6522 2c20 6174 7472 6962 7574 6573 290a  e", attributes).
+0003e180: 0a20 2020 2020 2020 2065 6c69 6620 7061  .        elif pa
+0003e190: 7261 6d73 5b22 7479 7065 225d 203d 3d20  rams["type"] == 
+0003e1a0: 2264 7570 6c69 6361 7465 5661 6c75 6573  "duplicateValues
+0003e1b0: 223a 0a20 2020 2020 2020 2020 2020 2073  ":.            s
+0003e1c0: 656c 662e 5f78 6d6c 5f65 6d70 7479 5f74  elf._xml_empty_t
+0003e1d0: 6167 2822 6366 5275 6c65 222c 2061 7474  ag("cfRule", att
+0003e1e0: 7269 6275 7465 7329 0a0a 2020 2020 2020  ributes)..      
+0003e1f0: 2020 656c 6966 2070 6172 616d 735b 2274    elif params["t
+0003e200: 7970 6522 5d20 3d3d 2022 756e 6971 7565  ype"] == "unique
+0003e210: 5661 6c75 6573 223a 0a20 2020 2020 2020  Values":.       
+0003e220: 2020 2020 2073 656c 662e 5f78 6d6c 5f65       self._xml_e
+0003e230: 6d70 7479 5f74 6167 2822 6366 5275 6c65  mpty_tag("cfRule
+0003e240: 222c 2061 7474 7269 6275 7465 7329 0a0a  ", attributes)..
+0003e250: 2020 2020 2020 2020 656c 6966 2028 0a20          elif (. 
+0003e260: 2020 2020 2020 2020 2020 2070 6172 616d             param
+0003e270: 735b 2274 7970 6522 5d20 3d3d 2022 636f  s["type"] == "co
+0003e280: 6e74 6169 6e73 5465 7874 220a 2020 2020  ntainsText".    
+0003e290: 2020 2020 2020 2020 6f72 2070 6172 616d          or param
+0003e2a0: 735b 2274 7970 6522 5d20 3d3d 2022 6e6f  s["type"] == "no
+0003e2b0: 7443 6f6e 7461 696e 7354 6578 7422 0a20  tContainsText". 
+0003e2c0: 2020 2020 2020 2020 2020 206f 7220 7061             or pa
+0003e2d0: 7261 6d73 5b22 7479 7065 225d 203d 3d20  rams["type"] == 
+0003e2e0: 2262 6567 696e 7357 6974 6822 0a20 2020  "beginsWith".   
+0003e2f0: 2020 2020 2020 2020 206f 7220 7061 7261           or para
+0003e300: 6d73 5b22 7479 7065 225d 203d 3d20 2265  ms["type"] == "e
+0003e310: 6e64 7357 6974 6822 0a20 2020 2020 2020  ndsWith".       
+0003e320: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+0003e330: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
+0003e340: 6428 2822 6f70 6572 6174 6f72 222c 2070  d(("operator", p
+0003e350: 6172 616d 735b 2263 7269 7465 7269 6122  arams["criteria"
+0003e360: 5d29 290a 2020 2020 2020 2020 2020 2020  ])).            
+0003e370: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
+0003e380: 6428 2822 7465 7874 222c 2070 6172 616d  d(("text", param
+0003e390: 735b 2276 616c 7565 225d 2929 0a20 2020  s["value"])).   
+0003e3a0: 2020 2020 2020 2020 2073 656c 662e 5f78           self._x
+0003e3b0: 6d6c 5f73 7461 7274 5f74 6167 2822 6366  ml_start_tag("cf
+0003e3c0: 5275 6c65 222c 2061 7474 7269 6275 7465  Rule", attribute
+0003e3d0: 7329 0a20 2020 2020 2020 2020 2020 2073  s).            s
+0003e3e0: 656c 662e 5f77 7269 7465 5f66 6f72 6d75  elf._write_formu
+0003e3f0: 6c61 5f65 6c65 6d65 6e74 2870 6172 616d  la_element(param
+0003e400: 735b 2266 6f72 6d75 6c61 225d 290a 2020  s["formula"]).  
+0003e410: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0003e420: 786d 6c5f 656e 645f 7461 6728 2263 6652  xml_end_tag("cfR
+0003e430: 756c 6522 290a 0a20 2020 2020 2020 2065  ule")..        e
+0003e440: 6c69 6620 7061 7261 6d73 5b22 7479 7065  lif params["type
+0003e450: 225d 203d 3d20 2274 696d 6550 6572 696f  "] == "timePerio
+0003e460: 6422 3a0a 2020 2020 2020 2020 2020 2020  d":.            
+0003e470: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
+0003e480: 6428 2822 7469 6d65 5065 7269 6f64 222c  d(("timePeriod",
+0003e490: 2070 6172 616d 735b 2263 7269 7465 7269   params["criteri
+0003e4a0: 6122 5d29 290a 2020 2020 2020 2020 2020  a"])).          
+0003e4b0: 2020 7365 6c66 2e5f 786d 6c5f 7374 6172    self._xml_star
+0003e4c0: 745f 7461 6728 2263 6652 756c 6522 2c20  t_tag("cfRule", 
+0003e4d0: 6174 7472 6962 7574 6573 290a 2020 2020  attributes).    
+0003e4e0: 2020 2020 2020 2020 7365 6c66 2e5f 7772          self._wr
+0003e4f0: 6974 655f 666f 726d 756c 615f 656c 656d  ite_formula_elem
+0003e500: 656e 7428 7061 7261 6d73 5b22 666f 726d  ent(params["form
+0003e510: 756c 6122 5d29 0a20 2020 2020 2020 2020  ula"]).         
+0003e520: 2020 2073 656c 662e 5f78 6d6c 5f65 6e64     self._xml_end
+0003e530: 5f74 6167 2822 6366 5275 6c65 2229 0a0a  _tag("cfRule")..
+0003e540: 2020 2020 2020 2020 656c 6966 2028 0a20          elif (. 
+0003e550: 2020 2020 2020 2020 2020 2070 6172 616d             param
+0003e560: 735b 2274 7970 6522 5d20 3d3d 2022 636f  s["type"] == "co
+0003e570: 6e74 6169 6e73 426c 616e 6b73 220a 2020  ntainsBlanks".  
+0003e580: 2020 2020 2020 2020 2020 6f72 2070 6172            or par
+0003e590: 616d 735b 2274 7970 6522 5d20 3d3d 2022  ams["type"] == "
+0003e5a0: 6e6f 7443 6f6e 7461 696e 7342 6c61 6e6b  notContainsBlank
+0003e5b0: 7322 0a20 2020 2020 2020 2020 2020 206f  s".            o
+0003e5c0: 7220 7061 7261 6d73 5b22 7479 7065 225d  r params["type"]
+0003e5d0: 203d 3d20 2263 6f6e 7461 696e 7345 7272   == "containsErr
+0003e5e0: 6f72 7322 0a20 2020 2020 2020 2020 2020  ors".           
+0003e5f0: 206f 7220 7061 7261 6d73 5b22 7479 7065   or params["type
+0003e600: 225d 203d 3d20 226e 6f74 436f 6e74 6169  "] == "notContai
+0003e610: 6e73 4572 726f 7273 220a 2020 2020 2020  nsErrors".      
+0003e620: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+0003e630: 2073 656c 662e 5f78 6d6c 5f73 7461 7274   self._xml_start
+0003e640: 5f74 6167 2822 6366 5275 6c65 222c 2061  _tag("cfRule", a
+0003e650: 7474 7269 6275 7465 7329 0a20 2020 2020  ttributes).     
+0003e660: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
+0003e670: 7465 5f66 6f72 6d75 6c61 5f65 6c65 6d65  te_formula_eleme
+0003e680: 6e74 2870 6172 616d 735b 2266 6f72 6d75  nt(params["formu
+0003e690: 6c61 225d 290a 2020 2020 2020 2020 2020  la"]).          
+0003e6a0: 2020 7365 6c66 2e5f 786d 6c5f 656e 645f    self._xml_end_
+0003e6b0: 7461 6728 2263 6652 756c 6522 290a 0a20  tag("cfRule").. 
+0003e6c0: 2020 2020 2020 2065 6c69 6620 7061 7261         elif para
+0003e6d0: 6d73 5b22 7479 7065 225d 203d 3d20 2263  ms["type"] == "c
+0003e6e0: 6f6c 6f72 5363 616c 6522 3a0a 2020 2020  olorScale":.    
+0003e6f0: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
+0003e700: 6c5f 7374 6172 745f 7461 6728 2263 6652  l_start_tag("cfR
+0003e710: 756c 6522 2c20 6174 7472 6962 7574 6573  ule", attributes
+0003e720: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
+0003e730: 6c66 2e5f 7772 6974 655f 636f 6c6f 725f  lf._write_color_
+0003e740: 7363 616c 6528 7061 7261 6d73 290a 2020  scale(params).  
+0003e750: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0003e760: 786d 6c5f 656e 645f 7461 6728 2263 6652  xml_end_tag("cfR
+0003e770: 756c 6522 290a 0a20 2020 2020 2020 2065  ule")..        e
+0003e780: 6c69 6620 7061 7261 6d73 5b22 7479 7065  lif params["type
+0003e790: 225d 203d 3d20 2264 6174 6142 6172 223a  "] == "dataBar":
+0003e7a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0003e7b0: 662e 5f78 6d6c 5f73 7461 7274 5f74 6167  f._xml_start_tag
+0003e7c0: 2822 6366 5275 6c65 222c 2061 7474 7269  ("cfRule", attri
+0003e7d0: 6275 7465 7329 0a20 2020 2020 2020 2020  butes).         
+0003e7e0: 2020 2073 656c 662e 5f77 7269 7465 5f64     self._write_d
+0003e7f0: 6174 615f 6261 7228 7061 7261 6d73 290a  ata_bar(params).
+0003e800: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0003e810: 7061 7261 6d73 2e67 6574 2822 6973 5f64  params.get("is_d
+0003e820: 6174 615f 6261 725f 3230 3130 2229 3a0a  ata_bar_2010"):.
+0003e830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e840: 7365 6c66 2e5f 7772 6974 655f 6461 7461  self._write_data
+0003e850: 5f62 6172 5f65 7874 2870 6172 616d 7329  _bar_ext(params)
+0003e860: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+0003e870: 6c66 2e5f 786d 6c5f 656e 645f 7461 6728  lf._xml_end_tag(
+0003e880: 2263 6652 756c 6522 290a 0a20 2020 2020  "cfRule")..     
+0003e890: 2020 2065 6c69 6620 7061 7261 6d73 5b22     elif params["
+0003e8a0: 7479 7065 225d 203d 3d20 2265 7870 7265  type"] == "expre
+0003e8b0: 7373 696f 6e22 3a0a 2020 2020 2020 2020  ssion":.        
+0003e8c0: 2020 2020 7365 6c66 2e5f 786d 6c5f 7374      self._xml_st
+0003e8d0: 6172 745f 7461 6728 2263 6652 756c 6522  art_tag("cfRule"
+0003e8e0: 2c20 6174 7472 6962 7574 6573 290a 2020  , attributes).  
+0003e8f0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0003e900: 7772 6974 655f 666f 726d 756c 615f 656c  write_formula_el
+0003e910: 656d 656e 7428 7061 7261 6d73 5b22 6372  ement(params["cr
+0003e920: 6974 6572 6961 225d 290a 2020 2020 2020  iteria"]).      
+0003e930: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
+0003e940: 656e 645f 7461 6728 2263 6652 756c 6522  end_tag("cfRule"
+0003e950: 290a 0a20 2020 2020 2020 2065 6c69 6620  )..        elif 
+0003e960: 7061 7261 6d73 5b22 7479 7065 225d 203d  params["type"] =
+0003e970: 3d20 2269 636f 6e53 6574 223a 0a20 2020  = "iconSet":.   
+0003e980: 2020 2020 2020 2020 2073 656c 662e 5f78           self._x
+0003e990: 6d6c 5f73 7461 7274 5f74 6167 2822 6366  ml_start_tag("cf
+0003e9a0: 5275 6c65 222c 2061 7474 7269 6275 7465  Rule", attribute
+0003e9b0: 7329 0a20 2020 2020 2020 2020 2020 2073  s).            s
+0003e9c0: 656c 662e 5f77 7269 7465 5f69 636f 6e5f  elf._write_icon_
+0003e9d0: 7365 7428 7061 7261 6d73 290a 2020 2020  set(params).    
+0003e9e0: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
+0003e9f0: 6c5f 656e 645f 7461 6728 2263 6652 756c  l_end_tag("cfRul
+0003ea00: 6522 290a 0a20 2020 2064 6566 205f 7772  e")..    def _wr
+0003ea10: 6974 655f 666f 726d 756c 615f 656c 656d  ite_formula_elem
+0003ea20: 656e 7428 7365 6c66 2c20 666f 726d 756c  ent(self, formul
+0003ea30: 6129 3a0a 2020 2020 2020 2020 2320 5772  a):.        # Wr
+0003ea40: 6974 6520 7468 6520 3c66 6f72 6d75 6c61  ite the <formula
+0003ea50: 3e20 656c 656d 656e 742e 0a0a 2020 2020  > element...    
+0003ea60: 2020 2020 2320 4368 6563 6b20 6966 2074      # Check if t
+0003ea70: 6865 2066 6f72 6d75 6c61 2069 7320 6120  he formula is a 
+0003ea80: 6e75 6d62 6572 2e0a 2020 2020 2020 2020  number..        
+0003ea90: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+0003eaa0: 2066 6c6f 6174 2866 6f72 6d75 6c61 290a   float(formula).
+0003eab0: 2020 2020 2020 2020 6578 6365 7074 2056          except V
+0003eac0: 616c 7565 4572 726f 723a 0a20 2020 2020  alueError:.     
+0003ead0: 2020 2020 2020 2023 204e 6f74 2061 206e         # Not a n
+0003eae0: 756d 6265 722e 2052 656d 6f76 6520 7468  umber. Remove th
+0003eaf0: 6520 666f 726d 756c 6120 273d 2720 7369  e formula '=' si
+0003eb00: 676e 2069 6620 6974 2065 7869 7374 732e  gn if it exists.
+0003eb10: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0003eb20: 666f 726d 756c 612e 7374 6172 7473 7769  formula.startswi
+0003eb30: 7468 2822 3d22 293a 0a20 2020 2020 2020  th("="):.       
+0003eb40: 2020 2020 2020 2020 2066 6f72 6d75 6c61           formula
+0003eb50: 203d 2066 6f72 6d75 6c61 2e6c 7374 7269   = formula.lstri
+0003eb60: 7028 223d 2229 0a0a 2020 2020 2020 2020  p("=")..        
+0003eb70: 7365 6c66 2e5f 786d 6c5f 6461 7461 5f65  self._xml_data_e
+0003eb80: 6c65 6d65 6e74 2822 666f 726d 756c 6122  lement("formula"
+0003eb90: 2c20 666f 726d 756c 6129 0a0a 2020 2020  , formula)..    
+0003eba0: 6465 6620 5f77 7269 7465 5f63 6f6c 6f72  def _write_color
+0003ebb0: 5f73 6361 6c65 2873 656c 662c 2070 6172  _scale(self, par
+0003ebc0: 616d 293a 0a20 2020 2020 2020 2023 2057  am):.        # W
+0003ebd0: 7269 7465 2074 6865 203c 636f 6c6f 7253  rite the <colorS
+0003ebe0: 6361 6c65 3e20 656c 656d 656e 742e 0a0a  cale> element...
+0003ebf0: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
+0003ec00: 6c5f 7374 6172 745f 7461 6728 2263 6f6c  l_start_tag("col
+0003ec10: 6f72 5363 616c 6522 290a 0a20 2020 2020  orScale")..     
+0003ec20: 2020 2073 656c 662e 5f77 7269 7465 5f63     self._write_c
+0003ec30: 6676 6f28 7061 7261 6d5b 226d 696e 5f74  fvo(param["min_t
+0003ec40: 7970 6522 5d2c 2070 6172 616d 5b22 6d69  ype"], param["mi
+0003ec50: 6e5f 7661 6c75 6522 5d29 0a0a 2020 2020  n_value"])..    
+0003ec60: 2020 2020 6966 2070 6172 616d 5b22 6d69      if param["mi
+0003ec70: 645f 7479 7065 225d 2069 7320 6e6f 7420  d_type"] is not 
+0003ec80: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0003ec90: 2020 7365 6c66 2e5f 7772 6974 655f 6366    self._write_cf
+0003eca0: 766f 2870 6172 616d 5b22 6d69 645f 7479  vo(param["mid_ty
+0003ecb0: 7065 225d 2c20 7061 7261 6d5b 226d 6964  pe"], param["mid
+0003ecc0: 5f76 616c 7565 225d 290a 0a20 2020 2020  _value"])..     
+0003ecd0: 2020 2073 656c 662e 5f77 7269 7465 5f63     self._write_c
+0003ece0: 6676 6f28 7061 7261 6d5b 226d 6178 5f74  fvo(param["max_t
+0003ecf0: 7970 6522 5d2c 2070 6172 616d 5b22 6d61  ype"], param["ma
+0003ed00: 785f 7661 6c75 6522 5d29 0a0a 2020 2020  x_value"])..    
+0003ed10: 2020 2020 7365 6c66 2e5f 7772 6974 655f      self._write_
+0003ed20: 636f 6c6f 7228 2272 6762 222c 2070 6172  color("rgb", par
+0003ed30: 616d 5b22 6d69 6e5f 636f 6c6f 7222 5d29  am["min_color"])
+0003ed40: 0a0a 2020 2020 2020 2020 6966 2070 6172  ..        if par
+0003ed50: 616d 5b22 6d69 645f 636f 6c6f 7222 5d20  am["mid_color"] 
+0003ed60: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0003ed70: 2020 2020 2020 2020 2073 656c 662e 5f77           self._w
+0003ed80: 7269 7465 5f63 6f6c 6f72 2822 7267 6222  rite_color("rgb"
+0003ed90: 2c20 7061 7261 6d5b 226d 6964 5f63 6f6c  , param["mid_col
+0003eda0: 6f72 225d 290a 0a20 2020 2020 2020 2073  or"])..        s
+0003edb0: 656c 662e 5f77 7269 7465 5f63 6f6c 6f72  elf._write_color
+0003edc0: 2822 7267 6222 2c20 7061 7261 6d5b 226d  ("rgb", param["m
+0003edd0: 6178 5f63 6f6c 6f72 225d 290a 0a20 2020  ax_color"])..   
+0003ede0: 2020 2020 2073 656c 662e 5f78 6d6c 5f65       self._xml_e
+0003edf0: 6e64 5f74 6167 2822 636f 6c6f 7253 6361  nd_tag("colorSca
+0003ee00: 6c65 2229 0a0a 2020 2020 6465 6620 5f77  le")..    def _w
+0003ee10: 7269 7465 5f64 6174 615f 6261 7228 7365  rite_data_bar(se
+0003ee20: 6c66 2c20 7061 7261 6d29 3a0a 2020 2020  lf, param):.    
+0003ee30: 2020 2020 2320 5772 6974 6520 7468 6520      # Write the 
+0003ee40: 3c64 6174 6142 6172 3e20 656c 656d 656e  <dataBar> elemen
+0003ee50: 742e 0a20 2020 2020 2020 2061 7474 7269  t..        attri
+0003ee60: 6275 7465 7320 3d20 5b5d 0a0a 2020 2020  butes = []..    
+0003ee70: 2020 2020 2320 4d69 6e20 616e 6420 6d61      # Min and ma
+0003ee80: 7820 6261 7220 6c65 6e67 7468 7320 696e  x bar lengths in
+0003ee90: 2069 6e20 7468 6520 7370 6563 2062 7574   in the spec but
+0003eea0: 206e 6f74 2073 7570 706f 7274 6564 2064   not supported d
+0003eeb0: 6972 6563 746c 7920 6279 0a20 2020 2020  irectly by.     
+0003eec0: 2020 2023 2045 7863 656c 2e0a 2020 2020     # Excel..    
+0003eed0: 2020 2020 6966 2070 6172 616d 2e67 6574      if param.get
+0003eee0: 2822 6d69 6e5f 6c65 6e67 7468 2229 3a0a  ("min_length"):.
+0003eef0: 2020 2020 2020 2020 2020 2020 6174 7472              attr
+0003ef00: 6962 7574 6573 2e61 7070 656e 6428 2822  ibutes.append(("
+0003ef10: 6d69 6e4c 656e 6774 6822 2c20 7061 7261  minLength", para
+0003ef20: 6d5b 226d 696e 5f6c 656e 6774 6822 5d29  m["min_length"])
+0003ef30: 290a 0a20 2020 2020 2020 2069 6620 7061  )..        if pa
+0003ef40: 7261 6d2e 6765 7428 226d 6178 5f6c 656e  ram.get("max_len
+0003ef50: 6774 6822 293a 0a20 2020 2020 2020 2020  gth"):.         
+0003ef60: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
+0003ef70: 7065 6e64 2828 226d 6178 4c65 6e67 7468  pend(("maxLength
+0003ef80: 222c 2070 6172 616d 5b22 6d61 785f 6c65  ", param["max_le
+0003ef90: 6e67 7468 225d 2929 0a0a 2020 2020 2020  ngth"]))..      
+0003efa0: 2020 6966 2070 6172 616d 2e67 6574 2822    if param.get("
+0003efb0: 6261 725f 6f6e 6c79 2229 3a0a 2020 2020  bar_only"):.    
+0003efc0: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
+0003efd0: 6573 2e61 7070 656e 6428 2822 7368 6f77  es.append(("show
+0003efe0: 5661 6c75 6522 2c20 3029 290a 0a20 2020  Value", 0))..   
+0003eff0: 2020 2020 2073 656c 662e 5f78 6d6c 5f73       self._xml_s
+0003f000: 7461 7274 5f74 6167 2822 6461 7461 4261  tart_tag("dataBa
+0003f010: 7222 2c20 6174 7472 6962 7574 6573 290a  r", attributes).
+0003f020: 0a20 2020 2020 2020 2073 656c 662e 5f77  .        self._w
+0003f030: 7269 7465 5f63 6676 6f28 7061 7261 6d5b  rite_cfvo(param[
+0003f040: 226d 696e 5f74 7970 6522 5d2c 2070 6172  "min_type"], par
+0003f050: 616d 5b22 6d69 6e5f 7661 6c75 6522 5d29  am["min_value"])
+0003f060: 0a20 2020 2020 2020 2073 656c 662e 5f77  .        self._w
+0003f070: 7269 7465 5f63 6676 6f28 7061 7261 6d5b  rite_cfvo(param[
+0003f080: 226d 6178 5f74 7970 6522 5d2c 2070 6172  "max_type"], par
+0003f090: 616d 5b22 6d61 785f 7661 6c75 6522 5d29  am["max_value"])
+0003f0a0: 0a20 2020 2020 2020 2073 656c 662e 5f77  .        self._w
+0003f0b0: 7269 7465 5f63 6f6c 6f72 2822 7267 6222  rite_color("rgb"
+0003f0c0: 2c20 7061 7261 6d5b 2262 6172 5f63 6f6c  , param["bar_col
+0003f0d0: 6f72 225d 290a 0a20 2020 2020 2020 2073  or"])..        s
+0003f0e0: 656c 662e 5f78 6d6c 5f65 6e64 5f74 6167  elf._xml_end_tag
+0003f0f0: 2822 6461 7461 4261 7222 290a 0a20 2020  ("dataBar")..   
+0003f100: 2064 6566 205f 7772 6974 655f 6461 7461   def _write_data
+0003f110: 5f62 6172 5f65 7874 2873 656c 662c 2070  _bar_ext(self, p
+0003f120: 6172 616d 293a 0a20 2020 2020 2020 2023  aram):.        #
+0003f130: 2057 7269 7465 2074 6865 203c 6578 744c   Write the <extL
+0003f140: 7374 3e20 6461 7461 4261 7220 6578 7465  st> dataBar exte
+0003f150: 6e73 696f 6e20 656c 656d 656e 742e 0a0a  nsion element...
+0003f160: 2020 2020 2020 2020 2320 4372 6561 7465          # Create
+0003f170: 2061 2070 7365 7564 6f20 4755 4944 2066   a pseudo GUID f
+0003f180: 6f72 2065 6163 6820 756e 6971 7565 2045  or each unique E
+0003f190: 7863 656c 2032 3031 3020 6461 7461 2062  xcel 2010 data b
+0003f1a0: 6172 2e0a 2020 2020 2020 2020 776f 726b  ar..        work
+0003f1b0: 7368 6565 745f 636f 756e 7420 3d20 7365  sheet_count = se
+0003f1c0: 6c66 2e69 6e64 6578 202b 2031 0a20 2020  lf.index + 1.   
+0003f1d0: 2020 2020 2064 6174 615f 6261 725f 636f       data_bar_co
+0003f1e0: 756e 7420 3d20 6c65 6e28 7365 6c66 2e64  unt = len(self.d
+0003f1f0: 6174 615f 6261 7273 5f32 3031 3029 202b  ata_bars_2010) +
+0003f200: 2031 0a20 2020 2020 2020 2067 7569 6420   1.        guid 
+0003f210: 3d20 227b 4441 3741 4241 3531 2d41 4141  = "{DA7ABA51-AAA
+0003f220: 412d 4242 4242 2d25 3034 582d 2530 3132  A-BBBB-%04X-%012
+0003f230: 587d 2220 2520 2877 6f72 6b73 6865 6574  X}" % (worksheet
+0003f240: 5f63 6f75 6e74 2c20 6461 7461 5f62 6172  _count, data_bar
+0003f250: 5f63 6f75 6e74 290a 0a20 2020 2020 2020  _count)..       
+0003f260: 2023 2053 746f 7265 2074 6865 2032 3031   # Store the 201
+0003f270: 3020 6461 7461 2062 6172 2070 6172 616d  0 data bar param
+0003f280: 6574 6572 7320 746f 2077 7269 7465 2074  eters to write t
+0003f290: 6865 2065 7874 4c73 7420 656c 656d 656e  he extLst elemen
+0003f2a0: 7473 2e0a 2020 2020 2020 2020 7061 7261  ts..        para
+0003f2b0: 6d5b 2267 7569 6422 5d20 3d20 6775 6964  m["guid"] = guid
+0003f2c0: 0a20 2020 2020 2020 2073 656c 662e 6461  .        self.da
+0003f2d0: 7461 5f62 6172 735f 3230 3130 2e61 7070  ta_bars_2010.app
+0003f2e0: 656e 6428 7061 7261 6d29 0a0a 2020 2020  end(param)..    
+0003f2f0: 2020 2020 7365 6c66 2e5f 786d 6c5f 7374      self._xml_st
+0003f300: 6172 745f 7461 6728 2265 7874 4c73 7422  art_tag("extLst"
+0003f310: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
+0003f320: 7772 6974 655f 6578 7428 227b 4230 3235  write_ext("{B025
+0003f330: 4639 3337 2d43 3742 312d 3437 4433 2d42  F937-C7B1-47D3-B
+0003f340: 3637 462d 4136 3245 4646 3636 3645 3345  67F-A62EFF666E3E
+0003f350: 7d22 290a 2020 2020 2020 2020 7365 6c66  }").        self
+0003f360: 2e5f 786d 6c5f 6461 7461 5f65 6c65 6d65  ._xml_data_eleme
+0003f370: 6e74 2822 7831 343a 6964 222c 2067 7569  nt("x14:id", gui
+0003f380: 6429 0a20 2020 2020 2020 2073 656c 662e  d).        self.
+0003f390: 5f78 6d6c 5f65 6e64 5f74 6167 2822 6578  _xml_end_tag("ex
+0003f3a0: 7422 290a 2020 2020 2020 2020 7365 6c66  t").        self
+0003f3b0: 2e5f 786d 6c5f 656e 645f 7461 6728 2265  ._xml_end_tag("e
+0003f3c0: 7874 4c73 7422 290a 0a20 2020 2064 6566  xtLst")..    def
+0003f3d0: 205f 7772 6974 655f 6963 6f6e 5f73 6574   _write_icon_set
+0003f3e0: 2873 656c 662c 2070 6172 616d 293a 0a20  (self, param):. 
+0003f3f0: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
+0003f400: 6865 203c 6963 6f6e 5365 743e 2065 6c65  he <iconSet> ele
+0003f410: 6d65 6e74 2e0a 2020 2020 2020 2020 6174  ment..        at
+0003f420: 7472 6962 7574 6573 203d 205b 5d0a 0a20  tributes = [].. 
+0003f430: 2020 2020 2020 2023 2044 6f6e 2774 2073         # Don't s
+0003f440: 6574 2061 7474 7269 6275 7465 2066 6f72  et attribute for
+0003f450: 2064 6566 6175 6c74 2073 7479 6c65 2e0a   default style..
+0003f460: 2020 2020 2020 2020 6966 2070 6172 616d          if param
+0003f470: 5b22 6963 6f6e 5f73 7479 6c65 225d 2021  ["icon_style"] !
+0003f480: 3d20 2233 5472 6166 6669 634c 6967 6874  = "3TrafficLight
+0003f490: 7322 3a0a 2020 2020 2020 2020 2020 2020  s":.            
+0003f4a0: 6174 7472 6962 7574 6573 203d 205b 2822  attributes = [("
+0003f4b0: 6963 6f6e 5365 7422 2c20 7061 7261 6d5b  iconSet", param[
+0003f4c0: 2269 636f 6e5f 7374 796c 6522 5d29 5d0a  "icon_style"])].
+0003f4d0: 0a20 2020 2020 2020 2069 6620 7061 7261  .        if para
+0003f4e0: 6d2e 6765 7428 2269 636f 6e73 5f6f 6e6c  m.get("icons_onl
+0003f4f0: 7922 293a 0a20 2020 2020 2020 2020 2020  y"):.           
+0003f500: 2061 7474 7269 6275 7465 732e 6170 7065   attributes.appe
+0003f510: 6e64 2828 2273 686f 7756 616c 7565 222c  nd(("showValue",
+0003f520: 2030 2929 0a0a 2020 2020 2020 2020 6966   0))..        if
+0003f530: 2070 6172 616d 2e67 6574 2822 7265 7665   param.get("reve
+0003f540: 7273 655f 6963 6f6e 7322 293a 0a20 2020  rse_icons"):.   
+0003f550: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+0003f560: 7465 732e 6170 7065 6e64 2828 2272 6576  tes.append(("rev
+0003f570: 6572 7365 222c 2031 2929 0a0a 2020 2020  erse", 1))..    
+0003f580: 2020 2020 7365 6c66 2e5f 786d 6c5f 7374      self._xml_st
+0003f590: 6172 745f 7461 6728 2269 636f 6e53 6574  art_tag("iconSet
+0003f5a0: 222c 2061 7474 7269 6275 7465 7329 0a0a  ", attributes)..
+0003f5b0: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
+0003f5c0: 7468 6520 7072 6f70 6572 7469 6573 2066  the properties f
+0003f5d0: 6f72 2064 6966 6665 7265 6e74 2069 636f  or different ico
+0003f5e0: 6e20 7374 796c 6573 2e0a 2020 2020 2020  n styles..      
+0003f5f0: 2020 666f 7220 6963 6f6e 2069 6e20 7265    for icon in re
+0003f600: 7665 7273 6564 2870 6172 616d 5b22 6963  versed(param["ic
+0003f610: 6f6e 7322 5d29 3a0a 2020 2020 2020 2020  ons"]):.        
+0003f620: 2020 2020 7365 6c66 2e5f 7772 6974 655f      self._write_
+0003f630: 6366 766f 2869 636f 6e5b 2274 7970 6522  cfvo(icon["type"
+0003f640: 5d2c 2069 636f 6e5b 2276 616c 7565 225d  ], icon["value"]
+0003f650: 2c20 6963 6f6e 5b22 6372 6974 6572 6961  , icon["criteria
+0003f660: 225d 290a 0a20 2020 2020 2020 2073 656c  "])..        sel
+0003f670: 662e 5f78 6d6c 5f65 6e64 5f74 6167 2822  f._xml_end_tag("
+0003f680: 6963 6f6e 5365 7422 290a 0a20 2020 2064  iconSet")..    d
+0003f690: 6566 205f 7772 6974 655f 6366 766f 2873  ef _write_cfvo(s
+0003f6a0: 656c 662c 2063 665f 7479 7065 2c20 7661  elf, cf_type, va
+0003f6b0: 6c2c 2063 7269 7465 7269 613d 4e6f 6e65  l, criteria=None
+0003f6c0: 293a 0a20 2020 2020 2020 2023 2057 7269  ):.        # Wri
+0003f6d0: 7465 2074 6865 203c 6366 766f 3e20 656c  te the <cfvo> el
+0003f6e0: 656d 656e 742e 0a20 2020 2020 2020 2061  ement..        a
+0003f6f0: 7474 7269 6275 7465 7320 3d20 5b28 2274  ttributes = [("t
+0003f700: 7970 6522 2c20 6366 5f74 7970 6529 5d0a  ype", cf_type)].
+0003f710: 0a20 2020 2020 2020 2069 6620 7661 6c20  .        if val 
+0003f720: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0003f730: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+0003f740: 7465 732e 6170 7065 6e64 2828 2276 616c  tes.append(("val
+0003f750: 222c 2076 616c 2929 0a0a 2020 2020 2020  ", val))..      
+0003f760: 2020 6966 2063 7269 7465 7269 613a 0a20    if criteria:. 
+0003f770: 2020 2020 2020 2020 2020 2061 7474 7269             attri
+0003f780: 6275 7465 732e 6170 7065 6e64 2828 2267  butes.append(("g
+0003f790: 7465 222c 2030 2929 0a0a 2020 2020 2020  te", 0))..      
+0003f7a0: 2020 7365 6c66 2e5f 786d 6c5f 656d 7074    self._xml_empt
+0003f7b0: 795f 7461 6728 2263 6676 6f22 2c20 6174  y_tag("cfvo", at
+0003f7c0: 7472 6962 7574 6573 290a 0a20 2020 2064  tributes)..    d
+0003f7d0: 6566 205f 7772 6974 655f 636f 6c6f 7228  ef _write_color(
+0003f7e0: 7365 6c66 2c20 6e61 6d65 2c20 7661 6c75  self, name, valu
+0003f7f0: 6529 3a0a 2020 2020 2020 2020 2320 5772  e):.        # Wr
+0003f800: 6974 6520 7468 6520 3c63 6f6c 6f72 3e20  ite the <color> 
+0003f810: 656c 656d 656e 742e 0a20 2020 2020 2020  element..       
+0003f820: 2061 7474 7269 6275 7465 7320 3d20 5b28   attributes = [(
+0003f830: 6e61 6d65 2c20 7661 6c75 6529 5d0a 0a20  name, value)].. 
 0003f840: 2020 2020 2020 2073 656c 662e 5f78 6d6c         self._xml
-0003f850: 5f65 6e64 5f74 6167 2827 6578 7427 290a  _end_tag('ext').
-0003f860: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
-0003f870: 6c5f 656e 645f 7461 6728 2765 7874 4c73  l_end_tag('extLs
-0003f880: 7427 290a 0a20 2020 2064 6566 205f 7772  t')..    def _wr
-0003f890: 6974 655f 6963 6f6e 5f73 6574 2873 656c  ite_icon_set(sel
-0003f8a0: 662c 2070 6172 616d 293a 0a20 2020 2020  f, param):.     
-0003f8b0: 2020 2023 2057 7269 7465 2074 6865 203c     # Write the <
-0003f8c0: 6963 6f6e 5365 743e 2065 6c65 6d65 6e74  iconSet> element
-0003f8d0: 2e0a 2020 2020 2020 2020 6174 7472 6962  ..        attrib
-0003f8e0: 7574 6573 203d 205b 5d0a 0a20 2020 2020  utes = []..     
-0003f8f0: 2020 2023 2044 6f6e 2774 2073 6574 2061     # Don't set a
-0003f900: 7474 7269 6275 7465 2066 6f72 2064 6566  ttribute for def
-0003f910: 6175 6c74 2073 7479 6c65 2e0a 2020 2020  ault style..    
-0003f920: 2020 2020 6966 2070 6172 616d 5b27 6963      if param['ic
-0003f930: 6f6e 5f73 7479 6c65 275d 2021 3d20 2733  on_style'] != '3
-0003f940: 5472 6166 6669 634c 6967 6874 7327 3a0a  TrafficLights':.
-0003f950: 2020 2020 2020 2020 2020 2020 6174 7472              attr
-0003f960: 6962 7574 6573 203d 205b 2827 6963 6f6e  ibutes = [('icon
-0003f970: 5365 7427 2c20 7061 7261 6d5b 2769 636f  Set', param['ico
-0003f980: 6e5f 7374 796c 6527 5d29 5d0a 0a20 2020  n_style'])]..   
-0003f990: 2020 2020 2069 6620 7061 7261 6d2e 6765       if param.ge
-0003f9a0: 7428 2769 636f 6e73 5f6f 6e6c 7927 293a  t('icons_only'):
-0003f9b0: 0a20 2020 2020 2020 2020 2020 2061 7474  .            att
-0003f9c0: 7269 6275 7465 732e 6170 7065 6e64 2828  ributes.append((
-0003f9d0: 2773 686f 7756 616c 7565 272c 2030 2929  'showValue', 0))
-0003f9e0: 0a0a 2020 2020 2020 2020 6966 2070 6172  ..        if par
-0003f9f0: 616d 2e67 6574 2827 7265 7665 7273 655f  am.get('reverse_
-0003fa00: 6963 6f6e 7327 293a 0a20 2020 2020 2020  icons'):.       
-0003fa10: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
-0003fa20: 6170 7065 6e64 2828 2772 6576 6572 7365  append(('reverse
-0003fa30: 272c 2031 2929 0a0a 2020 2020 2020 2020  ', 1))..        
-0003fa40: 7365 6c66 2e5f 786d 6c5f 7374 6172 745f  self._xml_start_
-0003fa50: 7461 6728 2769 636f 6e53 6574 272c 2061  tag('iconSet', a
-0003fa60: 7474 7269 6275 7465 7329 0a0a 2020 2020  ttributes)..    
-0003fa70: 2020 2020 2320 5772 6974 6520 7468 6520      # Write the 
-0003fa80: 7072 6f70 6572 7469 6573 2066 6f72 2064  properties for d
-0003fa90: 6966 6665 7265 6e74 2069 636f 6e20 7374  ifferent icon st
-0003faa0: 796c 6573 2e0a 2020 2020 2020 2020 666f  yles..        fo
-0003fab0: 7220 6963 6f6e 2069 6e20 7265 7665 7273  r icon in revers
-0003fac0: 6564 2870 6172 616d 5b27 6963 6f6e 7327  ed(param['icons'
-0003fad0: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
-0003fae0: 7365 6c66 2e5f 7772 6974 655f 6366 766f  self._write_cfvo
-0003faf0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0003fb00: 2020 6963 6f6e 5b27 7479 7065 275d 2c0a    icon['type'],.
-0003fb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fb20: 6963 6f6e 5b27 7661 6c75 6527 5d2c 0a20  icon['value'],. 
-0003fb30: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0003fb40: 636f 6e5b 2763 7269 7465 7269 6127 5d29  con['criteria'])
-0003fb50: 0a0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-0003fb60: 786d 6c5f 656e 645f 7461 6728 2769 636f  xml_end_tag('ico
-0003fb70: 6e53 6574 2729 0a0a 2020 2020 6465 6620  nSet')..    def 
-0003fb80: 5f77 7269 7465 5f63 6676 6f28 7365 6c66  _write_cfvo(self
-0003fb90: 2c20 6366 5f74 7970 652c 2076 616c 2c20  , cf_type, val, 
-0003fba0: 6372 6974 6572 6961 3d4e 6f6e 6529 3a0a  criteria=None):.
-0003fbb0: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
-0003fbc0: 7468 6520 3c63 6676 6f3e 2065 6c65 6d65  the <cfvo> eleme
-0003fbd0: 6e74 2e0a 2020 2020 2020 2020 6174 7472  nt..        attr
-0003fbe0: 6962 7574 6573 203d 205b 2827 7479 7065  ibutes = [('type
-0003fbf0: 272c 2063 665f 7479 7065 295d 0a0a 2020  ', cf_type)]..  
-0003fc00: 2020 2020 2020 6966 2076 616c 2069 7320        if val is 
-0003fc10: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-0003fc20: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-0003fc30: 2e61 7070 656e 6428 2827 7661 6c27 2c20  .append(('val', 
-0003fc40: 7661 6c29 290a 0a20 2020 2020 2020 2069  val))..        i
-0003fc50: 6620 6372 6974 6572 6961 3a0a 2020 2020  f criteria:.    
-0003fc60: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
-0003fc70: 6573 2e61 7070 656e 6428 2827 6774 6527  es.append(('gte'
-0003fc80: 2c20 3029 290a 0a20 2020 2020 2020 2073  , 0))..        s
-0003fc90: 656c 662e 5f78 6d6c 5f65 6d70 7479 5f74  elf._xml_empty_t
-0003fca0: 6167 2827 6366 766f 272c 2061 7474 7269  ag('cfvo', attri
-0003fcb0: 6275 7465 7329 0a0a 2020 2020 6465 6620  butes)..    def 
-0003fcc0: 5f77 7269 7465 5f63 6f6c 6f72 2873 656c  _write_color(sel
-0003fcd0: 662c 206e 616d 652c 2076 616c 7565 293a  f, name, value):
-0003fce0: 0a20 2020 2020 2020 2023 2057 7269 7465  .        # Write
-0003fcf0: 2074 6865 203c 636f 6c6f 723e 2065 6c65   the <color> ele
-0003fd00: 6d65 6e74 2e0a 2020 2020 2020 2020 6174  ment..        at
-0003fd10: 7472 6962 7574 6573 203d 205b 286e 616d  tributes = [(nam
-0003fd20: 652c 2076 616c 7565 295d 0a0a 2020 2020  e, value)]..    
-0003fd30: 2020 2020 7365 6c66 2e5f 786d 6c5f 656d      self._xml_em
-0003fd40: 7074 795f 7461 6728 2763 6f6c 6f72 272c  pty_tag('color',
-0003fd50: 2061 7474 7269 6275 7465 7329 0a0a 2020   attributes)..  
-0003fd60: 2020 6465 6620 5f77 7269 7465 5f73 656c    def _write_sel
-0003fd70: 6563 7469 6f6e 7328 7365 6c66 293a 0a20  ections(self):. 
-0003fd80: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
-0003fd90: 6865 203c 7365 6c65 6374 696f 6e3e 2065  he <selection> e
-0003fda0: 6c65 6d65 6e74 732e 0a20 2020 2020 2020  lements..       
-0003fdb0: 2066 6f72 2073 656c 6563 7469 6f6e 2069   for selection i
-0003fdc0: 6e20 7365 6c66 2e73 656c 6563 7469 6f6e  n self.selection
-0003fdd0: 733a 0a20 2020 2020 2020 2020 2020 2073  s:.            s
-0003fde0: 656c 662e 5f77 7269 7465 5f73 656c 6563  elf._write_selec
-0003fdf0: 7469 6f6e 282a 7365 6c65 6374 696f 6e29  tion(*selection)
-0003fe00: 0a0a 2020 2020 6465 6620 5f77 7269 7465  ..    def _write
-0003fe10: 5f73 656c 6563 7469 6f6e 2873 656c 662c  _selection(self,
-0003fe20: 2070 616e 652c 2061 6374 6976 655f 6365   pane, active_ce
-0003fe30: 6c6c 2c20 7371 7265 6629 3a0a 2020 2020  ll, sqref):.    
-0003fe40: 2020 2020 2320 5772 6974 6520 7468 6520      # Write the 
-0003fe50: 3c73 656c 6563 7469 6f6e 3e20 656c 656d  <selection> elem
-0003fe60: 656e 742e 0a20 2020 2020 2020 2061 7474  ent..        att
-0003fe70: 7269 6275 7465 7320 3d20 5b5d 0a0a 2020  ributes = []..  
-0003fe80: 2020 2020 2020 6966 2070 616e 653a 0a20        if pane:. 
-0003fe90: 2020 2020 2020 2020 2020 2061 7474 7269             attri
-0003fea0: 6275 7465 732e 6170 7065 6e64 2828 2770  butes.append(('p
-0003feb0: 616e 6527 2c20 7061 6e65 2929 0a0a 2020  ane', pane))..  
-0003fec0: 2020 2020 2020 6966 2061 6374 6976 655f        if active_
-0003fed0: 6365 6c6c 3a0a 2020 2020 2020 2020 2020  cell:.          
-0003fee0: 2020 6174 7472 6962 7574 6573 2e61 7070    attributes.app
-0003fef0: 656e 6428 2827 6163 7469 7665 4365 6c6c  end(('activeCell
-0003ff00: 272c 2061 6374 6976 655f 6365 6c6c 2929  ', active_cell))
-0003ff10: 0a0a 2020 2020 2020 2020 6966 2073 7172  ..        if sqr
-0003ff20: 6566 3a0a 2020 2020 2020 2020 2020 2020  ef:.            
-0003ff30: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
-0003ff40: 6428 2827 7371 7265 6627 2c20 7371 7265  d(('sqref', sqre
-0003ff50: 6629 290a 0a20 2020 2020 2020 2073 656c  f))..        sel
-0003ff60: 662e 5f78 6d6c 5f65 6d70 7479 5f74 6167  f._xml_empty_tag
-0003ff70: 2827 7365 6c65 6374 696f 6e27 2c20 6174  ('selection', at
-0003ff80: 7472 6962 7574 6573 290a 0a20 2020 2064  tributes)..    d
-0003ff90: 6566 205f 7772 6974 655f 7061 6e65 7328  ef _write_panes(
-0003ffa0: 7365 6c66 293a 0a20 2020 2020 2020 2023  self):.        #
-0003ffb0: 2057 7269 7465 2074 6865 2066 726f 7a65   Write the froze
-0003ffc0: 6e20 6f72 2073 706c 6974 203c 7061 6e65  n or split <pane
-0003ffd0: 3e20 656c 656d 656e 7473 2e0a 2020 2020  > elements..    
-0003ffe0: 2020 2020 7061 6e65 7320 3d20 7365 6c66      panes = self
-0003fff0: 2e70 616e 6573 0a0a 2020 2020 2020 2020  .panes..        
-00040000: 6966 206e 6f74 206c 656e 2870 616e 6573  if not len(panes
-00040010: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-00040020: 6574 7572 6e0a 0a20 2020 2020 2020 2069  eturn..        i
-00040030: 6620 7061 6e65 735b 345d 203d 3d20 323a  f panes[4] == 2:
-00040040: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00040050: 662e 5f77 7269 7465 5f73 706c 6974 5f70  f._write_split_p
-00040060: 616e 6573 282a 7061 6e65 7329 0a20 2020  anes(*panes).   
-00040070: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00040080: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
-00040090: 7465 5f66 7265 657a 655f 7061 6e65 7328  te_freeze_panes(
-000400a0: 2a70 616e 6573 290a 0a20 2020 2064 6566  *panes)..    def
-000400b0: 205f 7772 6974 655f 6672 6565 7a65 5f70   _write_freeze_p
-000400c0: 616e 6573 2873 656c 662c 2072 6f77 2c20  anes(self, row, 
-000400d0: 636f 6c2c 2074 6f70 5f72 6f77 2c20 6c65  col, top_row, le
-000400e0: 6674 5f63 6f6c 2c20 7061 6e65 5f74 7970  ft_col, pane_typ
-000400f0: 6529 3a0a 2020 2020 2020 2020 2320 5772  e):.        # Wr
-00040100: 6974 6520 7468 6520 3c70 616e 653e 2065  ite the <pane> e
-00040110: 6c65 6d65 6e74 2066 6f72 2066 7265 657a  lement for freez
-00040120: 6520 7061 6e65 732e 0a20 2020 2020 2020  e panes..       
-00040130: 2061 7474 7269 6275 7465 7320 3d20 5b5d   attributes = []
-00040140: 0a0a 2020 2020 2020 2020 795f 7370 6c69  ..        y_spli
-00040150: 7420 3d20 726f 770a 2020 2020 2020 2020  t = row.        
-00040160: 785f 7370 6c69 7420 3d20 636f 6c0a 2020  x_split = col.  
-00040170: 2020 2020 2020 746f 705f 6c65 6674 5f63        top_left_c
-00040180: 656c 6c20 3d20 786c 5f72 6f77 636f 6c5f  ell = xl_rowcol_
-00040190: 746f 5f63 656c 6c28 746f 705f 726f 772c  to_cell(top_row,
-000401a0: 206c 6566 745f 636f 6c29 0a20 2020 2020   left_col).     
-000401b0: 2020 2061 6374 6976 655f 7061 6e65 203d     active_pane =
-000401c0: 2027 270a 2020 2020 2020 2020 7374 6174   ''.        stat
-000401d0: 6520 3d20 2727 0a20 2020 2020 2020 2061  e = ''.        a
-000401e0: 6374 6976 655f 6365 6c6c 203d 2027 270a  ctive_cell = ''.
-000401f0: 2020 2020 2020 2020 7371 7265 6620 3d20          sqref = 
-00040200: 2727 0a0a 2020 2020 2020 2020 2320 4d6f  ''..        # Mo
-00040210: 7665 2075 7365 7220 6365 6c6c 2073 656c  ve user cell sel
-00040220: 6563 7469 6f6e 2074 6f20 7468 6520 7061  ection to the pa
-00040230: 6e65 732e 0a20 2020 2020 2020 2069 6620  nes..        if 
-00040240: 7365 6c66 2e73 656c 6563 7469 6f6e 733a  self.selections:
-00040250: 0a20 2020 2020 2020 2020 2020 2028 5f2c  .            (_,
-00040260: 2061 6374 6976 655f 6365 6c6c 2c20 7371   active_cell, sq
-00040270: 7265 6629 203d 2073 656c 662e 7365 6c65  ref) = self.sele
-00040280: 6374 696f 6e73 5b30 5d0a 2020 2020 2020  ctions[0].      
-00040290: 2020 2020 2020 7365 6c66 2e73 656c 6563        self.selec
-000402a0: 7469 6f6e 7320 3d20 5b5d 0a0a 2020 2020  tions = []..    
-000402b0: 2020 2020 2320 5365 7420 7468 6520 6163      # Set the ac
-000402c0: 7469 7665 2070 616e 652e 0a20 2020 2020  tive pane..     
-000402d0: 2020 2069 6620 726f 7720 616e 6420 636f     if row and co
-000402e0: 6c3a 0a20 2020 2020 2020 2020 2020 2061  l:.            a
-000402f0: 6374 6976 655f 7061 6e65 203d 2027 626f  ctive_pane = 'bo
-00040300: 7474 6f6d 5269 6768 7427 0a0a 2020 2020  ttomRight'..    
-00040310: 2020 2020 2020 2020 726f 775f 6365 6c6c          row_cell
-00040320: 203d 2078 6c5f 726f 7763 6f6c 5f74 6f5f   = xl_rowcol_to_
-00040330: 6365 6c6c 2872 6f77 2c20 3029 0a20 2020  cell(row, 0).   
-00040340: 2020 2020 2020 2020 2063 6f6c 5f63 656c           col_cel
-00040350: 6c20 3d20 786c 5f72 6f77 636f 6c5f 746f  l = xl_rowcol_to
-00040360: 5f63 656c 6c28 302c 2063 6f6c 290a 0a20  _cell(0, col).. 
-00040370: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00040380: 7365 6c65 6374 696f 6e73 2e61 7070 656e  selections.appen
-00040390: 6428 5b27 746f 7052 6967 6874 272c 2063  d(['topRight', c
-000403a0: 6f6c 5f63 656c 6c2c 2063 6f6c 5f63 656c  ol_cell, col_cel
-000403b0: 6c5d 290a 2020 2020 2020 2020 2020 2020  l]).            
-000403c0: 7365 6c66 2e73 656c 6563 7469 6f6e 732e  self.selections.
-000403d0: 6170 7065 6e64 285b 2762 6f74 746f 6d4c  append(['bottomL
-000403e0: 6566 7427 2c20 726f 775f 6365 6c6c 2c20  eft', row_cell, 
-000403f0: 726f 775f 6365 6c6c 5d29 0a20 2020 2020  row_cell]).     
-00040400: 2020 2020 2020 2073 656c 662e 7365 6c65         self.sele
-00040410: 6374 696f 6e73 2e61 7070 656e 6428 5b27  ctions.append(['
-00040420: 626f 7474 6f6d 5269 6768 7427 2c20 6163  bottomRight', ac
-00040430: 7469 7665 5f63 656c 6c2c 2073 7172 6566  tive_cell, sqref
-00040440: 5d29 0a0a 2020 2020 2020 2020 656c 6966  ])..        elif
-00040450: 2063 6f6c 3a0a 2020 2020 2020 2020 2020   col:.          
-00040460: 2020 6163 7469 7665 5f70 616e 6520 3d20    active_pane = 
-00040470: 2774 6f70 5269 6768 7427 0a20 2020 2020  'topRight'.     
-00040480: 2020 2020 2020 2073 656c 662e 7365 6c65         self.sele
-00040490: 6374 696f 6e73 2e61 7070 656e 6428 5b27  ctions.append(['
-000404a0: 746f 7052 6967 6874 272c 2061 6374 6976  topRight', activ
-000404b0: 655f 6365 6c6c 2c20 7371 7265 665d 290a  e_cell, sqref]).
-000404c0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-000404d0: 2020 2020 2020 2020 2020 2061 6374 6976             activ
-000404e0: 655f 7061 6e65 203d 2027 626f 7474 6f6d  e_pane = 'bottom
-000404f0: 4c65 6674 270a 2020 2020 2020 2020 2020  Left'.          
-00040500: 2020 7365 6c66 2e73 656c 6563 7469 6f6e    self.selection
-00040510: 732e 6170 7065 6e64 285b 2762 6f74 746f  s.append(['botto
-00040520: 6d4c 6566 7427 2c20 6163 7469 7665 5f63  mLeft', active_c
-00040530: 656c 6c2c 2073 7172 6566 5d29 0a0a 2020  ell, sqref])..  
-00040540: 2020 2020 2020 2320 5365 7420 7468 6520        # Set the 
-00040550: 7061 6e65 2074 7970 652e 0a20 2020 2020  pane type..     
-00040560: 2020 2069 6620 7061 6e65 5f74 7970 6520     if pane_type 
-00040570: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-00040580: 2020 7374 6174 6520 3d20 2766 726f 7a65    state = 'froze
-00040590: 6e27 0a20 2020 2020 2020 2065 6c69 6620  n'.        elif 
-000405a0: 7061 6e65 5f74 7970 6520 3d3d 2031 3a0a  pane_type == 1:.
-000405b0: 2020 2020 2020 2020 2020 2020 7374 6174              stat
-000405c0: 6520 3d20 2766 726f 7a65 6e53 706c 6974  e = 'frozenSplit
-000405d0: 270a 2020 2020 2020 2020 656c 7365 3a0a  '.        else:.
-000405e0: 2020 2020 2020 2020 2020 2020 7374 6174              stat
-000405f0: 6520 3d20 2773 706c 6974 270a 0a20 2020  e = 'split'..   
-00040600: 2020 2020 2069 6620 785f 7370 6c69 743a       if x_split:
-00040610: 0a20 2020 2020 2020 2020 2020 2061 7474  .            att
-00040620: 7269 6275 7465 732e 6170 7065 6e64 2828  ributes.append((
-00040630: 2778 5370 6c69 7427 2c20 785f 7370 6c69  'xSplit', x_spli
-00040640: 7429 290a 0a20 2020 2020 2020 2069 6620  t))..        if 
-00040650: 795f 7370 6c69 743a 0a20 2020 2020 2020  y_split:.       
-00040660: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
-00040670: 6170 7065 6e64 2828 2779 5370 6c69 7427  append(('ySplit'
-00040680: 2c20 795f 7370 6c69 7429 290a 0a20 2020  , y_split))..   
-00040690: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
-000406a0: 6170 7065 6e64 2828 2774 6f70 4c65 6674  append(('topLeft
-000406b0: 4365 6c6c 272c 2074 6f70 5f6c 6566 745f  Cell', top_left_
-000406c0: 6365 6c6c 2929 0a20 2020 2020 2020 2061  cell)).        a
-000406d0: 7474 7269 6275 7465 732e 6170 7065 6e64  ttributes.append
-000406e0: 2828 2761 6374 6976 6550 616e 6527 2c20  (('activePane', 
-000406f0: 6163 7469 7665 5f70 616e 6529 290a 2020  active_pane)).  
-00040700: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-00040710: 2e61 7070 656e 6428 2827 7374 6174 6527  .append(('state'
-00040720: 2c20 7374 6174 6529 290a 0a20 2020 2020  , state))..     
-00040730: 2020 2073 656c 662e 5f78 6d6c 5f65 6d70     self._xml_emp
-00040740: 7479 5f74 6167 2827 7061 6e65 272c 2061  ty_tag('pane', a
-00040750: 7474 7269 6275 7465 7329 0a0a 2020 2020  ttributes)..    
-00040760: 6465 6620 5f77 7269 7465 5f73 706c 6974  def _write_split
-00040770: 5f70 616e 6573 2873 656c 662c 2072 6f77  _panes(self, row
-00040780: 2c20 636f 6c2c 2074 6f70 5f72 6f77 2c20  , col, top_row, 
-00040790: 6c65 6674 5f63 6f6c 2c20 7061 6e65 5f74  left_col, pane_t
-000407a0: 7970 6529 3a0a 2020 2020 2020 2020 2320  ype):.        # 
-000407b0: 5772 6974 6520 7468 6520 3c70 616e 653e  Write the <pane>
-000407c0: 2065 6c65 6d65 6e74 2066 6f72 2073 706c   element for spl
-000407d0: 6974 2070 616e 6573 2e0a 2020 2020 2020  it panes..      
-000407e0: 2020 6174 7472 6962 7574 6573 203d 205b    attributes = [
-000407f0: 5d0a 2020 2020 2020 2020 6861 735f 7365  ].        has_se
-00040800: 6c65 6374 696f 6e20 3d20 300a 2020 2020  lection = 0.    
-00040810: 2020 2020 6163 7469 7665 5f70 616e 6520      active_pane 
-00040820: 3d20 2727 0a20 2020 2020 2020 2061 6374  = ''.        act
-00040830: 6976 655f 6365 6c6c 203d 2027 270a 2020  ive_cell = ''.  
-00040840: 2020 2020 2020 7371 7265 6620 3d20 2727        sqref = ''
-00040850: 0a0a 2020 2020 2020 2020 795f 7370 6c69  ..        y_spli
-00040860: 7420 3d20 726f 770a 2020 2020 2020 2020  t = row.        
-00040870: 785f 7370 6c69 7420 3d20 636f 6c0a 0a20  x_split = col.. 
-00040880: 2020 2020 2020 2023 204d 6f76 6520 7573         # Move us
-00040890: 6572 2063 656c 6c20 7365 6c65 6374 696f  er cell selectio
-000408a0: 6e20 746f 2074 6865 2070 616e 6573 2e0a  n to the panes..
-000408b0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-000408c0: 7365 6c65 6374 696f 6e73 3a0a 2020 2020  selections:.    
-000408d0: 2020 2020 2020 2020 285f 2c20 6163 7469          (_, acti
-000408e0: 7665 5f63 656c 6c2c 2073 7172 6566 2920  ve_cell, sqref) 
-000408f0: 3d20 7365 6c66 2e73 656c 6563 7469 6f6e  = self.selection
-00040900: 735b 305d 0a20 2020 2020 2020 2020 2020  s[0].           
-00040910: 2073 656c 662e 7365 6c65 6374 696f 6e73   self.selections
-00040920: 203d 205b 5d0a 2020 2020 2020 2020 2020   = [].          
-00040930: 2020 6861 735f 7365 6c65 6374 696f 6e20    has_selection 
-00040940: 3d20 310a 0a20 2020 2020 2020 2023 2043  = 1..        # C
-00040950: 6f6e 7665 7274 2074 6865 2072 6f77 2061  onvert the row a
-00040960: 6e64 2063 6f6c 2074 6f20 312f 3230 2074  nd col to 1/20 t
-00040970: 7769 7020 756e 6974 7320 7769 7468 2070  wip units with p
-00040980: 6164 6469 6e67 2e0a 2020 2020 2020 2020  adding..        
-00040990: 6966 2079 5f73 706c 6974 3a0a 2020 2020  if y_split:.    
-000409a0: 2020 2020 2020 2020 795f 7370 6c69 7420          y_split 
-000409b0: 3d20 696e 7428 3230 202a 2079 5f73 706c  = int(20 * y_spl
-000409c0: 6974 202b 2033 3030 290a 0a20 2020 2020  it + 300)..     
-000409d0: 2020 2069 6620 785f 7370 6c69 743a 0a20     if x_split:. 
-000409e0: 2020 2020 2020 2020 2020 2078 5f73 706c             x_spl
-000409f0: 6974 203d 2073 656c 662e 5f63 616c 6375  it = self._calcu
-00040a00: 6c61 7465 5f78 5f73 706c 6974 5f77 6964  late_x_split_wid
-00040a10: 7468 2878 5f73 706c 6974 290a 0a20 2020  th(x_split)..   
-00040a20: 2020 2020 2023 2046 6f72 206e 6f6e 2d65       # For non-e
-00040a30: 7870 6c69 6369 7420 746f 704c 6566 7420  xplicit topLeft 
-00040a40: 6465 6669 6e69 7469 6f6e 732c 2065 7374  definitions, est
-00040a50: 696d 6174 6520 7468 6520 6365 6c6c 206f  imate the cell o
-00040a60: 6666 7365 7420 6261 7365 640a 2020 2020  ffset based.    
-00040a70: 2020 2020 2320 6f6e 2074 6865 2070 6978      # on the pix
-00040a80: 656c 7320 6469 6d65 6e73 696f 6e73 2e20  els dimensions. 
-00040a90: 5468 6973 2069 7320 6f6e 6c79 2061 2077  This is only a w
-00040aa0: 6f72 6b61 726f 756e 6420 616e 6420 646f  orkaround and do
-00040ab0: 6573 6e27 7420 7461 6b65 0a20 2020 2020  esn't take.     
-00040ac0: 2020 2023 2061 646a 7573 7465 6420 6365     # adjusted ce
-00040ad0: 6c6c 2064 696d 656e 7369 6f6e 7320 696e  ll dimensions in
-00040ae0: 746f 2061 6363 6f75 6e74 2e0a 2020 2020  to account..    
-00040af0: 2020 2020 6966 2074 6f70 5f72 6f77 203d      if top_row =
-00040b00: 3d20 726f 7720 616e 6420 6c65 6674 5f63  = row and left_c
-00040b10: 6f6c 203d 3d20 636f 6c3a 0a20 2020 2020  ol == col:.     
-00040b20: 2020 2020 2020 2074 6f70 5f72 6f77 203d         top_row =
-00040b30: 2069 6e74 2830 2e35 202b 2028 795f 7370   int(0.5 + (y_sp
-00040b40: 6c69 7420 2d20 3330 3029 202f 2032 3020  lit - 300) / 20 
-00040b50: 2f20 3135 290a 2020 2020 2020 2020 2020  / 15).          
-00040b60: 2020 6c65 6674 5f63 6f6c 203d 2069 6e74    left_col = int
-00040b70: 2830 2e35 202b 2028 785f 7370 6c69 7420  (0.5 + (x_split 
-00040b80: 2d20 3339 3029 202f 2032 3020 2f20 3320  - 390) / 20 / 3 
-00040b90: 2a20 3420 2f20 3634 290a 0a20 2020 2020  * 4 / 64)..     
-00040ba0: 2020 2074 6f70 5f6c 6566 745f 6365 6c6c     top_left_cell
-00040bb0: 203d 2078 6c5f 726f 7763 6f6c 5f74 6f5f   = xl_rowcol_to_
-00040bc0: 6365 6c6c 2874 6f70 5f72 6f77 2c20 6c65  cell(top_row, le
-00040bd0: 6674 5f63 6f6c 290a 0a20 2020 2020 2020  ft_col)..       
-00040be0: 2023 2049 6620 7468 6572 6520 6973 206e   # If there is n
-00040bf0: 6f20 7365 6c65 6374 696f 6e20 7365 7420  o selection set 
-00040c00: 7468 6520 6163 7469 7665 2063 656c 6c20  the active cell 
-00040c10: 746f 2074 6865 2074 6f70 206c 6566 7420  to the top left 
-00040c20: 6365 6c6c 2e0a 2020 2020 2020 2020 6966  cell..        if
-00040c30: 206e 6f74 2068 6173 5f73 656c 6563 7469   not has_selecti
-00040c40: 6f6e 3a0a 2020 2020 2020 2020 2020 2020  on:.            
-00040c50: 6163 7469 7665 5f63 656c 6c20 3d20 746f  active_cell = to
-00040c60: 705f 6c65 6674 5f63 656c 6c0a 2020 2020  p_left_cell.    
-00040c70: 2020 2020 2020 2020 7371 7265 6620 3d20          sqref = 
-00040c80: 746f 705f 6c65 6674 5f63 656c 6c0a 0a20  top_left_cell.. 
-00040c90: 2020 2020 2020 2023 2053 6574 2074 6865         # Set the
-00040ca0: 2043 656c 6c20 7365 6c65 6374 696f 6e73   Cell selections
-00040cb0: 2e0a 2020 2020 2020 2020 6966 2072 6f77  ..        if row
-00040cc0: 2061 6e64 2063 6f6c 3a0a 2020 2020 2020   and col:.      
-00040cd0: 2020 2020 2020 6163 7469 7665 5f70 616e        active_pan
-00040ce0: 6520 3d20 2762 6f74 746f 6d52 6967 6874  e = 'bottomRight
-00040cf0: 270a 0a20 2020 2020 2020 2020 2020 2072  '..            r
-00040d00: 6f77 5f63 656c 6c20 3d20 786c 5f72 6f77  ow_cell = xl_row
-00040d10: 636f 6c5f 746f 5f63 656c 6c28 746f 705f  col_to_cell(top_
-00040d20: 726f 772c 2030 290a 2020 2020 2020 2020  row, 0).        
-00040d30: 2020 2020 636f 6c5f 6365 6c6c 203d 2078      col_cell = x
-00040d40: 6c5f 726f 7763 6f6c 5f74 6f5f 6365 6c6c  l_rowcol_to_cell
-00040d50: 2830 2c20 6c65 6674 5f63 6f6c 290a 0a20  (0, left_col).. 
-00040d60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00040d70: 7365 6c65 6374 696f 6e73 2e61 7070 656e  selections.appen
-00040d80: 6428 5b27 746f 7052 6967 6874 272c 2063  d(['topRight', c
-00040d90: 6f6c 5f63 656c 6c2c 2063 6f6c 5f63 656c  ol_cell, col_cel
-00040da0: 6c5d 290a 2020 2020 2020 2020 2020 2020  l]).            
-00040db0: 7365 6c66 2e73 656c 6563 7469 6f6e 732e  self.selections.
-00040dc0: 6170 7065 6e64 285b 2762 6f74 746f 6d4c  append(['bottomL
-00040dd0: 6566 7427 2c20 726f 775f 6365 6c6c 2c20  eft', row_cell, 
-00040de0: 726f 775f 6365 6c6c 5d29 0a20 2020 2020  row_cell]).     
-00040df0: 2020 2020 2020 2073 656c 662e 7365 6c65         self.sele
-00040e00: 6374 696f 6e73 2e61 7070 656e 6428 5b27  ctions.append(['
-00040e10: 626f 7474 6f6d 5269 6768 7427 2c20 6163  bottomRight', ac
-00040e20: 7469 7665 5f63 656c 6c2c 2073 7172 6566  tive_cell, sqref
-00040e30: 5d29 0a0a 2020 2020 2020 2020 656c 6966  ])..        elif
-00040e40: 2063 6f6c 3a0a 2020 2020 2020 2020 2020   col:.          
-00040e50: 2020 6163 7469 7665 5f70 616e 6520 3d20    active_pane = 
-00040e60: 2774 6f70 5269 6768 7427 0a20 2020 2020  'topRight'.     
-00040e70: 2020 2020 2020 2073 656c 662e 7365 6c65         self.sele
-00040e80: 6374 696f 6e73 2e61 7070 656e 6428 5b27  ctions.append(['
-00040e90: 746f 7052 6967 6874 272c 2061 6374 6976  topRight', activ
-00040ea0: 655f 6365 6c6c 2c20 7371 7265 665d 290a  e_cell, sqref]).
-00040eb0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00040ec0: 2020 2020 2020 2020 2020 2061 6374 6976             activ
-00040ed0: 655f 7061 6e65 203d 2027 626f 7474 6f6d  e_pane = 'bottom
-00040ee0: 4c65 6674 270a 2020 2020 2020 2020 2020  Left'.          
-00040ef0: 2020 7365 6c66 2e73 656c 6563 7469 6f6e    self.selection
-00040f00: 732e 6170 7065 6e64 285b 2762 6f74 746f  s.append(['botto
-00040f10: 6d4c 6566 7427 2c20 6163 7469 7665 5f63  mLeft', active_c
-00040f20: 656c 6c2c 2073 7172 6566 5d29 0a0a 2020  ell, sqref])..  
-00040f30: 2020 2020 2020 2320 466f 726d 6174 2073        # Format s
-00040f40: 706c 6974 7320 746f 2074 6865 2073 616d  plits to the sam
-00040f50: 6520 7072 6563 6973 696f 6e20 6173 2045  e precision as E
-00040f60: 7863 656c 2e0a 2020 2020 2020 2020 6966  xcel..        if
-00040f70: 2078 5f73 706c 6974 3a0a 2020 2020 2020   x_split:.      
-00040f80: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-00040f90: 2e61 7070 656e 6428 2827 7853 706c 6974  .append(('xSplit
-00040fa0: 272c 2022 252e 3136 6722 2025 2078 5f73  ', "%.16g" % x_s
-00040fb0: 706c 6974 2929 0a0a 2020 2020 2020 2020  plit))..        
-00040fc0: 6966 2079 5f73 706c 6974 3a0a 2020 2020  if y_split:.    
-00040fd0: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
-00040fe0: 6573 2e61 7070 656e 6428 2827 7953 706c  es.append(('ySpl
-00040ff0: 6974 272c 2022 252e 3136 6722 2025 2079  it', "%.16g" % y
-00041000: 5f73 706c 6974 2929 0a0a 2020 2020 2020  _split))..      
-00041010: 2020 6174 7472 6962 7574 6573 2e61 7070    attributes.app
-00041020: 656e 6428 2827 746f 704c 6566 7443 656c  end(('topLeftCel
-00041030: 6c27 2c20 746f 705f 6c65 6674 5f63 656c  l', top_left_cel
-00041040: 6c29 290a 0a20 2020 2020 2020 2069 6620  l))..        if 
-00041050: 6861 735f 7365 6c65 6374 696f 6e3a 0a20  has_selection:. 
-00041060: 2020 2020 2020 2020 2020 2061 7474 7269             attri
-00041070: 6275 7465 732e 6170 7065 6e64 2828 2761  butes.append(('a
-00041080: 6374 6976 6550 616e 6527 2c20 6163 7469  ctivePane', acti
-00041090: 7665 5f70 616e 6529 290a 0a20 2020 2020  ve_pane))..     
-000410a0: 2020 2073 656c 662e 5f78 6d6c 5f65 6d70     self._xml_emp
-000410b0: 7479 5f74 6167 2827 7061 6e65 272c 2061  ty_tag('pane', a
-000410c0: 7474 7269 6275 7465 7329 0a0a 2020 2020  ttributes)..    
-000410d0: 6465 6620 5f63 616c 6375 6c61 7465 5f78  def _calculate_x
-000410e0: 5f73 706c 6974 5f77 6964 7468 2873 656c  _split_width(sel
-000410f0: 662c 2077 6964 7468 293a 0a20 2020 2020  f, width):.     
-00041100: 2020 2023 2043 6f6e 7665 7274 2063 6f6c     # Convert col
-00041110: 756d 6e20 7769 6474 6820 6672 6f6d 2075  umn width from u
-00041120: 7365 7220 756e 6974 7320 746f 2070 616e  ser units to pan
-00041130: 6520 7370 6c69 7420 7769 6474 682e 0a0a  e split width...
-00041140: 2020 2020 2020 2020 6d61 785f 6469 6769          max_digi
-00041150: 745f 7769 6474 6820 3d20 3720 2023 2046  t_width = 7  # F
-00041160: 6f72 2043 616c 6162 7269 2031 312e 0a20  or Calabri 11.. 
-00041170: 2020 2020 2020 2070 6164 6469 6e67 203d         padding =
-00041180: 2035 0a0a 2020 2020 2020 2020 2320 436f   5..        # Co
-00041190: 6e76 6572 7420 746f 2070 6978 656c 732e  nvert to pixels.
-000411a0: 0a20 2020 2020 2020 2069 6620 7769 6474  .        if widt
-000411b0: 6820 3c20 313a 0a20 2020 2020 2020 2020  h < 1:.         
-000411c0: 2020 2070 6978 656c 7320 3d20 696e 7428     pixels = int(
-000411d0: 7769 6474 6820 2a20 286d 6178 5f64 6967  width * (max_dig
-000411e0: 6974 5f77 6964 7468 202b 2070 6164 6469  it_width + paddi
-000411f0: 6e67 2920 2b20 302e 3529 0a20 2020 2020  ng) + 0.5).     
-00041200: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00041210: 2020 2020 2070 6978 656c 7320 3d20 696e       pixels = in
-00041220: 7428 7769 6474 6820 2a20 6d61 785f 6469  t(width * max_di
-00041230: 6769 745f 7769 6474 6820 2b20 302e 3529  git_width + 0.5)
-00041240: 202b 2070 6164 6469 6e67 0a0a 2020 2020   + padding..    
-00041250: 2020 2020 2320 436f 6e76 6572 7420 746f      # Convert to
-00041260: 2070 6f69 6e74 732e 0a20 2020 2020 2020   points..       
-00041270: 2070 6f69 6e74 7320 3d20 7069 7865 6c73   points = pixels
-00041280: 202a 2033 202f 2034 0a0a 2020 2020 2020   * 3 / 4..      
-00041290: 2020 2320 436f 6e76 6572 7420 746f 2074    # Convert to t
-000412a0: 7769 7073 2028 7477 656e 7469 6574 6873  wips (twentieths
-000412b0: 206f 6620 6120 706f 696e 7429 2e0a 2020   of a point)..  
-000412c0: 2020 2020 2020 7477 6970 7320 3d20 706f        twips = po
-000412d0: 696e 7473 202a 2032 300a 0a20 2020 2020  ints * 20..     
-000412e0: 2020 2023 2041 6464 206f 6666 7365 742f     # Add offset/
-000412f0: 7061 6464 696e 672e 0a20 2020 2020 2020  padding..       
-00041300: 2077 6964 7468 203d 2074 7769 7073 202b   width = twips +
-00041310: 2033 3930 0a0a 2020 2020 2020 2020 7265   390..        re
-00041320: 7475 726e 2077 6964 7468 0a0a 2020 2020  turn width..    
-00041330: 6465 6620 5f77 7269 7465 5f74 6162 6c65  def _write_table
-00041340: 5f70 6172 7473 2873 656c 6629 3a0a 2020  _parts(self):.  
-00041350: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
-00041360: 6520 3c74 6162 6c65 5061 7274 733e 2065  e <tableParts> e
-00041370: 6c65 6d65 6e74 2e0a 2020 2020 2020 2020  lement..        
-00041380: 7461 626c 6573 203d 2073 656c 662e 7461  tables = self.ta
-00041390: 626c 6573 0a20 2020 2020 2020 2063 6f75  bles.        cou
-000413a0: 6e74 203d 206c 656e 2874 6162 6c65 7329  nt = len(tables)
-000413b0: 0a0a 2020 2020 2020 2020 2320 5265 7475  ..        # Retu
-000413c0: 726e 2069 6620 776f 726b 7368 6565 7420  rn if worksheet 
-000413d0: 646f 6573 6e27 7420 636f 6e74 6169 6e20  doesn't contain 
-000413e0: 616e 7920 7461 626c 6573 2e0a 2020 2020  any tables..    
-000413f0: 2020 2020 6966 206e 6f74 2063 6f75 6e74      if not count
-00041400: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00041410: 7475 726e 0a0a 2020 2020 2020 2020 6174  turn..        at
-00041420: 7472 6962 7574 6573 203d 205b 2827 636f  tributes = [('co
-00041430: 756e 7427 2c20 636f 756e 742c 295d 0a0a  unt', count,)]..
-00041440: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
-00041450: 6c5f 7374 6172 745f 7461 6728 2774 6162  l_start_tag('tab
-00041460: 6c65 5061 7274 7327 2c20 6174 7472 6962  leParts', attrib
-00041470: 7574 6573 290a 0a20 2020 2020 2020 2066  utes)..        f
-00041480: 6f72 205f 2069 6e20 7461 626c 6573 3a0a  or _ in tables:.
-00041490: 0a20 2020 2020 2020 2020 2020 2023 2057  .            # W
-000414a0: 7269 7465 2074 6865 2074 6162 6c65 5061  rite the tablePa
-000414b0: 7274 2065 6c65 6d65 6e74 2e0a 2020 2020  rt element..    
-000414c0: 2020 2020 2020 2020 7365 6c66 2e72 656c          self.rel
-000414d0: 5f63 6f75 6e74 202b 3d20 310a 2020 2020  _count += 1.    
-000414e0: 2020 2020 2020 2020 7365 6c66 2e5f 7772          self._wr
-000414f0: 6974 655f 7461 626c 655f 7061 7274 2873  ite_table_part(s
-00041500: 656c 662e 7265 6c5f 636f 756e 7429 0a0a  elf.rel_count)..
-00041510: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
-00041520: 6c5f 656e 645f 7461 6728 2774 6162 6c65  l_end_tag('table
-00041530: 5061 7274 7327 290a 0a20 2020 2064 6566  Parts')..    def
-00041540: 205f 7772 6974 655f 7461 626c 655f 7061   _write_table_pa
-00041550: 7274 2873 656c 662c 2072 5f69 6429 3a0a  rt(self, r_id):.
-00041560: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
-00041570: 7468 6520 3c74 6162 6c65 5061 7274 3e20  the <tablePart> 
-00041580: 656c 656d 656e 742e 0a0a 2020 2020 2020  element...      
-00041590: 2020 725f 6964 203d 2027 7249 6427 202b    r_id = 'rId' +
-000415a0: 2073 7472 2872 5f69 6429 0a0a 2020 2020   str(r_id)..    
-000415b0: 2020 2020 6174 7472 6962 7574 6573 203d      attributes =
-000415c0: 205b 2827 723a 6964 272c 2072 5f69 642c   [('r:id', r_id,
-000415d0: 295d 0a0a 2020 2020 2020 2020 7365 6c66  )]..        self
-000415e0: 2e5f 786d 6c5f 656d 7074 795f 7461 6728  ._xml_empty_tag(
-000415f0: 2774 6162 6c65 5061 7274 272c 2061 7474  'tablePart', att
-00041600: 7269 6275 7465 7329 0a0a 2020 2020 6465  ributes)..    de
-00041610: 6620 5f77 7269 7465 5f65 7874 5f6c 6973  f _write_ext_lis
-00041620: 7428 7365 6c66 293a 0a20 2020 2020 2020  t(self):.       
-00041630: 2023 2057 7269 7465 2074 6865 203c 6578   # Write the <ex
-00041640: 744c 7374 3e20 656c 656d 656e 7420 666f  tLst> element fo
-00041650: 7220 6461 7461 2062 6172 7320 616e 6420  r data bars and 
-00041660: 7370 6172 6b6c 696e 6573 2e0a 2020 2020  sparklines..    
-00041670: 2020 2020 6861 735f 6461 7461 5f62 6172      has_data_bar
-00041680: 7320 3d20 6c65 6e28 7365 6c66 2e64 6174  s = len(self.dat
-00041690: 615f 6261 7273 5f32 3031 3029 0a20 2020  a_bars_2010).   
-000416a0: 2020 2020 2068 6173 5f73 7061 726b 6c69       has_sparkli
-000416b0: 6e65 7320 3d20 6c65 6e28 7365 6c66 2e73  nes = len(self.s
-000416c0: 7061 726b 6c69 6e65 7329 0a0a 2020 2020  parklines)..    
-000416d0: 2020 2020 6966 206e 6f74 2068 6173 5f64      if not has_d
-000416e0: 6174 615f 6261 7273 2061 6e64 206e 6f74  ata_bars and not
-000416f0: 2068 6173 5f73 7061 726b 6c69 6e65 733a   has_sparklines:
-00041700: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00041710: 7572 6e0a 0a20 2020 2020 2020 2023 2057  urn..        # W
-00041720: 7269 7465 2074 6865 2065 7874 4c73 7420  rite the extLst 
-00041730: 656c 656d 656e 742e 0a20 2020 2020 2020  element..       
-00041740: 2073 656c 662e 5f78 6d6c 5f73 7461 7274   self._xml_start
-00041750: 5f74 6167 2827 6578 744c 7374 2729 0a0a  _tag('extLst')..
-00041760: 2020 2020 2020 2020 6966 2068 6173 5f64          if has_d
-00041770: 6174 615f 6261 7273 3a0a 2020 2020 2020  ata_bars:.      
-00041780: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
-00041790: 655f 6578 745f 6c69 7374 5f64 6174 615f  e_ext_list_data_
-000417a0: 6261 7273 2829 0a0a 2020 2020 2020 2020  bars()..        
-000417b0: 6966 2068 6173 5f73 7061 726b 6c69 6e65  if has_sparkline
-000417c0: 733a 0a20 2020 2020 2020 2020 2020 2073  s:.            s
-000417d0: 656c 662e 5f77 7269 7465 5f65 7874 5f6c  elf._write_ext_l
-000417e0: 6973 745f 7370 6172 6b6c 696e 6573 2829  ist_sparklines()
-000417f0: 0a0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-00041800: 786d 6c5f 656e 645f 7461 6728 2765 7874  xml_end_tag('ext
-00041810: 4c73 7427 290a 0a20 2020 2064 6566 205f  Lst')..    def _
-00041820: 7772 6974 655f 6578 745f 6c69 7374 5f64  write_ext_list_d
-00041830: 6174 615f 6261 7273 2873 656c 6629 3a0a  ata_bars(self):.
-00041840: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
-00041850: 7468 6520 4578 6365 6c20 3230 3130 2064  the Excel 2010 d
-00041860: 6174 615f 6261 7220 7375 6265 6c65 6d65  ata_bar subeleme
-00041870: 6e74 732e 0a20 2020 2020 2020 2073 656c  nts..        sel
-00041880: 662e 5f77 7269 7465 5f65 7874 2827 7b37  f._write_ext('{7
-00041890: 3843 3044 3933 312d 3634 3337 2d34 3037  8C0D931-6437-407
-000418a0: 642d 4138 4545 2d46 3041 4144 3735 3339  d-A8EE-F0AAD7539
-000418b0: 4536 357d 2729 0a0a 2020 2020 2020 2020  E65}')..        
-000418c0: 7365 6c66 2e5f 786d 6c5f 7374 6172 745f  self._xml_start_
-000418d0: 7461 6728 2778 3134 3a63 6f6e 6469 7469  tag('x14:conditi
-000418e0: 6f6e 616c 466f 726d 6174 7469 6e67 7327  onalFormattings'
-000418f0: 290a 0a20 2020 2020 2020 2023 2057 7269  )..        # Wri
-00041900: 7465 2074 6865 2045 7863 656c 2032 3031  te the Excel 201
-00041910: 3020 636f 6e64 6974 696f 6e61 6c20 666f  0 conditional fo
-00041920: 726d 6174 7469 6e67 2064 6174 6120 6261  rmatting data ba
-00041930: 7220 656c 656d 656e 7473 2e0a 2020 2020  r elements..    
-00041940: 2020 2020 666f 7220 6461 7461 5f62 6172      for data_bar
-00041950: 2069 6e20 7365 6c66 2e64 6174 615f 6261   in self.data_ba
-00041960: 7273 5f32 3031 303a 0a20 2020 2020 2020  rs_2010:.       
-00041970: 2020 2020 2023 2057 7269 7465 2074 6865       # Write the
-00041980: 2078 3134 3a63 6f6e 6469 7469 6f6e 616c   x14:conditional
-00041990: 466f 726d 6174 7469 6e67 2065 6c65 6d65  Formatting eleme
-000419a0: 6e74 2e0a 2020 2020 2020 2020 2020 2020  nt..            
-000419b0: 7365 6c66 2e5f 7772 6974 655f 636f 6e64  self._write_cond
-000419c0: 6974 696f 6e61 6c5f 666f 726d 6174 7469  itional_formatti
-000419d0: 6e67 5f32 3031 3028 6461 7461 5f62 6172  ng_2010(data_bar
-000419e0: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-000419f0: 5f78 6d6c 5f65 6e64 5f74 6167 2827 7831  _xml_end_tag('x1
-00041a00: 343a 636f 6e64 6974 696f 6e61 6c46 6f72  4:conditionalFor
-00041a10: 6d61 7474 696e 6773 2729 0a20 2020 2020  mattings').     
-00041a20: 2020 2073 656c 662e 5f78 6d6c 5f65 6e64     self._xml_end
-00041a30: 5f74 6167 2827 6578 7427 290a 0a20 2020  _tag('ext')..   
-00041a40: 2064 6566 205f 7772 6974 655f 636f 6e64   def _write_cond
-00041a50: 6974 696f 6e61 6c5f 666f 726d 6174 7469  itional_formatti
-00041a60: 6e67 5f32 3031 3028 7365 6c66 2c20 6461  ng_2010(self, da
-00041a70: 7461 5f62 6172 293a 0a20 2020 2020 2020  ta_bar):.       
-00041a80: 2023 2057 7269 7465 2074 6865 203c 7831   # Write the <x1
-00041a90: 343a 636f 6e64 6974 696f 6e61 6c46 6f72  4:conditionalFor
-00041aa0: 6d61 7474 696e 673e 2065 6c65 6d65 6e74  matting> element
-00041ab0: 2e0a 2020 2020 2020 2020 786d 6c6e 735f  ..        xmlns_
-00041ac0: 786d 203d 2027 6874 7470 3a2f 2f73 6368  xm = 'http://sch
-00041ad0: 656d 6173 2e6d 6963 726f 736f 6674 2e63  emas.microsoft.c
-00041ae0: 6f6d 2f6f 6666 6963 652f 6578 6365 6c2f  om/office/excel/
-00041af0: 3230 3036 2f6d 6169 6e27 0a0a 2020 2020  2006/main'..    
-00041b00: 2020 2020 6174 7472 6962 7574 6573 203d      attributes =
-00041b10: 205b 2827 786d 6c6e 733a 786d 272c 2078   [('xmlns:xm', x
-00041b20: 6d6c 6e73 5f78 6d29 5d0a 0a20 2020 2020  mlns_xm)]..     
-00041b30: 2020 2073 656c 662e 5f78 6d6c 5f73 7461     self._xml_sta
-00041b40: 7274 5f74 6167 2827 7831 343a 636f 6e64  rt_tag('x14:cond
-00041b50: 6974 696f 6e61 6c46 6f72 6d61 7474 696e  itionalFormattin
-00041b60: 6727 2c20 6174 7472 6962 7574 6573 290a  g', attributes).
-00041b70: 0a20 2020 2020 2020 2023 2057 7269 7465  .        # Write
-00041b80: 2074 6865 2078 3134 3a63 6652 756c 6520   the x14:cfRule 
-00041b90: 656c 656d 656e 742e 0a20 2020 2020 2020  element..       
-00041ba0: 2073 656c 662e 5f77 7269 7465 5f78 3134   self._write_x14
-00041bb0: 5f63 665f 7275 6c65 2864 6174 615f 6261  _cf_rule(data_ba
-00041bc0: 7229 0a0a 2020 2020 2020 2020 2320 5772  r)..        # Wr
-00041bd0: 6974 6520 7468 6520 7831 343a 6461 7461  ite the x14:data
-00041be0: 4261 7220 656c 656d 656e 742e 0a20 2020  Bar element..   
-00041bf0: 2020 2020 2073 656c 662e 5f77 7269 7465       self._write
-00041c00: 5f78 3134 5f64 6174 615f 6261 7228 6461  _x14_data_bar(da
-00041c10: 7461 5f62 6172 290a 0a20 2020 2020 2020  ta_bar)..       
-00041c20: 2023 2057 7269 7465 2074 6865 2078 3134   # Write the x14
-00041c30: 206d 6178 2061 6e64 206d 696e 2064 6174   max and min dat
-00041c40: 6120 6261 7273 2e0a 2020 2020 2020 2020  a bars..        
-00041c50: 7365 6c66 2e5f 7772 6974 655f 7831 345f  self._write_x14_
-00041c60: 6366 766f 2864 6174 615f 6261 725b 2778  cfvo(data_bar['x
-00041c70: 3134 5f6d 696e 5f74 7970 6527 5d2c 2064  14_min_type'], d
-00041c80: 6174 615f 6261 725b 276d 696e 5f76 616c  ata_bar['min_val
-00041c90: 7565 275d 290a 2020 2020 2020 2020 7365  ue']).        se
-00041ca0: 6c66 2e5f 7772 6974 655f 7831 345f 6366  lf._write_x14_cf
-00041cb0: 766f 2864 6174 615f 6261 725b 2778 3134  vo(data_bar['x14
-00041cc0: 5f6d 6178 5f74 7970 6527 5d2c 2064 6174  _max_type'], dat
-00041cd0: 615f 6261 725b 276d 6178 5f76 616c 7565  a_bar['max_value
-00041ce0: 275d 290a 0a20 2020 2020 2020 2069 6620  '])..        if 
-00041cf0: 6e6f 7420 6461 7461 5f62 6172 5b27 6261  not data_bar['ba
-00041d00: 725f 6e6f 5f62 6f72 6465 7227 5d3a 0a20  r_no_border']:. 
-00041d10: 2020 2020 2020 2020 2020 2023 2057 7269             # Wri
-00041d20: 7465 2074 6865 2078 3134 3a62 6f72 6465  te the x14:borde
-00041d30: 7243 6f6c 6f72 2065 6c65 6d65 6e74 2e0a  rColor element..
-00041d40: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00041d50: 2e5f 7772 6974 655f 7831 345f 626f 7264  ._write_x14_bord
-00041d60: 6572 5f63 6f6c 6f72 2864 6174 615f 6261  er_color(data_ba
-00041d70: 725b 2762 6172 5f62 6f72 6465 725f 636f  r['bar_border_co
-00041d80: 6c6f 7227 5d29 0a0a 2020 2020 2020 2020  lor'])..        
-00041d90: 2320 5772 6974 6520 7468 6520 7831 343a  # Write the x14:
-00041da0: 6e65 6761 7469 7665 4669 6c6c 436f 6c6f  negativeFillColo
-00041db0: 7220 656c 656d 656e 742e 0a20 2020 2020  r element..     
-00041dc0: 2020 2069 6620 6e6f 7420 6461 7461 5f62     if not data_b
-00041dd0: 6172 5b27 6261 725f 6e65 6761 7469 7665  ar['bar_negative
-00041de0: 5f63 6f6c 6f72 5f73 616d 6527 5d3a 0a20  _color_same']:. 
-00041df0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00041e00: 5f77 7269 7465 5f78 3134 5f6e 6567 6174  _write_x14_negat
-00041e10: 6976 655f 6669 6c6c 5f63 6f6c 6f72 280a  ive_fill_color(.
-00041e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041e30: 6461 7461 5f62 6172 5b27 6261 725f 6e65  data_bar['bar_ne
-00041e40: 6761 7469 7665 5f63 6f6c 6f72 275d 290a  gative_color']).
-00041e50: 0a20 2020 2020 2020 2023 2057 7269 7465  .        # Write
-00041e60: 2074 6865 2078 3134 3a6e 6567 6174 6976   the x14:negativ
-00041e70: 6542 6f72 6465 7243 6f6c 6f72 2065 6c65  eBorderColor ele
-00041e80: 6d65 6e74 2e0a 2020 2020 2020 2020 6966  ment..        if
-00041e90: 2028 6e6f 7420 6461 7461 5f62 6172 5b27   (not data_bar['
-00041ea0: 6261 725f 6e6f 5f62 6f72 6465 7227 5d20  bar_no_border'] 
-00041eb0: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
-00041ec0: 2020 2020 6e6f 7420 6461 7461 5f62 6172      not data_bar
-00041ed0: 5b27 6261 725f 6e65 6761 7469 7665 5f62  ['bar_negative_b
-00041ee0: 6f72 6465 725f 636f 6c6f 725f 7361 6d65  order_color_same
-00041ef0: 275d 293a 0a20 2020 2020 2020 2020 2020  ']):.           
-00041f00: 2073 656c 662e 5f77 7269 7465 5f78 3134   self._write_x14
-00041f10: 5f6e 6567 6174 6976 655f 626f 7264 6572  _negative_border
-00041f20: 5f63 6f6c 6f72 280a 2020 2020 2020 2020  _color(.        
-00041f30: 2020 2020 2020 2020 6461 7461 5f62 6172          data_bar
-00041f40: 5b27 6261 725f 6e65 6761 7469 7665 5f62  ['bar_negative_b
-00041f50: 6f72 6465 725f 636f 6c6f 7227 5d29 0a0a  order_color'])..
-00041f60: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
-00041f70: 7468 6520 7831 343a 6178 6973 436f 6c6f  the x14:axisColo
-00041f80: 7220 656c 656d 656e 742e 0a20 2020 2020  r element..     
-00041f90: 2020 2069 6620 6461 7461 5f62 6172 5b27     if data_bar['
-00041fa0: 6261 725f 6178 6973 5f70 6f73 6974 696f  bar_axis_positio
-00041fb0: 6e27 5d20 213d 2027 6e6f 6e65 273a 0a20  n'] != 'none':. 
-00041fc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00041fd0: 5f77 7269 7465 5f78 3134 5f61 7869 735f  _write_x14_axis_
-00041fe0: 636f 6c6f 7228 6461 7461 5f62 6172 5b27  color(data_bar['
-00041ff0: 6261 725f 6178 6973 5f63 6f6c 6f72 275d  bar_axis_color']
-00042000: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-00042010: 5f78 6d6c 5f65 6e64 5f74 6167 2827 7831  _xml_end_tag('x1
-00042020: 343a 6461 7461 4261 7227 290a 2020 2020  4:dataBar').    
-00042030: 2020 2020 7365 6c66 2e5f 786d 6c5f 656e      self._xml_en
-00042040: 645f 7461 6728 2778 3134 3a63 6652 756c  d_tag('x14:cfRul
-00042050: 6527 290a 0a20 2020 2020 2020 2023 2057  e')..        # W
-00042060: 7269 7465 2074 6865 2078 6d3a 7371 7265  rite the xm:sqre
-00042070: 6620 656c 656d 656e 742e 0a20 2020 2020  f element..     
-00042080: 2020 2073 656c 662e 5f78 6d6c 5f64 6174     self._xml_dat
-00042090: 615f 656c 656d 656e 7428 2778 6d3a 7371  a_element('xm:sq
-000420a0: 7265 6627 2c20 6461 7461 5f62 6172 5b27  ref', data_bar['
-000420b0: 7261 6e67 6527 5d29 0a0a 2020 2020 2020  range'])..      
-000420c0: 2020 7365 6c66 2e5f 786d 6c5f 656e 645f    self._xml_end_
-000420d0: 7461 6728 2778 3134 3a63 6f6e 6469 7469  tag('x14:conditi
-000420e0: 6f6e 616c 466f 726d 6174 7469 6e67 2729  onalFormatting')
-000420f0: 0a0a 2020 2020 6465 6620 5f77 7269 7465  ..    def _write
-00042100: 5f78 3134 5f63 665f 7275 6c65 2873 656c  _x14_cf_rule(sel
-00042110: 662c 2064 6174 615f 6261 7229 3a0a 2020  f, data_bar):.  
-00042120: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
-00042130: 6520 3c78 3134 3a63 6652 756c 653e 2065  e <x14:cfRule> e
-00042140: 6c65 6d65 6e74 2e0a 2020 2020 2020 2020  lement..        
-00042150: 7275 6c65 5f74 7970 6520 3d20 2764 6174  rule_type = 'dat
-00042160: 6142 6172 270a 2020 2020 2020 2020 6775  aBar'.        gu
-00042170: 6964 203d 2064 6174 615f 6261 725b 2767  id = data_bar['g
-00042180: 7569 6427 5d0a 2020 2020 2020 2020 6174  uid'].        at
-00042190: 7472 6962 7574 6573 203d 205b 2827 7479  tributes = [('ty
-000421a0: 7065 272c 2072 756c 655f 7479 7065 292c  pe', rule_type),
-000421b0: 2028 2769 6427 2c20 6775 6964 295d 0a0a   ('id', guid)]..
-000421c0: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
-000421d0: 6c5f 7374 6172 745f 7461 6728 2778 3134  l_start_tag('x14
-000421e0: 3a63 6652 756c 6527 2c20 6174 7472 6962  :cfRule', attrib
-000421f0: 7574 6573 290a 0a20 2020 2064 6566 205f  utes)..    def _
-00042200: 7772 6974 655f 7831 345f 6461 7461 5f62  write_x14_data_b
-00042210: 6172 2873 656c 662c 2064 6174 615f 6261  ar(self, data_ba
-00042220: 7229 3a0a 2020 2020 2020 2020 2320 5772  r):.        # Wr
-00042230: 6974 6520 7468 6520 3c78 3134 3a64 6174  ite the <x14:dat
-00042240: 6142 6172 3e20 656c 656d 656e 742e 0a20  aBar> element.. 
-00042250: 2020 2020 2020 206d 696e 5f6c 656e 6774         min_lengt
-00042260: 6820 3d20 300a 2020 2020 2020 2020 6d61  h = 0.        ma
-00042270: 785f 6c65 6e67 7468 203d 2031 3030 0a0a  x_length = 100..
-00042280: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
-00042290: 6573 203d 205b 0a20 2020 2020 2020 2020  es = [.         
-000422a0: 2020 2028 276d 696e 4c65 6e67 7468 272c     ('minLength',
-000422b0: 206d 696e 5f6c 656e 6774 6829 2c0a 2020   min_length),.  
-000422c0: 2020 2020 2020 2020 2020 2827 6d61 784c            ('maxL
-000422d0: 656e 6774 6827 2c20 6d61 785f 6c65 6e67  ength', max_leng
-000422e0: 7468 292c 0a20 2020 2020 2020 205d 0a0a  th),.        ]..
-000422f0: 2020 2020 2020 2020 6966 206e 6f74 2064          if not d
-00042300: 6174 615f 6261 725b 2762 6172 5f6e 6f5f  ata_bar['bar_no_
-00042310: 626f 7264 6572 275d 3a0a 2020 2020 2020  border']:.      
-00042320: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-00042330: 2e61 7070 656e 6428 2827 626f 7264 6572  .append(('border
-00042340: 272c 2031 2929 0a0a 2020 2020 2020 2020  ', 1))..        
-00042350: 6966 2064 6174 615f 6261 725b 2762 6172  if data_bar['bar
-00042360: 5f73 6f6c 6964 275d 3a0a 2020 2020 2020  _solid']:.      
-00042370: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-00042380: 2e61 7070 656e 6428 2827 6772 6164 6965  .append(('gradie
-00042390: 6e74 272c 2030 2929 0a0a 2020 2020 2020  nt', 0))..      
-000423a0: 2020 6966 2064 6174 615f 6261 725b 2762    if data_bar['b
-000423b0: 6172 5f64 6972 6563 7469 6f6e 275d 203d  ar_direction'] =
-000423c0: 3d20 276c 6566 7427 3a0a 2020 2020 2020  = 'left':.      
-000423d0: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-000423e0: 2e61 7070 656e 6428 2827 6469 7265 6374  .append(('direct
-000423f0: 696f 6e27 2c20 276c 6566 7454 6f52 6967  ion', 'leftToRig
-00042400: 6874 2729 290a 0a20 2020 2020 2020 2069  ht'))..        i
-00042410: 6620 6461 7461 5f62 6172 5b27 6261 725f  f data_bar['bar_
-00042420: 6469 7265 6374 696f 6e27 5d20 3d3d 2027  direction'] == '
-00042430: 7269 6768 7427 3a0a 2020 2020 2020 2020  right':.        
-00042440: 2020 2020 6174 7472 6962 7574 6573 2e61      attributes.a
-00042450: 7070 656e 6428 2827 6469 7265 6374 696f  ppend(('directio
-00042460: 6e27 2c20 2772 6967 6874 546f 4c65 6674  n', 'rightToLeft
-00042470: 2729 290a 0a20 2020 2020 2020 2069 6620  '))..        if 
-00042480: 6461 7461 5f62 6172 5b27 6261 725f 6e65  data_bar['bar_ne
-00042490: 6761 7469 7665 5f63 6f6c 6f72 5f73 616d  gative_color_sam
-000424a0: 6527 5d3a 0a20 2020 2020 2020 2020 2020  e']:.           
-000424b0: 2061 7474 7269 6275 7465 732e 6170 7065   attributes.appe
-000424c0: 6e64 2828 276e 6567 6174 6976 6542 6172  nd(('negativeBar
-000424d0: 436f 6c6f 7253 616d 6541 7350 6f73 6974  ColorSameAsPosit
-000424e0: 6976 6527 2c20 3129 290a 0a20 2020 2020  ive', 1))..     
-000424f0: 2020 2069 6620 286e 6f74 2064 6174 615f     if (not data_
-00042500: 6261 725b 2762 6172 5f6e 6f5f 626f 7264  bar['bar_no_bord
-00042510: 6572 275d 2061 6e64 0a20 2020 2020 2020  er'] and.       
-00042520: 2020 2020 2020 2020 206e 6f74 2064 6174           not dat
-00042530: 615f 6261 725b 2762 6172 5f6e 6567 6174  a_bar['bar_negat
-00042540: 6976 655f 626f 7264 6572 5f63 6f6c 6f72  ive_border_color
-00042550: 5f73 616d 6527 5d29 3a0a 2020 2020 2020  _same']):.      
-00042560: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-00042570: 2e61 7070 656e 6428 2827 6e65 6761 7469  .append(('negati
-00042580: 7665 4261 7242 6f72 6465 7243 6f6c 6f72  veBarBorderColor
-00042590: 5361 6d65 4173 506f 7369 7469 7665 272c  SameAsPositive',
-000425a0: 2030 2929 0a0a 2020 2020 2020 2020 6966   0))..        if
-000425b0: 2064 6174 615f 6261 725b 2762 6172 5f61   data_bar['bar_a
-000425c0: 7869 735f 706f 7369 7469 6f6e 275d 203d  xis_position'] =
-000425d0: 3d20 276d 6964 646c 6527 3a0a 2020 2020  = 'middle':.    
-000425e0: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
-000425f0: 6573 2e61 7070 656e 6428 2827 6178 6973  es.append(('axis
-00042600: 506f 7369 7469 6f6e 272c 2027 6d69 6464  Position', 'midd
-00042610: 6c65 2729 290a 0a20 2020 2020 2020 2069  le'))..        i
-00042620: 6620 6461 7461 5f62 6172 5b27 6261 725f  f data_bar['bar_
-00042630: 6178 6973 5f70 6f73 6974 696f 6e27 5d20  axis_position'] 
-00042640: 3d3d 2027 6e6f 6e65 273a 0a20 2020 2020  == 'none':.     
-00042650: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
-00042660: 732e 6170 7065 6e64 2828 2761 7869 7350  s.append(('axisP
-00042670: 6f73 6974 696f 6e27 2c20 276e 6f6e 6527  osition', 'none'
-00042680: 2929 0a0a 2020 2020 2020 2020 7365 6c66  ))..        self
-00042690: 2e5f 786d 6c5f 7374 6172 745f 7461 6728  ._xml_start_tag(
-000426a0: 2778 3134 3a64 6174 6142 6172 272c 2061  'x14:dataBar', a
-000426b0: 7474 7269 6275 7465 7329 0a0a 2020 2020  ttributes)..    
-000426c0: 6465 6620 5f77 7269 7465 5f78 3134 5f63  def _write_x14_c
-000426d0: 6676 6f28 7365 6c66 2c20 7275 6c65 5f74  fvo(self, rule_t
-000426e0: 7970 652c 2076 616c 7565 293a 0a20 2020  ype, value):.   
-000426f0: 2020 2020 2023 2057 7269 7465 2074 6865       # Write the
-00042700: 203c 7831 343a 6366 766f 3e20 656c 656d   <x14:cfvo> elem
-00042710: 656e 742e 0a20 2020 2020 2020 2061 7474  ent..        att
-00042720: 7269 6275 7465 7320 3d20 5b28 2774 7970  ributes = [('typ
-00042730: 6527 2c20 7275 6c65 5f74 7970 6529 5d0a  e', rule_type)].
-00042740: 0a20 2020 2020 2020 2069 6620 7275 6c65  .        if rule
-00042750: 5f74 7970 6520 696e 2028 276d 696e 272c  _type in ('min',
-00042760: 2027 6d61 7827 2c20 2761 7574 6f4d 696e   'max', 'autoMin
-00042770: 272c 2027 6175 746f 4d61 7827 293a 0a20  ', 'autoMax'):. 
-00042780: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00042790: 5f78 6d6c 5f65 6d70 7479 5f74 6167 2827  _xml_empty_tag('
-000427a0: 7831 343a 6366 766f 272c 2061 7474 7269  x14:cfvo', attri
-000427b0: 6275 7465 7329 0a20 2020 2020 2020 2065  butes).        e
-000427c0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000427d0: 2073 656c 662e 5f78 6d6c 5f73 7461 7274   self._xml_start
-000427e0: 5f74 6167 2827 7831 343a 6366 766f 272c  _tag('x14:cfvo',
-000427f0: 2061 7474 7269 6275 7465 7329 0a20 2020   attributes).   
-00042800: 2020 2020 2020 2020 2073 656c 662e 5f78           self._x
-00042810: 6d6c 5f64 6174 615f 656c 656d 656e 7428  ml_data_element(
-00042820: 2778 6d3a 6627 2c20 7661 6c75 6529 0a20  'xm:f', value). 
-00042830: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00042840: 5f78 6d6c 5f65 6e64 5f74 6167 2827 7831  _xml_end_tag('x1
-00042850: 343a 6366 766f 2729 0a0a 2020 2020 6465  4:cfvo')..    de
-00042860: 6620 5f77 7269 7465 5f78 3134 5f62 6f72  f _write_x14_bor
-00042870: 6465 725f 636f 6c6f 7228 7365 6c66 2c20  der_color(self, 
-00042880: 7267 6229 3a0a 2020 2020 2020 2020 2320  rgb):.        # 
-00042890: 5772 6974 6520 7468 6520 3c78 3134 3a62  Write the <x14:b
-000428a0: 6f72 6465 7243 6f6c 6f72 3e20 656c 656d  orderColor> elem
-000428b0: 656e 742e 0a20 2020 2020 2020 2061 7474  ent..        att
-000428c0: 7269 6275 7465 7320 3d20 5b28 2772 6762  ributes = [('rgb
-000428d0: 272c 2072 6762 295d 0a20 2020 2020 2020  ', rgb)].       
-000428e0: 2073 656c 662e 5f78 6d6c 5f65 6d70 7479   self._xml_empty
-000428f0: 5f74 6167 2827 7831 343a 626f 7264 6572  _tag('x14:border
-00042900: 436f 6c6f 7227 2c20 6174 7472 6962 7574  Color', attribut
-00042910: 6573 290a 0a20 2020 2064 6566 205f 7772  es)..    def _wr
-00042920: 6974 655f 7831 345f 6e65 6761 7469 7665  ite_x14_negative
-00042930: 5f66 696c 6c5f 636f 6c6f 7228 7365 6c66  _fill_color(self
-00042940: 2c20 7267 6229 3a0a 2020 2020 2020 2020  , rgb):.        
-00042950: 2320 5772 6974 6520 7468 6520 3c78 3134  # Write the <x14
-00042960: 3a6e 6567 6174 6976 6546 696c 6c43 6f6c  :negativeFillCol
-00042970: 6f72 3e20 656c 656d 656e 742e 0a20 2020  or> element..   
-00042980: 2020 2020 2061 7474 7269 6275 7465 7320       attributes 
-00042990: 3d20 5b28 2772 6762 272c 2072 6762 295d  = [('rgb', rgb)]
-000429a0: 0a20 2020 2020 2020 2073 656c 662e 5f78  .        self._x
-000429b0: 6d6c 5f65 6d70 7479 5f74 6167 2827 7831  ml_empty_tag('x1
-000429c0: 343a 6e65 6761 7469 7665 4669 6c6c 436f  4:negativeFillCo
-000429d0: 6c6f 7227 2c20 6174 7472 6962 7574 6573  lor', attributes
-000429e0: 290a 0a20 2020 2064 6566 205f 7772 6974  )..    def _writ
-000429f0: 655f 7831 345f 6e65 6761 7469 7665 5f62  e_x14_negative_b
-00042a00: 6f72 6465 725f 636f 6c6f 7228 7365 6c66  order_color(self
-00042a10: 2c20 7267 6229 3a0a 2020 2020 2020 2020  , rgb):.        
-00042a20: 2320 5772 6974 6520 7468 6520 3c78 3134  # Write the <x14
-00042a30: 3a6e 6567 6174 6976 6542 6f72 6465 7243  :negativeBorderC
-00042a40: 6f6c 6f72 3e20 656c 656d 656e 742e 0a20  olor> element.. 
-00042a50: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
-00042a60: 7320 3d20 5b28 2772 6762 272c 2072 6762  s = [('rgb', rgb
-00042a70: 295d 0a20 2020 2020 2020 2073 656c 662e  )].        self.
-00042a80: 5f78 6d6c 5f65 6d70 7479 5f74 6167 2827  _xml_empty_tag('
-00042a90: 7831 343a 6e65 6761 7469 7665 426f 7264  x14:negativeBord
-00042aa0: 6572 436f 6c6f 7227 2c20 6174 7472 6962  erColor', attrib
-00042ab0: 7574 6573 290a 0a20 2020 2064 6566 205f  utes)..    def _
-00042ac0: 7772 6974 655f 7831 345f 6178 6973 5f63  write_x14_axis_c
-00042ad0: 6f6c 6f72 2873 656c 662c 2072 6762 293a  olor(self, rgb):
-00042ae0: 0a20 2020 2020 2020 2023 2057 7269 7465  .        # Write
-00042af0: 2074 6865 203c 7831 343a 6178 6973 436f   the <x14:axisCo
-00042b00: 6c6f 723e 2065 6c65 6d65 6e74 2e0a 2020  lor> element..  
-00042b10: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-00042b20: 203d 205b 2827 7267 6227 2c20 7267 6229   = [('rgb', rgb)
-00042b30: 5d0a 2020 2020 2020 2020 7365 6c66 2e5f  ].        self._
-00042b40: 786d 6c5f 656d 7074 795f 7461 6728 2778  xml_empty_tag('x
-00042b50: 3134 3a61 7869 7343 6f6c 6f72 272c 2061  14:axisColor', a
-00042b60: 7474 7269 6275 7465 7329 0a0a 2020 2020  ttributes)..    
-00042b70: 6465 6620 5f77 7269 7465 5f65 7874 5f6c  def _write_ext_l
-00042b80: 6973 745f 7370 6172 6b6c 696e 6573 2873  ist_sparklines(s
-00042b90: 656c 6629 3a0a 2020 2020 2020 2020 2320  elf):.        # 
-00042ba0: 5772 6974 6520 7468 6520 7370 6172 6b6c  Write the sparkl
-00042bb0: 696e 6520 6578 7465 6e73 696f 6e20 7375  ine extension su
-00042bc0: 622d 656c 656d 656e 7473 2e0a 2020 2020  b-elements..    
-00042bd0: 2020 2020 7365 6c66 2e5f 7772 6974 655f      self._write_
-00042be0: 6578 7428 277b 3035 4336 3035 3335 2d31  ext('{05C60535-1
-00042bf0: 4631 362d 3466 6432 2d42 3633 332d 4634  F16-4fd2-B633-F4
-00042c00: 4633 3646 3042 3634 4530 7d27 290a 0a20  F36F0B64E0}').. 
-00042c10: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
-00042c20: 6865 2078 3134 3a73 7061 726b 6c69 6e65  he x14:sparkline
-00042c30: 4772 6f75 7073 2065 6c65 6d65 6e74 2e0a  Groups element..
-00042c40: 2020 2020 2020 2020 7365 6c66 2e5f 7772          self._wr
-00042c50: 6974 655f 7370 6172 6b6c 696e 655f 6772  ite_sparkline_gr
-00042c60: 6f75 7073 2829 0a0a 2020 2020 2020 2020  oups()..        
-00042c70: 2320 5772 6974 6520 7468 6520 7370 6172  # Write the spar
-00042c80: 6b6c 696e 6520 656c 656d 656e 7473 2e0a  kline elements..
-00042c90: 2020 2020 2020 2020 666f 7220 7370 6172          for spar
-00042ca0: 6b6c 696e 6520 696e 2072 6576 6572 7365  kline in reverse
-00042cb0: 6428 7365 6c66 2e73 7061 726b 6c69 6e65  d(self.sparkline
-00042cc0: 7329 3a0a 0a20 2020 2020 2020 2020 2020  s):..           
-00042cd0: 2023 2057 7269 7465 2074 6865 2078 3134   # Write the x14
-00042ce0: 3a73 7061 726b 6c69 6e65 4772 6f75 7020  :sparklineGroup 
-00042cf0: 656c 656d 656e 742e 0a20 2020 2020 2020  element..       
-00042d00: 2020 2020 2073 656c 662e 5f77 7269 7465       self._write
-00042d10: 5f73 7061 726b 6c69 6e65 5f67 726f 7570  _sparkline_group
-00042d20: 2873 7061 726b 6c69 6e65 290a 0a20 2020  (sparkline)..   
-00042d30: 2020 2020 2020 2020 2023 2057 7269 7465           # Write
-00042d40: 2074 6865 2078 3134 3a63 6f6c 6f72 5365   the x14:colorSe
-00042d50: 7269 6573 2065 6c65 6d65 6e74 2e0a 2020  ries element..  
-00042d60: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00042d70: 7772 6974 655f 636f 6c6f 725f 7365 7269  write_color_seri
-00042d80: 6573 2873 7061 726b 6c69 6e65 5b27 7365  es(sparkline['se
-00042d90: 7269 6573 5f63 6f6c 6f72 275d 290a 0a20  ries_color']).. 
-00042da0: 2020 2020 2020 2020 2020 2023 2057 7269             # Wri
-00042db0: 7465 2074 6865 2078 3134 3a63 6f6c 6f72  te the x14:color
-00042dc0: 4e65 6761 7469 7665 2065 6c65 6d65 6e74  Negative element
-00042dd0: 2e0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00042de0: 6c66 2e5f 7772 6974 655f 636f 6c6f 725f  lf._write_color_
-00042df0: 6e65 6761 7469 7665 2873 7061 726b 6c69  negative(sparkli
-00042e00: 6e65 5b27 6e65 6761 7469 7665 5f63 6f6c  ne['negative_col
-00042e10: 6f72 275d 290a 0a20 2020 2020 2020 2020  or'])..         
-00042e20: 2020 2023 2057 7269 7465 2074 6865 2078     # Write the x
-00042e30: 3134 3a63 6f6c 6f72 4178 6973 2065 6c65  14:colorAxis ele
-00042e40: 6d65 6e74 2e0a 2020 2020 2020 2020 2020  ment..          
-00042e50: 2020 7365 6c66 2e5f 7772 6974 655f 636f    self._write_co
-00042e60: 6c6f 725f 6178 6973 2829 0a0a 2020 2020  lor_axis()..    
-00042e70: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
-00042e80: 7468 6520 7831 343a 636f 6c6f 724d 6172  the x14:colorMar
-00042e90: 6b65 7273 2065 6c65 6d65 6e74 2e0a 2020  kers element..  
-00042ea0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00042eb0: 7772 6974 655f 636f 6c6f 725f 6d61 726b  write_color_mark
-00042ec0: 6572 7328 7370 6172 6b6c 696e 655b 276d  ers(sparkline['m
-00042ed0: 6172 6b65 7273 5f63 6f6c 6f72 275d 290a  arkers_color']).
-00042ee0: 0a20 2020 2020 2020 2020 2020 2023 2057  .            # W
-00042ef0: 7269 7465 2074 6865 2078 3134 3a63 6f6c  rite the x14:col
-00042f00: 6f72 4669 7273 7420 656c 656d 656e 742e  orFirst element.
-00042f10: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00042f20: 662e 5f77 7269 7465 5f63 6f6c 6f72 5f66  f._write_color_f
-00042f30: 6972 7374 2873 7061 726b 6c69 6e65 5b27  irst(sparkline['
-00042f40: 6669 7273 745f 636f 6c6f 7227 5d29 0a0a  first_color'])..
-00042f50: 2020 2020 2020 2020 2020 2020 2320 5772              # Wr
-00042f60: 6974 6520 7468 6520 7831 343a 636f 6c6f  ite the x14:colo
-00042f70: 724c 6173 7420 656c 656d 656e 742e 0a20  rLast element.. 
-00042f80: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00042f90: 5f77 7269 7465 5f63 6f6c 6f72 5f6c 6173  _write_color_las
-00042fa0: 7428 7370 6172 6b6c 696e 655b 276c 6173  t(sparkline['las
-00042fb0: 745f 636f 6c6f 7227 5d29 0a0a 2020 2020  t_color'])..    
-00042fc0: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
-00042fd0: 7468 6520 7831 343a 636f 6c6f 7248 6967  the x14:colorHig
-00042fe0: 6820 656c 656d 656e 742e 0a20 2020 2020  h element..     
-00042ff0: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
-00043000: 7465 5f63 6f6c 6f72 5f68 6967 6828 7370  te_color_high(sp
-00043010: 6172 6b6c 696e 655b 2768 6967 685f 636f  arkline['high_co
-00043020: 6c6f 7227 5d29 0a0a 2020 2020 2020 2020  lor'])..        
-00043030: 2020 2020 2320 5772 6974 6520 7468 6520      # Write the 
-00043040: 7831 343a 636f 6c6f 724c 6f77 2065 6c65  x14:colorLow ele
-00043050: 6d65 6e74 2e0a 2020 2020 2020 2020 2020  ment..          
-00043060: 2020 7365 6c66 2e5f 7772 6974 655f 636f    self._write_co
-00043070: 6c6f 725f 6c6f 7728 7370 6172 6b6c 696e  lor_low(sparklin
-00043080: 655b 276c 6f77 5f63 6f6c 6f72 275d 290a  e['low_color']).
-00043090: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000430a0: 7370 6172 6b6c 696e 655b 2764 6174 655f  sparkline['date_
-000430b0: 6178 6973 275d 3a0a 2020 2020 2020 2020  axis']:.        
-000430c0: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
-000430d0: 6c5f 6461 7461 5f65 6c65 6d65 6e74 2827  l_data_element('
-000430e0: 786d 3a66 272c 2073 7061 726b 6c69 6e65  xm:f', sparkline
-000430f0: 5b27 6461 7465 5f61 7869 7327 5d29 0a0a  ['date_axis'])..
-00043100: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00043110: 2e5f 7772 6974 655f 7370 6172 6b6c 696e  ._write_sparklin
-00043120: 6573 2873 7061 726b 6c69 6e65 290a 0a20  es(sparkline).. 
-00043130: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00043140: 5f78 6d6c 5f65 6e64 5f74 6167 2827 7831  _xml_end_tag('x1
-00043150: 343a 7370 6172 6b6c 696e 6547 726f 7570  4:sparklineGroup
-00043160: 2729 0a0a 2020 2020 2020 2020 7365 6c66  ')..        self
-00043170: 2e5f 786d 6c5f 656e 645f 7461 6728 2778  ._xml_end_tag('x
-00043180: 3134 3a73 7061 726b 6c69 6e65 4772 6f75  14:sparklineGrou
-00043190: 7073 2729 0a20 2020 2020 2020 2073 656c  ps').        sel
-000431a0: 662e 5f78 6d6c 5f65 6e64 5f74 6167 2827  f._xml_end_tag('
-000431b0: 6578 7427 290a 0a20 2020 2064 6566 205f  ext')..    def _
-000431c0: 7772 6974 655f 7370 6172 6b6c 696e 6573  write_sparklines
-000431d0: 2873 656c 662c 2073 7061 726b 6c69 6e65  (self, sparkline
-000431e0: 293a 0a20 2020 2020 2020 2023 2057 7269  ):.        # Wri
-000431f0: 7465 2074 6865 203c 7831 343a 7370 6172  te the <x14:spar
-00043200: 6b6c 696e 6573 3e20 656c 656d 656e 7420  klines> element 
-00043210: 616e 6420 3c78 3134 3a73 7061 726b 6c69  and <x14:sparkli
-00043220: 6e65 3e20 7375 622d 656c 656d 656e 7473  ne> sub-elements
-00043230: 2e0a 0a20 2020 2020 2020 2023 2057 7269  ...        # Wri
-00043240: 7465 2074 6865 2073 7061 726b 6c69 6e65  te the sparkline
-00043250: 2065 6c65 6d65 6e74 732e 0a20 2020 2020   elements..     
-00043260: 2020 2073 656c 662e 5f78 6d6c 5f73 7461     self._xml_sta
-00043270: 7274 5f74 6167 2827 7831 343a 7370 6172  rt_tag('x14:spar
-00043280: 6b6c 696e 6573 2729 0a0a 2020 2020 2020  klines')..      
-00043290: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-000432a0: 2873 7061 726b 6c69 6e65 5b27 636f 756e  (sparkline['coun
-000432b0: 7427 5d29 3a0a 2020 2020 2020 2020 2020  t']):.          
-000432c0: 2020 7370 6172 6b5f 7261 6e67 6520 3d20    spark_range = 
-000432d0: 7370 6172 6b6c 696e 655b 2772 616e 6765  sparkline['range
-000432e0: 7327 5d5b 695d 0a20 2020 2020 2020 2020  s'][i].         
-000432f0: 2020 206c 6f63 6174 696f 6e20 3d20 7370     location = sp
-00043300: 6172 6b6c 696e 655b 276c 6f63 6174 696f  arkline['locatio
-00043310: 6e73 275d 5b69 5d0a 0a20 2020 2020 2020  ns'][i]..       
-00043320: 2020 2020 2073 656c 662e 5f78 6d6c 5f73       self._xml_s
-00043330: 7461 7274 5f74 6167 2827 7831 343a 7370  tart_tag('x14:sp
-00043340: 6172 6b6c 696e 6527 290a 2020 2020 2020  arkline').      
-00043350: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
-00043360: 6461 7461 5f65 6c65 6d65 6e74 2827 786d  data_element('xm
-00043370: 3a66 272c 2073 7061 726b 5f72 616e 6765  :f', spark_range
-00043380: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-00043390: 6c66 2e5f 786d 6c5f 6461 7461 5f65 6c65  lf._xml_data_ele
-000433a0: 6d65 6e74 2827 786d 3a73 7172 6566 272c  ment('xm:sqref',
-000433b0: 206c 6f63 6174 696f 6e29 0a20 2020 2020   location).     
-000433c0: 2020 2020 2020 2073 656c 662e 5f78 6d6c         self._xml
-000433d0: 5f65 6e64 5f74 6167 2827 7831 343a 7370  _end_tag('x14:sp
-000433e0: 6172 6b6c 696e 6527 290a 0a20 2020 2020  arkline')..     
-000433f0: 2020 2073 656c 662e 5f78 6d6c 5f65 6e64     self._xml_end
-00043400: 5f74 6167 2827 7831 343a 7370 6172 6b6c  _tag('x14:sparkl
-00043410: 696e 6573 2729 0a0a 2020 2020 6465 6620  ines')..    def 
-00043420: 5f77 7269 7465 5f65 7874 2873 656c 662c  _write_ext(self,
-00043430: 2075 7269 293a 0a20 2020 2020 2020 2023   uri):.        #
-00043440: 2057 7269 7465 2074 6865 203c 6578 743e   Write the <ext>
-00043450: 2065 6c65 6d65 6e74 2e0a 2020 2020 2020   element..      
-00043460: 2020 7363 6865 6d61 203d 2027 6874 7470    schema = 'http
-00043470: 3a2f 2f73 6368 656d 6173 2e6d 6963 726f  ://schemas.micro
-00043480: 736f 6674 2e63 6f6d 2f6f 6666 6963 652f  soft.com/office/
-00043490: 270a 2020 2020 2020 2020 786d 6c6e 735f  '.        xmlns_
-000434a0: 7831 3420 3d20 7363 6865 6d61 202b 2027  x14 = schema + '
-000434b0: 7370 7265 6164 7368 6565 746d 6c2f 3230  spreadsheetml/20
-000434c0: 3039 2f39 2f6d 6169 6e27 0a0a 2020 2020  09/9/main'..    
-000434d0: 2020 2020 6174 7472 6962 7574 6573 203d      attributes =
-000434e0: 205b 0a20 2020 2020 2020 2020 2020 2028   [.            (
-000434f0: 2778 6d6c 6e73 3a78 3134 272c 2078 6d6c  'xmlns:x14', xml
-00043500: 6e73 5f78 3134 292c 0a20 2020 2020 2020  ns_x14),.       
-00043510: 2020 2020 2028 2775 7269 272c 2075 7269       ('uri', uri
-00043520: 292c 0a20 2020 2020 2020 205d 0a0a 2020  ),.        ]..  
-00043530: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
-00043540: 7374 6172 745f 7461 6728 2765 7874 272c  start_tag('ext',
-00043550: 2061 7474 7269 6275 7465 7329 0a0a 2020   attributes)..  
-00043560: 2020 6465 6620 5f77 7269 7465 5f73 7061    def _write_spa
-00043570: 726b 6c69 6e65 5f67 726f 7570 7328 7365  rkline_groups(se
-00043580: 6c66 293a 0a20 2020 2020 2020 2023 2057  lf):.        # W
-00043590: 7269 7465 2074 6865 203c 7831 343a 7370  rite the <x14:sp
-000435a0: 6172 6b6c 696e 6547 726f 7570 733e 2065  arklineGroups> e
-000435b0: 6c65 6d65 6e74 2e0a 2020 2020 2020 2020  lement..        
-000435c0: 786d 6c6e 735f 786d 203d 2027 6874 7470  xmlns_xm = 'http
-000435d0: 3a2f 2f73 6368 656d 6173 2e6d 6963 726f  ://schemas.micro
-000435e0: 736f 6674 2e63 6f6d 2f6f 6666 6963 652f  soft.com/office/
-000435f0: 6578 6365 6c2f 3230 3036 2f6d 6169 6e27  excel/2006/main'
-00043600: 0a0a 2020 2020 2020 2020 6174 7472 6962  ..        attrib
-00043610: 7574 6573 203d 205b 2827 786d 6c6e 733a  utes = [('xmlns:
-00043620: 786d 272c 2078 6d6c 6e73 5f78 6d29 5d0a  xm', xmlns_xm)].
-00043630: 0a20 2020 2020 2020 2073 656c 662e 5f78  .        self._x
-00043640: 6d6c 5f73 7461 7274 5f74 6167 2827 7831  ml_start_tag('x1
-00043650: 343a 7370 6172 6b6c 696e 6547 726f 7570  4:sparklineGroup
-00043660: 7327 2c20 6174 7472 6962 7574 6573 290a  s', attributes).
-00043670: 0a20 2020 2064 6566 205f 7772 6974 655f  .    def _write_
-00043680: 7370 6172 6b6c 696e 655f 6772 6f75 7028  sparkline_group(
-00043690: 7365 6c66 2c20 6f70 7469 6f6e 7329 3a0a  self, options):.
-000436a0: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
-000436b0: 7468 6520 3c78 3134 3a73 7061 726b 6c69  the <x14:sparkli
-000436c0: 6e65 4772 6f75 703e 2065 6c65 6d65 6e74  neGroup> element
-000436d0: 2e0a 2020 2020 2020 2020 230a 2020 2020  ..        #.    
-000436e0: 2020 2020 2320 4578 616d 706c 6520 666f      # Example fo
-000436f0: 7220 6f72 6465 722e 0a20 2020 2020 2020  r order..       
-00043700: 2023 0a20 2020 2020 2020 2023 203c 7831   #.        # <x1
-00043710: 343a 7370 6172 6b6c 696e 6547 726f 7570  4:sparklineGroup
-00043720: 0a20 2020 2020 2020 2023 2020 2020 206d  .        #     m
-00043730: 616e 7561 6c4d 6178 3d22 3022 0a20 2020  anualMax="0".   
-00043740: 2020 2020 2023 2020 2020 206d 616e 7561       #     manua
-00043750: 6c4d 696e 3d22 3022 0a20 2020 2020 2020  lMin="0".       
-00043760: 2023 2020 2020 206c 696e 6557 6569 6768   #     lineWeigh
-00043770: 743d 2232 2e32 3522 0a20 2020 2020 2020  t="2.25".       
-00043780: 2023 2020 2020 2074 7970 653d 2263 6f6c   #     type="col
-00043790: 756d 6e22 0a20 2020 2020 2020 2023 2020  umn".        #  
-000437a0: 2020 2064 6174 6541 7869 733d 2231 220a     dateAxis="1".
-000437b0: 2020 2020 2020 2020 2320 2020 2020 6469          #     di
-000437c0: 7370 6c61 7945 6d70 7479 4365 6c6c 7341  splayEmptyCellsA
-000437d0: 733d 2273 7061 6e22 0a20 2020 2020 2020  s="span".       
-000437e0: 2023 2020 2020 206d 6172 6b65 7273 3d22   #     markers="
-000437f0: 3122 0a20 2020 2020 2020 2023 2020 2020  1".        #    
-00043800: 2068 6967 683d 2231 220a 2020 2020 2020   high="1".      
-00043810: 2020 2320 2020 2020 6c6f 773d 2231 220a    #     low="1".
-00043820: 2020 2020 2020 2020 2320 2020 2020 6669          #     fi
-00043830: 7273 743d 2231 220a 2020 2020 2020 2020  rst="1".        
-00043840: 2320 2020 2020 6c61 7374 3d22 3122 0a20  #     last="1". 
-00043850: 2020 2020 2020 2023 2020 2020 206e 6567         #     neg
-00043860: 6174 6976 653d 2231 220a 2020 2020 2020  ative="1".      
-00043870: 2020 2320 2020 2020 6469 7370 6c61 7958    #     displayX
-00043880: 4178 6973 3d22 3122 0a20 2020 2020 2020  Axis="1".       
-00043890: 2023 2020 2020 2064 6973 706c 6179 4869   #     displayHi
-000438a0: 6464 656e 3d22 3122 0a20 2020 2020 2020  dden="1".       
-000438b0: 2023 2020 2020 206d 696e 4178 6973 5479   #     minAxisTy
-000438c0: 7065 3d22 6375 7374 6f6d 220a 2020 2020  pe="custom".    
-000438d0: 2020 2020 2320 2020 2020 6d61 7841 7869      #     maxAxi
-000438e0: 7354 7970 653d 2263 7573 746f 6d22 0a20  sType="custom". 
-000438f0: 2020 2020 2020 2023 2020 2020 2072 6967         #     rig
-00043900: 6874 546f 4c65 6674 3d22 3122 3e0a 2020  htToLeft="1">.  
-00043910: 2020 2020 2020 230a 2020 2020 2020 2020        #.        
-00043920: 656d 7074 7920 3d20 6f70 7469 6f6e 732e  empty = options.
-00043930: 6765 7428 2765 6d70 7479 2729 0a20 2020  get('empty').   
-00043940: 2020 2020 2061 7474 7269 6275 7465 7320       attributes 
-00043950: 3d20 5b5d 0a0a 2020 2020 2020 2020 6966  = []..        if
-00043960: 206f 7074 696f 6e73 2e67 6574 2827 6d61   options.get('ma
-00043970: 7827 2920 6973 206e 6f74 204e 6f6e 653a  x') is not None:
-00043980: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00043990: 6f70 7469 6f6e 735b 276d 6178 275d 203d  options['max'] =
-000439a0: 3d20 2767 726f 7570 273a 0a20 2020 2020  = 'group':.     
-000439b0: 2020 2020 2020 2020 2020 206f 7074 696f             optio
-000439c0: 6e73 5b27 6375 7374 5f6d 6178 275d 203d  ns['cust_max'] =
-000439d0: 2027 6772 6f75 7027 0a20 2020 2020 2020   'group'.       
-000439e0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000439f0: 2020 2020 2020 2020 2020 2061 7474 7269             attri
-00043a00: 6275 7465 732e 6170 7065 6e64 2828 276d  butes.append(('m
-00043a10: 616e 7561 6c4d 6178 272c 206f 7074 696f  anualMax', optio
-00043a20: 6e73 5b27 6d61 7827 5d29 290a 2020 2020  ns['max'])).    
-00043a30: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
-00043a40: 6f6e 735b 2763 7573 745f 6d61 7827 5d20  ons['cust_max'] 
-00043a50: 3d20 2763 7573 746f 6d27 0a0a 2020 2020  = 'custom'..    
-00043a60: 2020 2020 6966 206f 7074 696f 6e73 2e67      if options.g
-00043a70: 6574 2827 6d69 6e27 2920 6973 206e 6f74  et('min') is not
-00043a80: 204e 6f6e 653a 0a0a 2020 2020 2020 2020   None:..        
-00043a90: 2020 2020 6966 206f 7074 696f 6e73 5b27      if options['
-00043aa0: 6d69 6e27 5d20 3d3d 2027 6772 6f75 7027  min'] == 'group'
-00043ab0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00043ac0: 2020 6f70 7469 6f6e 735b 2763 7573 745f    options['cust_
-00043ad0: 6d69 6e27 5d20 3d20 2767 726f 7570 270a  min'] = 'group'.
-00043ae0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00043af0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00043b00: 2020 6174 7472 6962 7574 6573 2e61 7070    attributes.app
-00043b10: 656e 6428 2827 6d61 6e75 616c 4d69 6e27  end(('manualMin'
-00043b20: 2c20 6f70 7469 6f6e 735b 276d 696e 275d  , options['min']
-00043b30: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-00043b40: 2020 206f 7074 696f 6e73 5b27 6375 7374     options['cust
-00043b50: 5f6d 696e 275d 203d 2027 6375 7374 6f6d  _min'] = 'custom
-00043b60: 270a 0a20 2020 2020 2020 2023 2049 676e  '..        # Ign
-00043b70: 6f72 6520 7468 6520 6465 6661 756c 7420  ore the default 
-00043b80: 7479 7065 2061 7474 7269 6275 7465 2028  type attribute (
-00043b90: 6c69 6e65 292e 0a20 2020 2020 2020 2069  line)..        i
-00043ba0: 6620 6f70 7469 6f6e 735b 2774 7970 6527  f options['type'
-00043bb0: 5d20 213d 2027 6c69 6e65 273a 0a20 2020  ] != 'line':.   
-00043bc0: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
-00043bd0: 7465 732e 6170 7065 6e64 2828 2774 7970  tes.append(('typ
-00043be0: 6527 2c20 6f70 7469 6f6e 735b 2774 7970  e', options['typ
-00043bf0: 6527 5d29 290a 0a20 2020 2020 2020 2069  e']))..        i
-00043c00: 6620 6f70 7469 6f6e 732e 6765 7428 2777  f options.get('w
-00043c10: 6569 6768 7427 293a 0a20 2020 2020 2020  eight'):.       
-00043c20: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
-00043c30: 6170 7065 6e64 2828 276c 696e 6557 6569  append(('lineWei
-00043c40: 6768 7427 2c20 6f70 7469 6f6e 735b 2777  ght', options['w
-00043c50: 6569 6768 7427 5d29 290a 0a20 2020 2020  eight']))..     
-00043c60: 2020 2069 6620 6f70 7469 6f6e 732e 6765     if options.ge
-00043c70: 7428 2764 6174 655f 6178 6973 2729 3a0a  t('date_axis'):.
-00043c80: 2020 2020 2020 2020 2020 2020 6174 7472              attr
-00043c90: 6962 7574 6573 2e61 7070 656e 6428 2827  ibutes.append(('
-00043ca0: 6461 7465 4178 6973 272c 2031 2929 0a0a  dateAxis', 1))..
-00043cb0: 2020 2020 2020 2020 6966 2065 6d70 7479          if empty
-00043cc0: 3a0a 2020 2020 2020 2020 2020 2020 6174  :.            at
-00043cd0: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
-00043ce0: 2827 6469 7370 6c61 7945 6d70 7479 4365  ('displayEmptyCe
-00043cf0: 6c6c 7341 7327 2c20 656d 7074 7929 290a  llsAs', empty)).
-00043d00: 0a20 2020 2020 2020 2069 6620 6f70 7469  .        if opti
-00043d10: 6f6e 732e 6765 7428 276d 6172 6b65 7273  ons.get('markers
-00043d20: 2729 3a0a 2020 2020 2020 2020 2020 2020  '):.            
-00043d30: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
-00043d40: 6428 2827 6d61 726b 6572 7327 2c20 3129  d(('markers', 1)
-00043d50: 290a 0a20 2020 2020 2020 2069 6620 6f70  )..        if op
-00043d60: 7469 6f6e 732e 6765 7428 2768 6967 6827  tions.get('high'
-00043d70: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
-00043d80: 7474 7269 6275 7465 732e 6170 7065 6e64  ttributes.append
-00043d90: 2828 2768 6967 6827 2c20 3129 290a 0a20  (('high', 1)).. 
-00043da0: 2020 2020 2020 2069 6620 6f70 7469 6f6e         if option
-00043db0: 732e 6765 7428 276c 6f77 2729 3a0a 2020  s.get('low'):.  
-00043dc0: 2020 2020 2020 2020 2020 6174 7472 6962            attrib
-00043dd0: 7574 6573 2e61 7070 656e 6428 2827 6c6f  utes.append(('lo
-00043de0: 7727 2c20 3129 290a 0a20 2020 2020 2020  w', 1))..       
-00043df0: 2069 6620 6f70 7469 6f6e 732e 6765 7428   if options.get(
-00043e00: 2766 6972 7374 2729 3a0a 2020 2020 2020  'first'):.      
-00043e10: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-00043e20: 2e61 7070 656e 6428 2827 6669 7273 7427  .append(('first'
-00043e30: 2c20 3129 290a 0a20 2020 2020 2020 2069  , 1))..        i
-00043e40: 6620 6f70 7469 6f6e 732e 6765 7428 276c  f options.get('l
-00043e50: 6173 7427 293a 0a20 2020 2020 2020 2020  ast'):.         
-00043e60: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
-00043e70: 7065 6e64 2828 276c 6173 7427 2c20 3129  pend(('last', 1)
-00043e80: 290a 0a20 2020 2020 2020 2069 6620 6f70  )..        if op
-00043e90: 7469 6f6e 732e 6765 7428 276e 6567 6174  tions.get('negat
-00043ea0: 6976 6527 293a 0a20 2020 2020 2020 2020  ive'):.         
-00043eb0: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
-00043ec0: 7065 6e64 2828 276e 6567 6174 6976 6527  pend(('negative'
-00043ed0: 2c20 3129 290a 0a20 2020 2020 2020 2069  , 1))..        i
-00043ee0: 6620 6f70 7469 6f6e 732e 6765 7428 2761  f options.get('a
-00043ef0: 7869 7327 293a 0a20 2020 2020 2020 2020  xis'):.         
-00043f00: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
-00043f10: 7065 6e64 2828 2764 6973 706c 6179 5841  pend(('displayXA
-00043f20: 7869 7327 2c20 3129 290a 0a20 2020 2020  xis', 1))..     
-00043f30: 2020 2069 6620 6f70 7469 6f6e 732e 6765     if options.ge
-00043f40: 7428 2768 6964 6465 6e27 293a 0a20 2020  t('hidden'):.   
-00043f50: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
-00043f60: 7465 732e 6170 7065 6e64 2828 2764 6973  tes.append(('dis
-00043f70: 706c 6179 4869 6464 656e 272c 2031 2929  playHidden', 1))
-00043f80: 0a0a 2020 2020 2020 2020 6966 206f 7074  ..        if opt
-00043f90: 696f 6e73 2e67 6574 2827 6375 7374 5f6d  ions.get('cust_m
-00043fa0: 696e 2729 3a0a 2020 2020 2020 2020 2020  in'):.          
-00043fb0: 2020 6174 7472 6962 7574 6573 2e61 7070    attributes.app
-00043fc0: 656e 6428 2827 6d69 6e41 7869 7354 7970  end(('minAxisTyp
-00043fd0: 6527 2c20 6f70 7469 6f6e 735b 2763 7573  e', options['cus
-00043fe0: 745f 6d69 6e27 5d29 290a 0a20 2020 2020  t_min']))..     
-00043ff0: 2020 2069 6620 6f70 7469 6f6e 732e 6765     if options.ge
-00044000: 7428 2763 7573 745f 6d61 7827 293a 0a20  t('cust_max'):. 
-00044010: 2020 2020 2020 2020 2020 2061 7474 7269             attri
-00044020: 6275 7465 732e 6170 7065 6e64 2828 276d  butes.append(('m
-00044030: 6178 4178 6973 5479 7065 272c 206f 7074  axAxisType', opt
-00044040: 696f 6e73 5b27 6375 7374 5f6d 6178 275d  ions['cust_max']
-00044050: 2929 0a0a 2020 2020 2020 2020 6966 206f  ))..        if o
-00044060: 7074 696f 6e73 2e67 6574 2827 7265 7665  ptions.get('reve
-00044070: 7273 6527 293a 0a20 2020 2020 2020 2020  rse'):.         
-00044080: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
-00044090: 7065 6e64 2828 2772 6967 6874 546f 4c65  pend(('rightToLe
-000440a0: 6674 272c 2031 2929 0a0a 2020 2020 2020  ft', 1))..      
-000440b0: 2020 7365 6c66 2e5f 786d 6c5f 7374 6172    self._xml_star
-000440c0: 745f 7461 6728 2778 3134 3a73 7061 726b  t_tag('x14:spark
-000440d0: 6c69 6e65 4772 6f75 7027 2c20 6174 7472  lineGroup', attr
-000440e0: 6962 7574 6573 290a 0a20 2020 2064 6566  ibutes)..    def
-000440f0: 205f 7772 6974 655f 7370 6172 6b5f 636f   _write_spark_co
-00044100: 6c6f 7228 7365 6c66 2c20 656c 656d 656e  lor(self, elemen
-00044110: 742c 2063 6f6c 6f72 293a 0a20 2020 2020  t, color):.     
-00044120: 2020 2023 2048 656c 7065 7220 6675 6e63     # Helper func
-00044130: 7469 6f6e 2066 6f72 2074 6865 2073 7061  tion for the spa
-00044140: 726b 6c69 6e65 2063 6f6c 6f72 2066 756e  rkline color fun
-00044150: 6374 696f 6e73 2062 656c 6f77 2e0a 2020  ctions below..  
-00044160: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
-00044170: 203d 205b 5d0a 0a20 2020 2020 2020 2069   = []..        i
-00044180: 6620 636f 6c6f 722e 6765 7428 2772 6762  f color.get('rgb
-00044190: 2729 3a0a 2020 2020 2020 2020 2020 2020  '):.            
-000441a0: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
-000441b0: 6428 2827 7267 6227 2c20 636f 6c6f 725b  d(('rgb', color[
-000441c0: 2772 6762 275d 2929 0a0a 2020 2020 2020  'rgb']))..      
-000441d0: 2020 6966 2063 6f6c 6f72 2e67 6574 2827    if color.get('
-000441e0: 7468 656d 6527 293a 0a20 2020 2020 2020  theme'):.       
-000441f0: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
-00044200: 6170 7065 6e64 2828 2774 6865 6d65 272c  append(('theme',
-00044210: 2063 6f6c 6f72 5b27 7468 656d 6527 5d29   color['theme'])
-00044220: 290a 0a20 2020 2020 2020 2069 6620 636f  )..        if co
-00044230: 6c6f 722e 6765 7428 2774 696e 7427 293a  lor.get('tint'):
-00044240: 0a20 2020 2020 2020 2020 2020 2061 7474  .            att
-00044250: 7269 6275 7465 732e 6170 7065 6e64 2828  ributes.append((
-00044260: 2774 696e 7427 2c20 636f 6c6f 725b 2774  'tint', color['t
-00044270: 696e 7427 5d29 290a 0a20 2020 2020 2020  int']))..       
-00044280: 2073 656c 662e 5f78 6d6c 5f65 6d70 7479   self._xml_empty
-00044290: 5f74 6167 2865 6c65 6d65 6e74 2c20 6174  _tag(element, at
-000442a0: 7472 6962 7574 6573 290a 0a20 2020 2064  tributes)..    d
-000442b0: 6566 205f 7772 6974 655f 636f 6c6f 725f  ef _write_color_
-000442c0: 7365 7269 6573 2873 656c 662c 2063 6f6c  series(self, col
-000442d0: 6f72 293a 0a20 2020 2020 2020 2023 2057  or):.        # W
-000442e0: 7269 7465 2074 6865 203c 7831 343a 636f  rite the <x14:co
-000442f0: 6c6f 7253 6572 6965 733e 2065 6c65 6d65  lorSeries> eleme
-00044300: 6e74 2e0a 2020 2020 2020 2020 7365 6c66  nt..        self
-00044310: 2e5f 7772 6974 655f 7370 6172 6b5f 636f  ._write_spark_co
-00044320: 6c6f 7228 2778 3134 3a63 6f6c 6f72 5365  lor('x14:colorSe
-00044330: 7269 6573 272c 2063 6f6c 6f72 290a 0a20  ries', color).. 
-00044340: 2020 2064 6566 205f 7772 6974 655f 636f     def _write_co
-00044350: 6c6f 725f 6e65 6761 7469 7665 2873 656c  lor_negative(sel
-00044360: 662c 2063 6f6c 6f72 293a 0a20 2020 2020  f, color):.     
-00044370: 2020 2023 2057 7269 7465 2074 6865 203c     # Write the <
-00044380: 7831 343a 636f 6c6f 724e 6567 6174 6976  x14:colorNegativ
-00044390: 653e 2065 6c65 6d65 6e74 2e0a 2020 2020  e> element..    
-000443a0: 2020 2020 7365 6c66 2e5f 7772 6974 655f      self._write_
-000443b0: 7370 6172 6b5f 636f 6c6f 7228 2778 3134  spark_color('x14
-000443c0: 3a63 6f6c 6f72 4e65 6761 7469 7665 272c  :colorNegative',
-000443d0: 2063 6f6c 6f72 290a 0a20 2020 2064 6566   color)..    def
-000443e0: 205f 7772 6974 655f 636f 6c6f 725f 6178   _write_color_ax
-000443f0: 6973 2873 656c 6629 3a0a 2020 2020 2020  is(self):.      
-00044400: 2020 2320 5772 6974 6520 7468 6520 3c78    # Write the <x
-00044410: 3134 3a63 6f6c 6f72 4178 6973 3e20 656c  14:colorAxis> el
-00044420: 656d 656e 742e 0a20 2020 2020 2020 2073  ement..        s
-00044430: 656c 662e 5f77 7269 7465 5f73 7061 726b  elf._write_spark
-00044440: 5f63 6f6c 6f72 2827 7831 343a 636f 6c6f  _color('x14:colo
-00044450: 7241 7869 7327 2c20 7b27 7267 6227 3a20  rAxis', {'rgb': 
-00044460: 2746 4630 3030 3030 3027 7d29 0a0a 2020  'FF000000'})..  
-00044470: 2020 6465 6620 5f77 7269 7465 5f63 6f6c    def _write_col
-00044480: 6f72 5f6d 6172 6b65 7273 2873 656c 662c  or_markers(self,
-00044490: 2063 6f6c 6f72 293a 0a20 2020 2020 2020   color):.       
-000444a0: 2023 2057 7269 7465 2074 6865 203c 7831   # Write the <x1
-000444b0: 343a 636f 6c6f 724d 6172 6b65 7273 3e20  4:colorMarkers> 
-000444c0: 656c 656d 656e 742e 0a20 2020 2020 2020  element..       
-000444d0: 2073 656c 662e 5f77 7269 7465 5f73 7061   self._write_spa
-000444e0: 726b 5f63 6f6c 6f72 2827 7831 343a 636f  rk_color('x14:co
-000444f0: 6c6f 724d 6172 6b65 7273 272c 2063 6f6c  lorMarkers', col
-00044500: 6f72 290a 0a20 2020 2064 6566 205f 7772  or)..    def _wr
-00044510: 6974 655f 636f 6c6f 725f 6669 7273 7428  ite_color_first(
-00044520: 7365 6c66 2c20 636f 6c6f 7229 3a0a 2020  self, color):.  
-00044530: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
-00044540: 6520 3c78 3134 3a63 6f6c 6f72 4669 7273  e <x14:colorFirs
-00044550: 743e 2065 6c65 6d65 6e74 2e0a 2020 2020  t> element..    
-00044560: 2020 2020 7365 6c66 2e5f 7772 6974 655f      self._write_
-00044570: 7370 6172 6b5f 636f 6c6f 7228 2778 3134  spark_color('x14
-00044580: 3a63 6f6c 6f72 4669 7273 7427 2c20 636f  :colorFirst', co
-00044590: 6c6f 7229 0a0a 2020 2020 6465 6620 5f77  lor)..    def _w
-000445a0: 7269 7465 5f63 6f6c 6f72 5f6c 6173 7428  rite_color_last(
-000445b0: 7365 6c66 2c20 636f 6c6f 7229 3a0a 2020  self, color):.  
-000445c0: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
-000445d0: 6520 3c78 3134 3a63 6f6c 6f72 4c61 7374  e <x14:colorLast
-000445e0: 3e20 656c 656d 656e 742e 0a20 2020 2020  > element..     
-000445f0: 2020 2073 656c 662e 5f77 7269 7465 5f73     self._write_s
-00044600: 7061 726b 5f63 6f6c 6f72 2827 7831 343a  park_color('x14:
-00044610: 636f 6c6f 724c 6173 7427 2c20 636f 6c6f  colorLast', colo
-00044620: 7229 0a0a 2020 2020 6465 6620 5f77 7269  r)..    def _wri
-00044630: 7465 5f63 6f6c 6f72 5f68 6967 6828 7365  te_color_high(se
-00044640: 6c66 2c20 636f 6c6f 7229 3a0a 2020 2020  lf, color):.    
-00044650: 2020 2020 2320 5772 6974 6520 7468 6520      # Write the 
-00044660: 3c78 3134 3a63 6f6c 6f72 4869 6768 3e20  <x14:colorHigh> 
-00044670: 656c 656d 656e 742e 0a20 2020 2020 2020  element..       
-00044680: 2073 656c 662e 5f77 7269 7465 5f73 7061   self._write_spa
-00044690: 726b 5f63 6f6c 6f72 2827 7831 343a 636f  rk_color('x14:co
-000446a0: 6c6f 7248 6967 6827 2c20 636f 6c6f 7229  lorHigh', color)
-000446b0: 0a0a 2020 2020 6465 6620 5f77 7269 7465  ..    def _write
-000446c0: 5f63 6f6c 6f72 5f6c 6f77 2873 656c 662c  _color_low(self,
-000446d0: 2063 6f6c 6f72 293a 0a20 2020 2020 2020   color):.       
-000446e0: 2023 2057 7269 7465 2074 6865 203c 7831   # Write the <x1
-000446f0: 343a 636f 6c6f 724c 6f77 3e20 656c 656d  4:colorLow> elem
-00044700: 656e 742e 0a20 2020 2020 2020 2073 656c  ent..        sel
-00044710: 662e 5f77 7269 7465 5f73 7061 726b 5f63  f._write_spark_c
-00044720: 6f6c 6f72 2827 7831 343a 636f 6c6f 724c  olor('x14:colorL
-00044730: 6f77 272c 2063 6f6c 6f72 290a 0a20 2020  ow', color)..   
-00044740: 2064 6566 205f 7772 6974 655f 7068 6f6e   def _write_phon
-00044750: 6574 6963 5f70 7228 7365 6c66 293a 0a20  etic_pr(self):. 
-00044760: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
-00044770: 6865 203c 7068 6f6e 6574 6963 5072 3e20  he <phoneticPr> 
-00044780: 656c 656d 656e 742e 0a20 2020 2020 2020  element..       
-00044790: 2061 7474 7269 6275 7465 7320 3d20 5b0a   attributes = [.
-000447a0: 2020 2020 2020 2020 2020 2020 2827 666f              ('fo
-000447b0: 6e74 4964 272c 2027 3027 292c 0a20 2020  ntId', '0'),.   
-000447c0: 2020 2020 2020 2020 2028 2774 7970 6527           ('type'
-000447d0: 2c20 276e 6f43 6f6e 7665 7273 696f 6e27  , 'noConversion'
-000447e0: 292c 0a20 2020 2020 2020 205d 0a0a 2020  ),.        ]..  
-000447f0: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
-00044800: 656d 7074 795f 7461 6728 2770 686f 6e65  empty_tag('phone
-00044810: 7469 6350 7227 2c20 6174 7472 6962 7574  ticPr', attribut
-00044820: 6573 290a 0a20 2020 2064 6566 205f 7772  es)..    def _wr
-00044830: 6974 655f 6967 6e6f 7265 645f 6572 726f  ite_ignored_erro
-00044840: 7273 2873 656c 6629 3a0a 2020 2020 2020  rs(self):.      
-00044850: 2020 2320 5772 6974 6520 7468 6520 3c69    # Write the <i
-00044860: 676e 6f72 6564 4572 726f 7273 3e20 656c  gnoredErrors> el
-00044870: 656d 656e 742e 0a20 2020 2020 2020 2069  ement..        i
-00044880: 6620 6e6f 7420 7365 6c66 2e69 676e 6f72  f not self.ignor
-00044890: 6564 5f65 7272 6f72 733a 0a20 2020 2020  ed_errors:.     
-000448a0: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
-000448b0: 2020 2020 2020 2073 656c 662e 5f78 6d6c         self._xml
-000448c0: 5f73 7461 7274 5f74 6167 2827 6967 6e6f  _start_tag('igno
-000448d0: 7265 6445 7272 6f72 7327 290a 0a20 2020  redErrors')..   
-000448e0: 2020 2020 2069 6620 7365 6c66 2e69 676e       if self.ign
-000448f0: 6f72 6564 5f65 7272 6f72 732e 6765 7428  ored_errors.get(
-00044900: 276e 756d 6265 725f 7374 6f72 6564 5f61  'number_stored_a
-00044910: 735f 7465 7874 2729 3a0a 2020 2020 2020  s_text'):.      
-00044920: 2020 2020 2020 7261 6e67 6520 3d20 7365        range = se
-00044930: 6c66 2e69 676e 6f72 6564 5f65 7272 6f72  lf.ignored_error
-00044940: 735b 276e 756d 6265 725f 7374 6f72 6564  s['number_stored
-00044950: 5f61 735f 7465 7874 275d 0a20 2020 2020  _as_text'].     
-00044960: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
-00044970: 7465 5f69 676e 6f72 6564 5f65 7272 6f72  te_ignored_error
-00044980: 2827 6e75 6d62 6572 5374 6f72 6564 4173  ('numberStoredAs
-00044990: 5465 7874 272c 2072 616e 6765 290a 0a20  Text', range).. 
-000449a0: 2020 2020 2020 2069 6620 7365 6c66 2e69         if self.i
-000449b0: 676e 6f72 6564 5f65 7272 6f72 732e 6765  gnored_errors.ge
-000449c0: 7428 2765 7661 6c5f 6572 726f 7227 293a  t('eval_error'):
-000449d0: 0a20 2020 2020 2020 2020 2020 2072 616e  .            ran
-000449e0: 6765 203d 2073 656c 662e 6967 6e6f 7265  ge = self.ignore
-000449f0: 645f 6572 726f 7273 5b27 6576 616c 5f65  d_errors['eval_e
-00044a00: 7272 6f72 275d 0a20 2020 2020 2020 2020  rror'].         
-00044a10: 2020 2073 656c 662e 5f77 7269 7465 5f69     self._write_i
-00044a20: 676e 6f72 6564 5f65 7272 6f72 2827 6576  gnored_error('ev
-00044a30: 616c 4572 726f 7227 2c20 7261 6e67 6529  alError', range)
-00044a40: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
-00044a50: 662e 6967 6e6f 7265 645f 6572 726f 7273  f.ignored_errors
-00044a60: 2e67 6574 2827 666f 726d 756c 615f 6469  .get('formula_di
-00044a70: 6666 6572 7327 293a 0a20 2020 2020 2020  ffers'):.       
-00044a80: 2020 2020 2072 616e 6765 203d 2073 656c       range = sel
-00044a90: 662e 6967 6e6f 7265 645f 6572 726f 7273  f.ignored_errors
-00044aa0: 5b27 666f 726d 756c 615f 6469 6666 6572  ['formula_differ
-00044ab0: 7327 5d0a 2020 2020 2020 2020 2020 2020  s'].            
-00044ac0: 7365 6c66 2e5f 7772 6974 655f 6967 6e6f  self._write_igno
-00044ad0: 7265 645f 6572 726f 7228 2766 6f72 6d75  red_error('formu
-00044ae0: 6c61 272c 2072 616e 6765 290a 0a20 2020  la', range)..   
-00044af0: 2020 2020 2069 6620 7365 6c66 2e69 676e       if self.ign
-00044b00: 6f72 6564 5f65 7272 6f72 732e 6765 7428  ored_errors.get(
-00044b10: 2766 6f72 6d75 6c61 5f72 616e 6765 2729  'formula_range')
-00044b20: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00044b30: 6e67 6520 3d20 7365 6c66 2e69 676e 6f72  nge = self.ignor
-00044b40: 6564 5f65 7272 6f72 735b 2766 6f72 6d75  ed_errors['formu
-00044b50: 6c61 5f72 616e 6765 275d 0a20 2020 2020  la_range'].     
-00044b60: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
-00044b70: 7465 5f69 676e 6f72 6564 5f65 7272 6f72  te_ignored_error
-00044b80: 2827 666f 726d 756c 6152 616e 6765 272c  ('formulaRange',
-00044b90: 2072 616e 6765 290a 0a20 2020 2020 2020   range)..       
-00044ba0: 2069 6620 7365 6c66 2e69 676e 6f72 6564   if self.ignored
-00044bb0: 5f65 7272 6f72 732e 6765 7428 2766 6f72  _errors.get('for
-00044bc0: 6d75 6c61 5f75 6e6c 6f63 6b65 6427 293a  mula_unlocked'):
-00044bd0: 0a20 2020 2020 2020 2020 2020 2072 616e  .            ran
-00044be0: 6765 203d 2073 656c 662e 6967 6e6f 7265  ge = self.ignore
-00044bf0: 645f 6572 726f 7273 5b27 666f 726d 756c  d_errors['formul
-00044c00: 615f 756e 6c6f 636b 6564 275d 0a20 2020  a_unlocked'].   
-00044c10: 2020 2020 2020 2020 2073 656c 662e 5f77           self._w
-00044c20: 7269 7465 5f69 676e 6f72 6564 5f65 7272  rite_ignored_err
-00044c30: 6f72 2827 756e 6c6f 636b 6564 466f 726d  or('unlockedForm
-00044c40: 756c 6127 2c20 7261 6e67 6529 0a0a 2020  ula', range)..  
-00044c50: 2020 2020 2020 6966 2073 656c 662e 6967        if self.ig
-00044c60: 6e6f 7265 645f 6572 726f 7273 2e67 6574  nored_errors.get
-00044c70: 2827 656d 7074 795f 6365 6c6c 5f72 6566  ('empty_cell_ref
-00044c80: 6572 656e 6365 2729 3a0a 2020 2020 2020  erence'):.      
-00044c90: 2020 2020 2020 7261 6e67 6520 3d20 7365        range = se
-00044ca0: 6c66 2e69 676e 6f72 6564 5f65 7272 6f72  lf.ignored_error
-00044cb0: 735b 2765 6d70 7479 5f63 656c 6c5f 7265  s['empty_cell_re
-00044cc0: 6665 7265 6e63 6527 5d0a 2020 2020 2020  ference'].      
-00044cd0: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
-00044ce0: 655f 6967 6e6f 7265 645f 6572 726f 7228  e_ignored_error(
-00044cf0: 2765 6d70 7479 4365 6c6c 5265 6665 7265  'emptyCellRefere
-00044d00: 6e63 6527 2c20 7261 6e67 6529 0a0a 2020  nce', range)..  
-00044d10: 2020 2020 2020 6966 2073 656c 662e 6967        if self.ig
-00044d20: 6e6f 7265 645f 6572 726f 7273 2e67 6574  nored_errors.get
-00044d30: 2827 6c69 7374 5f64 6174 615f 7661 6c69  ('list_data_vali
-00044d40: 6461 7469 6f6e 2729 3a0a 2020 2020 2020  dation'):.      
-00044d50: 2020 2020 2020 7261 6e67 6520 3d20 7365        range = se
-00044d60: 6c66 2e69 676e 6f72 6564 5f65 7272 6f72  lf.ignored_error
-00044d70: 735b 276c 6973 745f 6461 7461 5f76 616c  s['list_data_val
-00044d80: 6964 6174 696f 6e27 5d0a 2020 2020 2020  idation'].      
-00044d90: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
-00044da0: 655f 6967 6e6f 7265 645f 6572 726f 7228  e_ignored_error(
-00044db0: 276c 6973 7444 6174 6156 616c 6964 6174  'listDataValidat
-00044dc0: 696f 6e27 2c20 7261 6e67 6529 0a0a 2020  ion', range)..  
-00044dd0: 2020 2020 2020 6966 2073 656c 662e 6967        if self.ig
-00044de0: 6e6f 7265 645f 6572 726f 7273 2e67 6574  nored_errors.get
-00044df0: 2827 6361 6c63 756c 6174 6564 5f63 6f6c  ('calculated_col
-00044e00: 756d 6e27 293a 0a20 2020 2020 2020 2020  umn'):.         
-00044e10: 2020 2072 616e 6765 203d 2073 656c 662e     range = self.
-00044e20: 6967 6e6f 7265 645f 6572 726f 7273 5b27  ignored_errors['
-00044e30: 6361 6c63 756c 6174 6564 5f63 6f6c 756d  calculated_colum
-00044e40: 6e27 5d0a 2020 2020 2020 2020 2020 2020  n'].            
-00044e50: 7365 6c66 2e5f 7772 6974 655f 6967 6e6f  self._write_igno
-00044e60: 7265 645f 6572 726f 7228 2763 616c 6375  red_error('calcu
-00044e70: 6c61 7465 6443 6f6c 756d 6e27 2c20 7261  latedColumn', ra
-00044e80: 6e67 6529 0a0a 2020 2020 2020 2020 6966  nge)..        if
-00044e90: 2073 656c 662e 6967 6e6f 7265 645f 6572   self.ignored_er
-00044ea0: 726f 7273 2e67 6574 2827 7477 6f5f 6469  rors.get('two_di
-00044eb0: 6769 745f 7465 7874 5f79 6561 7227 293a  git_text_year'):
-00044ec0: 0a20 2020 2020 2020 2020 2020 2072 616e  .            ran
-00044ed0: 6765 203d 2073 656c 662e 6967 6e6f 7265  ge = self.ignore
-00044ee0: 645f 6572 726f 7273 5b27 7477 6f5f 6469  d_errors['two_di
-00044ef0: 6769 745f 7465 7874 5f79 6561 7227 5d0a  git_text_year'].
-00044f00: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00044f10: 2e5f 7772 6974 655f 6967 6e6f 7265 645f  ._write_ignored_
-00044f20: 6572 726f 7228 2774 776f 4469 6769 7454  error('twoDigitT
-00044f30: 6578 7459 6561 7227 2c20 7261 6e67 6529  extYear', range)
-00044f40: 0a0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-00044f50: 786d 6c5f 656e 645f 7461 6728 2769 676e  xml_end_tag('ign
-00044f60: 6f72 6564 4572 726f 7273 2729 0a0a 2020  oredErrors')..  
-00044f70: 2020 6465 6620 5f77 7269 7465 5f69 676e    def _write_ign
-00044f80: 6f72 6564 5f65 7272 6f72 2873 656c 662c  ored_error(self,
-00044f90: 2074 7970 652c 2072 616e 6765 293a 0a20   type, range):. 
-00044fa0: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
-00044fb0: 6865 203c 6967 6e6f 7265 6445 7272 6f72  he <ignoredError
-00044fc0: 3e20 656c 656d 656e 742e 0a20 2020 2020  > element..     
-00044fd0: 2020 2061 7474 7269 6275 7465 7320 3d20     attributes = 
-00044fe0: 5b0a 2020 2020 2020 2020 2020 2020 2827  [.            ('
-00044ff0: 7371 7265 6627 2c20 7261 6e67 6529 2c0a  sqref', range),.
-00045000: 2020 2020 2020 2020 2020 2020 2874 7970              (typ
-00045010: 652c 2031 292c 0a20 2020 2020 2020 205d  e, 1),.        ]
-00045020: 0a0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-00045030: 786d 6c5f 656d 7074 795f 7461 6728 2769  xml_empty_tag('i
-00045040: 676e 6f72 6564 4572 726f 7227 2c20 6174  gnoredError', at
-00045050: 7472 6962 7574 6573 290a                 tributes).
+0003f850: 5f65 6d70 7479 5f74 6167 2822 636f 6c6f  _empty_tag("colo
+0003f860: 7222 2c20 6174 7472 6962 7574 6573 290a  r", attributes).
+0003f870: 0a20 2020 2064 6566 205f 7772 6974 655f  .    def _write_
+0003f880: 7365 6c65 6374 696f 6e73 2873 656c 6629  selections(self)
+0003f890: 3a0a 2020 2020 2020 2020 2320 5772 6974  :.        # Writ
+0003f8a0: 6520 7468 6520 3c73 656c 6563 7469 6f6e  e the <selection
+0003f8b0: 3e20 656c 656d 656e 7473 2e0a 2020 2020  > elements..    
+0003f8c0: 2020 2020 666f 7220 7365 6c65 6374 696f      for selectio
+0003f8d0: 6e20 696e 2073 656c 662e 7365 6c65 6374  n in self.select
+0003f8e0: 696f 6e73 3a0a 2020 2020 2020 2020 2020  ions:.          
+0003f8f0: 2020 7365 6c66 2e5f 7772 6974 655f 7365    self._write_se
+0003f900: 6c65 6374 696f 6e28 2a73 656c 6563 7469  lection(*selecti
+0003f910: 6f6e 290a 0a20 2020 2064 6566 205f 7772  on)..    def _wr
+0003f920: 6974 655f 7365 6c65 6374 696f 6e28 7365  ite_selection(se
+0003f930: 6c66 2c20 7061 6e65 2c20 6163 7469 7665  lf, pane, active
+0003f940: 5f63 656c 6c2c 2073 7172 6566 293a 0a20  _cell, sqref):. 
+0003f950: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
+0003f960: 6865 203c 7365 6c65 6374 696f 6e3e 2065  he <selection> e
+0003f970: 6c65 6d65 6e74 2e0a 2020 2020 2020 2020  lement..        
+0003f980: 6174 7472 6962 7574 6573 203d 205b 5d0a  attributes = [].
+0003f990: 0a20 2020 2020 2020 2069 6620 7061 6e65  .        if pane
+0003f9a0: 3a0a 2020 2020 2020 2020 2020 2020 6174  :.            at
+0003f9b0: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
+0003f9c0: 2822 7061 6e65 222c 2070 616e 6529 290a  ("pane", pane)).
+0003f9d0: 0a20 2020 2020 2020 2069 6620 6163 7469  .        if acti
+0003f9e0: 7665 5f63 656c 6c3a 0a20 2020 2020 2020  ve_cell:.       
+0003f9f0: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
+0003fa00: 6170 7065 6e64 2828 2261 6374 6976 6543  append(("activeC
+0003fa10: 656c 6c22 2c20 6163 7469 7665 5f63 656c  ell", active_cel
+0003fa20: 6c29 290a 0a20 2020 2020 2020 2069 6620  l))..        if 
+0003fa30: 7371 7265 663a 0a20 2020 2020 2020 2020  sqref:.         
+0003fa40: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
+0003fa50: 7065 6e64 2828 2273 7172 6566 222c 2073  pend(("sqref", s
+0003fa60: 7172 6566 2929 0a0a 2020 2020 2020 2020  qref))..        
+0003fa70: 7365 6c66 2e5f 786d 6c5f 656d 7074 795f  self._xml_empty_
+0003fa80: 7461 6728 2273 656c 6563 7469 6f6e 222c  tag("selection",
+0003fa90: 2061 7474 7269 6275 7465 7329 0a0a 2020   attributes)..  
+0003faa0: 2020 6465 6620 5f77 7269 7465 5f70 616e    def _write_pan
+0003fab0: 6573 2873 656c 6629 3a0a 2020 2020 2020  es(self):.      
+0003fac0: 2020 2320 5772 6974 6520 7468 6520 6672    # Write the fr
+0003fad0: 6f7a 656e 206f 7220 7370 6c69 7420 3c70  ozen or split <p
+0003fae0: 616e 653e 2065 6c65 6d65 6e74 732e 0a20  ane> elements.. 
+0003faf0: 2020 2020 2020 2070 616e 6573 203d 2073         panes = s
+0003fb00: 656c 662e 7061 6e65 730a 0a20 2020 2020  elf.panes..     
+0003fb10: 2020 2069 6620 6e6f 7420 6c65 6e28 7061     if not len(pa
+0003fb20: 6e65 7329 3a0a 2020 2020 2020 2020 2020  nes):.          
+0003fb30: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
+0003fb40: 2020 6966 2070 616e 6573 5b34 5d20 3d3d    if panes[4] ==
+0003fb50: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
+0003fb60: 7365 6c66 2e5f 7772 6974 655f 7370 6c69  self._write_spli
+0003fb70: 745f 7061 6e65 7328 2a70 616e 6573 290a  t_panes(*panes).
+0003fb80: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0003fb90: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0003fba0: 7772 6974 655f 6672 6565 7a65 5f70 616e  write_freeze_pan
+0003fbb0: 6573 282a 7061 6e65 7329 0a0a 2020 2020  es(*panes)..    
+0003fbc0: 6465 6620 5f77 7269 7465 5f66 7265 657a  def _write_freez
+0003fbd0: 655f 7061 6e65 7328 7365 6c66 2c20 726f  e_panes(self, ro
+0003fbe0: 772c 2063 6f6c 2c20 746f 705f 726f 772c  w, col, top_row,
+0003fbf0: 206c 6566 745f 636f 6c2c 2070 616e 655f   left_col, pane_
+0003fc00: 7479 7065 293a 0a20 2020 2020 2020 2023  type):.        #
+0003fc10: 2057 7269 7465 2074 6865 203c 7061 6e65   Write the <pane
+0003fc20: 3e20 656c 656d 656e 7420 666f 7220 6672  > element for fr
+0003fc30: 6565 7a65 2070 616e 6573 2e0a 2020 2020  eeze panes..    
+0003fc40: 2020 2020 6174 7472 6962 7574 6573 203d      attributes =
+0003fc50: 205b 5d0a 0a20 2020 2020 2020 2079 5f73   []..        y_s
+0003fc60: 706c 6974 203d 2072 6f77 0a20 2020 2020  plit = row.     
+0003fc70: 2020 2078 5f73 706c 6974 203d 2063 6f6c     x_split = col
+0003fc80: 0a20 2020 2020 2020 2074 6f70 5f6c 6566  .        top_lef
+0003fc90: 745f 6365 6c6c 203d 2078 6c5f 726f 7763  t_cell = xl_rowc
+0003fca0: 6f6c 5f74 6f5f 6365 6c6c 2874 6f70 5f72  ol_to_cell(top_r
+0003fcb0: 6f77 2c20 6c65 6674 5f63 6f6c 290a 2020  ow, left_col).  
+0003fcc0: 2020 2020 2020 6163 7469 7665 5f70 616e        active_pan
+0003fcd0: 6520 3d20 2222 0a20 2020 2020 2020 2073  e = "".        s
+0003fce0: 7461 7465 203d 2022 220a 2020 2020 2020  tate = "".      
+0003fcf0: 2020 6163 7469 7665 5f63 656c 6c20 3d20    active_cell = 
+0003fd00: 2222 0a20 2020 2020 2020 2073 7172 6566  "".        sqref
+0003fd10: 203d 2022 220a 0a20 2020 2020 2020 2023   = ""..        #
+0003fd20: 204d 6f76 6520 7573 6572 2063 656c 6c20   Move user cell 
+0003fd30: 7365 6c65 6374 696f 6e20 746f 2074 6865  selection to the
+0003fd40: 2070 616e 6573 2e0a 2020 2020 2020 2020   panes..        
+0003fd50: 6966 2073 656c 662e 7365 6c65 6374 696f  if self.selectio
+0003fd60: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
+0003fd70: 285f 2c20 6163 7469 7665 5f63 656c 6c2c  (_, active_cell,
+0003fd80: 2073 7172 6566 2920 3d20 7365 6c66 2e73   sqref) = self.s
+0003fd90: 656c 6563 7469 6f6e 735b 305d 0a20 2020  elections[0].   
+0003fda0: 2020 2020 2020 2020 2073 656c 662e 7365           self.se
+0003fdb0: 6c65 6374 696f 6e73 203d 205b 5d0a 0a20  lections = [].. 
+0003fdc0: 2020 2020 2020 2023 2053 6574 2074 6865         # Set the
+0003fdd0: 2061 6374 6976 6520 7061 6e65 2e0a 2020   active pane..  
+0003fde0: 2020 2020 2020 6966 2072 6f77 2061 6e64        if row and
+0003fdf0: 2063 6f6c 3a0a 2020 2020 2020 2020 2020   col:.          
+0003fe00: 2020 6163 7469 7665 5f70 616e 6520 3d20    active_pane = 
+0003fe10: 2262 6f74 746f 6d52 6967 6874 220a 0a20  "bottomRight".. 
+0003fe20: 2020 2020 2020 2020 2020 2072 6f77 5f63             row_c
+0003fe30: 656c 6c20 3d20 786c 5f72 6f77 636f 6c5f  ell = xl_rowcol_
+0003fe40: 746f 5f63 656c 6c28 726f 772c 2030 290a  to_cell(row, 0).
+0003fe50: 2020 2020 2020 2020 2020 2020 636f 6c5f              col_
+0003fe60: 6365 6c6c 203d 2078 6c5f 726f 7763 6f6c  cell = xl_rowcol
+0003fe70: 5f74 6f5f 6365 6c6c 2830 2c20 636f 6c29  _to_cell(0, col)
+0003fe80: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+0003fe90: 6c66 2e73 656c 6563 7469 6f6e 732e 6170  lf.selections.ap
+0003fea0: 7065 6e64 285b 2274 6f70 5269 6768 7422  pend(["topRight"
+0003feb0: 2c20 636f 6c5f 6365 6c6c 2c20 636f 6c5f  , col_cell, col_
+0003fec0: 6365 6c6c 5d29 0a20 2020 2020 2020 2020  cell]).         
+0003fed0: 2020 2073 656c 662e 7365 6c65 6374 696f     self.selectio
+0003fee0: 6e73 2e61 7070 656e 6428 5b22 626f 7474  ns.append(["bott
+0003fef0: 6f6d 4c65 6674 222c 2072 6f77 5f63 656c  omLeft", row_cel
+0003ff00: 6c2c 2072 6f77 5f63 656c 6c5d 290a 2020  l, row_cell]).  
+0003ff10: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
+0003ff20: 656c 6563 7469 6f6e 732e 6170 7065 6e64  elections.append
+0003ff30: 285b 2262 6f74 746f 6d52 6967 6874 222c  (["bottomRight",
+0003ff40: 2061 6374 6976 655f 6365 6c6c 2c20 7371   active_cell, sq
+0003ff50: 7265 665d 290a 0a20 2020 2020 2020 2065  ref])..        e
+0003ff60: 6c69 6620 636f 6c3a 0a20 2020 2020 2020  lif col:.       
+0003ff70: 2020 2020 2061 6374 6976 655f 7061 6e65       active_pane
+0003ff80: 203d 2022 746f 7052 6967 6874 220a 2020   = "topRight".  
+0003ff90: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
+0003ffa0: 656c 6563 7469 6f6e 732e 6170 7065 6e64  elections.append
+0003ffb0: 285b 2274 6f70 5269 6768 7422 2c20 6163  (["topRight", ac
+0003ffc0: 7469 7665 5f63 656c 6c2c 2073 7172 6566  tive_cell, sqref
+0003ffd0: 5d29 0a0a 2020 2020 2020 2020 656c 7365  ])..        else
+0003ffe0: 3a0a 2020 2020 2020 2020 2020 2020 6163  :.            ac
+0003fff0: 7469 7665 5f70 616e 6520 3d20 2262 6f74  tive_pane = "bot
+00040000: 746f 6d4c 6566 7422 0a20 2020 2020 2020  tomLeft".       
+00040010: 2020 2020 2073 656c 662e 7365 6c65 6374       self.select
+00040020: 696f 6e73 2e61 7070 656e 6428 5b22 626f  ions.append(["bo
+00040030: 7474 6f6d 4c65 6674 222c 2061 6374 6976  ttomLeft", activ
+00040040: 655f 6365 6c6c 2c20 7371 7265 665d 290a  e_cell, sqref]).
+00040050: 0a20 2020 2020 2020 2023 2053 6574 2074  .        # Set t
+00040060: 6865 2070 616e 6520 7479 7065 2e0a 2020  he pane type..  
+00040070: 2020 2020 2020 6966 2070 616e 655f 7479        if pane_ty
+00040080: 7065 203d 3d20 303a 0a20 2020 2020 2020  pe == 0:.       
+00040090: 2020 2020 2073 7461 7465 203d 2022 6672       state = "fr
+000400a0: 6f7a 656e 220a 2020 2020 2020 2020 656c  ozen".        el
+000400b0: 6966 2070 616e 655f 7479 7065 203d 3d20  if pane_type == 
+000400c0: 313a 0a20 2020 2020 2020 2020 2020 2073  1:.            s
+000400d0: 7461 7465 203d 2022 6672 6f7a 656e 5370  tate = "frozenSp
+000400e0: 6c69 7422 0a20 2020 2020 2020 2065 6c73  lit".        els
+000400f0: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00040100: 7461 7465 203d 2022 7370 6c69 7422 0a0a  tate = "split"..
+00040110: 2020 2020 2020 2020 6966 2078 5f73 706c          if x_spl
+00040120: 6974 3a0a 2020 2020 2020 2020 2020 2020  it:.            
+00040130: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
+00040140: 6428 2822 7853 706c 6974 222c 2078 5f73  d(("xSplit", x_s
+00040150: 706c 6974 2929 0a0a 2020 2020 2020 2020  plit))..        
+00040160: 6966 2079 5f73 706c 6974 3a0a 2020 2020  if y_split:.    
+00040170: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
+00040180: 6573 2e61 7070 656e 6428 2822 7953 706c  es.append(("ySpl
+00040190: 6974 222c 2079 5f73 706c 6974 2929 0a0a  it", y_split))..
+000401a0: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
+000401b0: 6573 2e61 7070 656e 6428 2822 746f 704c  es.append(("topL
+000401c0: 6566 7443 656c 6c22 2c20 746f 705f 6c65  eftCell", top_le
+000401d0: 6674 5f63 656c 6c29 290a 2020 2020 2020  ft_cell)).      
+000401e0: 2020 6174 7472 6962 7574 6573 2e61 7070    attributes.app
+000401f0: 656e 6428 2822 6163 7469 7665 5061 6e65  end(("activePane
+00040200: 222c 2061 6374 6976 655f 7061 6e65 2929  ", active_pane))
+00040210: 0a20 2020 2020 2020 2061 7474 7269 6275  .        attribu
+00040220: 7465 732e 6170 7065 6e64 2828 2273 7461  tes.append(("sta
+00040230: 7465 222c 2073 7461 7465 2929 0a0a 2020  te", state))..  
+00040240: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
+00040250: 656d 7074 795f 7461 6728 2270 616e 6522  empty_tag("pane"
+00040260: 2c20 6174 7472 6962 7574 6573 290a 0a20  , attributes).. 
+00040270: 2020 2064 6566 205f 7772 6974 655f 7370     def _write_sp
+00040280: 6c69 745f 7061 6e65 7328 7365 6c66 2c20  lit_panes(self, 
+00040290: 726f 772c 2063 6f6c 2c20 746f 705f 726f  row, col, top_ro
+000402a0: 772c 206c 6566 745f 636f 6c2c 2070 616e  w, left_col, pan
+000402b0: 655f 7479 7065 293a 0a20 2020 2020 2020  e_type):.       
+000402c0: 2023 2057 7269 7465 2074 6865 203c 7061   # Write the <pa
+000402d0: 6e65 3e20 656c 656d 656e 7420 666f 7220  ne> element for 
+000402e0: 7370 6c69 7420 7061 6e65 732e 0a20 2020  split panes..   
+000402f0: 2020 2020 2061 7474 7269 6275 7465 7320       attributes 
+00040300: 3d20 5b5d 0a20 2020 2020 2020 2068 6173  = [].        has
+00040310: 5f73 656c 6563 7469 6f6e 203d 2030 0a20  _selection = 0. 
+00040320: 2020 2020 2020 2061 6374 6976 655f 7061         active_pa
+00040330: 6e65 203d 2022 220a 2020 2020 2020 2020  ne = "".        
+00040340: 6163 7469 7665 5f63 656c 6c20 3d20 2222  active_cell = ""
+00040350: 0a20 2020 2020 2020 2073 7172 6566 203d  .        sqref =
+00040360: 2022 220a 0a20 2020 2020 2020 2079 5f73   ""..        y_s
+00040370: 706c 6974 203d 2072 6f77 0a20 2020 2020  plit = row.     
+00040380: 2020 2078 5f73 706c 6974 203d 2063 6f6c     x_split = col
+00040390: 0a0a 2020 2020 2020 2020 2320 4d6f 7665  ..        # Move
+000403a0: 2075 7365 7220 6365 6c6c 2073 656c 6563   user cell selec
+000403b0: 7469 6f6e 2074 6f20 7468 6520 7061 6e65  tion to the pane
+000403c0: 732e 0a20 2020 2020 2020 2069 6620 7365  s..        if se
+000403d0: 6c66 2e73 656c 6563 7469 6f6e 733a 0a20  lf.selections:. 
+000403e0: 2020 2020 2020 2020 2020 2028 5f2c 2061             (_, a
+000403f0: 6374 6976 655f 6365 6c6c 2c20 7371 7265  ctive_cell, sqre
+00040400: 6629 203d 2073 656c 662e 7365 6c65 6374  f) = self.select
+00040410: 696f 6e73 5b30 5d0a 2020 2020 2020 2020  ions[0].        
+00040420: 2020 2020 7365 6c66 2e73 656c 6563 7469      self.selecti
+00040430: 6f6e 7320 3d20 5b5d 0a20 2020 2020 2020  ons = [].       
+00040440: 2020 2020 2068 6173 5f73 656c 6563 7469       has_selecti
+00040450: 6f6e 203d 2031 0a0a 2020 2020 2020 2020  on = 1..        
+00040460: 2320 436f 6e76 6572 7420 7468 6520 726f  # Convert the ro
+00040470: 7720 616e 6420 636f 6c20 746f 2031 2f32  w and col to 1/2
+00040480: 3020 7477 6970 2075 6e69 7473 2077 6974  0 twip units wit
+00040490: 6820 7061 6464 696e 672e 0a20 2020 2020  h padding..     
+000404a0: 2020 2069 6620 795f 7370 6c69 743a 0a20     if y_split:. 
+000404b0: 2020 2020 2020 2020 2020 2079 5f73 706c             y_spl
+000404c0: 6974 203d 2069 6e74 2832 3020 2a20 795f  it = int(20 * y_
+000404d0: 7370 6c69 7420 2b20 3330 3029 0a0a 2020  split + 300)..  
+000404e0: 2020 2020 2020 6966 2078 5f73 706c 6974        if x_split
+000404f0: 3a0a 2020 2020 2020 2020 2020 2020 785f  :.            x_
+00040500: 7370 6c69 7420 3d20 7365 6c66 2e5f 6361  split = self._ca
+00040510: 6c63 756c 6174 655f 785f 7370 6c69 745f  lculate_x_split_
+00040520: 7769 6474 6828 785f 7370 6c69 7429 0a0a  width(x_split)..
+00040530: 2020 2020 2020 2020 2320 466f 7220 6e6f          # For no
+00040540: 6e2d 6578 706c 6963 6974 2074 6f70 4c65  n-explicit topLe
+00040550: 6674 2064 6566 696e 6974 696f 6e73 2c20  ft definitions, 
+00040560: 6573 7469 6d61 7465 2074 6865 2063 656c  estimate the cel
+00040570: 6c20 6f66 6673 6574 2062 6173 6564 0a20  l offset based. 
+00040580: 2020 2020 2020 2023 206f 6e20 7468 6520         # on the 
+00040590: 7069 7865 6c73 2064 696d 656e 7369 6f6e  pixels dimension
+000405a0: 732e 2054 6869 7320 6973 206f 6e6c 7920  s. This is only 
+000405b0: 6120 776f 726b 6172 6f75 6e64 2061 6e64  a workaround and
+000405c0: 2064 6f65 736e 2774 2074 616b 650a 2020   doesn't take.  
+000405d0: 2020 2020 2020 2320 6164 6a75 7374 6564        # adjusted
+000405e0: 2063 656c 6c20 6469 6d65 6e73 696f 6e73   cell dimensions
+000405f0: 2069 6e74 6f20 6163 636f 756e 742e 0a20   into account.. 
+00040600: 2020 2020 2020 2069 6620 746f 705f 726f         if top_ro
+00040610: 7720 3d3d 2072 6f77 2061 6e64 206c 6566  w == row and lef
+00040620: 745f 636f 6c20 3d3d 2063 6f6c 3a0a 2020  t_col == col:.  
+00040630: 2020 2020 2020 2020 2020 746f 705f 726f            top_ro
+00040640: 7720 3d20 696e 7428 302e 3520 2b20 2879  w = int(0.5 + (y
+00040650: 5f73 706c 6974 202d 2033 3030 2920 2f20  _split - 300) / 
+00040660: 3230 202f 2031 3529 0a20 2020 2020 2020  20 / 15).       
+00040670: 2020 2020 206c 6566 745f 636f 6c20 3d20       left_col = 
+00040680: 696e 7428 302e 3520 2b20 2878 5f73 706c  int(0.5 + (x_spl
+00040690: 6974 202d 2033 3930 2920 2f20 3230 202f  it - 390) / 20 /
+000406a0: 2033 202a 2034 202f 2036 3429 0a0a 2020   3 * 4 / 64)..  
+000406b0: 2020 2020 2020 746f 705f 6c65 6674 5f63        top_left_c
+000406c0: 656c 6c20 3d20 786c 5f72 6f77 636f 6c5f  ell = xl_rowcol_
+000406d0: 746f 5f63 656c 6c28 746f 705f 726f 772c  to_cell(top_row,
+000406e0: 206c 6566 745f 636f 6c29 0a0a 2020 2020   left_col)..    
+000406f0: 2020 2020 2320 4966 2074 6865 7265 2069      # If there i
+00040700: 7320 6e6f 2073 656c 6563 7469 6f6e 2073  s no selection s
+00040710: 6574 2074 6865 2061 6374 6976 6520 6365  et the active ce
+00040720: 6c6c 2074 6f20 7468 6520 746f 7020 6c65  ll to the top le
+00040730: 6674 2063 656c 6c2e 0a20 2020 2020 2020  ft cell..       
+00040740: 2069 6620 6e6f 7420 6861 735f 7365 6c65   if not has_sele
+00040750: 6374 696f 6e3a 0a20 2020 2020 2020 2020  ction:.         
+00040760: 2020 2061 6374 6976 655f 6365 6c6c 203d     active_cell =
+00040770: 2074 6f70 5f6c 6566 745f 6365 6c6c 0a20   top_left_cell. 
+00040780: 2020 2020 2020 2020 2020 2073 7172 6566             sqref
+00040790: 203d 2074 6f70 5f6c 6566 745f 6365 6c6c   = top_left_cell
+000407a0: 0a0a 2020 2020 2020 2020 2320 5365 7420  ..        # Set 
+000407b0: 7468 6520 4365 6c6c 2073 656c 6563 7469  the Cell selecti
+000407c0: 6f6e 732e 0a20 2020 2020 2020 2069 6620  ons..        if 
+000407d0: 726f 7720 616e 6420 636f 6c3a 0a20 2020  row and col:.   
+000407e0: 2020 2020 2020 2020 2061 6374 6976 655f           active_
+000407f0: 7061 6e65 203d 2022 626f 7474 6f6d 5269  pane = "bottomRi
+00040800: 6768 7422 0a0a 2020 2020 2020 2020 2020  ght"..          
+00040810: 2020 726f 775f 6365 6c6c 203d 2078 6c5f    row_cell = xl_
+00040820: 726f 7763 6f6c 5f74 6f5f 6365 6c6c 2874  rowcol_to_cell(t
+00040830: 6f70 5f72 6f77 2c20 3029 0a20 2020 2020  op_row, 0).     
+00040840: 2020 2020 2020 2063 6f6c 5f63 656c 6c20         col_cell 
+00040850: 3d20 786c 5f72 6f77 636f 6c5f 746f 5f63  = xl_rowcol_to_c
+00040860: 656c 6c28 302c 206c 6566 745f 636f 6c29  ell(0, left_col)
+00040870: 0a0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00040880: 6c66 2e73 656c 6563 7469 6f6e 732e 6170  lf.selections.ap
+00040890: 7065 6e64 285b 2274 6f70 5269 6768 7422  pend(["topRight"
+000408a0: 2c20 636f 6c5f 6365 6c6c 2c20 636f 6c5f  , col_cell, col_
+000408b0: 6365 6c6c 5d29 0a20 2020 2020 2020 2020  cell]).         
+000408c0: 2020 2073 656c 662e 7365 6c65 6374 696f     self.selectio
+000408d0: 6e73 2e61 7070 656e 6428 5b22 626f 7474  ns.append(["bott
+000408e0: 6f6d 4c65 6674 222c 2072 6f77 5f63 656c  omLeft", row_cel
+000408f0: 6c2c 2072 6f77 5f63 656c 6c5d 290a 2020  l, row_cell]).  
+00040900: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
+00040910: 656c 6563 7469 6f6e 732e 6170 7065 6e64  elections.append
+00040920: 285b 2262 6f74 746f 6d52 6967 6874 222c  (["bottomRight",
+00040930: 2061 6374 6976 655f 6365 6c6c 2c20 7371   active_cell, sq
+00040940: 7265 665d 290a 0a20 2020 2020 2020 2065  ref])..        e
+00040950: 6c69 6620 636f 6c3a 0a20 2020 2020 2020  lif col:.       
+00040960: 2020 2020 2061 6374 6976 655f 7061 6e65       active_pane
+00040970: 203d 2022 746f 7052 6967 6874 220a 2020   = "topRight".  
+00040980: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
+00040990: 656c 6563 7469 6f6e 732e 6170 7065 6e64  elections.append
+000409a0: 285b 2274 6f70 5269 6768 7422 2c20 6163  (["topRight", ac
+000409b0: 7469 7665 5f63 656c 6c2c 2073 7172 6566  tive_cell, sqref
+000409c0: 5d29 0a0a 2020 2020 2020 2020 656c 7365  ])..        else
+000409d0: 3a0a 2020 2020 2020 2020 2020 2020 6163  :.            ac
+000409e0: 7469 7665 5f70 616e 6520 3d20 2262 6f74  tive_pane = "bot
+000409f0: 746f 6d4c 6566 7422 0a20 2020 2020 2020  tomLeft".       
+00040a00: 2020 2020 2073 656c 662e 7365 6c65 6374       self.select
+00040a10: 696f 6e73 2e61 7070 656e 6428 5b22 626f  ions.append(["bo
+00040a20: 7474 6f6d 4c65 6674 222c 2061 6374 6976  ttomLeft", activ
+00040a30: 655f 6365 6c6c 2c20 7371 7265 665d 290a  e_cell, sqref]).
+00040a40: 0a20 2020 2020 2020 2023 2046 6f72 6d61  .        # Forma
+00040a50: 7420 7370 6c69 7473 2074 6f20 7468 6520  t splits to the 
+00040a60: 7361 6d65 2070 7265 6369 7369 6f6e 2061  same precision a
+00040a70: 7320 4578 6365 6c2e 0a20 2020 2020 2020  s Excel..       
+00040a80: 2069 6620 785f 7370 6c69 743a 0a20 2020   if x_split:.   
+00040a90: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+00040aa0: 7465 732e 6170 7065 6e64 2828 2278 5370  tes.append(("xSp
+00040ab0: 6c69 7422 2c20 2225 2e31 3667 2220 2520  lit", "%.16g" % 
+00040ac0: 785f 7370 6c69 7429 290a 0a20 2020 2020  x_split))..     
+00040ad0: 2020 2069 6620 795f 7370 6c69 743a 0a20     if y_split:. 
+00040ae0: 2020 2020 2020 2020 2020 2061 7474 7269             attri
+00040af0: 6275 7465 732e 6170 7065 6e64 2828 2279  butes.append(("y
+00040b00: 5370 6c69 7422 2c20 2225 2e31 3667 2220  Split", "%.16g" 
+00040b10: 2520 795f 7370 6c69 7429 290a 0a20 2020  % y_split))..   
+00040b20: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
+00040b30: 6170 7065 6e64 2828 2274 6f70 4c65 6674  append(("topLeft
+00040b40: 4365 6c6c 222c 2074 6f70 5f6c 6566 745f  Cell", top_left_
+00040b50: 6365 6c6c 2929 0a0a 2020 2020 2020 2020  cell))..        
+00040b60: 6966 2068 6173 5f73 656c 6563 7469 6f6e  if has_selection
+00040b70: 3a0a 2020 2020 2020 2020 2020 2020 6174  :.            at
+00040b80: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
+00040b90: 2822 6163 7469 7665 5061 6e65 222c 2061  ("activePane", a
+00040ba0: 6374 6976 655f 7061 6e65 2929 0a0a 2020  ctive_pane))..  
+00040bb0: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
+00040bc0: 656d 7074 795f 7461 6728 2270 616e 6522  empty_tag("pane"
+00040bd0: 2c20 6174 7472 6962 7574 6573 290a 0a20  , attributes).. 
+00040be0: 2020 2064 6566 205f 6361 6c63 756c 6174     def _calculat
+00040bf0: 655f 785f 7370 6c69 745f 7769 6474 6828  e_x_split_width(
+00040c00: 7365 6c66 2c20 7769 6474 6829 3a0a 2020  self, width):.  
+00040c10: 2020 2020 2020 2320 436f 6e76 6572 7420        # Convert 
+00040c20: 636f 6c75 6d6e 2077 6964 7468 2066 726f  column width fro
+00040c30: 6d20 7573 6572 2075 6e69 7473 2074 6f20  m user units to 
+00040c40: 7061 6e65 2073 706c 6974 2077 6964 7468  pane split width
+00040c50: 2e0a 0a20 2020 2020 2020 206d 6178 5f64  ...        max_d
+00040c60: 6967 6974 5f77 6964 7468 203d 2037 2020  igit_width = 7  
+00040c70: 2320 466f 7220 4361 6c61 6272 6920 3131  # For Calabri 11
+00040c80: 2e0a 2020 2020 2020 2020 7061 6464 696e  ..        paddin
+00040c90: 6720 3d20 350a 0a20 2020 2020 2020 2023  g = 5..        #
+00040ca0: 2043 6f6e 7665 7274 2074 6f20 7069 7865   Convert to pixe
+00040cb0: 6c73 2e0a 2020 2020 2020 2020 6966 2077  ls..        if w
+00040cc0: 6964 7468 203c 2031 3a0a 2020 2020 2020  idth < 1:.      
+00040cd0: 2020 2020 2020 7069 7865 6c73 203d 2069        pixels = i
+00040ce0: 6e74 2877 6964 7468 202a 2028 6d61 785f  nt(width * (max_
+00040cf0: 6469 6769 745f 7769 6474 6820 2b20 7061  digit_width + pa
+00040d00: 6464 696e 6729 202b 2030 2e35 290a 2020  dding) + 0.5).  
+00040d10: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00040d20: 2020 2020 2020 2020 7069 7865 6c73 203d          pixels =
+00040d30: 2069 6e74 2877 6964 7468 202a 206d 6178   int(width * max
+00040d40: 5f64 6967 6974 5f77 6964 7468 202b 2030  _digit_width + 0
+00040d50: 2e35 2920 2b20 7061 6464 696e 670a 0a20  .5) + padding.. 
+00040d60: 2020 2020 2020 2023 2043 6f6e 7665 7274         # Convert
+00040d70: 2074 6f20 706f 696e 7473 2e0a 2020 2020   to points..    
+00040d80: 2020 2020 706f 696e 7473 203d 2070 6978      points = pix
+00040d90: 656c 7320 2a20 3320 2f20 340a 0a20 2020  els * 3 / 4..   
+00040da0: 2020 2020 2023 2043 6f6e 7665 7274 2074       # Convert t
+00040db0: 6f20 7477 6970 7320 2874 7765 6e74 6965  o twips (twentie
+00040dc0: 7468 7320 6f66 2061 2070 6f69 6e74 292e  ths of a point).
+00040dd0: 0a20 2020 2020 2020 2074 7769 7073 203d  .        twips =
+00040de0: 2070 6f69 6e74 7320 2a20 3230 0a0a 2020   points * 20..  
+00040df0: 2020 2020 2020 2320 4164 6420 6f66 6673        # Add offs
+00040e00: 6574 2f70 6164 6469 6e67 2e0a 2020 2020  et/padding..    
+00040e10: 2020 2020 7769 6474 6820 3d20 7477 6970      width = twip
+00040e20: 7320 2b20 3339 300a 0a20 2020 2020 2020  s + 390..       
+00040e30: 2072 6574 7572 6e20 7769 6474 680a 0a20   return width.. 
+00040e40: 2020 2064 6566 205f 7772 6974 655f 7461     def _write_ta
+00040e50: 626c 655f 7061 7274 7328 7365 6c66 293a  ble_parts(self):
+00040e60: 0a20 2020 2020 2020 2023 2057 7269 7465  .        # Write
+00040e70: 2074 6865 203c 7461 626c 6550 6172 7473   the <tableParts
+00040e80: 3e20 656c 656d 656e 742e 0a20 2020 2020  > element..     
+00040e90: 2020 2074 6162 6c65 7320 3d20 7365 6c66     tables = self
+00040ea0: 2e74 6162 6c65 730a 2020 2020 2020 2020  .tables.        
+00040eb0: 636f 756e 7420 3d20 6c65 6e28 7461 626c  count = len(tabl
+00040ec0: 6573 290a 0a20 2020 2020 2020 2023 2052  es)..        # R
+00040ed0: 6574 7572 6e20 6966 2077 6f72 6b73 6865  eturn if workshe
+00040ee0: 6574 2064 6f65 736e 2774 2063 6f6e 7461  et doesn't conta
+00040ef0: 696e 2061 6e79 2074 6162 6c65 732e 0a20  in any tables.. 
+00040f00: 2020 2020 2020 2069 6620 6e6f 7420 636f         if not co
+00040f10: 756e 743a 0a20 2020 2020 2020 2020 2020  unt:.           
+00040f20: 2072 6574 7572 6e0a 0a20 2020 2020 2020   return..       
+00040f30: 2061 7474 7269 6275 7465 7320 3d20 5b0a   attributes = [.
+00040f40: 2020 2020 2020 2020 2020 2020 280a 2020              (.  
+00040f50: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+00040f60: 6f75 6e74 222c 0a20 2020 2020 2020 2020  ount",.         
+00040f70: 2020 2020 2020 2063 6f75 6e74 2c0a 2020         count,.  
+00040f80: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00040f90: 2020 2020 5d0a 0a20 2020 2020 2020 2073      ]..        s
+00040fa0: 656c 662e 5f78 6d6c 5f73 7461 7274 5f74  elf._xml_start_t
+00040fb0: 6167 2822 7461 626c 6550 6172 7473 222c  ag("tableParts",
+00040fc0: 2061 7474 7269 6275 7465 7329 0a0a 2020   attributes)..  
+00040fd0: 2020 2020 2020 666f 7220 5f20 696e 2074        for _ in t
+00040fe0: 6162 6c65 733a 0a20 2020 2020 2020 2020  ables:.         
+00040ff0: 2020 2023 2057 7269 7465 2074 6865 2074     # Write the t
+00041000: 6162 6c65 5061 7274 2065 6c65 6d65 6e74  ablePart element
+00041010: 2e0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00041020: 6c66 2e72 656c 5f63 6f75 6e74 202b 3d20  lf.rel_count += 
+00041030: 310a 2020 2020 2020 2020 2020 2020 7365  1.            se
+00041040: 6c66 2e5f 7772 6974 655f 7461 626c 655f  lf._write_table_
+00041050: 7061 7274 2873 656c 662e 7265 6c5f 636f  part(self.rel_co
+00041060: 756e 7429 0a0a 2020 2020 2020 2020 7365  unt)..        se
+00041070: 6c66 2e5f 786d 6c5f 656e 645f 7461 6728  lf._xml_end_tag(
+00041080: 2274 6162 6c65 5061 7274 7322 290a 0a20  "tableParts").. 
+00041090: 2020 2064 6566 205f 7772 6974 655f 7461     def _write_ta
+000410a0: 626c 655f 7061 7274 2873 656c 662c 2072  ble_part(self, r
+000410b0: 5f69 6429 3a0a 2020 2020 2020 2020 2320  _id):.        # 
+000410c0: 5772 6974 6520 7468 6520 3c74 6162 6c65  Write the <table
+000410d0: 5061 7274 3e20 656c 656d 656e 742e 0a0a  Part> element...
+000410e0: 2020 2020 2020 2020 725f 6964 203d 2022          r_id = "
+000410f0: 7249 6422 202b 2073 7472 2872 5f69 6429  rId" + str(r_id)
+00041100: 0a0a 2020 2020 2020 2020 6174 7472 6962  ..        attrib
+00041110: 7574 6573 203d 205b 0a20 2020 2020 2020  utes = [.       
+00041120: 2020 2020 2028 0a20 2020 2020 2020 2020       (.         
+00041130: 2020 2020 2020 2022 723a 6964 222c 0a20         "r:id",. 
+00041140: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00041150: 5f69 642c 0a20 2020 2020 2020 2020 2020  _id,.           
+00041160: 2029 0a20 2020 2020 2020 205d 0a0a 2020   ).        ]..  
+00041170: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
+00041180: 656d 7074 795f 7461 6728 2274 6162 6c65  empty_tag("table
+00041190: 5061 7274 222c 2061 7474 7269 6275 7465  Part", attribute
+000411a0: 7329 0a0a 2020 2020 6465 6620 5f77 7269  s)..    def _wri
+000411b0: 7465 5f65 7874 5f6c 6973 7428 7365 6c66  te_ext_list(self
+000411c0: 293a 0a20 2020 2020 2020 2023 2057 7269  ):.        # Wri
+000411d0: 7465 2074 6865 203c 6578 744c 7374 3e20  te the <extLst> 
+000411e0: 656c 656d 656e 7420 666f 7220 6461 7461  element for data
+000411f0: 2062 6172 7320 616e 6420 7370 6172 6b6c   bars and sparkl
+00041200: 696e 6573 2e0a 2020 2020 2020 2020 6861  ines..        ha
+00041210: 735f 6461 7461 5f62 6172 7320 3d20 6c65  s_data_bars = le
+00041220: 6e28 7365 6c66 2e64 6174 615f 6261 7273  n(self.data_bars
+00041230: 5f32 3031 3029 0a20 2020 2020 2020 2068  _2010).        h
+00041240: 6173 5f73 7061 726b 6c69 6e65 7320 3d20  as_sparklines = 
+00041250: 6c65 6e28 7365 6c66 2e73 7061 726b 6c69  len(self.sparkli
+00041260: 6e65 7329 0a0a 2020 2020 2020 2020 6966  nes)..        if
+00041270: 206e 6f74 2068 6173 5f64 6174 615f 6261   not has_data_ba
+00041280: 7273 2061 6e64 206e 6f74 2068 6173 5f73  rs and not has_s
+00041290: 7061 726b 6c69 6e65 733a 0a20 2020 2020  parklines:.     
+000412a0: 2020 2020 2020 2072 6574 7572 6e0a 0a20         return.. 
+000412b0: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
+000412c0: 6865 2065 7874 4c73 7420 656c 656d 656e  he extLst elemen
+000412d0: 742e 0a20 2020 2020 2020 2073 656c 662e  t..        self.
+000412e0: 5f78 6d6c 5f73 7461 7274 5f74 6167 2822  _xml_start_tag("
+000412f0: 6578 744c 7374 2229 0a0a 2020 2020 2020  extLst")..      
+00041300: 2020 6966 2068 6173 5f64 6174 615f 6261    if has_data_ba
+00041310: 7273 3a0a 2020 2020 2020 2020 2020 2020  rs:.            
+00041320: 7365 6c66 2e5f 7772 6974 655f 6578 745f  self._write_ext_
+00041330: 6c69 7374 5f64 6174 615f 6261 7273 2829  list_data_bars()
+00041340: 0a0a 2020 2020 2020 2020 6966 2068 6173  ..        if has
+00041350: 5f73 7061 726b 6c69 6e65 733a 0a20 2020  _sparklines:.   
+00041360: 2020 2020 2020 2020 2073 656c 662e 5f77           self._w
+00041370: 7269 7465 5f65 7874 5f6c 6973 745f 7370  rite_ext_list_sp
+00041380: 6172 6b6c 696e 6573 2829 0a0a 2020 2020  arklines()..    
+00041390: 2020 2020 7365 6c66 2e5f 786d 6c5f 656e      self._xml_en
+000413a0: 645f 7461 6728 2265 7874 4c73 7422 290a  d_tag("extLst").
+000413b0: 0a20 2020 2064 6566 205f 7772 6974 655f  .    def _write_
+000413c0: 6578 745f 6c69 7374 5f64 6174 615f 6261  ext_list_data_ba
+000413d0: 7273 2873 656c 6629 3a0a 2020 2020 2020  rs(self):.      
+000413e0: 2020 2320 5772 6974 6520 7468 6520 4578    # Write the Ex
+000413f0: 6365 6c20 3230 3130 2064 6174 615f 6261  cel 2010 data_ba
+00041400: 7220 7375 6265 6c65 6d65 6e74 732e 0a20  r subelements.. 
+00041410: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
+00041420: 7465 5f65 7874 2822 7b37 3843 3044 3933  te_ext("{78C0D93
+00041430: 312d 3634 3337 2d34 3037 642d 4138 4545  1-6437-407d-A8EE
+00041440: 2d46 3041 4144 3735 3339 4536 357d 2229  -F0AAD7539E65}")
+00041450: 0a0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+00041460: 786d 6c5f 7374 6172 745f 7461 6728 2278  xml_start_tag("x
+00041470: 3134 3a63 6f6e 6469 7469 6f6e 616c 466f  14:conditionalFo
+00041480: 726d 6174 7469 6e67 7322 290a 0a20 2020  rmattings")..   
+00041490: 2020 2020 2023 2057 7269 7465 2074 6865       # Write the
+000414a0: 2045 7863 656c 2032 3031 3020 636f 6e64   Excel 2010 cond
+000414b0: 6974 696f 6e61 6c20 666f 726d 6174 7469  itional formatti
+000414c0: 6e67 2064 6174 6120 6261 7220 656c 656d  ng data bar elem
+000414d0: 656e 7473 2e0a 2020 2020 2020 2020 666f  ents..        fo
+000414e0: 7220 6461 7461 5f62 6172 2069 6e20 7365  r data_bar in se
+000414f0: 6c66 2e64 6174 615f 6261 7273 5f32 3031  lf.data_bars_201
+00041500: 303a 0a20 2020 2020 2020 2020 2020 2023  0:.            #
+00041510: 2057 7269 7465 2074 6865 2078 3134 3a63   Write the x14:c
+00041520: 6f6e 6469 7469 6f6e 616c 466f 726d 6174  onditionalFormat
+00041530: 7469 6e67 2065 6c65 6d65 6e74 2e0a 2020  ting element..  
+00041540: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00041550: 7772 6974 655f 636f 6e64 6974 696f 6e61  write_conditiona
+00041560: 6c5f 666f 726d 6174 7469 6e67 5f32 3031  l_formatting_201
+00041570: 3028 6461 7461 5f62 6172 290a 0a20 2020  0(data_bar)..   
+00041580: 2020 2020 2073 656c 662e 5f78 6d6c 5f65       self._xml_e
+00041590: 6e64 5f74 6167 2822 7831 343a 636f 6e64  nd_tag("x14:cond
+000415a0: 6974 696f 6e61 6c46 6f72 6d61 7474 696e  itionalFormattin
+000415b0: 6773 2229 0a20 2020 2020 2020 2073 656c  gs").        sel
+000415c0: 662e 5f78 6d6c 5f65 6e64 5f74 6167 2822  f._xml_end_tag("
+000415d0: 6578 7422 290a 0a20 2020 2064 6566 205f  ext")..    def _
+000415e0: 7772 6974 655f 636f 6e64 6974 696f 6e61  write_conditiona
+000415f0: 6c5f 666f 726d 6174 7469 6e67 5f32 3031  l_formatting_201
+00041600: 3028 7365 6c66 2c20 6461 7461 5f62 6172  0(self, data_bar
+00041610: 293a 0a20 2020 2020 2020 2023 2057 7269  ):.        # Wri
+00041620: 7465 2074 6865 203c 7831 343a 636f 6e64  te the <x14:cond
+00041630: 6974 696f 6e61 6c46 6f72 6d61 7474 696e  itionalFormattin
+00041640: 673e 2065 6c65 6d65 6e74 2e0a 2020 2020  g> element..    
+00041650: 2020 2020 786d 6c6e 735f 786d 203d 2022      xmlns_xm = "
+00041660: 6874 7470 3a2f 2f73 6368 656d 6173 2e6d  http://schemas.m
+00041670: 6963 726f 736f 6674 2e63 6f6d 2f6f 6666  icrosoft.com/off
+00041680: 6963 652f 6578 6365 6c2f 3230 3036 2f6d  ice/excel/2006/m
+00041690: 6169 6e22 0a0a 2020 2020 2020 2020 6174  ain"..        at
+000416a0: 7472 6962 7574 6573 203d 205b 2822 786d  tributes = [("xm
+000416b0: 6c6e 733a 786d 222c 2078 6d6c 6e73 5f78  lns:xm", xmlns_x
+000416c0: 6d29 5d0a 0a20 2020 2020 2020 2073 656c  m)]..        sel
+000416d0: 662e 5f78 6d6c 5f73 7461 7274 5f74 6167  f._xml_start_tag
+000416e0: 2822 7831 343a 636f 6e64 6974 696f 6e61  ("x14:conditiona
+000416f0: 6c46 6f72 6d61 7474 696e 6722 2c20 6174  lFormatting", at
+00041700: 7472 6962 7574 6573 290a 0a20 2020 2020  tributes)..     
+00041710: 2020 2023 2057 7269 7465 2074 6865 2078     # Write the x
+00041720: 3134 3a63 6652 756c 6520 656c 656d 656e  14:cfRule elemen
+00041730: 742e 0a20 2020 2020 2020 2073 656c 662e  t..        self.
+00041740: 5f77 7269 7465 5f78 3134 5f63 665f 7275  _write_x14_cf_ru
+00041750: 6c65 2864 6174 615f 6261 7229 0a0a 2020  le(data_bar)..  
+00041760: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
+00041770: 6520 7831 343a 6461 7461 4261 7220 656c  e x14:dataBar el
+00041780: 656d 656e 742e 0a20 2020 2020 2020 2073  ement..        s
+00041790: 656c 662e 5f77 7269 7465 5f78 3134 5f64  elf._write_x14_d
+000417a0: 6174 615f 6261 7228 6461 7461 5f62 6172  ata_bar(data_bar
+000417b0: 290a 0a20 2020 2020 2020 2023 2057 7269  )..        # Wri
+000417c0: 7465 2074 6865 2078 3134 206d 6178 2061  te the x14 max a
+000417d0: 6e64 206d 696e 2064 6174 6120 6261 7273  nd min data bars
+000417e0: 2e0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+000417f0: 7772 6974 655f 7831 345f 6366 766f 2864  write_x14_cfvo(d
+00041800: 6174 615f 6261 725b 2278 3134 5f6d 696e  ata_bar["x14_min
+00041810: 5f74 7970 6522 5d2c 2064 6174 615f 6261  _type"], data_ba
+00041820: 725b 226d 696e 5f76 616c 7565 225d 290a  r["min_value"]).
+00041830: 2020 2020 2020 2020 7365 6c66 2e5f 7772          self._wr
+00041840: 6974 655f 7831 345f 6366 766f 2864 6174  ite_x14_cfvo(dat
+00041850: 615f 6261 725b 2278 3134 5f6d 6178 5f74  a_bar["x14_max_t
+00041860: 7970 6522 5d2c 2064 6174 615f 6261 725b  ype"], data_bar[
+00041870: 226d 6178 5f76 616c 7565 225d 290a 0a20  "max_value"]).. 
+00041880: 2020 2020 2020 2069 6620 6e6f 7420 6461         if not da
+00041890: 7461 5f62 6172 5b22 6261 725f 6e6f 5f62  ta_bar["bar_no_b
+000418a0: 6f72 6465 7222 5d3a 0a20 2020 2020 2020  order"]:.       
+000418b0: 2020 2020 2023 2057 7269 7465 2074 6865       # Write the
+000418c0: 2078 3134 3a62 6f72 6465 7243 6f6c 6f72   x14:borderColor
+000418d0: 2065 6c65 6d65 6e74 2e0a 2020 2020 2020   element..      
+000418e0: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
+000418f0: 655f 7831 345f 626f 7264 6572 5f63 6f6c  e_x14_border_col
+00041900: 6f72 2864 6174 615f 6261 725b 2262 6172  or(data_bar["bar
+00041910: 5f62 6f72 6465 725f 636f 6c6f 7222 5d29  _border_color"])
+00041920: 0a0a 2020 2020 2020 2020 2320 5772 6974  ..        # Writ
+00041930: 6520 7468 6520 7831 343a 6e65 6761 7469  e the x14:negati
+00041940: 7665 4669 6c6c 436f 6c6f 7220 656c 656d  veFillColor elem
+00041950: 656e 742e 0a20 2020 2020 2020 2069 6620  ent..        if 
+00041960: 6e6f 7420 6461 7461 5f62 6172 5b22 6261  not data_bar["ba
+00041970: 725f 6e65 6761 7469 7665 5f63 6f6c 6f72  r_negative_color
+00041980: 5f73 616d 6522 5d3a 0a20 2020 2020 2020  _same"]:.       
+00041990: 2020 2020 2073 656c 662e 5f77 7269 7465       self._write
+000419a0: 5f78 3134 5f6e 6567 6174 6976 655f 6669  _x14_negative_fi
+000419b0: 6c6c 5f63 6f6c 6f72 2864 6174 615f 6261  ll_color(data_ba
+000419c0: 725b 2262 6172 5f6e 6567 6174 6976 655f  r["bar_negative_
+000419d0: 636f 6c6f 7222 5d29 0a0a 2020 2020 2020  color"])..      
+000419e0: 2020 2320 5772 6974 6520 7468 6520 7831    # Write the x1
+000419f0: 343a 6e65 6761 7469 7665 426f 7264 6572  4:negativeBorder
+00041a00: 436f 6c6f 7220 656c 656d 656e 742e 0a20  Color element.. 
+00041a10: 2020 2020 2020 2069 6620 280a 2020 2020         if (.    
+00041a20: 2020 2020 2020 2020 6e6f 7420 6461 7461          not data
+00041a30: 5f62 6172 5b22 6261 725f 6e6f 5f62 6f72  _bar["bar_no_bor
+00041a40: 6465 7222 5d0a 2020 2020 2020 2020 2020  der"].          
+00041a50: 2020 616e 6420 6e6f 7420 6461 7461 5f62    and not data_b
+00041a60: 6172 5b22 6261 725f 6e65 6761 7469 7665  ar["bar_negative
+00041a70: 5f62 6f72 6465 725f 636f 6c6f 725f 7361  _border_color_sa
+00041a80: 6d65 225d 0a20 2020 2020 2020 2029 3a0a  me"].        ):.
+00041a90: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00041aa0: 2e5f 7772 6974 655f 7831 345f 6e65 6761  ._write_x14_nega
+00041ab0: 7469 7665 5f62 6f72 6465 725f 636f 6c6f  tive_border_colo
+00041ac0: 7228 6461 7461 5f62 6172 5b22 6261 725f  r(data_bar["bar_
+00041ad0: 6e65 6761 7469 7665 5f62 6f72 6465 725f  negative_border_
+00041ae0: 636f 6c6f 7222 5d29 0a0a 2020 2020 2020  color"])..      
+00041af0: 2020 2320 5772 6974 6520 7468 6520 7831    # Write the x1
+00041b00: 343a 6178 6973 436f 6c6f 7220 656c 656d  4:axisColor elem
+00041b10: 656e 742e 0a20 2020 2020 2020 2069 6620  ent..        if 
+00041b20: 6461 7461 5f62 6172 5b22 6261 725f 6178  data_bar["bar_ax
+00041b30: 6973 5f70 6f73 6974 696f 6e22 5d20 213d  is_position"] !=
+00041b40: 2022 6e6f 6e65 223a 0a20 2020 2020 2020   "none":.       
+00041b50: 2020 2020 2073 656c 662e 5f77 7269 7465       self._write
+00041b60: 5f78 3134 5f61 7869 735f 636f 6c6f 7228  _x14_axis_color(
+00041b70: 6461 7461 5f62 6172 5b22 6261 725f 6178  data_bar["bar_ax
+00041b80: 6973 5f63 6f6c 6f72 225d 290a 0a20 2020  is_color"])..   
+00041b90: 2020 2020 2073 656c 662e 5f78 6d6c 5f65       self._xml_e
+00041ba0: 6e64 5f74 6167 2822 7831 343a 6461 7461  nd_tag("x14:data
+00041bb0: 4261 7222 290a 2020 2020 2020 2020 7365  Bar").        se
+00041bc0: 6c66 2e5f 786d 6c5f 656e 645f 7461 6728  lf._xml_end_tag(
+00041bd0: 2278 3134 3a63 6652 756c 6522 290a 0a20  "x14:cfRule").. 
+00041be0: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
+00041bf0: 6865 2078 6d3a 7371 7265 6620 656c 656d  he xm:sqref elem
+00041c00: 656e 742e 0a20 2020 2020 2020 2073 656c  ent..        sel
+00041c10: 662e 5f78 6d6c 5f64 6174 615f 656c 656d  f._xml_data_elem
+00041c20: 656e 7428 2278 6d3a 7371 7265 6622 2c20  ent("xm:sqref", 
+00041c30: 6461 7461 5f62 6172 5b22 7261 6e67 6522  data_bar["range"
+00041c40: 5d29 0a0a 2020 2020 2020 2020 7365 6c66  ])..        self
+00041c50: 2e5f 786d 6c5f 656e 645f 7461 6728 2278  ._xml_end_tag("x
+00041c60: 3134 3a63 6f6e 6469 7469 6f6e 616c 466f  14:conditionalFo
+00041c70: 726d 6174 7469 6e67 2229 0a0a 2020 2020  rmatting")..    
+00041c80: 6465 6620 5f77 7269 7465 5f78 3134 5f63  def _write_x14_c
+00041c90: 665f 7275 6c65 2873 656c 662c 2064 6174  f_rule(self, dat
+00041ca0: 615f 6261 7229 3a0a 2020 2020 2020 2020  a_bar):.        
+00041cb0: 2320 5772 6974 6520 7468 6520 3c78 3134  # Write the <x14
+00041cc0: 3a63 6652 756c 653e 2065 6c65 6d65 6e74  :cfRule> element
+00041cd0: 2e0a 2020 2020 2020 2020 7275 6c65 5f74  ..        rule_t
+00041ce0: 7970 6520 3d20 2264 6174 6142 6172 220a  ype = "dataBar".
+00041cf0: 2020 2020 2020 2020 6775 6964 203d 2064          guid = d
+00041d00: 6174 615f 6261 725b 2267 7569 6422 5d0a  ata_bar["guid"].
+00041d10: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
+00041d20: 6573 203d 205b 2822 7479 7065 222c 2072  es = [("type", r
+00041d30: 756c 655f 7479 7065 292c 2028 2269 6422  ule_type), ("id"
+00041d40: 2c20 6775 6964 295d 0a0a 2020 2020 2020  , guid)]..      
+00041d50: 2020 7365 6c66 2e5f 786d 6c5f 7374 6172    self._xml_star
+00041d60: 745f 7461 6728 2278 3134 3a63 6652 756c  t_tag("x14:cfRul
+00041d70: 6522 2c20 6174 7472 6962 7574 6573 290a  e", attributes).
+00041d80: 0a20 2020 2064 6566 205f 7772 6974 655f  .    def _write_
+00041d90: 7831 345f 6461 7461 5f62 6172 2873 656c  x14_data_bar(sel
+00041da0: 662c 2064 6174 615f 6261 7229 3a0a 2020  f, data_bar):.  
+00041db0: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
+00041dc0: 6520 3c78 3134 3a64 6174 6142 6172 3e20  e <x14:dataBar> 
+00041dd0: 656c 656d 656e 742e 0a20 2020 2020 2020  element..       
+00041de0: 206d 696e 5f6c 656e 6774 6820 3d20 300a   min_length = 0.
+00041df0: 2020 2020 2020 2020 6d61 785f 6c65 6e67          max_leng
+00041e00: 7468 203d 2031 3030 0a0a 2020 2020 2020  th = 100..      
+00041e10: 2020 6174 7472 6962 7574 6573 203d 205b    attributes = [
+00041e20: 0a20 2020 2020 2020 2020 2020 2028 226d  .            ("m
+00041e30: 696e 4c65 6e67 7468 222c 206d 696e 5f6c  inLength", min_l
+00041e40: 656e 6774 6829 2c0a 2020 2020 2020 2020  ength),.        
+00041e50: 2020 2020 2822 6d61 784c 656e 6774 6822      ("maxLength"
+00041e60: 2c20 6d61 785f 6c65 6e67 7468 292c 0a20  , max_length),. 
+00041e70: 2020 2020 2020 205d 0a0a 2020 2020 2020         ]..      
+00041e80: 2020 6966 206e 6f74 2064 6174 615f 6261    if not data_ba
+00041e90: 725b 2262 6172 5f6e 6f5f 626f 7264 6572  r["bar_no_border
+00041ea0: 225d 3a0a 2020 2020 2020 2020 2020 2020  "]:.            
+00041eb0: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
+00041ec0: 6428 2822 626f 7264 6572 222c 2031 2929  d(("border", 1))
+00041ed0: 0a0a 2020 2020 2020 2020 6966 2064 6174  ..        if dat
+00041ee0: 615f 6261 725b 2262 6172 5f73 6f6c 6964  a_bar["bar_solid
+00041ef0: 225d 3a0a 2020 2020 2020 2020 2020 2020  "]:.            
+00041f00: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
+00041f10: 6428 2822 6772 6164 6965 6e74 222c 2030  d(("gradient", 0
+00041f20: 2929 0a0a 2020 2020 2020 2020 6966 2064  ))..        if d
+00041f30: 6174 615f 6261 725b 2262 6172 5f64 6972  ata_bar["bar_dir
+00041f40: 6563 7469 6f6e 225d 203d 3d20 226c 6566  ection"] == "lef
+00041f50: 7422 3a0a 2020 2020 2020 2020 2020 2020  t":.            
+00041f60: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
+00041f70: 6428 2822 6469 7265 6374 696f 6e22 2c20  d(("direction", 
+00041f80: 226c 6566 7454 6f52 6967 6874 2229 290a  "leftToRight")).
+00041f90: 0a20 2020 2020 2020 2069 6620 6461 7461  .        if data
+00041fa0: 5f62 6172 5b22 6261 725f 6469 7265 6374  _bar["bar_direct
+00041fb0: 696f 6e22 5d20 3d3d 2022 7269 6768 7422  ion"] == "right"
+00041fc0: 3a0a 2020 2020 2020 2020 2020 2020 6174  :.            at
+00041fd0: 7472 6962 7574 6573 2e61 7070 656e 6428  tributes.append(
+00041fe0: 2822 6469 7265 6374 696f 6e22 2c20 2272  ("direction", "r
+00041ff0: 6967 6874 546f 4c65 6674 2229 290a 0a20  ightToLeft")).. 
+00042000: 2020 2020 2020 2069 6620 6461 7461 5f62         if data_b
+00042010: 6172 5b22 6261 725f 6e65 6761 7469 7665  ar["bar_negative
+00042020: 5f63 6f6c 6f72 5f73 616d 6522 5d3a 0a20  _color_same"]:. 
+00042030: 2020 2020 2020 2020 2020 2061 7474 7269             attri
+00042040: 6275 7465 732e 6170 7065 6e64 2828 226e  butes.append(("n
+00042050: 6567 6174 6976 6542 6172 436f 6c6f 7253  egativeBarColorS
+00042060: 616d 6541 7350 6f73 6974 6976 6522 2c20  ameAsPositive", 
+00042070: 3129 290a 0a20 2020 2020 2020 2069 6620  1))..        if 
+00042080: 280a 2020 2020 2020 2020 2020 2020 6e6f  (.            no
+00042090: 7420 6461 7461 5f62 6172 5b22 6261 725f  t data_bar["bar_
+000420a0: 6e6f 5f62 6f72 6465 7222 5d0a 2020 2020  no_border"].    
+000420b0: 2020 2020 2020 2020 616e 6420 6e6f 7420          and not 
+000420c0: 6461 7461 5f62 6172 5b22 6261 725f 6e65  data_bar["bar_ne
+000420d0: 6761 7469 7665 5f62 6f72 6465 725f 636f  gative_border_co
+000420e0: 6c6f 725f 7361 6d65 225d 0a20 2020 2020  lor_same"].     
+000420f0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00042100: 2020 6174 7472 6962 7574 6573 2e61 7070    attributes.app
+00042110: 656e 6428 2822 6e65 6761 7469 7665 4261  end(("negativeBa
+00042120: 7242 6f72 6465 7243 6f6c 6f72 5361 6d65  rBorderColorSame
+00042130: 4173 506f 7369 7469 7665 222c 2030 2929  AsPositive", 0))
+00042140: 0a0a 2020 2020 2020 2020 6966 2064 6174  ..        if dat
+00042150: 615f 6261 725b 2262 6172 5f61 7869 735f  a_bar["bar_axis_
+00042160: 706f 7369 7469 6f6e 225d 203d 3d20 226d  position"] == "m
+00042170: 6964 646c 6522 3a0a 2020 2020 2020 2020  iddle":.        
+00042180: 2020 2020 6174 7472 6962 7574 6573 2e61      attributes.a
+00042190: 7070 656e 6428 2822 6178 6973 506f 7369  ppend(("axisPosi
+000421a0: 7469 6f6e 222c 2022 6d69 6464 6c65 2229  tion", "middle")
+000421b0: 290a 0a20 2020 2020 2020 2069 6620 6461  )..        if da
+000421c0: 7461 5f62 6172 5b22 6261 725f 6178 6973  ta_bar["bar_axis
+000421d0: 5f70 6f73 6974 696f 6e22 5d20 3d3d 2022  _position"] == "
+000421e0: 6e6f 6e65 223a 0a20 2020 2020 2020 2020  none":.         
+000421f0: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
+00042200: 7065 6e64 2828 2261 7869 7350 6f73 6974  pend(("axisPosit
+00042210: 696f 6e22 2c20 226e 6f6e 6522 2929 0a0a  ion", "none"))..
+00042220: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
+00042230: 6c5f 7374 6172 745f 7461 6728 2278 3134  l_start_tag("x14
+00042240: 3a64 6174 6142 6172 222c 2061 7474 7269  :dataBar", attri
+00042250: 6275 7465 7329 0a0a 2020 2020 6465 6620  butes)..    def 
+00042260: 5f77 7269 7465 5f78 3134 5f63 6676 6f28  _write_x14_cfvo(
+00042270: 7365 6c66 2c20 7275 6c65 5f74 7970 652c  self, rule_type,
+00042280: 2076 616c 7565 293a 0a20 2020 2020 2020   value):.       
+00042290: 2023 2057 7269 7465 2074 6865 203c 7831   # Write the <x1
+000422a0: 343a 6366 766f 3e20 656c 656d 656e 742e  4:cfvo> element.
+000422b0: 0a20 2020 2020 2020 2061 7474 7269 6275  .        attribu
+000422c0: 7465 7320 3d20 5b28 2274 7970 6522 2c20  tes = [("type", 
+000422d0: 7275 6c65 5f74 7970 6529 5d0a 0a20 2020  rule_type)]..   
+000422e0: 2020 2020 2069 6620 7275 6c65 5f74 7970       if rule_typ
+000422f0: 6520 696e 2028 226d 696e 222c 2022 6d61  e in ("min", "ma
+00042300: 7822 2c20 2261 7574 6f4d 696e 222c 2022  x", "autoMin", "
+00042310: 6175 746f 4d61 7822 293a 0a20 2020 2020  autoMax"):.     
+00042320: 2020 2020 2020 2073 656c 662e 5f78 6d6c         self._xml
+00042330: 5f65 6d70 7479 5f74 6167 2822 7831 343a  _empty_tag("x14:
+00042340: 6366 766f 222c 2061 7474 7269 6275 7465  cfvo", attribute
+00042350: 7329 0a20 2020 2020 2020 2065 6c73 653a  s).        else:
+00042360: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00042370: 662e 5f78 6d6c 5f73 7461 7274 5f74 6167  f._xml_start_tag
+00042380: 2822 7831 343a 6366 766f 222c 2061 7474  ("x14:cfvo", att
+00042390: 7269 6275 7465 7329 0a20 2020 2020 2020  ributes).       
+000423a0: 2020 2020 2073 656c 662e 5f78 6d6c 5f64       self._xml_d
+000423b0: 6174 615f 656c 656d 656e 7428 2278 6d3a  ata_element("xm:
+000423c0: 6622 2c20 7661 6c75 6529 0a20 2020 2020  f", value).     
+000423d0: 2020 2020 2020 2073 656c 662e 5f78 6d6c         self._xml
+000423e0: 5f65 6e64 5f74 6167 2822 7831 343a 6366  _end_tag("x14:cf
+000423f0: 766f 2229 0a0a 2020 2020 6465 6620 5f77  vo")..    def _w
+00042400: 7269 7465 5f78 3134 5f62 6f72 6465 725f  rite_x14_border_
+00042410: 636f 6c6f 7228 7365 6c66 2c20 7267 6229  color(self, rgb)
+00042420: 3a0a 2020 2020 2020 2020 2320 5772 6974  :.        # Writ
+00042430: 6520 7468 6520 3c78 3134 3a62 6f72 6465  e the <x14:borde
+00042440: 7243 6f6c 6f72 3e20 656c 656d 656e 742e  rColor> element.
+00042450: 0a20 2020 2020 2020 2061 7474 7269 6275  .        attribu
+00042460: 7465 7320 3d20 5b28 2272 6762 222c 2072  tes = [("rgb", r
+00042470: 6762 295d 0a20 2020 2020 2020 2073 656c  gb)].        sel
+00042480: 662e 5f78 6d6c 5f65 6d70 7479 5f74 6167  f._xml_empty_tag
+00042490: 2822 7831 343a 626f 7264 6572 436f 6c6f  ("x14:borderColo
+000424a0: 7222 2c20 6174 7472 6962 7574 6573 290a  r", attributes).
+000424b0: 0a20 2020 2064 6566 205f 7772 6974 655f  .    def _write_
+000424c0: 7831 345f 6e65 6761 7469 7665 5f66 696c  x14_negative_fil
+000424d0: 6c5f 636f 6c6f 7228 7365 6c66 2c20 7267  l_color(self, rg
+000424e0: 6229 3a0a 2020 2020 2020 2020 2320 5772  b):.        # Wr
+000424f0: 6974 6520 7468 6520 3c78 3134 3a6e 6567  ite the <x14:neg
+00042500: 6174 6976 6546 696c 6c43 6f6c 6f72 3e20  ativeFillColor> 
+00042510: 656c 656d 656e 742e 0a20 2020 2020 2020  element..       
+00042520: 2061 7474 7269 6275 7465 7320 3d20 5b28   attributes = [(
+00042530: 2272 6762 222c 2072 6762 295d 0a20 2020  "rgb", rgb)].   
+00042540: 2020 2020 2073 656c 662e 5f78 6d6c 5f65       self._xml_e
+00042550: 6d70 7479 5f74 6167 2822 7831 343a 6e65  mpty_tag("x14:ne
+00042560: 6761 7469 7665 4669 6c6c 436f 6c6f 7222  gativeFillColor"
+00042570: 2c20 6174 7472 6962 7574 6573 290a 0a20  , attributes).. 
+00042580: 2020 2064 6566 205f 7772 6974 655f 7831     def _write_x1
+00042590: 345f 6e65 6761 7469 7665 5f62 6f72 6465  4_negative_borde
+000425a0: 725f 636f 6c6f 7228 7365 6c66 2c20 7267  r_color(self, rg
+000425b0: 6229 3a0a 2020 2020 2020 2020 2320 5772  b):.        # Wr
+000425c0: 6974 6520 7468 6520 3c78 3134 3a6e 6567  ite the <x14:neg
+000425d0: 6174 6976 6542 6f72 6465 7243 6f6c 6f72  ativeBorderColor
+000425e0: 3e20 656c 656d 656e 742e 0a20 2020 2020  > element..     
+000425f0: 2020 2061 7474 7269 6275 7465 7320 3d20     attributes = 
+00042600: 5b28 2272 6762 222c 2072 6762 295d 0a20  [("rgb", rgb)]. 
+00042610: 2020 2020 2020 2073 656c 662e 5f78 6d6c         self._xml
+00042620: 5f65 6d70 7479 5f74 6167 2822 7831 343a  _empty_tag("x14:
+00042630: 6e65 6761 7469 7665 426f 7264 6572 436f  negativeBorderCo
+00042640: 6c6f 7222 2c20 6174 7472 6962 7574 6573  lor", attributes
+00042650: 290a 0a20 2020 2064 6566 205f 7772 6974  )..    def _writ
+00042660: 655f 7831 345f 6178 6973 5f63 6f6c 6f72  e_x14_axis_color
+00042670: 2873 656c 662c 2072 6762 293a 0a20 2020  (self, rgb):.   
+00042680: 2020 2020 2023 2057 7269 7465 2074 6865       # Write the
+00042690: 203c 7831 343a 6178 6973 436f 6c6f 723e   <x14:axisColor>
+000426a0: 2065 6c65 6d65 6e74 2e0a 2020 2020 2020   element..      
+000426b0: 2020 6174 7472 6962 7574 6573 203d 205b    attributes = [
+000426c0: 2822 7267 6222 2c20 7267 6229 5d0a 2020  ("rgb", rgb)].  
+000426d0: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
+000426e0: 656d 7074 795f 7461 6728 2278 3134 3a61  empty_tag("x14:a
+000426f0: 7869 7343 6f6c 6f72 222c 2061 7474 7269  xisColor", attri
+00042700: 6275 7465 7329 0a0a 2020 2020 6465 6620  butes)..    def 
+00042710: 5f77 7269 7465 5f65 7874 5f6c 6973 745f  _write_ext_list_
+00042720: 7370 6172 6b6c 696e 6573 2873 656c 6629  sparklines(self)
+00042730: 3a0a 2020 2020 2020 2020 2320 5772 6974  :.        # Writ
+00042740: 6520 7468 6520 7370 6172 6b6c 696e 6520  e the sparkline 
+00042750: 6578 7465 6e73 696f 6e20 7375 622d 656c  extension sub-el
+00042760: 656d 656e 7473 2e0a 2020 2020 2020 2020  ements..        
+00042770: 7365 6c66 2e5f 7772 6974 655f 6578 7428  self._write_ext(
+00042780: 227b 3035 4336 3035 3335 2d31 4631 362d  "{05C60535-1F16-
+00042790: 3466 6432 2d42 3633 332d 4634 4633 3646  4fd2-B633-F4F36F
+000427a0: 3042 3634 4530 7d22 290a 0a20 2020 2020  0B64E0}")..     
+000427b0: 2020 2023 2057 7269 7465 2074 6865 2078     # Write the x
+000427c0: 3134 3a73 7061 726b 6c69 6e65 4772 6f75  14:sparklineGrou
+000427d0: 7073 2065 6c65 6d65 6e74 2e0a 2020 2020  ps element..    
+000427e0: 2020 2020 7365 6c66 2e5f 7772 6974 655f      self._write_
+000427f0: 7370 6172 6b6c 696e 655f 6772 6f75 7073  sparkline_groups
+00042800: 2829 0a0a 2020 2020 2020 2020 2320 5772  ()..        # Wr
+00042810: 6974 6520 7468 6520 7370 6172 6b6c 696e  ite the sparklin
+00042820: 6520 656c 656d 656e 7473 2e0a 2020 2020  e elements..    
+00042830: 2020 2020 666f 7220 7370 6172 6b6c 696e      for sparklin
+00042840: 6520 696e 2072 6576 6572 7365 6428 7365  e in reversed(se
+00042850: 6c66 2e73 7061 726b 6c69 6e65 7329 3a0a  lf.sparklines):.
+00042860: 2020 2020 2020 2020 2020 2020 2320 5772              # Wr
+00042870: 6974 6520 7468 6520 7831 343a 7370 6172  ite the x14:spar
+00042880: 6b6c 696e 6547 726f 7570 2065 6c65 6d65  klineGroup eleme
+00042890: 6e74 2e0a 2020 2020 2020 2020 2020 2020  nt..            
+000428a0: 7365 6c66 2e5f 7772 6974 655f 7370 6172  self._write_spar
+000428b0: 6b6c 696e 655f 6772 6f75 7028 7370 6172  kline_group(spar
+000428c0: 6b6c 696e 6529 0a0a 2020 2020 2020 2020  kline)..        
+000428d0: 2020 2020 2320 5772 6974 6520 7468 6520      # Write the 
+000428e0: 7831 343a 636f 6c6f 7253 6572 6965 7320  x14:colorSeries 
+000428f0: 656c 656d 656e 742e 0a20 2020 2020 2020  element..       
+00042900: 2020 2020 2073 656c 662e 5f77 7269 7465       self._write
+00042910: 5f63 6f6c 6f72 5f73 6572 6965 7328 7370  _color_series(sp
+00042920: 6172 6b6c 696e 655b 2273 6572 6965 735f  arkline["series_
+00042930: 636f 6c6f 7222 5d29 0a0a 2020 2020 2020  color"])..      
+00042940: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
+00042950: 6520 7831 343a 636f 6c6f 724e 6567 6174  e x14:colorNegat
+00042960: 6976 6520 656c 656d 656e 742e 0a20 2020  ive element..   
+00042970: 2020 2020 2020 2020 2073 656c 662e 5f77           self._w
+00042980: 7269 7465 5f63 6f6c 6f72 5f6e 6567 6174  rite_color_negat
+00042990: 6976 6528 7370 6172 6b6c 696e 655b 226e  ive(sparkline["n
+000429a0: 6567 6174 6976 655f 636f 6c6f 7222 5d29  egative_color"])
+000429b0: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+000429c0: 5772 6974 6520 7468 6520 7831 343a 636f  Write the x14:co
+000429d0: 6c6f 7241 7869 7320 656c 656d 656e 742e  lorAxis element.
+000429e0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000429f0: 662e 5f77 7269 7465 5f63 6f6c 6f72 5f61  f._write_color_a
+00042a00: 7869 7328 290a 0a20 2020 2020 2020 2020  xis()..         
+00042a10: 2020 2023 2057 7269 7465 2074 6865 2078     # Write the x
+00042a20: 3134 3a63 6f6c 6f72 4d61 726b 6572 7320  14:colorMarkers 
+00042a30: 656c 656d 656e 742e 0a20 2020 2020 2020  element..       
+00042a40: 2020 2020 2073 656c 662e 5f77 7269 7465       self._write
+00042a50: 5f63 6f6c 6f72 5f6d 6172 6b65 7273 2873  _color_markers(s
+00042a60: 7061 726b 6c69 6e65 5b22 6d61 726b 6572  parkline["marker
+00042a70: 735f 636f 6c6f 7222 5d29 0a0a 2020 2020  s_color"])..    
+00042a80: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
+00042a90: 7468 6520 7831 343a 636f 6c6f 7246 6972  the x14:colorFir
+00042aa0: 7374 2065 6c65 6d65 6e74 2e0a 2020 2020  st element..    
+00042ab0: 2020 2020 2020 2020 7365 6c66 2e5f 7772          self._wr
+00042ac0: 6974 655f 636f 6c6f 725f 6669 7273 7428  ite_color_first(
+00042ad0: 7370 6172 6b6c 696e 655b 2266 6972 7374  sparkline["first
+00042ae0: 5f63 6f6c 6f72 225d 290a 0a20 2020 2020  _color"])..     
+00042af0: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
+00042b00: 6865 2078 3134 3a63 6f6c 6f72 4c61 7374  he x14:colorLast
+00042b10: 2065 6c65 6d65 6e74 2e0a 2020 2020 2020   element..      
+00042b20: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
+00042b30: 655f 636f 6c6f 725f 6c61 7374 2873 7061  e_color_last(spa
+00042b40: 726b 6c69 6e65 5b22 6c61 7374 5f63 6f6c  rkline["last_col
+00042b50: 6f72 225d 290a 0a20 2020 2020 2020 2020  or"])..         
+00042b60: 2020 2023 2057 7269 7465 2074 6865 2078     # Write the x
+00042b70: 3134 3a63 6f6c 6f72 4869 6768 2065 6c65  14:colorHigh ele
+00042b80: 6d65 6e74 2e0a 2020 2020 2020 2020 2020  ment..          
+00042b90: 2020 7365 6c66 2e5f 7772 6974 655f 636f    self._write_co
+00042ba0: 6c6f 725f 6869 6768 2873 7061 726b 6c69  lor_high(sparkli
+00042bb0: 6e65 5b22 6869 6768 5f63 6f6c 6f72 225d  ne["high_color"]
+00042bc0: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
+00042bd0: 2057 7269 7465 2074 6865 2078 3134 3a63   Write the x14:c
+00042be0: 6f6c 6f72 4c6f 7720 656c 656d 656e 742e  olorLow element.
+00042bf0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00042c00: 662e 5f77 7269 7465 5f63 6f6c 6f72 5f6c  f._write_color_l
+00042c10: 6f77 2873 7061 726b 6c69 6e65 5b22 6c6f  ow(sparkline["lo
+00042c20: 775f 636f 6c6f 7222 5d29 0a0a 2020 2020  w_color"])..    
+00042c30: 2020 2020 2020 2020 6966 2073 7061 726b          if spark
+00042c40: 6c69 6e65 5b22 6461 7465 5f61 7869 7322  line["date_axis"
+00042c50: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
+00042c60: 2020 2073 656c 662e 5f78 6d6c 5f64 6174     self._xml_dat
+00042c70: 615f 656c 656d 656e 7428 2278 6d3a 6622  a_element("xm:f"
+00042c80: 2c20 7370 6172 6b6c 696e 655b 2264 6174  , sparkline["dat
+00042c90: 655f 6178 6973 225d 290a 0a20 2020 2020  e_axis"])..     
+00042ca0: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
+00042cb0: 7465 5f73 7061 726b 6c69 6e65 7328 7370  te_sparklines(sp
+00042cc0: 6172 6b6c 696e 6529 0a0a 2020 2020 2020  arkline)..      
+00042cd0: 2020 2020 2020 7365 6c66 2e5f 786d 6c5f        self._xml_
+00042ce0: 656e 645f 7461 6728 2278 3134 3a73 7061  end_tag("x14:spa
+00042cf0: 726b 6c69 6e65 4772 6f75 7022 290a 0a20  rklineGroup").. 
+00042d00: 2020 2020 2020 2073 656c 662e 5f78 6d6c         self._xml
+00042d10: 5f65 6e64 5f74 6167 2822 7831 343a 7370  _end_tag("x14:sp
+00042d20: 6172 6b6c 696e 6547 726f 7570 7322 290a  arklineGroups").
+00042d30: 2020 2020 2020 2020 7365 6c66 2e5f 786d          self._xm
+00042d40: 6c5f 656e 645f 7461 6728 2265 7874 2229  l_end_tag("ext")
+00042d50: 0a0a 2020 2020 6465 6620 5f77 7269 7465  ..    def _write
+00042d60: 5f73 7061 726b 6c69 6e65 7328 7365 6c66  _sparklines(self
+00042d70: 2c20 7370 6172 6b6c 696e 6529 3a0a 2020  , sparkline):.  
+00042d80: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
+00042d90: 6520 3c78 3134 3a73 7061 726b 6c69 6e65  e <x14:sparkline
+00042da0: 733e 2065 6c65 6d65 6e74 2061 6e64 203c  s> element and <
+00042db0: 7831 343a 7370 6172 6b6c 696e 653e 2073  x14:sparkline> s
+00042dc0: 7562 2d65 6c65 6d65 6e74 732e 0a0a 2020  ub-elements...  
+00042dd0: 2020 2020 2020 2320 5772 6974 6520 7468        # Write th
+00042de0: 6520 7370 6172 6b6c 696e 6520 656c 656d  e sparkline elem
+00042df0: 656e 7473 2e0a 2020 2020 2020 2020 7365  ents..        se
+00042e00: 6c66 2e5f 786d 6c5f 7374 6172 745f 7461  lf._xml_start_ta
+00042e10: 6728 2278 3134 3a73 7061 726b 6c69 6e65  g("x14:sparkline
+00042e20: 7322 290a 0a20 2020 2020 2020 2066 6f72  s")..        for
+00042e30: 2069 2069 6e20 7261 6e67 6528 7370 6172   i in range(spar
+00042e40: 6b6c 696e 655b 2263 6f75 6e74 225d 293a  kline["count"]):
+00042e50: 0a20 2020 2020 2020 2020 2020 2073 7061  .            spa
+00042e60: 726b 5f72 616e 6765 203d 2073 7061 726b  rk_range = spark
+00042e70: 6c69 6e65 5b22 7261 6e67 6573 225d 5b69  line["ranges"][i
+00042e80: 5d0a 2020 2020 2020 2020 2020 2020 6c6f  ].            lo
+00042e90: 6361 7469 6f6e 203d 2073 7061 726b 6c69  cation = sparkli
+00042ea0: 6e65 5b22 6c6f 6361 7469 6f6e 7322 5d5b  ne["locations"][
+00042eb0: 695d 0a0a 2020 2020 2020 2020 2020 2020  i]..            
+00042ec0: 7365 6c66 2e5f 786d 6c5f 7374 6172 745f  self._xml_start_
+00042ed0: 7461 6728 2278 3134 3a73 7061 726b 6c69  tag("x14:sparkli
+00042ee0: 6e65 2229 0a20 2020 2020 2020 2020 2020  ne").           
+00042ef0: 2073 656c 662e 5f78 6d6c 5f64 6174 615f   self._xml_data_
+00042f00: 656c 656d 656e 7428 2278 6d3a 6622 2c20  element("xm:f", 
+00042f10: 7370 6172 6b5f 7261 6e67 6529 0a20 2020  spark_range).   
+00042f20: 2020 2020 2020 2020 2073 656c 662e 5f78           self._x
+00042f30: 6d6c 5f64 6174 615f 656c 656d 656e 7428  ml_data_element(
+00042f40: 2278 6d3a 7371 7265 6622 2c20 6c6f 6361  "xm:sqref", loca
+00042f50: 7469 6f6e 290a 2020 2020 2020 2020 2020  tion).          
+00042f60: 2020 7365 6c66 2e5f 786d 6c5f 656e 645f    self._xml_end_
+00042f70: 7461 6728 2278 3134 3a73 7061 726b 6c69  tag("x14:sparkli
+00042f80: 6e65 2229 0a0a 2020 2020 2020 2020 7365  ne")..        se
+00042f90: 6c66 2e5f 786d 6c5f 656e 645f 7461 6728  lf._xml_end_tag(
+00042fa0: 2278 3134 3a73 7061 726b 6c69 6e65 7322  "x14:sparklines"
+00042fb0: 290a 0a20 2020 2064 6566 205f 7772 6974  )..    def _writ
+00042fc0: 655f 6578 7428 7365 6c66 2c20 7572 6929  e_ext(self, uri)
+00042fd0: 3a0a 2020 2020 2020 2020 2320 5772 6974  :.        # Writ
+00042fe0: 6520 7468 6520 3c65 7874 3e20 656c 656d  e the <ext> elem
+00042ff0: 656e 742e 0a20 2020 2020 2020 2073 6368  ent..        sch
+00043000: 656d 6120 3d20 2268 7474 703a 2f2f 7363  ema = "http://sc
+00043010: 6865 6d61 732e 6d69 6372 6f73 6f66 742e  hemas.microsoft.
+00043020: 636f 6d2f 6f66 6669 6365 2f22 0a20 2020  com/office/".   
+00043030: 2020 2020 2078 6d6c 6e73 5f78 3134 203d       xmlns_x14 =
+00043040: 2073 6368 656d 6120 2b20 2273 7072 6561   schema + "sprea
+00043050: 6473 6865 6574 6d6c 2f32 3030 392f 392f  dsheetml/2009/9/
+00043060: 6d61 696e 220a 0a20 2020 2020 2020 2061  main"..        a
+00043070: 7474 7269 6275 7465 7320 3d20 5b0a 2020  ttributes = [.  
+00043080: 2020 2020 2020 2020 2020 2822 786d 6c6e            ("xmln
+00043090: 733a 7831 3422 2c20 786d 6c6e 735f 7831  s:x14", xmlns_x1
+000430a0: 3429 2c0a 2020 2020 2020 2020 2020 2020  4),.            
+000430b0: 2822 7572 6922 2c20 7572 6929 2c0a 2020  ("uri", uri),.  
+000430c0: 2020 2020 2020 5d0a 0a20 2020 2020 2020        ]..       
+000430d0: 2073 656c 662e 5f78 6d6c 5f73 7461 7274   self._xml_start
+000430e0: 5f74 6167 2822 6578 7422 2c20 6174 7472  _tag("ext", attr
+000430f0: 6962 7574 6573 290a 0a20 2020 2064 6566  ibutes)..    def
+00043100: 205f 7772 6974 655f 7370 6172 6b6c 696e   _write_sparklin
+00043110: 655f 6772 6f75 7073 2873 656c 6629 3a0a  e_groups(self):.
+00043120: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
+00043130: 7468 6520 3c78 3134 3a73 7061 726b 6c69  the <x14:sparkli
+00043140: 6e65 4772 6f75 7073 3e20 656c 656d 656e  neGroups> elemen
+00043150: 742e 0a20 2020 2020 2020 2078 6d6c 6e73  t..        xmlns
+00043160: 5f78 6d20 3d20 2268 7474 703a 2f2f 7363  _xm = "http://sc
+00043170: 6865 6d61 732e 6d69 6372 6f73 6f66 742e  hemas.microsoft.
+00043180: 636f 6d2f 6f66 6669 6365 2f65 7863 656c  com/office/excel
+00043190: 2f32 3030 362f 6d61 696e 220a 0a20 2020  /2006/main"..   
+000431a0: 2020 2020 2061 7474 7269 6275 7465 7320       attributes 
+000431b0: 3d20 5b28 2278 6d6c 6e73 3a78 6d22 2c20  = [("xmlns:xm", 
+000431c0: 786d 6c6e 735f 786d 295d 0a0a 2020 2020  xmlns_xm)]..    
+000431d0: 2020 2020 7365 6c66 2e5f 786d 6c5f 7374      self._xml_st
+000431e0: 6172 745f 7461 6728 2278 3134 3a73 7061  art_tag("x14:spa
+000431f0: 726b 6c69 6e65 4772 6f75 7073 222c 2061  rklineGroups", a
+00043200: 7474 7269 6275 7465 7329 0a0a 2020 2020  ttributes)..    
+00043210: 6465 6620 5f77 7269 7465 5f73 7061 726b  def _write_spark
+00043220: 6c69 6e65 5f67 726f 7570 2873 656c 662c  line_group(self,
+00043230: 206f 7074 696f 6e73 293a 0a20 2020 2020   options):.     
+00043240: 2020 2023 2057 7269 7465 2074 6865 203c     # Write the <
+00043250: 7831 343a 7370 6172 6b6c 696e 6547 726f  x14:sparklineGro
+00043260: 7570 3e20 656c 656d 656e 742e 0a20 2020  up> element..   
+00043270: 2020 2020 2023 0a20 2020 2020 2020 2023       #.        #
+00043280: 2045 7861 6d70 6c65 2066 6f72 206f 7264   Example for ord
+00043290: 6572 2e0a 2020 2020 2020 2020 230a 2020  er..        #.  
+000432a0: 2020 2020 2020 2320 3c78 3134 3a73 7061        # <x14:spa
+000432b0: 726b 6c69 6e65 4772 6f75 700a 2020 2020  rklineGroup.    
+000432c0: 2020 2020 2320 2020 2020 6d61 6e75 616c      #     manual
+000432d0: 4d61 783d 2230 220a 2020 2020 2020 2020  Max="0".        
+000432e0: 2320 2020 2020 6d61 6e75 616c 4d69 6e3d  #     manualMin=
+000432f0: 2230 220a 2020 2020 2020 2020 2320 2020  "0".        #   
+00043300: 2020 6c69 6e65 5765 6967 6874 3d22 322e    lineWeight="2.
+00043310: 3235 220a 2020 2020 2020 2020 2320 2020  25".        #   
+00043320: 2020 7479 7065 3d22 636f 6c75 6d6e 220a    type="column".
+00043330: 2020 2020 2020 2020 2320 2020 2020 6461          #     da
+00043340: 7465 4178 6973 3d22 3122 0a20 2020 2020  teAxis="1".     
+00043350: 2020 2023 2020 2020 2064 6973 706c 6179     #     display
+00043360: 456d 7074 7943 656c 6c73 4173 3d22 7370  EmptyCellsAs="sp
+00043370: 616e 220a 2020 2020 2020 2020 2320 2020  an".        #   
+00043380: 2020 6d61 726b 6572 733d 2231 220a 2020    markers="1".  
+00043390: 2020 2020 2020 2320 2020 2020 6869 6768        #     high
+000433a0: 3d22 3122 0a20 2020 2020 2020 2023 2020  ="1".        #  
+000433b0: 2020 206c 6f77 3d22 3122 0a20 2020 2020     low="1".     
+000433c0: 2020 2023 2020 2020 2066 6972 7374 3d22     #     first="
+000433d0: 3122 0a20 2020 2020 2020 2023 2020 2020  1".        #    
+000433e0: 206c 6173 743d 2231 220a 2020 2020 2020   last="1".      
+000433f0: 2020 2320 2020 2020 6e65 6761 7469 7665    #     negative
+00043400: 3d22 3122 0a20 2020 2020 2020 2023 2020  ="1".        #  
+00043410: 2020 2064 6973 706c 6179 5841 7869 733d     displayXAxis=
+00043420: 2231 220a 2020 2020 2020 2020 2320 2020  "1".        #   
+00043430: 2020 6469 7370 6c61 7948 6964 6465 6e3d    displayHidden=
+00043440: 2231 220a 2020 2020 2020 2020 2320 2020  "1".        #   
+00043450: 2020 6d69 6e41 7869 7354 7970 653d 2263    minAxisType="c
+00043460: 7573 746f 6d22 0a20 2020 2020 2020 2023  ustom".        #
+00043470: 2020 2020 206d 6178 4178 6973 5479 7065       maxAxisType
+00043480: 3d22 6375 7374 6f6d 220a 2020 2020 2020  ="custom".      
+00043490: 2020 2320 2020 2020 7269 6768 7454 6f4c    #     rightToL
+000434a0: 6566 743d 2231 223e 0a20 2020 2020 2020  eft="1">.       
+000434b0: 2023 0a20 2020 2020 2020 2065 6d70 7479   #.        empty
+000434c0: 203d 206f 7074 696f 6e73 2e67 6574 2822   = options.get("
+000434d0: 656d 7074 7922 290a 2020 2020 2020 2020  empty").        
+000434e0: 6174 7472 6962 7574 6573 203d 205b 5d0a  attributes = [].
+000434f0: 0a20 2020 2020 2020 2069 6620 6f70 7469  .        if opti
+00043500: 6f6e 732e 6765 7428 226d 6178 2229 2069  ons.get("max") i
+00043510: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+00043520: 2020 2020 2020 2020 6966 206f 7074 696f          if optio
+00043530: 6e73 5b22 6d61 7822 5d20 3d3d 2022 6772  ns["max"] == "gr
+00043540: 6f75 7022 3a0a 2020 2020 2020 2020 2020  oup":.          
+00043550: 2020 2020 2020 6f70 7469 6f6e 735b 2263        options["c
+00043560: 7573 745f 6d61 7822 5d20 3d20 2267 726f  ust_max"] = "gro
+00043570: 7570 220a 2020 2020 2020 2020 2020 2020  up".            
+00043580: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00043590: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
+000435a0: 2e61 7070 656e 6428 2822 6d61 6e75 616c  .append(("manual
+000435b0: 4d61 7822 2c20 6f70 7469 6f6e 735b 226d  Max", options["m
+000435c0: 6178 225d 2929 0a20 2020 2020 2020 2020  ax"])).         
+000435d0: 2020 2020 2020 206f 7074 696f 6e73 5b22         options["
+000435e0: 6375 7374 5f6d 6178 225d 203d 2022 6375  cust_max"] = "cu
+000435f0: 7374 6f6d 220a 0a20 2020 2020 2020 2069  stom"..        i
+00043600: 6620 6f70 7469 6f6e 732e 6765 7428 226d  f options.get("m
+00043610: 696e 2229 2069 7320 6e6f 7420 4e6f 6e65  in") is not None
+00043620: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00043630: 206f 7074 696f 6e73 5b22 6d69 6e22 5d20   options["min"] 
+00043640: 3d3d 2022 6772 6f75 7022 3a0a 2020 2020  == "group":.    
+00043650: 2020 2020 2020 2020 2020 2020 6f70 7469              opti
+00043660: 6f6e 735b 2263 7573 745f 6d69 6e22 5d20  ons["cust_min"] 
+00043670: 3d20 2267 726f 7570 220a 2020 2020 2020  = "group".      
+00043680: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00043690: 2020 2020 2020 2020 2020 2020 6174 7472              attr
+000436a0: 6962 7574 6573 2e61 7070 656e 6428 2822  ibutes.append(("
+000436b0: 6d61 6e75 616c 4d69 6e22 2c20 6f70 7469  manualMin", opti
+000436c0: 6f6e 735b 226d 696e 225d 2929 0a20 2020  ons["min"])).   
+000436d0: 2020 2020 2020 2020 2020 2020 206f 7074               opt
+000436e0: 696f 6e73 5b22 6375 7374 5f6d 696e 225d  ions["cust_min"]
+000436f0: 203d 2022 6375 7374 6f6d 220a 0a20 2020   = "custom"..   
+00043700: 2020 2020 2023 2049 676e 6f72 6520 7468       # Ignore th
+00043710: 6520 6465 6661 756c 7420 7479 7065 2061  e default type a
+00043720: 7474 7269 6275 7465 2028 6c69 6e65 292e  ttribute (line).
+00043730: 0a20 2020 2020 2020 2069 6620 6f70 7469  .        if opti
+00043740: 6f6e 735b 2274 7970 6522 5d20 213d 2022  ons["type"] != "
+00043750: 6c69 6e65 223a 0a20 2020 2020 2020 2020  line":.         
+00043760: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
+00043770: 7065 6e64 2828 2274 7970 6522 2c20 6f70  pend(("type", op
+00043780: 7469 6f6e 735b 2274 7970 6522 5d29 290a  tions["type"])).
+00043790: 0a20 2020 2020 2020 2069 6620 6f70 7469  .        if opti
+000437a0: 6f6e 732e 6765 7428 2277 6569 6768 7422  ons.get("weight"
+000437b0: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
+000437c0: 7474 7269 6275 7465 732e 6170 7065 6e64  ttributes.append
+000437d0: 2828 226c 696e 6557 6569 6768 7422 2c20  (("lineWeight", 
+000437e0: 6f70 7469 6f6e 735b 2277 6569 6768 7422  options["weight"
+000437f0: 5d29 290a 0a20 2020 2020 2020 2069 6620  ]))..        if 
+00043800: 6f70 7469 6f6e 732e 6765 7428 2264 6174  options.get("dat
+00043810: 655f 6178 6973 2229 3a0a 2020 2020 2020  e_axis"):.      
+00043820: 2020 2020 2020 6174 7472 6962 7574 6573        attributes
+00043830: 2e61 7070 656e 6428 2822 6461 7465 4178  .append(("dateAx
+00043840: 6973 222c 2031 2929 0a0a 2020 2020 2020  is", 1))..      
+00043850: 2020 6966 2065 6d70 7479 3a0a 2020 2020    if empty:.    
+00043860: 2020 2020 2020 2020 6174 7472 6962 7574          attribut
+00043870: 6573 2e61 7070 656e 6428 2822 6469 7370  es.append(("disp
+00043880: 6c61 7945 6d70 7479 4365 6c6c 7341 7322  layEmptyCellsAs"
+00043890: 2c20 656d 7074 7929 290a 0a20 2020 2020  , empty))..     
+000438a0: 2020 2069 6620 6f70 7469 6f6e 732e 6765     if options.ge
+000438b0: 7428 226d 6172 6b65 7273 2229 3a0a 2020  t("markers"):.  
+000438c0: 2020 2020 2020 2020 2020 6174 7472 6962            attrib
+000438d0: 7574 6573 2e61 7070 656e 6428 2822 6d61  utes.append(("ma
+000438e0: 726b 6572 7322 2c20 3129 290a 0a20 2020  rkers", 1))..   
+000438f0: 2020 2020 2069 6620 6f70 7469 6f6e 732e       if options.
+00043900: 6765 7428 2268 6967 6822 293a 0a20 2020  get("high"):.   
+00043910: 2020 2020 2020 2020 2061 7474 7269 6275           attribu
+00043920: 7465 732e 6170 7065 6e64 2828 2268 6967  tes.append(("hig
+00043930: 6822 2c20 3129 290a 0a20 2020 2020 2020  h", 1))..       
+00043940: 2069 6620 6f70 7469 6f6e 732e 6765 7428   if options.get(
+00043950: 226c 6f77 2229 3a0a 2020 2020 2020 2020  "low"):.        
+00043960: 2020 2020 6174 7472 6962 7574 6573 2e61      attributes.a
+00043970: 7070 656e 6428 2822 6c6f 7722 2c20 3129  ppend(("low", 1)
+00043980: 290a 0a20 2020 2020 2020 2069 6620 6f70  )..        if op
+00043990: 7469 6f6e 732e 6765 7428 2266 6972 7374  tions.get("first
+000439a0: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+000439b0: 6174 7472 6962 7574 6573 2e61 7070 656e  attributes.appen
+000439c0: 6428 2822 6669 7273 7422 2c20 3129 290a  d(("first", 1)).
+000439d0: 0a20 2020 2020 2020 2069 6620 6f70 7469  .        if opti
+000439e0: 6f6e 732e 6765 7428 226c 6173 7422 293a  ons.get("last"):
+000439f0: 0a20 2020 2020 2020 2020 2020 2061 7474  .            att
+00043a00: 7269 6275 7465 732e 6170 7065 6e64 2828  ributes.append((
+00043a10: 226c 6173 7422 2c20 3129 290a 0a20 2020  "last", 1))..   
+00043a20: 2020 2020 2069 6620 6f70 7469 6f6e 732e       if options.
+00043a30: 6765 7428 226e 6567 6174 6976 6522 293a  get("negative"):
+00043a40: 0a20 2020 2020 2020 2020 2020 2061 7474  .            att
+00043a50: 7269 6275 7465 732e 6170 7065 6e64 2828  ributes.append((
+00043a60: 226e 6567 6174 6976 6522 2c20 3129 290a  "negative", 1)).
+00043a70: 0a20 2020 2020 2020 2069 6620 6f70 7469  .        if opti
+00043a80: 6f6e 732e 6765 7428 2261 7869 7322 293a  ons.get("axis"):
+00043a90: 0a20 2020 2020 2020 2020 2020 2061 7474  .            att
+00043aa0: 7269 6275 7465 732e 6170 7065 6e64 2828  ributes.append((
+00043ab0: 2264 6973 706c 6179 5841 7869 7322 2c20  "displayXAxis", 
+00043ac0: 3129 290a 0a20 2020 2020 2020 2069 6620  1))..        if 
+00043ad0: 6f70 7469 6f6e 732e 6765 7428 2268 6964  options.get("hid
+00043ae0: 6465 6e22 293a 0a20 2020 2020 2020 2020  den"):.         
+00043af0: 2020 2061 7474 7269 6275 7465 732e 6170     attributes.ap
+00043b00: 7065 6e64 2828 2264 6973 706c 6179 4869  pend(("displayHi
+00043b10: 6464 656e 222c 2031 2929 0a0a 2020 2020  dden", 1))..    
+00043b20: 2020 2020 6966 206f 7074 696f 6e73 2e67      if options.g
+00043b30: 6574 2822 6375 7374 5f6d 696e 2229 3a0a  et("cust_min"):.
+00043b40: 2020 2020 2020 2020 2020 2020 6174 7472              attr
+00043b50: 6962 7574 6573 2e61 7070 656e 6428 2822  ibutes.append(("
+00043b60: 6d69 6e41 7869 7354 7970 6522 2c20 6f70  minAxisType", op
+00043b70: 7469 6f6e 735b 2263 7573 745f 6d69 6e22  tions["cust_min"
+00043b80: 5d29 290a 0a20 2020 2020 2020 2069 6620  ]))..        if 
+00043b90: 6f70 7469 6f6e 732e 6765 7428 2263 7573  options.get("cus
+00043ba0: 745f 6d61 7822 293a 0a20 2020 2020 2020  t_max"):.       
+00043bb0: 2020 2020 2061 7474 7269 6275 7465 732e       attributes.
+00043bc0: 6170 7065 6e64 2828 226d 6178 4178 6973  append(("maxAxis
+00043bd0: 5479 7065 222c 206f 7074 696f 6e73 5b22  Type", options["
+00043be0: 6375 7374 5f6d 6178 225d 2929 0a0a 2020  cust_max"]))..  
+00043bf0: 2020 2020 2020 6966 206f 7074 696f 6e73        if options
+00043c00: 2e67 6574 2822 7265 7665 7273 6522 293a  .get("reverse"):
+00043c10: 0a20 2020 2020 2020 2020 2020 2061 7474  .            att
+00043c20: 7269 6275 7465 732e 6170 7065 6e64 2828  ributes.append((
+00043c30: 2272 6967 6874 546f 4c65 6674 222c 2031  "rightToLeft", 1
+00043c40: 2929 0a0a 2020 2020 2020 2020 7365 6c66  ))..        self
+00043c50: 2e5f 786d 6c5f 7374 6172 745f 7461 6728  ._xml_start_tag(
+00043c60: 2278 3134 3a73 7061 726b 6c69 6e65 4772  "x14:sparklineGr
+00043c70: 6f75 7022 2c20 6174 7472 6962 7574 6573  oup", attributes
+00043c80: 290a 0a20 2020 2064 6566 205f 7772 6974  )..    def _writ
+00043c90: 655f 7370 6172 6b5f 636f 6c6f 7228 7365  e_spark_color(se
+00043ca0: 6c66 2c20 656c 656d 656e 742c 2063 6f6c  lf, element, col
+00043cb0: 6f72 293a 0a20 2020 2020 2020 2023 2048  or):.        # H
+00043cc0: 656c 7065 7220 6675 6e63 7469 6f6e 2066  elper function f
+00043cd0: 6f72 2074 6865 2073 7061 726b 6c69 6e65  or the sparkline
+00043ce0: 2063 6f6c 6f72 2066 756e 6374 696f 6e73   color functions
+00043cf0: 2062 656c 6f77 2e0a 2020 2020 2020 2020   below..        
+00043d00: 6174 7472 6962 7574 6573 203d 205b 5d0a  attributes = [].
+00043d10: 0a20 2020 2020 2020 2069 6620 636f 6c6f  .        if colo
+00043d20: 722e 6765 7428 2272 6762 2229 3a0a 2020  r.get("rgb"):.  
+00043d30: 2020 2020 2020 2020 2020 6174 7472 6962            attrib
+00043d40: 7574 6573 2e61 7070 656e 6428 2822 7267  utes.append(("rg
+00043d50: 6222 2c20 636f 6c6f 725b 2272 6762 225d  b", color["rgb"]
+00043d60: 2929 0a0a 2020 2020 2020 2020 6966 2063  ))..        if c
+00043d70: 6f6c 6f72 2e67 6574 2822 7468 656d 6522  olor.get("theme"
+00043d80: 293a 0a20 2020 2020 2020 2020 2020 2061  ):.            a
+00043d90: 7474 7269 6275 7465 732e 6170 7065 6e64  ttributes.append
+00043da0: 2828 2274 6865 6d65 222c 2063 6f6c 6f72  (("theme", color
+00043db0: 5b22 7468 656d 6522 5d29 290a 0a20 2020  ["theme"]))..   
+00043dc0: 2020 2020 2069 6620 636f 6c6f 722e 6765       if color.ge
+00043dd0: 7428 2274 696e 7422 293a 0a20 2020 2020  t("tint"):.     
+00043de0: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
+00043df0: 732e 6170 7065 6e64 2828 2274 696e 7422  s.append(("tint"
+00043e00: 2c20 636f 6c6f 725b 2274 696e 7422 5d29  , color["tint"])
+00043e10: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00043e20: 5f78 6d6c 5f65 6d70 7479 5f74 6167 2865  _xml_empty_tag(e
+00043e30: 6c65 6d65 6e74 2c20 6174 7472 6962 7574  lement, attribut
+00043e40: 6573 290a 0a20 2020 2064 6566 205f 7772  es)..    def _wr
+00043e50: 6974 655f 636f 6c6f 725f 7365 7269 6573  ite_color_series
+00043e60: 2873 656c 662c 2063 6f6c 6f72 293a 0a20  (self, color):. 
+00043e70: 2020 2020 2020 2023 2057 7269 7465 2074         # Write t
+00043e80: 6865 203c 7831 343a 636f 6c6f 7253 6572  he <x14:colorSer
+00043e90: 6965 733e 2065 6c65 6d65 6e74 2e0a 2020  ies> element..  
+00043ea0: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
+00043eb0: 655f 7370 6172 6b5f 636f 6c6f 7228 2278  e_spark_color("x
+00043ec0: 3134 3a63 6f6c 6f72 5365 7269 6573 222c  14:colorSeries",
+00043ed0: 2063 6f6c 6f72 290a 0a20 2020 2064 6566   color)..    def
+00043ee0: 205f 7772 6974 655f 636f 6c6f 725f 6e65   _write_color_ne
+00043ef0: 6761 7469 7665 2873 656c 662c 2063 6f6c  gative(self, col
+00043f00: 6f72 293a 0a20 2020 2020 2020 2023 2057  or):.        # W
+00043f10: 7269 7465 2074 6865 203c 7831 343a 636f  rite the <x14:co
+00043f20: 6c6f 724e 6567 6174 6976 653e 2065 6c65  lorNegative> ele
+00043f30: 6d65 6e74 2e0a 2020 2020 2020 2020 7365  ment..        se
+00043f40: 6c66 2e5f 7772 6974 655f 7370 6172 6b5f  lf._write_spark_
+00043f50: 636f 6c6f 7228 2278 3134 3a63 6f6c 6f72  color("x14:color
+00043f60: 4e65 6761 7469 7665 222c 2063 6f6c 6f72  Negative", color
+00043f70: 290a 0a20 2020 2064 6566 205f 7772 6974  )..    def _writ
+00043f80: 655f 636f 6c6f 725f 6178 6973 2873 656c  e_color_axis(sel
+00043f90: 6629 3a0a 2020 2020 2020 2020 2320 5772  f):.        # Wr
+00043fa0: 6974 6520 7468 6520 3c78 3134 3a63 6f6c  ite the <x14:col
+00043fb0: 6f72 4178 6973 3e20 656c 656d 656e 742e  orAxis> element.
+00043fc0: 0a20 2020 2020 2020 2073 656c 662e 5f77  .        self._w
+00043fd0: 7269 7465 5f73 7061 726b 5f63 6f6c 6f72  rite_spark_color
+00043fe0: 2822 7831 343a 636f 6c6f 7241 7869 7322  ("x14:colorAxis"
+00043ff0: 2c20 7b22 7267 6222 3a20 2246 4630 3030  , {"rgb": "FF000
+00044000: 3030 3022 7d29 0a0a 2020 2020 6465 6620  000"})..    def 
+00044010: 5f77 7269 7465 5f63 6f6c 6f72 5f6d 6172  _write_color_mar
+00044020: 6b65 7273 2873 656c 662c 2063 6f6c 6f72  kers(self, color
+00044030: 293a 0a20 2020 2020 2020 2023 2057 7269  ):.        # Wri
+00044040: 7465 2074 6865 203c 7831 343a 636f 6c6f  te the <x14:colo
+00044050: 724d 6172 6b65 7273 3e20 656c 656d 656e  rMarkers> elemen
+00044060: 742e 0a20 2020 2020 2020 2073 656c 662e  t..        self.
+00044070: 5f77 7269 7465 5f73 7061 726b 5f63 6f6c  _write_spark_col
+00044080: 6f72 2822 7831 343a 636f 6c6f 724d 6172  or("x14:colorMar
+00044090: 6b65 7273 222c 2063 6f6c 6f72 290a 0a20  kers", color).. 
+000440a0: 2020 2064 6566 205f 7772 6974 655f 636f     def _write_co
+000440b0: 6c6f 725f 6669 7273 7428 7365 6c66 2c20  lor_first(self, 
+000440c0: 636f 6c6f 7229 3a0a 2020 2020 2020 2020  color):.        
+000440d0: 2320 5772 6974 6520 7468 6520 3c78 3134  # Write the <x14
+000440e0: 3a63 6f6c 6f72 4669 7273 743e 2065 6c65  :colorFirst> ele
+000440f0: 6d65 6e74 2e0a 2020 2020 2020 2020 7365  ment..        se
+00044100: 6c66 2e5f 7772 6974 655f 7370 6172 6b5f  lf._write_spark_
+00044110: 636f 6c6f 7228 2278 3134 3a63 6f6c 6f72  color("x14:color
+00044120: 4669 7273 7422 2c20 636f 6c6f 7229 0a0a  First", color)..
+00044130: 2020 2020 6465 6620 5f77 7269 7465 5f63      def _write_c
+00044140: 6f6c 6f72 5f6c 6173 7428 7365 6c66 2c20  olor_last(self, 
+00044150: 636f 6c6f 7229 3a0a 2020 2020 2020 2020  color):.        
+00044160: 2320 5772 6974 6520 7468 6520 3c78 3134  # Write the <x14
+00044170: 3a63 6f6c 6f72 4c61 7374 3e20 656c 656d  :colorLast> elem
+00044180: 656e 742e 0a20 2020 2020 2020 2073 656c  ent..        sel
+00044190: 662e 5f77 7269 7465 5f73 7061 726b 5f63  f._write_spark_c
+000441a0: 6f6c 6f72 2822 7831 343a 636f 6c6f 724c  olor("x14:colorL
+000441b0: 6173 7422 2c20 636f 6c6f 7229 0a0a 2020  ast", color)..  
+000441c0: 2020 6465 6620 5f77 7269 7465 5f63 6f6c    def _write_col
+000441d0: 6f72 5f68 6967 6828 7365 6c66 2c20 636f  or_high(self, co
+000441e0: 6c6f 7229 3a0a 2020 2020 2020 2020 2320  lor):.        # 
+000441f0: 5772 6974 6520 7468 6520 3c78 3134 3a63  Write the <x14:c
+00044200: 6f6c 6f72 4869 6768 3e20 656c 656d 656e  olorHigh> elemen
+00044210: 742e 0a20 2020 2020 2020 2073 656c 662e  t..        self.
+00044220: 5f77 7269 7465 5f73 7061 726b 5f63 6f6c  _write_spark_col
+00044230: 6f72 2822 7831 343a 636f 6c6f 7248 6967  or("x14:colorHig
+00044240: 6822 2c20 636f 6c6f 7229 0a0a 2020 2020  h", color)..    
+00044250: 6465 6620 5f77 7269 7465 5f63 6f6c 6f72  def _write_color
+00044260: 5f6c 6f77 2873 656c 662c 2063 6f6c 6f72  _low(self, color
+00044270: 293a 0a20 2020 2020 2020 2023 2057 7269  ):.        # Wri
+00044280: 7465 2074 6865 203c 7831 343a 636f 6c6f  te the <x14:colo
+00044290: 724c 6f77 3e20 656c 656d 656e 742e 0a20  rLow> element.. 
+000442a0: 2020 2020 2020 2073 656c 662e 5f77 7269         self._wri
+000442b0: 7465 5f73 7061 726b 5f63 6f6c 6f72 2822  te_spark_color("
+000442c0: 7831 343a 636f 6c6f 724c 6f77 222c 2063  x14:colorLow", c
+000442d0: 6f6c 6f72 290a 0a20 2020 2064 6566 205f  olor)..    def _
+000442e0: 7772 6974 655f 7068 6f6e 6574 6963 5f70  write_phonetic_p
+000442f0: 7228 7365 6c66 293a 0a20 2020 2020 2020  r(self):.       
+00044300: 2023 2057 7269 7465 2074 6865 203c 7068   # Write the <ph
+00044310: 6f6e 6574 6963 5072 3e20 656c 656d 656e  oneticPr> elemen
+00044320: 742e 0a20 2020 2020 2020 2061 7474 7269  t..        attri
+00044330: 6275 7465 7320 3d20 5b0a 2020 2020 2020  butes = [.      
+00044340: 2020 2020 2020 2822 666f 6e74 4964 222c        ("fontId",
+00044350: 2022 3022 292c 0a20 2020 2020 2020 2020   "0"),.         
+00044360: 2020 2028 2274 7970 6522 2c20 226e 6f43     ("type", "noC
+00044370: 6f6e 7665 7273 696f 6e22 292c 0a20 2020  onversion"),.   
+00044380: 2020 2020 205d 0a0a 2020 2020 2020 2020       ]..        
+00044390: 7365 6c66 2e5f 786d 6c5f 656d 7074 795f  self._xml_empty_
+000443a0: 7461 6728 2270 686f 6e65 7469 6350 7222  tag("phoneticPr"
+000443b0: 2c20 6174 7472 6962 7574 6573 290a 0a20  , attributes).. 
+000443c0: 2020 2064 6566 205f 7772 6974 655f 6967     def _write_ig
+000443d0: 6e6f 7265 645f 6572 726f 7273 2873 656c  nored_errors(sel
+000443e0: 6629 3a0a 2020 2020 2020 2020 2320 5772  f):.        # Wr
+000443f0: 6974 6520 7468 6520 3c69 676e 6f72 6564  ite the <ignored
+00044400: 4572 726f 7273 3e20 656c 656d 656e 742e  Errors> element.
+00044410: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+00044420: 7365 6c66 2e69 676e 6f72 6564 5f65 7272  self.ignored_err
+00044430: 6f72 733a 0a20 2020 2020 2020 2020 2020  ors:.           
+00044440: 2072 6574 7572 6e0a 0a20 2020 2020 2020   return..       
+00044450: 2073 656c 662e 5f78 6d6c 5f73 7461 7274   self._xml_start
+00044460: 5f74 6167 2822 6967 6e6f 7265 6445 7272  _tag("ignoredErr
+00044470: 6f72 7322 290a 0a20 2020 2020 2020 2069  ors")..        i
+00044480: 6620 7365 6c66 2e69 676e 6f72 6564 5f65  f self.ignored_e
+00044490: 7272 6f72 732e 6765 7428 226e 756d 6265  rrors.get("numbe
+000444a0: 725f 7374 6f72 6564 5f61 735f 7465 7874  r_stored_as_text
+000444b0: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+000444c0: 7261 6e67 6520 3d20 7365 6c66 2e69 676e  range = self.ign
+000444d0: 6f72 6564 5f65 7272 6f72 735b 226e 756d  ored_errors["num
+000444e0: 6265 725f 7374 6f72 6564 5f61 735f 7465  ber_stored_as_te
+000444f0: 7874 225d 0a20 2020 2020 2020 2020 2020  xt"].           
+00044500: 2073 656c 662e 5f77 7269 7465 5f69 676e   self._write_ign
+00044510: 6f72 6564 5f65 7272 6f72 2822 6e75 6d62  ored_error("numb
+00044520: 6572 5374 6f72 6564 4173 5465 7874 222c  erStoredAsText",
+00044530: 2072 616e 6765 290a 0a20 2020 2020 2020   range)..       
+00044540: 2069 6620 7365 6c66 2e69 676e 6f72 6564   if self.ignored
+00044550: 5f65 7272 6f72 732e 6765 7428 2265 7661  _errors.get("eva
+00044560: 6c5f 6572 726f 7222 293a 0a20 2020 2020  l_error"):.     
+00044570: 2020 2020 2020 2072 616e 6765 203d 2073         range = s
+00044580: 656c 662e 6967 6e6f 7265 645f 6572 726f  elf.ignored_erro
+00044590: 7273 5b22 6576 616c 5f65 7272 6f72 225d  rs["eval_error"]
+000445a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000445b0: 662e 5f77 7269 7465 5f69 676e 6f72 6564  f._write_ignored
+000445c0: 5f65 7272 6f72 2822 6576 616c 4572 726f  _error("evalErro
+000445d0: 7222 2c20 7261 6e67 6529 0a0a 2020 2020  r", range)..    
+000445e0: 2020 2020 6966 2073 656c 662e 6967 6e6f      if self.igno
+000445f0: 7265 645f 6572 726f 7273 2e67 6574 2822  red_errors.get("
+00044600: 666f 726d 756c 615f 6469 6666 6572 7322  formula_differs"
+00044610: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00044620: 616e 6765 203d 2073 656c 662e 6967 6e6f  ange = self.igno
+00044630: 7265 645f 6572 726f 7273 5b22 666f 726d  red_errors["form
+00044640: 756c 615f 6469 6666 6572 7322 5d0a 2020  ula_differs"].  
+00044650: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00044660: 7772 6974 655f 6967 6e6f 7265 645f 6572  write_ignored_er
+00044670: 726f 7228 2266 6f72 6d75 6c61 222c 2072  ror("formula", r
+00044680: 616e 6765 290a 0a20 2020 2020 2020 2069  ange)..        i
+00044690: 6620 7365 6c66 2e69 676e 6f72 6564 5f65  f self.ignored_e
+000446a0: 7272 6f72 732e 6765 7428 2266 6f72 6d75  rrors.get("formu
+000446b0: 6c61 5f72 616e 6765 2229 3a0a 2020 2020  la_range"):.    
+000446c0: 2020 2020 2020 2020 7261 6e67 6520 3d20          range = 
+000446d0: 7365 6c66 2e69 676e 6f72 6564 5f65 7272  self.ignored_err
+000446e0: 6f72 735b 2266 6f72 6d75 6c61 5f72 616e  ors["formula_ran
+000446f0: 6765 225d 0a20 2020 2020 2020 2020 2020  ge"].           
+00044700: 2073 656c 662e 5f77 7269 7465 5f69 676e   self._write_ign
+00044710: 6f72 6564 5f65 7272 6f72 2822 666f 726d  ored_error("form
+00044720: 756c 6152 616e 6765 222c 2072 616e 6765  ulaRange", range
+00044730: 290a 0a20 2020 2020 2020 2069 6620 7365  )..        if se
+00044740: 6c66 2e69 676e 6f72 6564 5f65 7272 6f72  lf.ignored_error
+00044750: 732e 6765 7428 2266 6f72 6d75 6c61 5f75  s.get("formula_u
+00044760: 6e6c 6f63 6b65 6422 293a 0a20 2020 2020  nlocked"):.     
+00044770: 2020 2020 2020 2072 616e 6765 203d 2073         range = s
+00044780: 656c 662e 6967 6e6f 7265 645f 6572 726f  elf.ignored_erro
+00044790: 7273 5b22 666f 726d 756c 615f 756e 6c6f  rs["formula_unlo
+000447a0: 636b 6564 225d 0a20 2020 2020 2020 2020  cked"].         
+000447b0: 2020 2073 656c 662e 5f77 7269 7465 5f69     self._write_i
+000447c0: 676e 6f72 6564 5f65 7272 6f72 2822 756e  gnored_error("un
+000447d0: 6c6f 636b 6564 466f 726d 756c 6122 2c20  lockedFormula", 
+000447e0: 7261 6e67 6529 0a0a 2020 2020 2020 2020  range)..        
+000447f0: 6966 2073 656c 662e 6967 6e6f 7265 645f  if self.ignored_
+00044800: 6572 726f 7273 2e67 6574 2822 656d 7074  errors.get("empt
+00044810: 795f 6365 6c6c 5f72 6566 6572 656e 6365  y_cell_reference
+00044820: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+00044830: 7261 6e67 6520 3d20 7365 6c66 2e69 676e  range = self.ign
+00044840: 6f72 6564 5f65 7272 6f72 735b 2265 6d70  ored_errors["emp
+00044850: 7479 5f63 656c 6c5f 7265 6665 7265 6e63  ty_cell_referenc
+00044860: 6522 5d0a 2020 2020 2020 2020 2020 2020  e"].            
+00044870: 7365 6c66 2e5f 7772 6974 655f 6967 6e6f  self._write_igno
+00044880: 7265 645f 6572 726f 7228 2265 6d70 7479  red_error("empty
+00044890: 4365 6c6c 5265 6665 7265 6e63 6522 2c20  CellReference", 
+000448a0: 7261 6e67 6529 0a0a 2020 2020 2020 2020  range)..        
+000448b0: 6966 2073 656c 662e 6967 6e6f 7265 645f  if self.ignored_
+000448c0: 6572 726f 7273 2e67 6574 2822 6c69 7374  errors.get("list
+000448d0: 5f64 6174 615f 7661 6c69 6461 7469 6f6e  _data_validation
+000448e0: 2229 3a0a 2020 2020 2020 2020 2020 2020  "):.            
+000448f0: 7261 6e67 6520 3d20 7365 6c66 2e69 676e  range = self.ign
+00044900: 6f72 6564 5f65 7272 6f72 735b 226c 6973  ored_errors["lis
+00044910: 745f 6461 7461 5f76 616c 6964 6174 696f  t_data_validatio
+00044920: 6e22 5d0a 2020 2020 2020 2020 2020 2020  n"].            
+00044930: 7365 6c66 2e5f 7772 6974 655f 6967 6e6f  self._write_igno
+00044940: 7265 645f 6572 726f 7228 226c 6973 7444  red_error("listD
+00044950: 6174 6156 616c 6964 6174 696f 6e22 2c20  ataValidation", 
+00044960: 7261 6e67 6529 0a0a 2020 2020 2020 2020  range)..        
+00044970: 6966 2073 656c 662e 6967 6e6f 7265 645f  if self.ignored_
+00044980: 6572 726f 7273 2e67 6574 2822 6361 6c63  errors.get("calc
+00044990: 756c 6174 6564 5f63 6f6c 756d 6e22 293a  ulated_column"):
+000449a0: 0a20 2020 2020 2020 2020 2020 2072 616e  .            ran
+000449b0: 6765 203d 2073 656c 662e 6967 6e6f 7265  ge = self.ignore
+000449c0: 645f 6572 726f 7273 5b22 6361 6c63 756c  d_errors["calcul
+000449d0: 6174 6564 5f63 6f6c 756d 6e22 5d0a 2020  ated_column"].  
+000449e0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+000449f0: 7772 6974 655f 6967 6e6f 7265 645f 6572  write_ignored_er
+00044a00: 726f 7228 2263 616c 6375 6c61 7465 6443  ror("calculatedC
+00044a10: 6f6c 756d 6e22 2c20 7261 6e67 6529 0a0a  olumn", range)..
+00044a20: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00044a30: 6967 6e6f 7265 645f 6572 726f 7273 2e67  ignored_errors.g
+00044a40: 6574 2822 7477 6f5f 6469 6769 745f 7465  et("two_digit_te
+00044a50: 7874 5f79 6561 7222 293a 0a20 2020 2020  xt_year"):.     
+00044a60: 2020 2020 2020 2072 616e 6765 203d 2073         range = s
+00044a70: 656c 662e 6967 6e6f 7265 645f 6572 726f  elf.ignored_erro
+00044a80: 7273 5b22 7477 6f5f 6469 6769 745f 7465  rs["two_digit_te
+00044a90: 7874 5f79 6561 7222 5d0a 2020 2020 2020  xt_year"].      
+00044aa0: 2020 2020 2020 7365 6c66 2e5f 7772 6974        self._writ
+00044ab0: 655f 6967 6e6f 7265 645f 6572 726f 7228  e_ignored_error(
+00044ac0: 2274 776f 4469 6769 7454 6578 7459 6561  "twoDigitTextYea
+00044ad0: 7222 2c20 7261 6e67 6529 0a0a 2020 2020  r", range)..    
+00044ae0: 2020 2020 7365 6c66 2e5f 786d 6c5f 656e      self._xml_en
+00044af0: 645f 7461 6728 2269 676e 6f72 6564 4572  d_tag("ignoredEr
+00044b00: 726f 7273 2229 0a0a 2020 2020 6465 6620  rors")..    def 
+00044b10: 5f77 7269 7465 5f69 676e 6f72 6564 5f65  _write_ignored_e
+00044b20: 7272 6f72 2873 656c 662c 2074 7970 652c  rror(self, type,
+00044b30: 2072 616e 6765 293a 0a20 2020 2020 2020   range):.       
+00044b40: 2023 2057 7269 7465 2074 6865 203c 6967   # Write the <ig
+00044b50: 6e6f 7265 6445 7272 6f72 3e20 656c 656d  noredError> elem
+00044b60: 656e 742e 0a20 2020 2020 2020 2061 7474  ent..        att
+00044b70: 7269 6275 7465 7320 3d20 5b0a 2020 2020  ributes = [.    
+00044b80: 2020 2020 2020 2020 2822 7371 7265 6622          ("sqref"
+00044b90: 2c20 7261 6e67 6529 2c0a 2020 2020 2020  , range),.      
+00044ba0: 2020 2020 2020 2874 7970 652c 2031 292c        (type, 1),
+00044bb0: 0a20 2020 2020 2020 205d 0a0a 2020 2020  .        ]..    
+00044bc0: 2020 2020 7365 6c66 2e5f 786d 6c5f 656d      self._xml_em
+00044bd0: 7074 795f 7461 6728 2269 676e 6f72 6564  pty_tag("ignored
+00044be0: 4572 726f 7222 2c20 6174 7472 6962 7574  Error", attribut
+00044bf0: 6573 290a                                es).
```

### Comparing `XlsxWriter-3.0.9/xlsxwriter/xmlwriter.py` & `XlsxWriter-3.1.0/xlsxwriter/xmlwriter.py`

 * *Files 11% similar despite different names*

```diff
@@ -32,25 +32,24 @@
     def _set_xml_writer(self, filename):
         # Set the XML writer filehandle for the object.
         if isinstance(filename, StringIO):
             self.internal_fh = False
             self.fh = filename
         else:
             self.internal_fh = True
-            self.fh = open(filename, 'w', encoding='utf-8')
+            self.fh = open(filename, "w", encoding="utf-8")
 
     def _xml_close(self):
         # Close the XML filehandle if we created it.
         if self.internal_fh:
             self.fh.close()
 
     def _xml_declaration(self):
         # Write the XML declaration.
-        self.fh.write(
-            """<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n""")
+        self.fh.write("""<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\n""")
 
     def _xml_start_tag(self, tag, attributes=[]):
         # Write an XML start tag with optional attributes.
         for key, value in attributes:
             value = self._escape_attributes(value)
             tag += ' %s="%s"' % (key, value)
 
@@ -95,25 +94,25 @@
             tag += ' %s="%s"' % (key, value)
 
         data = self._escape_data(data)
         self.fh.write("<%s>%s</%s>" % (tag, data, end_tag))
 
     def _xml_string_element(self, index, attributes=[]):
         # Optimized tag writer for <c> cell string elements in the inner loop.
-        attr = ''
+        attr = ""
 
         for key, value in attributes:
             value = self._escape_attributes(value)
             attr += ' %s="%s"' % (key, value)
 
         self.fh.write("""<c%s t="s"><v>%d</v></c>""" % (attr, index))
 
     def _xml_si_element(self, string, attributes=[]):
         # Optimized tag writer for shared strings <si> elements.
-        attr = ''
+        attr = ""
 
         for key, value in attributes:
             value = self._escape_attributes(value)
             attr += ' %s="%s"' % (key, value)
 
         string = self._escape_data(string)
 
@@ -122,91 +121,86 @@
     def _xml_rich_si_element(self, string):
         # Optimized tag writer for shared strings <si> rich string elements.
 
         self.fh.write("""<si>%s</si>""" % string)
 
     def _xml_number_element(self, number, attributes=[]):
         # Optimized tag writer for <c> cell number elements in the inner loop.
-        attr = ''
+        attr = ""
 
         for key, value in attributes:
             value = self._escape_attributes(value)
             attr += ' %s="%s"' % (key, value)
 
         self.fh.write("""<c%s><v>%.16G</v></c>""" % (attr, number))
 
     def _xml_formula_element(self, formula, result, attributes=[]):
         # Optimized tag writer for <c> cell formula elements in the inner loop.
-        attr = ''
+        attr = ""
 
         for key, value in attributes:
             value = self._escape_attributes(value)
             attr += ' %s="%s"' % (key, value)
 
-        self.fh.write("""<c%s><f>%s</f><v>%s</v></c>"""
-                      % (attr, self._escape_data(formula),
-                         self._escape_data(result)))
+        self.fh.write(
+            """<c%s><f>%s</f><v>%s</v></c>"""
+            % (attr, self._escape_data(formula), self._escape_data(result))
+        )
 
     def _xml_inline_string(self, string, preserve, attributes=[]):
         # Optimized tag writer for inlineStr cell elements in the inner loop.
-        attr = ''
-        t_attr = ''
+        attr = ""
+        t_attr = ""
 
         # Set the <t> attribute to preserve whitespace.
         if preserve:
             t_attr = ' xml:space="preserve"'
 
         for key, value in attributes:
             value = self._escape_attributes(value)
             attr += ' %s="%s"' % (key, value)
 
         string = self._escape_data(string)
 
-        self.fh.write("""<c%s t="inlineStr"><is><t%s>%s</t></is></c>""" %
-                      (attr, t_attr, string))
+        self.fh.write(
+            """<c%s t="inlineStr"><is><t%s>%s</t></is></c>""" % (attr, t_attr, string)
+        )
 
     def _xml_rich_inline_string(self, string, attributes=[]):
         # Optimized tag writer for rich inlineStr in the inner loop.
-        attr = ''
+        attr = ""
 
         for key, value in attributes:
             value = self._escape_attributes(value)
             attr += ' %s="%s"' % (key, value)
 
-        self.fh.write("""<c%s t="inlineStr"><is>%s</is></c>""" %
-                      (attr, string))
+        self.fh.write("""<c%s t="inlineStr"><is>%s</is></c>""" % (attr, string))
 
     def _escape_attributes(self, attribute):
         # Escape XML characters in attributes.
         try:
             if not self.escapes.search(attribute):
                 return attribute
         except TypeError:
             return attribute
 
         attribute = (
-            attribute
-            .replace('&', '&amp;')
-            .replace('"', '&quot;')
-            .replace('<', '&lt;')
-            .replace('>', '&gt;')
-            .replace('\n', '&#xA;')
+            attribute.replace("&", "&amp;")
+            .replace('"', "&quot;")
+            .replace("<", "&lt;")
+            .replace(">", "&gt;")
+            .replace("\n", "&#xA;")
         )
         return attribute
 
     def _escape_data(self, data):
         # Escape XML characters in data sections of tags.  Note, this
         # is different from _escape_attributes() in that double quotes
         # are not escaped by Excel.
         try:
             if not self.escapes.search(data):
                 return data
         except TypeError:
             return data
 
-        data = (
-            data
-            .replace('&', '&amp;')
-            .replace('<', '&lt;')
-            .replace('>', '&gt;')
-        )
+        data = data.replace("&", "&amp;").replace("<", "&lt;").replace(">", "&gt;")
         return data
```

