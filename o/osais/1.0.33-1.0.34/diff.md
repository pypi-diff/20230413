# Comparing `tmp/osais-1.0.33.tar.gz` & `tmp/osais-1.0.34.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "D:\Websites\opensourceais\python\lib_osais\dist\.tmp-qf3oh497\osais-1.0.33.tar", last modified: Thu Apr 13 12:42:09 2023, max compression
+gzip compressed data, was "D:\Websites\opensourceais\python\lib_osais\dist\.tmp-qt1lhzrv\osais-1.0.34.tar", last modified: Thu Apr 13 18:55:33 2023, max compression
```

## Comparing `osais-1.0.33.tar` & `osais-1.0.34.tar`

### file list

```diff
@@ -1,16 +1,16 @@
-drwxrwxrwx   0        0        0        0 2023-04-13 12:42:09.218988 osais-1.0.33/
--rw-rw-rw-   0        0        0    33041 2023-04-05 11:19:20.000000 osais-1.0.33/LICENSE
--rw-rw-rw-   0        0        0     1113 2023-04-13 12:42:09.218988 osais-1.0.33/PKG-INFO
--rw-rw-rw-   0        0        0      339 2023-04-05 15:00:45.000000 osais-1.0.33/README.md
-drwxrwxrwx   0        0        0        0 2023-04-13 12:42:09.213987 osais-1.0.33/osais/
--rw-rw-rw-   0        0        0      652 2023-04-13 12:41:09.000000 osais-1.0.33/osais/__init__.py
--rw-rw-rw-   0        0        0    41183 2023-04-13 12:41:18.000000 osais-1.0.33/osais/osais.py
-drwxrwxrwx   0        0        0        0 2023-04-13 12:42:09.216988 osais-1.0.33/osais.egg-info/
--rw-rw-rw-   0        0        0     1113 2023-04-13 12:42:09.000000 osais-1.0.33/osais.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      218 2023-04-13 12:42:09.000000 osais-1.0.33/osais.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2023-04-13 12:42:09.000000 osais-1.0.33/osais.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0       65 2023-04-13 12:42:09.000000 osais-1.0.33/osais.egg-info/requires.txt
--rw-rw-rw-   0        0        0        6 2023-04-13 12:42:09.000000 osais-1.0.33/osais.egg-info/top_level.txt
--rw-rw-rw-   0        0        0       95 2023-04-05 18:53:17.000000 osais-1.0.33/pyproject.toml
--rw-rw-rw-   0        0        0       42 2023-04-13 12:42:09.218988 osais-1.0.33/setup.cfg
--rw-rw-rw-   0        0        0     1124 2023-04-13 12:41:27.000000 osais-1.0.33/setup.py
+drwxrwxrwx   0        0        0        0 2023-04-13 18:55:33.351486 osais-1.0.34/
+-rw-rw-rw-   0        0        0    33041 2023-04-05 11:19:20.000000 osais-1.0.34/LICENSE
+-rw-rw-rw-   0        0        0     1113 2023-04-13 18:55:33.350485 osais-1.0.34/PKG-INFO
+-rw-rw-rw-   0        0        0      339 2023-04-05 15:00:45.000000 osais-1.0.34/README.md
+drwxrwxrwx   0        0        0        0 2023-04-13 18:55:33.346486 osais-1.0.34/osais/
+-rw-rw-rw-   0        0        0      652 2023-04-13 18:54:40.000000 osais-1.0.34/osais/__init__.py
+-rw-rw-rw-   0        0        0    41351 2023-04-13 18:54:47.000000 osais-1.0.34/osais/osais.py
+drwxrwxrwx   0        0        0        0 2023-04-13 18:55:33.349486 osais-1.0.34/osais.egg-info/
+-rw-rw-rw-   0        0        0     1113 2023-04-13 18:55:33.000000 osais-1.0.34/osais.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      218 2023-04-13 18:55:33.000000 osais-1.0.34/osais.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2023-04-13 18:55:33.000000 osais-1.0.34/osais.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0       65 2023-04-13 18:55:33.000000 osais-1.0.34/osais.egg-info/requires.txt
+-rw-rw-rw-   0        0        0        6 2023-04-13 18:55:33.000000 osais-1.0.34/osais.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0       95 2023-04-05 18:53:17.000000 osais-1.0.34/pyproject.toml
+-rw-rw-rw-   0        0        0       42 2023-04-13 18:55:33.351486 osais-1.0.34/setup.cfg
+-rw-rw-rw-   0        0        0     1124 2023-04-13 18:54:55.000000 osais-1.0.34/setup.py
```

### Comparing `osais-1.0.33/LICENSE` & `osais-1.0.34/LICENSE`

 * *Files identical despite different names*

### Comparing `osais-1.0.33/PKG-INFO` & `osais-1.0.34/PKG-INFO`

 * *Files 24% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: osais
-Version: 1.0.33
+Version: 1.0.34
 Summary: The osais Python lib for connecting AIs to OSAIS cloud
 Home-page: https://github.com/incubiq/osais
 Author: incubiq
 Author-email: eric@incubiq.com
 Keywords: osais,opensourceais
 Classifier: Development Status :: 3 - Alpha
 Classifier: Intended Audience :: Developers
```

### Comparing `osais-1.0.33/osais/__init__.py` & `osais-1.0.34/osais/__init__.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 """
 A package for OSAIS virtual AI.
 """
-__version__="1.0.33"
+__version__="1.0.34"
 __author__ = "incubiq"
 __email__ = "eric@incubiq.com"
 
 from .osais import osais_isLocal
 from .osais import osais_loadConfig
 from .osais import osais_getEnv
 from .osais import osais_getHarwareInfo
```

### Comparing `osais-1.0.33/osais/osais.py` & `osais-1.0.34/osais/osais.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,9 +1,9 @@
 00000000: 0d0a 5f5f 7665 7273 696f 6e5f 5f3d 2231  ..__version__="1
-00000010: 2e30 2e33 3322 0d0a 0d0a 2323 203d 3d3d  .0.33"....## ===
+00000010: 2e30 2e33 3422 0d0a 0d0a 2323 203d 3d3d  .0.34"....## ===
 00000020: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00000030: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00000040: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00000050: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00000060: 3d3d 3d3d 3d0d 0a23 2320 0d0a 2323 2020  =====..## ..##  
 00000070: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00000080: 2020 2020 5574 696c 6974 6965 7320 7374      Utilities st
@@ -73,2502 +73,2513 @@
 00000480: 2873 656c 662c 2065 7665 6e74 293a 0d0a  (self, event):..
 00000490: 2020 2020 2020 2020 6966 2065 7665 6e74          if event
 000004a0: 2e69 735f 6469 7265 6374 6f72 793a 0d0a  .is_directory:..
 000004b0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
 000004c0: 726e 0d0a 2020 2020 2020 2020 6966 2065  rn..        if e
 000004d0: 7665 6e74 2e65 7665 6e74 5f74 7970 6520  vent.event_type 
 000004e0: 3d3d 2027 6372 6561 7465 6427 3a0d 0a20  == 'created':.. 
-000004f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00000500: 666e 4f6e 4669 6c65 4372 6561 7465 6428  fnOnFileCreated(
-00000510: 6f73 2e70 6174 682e 6469 726e 616d 6528  os.path.dirname(
-00000520: 6576 656e 742e 7372 635f 7061 7468 292c  event.src_path),
-00000530: 206f 732e 7061 7468 2e62 6173 656e 616d   os.path.basenam
-00000540: 6528 6576 656e 742e 7372 635f 7061 7468  e(event.src_path
-00000550: 292c 2073 656c 662e 5f61 7267 7329 0d0a  ), self._args)..
-00000560: 0d0a 6465 6620 7374 6172 745f 6f62 7365  ..def start_obse
-00000570: 7276 6572 5f74 6872 6561 6428 7061 7468  rver_thread(path
-00000580: 2c20 666e 4f6e 4669 6c65 4372 6561 7465  , fnOnFileCreate
-00000590: 642c 205f 6172 6773 293a 0d0a 0d0a 2020  d, _args):....  
-000005a0: 2020 2323 2077 6174 6368 2064 6972 6563    ## watch direc
-000005b0: 746f 7279 2061 6e64 2063 616c 6c20 6261  tory and call ba
-000005c0: 636b 2069 6620 6669 6c65 2077 6173 2063  ck if file was c
-000005d0: 7265 6174 6564 0d0a 2020 2020 6465 6620  reated..    def 
-000005e0: 7761 7463 685f 6469 7265 6374 6f72 7928  watch_directory(
-000005f0: 7061 7468 2c20 666e 4f6e 4669 6c65 4372  path, fnOnFileCr
-00000600: 6561 7465 642c 205f 6172 6773 293a 2020  eated, _args):  
-00000610: 2020 0d0a 2020 2020 2020 2020 676c 6f62    ..        glob
-00000620: 616c 2067 4f62 7365 7276 6572 0d0a 2020  al gObserver..  
-00000630: 2020 2020 2020 6966 2067 4f62 7365 7276        if gObserv
-00000640: 6572 213d 4e6f 6e65 3a0d 0a20 2020 2020  er!=None:..     
-00000650: 2020 2020 2020 2067 4f62 7365 7276 6572         gObserver
-00000660: 2e73 746f 7028 290d 0a20 2020 2020 2020  .stop()..       
-00000670: 2065 7665 6e74 5f68 616e 646c 6572 203d   event_handler =
-00000680: 204e 6577 4669 6c65 4861 6e64 6c65 7228   NewFileHandler(
-00000690: 666e 4f6e 4669 6c65 4372 6561 7465 642c  fnOnFileCreated,
-000006a0: 205f 6172 6773 290d 0a20 2020 2020 2020   _args)..       
-000006b0: 2067 4f62 7365 7276 6572 203d 204f 6273   gObserver = Obs
-000006c0: 6572 7665 7228 290d 0a20 2020 2020 2020  erver()..       
-000006d0: 2067 4f62 7365 7276 6572 2e73 6368 6564   gObserver.sched
-000006e0: 756c 6528 6576 656e 745f 6861 6e64 6c65  ule(event_handle
-000006f0: 722c 2070 6174 682c 2072 6563 7572 7369  r, path, recursi
-00000700: 7665 3d46 616c 7365 290d 0a20 2020 2020  ve=False)..     
-00000710: 2020 2067 4f62 7365 7276 6572 2e73 7461     gObserver.sta
-00000720: 7274 2829 0d0a 2020 2020 2020 2020 674f  rt()..        gO
-00000730: 6273 6572 7665 722e 6a6f 696e 2831 290d  bserver.join(1).
-00000740: 0a0d 0a20 2020 2074 6872 6561 6420 3d20  ...    thread = 
-00000750: 7468 7265 6164 696e 672e 5468 7265 6164  threading.Thread
-00000760: 2874 6172 6765 743d 7761 7463 685f 6469  (target=watch_di
-00000770: 7265 6374 6f72 792c 2061 7267 733d 2870  rectory, args=(p
-00000780: 6174 682c 2066 6e4f 6e46 696c 6543 7265  ath, fnOnFileCre
-00000790: 6174 6564 2c20 5f61 7267 7329 290d 0a20  ated, _args)).. 
-000007a0: 2020 2074 6872 6561 642e 7374 6172 7428     thread.start(
-000007b0: 290d 0a20 2020 2072 6574 7572 6e20 7761  )..    return wa
-000007c0: 7463 685f 6469 7265 6374 6f72 790d 0a0d  tch_directory...
-000007d0: 0a64 6566 2073 7461 7274 5f6e 6f74 6966  .def start_notif
-000007e0: 6963 6174 696f 6e5f 7468 7265 6164 2866  ication_thread(f
-000007f0: 6e4f 6e4e 6f74 6966 7929 3a0d 0a20 2020  nOnNotify):..   
-00000800: 2064 6566 205f 7275 6e28 5f66 6e29 3a0d   def _run(_fn):.
-00000810: 0a20 2020 2020 2020 205f 666e 2829 0d0a  .        _fn()..
-00000820: 2020 2020 7468 7265 6164 203d 2074 6872      thread = thr
-00000830: 6561 6469 6e67 2e54 6872 6561 6428 7461  eading.Thread(ta
-00000840: 7267 6574 3d5f 7275 6e2c 2061 7267 733d  rget=_run, args=
-00000850: 2866 6e4f 6e4e 6f74 6966 7929 290d 0a20  (fnOnNotify)).. 
-00000860: 2020 2074 6872 6561 642e 7374 6172 7428     thread.start(
-00000870: 290d 0a20 2020 2072 6574 7572 6e20 5f72  )..    return _r
-00000880: 756e 0d0a 0d0a 2323 202d 2d2d 2d2d 2d2d  un....## -------
-00000890: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000008a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000008b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000008c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000008d0: 2d0d 0a23 2020 2020 2020 2044 6972 6563  -..#       Direc
-000008e0: 746f 7279 2075 7469 6c73 0d0a 2323 202d  tory utils..## -
-000008f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000900: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000910: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000920: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000930: 2d2d 2d2d 2d2d 2d0d 0a0d 0a23 2320 6c69  -------....## li
-00000940: 7374 2063 6f6e 7465 6e74 206f 6620 6120  st content of a 
-00000950: 6469 7265 6374 6f72 790d 0a64 6566 206c  directory..def l
-00000960: 6973 7444 6972 436f 6e74 656e 7428 5f64  istDirContent(_d
-00000970: 6972 293a 0d0a 2020 2020 6672 6f6d 206f  ir):..    from o
-00000980: 732e 7061 7468 2069 6d70 6f72 7420 6973  s.path import is
-00000990: 6669 6c65 2c20 6a6f 696e 0d0a 2020 2020  file, join..    
-000009a0: 6f6e 6c79 6669 6c65 7320 3d20 5b66 2066  onlyfiles = [f f
-000009b0: 6f72 2066 2069 6e20 6f73 2e6c 6973 7464  or f in os.listd
-000009c0: 6972 285f 6469 7229 5d0d 0a20 2020 2072  ir(_dir)]..    r
-000009d0: 6574 3d22 466f 756e 6420 222b 7374 7220  et="Found "+str 
-000009e0: 286c 656e 286f 6e6c 7966 696c 6573 2929  (len(onlyfiles))
-000009f0: 202b 2022 2066 696c 6573 2069 6e20 7061   + " files in pa
-00000a00: 7468 2022 2b5f 6469 722b 223c 6272 3e3c  th "+_dir+"<br><
-00000a10: 6272 3e22 3b0d 0a20 2020 2066 6f72 2078  br>";..    for x
-00000a20: 2069 6e20 6f6e 6c79 6669 6c65 733a 0d0a   in onlyfiles:..
-00000a30: 2020 2020 2020 2020 6966 2069 7366 696c          if isfil
-00000a40: 6528 6a6f 696e 285f 6469 722c 2078 2929  e(join(_dir, x))
-00000a50: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-00000a60: 6574 203d 2072 6574 2b78 2b22 3c62 723e  et = ret+x+"<br>
-00000a70: 220d 0a20 2020 2020 2020 2065 6c73 653a  "..        else:
-00000a80: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-00000a90: 7420 3d20 7265 742b 222e 2f22 2b78 2b22  t = ret+"./"+x+"
-00000aa0: 3c62 723e 220d 0a0d 0a20 2020 2066 726f  <br>"....    fro
-00000ab0: 6d20 6461 7465 7469 6d65 2069 6d70 6f72  m datetime impor
-00000ac0: 7420 6461 7465 7469 6d65 0d0a 2020 2020  t datetime..    
-00000ad0: 6e6f 7720 3d20 6461 7465 7469 6d65 2e6e  now = datetime.n
-00000ae0: 6f77 2829 0d0a 2020 2020 6474 5f73 7472  ow()..    dt_str
-00000af0: 696e 6720 3d20 6e6f 772e 7374 7266 7469  ing = now.strfti
-00000b00: 6d65 2822 2564 2f25 6d2f 2559 2025 483a  me("%d/%m/%Y %H:
-00000b10: 254d 3a25 5322 290d 0a20 2020 2072 6574  %M:%S")..    ret
-00000b20: 7572 6e20 6474 5f73 7472 696e 672b 223c  urn dt_string+"<
-00000b30: 6272 3e22 2b72 6574 0d0a 0d0a 6465 6620  br>"+ret....def 
-00000b40: 636c 6561 724f 6c64 4669 6c65 7328 5f64  clearOldFiles(_d
-00000b50: 6972 293a 2020 0d0a 2020 2020 6672 6f6d  ir):  ..    from
-00000b60: 2064 6174 6574 696d 6520 696d 706f 7274   datetime import
-00000b70: 2074 696d 6564 656c 7461 0d0a 2020 2020   timedelta..    
-00000b80: 6672 6f6d 2064 6174 6574 696d 6520 696d  from datetime im
-00000b90: 706f 7274 2064 6174 6574 696d 650d 0a20  port datetime.. 
-00000ba0: 2020 205f 6e6f 773d 6461 7465 7469 6d65     _now=datetime
-00000bb0: 2e6e 6f77 2829 0d0a 2020 2020 6375 746f  .now()..    cuto
-00000bc0: 6666 5f74 696d 6520 3d20 5f6e 6f77 202d  ff_time = _now -
-00000bd0: 2074 696d 6564 656c 7461 286d 696e 7574   timedelta(minut
-00000be0: 6573 3d31 3029 0d0a 2020 2020 666f 7220  es=10)..    for 
-00000bf0: 6669 6c65 6e61 6d65 2069 6e20 6f73 2e6c  filename in os.l
-00000c00: 6973 7464 6972 285f 6469 7229 3a0d 0a20  istdir(_dir):.. 
-00000c10: 2020 2020 2020 2066 696c 655f 7061 7468         file_path
-00000c20: 203d 206f 732e 7061 7468 2e6a 6f69 6e28   = os.path.join(
-00000c30: 5f64 6972 2c20 6669 6c65 6e61 6d65 290d  _dir, filename).
-00000c40: 0a20 2020 2020 2020 206d 6f64 6966 6963  .        modific
-00000c50: 6174 696f 6e5f 7469 6d65 203d 2064 6174  ation_time = dat
-00000c60: 6574 696d 652e 6672 6f6d 7469 6d65 7374  etime.fromtimest
-00000c70: 616d 7028 6f73 2e70 6174 682e 6765 746d  amp(os.path.getm
-00000c80: 7469 6d65 2866 696c 655f 7061 7468 2929  time(file_path))
-00000c90: 0d0a 2020 2020 2020 2020 6966 206d 6f64  ..        if mod
-00000ca0: 6966 6963 6174 696f 6e5f 7469 6d65 203c  ification_time <
-00000cb0: 2063 7574 6f66 665f 7469 6d65 3a0d 0a20   cutoff_time:.. 
-00000cc0: 2020 2020 2020 2020 2020 206f 732e 7265             os.re
-00000cd0: 6d6f 7665 2866 696c 655f 7061 7468 290d  move(file_path).
-00000ce0: 0a20 2020 2020 2020 2020 2020 200d 0a23  .            ..#
-00000cf0: 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  # --------------
-00000d00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000d10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000d20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000d30: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2320 2020  ----------..#   
-00000d40: 2020 2020 5379 7374 656d 2075 7469 6c73      System utils
-00000d50: 0d0a 2323 202d 2d2d 2d2d 2d2d 2d2d 2d2d  ..## -----------
-00000d60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000d70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000d80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00000d90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d  -------------...
-00000da0: 0a23 2320 6765 7420 6120 6d65 616e 696e  .## get a meanin
-00000db0: 6766 756c 206e 616d 6520 666f 7220 6f75  gful name for ou
-00000dc0: 7220 6d61 6368 696e 650d 0a64 6566 2067  r machine..def g
-00000dd0: 6574 5f6d 6163 6869 6e65 5f6e 616d 6528  et_machine_name(
-00000de0: 2920 3a0d 0a20 2020 205f 6d61 6368 696e  ) :..    _machin
-00000df0: 653d 7374 7220 2868 6578 2875 7569 642e  e=str (hex(uuid.
-00000e00: 6765 746e 6f64 6528 2929 290d 0a20 2020  getnode()))..   
-00000e10: 205f 6973 446f 636b 6572 3d69 735f 7275   _isDocker=is_ru
-00000e20: 6e6e 696e 675f 696e 5f64 6f63 6b65 7228  nning_in_docker(
-00000e30: 290d 0a20 2020 2069 6620 5f69 7344 6f63  )..    if _isDoc
-00000e40: 6b65 723a 0d0a 2020 2020 2020 2020 5f6d  ker:..        _m
-00000e50: 6163 6869 6e65 203d 206f 732e 656e 7669  achine = os.envi
-00000e60: 726f 6e2e 6765 7428 2748 4f53 544e 414d  ron.get('HOSTNAM
-00000e70: 4527 2920 6f72 206f 732e 706f 7065 6e28  E') or os.popen(
-00000e80: 2768 6f73 746e 616d 6527 292e 7265 6164  'hostname').read
-00000e90: 2829 2e73 7472 6970 2829 0d0a 2020 2020  ().strip()..    
-00000ea0: 7265 7475 726e 205f 6d61 6368 696e 650d  return _machine.
-00000eb0: 0a0d 0a23 2320 7768 6963 6820 4f53 2061  ...## which OS a
-00000ec0: 7265 2077 6520 7275 6e6e 696e 6720 6f6e  re we running on
-00000ed0: 3f0d 0a64 6566 2067 6574 5f6f 735f 6e61  ?..def get_os_na
-00000ee0: 6d65 2829 3a0d 0a20 2020 206f 735f 6e61  me():..    os_na
-00000ef0: 6d65 203d 2070 6c61 7466 6f72 6d2e 7379  me = platform.sy
-00000f00: 7374 656d 2829 0d0a 2020 2020 7265 7475  stem()..    retu
-00000f10: 726e 206f 735f 6e61 6d65 0d0a 0d0a 2323  rn os_name....##
-00000f20: 2041 7265 2077 6520 7275 6e6e 696e 6720   Are we running 
-00000f30: 696e 7369 6465 2061 2064 6f63 6b65 7220  inside a docker 
-00000f40: 7365 7373 696f 6e3f 0d0a 6465 6620 6973  session?..def is
-00000f50: 5f72 756e 6e69 6e67 5f69 6e5f 646f 636b  _running_in_dock
-00000f60: 6572 2829 3a0d 0a20 2020 2069 6620 6f73  er():..    if os
-00000f70: 2e70 6174 682e 6578 6973 7473 2827 2f70  .path.exists('/p
-00000f80: 726f 632f 7365 6c66 2f63 6772 6f75 7027  roc/self/cgroup'
-00000f90: 293a 0d0a 2020 2020 2020 2020 7769 7468  ):..        with
-00000fa0: 206f 7065 6e28 272f 7072 6f63 2f73 656c   open('/proc/sel
-00000fb0: 662f 6367 726f 7570 272c 2027 7274 2729  f/cgroup', 'rt')
-00000fc0: 2061 7320 663a 0d0a 2020 2020 2020 2020   as f:..        
-00000fd0: 2020 2020 7265 7475 726e 2027 646f 636b      return 'dock
-00000fe0: 6572 2720 696e 2066 2e72 6561 6428 290d  er' in f.read().
-00000ff0: 0a20 2020 2072 6574 7572 6e20 4661 6c73  .    return Fals
-00001000: 650d 0a0d 0a23 2320 6765 7420 6970 2061  e....## get ip a
-00001010: 6464 7265 7373 206f 6620 7468 6520 686f  ddress of the ho
-00001020: 7374 0d0a 6465 6620 6765 745f 636f 6e74  st..def get_cont
-00001030: 6169 6e65 725f 6970 2829 3a0d 0a20 2020  ainer_ip():..   
-00001040: 2069 6d70 6f72 7420 736f 636b 6574 0d0a   import socket..
-00001050: 0d0a 2020 2020 2320 4765 7420 7468 6520  ..    # Get the 
-00001060: 686f 7374 6e61 6d65 206f 6620 7468 6520  hostname of the 
-00001070: 6d61 6368 696e 6520 7275 6e6e 696e 6720  machine running 
-00001080: 7468 6520 7363 7269 7074 0d0a 2020 2020  the script..    
-00001090: 686f 7374 6e61 6d65 203d 2073 6f63 6b65  hostname = socke
-000010a0: 742e 6765 7468 6f73 746e 616d 6528 290d  t.gethostname().
-000010b0: 0a0d 0a20 2020 2023 2047 6574 2074 6865  ...    # Get the
-000010c0: 2049 5020 6164 6472 6573 7320 6f66 2074   IP address of t
-000010d0: 6865 2063 6f6e 7461 696e 6572 2062 7920  he container by 
-000010e0: 7265 736f 6c76 696e 6720 7468 6520 686f  resolving the ho
-000010f0: 7374 6e61 6d65 0d0a 2020 2020 6970 5f61  stname..    ip_a
-00001100: 6464 7265 7373 203d 2073 6f63 6b65 742e  ddress = socket.
-00001110: 6765 7468 6f73 7462 796e 616d 6528 686f  gethostbyname(ho
-00001120: 7374 6e61 6d65 290d 0a20 2020 2072 6574  stname)..    ret
-00001130: 7572 6e20 6970 5f61 6464 7265 7373 0d0a  urn ip_address..
-00001140: 0d0a 2323 2067 6574 206f 7572 2065 7874  ..## get our ext
-00001150: 6572 6e61 6c20 6970 2061 6464 7265 7373  ernal ip address
-00001160: 0d0a 6465 6620 6765 745f 6578 7465 726e  ..def get_extern
-00001170: 616c 5f69 7028 293a 0d0a 2020 2020 696d  al_ip():..    im
-00001180: 706f 7274 2072 6571 7565 7374 730d 0a20  port requests.. 
-00001190: 2020 2075 726c 203d 2022 6874 7470 733a     url = "https:
-000011a0: 2f2f 6170 692e 6970 6966 792e 6f72 6722  //api.ipify.org"
-000011b0: 0d0a 2020 2020 7265 7370 6f6e 7365 203d  ..    response =
-000011c0: 2072 6571 7565 7374 732e 6765 7428 7572   requests.get(ur
-000011d0: 6c29 0d0a 2020 2020 7265 7475 726e 2072  l)..    return r
-000011e0: 6573 706f 6e73 652e 7465 7874 2e73 7472  esponse.text.str
-000011f0: 6970 2829 0d0a 0d0a 2323 2067 6574 206f  ip()....## get o
-00001200: 7572 2065 7874 6572 6e61 6c20 706f 7274  ur external port
-00001210: 0d0a 6465 6620 6765 745f 706f 7274 2829  ..def get_port()
-00001220: 3a20 0d0a 2020 2020 696d 706f 7274 2073  : ..    import s
-00001230: 6f63 6b65 740d 0a20 2020 2073 6f63 6b20  ocket..    sock 
-00001240: 3d20 736f 636b 6574 2e73 6f63 6b65 7428  = socket.socket(
-00001250: 736f 636b 6574 2e41 465f 494e 4554 2c20  socket.AF_INET, 
-00001260: 736f 636b 6574 2e53 4f43 4b5f 5354 5245  socket.SOCK_STRE
-00001270: 414d 290d 0a20 2020 2073 6f63 6b2e 6269  AM)..    sock.bi
-00001280: 6e64 2828 276c 6f63 616c 686f 7374 272c  nd(('localhost',
-00001290: 2030 2929 0d0a 2020 2020 706f 7274 203d   0))..    port =
-000012a0: 2073 6f63 6b2e 6765 7473 6f63 6b6e 616d   sock.getsocknam
-000012b0: 6528 295b 315d 0d0a 2020 2020 7265 7475  e()[1]..    retu
-000012c0: 726e 2070 6f72 740d 0a0d 0a23 2320 6a75  rn port....## ju
-000012d0: 7374 2074 6f20 6765 7420 7468 6520 6c69  st to get the li
-000012e0: 7374 206f 6620 616c 6c20 696e 7374 616c  st of all instal
-000012f0: 6c65 6420 5079 7468 6f6e 206d 6f64 756c  led Python modul
-00001300: 6573 2069 6e20 7468 6520 7275 6e6e 696e  es in the runnin
-00001310: 6720 7365 7373 696f 6e0d 0a64 6566 2067  g session..def g
-00001320: 6574 5f6c 6973 745f 6f66 5f6d 6f64 756c  et_list_of_modul
-00001330: 6573 2829 3a0d 0a20 2020 2069 6e73 7461  es():..    insta
-00001340: 6c6c 6564 5f70 6163 6b61 6765 7320 3d20  lled_packages = 
-00001350: 706b 675f 7265 736f 7572 6365 732e 776f  pkg_resources.wo
-00001360: 726b 696e 675f 7365 740d 0a20 2020 2069  rking_set..    i
-00001370: 6e73 7461 6c6c 6564 5f70 6163 6b61 6765  nstalled_package
-00001380: 735f 6c69 7374 3d5b 5d0d 0a20 2020 2066  s_list=[]..    f
-00001390: 6f72 2069 2069 6e20 696e 7374 616c 6c65  or i in installe
-000013a0: 645f 7061 636b 6167 6573 3a0d 0a20 2020  d_packages:..   
-000013b0: 2020 2020 2069 6e73 7461 6c6c 6564 5f70       installed_p
-000013c0: 6163 6b61 6765 735f 6c69 7374 2e61 7070  ackages_list.app
-000013d0: 656e 6428 7b69 2e6b 6579 3a20 692e 7665  end({i.key: i.ve
-000013e0: 7273 696f 6e7d 290d 0a20 2020 2072 6574  rsion})..    ret
-000013f0: 7572 6e20 696e 7374 616c 6c65 645f 7061  urn installed_pa
-00001400: 636b 6167 6573 5f6c 6973 740d 0a0d 0a23  ckages_list....#
-00001410: 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  # --------------
-00001420: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001430: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001440: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001450: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2320 2020  ----------..#   
-00001460: 2020 2020 4750 5520 7574 696c 730d 0a23      GPU utils..#
-00001470: 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  # --------------
-00001480: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00001490: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000014a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000014b0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a 2323  ----------....##
-000014c0: 2077 6869 6368 2047 5055 2069 7320 7468   which GPU is th
-000014d0: 6973 3f20 2877 696c 6c20 7265 7175 6972  is? (will requir
-000014e0: 6520 6163 6365 7373 2074 6f20 6e76 6964  e access to nvid
-000014f0: 6961 2d73 6d69 290d 0a64 6566 2067 6574  ia-smi)..def get
-00001500: 5f67 7075 5f61 7474 7228 5f61 7474 7229  _gpu_attr(_attr)
-00001510: 3a0d 0a20 2020 6f75 7470 7574 5f74 6f5f  :..   output_to_
-00001520: 6c69 7374 203d 206c 616d 6264 6120 783a  list = lambda x:
-00001530: 2078 2e64 6563 6f64 6528 2761 7363 6969   x.decode('ascii
-00001540: 2729 2e73 706c 6974 2827 5c6e 2729 5b3a  ').split('\n')[:
-00001550: 2d31 5d0d 0a20 2020 434f 4d4d 414e 4420  -1]..   COMMAND 
-00001560: 3d20 226e 7669 6469 612d 736d 6920 2d2d  = "nvidia-smi --
-00001570: 7175 6572 792d 6770 753d 222b 5f61 7474  query-gpu="+_att
-00001580: 722b 2220 2d2d 666f 726d 6174 3d63 7376  r+" --format=csv
-00001590: 220d 0a20 2020 7472 793a 0d0a 2020 2020  "..   try:..    
-000015a0: 2020 2020 6d65 6d6f 7279 5f75 7365 5f69      memory_use_i
-000015b0: 6e66 6f20 3d20 6f75 7470 7574 5f74 6f5f  nfo = output_to_
-000015c0: 6c69 7374 2873 702e 6368 6563 6b5f 6f75  list(sp.check_ou
-000015d0: 7470 7574 2843 4f4d 4d41 4e44 2e73 706c  tput(COMMAND.spl
-000015e0: 6974 2829 2c73 7464 6572 723d 7370 2e53  it(),stderr=sp.S
-000015f0: 5444 4f55 5429 295b 313a 5d0d 0a20 2020  TDOUT))[1:]..   
-00001600: 6578 6365 7074 2073 702e 4361 6c6c 6564  except sp.Called
-00001610: 5072 6f63 6573 7345 7272 6f72 2061 7320  ProcessError as 
-00001620: 653a 0d0a 2020 2020 2020 2020 7261 6973  e:..        rais
-00001630: 6520 5275 6e74 696d 6545 7272 6f72 2822  e RuntimeError("
-00001640: 636f 6d6d 616e 6420 277b 7d27 2072 6574  command '{}' ret
-00001650: 7572 6e20 7769 7468 2065 7272 6f72 2028  urn with error (
-00001660: 636f 6465 207b 7d29 3a20 7b7d 222e 666f  code {}): {}".fo
-00001670: 726d 6174 2865 2e63 6d64 2c20 652e 7265  rmat(e.cmd, e.re
-00001680: 7475 726e 636f 6465 2c20 652e 6f75 7470  turncode, e.outp
-00001690: 7574 2929 0d0a 2020 206d 656d 6f72 795f  ut))..   memory_
-000016a0: 7573 655f 7661 6c75 6573 203d 205b 782e  use_values = [x.
-000016b0: 7265 706c 6163 6528 275c 7227 2c20 2727  replace('\r', ''
-000016c0: 2920 666f 7220 692c 2078 2069 6e20 656e  ) for i, x in en
-000016d0: 756d 6572 6174 6528 6d65 6d6f 7279 5f75  umerate(memory_u
-000016e0: 7365 5f69 6e66 6f29 5d0d 0a20 2020 7265  se_info)]..   re
-000016f0: 7475 726e 206d 656d 6f72 795f 7573 655f  turn memory_use_
-00001700: 7661 6c75 6573 0d0a 0d0a 0d0a 2323 2067  values......## g
-00001710: 6574 2047 5055 2043 7564 6120 696e 666f  et GPU Cuda info
-00001720: 0d0a 2320 7365 6520 6865 7265 3a20 6874  ..# see here: ht
-00001730: 7470 733a 2f2f 6769 7374 2e67 6974 6875  tps://gist.githu
-00001740: 622e 636f 6d2f 7469 7370 7261 7469 6b2f  b.com/tispratik/
-00001750: 3432 6137 3163 6165 3334 3338 3966 6437  42a71cae34389fd7
-00001760: 6338 6538 3934 3936 6165 3838 3133 6165  c8e89496ae8813ae
-00001770: 0d0a 6465 6620 6765 7443 7564 6149 6e66  ..def getCudaInf
-00001780: 6f28 293a 0d0a 2020 2020 0d0a 2020 2020  o():..    ..    
-00001790: 6469 7370 6c61 795f 6e61 6d65 203d 2022  display_name = "
-000017a0: 6e6f 2047 5055 220d 0a20 2020 2064 6973  no GPU"..    dis
-000017b0: 706c 6179 5f63 6f72 6573 203d 2022 3022  play_cores = "0"
-000017c0: 0d0a 2020 2020 6469 7370 6c61 795f 6d61  ..    display_ma
-000017d0: 6a6f 7220 3d20 2230 220d 0a20 2020 2064  jor = "0"..    d
-000017e0: 6973 706c 6179 5f6d 696e 6f72 203d 2022  isplay_minor = "
-000017f0: 3022 0d0a 0d0a 2020 2020 6966 2063 7564  0"....    if cud
-00001800: 613a 0d0a 2020 2020 2020 2020 4355 4441  a:..        CUDA
-00001810: 5f53 5543 4345 5353 203d 2030 0d0a 2020  _SUCCESS = 0..  
-00001820: 2020 2020 2020 4355 5f44 4556 4943 455f        CU_DEVICE_
-00001830: 4154 5452 4942 5554 455f 4d55 4c54 4950  ATTRIBUTE_MULTIP
-00001840: 524f 4345 5353 4f52 5f43 4f55 4e54 203d  ROCESSOR_COUNT =
-00001850: 2031 360d 0a20 2020 2020 2020 2043 555f   16..        CU_
-00001860: 4445 5649 4345 5f41 5454 5249 4255 5445  DEVICE_ATTRIBUTE
-00001870: 5f4d 4158 5f54 4852 4541 4453 5f50 4552  _MAX_THREADS_PER
-00001880: 5f4d 554c 5449 5052 4f43 4553 534f 5220  _MULTIPROCESSOR 
-00001890: 3d20 3339 0d0a 2020 2020 2020 2020 4355  = 39..        CU
-000018a0: 5f44 4556 4943 455f 4154 5452 4942 5554  _DEVICE_ATTRIBUT
-000018b0: 455f 434c 4f43 4b5f 5241 5445 203d 2031  E_CLOCK_RATE = 1
-000018c0: 330d 0a20 2020 2020 2020 2043 555f 4445  3..        CU_DE
-000018d0: 5649 4345 5f41 5454 5249 4255 5445 5f4d  VICE_ATTRIBUTE_M
-000018e0: 454d 4f52 595f 434c 4f43 4b5f 5241 5445  EMORY_CLOCK_RATE
-000018f0: 203d 2033 360d 0a0d 0a20 2020 2020 2020   = 36....       
-00001900: 206e 4770 7573 203d 2063 7479 7065 732e   nGpus = ctypes.
-00001910: 635f 696e 7428 290d 0a20 2020 2020 2020  c_int()..       
-00001920: 206e 616d 6520 3d20 6227 2027 202a 2031   name = b' ' * 1
-00001930: 3030 0d0a 2020 2020 2020 2020 6363 5f6d  00..        cc_m
-00001940: 616a 6f72 203d 2063 7479 7065 732e 635f  ajor = ctypes.c_
-00001950: 696e 7428 290d 0a20 2020 2020 2020 2063  int()..        c
-00001960: 635f 6d69 6e6f 7220 3d20 6374 7970 6573  c_minor = ctypes
-00001970: 2e63 5f69 6e74 2829 0d0a 2020 2020 2020  .c_int()..      
-00001980: 2020 636f 7265 7320 3d20 6374 7970 6573    cores = ctypes
-00001990: 2e63 5f69 6e74 2829 0d0a 2020 2020 2020  .c_int()..      
-000019a0: 2020 7468 7265 6164 735f 7065 725f 636f    threads_per_co
-000019b0: 7265 203d 2063 7479 7065 732e 635f 696e  re = ctypes.c_in
-000019c0: 7428 290d 0a20 2020 2020 2020 2063 6c6f  t()..        clo
-000019d0: 636b 7261 7465 203d 2063 7479 7065 732e  ckrate = ctypes.
-000019e0: 635f 696e 7428 290d 0a20 2020 2020 2020  c_int()..       
-000019f0: 2066 7265 654d 656d 203d 2063 7479 7065   freeMem = ctype
-00001a00: 732e 635f 7369 7a65 5f74 2829 0d0a 2020  s.c_size_t()..  
-00001a10: 2020 2020 2020 746f 7461 6c4d 656d 203d        totalMem =
-00001a20: 2063 7479 7065 732e 635f 7369 7a65 5f74   ctypes.c_size_t
-00001a30: 2829 0d0a 0d0a 2020 2020 2020 2020 7265  ()....        re
-00001a40: 7375 6c74 203d 2063 7479 7065 732e 635f  sult = ctypes.c_
-00001a50: 696e 7428 290d 0a20 2020 2020 2020 2064  int()..        d
-00001a60: 6576 6963 6520 3d20 6374 7970 6573 2e63  evice = ctypes.c
-00001a70: 5f69 6e74 2829 0d0a 2020 2020 2020 2020  _int()..        
-00001a80: 636f 6e74 6578 7420 3d20 6374 7970 6573  context = ctypes
-00001a90: 2e63 5f76 6f69 645f 7028 290d 0a20 2020  .c_void_p()..   
-00001aa0: 2020 2020 2065 7272 6f72 5f73 7472 203d       error_str =
-00001ab0: 2063 7479 7065 732e 635f 6368 6172 5f70   ctypes.c_char_p
-00001ac0: 2829 0d0a 0d0a 2020 2020 2020 2020 7265  ()....        re
-00001ad0: 7375 6c74 3d63 7564 612e 6375 496e 6974  sult=cuda.cuInit
-00001ae0: 2830 290d 0a20 2020 2020 2020 2069 6628  (0)..        if(
-00001af0: 7265 7375 6c74 2021 3d20 4355 4441 5f53  result != CUDA_S
-00001b00: 5543 4345 5353 293a 0d0a 2020 2020 2020  UCCESS):..      
-00001b10: 2020 2020 2020 7072 696e 7428 2265 7272        print("err
-00001b20: 6f72 2025 6420 2220 2520 2872 6573 756c  or %d " % (resul
-00001b30: 7429 290d 0a20 2020 2020 2020 2020 2020  t))..           
-00001b40: 2072 6574 7572 6e20 300d 0a20 2020 2020   return 0..     
-00001b50: 2020 200d 0a20 2020 2020 2020 2069 6628     ..        if(
-00001b60: 6375 6461 2e63 7544 6576 6963 6547 6574  cuda.cuDeviceGet
-00001b70: 436f 756e 7428 6374 7970 6573 2e62 7972  Count(ctypes.byr
-00001b80: 6566 286e 4770 7573 2929 2021 3d20 4355  ef(nGpus)) != CU
-00001b90: 4441 5f53 5543 4345 5353 293a 0d0a 2020  DA_SUCCESS):..  
-00001ba0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00001bb0: 2030 0d0a 0d0a 2020 2020 2020 2020 666f   0....        fo
-00001bc0: 7220 6920 696e 2072 616e 6765 286e 4770  r i in range(nGp
-00001bd0: 7573 2e76 616c 7565 293a 0d0a 0d0a 2020  us.value):....  
-00001be0: 2020 2020 2020 2020 2020 2320 6765 7420            # get 
-00001bf0: 6465 7669 6365 0d0a 2020 2020 2020 2020  device..        
+000004f0: 2020 2020 2020 2020 2020 2023 2320 6f6e             ## on
+00000500: 6c79 206e 6f74 6966 7920 6966 2075 6964  ly notify if uid
+00000510: 2069 6e20 7468 6520 6669 6c65 6e61 6d65   in the filename
+00000520: 2028 6f74 6865 7277 6973 6520 7765 2061   (otherwise we a
+00000530: 7265 2067 6574 7469 6e67 206e 6f74 6966  re getting notif
+00000540: 6965 6420 6f66 2061 6e6f 7468 6572 2041  ied of another A
+00000550: 4927 7320 6a6f 6220 2129 0d0a 2020 2020  I's job !)..    
+00000560: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00000570: 5f61 7267 735b 222d 7569 6422 5d20 696e  _args["-uid"] in
+00000580: 2065 7665 6e74 2e73 7263 5f70 6174 683a   event.src_path:
+00000590: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000005a0: 2020 7365 6c66 2e66 6e4f 6e46 696c 6543    self.fnOnFileC
+000005b0: 7265 6174 6564 286f 732e 7061 7468 2e64  reated(os.path.d
+000005c0: 6972 6e61 6d65 2865 7665 6e74 2e73 7263  irname(event.src
+000005d0: 5f70 6174 6829 2c20 6f73 2e70 6174 682e  _path), os.path.
+000005e0: 6261 7365 6e61 6d65 2865 7665 6e74 2e73  basename(event.s
+000005f0: 7263 5f70 6174 6829 2c20 7365 6c66 2e5f  rc_path), self._
+00000600: 6172 6773 290d 0a0d 0a64 6566 2073 7461  args)....def sta
+00000610: 7274 5f6f 6273 6572 7665 725f 7468 7265  rt_observer_thre
+00000620: 6164 2870 6174 682c 2066 6e4f 6e46 696c  ad(path, fnOnFil
+00000630: 6543 7265 6174 6564 2c20 5f61 7267 7329  eCreated, _args)
+00000640: 3a0d 0a0d 0a20 2020 2023 2320 7761 7463  :....    ## watc
+00000650: 6820 6469 7265 6374 6f72 7920 616e 6420  h directory and 
+00000660: 6361 6c6c 2062 6163 6b20 6966 2066 696c  call back if fil
+00000670: 6520 7761 7320 6372 6561 7465 640d 0a20  e was created.. 
+00000680: 2020 2064 6566 2077 6174 6368 5f64 6972     def watch_dir
+00000690: 6563 746f 7279 2870 6174 682c 2066 6e4f  ectory(path, fnO
+000006a0: 6e46 696c 6543 7265 6174 6564 2c20 5f61  nFileCreated, _a
+000006b0: 7267 7329 3a20 2020 200d 0a20 2020 2020  rgs):    ..     
+000006c0: 2020 2067 6c6f 6261 6c20 674f 6273 6572     global gObser
+000006d0: 7665 720d 0a20 2020 2020 2020 2069 6620  ver..        if 
+000006e0: 674f 6273 6572 7665 7221 3d4e 6f6e 653a  gObserver!=None:
+000006f0: 0d0a 2020 2020 2020 2020 2020 2020 674f  ..            gO
+00000700: 6273 6572 7665 722e 7374 6f70 2829 0d0a  bserver.stop()..
+00000710: 2020 2020 2020 2020 6576 656e 745f 6861          event_ha
+00000720: 6e64 6c65 7220 3d20 4e65 7746 696c 6548  ndler = NewFileH
+00000730: 616e 646c 6572 2866 6e4f 6e46 696c 6543  andler(fnOnFileC
+00000740: 7265 6174 6564 2c20 5f61 7267 7329 0d0a  reated, _args)..
+00000750: 2020 2020 2020 2020 674f 6273 6572 7665          gObserve
+00000760: 7220 3d20 4f62 7365 7276 6572 2829 0d0a  r = Observer()..
+00000770: 2020 2020 2020 2020 674f 6273 6572 7665          gObserve
+00000780: 722e 7363 6865 6475 6c65 2865 7665 6e74  r.schedule(event
+00000790: 5f68 616e 646c 6572 2c20 7061 7468 2c20  _handler, path, 
+000007a0: 7265 6375 7273 6976 653d 4661 6c73 6529  recursive=False)
+000007b0: 0d0a 2020 2020 2020 2020 674f 6273 6572  ..        gObser
+000007c0: 7665 722e 7374 6172 7428 290d 0a20 2020  ver.start()..   
+000007d0: 2020 2020 2067 4f62 7365 7276 6572 2e6a       gObserver.j
+000007e0: 6f69 6e28 3129 0d0a 0d0a 2020 2020 7468  oin(1)....    th
+000007f0: 7265 6164 203d 2074 6872 6561 6469 6e67  read = threading
+00000800: 2e54 6872 6561 6428 7461 7267 6574 3d77  .Thread(target=w
+00000810: 6174 6368 5f64 6972 6563 746f 7279 2c20  atch_directory, 
+00000820: 6172 6773 3d28 7061 7468 2c20 666e 4f6e  args=(path, fnOn
+00000830: 4669 6c65 4372 6561 7465 642c 205f 6172  FileCreated, _ar
+00000840: 6773 2929 0d0a 2020 2020 7468 7265 6164  gs))..    thread
+00000850: 2e73 7461 7274 2829 0d0a 2020 2020 7265  .start()..    re
+00000860: 7475 726e 2077 6174 6368 5f64 6972 6563  turn watch_direc
+00000870: 746f 7279 0d0a 0d0a 6465 6620 7374 6172  tory....def star
+00000880: 745f 6e6f 7469 6669 6361 7469 6f6e 5f74  t_notification_t
+00000890: 6872 6561 6428 666e 4f6e 4e6f 7469 6679  hread(fnOnNotify
+000008a0: 293a 0d0a 2020 2020 6465 6620 5f72 756e  ):..    def _run
+000008b0: 285f 666e 293a 0d0a 2020 2020 2020 2020  (_fn):..        
+000008c0: 5f66 6e28 290d 0a20 2020 2074 6872 6561  _fn()..    threa
+000008d0: 6420 3d20 7468 7265 6164 696e 672e 5468  d = threading.Th
+000008e0: 7265 6164 2874 6172 6765 743d 5f72 756e  read(target=_run
+000008f0: 2c20 6172 6773 3d28 666e 4f6e 4e6f 7469  , args=(fnOnNoti
+00000900: 6679 2929 0d0a 2020 2020 7468 7265 6164  fy))..    thread
+00000910: 2e73 7461 7274 2829 0d0a 2020 2020 7265  .start()..    re
+00000920: 7475 726e 205f 7275 6e0d 0a0d 0a23 2320  turn _run....## 
+00000930: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000940: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000950: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000960: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000970: 2d2d 2d2d 2d2d 2d2d 0d0a 2320 2020 2020  --------..#     
+00000980: 2020 4469 7265 6374 6f72 7920 7574 696c    Directory util
+00000990: 730d 0a23 2320 2d2d 2d2d 2d2d 2d2d 2d2d  s..## ----------
+000009a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000009b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000009c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000009d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  --------------..
+000009e0: 0d0a 2323 206c 6973 7420 636f 6e74 656e  ..## list conten
+000009f0: 7420 6f66 2061 2064 6972 6563 746f 7279  t of a directory
+00000a00: 0d0a 6465 6620 6c69 7374 4469 7243 6f6e  ..def listDirCon
+00000a10: 7465 6e74 285f 6469 7229 3a0d 0a20 2020  tent(_dir):..   
+00000a20: 2066 726f 6d20 6f73 2e70 6174 6820 696d   from os.path im
+00000a30: 706f 7274 2069 7366 696c 652c 206a 6f69  port isfile, joi
+00000a40: 6e0d 0a20 2020 206f 6e6c 7966 696c 6573  n..    onlyfiles
+00000a50: 203d 205b 6620 666f 7220 6620 696e 206f   = [f for f in o
+00000a60: 732e 6c69 7374 6469 7228 5f64 6972 295d  s.listdir(_dir)]
+00000a70: 0d0a 2020 2020 7265 743d 2246 6f75 6e64  ..    ret="Found
+00000a80: 2022 2b73 7472 2028 6c65 6e28 6f6e 6c79   "+str (len(only
+00000a90: 6669 6c65 7329 2920 2b20 2220 6669 6c65  files)) + " file
+00000aa0: 7320 696e 2070 6174 6820 222b 5f64 6972  s in path "+_dir
+00000ab0: 2b22 3c62 723e 3c62 723e 223b 0d0a 2020  +"<br><br>";..  
+00000ac0: 2020 666f 7220 7820 696e 206f 6e6c 7966    for x in onlyf
+00000ad0: 696c 6573 3a0d 0a20 2020 2020 2020 2069  iles:..        i
+00000ae0: 6620 6973 6669 6c65 286a 6f69 6e28 5f64  f isfile(join(_d
+00000af0: 6972 2c20 7829 293a 0d0a 2020 2020 2020  ir, x)):..      
+00000b00: 2020 2020 2020 7265 7420 3d20 7265 742b        ret = ret+
+00000b10: 782b 223c 6272 3e22 0d0a 2020 2020 2020  x+"<br>"..      
+00000b20: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00000b30: 2020 2020 2072 6574 203d 2072 6574 2b22       ret = ret+"
+00000b40: 2e2f 222b 782b 223c 6272 3e22 0d0a 0d0a  ./"+x+"<br>"....
+00000b50: 2020 2020 6672 6f6d 2064 6174 6574 696d      from datetim
+00000b60: 6520 696d 706f 7274 2064 6174 6574 696d  e import datetim
+00000b70: 650d 0a20 2020 206e 6f77 203d 2064 6174  e..    now = dat
+00000b80: 6574 696d 652e 6e6f 7728 290d 0a20 2020  etime.now()..   
+00000b90: 2064 745f 7374 7269 6e67 203d 206e 6f77   dt_string = now
+00000ba0: 2e73 7472 6674 696d 6528 2225 642f 256d  .strftime("%d/%m
+00000bb0: 2f25 5920 2548 3a25 4d3a 2553 2229 0d0a  /%Y %H:%M:%S")..
+00000bc0: 2020 2020 7265 7475 726e 2064 745f 7374      return dt_st
+00000bd0: 7269 6e67 2b22 3c62 723e 222b 7265 740d  ring+"<br>"+ret.
+00000be0: 0a0d 0a64 6566 2063 6c65 6172 4f6c 6446  ...def clearOldF
+00000bf0: 696c 6573 285f 6469 7229 3a20 200d 0a20  iles(_dir):  .. 
+00000c00: 2020 2066 726f 6d20 6461 7465 7469 6d65     from datetime
+00000c10: 2069 6d70 6f72 7420 7469 6d65 6465 6c74   import timedelt
+00000c20: 610d 0a20 2020 2066 726f 6d20 6461 7465  a..    from date
+00000c30: 7469 6d65 2069 6d70 6f72 7420 6461 7465  time import date
+00000c40: 7469 6d65 0d0a 2020 2020 5f6e 6f77 3d64  time..    _now=d
+00000c50: 6174 6574 696d 652e 6e6f 7728 290d 0a20  atetime.now().. 
+00000c60: 2020 2063 7574 6f66 665f 7469 6d65 203d     cutoff_time =
+00000c70: 205f 6e6f 7720 2d20 7469 6d65 6465 6c74   _now - timedelt
+00000c80: 6128 6d69 6e75 7465 733d 3130 290d 0a20  a(minutes=10).. 
+00000c90: 2020 2066 6f72 2066 696c 656e 616d 6520     for filename 
+00000ca0: 696e 206f 732e 6c69 7374 6469 7228 5f64  in os.listdir(_d
+00000cb0: 6972 293a 0d0a 2020 2020 2020 2020 6669  ir):..        fi
+00000cc0: 6c65 5f70 6174 6820 3d20 6f73 2e70 6174  le_path = os.pat
+00000cd0: 682e 6a6f 696e 285f 6469 722c 2066 696c  h.join(_dir, fil
+00000ce0: 656e 616d 6529 0d0a 2020 2020 2020 2020  ename)..        
+00000cf0: 6d6f 6469 6669 6361 7469 6f6e 5f74 696d  modification_tim
+00000d00: 6520 3d20 6461 7465 7469 6d65 2e66 726f  e = datetime.fro
+00000d10: 6d74 696d 6573 7461 6d70 286f 732e 7061  mtimestamp(os.pa
+00000d20: 7468 2e67 6574 6d74 696d 6528 6669 6c65  th.getmtime(file
+00000d30: 5f70 6174 6829 290d 0a20 2020 2020 2020  _path))..       
+00000d40: 2069 6620 6d6f 6469 6669 6361 7469 6f6e   if modification
+00000d50: 5f74 696d 6520 3c20 6375 746f 6666 5f74  _time < cutoff_t
+00000d60: 696d 653a 0d0a 2020 2020 2020 2020 2020  ime:..          
+00000d70: 2020 6f73 2e72 656d 6f76 6528 6669 6c65    os.remove(file
+00000d80: 5f70 6174 6829 0d0a 2020 2020 2020 2020  _path)..        
+00000d90: 2020 2020 0d0a 2323 202d 2d2d 2d2d 2d2d      ..## -------
+00000da0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000db0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000dc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000dd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000de0: 2d0d 0a23 2020 2020 2020 2053 7973 7465  -..#       Syste
+00000df0: 6d20 7574 696c 730d 0a23 2320 2d2d 2d2d  m utils..## ----
+00000e00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000e10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000e20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000e30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00000e40: 2d2d 2d2d 0d0a 0d0a 2323 2067 6574 2061  ----....## get a
+00000e50: 206d 6561 6e69 6e67 6675 6c20 6e61 6d65   meaningful name
+00000e60: 2066 6f72 206f 7572 206d 6163 6869 6e65   for our machine
+00000e70: 0d0a 6465 6620 6765 745f 6d61 6368 696e  ..def get_machin
+00000e80: 655f 6e61 6d65 2829 203a 0d0a 2020 2020  e_name() :..    
+00000e90: 5f6d 6163 6869 6e65 3d73 7472 2028 6865  _machine=str (he
+00000ea0: 7828 7575 6964 2e67 6574 6e6f 6465 2829  x(uuid.getnode()
+00000eb0: 2929 0d0a 2020 2020 5f69 7344 6f63 6b65  ))..    _isDocke
+00000ec0: 723d 6973 5f72 756e 6e69 6e67 5f69 6e5f  r=is_running_in_
+00000ed0: 646f 636b 6572 2829 0d0a 2020 2020 6966  docker()..    if
+00000ee0: 205f 6973 446f 636b 6572 3a0d 0a20 2020   _isDocker:..   
+00000ef0: 2020 2020 205f 6d61 6368 696e 6520 3d20       _machine = 
+00000f00: 6f73 2e65 6e76 6972 6f6e 2e67 6574 2827  os.environ.get('
+00000f10: 484f 5354 4e41 4d45 2729 206f 7220 6f73  HOSTNAME') or os
+00000f20: 2e70 6f70 656e 2827 686f 7374 6e61 6d65  .popen('hostname
+00000f30: 2729 2e72 6561 6428 292e 7374 7269 7028  ').read().strip(
+00000f40: 290d 0a20 2020 2072 6574 7572 6e20 5f6d  )..    return _m
+00000f50: 6163 6869 6e65 0d0a 0d0a 2323 2077 6869  achine....## whi
+00000f60: 6368 204f 5320 6172 6520 7765 2072 756e  ch OS are we run
+00000f70: 6e69 6e67 206f 6e3f 0d0a 6465 6620 6765  ning on?..def ge
+00000f80: 745f 6f73 5f6e 616d 6528 293a 0d0a 2020  t_os_name():..  
+00000f90: 2020 6f73 5f6e 616d 6520 3d20 706c 6174    os_name = plat
+00000fa0: 666f 726d 2e73 7973 7465 6d28 290d 0a20  form.system().. 
+00000fb0: 2020 2072 6574 7572 6e20 6f73 5f6e 616d     return os_nam
+00000fc0: 650d 0a0d 0a23 2320 4172 6520 7765 2072  e....## Are we r
+00000fd0: 756e 6e69 6e67 2069 6e73 6964 6520 6120  unning inside a 
+00000fe0: 646f 636b 6572 2073 6573 7369 6f6e 3f0d  docker session?.
+00000ff0: 0a64 6566 2069 735f 7275 6e6e 696e 675f  .def is_running_
+00001000: 696e 5f64 6f63 6b65 7228 293a 0d0a 2020  in_docker():..  
+00001010: 2020 6966 206f 732e 7061 7468 2e65 7869    if os.path.exi
+00001020: 7374 7328 272f 7072 6f63 2f73 656c 662f  sts('/proc/self/
+00001030: 6367 726f 7570 2729 3a0d 0a20 2020 2020  cgroup'):..     
+00001040: 2020 2077 6974 6820 6f70 656e 2827 2f70     with open('/p
+00001050: 726f 632f 7365 6c66 2f63 6772 6f75 7027  roc/self/cgroup'
+00001060: 2c20 2772 7427 2920 6173 2066 3a0d 0a20  , 'rt') as f:.. 
+00001070: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00001080: 6e20 2764 6f63 6b65 7227 2069 6e20 662e  n 'docker' in f.
+00001090: 7265 6164 2829 0d0a 2020 2020 7265 7475  read()..    retu
+000010a0: 726e 2046 616c 7365 0d0a 0d0a 2323 2067  rn False....## g
+000010b0: 6574 2069 7020 6164 6472 6573 7320 6f66  et ip address of
+000010c0: 2074 6865 2068 6f73 740d 0a64 6566 2067   the host..def g
+000010d0: 6574 5f63 6f6e 7461 696e 6572 5f69 7028  et_container_ip(
+000010e0: 293a 0d0a 2020 2020 696d 706f 7274 2073  ):..    import s
+000010f0: 6f63 6b65 740d 0a0d 0a20 2020 2023 2047  ocket....    # G
+00001100: 6574 2074 6865 2068 6f73 746e 616d 6520  et the hostname 
+00001110: 6f66 2074 6865 206d 6163 6869 6e65 2072  of the machine r
+00001120: 756e 6e69 6e67 2074 6865 2073 6372 6970  unning the scrip
+00001130: 740d 0a20 2020 2068 6f73 746e 616d 6520  t..    hostname 
+00001140: 3d20 736f 636b 6574 2e67 6574 686f 7374  = socket.gethost
+00001150: 6e61 6d65 2829 0d0a 0d0a 2020 2020 2320  name()....    # 
+00001160: 4765 7420 7468 6520 4950 2061 6464 7265  Get the IP addre
+00001170: 7373 206f 6620 7468 6520 636f 6e74 6169  ss of the contai
+00001180: 6e65 7220 6279 2072 6573 6f6c 7669 6e67  ner by resolving
+00001190: 2074 6865 2068 6f73 746e 616d 650d 0a20   the hostname.. 
+000011a0: 2020 2069 705f 6164 6472 6573 7320 3d20     ip_address = 
+000011b0: 736f 636b 6574 2e67 6574 686f 7374 6279  socket.gethostby
+000011c0: 6e61 6d65 2868 6f73 746e 616d 6529 0d0a  name(hostname)..
+000011d0: 2020 2020 7265 7475 726e 2069 705f 6164      return ip_ad
+000011e0: 6472 6573 730d 0a0d 0a23 2320 6765 7420  dress....## get 
+000011f0: 6f75 7220 6578 7465 726e 616c 2069 7020  our external ip 
+00001200: 6164 6472 6573 730d 0a64 6566 2067 6574  address..def get
+00001210: 5f65 7874 6572 6e61 6c5f 6970 2829 3a0d  _external_ip():.
+00001220: 0a20 2020 2069 6d70 6f72 7420 7265 7175  .    import requ
+00001230: 6573 7473 0d0a 2020 2020 7572 6c20 3d20  ests..    url = 
+00001240: 2268 7474 7073 3a2f 2f61 7069 2e69 7069  "https://api.ipi
+00001250: 6679 2e6f 7267 220d 0a20 2020 2072 6573  fy.org"..    res
+00001260: 706f 6e73 6520 3d20 7265 7175 6573 7473  ponse = requests
+00001270: 2e67 6574 2875 726c 290d 0a20 2020 2072  .get(url)..    r
+00001280: 6574 7572 6e20 7265 7370 6f6e 7365 2e74  eturn response.t
+00001290: 6578 742e 7374 7269 7028 290d 0a0d 0a23  ext.strip()....#
+000012a0: 2320 6765 7420 6f75 7220 6578 7465 726e  # get our extern
+000012b0: 616c 2070 6f72 740d 0a64 6566 2067 6574  al port..def get
+000012c0: 5f70 6f72 7428 293a 200d 0a20 2020 2069  _port(): ..    i
+000012d0: 6d70 6f72 7420 736f 636b 6574 0d0a 2020  mport socket..  
+000012e0: 2020 736f 636b 203d 2073 6f63 6b65 742e    sock = socket.
+000012f0: 736f 636b 6574 2873 6f63 6b65 742e 4146  socket(socket.AF
+00001300: 5f49 4e45 542c 2073 6f63 6b65 742e 534f  _INET, socket.SO
+00001310: 434b 5f53 5452 4541 4d29 0d0a 2020 2020  CK_STREAM)..    
+00001320: 736f 636b 2e62 696e 6428 2827 6c6f 6361  sock.bind(('loca
+00001330: 6c68 6f73 7427 2c20 3029 290d 0a20 2020  lhost', 0))..   
+00001340: 2070 6f72 7420 3d20 736f 636b 2e67 6574   port = sock.get
+00001350: 736f 636b 6e61 6d65 2829 5b31 5d0d 0a20  sockname()[1].. 
+00001360: 2020 2072 6574 7572 6e20 706f 7274 0d0a     return port..
+00001370: 0d0a 2323 206a 7573 7420 746f 2067 6574  ..## just to get
+00001380: 2074 6865 206c 6973 7420 6f66 2061 6c6c   the list of all
+00001390: 2069 6e73 7461 6c6c 6564 2050 7974 686f   installed Pytho
+000013a0: 6e20 6d6f 6475 6c65 7320 696e 2074 6865  n modules in the
+000013b0: 2072 756e 6e69 6e67 2073 6573 7369 6f6e   running session
+000013c0: 0d0a 6465 6620 6765 745f 6c69 7374 5f6f  ..def get_list_o
+000013d0: 665f 6d6f 6475 6c65 7328 293a 0d0a 2020  f_modules():..  
+000013e0: 2020 696e 7374 616c 6c65 645f 7061 636b    installed_pack
+000013f0: 6167 6573 203d 2070 6b67 5f72 6573 6f75  ages = pkg_resou
+00001400: 7263 6573 2e77 6f72 6b69 6e67 5f73 6574  rces.working_set
+00001410: 0d0a 2020 2020 696e 7374 616c 6c65 645f  ..    installed_
+00001420: 7061 636b 6167 6573 5f6c 6973 743d 5b5d  packages_list=[]
+00001430: 0d0a 2020 2020 666f 7220 6920 696e 2069  ..    for i in i
+00001440: 6e73 7461 6c6c 6564 5f70 6163 6b61 6765  nstalled_package
+00001450: 733a 0d0a 2020 2020 2020 2020 696e 7374  s:..        inst
+00001460: 616c 6c65 645f 7061 636b 6167 6573 5f6c  alled_packages_l
+00001470: 6973 742e 6170 7065 6e64 287b 692e 6b65  ist.append({i.ke
+00001480: 793a 2069 2e76 6572 7369 6f6e 7d29 0d0a  y: i.version})..
+00001490: 2020 2020 7265 7475 726e 2069 6e73 7461      return insta
+000014a0: 6c6c 6564 5f70 6163 6b61 6765 735f 6c69  lled_packages_li
+000014b0: 7374 0d0a 0d0a 2323 202d 2d2d 2d2d 2d2d  st....## -------
+000014c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000014d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000014e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000014f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001500: 2d0d 0a23 2020 2020 2020 2047 5055 2075  -..#       GPU u
+00001510: 7469 6c73 0d0a 2323 202d 2d2d 2d2d 2d2d  tils..## -------
+00001520: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001530: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001540: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001550: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00001560: 2d0d 0a0d 0a23 2320 7768 6963 6820 4750  -....## which GP
+00001570: 5520 6973 2074 6869 733f 2028 7769 6c6c  U is this? (will
+00001580: 2072 6571 7569 7265 2061 6363 6573 7320   require access 
+00001590: 746f 206e 7669 6469 612d 736d 6929 0d0a  to nvidia-smi)..
+000015a0: 6465 6620 6765 745f 6770 755f 6174 7472  def get_gpu_attr
+000015b0: 285f 6174 7472 293a 0d0a 2020 206f 7574  (_attr):..   out
+000015c0: 7075 745f 746f 5f6c 6973 7420 3d20 6c61  put_to_list = la
+000015d0: 6d62 6461 2078 3a20 782e 6465 636f 6465  mbda x: x.decode
+000015e0: 2827 6173 6369 6927 292e 7370 6c69 7428  ('ascii').split(
+000015f0: 275c 6e27 295b 3a2d 315d 0d0a 2020 2043  '\n')[:-1]..   C
+00001600: 4f4d 4d41 4e44 203d 2022 6e76 6964 6961  OMMAND = "nvidia
+00001610: 2d73 6d69 202d 2d71 7565 7279 2d67 7075  -smi --query-gpu
+00001620: 3d22 2b5f 6174 7472 2b22 202d 2d66 6f72  ="+_attr+" --for
+00001630: 6d61 743d 6373 7622 0d0a 2020 2074 7279  mat=csv"..   try
+00001640: 3a0d 0a20 2020 2020 2020 206d 656d 6f72  :..        memor
+00001650: 795f 7573 655f 696e 666f 203d 206f 7574  y_use_info = out
+00001660: 7075 745f 746f 5f6c 6973 7428 7370 2e63  put_to_list(sp.c
+00001670: 6865 636b 5f6f 7574 7075 7428 434f 4d4d  heck_output(COMM
+00001680: 414e 442e 7370 6c69 7428 292c 7374 6465  AND.split(),stde
+00001690: 7272 3d73 702e 5354 444f 5554 2929 5b31  rr=sp.STDOUT))[1
+000016a0: 3a5d 0d0a 2020 2065 7863 6570 7420 7370  :]..   except sp
+000016b0: 2e43 616c 6c65 6450 726f 6365 7373 4572  .CalledProcessEr
+000016c0: 726f 7220 6173 2065 3a0d 0a20 2020 2020  ror as e:..     
+000016d0: 2020 2072 6169 7365 2052 756e 7469 6d65     raise Runtime
+000016e0: 4572 726f 7228 2263 6f6d 6d61 6e64 2027  Error("command '
+000016f0: 7b7d 2720 7265 7475 726e 2077 6974 6820  {}' return with 
+00001700: 6572 726f 7220 2863 6f64 6520 7b7d 293a  error (code {}):
+00001710: 207b 7d22 2e66 6f72 6d61 7428 652e 636d   {}".format(e.cm
+00001720: 642c 2065 2e72 6574 7572 6e63 6f64 652c  d, e.returncode,
+00001730: 2065 2e6f 7574 7075 7429 290d 0a20 2020   e.output))..   
+00001740: 6d65 6d6f 7279 5f75 7365 5f76 616c 7565  memory_use_value
+00001750: 7320 3d20 5b78 2e72 6570 6c61 6365 2827  s = [x.replace('
+00001760: 5c72 272c 2027 2729 2066 6f72 2069 2c20  \r', '') for i, 
+00001770: 7820 696e 2065 6e75 6d65 7261 7465 286d  x in enumerate(m
+00001780: 656d 6f72 795f 7573 655f 696e 666f 295d  emory_use_info)]
+00001790: 0d0a 2020 2072 6574 7572 6e20 6d65 6d6f  ..   return memo
+000017a0: 7279 5f75 7365 5f76 616c 7565 730d 0a0d  ry_use_values...
+000017b0: 0a0d 0a23 2320 6765 7420 4750 5520 4375  ...## get GPU Cu
+000017c0: 6461 2069 6e66 6f0d 0a23 2073 6565 2068  da info..# see h
+000017d0: 6572 653a 2068 7474 7073 3a2f 2f67 6973  ere: https://gis
+000017e0: 742e 6769 7468 7562 2e63 6f6d 2f74 6973  t.github.com/tis
+000017f0: 7072 6174 696b 2f34 3261 3731 6361 6533  pratik/42a71cae3
+00001800: 3433 3839 6664 3763 3865 3839 3439 3661  4389fd7c8e89496a
+00001810: 6538 3831 3361 650d 0a64 6566 2067 6574  e8813ae..def get
+00001820: 4375 6461 496e 666f 2829 3a0d 0a20 2020  CudaInfo():..   
+00001830: 200d 0a20 2020 2064 6973 706c 6179 5f6e   ..    display_n
+00001840: 616d 6520 3d20 226e 6f20 4750 5522 0d0a  ame = "no GPU"..
+00001850: 2020 2020 6469 7370 6c61 795f 636f 7265      display_core
+00001860: 7320 3d20 2230 220d 0a20 2020 2064 6973  s = "0"..    dis
+00001870: 706c 6179 5f6d 616a 6f72 203d 2022 3022  play_major = "0"
+00001880: 0d0a 2020 2020 6469 7370 6c61 795f 6d69  ..    display_mi
+00001890: 6e6f 7220 3d20 2230 220d 0a0d 0a20 2020  nor = "0"....   
+000018a0: 2069 6620 6375 6461 3a0d 0a20 2020 2020   if cuda:..     
+000018b0: 2020 2043 5544 415f 5355 4343 4553 5320     CUDA_SUCCESS 
+000018c0: 3d20 300d 0a20 2020 2020 2020 2043 555f  = 0..        CU_
+000018d0: 4445 5649 4345 5f41 5454 5249 4255 5445  DEVICE_ATTRIBUTE
+000018e0: 5f4d 554c 5449 5052 4f43 4553 534f 525f  _MULTIPROCESSOR_
+000018f0: 434f 554e 5420 3d20 3136 0d0a 2020 2020  COUNT = 16..    
+00001900: 2020 2020 4355 5f44 4556 4943 455f 4154      CU_DEVICE_AT
+00001910: 5452 4942 5554 455f 4d41 585f 5448 5245  TRIBUTE_MAX_THRE
+00001920: 4144 535f 5045 525f 4d55 4c54 4950 524f  ADS_PER_MULTIPRO
+00001930: 4345 5353 4f52 203d 2033 390d 0a20 2020  CESSOR = 39..   
+00001940: 2020 2020 2043 555f 4445 5649 4345 5f41       CU_DEVICE_A
+00001950: 5454 5249 4255 5445 5f43 4c4f 434b 5f52  TTRIBUTE_CLOCK_R
+00001960: 4154 4520 3d20 3133 0d0a 2020 2020 2020  ATE = 13..      
+00001970: 2020 4355 5f44 4556 4943 455f 4154 5452    CU_DEVICE_ATTR
+00001980: 4942 5554 455f 4d45 4d4f 5259 5f43 4c4f  IBUTE_MEMORY_CLO
+00001990: 434b 5f52 4154 4520 3d20 3336 0d0a 0d0a  CK_RATE = 36....
+000019a0: 2020 2020 2020 2020 6e47 7075 7320 3d20          nGpus = 
+000019b0: 6374 7970 6573 2e63 5f69 6e74 2829 0d0a  ctypes.c_int()..
+000019c0: 2020 2020 2020 2020 6e61 6d65 203d 2062          name = b
+000019d0: 2720 2720 2a20 3130 300d 0a20 2020 2020  ' ' * 100..     
+000019e0: 2020 2063 635f 6d61 6a6f 7220 3d20 6374     cc_major = ct
+000019f0: 7970 6573 2e63 5f69 6e74 2829 0d0a 2020  ypes.c_int()..  
+00001a00: 2020 2020 2020 6363 5f6d 696e 6f72 203d        cc_minor =
+00001a10: 2063 7479 7065 732e 635f 696e 7428 290d   ctypes.c_int().
+00001a20: 0a20 2020 2020 2020 2063 6f72 6573 203d  .        cores =
+00001a30: 2063 7479 7065 732e 635f 696e 7428 290d   ctypes.c_int().
+00001a40: 0a20 2020 2020 2020 2074 6872 6561 6473  .        threads
+00001a50: 5f70 6572 5f63 6f72 6520 3d20 6374 7970  _per_core = ctyp
+00001a60: 6573 2e63 5f69 6e74 2829 0d0a 2020 2020  es.c_int()..    
+00001a70: 2020 2020 636c 6f63 6b72 6174 6520 3d20      clockrate = 
+00001a80: 6374 7970 6573 2e63 5f69 6e74 2829 0d0a  ctypes.c_int()..
+00001a90: 2020 2020 2020 2020 6672 6565 4d65 6d20          freeMem 
+00001aa0: 3d20 6374 7970 6573 2e63 5f73 697a 655f  = ctypes.c_size_
+00001ab0: 7428 290d 0a20 2020 2020 2020 2074 6f74  t()..        tot
+00001ac0: 616c 4d65 6d20 3d20 6374 7970 6573 2e63  alMem = ctypes.c
+00001ad0: 5f73 697a 655f 7428 290d 0a0d 0a20 2020  _size_t()....   
+00001ae0: 2020 2020 2072 6573 756c 7420 3d20 6374       result = ct
+00001af0: 7970 6573 2e63 5f69 6e74 2829 0d0a 2020  ypes.c_int()..  
+00001b00: 2020 2020 2020 6465 7669 6365 203d 2063        device = c
+00001b10: 7479 7065 732e 635f 696e 7428 290d 0a20  types.c_int().. 
+00001b20: 2020 2020 2020 2063 6f6e 7465 7874 203d         context =
+00001b30: 2063 7479 7065 732e 635f 766f 6964 5f70   ctypes.c_void_p
+00001b40: 2829 0d0a 2020 2020 2020 2020 6572 726f  ()..        erro
+00001b50: 725f 7374 7220 3d20 6374 7970 6573 2e63  r_str = ctypes.c
+00001b60: 5f63 6861 725f 7028 290d 0a0d 0a20 2020  _char_p()....   
+00001b70: 2020 2020 2072 6573 756c 743d 6375 6461       result=cuda
+00001b80: 2e63 7549 6e69 7428 3029 0d0a 2020 2020  .cuInit(0)..    
+00001b90: 2020 2020 6966 2872 6573 756c 7420 213d      if(result !=
+00001ba0: 2043 5544 415f 5355 4343 4553 5329 3a0d   CUDA_SUCCESS):.
+00001bb0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+00001bc0: 6e74 2822 6572 726f 7220 2564 2022 2025  nt("error %d " %
+00001bd0: 2028 7265 7375 6c74 2929 0d0a 2020 2020   (result))..    
+00001be0: 2020 2020 2020 2020 7265 7475 726e 2030          return 0
+00001bf0: 0d0a 2020 2020 2020 2020 0d0a 2020 2020  ..        ..    
 00001c00: 2020 2020 6966 2863 7564 612e 6375 4465      if(cuda.cuDe
-00001c10: 7669 6365 4765 7428 6374 7970 6573 2e62  viceGet(ctypes.b
-00001c20: 7972 6566 2864 6576 6963 6529 2c20 6929  yref(device), i)
-00001c30: 2021 3d20 4355 4441 5f53 5543 4345 5353   != CUDA_SUCCESS
-00001c40: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00001c50: 2020 2020 7265 7475 726e 2030 0d0a 2020      return 0..  
-00001c60: 2020 2020 2020 2020 2020 6966 2028 6375            if (cu
-00001c70: 6461 2e63 7544 6576 6963 6543 6f6d 7075  da.cuDeviceCompu
-00001c80: 7465 4361 7061 6269 6c69 7479 2863 7479  teCapability(cty
-00001c90: 7065 732e 6279 7265 6628 6363 5f6d 616a  pes.byref(cc_maj
-00001ca0: 6f72 292c 2063 7479 7065 732e 6279 7265  or), ctypes.byre
-00001cb0: 6628 6363 5f6d 696e 6f72 292c 2064 6576  f(cc_minor), dev
-00001cc0: 6963 6529 2021 3d20 4355 4441 5f53 5543  ice) != CUDA_SUC
-00001cd0: 4345 5353 293a 2020 0d0a 2020 2020 2020  CESS):  ..      
-00001ce0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00001cf0: 2030 0d0a 2020 2020 2020 2020 2020 2020   0..            
-00001d00: 6966 2028 6375 6461 2e63 7544 6576 6963  if (cuda.cuDevic
-00001d10: 6547 6574 4e61 6d65 2863 7479 7065 732e  eGetName(ctypes.
-00001d20: 635f 6368 6172 5f70 286e 616d 6529 2c20  c_char_p(name), 
-00001d30: 6c65 6e28 6e61 6d65 292c 2064 6576 6963  len(name), devic
-00001d40: 6529 2021 3d20 4355 4441 5f53 5543 4345  e) != CUDA_SUCCE
-00001d50: 5353 293a 200d 0a20 2020 2020 2020 2020  SS): ..         
-00001d60: 2020 2020 2020 2072 6574 7572 6e20 300d         return 0.
-00001d70: 0a20 2020 2020 2020 2020 2020 2069 6628  .            if(
-00001d80: 6375 6461 2e63 7544 6576 6963 6547 6574  cuda.cuDeviceGet
-00001d90: 4174 7472 6962 7574 6528 6374 7970 6573  Attribute(ctypes
-00001da0: 2e62 7972 6566 2863 6f72 6573 292c 2043  .byref(cores), C
-00001db0: 555f 4445 5649 4345 5f41 5454 5249 4255  U_DEVICE_ATTRIBU
-00001dc0: 5445 5f4d 554c 5449 5052 4f43 4553 534f  TE_MULTIPROCESSO
-00001dd0: 525f 434f 554e 542c 2064 6576 6963 6529  R_COUNT, device)
-00001de0: 2021 3d20 4355 4441 5f53 5543 4345 5353   != CUDA_SUCCESS
-00001df0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00001e00: 2020 2020 7265 7475 726e 2030 0d0a 0d0a      return 0....
-00001e10: 2020 2020 2020 2020 6469 7370 6c61 795f          display_
-00001e20: 6e61 6d65 3d6e 616d 652e 7370 6c69 7428  name=name.split(
-00001e30: 6227 5c30 272c 2031 295b 305d 2e64 6563  b'\0', 1)[0].dec
-00001e40: 6f64 6528 290d 0a20 2020 2020 2020 2064  ode()..        d
-00001e50: 6973 706c 6179 5f6d 616a 6f72 3d63 635f  isplay_major=cc_
-00001e60: 6d61 6a6f 722e 7661 6c75 650d 0a20 2020  major.value..   
-00001e70: 2020 2020 2064 6973 706c 6179 5f6d 696e       display_min
-00001e80: 6f72 3d63 635f 6d69 6e6f 722e 7661 6c75  or=cc_minor.valu
-00001e90: 650d 0a20 2020 2020 2020 2064 6973 706c  e..        displ
-00001ea0: 6179 5f63 6f72 6573 3d63 6f72 6573 2e76  ay_cores=cores.v
-00001eb0: 616c 7565 202a 205f 436f 6e76 6572 7453  alue * _ConvertS
-00001ec0: 4d56 6572 3243 6f72 6573 2863 635f 6d61  MVer2Cores(cc_ma
-00001ed0: 6a6f 722e 7661 6c75 652c 2063 635f 6d69  jor.value, cc_mi
-00001ee0: 6e6f 722e 7661 6c75 6529 0d0a 0d0a 2020  nor.value)....  
-00001ef0: 2020 7265 7475 726e 207b 0d0a 2020 2020    return {..    
-00001f00: 2020 2020 226e 616d 6522 3a20 6469 7370      "name": disp
-00001f10: 6c61 795f 6e61 6d65 2c0d 0a20 2020 2020  lay_name,..     
-00001f20: 2020 2022 636f 6d70 7574 655f 6d61 6a6f     "compute_majo
-00001f30: 7222 3a20 6469 7370 6c61 795f 6d61 6a6f  r": display_majo
-00001f40: 722c 0d0a 2020 2020 2020 2020 2263 6f6d  r,..        "com
-00001f50: 7075 7465 5f6d 696e 6f72 223a 2064 6973  pute_minor": dis
-00001f60: 706c 6179 5f6d 696e 6f72 2c0d 0a20 2020  play_minor,..   
-00001f70: 2020 2020 2022 6375 6461 2063 6f72 6573       "cuda cores
-00001f80: 223a 2064 6973 706c 6179 5f63 6f72 6573  ": display_cores
-00001f90: 200d 0a20 2020 207d 0d0a 0d0a 6465 6620   ..    }....def 
-00001fa0: 5f43 6f6e 7665 7274 534d 5665 7232 436f  _ConvertSMVer2Co
-00001fb0: 7265 7328 6d61 6a6f 722c 206d 696e 6f72  res(major, minor
-00001fc0: 293a 0d0a 2020 2020 2320 5265 7475 726e  ):..    # Return
-00001fd0: 7320 7468 6520 6e75 6d62 6572 206f 6620  s the number of 
-00001fe0: 4355 4441 2063 6f72 6573 2070 6572 206d  CUDA cores per m
-00001ff0: 756c 7469 7072 6f63 6573 736f 7220 666f  ultiprocessor fo
-00002000: 7220 6120 6769 7665 6e0d 0a20 2020 2023  r a given..    #
-00002010: 2043 6f6d 7075 7465 2043 6170 6162 696c   Compute Capabil
-00002020: 6974 7920 7665 7273 696f 6e2e 2054 6865  ity version. The
-00002030: 7265 2069 7320 6e6f 2077 6179 2074 6f20  re is no way to 
-00002040: 7265 7472 6965 7665 2074 6861 7420 7669  retrieve that vi
-00002050: 610d 0a20 2020 2023 2074 6865 2041 5049  a..    # the API
-00002060: 2c20 736f 2069 7420 6e65 6564 7320 746f  , so it needs to
-00002070: 2062 6520 6861 7264 2d63 6f64 6564 2e0d   be hard-coded..
-00002080: 0a20 2020 2072 6574 7572 6e20 7b0d 0a20  .    return {.. 
-00002090: 2020 2023 2054 6573 6c61 0d0a 2020 2020     # Tesla..    
-000020a0: 2020 2831 2c20 3029 3a20 2020 382c 2020    (1, 0):   8,  
-000020b0: 2020 2020 2320 534d 2031 2e30 0d0a 2020      # SM 1.0..  
-000020c0: 2020 2020 2831 2c20 3129 3a20 2020 382c      (1, 1):   8,
-000020d0: 2020 2020 2020 2320 534d 2031 2e31 0d0a        # SM 1.1..
-000020e0: 2020 2020 2020 2831 2c20 3229 3a20 2020        (1, 2):   
-000020f0: 382c 2020 2020 2020 2320 534d 2031 2e32  8,      # SM 1.2
-00002100: 0d0a 2020 2020 2020 2831 2c20 3329 3a20  ..      (1, 3): 
-00002110: 2020 382c 2020 2020 2020 2320 534d 2031    8,      # SM 1
-00002120: 2e33 0d0a 2020 2020 2320 4665 726d 690d  .3..    # Fermi.
-00002130: 0a20 2020 2020 2028 322c 2030 293a 2020  .      (2, 0):  
-00002140: 3332 2c20 2020 2020 2023 2053 4d20 322e  32,      # SM 2.
-00002150: 303a 2047 4631 3030 2063 6c61 7373 0d0a  0: GF100 class..
-00002160: 2020 2020 2020 2832 2c20 3129 3a20 2034        (2, 1):  4
-00002170: 382c 2020 2020 2020 2320 534d 2032 2e31  8,      # SM 2.1
-00002180: 3a20 4746 3130 7820 636c 6173 730d 0a20  : GF10x class.. 
-00002190: 2020 2023 204b 6570 6c65 720d 0a20 2020     # Kepler..   
-000021a0: 2020 2028 332c 2030 293a 2031 3932 2c20     (3, 0): 192, 
-000021b0: 2020 2020 2023 2053 4d20 332e 303a 2047       # SM 3.0: G
-000021c0: 4b31 3078 2063 6c61 7373 0d0a 2020 2020  K10x class..    
-000021d0: 2020 2833 2c20 3229 3a20 3139 322c 2020    (3, 2): 192,  
-000021e0: 2020 2020 2320 534d 2033 2e32 3a20 474b      # SM 3.2: GK
-000021f0: 3130 7820 636c 6173 730d 0a20 2020 2020  10x class..     
-00002200: 2028 332c 2035 293a 2031 3932 2c20 2020   (3, 5): 192,   
-00002210: 2020 2023 2053 4d20 332e 353a 2047 4b31     # SM 3.5: GK1
-00002220: 3178 2063 6c61 7373 0d0a 2020 2020 2020  1x class..      
-00002230: 2833 2c20 3729 3a20 3139 322c 2020 2020  (3, 7): 192,    
-00002240: 2020 2320 534d 2033 2e37 3a20 474b 3231    # SM 3.7: GK21
-00002250: 7820 636c 6173 730d 0a20 2020 2023 204d  x class..    # M
-00002260: 6178 7765 6c6c 0d0a 2020 2020 2020 2835  axwell..      (5
-00002270: 2c20 3029 3a20 3132 382c 2020 2020 2020  , 0): 128,      
-00002280: 2320 534d 2035 2e30 3a20 474d 3130 7820  # SM 5.0: GM10x 
-00002290: 636c 6173 730d 0a20 2020 2020 2028 352c  class..      (5,
-000022a0: 2032 293a 2031 3238 2c20 2020 2020 2023   2): 128,      #
-000022b0: 2053 4d20 352e 323a 2047 4d32 3078 2063   SM 5.2: GM20x c
-000022c0: 6c61 7373 0d0a 2020 2020 2020 2835 2c20  lass..      (5, 
-000022d0: 3329 3a20 3132 382c 2020 2020 2020 2320  3): 128,      # 
-000022e0: 534d 2035 2e33 3a20 474d 3230 7820 636c  SM 5.3: GM20x cl
-000022f0: 6173 730d 0a20 2020 2023 2050 6173 6361  ass..    # Pasca
-00002300: 6c0d 0a20 2020 2020 2028 362c 2030 293a  l..      (6, 0):
-00002310: 2020 3634 2c20 2020 2020 2023 2053 4d20    64,      # SM 
-00002320: 362e 303a 2047 5031 3030 2063 6c61 7373  6.0: GP100 class
-00002330: 0d0a 2020 2020 2020 2836 2c20 3129 3a20  ..      (6, 1): 
-00002340: 3132 382c 2020 2020 2020 2320 534d 2036  128,      # SM 6
-00002350: 2e31 3a20 4750 3130 7820 636c 6173 730d  .1: GP10x class.
-00002360: 0a20 2020 2020 2028 362c 2032 293a 2031  .      (6, 2): 1
-00002370: 3238 2c20 2020 2020 2023 2053 4d20 362e  28,      # SM 6.
-00002380: 323a 2047 5031 3078 2063 6c61 7373 0d0a  2: GP10x class..
-00002390: 2020 2020 2320 566f 6c74 610d 0a20 2020      # Volta..   
-000023a0: 2020 2028 372c 2030 293a 2020 3634 2c20     (7, 0):  64, 
-000023b0: 2020 2020 2023 2053 4d20 372e 303a 2047       # SM 7.0: G
-000023c0: 5631 3030 2063 6c61 7373 0d0a 2020 2020  V100 class..    
-000023d0: 2020 2837 2c20 3229 3a20 2036 342c 2020    (7, 2):  64,  
-000023e0: 2020 2020 2320 534d 2037 2e32 3a20 4756      # SM 7.2: GV
-000023f0: 3131 6220 636c 6173 730d 0a20 2020 2023  11b class..    #
-00002400: 2054 7572 696e 670d 0a20 2020 2020 2028   Turing..      (
-00002410: 372c 2035 293a 2020 3634 2c20 2020 2020  7, 5):  64,     
-00002420: 2023 2053 4d20 372e 353a 2054 5531 3078   # SM 7.5: TU10x
-00002430: 2063 6c61 7373 0d0a 2020 2020 7d2e 6765   class..    }.ge
-00002440: 7428 286d 616a 6f72 2c20 6d69 6e6f 7229  t((major, minor)
-00002450: 2c20 3634 2920 2020 2320 756e 6b6e 6f77  , 64)   # unknow
-00002460: 6e20 6172 6368 6974 6563 7475 7265 2c20  n architecture, 
-00002470: 7265 7475 726e 2061 2064 6566 6175 6c74  return a default
-00002480: 2076 616c 7565 0d0a 0d0a 2323 202d 2d2d   value....## ---
-00002490: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000024a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000024b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000024c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000024d0: 2d2d 2d2d 2d0d 0a23 2020 2020 2020 2067  -----..#       g
-000024e0: 6574 496e 666f 2065 6e64 6f69 6e74 0d0a  etInfo endoint..
-000024f0: 2323 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ## -------------
-00002500: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002510: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002520: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002530: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d 0a23  -----------....#
-00002540: 2320 6765 7420 7661 7269 6f75 7320 696e  # get various in
-00002550: 666f 2061 626f 7574 2074 6869 7320 686f  fo about this ho
-00002560: 7374 0d0a 6465 6620 6765 7448 6f73 7449  st..def getHostI
-00002570: 6e66 6f28 5f65 6e67 696e 6529 3a0d 0a20  nfo(_engine):.. 
-00002580: 2020 2066 726f 6d20 6461 7465 7469 6d65     from datetime
-00002590: 2069 6d70 6f72 7420 6461 7465 7469 6d65   import datetime
-000025a0: 0d0a 2020 2020 6e6f 7720 3d20 6461 7465  ..    now = date
-000025b0: 7469 6d65 2e6e 6f77 2829 0d0a 2020 2020  time.now()..    
-000025c0: 6f62 6a47 5055 3d7b 7d0d 0a20 2020 206f  objGPU={}..    o
-000025d0: 626a 4750 555b 226d 656d 6f72 795f 6672  bjGPU["memory_fr
-000025e0: 6565 225d 3d67 6574 5f67 7075 5f61 7474  ee"]=get_gpu_att
-000025f0: 7228 226d 656d 6f72 792e 6672 6565 2229  r("memory.free")
-00002600: 5b30 5d0d 0a20 2020 206f 626a 4750 555b  [0]..    objGPU[
-00002610: 226d 656d 6f72 795f 7573 6564 225d 3d67  "memory_used"]=g
-00002620: 6574 5f67 7075 5f61 7474 7228 226d 656d  et_gpu_attr("mem
-00002630: 6f72 792e 7573 6564 2229 5b30 5d0d 0a20  ory.used")[0].. 
-00002640: 2020 206f 626a 4750 555b 226e 616d 6522     objGPU["name"
-00002650: 5d3d 6765 745f 6770 755f 6174 7472 2822  ]=get_gpu_attr("
-00002660: 6770 755f 6e61 6d65 2229 5b30 5d0d 0a20  gpu_name")[0].. 
-00002670: 2020 206f 626a 4750 555b 2264 7269 7665     objGPU["drive
-00002680: 725f 7665 7273 696f 6e22 5d3d 6765 745f  r_version"]=get_
-00002690: 6770 755f 6174 7472 2822 6472 6976 6572  gpu_attr("driver
-000026a0: 5f76 6572 7369 6f6e 2229 5b30 5d0d 0a20  _version")[0].. 
-000026b0: 2020 206f 626a 4750 555b 2274 656d 7065     objGPU["tempe
-000026c0: 7261 7475 7265 225d 3d67 6574 5f67 7075  rature"]=get_gpu
-000026d0: 5f61 7474 7228 2274 656d 7065 7261 7475  _attr("temperatu
-000026e0: 7265 2e67 7075 2229 5b30 5d0d 0a20 2020  re.gpu")[0]..   
-000026f0: 206f 626a 4750 555b 2275 7469 6c69 7a61   objGPU["utiliza
-00002700: 7469 6f6e 225d 3d67 6574 5f67 7075 5f61  tion"]=get_gpu_a
-00002710: 7474 7228 2275 7469 6c69 7a61 7469 6f6e  ttr("utilization
-00002720: 2e67 7075 2229 5b30 5d0d 0a0d 0a20 2020  .gpu")[0]....   
-00002730: 206f 626a 4375 6461 3d67 6574 4375 6461   objCuda=getCuda
-00002740: 496e 666f 2829 2020 2020 2020 2020 0d0a  Info()        ..
-00002750: 2020 2020 7265 7475 726e 207b 0d0a 2020      return {..  
-00002760: 2020 2020 2020 2264 6174 6574 696d 6522        "datetime"
-00002770: 3a20 6e6f 772e 7374 7266 7469 6d65 2822  : now.strftime("
-00002780: 2564 2f25 6d2f 2559 2025 483a 254d 3a25  %d/%m/%Y %H:%M:%
-00002790: 5322 292c 200d 0a20 2020 2020 2020 2022  S"), ..        "
-000027a0: 6973 446f 636b 6572 223a 2069 735f 7275  isDocker": is_ru
-000027b0: 6e6e 696e 675f 696e 5f64 6f63 6b65 7228  nning_in_docker(
-000027c0: 292c 0d0a 2020 2020 2020 2020 2269 6e74  ),..        "int
-000027d0: 6572 6e61 6c20 4950 223a 2067 6574 5f63  ernal IP": get_c
-000027e0: 6f6e 7461 696e 6572 5f69 7028 292c 0d0a  ontainer_ip(),..
-000027f0: 2020 2020 2020 2020 2270 6f72 7422 3a20          "port": 
-00002800: 6765 745f 706f 7274 2829 2c0d 0a20 2020  get_port(),..   
-00002810: 2020 2020 2022 656e 6769 6e65 223a 205f       "engine": _
-00002820: 656e 6769 6e65 2c0d 0a20 2020 2020 2020  engine,..       
-00002830: 2022 6d61 6368 696e 6522 3a20 6765 745f   "machine": get_
-00002840: 6d61 6368 696e 655f 6e61 6d65 2829 2c0d  machine_name(),.
-00002850: 0a20 2020 2020 2020 2022 4750 5522 3a20  .        "GPU": 
-00002860: 6f62 6a47 5055 2c0d 0a20 2020 2020 2020  objGPU,..       
-00002870: 2022 4375 6461 223a 206f 626a 4375 6461   "Cuda": objCuda
-00002880: 2c0d 0a20 2020 2020 2020 2022 6d6f 6475  ,..        "modu
-00002890: 6c65 7322 3a20 6765 745f 6c69 7374 5f6f  les": get_list_o
-000028a0: 665f 6d6f 6475 6c65 7328 290d 0a20 2020  f_modules()..   
-000028b0: 207d 0d0a 0d0a 2323 202d 2d2d 2d2d 2d2d   }....## -------
-000028c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000028d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000028e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000028f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002900: 2d0d 0a23 2020 2020 2020 2046 696c 6520  -..#       File 
-00002910: 2f20 496d 6167 6520 7574 696c 730d 0a23  / Image utils..#
-00002920: 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  # --------------
-00002930: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002940: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002950: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002960: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a 2323  ----------....##
-00002970: 2064 6f77 6e6c 6f61 6473 2061 6e20 696d   downloads an im
-00002980: 6167 6520 6173 2066 696c 6520 6672 6f6d  age as file from
-00002990: 2065 7874 6572 6e61 6c20 5552 4c0d 0a64   external URL..d
-000029a0: 6566 2064 6f77 6e6c 6f61 6449 6d61 6765  ef downloadImage
-000029b0: 2875 726c 2920 3a0d 0a20 2020 2069 6d70  (url) :..    imp
-000029c0: 6f72 7420 7572 6c6c 6962 2e72 6571 7565  ort urllib.reque
-000029d0: 7374 0d0a 0d0a 2020 2020 2320 4465 7465  st....    # Dete
-000029e0: 726d 696e 6520 7468 6520 6669 6c65 206e  rmine the file n
-000029f0: 616d 6520 616e 6420 6578 7465 6e73 696f  ame and extensio
-00002a00: 6e20 6f66 2074 6865 2069 6d61 6765 2062  n of the image b
-00002a10: 6173 6564 206f 6e20 7468 6520 5552 4c2e  ased on the URL.
-00002a20: 0d0a 2020 2020 6669 6c65 5f6e 616d 652c  ..    file_name,
-00002a30: 2066 696c 655f 6578 7465 6e73 696f 6e20   file_extension 
-00002a40: 3d20 6f73 2e70 6174 682e 7370 6c69 7465  = os.path.splite
-00002a50: 7874 2875 726c 290d 0a20 2020 200d 0a20  xt(url)..    .. 
-00002a60: 2020 2023 2044 6566 696e 6520 7468 6520     # Define the 
-00002a70: 6c6f 6361 6c20 6669 6c65 2070 6174 6820  local file path 
-00002a80: 7768 6572 6520 7468 6520 696d 6167 6520  where the image 
-00002a90: 7769 6c6c 2062 6520 7361 7665 642e 0d0a  will be saved...
-00002aa0: 2020 2020 7370 6c69 7465 723d 272f 270d      spliter='/'.
-00002ab0: 0a20 2020 206c 6f63 616c 5f66 696c 656e  .    local_filen
-00002ac0: 616d 653d 6669 6c65 5f6e 616d 652e 7370  ame=file_name.sp
-00002ad0: 6c69 7428 7370 6c69 7465 7229 5b2d 315d  lit(spliter)[-1]
-00002ae0: 0d0a 2020 2020 6c6f 6361 6c5f 6669 6c65  ..    local_file
-00002af0: 5f70 6174 6820 3d20 6622 2e2f 5f69 6e70  _path = f"./_inp
-00002b00: 7574 2f7b 6c6f 6361 6c5f 6669 6c65 6e61  ut/{local_filena
-00002b10: 6d65 7d7b 6669 6c65 5f65 7874 656e 7369  me}{file_extensi
-00002b20: 6f6e 7d22 0d0a 2020 2020 0d0a 2020 2020  on}"..    ..    
-00002b30: 2320 446f 776e 6c6f 6164 2074 6865 2069  # Download the i
-00002b40: 6d61 6765 2066 726f 6d20 7468 6520 5552  mage from the UR
-00002b50: 4c20 616e 6420 7361 7665 2069 7420 6c6f  L and save it lo
-00002b60: 6361 6c6c 792e 0d0a 2020 2020 7572 6c6c  cally...    urll
-00002b70: 6962 2e72 6571 7565 7374 2e75 726c 7265  ib.request.urlre
-00002b80: 7472 6965 7665 2875 726c 2c20 6c6f 6361  trieve(url, loca
-00002b90: 6c5f 6669 6c65 5f70 6174 6829 0d0a 2020  l_file_path)..  
-00002ba0: 2020 7265 7475 726e 2066 227b 6c6f 6361    return f"{loca
-00002bb0: 6c5f 6669 6c65 6e61 6d65 7d7b 6669 6c65  l_filename}{file
-00002bc0: 5f65 7874 656e 7369 6f6e 7d22 0d0a 0d0a  _extension}"....
-00002bd0: 2323 203d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ## =============
-00002be0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00002bf0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00002c00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00002c10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0d 0a23 2320  ===========..## 
-00002c20: 0d0a 2323 2020 2020 2020 2020 2020 2020  ..##            
-00002c30: 2020 2020 2020 2020 2020 4f53 4149 5320            OSAIS 
-00002c40: 7374 6172 7473 2068 6572 6520 0d0a 2323  starts here ..##
-00002c50: 200d 0a23 2320 3d3d 3d3d 3d3d 3d3d 3d3d   ..## ==========
-00002c60: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00002c70: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00001c10: 7669 6365 4765 7443 6f75 6e74 2863 7479  viceGetCount(cty
+00001c20: 7065 732e 6279 7265 6628 6e47 7075 7329  pes.byref(nGpus)
+00001c30: 2920 213d 2043 5544 415f 5355 4343 4553  ) != CUDA_SUCCES
+00001c40: 5329 3a0d 0a20 2020 2020 2020 2020 2020  S):..           
+00001c50: 2072 6574 7572 6e20 300d 0a0d 0a20 2020   return 0....   
+00001c60: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
+00001c70: 6e67 6528 6e47 7075 732e 7661 6c75 6529  nge(nGpus.value)
+00001c80: 3a0d 0a0d 0a20 2020 2020 2020 2020 2020  :....           
+00001c90: 2023 2067 6574 2064 6576 6963 650d 0a20   # get device.. 
+00001ca0: 2020 2020 2020 2020 2020 2069 6628 6375             if(cu
+00001cb0: 6461 2e63 7544 6576 6963 6547 6574 2863  da.cuDeviceGet(c
+00001cc0: 7479 7065 732e 6279 7265 6628 6465 7669  types.byref(devi
+00001cd0: 6365 292c 2069 2920 213d 2043 5544 415f  ce), i) != CUDA_
+00001ce0: 5355 4343 4553 5329 3a0d 0a20 2020 2020  SUCCESS):..     
+00001cf0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00001d00: 6e20 300d 0a20 2020 2020 2020 2020 2020  n 0..           
+00001d10: 2069 6620 2863 7564 612e 6375 4465 7669   if (cuda.cuDevi
+00001d20: 6365 436f 6d70 7574 6543 6170 6162 696c  ceComputeCapabil
+00001d30: 6974 7928 6374 7970 6573 2e62 7972 6566  ity(ctypes.byref
+00001d40: 2863 635f 6d61 6a6f 7229 2c20 6374 7970  (cc_major), ctyp
+00001d50: 6573 2e62 7972 6566 2863 635f 6d69 6e6f  es.byref(cc_mino
+00001d60: 7229 2c20 6465 7669 6365 2920 213d 2043  r), device) != C
+00001d70: 5544 415f 5355 4343 4553 5329 3a20 200d  UDA_SUCCESS):  .
+00001d80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00001d90: 2072 6574 7572 6e20 300d 0a20 2020 2020   return 0..     
+00001da0: 2020 2020 2020 2069 6620 2863 7564 612e         if (cuda.
+00001db0: 6375 4465 7669 6365 4765 744e 616d 6528  cuDeviceGetName(
+00001dc0: 6374 7970 6573 2e63 5f63 6861 725f 7028  ctypes.c_char_p(
+00001dd0: 6e61 6d65 292c 206c 656e 286e 616d 6529  name), len(name)
+00001de0: 2c20 6465 7669 6365 2920 213d 2043 5544  , device) != CUD
+00001df0: 415f 5355 4343 4553 5329 3a20 0d0a 2020  A_SUCCESS): ..  
+00001e00: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00001e10: 7475 726e 2030 0d0a 2020 2020 2020 2020  turn 0..        
+00001e20: 2020 2020 6966 2863 7564 612e 6375 4465      if(cuda.cuDe
+00001e30: 7669 6365 4765 7441 7474 7269 6275 7465  viceGetAttribute
+00001e40: 2863 7479 7065 732e 6279 7265 6628 636f  (ctypes.byref(co
+00001e50: 7265 7329 2c20 4355 5f44 4556 4943 455f  res), CU_DEVICE_
+00001e60: 4154 5452 4942 5554 455f 4d55 4c54 4950  ATTRIBUTE_MULTIP
+00001e70: 524f 4345 5353 4f52 5f43 4f55 4e54 2c20  ROCESSOR_COUNT, 
+00001e80: 6465 7669 6365 2920 213d 2043 5544 415f  device) != CUDA_
+00001e90: 5355 4343 4553 5329 3a0d 0a20 2020 2020  SUCCESS):..     
+00001ea0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00001eb0: 6e20 300d 0a0d 0a20 2020 2020 2020 2064  n 0....        d
+00001ec0: 6973 706c 6179 5f6e 616d 653d 6e61 6d65  isplay_name=name
+00001ed0: 2e73 706c 6974 2862 275c 3027 2c20 3129  .split(b'\0', 1)
+00001ee0: 5b30 5d2e 6465 636f 6465 2829 0d0a 2020  [0].decode()..  
+00001ef0: 2020 2020 2020 6469 7370 6c61 795f 6d61        display_ma
+00001f00: 6a6f 723d 6363 5f6d 616a 6f72 2e76 616c  jor=cc_major.val
+00001f10: 7565 0d0a 2020 2020 2020 2020 6469 7370  ue..        disp
+00001f20: 6c61 795f 6d69 6e6f 723d 6363 5f6d 696e  lay_minor=cc_min
+00001f30: 6f72 2e76 616c 7565 0d0a 2020 2020 2020  or.value..      
+00001f40: 2020 6469 7370 6c61 795f 636f 7265 733d    display_cores=
+00001f50: 636f 7265 732e 7661 6c75 6520 2a20 5f43  cores.value * _C
+00001f60: 6f6e 7665 7274 534d 5665 7232 436f 7265  onvertSMVer2Core
+00001f70: 7328 6363 5f6d 616a 6f72 2e76 616c 7565  s(cc_major.value
+00001f80: 2c20 6363 5f6d 696e 6f72 2e76 616c 7565  , cc_minor.value
+00001f90: 290d 0a0d 0a20 2020 2072 6574 7572 6e20  )....    return 
+00001fa0: 7b0d 0a20 2020 2020 2020 2022 6e61 6d65  {..        "name
+00001fb0: 223a 2064 6973 706c 6179 5f6e 616d 652c  ": display_name,
+00001fc0: 0d0a 2020 2020 2020 2020 2263 6f6d 7075  ..        "compu
+00001fd0: 7465 5f6d 616a 6f72 223a 2064 6973 706c  te_major": displ
+00001fe0: 6179 5f6d 616a 6f72 2c0d 0a20 2020 2020  ay_major,..     
+00001ff0: 2020 2022 636f 6d70 7574 655f 6d69 6e6f     "compute_mino
+00002000: 7222 3a20 6469 7370 6c61 795f 6d69 6e6f  r": display_mino
+00002010: 722c 0d0a 2020 2020 2020 2020 2263 7564  r,..        "cud
+00002020: 6120 636f 7265 7322 3a20 6469 7370 6c61  a cores": displa
+00002030: 795f 636f 7265 7320 0d0a 2020 2020 7d0d  y_cores ..    }.
+00002040: 0a0d 0a64 6566 205f 436f 6e76 6572 7453  ...def _ConvertS
+00002050: 4d56 6572 3243 6f72 6573 286d 616a 6f72  MVer2Cores(major
+00002060: 2c20 6d69 6e6f 7229 3a0d 0a20 2020 2023  , minor):..    #
+00002070: 2052 6574 7572 6e73 2074 6865 206e 756d   Returns the num
+00002080: 6265 7220 6f66 2043 5544 4120 636f 7265  ber of CUDA core
+00002090: 7320 7065 7220 6d75 6c74 6970 726f 6365  s per multiproce
+000020a0: 7373 6f72 2066 6f72 2061 2067 6976 656e  ssor for a given
+000020b0: 0d0a 2020 2020 2320 436f 6d70 7574 6520  ..    # Compute 
+000020c0: 4361 7061 6269 6c69 7479 2076 6572 7369  Capability versi
+000020d0: 6f6e 2e20 5468 6572 6520 6973 206e 6f20  on. There is no 
+000020e0: 7761 7920 746f 2072 6574 7269 6576 6520  way to retrieve 
+000020f0: 7468 6174 2076 6961 0d0a 2020 2020 2320  that via..    # 
+00002100: 7468 6520 4150 492c 2073 6f20 6974 206e  the API, so it n
+00002110: 6565 6473 2074 6f20 6265 2068 6172 642d  eeds to be hard-
+00002120: 636f 6465 642e 0d0a 2020 2020 7265 7475  coded...    retu
+00002130: 726e 207b 0d0a 2020 2020 2320 5465 736c  rn {..    # Tesl
+00002140: 610d 0a20 2020 2020 2028 312c 2030 293a  a..      (1, 0):
+00002150: 2020 2038 2c20 2020 2020 2023 2053 4d20     8,      # SM 
+00002160: 312e 300d 0a20 2020 2020 2028 312c 2031  1.0..      (1, 1
+00002170: 293a 2020 2038 2c20 2020 2020 2023 2053  ):   8,      # S
+00002180: 4d20 312e 310d 0a20 2020 2020 2028 312c  M 1.1..      (1,
+00002190: 2032 293a 2020 2038 2c20 2020 2020 2023   2):   8,      #
+000021a0: 2053 4d20 312e 320d 0a20 2020 2020 2028   SM 1.2..      (
+000021b0: 312c 2033 293a 2020 2038 2c20 2020 2020  1, 3):   8,     
+000021c0: 2023 2053 4d20 312e 330d 0a20 2020 2023   # SM 1.3..    #
+000021d0: 2046 6572 6d69 0d0a 2020 2020 2020 2832   Fermi..      (2
+000021e0: 2c20 3029 3a20 2033 322c 2020 2020 2020  , 0):  32,      
+000021f0: 2320 534d 2032 2e30 3a20 4746 3130 3020  # SM 2.0: GF100 
+00002200: 636c 6173 730d 0a20 2020 2020 2028 322c  class..      (2,
+00002210: 2031 293a 2020 3438 2c20 2020 2020 2023   1):  48,      #
+00002220: 2053 4d20 322e 313a 2047 4631 3078 2063   SM 2.1: GF10x c
+00002230: 6c61 7373 0d0a 2020 2020 2320 4b65 706c  lass..    # Kepl
+00002240: 6572 0d0a 2020 2020 2020 2833 2c20 3029  er..      (3, 0)
+00002250: 3a20 3139 322c 2020 2020 2020 2320 534d  : 192,      # SM
+00002260: 2033 2e30 3a20 474b 3130 7820 636c 6173   3.0: GK10x clas
+00002270: 730d 0a20 2020 2020 2028 332c 2032 293a  s..      (3, 2):
+00002280: 2031 3932 2c20 2020 2020 2023 2053 4d20   192,      # SM 
+00002290: 332e 323a 2047 4b31 3078 2063 6c61 7373  3.2: GK10x class
+000022a0: 0d0a 2020 2020 2020 2833 2c20 3529 3a20  ..      (3, 5): 
+000022b0: 3139 322c 2020 2020 2020 2320 534d 2033  192,      # SM 3
+000022c0: 2e35 3a20 474b 3131 7820 636c 6173 730d  .5: GK11x class.
+000022d0: 0a20 2020 2020 2028 332c 2037 293a 2031  .      (3, 7): 1
+000022e0: 3932 2c20 2020 2020 2023 2053 4d20 332e  92,      # SM 3.
+000022f0: 373a 2047 4b32 3178 2063 6c61 7373 0d0a  7: GK21x class..
+00002300: 2020 2020 2320 4d61 7877 656c 6c0d 0a20      # Maxwell.. 
+00002310: 2020 2020 2028 352c 2030 293a 2031 3238       (5, 0): 128
+00002320: 2c20 2020 2020 2023 2053 4d20 352e 303a  ,      # SM 5.0:
+00002330: 2047 4d31 3078 2063 6c61 7373 0d0a 2020   GM10x class..  
+00002340: 2020 2020 2835 2c20 3229 3a20 3132 382c      (5, 2): 128,
+00002350: 2020 2020 2020 2320 534d 2035 2e32 3a20        # SM 5.2: 
+00002360: 474d 3230 7820 636c 6173 730d 0a20 2020  GM20x class..   
+00002370: 2020 2028 352c 2033 293a 2031 3238 2c20     (5, 3): 128, 
+00002380: 2020 2020 2023 2053 4d20 352e 333a 2047       # SM 5.3: G
+00002390: 4d32 3078 2063 6c61 7373 0d0a 2020 2020  M20x class..    
+000023a0: 2320 5061 7363 616c 0d0a 2020 2020 2020  # Pascal..      
+000023b0: 2836 2c20 3029 3a20 2036 342c 2020 2020  (6, 0):  64,    
+000023c0: 2020 2320 534d 2036 2e30 3a20 4750 3130    # SM 6.0: GP10
+000023d0: 3020 636c 6173 730d 0a20 2020 2020 2028  0 class..      (
+000023e0: 362c 2031 293a 2031 3238 2c20 2020 2020  6, 1): 128,     
+000023f0: 2023 2053 4d20 362e 313a 2047 5031 3078   # SM 6.1: GP10x
+00002400: 2063 6c61 7373 0d0a 2020 2020 2020 2836   class..      (6
+00002410: 2c20 3229 3a20 3132 382c 2020 2020 2020  , 2): 128,      
+00002420: 2320 534d 2036 2e32 3a20 4750 3130 7820  # SM 6.2: GP10x 
+00002430: 636c 6173 730d 0a20 2020 2023 2056 6f6c  class..    # Vol
+00002440: 7461 0d0a 2020 2020 2020 2837 2c20 3029  ta..      (7, 0)
+00002450: 3a20 2036 342c 2020 2020 2020 2320 534d  :  64,      # SM
+00002460: 2037 2e30 3a20 4756 3130 3020 636c 6173   7.0: GV100 clas
+00002470: 730d 0a20 2020 2020 2028 372c 2032 293a  s..      (7, 2):
+00002480: 2020 3634 2c20 2020 2020 2023 2053 4d20    64,      # SM 
+00002490: 372e 323a 2047 5631 3162 2063 6c61 7373  7.2: GV11b class
+000024a0: 0d0a 2020 2020 2320 5475 7269 6e67 0d0a  ..    # Turing..
+000024b0: 2020 2020 2020 2837 2c20 3529 3a20 2036        (7, 5):  6
+000024c0: 342c 2020 2020 2020 2320 534d 2037 2e35  4,      # SM 7.5
+000024d0: 3a20 5455 3130 7820 636c 6173 730d 0a20  : TU10x class.. 
+000024e0: 2020 207d 2e67 6574 2828 6d61 6a6f 722c     }.get((major,
+000024f0: 206d 696e 6f72 292c 2036 3429 2020 2023   minor), 64)   #
+00002500: 2075 6e6b 6e6f 776e 2061 7263 6869 7465   unknown archite
+00002510: 6374 7572 652c 2072 6574 7572 6e20 6120  cture, return a 
+00002520: 6465 6661 756c 7420 7661 6c75 650d 0a0d  default value...
+00002530: 0a23 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  .## ------------
+00002540: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002550: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002560: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002570: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2320  ------------..# 
+00002580: 2020 2020 2020 6765 7449 6e66 6f20 656e        getInfo en
+00002590: 646f 696e 740d 0a23 2320 2d2d 2d2d 2d2d  doint..## ------
+000025a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000025b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000025c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000025d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000025e0: 2d2d 0d0a 0d0a 2323 2067 6574 2076 6172  --....## get var
+000025f0: 696f 7573 2069 6e66 6f20 6162 6f75 7420  ious info about 
+00002600: 7468 6973 2068 6f73 740d 0a64 6566 2067  this host..def g
+00002610: 6574 486f 7374 496e 666f 285f 656e 6769  etHostInfo(_engi
+00002620: 6e65 293a 0d0a 2020 2020 6672 6f6d 2064  ne):..    from d
+00002630: 6174 6574 696d 6520 696d 706f 7274 2064  atetime import d
+00002640: 6174 6574 696d 650d 0a20 2020 206e 6f77  atetime..    now
+00002650: 203d 2064 6174 6574 696d 652e 6e6f 7728   = datetime.now(
+00002660: 290d 0a20 2020 206f 626a 4750 553d 7b7d  )..    objGPU={}
+00002670: 0d0a 2020 2020 6f62 6a47 5055 5b22 6d65  ..    objGPU["me
+00002680: 6d6f 7279 5f66 7265 6522 5d3d 6765 745f  mory_free"]=get_
+00002690: 6770 755f 6174 7472 2822 6d65 6d6f 7279  gpu_attr("memory
+000026a0: 2e66 7265 6522 295b 305d 0d0a 2020 2020  .free")[0]..    
+000026b0: 6f62 6a47 5055 5b22 6d65 6d6f 7279 5f75  objGPU["memory_u
+000026c0: 7365 6422 5d3d 6765 745f 6770 755f 6174  sed"]=get_gpu_at
+000026d0: 7472 2822 6d65 6d6f 7279 2e75 7365 6422  tr("memory.used"
+000026e0: 295b 305d 0d0a 2020 2020 6f62 6a47 5055  )[0]..    objGPU
+000026f0: 5b22 6e61 6d65 225d 3d67 6574 5f67 7075  ["name"]=get_gpu
+00002700: 5f61 7474 7228 2267 7075 5f6e 616d 6522  _attr("gpu_name"
+00002710: 295b 305d 0d0a 2020 2020 6f62 6a47 5055  )[0]..    objGPU
+00002720: 5b22 6472 6976 6572 5f76 6572 7369 6f6e  ["driver_version
+00002730: 225d 3d67 6574 5f67 7075 5f61 7474 7228  "]=get_gpu_attr(
+00002740: 2264 7269 7665 725f 7665 7273 696f 6e22  "driver_version"
+00002750: 295b 305d 0d0a 2020 2020 6f62 6a47 5055  )[0]..    objGPU
+00002760: 5b22 7465 6d70 6572 6174 7572 6522 5d3d  ["temperature"]=
+00002770: 6765 745f 6770 755f 6174 7472 2822 7465  get_gpu_attr("te
+00002780: 6d70 6572 6174 7572 652e 6770 7522 295b  mperature.gpu")[
+00002790: 305d 0d0a 2020 2020 6f62 6a47 5055 5b22  0]..    objGPU["
+000027a0: 7574 696c 697a 6174 696f 6e22 5d3d 6765  utilization"]=ge
+000027b0: 745f 6770 755f 6174 7472 2822 7574 696c  t_gpu_attr("util
+000027c0: 697a 6174 696f 6e2e 6770 7522 295b 305d  ization.gpu")[0]
+000027d0: 0d0a 0d0a 2020 2020 6f62 6a43 7564 613d  ....    objCuda=
+000027e0: 6765 7443 7564 6149 6e66 6f28 2920 2020  getCudaInfo()   
+000027f0: 2020 2020 200d 0a20 2020 2072 6574 7572       ..    retur
+00002800: 6e20 7b0d 0a20 2020 2020 2020 2022 6461  n {..        "da
+00002810: 7465 7469 6d65 223a 206e 6f77 2e73 7472  tetime": now.str
+00002820: 6674 696d 6528 2225 642f 256d 2f25 5920  ftime("%d/%m/%Y 
+00002830: 2548 3a25 4d3a 2553 2229 2c20 0d0a 2020  %H:%M:%S"), ..  
+00002840: 2020 2020 2020 2269 7344 6f63 6b65 7222        "isDocker"
+00002850: 3a20 6973 5f72 756e 6e69 6e67 5f69 6e5f  : is_running_in_
+00002860: 646f 636b 6572 2829 2c0d 0a20 2020 2020  docker(),..     
+00002870: 2020 2022 696e 7465 726e 616c 2049 5022     "internal IP"
+00002880: 3a20 6765 745f 636f 6e74 6169 6e65 725f  : get_container_
+00002890: 6970 2829 2c0d 0a20 2020 2020 2020 2022  ip(),..        "
+000028a0: 706f 7274 223a 2067 6574 5f70 6f72 7428  port": get_port(
+000028b0: 292c 0d0a 2020 2020 2020 2020 2265 6e67  ),..        "eng
+000028c0: 696e 6522 3a20 5f65 6e67 696e 652c 0d0a  ine": _engine,..
+000028d0: 2020 2020 2020 2020 226d 6163 6869 6e65          "machine
+000028e0: 223a 2067 6574 5f6d 6163 6869 6e65 5f6e  ": get_machine_n
+000028f0: 616d 6528 292c 0d0a 2020 2020 2020 2020  ame(),..        
+00002900: 2247 5055 223a 206f 626a 4750 552c 0d0a  "GPU": objGPU,..
+00002910: 2020 2020 2020 2020 2243 7564 6122 3a20          "Cuda": 
+00002920: 6f62 6a43 7564 612c 0d0a 2020 2020 2020  objCuda,..      
+00002930: 2020 226d 6f64 756c 6573 223a 2067 6574    "modules": get
+00002940: 5f6c 6973 745f 6f66 5f6d 6f64 756c 6573  _list_of_modules
+00002950: 2829 0d0a 2020 2020 7d0d 0a0d 0a23 2320  ()..    }....## 
+00002960: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002970: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002980: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002990: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000029a0: 2d2d 2d2d 2d2d 2d2d 0d0a 2320 2020 2020  --------..#     
+000029b0: 2020 4669 6c65 202f 2049 6d61 6765 2075    File / Image u
+000029c0: 7469 6c73 0d0a 2323 202d 2d2d 2d2d 2d2d  tils..## -------
+000029d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000029e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000029f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002a00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002a10: 2d0d 0a0d 0a23 2320 646f 776e 6c6f 6164  -....## download
+00002a20: 7320 616e 2069 6d61 6765 2061 7320 6669  s an image as fi
+00002a30: 6c65 2066 726f 6d20 6578 7465 726e 616c  le from external
+00002a40: 2055 524c 0d0a 6465 6620 646f 776e 6c6f   URL..def downlo
+00002a50: 6164 496d 6167 6528 7572 6c29 203a 0d0a  adImage(url) :..
+00002a60: 2020 2020 696d 706f 7274 2075 726c 6c69      import urlli
+00002a70: 622e 7265 7175 6573 740d 0a0d 0a20 2020  b.request....   
+00002a80: 2023 2044 6574 6572 6d69 6e65 2074 6865   # Determine the
+00002a90: 2066 696c 6520 6e61 6d65 2061 6e64 2065   file name and e
+00002aa0: 7874 656e 7369 6f6e 206f 6620 7468 6520  xtension of the 
+00002ab0: 696d 6167 6520 6261 7365 6420 6f6e 2074  image based on t
+00002ac0: 6865 2055 524c 2e0d 0a20 2020 2066 696c  he URL...    fil
+00002ad0: 655f 6e61 6d65 2c20 6669 6c65 5f65 7874  e_name, file_ext
+00002ae0: 656e 7369 6f6e 203d 206f 732e 7061 7468  ension = os.path
+00002af0: 2e73 706c 6974 6578 7428 7572 6c29 0d0a  .splitext(url)..
+00002b00: 2020 2020 0d0a 2020 2020 2320 4465 6669      ..    # Defi
+00002b10: 6e65 2074 6865 206c 6f63 616c 2066 696c  ne the local fil
+00002b20: 6520 7061 7468 2077 6865 7265 2074 6865  e path where the
+00002b30: 2069 6d61 6765 2077 696c 6c20 6265 2073   image will be s
+00002b40: 6176 6564 2e0d 0a20 2020 2073 706c 6974  aved...    split
+00002b50: 6572 3d27 2f27 0d0a 2020 2020 6c6f 6361  er='/'..    loca
+00002b60: 6c5f 6669 6c65 6e61 6d65 3d66 696c 655f  l_filename=file_
+00002b70: 6e61 6d65 2e73 706c 6974 2873 706c 6974  name.split(split
+00002b80: 6572 295b 2d31 5d0d 0a20 2020 206c 6f63  er)[-1]..    loc
+00002b90: 616c 5f66 696c 655f 7061 7468 203d 2066  al_file_path = f
+00002ba0: 222e 2f5f 696e 7075 742f 7b6c 6f63 616c  "./_input/{local
+00002bb0: 5f66 696c 656e 616d 657d 7b66 696c 655f  _filename}{file_
+00002bc0: 6578 7465 6e73 696f 6e7d 220d 0a20 2020  extension}"..   
+00002bd0: 200d 0a20 2020 2023 2044 6f77 6e6c 6f61   ..    # Downloa
+00002be0: 6420 7468 6520 696d 6167 6520 6672 6f6d  d the image from
+00002bf0: 2074 6865 2055 524c 2061 6e64 2073 6176   the URL and sav
+00002c00: 6520 6974 206c 6f63 616c 6c79 2e0d 0a20  e it locally... 
+00002c10: 2020 2075 726c 6c69 622e 7265 7175 6573     urllib.reques
+00002c20: 742e 7572 6c72 6574 7269 6576 6528 7572  t.urlretrieve(ur
+00002c30: 6c2c 206c 6f63 616c 5f66 696c 655f 7061  l, local_file_pa
+00002c40: 7468 290d 0a20 2020 2072 6574 7572 6e20  th)..    return 
+00002c50: 6622 7b6c 6f63 616c 5f66 696c 656e 616d  f"{local_filenam
+00002c60: 657d 7b66 696c 655f 6578 7465 6e73 696f  e}{file_extensio
+00002c70: 6e7d 220d 0a0d 0a23 2320 3d3d 3d3d 3d3d  n}"....## ======
 00002c80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00002c90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0d0a  ==============..
-00002ca0: 0d0a 2323 202d 2d2d 2d2d 2d2d 2d2d 2d2d  ..## -----------
-00002cb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002cc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002cd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002ce0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a23  -------------..#
-00002cf0: 2020 2020 2020 204f 5341 4953 2070 7974         OSAIS pyt
-00002d00: 686f 6e20 4c69 6220 2869 6e74 6572 6661  hon Lib (interfa
-00002d10: 6365 2062 6574 7765 656e 2041 4973 2061  ce between AIs a
-00002d20: 6e64 204f 5341 4953 290d 0a23 2320 2d2d  nd OSAIS)..## --
-00002d30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002d40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002c90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00002ca0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00002cb0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00002cc0: 3d3d 0d0a 2323 200d 0a23 2320 2020 2020  ==..## ..##     
+00002cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002ce0: 204f 5341 4953 2073 7461 7274 7320 6865   OSAIS starts he
+00002cf0: 7265 200d 0a23 2320 0d0a 2323 203d 3d3d  re ..## ..## ===
+00002d00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00002d10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00002d20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00002d30: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00002d40: 3d3d 3d3d 3d0d 0a0d 0a23 2320 2d2d 2d2d  =====....## ----
 00002d50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00002d60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002d70: 2d2d 2d2d 2d2d 0d0a 0d0a 696d 706f 7274  ------....import
-00002d80: 2072 6571 7565 7374 730d 0a69 6d70 6f72   requests..impor
-00002d90: 7420 7363 6865 6475 6c65 0d0a 696d 706f  t schedule..impo
-00002da0: 7274 206a 736f 6e0d 0a69 6d70 6f72 7420  rt json..import 
-00002db0: 7379 730d 0a69 6d70 6f72 7420 6261 7365  sys..import base
-00002dc0: 3634 0d0a 6672 6f6d 2064 6174 6574 696d  64..from datetim
-00002dd0: 6520 696d 706f 7274 2064 6174 6574 696d  e import datetim
-00002de0: 650d 0a69 6d70 6f72 7420 6172 6770 6172  e..import argpar
-00002df0: 7365 0d0a 0d0a 2323 2066 726f 6d20 6f73  se....## from os
-00002e00: 6169 735f 7574 696c 7320 696d 706f 7274  ais_utils import
-00002e10: 2067 6574 486f 7374 496e 666f 2c20 6c69   getHostInfo, li
-00002e20: 7374 4469 7243 6f6e 7465 6e74 2c20 6973  stDirContent, is
-00002e30: 5f72 756e 6e69 6e67 5f69 6e5f 646f 636b  _running_in_dock
-00002e40: 6572 2c20 6765 745f 6578 7465 726e 616c  er, get_external
-00002e50: 5f69 702c 2067 6574 5f63 6f6e 7461 696e  _ip, get_contain
-00002e60: 6572 5f69 702c 2067 6574 5f6d 6163 6869  er_ip, get_machi
-00002e70: 6e65 5f6e 616d 652c 2067 6574 5f6f 735f  ne_name, get_os_
-00002e80: 6e61 6d65 2c20 6765 7443 7564 6149 6e66  name, getCudaInf
-00002e90: 6f2c 2064 6f77 6e6c 6f61 6449 6d61 6765  o, downloadImage
-00002ea0: 2c20 7374 6172 745f 6f62 7365 7276 6572  , start_observer
-00002eb0: 5f74 6872 6561 642c 2063 6c65 6172 4f6c  _thread, clearOl
-00002ec0: 6446 696c 6573 2c20 7374 6172 745f 6e6f  dFiles, start_no
-00002ed0: 7469 6669 6361 7469 6f6e 5f74 6872 6561  tification_threa
-00002ee0: 640d 0a0d 0a23 2320 2d2d 2d2d 2d2d 2d2d  d....## --------
-00002ef0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002f00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002f10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002f20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002f30: 0d0a 2320 2020 2020 2020 616c 6c20 676c  ..#       all gl
-00002f40: 6f62 616c 2076 6172 730d 0a23 2320 2d2d  obal vars..## --
-00002f50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002f60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002f70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002f80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00002f90: 2d2d 2d2d 2d2d 0d0a 0d0a 6756 6572 7369  ------....gVersi
-00002fa0: 6f6e 4c69 624f 5341 4953 3d5f 5f76 6572  onLibOSAIS=__ver
-00002fb0: 7369 6f6e 5f5f 2020 2020 2323 2076 6572  sion__    ## ver
-00002fc0: 7369 6f6e 206f 6620 7468 6973 206c 6962  sion of this lib
-00002fd0: 7261 7279 2028 746f 206b 6565 7020 6974  rary (to keep it
-00002fe0: 206c 6174 6573 7420 6576 6572 7977 6865   latest everywhe
-00002ff0: 7265 290d 0a67 5573 6572 6e61 6d65 3d4e  re)..gUsername=N
-00003000: 6f6e 6520 2020 2020 2020 2020 2020 2020  one             
-00003010: 2020 2020 2023 2320 7573 6572 206f 776e       ## user own
-00003020: 696e 6720 7468 6973 2041 4920 286e 6563  ing this AI (nec
-00003030: 6573 7361 7279 2074 6f20 636c 6169 6d20  essary to claim 
-00003040: 5669 7274 4149 2072 6567 7329 0d0a 0d0a  VirtAI regs)....
-00003050: 674e 616d 653d 4e6f 6e65 2020 2020 2020  gName=None      
-00003060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003070: 2323 206e 616d 6520 6f66 2074 6869 7320  ## name of this 
-00003080: 4149 2028 6e61 6d65 206f 6620 656e 6769  AI (name of engi
-00003090: 6e65 290d 0a67 5665 7273 696f 6e3d 2230  ne)..gVersion="0
-000030a0: 2e30 2e30 2220 2020 2020 2020 2020 2020  .0.0"           
-000030b0: 2020 2020 2023 2320 6e61 6d65 206f 6620       ## name of 
-000030c0: 7468 6973 2041 4927 7320 7665 7273 696f  this AI's versio
-000030d0: 6e20 2876 6572 7369 6f6e 206f 6620 656e  n (version of en
-000030e0: 6769 6e65 290d 0a67 4465 7363 7269 7074  gine)..gDescript
-000030f0: 696f 6e3d 4e6f 6e65 2020 2020 2020 2020  ion=None        
-00003100: 2020 2020 2020 2023 2320 4149 2773 2071         ## AI's q
-00003110: 7569 636b 2064 6573 6372 6970 7469 6f6e  uick description
-00003120: 0d0a 674f 7269 6769 6e3d 4e6f 6e65 2020  ..gOrigin=None  
-00003130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003140: 2020 2323 2077 6865 7265 2074 6869 7320    ## where this 
-00003150: 4149 2063 616d 6520 6672 6f6d 2028 6f6e  AI came from (on
-00003160: 2069 6e74 6572 6e65 7429 0d0a 674d 6163   internet)..gMac
-00003170: 6869 6e65 4e61 6d65 3d67 6574 5f6d 6163  hineName=get_mac
-00003180: 6869 6e65 5f6e 616d 6528 2920 2323 2074  hine_name() ## t
-00003190: 6865 206e 616d 6520 6f66 2074 6865 206d  he name of the m
-000031a0: 6163 6869 6e65 2028 7769 6c6c 2063 6861  achine (will cha
-000031b0: 6e67 6520 616c 6c20 7468 6520 7469 6d65  nge all the time
-000031c0: 2069 6620 696e 7369 6465 2064 6f63 6b65   if inside docke
-000031d0: 722c 206f 7420 6b65 6570 2073 616d 6520  r, ot keep same 
-000031e0: 6966 2072 756e 6e69 6e67 206f 6e20 6c6f  if running on lo
-000031f0: 6361 6c20 7365 7276 6572 290d 0a67 4c61  cal server)..gLa
-00003200: 7374 4368 6563 6b65 645f 6174 3d64 6174  stChecked_at=dat
-00003210: 6574 696d 652e 7574 636e 6f77 2829 2020  etime.utcnow()  
-00003220: 2323 2077 6865 6e20 7761 7320 7468 6973  ## when was this
-00003230: 2041 4920 6c61 7374 2075 7365 6420 666f   AI last used fo
-00003240: 7220 7072 6f63 6573 7369 6e67 2061 6e79  r processing any
-00003250: 7468 696e 670d 0a67 4c61 7374 5072 6f63  thing..gLastProc
-00003260: 6573 7353 7461 7274 5f61 743d 4e6f 6e65  essStart_at=None
-00003270: 2020 2020 2020 2023 2320 7768 656e 2077         ## when w
-00003280: 6173 2074 6869 7320 4149 206c 6173 7420  as this AI last 
-00003290: 7374 6172 7420 6576 656e 7420 666f 7220  start event for 
-000032a0: 7072 6f63 6573 7369 6e67 2061 6e79 7468  processing anyth
-000032b0: 696e 670d 0a0d 0a23 2320 6175 7468 656e  ing....## authen
-000032c0: 7469 6361 7465 2069 6e74 6f20 4f53 4149  ticate into OSAI
-000032d0: 530d 0a67 4175 7468 546f 6b65 6e3d 4e6f  S..gAuthToken=No
-000032e0: 6e65 2020 2020 2020 2020 2020 2020 2020  ne              
-000032f0: 2020 2023 2320 6175 7468 2074 6f6b 656e     ## auth token
-00003300: 2069 6e74 6f20 4f53 4149 5320 666f 7220   into OSAIS for 
-00003310: 7768 656e 2077 6f72 6b69 6e67 2061 7320  when working as 
-00003320: 7669 7274 7561 6c20 4169 0d0a 6754 6f6b  virtual Ai..gTok
-00003330: 656e 3d4e 6f6e 6520 2020 2020 2020 2020  en=None         
-00003340: 2020 2020 2020 2020 2020 2020 2323 2074              ## t
-00003350: 6f6b 656e 2075 7365 6420 666f 7220 6175  oken used for au
-00003360: 7468 656e 7469 6361 7469 6f6e 2069 6e74  thentication int
-00003370: 6f20 4f53 4149 530d 0a67 5365 6372 6574  o OSAIS..gSecret
-00003380: 3d4e 6f6e 6520 2020 2020 2020 2020 2020  =None           
-00003390: 2020 2020 2020 2020 2023 2320 7365 6372           ## secr
-000033a0: 6574 2075 7365 6420 666f 7220 6175 7468  et used for auth
-000033b0: 656e 7469 6361 7469 6f6e 2069 6e74 6f20  entication into 
-000033c0: 4f53 4149 530d 0a67 4f72 6967 696e 4f53  OSAIS..gOriginOS
-000033d0: 4149 533d 4e6f 6e65 2020 2020 2020 2020  AIS=None        
-000033e0: 2020 2020 2020 2023 2320 6c6f 6361 7469         ## locati
-000033f0: 6f6e 206f 6620 4f53 4149 530d 0a0d 0a23  on of OSAIS....#
-00003400: 2320 6175 7468 656e 7469 6361 7465 2069  # authenticate i
-00003410: 6e74 6f20 6120 6c6f 6361 6c20 4f53 4149  nto a local OSAI
-00003420: 5320 2864 6562 7567 290d 0a67 4175 7468  S (debug)..gAuth
-00003430: 546f 6b65 6e4c 6f63 616c 3d4e 6f6e 6520  TokenLocal=None 
-00003440: 2020 2020 2020 2020 2020 2023 2320 6175             ## au
-00003450: 7468 2074 6f6b 656e 2069 6e74 6f20 6120  th token into a 
-00003460: 6c6f 6361 6c20 4f53 4149 5320 2864 6562  local OSAIS (deb
-00003470: 7567 2920 666f 7220 7768 656e 2077 6f72  ug) for when wor
-00003480: 6b69 6e67 2061 7320 7669 7274 7561 6c20  king as virtual 
-00003490: 4169 0d0a 6754 6f6b 656e 4c6f 6361 6c3d  Ai..gTokenLocal=
-000034a0: 4e6f 6e65 2020 2020 2020 2020 2020 2020  None            
-000034b0: 2020 2020 2323 2074 6f6b 656e 2075 7365      ## token use
-000034c0: 6420 666f 7220 6175 7468 656e 7469 6361  d for authentica
-000034d0: 7469 6f6e 2069 6e74 6f20 6120 6c6f 6361  tion into a loca
-000034e0: 6c20 4f53 4149 5320 2864 6562 7567 290d  l OSAIS (debug).
-000034f0: 0a67 5365 6372 6574 4c6f 6361 6c3d 4e6f  .gSecretLocal=No
-00003500: 6e65 2020 2020 2020 2020 2020 2020 2020  ne              
-00003510: 2023 2320 7365 6372 6574 2075 7365 6420   ## secret used 
-00003520: 666f 7220 6175 7468 656e 7469 6361 7469  for authenticati
-00003530: 6f6e 2069 6e74 6f20 6120 6c6f 6361 6c20  on into a local 
-00003540: 4f53 4149 5320 2864 6562 7567 290d 0a67  OSAIS (debug)..g
-00003550: 4f72 6967 696e 4c6f 6361 6c4f 5341 4953  OriginLocalOSAIS
-00003560: 3d4e 6f6e 6520 2020 2020 2020 2020 2023  =None          #
-00003570: 2320 6c6f 6361 7469 6f6e 206f 6620 6120  # location of a 
-00003580: 6c6f 6361 6c20 4f53 4149 5320 2864 6562  local OSAIS (deb
-00003590: 7567 290d 0a0d 0a67 4f72 6967 696e 4761  ug)....gOriginGa
-000035a0: 7465 7761 793d 4e6f 6e65 2020 2020 2020  teway=None      
-000035b0: 2020 2020 2020 2023 2320 6c6f 6361 7469         ## locati
-000035c0: 6f6e 206f 6620 7468 6520 6c6f 6361 6c20  on of the local 
-000035d0: 6761 7465 7761 7920 666f 7220 7468 6973  gateway for this
-000035e0: 2028 6c6f 6361 6c29 2041 490d 0a0d 0a23   (local) AI....#
-000035f0: 2320 4950 2061 6e64 2050 6f72 7473 0d0a  # IP and Ports..
-00003600: 6745 7874 4950 3d67 6574 5f65 7874 6572  gExtIP=get_exter
-00003610: 6e61 6c5f 6970 2829 2020 2020 2020 2020  nal_ip()        
-00003620: 2323 2077 6865 7265 2074 6869 7320 4149  ## where this AI
-00003630: 2063 616e 2062 6520 6163 6365 7373 6564   can be accessed
-00003640: 2066 726f 6d20 6f75 7473 6964 6520 2849   from outside (I
-00003650: 5029 0d0a 6749 504c 6f63 616c 3d67 6574  P)..gIPLocal=get
-00003660: 5f63 6f6e 7461 696e 6572 5f69 7028 2920  _container_ip() 
-00003670: 2020 2020 2323 2077 6865 7265 2074 6869      ## where thi
-00003680: 7320 4149 2063 616e 2062 6520 6163 6365  s AI can be acce
-00003690: 7373 6564 206c 6f63 616c 6c79 0d0a 6750  ssed locally..gP
-000036a0: 6f72 7441 493d 4e6f 6e65 2020 2020 2020  ortAI=None      
-000036b0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
-000036c0: 2070 6f72 7420 7768 6572 6520 7468 6973   port where this
-000036d0: 2041 4920 6973 2061 6363 6573 7365 6420   AI is accessed 
-000036e0: 2877 696c 6c20 6265 2073 6574 2062 7920  (will be set by 
-000036f0: 4149 2063 6f6e 6669 6729 0d0a 6750 6f72  AI config)..gPor
-00003700: 7447 6174 6577 6179 3d33 3032 3320 2020  tGateway=3023   
-00003710: 2020 2020 2020 2020 2020 2020 2323 2070              ## p
-00003720: 6f72 7420 7768 6572 6520 7468 6520 6761  ort where the ga
-00003730: 7465 7761 7920 6361 6e20 6265 2061 6363  teway can be acc
-00003740: 6573 7365 640d 0a67 506f 7274 4c6f 6361  essed..gPortLoca
-00003750: 6c4f 5341 4953 3d33 3032 3220 2020 2020  lOSAIS=3022     
-00003760: 2020 2020 2020 2023 2320 706f 7274 2077         ## port w
-00003770: 6865 7265 2061 206c 6f63 616c 204f 5341  here a local OSA
-00003780: 4953 2063 616e 2062 6520 6163 6365 7373  IS can be access
-00003790: 6564 0d0a 0d0a 2323 2076 6972 7475 616c  ed....## virtual
-000037a0: 2041 4920 2f20 6c6f 6361 6c20 2f64 6f63   AI / local /doc
-000037b0: 6b65 7220 3f0d 0a67 4973 446f 636b 6572  ker ?..gIsDocker
-000037c0: 3d69 735f 7275 6e6e 696e 675f 696e 5f64  =is_running_in_d
-000037d0: 6f63 6b65 7228 2920 2020 2323 2061 7265  ocker()   ## are
-000037e0: 2077 6520 7275 6e6e 696e 6720 696e 2061   we running in a
-000037f0: 2044 6f63 6b65 723f 0d0a 6749 7356 6972   Docker?..gIsVir
-00003800: 7475 616c 4149 3d46 616c 7365 2020 2020  tualAI=False    
-00003810: 2020 2020 2020 2020 2020 2323 2061 7265            ## are
-00003820: 2077 6520 776f 726b 696e 6720 6173 2061   we working as a
-00003830: 2056 6972 7475 616c 2041 4920 636f 6e66   Virtual AI conf
-00003840: 6967 3f0d 0a67 4973 4c6f 6361 6c3d 4661  ig?..gIsLocal=Fa
-00003850: 6c73 6520 2020 2020 2020 2020 2020 2020  lse             
-00003860: 2020 2020 2023 2320 6172 6520 7765 2077       ## are we w
-00003870: 6f72 6b69 6e67 206c 6f63 616c 6c79 2028  orking locally (
-00003880: 6c6f 6361 6c68 6f73 7420 7365 7276 6572  localhost server
-00003890: 293f 0d0a 0d0a 2323 2074 656d 7020 6361  )?....## temp ca
-000038a0: 6368 650d 0a67 4150 726f 6365 7373 6564  che..gAProcessed
-000038b0: 3d5b 5d20 2020 2020 2020 2020 2020 2020  =[]             
-000038c0: 2020 2020 2023 2320 616c 6c20 746f 6b65       ## all toke
-000038d0: 6e20 6265 696e 6720 7365 6e74 2074 6f20  n being sent to 
-000038e0: 7072 6f63 6573 7369 6e67 2028 6e65 7665  processing (neve
-000038f0: 7220 6361 6c6c 2074 7769 6365 2066 6f72  r call twice for
-00003900: 2073 616d 6529 0d0a 6749 7353 6368 6564   same)..gIsSched
-00003910: 756c 6564 3d46 616c 7365 2020 2020 2020  uled=False      
-00003920: 2020 2020 2020 2020 2323 2064 6f20 7765          ## do we
-00003930: 2068 6176 6520 6120 7363 6865 6475 6c65   have a schedule
-00003940: 6420 6576 656e 7420 7275 6e6e 696e 673f  d event running?
-00003950: 0d0a 0d0a 2323 2072 756e 2074 696d 6573  ....## run times
-00003960: 0d0a 6749 7357 6172 6d75 703d 4661 6c73  ..gIsWarmup=Fals
-00003970: 6520 2020 2020 2020 2020 2020 2020 2020  e               
-00003980: 2020 2323 2054 7275 6520 6966 2074 6865    ## True if the
-00003990: 2072 6571 7565 7374 2077 6173 2061 2077   request was a w
-000039a0: 6172 6d75 7020 6f6e 6520 286e 6f74 2061  armup one (not a
-000039b0: 2074 7275 6520 6f6e 6520 6672 6f6d 2063   true one from c
-000039c0: 6c69 656e 7429 0d0a 6749 7342 7573 793d  lient)..gIsBusy=
-000039d0: 4661 6c73 6520 2020 2020 2020 2020 2020  False           
-000039e0: 2020 2020 2020 2020 2323 2054 7275 6520          ## True 
-000039f0: 6966 2041 4920 6275 7379 2070 726f 6365  if AI busy proce
-00003a00: 7373 696e 670d 0a67 4465 6661 756c 7443  ssing..gDefaultC
-00003a10: 6f73 743d 3130 3030 2020 2020 2020 2020  ost=1000        
-00003a20: 2020 2020 2020 2023 2320 6465 6661 756c         ## defaul
-00003a30: 7420 636f 7374 2076 616c 7565 2069 6e20  t cost value in 
-00003a40: 6d73 2028 7769 6c6c 2067 6574 206f 7665  ms (will get ove
-00003a50: 7272 6964 656e 2066 6173 742c 2074 6869  rriden fast, thi
-00003a60: 7320 7661 6c75 6520 6973 206e 6f20 6269  s value is no bi
-00003a70: 6720 6465 616c 290d 0a67 6150 726f 6365  g deal)..gaProce
-00003a80: 7373 5469 6d65 3d5b 5d20 2020 2020 2020  ssTime=[]       
-00003a90: 2020 2020 2020 2020 2023 2320 4172 7261           ## Arra
-00003aa0: 7920 6f66 206c 6173 7420 7820 2831 302f  y of last x (10/
-00003ab0: 3230 3f29 2074 696d 6520 7370 656e 7420  20?) time spent 
-00003ac0: 666f 7220 7072 6f63 6573 7365 6420 7265  for processed re
-00003ad0: 7175 6573 7473 200d 0a0d 0a23 2320 7072  quests ....## pr
-00003ae0: 6f63 6573 7369 6e67 2073 7065 6369 6669  ocessing specifi
-00003af0: 6373 0d0a 6741 7267 734f 5341 4953 3d4e  cs..gArgsOSAIS=N
-00003b00: 6f6e 6520 2020 2020 2020 2020 2020 2020  one             
-00003b10: 2020 2020 2323 2074 6865 2061 7267 7320      ## the args 
-00003b20: 7061 7373 6564 2074 6f20 7468 6520 4149  passed to the AI
-00003b30: 2077 6869 6368 2061 7265 2073 7065 6369   which are speci
-00003b40: 6669 6320 746f 204f 5341 4953 2066 6f72  fic to OSAIS for
-00003b50: 2073 656e 6469 6e67 206e 6f74 6966 6963   sending notific
-00003b60: 6174 696f 6e73 0d0a 0d0a 2323 2077 6865  ations....## whe
-00003b70: 6e20 7275 6e6e 696e 6720 6173 2076 4149  n running as vAI
-00003b80: 0d0a 6749 6e70 7574 4469 723d 222e 2f5f  ..gInputDir="./_
-00003b90: 696e 7075 742f 220d 0a67 4f75 7470 7574  input/"..gOutput
-00003ba0: 4469 723d 222e 2f5f 6f75 7470 7574 2f22  Dir="./_output/"
-00003bb0: 0d0a 0d0a 4149 5f50 524f 4752 4553 535f  ....AI_PROGRESS_
-00003bc0: 4552 524f 523d 2d31 0d0a 4149 5f50 524f  ERROR=-1..AI_PRO
-00003bd0: 4752 4553 535f 4944 4c45 3d30 2020 2020  GRESS_IDLE=0    
-00003be0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00003bf0: 756e 7573 6564 0d0a 4149 5f50 524f 4752  unused..AI_PROGR
-00003c00: 4553 535f 4152 4753 3d31 2020 2020 2020  ESS_ARGS=1      
-00003c10: 2020 2020 2020 2020 2020 2020 2320 756e              # un
-00003c20: 7573 6564 0d0a 4149 5f50 524f 4752 4553  used..AI_PROGRES
-00003c30: 535f 4149 5f53 5441 5254 4544 3d32 0d0a  S_AI_STARTED=2..
-00003c40: 4149 5f50 524f 4752 4553 535f 494e 4954  AI_PROGRESS_INIT
-00003c50: 5f49 4d41 4745 3d33 0d0a 4149 5f50 524f  _IMAGE=3..AI_PRO
-00003c60: 4752 4553 535f 444f 4e45 5f49 4d41 4745  GRESS_DONE_IMAGE
-00003c70: 3d34 0d0a 4149 5f50 524f 4752 4553 535f  =4..AI_PROGRESS_
-00003c80: 4149 5f53 544f 5050 4544 3d35 0d0a 0d0a  AI_STOPPED=5....
-00003c90: 2323 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ## -------------
-00003ca0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00003cb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00003cc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00003cd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a23 2020  -----------..#  
-00003ce0: 2020 2020 204c 6f61 6420 636f 6e66 6967       Load config
-00003cf0: 0d0a 2323 202d 2d2d 2d2d 2d2d 2d2d 2d2d  ..## -----------
-00003d00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00003d10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00003d20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00003d30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d  -------------...
-00003d40: 0a23 206c 6f61 6420 7468 6520 636f 6e66  .# load the conf
-00003d50: 6967 2066 696c 6520 696e 746f 2061 204a  ig file into a J
-00003d60: 534f 4e0d 0a64 6566 205f 6c6f 6164 436f  SON..def _loadCo
-00003d70: 6e66 6967 285f 6e61 6d65 293a 200d 0a20  nfig(_name): .. 
-00003d80: 2020 2067 6c6f 6261 6c20 6756 6572 7369     global gVersi
-00003d90: 6f6e 0d0a 2020 2020 676c 6f62 616c 2067  on..    global g
-00003da0: 4465 7363 7269 7074 696f 6e0d 0a20 2020  Description..   
-00003db0: 2067 6c6f 6261 6c20 674f 7269 6769 6e0d   global gOrigin.
-00003dc0: 0a20 2020 2067 6c6f 6261 6c20 6744 6566  .    global gDef
-00003dd0: 6175 6c74 436f 7374 0d0a 0d0a 2020 2020  aultCost....    
-00003de0: 5f6a 736f 6e20 3d20 4e6f 6e65 0d0a 2020  _json = None..  
-00003df0: 2020 5f64 6972 4669 6c65 3d4e 6f6e 650d    _dirFile=None.
-00003e00: 0a20 2020 2074 7279 3a0d 0a20 2020 2020  .    try:..     
-00003e10: 2020 2066 726f 6d20 7061 7468 6c69 6220     from pathlib 
-00003e20: 696d 706f 7274 2050 6174 680d 0a20 2020  import Path..   
-00003e30: 2020 2020 2063 7572 7265 6e74 5f77 6f72       current_wor
-00003e40: 6b69 6e67 5f64 6972 6563 746f 7279 203d  king_directory =
-00003e50: 2050 6174 682e 6377 6428 290d 0a20 2020   Path.cwd()..   
-00003e60: 2020 2020 205f 6469 7246 696c 653d 6627       _dirFile=f'
-00003e70: 7b63 7572 7265 6e74 5f77 6f72 6b69 6e67  {current_working
-00003e80: 5f64 6972 6563 746f 7279 7d2f 7b5f 6e61  _directory}/{_na
-00003e90: 6d65 7d2e 6a73 6f6e 270d 0a20 2020 2020  me}.json'..     
-00003ea0: 2020 2066 4a53 4f4e 203d 206f 7065 6e28     fJSON = open(
-00003eb0: 5f64 6972 4669 6c65 290d 0a20 2020 2020  _dirFile)..     
-00003ec0: 2020 205f 6a73 6f6e 203d 206a 736f 6e2e     _json = json.
-00003ed0: 6c6f 6164 2866 4a53 4f4e 290d 0a20 2020  load(fJSON)..   
-00003ee0: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
-00003ef0: 6e20 6173 2065 7272 3a0d 0a20 2020 2020  n as err:..     
-00003f00: 2020 2070 7269 6e74 2866 2743 5249 5449     print(f'CRITI
-00003f10: 4341 4c3a 204e 6f20 636f 6e66 6967 2066  CAL: No config f
-00003f20: 696c 6520 7b5f 6469 7246 696c 657d 2729  ile {_dirFile}')
-00003f30: 0d0a 2020 2020 2020 2020 7379 732e 6578  ..        sys.ex
-00003f40: 6974 2829 0d0a 0d0a 2020 2020 6756 6572  it()....    gVer
-00003f50: 7369 6f6e 3d5f 6a73 6f6e 5b22 7665 7273  sion=_json["vers
-00003f60: 696f 6e22 5d0d 0a20 2020 2067 4465 7363  ion"]..    gDesc
-00003f70: 7269 7074 696f 6e3d 5f6a 736f 6e5b 2264  ription=_json["d
-00003f80: 6573 6372 6970 7469 6f6e 225d 0d0a 2020  escription"]..  
-00003f90: 2020 674f 7269 6769 6e3d 5f6a 736f 6e5b    gOrigin=_json[
-00003fa0: 226f 7269 6769 6e22 5d0d 0a20 2020 205f  "origin"]..    _
-00003fb0: 636f 7374 3d5f 6a73 6f6e 5b22 6465 6661  cost=_json["defa
-00003fc0: 756c 745f 636f 7374 225d 0d0a 2020 2020  ult_cost"]..    
-00003fd0: 6966 205f 636f 7374 213d 4e6f 6e65 3a0d  if _cost!=None:.
-00003fe0: 0a20 2020 2020 2020 2067 4465 6661 756c  .        gDefaul
-00003ff0: 7443 6f73 743d 5f63 6f73 740d 0a0d 0a20  tCost=_cost.... 
-00004000: 2020 2072 6574 7572 6e20 5f6a 736f 6e0d     return _json.
-00004010: 0a0d 0a23 2067 6574 2074 6865 2066 756c  ...# get the ful
-00004020: 6c20 4149 2063 6f6e 6669 672c 2069 6e63  l AI config, inc
-00004030: 6c75 6469 6e67 204a 534f 4e20 7061 7261  luding JSON para
-00004040: 6d73 2061 6e64 2068 6172 6477 6172 6520  ms and hardware 
-00004050: 696e 666f 0d0a 6465 6620 5f67 6574 4675  info..def _getFu
-00004060: 6c6c 436f 6e66 6967 285f 6e61 6d65 2920  llConfig(_name) 
-00004070: 3a0d 0a20 2020 2067 6c6f 6261 6c20 6755  :..    global gU
-00004080: 7365 726e 616d 650d 0a20 2020 2067 6c6f  sername..    glo
-00004090: 6261 6c20 6750 6f72 7441 490d 0a20 2020  bal gPortAI..   
-000040a0: 2067 6c6f 6261 6c20 674e 616d 650d 0a20   global gName.. 
-000040b0: 2020 2067 6c6f 6261 6c20 6754 6f6b 656e     global gToken
-000040c0: 0d0a 2020 2020 676c 6f62 616c 2067 5365  ..    global gSe
-000040d0: 6372 6574 0d0a 2020 2020 676c 6f62 616c  cret..    global
-000040e0: 2067 4f72 6967 696e 4f53 4149 530d 0a20   gOriginOSAIS.. 
-000040f0: 2020 2067 6c6f 6261 6c20 6754 6f6b 656e     global gToken
-00004100: 4c6f 6361 6c0d 0a20 2020 2067 6c6f 6261  Local..    globa
-00004110: 6c20 6753 6563 7265 744c 6f63 616c 0d0a  l gSecretLocal..
-00004120: 2020 2020 676c 6f62 616c 2067 4f72 6967      global gOrig
-00004130: 696e 4c6f 6361 6c4f 5341 4953 0d0a 2020  inLocalOSAIS..  
-00004140: 2020 676c 6f62 616c 2067 4973 5669 7274    global gIsVirt
-00004150: 7561 6c41 490d 0a20 2020 2067 6c6f 6261  ualAI..    globa
-00004160: 6c20 6749 504c 6f63 616c 0d0a 2020 2020  l gIPLocal..    
-00004170: 676c 6f62 616c 2067 4578 7449 500d 0a20  global gExtIP.. 
-00004180: 0d0a 2020 2020 5f69 703d 6745 7874 4950  ..    _ip=gExtIP
-00004190: 0d0a 2020 2020 6966 2067 4973 5669 7274  ..    if gIsVirt
-000041a0: 7561 6c41 493d 3d46 616c 7365 3a0d 0a20  ualAI==False:.. 
-000041b0: 2020 2020 2020 205f 6970 3d67 4950 4c6f         _ip=gIPLo
-000041c0: 6361 6c20 2020 2020 2020 2020 2020 2020  cal             
-000041d0: 2020 2023 2320 7765 2072 6567 6973 7465     ## we registe
-000041e0: 7220 7769 7468 206c 6f63 616c 2069 7020  r with local ip 
-000041f0: 6966 2077 6520 6172 6520 696e 206c 6f63  if we are in loc
-00004200: 616c 2067 6174 6577 6179 206d 6f64 650d  al gateway mode.
-00004210: 0a0d 0a20 2020 205f 6a73 6f6e 3d5f 6c6f  ...    _json=_lo
-00004220: 6164 436f 6e66 6967 285f 6e61 6d65 290d  adConfig(_name).
-00004230: 0a0d 0a20 2020 206f 626a 4375 6461 496e  ...    objCudaIn
-00004240: 666f 3d67 6574 4375 6461 496e 666f 2829  fo=getCudaInfo()
-00004250: 0d0a 2020 2020 6770 754e 616d 653d 226e  ..    gpuName="n
-00004260: 6f20 4750 5522 0d0a 2020 2020 6966 206f  o GPU"..    if o
-00004270: 626a 4375 6461 496e 666f 2021 3d20 3020  bjCudaInfo != 0 
-00004280: 616e 6420 226e 616d 6522 2069 6e20 6f62  and "name" in ob
-00004290: 6a43 7564 6149 6e66 6f20 616e 6420 6f62  jCudaInfo and ob
-000042a0: 6a43 7564 6149 6e66 6f5b 226e 616d 6522  jCudaInfo["name"
-000042b0: 5d3a 0d0a 2020 2020 2020 2020 6770 754e  ]:..        gpuN
-000042c0: 616d 653d 6f62 6a43 7564 6149 6e66 6f5b  ame=objCudaInfo[
-000042d0: 226e 616d 6522 5d0d 0a0d 0a20 2020 2072  "name"]....    r
-000042e0: 6574 7572 6e20 7b0d 0a20 2020 2020 2020  eturn {..       
-000042f0: 2022 7573 6572 6e61 6d65 223a 2067 5573   "username": gUs
-00004300: 6572 6e61 6d65 2c0d 0a20 2020 2020 2020  ername,..       
-00004310: 2022 6f73 223a 2067 6574 5f6f 735f 6e61   "os": get_os_na
-00004320: 6d65 2829 2c0d 0a20 2020 2020 2020 2022  me(),..        "
-00004330: 6770 7522 3a20 6770 754e 616d 652c 0d0a  gpu": gpuName,..
-00004340: 2020 2020 2020 2020 226d 6163 6869 6e65          "machine
-00004350: 223a 2067 6574 5f6d 6163 6869 6e65 5f6e  ": get_machine_n
-00004360: 616d 6528 292c 0d0a 2020 2020 2020 2020  ame(),..        
-00004370: 2269 7022 3a20 5f69 702c 0d0a 2020 2020  "ip": _ip,..    
-00004380: 2020 2020 2270 6f72 7422 3a20 6750 6f72      "port": gPor
-00004390: 7441 492c 0d0a 2020 2020 2020 2020 2265  tAI,..        "e
-000043a0: 6e67 696e 6522 3a20 5f6a 736f 6e0d 0a20  ngine": _json.. 
-000043b0: 2020 207d 0d0a 0d0a 2323 2050 5542 4c49     }....## PUBLI
-000043c0: 4320 2d20 6172 6520 7765 2072 756e 6e69  C - are we runni
-000043d0: 6e67 206c 6f63 616c 6c79 3f0d 0a64 6566  ng locally?..def
-000043e0: 206f 7361 6973 5f69 734c 6f63 616c 2829   osais_isLocal()
-000043f0: 3a0d 0a20 2020 2067 6c6f 6261 6c20 6749  :..    global gI
-00004400: 734c 6f63 616c 0d0a 2020 2020 7265 7475  sLocal..    retu
-00004410: 726e 2067 4973 4c6f 6361 6c0d 0a0d 0a23  rn gIsLocal....#
-00004420: 2320 5055 424c 4943 202d 206c 6f61 6420  # PUBLIC - load 
-00004430: 7468 6520 636f 6e66 6967 206f 6620 7468  the config of th
-00004440: 6973 2041 490d 0a64 6566 206f 7361 6973  is AI..def osais
-00004450: 5f6c 6f61 6443 6f6e 6669 6728 5f6e 616d  _loadConfig(_nam
-00004460: 6529 3a20 0d0a 2020 2020 7265 7475 726e  e): ..    return
-00004470: 205f 6c6f 6164 436f 6e66 6967 285f 6e61   _loadConfig(_na
-00004480: 6d65 290d 0a0d 0a23 2320 5055 424c 4943  me)....## PUBLIC
-00004490: 202d 2047 6574 2065 6e76 2066 726f 6d20   - Get env from 
-000044a0: 6669 6c65 2028 6c6f 6361 6c20 6f72 2064  file (local or d
-000044b0: 6f63 6b65 7229 0d0a 6465 6620 6f73 6169  ocker)..def osai
-000044c0: 735f 6765 7445 6e76 285f 6669 6c65 6e61  s_getEnv(_filena
-000044d0: 6d65 293a 0d0a 2020 2020 676c 6f62 616c  me):..    global
-000044e0: 2067 5573 6572 6e61 6d65 0d0a 2020 2020   gUsername..    
-000044f0: 676c 6f62 616c 2067 4973 5669 7274 7561  global gIsVirtua
-00004500: 6c41 490d 0a20 2020 2067 6c6f 6261 6c20  lAI..    global 
-00004510: 6749 734c 6f63 616c 0d0a 2020 2020 676c  gIsLocal..    gl
-00004520: 6f62 616c 2067 4e61 6d65 0d0a 0d0a 2020  obal gName....  
-00004530: 2020 2323 2072 6561 6420 656e 7620 6672    ## read env fr
-00004540: 6f6d 2063 6f6e 6669 6720 6669 6c65 0d0a  om config file..
-00004550: 2020 2020 7769 7468 206f 7065 6e28 5f66      with open(_f
-00004560: 696c 656e 616d 652c 2022 7222 2920 6173  ilename, "r") as
-00004570: 2066 3a0d 0a20 2020 2020 2020 2063 6f6e   f:..        con
-00004580: 7465 6e74 203d 2066 2e72 6561 6428 290d  tent = f.read().
-00004590: 0a20 2020 2076 6172 6961 626c 6573 203d  .    variables =
-000045a0: 2063 6f6e 7465 6e74 2e73 706c 6974 2822   content.split("
-000045b0: 5c6e 2229 0d0a 2020 2020 666f 7220 7661  \n")..    for va
-000045c0: 7220 696e 2076 6172 6961 626c 6573 3a0d  r in variables:.
-000045d0: 0a20 2020 2020 2020 2069 6620 7661 7221  .        if var!
-000045e0: 3d22 223a 0d0a 2020 2020 2020 2020 2020  ="":..          
-000045f0: 2020 6b65 792c 2076 616c 7565 203d 2076    key, value = v
-00004600: 6172 2e73 706c 6974 2822 3d22 290d 0a20  ar.split("=").. 
-00004610: 2020 2020 2020 2020 2020 2069 6620 6b65             if ke
-00004620: 7920 3d3d 2022 5553 4552 4e41 4d45 223a  y == "USERNAME":
-00004630: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00004640: 2020 6755 7365 726e 616d 6520 3d20 7661    gUsername = va
-00004650: 6c75 650d 0a20 2020 2020 2020 2020 2020  lue..           
-00004660: 2065 6c69 6620 6b65 7920 3d3d 2022 4953   elif key == "IS
-00004670: 5f4c 4f43 414c 223a 0d0a 2020 2020 2020  _LOCAL":..      
-00004680: 2020 2020 2020 2020 2020 6749 734c 6f63            gIsLoc
-00004690: 616c 203d 2028 7661 6c75 653d 3d22 5472  al = (value=="Tr
-000046a0: 7565 2229 0d0a 2020 2020 2020 2020 2020  ue")..          
-000046b0: 2020 656c 6966 206b 6579 203d 3d20 2249    elif key == "I
-000046c0: 535f 5649 5254 5541 4c41 4922 3a0d 0a20  S_VIRTUALAI":.. 
-000046d0: 2020 2020 2020 2020 2020 2020 2020 2067                 g
-000046e0: 4973 5669 7274 7561 6c41 4920 3d20 2876  IsVirtualAI = (v
-000046f0: 616c 7565 3d3d 2254 7275 6522 290d 0a20  alue=="True").. 
-00004700: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00004710: 6b65 7920 3d3d 2022 454e 4749 4e45 223a  key == "ENGINE":
-00004720: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00004730: 2020 674e 616d 6520 3d20 7661 6c75 650d    gName = value.
-00004740: 0a20 2020 2072 6574 7572 6e20 7b0d 0a20  .    return {.. 
-00004750: 2020 2020 2020 2022 7573 6572 6e61 6d65         "username
-00004760: 223a 2067 5573 6572 6e61 6d65 2c0d 0a20  ": gUsername,.. 
-00004770: 2020 2020 2020 2022 6973 4c6f 6361 6c22         "isLocal"
-00004780: 3a20 6749 734c 6f63 616c 2c0d 0a20 2020  : gIsLocal,..   
-00004790: 2020 2020 2022 6973 5669 7274 7561 6c41       "isVirtualA
-000047a0: 4922 3a20 6749 7356 6972 7475 616c 4149  I": gIsVirtualAI
-000047b0: 2c0d 0a20 2020 2020 2020 2022 6e61 6d65  ,..        "name
-000047c0: 223a 2067 4e61 6d65 0d0a 2020 2020 7d0d  ": gName..    }.
-000047d0: 0a0d 0a23 2320 2d2d 2d2d 2d2d 2d2d 2d2d  ...## ----------
-000047e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000047f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004800: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004810: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  --------------..
-00004820: 2320 2020 2020 2020 636f 7374 2063 616c  #       cost cal
-00004830: 6375 6c61 7469 6f6e 0d0a 2323 202d 2d2d  culation..## ---
-00004840: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004850: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004860: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004870: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004880: 2d2d 2d2d 2d0d 0a0d 0a23 2069 6e69 7420  -----....# init 
-00004890: 7468 6520 6461 6661 756c 7420 636f 7374  the dafault cost
-000048a0: 2061 7272 6179 0d0a 6465 6620 5f69 6e69   array..def _ini
-000048b0: 7469 616c 697a 6543 6f73 7428 2920 3a0d  tializeCost() :.
-000048c0: 0a20 2020 2067 6c6f 6261 6c20 6744 6566  .    global gDef
-000048d0: 6175 6c74 436f 7374 0d0a 2020 2020 676c  aultCost..    gl
-000048e0: 6f62 616c 2067 6150 726f 6365 7373 5469  obal gaProcessTi
-000048f0: 6d65 0d0a 2020 2020 6672 6f6d 2061 7272  me..    from arr
-00004900: 6179 2069 6d70 6f72 7420 6172 7261 790d  ay import array.
-00004910: 0a20 2020 2067 6150 726f 6365 7373 5469  .    gaProcessTi
-00004920: 6d65 3d61 7272 6179 2827 6627 2c20 5b67  me=array('f', [g
-00004930: 4465 6661 756c 7443 6f73 742c 6744 6566  DefaultCost,gDef
-00004940: 6175 6c74 436f 7374 2c67 4465 6661 756c  aultCost,gDefaul
-00004950: 7443 6f73 742c 6744 6566 6175 6c74 436f  tCost,gDefaultCo
-00004960: 7374 2c67 4465 6661 756c 7443 6f73 742c  st,gDefaultCost,
-00004970: 6744 6566 6175 6c74 436f 7374 2c67 4465  gDefaultCost,gDe
-00004980: 6661 756c 7443 6f73 742c 6744 6566 6175  faultCost,gDefau
-00004990: 6c74 436f 7374 2c67 4465 6661 756c 7443  ltCost,gDefaultC
-000049a0: 6f73 742c 6744 6566 6175 6c74 436f 7374  ost,gDefaultCost
-000049b0: 5d29 0d0a 0d0a 2320 696e 6974 2074 6865  ])....# init the
-000049c0: 2064 6166 6175 6c74 2063 6f73 7420 6172   dafault cost ar
-000049d0: 7261 790d 0a64 6566 205f 6164 6443 6f73  ray..def _addCos
-000049e0: 7428 5f63 6f73 7429 203a 0d0a 2020 2020  t(_cost) :..    
-000049f0: 676c 6f62 616c 2067 4973 5761 726d 7570  global gIsWarmup
-00004a00: 0d0a 2020 2020 676c 6f62 616c 2067 6150  ..    global gaP
-00004a10: 726f 6365 7373 5469 6d65 0d0a 2020 2020  rocessTime..    
-00004a20: 6966 2067 4973 5761 726d 7570 3d3d 4661  if gIsWarmup==Fa
-00004a30: 6c73 653a 0d0a 2020 2020 2020 2020 6761  lse:..        ga
-00004a40: 5072 6f63 6573 7354 696d 652e 696e 7365  ProcessTime.inse
-00004a50: 7274 2830 2c20 5f63 6f73 7429 0d0a 2020  rt(0, _cost)..  
-00004a60: 2020 2020 2020 6761 5072 6f63 6573 7354        gaProcessT
-00004a70: 696d 652e 706f 7028 290d 0a0d 0a23 2069  ime.pop()....# i
-00004a80: 6e69 7420 7468 6520 6461 6661 756c 7420  nit the dafault 
-00004a90: 636f 7374 2061 7272 6179 0d0a 6465 6620  cost array..def 
-00004aa0: 5f67 6574 4176 6572 6167 6543 6f73 7428  _getAverageCost(
-00004ab0: 2920 3a0d 0a20 2020 2067 6c6f 6261 6c20  ) :..    global 
-00004ac0: 6761 5072 6f63 6573 7354 696d 650d 0a20  gaProcessTime.. 
-00004ad0: 2020 2061 7665 7261 6765 203d 2073 756d     average = sum
-00004ae0: 2867 6150 726f 6365 7373 5469 6d65 2920  (gaProcessTime) 
-00004af0: 2f20 6c65 6e28 6761 5072 6f63 6573 7354  / len(gaProcessT
-00004b00: 696d 6529 0d0a 2020 2020 7265 7475 726e  ime)..    return
-00004b10: 2061 7665 7261 6765 0d0a 0d0a 2323 202d   average....## -
-00004b20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004b30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004b40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004b50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004b60: 2d2d 2d2d 2d2d 2d0d 0a23 2020 2020 2020  -------..#      
-00004b70: 2061 7267 7320 7072 6f63 6573 7369 6e67   args processing
-00004b80: 0d0a 2323 202d 2d2d 2d2d 2d2d 2d2d 2d2d  ..## -----------
-00004b90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004ba0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004bb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004bc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d  -------------...
-00004bd0: 0a23 2077 6865 7265 2069 7320 7468 6520  .# where is the 
-00004be0: 6f75 7470 7574 2064 6972 3f0d 0a64 6566  output dir?..def
-00004bf0: 205f 6765 744f 7574 7075 7444 6972 2829   _getOutputDir()
-00004c00: 3a0d 0a20 2020 2067 6c6f 6261 6c20 6741  :..    global gA
-00004c10: 7267 734f 5341 4953 0d0a 2020 2020 676c  rgsOSAIS..    gl
-00004c20: 6f62 616c 2067 4f75 7470 7574 4469 720d  obal gOutputDir.
-00004c30: 0a0d 0a20 2020 2069 6620 6741 7267 734f  ...    if gArgsO
-00004c40: 5341 4953 213d 4e6f 6e65 3a0d 0a20 2020  SAIS!=None:..   
-00004c50: 2020 2020 2072 6574 7572 6e20 6741 7267       return gArg
-00004c60: 734f 5341 4953 2e6f 7574 6469 720d 0a20  sOSAIS.outdir.. 
-00004c70: 2020 2072 6574 7572 6e20 674f 7574 7075     return gOutpu
-00004c80: 7444 6972 0d0a 0d0a 2320 7265 6365 6976  tDir....# receiv
-00004c90: 6573 2061 7267 7320 6672 6f6d 2072 6571  es args from req
-00004ca0: 7565 7374 2061 6e64 2070 7574 2074 6865  uest and put the
-00004cb0: 6d20 696e 2061 2061 7272 6179 2066 6f72  m in a array for
-00004cc0: 2070 726f 6365 7373 696e 670d 0a64 6566   processing..def
-00004cd0: 205f 6765 7441 7267 7328 5f61 7267 7329   _getArgs(_args)
-00004ce0: 3a0d 0a20 2020 2061 5265 7375 6c74 203d  :..    aResult =
-00004cf0: 205b 5d0d 0a20 2020 2066 6f72 206b 6579   []..    for key
-00004d00: 2c20 7661 6c75 6520 696e 205f 6172 6773  , value in _args
-00004d10: 2e69 7465 6d73 2829 3a0d 0a20 2020 2020  .items():..     
-00004d20: 2020 2069 6620 6b65 792e 7374 6172 7473     if key.starts
-00004d30: 7769 7468 2822 2d22 293a 0d0a 2020 2020  with("-"):..    
-00004d40: 2020 2020 2020 2020 6152 6573 756c 742e          aResult.
-00004d50: 6170 7065 6e64 286b 6579 290d 0a20 2020  append(key)..   
-00004d60: 2020 2020 2020 2020 2061 5265 7375 6c74           aResult
-00004d70: 2e61 7070 656e 6428 7661 6c75 6529 0d0a  .append(value)..
-00004d80: 2020 2020 7265 7475 726e 2061 5265 7375      return aResu
-00004d90: 6c74 0d0a 0d0a 2320 6769 7665 206e 6577  lt....# give new
-00004da0: 2061 7267 7320 0d0a 6465 6620 5f61 7267   args ..def _arg
-00004db0: 7346 726f 6d46 696c 7465 7228 5f6f 7269  sFromFilter(_ori
-00004dc0: 6769 6e61 6c41 7267 732c 205f 6146 696c  ginalArgs, _aFil
-00004dd0: 7465 722c 205f 624b 6565 7029 3a0d 0a20  ter, _bKeep):.. 
-00004de0: 2020 2066 726f 6d20 7765 726b 7a65 7567     from werkzeug
-00004df0: 2e64 6174 6173 7472 7563 7475 7265 7320  .datastructures 
-00004e00: 696d 706f 7274 204d 756c 7469 4469 6374  import MultiDict
-00004e10: 0d0a 2020 2020 5f64 6963 7420 3d20 4d75  ..    _dict = Mu
-00004e20: 6c74 6944 6963 7428 5b5d 290d 0a20 2020  ltiDict([])..   
-00004e30: 2066 6f72 2069 2c20 6172 6720 696e 2065   for i, arg in e
-00004e40: 6e75 6d65 7261 7465 285f 6f72 6967 696e  numerate(_origin
-00004e50: 616c 4172 6773 293a 0d0a 2020 2020 2020  alArgs):..      
-00004e60: 2020 6966 205f 624b 6565 703a 0d0a 2020    if _bKeep:..  
-00004e70: 2020 2020 2020 2020 2020 6966 2061 7267            if arg
-00004e80: 2069 6e20 5f61 4669 6c74 6572 2061 6e64   in _aFilter and
-00004e90: 2069 203c 206c 656e 285f 6f72 6967 696e   i < len(_origin
-00004ea0: 616c 4172 6773 2920 2d20 313a 0d0a 2020  alArgs) - 1:..  
-00004eb0: 2020 2020 2020 2020 2020 2020 2020 5f64                _d
-00004ec0: 6963 742e 6164 6428 6172 672c 205f 6f72  ict.add(arg, _or
-00004ed0: 6967 696e 616c 4172 6773 5b69 2b31 5d29  iginalArgs[i+1])
-00004ee0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00004ef0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00004f00: 6172 6720 6e6f 7420 696e 205f 6146 696c  arg not in _aFil
-00004f10: 7465 7220 616e 6420 6920 3c20 6c65 6e28  ter and i < len(
-00004f20: 5f6f 7269 6769 6e61 6c41 7267 7329 202d  _originalArgs) -
-00004f30: 2031 3a0d 0a20 2020 2020 2020 2020 2020   1:..           
-00004f40: 2020 2020 205f 6469 6374 2e61 6464 2861       _dict.add(a
-00004f50: 7267 2c20 5f6f 7269 6769 6e61 6c41 7267  rg, _originalArg
-00004f60: 735b 692b 315d 290d 0a20 2020 200d 0a20  s[i+1])..    .. 
-00004f70: 2020 205f 6172 6773 3d5f 6765 7441 7267     _args=_getArg
-00004f80: 7328 5f64 6963 7429 0d0a 2020 2020 7265  s(_dict)..    re
-00004f90: 7475 726e 205f 6172 6773 0d0a 0d0a 2323  turn _args....##
-00004fa0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00004fb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004fc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004fd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004fe0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a23 2020 2020  ---------..#    
-00004ff0: 2020 2053 7973 7465 6d20 696e 666f 0d0a     System info..
-00005000: 2323 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ## -------------
-00005010: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005020: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005030: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005040: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d 0a64  -----------....d
-00005050: 6566 205f 636c 6561 7244 6972 2829 3a0d  ef _clearDir():.
-00005060: 0a20 2020 2063 6c65 6172 4f6c 6446 696c  .    clearOldFil
-00005070: 6573 2867 496e 7075 7444 6972 290d 0a20  es(gInputDir).. 
-00005080: 2020 2063 6c65 6172 4f6c 6446 696c 6573     clearOldFiles
-00005090: 2867 4f75 7470 7574 4469 7229 0d0a 0d0a  (gOutputDir)....
-000050a0: 2323 2050 5542 4c49 4320 2d20 696e 666f  ## PUBLIC - info
-000050b0: 2061 626f 7574 2068 6172 7761 7265 2074   about harware t
-000050c0: 6869 7320 4149 2069 7320 7275 6e6e 696e  his AI is runnin
-000050d0: 6720 6f6e 0d0a 6465 6620 6f73 6169 735f  g on..def osais_
-000050e0: 6765 7448 6172 7761 7265 496e 666f 2829  getHarwareInfo()
-000050f0: 203a 0d0a 2020 2020 676c 6f62 616c 2067   :..    global g
-00005100: 4e61 6d65 0d0a 2020 2020 7265 7475 726e  Name..    return
-00005110: 2067 6574 486f 7374 496e 666f 2867 4e61   getHostInfo(gNa
-00005120: 6d65 290d 0a0d 0a23 2320 5055 424c 4943  me)....## PUBLIC
-00005130: 202d 2067 6574 206c 6973 7420 6f66 2066   - get list of f
-00005140: 696c 6573 2069 6e20 6120 6469 7220 2863  iles in a dir (c
-00005150: 6865 636b 2077 6861 7420 7761 7320 6765  heck what was ge
-00005160: 6e65 7261 7465 6429 0d0a 6465 6620 6f73  nerated)..def os
-00005170: 6169 735f 6765 7444 6972 6563 746f 7279  ais_getDirectory
-00005180: 4c69 7374 696e 6728 5f64 6972 2920 3a0d  Listing(_dir) :.
-00005190: 0a20 2020 2072 6574 7572 6e20 6c69 7374  .    return list
-000051a0: 4469 7243 6f6e 7465 6e74 285f 6469 7229  DirContent(_dir)
-000051b0: 0d0a 0d0a 2323 2050 5542 4c49 4320 2d20  ....## PUBLIC - 
-000051c0: 696e 666f 2061 626f 7574 2074 6869 7320  info about this 
-000051d0: 4149 0d0a 6465 6620 6f73 6169 735f 6765  AI..def osais_ge
-000051e0: 7449 6e66 6f28 2920 3a0d 0a20 2020 2067  tInfo() :..    g
-000051f0: 6c6f 6261 6c20 6745 7874 4950 0d0a 2020  lobal gExtIP..  
-00005200: 2020 676c 6f62 616c 2067 506f 7274 4149    global gPortAI
-00005210: 0d0a 2020 2020 676c 6f62 616c 2067 4e61  ..    global gNa
-00005220: 6d65 0d0a 2020 2020 676c 6f62 616c 2067  me..    global g
-00005230: 5665 7273 696f 6e0d 0a20 2020 2067 6c6f  Version..    glo
-00005240: 6261 6c20 6749 7344 6f63 6b65 720d 0a20  bal gIsDocker.. 
-00005250: 2020 2067 6c6f 6261 6c20 674d 6163 6869     global gMachi
-00005260: 6e65 4e61 6d65 0d0a 2020 2020 676c 6f62  neName..    glob
-00005270: 616c 2067 5573 6572 6e61 6d65 0d0a 2020  al gUsername..  
-00005280: 2020 676c 6f62 616c 2067 4973 4275 7379    global gIsBusy
-00005290: 0d0a 2020 2020 676c 6f62 616c 2067 4c61  ..    global gLa
-000052a0: 7374 5072 6f63 6573 7353 7461 7274 5f61  stProcessStart_a
-000052b0: 740d 0a20 2020 2067 6c6f 6261 6c20 674c  t..    global gL
-000052c0: 6173 7443 6865 636b 6564 5f61 740d 0a0d  astChecked_at...
-000052d0: 0a20 2020 206f 626a 436f 6e66 3d5f 6765  .    objConf=_ge
-000052e0: 7446 756c 6c43 6f6e 6669 6728 674e 616d  tFullConfig(gNam
-000052f0: 6529 0d0a 0d0a 2020 2020 7265 7475 726e  e)....    return
-00005300: 207b 0d0a 2020 2020 2020 2020 226e 616d   {..        "nam
-00005310: 6522 3a20 674e 616d 652c 0d0a 2020 2020  e": gName,..    
-00005320: 2020 2020 2276 6572 7369 6f6e 223a 2067      "version": g
-00005330: 5665 7273 696f 6e2c 0d0a 2020 2020 2020  Version,..      
-00005340: 2020 226c 6f63 6174 696f 6e22 3a20 6622    "location": f"
-00005350: 7b67 4578 7449 507d 3a7b 6750 6f72 7441  {gExtIP}:{gPortA
-00005360: 497d 2f22 2c0d 0a20 2020 2020 2020 2022  I}/",..        "
-00005370: 6973 5275 6e6e 696e 6722 3a20 5472 7565  isRunning": True
-00005380: 2c20 2020 200d 0a20 2020 2020 2020 2022  ,    ..        "
-00005390: 6973 446f 636b 6572 223a 2067 4973 446f  isDocker": gIsDo
-000053a0: 636b 6572 2c20 2020 200d 0a20 2020 2020  cker,    ..     
-000053b0: 2020 2022 6c61 7374 4163 7469 7665 5f61     "lastActive_a
-000053c0: 7422 3a20 674c 6173 7443 6865 636b 6564  t": gLastChecked
-000053d0: 5f61 742c 0d0a 2020 2020 2020 2020 226c  _at,..        "l
-000053e0: 6173 7450 726f 6365 7373 5374 6172 745f  astProcessStart_
-000053f0: 6174 223a 2067 4c61 7374 5072 6f63 6573  at": gLastProces
-00005400: 7353 7461 7274 5f61 742c 0d0a 2020 2020  sStart_at,..    
-00005410: 2020 2020 226d 6163 6869 6e65 223a 2067      "machine": g
-00005420: 4d61 6368 696e 654e 616d 652c 0d0a 2020  MachineName,..  
-00005430: 2020 2020 2020 226f 776e 6572 223a 2067        "owner": g
-00005440: 5573 6572 6e61 6d65 2c20 0d0a 2020 2020  Username, ..    
-00005450: 2020 2020 2269 7341 7661 696c 6162 6c65      "isAvailable
-00005460: 223a 2028 6749 7342 7573 793d 3d46 616c  ": (gIsBusy==Fal
-00005470: 7365 292c 0d0a 2020 2020 2020 2020 2261  se),..        "a
-00005480: 7665 7261 6765 5265 7370 6f6e 7365 5469  verageResponseTi
-00005490: 6d65 223a 205f 6765 7441 7665 7261 6765  me": _getAverage
-000054a0: 436f 7374 2829 2c20 0d0a 2020 2020 2020  Cost(), ..      
-000054b0: 2020 226a 736f 6e22 3a20 6f62 6a43 6f6e    "json": objCon
-000054c0: 665b 2265 6e67 696e 6522 5d0d 0a20 2020  f["engine"]..   
-000054d0: 207d 0d0a 0d0a 2323 202d 2d2d 2d2d 2d2d   }....## -------
-000054e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000054f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005500: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005510: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005520: 2d0d 0a23 2020 2020 2020 2063 6f6e 6e65  -..#       conne
-00005530: 6374 2074 6f20 4761 7465 7761 790d 0a23  ct to Gateway..#
-00005540: 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  # --------------
-00005550: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005560: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005570: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005580: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a 2320  ----------....# 
-00005590: 6e6f 7469 6679 2074 6865 2067 6174 6577  notify the gatew
-000055a0: 6179 206f 6620 6f75 7220 4149 2063 6f6e  ay of our AI con
-000055b0: 6669 6720 6669 6c65 0d0a 6465 6620 5f6e  fig file..def _n
-000055c0: 6f74 6966 7947 6174 6577 6179 2829 203a  otifyGateway() :
-000055d0: 200d 0a20 2020 2067 6c6f 6261 6c20 674e   ..    global gN
-000055e0: 616d 650d 0a20 2020 2067 6c6f 6261 6c20  ame..    global 
-000055f0: 674f 7269 6769 6e47 6174 6577 6179 0d0a  gOriginGateway..
-00005600: 0d0a 2020 2020 6865 6164 6572 7320 3d20  ..    headers = 
-00005610: 7b0d 0a20 2020 2020 2020 2022 436f 6e74  {..        "Cont
-00005620: 656e 742d 5479 7065 223a 2027 6170 706c  ent-Type": 'appl
-00005630: 6963 6174 696f 6e2f 6a73 6f6e 272c 200d  ication/json', .
-00005640: 0a20 2020 2020 2020 2027 4163 6365 7074  .        'Accept
-00005650: 273a 2027 7465 7874 2f70 6c61 696e 272c  ': 'text/plain',
-00005660: 0d0a 2020 2020 7d0d 0a20 2020 206f 626a  ..    }..    obj
-00005670: 5061 7261 6d3d 5f67 6574 4675 6c6c 436f  Param=_getFullCo
-00005680: 6e66 6967 2867 4e61 6d65 290d 0a0d 0a20  nfig(gName).... 
-00005690: 2020 2023 2320 6e6f 7469 6679 2067 6174     ## notify gat
-000056a0: 6577 6179 0d0a 2020 2020 7472 793a 0d0a  eway..    try:..
-000056b0: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
-000056c0: 203d 2072 6571 7565 7374 732e 706f 7374   = requests.post
-000056d0: 2866 227b 674f 7269 6769 6e47 6174 6577  (f"{gOriginGatew
-000056e0: 6179 7d61 7069 2f76 312f 7075 626c 6963  ay}api/v1/public
-000056f0: 2f61 692f 636f 6e66 6967 222c 2068 6561  /ai/config", hea
-00005700: 6465 7273 3d68 6561 6465 7273 2c20 6461  ders=headers, da
-00005710: 7461 3d6a 736f 6e2e 6475 6d70 7328 6f62  ta=json.dumps(ob
-00005720: 6a50 6172 616d 2929 0d0a 2020 2020 2020  jParam))..      
-00005730: 2020 6f62 6a52 6573 3d72 6573 706f 6e73    objRes=respons
-00005740: 652e 6a73 6f6e 2829 5b22 6461 7461 225d  e.json()["data"]
-00005750: 0d0a 2020 2020 2020 2020 6966 206f 626a  ..        if obj
-00005760: 5265 7320 6973 204e 6f6e 653a 0d0a 2020  Res is None:..  
-00005770: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00005780: 5661 6c75 6545 7272 6f72 2822 4352 4954  ValueError("CRIT
-00005790: 4943 414c 3a20 636f 756c 6420 6e6f 7420  ICAL: could not 
-000057a0: 6e6f 7469 6679 2047 6174 6577 6179 2229  notify Gateway")
-000057b0: 0d0a 0d0a 2020 2020 6578 6365 7074 2045  ....    except E
-000057c0: 7863 6570 7469 6f6e 2061 7320 6572 723a  xception as err:
-000057d0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-000057e0: 2243 5249 5449 4341 4c3a 2022 2b65 7272  "CRITICAL: "+err
-000057f0: 2e6d 7367 290d 0a20 2020 2020 2020 2072  .msg)..        r
-00005800: 6169 7365 2065 7272 0d0a 2020 2020 7265  aise err..    re
-00005810: 7475 726e 2054 7275 650d 0a0d 0a23 2320  turn True....## 
-00005820: 5055 424c 4943 202d 2052 6573 6574 2063  PUBLIC - Reset c
-00005830: 6f6e 6e65 6374 696f 6e20 746f 206c 6f63  onnection to loc
-00005840: 616c 2067 6174 6577 6179 0d0a 6465 6620  al gateway..def 
-00005850: 6f73 6169 735f 7265 7365 7447 6174 6577  osais_resetGatew
-00005860: 6179 285f 6c6f 6361 6c47 6174 6577 6179  ay(_localGateway
-00005870: 293a 0d0a 2020 2020 676c 6f62 616c 2067  ):..    global g
-00005880: 4f72 6967 696e 4761 7465 7761 790d 0a20  OriginGateway.. 
-00005890: 2020 2067 4f72 6967 696e 4761 7465 7761     gOriginGatewa
-000058a0: 793d 5f6c 6f63 616c 4761 7465 7761 790d  y=_localGateway.
-000058b0: 0a20 2020 2074 7279 3a0d 0a20 2020 2020  .    try:..     
-000058c0: 2020 205f 6e6f 7469 6679 4761 7465 7761     _notifyGatewa
-000058d0: 7928 290d 0a20 2020 2065 7863 6570 7420  y()..    except 
-000058e0: 4578 6365 7074 696f 6e20 6173 2065 7272  Exception as err
-000058f0: 3a0d 0a20 2020 2020 2020 2070 7269 6e74  :..        print
-00005900: 2822 4352 4954 4943 414c 3a20 222b 6572  ("CRITICAL: "+er
-00005910: 722e 6d73 6729 0d0a 2020 2020 2020 2020  r.msg)..        
-00005920: 7261 6973 6520 6572 720d 0a20 2020 200d  raise err..    .
-00005930: 0a20 2020 2070 7269 6e74 2822 3d3e 2054  .    print("=> T
-00005940: 6869 7320 4149 2069 7320 7265 7365 7420  his AI is reset 
-00005950: 746f 2074 616c 6b20 746f 2047 6174 6577  to talk to Gatew
-00005960: 6179 2022 2b5f 6c6f 6361 6c47 6174 6577  ay "+_localGatew
-00005970: 6179 290d 0a20 2020 2072 6574 7572 6e20  ay)..    return 
-00005980: 5472 7565 0d0a 0d0a 2323 202d 2d2d 2d2d  True....## -----
-00005990: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000059a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000059b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000059c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000059d0: 2d2d 2d0d 0a23 2020 2020 2020 2061 7574  ---..#       aut
-000059e0: 6865 6e74 6963 6174 6520 696e 746f 204f  henticate into O
-000059f0: 5341 4953 2061 7320 7669 7274 7561 6c20  SAIS as virtual 
-00005a00: 4149 0d0a 2323 202d 2d2d 2d2d 2d2d 2d2d  AI..## ---------
-00005a10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005a20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005a30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005a40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d  ---------------.
-00005a50: 0a0d 0a23 2052 6567 6973 7465 7220 6f75  ...# Register ou
-00005a60: 7220 5641 4920 696e 746f 204f 5341 4953  r VAI into OSAIS
-00005a70: 0d0a 6465 6620 5f72 6567 6973 7465 7256  ..def _registerV
-00005a80: 4149 2829 3a0d 0a20 2020 2067 6c6f 6261  AI():..    globa
-00005a90: 6c20 674e 616d 650d 0a20 2020 2067 6c6f  l gName..    glo
-00005aa0: 6261 6c20 6754 6f6b 656e 0d0a 2020 2020  bal gToken..    
-00005ab0: 676c 6f62 616c 2067 5365 6372 6574 0d0a  global gSecret..
-00005ac0: 2020 2020 676c 6f62 616c 2067 4f72 6967      global gOrig
-00005ad0: 696e 4f53 4149 530d 0a20 2020 2067 6c6f  inOSAIS..    glo
-00005ae0: 6261 6c20 6754 6f6b 656e 4c6f 6361 6c0d  bal gTokenLocal.
-00005af0: 0a20 2020 2067 6c6f 6261 6c20 6753 6563  .    global gSec
-00005b00: 7265 744c 6f63 616c 0d0a 2020 2020 676c  retLocal..    gl
-00005b10: 6f62 616c 2067 4f72 6967 696e 4c6f 6361  obal gOriginLoca
-00005b20: 6c4f 5341 4953 0d0a 2020 2020 676c 6f62  lOSAIS..    glob
-00005b30: 616c 2067 4973 4c6f 6361 6c0d 0a0d 0a20  al gIsLocal.... 
-00005b40: 2020 2068 6561 6465 7273 203d 207b 0d0a     headers = {..
-00005b50: 2020 2020 2020 2020 2243 6f6e 7465 6e74          "Content
-00005b60: 2d54 7970 6522 3a20 2761 7070 6c69 6361  -Type": 'applica
-00005b70: 7469 6f6e 2f6a 736f 6e27 2c20 0d0a 2020  tion/json', ..  
-00005b80: 2020 2020 2020 2741 6363 6570 7427 3a20        'Accept': 
-00005b90: 2774 6578 742f 706c 6169 6e27 2c0d 0a20  'text/plain',.. 
-00005ba0: 2020 207d 0d0a 2020 2020 6f62 6a50 6172     }..    objPar
-00005bb0: 616d 3d5f 6765 7446 756c 6c43 6f6e 6669  am=_getFullConfi
-00005bc0: 6728 674e 616d 6529 0d0a 0d0a 2020 2020  g(gName)....    
-00005bd0: 2323 2072 6567 2077 6974 6820 5072 6f64  ## reg with Prod
-00005be0: 0d0a 2020 2020 6966 2067 4973 4c6f 6361  ..    if gIsLoca
-00005bf0: 6c3d 3d46 616c 7365 3a0d 0a20 2020 2020  l==False:..     
-00005c00: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-00005c10: 2020 2020 2072 6573 706f 6e73 6520 3d20       response = 
-00005c20: 7265 7175 6573 7473 2e70 6f73 7428 6622  requests.post(f"
-00005c30: 7b67 4f72 6967 696e 4f53 4149 537d 6170  {gOriginOSAIS}ap
-00005c40: 692f 7631 2f70 7562 6c69 632f 7669 7274  i/v1/public/virt
-00005c50: 7561 6c61 692f 7265 6769 7374 6572 222c  ualai/register",
-00005c60: 2068 6561 6465 7273 3d68 6561 6465 7273   headers=headers
-00005c70: 2c20 6461 7461 3d6a 736f 6e2e 6475 6d70  , data=json.dump
-00005c80: 7328 6f62 6a50 6172 616d 2929 0d0a 2020  s(objParam))..  
-00005c90: 2020 2020 2020 2020 2020 6f62 6a52 6573            objRes
-00005ca0: 3d72 6573 706f 6e73 652e 6a73 6f6e 2829  =response.json()
-00005cb0: 5b22 6461 7461 225d 0d0a 2020 2020 2020  ["data"]..      
-00005cc0: 2020 2020 2020 6966 206f 626a 5265 7320        if objRes 
-00005cd0: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
-00005ce0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-00005cf0: 2243 4f55 4c44 204e 4f54 2052 4547 4953  "COULD NOT REGIS
-00005d00: 5445 522c 2073 746f 7070 696e 6720 6974  TER, stopping it
-00005d10: 2068 6572 6522 290d 0a20 2020 2020 2020   here")..       
-00005d20: 2020 2020 2020 2020 2073 7973 2e65 7869           sys.exi
-00005d30: 7428 290d 0a0d 0a20 2020 2020 2020 2020  t()....         
-00005d40: 2020 2067 546f 6b65 6e3d 6f62 6a52 6573     gToken=objRes
-00005d50: 5b22 746f 6b65 6e22 5d0d 0a20 2020 2020  ["token"]..     
-00005d60: 2020 2020 2020 2067 5365 6372 6574 3d6f         gSecret=o
-00005d70: 626a 5265 735b 2273 6563 7265 7422 5d0d  bjRes["secret"].
-00005d80: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-00005d90: 6e74 2822 5765 2061 7265 2052 4547 4953  nt("We are REGIS
-00005da0: 5445 5245 4420 7769 7468 204f 5341 4953  TERED with OSAIS
-00005db0: 2050 726f 6422 290d 0a20 2020 2020 2020   Prod")..       
-00005dc0: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
-00005dd0: 6e20 6173 2065 7272 3a0d 0a20 2020 2020  n as err:..     
-00005de0: 2020 2020 2020 2070 7269 6e74 2822 4352         print("CR
-00005df0: 4954 4943 414c 3a20 222b 6572 722e 6d73  ITICAL: "+err.ms
-00005e00: 6729 0d0a 2020 2020 2020 2020 2020 2020  g)..            
-00005e10: 7261 6973 6520 6572 720d 0a0d 0a20 2020  raise err....   
-00005e20: 2023 2320 7265 6720 7769 7468 204c 6f63   ## reg with Loc
-00005e30: 616c 204f 5341 4953 2028 6465 6275 6729  al OSAIS (debug)
-00005e40: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
-00005e50: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-00005e60: 2020 2020 2020 2072 6573 706f 6e73 6520         response 
-00005e70: 3d20 7265 7175 6573 7473 2e70 6f73 7428  = requests.post(
-00005e80: 6622 7b67 4f72 6967 696e 4c6f 6361 6c4f  f"{gOriginLocalO
-00005e90: 5341 4953 7d61 7069 2f76 312f 7075 626c  SAIS}api/v1/publ
-00005ea0: 6963 2f76 6972 7475 616c 6169 2f72 6567  ic/virtualai/reg
-00005eb0: 6973 7465 7222 2c20 6865 6164 6572 733d  ister", headers=
-00005ec0: 6865 6164 6572 732c 2064 6174 613d 6a73  headers, data=js
-00005ed0: 6f6e 2e64 756d 7073 286f 626a 5061 7261  on.dumps(objPara
-00005ee0: 6d29 290d 0a20 2020 2020 2020 2020 2020  m))..           
-00005ef0: 206f 626a 5265 733d 7265 7370 6f6e 7365   objRes=response
-00005f00: 2e6a 736f 6e28 295b 2264 6174 6122 5d0d  .json()["data"].
-00005f10: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00005f20: 6f62 6a52 6573 2069 7320 4e6f 6e65 3a0d  objRes is None:.
-00005f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005f40: 2070 7269 6e74 2822 434f 554c 4420 4e4f   print("COULD NO
-00005f50: 5420 5245 4749 5354 4552 2077 6974 6820  T REGISTER with 
-00005f60: 6465 6275 6722 290d 0a0d 0a20 2020 2020  debug")....     
-00005f70: 2020 2020 2020 2067 546f 6b65 6e4c 6f63         gTokenLoc
-00005f80: 616c 3d6f 626a 5265 735b 2274 6f6b 656e  al=objRes["token
-00005f90: 225d 0d0a 2020 2020 2020 2020 2020 2020  "]..            
-00005fa0: 6753 6563 7265 744c 6f63 616c 3d6f 626a  gSecretLocal=obj
-00005fb0: 5265 735b 2273 6563 7265 7422 5d0d 0a20  Res["secret"].. 
-00005fc0: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00005fd0: 2822 5765 2061 7265 2052 4547 4953 5445  ("We are REGISTE
-00005fe0: 5245 4420 7769 7468 204f 5341 4953 204c  RED with OSAIS L
-00005ff0: 6f63 616c 2028 6465 6275 6729 2229 0d0a  ocal (debug)")..
-00006000: 2020 2020 2020 2020 6578 6365 7074 2045          except E
-00006010: 7863 6570 7469 6f6e 2061 7320 6572 723a  xception as err:
-00006020: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-00006030: 696e 7428 2243 5249 5449 4341 4c3a 2022  int("CRITICAL: "
-00006040: 2b65 7272 2e6d 7367 290d 0a20 2020 2020  +err.msg)..     
-00006050: 2020 2020 2020 2072 6169 7365 2065 7272         raise err
-00006060: 0d0a 0d0a 2020 2020 7265 7475 726e 2054  ....    return T
-00006070: 7275 650d 0a0d 0a23 2041 7574 6865 6e74  rue....# Authent
-00006080: 6963 6174 6520 696e 746f 204f 5341 4953  icate into OSAIS
-00006090: 0d0a 6465 6620 5f6c 6f67 696e 5641 4928  ..def _loginVAI(
-000060a0: 293a 0d0a 2020 2020 676c 6f62 616c 2067  ):..    global g
-000060b0: 546f 6b65 6e0d 0a20 2020 2067 6c6f 6261  Token..    globa
-000060c0: 6c20 6753 6563 7265 740d 0a20 2020 2067  l gSecret..    g
-000060d0: 6c6f 6261 6c20 6741 7574 6854 6f6b 656e  lobal gAuthToken
-000060e0: 0d0a 2020 2020 676c 6f62 616c 2067 546f  ..    global gTo
-000060f0: 6b65 6e4c 6f63 616c 0d0a 2020 2020 676c  kenLocal..    gl
-00006100: 6f62 616c 2067 5365 6372 6574 4c6f 6361  obal gSecretLoca
-00006110: 6c0d 0a20 2020 2067 6c6f 6261 6c20 6741  l..    global gA
-00006120: 7574 6854 6f6b 656e 4c6f 6361 6c0d 0a0d  uthTokenLocal...
-00006130: 0a20 2020 2068 6561 6465 7273 203d 207b  .    headers = {
-00006140: 0d0a 2020 2020 2020 2020 2243 6f6e 7465  ..        "Conte
-00006150: 6e74 2d54 7970 6522 3a20 2261 7070 6c69  nt-Type": "appli
-00006160: 6361 7469 6f6e 2f6a 736f 6e22 0d0a 2020  cation/json"..  
-00006170: 2020 7d0d 0a0d 0a20 2020 2069 6620 6754    }....    if gT
-00006180: 6f6b 656e 213d 204e 6f6e 653a 0d0a 2020  oken!= None:..  
-00006190: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-000061a0: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
-000061b0: 203d 2072 6571 7565 7374 732e 706f 7374   = requests.post
-000061c0: 2866 227b 674f 7269 6769 6e4f 5341 4953  (f"{gOriginOSAIS
-000061d0: 7d61 7069 2f76 312f 7075 626c 6963 2f76  }api/v1/public/v
-000061e0: 6972 7475 616c 6169 2f6c 6f67 696e 222c  irtualai/login",
-000061f0: 2068 6561 6465 7273 3d68 6561 6465 7273   headers=headers
-00006200: 2c20 6461 7461 3d6a 736f 6e2e 6475 6d70  , data=json.dump
-00006210: 7328 7b0d 0a20 2020 2020 2020 2020 2020  s({..           
-00006220: 2020 2020 2022 746f 6b65 6e22 3a20 6754       "token": gT
-00006230: 6f6b 656e 2c0d 0a20 2020 2020 2020 2020  oken,..         
-00006240: 2020 2020 2020 2022 7365 6372 6574 223a         "secret":
-00006250: 2067 5365 6372 6574 0d0a 2020 2020 2020   gSecret..      
-00006260: 2020 2020 2020 7d29 290d 0a0d 0a20 2020        }))....   
-00006270: 2020 2020 2020 2020 206f 626a 5265 733d           objRes=
-00006280: 7265 7370 6f6e 7365 2e6a 736f 6e28 295b  response.json()[
-00006290: 2264 6174 6122 5d0d 0a20 2020 2020 2020  "data"]..       
-000062a0: 2020 2020 2069 6620 6f62 6a52 6573 2069       if objRes i
-000062b0: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
-000062c0: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-000062d0: 434f 554c 4420 4e4f 5420 4c4f 4749 4e2c  COULD NOT LOGIN,
-000062e0: 2073 746f 7070 696e 6720 6974 2068 6572   stopping it her
-000062f0: 6522 290d 0a20 2020 2020 2020 2020 2020  e")..           
-00006300: 2020 2020 2073 7973 2e65 7869 7428 290d       sys.exit().
-00006310: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-00006320: 6e74 2822 5765 2067 6f74 2061 6e20 6175  nt("We got an au
-00006330: 7468 656e 7469 6361 7469 6f6e 2074 6f6b  thentication tok
-00006340: 656e 2069 6e74 6f20 4f53 4149 5322 290d  en into OSAIS").
-00006350: 0a20 2020 2020 2020 2020 2020 2067 4175  .            gAu
-00006360: 7468 546f 6b65 6e3d 6f62 6a52 6573 5b22  thToken=objRes["
-00006370: 6175 7468 546f 6b65 6e22 5d20 2020 200d  authToken"]    .
-00006380: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-00006390: 4578 6365 7074 696f 6e20 6173 2065 7272  Exception as err
-000063a0: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-000063b0: 7269 6e74 2822 4352 4954 4943 414c 3a20  rint("CRITICAL: 
-000063c0: 222b 6572 722e 6d73 6729 0d0a 2020 2020  "+err.msg)..    
-000063d0: 2020 2020 2020 2020 7261 6973 6520 6572          raise er
-000063e0: 720d 0a0d 0a20 2020 2069 6620 6754 6f6b  r....    if gTok
-000063f0: 656e 4c6f 6361 6c21 3d20 4e6f 6e65 3a0d  enLocal!= None:.
-00006400: 0a20 2020 2020 2020 2074 7279 3a0d 0a20  .        try:.. 
-00006410: 2020 2020 2020 2020 2020 2072 6573 706f             respo
-00006420: 6e73 6520 3d20 7265 7175 6573 7473 2e70  nse = requests.p
-00006430: 6f73 7428 6622 7b67 4f72 6967 696e 4c6f  ost(f"{gOriginLo
-00006440: 6361 6c4f 5341 4953 7d61 7069 2f76 312f  calOSAIS}api/v1/
-00006450: 7075 626c 6963 2f76 6972 7475 616c 6169  public/virtualai
-00006460: 2f6c 6f67 696e 222c 2068 6561 6465 7273  /login", headers
-00006470: 3d68 6561 6465 7273 2c20 6461 7461 3d6a  =headers, data=j
-00006480: 736f 6e2e 6475 6d70 7328 7b0d 0a20 2020  son.dumps({..   
-00006490: 2020 2020 2020 2020 2020 2020 2022 746f               "to
-000064a0: 6b65 6e22 3a20 6754 6f6b 656e 4c6f 6361  ken": gTokenLoca
-000064b0: 6c2c 0d0a 2020 2020 2020 2020 2020 2020  l,..            
-000064c0: 2020 2020 2273 6563 7265 7422 3a20 6753      "secret": gS
-000064d0: 6563 7265 744c 6f63 616c 0d0a 2020 2020  ecretLocal..    
-000064e0: 2020 2020 2020 2020 7d29 290d 0a0d 0a20          })).... 
-000064f0: 2020 2020 2020 2020 2020 206f 626a 5265             objRe
-00006500: 733d 7265 7370 6f6e 7365 2e6a 736f 6e28  s=response.json(
-00006510: 295b 2264 6174 6122 5d0d 0a20 2020 2020  )["data"]..     
-00006520: 2020 2020 2020 2069 6620 6f62 6a52 6573         if objRes
-00006530: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
-00006540: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00006550: 2822 434f 554c 4420 4e4f 5420 4c4f 4749  ("COULD NOT LOGI
-00006560: 4e20 696e 746f 204f 5341 4953 204c 6f63  N into OSAIS Loc
-00006570: 616c 2229 0d0a 2020 2020 2020 2020 2020  al")..          
-00006580: 2020 7072 696e 7428 2257 6520 676f 7420    print("We got 
-00006590: 616e 2061 7574 6865 6e74 6963 6174 696f  an authenticatio
-000065a0: 6e20 746f 6b65 6e20 696e 746f 204f 5341  n token into OSA
-000065b0: 4953 204c 6f63 616c 2028 6465 6275 6729  IS Local (debug)
-000065c0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
-000065d0: 6741 7574 6854 6f6b 656e 4c6f 6361 6c3d  gAuthTokenLocal=
-000065e0: 6f62 6a52 6573 5b22 6175 7468 546f 6b65  objRes["authToke
-000065f0: 6e22 5d20 2020 200d 0a20 2020 2020 2020  n"]    ..       
-00006600: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
-00006610: 6e20 6173 2065 7272 3a0d 0a20 2020 2020  n as err:..     
-00006620: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
-00006630: 7565 0d0a 0d0a 2020 2020 7265 7475 726e  ue....    return
-00006640: 2054 7275 650d 0a0d 0a0d 0a23 2320 5055   True......## PU
-00006650: 424c 4943 202d 2041 7574 6865 6e74 6963  BLIC - Authentic
-00006660: 6174 6520 7468 6520 5669 7274 7561 6c20  ate the Virtual 
-00006670: 4149 2069 6e74 6f20 4f53 4149 530d 0a64  AI into OSAIS..d
-00006680: 6566 206f 7361 6973 5f61 7574 6865 6e74  ef osais_authent
-00006690: 6963 6174 6541 4928 293a 0d0a 2020 2020  icateAI():..    
-000066a0: 676c 6f62 616c 2067 4973 5669 7274 7561  global gIsVirtua
-000066b0: 6c41 490d 0a20 2020 2067 6c6f 6261 6c20  lAI..    global 
-000066c0: 674f 7269 6769 6e4f 5341 4953 0d0a 2020  gOriginOSAIS..  
-000066d0: 2020 676c 6f62 616c 2067 4973 5363 6865    global gIsSche
-000066e0: 6475 6c65 640d 0a20 2020 200d 0a20 2020  duled..    ..   
-000066f0: 2052 6573 703d 7b22 6461 7461 223a 204e   Resp={"data": N
-00006700: 6f6e 657d 0d0a 2020 2020 6966 2067 4973  one}..    if gIs
-00006710: 5669 7274 7561 6c41 493a 0d0a 0d0a 2020  VirtualAI:....  
-00006720: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-00006730: 2020 2020 2020 2020 7265 7370 3d20 5f72          resp= _r
-00006740: 6567 6973 7465 7256 4149 2829 0d0a 2020  egisterVAI()..  
-00006750: 2020 2020 2020 2020 2020 7265 7370 3d5f            resp=_
-00006760: 6c6f 6769 6e56 4149 2829 0d0a 2020 2020  loginVAI()..    
-00006770: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
-00006780: 7469 6f6e 2061 7320 6572 723a 0d0a 2020  tion as err:..  
-00006790: 2020 2020 2020 2020 2020 7072 696e 7428            print(
-000067a0: 2243 5249 5449 4341 4c3a 2022 2b65 7272  "CRITICAL: "+err
-000067b0: 2e6d 7367 290d 0a20 2020 2020 2020 2020  .msg)..         
-000067c0: 2020 2072 6169 7365 2065 7272 0d0a 2020     raise err..  
-000067d0: 2020 2020 2020 0d0a 2020 2020 2020 2020        ..        
-000067e0: 2320 5275 6e20 7468 6520 7363 6865 6475  # Run the schedu
-000067f0: 6c65 720d 0a20 2020 2020 2020 2069 6620  ler..        if 
-00006800: 6749 7353 6368 6564 756c 6564 3d3d 4661  gIsScheduled==Fa
-00006810: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00006820: 2020 6749 7353 6368 6564 756c 6564 3d54    gIsScheduled=T
-00006830: 7275 650d 0a20 2020 2020 2020 2020 2020  rue..           
-00006840: 2073 6368 6564 756c 652e 6576 6572 7928   schedule.every(
-00006850: 292e 6461 792e 6174 2822 3130 3a33 3022  ).day.at("10:30"
-00006860: 292e 646f 285f 6c6f 6769 6e56 4149 290d  ).do(_loginVAI).
-00006870: 0a0d 0a20 2020 2072 6574 7572 6e20 7265  ...    return re
-00006880: 7370 0d0a 0d0a 2323 202d 2d2d 2d2d 2d2d  sp....## -------
-00006890: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000068a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000068b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000068c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000068d0: 2d0d 0a23 2020 2020 2020 2052 756e 2074  -..#       Run t
-000068e0: 6865 2041 490d 0a23 2320 2d2d 2d2d 2d2d  he AI..## ------
-000068f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006900: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006910: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006920: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006930: 2d2d 0d0a 0d0a 2323 2050 5542 4c49 4320  --....## PUBLIC 
-00006940: 2d20 7061 7273 6520 6172 6773 2066 6f72  - parse args for
-00006950: 204f 5341 4953 2028 6e6f 7420 7468 6f73   OSAIS (not thos
-00006960: 6520 666f 7220 4149 290d 0a64 6566 206f  e for AI)..def o
-00006970: 7361 6973 5f69 6e69 7450 6172 7365 7228  sais_initParser(
-00006980: 6141 7267 293a 0d0a 2020 2020 676c 6f62  aArg):..    glob
-00006990: 616c 2067 4172 6773 4f53 4149 530d 0a20  al gArgsOSAIS.. 
-000069a0: 2020 2067 6c6f 6261 6c20 6749 6e70 7574     global gInput
-000069b0: 4469 720d 0a20 2020 2067 6c6f 6261 6c20  Dir..    global 
-000069c0: 674f 7574 7075 7444 6972 0d0a 2020 2020  gOutputDir..    
-000069d0: 676c 6f62 616c 2067 4973 5761 726d 7570  global gIsWarmup
-000069e0: 0d0a 0d0a 2020 2020 2320 4372 6561 7465  ....    # Create
-000069f0: 2074 6865 2070 6172 7365 720d 0a20 2020   the parser..   
-00006a00: 2076 715f 7061 7273 6572 203d 2061 7267   vq_parser = arg
-00006a10: 7061 7273 652e 4172 6775 6d65 6e74 5061  parse.ArgumentPa
-00006a20: 7273 6572 2864 6573 6372 6970 7469 6f6e  rser(description
-00006a30: 3d27 4172 6720 7061 7273 6572 2069 6e69  ='Arg parser ini
-00006a40: 7420 6279 204f 5341 4953 2729 0d0a 0d0a  t by OSAIS')....
-00006a50: 2020 2020 2320 4164 6420 7468 6520 4149      # Add the AI
-00006a60: 2047 6174 6577 6179 202f 204f 7065 6e53   Gateway / OpenS
-00006a70: 6f75 7263 6541 4973 2061 7267 756d 656e  ourceAIs argumen
-00006a80: 7473 0d0a 2020 2020 7671 5f70 6172 7365  ts..    vq_parse
-00006a90: 722e 6164 645f 6172 6775 6d65 6e74 2822  r.add_argument("
-00006aa0: 2d6f 7269 6722 2c20 2022 2d2d 6f72 6967  -orig",  "--orig
-00006ab0: 696e 222c 2074 7970 653d 7374 722c 2068  in", type=str, h
-00006ac0: 656c 703d 2241 4920 4761 7465 7761 7920  elp="AI Gateway 
-00006ad0: 7365 7276 6572 206f 7269 6769 6e22 2c20  server origin", 
-00006ae0: 6465 6661 756c 743d 6622 6874 7470 3a2f  default=f"http:/
-00006af0: 2f7b 6749 504c 6f63 616c 7d3a 7b67 506f  /{gIPLocal}:{gPo
-00006b00: 7274 4761 7465 7761 797d 2f22 202c 2064  rtGateway}/" , d
-00006b10: 6573 743d 274f 5341 4953 5f6f 7269 6769  est='OSAIS_origi
-00006b20: 6e27 2920 2020 2020 2323 2020 7468 6973  n')     ##  this
-00006b30: 2069 7320 666f 7220 636f 6d6d 7320 7769   is for comms wi
-00006b40: 7468 2041 4920 4761 7465 7761 790d 0a20  th AI Gateway.. 
-00006b50: 2020 2076 715f 7061 7273 6572 2e61 6464     vq_parser.add
-00006b60: 5f61 7267 756d 656e 7428 222d 7422 2c20  _argument("-t", 
-00006b70: 2022 2d2d 746f 6b65 6e22 2c20 7479 7065   "--token", type
-00006b80: 3d73 7472 2c20 6865 6c70 3d22 4f70 656e  =str, help="Open
-00006b90: 536f 7572 6365 4149 7320 746f 6b65 6e22  SourceAIs token"
-00006ba0: 2c20 6465 6661 756c 743d 2230 222c 2064  , default="0", d
-00006bb0: 6573 743d 2774 6f6b 656e 4149 2729 2020  est='tokenAI')  
-00006bc0: 2020 2020 2020 2020 2020 2020 2023 2320               ## 
-00006bd0: 2074 6869 7320 6973 2066 6f72 2063 6f6d   this is for com
-00006be0: 6d73 2077 6974 6820 4f70 656e 536f 7572  ms with OpenSour
-00006bf0: 6365 4149 730d 0a20 2020 2076 715f 7061  ceAIs..    vq_pa
-00006c00: 7273 6572 2e61 6464 5f61 7267 756d 656e  rser.add_argumen
-00006c10: 7428 222d 7522 2c20 2022 2d2d 7573 6572  t("-u",  "--user
-00006c20: 6e61 6d65 222c 2074 7970 653d 7374 722c  name", type=str,
-00006c30: 2068 656c 703d 224f 7065 6e53 6f75 7263   help="OpenSourc
-00006c40: 6541 4973 2075 7365 726e 616d 6522 2c20  eAIs username", 
-00006c50: 6465 6661 756c 743d 2222 2c20 6465 7374  default="", dest
-00006c60: 3d27 7573 6572 6e61 6d65 2729 2020 2020  ='username')    
-00006c70: 2020 2023 2320 2074 6869 7320 6973 2066     ##  this is f
-00006c80: 6f72 2063 6f6d 6d73 2077 6974 6820 4f70  or comms with Op
-00006c90: 656e 536f 7572 6365 4149 730d 0a20 2020  enSourceAIs..   
-00006ca0: 2076 715f 7061 7273 6572 2e61 6464 5f61   vq_parser.add_a
-00006cb0: 7267 756d 656e 7428 222d 7569 6422 2c20  rgument("-uid", 
-00006cc0: 2022 2d2d 756e 6971 7565 5f69 6422 2c20   "--unique_id", 
-00006cd0: 7479 7065 3d69 6e74 2c20 6865 6c70 3d22  type=int, help="
-00006ce0: 556e 6971 7565 2049 4420 6f66 2074 6869  Unique ID of thi
-00006cf0: 7320 4149 2073 6573 7369 6f6e 222c 2064  s AI session", d
-00006d00: 6566 6175 6c74 3d30 2c20 6465 7374 3d27  efault=0, dest='
-00006d10: 7569 6427 2920 2020 2023 2320 2074 6869  uid')    ##  thi
-00006d20: 7320 6973 2066 6f72 2063 6f6d 6d73 2077  s is for comms w
-00006d30: 6974 6820 4f70 656e 536f 7572 6365 4149  ith OpenSourceAI
-00006d40: 730d 0a20 2020 2076 715f 7061 7273 6572  s..    vq_parser
-00006d50: 2e61 6464 5f61 7267 756d 656e 7428 222d  .add_argument("-
-00006d60: 6f64 6972 222c 2022 2d2d 6f75 7464 6972  odir", "--outdir
-00006d70: 222c 2074 7970 653d 7374 722c 2068 656c  ", type=str, hel
-00006d80: 703d 224f 7574 7075 7420 6469 7265 6374  p="Output direct
-00006d90: 6f72 7922 2c20 6465 6661 756c 743d 674f  ory", default=gO
-00006da0: 7574 7075 7444 6972 2c20 6465 7374 3d27  utputDir, dest='
-00006db0: 6f75 7464 6972 2729 0d0a 2020 2020 7671  outdir')..    vq
-00006dc0: 5f70 6172 7365 722e 6164 645f 6172 6775  _parser.add_argu
-00006dd0: 6d65 6e74 2822 2d69 6469 7222 2c20 222d  ment("-idir", "-
-00006de0: 2d69 6e64 6972 222c 2074 7970 653d 7374  -indir", type=st
-00006df0: 722c 2068 656c 703d 2269 6e70 7574 2064  r, help="input d
-00006e00: 6972 6563 746f 7279 222c 2064 6566 6175  irectory", defau
-00006e10: 6c74 3d67 496e 7075 7444 6972 2c20 6465  lt=gInputDir, de
-00006e20: 7374 3d27 696e 6469 7227 290d 0a20 2020  st='indir')..   
-00006e30: 2076 715f 7061 7273 6572 2e61 6464 5f61   vq_parser.add_a
-00006e40: 7267 756d 656e 7428 222d 6c6f 6361 6c22  rgument("-local"
-00006e50: 2c20 222d 2d69 736c 6f63 616c 222c 2074  , "--islocal", t
-00006e60: 7970 653d 626f 6f6c 2c20 6865 6c70 3d22  ype=bool, help="
-00006e70: 6973 206c 6f63 616c 206f 7220 7072 6f64  is local or prod
-00006e80: 3f22 2c20 6465 6661 756c 743d 4661 6c73  ?", default=Fals
-00006e90: 652c 2064 6573 743d 2769 734c 6f63 616c  e, dest='isLocal
-00006ea0: 2729 0d0a 2020 2020 7671 5f70 6172 7365  ')..    vq_parse
-00006eb0: 722e 6164 645f 6172 6775 6d65 6e74 2822  r.add_argument("
-00006ec0: 2d63 7963 6c65 222c 2022 2d2d 6379 636c  -cycle", "--cycl
-00006ed0: 6522 2c20 7479 7065 3d69 6e74 2c20 6865  e", type=int, he
-00006ee0: 6c70 3d22 6379 636c 6522 2c20 6465 6661  lp="cycle", defa
-00006ef0: 756c 743d 302c 2064 6573 743d 2763 7963  ult=0, dest='cyc
-00006f00: 6c65 2729 0d0a 2020 2020 7671 5f70 6172  le')..    vq_par
-00006f10: 7365 722e 6164 645f 6172 6775 6d65 6e74  ser.add_argument
-00006f20: 2822 2d66 696c 656e 616d 6522 2c20 222d  ("-filename", "-
-00006f30: 2d66 696c 656e 616d 6522 2c20 7479 7065  -filename", type
-00006f40: 3d73 7472 2c20 6865 6c70 3d22 6669 6c65  =str, help="file
-00006f50: 6e61 6d65 222c 2064 6566 6175 6c74 3d22  name", default="
-00006f60: 6465 6661 756c 7422 2c20 6465 7374 3d27  default", dest='
-00006f70: 6669 6c65 6e61 6d65 2729 0d0a 2020 2020  filename')..    
-00006f80: 7671 5f70 6172 7365 722e 6164 645f 6172  vq_parser.add_ar
-00006f90: 6775 6d65 6e74 2822 2d77 6172 6d75 7022  gument("-warmup"
-00006fa0: 2c20 222d 2d77 6172 6d75 7022 2c20 7479  , "--warmup", ty
-00006fb0: 7065 3d62 6f6f 6c2c 2068 656c 703d 2277  pe=bool, help="w
-00006fc0: 6172 6d75 7022 2c20 6465 6661 756c 743d  armup", default=
-00006fd0: 4661 6c73 652c 2064 6573 743d 2777 6172  False, dest='war
-00006fe0: 6d75 7027 290d 0a0d 0a20 2020 2067 4172  mup')....    gAr
-00006ff0: 6773 4f53 4149 5320 3d20 7671 5f70 6172  gsOSAIS = vq_par
-00007000: 7365 722e 7061 7273 655f 6172 6773 2861  ser.parse_args(a
-00007010: 4172 6729 0d0a 2020 2020 6749 7357 6172  Arg)..    gIsWar
-00007020: 6d75 703d 6741 7267 734f 5341 4953 2e77  mup=gArgsOSAIS.w
-00007030: 6172 6d75 700d 0a20 2020 2072 6574 7572  armup..    retur
-00007040: 6e20 5472 7565 0d0a 0d0a 2323 2050 5542  n True....## PUB
-00007050: 4c49 4320 2d20 7275 6e20 7468 6520 4149  LIC - run the AI
-00007060: 2028 6174 206c 6561 7374 2074 7279 290d   (at least try).
-00007070: 0a64 6566 206f 7361 6973 5f72 756e 4149  .def osais_runAI
-00007080: 282a 6172 6773 293a 0d0a 2020 2020 676c  (*args):..    gl
-00007090: 6f62 616c 2067 4973 4275 7379 0d0a 2020  obal gIsBusy..  
-000070a0: 2020 676c 6f62 616c 2067 4150 726f 6365    global gAProce
-000070b0: 7373 6564 0d0a 2020 2020 676c 6f62 616c  ssed..    global
-000070c0: 2067 4e61 6d65 200d 0a20 2020 2067 6c6f   gName ..    glo
-000070d0: 6261 6c20 674c 6173 7450 726f 6365 7373  bal gLastProcess
-000070e0: 5374 6172 745f 6174 0d0a 0d0a 2020 2020  Start_at....    
-000070f0: 2323 2067 6574 2061 7267 730d 0a20 2020  ## get args..   
-00007100: 2066 6e5f 7275 6e3d 6172 6773 5b30 5d0d   fn_run=args[0].
-00007110: 0a20 2020 205f 6172 6773 3d61 7267 735b  .    _args=args[
-00007120: 315d 0d0a 0d0a 2020 2020 2323 2064 6f20  1]....    ## do 
-00007130: 6e6f 7420 7072 6f63 6573 7320 7477 6963  not process twic
-00007140: 6520 7361 6d65 2075 6964 0d0a 2020 2020  e same uid..    
-00007150: 5f75 6964 3d5f 6172 6773 2e67 6574 2827  _uid=_args.get('
-00007160: 2d75 6964 2729 0d0a 2020 2020 6966 205f  -uid')..    if _
-00007170: 7569 6420 696e 2067 4150 726f 6365 7373  uid in gAProcess
-00007180: 6564 3a0d 0a20 2020 2020 2020 2072 6574  ed:..        ret
-00007190: 7572 6e20 2022 6e6f 7420 7072 6f63 6573  urn  "not proces
-000071a0: 7369 6e67 2c20 616c 7265 6164 7920 7472  sing, already tr
-000071b0: 6965 642e 2e2e 220d 0a0d 0a20 2020 2023  ied..."....    #
-000071c0: 2320 7374 6172 7420 7469 6d65 0d0a 2020  # start time..  
-000071d0: 2020 6749 7342 7573 793d 5472 7565 0d0a    gIsBusy=True..
-000071e0: 2020 2020 6265 675f 6461 7465 203d 2064      beg_date = d
-000071f0: 6174 6574 696d 652e 7574 636e 6f77 2829  atetime.utcnow()
-00007200: 0d0a 0d0a 2020 2020 2323 2072 6570 726f  ....    ## repro
-00007210: 6365 7373 2041 4920 6172 6773 0d0a 2020  cess AI args..  
-00007220: 2020 6141 7267 466f 7270 6172 7365 7241    aArgForparserA
-00007230: 493d 5f67 6574 4172 6773 285f 6172 6773  I=_getArgs(_args
-00007240: 290d 0a20 2020 2061 7267 735f 4578 636c  )..    args_Excl
-00007250: 7573 6976 654f 5341 4953 3d5b 272d 6f72  usiveOSAIS=['-or
-00007260: 6967 272c 2027 2d74 272c 2027 2d75 272c  ig', '-t', '-u',
-00007270: 2027 2d75 6964 272c 2027 2d6c 6f63 616c   '-uid', '-local
-00007280: 272c 2027 2d63 7963 6c65 272c 2027 2d77  ', '-cycle', '-w
-00007290: 6172 6d75 7027 5d0d 0a20 2020 2061 4172  armup']..    aAr
-000072a0: 6746 6f72 7061 7273 6572 4149 3d5f 6172  gForparserAI=_ar
-000072b0: 6773 4672 6f6d 4669 6c74 6572 2861 4172  gsFromFilter(aAr
-000072c0: 6746 6f72 7061 7273 6572 4149 2c20 6172  gForparserAI, ar
-000072d0: 6773 5f45 7863 6c75 7369 7665 4f53 4149  gs_ExclusiveOSAI
-000072e0: 532c 2046 616c 7365 290d 0a0d 0a20 2020  S, False)....   
-000072f0: 2023 2320 7072 6f63 6573 7320 7468 6520   ## process the 
-00007300: 6669 6c65 6e61 6d65 2070 6173 7365 6420  filename passed 
-00007310: 696e 2064 6972 2028 6361 7365 206c 6f63  in dir (case loc
-00007320: 616c 686f 7374 202f 2041 4920 4761 7465  alhost / AI Gate
-00007330: 7761 7929 2c20 6f72 2064 6f77 6e6c 6f61  way), or downloa
-00007340: 6420 6669 6c65 2066 726f 6d20 5552 4c20  d file from URL 
-00007350: 2863 6173 6520 4149 2072 756e 6e69 6e67  (case AI running
-00007360: 2061 7320 5669 7274 7561 6c20 4149 290d   as Virtual AI).
-00007370: 0a20 2020 205f 696e 7075 743d 4e6f 6e65  .    _input=None
-00007380: 0d0a 2020 2020 5f66 696c 656e 616d 653d  ..    _filename=
-00007390: 5f61 7267 732e 6765 7428 272d 6669 6c65  _args.get('-file
-000073a0: 6e61 6d65 2729 0d0a 2020 2020 5f75 726c  name')..    _url
-000073b0: 5570 6c6f 6164 3d5f 6172 6773 2e67 6574  Upload=_args.get
-000073c0: 2827 7572 6c5f 7570 6c6f 6164 2729 0d0a  ('url_upload')..
-000073d0: 2020 2020 6966 206e 6f74 205f 6669 6c65      if not _file
-000073e0: 6e61 6d65 2061 6e64 205f 7572 6c55 706c  name and _urlUpl
-000073f0: 6f61 643a 0d0a 2020 2020 2020 2020 7472  oad:..        tr
-00007400: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
-00007410: 5f69 6e70 7574 3d64 6f77 6e6c 6f61 6449  _input=downloadI
-00007420: 6d61 6765 285f 7572 6c55 706c 6f61 6429  mage(_urlUpload)
-00007430: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00007440: 205f 696e 7075 743a 0d0a 2020 2020 2020   _input:..      
-00007450: 2020 2020 2020 2020 2020 6141 7267 466f            aArgFo
-00007460: 7270 6172 7365 7241 492e 6170 7065 6e64  rparserAI.append
-00007470: 2822 2d66 696c 656e 616d 6522 290d 0a20  ("-filename").. 
-00007480: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00007490: 4172 6746 6f72 7061 7273 6572 4149 2e61  ArgForparserAI.a
-000074a0: 7070 656e 6428 5f69 6e70 7574 290d 0a20  ppend(_input).. 
-000074b0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000074c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000074d0: 2020 2323 206d 696e 2072 6571 7569 7265    ## min require
-000074e0: 6d65 6e74 730d 0a20 2020 2020 2020 2020  ments..         
-000074f0: 2020 2020 2020 2070 7269 6e74 2822 6e6f         print("no
-00007500: 2069 6d61 6765 2074 6f20 7072 6f63 6573   image to proces
-00007510: 7322 290d 0a20 2020 2020 2020 2020 2020  s")..           
-00007520: 2020 2020 2072 6574 7572 6e20 2269 6e70       return "inp
-00007530: 7574 2072 6571 7569 7265 6422 0d0a 2020  ut required"..  
-00007540: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
-00007550: 6570 7469 6f6e 2061 7320 6572 723a 0d0a  eption as err:..
-00007560: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00007570: 7428 2243 5249 5449 4341 4c3a 2022 2b65  t("CRITICAL: "+e
-00007580: 7272 2e6d 7367 290d 0a20 2020 2020 2020  rr.msg)..       
-00007590: 2020 2020 2072 6169 7365 2065 7272 0d0a       raise err..
-000075a0: 2020 2020 0d0a 2020 2020 2323 2049 6e69      ..    ## Ini
-000075b0: 7420 4f53 4149 5320 5061 7261 6d73 2028  t OSAIS Params (
-000075c0: 6672 6f6d 2061 6c6c 2061 7267 732c 206b  from all args, k
-000075d0: 6565 7020 6f6e 6c79 2074 686f 7365 2066  eep only those f
-000075e0: 6f72 204f 5341 4953 290d 0a20 2020 2061  or OSAIS)..    a
-000075f0: 4172 6746 6f72 5061 7273 6572 4f53 4149  ArgForParserOSAI
-00007600: 533d 5f67 6574 4172 6773 285f 6172 6773  S=_getArgs(_args
-00007610: 290d 0a20 2020 2061 7267 735f 4578 636c  )..    args_Excl
-00007620: 7573 6976 654f 5341 4953 2e61 7070 656e  usiveOSAIS.appen
-00007630: 6428 272d 6f64 6972 2729 0d0a 2020 2020  d('-odir')..    
-00007640: 6172 6773 5f45 7863 6c75 7369 7665 4f53  args_ExclusiveOS
-00007650: 4149 532e 6170 7065 6e64 2827 2d69 6469  AIS.append('-idi
-00007660: 7227 290d 0a20 2020 2061 4172 6746 6f72  r')..    aArgFor
-00007670: 5061 7273 6572 4f53 4149 533d 5f61 7267  ParserOSAIS=_arg
-00007680: 7346 726f 6d46 696c 7465 7228 6141 7267  sFromFilter(aArg
-00007690: 466f 7250 6172 7365 724f 5341 4953 2c20  ForParserOSAIS, 
-000076a0: 6172 6773 5f45 7863 6c75 7369 7665 4f53  args_ExclusiveOS
-000076b0: 4149 532c 2054 7275 6529 0d0a 2020 2020  AIS, True)..    
-000076c0: 6f73 6169 735f 696e 6974 5061 7273 6572  osais_initParser
-000076d0: 2861 4172 6746 6f72 5061 7273 6572 4f53  (aArgForParserOS
-000076e0: 4149 5329 0d0a 0d0a 2020 2020 6966 2067  AIS)....    if g
-000076f0: 4973 5761 726d 7570 3a0d 0a20 2020 2020  IsWarmup:..     
-00007700: 2020 2070 7269 6e74 2822 5c72 5c6e 3d3e     print("\r\n=>
-00007710: 2057 6172 6d69 6e67 2075 702e 2e2e 205c   Warming up... \
-00007720: 725c 6e22 290d 0a20 2020 2065 6c73 653a  r\n")..    else:
-00007730: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
-00007740: 225c 725c 6e3d 3e20 6265 666f 7265 2072  "\r\n=> before r
-00007750: 756e 3a20 7072 6f63 6573 7365 6420 6172  un: processed ar
-00007760: 6773 2066 726f 6d20 7572 6c3a 2022 2b73  gs from url: "+s
-00007770: 7472 2861 4172 6746 6f72 7061 7273 6572  tr(aArgForparser
-00007780: 4149 292b 225c 725c 6e22 290d 0a0d 0a20  AI)+"\r\n").... 
-00007790: 2020 2023 23c2 a070 726f 6365 7373 696e     ##..processin
-000077a0: 6720 6163 6365 7074 6564 0d0a 2020 2020  g accepted..    
-000077b0: 674c 6173 7450 726f 6365 7373 5374 6172  gLastProcessStar
-000077c0: 745f 6174 3d64 6174 6574 696d 652e 7574  t_at=datetime.ut
-000077d0: 636e 6f77 2829 0d0a 2020 2020 6741 5072  cnow()..    gAPr
-000077e0: 6f63 6573 7365 642e 6170 7065 6e64 285f  ocessed.append(_
-000077f0: 7569 6429 0d0a 0d0a 2020 2020 2323 206e  uid)....    ## n
-00007800: 6f74 6966 7920 4f53 4149 5320 2873 7461  otify OSAIS (sta
-00007810: 7274 290d 0a20 2020 2043 7265 6473 5061  rt)..    CredsPa
-00007820: 7261 6d3d 6765 7443 7265 6473 5061 7261  ram=getCredsPara
-00007830: 6d73 2829 0d0a 2020 2020 4d6f 7270 6869  ms()..    Morphi
-00007840: 6e67 5061 7261 6d3d 6765 744d 6f72 7068  ngParam=getMorph
-00007850: 696e 6750 6172 616d 7328 290d 0a20 2020  ingParams()..   
-00007860: 2053 7461 6765 5061 7261 6d3d 6765 7453   StageParam=getS
-00007870: 7461 6765 5061 7261 6d73 2841 495f 5052  tageParams(AI_PR
-00007880: 4f47 5245 5353 5f41 495f 5354 4152 5445  OGRESS_AI_STARTE
-00007890: 442c 2030 290d 0a20 2020 206f 7361 6973  D, 0)..    osais
-000078a0: 5f6e 6f74 6966 7928 4372 6564 7350 6172  _notify(CredsPar
-000078b0: 616d 2c20 4d6f 7270 6869 6e67 5061 7261  am, MorphingPara
-000078c0: 6d20 2c20 5374 6167 6550 6172 616d 290d  m , StageParam).
-000078d0: 0a0d 0a20 2020 2023 2320 7374 6172 7420  ...    ## start 
-000078e0: 7761 7463 6820 6669 6c65 2063 7265 6174  watch file creat
-000078f0: 696f 6e0d 0a20 2020 205f 6f75 7470 7574  ion..    _output
-00007900: 3d5f 6765 744f 7574 7075 7444 6972 2829  =_getOutputDir()
-00007910: 0d0a 2020 2020 7761 7463 685f 6469 7265  ..    watch_dire
-00007920: 6374 6f72 7928 5f6f 7574 7075 742c 206f  ctory(_output, o
-00007930: 7361 6973 5f6f 6e4e 6f74 6966 7946 696c  sais_onNotifyFil
-00007940: 6543 7265 6174 6564 2c20 5f61 7267 7329  eCreated, _args)
-00007950: 0d0a 0d0a 2020 2020 2323 204e 6f74 6966  ....    ## Notif
-00007960: 204f 5341 4953 0d0a 2020 2020 5374 6167   OSAIS..    Stag
-00007970: 6550 6172 616d 3d67 6574 5374 6167 6550  eParam=getStageP
-00007980: 6172 616d 7328 4149 5f50 524f 4752 4553  arams(AI_PROGRES
-00007990: 535f 494e 4954 5f49 4d41 4745 2c20 3029  S_INIT_IMAGE, 0)
-000079a0: 0d0a 2020 2020 6f73 6169 735f 6e6f 7469  ..    osais_noti
-000079b0: 6679 2843 7265 6473 5061 7261 6d2c 204d  fy(CredsParam, M
-000079c0: 6f72 7068 696e 6750 6172 616d 202c 2053  orphingParam , S
-000079d0: 7461 6765 5061 7261 6d29 0d0a 0d0a 2020  tageParam)....  
-000079e0: 2020 2323 2072 756e 2041 490d 0a20 2020    ## run AI..   
-000079f0: 2072 6573 706f 6e73 653d 4e6f 6e65 0d0a   response=None..
-00007a00: 2020 2020 7472 793a 0d0a 2020 2020 2020      try:..      
-00007a10: 2020 6966 206c 656e 2861 7267 7329 3d3d    if len(args)==
-00007a20: 323a 0d0a 2020 2020 2020 2020 2020 2020  2:..            
-00007a30: 7265 7370 6f6e 7365 3d66 6e5f 7275 6e28  response=fn_run(
-00007a40: 6141 7267 466f 7270 6172 7365 7241 4929  aArgForparserAI)
-00007a50: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00007a60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00007a70: 6c65 6e28 6172 6773 293d 3d33 3a0d 0a20  len(args)==3:.. 
-00007a80: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00007a90: 6573 706f 6e73 653d 666e 5f72 756e 2861  esponse=fn_run(a
-00007aa0: 4172 6746 6f72 7061 7273 6572 4149 2c20  ArgForparserAI, 
-00007ab0: 6172 6773 5b32 5d29 0d0a 2020 2020 2020  args[2])..      
-00007ac0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-00007ad0: 2020 2020 2020 2020 2020 2020 2072 6573               res
-00007ae0: 706f 6e73 653d 666e 5f72 756e 2861 4172  ponse=fn_run(aAr
-00007af0: 6746 6f72 7061 7273 6572 4149 2c20 6172  gForparserAI, ar
-00007b00: 6773 5b32 5d2c 2061 7267 735b 335d 290d  gs[2], args[3]).
-00007b10: 0a20 2020 2065 7863 6570 7420 4578 6365  .    except Exce
-00007b20: 7074 696f 6e20 6173 2065 7272 3a0d 0a20  ption as err:.. 
-00007b30: 2020 2020 2020 2070 7269 6e74 2822 4352         print("CR
-00007b40: 4954 4943 414c 3a20 222b 6572 722e 6d73  ITICAL: "+err.ms
-00007b50: 6729 0d0a 2020 2020 2020 2020 7261 6973  g)..        rais
-00007b60: 6520 6572 720d 0a0d 0a20 2020 2023 2320  e err....    ## 
-00007b70: 6361 6c63 756c 6174 6520 636f 7374 0d0a  calculate cost..
-00007b80: 2020 2020 6749 7342 7573 793d 4661 6c73      gIsBusy=Fals
-00007b90: 650d 0a20 2020 2065 6e64 5f64 6174 6520  e..    end_date 
-00007ba0: 3d20 6461 7465 7469 6d65 2e75 7463 6e6f  = datetime.utcno
-00007bb0: 7728 290d 0a20 2020 2064 656c 7461 3d65  w()..    delta=e
-00007bc0: 6e64 5f64 6174 6520 2d20 6265 675f 6461  nd_date - beg_da
-00007bd0: 7465 0d0a 2020 2020 636f 7374 203d 2069  te..    cost = i
-00007be0: 6e74 2864 656c 7461 2e74 6f74 616c 5f73  nt(delta.total_s
-00007bf0: 6563 6f6e 6473 2829 2a20 3130 3030 202b  econds()* 1000 +
-00007c00: 2064 656c 7461 2e6d 6963 726f 7365 636f   delta.microseco
-00007c10: 6e64 7320 2f20 3130 3030 290d 0a20 2020  nds / 1000)..   
-00007c20: 205f 6164 6443 6f73 7428 636f 7374 290d   _addCost(cost).
-00007c30: 0a0d 0a20 2020 2023 2320 6e6f 7469 6679  ...    ## notify
-00007c40: 2065 6e64 0d0a 2020 2020 5374 6167 6550   end..    StageP
-00007c50: 6172 616d 3d67 6574 5374 6167 6550 6172  aram=getStagePar
-00007c60: 616d 7328 4149 5f50 524f 4752 4553 535f  ams(AI_PROGRESS_
-00007c70: 4149 5f53 544f 5050 4544 2c20 636f 7374  AI_STOPPED, cost
-00007c80: 290d 0a20 2020 206f 7361 6973 5f6e 6f74  )..    osais_not
-00007c90: 6966 7928 4372 6564 7350 6172 616d 2c20  ify(CredsParam, 
-00007ca0: 4d6f 7270 6869 6e67 5061 7261 6d20 2c20  MorphingParam , 
-00007cb0: 5374 6167 6550 6172 616d 290d 0a0d 0a20  StageParam).... 
-00007cc0: 2020 2023 2320 6465 6661 756c 7420 4f4b     ## default OK
-00007cd0: 2072 6573 706f 6e73 6520 6966 2074 6865   response if the
-00007ce0: 2041 4920 646f 6573 206e 6f74 2073 656e   AI does not sen
-00007cf0: 6420 616e 790d 0a20 2020 2069 6620 7265  d any..    if re
-00007d00: 7370 6f6e 7365 3d3d 4e6f 6e65 3a0d 0a20  sponse==None:.. 
-00007d10: 2020 2020 2020 2072 6573 706f 6e73 653d         response=
-00007d20: 5472 7565 0d0a 2020 2020 7265 7475 726e  True..    return
-00007d30: 2072 6573 706f 6e73 650d 0a0d 0a23 2320   response....## 
-00007d40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00007d50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00007d60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00007d70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00007d80: 2d2d 2d2d 2d2d 2d2d 0d0a 2320 2020 2020  --------..#     
-00007d90: 2020 6765 7420 666f 726d 6174 7465 6420    get formatted 
-00007da0: 7061 7261 6d73 2066 726f 6d20 4149 2063  params from AI c
-00007db0: 7572 7265 6e74 2073 7461 7465 0d0a 2323  urrent state..##
-00007dc0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00007dd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00007de0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002d70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002d80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002d90: 2d2d 2d2d 0d0a 2320 2020 2020 2020 4f53  ----..#       OS
+00002da0: 4149 5320 7079 7468 6f6e 204c 6962 2028  AIS python Lib (
+00002db0: 696e 7465 7266 6163 6520 6265 7477 6565  interface betwee
+00002dc0: 6e20 4149 7320 616e 6420 4f53 4149 5329  n AIs and OSAIS)
+00002dd0: 0d0a 2323 202d 2d2d 2d2d 2d2d 2d2d 2d2d  ..## -----------
+00002de0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002df0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002e00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002e10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d  -------------...
+00002e20: 0a69 6d70 6f72 7420 7265 7175 6573 7473  .import requests
+00002e30: 0d0a 696d 706f 7274 2073 6368 6564 756c  ..import schedul
+00002e40: 650d 0a69 6d70 6f72 7420 6a73 6f6e 0d0a  e..import json..
+00002e50: 696d 706f 7274 2073 7973 0d0a 696d 706f  import sys..impo
+00002e60: 7274 2062 6173 6536 340d 0a66 726f 6d20  rt base64..from 
+00002e70: 6461 7465 7469 6d65 2069 6d70 6f72 7420  datetime import 
+00002e80: 6461 7465 7469 6d65 0d0a 696d 706f 7274  datetime..import
+00002e90: 2061 7267 7061 7273 650d 0a0d 0a23 2320   argparse....## 
+00002ea0: 6672 6f6d 206f 7361 6973 5f75 7469 6c73  from osais_utils
+00002eb0: 2069 6d70 6f72 7420 6765 7448 6f73 7449   import getHostI
+00002ec0: 6e66 6f2c 206c 6973 7444 6972 436f 6e74  nfo, listDirCont
+00002ed0: 656e 742c 2069 735f 7275 6e6e 696e 675f  ent, is_running_
+00002ee0: 696e 5f64 6f63 6b65 722c 2067 6574 5f65  in_docker, get_e
+00002ef0: 7874 6572 6e61 6c5f 6970 2c20 6765 745f  xternal_ip, get_
+00002f00: 636f 6e74 6169 6e65 725f 6970 2c20 6765  container_ip, ge
+00002f10: 745f 6d61 6368 696e 655f 6e61 6d65 2c20  t_machine_name, 
+00002f20: 6765 745f 6f73 5f6e 616d 652c 2067 6574  get_os_name, get
+00002f30: 4375 6461 496e 666f 2c20 646f 776e 6c6f  CudaInfo, downlo
+00002f40: 6164 496d 6167 652c 2073 7461 7274 5f6f  adImage, start_o
+00002f50: 6273 6572 7665 725f 7468 7265 6164 2c20  bserver_thread, 
+00002f60: 636c 6561 724f 6c64 4669 6c65 732c 2073  clearOldFiles, s
+00002f70: 7461 7274 5f6e 6f74 6966 6963 6174 696f  tart_notificatio
+00002f80: 6e5f 7468 7265 6164 0d0a 0d0a 2323 202d  n_thread....## -
+00002f90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002fa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002fb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002fc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00002fd0: 2d2d 2d2d 2d2d 2d0d 0a23 2020 2020 2020  -------..#      
+00002fe0: 2061 6c6c 2067 6c6f 6261 6c20 7661 7273   all global vars
+00002ff0: 0d0a 2323 202d 2d2d 2d2d 2d2d 2d2d 2d2d  ..## -----------
+00003000: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003010: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003020: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003030: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d  -------------...
+00003040: 0a67 5665 7273 696f 6e4c 6962 4f53 4149  .gVersionLibOSAI
+00003050: 533d 5f5f 7665 7273 696f 6e5f 5f20 2020  S=__version__   
+00003060: 2023 2320 7665 7273 696f 6e20 6f66 2074   ## version of t
+00003070: 6869 7320 6c69 6272 6172 7920 2874 6f20  his library (to 
+00003080: 6b65 6570 2069 7420 6c61 7465 7374 2065  keep it latest e
+00003090: 7665 7279 7768 6572 6529 0d0a 6755 7365  verywhere)..gUse
+000030a0: 726e 616d 653d 4e6f 6e65 2020 2020 2020  rname=None      
+000030b0: 2020 2020 2020 2020 2020 2020 2323 2075              ## u
+000030c0: 7365 7220 6f77 6e69 6e67 2074 6869 7320  ser owning this 
+000030d0: 4149 2028 6e65 6365 7373 6172 7920 746f  AI (necessary to
+000030e0: 2063 6c61 696d 2056 6972 7441 4920 7265   claim VirtAI re
+000030f0: 6773 290d 0a0d 0a67 4e61 6d65 3d4e 6f6e  gs)....gName=Non
+00003100: 6520 2020 2020 2020 2020 2020 2020 2020  e               
+00003110: 2020 2020 2020 2023 2320 6e61 6d65 206f         ## name o
+00003120: 6620 7468 6973 2041 4920 286e 616d 6520  f this AI (name 
+00003130: 6f66 2065 6e67 696e 6529 0d0a 6756 6572  of engine)..gVer
+00003140: 7369 6f6e 3d22 302e 302e 3022 2020 2020  sion="0.0.0"    
+00003150: 2020 2020 2020 2020 2020 2020 2323 206e              ## n
+00003160: 616d 6520 6f66 2074 6869 7320 4149 2773  ame of this AI's
+00003170: 2076 6572 7369 6f6e 2028 7665 7273 696f   version (versio
+00003180: 6e20 6f66 2065 6e67 696e 6529 0d0a 6744  n of engine)..gD
+00003190: 6573 6372 6970 7469 6f6e 3d4e 6f6e 6520  escription=None 
+000031a0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+000031b0: 2041 4927 7320 7175 6963 6b20 6465 7363   AI's quick desc
+000031c0: 7269 7074 696f 6e0d 0a67 4f72 6967 696e  ription..gOrigin
+000031d0: 3d4e 6f6e 6520 2020 2020 2020 2020 2020  =None           
+000031e0: 2020 2020 2020 2020 2023 2320 7768 6572           ## wher
+000031f0: 6520 7468 6973 2041 4920 6361 6d65 2066  e this AI came f
+00003200: 726f 6d20 286f 6e20 696e 7465 726e 6574  rom (on internet
+00003210: 290d 0a67 4d61 6368 696e 654e 616d 653d  )..gMachineName=
+00003220: 6765 745f 6d61 6368 696e 655f 6e61 6d65  get_machine_name
+00003230: 2829 2023 2320 7468 6520 6e61 6d65 206f  () ## the name o
+00003240: 6620 7468 6520 6d61 6368 696e 6520 2877  f the machine (w
+00003250: 696c 6c20 6368 616e 6765 2061 6c6c 2074  ill change all t
+00003260: 6865 2074 696d 6520 6966 2069 6e73 6964  he time if insid
+00003270: 6520 646f 636b 6572 2c20 6f74 206b 6565  e docker, ot kee
+00003280: 7020 7361 6d65 2069 6620 7275 6e6e 696e  p same if runnin
+00003290: 6720 6f6e 206c 6f63 616c 2073 6572 7665  g on local serve
+000032a0: 7229 0d0a 674c 6173 7443 6865 636b 6564  r)..gLastChecked
+000032b0: 5f61 743d 6461 7465 7469 6d65 2e75 7463  _at=datetime.utc
+000032c0: 6e6f 7728 2920 2023 2320 7768 656e 2077  now()  ## when w
+000032d0: 6173 2074 6869 7320 4149 206c 6173 7420  as this AI last 
+000032e0: 7573 6564 2066 6f72 2070 726f 6365 7373  used for process
+000032f0: 696e 6720 616e 7974 6869 6e67 0d0a 674c  ing anything..gL
+00003300: 6173 7450 726f 6365 7373 5374 6172 745f  astProcessStart_
+00003310: 6174 3d4e 6f6e 6520 2020 2020 2020 2323  at=None       ##
+00003320: 2077 6865 6e20 7761 7320 7468 6973 2041   when was this A
+00003330: 4920 6c61 7374 2073 7461 7274 2065 7665  I last start eve
+00003340: 6e74 2066 6f72 2070 726f 6365 7373 696e  nt for processin
+00003350: 6720 616e 7974 6869 6e67 0d0a 0d0a 2323  g anything....##
+00003360: 2061 7574 6865 6e74 6963 6174 6520 696e   authenticate in
+00003370: 746f 204f 5341 4953 0d0a 6741 7574 6854  to OSAIS..gAuthT
+00003380: 6f6b 656e 3d4e 6f6e 6520 2020 2020 2020  oken=None       
+00003390: 2020 2020 2020 2020 2020 2323 2061 7574            ## aut
+000033a0: 6820 746f 6b65 6e20 696e 746f 204f 5341  h token into OSA
+000033b0: 4953 2066 6f72 2077 6865 6e20 776f 726b  IS for when work
+000033c0: 696e 6720 6173 2076 6972 7475 616c 2041  ing as virtual A
+000033d0: 690d 0a67 546f 6b65 6e3d 4e6f 6e65 2020  i..gToken=None  
+000033e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000033f0: 2020 2023 2320 746f 6b65 6e20 7573 6564     ## token used
+00003400: 2066 6f72 2061 7574 6865 6e74 6963 6174   for authenticat
+00003410: 696f 6e20 696e 746f 204f 5341 4953 0d0a  ion into OSAIS..
+00003420: 6753 6563 7265 743d 4e6f 6e65 2020 2020  gSecret=None    
+00003430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003440: 2323 2073 6563 7265 7420 7573 6564 2066  ## secret used f
+00003450: 6f72 2061 7574 6865 6e74 6963 6174 696f  or authenticatio
+00003460: 6e20 696e 746f 204f 5341 4953 0d0a 674f  n into OSAIS..gO
+00003470: 7269 6769 6e4f 5341 4953 3d4e 6f6e 6520  riginOSAIS=None 
+00003480: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+00003490: 206c 6f63 6174 696f 6e20 6f66 204f 5341   location of OSA
+000034a0: 4953 0d0a 0d0a 2323 2061 7574 6865 6e74  IS....## authent
+000034b0: 6963 6174 6520 696e 746f 2061 206c 6f63  icate into a loc
+000034c0: 616c 204f 5341 4953 2028 6465 6275 6729  al OSAIS (debug)
+000034d0: 0d0a 6741 7574 6854 6f6b 656e 4c6f 6361  ..gAuthTokenLoca
+000034e0: 6c3d 4e6f 6e65 2020 2020 2020 2020 2020  l=None          
+000034f0: 2020 2323 2061 7574 6820 746f 6b65 6e20    ## auth token 
+00003500: 696e 746f 2061 206c 6f63 616c 204f 5341  into a local OSA
+00003510: 4953 2028 6465 6275 6729 2066 6f72 2077  IS (debug) for w
+00003520: 6865 6e20 776f 726b 696e 6720 6173 2076  hen working as v
+00003530: 6972 7475 616c 2041 690d 0a67 546f 6b65  irtual Ai..gToke
+00003540: 6e4c 6f63 616c 3d4e 6f6e 6520 2020 2020  nLocal=None     
+00003550: 2020 2020 2020 2020 2020 2023 2320 746f             ## to
+00003560: 6b65 6e20 7573 6564 2066 6f72 2061 7574  ken used for aut
+00003570: 6865 6e74 6963 6174 696f 6e20 696e 746f  hentication into
+00003580: 2061 206c 6f63 616c 204f 5341 4953 2028   a local OSAIS (
+00003590: 6465 6275 6729 0d0a 6753 6563 7265 744c  debug)..gSecretL
+000035a0: 6f63 616c 3d4e 6f6e 6520 2020 2020 2020  ocal=None       
+000035b0: 2020 2020 2020 2020 2323 2073 6563 7265          ## secre
+000035c0: 7420 7573 6564 2066 6f72 2061 7574 6865  t used for authe
+000035d0: 6e74 6963 6174 696f 6e20 696e 746f 2061  ntication into a
+000035e0: 206c 6f63 616c 204f 5341 4953 2028 6465   local OSAIS (de
+000035f0: 6275 6729 0d0a 674f 7269 6769 6e4c 6f63  bug)..gOriginLoc
+00003600: 616c 4f53 4149 533d 4e6f 6e65 2020 2020  alOSAIS=None    
+00003610: 2020 2020 2020 2323 206c 6f63 6174 696f        ## locatio
+00003620: 6e20 6f66 2061 206c 6f63 616c 204f 5341  n of a local OSA
+00003630: 4953 2028 6465 6275 6729 0d0a 0d0a 674f  IS (debug)....gO
+00003640: 7269 6769 6e47 6174 6577 6179 3d4e 6f6e  riginGateway=Non
+00003650: 6520 2020 2020 2020 2020 2020 2020 2323  e             ##
+00003660: 206c 6f63 6174 696f 6e20 6f66 2074 6865   location of the
+00003670: 206c 6f63 616c 2067 6174 6577 6179 2066   local gateway f
+00003680: 6f72 2074 6869 7320 286c 6f63 616c 2920  or this (local) 
+00003690: 4149 0d0a 0d0a 2323 2049 5020 616e 6420  AI....## IP and 
+000036a0: 506f 7274 730d 0a67 4578 7449 503d 6765  Ports..gExtIP=ge
+000036b0: 745f 6578 7465 726e 616c 5f69 7028 2920  t_external_ip() 
+000036c0: 2020 2020 2020 2023 2320 7768 6572 6520         ## where 
+000036d0: 7468 6973 2041 4920 6361 6e20 6265 2061  this AI can be a
+000036e0: 6363 6573 7365 6420 6672 6f6d 206f 7574  ccessed from out
+000036f0: 7369 6465 2028 4950 290d 0a67 4950 4c6f  side (IP)..gIPLo
+00003700: 6361 6c3d 6765 745f 636f 6e74 6169 6e65  cal=get_containe
+00003710: 725f 6970 2829 2020 2020 2023 2320 7768  r_ip()     ## wh
+00003720: 6572 6520 7468 6973 2041 4920 6361 6e20  ere this AI can 
+00003730: 6265 2061 6363 6573 7365 6420 6c6f 6361  be accessed loca
+00003740: 6c6c 790d 0a67 506f 7274 4149 3d4e 6f6e  lly..gPortAI=Non
+00003750: 6520 2020 2020 2020 2020 2020 2020 2020  e               
+00003760: 2020 2020 2023 2320 706f 7274 2077 6865       ## port whe
+00003770: 7265 2074 6869 7320 4149 2069 7320 6163  re this AI is ac
+00003780: 6365 7373 6564 2028 7769 6c6c 2062 6520  cessed (will be 
+00003790: 7365 7420 6279 2041 4920 636f 6e66 6967  set by AI config
+000037a0: 290d 0a67 506f 7274 4761 7465 7761 793d  )..gPortGateway=
+000037b0: 3330 3233 2020 2020 2020 2020 2020 2020  3023            
+000037c0: 2020 2023 2320 706f 7274 2077 6865 7265     ## port where
+000037d0: 2074 6865 2067 6174 6577 6179 2063 616e   the gateway can
+000037e0: 2062 6520 6163 6365 7373 6564 0d0a 6750   be accessed..gP
+000037f0: 6f72 744c 6f63 616c 4f53 4149 533d 3330  ortLocalOSAIS=30
+00003800: 3232 2020 2020 2020 2020 2020 2020 2323  22            ##
+00003810: 2070 6f72 7420 7768 6572 6520 6120 6c6f   port where a lo
+00003820: 6361 6c20 4f53 4149 5320 6361 6e20 6265  cal OSAIS can be
+00003830: 2061 6363 6573 7365 640d 0a0d 0a23 2320   accessed....## 
+00003840: 7669 7274 7561 6c20 4149 202f 206c 6f63  virtual AI / loc
+00003850: 616c 202f 646f 636b 6572 203f 0d0a 6749  al /docker ?..gI
+00003860: 7344 6f63 6b65 723d 6973 5f72 756e 6e69  sDocker=is_runni
+00003870: 6e67 5f69 6e5f 646f 636b 6572 2829 2020  ng_in_docker()  
+00003880: 2023 2320 6172 6520 7765 2072 756e 6e69   ## are we runni
+00003890: 6e67 2069 6e20 6120 446f 636b 6572 3f0d  ng in a Docker?.
+000038a0: 0a67 4973 5669 7274 7561 6c41 493d 4661  .gIsVirtualAI=Fa
+000038b0: 6c73 6520 2020 2020 2020 2020 2020 2020  lse             
+000038c0: 2023 2320 6172 6520 7765 2077 6f72 6b69   ## are we worki
+000038d0: 6e67 2061 7320 6120 5669 7274 7561 6c20  ng as a Virtual 
+000038e0: 4149 2063 6f6e 6669 673f 0d0a 6749 734c  AI config?..gIsL
+000038f0: 6f63 616c 3d46 616c 7365 2020 2020 2020  ocal=False      
+00003900: 2020 2020 2020 2020 2020 2020 2323 2061              ## a
+00003910: 7265 2077 6520 776f 726b 696e 6720 6c6f  re we working lo
+00003920: 6361 6c6c 7920 286c 6f63 616c 686f 7374  cally (localhost
+00003930: 2073 6572 7665 7229 3f0d 0a0d 0a23 2320   server)?....## 
+00003940: 7465 6d70 2063 6163 6865 0d0a 6741 5072  temp cache..gAPr
+00003950: 6f63 6573 7365 643d 5b5d 2020 2020 2020  ocessed=[]      
+00003960: 2020 2020 2020 2020 2020 2020 2323 2061              ## a
+00003970: 6c6c 2074 6f6b 656e 2062 6569 6e67 2073  ll token being s
+00003980: 656e 7420 746f 2070 726f 6365 7373 696e  ent to processin
+00003990: 6720 286e 6576 6572 2063 616c 6c20 7477  g (never call tw
+000039a0: 6963 6520 666f 7220 7361 6d65 290d 0a67  ice for same)..g
+000039b0: 4973 5363 6865 6475 6c65 643d 4661 6c73  IsScheduled=Fals
+000039c0: 6520 2020 2020 2020 2020 2020 2020 2023  e              #
+000039d0: 2320 646f 2077 6520 6861 7665 2061 2073  # do we have a s
+000039e0: 6368 6564 756c 6564 2065 7665 6e74 2072  cheduled event r
+000039f0: 756e 6e69 6e67 3f0d 0a0d 0a23 2320 7275  unning?....## ru
+00003a00: 6e20 7469 6d65 730d 0a67 4973 5761 726d  n times..gIsWarm
+00003a10: 7570 3d46 616c 7365 2020 2020 2020 2020  up=False        
+00003a20: 2020 2020 2020 2020 2023 2320 5472 7565           ## True
+00003a30: 2069 6620 7468 6520 7265 7175 6573 7420   if the request 
+00003a40: 7761 7320 6120 7761 726d 7570 206f 6e65  was a warmup one
+00003a50: 2028 6e6f 7420 6120 7472 7565 206f 6e65   (not a true one
+00003a60: 2066 726f 6d20 636c 6965 6e74 290d 0a67   from client)..g
+00003a70: 4973 4275 7379 3d46 616c 7365 2020 2020  IsBusy=False    
+00003a80: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00003a90: 2320 5472 7565 2069 6620 4149 2062 7573  # True if AI bus
+00003aa0: 7920 7072 6f63 6573 7369 6e67 0d0a 6744  y processing..gD
+00003ab0: 6566 6175 6c74 436f 7374 3d31 3030 3020  efaultCost=1000 
+00003ac0: 2020 2020 2020 2020 2020 2020 2020 2323                ##
+00003ad0: 2064 6566 6175 6c74 2063 6f73 7420 7661   default cost va
+00003ae0: 6c75 6520 696e 206d 7320 2877 696c 6c20  lue in ms (will 
+00003af0: 6765 7420 6f76 6572 7269 6465 6e20 6661  get overriden fa
+00003b00: 7374 2c20 7468 6973 2076 616c 7565 2069  st, this value i
+00003b10: 7320 6e6f 2062 6967 2064 6561 6c29 0d0a  s no big deal)..
+00003b20: 6761 5072 6f63 6573 7354 696d 653d 5b5d  gaProcessTime=[]
+00003b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003b40: 2323 2041 7272 6179 206f 6620 6c61 7374  ## Array of last
+00003b50: 2078 2028 3130 2f32 303f 2920 7469 6d65   x (10/20?) time
+00003b60: 2073 7065 6e74 2066 6f72 2070 726f 6365   spent for proce
+00003b70: 7373 6564 2072 6571 7565 7374 7320 0d0a  ssed requests ..
+00003b80: 0d0a 2323 2070 726f 6365 7373 696e 6720  ..## processing 
+00003b90: 7370 6563 6966 6963 730d 0a67 4172 6773  specifics..gArgs
+00003ba0: 4f53 4149 533d 4e6f 6e65 2020 2020 2020  OSAIS=None      
+00003bb0: 2020 2020 2020 2020 2020 2023 2320 7468             ## th
+00003bc0: 6520 6172 6773 2070 6173 7365 6420 746f  e args passed to
+00003bd0: 2074 6865 2041 4920 7768 6963 6820 6172   the AI which ar
+00003be0: 6520 7370 6563 6966 6963 2074 6f20 4f53  e specific to OS
+00003bf0: 4149 5320 666f 7220 7365 6e64 696e 6720  AIS for sending 
+00003c00: 6e6f 7469 6669 6361 7469 6f6e 730d 0a0d  notifications...
+00003c10: 0a23 2320 7768 656e 2072 756e 6e69 6e67  .## when running
+00003c20: 2061 7320 7641 490d 0a67 496e 7075 7444   as vAI..gInputD
+00003c30: 6972 3d22 2e2f 5f69 6e70 7574 2f22 0d0a  ir="./_input/"..
+00003c40: 674f 7574 7075 7444 6972 3d22 2e2f 5f6f  gOutputDir="./_o
+00003c50: 7574 7075 742f 220d 0a0d 0a41 495f 5052  utput/"....AI_PR
+00003c60: 4f47 5245 5353 5f45 5252 4f52 3d2d 310d  OGRESS_ERROR=-1.
+00003c70: 0a41 495f 5052 4f47 5245 5353 5f49 444c  .AI_PROGRESS_IDL
+00003c80: 453d 3020 2020 2020 2020 2020 2020 2020  E=0             
+00003c90: 2020 2020 2023 2075 6e75 7365 640d 0a41       # unused..A
+00003ca0: 495f 5052 4f47 5245 5353 5f41 5247 533d  I_PROGRESS_ARGS=
+00003cb0: 3120 2020 2020 2020 2020 2020 2020 2020  1               
+00003cc0: 2020 2023 2075 6e75 7365 640d 0a41 495f     # unused..AI_
+00003cd0: 5052 4f47 5245 5353 5f41 495f 5354 4152  PROGRESS_AI_STAR
+00003ce0: 5445 443d 320d 0a41 495f 5052 4f47 5245  TED=2..AI_PROGRE
+00003cf0: 5353 5f49 4e49 545f 494d 4147 453d 330d  SS_INIT_IMAGE=3.
+00003d00: 0a41 495f 5052 4f47 5245 5353 5f44 4f4e  .AI_PROGRESS_DON
+00003d10: 455f 494d 4147 453d 340d 0a41 495f 5052  E_IMAGE=4..AI_PR
+00003d20: 4f47 5245 5353 5f41 495f 5354 4f50 5045  OGRESS_AI_STOPPE
+00003d30: 443d 350d 0a0d 0a23 2320 2d2d 2d2d 2d2d  D=5....## ------
+00003d40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003d50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003d60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003d70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003d80: 2d2d 0d0a 2320 2020 2020 2020 4c6f 6164  --..#       Load
+00003d90: 2063 6f6e 6669 670d 0a23 2320 2d2d 2d2d   config..## ----
+00003da0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003db0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003dc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003dd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003de0: 2d2d 2d2d 0d0a 0d0a 2320 6c6f 6164 2074  ----....# load t
+00003df0: 6865 2063 6f6e 6669 6720 6669 6c65 2069  he config file i
+00003e00: 6e74 6f20 6120 4a53 4f4e 0d0a 6465 6620  nto a JSON..def 
+00003e10: 5f6c 6f61 6443 6f6e 6669 6728 5f6e 616d  _loadConfig(_nam
+00003e20: 6529 3a20 0d0a 2020 2020 676c 6f62 616c  e): ..    global
+00003e30: 2067 5665 7273 696f 6e0d 0a20 2020 2067   gVersion..    g
+00003e40: 6c6f 6261 6c20 6744 6573 6372 6970 7469  lobal gDescripti
+00003e50: 6f6e 0d0a 2020 2020 676c 6f62 616c 2067  on..    global g
+00003e60: 4f72 6967 696e 0d0a 2020 2020 676c 6f62  Origin..    glob
+00003e70: 616c 2067 4465 6661 756c 7443 6f73 740d  al gDefaultCost.
+00003e80: 0a0d 0a20 2020 205f 6a73 6f6e 203d 204e  ...    _json = N
+00003e90: 6f6e 650d 0a20 2020 205f 6469 7246 696c  one..    _dirFil
+00003ea0: 653d 4e6f 6e65 0d0a 2020 2020 7472 793a  e=None..    try:
+00003eb0: 0d0a 2020 2020 2020 2020 6672 6f6d 2070  ..        from p
+00003ec0: 6174 686c 6962 2069 6d70 6f72 7420 5061  athlib import Pa
+00003ed0: 7468 0d0a 2020 2020 2020 2020 6375 7272  th..        curr
+00003ee0: 656e 745f 776f 726b 696e 675f 6469 7265  ent_working_dire
+00003ef0: 6374 6f72 7920 3d20 5061 7468 2e63 7764  ctory = Path.cwd
+00003f00: 2829 0d0a 2020 2020 2020 2020 5f64 6972  ()..        _dir
+00003f10: 4669 6c65 3d66 277b 6375 7272 656e 745f  File=f'{current_
+00003f20: 776f 726b 696e 675f 6469 7265 6374 6f72  working_director
+00003f30: 797d 2f7b 5f6e 616d 657d 2e6a 736f 6e27  y}/{_name}.json'
+00003f40: 0d0a 2020 2020 2020 2020 664a 534f 4e20  ..        fJSON 
+00003f50: 3d20 6f70 656e 285f 6469 7246 696c 6529  = open(_dirFile)
+00003f60: 0d0a 2020 2020 2020 2020 5f6a 736f 6e20  ..        _json 
+00003f70: 3d20 6a73 6f6e 2e6c 6f61 6428 664a 534f  = json.load(fJSO
+00003f80: 4e29 0d0a 2020 2020 6578 6365 7074 2045  N)..    except E
+00003f90: 7863 6570 7469 6f6e 2061 7320 6572 723a  xception as err:
+00003fa0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+00003fb0: 6627 4352 4954 4943 414c 3a20 4e6f 2063  f'CRITICAL: No c
+00003fc0: 6f6e 6669 6720 6669 6c65 207b 5f64 6972  onfig file {_dir
+00003fd0: 4669 6c65 7d27 290d 0a20 2020 2020 2020  File}')..       
+00003fe0: 2073 7973 2e65 7869 7428 290d 0a0d 0a20   sys.exit().... 
+00003ff0: 2020 2067 5665 7273 696f 6e3d 5f6a 736f     gVersion=_jso
+00004000: 6e5b 2276 6572 7369 6f6e 225d 0d0a 2020  n["version"]..  
+00004010: 2020 6744 6573 6372 6970 7469 6f6e 3d5f    gDescription=_
+00004020: 6a73 6f6e 5b22 6465 7363 7269 7074 696f  json["descriptio
+00004030: 6e22 5d0d 0a20 2020 2067 4f72 6967 696e  n"]..    gOrigin
+00004040: 3d5f 6a73 6f6e 5b22 6f72 6967 696e 225d  =_json["origin"]
+00004050: 0d0a 2020 2020 5f63 6f73 743d 5f6a 736f  ..    _cost=_jso
+00004060: 6e5b 2264 6566 6175 6c74 5f63 6f73 7422  n["default_cost"
+00004070: 5d0d 0a20 2020 2069 6620 5f63 6f73 7421  ]..    if _cost!
+00004080: 3d4e 6f6e 653a 0d0a 2020 2020 2020 2020  =None:..        
+00004090: 6744 6566 6175 6c74 436f 7374 3d5f 636f  gDefaultCost=_co
+000040a0: 7374 0d0a 0d0a 2020 2020 7265 7475 726e  st....    return
+000040b0: 205f 6a73 6f6e 0d0a 0d0a 2320 6765 7420   _json....# get 
+000040c0: 7468 6520 6675 6c6c 2041 4920 636f 6e66  the full AI conf
+000040d0: 6967 2c20 696e 636c 7564 696e 6720 4a53  ig, including JS
+000040e0: 4f4e 2070 6172 616d 7320 616e 6420 6861  ON params and ha
+000040f0: 7264 7761 7265 2069 6e66 6f0d 0a64 6566  rdware info..def
+00004100: 205f 6765 7446 756c 6c43 6f6e 6669 6728   _getFullConfig(
+00004110: 5f6e 616d 6529 203a 0d0a 2020 2020 676c  _name) :..    gl
+00004120: 6f62 616c 2067 5573 6572 6e61 6d65 0d0a  obal gUsername..
+00004130: 2020 2020 676c 6f62 616c 2067 506f 7274      global gPort
+00004140: 4149 0d0a 2020 2020 676c 6f62 616c 2067  AI..    global g
+00004150: 4e61 6d65 0d0a 2020 2020 676c 6f62 616c  Name..    global
+00004160: 2067 546f 6b65 6e0d 0a20 2020 2067 6c6f   gToken..    glo
+00004170: 6261 6c20 6753 6563 7265 740d 0a20 2020  bal gSecret..   
+00004180: 2067 6c6f 6261 6c20 674f 7269 6769 6e4f   global gOriginO
+00004190: 5341 4953 0d0a 2020 2020 676c 6f62 616c  SAIS..    global
+000041a0: 2067 546f 6b65 6e4c 6f63 616c 0d0a 2020   gTokenLocal..  
+000041b0: 2020 676c 6f62 616c 2067 5365 6372 6574    global gSecret
+000041c0: 4c6f 6361 6c0d 0a20 2020 2067 6c6f 6261  Local..    globa
+000041d0: 6c20 674f 7269 6769 6e4c 6f63 616c 4f53  l gOriginLocalOS
+000041e0: 4149 530d 0a20 2020 2067 6c6f 6261 6c20  AIS..    global 
+000041f0: 6749 7356 6972 7475 616c 4149 0d0a 2020  gIsVirtualAI..  
+00004200: 2020 676c 6f62 616c 2067 4950 4c6f 6361    global gIPLoca
+00004210: 6c0d 0a20 2020 2067 6c6f 6261 6c20 6745  l..    global gE
+00004220: 7874 4950 0d0a 200d 0a20 2020 205f 6970  xtIP.. ..    _ip
+00004230: 3d67 4578 7449 500d 0a20 2020 2069 6620  =gExtIP..    if 
+00004240: 6749 7356 6972 7475 616c 4149 3d3d 4661  gIsVirtualAI==Fa
+00004250: 6c73 653a 0d0a 2020 2020 2020 2020 5f69  lse:..        _i
+00004260: 703d 6749 504c 6f63 616c 2020 2020 2020  p=gIPLocal      
+00004270: 2020 2020 2020 2020 2020 2323 2077 6520            ## we 
+00004280: 7265 6769 7374 6572 2077 6974 6820 6c6f  register with lo
+00004290: 6361 6c20 6970 2069 6620 7765 2061 7265  cal ip if we are
+000042a0: 2069 6e20 6c6f 6361 6c20 6761 7465 7761   in local gatewa
+000042b0: 7920 6d6f 6465 0d0a 0d0a 2020 2020 5f6a  y mode....    _j
+000042c0: 736f 6e3d 5f6c 6f61 6443 6f6e 6669 6728  son=_loadConfig(
+000042d0: 5f6e 616d 6529 0d0a 0d0a 2020 2020 6f62  _name)....    ob
+000042e0: 6a43 7564 6149 6e66 6f3d 6765 7443 7564  jCudaInfo=getCud
+000042f0: 6149 6e66 6f28 290d 0a20 2020 2067 7075  aInfo()..    gpu
+00004300: 4e61 6d65 3d22 6e6f 2047 5055 220d 0a20  Name="no GPU".. 
+00004310: 2020 2069 6620 6f62 6a43 7564 6149 6e66     if objCudaInf
+00004320: 6f20 213d 2030 2061 6e64 2022 6e61 6d65  o != 0 and "name
+00004330: 2220 696e 206f 626a 4375 6461 496e 666f  " in objCudaInfo
+00004340: 2061 6e64 206f 626a 4375 6461 496e 666f   and objCudaInfo
+00004350: 5b22 6e61 6d65 225d 3a0d 0a20 2020 2020  ["name"]:..     
+00004360: 2020 2067 7075 4e61 6d65 3d6f 626a 4375     gpuName=objCu
+00004370: 6461 496e 666f 5b22 6e61 6d65 225d 0d0a  daInfo["name"]..
+00004380: 0d0a 2020 2020 7265 7475 726e 207b 0d0a  ..    return {..
+00004390: 2020 2020 2020 2020 2275 7365 726e 616d          "usernam
+000043a0: 6522 3a20 6755 7365 726e 616d 652c 0d0a  e": gUsername,..
+000043b0: 2020 2020 2020 2020 226f 7322 3a20 6765          "os": ge
+000043c0: 745f 6f73 5f6e 616d 6528 292c 0d0a 2020  t_os_name(),..  
+000043d0: 2020 2020 2020 2267 7075 223a 2067 7075        "gpu": gpu
+000043e0: 4e61 6d65 2c0d 0a20 2020 2020 2020 2022  Name,..        "
+000043f0: 6d61 6368 696e 6522 3a20 6765 745f 6d61  machine": get_ma
+00004400: 6368 696e 655f 6e61 6d65 2829 2c0d 0a20  chine_name(),.. 
+00004410: 2020 2020 2020 2022 6970 223a 205f 6970         "ip": _ip
+00004420: 2c0d 0a20 2020 2020 2020 2022 706f 7274  ,..        "port
+00004430: 223a 2067 506f 7274 4149 2c0d 0a20 2020  ": gPortAI,..   
+00004440: 2020 2020 2022 656e 6769 6e65 223a 205f       "engine": _
+00004450: 6a73 6f6e 0d0a 2020 2020 7d0d 0a0d 0a23  json..    }....#
+00004460: 2320 5055 424c 4943 202d 2061 7265 2077  # PUBLIC - are w
+00004470: 6520 7275 6e6e 696e 6720 6c6f 6361 6c6c  e running locall
+00004480: 793f 0d0a 6465 6620 6f73 6169 735f 6973  y?..def osais_is
+00004490: 4c6f 6361 6c28 293a 0d0a 2020 2020 676c  Local():..    gl
+000044a0: 6f62 616c 2067 4973 4c6f 6361 6c0d 0a20  obal gIsLocal.. 
+000044b0: 2020 2072 6574 7572 6e20 6749 734c 6f63     return gIsLoc
+000044c0: 616c 0d0a 0d0a 2323 2050 5542 4c49 4320  al....## PUBLIC 
+000044d0: 2d20 6c6f 6164 2074 6865 2063 6f6e 6669  - load the confi
+000044e0: 6720 6f66 2074 6869 7320 4149 0d0a 6465  g of this AI..de
+000044f0: 6620 6f73 6169 735f 6c6f 6164 436f 6e66  f osais_loadConf
+00004500: 6967 285f 6e61 6d65 293a 200d 0a20 2020  ig(_name): ..   
+00004510: 2072 6574 7572 6e20 5f6c 6f61 6443 6f6e   return _loadCon
+00004520: 6669 6728 5f6e 616d 6529 0d0a 0d0a 2323  fig(_name)....##
+00004530: 2050 5542 4c49 4320 2d20 4765 7420 656e   PUBLIC - Get en
+00004540: 7620 6672 6f6d 2066 696c 6520 286c 6f63  v from file (loc
+00004550: 616c 206f 7220 646f 636b 6572 290d 0a64  al or docker)..d
+00004560: 6566 206f 7361 6973 5f67 6574 456e 7628  ef osais_getEnv(
+00004570: 5f66 696c 656e 616d 6529 3a0d 0a20 2020  _filename):..   
+00004580: 2067 6c6f 6261 6c20 6755 7365 726e 616d   global gUsernam
+00004590: 650d 0a20 2020 2067 6c6f 6261 6c20 6749  e..    global gI
+000045a0: 7356 6972 7475 616c 4149 0d0a 2020 2020  sVirtualAI..    
+000045b0: 676c 6f62 616c 2067 4973 4c6f 6361 6c0d  global gIsLocal.
+000045c0: 0a20 2020 2067 6c6f 6261 6c20 674e 616d  .    global gNam
+000045d0: 650d 0a0d 0a20 2020 2023 2320 7265 6164  e....    ## read
+000045e0: 2065 6e76 2066 726f 6d20 636f 6e66 6967   env from config
+000045f0: 2066 696c 650d 0a20 2020 2077 6974 6820   file..    with 
+00004600: 6f70 656e 285f 6669 6c65 6e61 6d65 2c20  open(_filename, 
+00004610: 2272 2229 2061 7320 663a 0d0a 2020 2020  "r") as f:..    
+00004620: 2020 2020 636f 6e74 656e 7420 3d20 662e      content = f.
+00004630: 7265 6164 2829 0d0a 2020 2020 7661 7269  read()..    vari
+00004640: 6162 6c65 7320 3d20 636f 6e74 656e 742e  ables = content.
+00004650: 7370 6c69 7428 225c 6e22 290d 0a20 2020  split("\n")..   
+00004660: 2066 6f72 2076 6172 2069 6e20 7661 7269   for var in vari
+00004670: 6162 6c65 733a 0d0a 2020 2020 2020 2020  ables:..        
+00004680: 6966 2076 6172 213d 2222 3a0d 0a20 2020  if var!="":..   
+00004690: 2020 2020 2020 2020 206b 6579 2c20 7661           key, va
+000046a0: 6c75 6520 3d20 7661 722e 7370 6c69 7428  lue = var.split(
+000046b0: 223d 2229 0d0a 2020 2020 2020 2020 2020  "=")..          
+000046c0: 2020 6966 206b 6579 203d 3d20 2255 5345    if key == "USE
+000046d0: 524e 414d 4522 3a0d 0a20 2020 2020 2020  RNAME":..       
+000046e0: 2020 2020 2020 2020 2067 5573 6572 6e61           gUserna
+000046f0: 6d65 203d 2076 616c 7565 0d0a 2020 2020  me = value..    
+00004700: 2020 2020 2020 2020 656c 6966 206b 6579          elif key
+00004710: 203d 3d20 2249 535f 4c4f 4341 4c22 3a0d   == "IS_LOCAL":.
+00004720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004730: 2067 4973 4c6f 6361 6c20 3d20 2876 616c   gIsLocal = (val
+00004740: 7565 3d3d 2254 7275 6522 290d 0a20 2020  ue=="True")..   
+00004750: 2020 2020 2020 2020 2065 6c69 6620 6b65           elif ke
+00004760: 7920 3d3d 2022 4953 5f56 4952 5455 414c  y == "IS_VIRTUAL
+00004770: 4149 223a 0d0a 2020 2020 2020 2020 2020  AI":..          
+00004780: 2020 2020 2020 6749 7356 6972 7475 616c        gIsVirtual
+00004790: 4149 203d 2028 7661 6c75 653d 3d22 5472  AI = (value=="Tr
+000047a0: 7565 2229 0d0a 2020 2020 2020 2020 2020  ue")..          
+000047b0: 2020 656c 6966 206b 6579 203d 3d20 2245    elif key == "E
+000047c0: 4e47 494e 4522 3a0d 0a20 2020 2020 2020  NGINE":..       
+000047d0: 2020 2020 2020 2020 2067 4e61 6d65 203d           gName =
+000047e0: 2076 616c 7565 0d0a 2020 2020 7265 7475   value..    retu
+000047f0: 726e 207b 0d0a 2020 2020 2020 2020 2275  rn {..        "u
+00004800: 7365 726e 616d 6522 3a20 6755 7365 726e  sername": gUsern
+00004810: 616d 652c 0d0a 2020 2020 2020 2020 2269  ame,..        "i
+00004820: 734c 6f63 616c 223a 2067 4973 4c6f 6361  sLocal": gIsLoca
+00004830: 6c2c 0d0a 2020 2020 2020 2020 2269 7356  l,..        "isV
+00004840: 6972 7475 616c 4149 223a 2067 4973 5669  irtualAI": gIsVi
+00004850: 7274 7561 6c41 492c 0d0a 2020 2020 2020  rtualAI,..      
+00004860: 2020 226e 616d 6522 3a20 674e 616d 650d    "name": gName.
+00004870: 0a20 2020 207d 0d0a 0d0a 2323 202d 2d2d  .    }....## ---
+00004880: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004890: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000048a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000048b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000048c0: 2d2d 2d2d 2d0d 0a23 2020 2020 2020 2063  -----..#       c
+000048d0: 6f73 7420 6361 6c63 756c 6174 696f 6e0d  ost calculation.
+000048e0: 0a23 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  .## ------------
+000048f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004900: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004910: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004920: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a  ------------....
+00004930: 2320 696e 6974 2074 6865 2064 6166 6175  # init the dafau
+00004940: 6c74 2063 6f73 7420 6172 7261 790d 0a64  lt cost array..d
+00004950: 6566 205f 696e 6974 6961 6c69 7a65 436f  ef _initializeCo
+00004960: 7374 2829 203a 0d0a 2020 2020 676c 6f62  st() :..    glob
+00004970: 616c 2067 4465 6661 756c 7443 6f73 740d  al gDefaultCost.
+00004980: 0a20 2020 2067 6c6f 6261 6c20 6761 5072  .    global gaPr
+00004990: 6f63 6573 7354 696d 650d 0a20 2020 2066  ocessTime..    f
+000049a0: 726f 6d20 6172 7261 7920 696d 706f 7274  rom array import
+000049b0: 2061 7272 6179 0d0a 2020 2020 6761 5072   array..    gaPr
+000049c0: 6f63 6573 7354 696d 653d 6172 7261 7928  ocessTime=array(
+000049d0: 2766 272c 205b 6744 6566 6175 6c74 436f  'f', [gDefaultCo
+000049e0: 7374 2c67 4465 6661 756c 7443 6f73 742c  st,gDefaultCost,
+000049f0: 6744 6566 6175 6c74 436f 7374 2c67 4465  gDefaultCost,gDe
+00004a00: 6661 756c 7443 6f73 742c 6744 6566 6175  faultCost,gDefau
+00004a10: 6c74 436f 7374 2c67 4465 6661 756c 7443  ltCost,gDefaultC
+00004a20: 6f73 742c 6744 6566 6175 6c74 436f 7374  ost,gDefaultCost
+00004a30: 2c67 4465 6661 756c 7443 6f73 742c 6744  ,gDefaultCost,gD
+00004a40: 6566 6175 6c74 436f 7374 2c67 4465 6661  efaultCost,gDefa
+00004a50: 756c 7443 6f73 745d 290d 0a0d 0a23 2069  ultCost])....# i
+00004a60: 6e69 7420 7468 6520 6461 6661 756c 7420  nit the dafault 
+00004a70: 636f 7374 2061 7272 6179 0d0a 6465 6620  cost array..def 
+00004a80: 5f61 6464 436f 7374 285f 636f 7374 2920  _addCost(_cost) 
+00004a90: 3a0d 0a20 2020 2067 6c6f 6261 6c20 6749  :..    global gI
+00004aa0: 7357 6172 6d75 700d 0a20 2020 2067 6c6f  sWarmup..    glo
+00004ab0: 6261 6c20 6761 5072 6f63 6573 7354 696d  bal gaProcessTim
+00004ac0: 650d 0a20 2020 2069 6620 6749 7357 6172  e..    if gIsWar
+00004ad0: 6d75 703d 3d46 616c 7365 3a0d 0a20 2020  mup==False:..   
+00004ae0: 2020 2020 2067 6150 726f 6365 7373 5469       gaProcessTi
+00004af0: 6d65 2e69 6e73 6572 7428 302c 205f 636f  me.insert(0, _co
+00004b00: 7374 290d 0a20 2020 2020 2020 2067 6150  st)..        gaP
+00004b10: 726f 6365 7373 5469 6d65 2e70 6f70 2829  rocessTime.pop()
+00004b20: 0d0a 0d0a 2320 696e 6974 2074 6865 2064  ....# init the d
+00004b30: 6166 6175 6c74 2063 6f73 7420 6172 7261  afault cost arra
+00004b40: 790d 0a64 6566 205f 6765 7441 7665 7261  y..def _getAvera
+00004b50: 6765 436f 7374 2829 203a 0d0a 2020 2020  geCost() :..    
+00004b60: 676c 6f62 616c 2067 6150 726f 6365 7373  global gaProcess
+00004b70: 5469 6d65 0d0a 2020 2020 6176 6572 6167  Time..    averag
+00004b80: 6520 3d20 7375 6d28 6761 5072 6f63 6573  e = sum(gaProces
+00004b90: 7354 696d 6529 202f 206c 656e 2867 6150  sTime) / len(gaP
+00004ba0: 726f 6365 7373 5469 6d65 290d 0a20 2020  rocessTime)..   
+00004bb0: 2072 6574 7572 6e20 6176 6572 6167 650d   return average.
+00004bc0: 0a0d 0a23 2320 2d2d 2d2d 2d2d 2d2d 2d2d  ...## ----------
+00004bd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004be0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004bf0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004c00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  --------------..
+00004c10: 2320 2020 2020 2020 6172 6773 2070 726f  #       args pro
+00004c20: 6365 7373 696e 670d 0a23 2320 2d2d 2d2d  cessing..## ----
+00004c30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004c40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004c50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004c60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004c70: 2d2d 2d2d 0d0a 0d0a 2320 7768 6572 6520  ----....# where 
+00004c80: 6973 2074 6865 206f 7574 7075 7420 6469  is the output di
+00004c90: 723f 0d0a 6465 6620 5f67 6574 4f75 7470  r?..def _getOutp
+00004ca0: 7574 4469 7228 293a 0d0a 2020 2020 676c  utDir():..    gl
+00004cb0: 6f62 616c 2067 4172 6773 4f53 4149 530d  obal gArgsOSAIS.
+00004cc0: 0a20 2020 2067 6c6f 6261 6c20 674f 7574  .    global gOut
+00004cd0: 7075 7444 6972 0d0a 0d0a 2020 2020 6966  putDir....    if
+00004ce0: 2067 4172 6773 4f53 4149 5321 3d4e 6f6e   gArgsOSAIS!=Non
+00004cf0: 653a 0d0a 2020 2020 2020 2020 7265 7475  e:..        retu
+00004d00: 726e 2067 4172 6773 4f53 4149 532e 6f75  rn gArgsOSAIS.ou
+00004d10: 7464 6972 0d0a 2020 2020 7265 7475 726e  tdir..    return
+00004d20: 2067 4f75 7470 7574 4469 720d 0a0d 0a23   gOutputDir....#
+00004d30: 2072 6563 6569 7665 7320 6172 6773 2066   receives args f
+00004d40: 726f 6d20 7265 7175 6573 7420 616e 6420  rom request and 
+00004d50: 7075 7420 7468 656d 2069 6e20 6120 6172  put them in a ar
+00004d60: 7261 7920 666f 7220 7072 6f63 6573 7369  ray for processi
+00004d70: 6e67 0d0a 6465 6620 5f67 6574 4172 6773  ng..def _getArgs
+00004d80: 285f 6172 6773 293a 0d0a 2020 2020 6152  (_args):..    aR
+00004d90: 6573 756c 7420 3d20 5b5d 0d0a 2020 2020  esult = []..    
+00004da0: 666f 7220 6b65 792c 2076 616c 7565 2069  for key, value i
+00004db0: 6e20 5f61 7267 732e 6974 656d 7328 293a  n _args.items():
+00004dc0: 0d0a 2020 2020 2020 2020 6966 206b 6579  ..        if key
+00004dd0: 2e73 7461 7274 7377 6974 6828 222d 2229  .startswith("-")
+00004de0: 3a0d 0a20 2020 2020 2020 2020 2020 2061  :..            a
+00004df0: 5265 7375 6c74 2e61 7070 656e 6428 6b65  Result.append(ke
+00004e00: 7929 0d0a 2020 2020 2020 2020 2020 2020  y)..            
+00004e10: 6152 6573 756c 742e 6170 7065 6e64 2876  aResult.append(v
+00004e20: 616c 7565 290d 0a20 2020 2072 6574 7572  alue)..    retur
+00004e30: 6e20 6152 6573 756c 740d 0a0d 0a23 2067  n aResult....# g
+00004e40: 6976 6520 6e65 7720 6172 6773 200d 0a64  ive new args ..d
+00004e50: 6566 205f 6172 6773 4672 6f6d 4669 6c74  ef _argsFromFilt
+00004e60: 6572 285f 6f72 6967 696e 616c 4172 6773  er(_originalArgs
+00004e70: 2c20 5f61 4669 6c74 6572 2c20 5f62 4b65  , _aFilter, _bKe
+00004e80: 6570 293a 0d0a 2020 2020 6672 6f6d 2077  ep):..    from w
+00004e90: 6572 6b7a 6575 672e 6461 7461 7374 7275  erkzeug.datastru
+00004ea0: 6374 7572 6573 2069 6d70 6f72 7420 4d75  ctures import Mu
+00004eb0: 6c74 6944 6963 740d 0a20 2020 205f 6469  ltiDict..    _di
+00004ec0: 6374 203d 204d 756c 7469 4469 6374 285b  ct = MultiDict([
+00004ed0: 5d29 0d0a 2020 2020 666f 7220 692c 2061  ])..    for i, a
+00004ee0: 7267 2069 6e20 656e 756d 6572 6174 6528  rg in enumerate(
+00004ef0: 5f6f 7269 6769 6e61 6c41 7267 7329 3a0d  _originalArgs):.
+00004f00: 0a20 2020 2020 2020 2069 6620 5f62 4b65  .        if _bKe
+00004f10: 6570 3a0d 0a20 2020 2020 2020 2020 2020  ep:..           
+00004f20: 2069 6620 6172 6720 696e 205f 6146 696c   if arg in _aFil
+00004f30: 7465 7220 616e 6420 6920 3c20 6c65 6e28  ter and i < len(
+00004f40: 5f6f 7269 6769 6e61 6c41 7267 7329 202d  _originalArgs) -
+00004f50: 2031 3a0d 0a20 2020 2020 2020 2020 2020   1:..           
+00004f60: 2020 2020 205f 6469 6374 2e61 6464 2861       _dict.add(a
+00004f70: 7267 2c20 5f6f 7269 6769 6e61 6c41 7267  rg, _originalArg
+00004f80: 735b 692b 315d 290d 0a20 2020 2020 2020  s[i+1])..       
+00004f90: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00004fa0: 2020 2020 6966 2061 7267 206e 6f74 2069      if arg not i
+00004fb0: 6e20 5f61 4669 6c74 6572 2061 6e64 2069  n _aFilter and i
+00004fc0: 203c 206c 656e 285f 6f72 6967 696e 616c   < len(_original
+00004fd0: 4172 6773 2920 2d20 313a 0d0a 2020 2020  Args) - 1:..    
+00004fe0: 2020 2020 2020 2020 2020 2020 5f64 6963              _dic
+00004ff0: 742e 6164 6428 6172 672c 205f 6f72 6967  t.add(arg, _orig
+00005000: 696e 616c 4172 6773 5b69 2b31 5d29 0d0a  inalArgs[i+1])..
+00005010: 2020 2020 0d0a 2020 2020 5f61 7267 733d      ..    _args=
+00005020: 5f67 6574 4172 6773 285f 6469 6374 290d  _getArgs(_dict).
+00005030: 0a20 2020 2072 6574 7572 6e20 5f61 7267  .    return _arg
+00005040: 730d 0a0d 0a23 2320 2d2d 2d2d 2d2d 2d2d  s....## --------
+00005050: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005060: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005070: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005080: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005090: 0d0a 2320 2020 2020 2020 5379 7374 656d  ..#       System
+000050a0: 2069 6e66 6f0d 0a23 2320 2d2d 2d2d 2d2d   info..## ------
+000050b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000050c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000050d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000050e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000050f0: 2d2d 0d0a 0d0a 6465 6620 5f63 6c65 6172  --....def _clear
+00005100: 4469 7228 293a 0d0a 2020 2020 636c 6561  Dir():..    clea
+00005110: 724f 6c64 4669 6c65 7328 6749 6e70 7574  rOldFiles(gInput
+00005120: 4469 7229 0d0a 2020 2020 636c 6561 724f  Dir)..    clearO
+00005130: 6c64 4669 6c65 7328 674f 7574 7075 7444  ldFiles(gOutputD
+00005140: 6972 290d 0a0d 0a23 2320 5055 424c 4943  ir)....## PUBLIC
+00005150: 202d 2069 6e66 6f20 6162 6f75 7420 6861   - info about ha
+00005160: 7277 6172 6520 7468 6973 2041 4920 6973  rware this AI is
+00005170: 2072 756e 6e69 6e67 206f 6e0d 0a64 6566   running on..def
+00005180: 206f 7361 6973 5f67 6574 4861 7277 6172   osais_getHarwar
+00005190: 6549 6e66 6f28 2920 3a0d 0a20 2020 2067  eInfo() :..    g
+000051a0: 6c6f 6261 6c20 674e 616d 650d 0a20 2020  lobal gName..   
+000051b0: 2072 6574 7572 6e20 6765 7448 6f73 7449   return getHostI
+000051c0: 6e66 6f28 674e 616d 6529 0d0a 0d0a 2323  nfo(gName)....##
+000051d0: 2050 5542 4c49 4320 2d20 6765 7420 6c69   PUBLIC - get li
+000051e0: 7374 206f 6620 6669 6c65 7320 696e 2061  st of files in a
+000051f0: 2064 6972 2028 6368 6563 6b20 7768 6174   dir (check what
+00005200: 2077 6173 2067 656e 6572 6174 6564 290d   was generated).
+00005210: 0a64 6566 206f 7361 6973 5f67 6574 4469  .def osais_getDi
+00005220: 7265 6374 6f72 794c 6973 7469 6e67 285f  rectoryListing(_
+00005230: 6469 7229 203a 0d0a 2020 2020 7265 7475  dir) :..    retu
+00005240: 726e 206c 6973 7444 6972 436f 6e74 656e  rn listDirConten
+00005250: 7428 5f64 6972 290d 0a0d 0a23 2320 5055  t(_dir)....## PU
+00005260: 424c 4943 202d 2069 6e66 6f20 6162 6f75  BLIC - info abou
+00005270: 7420 7468 6973 2041 490d 0a64 6566 206f  t this AI..def o
+00005280: 7361 6973 5f67 6574 496e 666f 2829 203a  sais_getInfo() :
+00005290: 0d0a 2020 2020 676c 6f62 616c 2067 4578  ..    global gEx
+000052a0: 7449 500d 0a20 2020 2067 6c6f 6261 6c20  tIP..    global 
+000052b0: 6750 6f72 7441 490d 0a20 2020 2067 6c6f  gPortAI..    glo
+000052c0: 6261 6c20 674e 616d 650d 0a20 2020 2067  bal gName..    g
+000052d0: 6c6f 6261 6c20 6756 6572 7369 6f6e 0d0a  lobal gVersion..
+000052e0: 2020 2020 676c 6f62 616c 2067 4973 446f      global gIsDo
+000052f0: 636b 6572 0d0a 2020 2020 676c 6f62 616c  cker..    global
+00005300: 2067 4d61 6368 696e 654e 616d 650d 0a20   gMachineName.. 
+00005310: 2020 2067 6c6f 6261 6c20 6755 7365 726e     global gUsern
+00005320: 616d 650d 0a20 2020 2067 6c6f 6261 6c20  ame..    global 
+00005330: 6749 7342 7573 790d 0a20 2020 2067 6c6f  gIsBusy..    glo
+00005340: 6261 6c20 674c 6173 7450 726f 6365 7373  bal gLastProcess
+00005350: 5374 6172 745f 6174 0d0a 2020 2020 676c  Start_at..    gl
+00005360: 6f62 616c 2067 4c61 7374 4368 6563 6b65  obal gLastChecke
+00005370: 645f 6174 0d0a 0d0a 2020 2020 6f62 6a43  d_at....    objC
+00005380: 6f6e 663d 5f67 6574 4675 6c6c 436f 6e66  onf=_getFullConf
+00005390: 6967 2867 4e61 6d65 290d 0a0d 0a20 2020  ig(gName)....   
+000053a0: 2072 6574 7572 6e20 7b0d 0a20 2020 2020   return {..     
+000053b0: 2020 2022 6e61 6d65 223a 2067 4e61 6d65     "name": gName
+000053c0: 2c0d 0a20 2020 2020 2020 2022 7665 7273  ,..        "vers
+000053d0: 696f 6e22 3a20 6756 6572 7369 6f6e 2c0d  ion": gVersion,.
+000053e0: 0a20 2020 2020 2020 2022 6c6f 6361 7469  .        "locati
+000053f0: 6f6e 223a 2066 227b 6745 7874 4950 7d3a  on": f"{gExtIP}:
+00005400: 7b67 506f 7274 4149 7d2f 222c 0d0a 2020  {gPortAI}/",..  
+00005410: 2020 2020 2020 2269 7352 756e 6e69 6e67        "isRunning
+00005420: 223a 2054 7275 652c 2020 2020 0d0a 2020  ": True,    ..  
+00005430: 2020 2020 2020 2269 7344 6f63 6b65 7222        "isDocker"
+00005440: 3a20 6749 7344 6f63 6b65 722c 2020 2020  : gIsDocker,    
+00005450: 0d0a 2020 2020 2020 2020 226c 6173 7441  ..        "lastA
+00005460: 6374 6976 655f 6174 223a 2067 4c61 7374  ctive_at": gLast
+00005470: 4368 6563 6b65 645f 6174 2c0d 0a20 2020  Checked_at,..   
+00005480: 2020 2020 2022 6c61 7374 5072 6f63 6573       "lastProces
+00005490: 7353 7461 7274 5f61 7422 3a20 674c 6173  sStart_at": gLas
+000054a0: 7450 726f 6365 7373 5374 6172 745f 6174  tProcessStart_at
+000054b0: 2c0d 0a20 2020 2020 2020 2022 6d61 6368  ,..        "mach
+000054c0: 696e 6522 3a20 674d 6163 6869 6e65 4e61  ine": gMachineNa
+000054d0: 6d65 2c0d 0a20 2020 2020 2020 2022 6f77  me,..        "ow
+000054e0: 6e65 7222 3a20 6755 7365 726e 616d 652c  ner": gUsername,
+000054f0: 200d 0a20 2020 2020 2020 2022 6973 4176   ..        "isAv
+00005500: 6169 6c61 626c 6522 3a20 2867 4973 4275  ailable": (gIsBu
+00005510: 7379 3d3d 4661 6c73 6529 2c0d 0a20 2020  sy==False),..   
+00005520: 2020 2020 2022 6176 6572 6167 6552 6573       "averageRes
+00005530: 706f 6e73 6554 696d 6522 3a20 5f67 6574  ponseTime": _get
+00005540: 4176 6572 6167 6543 6f73 7428 292c 200d  AverageCost(), .
+00005550: 0a20 2020 2020 2020 2022 6a73 6f6e 223a  .        "json":
+00005560: 206f 626a 436f 6e66 5b22 656e 6769 6e65   objConf["engine
+00005570: 225d 0d0a 2020 2020 7d0d 0a0d 0a23 2320  "]..    }....## 
+00005580: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005590: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000055a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000055b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000055c0: 2d2d 2d2d 2d2d 2d2d 0d0a 2320 2020 2020  --------..#     
+000055d0: 2020 636f 6e6e 6563 7420 746f 2047 6174    connect to Gat
+000055e0: 6577 6179 0d0a 2323 202d 2d2d 2d2d 2d2d  eway..## -------
+000055f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005600: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005610: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005620: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005630: 2d0d 0a0d 0a23 206e 6f74 6966 7920 7468  -....# notify th
+00005640: 6520 6761 7465 7761 7920 6f66 206f 7572  e gateway of our
+00005650: 2041 4920 636f 6e66 6967 2066 696c 650d   AI config file.
+00005660: 0a64 6566 205f 6e6f 7469 6679 4761 7465  .def _notifyGate
+00005670: 7761 7928 2920 3a20 0d0a 2020 2020 676c  way() : ..    gl
+00005680: 6f62 616c 2067 4e61 6d65 0d0a 2020 2020  obal gName..    
+00005690: 676c 6f62 616c 2067 4f72 6967 696e 4761  global gOriginGa
+000056a0: 7465 7761 790d 0a0d 0a20 2020 2068 6561  teway....    hea
+000056b0: 6465 7273 203d 207b 0d0a 2020 2020 2020  ders = {..      
+000056c0: 2020 2243 6f6e 7465 6e74 2d54 7970 6522    "Content-Type"
+000056d0: 3a20 2761 7070 6c69 6361 7469 6f6e 2f6a  : 'application/j
+000056e0: 736f 6e27 2c20 0d0a 2020 2020 2020 2020  son', ..        
+000056f0: 2741 6363 6570 7427 3a20 2774 6578 742f  'Accept': 'text/
+00005700: 706c 6169 6e27 2c0d 0a20 2020 207d 0d0a  plain',..    }..
+00005710: 2020 2020 6f62 6a50 6172 616d 3d5f 6765      objParam=_ge
+00005720: 7446 756c 6c43 6f6e 6669 6728 674e 616d  tFullConfig(gNam
+00005730: 6529 0d0a 0d0a 2020 2020 2323 206e 6f74  e)....    ## not
+00005740: 6966 7920 6761 7465 7761 790d 0a20 2020  ify gateway..   
+00005750: 2074 7279 3a0d 0a20 2020 2020 2020 2072   try:..        r
+00005760: 6573 706f 6e73 6520 3d20 7265 7175 6573  esponse = reques
+00005770: 7473 2e70 6f73 7428 6622 7b67 4f72 6967  ts.post(f"{gOrig
+00005780: 696e 4761 7465 7761 797d 6170 692f 7631  inGateway}api/v1
+00005790: 2f70 7562 6c69 632f 6169 2f63 6f6e 6669  /public/ai/confi
+000057a0: 6722 2c20 6865 6164 6572 733d 6865 6164  g", headers=head
+000057b0: 6572 732c 2064 6174 613d 6a73 6f6e 2e64  ers, data=json.d
+000057c0: 756d 7073 286f 626a 5061 7261 6d29 290d  umps(objParam)).
+000057d0: 0a20 2020 2020 2020 206f 626a 5265 733d  .        objRes=
+000057e0: 7265 7370 6f6e 7365 2e6a 736f 6e28 295b  response.json()[
+000057f0: 2264 6174 6122 5d0d 0a20 2020 2020 2020  "data"]..       
+00005800: 2069 6620 6f62 6a52 6573 2069 7320 4e6f   if objRes is No
+00005810: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+00005820: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00005830: 7228 2243 5249 5449 4341 4c3a 2063 6f75  r("CRITICAL: cou
+00005840: 6c64 206e 6f74 206e 6f74 6966 7920 4761  ld not notify Ga
+00005850: 7465 7761 7922 290d 0a0d 0a20 2020 2065  teway")....    e
+00005860: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
+00005870: 6173 2065 7272 3a0d 0a20 2020 2020 2020  as err:..       
+00005880: 2070 7269 6e74 2822 4352 4954 4943 414c   print("CRITICAL
+00005890: 3a20 222b 6572 722e 6d73 6729 0d0a 2020  : "+err.msg)..  
+000058a0: 2020 2020 2020 7261 6973 6520 6572 720d        raise err.
+000058b0: 0a20 2020 2072 6574 7572 6e20 5472 7565  .    return True
+000058c0: 0d0a 0d0a 2323 2050 5542 4c49 4320 2d20  ....## PUBLIC - 
+000058d0: 5265 7365 7420 636f 6e6e 6563 7469 6f6e  Reset connection
+000058e0: 2074 6f20 6c6f 6361 6c20 6761 7465 7761   to local gatewa
+000058f0: 790d 0a64 6566 206f 7361 6973 5f72 6573  y..def osais_res
+00005900: 6574 4761 7465 7761 7928 5f6c 6f63 616c  etGateway(_local
+00005910: 4761 7465 7761 7929 3a0d 0a20 2020 2067  Gateway):..    g
+00005920: 6c6f 6261 6c20 674f 7269 6769 6e47 6174  lobal gOriginGat
+00005930: 6577 6179 0d0a 2020 2020 674f 7269 6769  eway..    gOrigi
+00005940: 6e47 6174 6577 6179 3d5f 6c6f 6361 6c47  nGateway=_localG
+00005950: 6174 6577 6179 0d0a 2020 2020 7472 793a  ateway..    try:
+00005960: 0d0a 2020 2020 2020 2020 5f6e 6f74 6966  ..        _notif
+00005970: 7947 6174 6577 6179 2829 0d0a 2020 2020  yGateway()..    
+00005980: 6578 6365 7074 2045 7863 6570 7469 6f6e  except Exception
+00005990: 2061 7320 6572 723a 0d0a 2020 2020 2020   as err:..      
+000059a0: 2020 7072 696e 7428 2243 5249 5449 4341    print("CRITICA
+000059b0: 4c3a 2022 2b65 7272 2e6d 7367 290d 0a20  L: "+err.msg).. 
+000059c0: 2020 2020 2020 2072 6169 7365 2065 7272         raise err
+000059d0: 0d0a 2020 2020 0d0a 2020 2020 7072 696e  ..    ..    prin
+000059e0: 7428 223d 3e20 5468 6973 2041 4920 6973  t("=> This AI is
+000059f0: 2072 6573 6574 2074 6f20 7461 6c6b 2074   reset to talk t
+00005a00: 6f20 4761 7465 7761 7920 222b 5f6c 6f63  o Gateway "+_loc
+00005a10: 616c 4761 7465 7761 7929 0d0a 2020 2020  alGateway)..    
+00005a20: 7265 7475 726e 2054 7275 650d 0a0d 0a23  return True....#
+00005a30: 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  # --------------
+00005a40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005a50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005a60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005a70: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2320 2020  ----------..#   
+00005a80: 2020 2020 6175 7468 656e 7469 6361 7465      authenticate
+00005a90: 2069 6e74 6f20 4f53 4149 5320 6173 2076   into OSAIS as v
+00005aa0: 6972 7475 616c 2041 490d 0a23 2320 2d2d  irtual AI..## --
+00005ab0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005ac0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005ad0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005ae0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005af0: 2d2d 2d2d 2d2d 0d0a 0d0a 2320 5265 6769  ------....# Regi
+00005b00: 7374 6572 206f 7572 2056 4149 2069 6e74  ster our VAI int
+00005b10: 6f20 4f53 4149 530d 0a64 6566 205f 7265  o OSAIS..def _re
+00005b20: 6769 7374 6572 5641 4928 293a 0d0a 2020  gisterVAI():..  
+00005b30: 2020 676c 6f62 616c 2067 4e61 6d65 0d0a    global gName..
+00005b40: 2020 2020 676c 6f62 616c 2067 546f 6b65      global gToke
+00005b50: 6e0d 0a20 2020 2067 6c6f 6261 6c20 6753  n..    global gS
+00005b60: 6563 7265 740d 0a20 2020 2067 6c6f 6261  ecret..    globa
+00005b70: 6c20 674f 7269 6769 6e4f 5341 4953 0d0a  l gOriginOSAIS..
+00005b80: 2020 2020 676c 6f62 616c 2067 546f 6b65      global gToke
+00005b90: 6e4c 6f63 616c 0d0a 2020 2020 676c 6f62  nLocal..    glob
+00005ba0: 616c 2067 5365 6372 6574 4c6f 6361 6c0d  al gSecretLocal.
+00005bb0: 0a20 2020 2067 6c6f 6261 6c20 674f 7269  .    global gOri
+00005bc0: 6769 6e4c 6f63 616c 4f53 4149 530d 0a20  ginLocalOSAIS.. 
+00005bd0: 2020 2067 6c6f 6261 6c20 6749 734c 6f63     global gIsLoc
+00005be0: 616c 0d0a 0d0a 2020 2020 6865 6164 6572  al....    header
+00005bf0: 7320 3d20 7b0d 0a20 2020 2020 2020 2022  s = {..        "
+00005c00: 436f 6e74 656e 742d 5479 7065 223a 2027  Content-Type": '
+00005c10: 6170 706c 6963 6174 696f 6e2f 6a73 6f6e  application/json
+00005c20: 272c 200d 0a20 2020 2020 2020 2027 4163  ', ..        'Ac
+00005c30: 6365 7074 273a 2027 7465 7874 2f70 6c61  cept': 'text/pla
+00005c40: 696e 272c 0d0a 2020 2020 7d0d 0a20 2020  in',..    }..   
+00005c50: 206f 626a 5061 7261 6d3d 5f67 6574 4675   objParam=_getFu
+00005c60: 6c6c 436f 6e66 6967 2867 4e61 6d65 290d  llConfig(gName).
+00005c70: 0a0d 0a20 2020 2023 2320 7265 6720 7769  ...    ## reg wi
+00005c80: 7468 2050 726f 640d 0a20 2020 2069 6620  th Prod..    if 
+00005c90: 6749 734c 6f63 616c 3d3d 4661 6c73 653a  gIsLocal==False:
+00005ca0: 0d0a 2020 2020 2020 2020 7472 793a 0d0a  ..        try:..
+00005cb0: 2020 2020 2020 2020 2020 2020 7265 7370              resp
+00005cc0: 6f6e 7365 203d 2072 6571 7565 7374 732e  onse = requests.
+00005cd0: 706f 7374 2866 227b 674f 7269 6769 6e4f  post(f"{gOriginO
+00005ce0: 5341 4953 7d61 7069 2f76 312f 7075 626c  SAIS}api/v1/publ
+00005cf0: 6963 2f76 6972 7475 616c 6169 2f72 6567  ic/virtualai/reg
+00005d00: 6973 7465 7222 2c20 6865 6164 6572 733d  ister", headers=
+00005d10: 6865 6164 6572 732c 2064 6174 613d 6a73  headers, data=js
+00005d20: 6f6e 2e64 756d 7073 286f 626a 5061 7261  on.dumps(objPara
+00005d30: 6d29 290d 0a20 2020 2020 2020 2020 2020  m))..           
+00005d40: 206f 626a 5265 733d 7265 7370 6f6e 7365   objRes=response
+00005d50: 2e6a 736f 6e28 295b 2264 6174 6122 5d0d  .json()["data"].
+00005d60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00005d70: 6f62 6a52 6573 2069 7320 4e6f 6e65 3a0d  objRes is None:.
+00005d80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005d90: 2070 7269 6e74 2822 434f 554c 4420 4e4f   print("COULD NO
+00005da0: 5420 5245 4749 5354 4552 2c20 7374 6f70  T REGISTER, stop
+00005db0: 7069 6e67 2069 7420 6865 7265 2229 0d0a  ping it here")..
+00005dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005dd0: 7379 732e 6578 6974 2829 0d0a 0d0a 2020  sys.exit()....  
+00005de0: 2020 2020 2020 2020 2020 6754 6f6b 656e            gToken
+00005df0: 3d6f 626a 5265 735b 2274 6f6b 656e 225d  =objRes["token"]
+00005e00: 0d0a 2020 2020 2020 2020 2020 2020 6753  ..            gS
+00005e10: 6563 7265 743d 6f62 6a52 6573 5b22 7365  ecret=objRes["se
+00005e20: 6372 6574 225d 0d0a 2020 2020 2020 2020  cret"]..        
+00005e30: 2020 2020 7072 696e 7428 2257 6520 6172      print("We ar
+00005e40: 6520 5245 4749 5354 4552 4544 2077 6974  e REGISTERED wit
+00005e50: 6820 4f53 4149 5320 5072 6f64 2229 0d0a  h OSAIS Prod")..
+00005e60: 2020 2020 2020 2020 6578 6365 7074 2045          except E
+00005e70: 7863 6570 7469 6f6e 2061 7320 6572 723a  xception as err:
+00005e80: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
+00005e90: 696e 7428 2243 5249 5449 4341 4c3a 2022  int("CRITICAL: "
+00005ea0: 2b65 7272 2e6d 7367 290d 0a20 2020 2020  +err.msg)..     
+00005eb0: 2020 2020 2020 2072 6169 7365 2065 7272         raise err
+00005ec0: 0d0a 0d0a 2020 2020 2323 2072 6567 2077  ....    ## reg w
+00005ed0: 6974 6820 4c6f 6361 6c20 4f53 4149 5320  ith Local OSAIS 
+00005ee0: 2864 6562 7567 290d 0a20 2020 2065 6c73  (debug)..    els
+00005ef0: 653a 0d0a 2020 2020 2020 2020 7472 793a  e:..        try:
+00005f00: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00005f10: 7370 6f6e 7365 203d 2072 6571 7565 7374  sponse = request
+00005f20: 732e 706f 7374 2866 227b 674f 7269 6769  s.post(f"{gOrigi
+00005f30: 6e4c 6f63 616c 4f53 4149 537d 6170 692f  nLocalOSAIS}api/
+00005f40: 7631 2f70 7562 6c69 632f 7669 7274 7561  v1/public/virtua
+00005f50: 6c61 692f 7265 6769 7374 6572 222c 2068  lai/register", h
+00005f60: 6561 6465 7273 3d68 6561 6465 7273 2c20  eaders=headers, 
+00005f70: 6461 7461 3d6a 736f 6e2e 6475 6d70 7328  data=json.dumps(
+00005f80: 6f62 6a50 6172 616d 2929 0d0a 2020 2020  objParam))..    
+00005f90: 2020 2020 2020 2020 6f62 6a52 6573 3d72          objRes=r
+00005fa0: 6573 706f 6e73 652e 6a73 6f6e 2829 5b22  esponse.json()["
+00005fb0: 6461 7461 225d 0d0a 2020 2020 2020 2020  data"]..        
+00005fc0: 2020 2020 6966 206f 626a 5265 7320 6973      if objRes is
+00005fd0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00005fe0: 2020 2020 2020 2020 7072 696e 7428 2243          print("C
+00005ff0: 4f55 4c44 204e 4f54 2052 4547 4953 5445  OULD NOT REGISTE
+00006000: 5220 7769 7468 2064 6562 7567 2229 0d0a  R with debug")..
+00006010: 0d0a 2020 2020 2020 2020 2020 2020 6754  ..            gT
+00006020: 6f6b 656e 4c6f 6361 6c3d 6f62 6a52 6573  okenLocal=objRes
+00006030: 5b22 746f 6b65 6e22 5d0d 0a20 2020 2020  ["token"]..     
+00006040: 2020 2020 2020 2067 5365 6372 6574 4c6f         gSecretLo
+00006050: 6361 6c3d 6f62 6a52 6573 5b22 7365 6372  cal=objRes["secr
+00006060: 6574 225d 0d0a 2020 2020 2020 2020 2020  et"]..          
+00006070: 2020 7072 696e 7428 2257 6520 6172 6520    print("We are 
+00006080: 5245 4749 5354 4552 4544 2077 6974 6820  REGISTERED with 
+00006090: 4f53 4149 5320 4c6f 6361 6c20 2864 6562  OSAIS Local (deb
+000060a0: 7567 2922 290d 0a20 2020 2020 2020 2065  ug)")..        e
+000060b0: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
+000060c0: 6173 2065 7272 3a0d 0a20 2020 2020 2020  as err:..       
+000060d0: 2020 2020 2070 7269 6e74 2822 4352 4954       print("CRIT
+000060e0: 4943 414c 3a20 222b 6572 722e 6d73 6729  ICAL: "+err.msg)
+000060f0: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+00006100: 6973 6520 6572 720d 0a0d 0a20 2020 2072  ise err....    r
+00006110: 6574 7572 6e20 5472 7565 0d0a 0d0a 2320  eturn True....# 
+00006120: 4175 7468 656e 7469 6361 7465 2069 6e74  Authenticate int
+00006130: 6f20 4f53 4149 530d 0a64 6566 205f 6c6f  o OSAIS..def _lo
+00006140: 6769 6e56 4149 2829 3a0d 0a20 2020 2067  ginVAI():..    g
+00006150: 6c6f 6261 6c20 6754 6f6b 656e 0d0a 2020  lobal gToken..  
+00006160: 2020 676c 6f62 616c 2067 5365 6372 6574    global gSecret
+00006170: 0d0a 2020 2020 676c 6f62 616c 2067 4175  ..    global gAu
+00006180: 7468 546f 6b65 6e0d 0a20 2020 2067 6c6f  thToken..    glo
+00006190: 6261 6c20 6754 6f6b 656e 4c6f 6361 6c0d  bal gTokenLocal.
+000061a0: 0a20 2020 2067 6c6f 6261 6c20 6753 6563  .    global gSec
+000061b0: 7265 744c 6f63 616c 0d0a 2020 2020 676c  retLocal..    gl
+000061c0: 6f62 616c 2067 4175 7468 546f 6b65 6e4c  obal gAuthTokenL
+000061d0: 6f63 616c 0d0a 0d0a 2020 2020 6865 6164  ocal....    head
+000061e0: 6572 7320 3d20 7b0d 0a20 2020 2020 2020  ers = {..       
+000061f0: 2022 436f 6e74 656e 742d 5479 7065 223a   "Content-Type":
+00006200: 2022 6170 706c 6963 6174 696f 6e2f 6a73   "application/js
+00006210: 6f6e 220d 0a20 2020 207d 0d0a 0d0a 2020  on"..    }....  
+00006220: 2020 6966 2067 546f 6b65 6e21 3d20 4e6f    if gToken!= No
+00006230: 6e65 3a0d 0a20 2020 2020 2020 2074 7279  ne:..        try
+00006240: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+00006250: 6573 706f 6e73 6520 3d20 7265 7175 6573  esponse = reques
+00006260: 7473 2e70 6f73 7428 6622 7b67 4f72 6967  ts.post(f"{gOrig
+00006270: 696e 4f53 4149 537d 6170 692f 7631 2f70  inOSAIS}api/v1/p
+00006280: 7562 6c69 632f 7669 7274 7561 6c61 692f  ublic/virtualai/
+00006290: 6c6f 6769 6e22 2c20 6865 6164 6572 733d  login", headers=
+000062a0: 6865 6164 6572 732c 2064 6174 613d 6a73  headers, data=js
+000062b0: 6f6e 2e64 756d 7073 287b 0d0a 2020 2020  on.dumps({..    
+000062c0: 2020 2020 2020 2020 2020 2020 2274 6f6b              "tok
+000062d0: 656e 223a 2067 546f 6b65 6e2c 0d0a 2020  en": gToken,..  
+000062e0: 2020 2020 2020 2020 2020 2020 2020 2273                "s
+000062f0: 6563 7265 7422 3a20 6753 6563 7265 740d  ecret": gSecret.
+00006300: 0a20 2020 2020 2020 2020 2020 207d 2929  .            }))
+00006310: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00006320: 6f62 6a52 6573 3d72 6573 706f 6e73 652e  objRes=response.
+00006330: 6a73 6f6e 2829 5b22 6461 7461 225d 0d0a  json()["data"]..
+00006340: 2020 2020 2020 2020 2020 2020 6966 206f              if o
+00006350: 626a 5265 7320 6973 204e 6f6e 653a 0d0a  bjRes is None:..
+00006360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006370: 7072 696e 7428 2243 4f55 4c44 204e 4f54  print("COULD NOT
+00006380: 204c 4f47 494e 2c20 7374 6f70 7069 6e67   LOGIN, stopping
+00006390: 2069 7420 6865 7265 2229 0d0a 2020 2020   it here")..    
+000063a0: 2020 2020 2020 2020 2020 2020 7379 732e              sys.
+000063b0: 6578 6974 2829 0d0a 2020 2020 2020 2020  exit()..        
+000063c0: 2020 2020 7072 696e 7428 2257 6520 676f      print("We go
+000063d0: 7420 616e 2061 7574 6865 6e74 6963 6174  t an authenticat
+000063e0: 696f 6e20 746f 6b65 6e20 696e 746f 204f  ion token into O
+000063f0: 5341 4953 2229 0d0a 2020 2020 2020 2020  SAIS")..        
+00006400: 2020 2020 6741 7574 6854 6f6b 656e 3d6f      gAuthToken=o
+00006410: 626a 5265 735b 2261 7574 6854 6f6b 656e  bjRes["authToken
+00006420: 225d 2020 2020 0d0a 2020 2020 2020 2020  "]    ..        
+00006430: 6578 6365 7074 2045 7863 6570 7469 6f6e  except Exception
+00006440: 2061 7320 6572 723a 0d0a 2020 2020 2020   as err:..      
+00006450: 2020 2020 2020 7072 696e 7428 2243 5249        print("CRI
+00006460: 5449 4341 4c3a 2022 2b65 7272 2e6d 7367  TICAL: "+err.msg
+00006470: 290d 0a20 2020 2020 2020 2020 2020 2072  )..            r
+00006480: 6169 7365 2065 7272 0d0a 0d0a 2020 2020  aise err....    
+00006490: 6966 2067 546f 6b65 6e4c 6f63 616c 213d  if gTokenLocal!=
+000064a0: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+000064b0: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+000064c0: 2020 7265 7370 6f6e 7365 203d 2072 6571    response = req
+000064d0: 7565 7374 732e 706f 7374 2866 227b 674f  uests.post(f"{gO
+000064e0: 7269 6769 6e4c 6f63 616c 4f53 4149 537d  riginLocalOSAIS}
+000064f0: 6170 692f 7631 2f70 7562 6c69 632f 7669  api/v1/public/vi
+00006500: 7274 7561 6c61 692f 6c6f 6769 6e22 2c20  rtualai/login", 
+00006510: 6865 6164 6572 733d 6865 6164 6572 732c  headers=headers,
+00006520: 2064 6174 613d 6a73 6f6e 2e64 756d 7073   data=json.dumps
+00006530: 287b 0d0a 2020 2020 2020 2020 2020 2020  ({..            
+00006540: 2020 2020 2274 6f6b 656e 223a 2067 546f      "token": gTo
+00006550: 6b65 6e4c 6f63 616c 2c0d 0a20 2020 2020  kenLocal,..     
+00006560: 2020 2020 2020 2020 2020 2022 7365 6372             "secr
+00006570: 6574 223a 2067 5365 6372 6574 4c6f 6361  et": gSecretLoca
+00006580: 6c0d 0a20 2020 2020 2020 2020 2020 207d  l..            }
+00006590: 2929 0d0a 0d0a 2020 2020 2020 2020 2020  ))....          
+000065a0: 2020 6f62 6a52 6573 3d72 6573 706f 6e73    objRes=respons
+000065b0: 652e 6a73 6f6e 2829 5b22 6461 7461 225d  e.json()["data"]
+000065c0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+000065d0: 206f 626a 5265 7320 6973 204e 6f6e 653a   objRes is None:
+000065e0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000065f0: 2020 7072 696e 7428 2243 4f55 4c44 204e    print("COULD N
+00006600: 4f54 204c 4f47 494e 2069 6e74 6f20 4f53  OT LOGIN into OS
+00006610: 4149 5320 4c6f 6361 6c22 290d 0a20 2020  AIS Local")..   
+00006620: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
+00006630: 5765 2067 6f74 2061 6e20 6175 7468 656e  We got an authen
+00006640: 7469 6361 7469 6f6e 2074 6f6b 656e 2069  tication token i
+00006650: 6e74 6f20 4f53 4149 5320 4c6f 6361 6c20  nto OSAIS Local 
+00006660: 2864 6562 7567 2922 290d 0a20 2020 2020  (debug)")..     
+00006670: 2020 2020 2020 2067 4175 7468 546f 6b65         gAuthToke
+00006680: 6e4c 6f63 616c 3d6f 626a 5265 735b 2261  nLocal=objRes["a
+00006690: 7574 6854 6f6b 656e 225d 2020 2020 0d0a  uthToken"]    ..
+000066a0: 2020 2020 2020 2020 6578 6365 7074 2045          except E
+000066b0: 7863 6570 7469 6f6e 2061 7320 6572 723a  xception as err:
+000066c0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+000066d0: 7475 726e 2054 7275 650d 0a0d 0a20 2020  turn True....   
+000066e0: 2072 6574 7572 6e20 5472 7565 0d0a 0d0a   return True....
+000066f0: 0d0a 2323 2050 5542 4c49 4320 2d20 4175  ..## PUBLIC - Au
+00006700: 7468 656e 7469 6361 7465 2074 6865 2056  thenticate the V
+00006710: 6972 7475 616c 2041 4920 696e 746f 204f  irtual AI into O
+00006720: 5341 4953 0d0a 6465 6620 6f73 6169 735f  SAIS..def osais_
+00006730: 6175 7468 656e 7469 6361 7465 4149 2829  authenticateAI()
+00006740: 3a0d 0a20 2020 2067 6c6f 6261 6c20 6749  :..    global gI
+00006750: 7356 6972 7475 616c 4149 0d0a 2020 2020  sVirtualAI..    
+00006760: 676c 6f62 616c 2067 4f72 6967 696e 4f53  global gOriginOS
+00006770: 4149 530d 0a20 2020 2067 6c6f 6261 6c20  AIS..    global 
+00006780: 6749 7353 6368 6564 756c 6564 0d0a 2020  gIsScheduled..  
+00006790: 2020 0d0a 2020 2020 5265 7370 3d7b 2264    ..    Resp={"d
+000067a0: 6174 6122 3a20 4e6f 6e65 7d0d 0a20 2020  ata": None}..   
+000067b0: 2069 6620 6749 7356 6972 7475 616c 4149   if gIsVirtualAI
+000067c0: 3a0d 0a0d 0a20 2020 2020 2020 2074 7279  :....        try
+000067d0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+000067e0: 6573 703d 205f 7265 6769 7374 6572 5641  esp= _registerVA
+000067f0: 4928 290d 0a20 2020 2020 2020 2020 2020  I()..           
+00006800: 2072 6573 703d 5f6c 6f67 696e 5641 4928   resp=_loginVAI(
+00006810: 290d 0a20 2020 2020 2020 2065 7863 6570  )..        excep
+00006820: 7420 4578 6365 7074 696f 6e20 6173 2065  t Exception as e
+00006830: 7272 3a0d 0a20 2020 2020 2020 2020 2020  rr:..           
+00006840: 2070 7269 6e74 2822 4352 4954 4943 414c   print("CRITICAL
+00006850: 3a20 222b 6572 722e 6d73 6729 0d0a 2020  : "+err.msg)..  
+00006860: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00006870: 6572 720d 0a20 2020 2020 2020 200d 0a20  err..        .. 
+00006880: 2020 2020 2020 2023 2052 756e 2074 6865         # Run the
+00006890: 2073 6368 6564 756c 6572 0d0a 2020 2020   scheduler..    
+000068a0: 2020 2020 6966 2067 4973 5363 6865 6475      if gIsSchedu
+000068b0: 6c65 643d 3d46 616c 7365 3a0d 0a20 2020  led==False:..   
+000068c0: 2020 2020 2020 2020 2067 4973 5363 6865           gIsSche
+000068d0: 6475 6c65 643d 5472 7565 0d0a 2020 2020  duled=True..    
+000068e0: 2020 2020 2020 2020 7363 6865 6475 6c65          schedule
+000068f0: 2e65 7665 7279 2829 2e64 6179 2e61 7428  .every().day.at(
+00006900: 2231 303a 3330 2229 2e64 6f28 5f6c 6f67  "10:30").do(_log
+00006910: 696e 5641 4929 0d0a 0d0a 2020 2020 7265  inVAI)....    re
+00006920: 7475 726e 2072 6573 700d 0a0d 0a23 2320  turn resp....## 
+00006930: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006940: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006950: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006960: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006970: 2d2d 2d2d 2d2d 2d2d 0d0a 2320 2020 2020  --------..#     
+00006980: 2020 5275 6e20 7468 6520 4149 0d0a 2323    Run the AI..##
+00006990: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+000069a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000069b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000069c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000069d0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d 0a23 2320  ---------....## 
+000069e0: 5055 424c 4943 202d 2070 6172 7365 2061  PUBLIC - parse a
+000069f0: 7267 7320 666f 7220 4f53 4149 5320 286e  rgs for OSAIS (n
+00006a00: 6f74 2074 686f 7365 2066 6f72 2041 4929  ot those for AI)
+00006a10: 0d0a 6465 6620 6f73 6169 735f 696e 6974  ..def osais_init
+00006a20: 5061 7273 6572 2861 4172 6729 3a0d 0a20  Parser(aArg):.. 
+00006a30: 2020 2067 6c6f 6261 6c20 6741 7267 734f     global gArgsO
+00006a40: 5341 4953 0d0a 2020 2020 676c 6f62 616c  SAIS..    global
+00006a50: 2067 496e 7075 7444 6972 0d0a 2020 2020   gInputDir..    
+00006a60: 676c 6f62 616c 2067 4f75 7470 7574 4469  global gOutputDi
+00006a70: 720d 0a20 2020 2067 6c6f 6261 6c20 6749  r..    global gI
+00006a80: 7357 6172 6d75 700d 0a0d 0a20 2020 2023  sWarmup....    #
+00006a90: 2043 7265 6174 6520 7468 6520 7061 7273   Create the pars
+00006aa0: 6572 0d0a 2020 2020 7671 5f70 6172 7365  er..    vq_parse
+00006ab0: 7220 3d20 6172 6770 6172 7365 2e41 7267  r = argparse.Arg
+00006ac0: 756d 656e 7450 6172 7365 7228 6465 7363  umentParser(desc
+00006ad0: 7269 7074 696f 6e3d 2741 7267 2070 6172  ription='Arg par
+00006ae0: 7365 7220 696e 6974 2062 7920 4f53 4149  ser init by OSAI
+00006af0: 5327 290d 0a0d 0a20 2020 2023 2041 6464  S')....    # Add
+00006b00: 2074 6865 2041 4920 4761 7465 7761 7920   the AI Gateway 
+00006b10: 2f20 4f70 656e 536f 7572 6365 4149 7320  / OpenSourceAIs 
+00006b20: 6172 6775 6d65 6e74 730d 0a20 2020 2076  arguments..    v
+00006b30: 715f 7061 7273 6572 2e61 6464 5f61 7267  q_parser.add_arg
+00006b40: 756d 656e 7428 222d 6f72 6967 222c 2020  ument("-orig",  
+00006b50: 222d 2d6f 7269 6769 6e22 2c20 7479 7065  "--origin", type
+00006b60: 3d73 7472 2c20 6865 6c70 3d22 4149 2047  =str, help="AI G
+00006b70: 6174 6577 6179 2073 6572 7665 7220 6f72  ateway server or
+00006b80: 6967 696e 222c 2064 6566 6175 6c74 3d66  igin", default=f
+00006b90: 2268 7474 703a 2f2f 7b67 4950 4c6f 6361  "http://{gIPLoca
+00006ba0: 6c7d 3a7b 6750 6f72 7447 6174 6577 6179  l}:{gPortGateway
+00006bb0: 7d2f 2220 2c20 6465 7374 3d27 4f53 4149  }/" , dest='OSAI
+00006bc0: 535f 6f72 6967 696e 2729 2020 2020 2023  S_origin')     #
+00006bd0: 2320 2074 6869 7320 6973 2066 6f72 2063  #  this is for c
+00006be0: 6f6d 6d73 2077 6974 6820 4149 2047 6174  omms with AI Gat
+00006bf0: 6577 6179 0d0a 2020 2020 7671 5f70 6172  eway..    vq_par
+00006c00: 7365 722e 6164 645f 6172 6775 6d65 6e74  ser.add_argument
+00006c10: 2822 2d74 222c 2020 222d 2d74 6f6b 656e  ("-t",  "--token
+00006c20: 222c 2074 7970 653d 7374 722c 2068 656c  ", type=str, hel
+00006c30: 703d 224f 7065 6e53 6f75 7263 6541 4973  p="OpenSourceAIs
+00006c40: 2074 6f6b 656e 222c 2064 6566 6175 6c74   token", default
+00006c50: 3d22 3022 2c20 6465 7374 3d27 746f 6b65  ="0", dest='toke
+00006c60: 6e41 4927 2920 2020 2020 2020 2020 2020  nAI')           
+00006c70: 2020 2020 2323 2020 7468 6973 2069 7320      ##  this is 
+00006c80: 666f 7220 636f 6d6d 7320 7769 7468 204f  for comms with O
+00006c90: 7065 6e53 6f75 7263 6541 4973 0d0a 2020  penSourceAIs..  
+00006ca0: 2020 7671 5f70 6172 7365 722e 6164 645f    vq_parser.add_
+00006cb0: 6172 6775 6d65 6e74 2822 2d75 222c 2020  argument("-u",  
+00006cc0: 222d 2d75 7365 726e 616d 6522 2c20 7479  "--username", ty
+00006cd0: 7065 3d73 7472 2c20 6865 6c70 3d22 4f70  pe=str, help="Op
+00006ce0: 656e 536f 7572 6365 4149 7320 7573 6572  enSourceAIs user
+00006cf0: 6e61 6d65 222c 2064 6566 6175 6c74 3d22  name", default="
+00006d00: 222c 2064 6573 743d 2775 7365 726e 616d  ", dest='usernam
+00006d10: 6527 2920 2020 2020 2020 2323 2020 7468  e')       ##  th
+00006d20: 6973 2069 7320 666f 7220 636f 6d6d 7320  is is for comms 
+00006d30: 7769 7468 204f 7065 6e53 6f75 7263 6541  with OpenSourceA
+00006d40: 4973 0d0a 2020 2020 7671 5f70 6172 7365  Is..    vq_parse
+00006d50: 722e 6164 645f 6172 6775 6d65 6e74 2822  r.add_argument("
+00006d60: 2d75 6964 222c 2020 222d 2d75 6e69 7175  -uid",  "--uniqu
+00006d70: 655f 6964 222c 2074 7970 653d 696e 742c  e_id", type=int,
+00006d80: 2068 656c 703d 2255 6e69 7175 6520 4944   help="Unique ID
+00006d90: 206f 6620 7468 6973 2041 4920 7365 7373   of this AI sess
+00006da0: 696f 6e22 2c20 6465 6661 756c 743d 302c  ion", default=0,
+00006db0: 2064 6573 743d 2775 6964 2729 2020 2020   dest='uid')    
+00006dc0: 2323 2020 7468 6973 2069 7320 666f 7220  ##  this is for 
+00006dd0: 636f 6d6d 7320 7769 7468 204f 7065 6e53  comms with OpenS
+00006de0: 6f75 7263 6541 4973 0d0a 2020 2020 7671  ourceAIs..    vq
+00006df0: 5f70 6172 7365 722e 6164 645f 6172 6775  _parser.add_argu
+00006e00: 6d65 6e74 2822 2d6f 6469 7222 2c20 222d  ment("-odir", "-
+00006e10: 2d6f 7574 6469 7222 2c20 7479 7065 3d73  -outdir", type=s
+00006e20: 7472 2c20 6865 6c70 3d22 4f75 7470 7574  tr, help="Output
+00006e30: 2064 6972 6563 746f 7279 222c 2064 6566   directory", def
+00006e40: 6175 6c74 3d67 4f75 7470 7574 4469 722c  ault=gOutputDir,
+00006e50: 2064 6573 743d 276f 7574 6469 7227 290d   dest='outdir').
+00006e60: 0a20 2020 2076 715f 7061 7273 6572 2e61  .    vq_parser.a
+00006e70: 6464 5f61 7267 756d 656e 7428 222d 6964  dd_argument("-id
+00006e80: 6972 222c 2022 2d2d 696e 6469 7222 2c20  ir", "--indir", 
+00006e90: 7479 7065 3d73 7472 2c20 6865 6c70 3d22  type=str, help="
+00006ea0: 696e 7075 7420 6469 7265 6374 6f72 7922  input directory"
+00006eb0: 2c20 6465 6661 756c 743d 6749 6e70 7574  , default=gInput
+00006ec0: 4469 722c 2064 6573 743d 2769 6e64 6972  Dir, dest='indir
+00006ed0: 2729 0d0a 2020 2020 7671 5f70 6172 7365  ')..    vq_parse
+00006ee0: 722e 6164 645f 6172 6775 6d65 6e74 2822  r.add_argument("
+00006ef0: 2d6c 6f63 616c 222c 2022 2d2d 6973 6c6f  -local", "--islo
+00006f00: 6361 6c22 2c20 7479 7065 3d62 6f6f 6c2c  cal", type=bool,
+00006f10: 2068 656c 703d 2269 7320 6c6f 6361 6c20   help="is local 
+00006f20: 6f72 2070 726f 643f 222c 2064 6566 6175  or prod?", defau
+00006f30: 6c74 3d46 616c 7365 2c20 6465 7374 3d27  lt=False, dest='
+00006f40: 6973 4c6f 6361 6c27 290d 0a20 2020 2076  isLocal')..    v
+00006f50: 715f 7061 7273 6572 2e61 6464 5f61 7267  q_parser.add_arg
+00006f60: 756d 656e 7428 222d 6379 636c 6522 2c20  ument("-cycle", 
+00006f70: 222d 2d63 7963 6c65 222c 2074 7970 653d  "--cycle", type=
+00006f80: 696e 742c 2068 656c 703d 2263 7963 6c65  int, help="cycle
+00006f90: 222c 2064 6566 6175 6c74 3d30 2c20 6465  ", default=0, de
+00006fa0: 7374 3d27 6379 636c 6527 290d 0a20 2020  st='cycle')..   
+00006fb0: 2076 715f 7061 7273 6572 2e61 6464 5f61   vq_parser.add_a
+00006fc0: 7267 756d 656e 7428 222d 6669 6c65 6e61  rgument("-filena
+00006fd0: 6d65 222c 2022 2d2d 6669 6c65 6e61 6d65  me", "--filename
+00006fe0: 222c 2074 7970 653d 7374 722c 2068 656c  ", type=str, hel
+00006ff0: 703d 2266 696c 656e 616d 6522 2c20 6465  p="filename", de
+00007000: 6661 756c 743d 2264 6566 6175 6c74 222c  fault="default",
+00007010: 2064 6573 743d 2766 696c 656e 616d 6527   dest='filename'
+00007020: 290d 0a20 2020 2076 715f 7061 7273 6572  )..    vq_parser
+00007030: 2e61 6464 5f61 7267 756d 656e 7428 222d  .add_argument("-
+00007040: 7761 726d 7570 222c 2022 2d2d 7761 726d  warmup", "--warm
+00007050: 7570 222c 2074 7970 653d 626f 6f6c 2c20  up", type=bool, 
+00007060: 6865 6c70 3d22 7761 726d 7570 222c 2064  help="warmup", d
+00007070: 6566 6175 6c74 3d46 616c 7365 2c20 6465  efault=False, de
+00007080: 7374 3d27 7761 726d 7570 2729 0d0a 0d0a  st='warmup')....
+00007090: 2020 2020 6741 7267 734f 5341 4953 203d      gArgsOSAIS =
+000070a0: 2076 715f 7061 7273 6572 2e70 6172 7365   vq_parser.parse
+000070b0: 5f61 7267 7328 6141 7267 290d 0a20 2020  _args(aArg)..   
+000070c0: 2067 4973 5761 726d 7570 3d67 4172 6773   gIsWarmup=gArgs
+000070d0: 4f53 4149 532e 7761 726d 7570 0d0a 2020  OSAIS.warmup..  
+000070e0: 2020 7265 7475 726e 2054 7275 650d 0a0d    return True...
+000070f0: 0a23 2320 5055 424c 4943 202d 2072 756e  .## PUBLIC - run
+00007100: 2074 6865 2041 4920 2861 7420 6c65 6173   the AI (at leas
+00007110: 7420 7472 7929 0d0a 6465 6620 6f73 6169  t try)..def osai
+00007120: 735f 7275 6e41 4928 2a61 7267 7329 3a0d  s_runAI(*args):.
+00007130: 0a20 2020 2067 6c6f 6261 6c20 6749 7342  .    global gIsB
+00007140: 7573 790d 0a20 2020 2067 6c6f 6261 6c20  usy..    global 
+00007150: 6741 5072 6f63 6573 7365 640d 0a20 2020  gAProcessed..   
+00007160: 2067 6c6f 6261 6c20 674e 616d 6520 0d0a   global gName ..
+00007170: 2020 2020 676c 6f62 616c 2067 4c61 7374      global gLast
+00007180: 5072 6f63 6573 7353 7461 7274 5f61 740d  ProcessStart_at.
+00007190: 0a0d 0a20 2020 2023 2320 6765 7420 6172  ...    ## get ar
+000071a0: 6773 0d0a 2020 2020 666e 5f72 756e 3d61  gs..    fn_run=a
+000071b0: 7267 735b 305d 0d0a 2020 2020 5f61 7267  rgs[0]..    _arg
+000071c0: 733d 6172 6773 5b31 5d0d 0a0d 0a20 2020  s=args[1]....   
+000071d0: 2023 2320 646f 206e 6f74 2070 726f 6365   ## do not proce
+000071e0: 7373 2074 7769 6365 2073 616d 6520 7569  ss twice same ui
+000071f0: 640d 0a20 2020 205f 7569 643d 5f61 7267  d..    _uid=_arg
+00007200: 732e 6765 7428 272d 7569 6427 290d 0a20  s.get('-uid').. 
+00007210: 2020 2069 6620 5f75 6964 2069 6e20 6741     if _uid in gA
+00007220: 5072 6f63 6573 7365 643a 0d0a 2020 2020  Processed:..    
+00007230: 2020 2020 7265 7475 726e 2020 226e 6f74      return  "not
+00007240: 2070 726f 6365 7373 696e 672c 2061 6c72   processing, alr
+00007250: 6561 6479 2074 7269 6564 2e2e 2e22 0d0a  eady tried..."..
+00007260: 0d0a 2020 2020 2323 2073 7461 7274 2074  ..    ## start t
+00007270: 696d 650d 0a20 2020 2067 4973 4275 7379  ime..    gIsBusy
+00007280: 3d54 7275 650d 0a20 2020 2062 6567 5f64  =True..    beg_d
+00007290: 6174 6520 3d20 6461 7465 7469 6d65 2e75  ate = datetime.u
+000072a0: 7463 6e6f 7728 290d 0a0d 0a20 2020 2023  tcnow()....    #
+000072b0: 2320 7265 7072 6f63 6573 7320 4149 2061  # reprocess AI a
+000072c0: 7267 730d 0a20 2020 2061 4172 6746 6f72  rgs..    aArgFor
+000072d0: 7061 7273 6572 4149 3d5f 6765 7441 7267  parserAI=_getArg
+000072e0: 7328 5f61 7267 7329 0d0a 2020 2020 6172  s(_args)..    ar
+000072f0: 6773 5f45 7863 6c75 7369 7665 4f53 4149  gs_ExclusiveOSAI
+00007300: 533d 5b27 2d6f 7269 6727 2c20 272d 7427  S=['-orig', '-t'
+00007310: 2c20 272d 7527 2c20 272d 7569 6427 2c20  , '-u', '-uid', 
+00007320: 272d 6c6f 6361 6c27 2c20 272d 6379 636c  '-local', '-cycl
+00007330: 6527 2c20 272d 7761 726d 7570 275d 0d0a  e', '-warmup']..
+00007340: 2020 2020 6141 7267 466f 7270 6172 7365      aArgForparse
+00007350: 7241 493d 5f61 7267 7346 726f 6d46 696c  rAI=_argsFromFil
+00007360: 7465 7228 6141 7267 466f 7270 6172 7365  ter(aArgForparse
+00007370: 7241 492c 2061 7267 735f 4578 636c 7573  rAI, args_Exclus
+00007380: 6976 654f 5341 4953 2c20 4661 6c73 6529  iveOSAIS, False)
+00007390: 0d0a 0d0a 2020 2020 2323 2070 726f 6365  ....    ## proce
+000073a0: 7373 2074 6865 2066 696c 656e 616d 6520  ss the filename 
+000073b0: 7061 7373 6564 2069 6e20 6469 7220 2863  passed in dir (c
+000073c0: 6173 6520 6c6f 6361 6c68 6f73 7420 2f20  ase localhost / 
+000073d0: 4149 2047 6174 6577 6179 292c 206f 7220  AI Gateway), or 
+000073e0: 646f 776e 6c6f 6164 2066 696c 6520 6672  download file fr
+000073f0: 6f6d 2055 524c 2028 6361 7365 2041 4920  om URL (case AI 
+00007400: 7275 6e6e 696e 6720 6173 2056 6972 7475  running as Virtu
+00007410: 616c 2041 4929 0d0a 2020 2020 5f69 6e70  al AI)..    _inp
+00007420: 7574 3d4e 6f6e 650d 0a20 2020 205f 6669  ut=None..    _fi
+00007430: 6c65 6e61 6d65 3d5f 6172 6773 2e67 6574  lename=_args.get
+00007440: 2827 2d66 696c 656e 616d 6527 290d 0a20  ('-filename').. 
+00007450: 2020 205f 7572 6c55 706c 6f61 643d 5f61     _urlUpload=_a
+00007460: 7267 732e 6765 7428 2775 726c 5f75 706c  rgs.get('url_upl
+00007470: 6f61 6427 290d 0a20 2020 2069 6620 6e6f  oad')..    if no
+00007480: 7420 5f66 696c 656e 616d 6520 616e 6420  t _filename and 
+00007490: 5f75 726c 5570 6c6f 6164 3a0d 0a20 2020  _urlUpload:..   
+000074a0: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+000074b0: 2020 2020 2020 205f 696e 7075 743d 646f         _input=do
+000074c0: 776e 6c6f 6164 496d 6167 6528 5f75 726c  wnloadImage(_url
+000074d0: 5570 6c6f 6164 290d 0a20 2020 2020 2020  Upload)..       
+000074e0: 2020 2020 2069 6620 5f69 6e70 7574 3a0d       if _input:.
+000074f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007500: 2061 4172 6746 6f72 7061 7273 6572 4149   aArgForparserAI
+00007510: 2e61 7070 656e 6428 222d 6669 6c65 6e61  .append("-filena
+00007520: 6d65 2229 0d0a 2020 2020 2020 2020 2020  me")..          
+00007530: 2020 2020 2020 6141 7267 466f 7270 6172        aArgForpar
+00007540: 7365 7241 492e 6170 7065 6e64 285f 696e  serAI.append(_in
+00007550: 7075 7429 0d0a 2020 2020 2020 2020 2020  put)..          
+00007560: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00007570: 2020 2020 2020 2020 2023 2320 6d69 6e20           ## min 
+00007580: 7265 7175 6972 656d 656e 7473 0d0a 2020  requirements..  
+00007590: 2020 2020 2020 2020 2020 2020 2020 7072                pr
+000075a0: 696e 7428 226e 6f20 696d 6167 6520 746f  int("no image to
+000075b0: 2070 726f 6365 7373 2229 0d0a 2020 2020   process")..    
+000075c0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+000075d0: 726e 2022 696e 7075 7420 7265 7175 6972  rn "input requir
+000075e0: 6564 220d 0a20 2020 2020 2020 2065 7863  ed"..        exc
+000075f0: 6570 7420 4578 6365 7074 696f 6e20 6173  ept Exception as
+00007600: 2065 7272 3a0d 0a20 2020 2020 2020 2020   err:..         
+00007610: 2020 2070 7269 6e74 2822 4352 4954 4943     print("CRITIC
+00007620: 414c 3a20 222b 6572 722e 6d73 6729 0d0a  AL: "+err.msg)..
+00007630: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00007640: 6520 6572 720d 0a20 2020 200d 0a20 2020  e err..    ..   
+00007650: 2023 2320 496e 6974 204f 5341 4953 2050   ## Init OSAIS P
+00007660: 6172 616d 7320 2866 726f 6d20 616c 6c20  arams (from all 
+00007670: 6172 6773 2c20 6b65 6570 206f 6e6c 7920  args, keep only 
+00007680: 7468 6f73 6520 666f 7220 4f53 4149 5329  those for OSAIS)
+00007690: 0d0a 2020 2020 6141 7267 466f 7250 6172  ..    aArgForPar
+000076a0: 7365 724f 5341 4953 3d5f 6765 7441 7267  serOSAIS=_getArg
+000076b0: 7328 5f61 7267 7329 0d0a 2020 2020 6172  s(_args)..    ar
+000076c0: 6773 5f45 7863 6c75 7369 7665 4f53 4149  gs_ExclusiveOSAI
+000076d0: 532e 6170 7065 6e64 2827 2d6f 6469 7227  S.append('-odir'
+000076e0: 290d 0a20 2020 2061 7267 735f 4578 636c  )..    args_Excl
+000076f0: 7573 6976 654f 5341 4953 2e61 7070 656e  usiveOSAIS.appen
+00007700: 6428 272d 6964 6972 2729 0d0a 2020 2020  d('-idir')..    
+00007710: 6141 7267 466f 7250 6172 7365 724f 5341  aArgForParserOSA
+00007720: 4953 3d5f 6172 6773 4672 6f6d 4669 6c74  IS=_argsFromFilt
+00007730: 6572 2861 4172 6746 6f72 5061 7273 6572  er(aArgForParser
+00007740: 4f53 4149 532c 2061 7267 735f 4578 636c  OSAIS, args_Excl
+00007750: 7573 6976 654f 5341 4953 2c20 5472 7565  usiveOSAIS, True
+00007760: 290d 0a20 2020 206f 7361 6973 5f69 6e69  )..    osais_ini
+00007770: 7450 6172 7365 7228 6141 7267 466f 7250  tParser(aArgForP
+00007780: 6172 7365 724f 5341 4953 290d 0a0d 0a20  arserOSAIS).... 
+00007790: 2020 2069 6620 6749 7357 6172 6d75 703a     if gIsWarmup:
+000077a0: 0d0a 2020 2020 2020 2020 7072 696e 7428  ..        print(
+000077b0: 225c 725c 6e3d 3e20 5761 726d 696e 6720  "\r\n=> Warming 
+000077c0: 7570 2e2e 2e20 5c72 5c6e 2229 0d0a 2020  up... \r\n")..  
+000077d0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+000077e0: 2070 7269 6e74 2822 5c72 5c6e 3d3e 2062   print("\r\n=> b
+000077f0: 6566 6f72 6520 7275 6e3a 2070 726f 6365  efore run: proce
+00007800: 7373 6564 2061 7267 7320 6672 6f6d 2075  ssed args from u
+00007810: 726c 3a20 222b 7374 7228 6141 7267 466f  rl: "+str(aArgFo
+00007820: 7270 6172 7365 7241 4929 2b22 5c72 5c6e  rparserAI)+"\r\n
+00007830: 2229 0d0a 0d0a 2020 2020 2323 c2a0 7072  ")....    ##..pr
+00007840: 6f63 6573 7369 6e67 2061 6363 6570 7465  ocessing accepte
+00007850: 640d 0a20 2020 2067 4c61 7374 5072 6f63  d..    gLastProc
+00007860: 6573 7353 7461 7274 5f61 743d 6461 7465  essStart_at=date
+00007870: 7469 6d65 2e75 7463 6e6f 7728 290d 0a20  time.utcnow().. 
+00007880: 2020 2067 4150 726f 6365 7373 6564 2e61     gAProcessed.a
+00007890: 7070 656e 6428 5f75 6964 290d 0a0d 0a20  ppend(_uid).... 
+000078a0: 2020 2023 2320 6e6f 7469 6679 204f 5341     ## notify OSA
+000078b0: 4953 2028 7374 6172 7429 0d0a 2020 2020  IS (start)..    
+000078c0: 4372 6564 7350 6172 616d 3d67 6574 4372  CredsParam=getCr
+000078d0: 6564 7350 6172 616d 7328 290d 0a20 2020  edsParams()..   
+000078e0: 204d 6f72 7068 696e 6750 6172 616d 3d67   MorphingParam=g
+000078f0: 6574 4d6f 7270 6869 6e67 5061 7261 6d73  etMorphingParams
+00007900: 2829 0d0a 2020 2020 5374 6167 6550 6172  ()..    StagePar
+00007910: 616d 3d67 6574 5374 6167 6550 6172 616d  am=getStageParam
+00007920: 7328 4149 5f50 524f 4752 4553 535f 4149  s(AI_PROGRESS_AI
+00007930: 5f53 5441 5254 4544 2c20 3029 0d0a 2020  _STARTED, 0)..  
+00007940: 2020 6f73 6169 735f 6e6f 7469 6679 2843    osais_notify(C
+00007950: 7265 6473 5061 7261 6d2c 204d 6f72 7068  redsParam, Morph
+00007960: 696e 6750 6172 616d 202c 2053 7461 6765  ingParam , Stage
+00007970: 5061 7261 6d29 0d0a 0d0a 2020 2020 2323  Param)....    ##
+00007980: 2073 7461 7274 2077 6174 6368 2066 696c   start watch fil
+00007990: 6520 6372 6561 7469 6f6e 0d0a 2020 2020  e creation..    
+000079a0: 5f6f 7574 7075 743d 5f67 6574 4f75 7470  _output=_getOutp
+000079b0: 7574 4469 7228 290d 0a20 2020 2077 6174  utDir()..    wat
+000079c0: 6368 5f64 6972 6563 746f 7279 285f 6f75  ch_directory(_ou
+000079d0: 7470 7574 2c20 6f73 6169 735f 6f6e 4e6f  tput, osais_onNo
+000079e0: 7469 6679 4669 6c65 4372 6561 7465 642c  tifyFileCreated,
+000079f0: 205f 6172 6773 290d 0a0d 0a20 2020 2023   _args)....    #
+00007a00: 2320 4e6f 7469 6620 4f53 4149 530d 0a20  # Notif OSAIS.. 
+00007a10: 2020 2053 7461 6765 5061 7261 6d3d 6765     StageParam=ge
+00007a20: 7453 7461 6765 5061 7261 6d73 2841 495f  tStageParams(AI_
+00007a30: 5052 4f47 5245 5353 5f49 4e49 545f 494d  PROGRESS_INIT_IM
+00007a40: 4147 452c 2030 290d 0a20 2020 206f 7361  AGE, 0)..    osa
+00007a50: 6973 5f6e 6f74 6966 7928 4372 6564 7350  is_notify(CredsP
+00007a60: 6172 616d 2c20 4d6f 7270 6869 6e67 5061  aram, MorphingPa
+00007a70: 7261 6d20 2c20 5374 6167 6550 6172 616d  ram , StageParam
+00007a80: 290d 0a0d 0a20 2020 2023 2320 7275 6e20  )....    ## run 
+00007a90: 4149 0d0a 2020 2020 7265 7370 6f6e 7365  AI..    response
+00007aa0: 3d4e 6f6e 650d 0a20 2020 2074 7279 3a0d  =None..    try:.
+00007ab0: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+00007ac0: 6172 6773 293d 3d32 3a0d 0a20 2020 2020  args)==2:..     
+00007ad0: 2020 2020 2020 2072 6573 706f 6e73 653d         response=
+00007ae0: 666e 5f72 756e 2861 4172 6746 6f72 7061  fn_run(aArgForpa
+00007af0: 7273 6572 4149 290d 0a20 2020 2020 2020  rserAI)..       
+00007b00: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00007b10: 2020 2020 6966 206c 656e 2861 7267 7329      if len(args)
+00007b20: 3d3d 333a 0d0a 2020 2020 2020 2020 2020  ==3:..          
+00007b30: 2020 2020 2020 7265 7370 6f6e 7365 3d66        response=f
+00007b40: 6e5f 7275 6e28 6141 7267 466f 7270 6172  n_run(aArgForpar
+00007b50: 7365 7241 492c 2061 7267 735b 325d 290d  serAI, args[2]).
+00007b60: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00007b70: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00007b80: 2020 2020 7265 7370 6f6e 7365 3d66 6e5f      response=fn_
+00007b90: 7275 6e28 6141 7267 466f 7270 6172 7365  run(aArgForparse
+00007ba0: 7241 492c 2061 7267 735b 325d 2c20 6172  rAI, args[2], ar
+00007bb0: 6773 5b33 5d29 0d0a 2020 2020 6578 6365  gs[3])..    exce
+00007bc0: 7074 2045 7863 6570 7469 6f6e 2061 7320  pt Exception as 
+00007bd0: 6572 723a 0d0a 2020 2020 2020 2020 7072  err:..        pr
+00007be0: 696e 7428 2243 5249 5449 4341 4c3a 2022  int("CRITICAL: "
+00007bf0: 2b65 7272 2e6d 7367 290d 0a20 2020 2020  +err.msg)..     
+00007c00: 2020 2072 6169 7365 2065 7272 0d0a 0d0a     raise err....
+00007c10: 2020 2020 2323 2063 616c 6375 6c61 7465      ## calculate
+00007c20: 2063 6f73 740d 0a20 2020 2067 4973 4275   cost..    gIsBu
+00007c30: 7379 3d46 616c 7365 0d0a 2020 2020 656e  sy=False..    en
+00007c40: 645f 6461 7465 203d 2064 6174 6574 696d  d_date = datetim
+00007c50: 652e 7574 636e 6f77 2829 0d0a 2020 2020  e.utcnow()..    
+00007c60: 6465 6c74 613d 656e 645f 6461 7465 202d  delta=end_date -
+00007c70: 2062 6567 5f64 6174 650d 0a20 2020 2063   beg_date..    c
+00007c80: 6f73 7420 3d20 696e 7428 6465 6c74 612e  ost = int(delta.
+00007c90: 746f 7461 6c5f 7365 636f 6e64 7328 292a  total_seconds()*
+00007ca0: 2031 3030 3020 2b20 6465 6c74 612e 6d69   1000 + delta.mi
+00007cb0: 6372 6f73 6563 6f6e 6473 202f 2031 3030  croseconds / 100
+00007cc0: 3029 0d0a 2020 2020 5f61 6464 436f 7374  0)..    _addCost
+00007cd0: 2863 6f73 7429 0d0a 0d0a 2020 2020 2323  (cost)....    ##
+00007ce0: 206e 6f74 6966 7920 656e 640d 0a20 2020   notify end..   
+00007cf0: 2053 7461 6765 5061 7261 6d3d 6765 7453   StageParam=getS
+00007d00: 7461 6765 5061 7261 6d73 2841 495f 5052  tageParams(AI_PR
+00007d10: 4f47 5245 5353 5f41 495f 5354 4f50 5045  OGRESS_AI_STOPPE
+00007d20: 442c 2063 6f73 7429 0d0a 2020 2020 6f73  D, cost)..    os
+00007d30: 6169 735f 6e6f 7469 6679 2843 7265 6473  ais_notify(Creds
+00007d40: 5061 7261 6d2c 204d 6f72 7068 696e 6750  Param, MorphingP
+00007d50: 6172 616d 202c 2053 7461 6765 5061 7261  aram , StagePara
+00007d60: 6d29 0d0a 0d0a 2020 2020 2323 2064 6566  m)....    ## def
+00007d70: 6175 6c74 204f 4b20 7265 7370 6f6e 7365  ault OK response
+00007d80: 2069 6620 7468 6520 4149 2064 6f65 7320   if the AI does 
+00007d90: 6e6f 7420 7365 6e64 2061 6e79 0d0a 2020  not send any..  
+00007da0: 2020 6966 2072 6573 706f 6e73 653d 3d4e    if response==N
+00007db0: 6f6e 653a 0d0a 2020 2020 2020 2020 7265  one:..        re
+00007dc0: 7370 6f6e 7365 3d54 7275 650d 0a20 2020  sponse=True..   
+00007dd0: 2072 6574 7572 6e20 7265 7370 6f6e 7365   return response
+00007de0: 0d0a 0d0a 2323 202d 2d2d 2d2d 2d2d 2d2d  ....## ---------
 00007df0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00007e00: 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d 0a64 6566  ---------....def
-00007e10: 2067 6574 4372 6564 7350 6172 616d 7328   getCredsParams(
-00007e20: 2920 3a0d 0a20 2020 2067 6c6f 6261 6c20  ) :..    global 
-00007e30: 674e 616d 650d 0a20 2020 2067 6c6f 6261  gName..    globa
-00007e40: 6c20 6741 7267 734f 5341 4953 0d0a 2020  l gArgsOSAIS..  
-00007e50: 2020 7265 7475 726e 207b 0d0a 2020 2020    return {..    
-00007e60: 2020 2020 2265 6e67 696e 6522 3a20 674e      "engine": gN
-00007e70: 616d 652c 200d 0a20 2020 2020 2020 2022  ame, ..        "
-00007e80: 7665 7273 696f 6e22 3a20 6756 6572 7369  version": gVersi
-00007e90: 6f6e 2c20 0d0a 2020 2020 2020 2020 2274  on, ..        "t
-00007ea0: 6f6b 656e 4149 223a 2067 4172 6773 4f53  okenAI": gArgsOS
-00007eb0: 4149 532e 746f 6b65 6e41 492c 0d0a 2020  AIS.tokenAI,..  
-00007ec0: 2020 2020 2020 2275 7365 726e 616d 6522        "username"
-00007ed0: 3a20 6741 7267 734f 5341 4953 2e75 7365  : gArgsOSAIS.use
-00007ee0: 726e 616d 652c 0d0a 2020 2020 2020 2020  rname,..        
-00007ef0: 2269 734c 6f63 616c 223a 2067 4172 6773  "isLocal": gArgs
-00007f00: 4f53 4149 532e 6973 4c6f 6361 6c0d 0a20  OSAIS.isLocal.. 
-00007f10: 2020 207d 200d 0a0d 0a64 6566 2067 6574     } ....def get
-00007f20: 4d6f 7270 6869 6e67 5061 7261 6d73 2829  MorphingParams()
-00007f30: 203a 0d0a 2020 2020 676c 6f62 616c 2067   :..    global g
-00007f40: 4172 6773 4f53 4149 530d 0a20 2020 2072  ArgsOSAIS..    r
-00007f50: 6574 7572 6e20 7b0d 0a20 2020 2020 2020  eturn {..       
-00007f60: 2022 7569 6422 3a20 6741 7267 734f 5341   "uid": gArgsOSA
-00007f70: 4953 2e75 6964 2c0d 0a20 2020 2020 2020  IS.uid,..       
-00007f80: 2022 6379 636c 6522 3a20 6741 7267 734f   "cycle": gArgsO
-00007f90: 5341 4953 2e63 7963 6c65 2c0d 0a20 2020  SAIS.cycle,..   
-00007fa0: 2020 2020 2022 6669 6c65 6e61 6d65 223a       "filename":
-00007fb0: 2067 4172 6773 4f53 4149 532e 6669 6c65   gArgsOSAIS.file
-00007fc0: 6e61 6d65 2c20 0d0a 2020 2020 2020 2020  name, ..        
-00007fd0: 226f 6469 7222 3a20 5f67 6574 4f75 7470  "odir": _getOutp
-00007fe0: 7574 4469 7228 290d 0a20 2020 207d 0d0a  utDir()..    }..
-00007ff0: 0d0a 6465 6620 6765 7453 7461 6765 5061  ..def getStagePa
-00008000: 7261 6d73 285f 7374 6167 652c 205f 636f  rams(_stage, _co
-00008010: 7374 2920 3a0d 0a20 2020 2067 6c6f 6261  st) :..    globa
-00008020: 6c20 6741 7267 734f 5341 4953 0d0a 2020  l gArgsOSAIS..  
-00008030: 2020 6966 205f 7374 6167 653d 3d41 495f    if _stage==AI_
-00008040: 5052 4f47 5245 5353 5f41 5247 533a 0d0a  PROGRESS_ARGS:..
-00008050: 2020 2020 2020 2020 7265 7475 726e 207b          return {
-00008060: 2273 7461 6765 223a 2041 495f 5052 4f47  "stage": AI_PROG
-00008070: 5245 5353 5f41 495f 5354 4152 5445 442c  RESS_AI_STARTED,
-00008080: 2022 6465 7363 7222 3a22 4a75 7374 2070   "descr":"Just p
-00008090: 6172 7365 6420 4149 2070 6172 616d 7322  arsed AI params"
-000080a0: 7d0d 0a20 2020 2069 6620 5f73 7461 6765  }..    if _stage
-000080b0: 3d3d 4149 5f50 524f 4752 4553 535f 4552  ==AI_PROGRESS_ER
-000080c0: 524f 523a 0d0a 2020 2020 2020 2020 7265  ROR:..        re
-000080d0: 7475 726e 207b 2273 7461 6765 223a 2041  turn {"stage": A
-000080e0: 495f 5052 4f47 5245 5353 5f41 495f 5354  I_PROGRESS_AI_ST
-000080f0: 4f50 5045 442c 2022 6465 7363 7222 3a22  OPPED, "descr":"
-00008100: 4149 2073 746f 7070 6564 2077 6974 6820  AI stopped with 
-00008110: 6572 726f 7222 7d0d 0a20 2020 2069 6620  error"}..    if 
-00008120: 5f73 7461 6765 3d3d 4149 5f50 524f 4752  _stage==AI_PROGR
-00008130: 4553 535f 4149 5f53 5441 5254 4544 3a0d  ESS_AI_STARTED:.
-00008140: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00008150: 7b22 7374 6167 6522 3a20 4149 5f50 524f  {"stage": AI_PRO
-00008160: 4752 4553 535f 4149 5f53 5441 5254 4544  GRESS_AI_STARTED
-00008170: 2c20 2264 6573 6372 223a 2241 4920 7374  , "descr":"AI st
-00008180: 6172 7465 6422 7d0d 0a20 2020 2069 6620  arted"}..    if 
-00008190: 5f73 7461 6765 3d3d 4149 5f50 524f 4752  _stage==AI_PROGR
-000081a0: 4553 535f 4149 5f53 544f 5050 4544 3a0d  ESS_AI_STOPPED:.
-000081b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000081c0: 7b22 7374 6167 6522 3a20 4149 5f50 524f  {"stage": AI_PRO
-000081d0: 4752 4553 535f 4149 5f53 544f 5050 4544  GRESS_AI_STOPPED
-000081e0: 2c20 2264 6573 6372 223a 2241 4920 7374  , "descr":"AI st
-000081f0: 6f70 7065 6422 2c20 2263 6f73 7422 3a20  opped", "cost": 
-00008200: 5f63 6f73 747d 0d0a 2020 2020 6966 205f  _cost}..    if _
-00008210: 7374 6167 653d 3d41 495f 5052 4f47 5245  stage==AI_PROGRE
-00008220: 5353 5f49 4e49 545f 494d 4147 453a 0d0a  SS_INIT_IMAGE:..
-00008230: 2020 2020 2020 2020 7265 7475 726e 207b          return {
-00008240: 2273 7461 6765 223a 2041 495f 5052 4f47  "stage": AI_PROG
-00008250: 5245 5353 5f49 4e49 545f 494d 4147 452c  RESS_INIT_IMAGE,
-00008260: 2022 6465 7363 7222 3a22 6465 7374 696e   "descr":"destin
-00008270: 6174 696f 6e20 696d 6167 6520 3d20 222b  ation image = "+
-00008280: 6741 7267 734f 5341 4953 2e66 696c 656e  gArgsOSAIS.filen
-00008290: 616d 657d 0d0a 2020 2020 6966 205f 7374  ame}..    if _st
-000082a0: 6167 653d 3d41 495f 5052 4f47 5245 5353  age==AI_PROGRESS
-000082b0: 5f44 4f4e 455f 494d 4147 453a 0d0a 2020  _DONE_IMAGE:..  
-000082c0: 2020 2020 2020 7265 7475 726e 207b 2273        return {"s
-000082d0: 7461 6765 223a 2041 495f 5052 4f47 5245  tage": AI_PROGRE
-000082e0: 5353 5f44 4f4e 455f 494d 4147 452c 2022  SS_DONE_IMAGE, "
-000082f0: 6465 7363 7222 3a22 636f 7069 6564 2069  descr":"copied i
-00008300: 6e70 7574 2069 6d61 6765 2074 6f20 6465  nput image to de
-00008310: 7374 696e 6174 696f 6e20 696d 6167 6522  stination image"
-00008320: 7d0d 0a20 2020 2072 6574 7572 6e20 7b22  }..    return {"
-00008330: 7374 6167 6522 3a20 4149 5f50 524f 4752  stage": AI_PROGR
-00008340: 4553 535f 4552 524f 522c 2022 6465 7363  ESS_ERROR, "desc
-00008350: 7222 3a22 6572 726f 7222 7d0d 0a0d 0a23  r":"error"}....#
-00008360: 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  # --------------
-00008370: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00008380: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00008390: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000083a0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2320 2020  ----------..#   
-000083b0: 2020 2020 4e6f 7469 6669 6361 7469 6f6e      Notification
-000083c0: 7320 746f 2047 6174 6577 6179 202f 204f  s to Gateway / O
-000083d0: 5341 4953 0d0a 2323 202d 2d2d 2d2d 2d2d  SAIS..## -------
-000083e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000083f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00008400: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00007e00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00007e10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00007e20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d  ---------------.
+00007e30: 0a23 2020 2020 2020 2067 6574 2066 6f72  .#       get for
+00007e40: 6d61 7474 6564 2070 6172 616d 7320 6672  matted params fr
+00007e50: 6f6d 2041 4920 6375 7272 656e 7420 7374  om AI current st
+00007e60: 6174 650d 0a23 2320 2d2d 2d2d 2d2d 2d2d  ate..## --------
+00007e70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00007e80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00007e90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00007ea0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00007eb0: 0d0a 0d0a 6465 6620 6765 7443 7265 6473  ....def getCreds
+00007ec0: 5061 7261 6d73 2829 203a 0d0a 2020 2020  Params() :..    
+00007ed0: 676c 6f62 616c 2067 4e61 6d65 0d0a 2020  global gName..  
+00007ee0: 2020 676c 6f62 616c 2067 4172 6773 4f53    global gArgsOS
+00007ef0: 4149 530d 0a20 2020 2072 6574 7572 6e20  AIS..    return 
+00007f00: 7b0d 0a20 2020 2020 2020 2022 656e 6769  {..        "engi
+00007f10: 6e65 223a 2067 4e61 6d65 2c20 0d0a 2020  ne": gName, ..  
+00007f20: 2020 2020 2020 2276 6572 7369 6f6e 223a        "version":
+00007f30: 2067 5665 7273 696f 6e2c 200d 0a20 2020   gVersion, ..   
+00007f40: 2020 2020 2022 746f 6b65 6e41 4922 3a20       "tokenAI": 
+00007f50: 6741 7267 734f 5341 4953 2e74 6f6b 656e  gArgsOSAIS.token
+00007f60: 4149 2c0d 0a20 2020 2020 2020 2022 7573  AI,..        "us
+00007f70: 6572 6e61 6d65 223a 2067 4172 6773 4f53  ername": gArgsOS
+00007f80: 4149 532e 7573 6572 6e61 6d65 2c0d 0a20  AIS.username,.. 
+00007f90: 2020 2020 2020 2022 6973 4c6f 6361 6c22         "isLocal"
+00007fa0: 3a20 6741 7267 734f 5341 4953 2e69 734c  : gArgsOSAIS.isL
+00007fb0: 6f63 616c 0d0a 2020 2020 7d20 0d0a 0d0a  ocal..    } ....
+00007fc0: 6465 6620 6765 744d 6f72 7068 696e 6750  def getMorphingP
+00007fd0: 6172 616d 7328 2920 3a0d 0a20 2020 2067  arams() :..    g
+00007fe0: 6c6f 6261 6c20 6741 7267 734f 5341 4953  lobal gArgsOSAIS
+00007ff0: 0d0a 2020 2020 7265 7475 726e 207b 0d0a  ..    return {..
+00008000: 2020 2020 2020 2020 2275 6964 223a 2067          "uid": g
+00008010: 4172 6773 4f53 4149 532e 7569 642c 0d0a  ArgsOSAIS.uid,..
+00008020: 2020 2020 2020 2020 2263 7963 6c65 223a          "cycle":
+00008030: 2067 4172 6773 4f53 4149 532e 6379 636c   gArgsOSAIS.cycl
+00008040: 652c 0d0a 2020 2020 2020 2020 2266 696c  e,..        "fil
+00008050: 656e 616d 6522 3a20 6741 7267 734f 5341  ename": gArgsOSA
+00008060: 4953 2e66 696c 656e 616d 652c 200d 0a20  IS.filename, .. 
+00008070: 2020 2020 2020 2022 6f64 6972 223a 205f         "odir": _
+00008080: 6765 744f 7574 7075 7444 6972 2829 0d0a  getOutputDir()..
+00008090: 2020 2020 7d0d 0a0d 0a64 6566 2067 6574      }....def get
+000080a0: 5374 6167 6550 6172 616d 7328 5f73 7461  StageParams(_sta
+000080b0: 6765 2c20 5f63 6f73 7429 203a 0d0a 2020  ge, _cost) :..  
+000080c0: 2020 676c 6f62 616c 2067 4172 6773 4f53    global gArgsOS
+000080d0: 4149 530d 0a20 2020 2069 6620 5f73 7461  AIS..    if _sta
+000080e0: 6765 3d3d 4149 5f50 524f 4752 4553 535f  ge==AI_PROGRESS_
+000080f0: 4152 4753 3a0d 0a20 2020 2020 2020 2072  ARGS:..        r
+00008100: 6574 7572 6e20 7b22 7374 6167 6522 3a20  eturn {"stage": 
+00008110: 4149 5f50 524f 4752 4553 535f 4149 5f53  AI_PROGRESS_AI_S
+00008120: 5441 5254 4544 2c20 2264 6573 6372 223a  TARTED, "descr":
+00008130: 224a 7573 7420 7061 7273 6564 2041 4920  "Just parsed AI 
+00008140: 7061 7261 6d73 227d 0d0a 2020 2020 6966  params"}..    if
+00008150: 205f 7374 6167 653d 3d41 495f 5052 4f47   _stage==AI_PROG
+00008160: 5245 5353 5f45 5252 4f52 3a0d 0a20 2020  RESS_ERROR:..   
+00008170: 2020 2020 2072 6574 7572 6e20 7b22 7374       return {"st
+00008180: 6167 6522 3a20 4149 5f50 524f 4752 4553  age": AI_PROGRES
+00008190: 535f 4149 5f53 544f 5050 4544 2c20 2264  S_AI_STOPPED, "d
+000081a0: 6573 6372 223a 2241 4920 7374 6f70 7065  escr":"AI stoppe
+000081b0: 6420 7769 7468 2065 7272 6f72 227d 0d0a  d with error"}..
+000081c0: 2020 2020 6966 205f 7374 6167 653d 3d41      if _stage==A
+000081d0: 495f 5052 4f47 5245 5353 5f41 495f 5354  I_PROGRESS_AI_ST
+000081e0: 4152 5445 443a 0d0a 2020 2020 2020 2020  ARTED:..        
+000081f0: 7265 7475 726e 207b 2273 7461 6765 223a  return {"stage":
+00008200: 2041 495f 5052 4f47 5245 5353 5f41 495f   AI_PROGRESS_AI_
+00008210: 5354 4152 5445 442c 2022 6465 7363 7222  STARTED, "descr"
+00008220: 3a22 4149 2073 7461 7274 6564 227d 0d0a  :"AI started"}..
+00008230: 2020 2020 6966 205f 7374 6167 653d 3d41      if _stage==A
+00008240: 495f 5052 4f47 5245 5353 5f41 495f 5354  I_PROGRESS_AI_ST
+00008250: 4f50 5045 443a 0d0a 2020 2020 2020 2020  OPPED:..        
+00008260: 7265 7475 726e 207b 2273 7461 6765 223a  return {"stage":
+00008270: 2041 495f 5052 4f47 5245 5353 5f41 495f   AI_PROGRESS_AI_
+00008280: 5354 4f50 5045 442c 2022 6465 7363 7222  STOPPED, "descr"
+00008290: 3a22 4149 2073 746f 7070 6564 222c 2022  :"AI stopped", "
+000082a0: 636f 7374 223a 205f 636f 7374 7d0d 0a20  cost": _cost}.. 
+000082b0: 2020 2069 6620 5f73 7461 6765 3d3d 4149     if _stage==AI
+000082c0: 5f50 524f 4752 4553 535f 494e 4954 5f49  _PROGRESS_INIT_I
+000082d0: 4d41 4745 3a0d 0a20 2020 2020 2020 2072  MAGE:..        r
+000082e0: 6574 7572 6e20 7b22 7374 6167 6522 3a20  eturn {"stage": 
+000082f0: 4149 5f50 524f 4752 4553 535f 494e 4954  AI_PROGRESS_INIT
+00008300: 5f49 4d41 4745 2c20 2264 6573 6372 223a  _IMAGE, "descr":
+00008310: 2264 6573 7469 6e61 7469 6f6e 2069 6d61  "destination ima
+00008320: 6765 203d 2022 2b67 4172 6773 4f53 4149  ge = "+gArgsOSAI
+00008330: 532e 6669 6c65 6e61 6d65 7d0d 0a20 2020  S.filename}..   
+00008340: 2069 6620 5f73 7461 6765 3d3d 4149 5f50   if _stage==AI_P
+00008350: 524f 4752 4553 535f 444f 4e45 5f49 4d41  ROGRESS_DONE_IMA
+00008360: 4745 3a0d 0a20 2020 2020 2020 2072 6574  GE:..        ret
+00008370: 7572 6e20 7b22 7374 6167 6522 3a20 4149  urn {"stage": AI
+00008380: 5f50 524f 4752 4553 535f 444f 4e45 5f49  _PROGRESS_DONE_I
+00008390: 4d41 4745 2c20 2264 6573 6372 223a 2263  MAGE, "descr":"c
+000083a0: 6f70 6965 6420 696e 7075 7420 696d 6167  opied input imag
+000083b0: 6520 746f 2064 6573 7469 6e61 7469 6f6e  e to destination
+000083c0: 2069 6d61 6765 227d 0d0a 2020 2020 7265   image"}..    re
+000083d0: 7475 726e 207b 2273 7461 6765 223a 2041  turn {"stage": A
+000083e0: 495f 5052 4f47 5245 5353 5f45 5252 4f52  I_PROGRESS_ERROR
+000083f0: 2c20 2264 6573 6372 223a 2265 7272 6f72  , "descr":"error
+00008400: 227d 0d0a 0d0a 2323 202d 2d2d 2d2d 2d2d  "}....## -------
 00008410: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00008420: 2d0d 0a0d 0a23 2055 706c 6f61 6420 696d  -....# Upload im
-00008430: 6167 6520 746f 204f 5341 4953 200d 0a64  age to OSAIS ..d
-00008440: 6566 205f 7570 6c6f 6164 496d 6167 6554  ef _uploadImageT
-00008450: 6f4f 5341 4953 286f 626a 5061 7261 6d2c  oOSAIS(objParam,
-00008460: 2069 734c 6f63 616c 293a 0d0a 2020 2020   isLocal):..    
-00008470: 6966 2067 4973 5669 7274 7561 6c41 493d  if gIsVirtualAI=
-00008480: 3d46 616c 7365 3a0d 0a20 2020 2020 2020  =False:..       
-00008490: 2072 6574 7572 6e20 4e6f 6e65 0d0a 2020   return None..  
-000084a0: 2020 0d0a 2020 2020 676c 6f62 616c 2067    ..    global g
-000084b0: 4175 7468 546f 6b65 6e0d 0a20 2020 2067  AuthToken..    g
-000084c0: 6c6f 6261 6c20 674f 7269 6769 6e4f 5341  lobal gOriginOSA
-000084d0: 4953 0d0a 2020 2020 676c 6f62 616c 2067  IS..    global g
-000084e0: 4175 7468 546f 6b65 6e4c 6f63 616c 0d0a  AuthTokenLocal..
-000084f0: 2020 2020 676c 6f62 616c 2067 4f72 6967      global gOrig
-00008500: 696e 4c6f 6361 6c4f 5341 4953 0d0a 0d0a  inLocalOSAIS....
-00008510: 2020 2020 5f61 7574 683d 6741 7574 6854      _auth=gAuthT
-00008520: 6f6b 656e 0d0a 2020 2020 6966 2069 734c  oken..    if isL
-00008530: 6f63 616c 3a0d 0a20 2020 2020 2020 205f  ocal:..        _
-00008540: 6175 7468 3d67 4175 7468 546f 6b65 6e4c  auth=gAuthTokenL
-00008550: 6f63 616c 0d0a 2020 2020 5f6f 7361 6973  ocal..    _osais
-00008560: 3d67 4f72 6967 696e 4f53 4149 530d 0a20  =gOriginOSAIS.. 
-00008570: 2020 2069 6620 6973 4c6f 6361 6c3a 0d0a     if isLocal:..
-00008580: 2020 2020 2020 2020 5f6f 7361 6973 3d67          _osais=g
-00008590: 4f72 6967 696e 4c6f 6361 6c4f 5341 4953  OriginLocalOSAIS
-000085a0: 0d0a 0d0a 2020 2020 2320 6c65 7473 2067  ....    # lets g
-000085b0: 6f20 6361 6c6c 204f 5341 4953 2041 4920  o call OSAIS AI 
-000085c0: 4761 7465 7761 7920 2f20 6f72 204f 5341  Gateway / or OSA
-000085d0: 4953 2069 7473 656c 660d 0a20 2020 2068  IS itself..    h
-000085e0: 6561 6465 7273 203d 207b 0d0a 2020 2020  eaders = {..    
-000085f0: 2020 2020 2243 6f6e 7465 6e74 2d54 7970      "Content-Typ
-00008600: 6522 3a20 2761 7070 6c69 6361 7469 6f6e  e": 'application
-00008610: 2f6a 736f 6e27 2c20 0d0a 2020 2020 2020  /json', ..      
-00008620: 2020 2741 6363 6570 7427 3a20 2774 6578    'Accept': 'tex
-00008630: 742f 706c 6169 6e27 2c0d 0a20 2020 2020  t/plain',..     
-00008640: 2020 2022 4175 7468 6f72 697a 6174 696f     "Authorizatio
-00008650: 6e22 3a20 6622 4265 6172 6572 207b 5f61  n": f"Bearer {_a
-00008660: 7574 687d 220d 0a20 2020 207d 0d0a 0d0a  uth}"..    }....
-00008670: 2020 2020 6170 695f 7572 6c3d 6622 7b5f      api_url=f"{_
-00008680: 6f73 6169 737d 6170 692f 7631 2f70 7269  osais}api/v1/pri
-00008690: 7661 7465 2f75 706c 6f61 6422 2020 2020  vate/upload"    
-000086a0: 2020 2020 0d0a 2020 2020 7061 796c 6f61      ..    payloa
-000086b0: 6420 3d20 6a73 6f6e 2e64 756d 7073 286f  d = json.dumps(o
-000086c0: 626a 5061 7261 6d29 0d0a 2020 2020 7265  bjParam)..    re
-000086d0: 7370 6f6e 7365 203d 2072 6571 7565 7374  sponse = request
-000086e0: 732e 706f 7374 2861 7069 5f75 726c 2c20  s.post(api_url, 
-000086f0: 6865 6164 6572 733d 6865 6164 6572 732c  headers=headers,
-00008700: 2064 6174 613d 7061 796c 6f61 6420 290d   data=payload ).
-00008710: 0a20 2020 206f 626a 5265 733d 7265 7370  .    objRes=resp
-00008720: 6f6e 7365 2e6a 736f 6e28 290d 0a20 2020  onse.json()..   
-00008730: 2072 6574 7572 6e20 6f62 6a52 6573 2020   return objRes  
-00008740: 2020 0d0a 0d0a 6465 6620 6f73 6169 735f    ....def osais_
-00008750: 6f6e 4e6f 7469 6679 4669 6c65 4372 6561  onNotifyFileCrea
-00008760: 7465 6428 5f64 6972 2c20 5f66 696c 656e  ted(_dir, _filen
-00008770: 616d 652c 205f 6172 6773 293a 0d0a 2020  ame, _args):..  
-00008780: 2020 6741 7267 734f 5341 4953 2e66 696c    gArgsOSAIS.fil
-00008790: 656e 616d 653d 5f66 696c 656e 616d 650d  ename=_filename.
-000087a0: 0a20 2020 205f 7374 6167 6550 6172 616d  .    _stageParam
-000087b0: 3d67 6574 5374 6167 6550 6172 616d 7328  =getStageParams(
-000087c0: 4149 5f50 524f 4752 4553 535f 444f 4e45  AI_PROGRESS_DONE
-000087d0: 5f49 4d41 4745 2c20 3029 0d0a 2020 2020  _IMAGE, 0)..    
-000087e0: 5f6d 6f72 7068 696e 6750 6172 616d 3d67  _morphingParam=g
-000087f0: 6574 4d6f 7270 6869 6e67 5061 7261 6d73  etMorphingParams
-00008800: 2829 0d0a 2020 2020 5f63 7265 6473 5061  ()..    _credsPa
-00008810: 7261 6d3d 6765 7443 7265 6473 5061 7261  ram=getCredsPara
-00008820: 6d73 2829 0d0a 2020 2020 6f73 6169 735f  ms()..    osais_
-00008830: 6e6f 7469 6679 285f 6372 6564 7350 6172  notify(_credsPar
-00008840: 616d 2c20 5f6d 6f72 7068 696e 6750 6172  am, _morphingPar
-00008850: 616d 2c20 5f73 7461 6765 5061 7261 6d29  am, _stageParam)
-00008860: 2020 2020 2020 2020 2020 2020 2320 4f53              # OS
-00008870: 4149 5320 4e6f 7469 6669 6361 7469 6f6e  AIS Notification
-00008880: 0d0a 2020 2020 7265 7475 726e 2054 7275  ..    return Tru
-00008890: 650d 0a0d 0a23 2044 6972 6563 7420 4e6f  e....# Direct No
-000088a0: 7469 6679 204f 5341 4953 200d 0a64 6566  tify OSAIS ..def
-000088b0: 206f 7361 6973 5f6e 6f74 6966 7928 4372   osais_notify(Cr
-000088c0: 6564 5061 7261 6d2c 204d 6f72 7068 696e  edParam, Morphin
-000088d0: 6750 6172 616d 2c20 5374 6167 6550 6172  gParam, StagePar
-000088e0: 616d 293a 0d0a 2020 2020 676c 6f62 616c  am):..    global
-000088f0: 2067 4950 4c6f 6361 6c0d 0a20 2020 2067   gIPLocal..    g
-00008900: 6c6f 6261 6c20 6750 6f72 7447 6174 6577  lobal gPortGatew
-00008910: 6179 0d0a 2020 2020 676c 6f62 616c 2067  ay..    global g
-00008920: 4f72 6967 696e 4f53 4149 530d 0a20 2020  OriginOSAIS..   
-00008930: 2067 6c6f 6261 6c20 674f 7269 6769 6e4c   global gOriginL
-00008940: 6f63 616c 4f53 4149 530d 0a20 2020 2067  ocalOSAIS..    g
-00008950: 6c6f 6261 6c20 6749 7356 6972 7475 616c  lobal gIsVirtual
-00008960: 4149 0d0a 2020 2020 676c 6f62 616c 2067  AI..    global g
-00008970: 4175 7468 546f 6b65 6e0d 0a20 2020 2067  AuthToken..    g
-00008980: 6c6f 6261 6c20 6741 7574 6854 6f6b 656e  lobal gAuthToken
-00008990: 4c6f 6361 6c0d 0a20 2020 2067 6c6f 6261  Local..    globa
-000089a0: 6c20 674c 6173 7443 6865 636b 6564 5f61  l gLastChecked_a
-000089b0: 740d 0a20 2020 2067 6c6f 6261 6c20 6749  t..    global gI
-000089c0: 7357 6172 6d75 700d 0a0d 0a20 2020 2023  sWarmup....    #
-000089d0: 2320 6e6f 206e 6f74 6966 6963 6174 696f  # no notificatio
-000089e0: 6e20 6f66 2077 6172 6d75 700d 0a20 2020  n of warmup..   
-000089f0: 2069 6620 6749 7357 6172 6d75 703a 0d0a   if gIsWarmup:..
-00008a00: 2020 2020 2020 2020 7265 7475 726e 204e          return N
-00008a10: 6f6e 650d 0a20 2020 200d 0a20 2020 2067  one..    ..    g
-00008a20: 4c61 7374 4368 6563 6b65 645f 6174 203d  LastChecked_at =
-00008a30: 2064 6174 6574 696d 652e 7574 636e 6f77   datetime.utcnow
-00008a40: 2829 0d0a 0d0a 2020 2020 2320 6e6f 7469  ()....    # noti
-00008a50: 6669 6361 7469 6f6e 2063 6f6e 736f 6c65  fication console
-00008a60: 206c 6f67 0d0a 2020 2020 6d65 7267 6564   log..    merged
-00008a70: 203d 2064 6963 7428 290d 0a20 2020 206d   = dict()..    m
-00008a80: 6572 6765 642e 7570 6461 7465 2843 7265  erged.update(Cre
-00008a90: 6450 6172 616d 290d 0a20 2020 206d 6572  dParam)..    mer
-00008aa0: 6765 642e 7570 6461 7465 284d 6f72 7068  ged.update(Morph
-00008ab0: 696e 6750 6172 616d 290d 0a20 2020 2070  ingParam)..    p
-00008ac0: 7269 6e74 2822 4e6f 7469 6679 4f53 4149  rint("NotifyOSAI
-00008ad0: 5320 2822 2b73 7472 2853 7461 6765 5061  S ("+str(StagePa
-00008ae0: 7261 6d5b 2273 7461 6765 225d 292b 222f  ram["stage"])+"/
-00008af0: 2022 2b53 7461 6765 5061 7261 6d5b 2264   "+StageParam["d
-00008b00: 6573 6372 225d 2b22 293a 2022 2b73 7472  escr"]+"): "+str
-00008b10: 286d 6572 6765 6429 290d 0a20 2020 2070  (merged))..    p
-00008b20: 7269 6e74 2822 5c72 5c6e 2229 0d0a 0d0a  rint("\r\n")....
-00008b30: 2020 2020 5f66 696c 656e 616d 653d 2222      _filename=""
-00008b40: 0d0a 2020 2020 6966 204d 6f72 7068 696e  ..    if Morphin
-00008b50: 6750 6172 616d 5b22 6669 6c65 6e61 6d65  gParam["filename
-00008b60: 225d 213d 2222 3a0d 0a20 2020 2020 2020  "]!="":..       
-00008b70: 205f 6669 6c65 6e61 6d65 3d4d 6f72 7068   _filename=Morph
-00008b80: 696e 6750 6172 616d 5b22 6669 6c65 6e61  ingParam["filena
-00008b90: 6d65 225d 0d0a 0d0a 2020 2020 2320 6c65  me"]....    # le
-00008ba0: 7473 2067 6f20 6361 6c6c 204f 5341 4953  ts go call OSAIS
-00008bb0: 2041 4920 4761 7465 7761 7920 2f20 6f72   AI Gateway / or
-00008bc0: 204f 5341 4953 2069 7473 656c 660d 0a20   OSAIS itself.. 
-00008bd0: 2020 2068 6561 6465 7273 203d 207b 0d0a     headers = {..
-00008be0: 2020 2020 2020 2020 2243 6f6e 7465 6e74          "Content
-00008bf0: 2d54 7970 6522 3a20 2261 7070 6c69 6361  -Type": "applica
-00008c00: 7469 6f6e 2f6a 736f 6e22 0d0a 2020 2020  tion/json"..    
-00008c10: 7d0d 0a0d 0a20 2020 2023 2320 636f 6e66  }....    ## conf
-00008c20: 6967 2066 6f72 2063 616c 6c69 6e67 2067  ig for calling g
-00008c30: 6174 6577 6179 0d0a 2020 2020 6170 695f  ateway..    api_
-00008c40: 7572 6c20 3d20 6622 7b67 4f72 6967 696e  url = f"{gOrigin
-00008c50: 4761 7465 7761 797d 6170 692f 7631 2f70  Gateway}api/v1/p
-00008c60: 7562 6c69 632f 6e6f 7469 6679 220d 0a0d  ublic/notify"...
-00008c70: 0a20 2020 2023 2320 636f 6e66 6967 2066  .    ## config f
-00008c80: 6f72 2063 616c 6c69 6e67 204f 5341 4953  or calling OSAIS
-00008c90: 2028 6e6f 2067 6174 6577 6179 290d 0a20   (no gateway).. 
-00008ca0: 2020 2069 6620 6749 7356 6972 7475 616c     if gIsVirtual
-00008cb0: 4149 3a0d 0a20 2020 2020 2020 205f 6f73  AI:..        _os
-00008cc0: 6169 733d 674f 7269 6769 6e4f 5341 4953  ais=gOriginOSAIS
-00008cd0: 0d0a 2020 2020 2020 2020 5f61 7574 683d  ..        _auth=
-00008ce0: 6741 7574 6854 6f6b 656e 0d0a 0d0a 2020  gAuthToken....  
-00008cf0: 2020 2020 2020 6966 2043 7265 6450 6172        if CredPar
-00008d00: 616d 5b22 6973 4c6f 6361 6c22 5d3a 0d0a  am["isLocal"]:..
-00008d10: 2020 2020 2020 2020 2020 2020 5f6f 7361              _osa
-00008d20: 6973 3d67 4f72 6967 696e 4c6f 6361 6c4f  is=gOriginLocalO
-00008d30: 5341 4953 0d0a 2020 2020 2020 2020 2020  SAIS..          
-00008d40: 2020 5f61 7574 683d 6741 7574 6854 6f6b    _auth=gAuthTok
-00008d50: 656e 4c6f 6361 6c0d 0a0d 0a20 2020 2020  enLocal....     
-00008d60: 2020 2069 6620 6749 7356 6972 7475 616c     if gIsVirtual
-00008d70: 4149 3d3d 5472 7565 3a0d 0a20 2020 2020  AI==True:..     
-00008d80: 2020 2020 2020 2068 6561 6465 7273 5b22         headers["
-00008d90: 4175 7468 6f72 697a 6174 696f 6e22 5d3d  Authorization"]=
-00008da0: 2066 2242 6561 7265 7220 7b5f 6175 7468   f"Bearer {_auth
-00008db0: 7d22 0d0a 2020 2020 2020 2020 2020 2020  }"..            
-00008dc0: 6170 695f 7572 6c3d 6622 7b5f 6f73 6169  api_url=f"{_osai
-00008dd0: 737d 6170 692f 7631 2f70 7269 7661 7465  s}api/v1/private
-00008de0: 2f6e 6f74 6966 7922 0d0a 0d0a 2020 2020  /notify"....    
-00008df0: 6f62 6a50 6172 616d 3d7b 0d0a 2020 2020  objParam={..    
-00008e00: 2020 2020 2272 6573 706f 6e73 6522 3a20      "response": 
-00008e10: 7b0d 0a20 2020 2020 2020 2020 2020 2022  {..            "
-00008e20: 746f 6b65 6e22 3a20 4372 6564 5061 7261  token": CredPara
-00008e30: 6d5b 2274 6f6b 656e 4149 225d 2c0d 0a20  m["tokenAI"],.. 
-00008e40: 2020 2020 2020 2020 2020 2022 7569 6422             "uid"
-00008e50: 3a20 7374 7228 4d6f 7270 6869 6e67 5061  : str(MorphingPa
-00008e60: 7261 6d5b 2275 6964 225d 292c 0d0a 2020  ram["uid"]),..  
-00008e70: 2020 2020 2020 2020 2020 2273 7461 6765            "stage
-00008e80: 223a 2073 7472 2853 7461 6765 5061 7261  ": str(StagePara
-00008e90: 6d5b 2273 7461 6765 225d 292c 0d0a 2020  m["stage"]),..  
-00008ea0: 2020 2020 2020 2020 2020 2263 7963 6c65            "cycle
-00008eb0: 223a 2073 7472 284d 6f72 7068 696e 6750  ": str(MorphingP
-00008ec0: 6172 616d 5b22 6379 636c 6522 5d29 2c0d  aram["cycle"]),.
-00008ed0: 0a20 2020 2020 2020 2020 2020 2022 656e  .            "en
-00008ee0: 6769 6e65 223a 2043 7265 6450 6172 616d  gine": CredParam
-00008ef0: 5b22 656e 6769 6e65 225d 2c0d 0a20 2020  ["engine"],..   
-00008f00: 2020 2020 2020 2020 2022 7573 6572 6e61           "userna
-00008f10: 6d65 223a 2043 7265 6450 6172 616d 5b22  me": CredParam["
-00008f20: 7573 6572 6e61 6d65 225d 2c0d 0a20 2020  username"],..   
-00008f30: 2020 2020 2020 2020 2022 6465 7363 7222           "descr"
-00008f40: 3a20 5374 6167 6550 6172 616d 5b22 6465  : StageParam["de
-00008f50: 7363 7222 5d2c 0d0a 2020 2020 2020 2020  scr"],..        
-00008f60: 2020 2020 2266 696c 656e 616d 6522 3a20      "filename": 
-00008f70: 5f66 696c 656e 616d 650d 0a20 2020 2020  _filename..     
-00008f80: 2020 207d 0d0a 2020 2020 7d0d 0a0d 0a20     }..    }.... 
-00008f90: 2020 2069 6620 2263 6f73 7422 2069 6e20     if "cost" in 
-00008fa0: 5374 6167 6550 6172 616d 3a0d 0a20 2020  StageParam:..   
-00008fb0: 2020 2020 206f 626a 5061 7261 6d5b 2272       objParam["r
-00008fc0: 6573 706f 6e73 6522 5d5b 2263 6f73 7422  esponse"]["cost"
-00008fd0: 5d3d 2073 7472 2853 7461 6765 5061 7261  ]= str(StagePara
-00008fe0: 6d5b 2263 6f73 7422 5d29 0d0a 2020 2020  m["cost"])..    
-00008ff0: 0d0a 2020 2020 7265 7370 6f6e 7365 203d  ..    response =
-00009000: 2072 6571 7565 7374 732e 706f 7374 2861   requests.post(a
-00009010: 7069 5f75 726c 2c20 6865 6164 6572 733d  pi_url, headers=
-00009020: 6865 6164 6572 732c 2064 6174 613d 6a73  headers, data=js
-00009030: 6f6e 2e64 756d 7073 286f 626a 5061 7261  on.dumps(objPara
-00009040: 6d29 2029 0d0a 2020 2020 6f62 6a52 6573  m) )..    objRes
-00009050: 3d72 6573 706f 6e73 652e 6a73 6f6e 2829  =response.json()
-00009060: 0d0a 0d0a 2020 2020 6966 2053 7461 6765  ....    if Stage
-00009070: 5061 7261 6d5b 2273 7461 6765 225d 3d3d  Param["stage"]==
-00009080: 4149 5f50 524f 4752 4553 535f 444f 4e45  AI_PROGRESS_DONE
-00009090: 5f49 4d41 4745 3a0d 0a20 2020 2020 2020  _IMAGE:..       
-000090a0: 2069 6620 6749 7356 6972 7475 616c 4149   if gIsVirtualAI
-000090b0: 3d3d 5472 7565 3a0d 0a20 2020 2020 2020  ==True:..       
-000090c0: 2020 2020 205f 6469 723d 4d6f 7270 6869       _dir=Morphi
-000090d0: 6e67 5061 7261 6d5b 226f 6469 7222 5d0d  ngParam["odir"].
-000090e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000090f0: 5f64 6972 3d3d 4e6f 6e65 3a0d 0a20 2020  _dir==None:..   
-00009100: 2020 2020 2020 2020 2020 2020 205f 6469               _di
-00009110: 723d 674f 7574 7075 7444 6972 0d0a 2020  r=gOutputDir..  
-00009120: 2020 2020 2020 2020 2020 5f64 6972 496d            _dirIm
-00009130: 6167 653d 5f64 6972 2b5f 6669 6c65 6e61  age=_dir+_filena
-00009140: 6d65 0d0a 0d0a 2020 2020 2020 2020 2020  me....          
-00009150: 2020 7769 7468 206f 7065 6e28 5f64 6972    with open(_dir
-00009160: 496d 6167 652c 2022 7262 2229 2061 7320  Image, "rb") as 
-00009170: 696d 6167 655f 6669 6c65 3a0d 0a20 2020  image_file:..   
-00009180: 2020 2020 2020 2020 2020 2020 2069 6d61               ima
-00009190: 6765 5f64 6174 6120 3d20 696d 6167 655f  ge_data = image_
-000091a0: 6669 6c65 2e72 6561 6428 290d 0a0d 0a20  file.read().... 
-000091b0: 2020 2020 2020 2020 2020 2069 6d5f 6236             im_b6
-000091c0: 3420 3d20 6261 7365 3634 2e62 3634 656e  4 = base64.b64en
-000091d0: 636f 6465 2869 6d61 6765 5f64 6174 6129  code(image_data)
-000091e0: 2e64 6563 6f64 6528 2275 7466 3822 290d  .decode("utf8").
-000091f0: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
-00009200: 616d 3d7b 0d0a 2020 2020 2020 2020 2020  am={..          
-00009210: 2020 2020 2020 2269 6d61 6765 223a 2069        "image": i
-00009220: 6d5f 6236 342c 0d0a 2020 2020 2020 2020  m_b64,..        
-00009230: 2020 2020 2020 2020 2275 6964 223a 2073          "uid": s
-00009240: 7472 284d 6f72 7068 696e 6750 6172 616d  tr(MorphingParam
-00009250: 5b22 7569 6422 5d29 2c0d 0a20 2020 2020  ["uid"]),..     
-00009260: 2020 2020 2020 2020 2020 2022 6379 636c             "cycl
-00009270: 6522 3a20 7374 7228 4d6f 7270 6869 6e67  e": str(Morphing
-00009280: 5061 7261 6d5b 2263 7963 6c65 225d 292c  Param["cycle"]),
-00009290: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000092a0: 2020 2265 6e67 696e 6522 3a20 4372 6564    "engine": Cred
-000092b0: 5061 7261 6d5b 2265 6e67 696e 6522 5d2c  Param["engine"],
-000092c0: 0d0a 2020 2020 2020 2020 2020 2020 7d20  ..            } 
-000092d0: 2020 2020 2020 2020 2020 200d 0a20 2020             ..   
-000092e0: 2020 2020 2020 2020 205f 7570 6c6f 6164           _upload
-000092f0: 496d 6167 6554 6f4f 5341 4953 2870 6172  ImageToOSAIS(par
-00009300: 616d 2c20 4372 6564 5061 7261 6d5b 2269  am, CredParam["i
-00009310: 734c 6f63 616c 225d 290d 0a20 2020 2072  sLocal"])..    r
-00009320: 6574 7572 6e20 6f62 6a52 6573 0d0a 0d0a  eturn objRes....
-00009330: 2323 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ## -------------
-00009340: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009350: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009360: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009370: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a23 2020  -----------..#  
-00009380: 2020 2020 2049 6e69 7420 7072 6f63 6573       Init proces
-00009390: 7369 6e67 0d0a 2323 202d 2d2d 2d2d 2d2d  sing..## -------
-000093a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000093b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000093c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000093d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000093e0: 2d0d 0a0d 0a23 2320 5055 424c 4943 202d  -....## PUBLIC -
-000093f0: 2072 6573 6574 7469 6e67 2077 686f 2074   resetting who t
-00009400: 6869 7320 4149 2069 7320 7461 6c6b 696e  his AI is talkin
-00009410: 6720 746f 2028 4f53 4149 5320 7072 6f64  g to (OSAIS prod
-00009420: 2061 6e64 2064 6267 290d 0a64 6566 206f   and dbg)..def o
-00009430: 7361 6973 5f72 6573 6574 4f53 4149 5328  sais_resetOSAIS(
-00009440: 5f6c 6f63 6174 696f 6e50 726f 642c 205f  _locationProd, _
-00009450: 6c6f 6361 6c74 696f 6e44 6562 7567 293a  localtionDebug):
-00009460: 0d0a 2020 2020 676c 6f62 616c 2067 4f72  ..    global gOr
-00009470: 6967 696e 4f53 4149 530d 0a20 2020 2067  iginOSAIS..    g
-00009480: 6c6f 6261 6c20 674f 7269 6769 6e4c 6f63  lobal gOriginLoc
-00009490: 616c 4f53 4149 530d 0a20 2020 2067 4f72  alOSAIS..    gOr
-000094a0: 6967 696e 4f53 4149 533d 5f6c 6f63 6174  iginOSAIS=_locat
-000094b0: 696f 6e50 726f 640d 0a20 2020 2067 4f72  ionProd..    gOr
-000094c0: 6967 696e 4c6f 6361 6c4f 5341 4953 3d5f  iginLocalOSAIS=_
-000094d0: 6c6f 6361 6c74 696f 6e44 6562 7567 0d0a  localtionDebug..
-000094e0: 2020 2020 6966 205f 6c6f 6361 7469 6f6e      if _location
-000094f0: 5072 6f64 213d 4e6f 6e65 3a0d 0a20 2020  Prod!=None:..   
-00009500: 2020 2020 2070 7269 6e74 2822 3d3e 2054       print("=> T
-00009510: 6869 7320 4149 2069 7320 7265 7365 7420  his AI is reset 
-00009520: 746f 2074 616c 6b20 746f 2050 524f 4420  to talk to PROD 
-00009530: 222b 674f 7269 6769 6e4f 5341 4953 290d  "+gOriginOSAIS).
-00009540: 0a20 2020 2069 6620 5f6c 6f63 616c 7469  .    if _localti
-00009550: 6f6e 4465 6275 6721 3d4e 6f6e 653a 0d0a  onDebug!=None:..
-00009560: 2020 2020 2020 2020 7072 696e 7428 223d          print("=
-00009570: 3e20 5468 6973 2041 4920 6973 2072 6573  > This AI is res
-00009580: 6574 2074 6f20 7461 6c6b 2074 6f20 4445  et to talk to DE
-00009590: 4255 4720 222b 674f 7269 6769 6e4c 6f63  BUG "+gOriginLoc
-000095a0: 616c 4f53 4149 532b 225c 725c 6e22 290d  alOSAIS+"\r\n").
-000095b0: 0a20 2020 2072 6574 7572 6e20 5472 7565  .    return True
-000095c0: 0d0a 0d0a 2323 2050 5542 4c49 4320 2d20  ....## PUBLIC - 
-000095d0: 496e 6974 2074 6865 2056 6972 7475 616c  Init the Virtual
-000095e0: 2041 490d 0a64 6566 206f 7361 6973 5f69   AI..def osais_i
-000095f0: 6e69 7469 616c 697a 6541 4928 293a 0d0a  nitializeAI():..
-00009600: 2020 2020 676c 6f62 616c 2067 4973 446f      global gIsDo
-00009610: 636b 6572 0d0a 2020 2020 676c 6f62 616c  cker..    global
-00009620: 2067 4973 4c6f 6361 6c0d 0a20 2020 2067   gIsLocal..    g
-00009630: 6c6f 6261 6c20 6749 7356 6972 7475 616c  lobal gIsVirtual
-00009640: 4149 0d0a 2020 2020 676c 6f62 616c 2067  AI..    global g
-00009650: 5573 6572 6e61 6d65 0d0a 2020 2020 676c  Username..    gl
-00009660: 6f62 616c 2067 4e61 6d65 0d0a 2020 2020  obal gName..    
-00009670: 676c 6f62 616c 2067 506f 7274 4149 0d0a  global gPortAI..
-00009680: 2020 2020 676c 6f62 616c 2067 5665 7273      global gVers
-00009690: 696f 6e0d 0a20 2020 2067 6c6f 6261 6c20  ion..    global 
-000096a0: 6750 6f72 7447 6174 6577 6179 0d0a 2020  gPortGateway..  
-000096b0: 2020 676c 6f62 616c 2067 506f 7274 4c6f    global gPortLo
-000096c0: 6361 6c4f 5341 4953 0d0a 2020 2020 676c  calOSAIS..    gl
-000096d0: 6f62 616c 2067 4950 4c6f 6361 6c0d 0a20  obal gIPLocal.. 
-000096e0: 2020 2067 6c6f 6261 6c20 6745 7874 4950     global gExtIP
-000096f0: 0d0a 2020 2020 676c 6f62 616c 2067 4f72  ..    global gOr
-00009700: 6967 696e 4761 7465 7761 790d 0a20 2020  iginGateway..   
-00009710: 2067 6c6f 6261 6c20 6741 7574 6854 6f6b   global gAuthTok
-00009720: 656e 0d0a 2020 2020 676c 6f62 616c 2067  en..    global g
-00009730: 4175 7468 546f 6b65 6e4c 6f63 616c 0d0a  AuthTokenLocal..
-00009740: 2020 2020 676c 6f62 616c 2067 4f72 6967      global gOrig
-00009750: 696e 4f53 4149 530d 0a20 2020 2067 6c6f  inOSAIS..    glo
-00009760: 6261 6c20 674f 7269 6769 6e4c 6f63 616c  bal gOriginLocal
-00009770: 4f53 4149 530d 0a0d 0a20 2020 2023 2320  OSAIS....    ## 
-00009780: 6c6f 6164 2065 6e76 200d 0a20 2020 205f  load env ..    _
-00009790: 656e 7646 696c 653d 2265 6e76 5f6c 6f63  envFile="env_loc
-000097a0: 616c 220d 0a20 2020 2069 6620 6749 7344  al"..    if gIsD
-000097b0: 6f63 6b65 723a 0d0a 2020 2020 2020 2020  ocker:..        
-000097c0: 5f65 6e76 4669 6c65 3d22 656e 765f 646f  _envFile="env_do
-000097d0: 636b 6572 220d 0a20 2020 2020 2020 2070  cker"..        p
-000097e0: 7269 6e74 2822 5c72 5c6e 3d3e 2069 6e20  rint("\r\n=> in 
-000097f0: 446f 636b 6572 5c72 5c6e 2229 0d0a 2020  Docker\r\n")..  
-00009800: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00009810: 2070 7269 6e74 2822 5c72 5c6e 3d3e 204e   print("\r\n=> N
-00009820: 4f54 2069 6e20 446f 636b 6572 5c72 5c6e  OT in Docker\r\n
-00009830: 2229 2020 2020 2020 2020 0d0a 2020 2020  ")        ..    
-00009840: 6f62 6a3d 6f73 6169 735f 6765 7445 6e76  obj=osais_getEnv
-00009850: 285f 656e 7646 696c 6529 0d0a 2020 2020  (_envFile)..    
-00009860: 6749 734c 6f63 616c 3d6f 626a 5b22 6973  gIsLocal=obj["is
-00009870: 4c6f 6361 6c22 5d0d 0a20 2020 2067 4973  Local"]..    gIs
-00009880: 5669 7274 7561 6c41 493d 6f62 6a5b 2269  VirtualAI=obj["i
-00009890: 7356 6972 7475 616c 4149 225d 0d0a 2020  sVirtualAI"]..  
-000098a0: 2020 6755 7365 726e 616d 653d 6f62 6a5b    gUsername=obj[
-000098b0: 2275 7365 726e 616d 6522 5d0d 0a20 2020  "username"]..   
-000098c0: 2067 4e61 6d65 3d6f 626a 5b22 6e61 6d65   gName=obj["name
-000098d0: 225d 0d0a 0d0a 2020 2020 2323 2066 726f  "]....    ## fro
-000098e0: 6d20 656e 762c 206c 6f61 6420 4149 2063  m env, load AI c
-000098f0: 6f6e 6669 670d 0a20 2020 2067 436f 6e66  onfig..    gConf
-00009900: 6967 3d6f 7361 6973 5f6c 6f61 6443 6f6e  ig=osais_loadCon
-00009910: 6669 6728 674e 616d 6529 0d0a 2020 2020  fig(gName)..    
-00009920: 6750 6f72 7441 4920 3d20 6743 6f6e 6669  gPortAI = gConfi
-00009930: 675b 2270 6f72 7422 5d0d 0a20 2020 2067  g["port"]..    g
-00009940: 5665 7273 696f 6e20 3d20 6743 6f6e 6669  Version = gConfi
-00009950: 675b 2276 6572 7369 6f6e 225d 0d0a 0d0a  g["version"]....
-00009960: 2020 2020 7072 696e 7428 225c 725c 6e3d      print("\r\n=
-00009970: 3d3d 3d3d 2043 6f6e 6669 6720 3d3d 3d3d  ==== Config ====
-00009980: 3d22 290d 0a20 2020 2070 7269 6e74 2822  =")..    print("
-00009990: 6973 204c 6f63 616c 3a20 222b 7374 7228  is Local: "+str(
-000099a0: 6749 734c 6f63 616c 2929 0d0a 2020 2020  gIsLocal))..    
-000099b0: 7072 696e 7428 2269 7320 5669 7274 7561  print("is Virtua
-000099c0: 6c3a 2022 2b73 7472 2867 4973 5669 7274  l: "+str(gIsVirt
-000099d0: 7561 6c41 4929 290d 0a20 2020 2070 7269  ualAI))..    pri
-000099e0: 6e74 2822 6f77 6e65 6420 6279 2063 6c69  nt("owned by cli
-000099f0: 656e 743a 2022 2b73 7472 2867 5573 6572  ent: "+str(gUser
-00009a00: 6e61 6d65 2929 0d0a 2020 2020 7072 696e  name))..    prin
-00009a10: 7428 223d 3d3d 3d3d 202f 436f 6e66 6967  t("===== /Config
-00009a20: 203d 3d3d 3d3d 5c72 5c6e 2229 0d0a 0d0a   =====\r\n")....
-00009a30: 2020 2020 2323 206d 616b 6520 7375 7265      ## make sure
-00009a40: 2077 6520 6861 7665 2061 2063 6f6e 6669   we have a confi
-00009a50: 6720 6669 6c65 0d0a 2020 2020 5f6c 6f61  g file..    _loa
-00009a60: 6443 6f6e 6669 6728 674e 616d 6529 0d0a  dConfig(gName)..
-00009a70: 0d0a 2020 2020 2323 2077 6865 7265 2069  ..    ## where i
-00009a80: 7320 4f53 4149 5320 666f 7220 7573 2074  s OSAIS for us t
-00009a90: 6865 6e3f 0d0a 2020 2020 674f 7269 6769  hen?..    gOrigi
-00009aa0: 6e47 6174 6577 6179 3d66 2268 7474 703a  nGateway=f"http:
-00009ab0: 2f2f 7b67 4950 4c6f 6361 6c7d 3a7b 6750  //{gIPLocal}:{gP
-00009ac0: 6f72 7447 6174 6577 6179 7d2f 2220 2020  ortGateway}/"   
-00009ad0: 2020 2020 2020 2323 2063 6f6e 6669 6720        ## config 
-00009ae0: 666f 7220 6c6f 6361 6c20 6761 7465 7761  for local gatewa
-00009af0: 7920 286c 6f63 616c 2061 6e64 206e 6f74  y (local and not
-00009b00: 2076 6972 7475 616c 290d 0a20 2020 2069   virtual)..    i
-00009b10: 6620 6749 7356 6972 7475 616c 4149 3a0d  f gIsVirtualAI:.
-00009b20: 0a20 2020 2020 2020 2069 6620 6749 734c  .        if gIsL
-00009b30: 6f63 616c 3a0d 0a20 2020 2020 2020 2020  ocal:..         
-00009b40: 2020 206f 7361 6973 5f72 6573 6574 4f53     osais_resetOS
-00009b50: 4149 5328 4e6f 6e65 2c20 6622 6874 7470  AIS(None, f"http
-00009b60: 3a2f 2f7b 6749 504c 6f63 616c 7d3a 7b67  ://{gIPLocal}:{g
-00009b70: 506f 7274 4c6f 6361 6c4f 5341 4953 7d2f  PortLocalOSAIS}/
-00009b80: 2229 0d0a 2020 2020 2020 2020 656c 7365  ")..        else
-00009b90: 3a0d 0a20 2020 2020 2020 2020 2020 206f  :..            o
-00009ba0: 7361 6973 5f72 6573 6574 4f53 4149 5328  sais_resetOSAIS(
-00009bb0: 2268 7474 7073 3a2f 2f6f 7065 6e73 6f75  "https://opensou
-00009bc0: 7263 6561 6973 2e63 6f6d 2f22 2c20 4e6f  rceais.com/", No
-00009bd0: 6e65 290d 0a20 2020 2020 2020 2074 7279  ne)..        try
-00009be0: 3a0d 0a20 2020 2020 2020 2020 2020 206f  :..            o
-00009bf0: 7361 6973 5f61 7574 6865 6e74 6963 6174  sais_authenticat
-00009c00: 6541 4928 290d 0a20 2020 2020 2020 2065  eAI()..        e
-00009c10: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
-00009c20: 6173 2065 7272 3a0d 0a20 2020 2020 2020  as err:..       
-00009c30: 2020 2020 2070 7269 6e74 2822 3d3e 2043       print("=> C
-00009c40: 5249 5449 4341 4c3a 2043 6f75 6c64 206e  RITICAL: Could n
-00009c50: 6f74 2063 6f6e 6e65 6374 2076 6972 7475  ot connect virtu
-00009c60: 616c 2041 4920 222b 674e 616d 652b 2022  al AI "+gName+ "
-00009c70: 2074 6f20 4f53 4149 5322 290d 0a20 2020   to OSAIS")..   
-00009c80: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00009c90: 4e6f 6e65 0d0a 0d0a 2020 2020 2020 2020  None....        
-00009ca0: 6966 2067 4175 7468 546f 6b65 6e21 3d4e  if gAuthToken!=N
-00009cb0: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
-00009cc0: 2020 7072 696e 7428 223d 3e20 5275 6e6e    print("=> Runn
-00009cd0: 696e 6720 222b 674e 616d 652b 2220 4149  ing "+gName+" AI
-00009ce0: 2061 7320 6120 7669 7274 7561 6c20 4149   as a virtual AI
-00009cf0: 2063 6f6e 6e65 6374 6564 2074 6f3a 2022   connected to: "
-00009d00: 2b67 4f72 6967 696e 4f53 4149 5329 0d0a  +gOriginOSAIS)..
-00009d10: 2020 2020 2020 2020 6966 2067 4175 7468          if gAuth
-00009d20: 546f 6b65 6e4c 6f63 616c 213d 4e6f 6e65  TokenLocal!=None
-00009d30: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-00009d40: 7269 6e74 2822 3d3e 2052 756e 6e69 6e67  rint("=> Running
-00009d50: 2022 2b67 4e61 6d65 2b22 2041 4920 6173   "+gName+" AI as
-00009d60: 2061 2076 6972 7475 616c 2041 4920 636f   a virtual AI co
-00009d70: 6e6e 6563 7465 6420 746f 3a20 222b 674f  nnected to: "+gO
-00009d80: 7269 6769 6e4c 6f63 616c 4f53 4149 5329  riginLocalOSAIS)
-00009d90: 0d0a 2020 2020 656c 7365 3a0d 0a20 2020  ..    else:..   
-00009da0: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-00009db0: 2020 2020 2020 206f 7361 6973 5f72 6573         osais_res
-00009dc0: 6574 4761 7465 7761 7928 674f 7269 6769  etGateway(gOrigi
-00009dd0: 6e47 6174 6577 6179 290d 0a20 2020 2020  nGateway)..     
+00008420: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00008430: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00008440: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00008450: 2d0d 0a23 2020 2020 2020 204e 6f74 6966  -..#       Notif
+00008460: 6963 6174 696f 6e73 2074 6f20 4761 7465  ications to Gate
+00008470: 7761 7920 2f20 4f53 4149 530d 0a23 2320  way / OSAIS..## 
+00008480: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00008490: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000084a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000084b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000084c0: 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a 2320 5570  --------....# Up
+000084d0: 6c6f 6164 2069 6d61 6765 2074 6f20 4f53  load image to OS
+000084e0: 4149 5320 0d0a 6465 6620 5f75 706c 6f61  AIS ..def _uploa
+000084f0: 6449 6d61 6765 546f 4f53 4149 5328 6f62  dImageToOSAIS(ob
+00008500: 6a50 6172 616d 2c20 6973 4c6f 6361 6c29  jParam, isLocal)
+00008510: 3a0d 0a20 2020 2069 6620 6749 7356 6972  :..    if gIsVir
+00008520: 7475 616c 4149 3d3d 4661 6c73 653a 0d0a  tualAI==False:..
+00008530: 2020 2020 2020 2020 7265 7475 726e 204e          return N
+00008540: 6f6e 650d 0a20 2020 200d 0a20 2020 2067  one..    ..    g
+00008550: 6c6f 6261 6c20 6741 7574 6854 6f6b 656e  lobal gAuthToken
+00008560: 0d0a 2020 2020 676c 6f62 616c 2067 4f72  ..    global gOr
+00008570: 6967 696e 4f53 4149 530d 0a20 2020 2067  iginOSAIS..    g
+00008580: 6c6f 6261 6c20 6741 7574 6854 6f6b 656e  lobal gAuthToken
+00008590: 4c6f 6361 6c0d 0a20 2020 2067 6c6f 6261  Local..    globa
+000085a0: 6c20 674f 7269 6769 6e4c 6f63 616c 4f53  l gOriginLocalOS
+000085b0: 4149 530d 0a0d 0a20 2020 205f 6175 7468  AIS....    _auth
+000085c0: 3d67 4175 7468 546f 6b65 6e0d 0a20 2020  =gAuthToken..   
+000085d0: 2069 6620 6973 4c6f 6361 6c3a 0d0a 2020   if isLocal:..  
+000085e0: 2020 2020 2020 5f61 7574 683d 6741 7574        _auth=gAut
+000085f0: 6854 6f6b 656e 4c6f 6361 6c0d 0a20 2020  hTokenLocal..   
+00008600: 205f 6f73 6169 733d 674f 7269 6769 6e4f   _osais=gOriginO
+00008610: 5341 4953 0d0a 2020 2020 6966 2069 734c  SAIS..    if isL
+00008620: 6f63 616c 3a0d 0a20 2020 2020 2020 205f  ocal:..        _
+00008630: 6f73 6169 733d 674f 7269 6769 6e4c 6f63  osais=gOriginLoc
+00008640: 616c 4f53 4149 530d 0a0d 0a20 2020 2023  alOSAIS....    #
+00008650: 206c 6574 7320 676f 2063 616c 6c20 4f53   lets go call OS
+00008660: 4149 5320 4149 2047 6174 6577 6179 202f  AIS AI Gateway /
+00008670: 206f 7220 4f53 4149 5320 6974 7365 6c66   or OSAIS itself
+00008680: 0d0a 2020 2020 6865 6164 6572 7320 3d20  ..    headers = 
+00008690: 7b0d 0a20 2020 2020 2020 2022 436f 6e74  {..        "Cont
+000086a0: 656e 742d 5479 7065 223a 2027 6170 706c  ent-Type": 'appl
+000086b0: 6963 6174 696f 6e2f 6a73 6f6e 272c 200d  ication/json', .
+000086c0: 0a20 2020 2020 2020 2027 4163 6365 7074  .        'Accept
+000086d0: 273a 2027 7465 7874 2f70 6c61 696e 272c  ': 'text/plain',
+000086e0: 0d0a 2020 2020 2020 2020 2241 7574 686f  ..        "Autho
+000086f0: 7269 7a61 7469 6f6e 223a 2066 2242 6561  rization": f"Bea
+00008700: 7265 7220 7b5f 6175 7468 7d22 0d0a 2020  rer {_auth}"..  
+00008710: 2020 7d0d 0a0d 0a20 2020 2061 7069 5f75    }....    api_u
+00008720: 726c 3d66 227b 5f6f 7361 6973 7d61 7069  rl=f"{_osais}api
+00008730: 2f76 312f 7072 6976 6174 652f 7570 6c6f  /v1/private/uplo
+00008740: 6164 2220 2020 2020 2020 200d 0a20 2020  ad"        ..   
+00008750: 2070 6179 6c6f 6164 203d 206a 736f 6e2e   payload = json.
+00008760: 6475 6d70 7328 6f62 6a50 6172 616d 290d  dumps(objParam).
+00008770: 0a20 2020 2072 6573 706f 6e73 6520 3d20  .    response = 
+00008780: 7265 7175 6573 7473 2e70 6f73 7428 6170  requests.post(ap
+00008790: 695f 7572 6c2c 2068 6561 6465 7273 3d68  i_url, headers=h
+000087a0: 6561 6465 7273 2c20 6461 7461 3d70 6179  eaders, data=pay
+000087b0: 6c6f 6164 2029 0d0a 2020 2020 6f62 6a52  load )..    objR
+000087c0: 6573 3d72 6573 706f 6e73 652e 6a73 6f6e  es=response.json
+000087d0: 2829 0d0a 2020 2020 7265 7475 726e 206f  ()..    return o
+000087e0: 626a 5265 7320 2020 200d 0a0d 0a64 6566  bjRes    ....def
+000087f0: 206f 7361 6973 5f6f 6e4e 6f74 6966 7946   osais_onNotifyF
+00008800: 696c 6543 7265 6174 6564 285f 6469 722c  ileCreated(_dir,
+00008810: 205f 6669 6c65 6e61 6d65 2c20 5f61 7267   _filename, _arg
+00008820: 7329 3a0d 0a20 2020 2067 4172 6773 4f53  s):..    gArgsOS
+00008830: 4149 532e 6669 6c65 6e61 6d65 3d5f 6669  AIS.filename=_fi
+00008840: 6c65 6e61 6d65 0d0a 2020 2020 5f73 7461  lename..    _sta
+00008850: 6765 5061 7261 6d3d 6765 7453 7461 6765  geParam=getStage
+00008860: 5061 7261 6d73 2841 495f 5052 4f47 5245  Params(AI_PROGRE
+00008870: 5353 5f44 4f4e 455f 494d 4147 452c 2030  SS_DONE_IMAGE, 0
+00008880: 290d 0a20 2020 205f 6d6f 7270 6869 6e67  )..    _morphing
+00008890: 5061 7261 6d3d 6765 744d 6f72 7068 696e  Param=getMorphin
+000088a0: 6750 6172 616d 7328 290d 0a20 2020 205f  gParams()..    _
+000088b0: 6372 6564 7350 6172 616d 3d67 6574 4372  credsParam=getCr
+000088c0: 6564 7350 6172 616d 7328 290d 0a20 2020  edsParams()..   
+000088d0: 206f 7361 6973 5f6e 6f74 6966 7928 5f63   osais_notify(_c
+000088e0: 7265 6473 5061 7261 6d2c 205f 6d6f 7270  redsParam, _morp
+000088f0: 6869 6e67 5061 7261 6d2c 205f 7374 6167  hingParam, _stag
+00008900: 6550 6172 616d 2920 2020 2020 2020 2020  eParam)         
+00008910: 2020 2023 204f 5341 4953 204e 6f74 6966     # OSAIS Notif
+00008920: 6963 6174 696f 6e0d 0a20 2020 2072 6574  ication..    ret
+00008930: 7572 6e20 5472 7565 0d0a 0d0a 2320 4469  urn True....# Di
+00008940: 7265 6374 204e 6f74 6966 7920 4f53 4149  rect Notify OSAI
+00008950: 5320 0d0a 6465 6620 6f73 6169 735f 6e6f  S ..def osais_no
+00008960: 7469 6679 2843 7265 6450 6172 616d 2c20  tify(CredParam, 
+00008970: 4d6f 7270 6869 6e67 5061 7261 6d2c 2053  MorphingParam, S
+00008980: 7461 6765 5061 7261 6d29 3a0d 0a20 2020  tageParam):..   
+00008990: 2067 6c6f 6261 6c20 6749 504c 6f63 616c   global gIPLocal
+000089a0: 0d0a 2020 2020 676c 6f62 616c 2067 506f  ..    global gPo
+000089b0: 7274 4761 7465 7761 790d 0a20 2020 2067  rtGateway..    g
+000089c0: 6c6f 6261 6c20 674f 7269 6769 6e4f 5341  lobal gOriginOSA
+000089d0: 4953 0d0a 2020 2020 676c 6f62 616c 2067  IS..    global g
+000089e0: 4f72 6967 696e 4c6f 6361 6c4f 5341 4953  OriginLocalOSAIS
+000089f0: 0d0a 2020 2020 676c 6f62 616c 2067 4973  ..    global gIs
+00008a00: 5669 7274 7561 6c41 490d 0a20 2020 2067  VirtualAI..    g
+00008a10: 6c6f 6261 6c20 6741 7574 6854 6f6b 656e  lobal gAuthToken
+00008a20: 0d0a 2020 2020 676c 6f62 616c 2067 4175  ..    global gAu
+00008a30: 7468 546f 6b65 6e4c 6f63 616c 0d0a 2020  thTokenLocal..  
+00008a40: 2020 676c 6f62 616c 2067 4c61 7374 4368    global gLastCh
+00008a50: 6563 6b65 645f 6174 0d0a 2020 2020 676c  ecked_at..    gl
+00008a60: 6f62 616c 2067 4973 5761 726d 7570 0d0a  obal gIsWarmup..
+00008a70: 0d0a 2020 2020 2323 206e 6f20 6e6f 7469  ..    ## no noti
+00008a80: 6669 6361 7469 6f6e 206f 6620 7761 726d  fication of warm
+00008a90: 7570 0d0a 2020 2020 6966 2067 4973 5761  up..    if gIsWa
+00008aa0: 726d 7570 3a0d 0a20 2020 2020 2020 2072  rmup:..        r
+00008ab0: 6574 7572 6e20 4e6f 6e65 0d0a 2020 2020  eturn None..    
+00008ac0: 0d0a 2020 2020 674c 6173 7443 6865 636b  ..    gLastCheck
+00008ad0: 6564 5f61 7420 3d20 6461 7465 7469 6d65  ed_at = datetime
+00008ae0: 2e75 7463 6e6f 7728 290d 0a0d 0a20 2020  .utcnow()....   
+00008af0: 2023 206e 6f74 6966 6963 6174 696f 6e20   # notification 
+00008b00: 636f 6e73 6f6c 6520 6c6f 670d 0a20 2020  console log..   
+00008b10: 206d 6572 6765 6420 3d20 6469 6374 2829   merged = dict()
+00008b20: 0d0a 2020 2020 6d65 7267 6564 2e75 7064  ..    merged.upd
+00008b30: 6174 6528 4372 6564 5061 7261 6d29 0d0a  ate(CredParam)..
+00008b40: 2020 2020 6d65 7267 6564 2e75 7064 6174      merged.updat
+00008b50: 6528 4d6f 7270 6869 6e67 5061 7261 6d29  e(MorphingParam)
+00008b60: 0d0a 2020 2020 7072 696e 7428 224e 6f74  ..    print("Not
+00008b70: 6966 794f 5341 4953 2028 222b 7374 7228  ifyOSAIS ("+str(
+00008b80: 5374 6167 6550 6172 616d 5b22 7374 6167  StageParam["stag
+00008b90: 6522 5d29 2b22 2f20 222b 5374 6167 6550  e"])+"/ "+StageP
+00008ba0: 6172 616d 5b22 6465 7363 7222 5d2b 2229  aram["descr"]+")
+00008bb0: 3a20 222b 7374 7228 6d65 7267 6564 2929  : "+str(merged))
+00008bc0: 0d0a 2020 2020 7072 696e 7428 225c 725c  ..    print("\r\
+00008bd0: 6e22 290d 0a0d 0a20 2020 205f 6669 6c65  n")....    _file
+00008be0: 6e61 6d65 3d22 220d 0a20 2020 2069 6620  name=""..    if 
+00008bf0: 4d6f 7270 6869 6e67 5061 7261 6d5b 2266  MorphingParam["f
+00008c00: 696c 656e 616d 6522 5d21 3d22 223a 0d0a  ilename"]!="":..
+00008c10: 2020 2020 2020 2020 5f66 696c 656e 616d          _filenam
+00008c20: 653d 4d6f 7270 6869 6e67 5061 7261 6d5b  e=MorphingParam[
+00008c30: 2266 696c 656e 616d 6522 5d0d 0a0d 0a20  "filename"].... 
+00008c40: 2020 2023 206c 6574 7320 676f 2063 616c     # lets go cal
+00008c50: 6c20 4f53 4149 5320 4149 2047 6174 6577  l OSAIS AI Gatew
+00008c60: 6179 202f 206f 7220 4f53 4149 5320 6974  ay / or OSAIS it
+00008c70: 7365 6c66 0d0a 2020 2020 6865 6164 6572  self..    header
+00008c80: 7320 3d20 7b0d 0a20 2020 2020 2020 2022  s = {..        "
+00008c90: 436f 6e74 656e 742d 5479 7065 223a 2022  Content-Type": "
+00008ca0: 6170 706c 6963 6174 696f 6e2f 6a73 6f6e  application/json
+00008cb0: 220d 0a20 2020 207d 0d0a 0d0a 2020 2020  "..    }....    
+00008cc0: 2323 2063 6f6e 6669 6720 666f 7220 6361  ## config for ca
+00008cd0: 6c6c 696e 6720 6761 7465 7761 790d 0a20  lling gateway.. 
+00008ce0: 2020 2061 7069 5f75 726c 203d 2066 227b     api_url = f"{
+00008cf0: 674f 7269 6769 6e47 6174 6577 6179 7d61  gOriginGateway}a
+00008d00: 7069 2f76 312f 7075 626c 6963 2f6e 6f74  pi/v1/public/not
+00008d10: 6966 7922 0d0a 0d0a 2020 2020 2323 2063  ify"....    ## c
+00008d20: 6f6e 6669 6720 666f 7220 6361 6c6c 696e  onfig for callin
+00008d30: 6720 4f53 4149 5320 286e 6f20 6761 7465  g OSAIS (no gate
+00008d40: 7761 7929 0d0a 2020 2020 6966 2067 4973  way)..    if gIs
+00008d50: 5669 7274 7561 6c41 493a 0d0a 2020 2020  VirtualAI:..    
+00008d60: 2020 2020 5f6f 7361 6973 3d67 4f72 6967      _osais=gOrig
+00008d70: 696e 4f53 4149 530d 0a20 2020 2020 2020  inOSAIS..       
+00008d80: 205f 6175 7468 3d67 4175 7468 546f 6b65   _auth=gAuthToke
+00008d90: 6e0d 0a0d 0a20 2020 2020 2020 2069 6620  n....        if 
+00008da0: 4372 6564 5061 7261 6d5b 2269 734c 6f63  CredParam["isLoc
+00008db0: 616c 225d 3a0d 0a20 2020 2020 2020 2020  al"]:..         
+00008dc0: 2020 205f 6f73 6169 733d 674f 7269 6769     _osais=gOrigi
+00008dd0: 6e4c 6f63 616c 4f53 4149 530d 0a20 2020  nLocalOSAIS..   
+00008de0: 2020 2020 2020 2020 205f 6175 7468 3d67           _auth=g
+00008df0: 4175 7468 546f 6b65 6e4c 6f63 616c 0d0a  AuthTokenLocal..
+00008e00: 0d0a 2020 2020 2020 2020 6966 2067 4973  ..        if gIs
+00008e10: 5669 7274 7561 6c41 493d 3d54 7275 653a  VirtualAI==True:
+00008e20: 0d0a 2020 2020 2020 2020 2020 2020 6865  ..            he
+00008e30: 6164 6572 735b 2241 7574 686f 7269 7a61  aders["Authoriza
+00008e40: 7469 6f6e 225d 3d20 6622 4265 6172 6572  tion"]= f"Bearer
+00008e50: 207b 5f61 7574 687d 220d 0a20 2020 2020   {_auth}"..     
+00008e60: 2020 2020 2020 2061 7069 5f75 726c 3d66         api_url=f
+00008e70: 227b 5f6f 7361 6973 7d61 7069 2f76 312f  "{_osais}api/v1/
+00008e80: 7072 6976 6174 652f 6e6f 7469 6679 220d  private/notify".
+00008e90: 0a0d 0a20 2020 206f 626a 5061 7261 6d3d  ...    objParam=
+00008ea0: 7b0d 0a20 2020 2020 2020 2022 7265 7370  {..        "resp
+00008eb0: 6f6e 7365 223a 207b 0d0a 2020 2020 2020  onse": {..      
+00008ec0: 2020 2020 2020 2274 6f6b 656e 223a 2043        "token": C
+00008ed0: 7265 6450 6172 616d 5b22 746f 6b65 6e41  redParam["tokenA
+00008ee0: 4922 5d2c 0d0a 2020 2020 2020 2020 2020  I"],..          
+00008ef0: 2020 2275 6964 223a 2073 7472 284d 6f72    "uid": str(Mor
+00008f00: 7068 696e 6750 6172 616d 5b22 7569 6422  phingParam["uid"
+00008f10: 5d29 2c0d 0a20 2020 2020 2020 2020 2020  ]),..           
+00008f20: 2022 7374 6167 6522 3a20 7374 7228 5374   "stage": str(St
+00008f30: 6167 6550 6172 616d 5b22 7374 6167 6522  ageParam["stage"
+00008f40: 5d29 2c0d 0a20 2020 2020 2020 2020 2020  ]),..           
+00008f50: 2022 6379 636c 6522 3a20 7374 7228 4d6f   "cycle": str(Mo
+00008f60: 7270 6869 6e67 5061 7261 6d5b 2263 7963  rphingParam["cyc
+00008f70: 6c65 225d 292c 0d0a 2020 2020 2020 2020  le"]),..        
+00008f80: 2020 2020 2265 6e67 696e 6522 3a20 4372      "engine": Cr
+00008f90: 6564 5061 7261 6d5b 2265 6e67 696e 6522  edParam["engine"
+00008fa0: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+00008fb0: 2275 7365 726e 616d 6522 3a20 4372 6564  "username": Cred
+00008fc0: 5061 7261 6d5b 2275 7365 726e 616d 6522  Param["username"
+00008fd0: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+00008fe0: 2264 6573 6372 223a 2053 7461 6765 5061  "descr": StagePa
+00008ff0: 7261 6d5b 2264 6573 6372 225d 2c0d 0a20  ram["descr"],.. 
+00009000: 2020 2020 2020 2020 2020 2022 6669 6c65             "file
+00009010: 6e61 6d65 223a 205f 6669 6c65 6e61 6d65  name": _filename
+00009020: 2c0d 0a20 2020 2020 2020 207d 0d0a 2020  ,..        }..  
+00009030: 2020 7d0d 0a0d 0a20 2020 2069 6620 2263    }....    if "c
+00009040: 6f73 7422 2069 6e20 5374 6167 6550 6172  ost" in StagePar
+00009050: 616d 3a0d 0a20 2020 2020 2020 206f 626a  am:..        obj
+00009060: 5061 7261 6d5b 2272 6573 706f 6e73 6522  Param["response"
+00009070: 5d5b 2263 6f73 7422 5d3d 2073 7472 2853  ]["cost"]= str(S
+00009080: 7461 6765 5061 7261 6d5b 2263 6f73 7422  tageParam["cost"
+00009090: 5d29 0d0a 2020 2020 0d0a 2020 2020 7265  ])..    ..    re
+000090a0: 7370 6f6e 7365 203d 2072 6571 7565 7374  sponse = request
+000090b0: 732e 706f 7374 2861 7069 5f75 726c 2c20  s.post(api_url, 
+000090c0: 6865 6164 6572 733d 6865 6164 6572 732c  headers=headers,
+000090d0: 2064 6174 613d 6a73 6f6e 2e64 756d 7073   data=json.dumps
+000090e0: 286f 626a 5061 7261 6d29 2029 0d0a 2020  (objParam) )..  
+000090f0: 2020 6f62 6a52 6573 3d72 6573 706f 6e73    objRes=respons
+00009100: 652e 6a73 6f6e 2829 0d0a 0d0a 2020 2020  e.json()....    
+00009110: 6966 2053 7461 6765 5061 7261 6d5b 2273  if StageParam["s
+00009120: 7461 6765 225d 3d3d 4149 5f50 524f 4752  tage"]==AI_PROGR
+00009130: 4553 535f 444f 4e45 5f49 4d41 4745 3a0d  ESS_DONE_IMAGE:.
+00009140: 0a20 2020 2020 2020 2069 6620 6749 7356  .        if gIsV
+00009150: 6972 7475 616c 4149 3d3d 5472 7565 3a0d  irtualAI==True:.
+00009160: 0a20 2020 2020 2020 2020 2020 205f 6469  .            _di
+00009170: 723d 4d6f 7270 6869 6e67 5061 7261 6d5b  r=MorphingParam[
+00009180: 226f 6469 7222 5d0d 0a20 2020 2020 2020  "odir"]..       
+00009190: 2020 2020 2069 6620 5f64 6972 3d3d 4e6f       if _dir==No
+000091a0: 6e65 3a0d 0a20 2020 2020 2020 2020 2020  ne:..           
+000091b0: 2020 2020 205f 6469 723d 674f 7574 7075       _dir=gOutpu
+000091c0: 7444 6972 0d0a 2020 2020 2020 2020 2020  tDir..          
+000091d0: 2020 5f64 6972 496d 6167 653d 5f64 6972    _dirImage=_dir
+000091e0: 2b5f 6669 6c65 6e61 6d65 0d0a 0d0a 2020  +_filename....  
+000091f0: 2020 2020 2020 2020 2020 7769 7468 206f            with o
+00009200: 7065 6e28 5f64 6972 496d 6167 652c 2022  pen(_dirImage, "
+00009210: 7262 2229 2061 7320 696d 6167 655f 6669  rb") as image_fi
+00009220: 6c65 3a0d 0a20 2020 2020 2020 2020 2020  le:..           
+00009230: 2020 2020 2069 6d61 6765 5f64 6174 6120       image_data 
+00009240: 3d20 696d 6167 655f 6669 6c65 2e72 6561  = image_file.rea
+00009250: 6428 290d 0a0d 0a20 2020 2020 2020 2020  d()....         
+00009260: 2020 2069 6d5f 6236 3420 3d20 6261 7365     im_b64 = base
+00009270: 3634 2e62 3634 656e 636f 6465 2869 6d61  64.b64encode(ima
+00009280: 6765 5f64 6174 6129 2e64 6563 6f64 6528  ge_data).decode(
+00009290: 2275 7466 3822 290d 0a20 2020 2020 2020  "utf8")..       
+000092a0: 2020 2020 2070 6172 616d 3d7b 0d0a 2020       param={..  
+000092b0: 2020 2020 2020 2020 2020 2020 2020 2269                "i
+000092c0: 6d61 6765 223a 2069 6d5f 6236 342c 0d0a  mage": im_b64,..
+000092d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000092e0: 2275 6964 223a 2073 7472 284d 6f72 7068  "uid": str(Morph
+000092f0: 696e 6750 6172 616d 5b22 7569 6422 5d29  ingParam["uid"])
+00009300: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00009310: 2020 2022 6379 636c 6522 3a20 7374 7228     "cycle": str(
+00009320: 4d6f 7270 6869 6e67 5061 7261 6d5b 2263  MorphingParam["c
+00009330: 7963 6c65 225d 292c 0d0a 2020 2020 2020  ycle"]),..      
+00009340: 2020 2020 2020 2020 2020 2265 6e67 696e            "engin
+00009350: 6522 3a20 4372 6564 5061 7261 6d5b 2265  e": CredParam["e
+00009360: 6e67 696e 6522 5d2c 0d0a 2020 2020 2020  ngine"],..      
+00009370: 2020 2020 2020 7d20 2020 2020 2020 2020        }         
+00009380: 2020 200d 0a20 2020 2020 2020 2020 2020     ..           
+00009390: 205f 7570 6c6f 6164 496d 6167 6554 6f4f   _uploadImageToO
+000093a0: 5341 4953 2870 6172 616d 2c20 4372 6564  SAIS(param, Cred
+000093b0: 5061 7261 6d5b 2269 734c 6f63 616c 225d  Param["isLocal"]
+000093c0: 290d 0a20 2020 2072 6574 7572 6e20 6f62  )..    return ob
+000093d0: 6a52 6573 0d0a 0d0a 2323 202d 2d2d 2d2d  jRes....## -----
+000093e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000093f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009400: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009410: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009420: 2d2d 2d0d 0a23 2020 2020 2020 2049 6e69  ---..#       Ini
+00009430: 7420 7072 6f63 6573 7369 6e67 0d0a 2323  t processing..##
+00009440: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
+00009450: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009460: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009470: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009480: 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d 0a23 2320  ---------....## 
+00009490: 5055 424c 4943 202d 2072 6573 6574 7469  PUBLIC - resetti
+000094a0: 6e67 2077 686f 2074 6869 7320 4149 2069  ng who this AI i
+000094b0: 7320 7461 6c6b 696e 6720 746f 2028 4f53  s talking to (OS
+000094c0: 4149 5320 7072 6f64 2061 6e64 2064 6267  AIS prod and dbg
+000094d0: 290d 0a64 6566 206f 7361 6973 5f72 6573  )..def osais_res
+000094e0: 6574 4f53 4149 5328 5f6c 6f63 6174 696f  etOSAIS(_locatio
+000094f0: 6e50 726f 642c 205f 6c6f 6361 6c74 696f  nProd, _localtio
+00009500: 6e44 6562 7567 293a 0d0a 2020 2020 676c  nDebug):..    gl
+00009510: 6f62 616c 2067 4f72 6967 696e 4f53 4149  obal gOriginOSAI
+00009520: 530d 0a20 2020 2067 6c6f 6261 6c20 674f  S..    global gO
+00009530: 7269 6769 6e4c 6f63 616c 4f53 4149 530d  riginLocalOSAIS.
+00009540: 0a20 2020 2067 4f72 6967 696e 4f53 4149  .    gOriginOSAI
+00009550: 533d 5f6c 6f63 6174 696f 6e50 726f 640d  S=_locationProd.
+00009560: 0a20 2020 2067 4f72 6967 696e 4c6f 6361  .    gOriginLoca
+00009570: 6c4f 5341 4953 3d5f 6c6f 6361 6c74 696f  lOSAIS=_localtio
+00009580: 6e44 6562 7567 0d0a 2020 2020 6966 205f  nDebug..    if _
+00009590: 6c6f 6361 7469 6f6e 5072 6f64 213d 4e6f  locationProd!=No
+000095a0: 6e65 3a0d 0a20 2020 2020 2020 2070 7269  ne:..        pri
+000095b0: 6e74 2822 3d3e 2054 6869 7320 4149 2069  nt("=> This AI i
+000095c0: 7320 7265 7365 7420 746f 2074 616c 6b20  s reset to talk 
+000095d0: 746f 2050 524f 4420 222b 674f 7269 6769  to PROD "+gOrigi
+000095e0: 6e4f 5341 4953 290d 0a20 2020 2069 6620  nOSAIS)..    if 
+000095f0: 5f6c 6f63 616c 7469 6f6e 4465 6275 6721  _localtionDebug!
+00009600: 3d4e 6f6e 653a 0d0a 2020 2020 2020 2020  =None:..        
+00009610: 7072 696e 7428 223d 3e20 5468 6973 2041  print("=> This A
+00009620: 4920 6973 2072 6573 6574 2074 6f20 7461  I is reset to ta
+00009630: 6c6b 2074 6f20 4445 4255 4720 222b 674f  lk to DEBUG "+gO
+00009640: 7269 6769 6e4c 6f63 616c 4f53 4149 532b  riginLocalOSAIS+
+00009650: 225c 725c 6e22 290d 0a20 2020 2072 6574  "\r\n")..    ret
+00009660: 7572 6e20 5472 7565 0d0a 0d0a 2323 2050  urn True....## P
+00009670: 5542 4c49 4320 2d20 496e 6974 2074 6865  UBLIC - Init the
+00009680: 2056 6972 7475 616c 2041 490d 0a64 6566   Virtual AI..def
+00009690: 206f 7361 6973 5f69 6e69 7469 616c 697a   osais_initializ
+000096a0: 6541 4928 293a 0d0a 2020 2020 676c 6f62  eAI():..    glob
+000096b0: 616c 2067 4973 446f 636b 6572 0d0a 2020  al gIsDocker..  
+000096c0: 2020 676c 6f62 616c 2067 4973 4c6f 6361    global gIsLoca
+000096d0: 6c0d 0a20 2020 2067 6c6f 6261 6c20 6749  l..    global gI
+000096e0: 7356 6972 7475 616c 4149 0d0a 2020 2020  sVirtualAI..    
+000096f0: 676c 6f62 616c 2067 5573 6572 6e61 6d65  global gUsername
+00009700: 0d0a 2020 2020 676c 6f62 616c 2067 4e61  ..    global gNa
+00009710: 6d65 0d0a 2020 2020 676c 6f62 616c 2067  me..    global g
+00009720: 506f 7274 4149 0d0a 2020 2020 676c 6f62  PortAI..    glob
+00009730: 616c 2067 5665 7273 696f 6e0d 0a20 2020  al gVersion..   
+00009740: 2067 6c6f 6261 6c20 6750 6f72 7447 6174   global gPortGat
+00009750: 6577 6179 0d0a 2020 2020 676c 6f62 616c  eway..    global
+00009760: 2067 506f 7274 4c6f 6361 6c4f 5341 4953   gPortLocalOSAIS
+00009770: 0d0a 2020 2020 676c 6f62 616c 2067 4950  ..    global gIP
+00009780: 4c6f 6361 6c0d 0a20 2020 2067 6c6f 6261  Local..    globa
+00009790: 6c20 6745 7874 4950 0d0a 2020 2020 676c  l gExtIP..    gl
+000097a0: 6f62 616c 2067 4f72 6967 696e 4761 7465  obal gOriginGate
+000097b0: 7761 790d 0a20 2020 2067 6c6f 6261 6c20  way..    global 
+000097c0: 6741 7574 6854 6f6b 656e 0d0a 2020 2020  gAuthToken..    
+000097d0: 676c 6f62 616c 2067 4175 7468 546f 6b65  global gAuthToke
+000097e0: 6e4c 6f63 616c 0d0a 2020 2020 676c 6f62  nLocal..    glob
+000097f0: 616c 2067 4f72 6967 696e 4f53 4149 530d  al gOriginOSAIS.
+00009800: 0a20 2020 2067 6c6f 6261 6c20 674f 7269  .    global gOri
+00009810: 6769 6e4c 6f63 616c 4f53 4149 530d 0a0d  ginLocalOSAIS...
+00009820: 0a20 2020 2023 2320 6c6f 6164 2065 6e76  .    ## load env
+00009830: 200d 0a20 2020 205f 656e 7646 696c 653d   ..    _envFile=
+00009840: 2265 6e76 5f6c 6f63 616c 220d 0a20 2020  "env_local"..   
+00009850: 2069 6620 6749 7344 6f63 6b65 723a 0d0a   if gIsDocker:..
+00009860: 2020 2020 2020 2020 5f65 6e76 4669 6c65          _envFile
+00009870: 3d22 656e 765f 646f 636b 6572 220d 0a20  ="env_docker".. 
+00009880: 2020 2020 2020 2070 7269 6e74 2822 5c72         print("\r
+00009890: 5c6e 3d3e 2069 6e20 446f 636b 6572 5c72  \n=> in Docker\r
+000098a0: 5c6e 2229 0d0a 2020 2020 656c 7365 3a0d  \n")..    else:.
+000098b0: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
+000098c0: 5c72 5c6e 3d3e 204e 4f54 2069 6e20 446f  \r\n=> NOT in Do
+000098d0: 636b 6572 5c72 5c6e 2229 2020 2020 2020  cker\r\n")      
+000098e0: 2020 0d0a 2020 2020 6f62 6a3d 6f73 6169    ..    obj=osai
+000098f0: 735f 6765 7445 6e76 285f 656e 7646 696c  s_getEnv(_envFil
+00009900: 6529 0d0a 2020 2020 6749 734c 6f63 616c  e)..    gIsLocal
+00009910: 3d6f 626a 5b22 6973 4c6f 6361 6c22 5d0d  =obj["isLocal"].
+00009920: 0a20 2020 2067 4973 5669 7274 7561 6c41  .    gIsVirtualA
+00009930: 493d 6f62 6a5b 2269 7356 6972 7475 616c  I=obj["isVirtual
+00009940: 4149 225d 0d0a 2020 2020 6755 7365 726e  AI"]..    gUsern
+00009950: 616d 653d 6f62 6a5b 2275 7365 726e 616d  ame=obj["usernam
+00009960: 6522 5d0d 0a20 2020 2067 4e61 6d65 3d6f  e"]..    gName=o
+00009970: 626a 5b22 6e61 6d65 225d 0d0a 0d0a 2020  bj["name"]....  
+00009980: 2020 2323 2066 726f 6d20 656e 762c 206c    ## from env, l
+00009990: 6f61 6420 4149 2063 6f6e 6669 670d 0a20  oad AI config.. 
+000099a0: 2020 2067 436f 6e66 6967 3d6f 7361 6973     gConfig=osais
+000099b0: 5f6c 6f61 6443 6f6e 6669 6728 674e 616d  _loadConfig(gNam
+000099c0: 6529 0d0a 2020 2020 6750 6f72 7441 4920  e)..    gPortAI 
+000099d0: 3d20 6743 6f6e 6669 675b 2270 6f72 7422  = gConfig["port"
+000099e0: 5d0d 0a20 2020 2067 5665 7273 696f 6e20  ]..    gVersion 
+000099f0: 3d20 6743 6f6e 6669 675b 2276 6572 7369  = gConfig["versi
+00009a00: 6f6e 225d 0d0a 0d0a 2020 2020 7072 696e  on"]....    prin
+00009a10: 7428 225c 725c 6e3d 3d3d 3d3d 2043 6f6e  t("\r\n===== Con
+00009a20: 6669 6720 3d3d 3d3d 3d22 290d 0a20 2020  fig =====")..   
+00009a30: 2070 7269 6e74 2822 6973 204c 6f63 616c   print("is Local
+00009a40: 3a20 222b 7374 7228 6749 734c 6f63 616c  : "+str(gIsLocal
+00009a50: 2929 0d0a 2020 2020 7072 696e 7428 2269  ))..    print("i
+00009a60: 7320 5669 7274 7561 6c3a 2022 2b73 7472  s Virtual: "+str
+00009a70: 2867 4973 5669 7274 7561 6c41 4929 290d  (gIsVirtualAI)).
+00009a80: 0a20 2020 2070 7269 6e74 2822 6f77 6e65  .    print("owne
+00009a90: 6420 6279 2063 6c69 656e 743a 2022 2b73  d by client: "+s
+00009aa0: 7472 2867 5573 6572 6e61 6d65 2929 0d0a  tr(gUsername))..
+00009ab0: 2020 2020 7072 696e 7428 223d 3d3d 3d3d      print("=====
+00009ac0: 202f 436f 6e66 6967 203d 3d3d 3d3d 5c72   /Config =====\r
+00009ad0: 5c6e 2229 0d0a 0d0a 2020 2020 2323 206d  \n")....    ## m
+00009ae0: 616b 6520 7375 7265 2077 6520 6861 7665  ake sure we have
+00009af0: 2061 2063 6f6e 6669 6720 6669 6c65 0d0a   a config file..
+00009b00: 2020 2020 5f6c 6f61 6443 6f6e 6669 6728      _loadConfig(
+00009b10: 674e 616d 6529 0d0a 0d0a 2020 2020 2323  gName)....    ##
+00009b20: 2077 6865 7265 2069 7320 4f53 4149 5320   where is OSAIS 
+00009b30: 666f 7220 7573 2074 6865 6e3f 0d0a 2020  for us then?..  
+00009b40: 2020 674f 7269 6769 6e47 6174 6577 6179    gOriginGateway
+00009b50: 3d66 2268 7474 703a 2f2f 7b67 4950 4c6f  =f"http://{gIPLo
+00009b60: 6361 6c7d 3a7b 6750 6f72 7447 6174 6577  cal}:{gPortGatew
+00009b70: 6179 7d2f 2220 2020 2020 2020 2020 2323  ay}/"         ##
+00009b80: 2063 6f6e 6669 6720 666f 7220 6c6f 6361   config for loca
+00009b90: 6c20 6761 7465 7761 7920 286c 6f63 616c  l gateway (local
+00009ba0: 2061 6e64 206e 6f74 2076 6972 7475 616c   and not virtual
+00009bb0: 290d 0a20 2020 2069 6620 6749 7356 6972  )..    if gIsVir
+00009bc0: 7475 616c 4149 3a0d 0a20 2020 2020 2020  tualAI:..       
+00009bd0: 2069 6620 6749 734c 6f63 616c 3a0d 0a20   if gIsLocal:.. 
+00009be0: 2020 2020 2020 2020 2020 206f 7361 6973             osais
+00009bf0: 5f72 6573 6574 4f53 4149 5328 4e6f 6e65  _resetOSAIS(None
+00009c00: 2c20 6622 6874 7470 3a2f 2f7b 6749 504c  , f"http://{gIPL
+00009c10: 6f63 616c 7d3a 7b67 506f 7274 4c6f 6361  ocal}:{gPortLoca
+00009c20: 6c4f 5341 4953 7d2f 2229 0d0a 2020 2020  lOSAIS}/")..    
+00009c30: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00009c40: 2020 2020 2020 206f 7361 6973 5f72 6573         osais_res
+00009c50: 6574 4f53 4149 5328 2268 7474 7073 3a2f  etOSAIS("https:/
+00009c60: 2f6f 7065 6e73 6f75 7263 6561 6973 2e63  /opensourceais.c
+00009c70: 6f6d 2f22 2c20 4e6f 6e65 290d 0a20 2020  om/", None)..   
+00009c80: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+00009c90: 2020 2020 2020 206f 7361 6973 5f61 7574         osais_aut
+00009ca0: 6865 6e74 6963 6174 6541 4928 290d 0a20  henticateAI().. 
+00009cb0: 2020 2020 2020 2065 7863 6570 7420 4578         except Ex
+00009cc0: 6365 7074 696f 6e20 6173 2065 7272 3a0d  ception as err:.
+00009cd0: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
+00009ce0: 6e74 2822 3d3e 2043 5249 5449 4341 4c3a  nt("=> CRITICAL:
+00009cf0: 2043 6f75 6c64 206e 6f74 2063 6f6e 6e65   Could not conne
+00009d00: 6374 2076 6972 7475 616c 2041 4920 222b  ct virtual AI "+
+00009d10: 674e 616d 652b 2022 2074 6f20 4f53 4149  gName+ " to OSAI
+00009d20: 5322 290d 0a20 2020 2020 2020 2020 2020  S")..           
+00009d30: 2072 6574 7572 6e20 4e6f 6e65 0d0a 0d0a   return None....
+00009d40: 2020 2020 2020 2020 6966 2067 4175 7468          if gAuth
+00009d50: 546f 6b65 6e21 3d4e 6f6e 653a 0d0a 2020  Token!=None:..  
+00009d60: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00009d70: 223d 3e20 5275 6e6e 696e 6720 222b 674e  "=> Running "+gN
+00009d80: 616d 652b 2220 4149 2061 7320 6120 7669  ame+" AI as a vi
+00009d90: 7274 7561 6c20 4149 2063 6f6e 6e65 6374  rtual AI connect
+00009da0: 6564 2074 6f3a 2022 2b67 4f72 6967 696e  ed to: "+gOrigin
+00009db0: 4f53 4149 5329 0d0a 2020 2020 2020 2020  OSAIS)..        
+00009dc0: 6966 2067 4175 7468 546f 6b65 6e4c 6f63  if gAuthTokenLoc
+00009dd0: 616c 213d 4e6f 6e65 3a0d 0a20 2020 2020  al!=None:..     
 00009de0: 2020 2020 2020 2070 7269 6e74 2822 3d3e         print("=>
 00009df0: 2052 756e 6e69 6e67 2022 2b67 4e61 6d65   Running "+gName
-00009e00: 2b22 2041 4920 6173 2061 2073 6572 7665  +" AI as a serve
-00009e10: 7220 636f 6e6e 6563 7465 6420 746f 206c  r connected to l
-00009e20: 6f63 616c 2047 6174 6577 6179 2022 2b67  ocal Gateway "+g
-00009e30: 4f72 6967 696e 4761 7465 7761 7929 0d0a  OriginGateway)..
-00009e40: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00009e50: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
-00009e60: 6f6e 2061 7320 6572 723a 0d0a 2020 2020  on as err:..    
-00009e70: 2020 2020 2020 2020 7072 696e 7428 2243          print("C
-00009e80: 5249 5449 4341 4c3a 2063 6f75 6c64 206e  RITICAL: could n
-00009e90: 6f74 206e 6f74 6966 7920 4761 7465 7761  ot notify Gatewa
-00009ea0: 7920 6174 2022 2b67 4f72 6967 696e 4761  y at "+gOriginGa
-00009eb0: 7465 7761 7929 0d0a 2020 2020 2020 2020  teway)..        
-00009ec0: 2020 2020 7265 7475 726e 204e 6f6e 650d      return None.
-00009ed0: 0a0d 0a20 2020 2023 2320 696e 6974 2064  ...    ## init d
-00009ee0: 6566 6175 6c74 2063 6f73 740d 0a20 2020  efault cost..   
-00009ef0: 205f 696e 6974 6961 6c69 7a65 436f 7374   _initializeCost
-00009f00: 2829 0d0a 0d0a 2020 2020 7072 696e 7428  ()....    print(
-00009f10: 225c 725c 6e22 290d 0a20 2020 2072 6574  "\r\n")..    ret
-00009f20: 7572 6e20 674e 616d 650d 0a0d 0a23 2320  urn gName....## 
-00009f30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009f40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009f50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009f60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009f70: 2d2d 2d2d 2d2d 2d2d 0d0a 2320 2020 2020  --------..#     
-00009f80: 2020 5374 6172 7469 6e67 2070 6f69 6e74    Starting point
-00009f90: 206f 6620 4c69 620d 0a23 2320 2d2d 2d2d   of Lib..## ----
-00009fa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009fb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009fc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009fd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009fe0: 2d2d 2d2d 0d0a 0d0a 2320 4d75 6c74 6974  ----....# Multit
-00009ff0: 6872 6561 6469 6e67 2066 6f72 206f 6273  hreading for obs
-0000a000: 6572 7665 7273 0d0a 7761 7463 685f 6469  ervers..watch_di
-0000a010: 7265 6374 6f72 793d 7374 6172 745f 6f62  rectory=start_ob
-0000a020: 7365 7276 6572 5f74 6872 6561 6428 5f67  server_thread(_g
-0000a030: 6574 4f75 7470 7574 4469 7228 292c 206f  etOutputDir(), o
-0000a040: 7361 6973 5f6f 6e4e 6f74 6966 7946 696c  sais_onNotifyFil
-0000a050: 6543 7265 6174 6564 2c20 4e6f 6e65 2920  eCreated, None) 
-0000a060: 2020 2020 0d0a 0d0a 2363 6c65 616e 696e      ....#cleanin
-0000a070: 6720 6469 7220 6576 6572 7920 3130 6d69  g dir every 10mi
-0000a080: 6e0d 0a73 6368 6564 756c 652e 6576 6572  n..schedule.ever
-0000a090: 7928 3130 292e 6d69 6e75 7465 732e 646f  y(10).minutes.do
-0000a0a0: 285f 636c 6561 7244 6972 290d 0a0d 0a70  (_clearDir)....p
-0000a0b0: 7269 6e74 2822 5c72 5c6e 5079 7468 6f6e  rint("\r\nPython
-0000a0c0: 204f 5341 4953 204c 6962 2069 7320 6c6f   OSAIS Lib is lo
-0000a0d0: 6164 6564 2e2e 2e22 290d 0a0d 0a0d 0a    aded...")......
+00009e00: 2b22 2041 4920 6173 2061 2076 6972 7475  +" AI as a virtu
+00009e10: 616c 2041 4920 636f 6e6e 6563 7465 6420  al AI connected 
+00009e20: 746f 3a20 222b 674f 7269 6769 6e4c 6f63  to: "+gOriginLoc
+00009e30: 616c 4f53 4149 5329 0d0a 2020 2020 656c  alOSAIS)..    el
+00009e40: 7365 3a0d 0a20 2020 2020 2020 2074 7279  se:..        try
+00009e50: 3a0d 0a20 2020 2020 2020 2020 2020 206f  :..            o
+00009e60: 7361 6973 5f72 6573 6574 4761 7465 7761  sais_resetGatewa
+00009e70: 7928 674f 7269 6769 6e47 6174 6577 6179  y(gOriginGateway
+00009e80: 290d 0a20 2020 2020 2020 2020 2020 2070  )..            p
+00009e90: 7269 6e74 2822 3d3e 2052 756e 6e69 6e67  rint("=> Running
+00009ea0: 2022 2b67 4e61 6d65 2b22 2041 4920 6173   "+gName+" AI as
+00009eb0: 2061 2073 6572 7665 7220 636f 6e6e 6563   a server connec
+00009ec0: 7465 6420 746f 206c 6f63 616c 2047 6174  ted to local Gat
+00009ed0: 6577 6179 2022 2b67 4f72 6967 696e 4761  eway "+gOriginGa
+00009ee0: 7465 7761 7929 0d0a 2020 2020 2020 2020  teway)..        
+00009ef0: 0d0a 2020 2020 2020 2020 6578 6365 7074  ..        except
+00009f00: 2045 7863 6570 7469 6f6e 2061 7320 6572   Exception as er
+00009f10: 723a 0d0a 2020 2020 2020 2020 2020 2020  r:..            
+00009f20: 7072 696e 7428 2243 5249 5449 4341 4c3a  print("CRITICAL:
+00009f30: 2063 6f75 6c64 206e 6f74 206e 6f74 6966   could not notif
+00009f40: 7920 4761 7465 7761 7920 6174 2022 2b67  y Gateway at "+g
+00009f50: 4f72 6967 696e 4761 7465 7761 7929 0d0a  OriginGateway)..
+00009f60: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00009f70: 726e 204e 6f6e 650d 0a0d 0a20 2020 2023  rn None....    #
+00009f80: 2320 696e 6974 2064 6566 6175 6c74 2063  # init default c
+00009f90: 6f73 740d 0a20 2020 205f 696e 6974 6961  ost..    _initia
+00009fa0: 6c69 7a65 436f 7374 2829 0d0a 0d0a 2020  lizeCost()....  
+00009fb0: 2020 7072 696e 7428 225c 725c 6e22 290d    print("\r\n").
+00009fc0: 0a20 2020 2072 6574 7572 6e20 674e 616d  .    return gNam
+00009fd0: 650d 0a0d 0a23 2320 2d2d 2d2d 2d2d 2d2d  e....## --------
+00009fe0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009ff0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a000: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a010: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a020: 0d0a 2320 2020 2020 2020 5374 6172 7469  ..#       Starti
+0000a030: 6e67 2070 6f69 6e74 206f 6620 4c69 620d  ng point of Lib.
+0000a040: 0a23 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  .## ------------
+0000a050: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a060: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a070: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0000a080: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a  ------------....
+0000a090: 2320 4d75 6c74 6974 6872 6561 6469 6e67  # Multithreading
+0000a0a0: 2066 6f72 206f 6273 6572 7665 7273 0d0a   for observers..
+0000a0b0: 7761 7463 685f 6469 7265 6374 6f72 793d  watch_directory=
+0000a0c0: 7374 6172 745f 6f62 7365 7276 6572 5f74  start_observer_t
+0000a0d0: 6872 6561 6428 5f67 6574 4f75 7470 7574  hread(_getOutput
+0000a0e0: 4469 7228 292c 206f 7361 6973 5f6f 6e4e  Dir(), osais_onN
+0000a0f0: 6f74 6966 7946 696c 6543 7265 6174 6564  otifyFileCreated
+0000a100: 2c20 4e6f 6e65 2920 2020 2020 0d0a 0d0a  , None)     ....
+0000a110: 2363 6c65 616e 696e 6720 6469 7220 6576  #cleaning dir ev
+0000a120: 6572 7920 3130 6d69 6e0d 0a73 6368 6564  ery 10min..sched
+0000a130: 756c 652e 6576 6572 7928 3130 292e 6d69  ule.every(10).mi
+0000a140: 6e75 7465 732e 646f 285f 636c 6561 7244  nutes.do(_clearD
+0000a150: 6972 290d 0a0d 0a70 7269 6e74 2822 5c72  ir)....print("\r
+0000a160: 5c6e 5079 7468 6f6e 204f 5341 4953 204c  \nPython OSAIS L
+0000a170: 6962 2069 7320 6c6f 6164 6564 2e2e 2e22  ib is loaded..."
+0000a180: 290d 0a0d 0a0d 0a                        )......
```

### Comparing `osais-1.0.33/osais.egg-info/PKG-INFO` & `osais-1.0.34/osais.egg-info/PKG-INFO`

 * *Files 24% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: osais
-Version: 1.0.33
+Version: 1.0.34
 Summary: The osais Python lib for connecting AIs to OSAIS cloud
 Home-page: https://github.com/incubiq/osais
 Author: incubiq
 Author-email: eric@incubiq.com
 Keywords: osais,opensourceais
 Classifier: Development Status :: 3 - Alpha
 Classifier: Intended Audience :: Developers
```

### Comparing `osais-1.0.33/setup.py` & `osais-1.0.34/setup.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,12 +1,12 @@
 from setuptools import setup, find_packages
 
 setup(
     name='osais',
-    version='1.0.33',
+    version='1.0.34',
     author='incubiq',
     author_email='eric@incubiq.com',
     description='The osais Python lib for connecting AIs to OSAIS cloud',
     long_description=open('README.md').read(),
     long_description_content_type='text/markdown',
     url='https://github.com/incubiq/osais',
     keywords = "osais, opensourceais",
```

