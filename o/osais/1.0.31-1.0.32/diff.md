# Comparing `tmp/osais-1.0.31.tar.gz` & `tmp/osais-1.0.32.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "D:\Websites\opensourceais\python\lib_osais\dist\.tmp-w521o5n9\osais-1.0.31.tar", last modified: Wed Apr 12 13:23:24 2023, max compression
+gzip compressed data, was "D:\Websites\opensourceais\python\lib_osais\dist\.tmp-zl2fuawc\osais-1.0.32.tar", last modified: Thu Apr 13 11:32:02 2023, max compression
```

## Comparing `osais-1.0.31.tar` & `osais-1.0.32.tar`

### file list

```diff
@@ -1,16 +1,16 @@
-drwxrwxrwx   0        0        0        0 2023-04-12 13:23:24.049351 osais-1.0.31/
--rw-rw-rw-   0        0        0    33041 2023-04-05 11:19:20.000000 osais-1.0.31/LICENSE
--rw-rw-rw-   0        0        0     1113 2023-04-12 13:23:24.049351 osais-1.0.31/PKG-INFO
--rw-rw-rw-   0        0        0      339 2023-04-05 15:00:45.000000 osais-1.0.31/README.md
-drwxrwxrwx   0        0        0        0 2023-04-12 13:23:24.044348 osais-1.0.31/osais/
--rw-rw-rw-   0        0        0      652 2023-04-12 13:22:01.000000 osais-1.0.31/osais/__init__.py
--rw-rw-rw-   0        0        0    40972 2023-04-12 13:23:02.000000 osais-1.0.31/osais/osais.py
-drwxrwxrwx   0        0        0        0 2023-04-12 13:23:24.047349 osais-1.0.31/osais.egg-info/
--rw-rw-rw-   0        0        0     1113 2023-04-12 13:23:24.000000 osais-1.0.31/osais.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      218 2023-04-12 13:23:24.000000 osais-1.0.31/osais.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2023-04-12 13:23:24.000000 osais-1.0.31/osais.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0       65 2023-04-12 13:23:24.000000 osais-1.0.31/osais.egg-info/requires.txt
--rw-rw-rw-   0        0        0        6 2023-04-12 13:23:24.000000 osais-1.0.31/osais.egg-info/top_level.txt
--rw-rw-rw-   0        0        0       95 2023-04-05 18:53:17.000000 osais-1.0.31/pyproject.toml
--rw-rw-rw-   0        0        0       42 2023-04-12 13:23:24.049351 osais-1.0.31/setup.cfg
--rw-rw-rw-   0        0        0     1124 2023-04-12 13:23:14.000000 osais-1.0.31/setup.py
+drwxrwxrwx   0        0        0        0 2023-04-13 11:32:02.967855 osais-1.0.32/
+-rw-rw-rw-   0        0        0    33041 2023-04-05 11:19:20.000000 osais-1.0.32/LICENSE
+-rw-rw-rw-   0        0        0     1113 2023-04-13 11:32:02.967855 osais-1.0.32/PKG-INFO
+-rw-rw-rw-   0        0        0      339 2023-04-05 15:00:45.000000 osais-1.0.32/README.md
+drwxrwxrwx   0        0        0        0 2023-04-13 11:32:02.962857 osais-1.0.32/osais/
+-rw-rw-rw-   0        0        0      652 2023-04-13 11:30:35.000000 osais-1.0.32/osais/__init__.py
+-rw-rw-rw-   0        0        0    41138 2023-04-13 11:30:45.000000 osais-1.0.32/osais/osais.py
+drwxrwxrwx   0        0        0        0 2023-04-13 11:32:02.966856 osais-1.0.32/osais.egg-info/
+-rw-rw-rw-   0        0        0     1113 2023-04-13 11:32:02.000000 osais-1.0.32/osais.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      218 2023-04-13 11:32:02.000000 osais-1.0.32/osais.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2023-04-13 11:32:02.000000 osais-1.0.32/osais.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0       65 2023-04-13 11:32:02.000000 osais-1.0.32/osais.egg-info/requires.txt
+-rw-rw-rw-   0        0        0        6 2023-04-13 11:32:02.000000 osais-1.0.32/osais.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0       95 2023-04-05 18:53:17.000000 osais-1.0.32/pyproject.toml
+-rw-rw-rw-   0        0        0       42 2023-04-13 11:32:02.967855 osais-1.0.32/setup.cfg
+-rw-rw-rw-   0        0        0     1124 2023-04-13 11:31:14.000000 osais-1.0.32/setup.py
```

### Comparing `osais-1.0.31/LICENSE` & `osais-1.0.32/LICENSE`

 * *Files identical despite different names*

### Comparing `osais-1.0.31/PKG-INFO` & `osais-1.0.32/PKG-INFO`

 * *Files 24% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: osais
-Version: 1.0.31
+Version: 1.0.32
 Summary: The osais Python lib for connecting AIs to OSAIS cloud
 Home-page: https://github.com/incubiq/osais
 Author: incubiq
 Author-email: eric@incubiq.com
 Keywords: osais,opensourceais
 Classifier: Development Status :: 3 - Alpha
 Classifier: Intended Audience :: Developers
```

### Comparing `osais-1.0.31/osais/__init__.py` & `osais-1.0.32/osais/__init__.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,11 +1,11 @@
 """
 A package for OSAIS virtual AI.
 """
-__version__="1.0.31"
+__version__="1.0.32"
 __author__ = "incubiq"
 __email__ = "eric@incubiq.com"
 
 from .osais import osais_isLocal
 from .osais import osais_loadConfig
 from .osais import osais_getEnv
 from .osais import osais_getHarwareInfo
```

### Comparing `osais-1.0.31/osais/osais.py` & `osais-1.0.32/osais/osais.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,9 +1,9 @@
 00000000: 0d0a 5f5f 7665 7273 696f 6e5f 5f3d 2231  ..__version__="1
-00000010: 2e30 2e33 3122 0d0a 0d0a 2323 203d 3d3d  .0.31"....## ===
+00000010: 2e30 2e33 3222 0d0a 0d0a 2323 203d 3d3d  .0.32"....## ===
 00000020: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00000030: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00000040: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00000050: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
 00000060: 3d3d 3d3d 3d0d 0a23 2320 0d0a 2323 2020  =====..## ..##  
 00000070: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00000080: 2020 2020 5574 696c 6974 6965 7320 7374      Utilities st
@@ -951,1611 +951,1622 @@
 00003b60: 6963 6174 696f 6e73 0d0a 0d0a 2323 2077  ications....## w
 00003b70: 6865 6e20 7275 6e6e 696e 6720 6173 2076  hen running as v
 00003b80: 4149 0d0a 6749 6e70 7574 4469 723d 222e  AI..gInputDir=".
 00003b90: 2f5f 696e 7075 742f 220d 0a67 4f75 7470  /_input/"..gOutp
 00003ba0: 7574 4469 723d 222e 2f5f 6f75 7470 7574  utDir="./_output
 00003bb0: 2f22 0d0a 0d0a 4149 5f50 524f 4752 4553  /"....AI_PROGRES
 00003bc0: 535f 4552 524f 523d 2d31 0d0a 4149 5f50  S_ERROR=-1..AI_P
-00003bd0: 524f 4752 4553 535f 4944 4c45 3d30 0d0a  ROGRESS_IDLE=0..
-00003be0: 4149 5f50 524f 4752 4553 535f 4152 4753  AI_PROGRESS_ARGS
-00003bf0: 3d31 0d0a 4149 5f50 524f 4752 4553 535f  =1..AI_PROGRESS_
-00003c00: 4149 5f53 5441 5254 4544 3d32 0d0a 4149  AI_STARTED=2..AI
-00003c10: 5f50 524f 4752 4553 535f 494e 4954 5f49  _PROGRESS_INIT_I
-00003c20: 4d41 4745 3d33 0d0a 4149 5f50 524f 4752  MAGE=3..AI_PROGR
-00003c30: 4553 535f 444f 4e45 5f49 4d41 4745 3d34  ESS_DONE_IMAGE=4
-00003c40: 0d0a 4149 5f50 524f 4752 4553 535f 4149  ..AI_PROGRESS_AI
-00003c50: 5f53 544f 5050 4544 3d35 0d0a 0d0a 2323  _STOPPED=5....##
-00003c60: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00003c70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00003c80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00003c90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00003ca0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a23 2020 2020  ---------..#    
-00003cb0: 2020 204c 6f61 6420 636f 6e66 6967 0d0a     Load config..
-00003cc0: 2323 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ## -------------
-00003cd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00003ce0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00003cf0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00003d00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d 0a23  -----------....#
-00003d10: 206c 6f61 6420 7468 6520 636f 6e66 6967   load the config
-00003d20: 2066 696c 6520 696e 746f 2061 204a 534f   file into a JSO
-00003d30: 4e0d 0a64 6566 205f 6c6f 6164 436f 6e66  N..def _loadConf
-00003d40: 6967 285f 6e61 6d65 293a 200d 0a20 2020  ig(_name): ..   
-00003d50: 2067 6c6f 6261 6c20 6756 6572 7369 6f6e   global gVersion
-00003d60: 0d0a 2020 2020 676c 6f62 616c 2067 4465  ..    global gDe
-00003d70: 7363 7269 7074 696f 6e0d 0a20 2020 2067  scription..    g
-00003d80: 6c6f 6261 6c20 674f 7269 6769 6e0d 0a20  lobal gOrigin.. 
-00003d90: 2020 2067 6c6f 6261 6c20 6744 6566 6175     global gDefau
-00003da0: 6c74 436f 7374 0d0a 0d0a 2020 2020 5f6a  ltCost....    _j
-00003db0: 736f 6e20 3d20 4e6f 6e65 0d0a 2020 2020  son = None..    
-00003dc0: 5f64 6972 4669 6c65 3d4e 6f6e 650d 0a20  _dirFile=None.. 
-00003dd0: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
-00003de0: 2066 726f 6d20 7061 7468 6c69 6220 696d   from pathlib im
-00003df0: 706f 7274 2050 6174 680d 0a20 2020 2020  port Path..     
-00003e00: 2020 2063 7572 7265 6e74 5f77 6f72 6b69     current_worki
-00003e10: 6e67 5f64 6972 6563 746f 7279 203d 2050  ng_directory = P
-00003e20: 6174 682e 6377 6428 290d 0a20 2020 2020  ath.cwd()..     
-00003e30: 2020 205f 6469 7246 696c 653d 6627 7b63     _dirFile=f'{c
-00003e40: 7572 7265 6e74 5f77 6f72 6b69 6e67 5f64  urrent_working_d
-00003e50: 6972 6563 746f 7279 7d2f 7b5f 6e61 6d65  irectory}/{_name
-00003e60: 7d2e 6a73 6f6e 270d 0a20 2020 2020 2020  }.json'..       
-00003e70: 2066 4a53 4f4e 203d 206f 7065 6e28 5f64   fJSON = open(_d
-00003e80: 6972 4669 6c65 290d 0a20 2020 2020 2020  irFile)..       
-00003e90: 205f 6a73 6f6e 203d 206a 736f 6e2e 6c6f   _json = json.lo
-00003ea0: 6164 2866 4a53 4f4e 290d 0a20 2020 2065  ad(fJSON)..    e
-00003eb0: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
-00003ec0: 6173 2065 7272 3a0d 0a20 2020 2020 2020  as err:..       
-00003ed0: 2070 7269 6e74 2866 2743 5249 5449 4341   print(f'CRITICA
-00003ee0: 4c3a 204e 6f20 636f 6e66 6967 2066 696c  L: No config fil
-00003ef0: 6520 7b5f 6469 7246 696c 657d 2729 0d0a  e {_dirFile}')..
-00003f00: 2020 2020 2020 2020 7379 732e 6578 6974          sys.exit
-00003f10: 2829 0d0a 0d0a 2020 2020 6756 6572 7369  ()....    gVersi
-00003f20: 6f6e 3d5f 6a73 6f6e 5b22 7665 7273 696f  on=_json["versio
-00003f30: 6e22 5d0d 0a20 2020 2067 4465 7363 7269  n"]..    gDescri
-00003f40: 7074 696f 6e3d 5f6a 736f 6e5b 2264 6573  ption=_json["des
-00003f50: 6372 6970 7469 6f6e 225d 0d0a 2020 2020  cription"]..    
-00003f60: 674f 7269 6769 6e3d 5f6a 736f 6e5b 226f  gOrigin=_json["o
-00003f70: 7269 6769 6e22 5d0d 0a20 2020 205f 636f  rigin"]..    _co
-00003f80: 7374 3d5f 6a73 6f6e 5b22 6465 6661 756c  st=_json["defaul
-00003f90: 745f 636f 7374 225d 0d0a 2020 2020 6966  t_cost"]..    if
-00003fa0: 205f 636f 7374 213d 4e6f 6e65 3a0d 0a20   _cost!=None:.. 
-00003fb0: 2020 2020 2020 2067 4465 6661 756c 7443         gDefaultC
-00003fc0: 6f73 743d 666c 6f61 7428 5f63 6f73 7429  ost=float(_cost)
-00003fd0: 0d0a 0d0a 2020 2020 7265 7475 726e 205f  ....    return _
-00003fe0: 6a73 6f6e 0d0a 0d0a 2320 6765 7420 7468  json....# get th
-00003ff0: 6520 6675 6c6c 2041 4920 636f 6e66 6967  e full AI config
-00004000: 2c20 696e 636c 7564 696e 6720 4a53 4f4e  , including JSON
-00004010: 2070 6172 616d 7320 616e 6420 6861 7264   params and hard
-00004020: 7761 7265 2069 6e66 6f0d 0a64 6566 205f  ware info..def _
-00004030: 6765 7446 756c 6c43 6f6e 6669 6728 5f6e  getFullConfig(_n
-00004040: 616d 6529 203a 0d0a 2020 2020 676c 6f62  ame) :..    glob
-00004050: 616c 2067 5573 6572 6e61 6d65 0d0a 2020  al gUsername..  
-00004060: 2020 676c 6f62 616c 2067 506f 7274 4149    global gPortAI
-00004070: 0d0a 2020 2020 676c 6f62 616c 2067 4e61  ..    global gNa
-00004080: 6d65 0d0a 2020 2020 676c 6f62 616c 2067  me..    global g
-00004090: 546f 6b65 6e0d 0a20 2020 2067 6c6f 6261  Token..    globa
-000040a0: 6c20 6753 6563 7265 740d 0a20 2020 2067  l gSecret..    g
-000040b0: 6c6f 6261 6c20 674f 7269 6769 6e4f 5341  lobal gOriginOSA
-000040c0: 4953 0d0a 2020 2020 676c 6f62 616c 2067  IS..    global g
-000040d0: 546f 6b65 6e4c 6f63 616c 0d0a 2020 2020  TokenLocal..    
-000040e0: 676c 6f62 616c 2067 5365 6372 6574 4c6f  global gSecretLo
-000040f0: 6361 6c0d 0a20 2020 2067 6c6f 6261 6c20  cal..    global 
-00004100: 674f 7269 6769 6e4c 6f63 616c 4f53 4149  gOriginLocalOSAI
-00004110: 530d 0a20 2020 2067 6c6f 6261 6c20 6749  S..    global gI
-00004120: 7356 6972 7475 616c 4149 0d0a 2020 2020  sVirtualAI..    
-00004130: 676c 6f62 616c 2067 4950 4c6f 6361 6c0d  global gIPLocal.
-00004140: 0a20 2020 2067 6c6f 6261 6c20 6745 7874  .    global gExt
-00004150: 4950 0d0a 200d 0a20 2020 205f 6970 3d67  IP.. ..    _ip=g
-00004160: 4578 7449 500d 0a20 2020 2069 6620 6749  ExtIP..    if gI
-00004170: 7356 6972 7475 616c 4149 3a0d 0a20 2020  sVirtualAI:..   
-00004180: 2020 2020 205f 6970 3d67 4950 4c6f 6361       _ip=gIPLoca
-00004190: 6c0d 0a0d 0a20 2020 205f 6a73 6f6e 3d5f  l....    _json=_
-000041a0: 6c6f 6164 436f 6e66 6967 285f 6e61 6d65  loadConfig(_name
-000041b0: 290d 0a0d 0a20 2020 206f 626a 4375 6461  )....    objCuda
-000041c0: 496e 666f 3d67 6574 4375 6461 496e 666f  Info=getCudaInfo
-000041d0: 2829 0d0a 2020 2020 6770 754e 616d 653d  ()..    gpuName=
-000041e0: 226e 6f20 4750 5522 0d0a 2020 2020 6966  "no GPU"..    if
-000041f0: 206f 626a 4375 6461 496e 666f 2021 3d20   objCudaInfo != 
-00004200: 3020 616e 6420 226e 616d 6522 2069 6e20  0 and "name" in 
-00004210: 6f62 6a43 7564 6149 6e66 6f20 616e 6420  objCudaInfo and 
-00004220: 6f62 6a43 7564 6149 6e66 6f5b 226e 616d  objCudaInfo["nam
-00004230: 6522 5d3a 0d0a 2020 2020 2020 2020 6770  e"]:..        gp
-00004240: 754e 616d 653d 6f62 6a43 7564 6149 6e66  uName=objCudaInf
-00004250: 6f5b 226e 616d 6522 5d0d 0a0d 0a20 2020  o["name"]....   
-00004260: 2072 6574 7572 6e20 7b0d 0a20 2020 2020   return {..     
-00004270: 2020 2022 7573 6572 6e61 6d65 223a 2067     "username": g
-00004280: 5573 6572 6e61 6d65 2c0d 0a20 2020 2020  Username,..     
-00004290: 2020 2022 6f73 223a 2067 6574 5f6f 735f     "os": get_os_
-000042a0: 6e61 6d65 2829 2c0d 0a20 2020 2020 2020  name(),..       
-000042b0: 2022 6770 7522 3a20 6770 754e 616d 652c   "gpu": gpuName,
-000042c0: 0d0a 2020 2020 2020 2020 226d 6163 6869  ..        "machi
-000042d0: 6e65 223a 2067 6574 5f6d 6163 6869 6e65  ne": get_machine
-000042e0: 5f6e 616d 6528 292c 0d0a 2020 2020 2020  _name(),..      
-000042f0: 2020 2269 7022 3a20 5f69 702c 0d0a 2020    "ip": _ip,..  
-00004300: 2020 2020 2020 2270 6f72 7422 3a20 6750        "port": gP
-00004310: 6f72 7441 492c 0d0a 2020 2020 2020 2020  ortAI,..        
-00004320: 2265 6e67 696e 6522 3a20 5f6a 736f 6e0d  "engine": _json.
-00004330: 0a20 2020 207d 0d0a 0d0a 2323 2050 5542  .    }....## PUB
-00004340: 4c49 4320 2d20 6172 6520 7765 2072 756e  LIC - are we run
-00004350: 6e69 6e67 206c 6f63 616c 6c79 3f0d 0a64  ning locally?..d
-00004360: 6566 206f 7361 6973 5f69 734c 6f63 616c  ef osais_isLocal
-00004370: 2829 3a0d 0a20 2020 2067 6c6f 6261 6c20  ():..    global 
-00004380: 6749 734c 6f63 616c 0d0a 2020 2020 7265  gIsLocal..    re
-00004390: 7475 726e 2067 4973 4c6f 6361 6c0d 0a0d  turn gIsLocal...
-000043a0: 0a23 2320 5055 424c 4943 202d 206c 6f61  .## PUBLIC - loa
-000043b0: 6420 7468 6520 636f 6e66 6967 206f 6620  d the config of 
-000043c0: 7468 6973 2041 490d 0a64 6566 206f 7361  this AI..def osa
-000043d0: 6973 5f6c 6f61 6443 6f6e 6669 6728 5f6e  is_loadConfig(_n
-000043e0: 616d 6529 3a20 0d0a 2020 2020 7265 7475  ame): ..    retu
-000043f0: 726e 205f 6c6f 6164 436f 6e66 6967 285f  rn _loadConfig(_
-00004400: 6e61 6d65 290d 0a0d 0a23 2320 5055 424c  name)....## PUBL
-00004410: 4943 202d 2047 6574 2065 6e76 2066 726f  IC - Get env fro
-00004420: 6d20 6669 6c65 2028 6c6f 6361 6c20 6f72  m file (local or
-00004430: 2064 6f63 6b65 7229 0d0a 6465 6620 6f73   docker)..def os
-00004440: 6169 735f 6765 7445 6e76 285f 6669 6c65  ais_getEnv(_file
-00004450: 6e61 6d65 293a 0d0a 2020 2020 676c 6f62  name):..    glob
-00004460: 616c 2067 5573 6572 6e61 6d65 0d0a 2020  al gUsername..  
-00004470: 2020 676c 6f62 616c 2067 4973 5669 7274    global gIsVirt
-00004480: 7561 6c41 490d 0a20 2020 2067 6c6f 6261  ualAI..    globa
-00004490: 6c20 6749 734c 6f63 616c 0d0a 2020 2020  l gIsLocal..    
-000044a0: 676c 6f62 616c 2067 4e61 6d65 0d0a 0d0a  global gName....
-000044b0: 2020 2020 2323 2072 6561 6420 656e 7620      ## read env 
-000044c0: 6672 6f6d 2063 6f6e 6669 6720 6669 6c65  from config file
-000044d0: 0d0a 2020 2020 7769 7468 206f 7065 6e28  ..    with open(
-000044e0: 5f66 696c 656e 616d 652c 2022 7222 2920  _filename, "r") 
-000044f0: 6173 2066 3a0d 0a20 2020 2020 2020 2063  as f:..        c
-00004500: 6f6e 7465 6e74 203d 2066 2e72 6561 6428  ontent = f.read(
-00004510: 290d 0a20 2020 2076 6172 6961 626c 6573  )..    variables
-00004520: 203d 2063 6f6e 7465 6e74 2e73 706c 6974   = content.split
-00004530: 2822 5c6e 2229 0d0a 2020 2020 666f 7220  ("\n")..    for 
-00004540: 7661 7220 696e 2076 6172 6961 626c 6573  var in variables
-00004550: 3a0d 0a20 2020 2020 2020 2069 6620 7661  :..        if va
-00004560: 7221 3d22 223a 0d0a 2020 2020 2020 2020  r!="":..        
-00004570: 2020 2020 6b65 792c 2076 616c 7565 203d      key, value =
-00004580: 2076 6172 2e73 706c 6974 2822 3d22 290d   var.split("=").
-00004590: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000045a0: 6b65 7920 3d3d 2022 5553 4552 4e41 4d45  key == "USERNAME
-000045b0: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
-000045c0: 2020 2020 6755 7365 726e 616d 6520 3d20      gUsername = 
-000045d0: 7661 6c75 650d 0a20 2020 2020 2020 2020  value..         
-000045e0: 2020 2065 6c69 6620 6b65 7920 3d3d 2022     elif key == "
-000045f0: 4953 5f4c 4f43 414c 223a 0d0a 2020 2020  IS_LOCAL":..    
-00004600: 2020 2020 2020 2020 2020 2020 6749 734c              gIsL
-00004610: 6f63 616c 203d 2028 7661 6c75 653d 3d22  ocal = (value=="
-00004620: 5472 7565 2229 0d0a 2020 2020 2020 2020  True")..        
-00004630: 2020 2020 656c 6966 206b 6579 203d 3d20      elif key == 
-00004640: 2249 535f 5649 5254 5541 4c41 4922 3a0d  "IS_VIRTUALAI":.
-00004650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004660: 2067 4973 5669 7274 7561 6c41 4920 3d20   gIsVirtualAI = 
-00004670: 2876 616c 7565 3d3d 2254 7275 6522 290d  (value=="True").
-00004680: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-00004690: 6620 6b65 7920 3d3d 2022 454e 4749 4e45  f key == "ENGINE
-000046a0: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
-000046b0: 2020 2020 674e 616d 6520 3d20 7661 6c75      gName = valu
-000046c0: 650d 0a20 2020 2072 6574 7572 6e20 7b0d  e..    return {.
-000046d0: 0a20 2020 2020 2020 2022 7573 6572 6e61  .        "userna
-000046e0: 6d65 223a 2067 5573 6572 6e61 6d65 2c0d  me": gUsername,.
-000046f0: 0a20 2020 2020 2020 2022 6973 4c6f 6361  .        "isLoca
-00004700: 6c22 3a20 6749 734c 6f63 616c 2c0d 0a20  l": gIsLocal,.. 
-00004710: 2020 2020 2020 2022 6973 5669 7274 7561         "isVirtua
-00004720: 6c41 4922 3a20 6749 7356 6972 7475 616c  lAI": gIsVirtual
-00004730: 4149 2c0d 0a20 2020 2020 2020 2022 6e61  AI,..        "na
-00004740: 6d65 223a 2067 4e61 6d65 0d0a 2020 2020  me": gName..    
-00004750: 7d0d 0a0d 0a23 2320 2d2d 2d2d 2d2d 2d2d  }....## --------
-00004760: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004770: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004780: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004790: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000047a0: 0d0a 2320 2020 2020 2020 636f 7374 2063  ..#       cost c
-000047b0: 616c 6375 6c61 7469 6f6e 0d0a 2323 202d  alculation..## -
-000047c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000047d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003bd0: 524f 4752 4553 535f 4944 4c45 3d30 2020  ROGRESS_IDLE=0  
+00003be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003bf0: 2320 756e 7573 6564 0d0a 4149 5f50 524f  # unused..AI_PRO
+00003c00: 4752 4553 535f 4152 4753 3d31 2020 2020  GRESS_ARGS=1    
+00003c10: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00003c20: 756e 7573 6564 0d0a 4149 5f50 524f 4752  unused..AI_PROGR
+00003c30: 4553 535f 4149 5f53 5441 5254 4544 3d32  ESS_AI_STARTED=2
+00003c40: 0d0a 4149 5f50 524f 4752 4553 535f 494e  ..AI_PROGRESS_IN
+00003c50: 4954 5f49 4d41 4745 3d33 0d0a 4149 5f50  IT_IMAGE=3..AI_P
+00003c60: 524f 4752 4553 535f 444f 4e45 5f49 4d41  ROGRESS_DONE_IMA
+00003c70: 4745 3d34 0d0a 4149 5f50 524f 4752 4553  GE=4..AI_PROGRES
+00003c80: 535f 4149 5f53 544f 5050 4544 3d35 0d0a  S_AI_STOPPED=5..
+00003c90: 0d0a 2323 202d 2d2d 2d2d 2d2d 2d2d 2d2d  ..## -----------
+00003ca0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003cb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003cc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003cd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a23  -------------..#
+00003ce0: 2020 2020 2020 204c 6f61 6420 636f 6e66         Load conf
+00003cf0: 6967 0d0a 2323 202d 2d2d 2d2d 2d2d 2d2d  ig..## ---------
+00003d00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003d10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003d20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00003d30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d  ---------------.
+00003d40: 0a0d 0a23 206c 6f61 6420 7468 6520 636f  ...# load the co
+00003d50: 6e66 6967 2066 696c 6520 696e 746f 2061  nfig file into a
+00003d60: 204a 534f 4e0d 0a64 6566 205f 6c6f 6164   JSON..def _load
+00003d70: 436f 6e66 6967 285f 6e61 6d65 293a 200d  Config(_name): .
+00003d80: 0a20 2020 2067 6c6f 6261 6c20 6756 6572  .    global gVer
+00003d90: 7369 6f6e 0d0a 2020 2020 676c 6f62 616c  sion..    global
+00003da0: 2067 4465 7363 7269 7074 696f 6e0d 0a20   gDescription.. 
+00003db0: 2020 2067 6c6f 6261 6c20 674f 7269 6769     global gOrigi
+00003dc0: 6e0d 0a20 2020 2067 6c6f 6261 6c20 6744  n..    global gD
+00003dd0: 6566 6175 6c74 436f 7374 0d0a 0d0a 2020  efaultCost....  
+00003de0: 2020 5f6a 736f 6e20 3d20 4e6f 6e65 0d0a    _json = None..
+00003df0: 2020 2020 5f64 6972 4669 6c65 3d4e 6f6e      _dirFile=Non
+00003e00: 650d 0a20 2020 2074 7279 3a0d 0a20 2020  e..    try:..   
+00003e10: 2020 2020 2066 726f 6d20 7061 7468 6c69       from pathli
+00003e20: 6220 696d 706f 7274 2050 6174 680d 0a20  b import Path.. 
+00003e30: 2020 2020 2020 2063 7572 7265 6e74 5f77         current_w
+00003e40: 6f72 6b69 6e67 5f64 6972 6563 746f 7279  orking_directory
+00003e50: 203d 2050 6174 682e 6377 6428 290d 0a20   = Path.cwd().. 
+00003e60: 2020 2020 2020 205f 6469 7246 696c 653d         _dirFile=
+00003e70: 6627 7b63 7572 7265 6e74 5f77 6f72 6b69  f'{current_worki
+00003e80: 6e67 5f64 6972 6563 746f 7279 7d2f 7b5f  ng_directory}/{_
+00003e90: 6e61 6d65 7d2e 6a73 6f6e 270d 0a20 2020  name}.json'..   
+00003ea0: 2020 2020 2066 4a53 4f4e 203d 206f 7065       fJSON = ope
+00003eb0: 6e28 5f64 6972 4669 6c65 290d 0a20 2020  n(_dirFile)..   
+00003ec0: 2020 2020 205f 6a73 6f6e 203d 206a 736f       _json = jso
+00003ed0: 6e2e 6c6f 6164 2866 4a53 4f4e 290d 0a20  n.load(fJSON).. 
+00003ee0: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
+00003ef0: 696f 6e20 6173 2065 7272 3a0d 0a20 2020  ion as err:..   
+00003f00: 2020 2020 2070 7269 6e74 2866 2743 5249       print(f'CRI
+00003f10: 5449 4341 4c3a 204e 6f20 636f 6e66 6967  TICAL: No config
+00003f20: 2066 696c 6520 7b5f 6469 7246 696c 657d   file {_dirFile}
+00003f30: 2729 0d0a 2020 2020 2020 2020 7379 732e  ')..        sys.
+00003f40: 6578 6974 2829 0d0a 0d0a 2020 2020 6756  exit()....    gV
+00003f50: 6572 7369 6f6e 3d5f 6a73 6f6e 5b22 7665  ersion=_json["ve
+00003f60: 7273 696f 6e22 5d0d 0a20 2020 2067 4465  rsion"]..    gDe
+00003f70: 7363 7269 7074 696f 6e3d 5f6a 736f 6e5b  scription=_json[
+00003f80: 2264 6573 6372 6970 7469 6f6e 225d 0d0a  "description"]..
+00003f90: 2020 2020 674f 7269 6769 6e3d 5f6a 736f      gOrigin=_jso
+00003fa0: 6e5b 226f 7269 6769 6e22 5d0d 0a20 2020  n["origin"]..   
+00003fb0: 205f 636f 7374 3d5f 6a73 6f6e 5b22 6465   _cost=_json["de
+00003fc0: 6661 756c 745f 636f 7374 225d 0d0a 2020  fault_cost"]..  
+00003fd0: 2020 6966 205f 636f 7374 213d 4e6f 6e65    if _cost!=None
+00003fe0: 3a0d 0a20 2020 2020 2020 2067 4465 6661  :..        gDefa
+00003ff0: 756c 7443 6f73 743d 666c 6f61 7428 5f63  ultCost=float(_c
+00004000: 6f73 7429 0d0a 0d0a 2020 2020 7265 7475  ost)....    retu
+00004010: 726e 205f 6a73 6f6e 0d0a 0d0a 2320 6765  rn _json....# ge
+00004020: 7420 7468 6520 6675 6c6c 2041 4920 636f  t the full AI co
+00004030: 6e66 6967 2c20 696e 636c 7564 696e 6720  nfig, including 
+00004040: 4a53 4f4e 2070 6172 616d 7320 616e 6420  JSON params and 
+00004050: 6861 7264 7761 7265 2069 6e66 6f0d 0a64  hardware info..d
+00004060: 6566 205f 6765 7446 756c 6c43 6f6e 6669  ef _getFullConfi
+00004070: 6728 5f6e 616d 6529 203a 0d0a 2020 2020  g(_name) :..    
+00004080: 676c 6f62 616c 2067 5573 6572 6e61 6d65  global gUsername
+00004090: 0d0a 2020 2020 676c 6f62 616c 2067 506f  ..    global gPo
+000040a0: 7274 4149 0d0a 2020 2020 676c 6f62 616c  rtAI..    global
+000040b0: 2067 4e61 6d65 0d0a 2020 2020 676c 6f62   gName..    glob
+000040c0: 616c 2067 546f 6b65 6e0d 0a20 2020 2067  al gToken..    g
+000040d0: 6c6f 6261 6c20 6753 6563 7265 740d 0a20  lobal gSecret.. 
+000040e0: 2020 2067 6c6f 6261 6c20 674f 7269 6769     global gOrigi
+000040f0: 6e4f 5341 4953 0d0a 2020 2020 676c 6f62  nOSAIS..    glob
+00004100: 616c 2067 546f 6b65 6e4c 6f63 616c 0d0a  al gTokenLocal..
+00004110: 2020 2020 676c 6f62 616c 2067 5365 6372      global gSecr
+00004120: 6574 4c6f 6361 6c0d 0a20 2020 2067 6c6f  etLocal..    glo
+00004130: 6261 6c20 674f 7269 6769 6e4c 6f63 616c  bal gOriginLocal
+00004140: 4f53 4149 530d 0a20 2020 2067 6c6f 6261  OSAIS..    globa
+00004150: 6c20 6749 7356 6972 7475 616c 4149 0d0a  l gIsVirtualAI..
+00004160: 2020 2020 676c 6f62 616c 2067 4950 4c6f      global gIPLo
+00004170: 6361 6c0d 0a20 2020 2067 6c6f 6261 6c20  cal..    global 
+00004180: 6745 7874 4950 0d0a 200d 0a20 2020 205f  gExtIP.. ..    _
+00004190: 6970 3d67 4578 7449 500d 0a20 2020 2069  ip=gExtIP..    i
+000041a0: 6620 6749 7356 6972 7475 616c 4149 3d3d  f gIsVirtualAI==
+000041b0: 4661 6c73 653a 0d0a 2020 2020 2020 2020  False:..        
+000041c0: 5f69 703d 6749 504c 6f63 616c 2020 2020  _ip=gIPLocal    
+000041d0: 2020 2020 2020 2020 2020 2020 2323 2077              ## w
+000041e0: 6520 7265 6769 7374 6572 2077 6974 6820  e register with 
+000041f0: 6c6f 6361 6c20 6970 2069 6620 7765 2061  local ip if we a
+00004200: 7265 2069 6e20 6c6f 6361 6c20 6761 7465  re in local gate
+00004210: 7761 7920 6d6f 6465 0d0a 0d0a 2020 2020  way mode....    
+00004220: 5f6a 736f 6e3d 5f6c 6f61 6443 6f6e 6669  _json=_loadConfi
+00004230: 6728 5f6e 616d 6529 0d0a 0d0a 2020 2020  g(_name)....    
+00004240: 6f62 6a43 7564 6149 6e66 6f3d 6765 7443  objCudaInfo=getC
+00004250: 7564 6149 6e66 6f28 290d 0a20 2020 2067  udaInfo()..    g
+00004260: 7075 4e61 6d65 3d22 6e6f 2047 5055 220d  puName="no GPU".
+00004270: 0a20 2020 2069 6620 6f62 6a43 7564 6149  .    if objCudaI
+00004280: 6e66 6f20 213d 2030 2061 6e64 2022 6e61  nfo != 0 and "na
+00004290: 6d65 2220 696e 206f 626a 4375 6461 496e  me" in objCudaIn
+000042a0: 666f 2061 6e64 206f 626a 4375 6461 496e  fo and objCudaIn
+000042b0: 666f 5b22 6e61 6d65 225d 3a0d 0a20 2020  fo["name"]:..   
+000042c0: 2020 2020 2067 7075 4e61 6d65 3d6f 626a       gpuName=obj
+000042d0: 4375 6461 496e 666f 5b22 6e61 6d65 225d  CudaInfo["name"]
+000042e0: 0d0a 0d0a 2020 2020 7265 7475 726e 207b  ....    return {
+000042f0: 0d0a 2020 2020 2020 2020 2275 7365 726e  ..        "usern
+00004300: 616d 6522 3a20 6755 7365 726e 616d 652c  ame": gUsername,
+00004310: 0d0a 2020 2020 2020 2020 226f 7322 3a20  ..        "os": 
+00004320: 6765 745f 6f73 5f6e 616d 6528 292c 0d0a  get_os_name(),..
+00004330: 2020 2020 2020 2020 2267 7075 223a 2067          "gpu": g
+00004340: 7075 4e61 6d65 2c0d 0a20 2020 2020 2020  puName,..       
+00004350: 2022 6d61 6368 696e 6522 3a20 6765 745f   "machine": get_
+00004360: 6d61 6368 696e 655f 6e61 6d65 2829 2c0d  machine_name(),.
+00004370: 0a20 2020 2020 2020 2022 6970 223a 205f  .        "ip": _
+00004380: 6970 2c0d 0a20 2020 2020 2020 2022 706f  ip,..        "po
+00004390: 7274 223a 2067 506f 7274 4149 2c0d 0a20  rt": gPortAI,.. 
+000043a0: 2020 2020 2020 2022 656e 6769 6e65 223a         "engine":
+000043b0: 205f 6a73 6f6e 0d0a 2020 2020 7d0d 0a0d   _json..    }...
+000043c0: 0a23 2320 5055 424c 4943 202d 2061 7265  .## PUBLIC - are
+000043d0: 2077 6520 7275 6e6e 696e 6720 6c6f 6361   we running loca
+000043e0: 6c6c 793f 0d0a 6465 6620 6f73 6169 735f  lly?..def osais_
+000043f0: 6973 4c6f 6361 6c28 293a 0d0a 2020 2020  isLocal():..    
+00004400: 676c 6f62 616c 2067 4973 4c6f 6361 6c0d  global gIsLocal.
+00004410: 0a20 2020 2072 6574 7572 6e20 6749 734c  .    return gIsL
+00004420: 6f63 616c 0d0a 0d0a 2323 2050 5542 4c49  ocal....## PUBLI
+00004430: 4320 2d20 6c6f 6164 2074 6865 2063 6f6e  C - load the con
+00004440: 6669 6720 6f66 2074 6869 7320 4149 0d0a  fig of this AI..
+00004450: 6465 6620 6f73 6169 735f 6c6f 6164 436f  def osais_loadCo
+00004460: 6e66 6967 285f 6e61 6d65 293a 200d 0a20  nfig(_name): .. 
+00004470: 2020 2072 6574 7572 6e20 5f6c 6f61 6443     return _loadC
+00004480: 6f6e 6669 6728 5f6e 616d 6529 0d0a 0d0a  onfig(_name)....
+00004490: 2323 2050 5542 4c49 4320 2d20 4765 7420  ## PUBLIC - Get 
+000044a0: 656e 7620 6672 6f6d 2066 696c 6520 286c  env from file (l
+000044b0: 6f63 616c 206f 7220 646f 636b 6572 290d  ocal or docker).
+000044c0: 0a64 6566 206f 7361 6973 5f67 6574 456e  .def osais_getEn
+000044d0: 7628 5f66 696c 656e 616d 6529 3a0d 0a20  v(_filename):.. 
+000044e0: 2020 2067 6c6f 6261 6c20 6755 7365 726e     global gUsern
+000044f0: 616d 650d 0a20 2020 2067 6c6f 6261 6c20  ame..    global 
+00004500: 6749 7356 6972 7475 616c 4149 0d0a 2020  gIsVirtualAI..  
+00004510: 2020 676c 6f62 616c 2067 4973 4c6f 6361    global gIsLoca
+00004520: 6c0d 0a20 2020 2067 6c6f 6261 6c20 674e  l..    global gN
+00004530: 616d 650d 0a0d 0a20 2020 2023 2320 7265  ame....    ## re
+00004540: 6164 2065 6e76 2066 726f 6d20 636f 6e66  ad env from conf
+00004550: 6967 2066 696c 650d 0a20 2020 2077 6974  ig file..    wit
+00004560: 6820 6f70 656e 285f 6669 6c65 6e61 6d65  h open(_filename
+00004570: 2c20 2272 2229 2061 7320 663a 0d0a 2020  , "r") as f:..  
+00004580: 2020 2020 2020 636f 6e74 656e 7420 3d20        content = 
+00004590: 662e 7265 6164 2829 0d0a 2020 2020 7661  f.read()..    va
+000045a0: 7269 6162 6c65 7320 3d20 636f 6e74 656e  riables = conten
+000045b0: 742e 7370 6c69 7428 225c 6e22 290d 0a20  t.split("\n").. 
+000045c0: 2020 2066 6f72 2076 6172 2069 6e20 7661     for var in va
+000045d0: 7269 6162 6c65 733a 0d0a 2020 2020 2020  riables:..      
+000045e0: 2020 6966 2076 6172 213d 2222 3a0d 0a20    if var!="":.. 
+000045f0: 2020 2020 2020 2020 2020 206b 6579 2c20             key, 
+00004600: 7661 6c75 6520 3d20 7661 722e 7370 6c69  value = var.spli
+00004610: 7428 223d 2229 0d0a 2020 2020 2020 2020  t("=")..        
+00004620: 2020 2020 6966 206b 6579 203d 3d20 2255      if key == "U
+00004630: 5345 524e 414d 4522 3a0d 0a20 2020 2020  SERNAME":..     
+00004640: 2020 2020 2020 2020 2020 2067 5573 6572             gUser
+00004650: 6e61 6d65 203d 2076 616c 7565 0d0a 2020  name = value..  
+00004660: 2020 2020 2020 2020 2020 656c 6966 206b            elif k
+00004670: 6579 203d 3d20 2249 535f 4c4f 4341 4c22  ey == "IS_LOCAL"
+00004680: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00004690: 2020 2067 4973 4c6f 6361 6c20 3d20 2876     gIsLocal = (v
+000046a0: 616c 7565 3d3d 2254 7275 6522 290d 0a20  alue=="True").. 
+000046b0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+000046c0: 6b65 7920 3d3d 2022 4953 5f56 4952 5455  key == "IS_VIRTU
+000046d0: 414c 4149 223a 0d0a 2020 2020 2020 2020  ALAI":..        
+000046e0: 2020 2020 2020 2020 6749 7356 6972 7475          gIsVirtu
+000046f0: 616c 4149 203d 2028 7661 6c75 653d 3d22  alAI = (value=="
+00004700: 5472 7565 2229 0d0a 2020 2020 2020 2020  True")..        
+00004710: 2020 2020 656c 6966 206b 6579 203d 3d20      elif key == 
+00004720: 2245 4e47 494e 4522 3a0d 0a20 2020 2020  "ENGINE":..     
+00004730: 2020 2020 2020 2020 2020 2067 4e61 6d65             gName
+00004740: 203d 2076 616c 7565 0d0a 2020 2020 7265   = value..    re
+00004750: 7475 726e 207b 0d0a 2020 2020 2020 2020  turn {..        
+00004760: 2275 7365 726e 616d 6522 3a20 6755 7365  "username": gUse
+00004770: 726e 616d 652c 0d0a 2020 2020 2020 2020  rname,..        
+00004780: 2269 734c 6f63 616c 223a 2067 4973 4c6f  "isLocal": gIsLo
+00004790: 6361 6c2c 0d0a 2020 2020 2020 2020 2269  cal,..        "i
+000047a0: 7356 6972 7475 616c 4149 223a 2067 4973  sVirtualAI": gIs
+000047b0: 5669 7274 7561 6c41 492c 0d0a 2020 2020  VirtualAI,..    
+000047c0: 2020 2020 226e 616d 6522 3a20 674e 616d      "name": gNam
+000047d0: 650d 0a20 2020 207d 0d0a 0d0a 2323 202d  e..    }....## -
 000047e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 000047f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004800: 2d2d 2d2d 2d2d 2d0d 0a0d 0a23 2069 6e69  -------....# ini
-00004810: 7420 7468 6520 6461 6661 756c 7420 636f  t the dafault co
-00004820: 7374 2061 7272 6179 0d0a 6465 6620 5f69  st array..def _i
-00004830: 6e69 7469 616c 697a 6543 6f73 7428 2920  nitializeCost() 
-00004840: 3a0d 0a20 2020 2067 6c6f 6261 6c20 6744  :..    global gD
-00004850: 6566 6175 6c74 436f 7374 0d0a 2020 2020  efaultCost..    
-00004860: 676c 6f62 616c 2067 6150 726f 6365 7373  global gaProcess
-00004870: 5469 6d65 0d0a 2020 2020 6672 6f6d 2061  Time..    from a
-00004880: 7272 6179 2069 6d70 6f72 7420 6172 7261  rray import arra
-00004890: 790d 0a20 2020 2067 6150 726f 6365 7373  y..    gaProcess
-000048a0: 5469 6d65 3d61 7272 6179 2827 6627 2c20  Time=array('f', 
-000048b0: 5b67 4465 6661 756c 7443 6f73 742c 6744  [gDefaultCost,gD
-000048c0: 6566 6175 6c74 436f 7374 2c67 4465 6661  efaultCost,gDefa
-000048d0: 756c 7443 6f73 742c 6744 6566 6175 6c74  ultCost,gDefault
-000048e0: 436f 7374 2c67 4465 6661 756c 7443 6f73  Cost,gDefaultCos
-000048f0: 742c 6744 6566 6175 6c74 436f 7374 2c67  t,gDefaultCost,g
-00004900: 4465 6661 756c 7443 6f73 742c 6744 6566  DefaultCost,gDef
-00004910: 6175 6c74 436f 7374 2c67 4465 6661 756c  aultCost,gDefaul
-00004920: 7443 6f73 742c 6744 6566 6175 6c74 436f  tCost,gDefaultCo
-00004930: 7374 5d29 0d0a 0d0a 2320 696e 6974 2074  st])....# init t
-00004940: 6865 2064 6166 6175 6c74 2063 6f73 7420  he dafault cost 
-00004950: 6172 7261 790d 0a64 6566 205f 6164 6443  array..def _addC
-00004960: 6f73 7428 5f63 6f73 7429 203a 0d0a 2020  ost(_cost) :..  
-00004970: 2020 676c 6f62 616c 2067 4973 5761 726d    global gIsWarm
-00004980: 7570 0d0a 2020 2020 676c 6f62 616c 2067  up..    global g
-00004990: 6150 726f 6365 7373 5469 6d65 0d0a 2020  aProcessTime..  
-000049a0: 2020 6966 2067 4973 5761 726d 7570 3d3d    if gIsWarmup==
-000049b0: 4661 6c73 653a 0d0a 2020 2020 2020 2020  False:..        
-000049c0: 6761 5072 6f63 6573 7354 696d 652e 696e  gaProcessTime.in
-000049d0: 7365 7274 2830 2c20 5f63 6f73 7429 0d0a  sert(0, _cost)..
-000049e0: 2020 2020 2020 2020 6761 5072 6f63 6573          gaProces
-000049f0: 7354 696d 652e 706f 7028 290d 0a0d 0a23  sTime.pop()....#
-00004a00: 2069 6e69 7420 7468 6520 6461 6661 756c   init the dafaul
-00004a10: 7420 636f 7374 2061 7272 6179 0d0a 6465  t cost array..de
-00004a20: 6620 5f67 6574 4176 6572 6167 6543 6f73  f _getAverageCos
-00004a30: 7428 2920 3a0d 0a20 2020 2067 6c6f 6261  t() :..    globa
-00004a40: 6c20 6761 5072 6f63 6573 7354 696d 650d  l gaProcessTime.
-00004a50: 0a20 2020 2061 7665 7261 6765 203d 2073  .    average = s
-00004a60: 756d 2867 6150 726f 6365 7373 5469 6d65  um(gaProcessTime
-00004a70: 2920 2f20 6c65 6e28 6761 5072 6f63 6573  ) / len(gaProces
-00004a80: 7354 696d 6529 0d0a 2020 2020 7265 7475  sTime)..    retu
-00004a90: 726e 2061 7665 7261 6765 0d0a 0d0a 2323  rn average....##
-00004aa0: 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d   ---------------
-00004ab0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004ac0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004ad0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004ae0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a23 2020 2020  ---------..#    
-00004af0: 2020 2061 7267 7320 7072 6f63 6573 7369     args processi
-00004b00: 6e67 0d0a 2323 202d 2d2d 2d2d 2d2d 2d2d  ng..## ---------
-00004b10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004b20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004800: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004810: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004820: 2d2d 2d2d 2d2d 2d0d 0a23 2020 2020 2020  -------..#      
+00004830: 2063 6f73 7420 6361 6c63 756c 6174 696f   cost calculatio
+00004840: 6e0d 0a23 2320 2d2d 2d2d 2d2d 2d2d 2d2d  n..## ----------
+00004850: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004860: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004870: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004880: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  --------------..
+00004890: 0d0a 2320 696e 6974 2074 6865 2064 6166  ..# init the daf
+000048a0: 6175 6c74 2063 6f73 7420 6172 7261 790d  ault cost array.
+000048b0: 0a64 6566 205f 696e 6974 6961 6c69 7a65  .def _initialize
+000048c0: 436f 7374 2829 203a 0d0a 2020 2020 676c  Cost() :..    gl
+000048d0: 6f62 616c 2067 4465 6661 756c 7443 6f73  obal gDefaultCos
+000048e0: 740d 0a20 2020 2067 6c6f 6261 6c20 6761  t..    global ga
+000048f0: 5072 6f63 6573 7354 696d 650d 0a20 2020  ProcessTime..   
+00004900: 2066 726f 6d20 6172 7261 7920 696d 706f   from array impo
+00004910: 7274 2061 7272 6179 0d0a 2020 2020 6761  rt array..    ga
+00004920: 5072 6f63 6573 7354 696d 653d 6172 7261  ProcessTime=arra
+00004930: 7928 2766 272c 205b 6744 6566 6175 6c74  y('f', [gDefault
+00004940: 436f 7374 2c67 4465 6661 756c 7443 6f73  Cost,gDefaultCos
+00004950: 742c 6744 6566 6175 6c74 436f 7374 2c67  t,gDefaultCost,g
+00004960: 4465 6661 756c 7443 6f73 742c 6744 6566  DefaultCost,gDef
+00004970: 6175 6c74 436f 7374 2c67 4465 6661 756c  aultCost,gDefaul
+00004980: 7443 6f73 742c 6744 6566 6175 6c74 436f  tCost,gDefaultCo
+00004990: 7374 2c67 4465 6661 756c 7443 6f73 742c  st,gDefaultCost,
+000049a0: 6744 6566 6175 6c74 436f 7374 2c67 4465  gDefaultCost,gDe
+000049b0: 6661 756c 7443 6f73 745d 290d 0a0d 0a23  faultCost])....#
+000049c0: 2069 6e69 7420 7468 6520 6461 6661 756c   init the dafaul
+000049d0: 7420 636f 7374 2061 7272 6179 0d0a 6465  t cost array..de
+000049e0: 6620 5f61 6464 436f 7374 285f 636f 7374  f _addCost(_cost
+000049f0: 2920 3a0d 0a20 2020 2067 6c6f 6261 6c20  ) :..    global 
+00004a00: 6749 7357 6172 6d75 700d 0a20 2020 2067  gIsWarmup..    g
+00004a10: 6c6f 6261 6c20 6761 5072 6f63 6573 7354  lobal gaProcessT
+00004a20: 696d 650d 0a20 2020 2069 6620 6749 7357  ime..    if gIsW
+00004a30: 6172 6d75 703d 3d46 616c 7365 3a0d 0a20  armup==False:.. 
+00004a40: 2020 2020 2020 2067 6150 726f 6365 7373         gaProcess
+00004a50: 5469 6d65 2e69 6e73 6572 7428 302c 205f  Time.insert(0, _
+00004a60: 636f 7374 290d 0a20 2020 2020 2020 2067  cost)..        g
+00004a70: 6150 726f 6365 7373 5469 6d65 2e70 6f70  aProcessTime.pop
+00004a80: 2829 0d0a 0d0a 2320 696e 6974 2074 6865  ()....# init the
+00004a90: 2064 6166 6175 6c74 2063 6f73 7420 6172   dafault cost ar
+00004aa0: 7261 790d 0a64 6566 205f 6765 7441 7665  ray..def _getAve
+00004ab0: 7261 6765 436f 7374 2829 203a 0d0a 2020  rageCost() :..  
+00004ac0: 2020 676c 6f62 616c 2067 6150 726f 6365    global gaProce
+00004ad0: 7373 5469 6d65 0d0a 2020 2020 6176 6572  ssTime..    aver
+00004ae0: 6167 6520 3d20 7375 6d28 6761 5072 6f63  age = sum(gaProc
+00004af0: 6573 7354 696d 6529 202f 206c 656e 2867  essTime) / len(g
+00004b00: 6150 726f 6365 7373 5469 6d65 290d 0a20  aProcessTime).. 
+00004b10: 2020 2072 6574 7572 6e20 6176 6572 6167     return averag
+00004b20: 650d 0a0d 0a23 2320 2d2d 2d2d 2d2d 2d2d  e....## --------
 00004b30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004b40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d  ---------------.
-00004b50: 0a0d 0a23 2077 6865 7265 2069 7320 7468  ...# where is th
-00004b60: 6520 6f75 7470 7574 2064 6972 3f0d 0a64  e output dir?..d
-00004b70: 6566 205f 6765 744f 7574 7075 7444 6972  ef _getOutputDir
-00004b80: 2829 3a0d 0a20 2020 2067 6c6f 6261 6c20  ():..    global 
-00004b90: 6741 7267 734f 5341 4953 0d0a 2020 2020  gArgsOSAIS..    
-00004ba0: 676c 6f62 616c 2067 4f75 7470 7574 4469  global gOutputDi
-00004bb0: 720d 0a0d 0a20 2020 2069 6620 6741 7267  r....    if gArg
-00004bc0: 734f 5341 4953 213d 4e6f 6e65 3a0d 0a20  sOSAIS!=None:.. 
-00004bd0: 2020 2020 2020 2072 6574 7572 6e20 6741         return gA
-00004be0: 7267 734f 5341 4953 2e6f 7574 6469 720d  rgsOSAIS.outdir.
-00004bf0: 0a20 2020 2072 6574 7572 6e20 674f 7574  .    return gOut
-00004c00: 7075 7444 6972 0d0a 0d0a 2320 7265 6365  putDir....# rece
-00004c10: 6976 6573 2061 7267 7320 6672 6f6d 2072  ives args from r
-00004c20: 6571 7565 7374 2061 6e64 2070 7574 2074  equest and put t
-00004c30: 6865 6d20 696e 2061 2061 7272 6179 2066  hem in a array f
-00004c40: 6f72 2070 726f 6365 7373 696e 670d 0a64  or processing..d
-00004c50: 6566 205f 6765 7441 7267 7328 5f61 7267  ef _getArgs(_arg
-00004c60: 7329 3a0d 0a20 2020 2061 5265 7375 6c74  s):..    aResult
-00004c70: 203d 205b 5d0d 0a20 2020 2066 6f72 206b   = []..    for k
-00004c80: 6579 2c20 7661 6c75 6520 696e 205f 6172  ey, value in _ar
-00004c90: 6773 2e69 7465 6d73 2829 3a0d 0a20 2020  gs.items():..   
-00004ca0: 2020 2020 2069 6620 6b65 792e 7374 6172       if key.star
-00004cb0: 7473 7769 7468 2822 2d22 293a 0d0a 2020  tswith("-"):..  
-00004cc0: 2020 2020 2020 2020 2020 6152 6573 756c            aResul
-00004cd0: 742e 6170 7065 6e64 286b 6579 290d 0a20  t.append(key).. 
-00004ce0: 2020 2020 2020 2020 2020 2061 5265 7375             aResu
-00004cf0: 6c74 2e61 7070 656e 6428 7661 6c75 6529  lt.append(value)
-00004d00: 0d0a 2020 2020 7265 7475 726e 2061 5265  ..    return aRe
-00004d10: 7375 6c74 0d0a 0d0a 2320 6769 7665 206e  sult....# give n
-00004d20: 6577 2061 7267 7320 0d0a 6465 6620 5f61  ew args ..def _a
-00004d30: 7267 7346 726f 6d46 696c 7465 7228 5f6f  rgsFromFilter(_o
-00004d40: 7269 6769 6e61 6c41 7267 732c 205f 6146  riginalArgs, _aF
-00004d50: 696c 7465 722c 205f 624b 6565 7029 3a0d  ilter, _bKeep):.
-00004d60: 0a20 2020 2066 726f 6d20 7765 726b 7a65  .    from werkze
-00004d70: 7567 2e64 6174 6173 7472 7563 7475 7265  ug.datastructure
-00004d80: 7320 696d 706f 7274 204d 756c 7469 4469  s import MultiDi
-00004d90: 6374 0d0a 2020 2020 5f64 6963 7420 3d20  ct..    _dict = 
-00004da0: 4d75 6c74 6944 6963 7428 5b5d 290d 0a20  MultiDict([]).. 
-00004db0: 2020 2066 6f72 2069 2c20 6172 6720 696e     for i, arg in
-00004dc0: 2065 6e75 6d65 7261 7465 285f 6f72 6967   enumerate(_orig
-00004dd0: 696e 616c 4172 6773 293a 0d0a 2020 2020  inalArgs):..    
-00004de0: 2020 2020 6966 205f 624b 6565 703a 0d0a      if _bKeep:..
-00004df0: 2020 2020 2020 2020 2020 2020 6966 2061              if a
-00004e00: 7267 2069 6e20 5f61 4669 6c74 6572 2061  rg in _aFilter a
-00004e10: 6e64 2069 203c 206c 656e 285f 6f72 6967  nd i < len(_orig
-00004e20: 696e 616c 4172 6773 2920 2d20 313a 0d0a  inalArgs) - 1:..
-00004e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004e40: 5f64 6963 742e 6164 6428 6172 672c 205f  _dict.add(arg, _
-00004e50: 6f72 6967 696e 616c 4172 6773 5b69 2b31  originalArgs[i+1
-00004e60: 5d29 0d0a 2020 2020 2020 2020 656c 7365  ])..        else
-00004e70: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00004e80: 6620 6172 6720 6e6f 7420 696e 205f 6146  f arg not in _aF
+00004b40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004b50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004b60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004b70: 0d0a 2320 2020 2020 2020 6172 6773 2070  ..#       args p
+00004b80: 726f 6365 7373 696e 670d 0a23 2320 2d2d  rocessing..## --
+00004b90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004ba0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004bb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004bc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004bd0: 2d2d 2d2d 2d2d 0d0a 0d0a 2320 7768 6572  ------....# wher
+00004be0: 6520 6973 2074 6865 206f 7574 7075 7420  e is the output 
+00004bf0: 6469 723f 0d0a 6465 6620 5f67 6574 4f75  dir?..def _getOu
+00004c00: 7470 7574 4469 7228 293a 0d0a 2020 2020  tputDir():..    
+00004c10: 676c 6f62 616c 2067 4172 6773 4f53 4149  global gArgsOSAI
+00004c20: 530d 0a20 2020 2067 6c6f 6261 6c20 674f  S..    global gO
+00004c30: 7574 7075 7444 6972 0d0a 0d0a 2020 2020  utputDir....    
+00004c40: 6966 2067 4172 6773 4f53 4149 5321 3d4e  if gArgsOSAIS!=N
+00004c50: 6f6e 653a 0d0a 2020 2020 2020 2020 7265  one:..        re
+00004c60: 7475 726e 2067 4172 6773 4f53 4149 532e  turn gArgsOSAIS.
+00004c70: 6f75 7464 6972 0d0a 2020 2020 7265 7475  outdir..    retu
+00004c80: 726e 2067 4f75 7470 7574 4469 720d 0a0d  rn gOutputDir...
+00004c90: 0a23 2072 6563 6569 7665 7320 6172 6773  .# receives args
+00004ca0: 2066 726f 6d20 7265 7175 6573 7420 616e   from request an
+00004cb0: 6420 7075 7420 7468 656d 2069 6e20 6120  d put them in a 
+00004cc0: 6172 7261 7920 666f 7220 7072 6f63 6573  array for proces
+00004cd0: 7369 6e67 0d0a 6465 6620 5f67 6574 4172  sing..def _getAr
+00004ce0: 6773 285f 6172 6773 293a 0d0a 2020 2020  gs(_args):..    
+00004cf0: 6152 6573 756c 7420 3d20 5b5d 0d0a 2020  aResult = []..  
+00004d00: 2020 666f 7220 6b65 792c 2076 616c 7565    for key, value
+00004d10: 2069 6e20 5f61 7267 732e 6974 656d 7328   in _args.items(
+00004d20: 293a 0d0a 2020 2020 2020 2020 6966 206b  ):..        if k
+00004d30: 6579 2e73 7461 7274 7377 6974 6828 222d  ey.startswith("-
+00004d40: 2229 3a0d 0a20 2020 2020 2020 2020 2020  "):..           
+00004d50: 2061 5265 7375 6c74 2e61 7070 656e 6428   aResult.append(
+00004d60: 6b65 7929 0d0a 2020 2020 2020 2020 2020  key)..          
+00004d70: 2020 6152 6573 756c 742e 6170 7065 6e64    aResult.append
+00004d80: 2876 616c 7565 290d 0a20 2020 2072 6574  (value)..    ret
+00004d90: 7572 6e20 6152 6573 756c 740d 0a0d 0a23  urn aResult....#
+00004da0: 2067 6976 6520 6e65 7720 6172 6773 200d   give new args .
+00004db0: 0a64 6566 205f 6172 6773 4672 6f6d 4669  .def _argsFromFi
+00004dc0: 6c74 6572 285f 6f72 6967 696e 616c 4172  lter(_originalAr
+00004dd0: 6773 2c20 5f61 4669 6c74 6572 2c20 5f62  gs, _aFilter, _b
+00004de0: 4b65 6570 293a 0d0a 2020 2020 6672 6f6d  Keep):..    from
+00004df0: 2077 6572 6b7a 6575 672e 6461 7461 7374   werkzeug.datast
+00004e00: 7275 6374 7572 6573 2069 6d70 6f72 7420  ructures import 
+00004e10: 4d75 6c74 6944 6963 740d 0a20 2020 205f  MultiDict..    _
+00004e20: 6469 6374 203d 204d 756c 7469 4469 6374  dict = MultiDict
+00004e30: 285b 5d29 0d0a 2020 2020 666f 7220 692c  ([])..    for i,
+00004e40: 2061 7267 2069 6e20 656e 756d 6572 6174   arg in enumerat
+00004e50: 6528 5f6f 7269 6769 6e61 6c41 7267 7329  e(_originalArgs)
+00004e60: 3a0d 0a20 2020 2020 2020 2069 6620 5f62  :..        if _b
+00004e70: 4b65 6570 3a0d 0a20 2020 2020 2020 2020  Keep:..         
+00004e80: 2020 2069 6620 6172 6720 696e 205f 6146     if arg in _aF
 00004e90: 696c 7465 7220 616e 6420 6920 3c20 6c65  ilter and i < le
 00004ea0: 6e28 5f6f 7269 6769 6e61 6c41 7267 7329  n(_originalArgs)
 00004eb0: 202d 2031 3a0d 0a20 2020 2020 2020 2020   - 1:..         
 00004ec0: 2020 2020 2020 205f 6469 6374 2e61 6464         _dict.add
 00004ed0: 2861 7267 2c20 5f6f 7269 6769 6e61 6c41  (arg, _originalA
-00004ee0: 7267 735b 692b 315d 290d 0a20 2020 200d  rgs[i+1])..    .
-00004ef0: 0a20 2020 205f 6172 6773 3d5f 6765 7441  .    _args=_getA
-00004f00: 7267 7328 5f64 6963 7429 0d0a 2020 2020  rgs(_dict)..    
-00004f10: 7265 7475 726e 205f 6172 6773 0d0a 0d0a  return _args....
-00004f20: 2323 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ## -------------
-00004f30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004f40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004f50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004f60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a23 2020  -----------..#  
-00004f70: 2020 2020 2053 7973 7465 6d20 696e 666f       System info
-00004f80: 0d0a 2323 202d 2d2d 2d2d 2d2d 2d2d 2d2d  ..## -----------
-00004f90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004fa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004ee0: 7267 735b 692b 315d 290d 0a20 2020 2020  rgs[i+1])..     
+00004ef0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00004f00: 2020 2020 2020 6966 2061 7267 206e 6f74        if arg not
+00004f10: 2069 6e20 5f61 4669 6c74 6572 2061 6e64   in _aFilter and
+00004f20: 2069 203c 206c 656e 285f 6f72 6967 696e   i < len(_origin
+00004f30: 616c 4172 6773 2920 2d20 313a 0d0a 2020  alArgs) - 1:..  
+00004f40: 2020 2020 2020 2020 2020 2020 2020 5f64                _d
+00004f50: 6963 742e 6164 6428 6172 672c 205f 6f72  ict.add(arg, _or
+00004f60: 6967 696e 616c 4172 6773 5b69 2b31 5d29  iginalArgs[i+1])
+00004f70: 0d0a 2020 2020 0d0a 2020 2020 5f61 7267  ..    ..    _arg
+00004f80: 733d 5f67 6574 4172 6773 285f 6469 6374  s=_getArgs(_dict
+00004f90: 290d 0a20 2020 2072 6574 7572 6e20 5f61  )..    return _a
+00004fa0: 7267 730d 0a0d 0a23 2320 2d2d 2d2d 2d2d  rgs....## ------
 00004fb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004fc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d  -------------...
-00004fd0: 0a64 6566 205f 636c 6561 7244 6972 2829  .def _clearDir()
-00004fe0: 3a0d 0a20 2020 2063 6c65 6172 4f6c 6446  :..    clearOldF
-00004ff0: 696c 6573 2867 496e 7075 7444 6972 290d  iles(gInputDir).
-00005000: 0a20 2020 2063 6c65 6172 4f6c 6446 696c  .    clearOldFil
-00005010: 6573 2867 4f75 7470 7574 4469 7229 0d0a  es(gOutputDir)..
-00005020: 0d0a 2323 2050 5542 4c49 4320 2d20 696e  ..## PUBLIC - in
-00005030: 666f 2061 626f 7574 2068 6172 7761 7265  fo about harware
-00005040: 2074 6869 7320 4149 2069 7320 7275 6e6e   this AI is runn
-00005050: 696e 6720 6f6e 0d0a 6465 6620 6f73 6169  ing on..def osai
-00005060: 735f 6765 7448 6172 7761 7265 496e 666f  s_getHarwareInfo
-00005070: 2829 203a 0d0a 2020 2020 676c 6f62 616c  () :..    global
-00005080: 2067 4e61 6d65 0d0a 2020 2020 7265 7475   gName..    retu
-00005090: 726e 2067 6574 486f 7374 496e 666f 2867  rn getHostInfo(g
-000050a0: 4e61 6d65 290d 0a0d 0a23 2320 5055 424c  Name)....## PUBL
-000050b0: 4943 202d 2067 6574 206c 6973 7420 6f66  IC - get list of
-000050c0: 2066 696c 6573 2069 6e20 6120 6469 7220   files in a dir 
-000050d0: 2863 6865 636b 2077 6861 7420 7761 7320  (check what was 
-000050e0: 6765 6e65 7261 7465 6429 0d0a 6465 6620  generated)..def 
-000050f0: 6f73 6169 735f 6765 7444 6972 6563 746f  osais_getDirecto
-00005100: 7279 4c69 7374 696e 6728 5f64 6972 2920  ryListing(_dir) 
-00005110: 3a0d 0a20 2020 2072 6574 7572 6e20 6c69  :..    return li
-00005120: 7374 4469 7243 6f6e 7465 6e74 285f 6469  stDirContent(_di
-00005130: 7229 0d0a 0d0a 2323 2050 5542 4c49 4320  r)....## PUBLIC 
-00005140: 2d20 696e 666f 2061 626f 7574 2074 6869  - info about thi
-00005150: 7320 4149 0d0a 6465 6620 6f73 6169 735f  s AI..def osais_
-00005160: 6765 7449 6e66 6f28 2920 3a0d 0a20 2020  getInfo() :..   
-00005170: 2067 6c6f 6261 6c20 6745 7874 4950 0d0a   global gExtIP..
-00005180: 2020 2020 676c 6f62 616c 2067 506f 7274      global gPort
-00005190: 4149 0d0a 2020 2020 676c 6f62 616c 2067  AI..    global g
-000051a0: 4e61 6d65 0d0a 2020 2020 676c 6f62 616c  Name..    global
-000051b0: 2067 5665 7273 696f 6e0d 0a20 2020 2067   gVersion..    g
-000051c0: 6c6f 6261 6c20 6749 7344 6f63 6b65 720d  lobal gIsDocker.
-000051d0: 0a20 2020 2067 6c6f 6261 6c20 674d 6163  .    global gMac
-000051e0: 6869 6e65 4e61 6d65 0d0a 2020 2020 676c  hineName..    gl
-000051f0: 6f62 616c 2067 5573 6572 6e61 6d65 0d0a  obal gUsername..
-00005200: 2020 2020 676c 6f62 616c 2067 4973 4275      global gIsBu
-00005210: 7379 0d0a 2020 2020 676c 6f62 616c 2067  sy..    global g
-00005220: 4c61 7374 5072 6f63 6573 7353 7461 7274  LastProcessStart
-00005230: 5f61 740d 0a20 2020 2067 6c6f 6261 6c20  _at..    global 
-00005240: 674c 6173 7443 6865 636b 6564 5f61 740d  gLastChecked_at.
-00005250: 0a0d 0a20 2020 206f 626a 436f 6e66 3d5f  ...    objConf=_
-00005260: 6765 7446 756c 6c43 6f6e 6669 6728 674e  getFullConfig(gN
-00005270: 616d 6529 0d0a 0d0a 2020 2020 7265 7475  ame)....    retu
-00005280: 726e 207b 0d0a 2020 2020 2020 2020 226e  rn {..        "n
-00005290: 616d 6522 3a20 674e 616d 652c 0d0a 2020  ame": gName,..  
-000052a0: 2020 2020 2020 2276 6572 7369 6f6e 223a        "version":
-000052b0: 2067 5665 7273 696f 6e2c 0d0a 2020 2020   gVersion,..    
-000052c0: 2020 2020 226c 6f63 6174 696f 6e22 3a20      "location": 
-000052d0: 6622 7b67 4578 7449 507d 3a7b 6750 6f72  f"{gExtIP}:{gPor
-000052e0: 7441 497d 2f22 2c0d 0a20 2020 2020 2020  tAI}/",..       
-000052f0: 2022 6973 5275 6e6e 696e 6722 3a20 5472   "isRunning": Tr
-00005300: 7565 2c20 2020 200d 0a20 2020 2020 2020  ue,    ..       
-00005310: 2022 6973 446f 636b 6572 223a 2067 4973   "isDocker": gIs
-00005320: 446f 636b 6572 2c20 2020 200d 0a20 2020  Docker,    ..   
-00005330: 2020 2020 2022 6c61 7374 4163 7469 7665       "lastActive
-00005340: 5f61 7422 3a20 674c 6173 7443 6865 636b  _at": gLastCheck
-00005350: 6564 5f61 742c 0d0a 2020 2020 2020 2020  ed_at,..        
-00005360: 226c 6173 7450 726f 6365 7373 5374 6172  "lastProcessStar
-00005370: 745f 6174 223a 2067 4c61 7374 5072 6f63  t_at": gLastProc
-00005380: 6573 7353 7461 7274 5f61 742c 0d0a 2020  essStart_at,..  
-00005390: 2020 2020 2020 226d 6163 6869 6e65 223a        "machine":
-000053a0: 2067 4d61 6368 696e 654e 616d 652c 0d0a   gMachineName,..
-000053b0: 2020 2020 2020 2020 226f 776e 6572 223a          "owner":
-000053c0: 2067 5573 6572 6e61 6d65 2c20 0d0a 2020   gUsername, ..  
-000053d0: 2020 2020 2020 2269 7341 7661 696c 6162        "isAvailab
-000053e0: 6c65 223a 2028 6749 7342 7573 793d 3d46  le": (gIsBusy==F
-000053f0: 616c 7365 292c 0d0a 2020 2020 2020 2020  alse),..        
-00005400: 2261 7665 7261 6765 5265 7370 6f6e 7365  "averageResponse
-00005410: 5469 6d65 223a 205f 6765 7441 7665 7261  Time": _getAvera
-00005420: 6765 436f 7374 2829 2c20 0d0a 2020 2020  geCost(), ..    
-00005430: 2020 2020 226a 736f 6e22 3a20 6f62 6a43      "json": objC
-00005440: 6f6e 665b 2265 6e67 696e 6522 5d0d 0a20  onf["engine"].. 
-00005450: 2020 207d 0d0a 0d0a 2323 202d 2d2d 2d2d     }....## -----
-00005460: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005470: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005480: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005490: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000054a0: 2d2d 2d0d 0a23 2020 2020 2020 2063 6f6e  ---..#       con
-000054b0: 6e65 6374 2074 6f20 4761 7465 7761 790d  nect to Gateway.
-000054c0: 0a23 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  .## ------------
-000054d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000054e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004fc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004fd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004fe0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004ff0: 2d2d 0d0a 2320 2020 2020 2020 5379 7374  --..#       Syst
+00005000: 656d 2069 6e66 6f0d 0a23 2320 2d2d 2d2d  em info..## ----
+00005010: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005020: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005030: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005040: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005050: 2d2d 2d2d 0d0a 0d0a 6465 6620 5f63 6c65  ----....def _cle
+00005060: 6172 4469 7228 293a 0d0a 2020 2020 636c  arDir():..    cl
+00005070: 6561 724f 6c64 4669 6c65 7328 6749 6e70  earOldFiles(gInp
+00005080: 7574 4469 7229 0d0a 2020 2020 636c 6561  utDir)..    clea
+00005090: 724f 6c64 4669 6c65 7328 674f 7574 7075  rOldFiles(gOutpu
+000050a0: 7444 6972 290d 0a0d 0a23 2320 5055 424c  tDir)....## PUBL
+000050b0: 4943 202d 2069 6e66 6f20 6162 6f75 7420  IC - info about 
+000050c0: 6861 7277 6172 6520 7468 6973 2041 4920  harware this AI 
+000050d0: 6973 2072 756e 6e69 6e67 206f 6e0d 0a64  is running on..d
+000050e0: 6566 206f 7361 6973 5f67 6574 4861 7277  ef osais_getHarw
+000050f0: 6172 6549 6e66 6f28 2920 3a0d 0a20 2020  areInfo() :..   
+00005100: 2067 6c6f 6261 6c20 674e 616d 650d 0a20   global gName.. 
+00005110: 2020 2072 6574 7572 6e20 6765 7448 6f73     return getHos
+00005120: 7449 6e66 6f28 674e 616d 6529 0d0a 0d0a  tInfo(gName)....
+00005130: 2323 2050 5542 4c49 4320 2d20 6765 7420  ## PUBLIC - get 
+00005140: 6c69 7374 206f 6620 6669 6c65 7320 696e  list of files in
+00005150: 2061 2064 6972 2028 6368 6563 6b20 7768   a dir (check wh
+00005160: 6174 2077 6173 2067 656e 6572 6174 6564  at was generated
+00005170: 290d 0a64 6566 206f 7361 6973 5f67 6574  )..def osais_get
+00005180: 4469 7265 6374 6f72 794c 6973 7469 6e67  DirectoryListing
+00005190: 285f 6469 7229 203a 0d0a 2020 2020 7265  (_dir) :..    re
+000051a0: 7475 726e 206c 6973 7444 6972 436f 6e74  turn listDirCont
+000051b0: 656e 7428 5f64 6972 290d 0a0d 0a23 2320  ent(_dir)....## 
+000051c0: 5055 424c 4943 202d 2069 6e66 6f20 6162  PUBLIC - info ab
+000051d0: 6f75 7420 7468 6973 2041 490d 0a64 6566  out this AI..def
+000051e0: 206f 7361 6973 5f67 6574 496e 666f 2829   osais_getInfo()
+000051f0: 203a 0d0a 2020 2020 676c 6f62 616c 2067   :..    global g
+00005200: 4578 7449 500d 0a20 2020 2067 6c6f 6261  ExtIP..    globa
+00005210: 6c20 6750 6f72 7441 490d 0a20 2020 2067  l gPortAI..    g
+00005220: 6c6f 6261 6c20 674e 616d 650d 0a20 2020  lobal gName..   
+00005230: 2067 6c6f 6261 6c20 6756 6572 7369 6f6e   global gVersion
+00005240: 0d0a 2020 2020 676c 6f62 616c 2067 4973  ..    global gIs
+00005250: 446f 636b 6572 0d0a 2020 2020 676c 6f62  Docker..    glob
+00005260: 616c 2067 4d61 6368 696e 654e 616d 650d  al gMachineName.
+00005270: 0a20 2020 2067 6c6f 6261 6c20 6755 7365  .    global gUse
+00005280: 726e 616d 650d 0a20 2020 2067 6c6f 6261  rname..    globa
+00005290: 6c20 6749 7342 7573 790d 0a20 2020 2067  l gIsBusy..    g
+000052a0: 6c6f 6261 6c20 674c 6173 7450 726f 6365  lobal gLastProce
+000052b0: 7373 5374 6172 745f 6174 0d0a 2020 2020  ssStart_at..    
+000052c0: 676c 6f62 616c 2067 4c61 7374 4368 6563  global gLastChec
+000052d0: 6b65 645f 6174 0d0a 0d0a 2020 2020 6f62  ked_at....    ob
+000052e0: 6a43 6f6e 663d 5f67 6574 4675 6c6c 436f  jConf=_getFullCo
+000052f0: 6e66 6967 2867 4e61 6d65 290d 0a0d 0a20  nfig(gName).... 
+00005300: 2020 2072 6574 7572 6e20 7b0d 0a20 2020     return {..   
+00005310: 2020 2020 2022 6e61 6d65 223a 2067 4e61       "name": gNa
+00005320: 6d65 2c0d 0a20 2020 2020 2020 2022 7665  me,..        "ve
+00005330: 7273 696f 6e22 3a20 6756 6572 7369 6f6e  rsion": gVersion
+00005340: 2c0d 0a20 2020 2020 2020 2022 6c6f 6361  ,..        "loca
+00005350: 7469 6f6e 223a 2066 227b 6745 7874 4950  tion": f"{gExtIP
+00005360: 7d3a 7b67 506f 7274 4149 7d2f 222c 0d0a  }:{gPortAI}/",..
+00005370: 2020 2020 2020 2020 2269 7352 756e 6e69          "isRunni
+00005380: 6e67 223a 2054 7275 652c 2020 2020 0d0a  ng": True,    ..
+00005390: 2020 2020 2020 2020 2269 7344 6f63 6b65          "isDocke
+000053a0: 7222 3a20 6749 7344 6f63 6b65 722c 2020  r": gIsDocker,  
+000053b0: 2020 0d0a 2020 2020 2020 2020 226c 6173    ..        "las
+000053c0: 7441 6374 6976 655f 6174 223a 2067 4c61  tActive_at": gLa
+000053d0: 7374 4368 6563 6b65 645f 6174 2c0d 0a20  stChecked_at,.. 
+000053e0: 2020 2020 2020 2022 6c61 7374 5072 6f63         "lastProc
+000053f0: 6573 7353 7461 7274 5f61 7422 3a20 674c  essStart_at": gL
+00005400: 6173 7450 726f 6365 7373 5374 6172 745f  astProcessStart_
+00005410: 6174 2c0d 0a20 2020 2020 2020 2022 6d61  at,..        "ma
+00005420: 6368 696e 6522 3a20 674d 6163 6869 6e65  chine": gMachine
+00005430: 4e61 6d65 2c0d 0a20 2020 2020 2020 2022  Name,..        "
+00005440: 6f77 6e65 7222 3a20 6755 7365 726e 616d  owner": gUsernam
+00005450: 652c 200d 0a20 2020 2020 2020 2022 6973  e, ..        "is
+00005460: 4176 6169 6c61 626c 6522 3a20 2867 4973  Available": (gIs
+00005470: 4275 7379 3d3d 4661 6c73 6529 2c0d 0a20  Busy==False),.. 
+00005480: 2020 2020 2020 2022 6176 6572 6167 6552         "averageR
+00005490: 6573 706f 6e73 6554 696d 6522 3a20 5f67  esponseTime": _g
+000054a0: 6574 4176 6572 6167 6543 6f73 7428 292c  etAverageCost(),
+000054b0: 200d 0a20 2020 2020 2020 2022 6a73 6f6e   ..        "json
+000054c0: 223a 206f 626a 436f 6e66 5b22 656e 6769  ": objConf["engi
+000054d0: 6e65 225d 0d0a 2020 2020 7d0d 0a0d 0a23  ne"]..    }....#
+000054e0: 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  # --------------
 000054f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005500: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a  ------------....
-00005510: 2320 6e6f 7469 6679 2074 6865 2067 6174  # notify the gat
-00005520: 6577 6179 206f 6620 6f75 7220 4149 2063  eway of our AI c
-00005530: 6f6e 6669 6720 6669 6c65 0d0a 6465 6620  onfig file..def 
-00005540: 5f6e 6f74 6966 7947 6174 6577 6179 2829  _notifyGateway()
-00005550: 203a 200d 0a20 2020 2067 6c6f 6261 6c20   : ..    global 
-00005560: 674e 616d 650d 0a20 2020 2067 6c6f 6261  gName..    globa
-00005570: 6c20 674f 7269 6769 6e47 6174 6577 6179  l gOriginGateway
-00005580: 0d0a 0d0a 2020 2020 6865 6164 6572 7320  ....    headers 
-00005590: 3d20 7b0d 0a20 2020 2020 2020 2022 436f  = {..        "Co
-000055a0: 6e74 656e 742d 5479 7065 223a 2027 6170  ntent-Type": 'ap
-000055b0: 706c 6963 6174 696f 6e2f 6a73 6f6e 272c  plication/json',
-000055c0: 200d 0a20 2020 2020 2020 2027 4163 6365   ..        'Acce
-000055d0: 7074 273a 2027 7465 7874 2f70 6c61 696e  pt': 'text/plain
-000055e0: 272c 0d0a 2020 2020 7d0d 0a20 2020 206f  ',..    }..    o
-000055f0: 626a 5061 7261 6d3d 5f67 6574 4675 6c6c  bjParam=_getFull
-00005600: 436f 6e66 6967 2867 4e61 6d65 290d 0a0d  Config(gName)...
-00005610: 0a20 2020 2023 2320 6e6f 7469 6679 2067  .    ## notify g
-00005620: 6174 6577 6179 0d0a 2020 2020 7472 793a  ateway..    try:
-00005630: 0d0a 2020 2020 2020 2020 7265 7370 6f6e  ..        respon
-00005640: 7365 203d 2072 6571 7565 7374 732e 706f  se = requests.po
-00005650: 7374 2866 227b 674f 7269 6769 6e47 6174  st(f"{gOriginGat
-00005660: 6577 6179 7d61 7069 2f76 312f 7075 626c  eway}api/v1/publ
-00005670: 6963 2f61 692f 636f 6e66 6967 222c 2068  ic/ai/config", h
-00005680: 6561 6465 7273 3d68 6561 6465 7273 2c20  eaders=headers, 
-00005690: 6461 7461 3d6a 736f 6e2e 6475 6d70 7328  data=json.dumps(
-000056a0: 6f62 6a50 6172 616d 2929 0d0a 2020 2020  objParam))..    
-000056b0: 2020 2020 6f62 6a52 6573 3d72 6573 706f      objRes=respo
-000056c0: 6e73 652e 6a73 6f6e 2829 5b22 6461 7461  nse.json()["data
-000056d0: 225d 0d0a 2020 2020 2020 2020 6966 206f  "]..        if o
-000056e0: 626a 5265 7320 6973 204e 6f6e 653a 0d0a  bjRes is None:..
-000056f0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00005700: 6520 5661 6c75 6545 7272 6f72 2822 4352  e ValueError("CR
-00005710: 4954 4943 414c 3a20 636f 756c 6420 6e6f  ITICAL: could no
-00005720: 7420 6e6f 7469 6679 2047 6174 6577 6179  t notify Gateway
-00005730: 2229 0d0a 0d0a 2020 2020 6578 6365 7074  ")....    except
-00005740: 2045 7863 6570 7469 6f6e 2061 7320 6572   Exception as er
-00005750: 723a 0d0a 2020 2020 2020 2020 7072 696e  r:..        prin
-00005760: 7428 2243 5249 5449 4341 4c3a 2022 2b65  t("CRITICAL: "+e
-00005770: 7272 2e6d 7367 290d 0a20 2020 2020 2020  rr.msg)..       
-00005780: 2072 6169 7365 2065 7272 0d0a 2020 2020   raise err..    
-00005790: 7265 7475 726e 2054 7275 650d 0a0d 0a23  return True....#
-000057a0: 2320 5055 424c 4943 202d 2052 6573 6574  # PUBLIC - Reset
-000057b0: 2063 6f6e 6e65 6374 696f 6e20 746f 206c   connection to l
-000057c0: 6f63 616c 2067 6174 6577 6179 0d0a 6465  ocal gateway..de
-000057d0: 6620 6f73 6169 735f 7265 7365 7447 6174  f osais_resetGat
-000057e0: 6577 6179 285f 6c6f 6361 6c47 6174 6577  eway(_localGatew
-000057f0: 6179 293a 0d0a 2020 2020 676c 6f62 616c  ay):..    global
-00005800: 2067 4f72 6967 696e 4761 7465 7761 790d   gOriginGateway.
-00005810: 0a20 2020 2067 4f72 6967 696e 4761 7465  .    gOriginGate
-00005820: 7761 793d 5f6c 6f63 616c 4761 7465 7761  way=_localGatewa
-00005830: 790d 0a20 2020 2074 7279 3a0d 0a20 2020  y..    try:..   
-00005840: 2020 2020 205f 6e6f 7469 6679 4761 7465       _notifyGate
-00005850: 7761 7928 290d 0a20 2020 2065 7863 6570  way()..    excep
-00005860: 7420 4578 6365 7074 696f 6e20 6173 2065  t Exception as e
-00005870: 7272 3a0d 0a20 2020 2020 2020 2070 7269  rr:..        pri
-00005880: 6e74 2822 4352 4954 4943 414c 3a20 222b  nt("CRITICAL: "+
-00005890: 6572 722e 6d73 6729 0d0a 2020 2020 2020  err.msg)..      
-000058a0: 2020 7261 6973 6520 6572 720d 0a20 2020    raise err..   
-000058b0: 200d 0a20 2020 2070 7269 6e74 2822 3d3e   ..    print("=>
-000058c0: 2054 6869 7320 4149 2069 7320 7265 7365   This AI is rese
-000058d0: 7420 746f 2074 616c 6b20 746f 2047 6174  t to talk to Gat
-000058e0: 6577 6179 2022 2b5f 6c6f 6361 6c47 6174  eway "+_localGat
-000058f0: 6577 6179 290d 0a20 2020 2072 6574 7572  eway)..    retur
-00005900: 6e20 5472 7565 0d0a 0d0a 2323 202d 2d2d  n True....## ---
-00005910: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005920: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005930: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005940: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00005950: 2d2d 2d2d 2d0d 0a23 2020 2020 2020 2061  -----..#       a
-00005960: 7574 6865 6e74 6963 6174 6520 696e 746f  uthenticate into
-00005970: 204f 5341 4953 2061 7320 7669 7274 7561   OSAIS as virtua
-00005980: 6c20 4149 0d0a 2323 202d 2d2d 2d2d 2d2d  l AI..## -------
-00005990: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005500: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005510: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005520: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2320 2020  ----------..#   
+00005530: 2020 2020 636f 6e6e 6563 7420 746f 2047      connect to G
+00005540: 6174 6577 6179 0d0a 2323 202d 2d2d 2d2d  ateway..## -----
+00005550: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005560: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005570: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005580: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005590: 2d2d 2d0d 0a0d 0a23 206e 6f74 6966 7920  ---....# notify 
+000055a0: 7468 6520 6761 7465 7761 7920 6f66 206f  the gateway of o
+000055b0: 7572 2041 4920 636f 6e66 6967 2066 696c  ur AI config fil
+000055c0: 650d 0a64 6566 205f 6e6f 7469 6679 4761  e..def _notifyGa
+000055d0: 7465 7761 7928 2920 3a20 0d0a 2020 2020  teway() : ..    
+000055e0: 676c 6f62 616c 2067 4e61 6d65 0d0a 2020  global gName..  
+000055f0: 2020 676c 6f62 616c 2067 4f72 6967 696e    global gOrigin
+00005600: 4761 7465 7761 790d 0a0d 0a20 2020 2068  Gateway....    h
+00005610: 6561 6465 7273 203d 207b 0d0a 2020 2020  eaders = {..    
+00005620: 2020 2020 2243 6f6e 7465 6e74 2d54 7970      "Content-Typ
+00005630: 6522 3a20 2761 7070 6c69 6361 7469 6f6e  e": 'application
+00005640: 2f6a 736f 6e27 2c20 0d0a 2020 2020 2020  /json', ..      
+00005650: 2020 2741 6363 6570 7427 3a20 2774 6578    'Accept': 'tex
+00005660: 742f 706c 6169 6e27 2c0d 0a20 2020 207d  t/plain',..    }
+00005670: 0d0a 2020 2020 6f62 6a50 6172 616d 3d5f  ..    objParam=_
+00005680: 6765 7446 756c 6c43 6f6e 6669 6728 674e  getFullConfig(gN
+00005690: 616d 6529 0d0a 0d0a 2020 2020 2323 206e  ame)....    ## n
+000056a0: 6f74 6966 7920 6761 7465 7761 790d 0a20  otify gateway.. 
+000056b0: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+000056c0: 2072 6573 706f 6e73 6520 3d20 7265 7175   response = requ
+000056d0: 6573 7473 2e70 6f73 7428 6622 7b67 4f72  ests.post(f"{gOr
+000056e0: 6967 696e 4761 7465 7761 797d 6170 692f  iginGateway}api/
+000056f0: 7631 2f70 7562 6c69 632f 6169 2f63 6f6e  v1/public/ai/con
+00005700: 6669 6722 2c20 6865 6164 6572 733d 6865  fig", headers=he
+00005710: 6164 6572 732c 2064 6174 613d 6a73 6f6e  aders, data=json
+00005720: 2e64 756d 7073 286f 626a 5061 7261 6d29  .dumps(objParam)
+00005730: 290d 0a20 2020 2020 2020 206f 626a 5265  )..        objRe
+00005740: 733d 7265 7370 6f6e 7365 2e6a 736f 6e28  s=response.json(
+00005750: 295b 2264 6174 6122 5d0d 0a20 2020 2020  )["data"]..     
+00005760: 2020 2069 6620 6f62 6a52 6573 2069 7320     if objRes is 
+00005770: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
+00005780: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00005790: 726f 7228 2243 5249 5449 4341 4c3a 2063  ror("CRITICAL: c
+000057a0: 6f75 6c64 206e 6f74 206e 6f74 6966 7920  ould not notify 
+000057b0: 4761 7465 7761 7922 290d 0a0d 0a20 2020  Gateway")....   
+000057c0: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
+000057d0: 6e20 6173 2065 7272 3a0d 0a20 2020 2020  n as err:..     
+000057e0: 2020 2070 7269 6e74 2822 4352 4954 4943     print("CRITIC
+000057f0: 414c 3a20 222b 6572 722e 6d73 6729 0d0a  AL: "+err.msg)..
+00005800: 2020 2020 2020 2020 7261 6973 6520 6572          raise er
+00005810: 720d 0a20 2020 2072 6574 7572 6e20 5472  r..    return Tr
+00005820: 7565 0d0a 0d0a 2323 2050 5542 4c49 4320  ue....## PUBLIC 
+00005830: 2d20 5265 7365 7420 636f 6e6e 6563 7469  - Reset connecti
+00005840: 6f6e 2074 6f20 6c6f 6361 6c20 6761 7465  on to local gate
+00005850: 7761 790d 0a64 6566 206f 7361 6973 5f72  way..def osais_r
+00005860: 6573 6574 4761 7465 7761 7928 5f6c 6f63  esetGateway(_loc
+00005870: 616c 4761 7465 7761 7929 3a0d 0a20 2020  alGateway):..   
+00005880: 2067 6c6f 6261 6c20 674f 7269 6769 6e47   global gOriginG
+00005890: 6174 6577 6179 0d0a 2020 2020 674f 7269  ateway..    gOri
+000058a0: 6769 6e47 6174 6577 6179 3d5f 6c6f 6361  ginGateway=_loca
+000058b0: 6c47 6174 6577 6179 0d0a 2020 2020 7472  lGateway..    tr
+000058c0: 793a 0d0a 2020 2020 2020 2020 5f6e 6f74  y:..        _not
+000058d0: 6966 7947 6174 6577 6179 2829 0d0a 2020  ifyGateway()..  
+000058e0: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
+000058f0: 6f6e 2061 7320 6572 723a 0d0a 2020 2020  on as err:..    
+00005900: 2020 2020 7072 696e 7428 2243 5249 5449      print("CRITI
+00005910: 4341 4c3a 2022 2b65 7272 2e6d 7367 290d  CAL: "+err.msg).
+00005920: 0a20 2020 2020 2020 2072 6169 7365 2065  .        raise e
+00005930: 7272 0d0a 2020 2020 0d0a 2020 2020 7072  rr..    ..    pr
+00005940: 696e 7428 223d 3e20 5468 6973 2041 4920  int("=> This AI 
+00005950: 6973 2072 6573 6574 2074 6f20 7461 6c6b  is reset to talk
+00005960: 2074 6f20 4761 7465 7761 7920 222b 5f6c   to Gateway "+_l
+00005970: 6f63 616c 4761 7465 7761 7929 0d0a 2020  ocalGateway)..  
+00005980: 2020 7265 7475 726e 2054 7275 650d 0a0d    return True...
+00005990: 0a23 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  .## ------------
 000059a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 000059b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 000059c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000059d0: 2d0d 0a0d 0a23 2052 6567 6973 7465 7220  -....# Register 
-000059e0: 6f75 7220 5641 4920 696e 746f 204f 5341  our VAI into OSA
-000059f0: 4953 0d0a 6465 6620 5f72 6567 6973 7465  IS..def _registe
-00005a00: 7256 4149 2829 3a0d 0a20 2020 2067 6c6f  rVAI():..    glo
-00005a10: 6261 6c20 674e 616d 650d 0a20 2020 2067  bal gName..    g
-00005a20: 6c6f 6261 6c20 6754 6f6b 656e 0d0a 2020  lobal gToken..  
-00005a30: 2020 676c 6f62 616c 2067 5365 6372 6574    global gSecret
-00005a40: 0d0a 2020 2020 676c 6f62 616c 2067 4f72  ..    global gOr
-00005a50: 6967 696e 4f53 4149 530d 0a20 2020 2067  iginOSAIS..    g
-00005a60: 6c6f 6261 6c20 6754 6f6b 656e 4c6f 6361  lobal gTokenLoca
-00005a70: 6c0d 0a20 2020 2067 6c6f 6261 6c20 6753  l..    global gS
-00005a80: 6563 7265 744c 6f63 616c 0d0a 2020 2020  ecretLocal..    
-00005a90: 676c 6f62 616c 2067 4f72 6967 696e 4c6f  global gOriginLo
-00005aa0: 6361 6c4f 5341 4953 0d0a 2020 2020 676c  calOSAIS..    gl
-00005ab0: 6f62 616c 2067 4973 4c6f 6361 6c0d 0a0d  obal gIsLocal...
-00005ac0: 0a20 2020 2068 6561 6465 7273 203d 207b  .    headers = {
-00005ad0: 0d0a 2020 2020 2020 2020 2243 6f6e 7465  ..        "Conte
-00005ae0: 6e74 2d54 7970 6522 3a20 2761 7070 6c69  nt-Type": 'appli
-00005af0: 6361 7469 6f6e 2f6a 736f 6e27 2c20 0d0a  cation/json', ..
-00005b00: 2020 2020 2020 2020 2741 6363 6570 7427          'Accept'
-00005b10: 3a20 2774 6578 742f 706c 6169 6e27 2c0d  : 'text/plain',.
-00005b20: 0a20 2020 207d 0d0a 2020 2020 6f62 6a50  .    }..    objP
-00005b30: 6172 616d 3d5f 6765 7446 756c 6c43 6f6e  aram=_getFullCon
-00005b40: 6669 6728 674e 616d 6529 0d0a 0d0a 2020  fig(gName)....  
-00005b50: 2020 2323 2072 6567 2077 6974 6820 5072    ## reg with Pr
-00005b60: 6f64 0d0a 2020 2020 6966 2067 4973 4c6f  od..    if gIsLo
-00005b70: 6361 6c3d 3d46 616c 7365 3a0d 0a20 2020  cal==False:..   
-00005b80: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-00005b90: 2020 2020 2020 2072 6573 706f 6e73 6520         response 
-00005ba0: 3d20 7265 7175 6573 7473 2e70 6f73 7428  = requests.post(
-00005bb0: 6622 7b67 4f72 6967 696e 4f53 4149 537d  f"{gOriginOSAIS}
-00005bc0: 6170 692f 7631 2f70 7562 6c69 632f 7669  api/v1/public/vi
-00005bd0: 7274 7561 6c61 692f 7265 6769 7374 6572  rtualai/register
-00005be0: 222c 2068 6561 6465 7273 3d68 6561 6465  ", headers=heade
-00005bf0: 7273 2c20 6461 7461 3d6a 736f 6e2e 6475  rs, data=json.du
-00005c00: 6d70 7328 6f62 6a50 6172 616d 2929 0d0a  mps(objParam))..
-00005c10: 2020 2020 2020 2020 2020 2020 6f62 6a52              objR
-00005c20: 6573 3d72 6573 706f 6e73 652e 6a73 6f6e  es=response.json
-00005c30: 2829 5b22 6461 7461 225d 0d0a 2020 2020  ()["data"]..    
-00005c40: 2020 2020 2020 2020 6966 206f 626a 5265          if objRe
-00005c50: 7320 6973 204e 6f6e 653a 0d0a 2020 2020  s is None:..    
-00005c60: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00005c70: 7428 2243 4f55 4c44 204e 4f54 2052 4547  t("COULD NOT REG
-00005c80: 4953 5445 522c 2073 746f 7070 696e 6720  ISTER, stopping 
-00005c90: 6974 2068 6572 6522 290d 0a20 2020 2020  it here")..     
-00005ca0: 2020 2020 2020 2020 2020 2073 7973 2e65             sys.e
-00005cb0: 7869 7428 290d 0a0d 0a20 2020 2020 2020  xit()....       
-00005cc0: 2020 2020 2067 546f 6b65 6e3d 6f62 6a52       gToken=objR
-00005cd0: 6573 5b22 746f 6b65 6e22 5d0d 0a20 2020  es["token"]..   
-00005ce0: 2020 2020 2020 2020 2067 5365 6372 6574           gSecret
-00005cf0: 3d6f 626a 5265 735b 2273 6563 7265 7422  =objRes["secret"
-00005d00: 5d0d 0a20 2020 2020 2020 2020 2020 2070  ]..            p
-00005d10: 7269 6e74 2822 5765 2061 7265 2052 4547  rint("We are REG
-00005d20: 4953 5445 5245 4420 7769 7468 204f 5341  ISTERED with OSA
-00005d30: 4953 2050 726f 6422 290d 0a20 2020 2020  IS Prod")..     
-00005d40: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
-00005d50: 696f 6e20 6173 2065 7272 3a0d 0a20 2020  ion as err:..   
-00005d60: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-00005d70: 4352 4954 4943 414c 3a20 222b 6572 722e  CRITICAL: "+err.
-00005d80: 6d73 6729 0d0a 2020 2020 2020 2020 2020  msg)..          
-00005d90: 2020 7261 6973 6520 6572 720d 0a0d 0a20    raise err.... 
-00005da0: 2020 2023 2320 7265 6720 7769 7468 204c     ## reg with L
-00005db0: 6f63 616c 204f 5341 4953 2028 6465 6275  ocal OSAIS (debu
-00005dc0: 6729 0d0a 2020 2020 656c 7365 3a0d 0a20  g)..    else:.. 
-00005dd0: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
-00005de0: 2020 2020 2020 2020 2072 6573 706f 6e73           respons
-00005df0: 6520 3d20 7265 7175 6573 7473 2e70 6f73  e = requests.pos
-00005e00: 7428 6622 7b67 4f72 6967 696e 4c6f 6361  t(f"{gOriginLoca
-00005e10: 6c4f 5341 4953 7d61 7069 2f76 312f 7075  lOSAIS}api/v1/pu
-00005e20: 626c 6963 2f76 6972 7475 616c 6169 2f72  blic/virtualai/r
-00005e30: 6567 6973 7465 7222 2c20 6865 6164 6572  egister", header
-00005e40: 733d 6865 6164 6572 732c 2064 6174 613d  s=headers, data=
-00005e50: 6a73 6f6e 2e64 756d 7073 286f 626a 5061  json.dumps(objPa
-00005e60: 7261 6d29 290d 0a20 2020 2020 2020 2020  ram))..         
-00005e70: 2020 206f 626a 5265 733d 7265 7370 6f6e     objRes=respon
-00005e80: 7365 2e6a 736f 6e28 295b 2264 6174 6122  se.json()["data"
-00005e90: 5d0d 0a20 2020 2020 2020 2020 2020 2069  ]..            i
-00005ea0: 6620 6f62 6a52 6573 2069 7320 4e6f 6e65  f objRes is None
-00005eb0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00005ec0: 2020 2070 7269 6e74 2822 434f 554c 4420     print("COULD 
-00005ed0: 4e4f 5420 5245 4749 5354 4552 2077 6974  NOT REGISTER wit
-00005ee0: 6820 6465 6275 6722 290d 0a0d 0a20 2020  h debug")....   
-00005ef0: 2020 2020 2020 2020 2067 546f 6b65 6e4c           gTokenL
-00005f00: 6f63 616c 3d6f 626a 5265 735b 2274 6f6b  ocal=objRes["tok
-00005f10: 656e 225d 0d0a 2020 2020 2020 2020 2020  en"]..          
-00005f20: 2020 6753 6563 7265 744c 6f63 616c 3d6f    gSecretLocal=o
-00005f30: 626a 5265 735b 2273 6563 7265 7422 5d0d  bjRes["secret"].
-00005f40: 0a20 2020 2020 2020 2020 2020 2070 7269  .            pri
-00005f50: 6e74 2822 5765 2061 7265 2052 4547 4953  nt("We are REGIS
-00005f60: 5445 5245 4420 7769 7468 204f 5341 4953  TERED with OSAIS
-00005f70: 204c 6f63 616c 2028 6465 6275 6729 2229   Local (debug)")
-00005f80: 0d0a 2020 2020 2020 2020 6578 6365 7074  ..        except
-00005f90: 2045 7863 6570 7469 6f6e 2061 7320 6572   Exception as er
-00005fa0: 723a 0d0a 2020 2020 2020 2020 2020 2020  r:..            
-00005fb0: 7072 696e 7428 2243 5249 5449 4341 4c3a  print("CRITICAL:
-00005fc0: 2022 2b65 7272 2e6d 7367 290d 0a20 2020   "+err.msg)..   
-00005fd0: 2020 2020 2020 2020 2072 6169 7365 2065           raise e
-00005fe0: 7272 0d0a 0d0a 2020 2020 7265 7475 726e  rr....    return
-00005ff0: 2054 7275 650d 0a0d 0a23 2041 7574 6865   True....# Authe
-00006000: 6e74 6963 6174 6520 696e 746f 204f 5341  nticate into OSA
-00006010: 4953 0d0a 6465 6620 5f6c 6f67 696e 5641  IS..def _loginVA
-00006020: 4928 293a 0d0a 2020 2020 676c 6f62 616c  I():..    global
-00006030: 2067 546f 6b65 6e0d 0a20 2020 2067 6c6f   gToken..    glo
-00006040: 6261 6c20 6753 6563 7265 740d 0a20 2020  bal gSecret..   
-00006050: 2067 6c6f 6261 6c20 6741 7574 6854 6f6b   global gAuthTok
-00006060: 656e 0d0a 2020 2020 676c 6f62 616c 2067  en..    global g
-00006070: 546f 6b65 6e4c 6f63 616c 0d0a 2020 2020  TokenLocal..    
-00006080: 676c 6f62 616c 2067 5365 6372 6574 4c6f  global gSecretLo
-00006090: 6361 6c0d 0a20 2020 2067 6c6f 6261 6c20  cal..    global 
-000060a0: 6741 7574 6854 6f6b 656e 4c6f 6361 6c0d  gAuthTokenLocal.
-000060b0: 0a0d 0a20 2020 2068 6561 6465 7273 203d  ...    headers =
-000060c0: 207b 0d0a 2020 2020 2020 2020 2243 6f6e   {..        "Con
-000060d0: 7465 6e74 2d54 7970 6522 3a20 2261 7070  tent-Type": "app
-000060e0: 6c69 6361 7469 6f6e 2f6a 736f 6e22 0d0a  lication/json"..
-000060f0: 2020 2020 7d0d 0a0d 0a20 2020 2069 6620      }....    if 
-00006100: 6754 6f6b 656e 213d 204e 6f6e 653a 0d0a  gToken!= None:..
-00006110: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
-00006120: 2020 2020 2020 2020 2020 7265 7370 6f6e            respon
-00006130: 7365 203d 2072 6571 7565 7374 732e 706f  se = requests.po
-00006140: 7374 2866 227b 674f 7269 6769 6e4f 5341  st(f"{gOriginOSA
-00006150: 4953 7d61 7069 2f76 312f 7075 626c 6963  IS}api/v1/public
-00006160: 2f76 6972 7475 616c 6169 2f6c 6f67 696e  /virtualai/login
-00006170: 222c 2068 6561 6465 7273 3d68 6561 6465  ", headers=heade
-00006180: 7273 2c20 6461 7461 3d6a 736f 6e2e 6475  rs, data=json.du
-00006190: 6d70 7328 7b0d 0a20 2020 2020 2020 2020  mps({..         
-000061a0: 2020 2020 2020 2022 746f 6b65 6e22 3a20         "token": 
-000061b0: 6754 6f6b 656e 2c0d 0a20 2020 2020 2020  gToken,..       
-000061c0: 2020 2020 2020 2020 2022 7365 6372 6574           "secret
-000061d0: 223a 2067 5365 6372 6574 0d0a 2020 2020  ": gSecret..    
-000061e0: 2020 2020 2020 2020 7d29 290d 0a0d 0a20          })).... 
-000061f0: 2020 2020 2020 2020 2020 206f 626a 5265             objRe
-00006200: 733d 7265 7370 6f6e 7365 2e6a 736f 6e28  s=response.json(
-00006210: 295b 2264 6174 6122 5d0d 0a20 2020 2020  )["data"]..     
-00006220: 2020 2020 2020 2069 6620 6f62 6a52 6573         if objRes
-00006230: 2069 7320 4e6f 6e65 3a0d 0a20 2020 2020   is None:..     
-00006240: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00006250: 2822 434f 554c 4420 4e4f 5420 4c4f 4749  ("COULD NOT LOGI
-00006260: 4e2c 2073 746f 7070 696e 6720 6974 2068  N, stopping it h
-00006270: 6572 6522 290d 0a20 2020 2020 2020 2020  ere")..         
-00006280: 2020 2020 2020 2073 7973 2e65 7869 7428         sys.exit(
-00006290: 290d 0a20 2020 2020 2020 2020 2020 2070  )..            p
-000062a0: 7269 6e74 2822 5765 2067 6f74 2061 6e20  rint("We got an 
-000062b0: 6175 7468 656e 7469 6361 7469 6f6e 2074  authentication t
-000062c0: 6f6b 656e 2069 6e74 6f20 4f53 4149 5322  oken into OSAIS"
-000062d0: 290d 0a20 2020 2020 2020 2020 2020 2067  )..            g
-000062e0: 4175 7468 546f 6b65 6e3d 6f62 6a52 6573  AuthToken=objRes
-000062f0: 5b22 6175 7468 546f 6b65 6e22 5d20 2020  ["authToken"]   
-00006300: 200d 0a20 2020 2020 2020 2065 7863 6570   ..        excep
-00006310: 7420 4578 6365 7074 696f 6e20 6173 2065  t Exception as e
-00006320: 7272 3a0d 0a20 2020 2020 2020 2020 2020  rr:..           
-00006330: 2070 7269 6e74 2822 4352 4954 4943 414c   print("CRITICAL
-00006340: 3a20 222b 6572 722e 6d73 6729 0d0a 2020  : "+err.msg)..  
-00006350: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00006360: 6572 720d 0a0d 0a20 2020 2069 6620 6754  err....    if gT
-00006370: 6f6b 656e 4c6f 6361 6c21 3d20 4e6f 6e65  okenLocal!= None
-00006380: 3a0d 0a20 2020 2020 2020 2074 7279 3a0d  :..        try:.
-00006390: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-000063a0: 706f 6e73 6520 3d20 7265 7175 6573 7473  ponse = requests
-000063b0: 2e70 6f73 7428 6622 7b67 4f72 6967 696e  .post(f"{gOrigin
-000063c0: 4c6f 6361 6c4f 5341 4953 7d61 7069 2f76  LocalOSAIS}api/v
-000063d0: 312f 7075 626c 6963 2f76 6972 7475 616c  1/public/virtual
-000063e0: 6169 2f6c 6f67 696e 222c 2068 6561 6465  ai/login", heade
-000063f0: 7273 3d68 6561 6465 7273 2c20 6461 7461  rs=headers, data
-00006400: 3d6a 736f 6e2e 6475 6d70 7328 7b0d 0a20  =json.dumps({.. 
-00006410: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00006420: 746f 6b65 6e22 3a20 6754 6f6b 656e 4c6f  token": gTokenLo
-00006430: 6361 6c2c 0d0a 2020 2020 2020 2020 2020  cal,..          
-00006440: 2020 2020 2020 2273 6563 7265 7422 3a20        "secret": 
-00006450: 6753 6563 7265 744c 6f63 616c 0d0a 2020  gSecretLocal..  
-00006460: 2020 2020 2020 2020 2020 7d29 290d 0a0d            }))...
-00006470: 0a20 2020 2020 2020 2020 2020 206f 626a  .            obj
-00006480: 5265 733d 7265 7370 6f6e 7365 2e6a 736f  Res=response.jso
-00006490: 6e28 295b 2264 6174 6122 5d0d 0a20 2020  n()["data"]..   
-000064a0: 2020 2020 2020 2020 2069 6620 6f62 6a52           if objR
-000064b0: 6573 2069 7320 4e6f 6e65 3a0d 0a20 2020  es is None:..   
-000064c0: 2020 2020 2020 2020 2020 2020 2070 7269               pri
-000064d0: 6e74 2822 434f 554c 4420 4e4f 5420 4c4f  nt("COULD NOT LO
-000064e0: 4749 4e20 696e 746f 204f 5341 4953 204c  GIN into OSAIS L
-000064f0: 6f63 616c 2229 0d0a 2020 2020 2020 2020  ocal")..        
-00006500: 2020 2020 7072 696e 7428 2257 6520 676f      print("We go
-00006510: 7420 616e 2061 7574 6865 6e74 6963 6174  t an authenticat
-00006520: 696f 6e20 746f 6b65 6e20 696e 746f 204f  ion token into O
-00006530: 5341 4953 204c 6f63 616c 2028 6465 6275  SAIS Local (debu
-00006540: 6729 2229 0d0a 2020 2020 2020 2020 2020  g)")..          
-00006550: 2020 6741 7574 6854 6f6b 656e 4c6f 6361    gAuthTokenLoca
-00006560: 6c3d 6f62 6a52 6573 5b22 6175 7468 546f  l=objRes["authTo
-00006570: 6b65 6e22 5d20 2020 200d 0a20 2020 2020  ken"]    ..     
-00006580: 2020 2065 7863 6570 7420 4578 6365 7074     except Except
-00006590: 696f 6e20 6173 2065 7272 3a0d 0a20 2020  ion as err:..   
-000065a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000065b0: 5472 7565 0d0a 0d0a 2020 2020 7265 7475  True....    retu
-000065c0: 726e 2054 7275 650d 0a0d 0a0d 0a23 2320  rn True......## 
-000065d0: 5055 424c 4943 202d 2041 7574 6865 6e74  PUBLIC - Authent
-000065e0: 6963 6174 6520 7468 6520 5669 7274 7561  icate the Virtua
-000065f0: 6c20 4149 2069 6e74 6f20 4f53 4149 530d  l AI into OSAIS.
-00006600: 0a64 6566 206f 7361 6973 5f61 7574 6865  .def osais_authe
-00006610: 6e74 6963 6174 6541 4928 293a 0d0a 2020  nticateAI():..  
-00006620: 2020 676c 6f62 616c 2067 4973 5669 7274    global gIsVirt
-00006630: 7561 6c41 490d 0a20 2020 2067 6c6f 6261  ualAI..    globa
-00006640: 6c20 674f 7269 6769 6e4f 5341 4953 0d0a  l gOriginOSAIS..
-00006650: 2020 2020 676c 6f62 616c 2067 4973 5363      global gIsSc
-00006660: 6865 6475 6c65 640d 0a20 2020 200d 0a20  heduled..    .. 
-00006670: 2020 2052 6573 703d 7b22 6461 7461 223a     Resp={"data":
-00006680: 204e 6f6e 657d 0d0a 2020 2020 6966 2067   None}..    if g
-00006690: 4973 5669 7274 7561 6c41 493a 0d0a 0d0a  IsVirtualAI:....
-000066a0: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
-000066b0: 2020 2020 2020 2020 2020 7265 7370 3d20            resp= 
-000066c0: 5f72 6567 6973 7465 7256 4149 2829 0d0a  _registerVAI()..
-000066d0: 2020 2020 2020 2020 2020 2020 7265 7370              resp
-000066e0: 3d5f 6c6f 6769 6e56 4149 2829 0d0a 2020  =_loginVAI()..  
-000066f0: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
-00006700: 6570 7469 6f6e 2061 7320 6572 723a 0d0a  eption as err:..
-00006710: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00006720: 7428 2243 5249 5449 4341 4c3a 2022 2b65  t("CRITICAL: "+e
-00006730: 7272 2e6d 7367 290d 0a20 2020 2020 2020  rr.msg)..       
-00006740: 2020 2020 2072 6169 7365 2065 7272 0d0a       raise err..
-00006750: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00006760: 2020 2320 5275 6e20 7468 6520 7363 6865    # Run the sche
-00006770: 6475 6c65 720d 0a20 2020 2020 2020 2069  duler..        i
-00006780: 6620 6749 7353 6368 6564 756c 6564 3d3d  f gIsScheduled==
-00006790: 4661 6c73 653a 0d0a 2020 2020 2020 2020  False:..        
-000067a0: 2020 2020 6749 7353 6368 6564 756c 6564      gIsScheduled
-000067b0: 3d54 7275 650d 0a20 2020 2020 2020 2020  =True..         
-000067c0: 2020 2073 6368 6564 756c 652e 6576 6572     schedule.ever
-000067d0: 7928 292e 6461 792e 6174 2822 3130 3a33  y().day.at("10:3
-000067e0: 3022 292e 646f 285f 6c6f 6769 6e56 4149  0").do(_loginVAI
-000067f0: 290d 0a0d 0a20 2020 2072 6574 7572 6e20  )....    return 
-00006800: 7265 7370 0d0a 0d0a 2323 202d 2d2d 2d2d  resp....## -----
-00006810: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006820: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006830: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006840: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006850: 2d2d 2d0d 0a23 2020 2020 2020 2052 756e  ---..#       Run
-00006860: 2074 6865 2041 490d 0a23 2320 2d2d 2d2d   the AI..## ----
-00006870: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006880: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00006890: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000059d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2320  ------------..# 
+000059e0: 2020 2020 2020 6175 7468 656e 7469 6361        authentica
+000059f0: 7465 2069 6e74 6f20 4f53 4149 5320 6173  te into OSAIS as
+00005a00: 2076 6972 7475 616c 2041 490d 0a23 2320   virtual AI..## 
+00005a10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005a20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005a30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005a40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00005a50: 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a 2320 5265  --------....# Re
+00005a60: 6769 7374 6572 206f 7572 2056 4149 2069  gister our VAI i
+00005a70: 6e74 6f20 4f53 4149 530d 0a64 6566 205f  nto OSAIS..def _
+00005a80: 7265 6769 7374 6572 5641 4928 293a 0d0a  registerVAI():..
+00005a90: 2020 2020 676c 6f62 616c 2067 4e61 6d65      global gName
+00005aa0: 0d0a 2020 2020 676c 6f62 616c 2067 546f  ..    global gTo
+00005ab0: 6b65 6e0d 0a20 2020 2067 6c6f 6261 6c20  ken..    global 
+00005ac0: 6753 6563 7265 740d 0a20 2020 2067 6c6f  gSecret..    glo
+00005ad0: 6261 6c20 674f 7269 6769 6e4f 5341 4953  bal gOriginOSAIS
+00005ae0: 0d0a 2020 2020 676c 6f62 616c 2067 546f  ..    global gTo
+00005af0: 6b65 6e4c 6f63 616c 0d0a 2020 2020 676c  kenLocal..    gl
+00005b00: 6f62 616c 2067 5365 6372 6574 4c6f 6361  obal gSecretLoca
+00005b10: 6c0d 0a20 2020 2067 6c6f 6261 6c20 674f  l..    global gO
+00005b20: 7269 6769 6e4c 6f63 616c 4f53 4149 530d  riginLocalOSAIS.
+00005b30: 0a20 2020 2067 6c6f 6261 6c20 6749 734c  .    global gIsL
+00005b40: 6f63 616c 0d0a 0d0a 2020 2020 6865 6164  ocal....    head
+00005b50: 6572 7320 3d20 7b0d 0a20 2020 2020 2020  ers = {..       
+00005b60: 2022 436f 6e74 656e 742d 5479 7065 223a   "Content-Type":
+00005b70: 2027 6170 706c 6963 6174 696f 6e2f 6a73   'application/js
+00005b80: 6f6e 272c 200d 0a20 2020 2020 2020 2027  on', ..        '
+00005b90: 4163 6365 7074 273a 2027 7465 7874 2f70  Accept': 'text/p
+00005ba0: 6c61 696e 272c 0d0a 2020 2020 7d0d 0a20  lain',..    }.. 
+00005bb0: 2020 206f 626a 5061 7261 6d3d 5f67 6574     objParam=_get
+00005bc0: 4675 6c6c 436f 6e66 6967 2867 4e61 6d65  FullConfig(gName
+00005bd0: 290d 0a0d 0a20 2020 2023 2320 7265 6720  )....    ## reg 
+00005be0: 7769 7468 2050 726f 640d 0a20 2020 2069  with Prod..    i
+00005bf0: 6620 6749 734c 6f63 616c 3d3d 4661 6c73  f gIsLocal==Fals
+00005c00: 653a 0d0a 2020 2020 2020 2020 7472 793a  e:..        try:
+00005c10: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00005c20: 7370 6f6e 7365 203d 2072 6571 7565 7374  sponse = request
+00005c30: 732e 706f 7374 2866 227b 674f 7269 6769  s.post(f"{gOrigi
+00005c40: 6e4f 5341 4953 7d61 7069 2f76 312f 7075  nOSAIS}api/v1/pu
+00005c50: 626c 6963 2f76 6972 7475 616c 6169 2f72  blic/virtualai/r
+00005c60: 6567 6973 7465 7222 2c20 6865 6164 6572  egister", header
+00005c70: 733d 6865 6164 6572 732c 2064 6174 613d  s=headers, data=
+00005c80: 6a73 6f6e 2e64 756d 7073 286f 626a 5061  json.dumps(objPa
+00005c90: 7261 6d29 290d 0a20 2020 2020 2020 2020  ram))..         
+00005ca0: 2020 206f 626a 5265 733d 7265 7370 6f6e     objRes=respon
+00005cb0: 7365 2e6a 736f 6e28 295b 2264 6174 6122  se.json()["data"
+00005cc0: 5d0d 0a20 2020 2020 2020 2020 2020 2069  ]..            i
+00005cd0: 6620 6f62 6a52 6573 2069 7320 4e6f 6e65  f objRes is None
+00005ce0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00005cf0: 2020 2070 7269 6e74 2822 434f 554c 4420     print("COULD 
+00005d00: 4e4f 5420 5245 4749 5354 4552 2c20 7374  NOT REGISTER, st
+00005d10: 6f70 7069 6e67 2069 7420 6865 7265 2229  opping it here")
+00005d20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00005d30: 2020 7379 732e 6578 6974 2829 0d0a 0d0a    sys.exit()....
+00005d40: 2020 2020 2020 2020 2020 2020 6754 6f6b              gTok
+00005d50: 656e 3d6f 626a 5265 735b 2274 6f6b 656e  en=objRes["token
+00005d60: 225d 0d0a 2020 2020 2020 2020 2020 2020  "]..            
+00005d70: 6753 6563 7265 743d 6f62 6a52 6573 5b22  gSecret=objRes["
+00005d80: 7365 6372 6574 225d 0d0a 2020 2020 2020  secret"]..      
+00005d90: 2020 2020 2020 7072 696e 7428 2257 6520        print("We 
+00005da0: 6172 6520 5245 4749 5354 4552 4544 2077  are REGISTERED w
+00005db0: 6974 6820 4f53 4149 5320 5072 6f64 2229  ith OSAIS Prod")
+00005dc0: 0d0a 2020 2020 2020 2020 6578 6365 7074  ..        except
+00005dd0: 2045 7863 6570 7469 6f6e 2061 7320 6572   Exception as er
+00005de0: 723a 0d0a 2020 2020 2020 2020 2020 2020  r:..            
+00005df0: 7072 696e 7428 2243 5249 5449 4341 4c3a  print("CRITICAL:
+00005e00: 2022 2b65 7272 2e6d 7367 290d 0a20 2020   "+err.msg)..   
+00005e10: 2020 2020 2020 2020 2072 6169 7365 2065           raise e
+00005e20: 7272 0d0a 0d0a 2020 2020 2323 2072 6567  rr....    ## reg
+00005e30: 2077 6974 6820 4c6f 6361 6c20 4f53 4149   with Local OSAI
+00005e40: 5320 2864 6562 7567 290d 0a20 2020 2065  S (debug)..    e
+00005e50: 6c73 653a 0d0a 2020 2020 2020 2020 7472  lse:..        tr
+00005e60: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
+00005e70: 7265 7370 6f6e 7365 203d 2072 6571 7565  response = reque
+00005e80: 7374 732e 706f 7374 2866 227b 674f 7269  sts.post(f"{gOri
+00005e90: 6769 6e4c 6f63 616c 4f53 4149 537d 6170  ginLocalOSAIS}ap
+00005ea0: 692f 7631 2f70 7562 6c69 632f 7669 7274  i/v1/public/virt
+00005eb0: 7561 6c61 692f 7265 6769 7374 6572 222c  ualai/register",
+00005ec0: 2068 6561 6465 7273 3d68 6561 6465 7273   headers=headers
+00005ed0: 2c20 6461 7461 3d6a 736f 6e2e 6475 6d70  , data=json.dump
+00005ee0: 7328 6f62 6a50 6172 616d 2929 0d0a 2020  s(objParam))..  
+00005ef0: 2020 2020 2020 2020 2020 6f62 6a52 6573            objRes
+00005f00: 3d72 6573 706f 6e73 652e 6a73 6f6e 2829  =response.json()
+00005f10: 5b22 6461 7461 225d 0d0a 2020 2020 2020  ["data"]..      
+00005f20: 2020 2020 2020 6966 206f 626a 5265 7320        if objRes 
+00005f30: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
+00005f40: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00005f50: 2243 4f55 4c44 204e 4f54 2052 4547 4953  "COULD NOT REGIS
+00005f60: 5445 5220 7769 7468 2064 6562 7567 2229  TER with debug")
+00005f70: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00005f80: 6754 6f6b 656e 4c6f 6361 6c3d 6f62 6a52  gTokenLocal=objR
+00005f90: 6573 5b22 746f 6b65 6e22 5d0d 0a20 2020  es["token"]..   
+00005fa0: 2020 2020 2020 2020 2067 5365 6372 6574           gSecret
+00005fb0: 4c6f 6361 6c3d 6f62 6a52 6573 5b22 7365  Local=objRes["se
+00005fc0: 6372 6574 225d 0d0a 2020 2020 2020 2020  cret"]..        
+00005fd0: 2020 2020 7072 696e 7428 2257 6520 6172      print("We ar
+00005fe0: 6520 5245 4749 5354 4552 4544 2077 6974  e REGISTERED wit
+00005ff0: 6820 4f53 4149 5320 4c6f 6361 6c20 2864  h OSAIS Local (d
+00006000: 6562 7567 2922 290d 0a20 2020 2020 2020  ebug)")..       
+00006010: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
+00006020: 6e20 6173 2065 7272 3a0d 0a20 2020 2020  n as err:..     
+00006030: 2020 2020 2020 2070 7269 6e74 2822 4352         print("CR
+00006040: 4954 4943 414c 3a20 222b 6572 722e 6d73  ITICAL: "+err.ms
+00006050: 6729 0d0a 2020 2020 2020 2020 2020 2020  g)..            
+00006060: 7261 6973 6520 6572 720d 0a0d 0a20 2020  raise err....   
+00006070: 2072 6574 7572 6e20 5472 7565 0d0a 0d0a   return True....
+00006080: 2320 4175 7468 656e 7469 6361 7465 2069  # Authenticate i
+00006090: 6e74 6f20 4f53 4149 530d 0a64 6566 205f  nto OSAIS..def _
+000060a0: 6c6f 6769 6e56 4149 2829 3a0d 0a20 2020  loginVAI():..   
+000060b0: 2067 6c6f 6261 6c20 6754 6f6b 656e 0d0a   global gToken..
+000060c0: 2020 2020 676c 6f62 616c 2067 5365 6372      global gSecr
+000060d0: 6574 0d0a 2020 2020 676c 6f62 616c 2067  et..    global g
+000060e0: 4175 7468 546f 6b65 6e0d 0a20 2020 2067  AuthToken..    g
+000060f0: 6c6f 6261 6c20 6754 6f6b 656e 4c6f 6361  lobal gTokenLoca
+00006100: 6c0d 0a20 2020 2067 6c6f 6261 6c20 6753  l..    global gS
+00006110: 6563 7265 744c 6f63 616c 0d0a 2020 2020  ecretLocal..    
+00006120: 676c 6f62 616c 2067 4175 7468 546f 6b65  global gAuthToke
+00006130: 6e4c 6f63 616c 0d0a 0d0a 2020 2020 6865  nLocal....    he
+00006140: 6164 6572 7320 3d20 7b0d 0a20 2020 2020  aders = {..     
+00006150: 2020 2022 436f 6e74 656e 742d 5479 7065     "Content-Type
+00006160: 223a 2022 6170 706c 6963 6174 696f 6e2f  ": "application/
+00006170: 6a73 6f6e 220d 0a20 2020 207d 0d0a 0d0a  json"..    }....
+00006180: 2020 2020 6966 2067 546f 6b65 6e21 3d20      if gToken!= 
+00006190: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2074  None:..        t
+000061a0: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
+000061b0: 2072 6573 706f 6e73 6520 3d20 7265 7175   response = requ
+000061c0: 6573 7473 2e70 6f73 7428 6622 7b67 4f72  ests.post(f"{gOr
+000061d0: 6967 696e 4f53 4149 537d 6170 692f 7631  iginOSAIS}api/v1
+000061e0: 2f70 7562 6c69 632f 7669 7274 7561 6c61  /public/virtuala
+000061f0: 692f 6c6f 6769 6e22 2c20 6865 6164 6572  i/login", header
+00006200: 733d 6865 6164 6572 732c 2064 6174 613d  s=headers, data=
+00006210: 6a73 6f6e 2e64 756d 7073 287b 0d0a 2020  json.dumps({..  
+00006220: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+00006230: 6f6b 656e 223a 2067 546f 6b65 6e2c 0d0a  oken": gToken,..
+00006240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006250: 2273 6563 7265 7422 3a20 6753 6563 7265  "secret": gSecre
+00006260: 740d 0a20 2020 2020 2020 2020 2020 207d  t..            }
+00006270: 2929 0d0a 0d0a 2020 2020 2020 2020 2020  ))....          
+00006280: 2020 6f62 6a52 6573 3d72 6573 706f 6e73    objRes=respons
+00006290: 652e 6a73 6f6e 2829 5b22 6461 7461 225d  e.json()["data"]
+000062a0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+000062b0: 206f 626a 5265 7320 6973 204e 6f6e 653a   objRes is None:
+000062c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000062d0: 2020 7072 696e 7428 2243 4f55 4c44 204e    print("COULD N
+000062e0: 4f54 204c 4f47 494e 2c20 7374 6f70 7069  OT LOGIN, stoppi
+000062f0: 6e67 2069 7420 6865 7265 2229 0d0a 2020  ng it here")..  
+00006300: 2020 2020 2020 2020 2020 2020 2020 7379                sy
+00006310: 732e 6578 6974 2829 0d0a 2020 2020 2020  s.exit()..      
+00006320: 2020 2020 2020 7072 696e 7428 2257 6520        print("We 
+00006330: 676f 7420 616e 2061 7574 6865 6e74 6963  got an authentic
+00006340: 6174 696f 6e20 746f 6b65 6e20 696e 746f  ation token into
+00006350: 204f 5341 4953 2229 0d0a 2020 2020 2020   OSAIS")..      
+00006360: 2020 2020 2020 6741 7574 6854 6f6b 656e        gAuthToken
+00006370: 3d6f 626a 5265 735b 2261 7574 6854 6f6b  =objRes["authTok
+00006380: 656e 225d 2020 2020 0d0a 2020 2020 2020  en"]    ..      
+00006390: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
+000063a0: 6f6e 2061 7320 6572 723a 0d0a 2020 2020  on as err:..    
+000063b0: 2020 2020 2020 2020 7072 696e 7428 2243          print("C
+000063c0: 5249 5449 4341 4c3a 2022 2b65 7272 2e6d  RITICAL: "+err.m
+000063d0: 7367 290d 0a20 2020 2020 2020 2020 2020  sg)..           
+000063e0: 2072 6169 7365 2065 7272 0d0a 0d0a 2020   raise err....  
+000063f0: 2020 6966 2067 546f 6b65 6e4c 6f63 616c    if gTokenLocal
+00006400: 213d 204e 6f6e 653a 0d0a 2020 2020 2020  != None:..      
+00006410: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
+00006420: 2020 2020 7265 7370 6f6e 7365 203d 2072      response = r
+00006430: 6571 7565 7374 732e 706f 7374 2866 227b  equests.post(f"{
+00006440: 674f 7269 6769 6e4c 6f63 616c 4f53 4149  gOriginLocalOSAI
+00006450: 537d 6170 692f 7631 2f70 7562 6c69 632f  S}api/v1/public/
+00006460: 7669 7274 7561 6c61 692f 6c6f 6769 6e22  virtualai/login"
+00006470: 2c20 6865 6164 6572 733d 6865 6164 6572  , headers=header
+00006480: 732c 2064 6174 613d 6a73 6f6e 2e64 756d  s, data=json.dum
+00006490: 7073 287b 0d0a 2020 2020 2020 2020 2020  ps({..          
+000064a0: 2020 2020 2020 2274 6f6b 656e 223a 2067        "token": g
+000064b0: 546f 6b65 6e4c 6f63 616c 2c0d 0a20 2020  TokenLocal,..   
+000064c0: 2020 2020 2020 2020 2020 2020 2022 7365               "se
+000064d0: 6372 6574 223a 2067 5365 6372 6574 4c6f  cret": gSecretLo
+000064e0: 6361 6c0d 0a20 2020 2020 2020 2020 2020  cal..           
+000064f0: 207d 2929 0d0a 0d0a 2020 2020 2020 2020   }))....        
+00006500: 2020 2020 6f62 6a52 6573 3d72 6573 706f      objRes=respo
+00006510: 6e73 652e 6a73 6f6e 2829 5b22 6461 7461  nse.json()["data
+00006520: 225d 0d0a 2020 2020 2020 2020 2020 2020  "]..            
+00006530: 6966 206f 626a 5265 7320 6973 204e 6f6e  if objRes is Non
+00006540: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00006550: 2020 2020 7072 696e 7428 2243 4f55 4c44      print("COULD
+00006560: 204e 4f54 204c 4f47 494e 2069 6e74 6f20   NOT LOGIN into 
+00006570: 4f53 4149 5320 4c6f 6361 6c22 290d 0a20  OSAIS Local").. 
+00006580: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00006590: 2822 5765 2067 6f74 2061 6e20 6175 7468  ("We got an auth
+000065a0: 656e 7469 6361 7469 6f6e 2074 6f6b 656e  entication token
+000065b0: 2069 6e74 6f20 4f53 4149 5320 4c6f 6361   into OSAIS Loca
+000065c0: 6c20 2864 6562 7567 2922 290d 0a20 2020  l (debug)")..   
+000065d0: 2020 2020 2020 2020 2067 4175 7468 546f           gAuthTo
+000065e0: 6b65 6e4c 6f63 616c 3d6f 626a 5265 735b  kenLocal=objRes[
+000065f0: 2261 7574 6854 6f6b 656e 225d 2020 2020  "authToken"]    
+00006600: 0d0a 2020 2020 2020 2020 6578 6365 7074  ..        except
+00006610: 2045 7863 6570 7469 6f6e 2061 7320 6572   Exception as er
+00006620: 723a 0d0a 2020 2020 2020 2020 2020 2020  r:..            
+00006630: 7265 7475 726e 2054 7275 650d 0a0d 0a20  return True.... 
+00006640: 2020 2072 6574 7572 6e20 5472 7565 0d0a     return True..
+00006650: 0d0a 0d0a 2323 2050 5542 4c49 4320 2d20  ....## PUBLIC - 
+00006660: 4175 7468 656e 7469 6361 7465 2074 6865  Authenticate the
+00006670: 2056 6972 7475 616c 2041 4920 696e 746f   Virtual AI into
+00006680: 204f 5341 4953 0d0a 6465 6620 6f73 6169   OSAIS..def osai
+00006690: 735f 6175 7468 656e 7469 6361 7465 4149  s_authenticateAI
+000066a0: 2829 3a0d 0a20 2020 2067 6c6f 6261 6c20  ():..    global 
+000066b0: 6749 7356 6972 7475 616c 4149 0d0a 2020  gIsVirtualAI..  
+000066c0: 2020 676c 6f62 616c 2067 4f72 6967 696e    global gOrigin
+000066d0: 4f53 4149 530d 0a20 2020 2067 6c6f 6261  OSAIS..    globa
+000066e0: 6c20 6749 7353 6368 6564 756c 6564 0d0a  l gIsScheduled..
+000066f0: 2020 2020 0d0a 2020 2020 5265 7370 3d7b      ..    Resp={
+00006700: 2264 6174 6122 3a20 4e6f 6e65 7d0d 0a20  "data": None}.. 
+00006710: 2020 2069 6620 6749 7356 6972 7475 616c     if gIsVirtual
+00006720: 4149 3a0d 0a0d 0a20 2020 2020 2020 2074  AI:....        t
+00006730: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
+00006740: 2072 6573 703d 205f 7265 6769 7374 6572   resp= _register
+00006750: 5641 4928 290d 0a20 2020 2020 2020 2020  VAI()..         
+00006760: 2020 2072 6573 703d 5f6c 6f67 696e 5641     resp=_loginVA
+00006770: 4928 290d 0a20 2020 2020 2020 2065 7863  I()..        exc
+00006780: 6570 7420 4578 6365 7074 696f 6e20 6173  ept Exception as
+00006790: 2065 7272 3a0d 0a20 2020 2020 2020 2020   err:..         
+000067a0: 2020 2070 7269 6e74 2822 4352 4954 4943     print("CRITIC
+000067b0: 414c 3a20 222b 6572 722e 6d73 6729 0d0a  AL: "+err.msg)..
+000067c0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000067d0: 6520 6572 720d 0a20 2020 2020 2020 200d  e err..        .
+000067e0: 0a20 2020 2020 2020 2023 2052 756e 2074  .        # Run t
+000067f0: 6865 2073 6368 6564 756c 6572 0d0a 2020  he scheduler..  
+00006800: 2020 2020 2020 6966 2067 4973 5363 6865        if gIsSche
+00006810: 6475 6c65 643d 3d46 616c 7365 3a0d 0a20  duled==False:.. 
+00006820: 2020 2020 2020 2020 2020 2067 4973 5363             gIsSc
+00006830: 6865 6475 6c65 643d 5472 7565 0d0a 2020  heduled=True..  
+00006840: 2020 2020 2020 2020 2020 7363 6865 6475            schedu
+00006850: 6c65 2e65 7665 7279 2829 2e64 6179 2e61  le.every().day.a
+00006860: 7428 2231 303a 3330 2229 2e64 6f28 5f6c  t("10:30").do(_l
+00006870: 6f67 696e 5641 4929 0d0a 0d0a 2020 2020  oginVAI)....    
+00006880: 7265 7475 726e 2072 6573 700d 0a0d 0a23  return resp....#
+00006890: 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  # --------------
 000068a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000068b0: 2d2d 2d2d 0d0a 0d0a 2323 2050 5542 4c49  ----....## PUBLI
-000068c0: 4320 2d20 7061 7273 6520 6172 6773 2066  C - parse args f
-000068d0: 6f72 204f 5341 4953 2028 6e6f 7420 7468  or OSAIS (not th
-000068e0: 6f73 6520 666f 7220 4149 290d 0a64 6566  ose for AI)..def
-000068f0: 206f 7361 6973 5f69 6e69 7450 6172 7365   osais_initParse
-00006900: 7228 6141 7267 293a 0d0a 2020 2020 676c  r(aArg):..    gl
-00006910: 6f62 616c 2067 4172 6773 4f53 4149 530d  obal gArgsOSAIS.
-00006920: 0a20 2020 2067 6c6f 6261 6c20 6749 6e70  .    global gInp
-00006930: 7574 4469 720d 0a20 2020 2067 6c6f 6261  utDir..    globa
-00006940: 6c20 674f 7574 7075 7444 6972 0d0a 2020  l gOutputDir..  
-00006950: 2020 676c 6f62 616c 2067 4973 5761 726d    global gIsWarm
-00006960: 7570 0d0a 0d0a 2020 2020 2320 4372 6561  up....    # Crea
-00006970: 7465 2074 6865 2070 6172 7365 720d 0a20  te the parser.. 
-00006980: 2020 2076 715f 7061 7273 6572 203d 2061     vq_parser = a
-00006990: 7267 7061 7273 652e 4172 6775 6d65 6e74  rgparse.Argument
-000069a0: 5061 7273 6572 2864 6573 6372 6970 7469  Parser(descripti
-000069b0: 6f6e 3d27 4172 6720 7061 7273 6572 2069  on='Arg parser i
-000069c0: 6e69 7420 6279 204f 5341 4953 2729 0d0a  nit by OSAIS')..
-000069d0: 0d0a 2020 2020 2320 4164 6420 7468 6520  ..    # Add the 
-000069e0: 4149 2047 6174 6577 6179 202f 204f 7065  AI Gateway / Ope
-000069f0: 6e53 6f75 7263 6541 4973 2061 7267 756d  nSourceAIs argum
-00006a00: 656e 7473 0d0a 2020 2020 7671 5f70 6172  ents..    vq_par
-00006a10: 7365 722e 6164 645f 6172 6775 6d65 6e74  ser.add_argument
-00006a20: 2822 2d6f 7269 6722 2c20 2022 2d2d 6f72  ("-orig",  "--or
-00006a30: 6967 696e 222c 2074 7970 653d 7374 722c  igin", type=str,
-00006a40: 2068 656c 703d 2241 4920 4761 7465 7761   help="AI Gatewa
-00006a50: 7920 7365 7276 6572 206f 7269 6769 6e22  y server origin"
-00006a60: 2c20 6465 6661 756c 743d 6622 6874 7470  , default=f"http
-00006a70: 3a2f 2f7b 6749 504c 6f63 616c 7d3a 7b67  ://{gIPLocal}:{g
-00006a80: 506f 7274 4761 7465 7761 797d 2f22 202c  PortGateway}/" ,
-00006a90: 2064 6573 743d 274f 5341 4953 5f6f 7269   dest='OSAIS_ori
-00006aa0: 6769 6e27 2920 2020 2020 2323 2020 7468  gin')     ##  th
-00006ab0: 6973 2069 7320 666f 7220 636f 6d6d 7320  is is for comms 
-00006ac0: 7769 7468 2041 4920 4761 7465 7761 790d  with AI Gateway.
-00006ad0: 0a20 2020 2076 715f 7061 7273 6572 2e61  .    vq_parser.a
-00006ae0: 6464 5f61 7267 756d 656e 7428 222d 7422  dd_argument("-t"
-00006af0: 2c20 2022 2d2d 746f 6b65 6e22 2c20 7479  ,  "--token", ty
-00006b00: 7065 3d73 7472 2c20 6865 6c70 3d22 4f70  pe=str, help="Op
-00006b10: 656e 536f 7572 6365 4149 7320 746f 6b65  enSourceAIs toke
-00006b20: 6e22 2c20 6465 6661 756c 743d 2230 222c  n", default="0",
-00006b30: 2064 6573 743d 2774 6f6b 656e 4149 2729   dest='tokenAI')
-00006b40: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00006b50: 2320 2074 6869 7320 6973 2066 6f72 2063  #  this is for c
-00006b60: 6f6d 6d73 2077 6974 6820 4f70 656e 536f  omms with OpenSo
-00006b70: 7572 6365 4149 730d 0a20 2020 2076 715f  urceAIs..    vq_
-00006b80: 7061 7273 6572 2e61 6464 5f61 7267 756d  parser.add_argum
-00006b90: 656e 7428 222d 7522 2c20 2022 2d2d 7573  ent("-u",  "--us
-00006ba0: 6572 6e61 6d65 222c 2074 7970 653d 7374  ername", type=st
-00006bb0: 722c 2068 656c 703d 224f 7065 6e53 6f75  r, help="OpenSou
-00006bc0: 7263 6541 4973 2075 7365 726e 616d 6522  rceAIs username"
-00006bd0: 2c20 6465 6661 756c 743d 2222 2c20 6465  , default="", de
-00006be0: 7374 3d27 7573 6572 6e61 6d65 2729 2020  st='username')  
-00006bf0: 2020 2020 2023 2320 2074 6869 7320 6973       ##  this is
-00006c00: 2066 6f72 2063 6f6d 6d73 2077 6974 6820   for comms with 
-00006c10: 4f70 656e 536f 7572 6365 4149 730d 0a20  OpenSourceAIs.. 
-00006c20: 2020 2076 715f 7061 7273 6572 2e61 6464     vq_parser.add
-00006c30: 5f61 7267 756d 656e 7428 222d 7569 6422  _argument("-uid"
-00006c40: 2c20 2022 2d2d 756e 6971 7565 5f69 6422  ,  "--unique_id"
-00006c50: 2c20 7479 7065 3d69 6e74 2c20 6865 6c70  , type=int, help
-00006c60: 3d22 556e 6971 7565 2049 4420 6f66 2074  ="Unique ID of t
-00006c70: 6869 7320 4149 2073 6573 7369 6f6e 222c  his AI session",
-00006c80: 2064 6566 6175 6c74 3d30 2c20 6465 7374   default=0, dest
-00006c90: 3d27 7569 6427 2920 2020 2023 2320 2074  ='uid')    ##  t
-00006ca0: 6869 7320 6973 2066 6f72 2063 6f6d 6d73  his is for comms
-00006cb0: 2077 6974 6820 4f70 656e 536f 7572 6365   with OpenSource
-00006cc0: 4149 730d 0a20 2020 2076 715f 7061 7273  AIs..    vq_pars
-00006cd0: 6572 2e61 6464 5f61 7267 756d 656e 7428  er.add_argument(
-00006ce0: 222d 6f64 6972 222c 2022 2d2d 6f75 7464  "-odir", "--outd
-00006cf0: 6972 222c 2074 7970 653d 7374 722c 2068  ir", type=str, h
-00006d00: 656c 703d 224f 7574 7075 7420 6469 7265  elp="Output dire
-00006d10: 6374 6f72 7922 2c20 6465 6661 756c 743d  ctory", default=
-00006d20: 674f 7574 7075 7444 6972 2c20 6465 7374  gOutputDir, dest
-00006d30: 3d27 6f75 7464 6972 2729 0d0a 2020 2020  ='outdir')..    
-00006d40: 7671 5f70 6172 7365 722e 6164 645f 6172  vq_parser.add_ar
-00006d50: 6775 6d65 6e74 2822 2d69 6469 7222 2c20  gument("-idir", 
-00006d60: 222d 2d69 6e64 6972 222c 2074 7970 653d  "--indir", type=
-00006d70: 7374 722c 2068 656c 703d 2269 6e70 7574  str, help="input
-00006d80: 2064 6972 6563 746f 7279 222c 2064 6566   directory", def
-00006d90: 6175 6c74 3d67 496e 7075 7444 6972 2c20  ault=gInputDir, 
-00006da0: 6465 7374 3d27 696e 6469 7227 290d 0a20  dest='indir').. 
-00006db0: 2020 2076 715f 7061 7273 6572 2e61 6464     vq_parser.add
-00006dc0: 5f61 7267 756d 656e 7428 222d 6c6f 6361  _argument("-loca
-00006dd0: 6c22 2c20 222d 2d69 736c 6f63 616c 222c  l", "--islocal",
-00006de0: 2074 7970 653d 626f 6f6c 2c20 6865 6c70   type=bool, help
-00006df0: 3d22 6973 206c 6f63 616c 206f 7220 7072  ="is local or pr
-00006e00: 6f64 3f22 2c20 6465 6661 756c 743d 4661  od?", default=Fa
-00006e10: 6c73 652c 2064 6573 743d 2769 734c 6f63  lse, dest='isLoc
-00006e20: 616c 2729 0d0a 2020 2020 7671 5f70 6172  al')..    vq_par
-00006e30: 7365 722e 6164 645f 6172 6775 6d65 6e74  ser.add_argument
-00006e40: 2822 2d63 7963 6c65 222c 2022 2d2d 6379  ("-cycle", "--cy
-00006e50: 636c 6522 2c20 7479 7065 3d69 6e74 2c20  cle", type=int, 
-00006e60: 6865 6c70 3d22 6379 636c 6522 2c20 6465  help="cycle", de
-00006e70: 6661 756c 743d 302c 2064 6573 743d 2763  fault=0, dest='c
-00006e80: 7963 6c65 2729 0d0a 2020 2020 7671 5f70  ycle')..    vq_p
-00006e90: 6172 7365 722e 6164 645f 6172 6775 6d65  arser.add_argume
-00006ea0: 6e74 2822 2d66 696c 656e 616d 6522 2c20  nt("-filename", 
-00006eb0: 222d 2d66 696c 656e 616d 6522 2c20 7479  "--filename", ty
-00006ec0: 7065 3d73 7472 2c20 6865 6c70 3d22 6669  pe=str, help="fi
-00006ed0: 6c65 6e61 6d65 222c 2064 6566 6175 6c74  lename", default
-00006ee0: 3d22 6465 6661 756c 7422 2c20 6465 7374  ="default", dest
-00006ef0: 3d27 6669 6c65 6e61 6d65 2729 0d0a 2020  ='filename')..  
-00006f00: 2020 7671 5f70 6172 7365 722e 6164 645f    vq_parser.add_
-00006f10: 6172 6775 6d65 6e74 2822 2d77 6172 6d75  argument("-warmu
-00006f20: 7022 2c20 222d 2d77 6172 6d75 7022 2c20  p", "--warmup", 
-00006f30: 7479 7065 3d62 6f6f 6c2c 2068 656c 703d  type=bool, help=
-00006f40: 2277 6172 6d75 7022 2c20 6465 6661 756c  "warmup", defaul
-00006f50: 743d 4661 6c73 652c 2064 6573 743d 2777  t=False, dest='w
-00006f60: 6172 6d75 7027 290d 0a0d 0a20 2020 2067  armup')....    g
-00006f70: 4172 6773 4f53 4149 5320 3d20 7671 5f70  ArgsOSAIS = vq_p
-00006f80: 6172 7365 722e 7061 7273 655f 6172 6773  arser.parse_args
-00006f90: 2861 4172 6729 0d0a 2020 2020 6749 7357  (aArg)..    gIsW
-00006fa0: 6172 6d75 703d 6741 7267 734f 5341 4953  armup=gArgsOSAIS
-00006fb0: 2e77 6172 6d75 700d 0a20 2020 2072 6574  .warmup..    ret
-00006fc0: 7572 6e20 5472 7565 0d0a 0d0a 2323 2050  urn True....## P
-00006fd0: 5542 4c49 4320 2d20 7275 6e20 7468 6520  UBLIC - run the 
-00006fe0: 4149 2028 6174 206c 6561 7374 2074 7279  AI (at least try
-00006ff0: 290d 0a64 6566 206f 7361 6973 5f72 756e  )..def osais_run
-00007000: 4149 282a 6172 6773 293a 0d0a 2020 2020  AI(*args):..    
-00007010: 676c 6f62 616c 2067 4973 4275 7379 0d0a  global gIsBusy..
-00007020: 2020 2020 676c 6f62 616c 2067 4150 726f      global gAPro
-00007030: 6365 7373 6564 0d0a 2020 2020 676c 6f62  cessed..    glob
-00007040: 616c 2067 4e61 6d65 200d 0a20 2020 2067  al gName ..    g
-00007050: 6c6f 6261 6c20 674c 6173 7450 726f 6365  lobal gLastProce
-00007060: 7373 5374 6172 745f 6174 0d0a 0d0a 2020  ssStart_at....  
-00007070: 2020 2323 2067 6574 2061 7267 730d 0a20    ## get args.. 
-00007080: 2020 2066 6e5f 7275 6e3d 6172 6773 5b30     fn_run=args[0
-00007090: 5d0d 0a20 2020 205f 6172 6773 3d61 7267  ]..    _args=arg
-000070a0: 735b 315d 0d0a 0d0a 2020 2020 2323 2064  s[1]....    ## d
-000070b0: 6f20 6e6f 7420 7072 6f63 6573 7320 7477  o not process tw
-000070c0: 6963 6520 7361 6d65 2075 6964 0d0a 2020  ice same uid..  
-000070d0: 2020 5f75 6964 3d5f 6172 6773 2e67 6574    _uid=_args.get
-000070e0: 2827 2d75 6964 2729 0d0a 2020 2020 6966  ('-uid')..    if
-000070f0: 205f 7569 6420 696e 2067 4150 726f 6365   _uid in gAProce
-00007100: 7373 6564 3a0d 0a20 2020 2020 2020 2072  ssed:..        r
-00007110: 6574 7572 6e20 2022 6e6f 7420 7072 6f63  eturn  "not proc
-00007120: 6573 7369 6e67 2c20 616c 7265 6164 7920  essing, already 
-00007130: 7472 6965 642e 2e2e 220d 0a0d 0a20 2020  tried..."....   
-00007140: 2023 2320 7374 6172 7420 7469 6d65 0d0a   ## start time..
-00007150: 2020 2020 6749 7342 7573 793d 5472 7565      gIsBusy=True
-00007160: 0d0a 2020 2020 6265 675f 6461 7465 203d  ..    beg_date =
-00007170: 2064 6174 6574 696d 652e 7574 636e 6f77   datetime.utcnow
-00007180: 2829 0d0a 0d0a 2020 2020 2323 2072 6570  ()....    ## rep
-00007190: 726f 6365 7373 2041 4920 6172 6773 0d0a  rocess AI args..
-000071a0: 2020 2020 6141 7267 466f 7270 6172 7365      aArgForparse
-000071b0: 7241 493d 5f67 6574 4172 6773 285f 6172  rAI=_getArgs(_ar
-000071c0: 6773 290d 0a20 2020 2061 7267 735f 4578  gs)..    args_Ex
-000071d0: 636c 7573 6976 654f 5341 4953 3d5b 272d  clusiveOSAIS=['-
-000071e0: 6f72 6967 272c 2027 2d74 272c 2027 2d75  orig', '-t', '-u
-000071f0: 272c 2027 2d75 6964 272c 2027 2d6c 6f63  ', '-uid', '-loc
-00007200: 616c 272c 2027 2d63 7963 6c65 272c 2027  al', '-cycle', '
-00007210: 2d77 6172 6d75 7027 5d0d 0a20 2020 2061  -warmup']..    a
-00007220: 4172 6746 6f72 7061 7273 6572 4149 3d5f  ArgForparserAI=_
-00007230: 6172 6773 4672 6f6d 4669 6c74 6572 2861  argsFromFilter(a
-00007240: 4172 6746 6f72 7061 7273 6572 4149 2c20  ArgForparserAI, 
+000068b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000068c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000068d0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2320 2020  ----------..#   
+000068e0: 2020 2020 5275 6e20 7468 6520 4149 0d0a      Run the AI..
+000068f0: 2323 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ## -------------
+00006900: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006910: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006920: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00006930: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d 0a23  -----------....#
+00006940: 2320 5055 424c 4943 202d 2070 6172 7365  # PUBLIC - parse
+00006950: 2061 7267 7320 666f 7220 4f53 4149 5320   args for OSAIS 
+00006960: 286e 6f74 2074 686f 7365 2066 6f72 2041  (not those for A
+00006970: 4929 0d0a 6465 6620 6f73 6169 735f 696e  I)..def osais_in
+00006980: 6974 5061 7273 6572 2861 4172 6729 3a0d  itParser(aArg):.
+00006990: 0a20 2020 2067 6c6f 6261 6c20 6741 7267  .    global gArg
+000069a0: 734f 5341 4953 0d0a 2020 2020 676c 6f62  sOSAIS..    glob
+000069b0: 616c 2067 496e 7075 7444 6972 0d0a 2020  al gInputDir..  
+000069c0: 2020 676c 6f62 616c 2067 4f75 7470 7574    global gOutput
+000069d0: 4469 720d 0a20 2020 2067 6c6f 6261 6c20  Dir..    global 
+000069e0: 6749 7357 6172 6d75 700d 0a0d 0a20 2020  gIsWarmup....   
+000069f0: 2023 2043 7265 6174 6520 7468 6520 7061   # Create the pa
+00006a00: 7273 6572 0d0a 2020 2020 7671 5f70 6172  rser..    vq_par
+00006a10: 7365 7220 3d20 6172 6770 6172 7365 2e41  ser = argparse.A
+00006a20: 7267 756d 656e 7450 6172 7365 7228 6465  rgumentParser(de
+00006a30: 7363 7269 7074 696f 6e3d 2741 7267 2070  scription='Arg p
+00006a40: 6172 7365 7220 696e 6974 2062 7920 4f53  arser init by OS
+00006a50: 4149 5327 290d 0a0d 0a20 2020 2023 2041  AIS')....    # A
+00006a60: 6464 2074 6865 2041 4920 4761 7465 7761  dd the AI Gatewa
+00006a70: 7920 2f20 4f70 656e 536f 7572 6365 4149  y / OpenSourceAI
+00006a80: 7320 6172 6775 6d65 6e74 730d 0a20 2020  s arguments..   
+00006a90: 2076 715f 7061 7273 6572 2e61 6464 5f61   vq_parser.add_a
+00006aa0: 7267 756d 656e 7428 222d 6f72 6967 222c  rgument("-orig",
+00006ab0: 2020 222d 2d6f 7269 6769 6e22 2c20 7479    "--origin", ty
+00006ac0: 7065 3d73 7472 2c20 6865 6c70 3d22 4149  pe=str, help="AI
+00006ad0: 2047 6174 6577 6179 2073 6572 7665 7220   Gateway server 
+00006ae0: 6f72 6967 696e 222c 2064 6566 6175 6c74  origin", default
+00006af0: 3d66 2268 7474 703a 2f2f 7b67 4950 4c6f  =f"http://{gIPLo
+00006b00: 6361 6c7d 3a7b 6750 6f72 7447 6174 6577  cal}:{gPortGatew
+00006b10: 6179 7d2f 2220 2c20 6465 7374 3d27 4f53  ay}/" , dest='OS
+00006b20: 4149 535f 6f72 6967 696e 2729 2020 2020  AIS_origin')    
+00006b30: 2023 2320 2074 6869 7320 6973 2066 6f72   ##  this is for
+00006b40: 2063 6f6d 6d73 2077 6974 6820 4149 2047   comms with AI G
+00006b50: 6174 6577 6179 0d0a 2020 2020 7671 5f70  ateway..    vq_p
+00006b60: 6172 7365 722e 6164 645f 6172 6775 6d65  arser.add_argume
+00006b70: 6e74 2822 2d74 222c 2020 222d 2d74 6f6b  nt("-t",  "--tok
+00006b80: 656e 222c 2074 7970 653d 7374 722c 2068  en", type=str, h
+00006b90: 656c 703d 224f 7065 6e53 6f75 7263 6541  elp="OpenSourceA
+00006ba0: 4973 2074 6f6b 656e 222c 2064 6566 6175  Is token", defau
+00006bb0: 6c74 3d22 3022 2c20 6465 7374 3d27 746f  lt="0", dest='to
+00006bc0: 6b65 6e41 4927 2920 2020 2020 2020 2020  kenAI')         
+00006bd0: 2020 2020 2020 2323 2020 7468 6973 2069        ##  this i
+00006be0: 7320 666f 7220 636f 6d6d 7320 7769 7468  s for comms with
+00006bf0: 204f 7065 6e53 6f75 7263 6541 4973 0d0a   OpenSourceAIs..
+00006c00: 2020 2020 7671 5f70 6172 7365 722e 6164      vq_parser.ad
+00006c10: 645f 6172 6775 6d65 6e74 2822 2d75 222c  d_argument("-u",
+00006c20: 2020 222d 2d75 7365 726e 616d 6522 2c20    "--username", 
+00006c30: 7479 7065 3d73 7472 2c20 6865 6c70 3d22  type=str, help="
+00006c40: 4f70 656e 536f 7572 6365 4149 7320 7573  OpenSourceAIs us
+00006c50: 6572 6e61 6d65 222c 2064 6566 6175 6c74  ername", default
+00006c60: 3d22 222c 2064 6573 743d 2775 7365 726e  ="", dest='usern
+00006c70: 616d 6527 2920 2020 2020 2020 2323 2020  ame')       ##  
+00006c80: 7468 6973 2069 7320 666f 7220 636f 6d6d  this is for comm
+00006c90: 7320 7769 7468 204f 7065 6e53 6f75 7263  s with OpenSourc
+00006ca0: 6541 4973 0d0a 2020 2020 7671 5f70 6172  eAIs..    vq_par
+00006cb0: 7365 722e 6164 645f 6172 6775 6d65 6e74  ser.add_argument
+00006cc0: 2822 2d75 6964 222c 2020 222d 2d75 6e69  ("-uid",  "--uni
+00006cd0: 7175 655f 6964 222c 2074 7970 653d 696e  que_id", type=in
+00006ce0: 742c 2068 656c 703d 2255 6e69 7175 6520  t, help="Unique 
+00006cf0: 4944 206f 6620 7468 6973 2041 4920 7365  ID of this AI se
+00006d00: 7373 696f 6e22 2c20 6465 6661 756c 743d  ssion", default=
+00006d10: 302c 2064 6573 743d 2775 6964 2729 2020  0, dest='uid')  
+00006d20: 2020 2323 2020 7468 6973 2069 7320 666f    ##  this is fo
+00006d30: 7220 636f 6d6d 7320 7769 7468 204f 7065  r comms with Ope
+00006d40: 6e53 6f75 7263 6541 4973 0d0a 2020 2020  nSourceAIs..    
+00006d50: 7671 5f70 6172 7365 722e 6164 645f 6172  vq_parser.add_ar
+00006d60: 6775 6d65 6e74 2822 2d6f 6469 7222 2c20  gument("-odir", 
+00006d70: 222d 2d6f 7574 6469 7222 2c20 7479 7065  "--outdir", type
+00006d80: 3d73 7472 2c20 6865 6c70 3d22 4f75 7470  =str, help="Outp
+00006d90: 7574 2064 6972 6563 746f 7279 222c 2064  ut directory", d
+00006da0: 6566 6175 6c74 3d67 4f75 7470 7574 4469  efault=gOutputDi
+00006db0: 722c 2064 6573 743d 276f 7574 6469 7227  r, dest='outdir'
+00006dc0: 290d 0a20 2020 2076 715f 7061 7273 6572  )..    vq_parser
+00006dd0: 2e61 6464 5f61 7267 756d 656e 7428 222d  .add_argument("-
+00006de0: 6964 6972 222c 2022 2d2d 696e 6469 7222  idir", "--indir"
+00006df0: 2c20 7479 7065 3d73 7472 2c20 6865 6c70  , type=str, help
+00006e00: 3d22 696e 7075 7420 6469 7265 6374 6f72  ="input director
+00006e10: 7922 2c20 6465 6661 756c 743d 6749 6e70  y", default=gInp
+00006e20: 7574 4469 722c 2064 6573 743d 2769 6e64  utDir, dest='ind
+00006e30: 6972 2729 0d0a 2020 2020 7671 5f70 6172  ir')..    vq_par
+00006e40: 7365 722e 6164 645f 6172 6775 6d65 6e74  ser.add_argument
+00006e50: 2822 2d6c 6f63 616c 222c 2022 2d2d 6973  ("-local", "--is
+00006e60: 6c6f 6361 6c22 2c20 7479 7065 3d62 6f6f  local", type=boo
+00006e70: 6c2c 2068 656c 703d 2269 7320 6c6f 6361  l, help="is loca
+00006e80: 6c20 6f72 2070 726f 643f 222c 2064 6566  l or prod?", def
+00006e90: 6175 6c74 3d46 616c 7365 2c20 6465 7374  ault=False, dest
+00006ea0: 3d27 6973 4c6f 6361 6c27 290d 0a20 2020  ='isLocal')..   
+00006eb0: 2076 715f 7061 7273 6572 2e61 6464 5f61   vq_parser.add_a
+00006ec0: 7267 756d 656e 7428 222d 6379 636c 6522  rgument("-cycle"
+00006ed0: 2c20 222d 2d63 7963 6c65 222c 2074 7970  , "--cycle", typ
+00006ee0: 653d 696e 742c 2068 656c 703d 2263 7963  e=int, help="cyc
+00006ef0: 6c65 222c 2064 6566 6175 6c74 3d30 2c20  le", default=0, 
+00006f00: 6465 7374 3d27 6379 636c 6527 290d 0a20  dest='cycle').. 
+00006f10: 2020 2076 715f 7061 7273 6572 2e61 6464     vq_parser.add
+00006f20: 5f61 7267 756d 656e 7428 222d 6669 6c65  _argument("-file
+00006f30: 6e61 6d65 222c 2022 2d2d 6669 6c65 6e61  name", "--filena
+00006f40: 6d65 222c 2074 7970 653d 7374 722c 2068  me", type=str, h
+00006f50: 656c 703d 2266 696c 656e 616d 6522 2c20  elp="filename", 
+00006f60: 6465 6661 756c 743d 2264 6566 6175 6c74  default="default
+00006f70: 222c 2064 6573 743d 2766 696c 656e 616d  ", dest='filenam
+00006f80: 6527 290d 0a20 2020 2076 715f 7061 7273  e')..    vq_pars
+00006f90: 6572 2e61 6464 5f61 7267 756d 656e 7428  er.add_argument(
+00006fa0: 222d 7761 726d 7570 222c 2022 2d2d 7761  "-warmup", "--wa
+00006fb0: 726d 7570 222c 2074 7970 653d 626f 6f6c  rmup", type=bool
+00006fc0: 2c20 6865 6c70 3d22 7761 726d 7570 222c  , help="warmup",
+00006fd0: 2064 6566 6175 6c74 3d46 616c 7365 2c20   default=False, 
+00006fe0: 6465 7374 3d27 7761 726d 7570 2729 0d0a  dest='warmup')..
+00006ff0: 0d0a 2020 2020 6741 7267 734f 5341 4953  ..    gArgsOSAIS
+00007000: 203d 2076 715f 7061 7273 6572 2e70 6172   = vq_parser.par
+00007010: 7365 5f61 7267 7328 6141 7267 290d 0a20  se_args(aArg).. 
+00007020: 2020 2067 4973 5761 726d 7570 3d67 4172     gIsWarmup=gAr
+00007030: 6773 4f53 4149 532e 7761 726d 7570 0d0a  gsOSAIS.warmup..
+00007040: 2020 2020 7265 7475 726e 2054 7275 650d      return True.
+00007050: 0a0d 0a23 2320 5055 424c 4943 202d 2072  ...## PUBLIC - r
+00007060: 756e 2074 6865 2041 4920 2861 7420 6c65  un the AI (at le
+00007070: 6173 7420 7472 7929 0d0a 6465 6620 6f73  ast try)..def os
+00007080: 6169 735f 7275 6e41 4928 2a61 7267 7329  ais_runAI(*args)
+00007090: 3a0d 0a20 2020 2067 6c6f 6261 6c20 6749  :..    global gI
+000070a0: 7342 7573 790d 0a20 2020 2067 6c6f 6261  sBusy..    globa
+000070b0: 6c20 6741 5072 6f63 6573 7365 640d 0a20  l gAProcessed.. 
+000070c0: 2020 2067 6c6f 6261 6c20 674e 616d 6520     global gName 
+000070d0: 0d0a 2020 2020 676c 6f62 616c 2067 4c61  ..    global gLa
+000070e0: 7374 5072 6f63 6573 7353 7461 7274 5f61  stProcessStart_a
+000070f0: 740d 0a0d 0a20 2020 2023 2320 6765 7420  t....    ## get 
+00007100: 6172 6773 0d0a 2020 2020 666e 5f72 756e  args..    fn_run
+00007110: 3d61 7267 735b 305d 0d0a 2020 2020 5f61  =args[0]..    _a
+00007120: 7267 733d 6172 6773 5b31 5d0d 0a0d 0a20  rgs=args[1].... 
+00007130: 2020 2023 2320 646f 206e 6f74 2070 726f     ## do not pro
+00007140: 6365 7373 2074 7769 6365 2073 616d 6520  cess twice same 
+00007150: 7569 640d 0a20 2020 205f 7569 643d 5f61  uid..    _uid=_a
+00007160: 7267 732e 6765 7428 272d 7569 6427 290d  rgs.get('-uid').
+00007170: 0a20 2020 2069 6620 5f75 6964 2069 6e20  .    if _uid in 
+00007180: 6741 5072 6f63 6573 7365 643a 0d0a 2020  gAProcessed:..  
+00007190: 2020 2020 2020 7265 7475 726e 2020 226e        return  "n
+000071a0: 6f74 2070 726f 6365 7373 696e 672c 2061  ot processing, a
+000071b0: 6c72 6561 6479 2074 7269 6564 2e2e 2e22  lready tried..."
+000071c0: 0d0a 0d0a 2020 2020 2323 2073 7461 7274  ....    ## start
+000071d0: 2074 696d 650d 0a20 2020 2067 4973 4275   time..    gIsBu
+000071e0: 7379 3d54 7275 650d 0a20 2020 2062 6567  sy=True..    beg
+000071f0: 5f64 6174 6520 3d20 6461 7465 7469 6d65  _date = datetime
+00007200: 2e75 7463 6e6f 7728 290d 0a0d 0a20 2020  .utcnow()....   
+00007210: 2023 2320 7265 7072 6f63 6573 7320 4149   ## reprocess AI
+00007220: 2061 7267 730d 0a20 2020 2061 4172 6746   args..    aArgF
+00007230: 6f72 7061 7273 6572 4149 3d5f 6765 7441  orparserAI=_getA
+00007240: 7267 7328 5f61 7267 7329 0d0a 2020 2020  rgs(_args)..    
 00007250: 6172 6773 5f45 7863 6c75 7369 7665 4f53  args_ExclusiveOS
-00007260: 4149 532c 2046 616c 7365 290d 0a0d 0a20  AIS, False).... 
-00007270: 2020 2023 2320 7072 6f63 6573 7320 7468     ## process th
-00007280: 6520 6669 6c65 6e61 6d65 2070 6173 7365  e filename passe
-00007290: 6420 696e 2064 6972 2028 6361 7365 206c  d in dir (case l
-000072a0: 6f63 616c 686f 7374 202f 2041 4920 4761  ocalhost / AI Ga
-000072b0: 7465 7761 7929 2c20 6f72 2064 6f77 6e6c  teway), or downl
-000072c0: 6f61 6420 6669 6c65 2066 726f 6d20 5552  oad file from UR
-000072d0: 4c20 2863 6173 6520 4149 2072 756e 6e69  L (case AI runni
-000072e0: 6e67 2061 7320 5669 7274 7561 6c20 4149  ng as Virtual AI
-000072f0: 290d 0a20 2020 205f 696e 7075 743d 4e6f  )..    _input=No
-00007300: 6e65 0d0a 2020 2020 5f66 696c 656e 616d  ne..    _filenam
-00007310: 653d 5f61 7267 732e 6765 7428 272d 6669  e=_args.get('-fi
-00007320: 6c65 6e61 6d65 2729 0d0a 2020 2020 5f75  lename')..    _u
-00007330: 726c 5570 6c6f 6164 3d5f 6172 6773 2e67  rlUpload=_args.g
-00007340: 6574 2827 7572 6c5f 7570 6c6f 6164 2729  et('url_upload')
-00007350: 0d0a 2020 2020 6966 206e 6f74 205f 6669  ..    if not _fi
-00007360: 6c65 6e61 6d65 2061 6e64 205f 7572 6c55  lename and _urlU
-00007370: 706c 6f61 643a 0d0a 2020 2020 2020 2020  pload:..        
-00007380: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
-00007390: 2020 5f69 6e70 7574 3d64 6f77 6e6c 6f61    _input=downloa
-000073a0: 6449 6d61 6765 285f 7572 6c55 706c 6f61  dImage(_urlUploa
-000073b0: 6429 0d0a 2020 2020 2020 2020 2020 2020  d)..            
-000073c0: 6966 205f 696e 7075 743a 0d0a 2020 2020  if _input:..    
-000073d0: 2020 2020 2020 2020 2020 2020 6141 7267              aArg
-000073e0: 466f 7270 6172 7365 7241 492e 6170 7065  ForparserAI.appe
-000073f0: 6e64 2822 2d66 696c 656e 616d 6522 290d  nd("-filename").
-00007400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007410: 2061 4172 6746 6f72 7061 7273 6572 4149   aArgForparserAI
-00007420: 2e61 7070 656e 6428 5f69 6e70 7574 290d  .append(_input).
-00007430: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00007440: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00007450: 2020 2020 2323 206d 696e 2072 6571 7569      ## min requi
-00007460: 7265 6d65 6e74 730d 0a20 2020 2020 2020  rements..       
-00007470: 2020 2020 2020 2020 2070 7269 6e74 2822           print("
-00007480: 6e6f 2069 6d61 6765 2074 6f20 7072 6f63  no image to proc
-00007490: 6573 7322 290d 0a20 2020 2020 2020 2020  ess")..         
-000074a0: 2020 2020 2020 2072 6574 7572 6e20 2269         return "i
-000074b0: 6e70 7574 2072 6571 7569 7265 6422 0d0a  nput required"..
-000074c0: 2020 2020 2020 2020 6578 6365 7074 2045          except E
-000074d0: 7863 6570 7469 6f6e 2061 7320 6572 723a  xception as err:
-000074e0: 0d0a 2020 2020 2020 2020 2020 2020 7072  ..            pr
-000074f0: 696e 7428 2243 5249 5449 4341 4c3a 2022  int("CRITICAL: "
-00007500: 2b65 7272 2e6d 7367 290d 0a20 2020 2020  +err.msg)..     
-00007510: 2020 2020 2020 2072 6169 7365 2065 7272         raise err
-00007520: 0d0a 2020 2020 0d0a 2020 2020 2323 2049  ..    ..    ## I
-00007530: 6e69 7420 4f53 4149 5320 5061 7261 6d73  nit OSAIS Params
-00007540: 2028 6672 6f6d 2061 6c6c 2061 7267 732c   (from all args,
-00007550: 206b 6565 7020 6f6e 6c79 2074 686f 7365   keep only those
-00007560: 2066 6f72 204f 5341 4953 290d 0a20 2020   for OSAIS)..   
-00007570: 2061 4172 6746 6f72 5061 7273 6572 4f53   aArgForParserOS
-00007580: 4149 533d 5f67 6574 4172 6773 285f 6172  AIS=_getArgs(_ar
-00007590: 6773 290d 0a20 2020 2061 7267 735f 4578  gs)..    args_Ex
-000075a0: 636c 7573 6976 654f 5341 4953 2e61 7070  clusiveOSAIS.app
-000075b0: 656e 6428 272d 6f64 6972 2729 0d0a 2020  end('-odir')..  
-000075c0: 2020 6172 6773 5f45 7863 6c75 7369 7665    args_Exclusive
-000075d0: 4f53 4149 532e 6170 7065 6e64 2827 2d69  OSAIS.append('-i
-000075e0: 6469 7227 290d 0a20 2020 2061 4172 6746  dir')..    aArgF
-000075f0: 6f72 5061 7273 6572 4f53 4149 533d 5f61  orParserOSAIS=_a
-00007600: 7267 7346 726f 6d46 696c 7465 7228 6141  rgsFromFilter(aA
-00007610: 7267 466f 7250 6172 7365 724f 5341 4953  rgForParserOSAIS
-00007620: 2c20 6172 6773 5f45 7863 6c75 7369 7665  , args_Exclusive
-00007630: 4f53 4149 532c 2054 7275 6529 0d0a 2020  OSAIS, True)..  
-00007640: 2020 6f73 6169 735f 696e 6974 5061 7273    osais_initPars
-00007650: 6572 2861 4172 6746 6f72 5061 7273 6572  er(aArgForParser
-00007660: 4f53 4149 5329 0d0a 0d0a 2020 2020 6966  OSAIS)....    if
-00007670: 2067 4973 5761 726d 7570 3a0d 0a20 2020   gIsWarmup:..   
-00007680: 2020 2020 2070 7269 6e74 2822 5c72 5c6e       print("\r\n
-00007690: 3d3e 2057 6172 6d69 6e67 2075 702e 2e2e  => Warming up...
-000076a0: 205c 725c 6e22 290d 0a20 2020 2065 6c73   \r\n")..    els
-000076b0: 653a 0d0a 2020 2020 2020 2020 7072 696e  e:..        prin
-000076c0: 7428 225c 725c 6e3d 3e20 6265 666f 7265  t("\r\n=> before
-000076d0: 2072 756e 3a20 7072 6f63 6573 7365 6420   run: processed 
-000076e0: 6172 6773 2066 726f 6d20 7572 6c3a 2022  args from url: "
-000076f0: 2b73 7472 2861 4172 6746 6f72 7061 7273  +str(aArgForpars
-00007700: 6572 4149 292b 225c 725c 6e22 290d 0a0d  erAI)+"\r\n")...
-00007710: 0a20 2020 2023 23c2 a070 726f 6365 7373  .    ##..process
-00007720: 696e 6720 6163 6365 7074 6564 0d0a 2020  ing accepted..  
-00007730: 2020 674c 6173 7450 726f 6365 7373 5374    gLastProcessSt
-00007740: 6172 745f 6174 3d64 6174 6574 696d 652e  art_at=datetime.
-00007750: 7574 636e 6f77 2829 0d0a 2020 2020 6741  utcnow()..    gA
-00007760: 5072 6f63 6573 7365 642e 6170 7065 6e64  Processed.append
-00007770: 285f 7569 6429 0d0a 0d0a 2020 2020 2323  (_uid)....    ##
-00007780: 206e 6f74 6966 7920 4f53 4149 5320 2873   notify OSAIS (s
-00007790: 7461 7274 290d 0a20 2020 2043 7265 6473  tart)..    Creds
-000077a0: 5061 7261 6d3d 6765 7443 7265 6473 5061  Param=getCredsPa
-000077b0: 7261 6d73 2829 0d0a 2020 2020 4d6f 7270  rams()..    Morp
-000077c0: 6869 6e67 5061 7261 6d3d 6765 744d 6f72  hingParam=getMor
-000077d0: 7068 696e 6750 6172 616d 7328 290d 0a20  phingParams().. 
-000077e0: 2020 2053 7461 6765 5061 7261 6d3d 6765     StageParam=ge
-000077f0: 7453 7461 6765 5061 7261 6d73 2841 495f  tStageParams(AI_
-00007800: 5052 4f47 5245 5353 5f41 495f 5354 4152  PROGRESS_AI_STAR
-00007810: 5445 442c 2030 290d 0a20 2020 206f 7361  TED, 0)..    osa
-00007820: 6973 5f6e 6f74 6966 7928 4372 6564 7350  is_notify(CredsP
-00007830: 6172 616d 2c20 4d6f 7270 6869 6e67 5061  aram, MorphingPa
-00007840: 7261 6d20 2c20 5374 6167 6550 6172 616d  ram , StageParam
-00007850: 290d 0a0d 0a20 2020 2023 2320 7374 6172  )....    ## star
-00007860: 7420 7761 7463 6820 6669 6c65 2063 7265  t watch file cre
-00007870: 6174 696f 6e0d 0a20 2020 205f 6f75 7470  ation..    _outp
-00007880: 7574 3d5f 6765 744f 7574 7075 7444 6972  ut=_getOutputDir
-00007890: 2829 0d0a 2020 2020 7761 7463 685f 6469  ()..    watch_di
-000078a0: 7265 6374 6f72 7928 5f6f 7574 7075 742c  rectory(_output,
-000078b0: 206f 7361 6973 5f6f 6e4e 6f74 6966 7946   osais_onNotifyF
-000078c0: 696c 6543 7265 6174 6564 2c20 5f61 7267  ileCreated, _arg
-000078d0: 7329 0d0a 0d0a 2020 2020 2323 204e 6f74  s)....    ## Not
-000078e0: 6966 204f 5341 4953 0d0a 2020 2020 5374  if OSAIS..    St
-000078f0: 6167 6550 6172 616d 3d67 6574 5374 6167  ageParam=getStag
-00007900: 6550 6172 616d 7328 4149 5f50 524f 4752  eParams(AI_PROGR
-00007910: 4553 535f 494e 4954 5f49 4d41 4745 2c20  ESS_INIT_IMAGE, 
-00007920: 3029 0d0a 2020 2020 6f73 6169 735f 6e6f  0)..    osais_no
-00007930: 7469 6679 2843 7265 6473 5061 7261 6d2c  tify(CredsParam,
-00007940: 204d 6f72 7068 696e 6750 6172 616d 202c   MorphingParam ,
-00007950: 2053 7461 6765 5061 7261 6d29 0d0a 0d0a   StageParam)....
-00007960: 2020 2020 2323 2072 756e 2041 490d 0a20      ## run AI.. 
-00007970: 2020 2072 6573 706f 6e73 653d 4e6f 6e65     response=None
-00007980: 0d0a 2020 2020 7472 793a 0d0a 2020 2020  ..    try:..    
-00007990: 2020 2020 6966 206c 656e 2861 7267 7329      if len(args)
-000079a0: 3d3d 323a 0d0a 2020 2020 2020 2020 2020  ==2:..          
-000079b0: 2020 7265 7370 6f6e 7365 3d66 6e5f 7275    response=fn_ru
-000079c0: 6e28 6141 7267 466f 7270 6172 7365 7241  n(aArgForparserA
-000079d0: 4929 0d0a 2020 2020 2020 2020 656c 7365  I)..        else
-000079e0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-000079f0: 6620 6c65 6e28 6172 6773 293d 3d33 3a0d  f len(args)==3:.
-00007a00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007a10: 2072 6573 706f 6e73 653d 666e 5f72 756e   response=fn_run
-00007a20: 2861 4172 6746 6f72 7061 7273 6572 4149  (aArgForparserAI
-00007a30: 2c20 6172 6773 5b32 5d29 0d0a 2020 2020  , args[2])..    
-00007a40: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00007a50: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00007a60: 6573 706f 6e73 653d 666e 5f72 756e 2861  esponse=fn_run(a
-00007a70: 4172 6746 6f72 7061 7273 6572 4149 2c20  ArgForparserAI, 
-00007a80: 6172 6773 5b32 5d2c 2061 7267 735b 335d  args[2], args[3]
-00007a90: 290d 0a20 2020 2065 7863 6570 7420 4578  )..    except Ex
-00007aa0: 6365 7074 696f 6e20 6173 2065 7272 3a0d  ception as err:.
-00007ab0: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
-00007ac0: 4352 4954 4943 414c 3a20 222b 6572 722e  CRITICAL: "+err.
-00007ad0: 6d73 6729 0d0a 2020 2020 2020 2020 7261  msg)..        ra
-00007ae0: 6973 6520 6572 720d 0a0d 0a20 2020 2023  ise err....    #
-00007af0: 2320 6361 6c63 756c 6174 6520 636f 7374  # calculate cost
-00007b00: 0d0a 2020 2020 6749 7342 7573 793d 4661  ..    gIsBusy=Fa
-00007b10: 6c73 650d 0a20 2020 2065 6e64 5f64 6174  lse..    end_dat
-00007b20: 6520 3d20 6461 7465 7469 6d65 2e75 7463  e = datetime.utc
-00007b30: 6e6f 7728 290d 0a20 2020 2063 6f73 7420  now()..    cost 
-00007b40: 3d20 2865 6e64 5f64 6174 6520 2d20 6265  = (end_date - be
-00007b50: 675f 6461 7465 292e 746f 7461 6c5f 7365  g_date).total_se
-00007b60: 636f 6e64 7328 290d 0a20 2020 205f 6164  conds()..    _ad
-00007b70: 6443 6f73 7428 636f 7374 290d 0a0d 0a20  dCost(cost).... 
-00007b80: 2020 2023 2320 6e6f 7469 6679 2065 6e64     ## notify end
-00007b90: 0d0a 2020 2020 5374 6167 6550 6172 616d  ..    StageParam
-00007ba0: 3d67 6574 5374 6167 6550 6172 616d 7328  =getStageParams(
-00007bb0: 4149 5f50 524f 4752 4553 535f 4149 5f53  AI_PROGRESS_AI_S
-00007bc0: 544f 5050 4544 2c20 636f 7374 290d 0a20  TOPPED, cost).. 
-00007bd0: 2020 206f 7361 6973 5f6e 6f74 6966 7928     osais_notify(
-00007be0: 4372 6564 7350 6172 616d 2c20 4d6f 7270  CredsParam, Morp
-00007bf0: 6869 6e67 5061 7261 6d20 2c20 5374 6167  hingParam , Stag
-00007c00: 6550 6172 616d 290d 0a0d 0a20 2020 2023  eParam)....    #
-00007c10: 2320 6465 6661 756c 7420 4f4b 2072 6573  # default OK res
-00007c20: 706f 6e73 6520 6966 2074 6865 2041 4920  ponse if the AI 
-00007c30: 646f 6573 206e 6f74 2073 656e 6420 616e  does not send an
-00007c40: 790d 0a20 2020 2069 6620 7265 7370 6f6e  y..    if respon
-00007c50: 7365 3d3d 4e6f 6e65 3a0d 0a20 2020 2020  se==None:..     
-00007c60: 2020 2072 6573 706f 6e73 653d 5472 7565     response=True
-00007c70: 0d0a 2020 2020 7265 7475 726e 2072 6573  ..    return res
-00007c80: 706f 6e73 650d 0a0d 0a23 2320 2d2d 2d2d  ponse....## ----
-00007c90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00007ca0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00007cb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00007cc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00007cd0: 2d2d 2d2d 0d0a 2320 2020 2020 2020 6765  ----..#       ge
-00007ce0: 7420 666f 726d 6174 7465 6420 7061 7261  t formatted para
-00007cf0: 6d73 2066 726f 6d20 4149 2063 7572 7265  ms from AI curre
-00007d00: 6e74 2073 7461 7465 0d0a 2323 202d 2d2d  nt state..## ---
-00007d10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00007260: 4149 533d 5b27 2d6f 7269 6727 2c20 272d  AIS=['-orig', '-
+00007270: 7427 2c20 272d 7527 2c20 272d 7569 6427  t', '-u', '-uid'
+00007280: 2c20 272d 6c6f 6361 6c27 2c20 272d 6379  , '-local', '-cy
+00007290: 636c 6527 2c20 272d 7761 726d 7570 275d  cle', '-warmup']
+000072a0: 0d0a 2020 2020 6141 7267 466f 7270 6172  ..    aArgForpar
+000072b0: 7365 7241 493d 5f61 7267 7346 726f 6d46  serAI=_argsFromF
+000072c0: 696c 7465 7228 6141 7267 466f 7270 6172  ilter(aArgForpar
+000072d0: 7365 7241 492c 2061 7267 735f 4578 636c  serAI, args_Excl
+000072e0: 7573 6976 654f 5341 4953 2c20 4661 6c73  usiveOSAIS, Fals
+000072f0: 6529 0d0a 0d0a 2020 2020 2323 2070 726f  e)....    ## pro
+00007300: 6365 7373 2074 6865 2066 696c 656e 616d  cess the filenam
+00007310: 6520 7061 7373 6564 2069 6e20 6469 7220  e passed in dir 
+00007320: 2863 6173 6520 6c6f 6361 6c68 6f73 7420  (case localhost 
+00007330: 2f20 4149 2047 6174 6577 6179 292c 206f  / AI Gateway), o
+00007340: 7220 646f 776e 6c6f 6164 2066 696c 6520  r download file 
+00007350: 6672 6f6d 2055 524c 2028 6361 7365 2041  from URL (case A
+00007360: 4920 7275 6e6e 696e 6720 6173 2056 6972  I running as Vir
+00007370: 7475 616c 2041 4929 0d0a 2020 2020 5f69  tual AI)..    _i
+00007380: 6e70 7574 3d4e 6f6e 650d 0a20 2020 205f  nput=None..    _
+00007390: 6669 6c65 6e61 6d65 3d5f 6172 6773 2e67  filename=_args.g
+000073a0: 6574 2827 2d66 696c 656e 616d 6527 290d  et('-filename').
+000073b0: 0a20 2020 205f 7572 6c55 706c 6f61 643d  .    _urlUpload=
+000073c0: 5f61 7267 732e 6765 7428 2775 726c 5f75  _args.get('url_u
+000073d0: 706c 6f61 6427 290d 0a20 2020 2069 6620  pload')..    if 
+000073e0: 6e6f 7420 5f66 696c 656e 616d 6520 616e  not _filename an
+000073f0: 6420 5f75 726c 5570 6c6f 6164 3a0d 0a20  d _urlUpload:.. 
+00007400: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+00007410: 2020 2020 2020 2020 205f 696e 7075 743d           _input=
+00007420: 646f 776e 6c6f 6164 496d 6167 6528 5f75  downloadImage(_u
+00007430: 726c 5570 6c6f 6164 290d 0a20 2020 2020  rlUpload)..     
+00007440: 2020 2020 2020 2069 6620 5f69 6e70 7574         if _input
+00007450: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00007460: 2020 2061 4172 6746 6f72 7061 7273 6572     aArgForparser
+00007470: 4149 2e61 7070 656e 6428 222d 6669 6c65  AI.append("-file
+00007480: 6e61 6d65 2229 0d0a 2020 2020 2020 2020  name")..        
+00007490: 2020 2020 2020 2020 6141 7267 466f 7270          aArgForp
+000074a0: 6172 7365 7241 492e 6170 7065 6e64 285f  arserAI.append(_
+000074b0: 696e 7075 7429 0d0a 2020 2020 2020 2020  input)..        
+000074c0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+000074d0: 2020 2020 2020 2020 2020 2023 2320 6d69             ## mi
+000074e0: 6e20 7265 7175 6972 656d 656e 7473 0d0a  n requirements..
+000074f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007500: 7072 696e 7428 226e 6f20 696d 6167 6520  print("no image 
+00007510: 746f 2070 726f 6365 7373 2229 0d0a 2020  to process")..  
+00007520: 2020 2020 2020 2020 2020 2020 2020 7265                re
+00007530: 7475 726e 2022 696e 7075 7420 7265 7175  turn "input requ
+00007540: 6972 6564 220d 0a20 2020 2020 2020 2065  ired"..        e
+00007550: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
+00007560: 6173 2065 7272 3a0d 0a20 2020 2020 2020  as err:..       
+00007570: 2020 2020 2070 7269 6e74 2822 4352 4954       print("CRIT
+00007580: 4943 414c 3a20 222b 6572 722e 6d73 6729  ICAL: "+err.msg)
+00007590: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+000075a0: 6973 6520 6572 720d 0a20 2020 200d 0a20  ise err..    .. 
+000075b0: 2020 2023 2320 496e 6974 204f 5341 4953     ## Init OSAIS
+000075c0: 2050 6172 616d 7320 2866 726f 6d20 616c   Params (from al
+000075d0: 6c20 6172 6773 2c20 6b65 6570 206f 6e6c  l args, keep onl
+000075e0: 7920 7468 6f73 6520 666f 7220 4f53 4149  y those for OSAI
+000075f0: 5329 0d0a 2020 2020 6141 7267 466f 7250  S)..    aArgForP
+00007600: 6172 7365 724f 5341 4953 3d5f 6765 7441  arserOSAIS=_getA
+00007610: 7267 7328 5f61 7267 7329 0d0a 2020 2020  rgs(_args)..    
+00007620: 6172 6773 5f45 7863 6c75 7369 7665 4f53  args_ExclusiveOS
+00007630: 4149 532e 6170 7065 6e64 2827 2d6f 6469  AIS.append('-odi
+00007640: 7227 290d 0a20 2020 2061 7267 735f 4578  r')..    args_Ex
+00007650: 636c 7573 6976 654f 5341 4953 2e61 7070  clusiveOSAIS.app
+00007660: 656e 6428 272d 6964 6972 2729 0d0a 2020  end('-idir')..  
+00007670: 2020 6141 7267 466f 7250 6172 7365 724f    aArgForParserO
+00007680: 5341 4953 3d5f 6172 6773 4672 6f6d 4669  SAIS=_argsFromFi
+00007690: 6c74 6572 2861 4172 6746 6f72 5061 7273  lter(aArgForPars
+000076a0: 6572 4f53 4149 532c 2061 7267 735f 4578  erOSAIS, args_Ex
+000076b0: 636c 7573 6976 654f 5341 4953 2c20 5472  clusiveOSAIS, Tr
+000076c0: 7565 290d 0a20 2020 206f 7361 6973 5f69  ue)..    osais_i
+000076d0: 6e69 7450 6172 7365 7228 6141 7267 466f  nitParser(aArgFo
+000076e0: 7250 6172 7365 724f 5341 4953 290d 0a0d  rParserOSAIS)...
+000076f0: 0a20 2020 2069 6620 6749 7357 6172 6d75  .    if gIsWarmu
+00007700: 703a 0d0a 2020 2020 2020 2020 7072 696e  p:..        prin
+00007710: 7428 225c 725c 6e3d 3e20 5761 726d 696e  t("\r\n=> Warmin
+00007720: 6720 7570 2e2e 2e20 5c72 5c6e 2229 0d0a  g up... \r\n")..
+00007730: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00007740: 2020 2070 7269 6e74 2822 5c72 5c6e 3d3e     print("\r\n=>
+00007750: 2062 6566 6f72 6520 7275 6e3a 2070 726f   before run: pro
+00007760: 6365 7373 6564 2061 7267 7320 6672 6f6d  cessed args from
+00007770: 2075 726c 3a20 222b 7374 7228 6141 7267   url: "+str(aArg
+00007780: 466f 7270 6172 7365 7241 4929 2b22 5c72  ForparserAI)+"\r
+00007790: 5c6e 2229 0d0a 0d0a 2020 2020 2323 c2a0  \n")....    ##..
+000077a0: 7072 6f63 6573 7369 6e67 2061 6363 6570  processing accep
+000077b0: 7465 640d 0a20 2020 2067 4c61 7374 5072  ted..    gLastPr
+000077c0: 6f63 6573 7353 7461 7274 5f61 743d 6461  ocessStart_at=da
+000077d0: 7465 7469 6d65 2e75 7463 6e6f 7728 290d  tetime.utcnow().
+000077e0: 0a20 2020 2067 4150 726f 6365 7373 6564  .    gAProcessed
+000077f0: 2e61 7070 656e 6428 5f75 6964 290d 0a0d  .append(_uid)...
+00007800: 0a20 2020 2023 2320 6e6f 7469 6679 204f  .    ## notify O
+00007810: 5341 4953 2028 7374 6172 7429 0d0a 2020  SAIS (start)..  
+00007820: 2020 4372 6564 7350 6172 616d 3d67 6574    CredsParam=get
+00007830: 4372 6564 7350 6172 616d 7328 290d 0a20  CredsParams().. 
+00007840: 2020 204d 6f72 7068 696e 6750 6172 616d     MorphingParam
+00007850: 3d67 6574 4d6f 7270 6869 6e67 5061 7261  =getMorphingPara
+00007860: 6d73 2829 0d0a 2020 2020 5374 6167 6550  ms()..    StageP
+00007870: 6172 616d 3d67 6574 5374 6167 6550 6172  aram=getStagePar
+00007880: 616d 7328 4149 5f50 524f 4752 4553 535f  ams(AI_PROGRESS_
+00007890: 4149 5f53 5441 5254 4544 2c20 3029 0d0a  AI_STARTED, 0)..
+000078a0: 2020 2020 6f73 6169 735f 6e6f 7469 6679      osais_notify
+000078b0: 2843 7265 6473 5061 7261 6d2c 204d 6f72  (CredsParam, Mor
+000078c0: 7068 696e 6750 6172 616d 202c 2053 7461  phingParam , Sta
+000078d0: 6765 5061 7261 6d29 0d0a 0d0a 2020 2020  geParam)....    
+000078e0: 2323 2073 7461 7274 2077 6174 6368 2066  ## start watch f
+000078f0: 696c 6520 6372 6561 7469 6f6e 0d0a 2020  ile creation..  
+00007900: 2020 5f6f 7574 7075 743d 5f67 6574 4f75    _output=_getOu
+00007910: 7470 7574 4469 7228 290d 0a20 2020 2077  tputDir()..    w
+00007920: 6174 6368 5f64 6972 6563 746f 7279 285f  atch_directory(_
+00007930: 6f75 7470 7574 2c20 6f73 6169 735f 6f6e  output, osais_on
+00007940: 4e6f 7469 6679 4669 6c65 4372 6561 7465  NotifyFileCreate
+00007950: 642c 205f 6172 6773 290d 0a0d 0a20 2020  d, _args)....   
+00007960: 2023 2320 4e6f 7469 6620 4f53 4149 530d   ## Notif OSAIS.
+00007970: 0a20 2020 2053 7461 6765 5061 7261 6d3d  .    StageParam=
+00007980: 6765 7453 7461 6765 5061 7261 6d73 2841  getStageParams(A
+00007990: 495f 5052 4f47 5245 5353 5f49 4e49 545f  I_PROGRESS_INIT_
+000079a0: 494d 4147 452c 2030 290d 0a20 2020 206f  IMAGE, 0)..    o
+000079b0: 7361 6973 5f6e 6f74 6966 7928 4372 6564  sais_notify(Cred
+000079c0: 7350 6172 616d 2c20 4d6f 7270 6869 6e67  sParam, Morphing
+000079d0: 5061 7261 6d20 2c20 5374 6167 6550 6172  Param , StagePar
+000079e0: 616d 290d 0a0d 0a20 2020 2023 2320 7275  am)....    ## ru
+000079f0: 6e20 4149 0d0a 2020 2020 7265 7370 6f6e  n AI..    respon
+00007a00: 7365 3d4e 6f6e 650d 0a20 2020 2074 7279  se=None..    try
+00007a10: 3a0d 0a20 2020 2020 2020 2069 6620 6c65  :..        if le
+00007a20: 6e28 6172 6773 293d 3d32 3a0d 0a20 2020  n(args)==2:..   
+00007a30: 2020 2020 2020 2020 2072 6573 706f 6e73           respons
+00007a40: 653d 666e 5f72 756e 2861 4172 6746 6f72  e=fn_run(aArgFor
+00007a50: 7061 7273 6572 4149 290d 0a20 2020 2020  parserAI)..     
+00007a60: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00007a70: 2020 2020 2020 6966 206c 656e 2861 7267        if len(arg
+00007a80: 7329 3d3d 333a 0d0a 2020 2020 2020 2020  s)==3:..        
+00007a90: 2020 2020 2020 2020 7265 7370 6f6e 7365          response
+00007aa0: 3d66 6e5f 7275 6e28 6141 7267 466f 7270  =fn_run(aArgForp
+00007ab0: 6172 7365 7241 492c 2061 7267 735b 325d  arserAI, args[2]
+00007ac0: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+00007ad0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00007ae0: 2020 2020 2020 7265 7370 6f6e 7365 3d66        response=f
+00007af0: 6e5f 7275 6e28 6141 7267 466f 7270 6172  n_run(aArgForpar
+00007b00: 7365 7241 492c 2061 7267 735b 325d 2c20  serAI, args[2], 
+00007b10: 6172 6773 5b33 5d29 0d0a 2020 2020 6578  args[3])..    ex
+00007b20: 6365 7074 2045 7863 6570 7469 6f6e 2061  cept Exception a
+00007b30: 7320 6572 723a 0d0a 2020 2020 2020 2020  s err:..        
+00007b40: 7072 696e 7428 2243 5249 5449 4341 4c3a  print("CRITICAL:
+00007b50: 2022 2b65 7272 2e6d 7367 290d 0a20 2020   "+err.msg)..   
+00007b60: 2020 2020 2072 6169 7365 2065 7272 0d0a       raise err..
+00007b70: 0d0a 2020 2020 2323 2063 616c 6375 6c61  ..    ## calcula
+00007b80: 7465 2063 6f73 740d 0a20 2020 2067 4973  te cost..    gIs
+00007b90: 4275 7379 3d46 616c 7365 0d0a 2020 2020  Busy=False..    
+00007ba0: 656e 645f 6461 7465 203d 2064 6174 6574  end_date = datet
+00007bb0: 696d 652e 7574 636e 6f77 2829 0d0a 2020  ime.utcnow()..  
+00007bc0: 2020 636f 7374 203d 2028 656e 645f 6461    cost = (end_da
+00007bd0: 7465 202d 2062 6567 5f64 6174 6529 2e74  te - beg_date).t
+00007be0: 6f74 616c 5f73 6563 6f6e 6473 2829 0d0a  otal_seconds()..
+00007bf0: 2020 2020 5f61 6464 436f 7374 2863 6f73      _addCost(cos
+00007c00: 7429 0d0a 0d0a 2020 2020 2323 206e 6f74  t)....    ## not
+00007c10: 6966 7920 656e 640d 0a20 2020 2053 7461  ify end..    Sta
+00007c20: 6765 5061 7261 6d3d 6765 7453 7461 6765  geParam=getStage
+00007c30: 5061 7261 6d73 2841 495f 5052 4f47 5245  Params(AI_PROGRE
+00007c40: 5353 5f41 495f 5354 4f50 5045 442c 2063  SS_AI_STOPPED, c
+00007c50: 6f73 7429 0d0a 2020 2020 6f73 6169 735f  ost)..    osais_
+00007c60: 6e6f 7469 6679 2843 7265 6473 5061 7261  notify(CredsPara
+00007c70: 6d2c 204d 6f72 7068 696e 6750 6172 616d  m, MorphingParam
+00007c80: 202c 2053 7461 6765 5061 7261 6d29 0d0a   , StageParam)..
+00007c90: 0d0a 2020 2020 2323 2064 6566 6175 6c74  ..    ## default
+00007ca0: 204f 4b20 7265 7370 6f6e 7365 2069 6620   OK response if 
+00007cb0: 7468 6520 4149 2064 6f65 7320 6e6f 7420  the AI does not 
+00007cc0: 7365 6e64 2061 6e79 0d0a 2020 2020 6966  send any..    if
+00007cd0: 2072 6573 706f 6e73 653d 3d4e 6f6e 653a   response==None:
+00007ce0: 0d0a 2020 2020 2020 2020 7265 7370 6f6e  ..        respon
+00007cf0: 7365 3d54 7275 650d 0a20 2020 2072 6574  se=True..    ret
+00007d00: 7572 6e20 7265 7370 6f6e 7365 0d0a 0d0a  urn response....
+00007d10: 2323 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ## -------------
 00007d20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00007d30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
 00007d40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00007d50: 2d2d 2d2d 2d0d 0a0d 0a64 6566 2067 6574  -----....def get
-00007d60: 4372 6564 7350 6172 616d 7328 2920 3a0d  CredsParams() :.
-00007d70: 0a20 2020 2067 6c6f 6261 6c20 674e 616d  .    global gNam
-00007d80: 650d 0a20 2020 2067 6c6f 6261 6c20 6741  e..    global gA
-00007d90: 7267 734f 5341 4953 0d0a 2020 2020 7265  rgsOSAIS..    re
-00007da0: 7475 726e 207b 0d0a 2020 2020 2020 2020  turn {..        
-00007db0: 2265 6e67 696e 6522 3a20 674e 616d 652c  "engine": gName,
-00007dc0: 200d 0a20 2020 2020 2020 2022 746f 6b65   ..        "toke
-00007dd0: 6e41 4922 3a20 6741 7267 734f 5341 4953  nAI": gArgsOSAIS
-00007de0: 2e74 6f6b 656e 4149 2c0d 0a20 2020 2020  .tokenAI,..     
-00007df0: 2020 2022 7573 6572 6e61 6d65 223a 2067     "username": g
-00007e00: 4172 6773 4f53 4149 532e 7573 6572 6e61  ArgsOSAIS.userna
-00007e10: 6d65 2c0d 0a20 2020 2020 2020 2022 6973  me,..        "is
-00007e20: 4c6f 6361 6c22 3a20 6741 7267 734f 5341  Local": gArgsOSA
-00007e30: 4953 2e69 734c 6f63 616c 0d0a 2020 2020  IS.isLocal..    
-00007e40: 7d20 0d0a 0d0a 6465 6620 6765 744d 6f72  } ....def getMor
-00007e50: 7068 696e 6750 6172 616d 7328 2920 3a0d  phingParams() :.
-00007e60: 0a20 2020 2067 6c6f 6261 6c20 6741 7267  .    global gArg
-00007e70: 734f 5341 4953 0d0a 2020 2020 7265 7475  sOSAIS..    retu
-00007e80: 726e 207b 0d0a 2020 2020 2020 2020 2275  rn {..        "u
-00007e90: 6964 223a 2067 4172 6773 4f53 4149 532e  id": gArgsOSAIS.
-00007ea0: 7569 642c 0d0a 2020 2020 2020 2020 2263  uid,..        "c
-00007eb0: 7963 6c65 223a 2067 4172 6773 4f53 4149  ycle": gArgsOSAI
-00007ec0: 532e 6379 636c 652c 0d0a 2020 2020 2020  S.cycle,..      
-00007ed0: 2020 2266 696c 656e 616d 6522 3a20 6741    "filename": gA
-00007ee0: 7267 734f 5341 4953 2e66 696c 656e 616d  rgsOSAIS.filenam
-00007ef0: 652c 200d 0a20 2020 2020 2020 2022 6f64  e, ..        "od
-00007f00: 6972 223a 205f 6765 744f 7574 7075 7444  ir": _getOutputD
-00007f10: 6972 2829 0d0a 2020 2020 7d0d 0a0d 0a64  ir()..    }....d
-00007f20: 6566 2067 6574 5374 6167 6550 6172 616d  ef getStageParam
-00007f30: 7328 5f73 7461 6765 2c20 5f63 6f73 7429  s(_stage, _cost)
-00007f40: 203a 0d0a 2020 2020 676c 6f62 616c 2067   :..    global g
-00007f50: 4172 6773 4f53 4149 530d 0a20 2020 2069  ArgsOSAIS..    i
-00007f60: 6620 5f73 7461 6765 3d3d 4149 5f50 524f  f _stage==AI_PRO
-00007f70: 4752 4553 535f 4152 4753 3a0d 0a20 2020  GRESS_ARGS:..   
-00007f80: 2020 2020 2072 6574 7572 6e20 7b22 7374       return {"st
-00007f90: 6167 6522 3a20 4149 5f50 524f 4752 4553  age": AI_PROGRES
-00007fa0: 535f 4149 5f53 5441 5254 4544 2c20 2264  S_AI_STARTED, "d
-00007fb0: 6573 6372 223a 224a 7573 7420 7061 7273  escr":"Just pars
-00007fc0: 6564 2041 4920 7061 7261 6d73 227d 0d0a  ed AI params"}..
-00007fd0: 2020 2020 6966 205f 7374 6167 653d 3d41      if _stage==A
-00007fe0: 495f 5052 4f47 5245 5353 5f45 5252 4f52  I_PROGRESS_ERROR
-00007ff0: 3a0d 0a20 2020 2020 2020 2072 6574 7572  :..        retur
-00008000: 6e20 7b22 7374 6167 6522 3a20 4149 5f50  n {"stage": AI_P
-00008010: 524f 4752 4553 535f 4149 5f53 544f 5050  ROGRESS_AI_STOPP
-00008020: 4544 2c20 2264 6573 6372 223a 2241 4920  ED, "descr":"AI 
-00008030: 7374 6f70 7065 6420 7769 7468 2065 7272  stopped with err
-00008040: 6f72 227d 0d0a 2020 2020 6966 205f 7374  or"}..    if _st
-00008050: 6167 653d 3d41 495f 5052 4f47 5245 5353  age==AI_PROGRESS
-00008060: 5f41 495f 5354 4152 5445 443a 0d0a 2020  _AI_STARTED:..  
-00008070: 2020 2020 2020 7265 7475 726e 207b 2273        return {"s
-00008080: 7461 6765 223a 2041 495f 5052 4f47 5245  tage": AI_PROGRE
-00008090: 5353 5f41 495f 5354 4152 5445 442c 2022  SS_AI_STARTED, "
-000080a0: 6465 7363 7222 3a22 4149 2073 7461 7274  descr":"AI start
-000080b0: 6564 227d 0d0a 2020 2020 6966 205f 7374  ed"}..    if _st
-000080c0: 6167 653d 3d41 495f 5052 4f47 5245 5353  age==AI_PROGRESS
-000080d0: 5f41 495f 5354 4f50 5045 443a 0d0a 2020  _AI_STOPPED:..  
-000080e0: 2020 2020 2020 7265 7475 726e 207b 2273        return {"s
-000080f0: 7461 6765 223a 2041 495f 5052 4f47 5245  tage": AI_PROGRE
-00008100: 5353 5f41 495f 5354 4f50 5045 442c 2022  SS_AI_STOPPED, "
-00008110: 6465 7363 7222 3a22 4149 2073 746f 7070  descr":"AI stopp
-00008120: 6564 222c 2022 636f 7374 223a 205f 636f  ed", "cost": _co
-00008130: 7374 7d0d 0a20 2020 2069 6620 5f73 7461  st}..    if _sta
-00008140: 6765 3d3d 4149 5f50 524f 4752 4553 535f  ge==AI_PROGRESS_
-00008150: 494e 4954 5f49 4d41 4745 3a0d 0a20 2020  INIT_IMAGE:..   
-00008160: 2020 2020 2072 6574 7572 6e20 7b22 7374       return {"st
-00008170: 6167 6522 3a20 4149 5f50 524f 4752 4553  age": AI_PROGRES
-00008180: 535f 494e 4954 5f49 4d41 4745 2c20 2264  S_INIT_IMAGE, "d
-00008190: 6573 6372 223a 2264 6573 7469 6e61 7469  escr":"destinati
-000081a0: 6f6e 2069 6d61 6765 203d 2022 2b67 4172  on image = "+gAr
-000081b0: 6773 4f53 4149 532e 6669 6c65 6e61 6d65  gsOSAIS.filename
-000081c0: 7d0d 0a20 2020 2069 6620 5f73 7461 6765  }..    if _stage
-000081d0: 3d3d 4149 5f50 524f 4752 4553 535f 444f  ==AI_PROGRESS_DO
-000081e0: 4e45 5f49 4d41 4745 3a0d 0a20 2020 2020  NE_IMAGE:..     
-000081f0: 2020 2072 6574 7572 6e20 7b22 7374 6167     return {"stag
-00008200: 6522 3a20 4149 5f50 524f 4752 4553 535f  e": AI_PROGRESS_
-00008210: 444f 4e45 5f49 4d41 4745 2c20 2264 6573  DONE_IMAGE, "des
-00008220: 6372 223a 2263 6f70 6965 6420 696e 7075  cr":"copied inpu
-00008230: 7420 696d 6167 6520 746f 2064 6573 7469  t image to desti
-00008240: 6e61 7469 6f6e 2069 6d61 6765 227d 0d0a  nation image"}..
-00008250: 2020 2020 7265 7475 726e 207b 2273 7461      return {"sta
-00008260: 6765 223a 2041 495f 5052 4f47 5245 5353  ge": AI_PROGRESS
-00008270: 5f45 5252 4f52 2c20 2264 6573 6372 223a  _ERROR, "descr":
-00008280: 2265 7272 6f72 227d 0d0a 0d0a 2323 202d  "error"}....## -
-00008290: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000082a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000082b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000082c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000082d0: 2d2d 2d2d 2d2d 2d0d 0a23 2020 2020 2020  -------..#      
-000082e0: 204e 6f74 6966 6963 6174 696f 6e73 2074   Notifications t
-000082f0: 6f20 4761 7465 7761 7920 2f20 4f53 4149  o Gateway / OSAI
-00008300: 530d 0a23 2320 2d2d 2d2d 2d2d 2d2d 2d2d  S..## ----------
-00008310: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00008320: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00008330: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00008340: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  --------------..
-00008350: 0d0a 2320 5570 6c6f 6164 2069 6d61 6765  ..# Upload image
-00008360: 2074 6f20 4f53 4149 5320 0d0a 6465 6620   to OSAIS ..def 
-00008370: 5f75 706c 6f61 6449 6d61 6765 546f 4f53  _uploadImageToOS
-00008380: 4149 5328 6f62 6a50 6172 616d 2c20 6973  AIS(objParam, is
-00008390: 4c6f 6361 6c29 3a0d 0a20 2020 2069 6620  Local):..    if 
-000083a0: 6749 7356 6972 7475 616c 4149 3d3d 4661  gIsVirtualAI==Fa
-000083b0: 6c73 653a 0d0a 2020 2020 2020 2020 7265  lse:..        re
-000083c0: 7475 726e 204e 6f6e 650d 0a20 2020 200d  turn None..    .
-000083d0: 0a20 2020 2067 6c6f 6261 6c20 6741 7574  .    global gAut
-000083e0: 6854 6f6b 656e 0d0a 2020 2020 676c 6f62  hToken..    glob
-000083f0: 616c 2067 4f72 6967 696e 4f53 4149 530d  al gOriginOSAIS.
-00008400: 0a20 2020 2067 6c6f 6261 6c20 6741 7574  .    global gAut
-00008410: 6854 6f6b 656e 4c6f 6361 6c0d 0a20 2020  hTokenLocal..   
-00008420: 2067 6c6f 6261 6c20 674f 7269 6769 6e4c   global gOriginL
-00008430: 6f63 616c 4f53 4149 530d 0a0d 0a20 2020  ocalOSAIS....   
-00008440: 205f 6175 7468 3d67 4175 7468 546f 6b65   _auth=gAuthToke
-00008450: 6e0d 0a20 2020 2069 6620 6973 4c6f 6361  n..    if isLoca
-00008460: 6c3a 0d0a 2020 2020 2020 2020 5f61 7574  l:..        _aut
-00008470: 683d 6741 7574 6854 6f6b 656e 4c6f 6361  h=gAuthTokenLoca
-00008480: 6c0d 0a20 2020 205f 6f73 6169 733d 674f  l..    _osais=gO
-00008490: 7269 6769 6e4f 5341 4953 0d0a 2020 2020  riginOSAIS..    
-000084a0: 6966 2069 734c 6f63 616c 3a0d 0a20 2020  if isLocal:..   
-000084b0: 2020 2020 205f 6f73 6169 733d 674f 7269       _osais=gOri
-000084c0: 6769 6e4c 6f63 616c 4f53 4149 530d 0a0d  ginLocalOSAIS...
-000084d0: 0a20 2020 2023 206c 6574 7320 676f 2063  .    # lets go c
-000084e0: 616c 6c20 4f53 4149 5320 4149 2047 6174  all OSAIS AI Gat
-000084f0: 6577 6179 202f 206f 7220 4f53 4149 5320  eway / or OSAIS 
-00008500: 6974 7365 6c66 0d0a 2020 2020 6865 6164  itself..    head
-00008510: 6572 7320 3d20 7b0d 0a20 2020 2020 2020  ers = {..       
-00008520: 2022 436f 6e74 656e 742d 5479 7065 223a   "Content-Type":
-00008530: 2027 6170 706c 6963 6174 696f 6e2f 6a73   'application/js
-00008540: 6f6e 272c 200d 0a20 2020 2020 2020 2027  on', ..        '
-00008550: 4163 6365 7074 273a 2027 7465 7874 2f70  Accept': 'text/p
-00008560: 6c61 696e 272c 0d0a 2020 2020 2020 2020  lain',..        
-00008570: 2241 7574 686f 7269 7a61 7469 6f6e 223a  "Authorization":
-00008580: 2066 2242 6561 7265 7220 7b5f 6175 7468   f"Bearer {_auth
-00008590: 7d22 0d0a 2020 2020 7d0d 0a0d 0a20 2020  }"..    }....   
-000085a0: 2061 7069 5f75 726c 3d66 227b 5f6f 7361   api_url=f"{_osa
-000085b0: 6973 7d61 7069 2f76 312f 7072 6976 6174  is}api/v1/privat
-000085c0: 652f 7570 6c6f 6164 2220 2020 2020 2020  e/upload"       
-000085d0: 200d 0a20 2020 2070 6179 6c6f 6164 203d   ..    payload =
-000085e0: 206a 736f 6e2e 6475 6d70 7328 6f62 6a50   json.dumps(objP
-000085f0: 6172 616d 290d 0a20 2020 2072 6573 706f  aram)..    respo
-00008600: 6e73 6520 3d20 7265 7175 6573 7473 2e70  nse = requests.p
-00008610: 6f73 7428 6170 695f 7572 6c2c 2068 6561  ost(api_url, hea
-00008620: 6465 7273 3d68 6561 6465 7273 2c20 6461  ders=headers, da
-00008630: 7461 3d70 6179 6c6f 6164 2029 0d0a 2020  ta=payload )..  
-00008640: 2020 6f62 6a52 6573 3d72 6573 706f 6e73    objRes=respons
-00008650: 652e 6a73 6f6e 2829 0d0a 2020 2020 7265  e.json()..    re
-00008660: 7475 726e 206f 626a 5265 7320 2020 200d  turn objRes    .
-00008670: 0a0d 0a64 6566 206f 7361 6973 5f6f 6e4e  ...def osais_onN
-00008680: 6f74 6966 7946 696c 6543 7265 6174 6564  otifyFileCreated
-00008690: 285f 6469 722c 205f 6669 6c65 6e61 6d65  (_dir, _filename
-000086a0: 2c20 5f61 7267 7329 3a0d 0a20 2020 2067  , _args):..    g
-000086b0: 4172 6773 4f53 4149 532e 6669 6c65 6e61  ArgsOSAIS.filena
-000086c0: 6d65 3d5f 6669 6c65 6e61 6d65 0d0a 2020  me=_filename..  
-000086d0: 2020 5f73 7461 6765 5061 7261 6d3d 6765    _stageParam=ge
-000086e0: 7453 7461 6765 5061 7261 6d73 2841 495f  tStageParams(AI_
-000086f0: 5052 4f47 5245 5353 5f44 4f4e 455f 494d  PROGRESS_DONE_IM
-00008700: 4147 452c 2030 290d 0a20 2020 205f 6d6f  AGE, 0)..    _mo
-00008710: 7270 6869 6e67 5061 7261 6d3d 6765 744d  rphingParam=getM
-00008720: 6f72 7068 696e 6750 6172 616d 7328 290d  orphingParams().
-00008730: 0a20 2020 205f 6372 6564 7350 6172 616d  .    _credsParam
-00008740: 3d67 6574 4372 6564 7350 6172 616d 7328  =getCredsParams(
-00008750: 290d 0a20 2020 206f 7361 6973 5f6e 6f74  )..    osais_not
-00008760: 6966 7928 5f63 7265 6473 5061 7261 6d2c  ify(_credsParam,
-00008770: 205f 6d6f 7270 6869 6e67 5061 7261 6d2c   _morphingParam,
-00008780: 205f 7374 6167 6550 6172 616d 2920 2020   _stageParam)   
-00008790: 2020 2020 2020 2020 2023 204f 5341 4953           # OSAIS
-000087a0: 204e 6f74 6966 6963 6174 696f 6e0d 0a20   Notification.. 
-000087b0: 2020 2072 6574 7572 6e20 5472 7565 0d0a     return True..
-000087c0: 0d0a 2320 4469 7265 6374 204e 6f74 6966  ..# Direct Notif
-000087d0: 7920 4f53 4149 5320 0d0a 6465 6620 6f73  y OSAIS ..def os
-000087e0: 6169 735f 6e6f 7469 6679 2843 7265 6450  ais_notify(CredP
-000087f0: 6172 616d 2c20 4d6f 7270 6869 6e67 5061  aram, MorphingPa
-00008800: 7261 6d2c 2053 7461 6765 5061 7261 6d29  ram, StageParam)
-00008810: 3a0d 0a20 2020 2067 6c6f 6261 6c20 6749  :..    global gI
-00008820: 504c 6f63 616c 0d0a 2020 2020 676c 6f62  PLocal..    glob
-00008830: 616c 2067 506f 7274 4761 7465 7761 790d  al gPortGateway.
-00008840: 0a20 2020 2067 6c6f 6261 6c20 674f 7269  .    global gOri
-00008850: 6769 6e4f 5341 4953 0d0a 2020 2020 676c  ginOSAIS..    gl
-00008860: 6f62 616c 2067 4f72 6967 696e 4c6f 6361  obal gOriginLoca
-00008870: 6c4f 5341 4953 0d0a 2020 2020 676c 6f62  lOSAIS..    glob
-00008880: 616c 2067 4973 5669 7274 7561 6c41 490d  al gIsVirtualAI.
-00008890: 0a20 2020 2067 6c6f 6261 6c20 6741 7574  .    global gAut
-000088a0: 6854 6f6b 656e 0d0a 2020 2020 676c 6f62  hToken..    glob
-000088b0: 616c 2067 4175 7468 546f 6b65 6e4c 6f63  al gAuthTokenLoc
-000088c0: 616c 0d0a 2020 2020 676c 6f62 616c 2067  al..    global g
-000088d0: 4c61 7374 4368 6563 6b65 645f 6174 0d0a  LastChecked_at..
-000088e0: 2020 2020 676c 6f62 616c 2067 4973 5761      global gIsWa
-000088f0: 726d 7570 0d0a 0d0a 2020 2020 2323 206e  rmup....    ## n
-00008900: 6f20 6e6f 7469 6669 6361 7469 6f6e 206f  o notification o
-00008910: 6620 7761 726d 7570 0d0a 2020 2020 6966  f warmup..    if
-00008920: 2067 4973 5761 726d 7570 3a0d 0a20 2020   gIsWarmup:..   
-00008930: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
-00008940: 0d0a 2020 2020 0d0a 2020 2020 674c 6173  ..    ..    gLas
-00008950: 7443 6865 636b 6564 5f61 7420 3d20 6461  tChecked_at = da
-00008960: 7465 7469 6d65 2e75 7463 6e6f 7728 290d  tetime.utcnow().
-00008970: 0a0d 0a20 2020 2023 206e 6f74 6966 6963  ...    # notific
-00008980: 6174 696f 6e20 636f 6e73 6f6c 6520 6c6f  ation console lo
-00008990: 670d 0a20 2020 206d 6572 6765 6420 3d20  g..    merged = 
-000089a0: 6469 6374 2829 0d0a 2020 2020 6d65 7267  dict()..    merg
-000089b0: 6564 2e75 7064 6174 6528 4372 6564 5061  ed.update(CredPa
-000089c0: 7261 6d29 0d0a 2020 2020 6d65 7267 6564  ram)..    merged
-000089d0: 2e75 7064 6174 6528 4d6f 7270 6869 6e67  .update(Morphing
-000089e0: 5061 7261 6d29 0d0a 2020 2020 7072 696e  Param)..    prin
-000089f0: 7428 224e 6f74 6966 794f 5341 4953 2028  t("NotifyOSAIS (
-00008a00: 222b 7374 7228 5374 6167 6550 6172 616d  "+str(StageParam
-00008a10: 5b22 7374 6167 6522 5d29 2b22 2f20 222b  ["stage"])+"/ "+
-00008a20: 5374 6167 6550 6172 616d 5b22 6465 7363  StageParam["desc
-00008a30: 7222 5d2b 2229 3a20 222b 7374 7228 6d65  r"]+"): "+str(me
-00008a40: 7267 6564 2929 0d0a 2020 2020 7072 696e  rged))..    prin
-00008a50: 7428 225c 725c 6e22 290d 0a0d 0a20 2020  t("\r\n")....   
-00008a60: 205f 6669 6c65 6e61 6d65 3d22 220d 0a20   _filename="".. 
-00008a70: 2020 2069 6620 4d6f 7270 6869 6e67 5061     if MorphingPa
-00008a80: 7261 6d5b 2266 696c 656e 616d 6522 5d21  ram["filename"]!
-00008a90: 3d22 223a 0d0a 2020 2020 2020 2020 5f66  ="":..        _f
-00008aa0: 696c 656e 616d 653d 4d6f 7270 6869 6e67  ilename=Morphing
-00008ab0: 5061 7261 6d5b 2266 696c 656e 616d 6522  Param["filename"
-00008ac0: 5d0d 0a0d 0a20 2020 2023 206c 6574 7320  ]....    # lets 
-00008ad0: 676f 2063 616c 6c20 4f53 4149 5320 4149  go call OSAIS AI
-00008ae0: 2047 6174 6577 6179 202f 206f 7220 4f53   Gateway / or OS
-00008af0: 4149 5320 6974 7365 6c66 0d0a 2020 2020  AIS itself..    
-00008b00: 6865 6164 6572 7320 3d20 7b0d 0a20 2020  headers = {..   
-00008b10: 2020 2020 2022 436f 6e74 656e 742d 5479       "Content-Ty
-00008b20: 7065 223a 2022 6170 706c 6963 6174 696f  pe": "applicatio
-00008b30: 6e2f 6a73 6f6e 220d 0a20 2020 207d 0d0a  n/json"..    }..
-00008b40: 0d0a 2020 2020 2323 2063 6f6e 6669 6720  ..    ## config 
-00008b50: 666f 7220 6361 6c6c 696e 6720 6761 7465  for calling gate
-00008b60: 7761 790d 0a20 2020 2061 7069 5f75 726c  way..    api_url
-00008b70: 203d 2066 227b 674f 7269 6769 6e47 6174   = f"{gOriginGat
-00008b80: 6577 6179 7d61 7069 2f76 312f 7075 626c  eway}api/v1/publ
-00008b90: 6963 2f6e 6f74 6966 7922 0d0a 0d0a 2020  ic/notify"....  
-00008ba0: 2020 2323 2063 6f6e 6669 6720 666f 7220    ## config for 
-00008bb0: 6361 6c6c 696e 6720 4f53 4149 5320 286e  calling OSAIS (n
-00008bc0: 6f20 6761 7465 7761 7929 0d0a 2020 2020  o gateway)..    
-00008bd0: 6966 2067 4973 5669 7274 7561 6c41 493a  if gIsVirtualAI:
-00008be0: 0d0a 2020 2020 2020 2020 5f6f 7361 6973  ..        _osais
-00008bf0: 3d67 4f72 6967 696e 4f53 4149 530d 0a20  =gOriginOSAIS.. 
-00008c00: 2020 2020 2020 205f 6175 7468 3d67 4175         _auth=gAu
-00008c10: 7468 546f 6b65 6e0d 0a0d 0a20 2020 2020  thToken....     
-00008c20: 2020 2069 6620 4372 6564 5061 7261 6d5b     if CredParam[
-00008c30: 2269 734c 6f63 616c 225d 3a0d 0a20 2020  "isLocal"]:..   
-00008c40: 2020 2020 2020 2020 205f 6f73 6169 733d           _osais=
-00008c50: 674f 7269 6769 6e4c 6f63 616c 4f53 4149  gOriginLocalOSAI
-00008c60: 530d 0a20 2020 2020 2020 2020 2020 205f  S..            _
-00008c70: 6175 7468 3d67 4175 7468 546f 6b65 6e4c  auth=gAuthTokenL
-00008c80: 6f63 616c 0d0a 0d0a 2020 2020 2020 2020  ocal....        
-00008c90: 6966 2067 4973 5669 7274 7561 6c41 493d  if gIsVirtualAI=
-00008ca0: 3d54 7275 653a 0d0a 2020 2020 2020 2020  =True:..        
-00008cb0: 2020 2020 6865 6164 6572 735b 2241 7574      headers["Aut
-00008cc0: 686f 7269 7a61 7469 6f6e 225d 3d20 6622  horization"]= f"
-00008cd0: 4265 6172 6572 207b 5f61 7574 687d 220d  Bearer {_auth}".
-00008ce0: 0a20 2020 2020 2020 2020 2020 2061 7069  .            api
-00008cf0: 5f75 726c 3d66 227b 5f6f 7361 6973 7d61  _url=f"{_osais}a
-00008d00: 7069 2f76 312f 7072 6976 6174 652f 6e6f  pi/v1/private/no
-00008d10: 7469 6679 220d 0a0d 0a20 2020 206f 626a  tify"....    obj
-00008d20: 5061 7261 6d3d 7b0d 0a20 2020 2020 2020  Param={..       
-00008d30: 2022 7265 7370 6f6e 7365 223a 207b 0d0a   "response": {..
-00008d40: 2020 2020 2020 2020 2020 2020 2274 6f6b              "tok
-00008d50: 656e 223a 2043 7265 6450 6172 616d 5b22  en": CredParam["
-00008d60: 746f 6b65 6e41 4922 5d2c 0d0a 2020 2020  tokenAI"],..    
-00008d70: 2020 2020 2020 2020 2275 6964 223a 2073          "uid": s
-00008d80: 7472 284d 6f72 7068 696e 6750 6172 616d  tr(MorphingParam
-00008d90: 5b22 7569 6422 5d29 2c0d 0a20 2020 2020  ["uid"]),..     
-00008da0: 2020 2020 2020 2022 7374 6167 6522 3a20         "stage": 
-00008db0: 7374 7228 5374 6167 6550 6172 616d 5b22  str(StageParam["
-00008dc0: 7374 6167 6522 5d29 2c0d 0a20 2020 2020  stage"]),..     
-00008dd0: 2020 2020 2020 2022 6379 636c 6522 3a20         "cycle": 
-00008de0: 7374 7228 4d6f 7270 6869 6e67 5061 7261  str(MorphingPara
-00008df0: 6d5b 2263 7963 6c65 225d 292c 0d0a 2020  m["cycle"]),..  
-00008e00: 2020 2020 2020 2020 2020 2265 6e67 696e            "engin
-00008e10: 6522 3a20 4372 6564 5061 7261 6d5b 2265  e": CredParam["e
-00008e20: 6e67 696e 6522 5d2c 0d0a 2020 2020 2020  ngine"],..      
-00008e30: 2020 2020 2020 2275 7365 726e 616d 6522        "username"
-00008e40: 3a20 4372 6564 5061 7261 6d5b 2275 7365  : CredParam["use
-00008e50: 726e 616d 6522 5d2c 0d0a 2020 2020 2020  rname"],..      
-00008e60: 2020 2020 2020 2264 6573 6372 223a 2053        "descr": S
-00008e70: 7461 6765 5061 7261 6d5b 2264 6573 6372  tageParam["descr
-00008e80: 225d 2c0d 0a20 2020 2020 2020 2020 2020  "],..           
-00008e90: 2022 6669 6c65 6e61 6d65 223a 205f 6669   "filename": _fi
-00008ea0: 6c65 6e61 6d65 0d0a 2020 2020 2020 2020  lename..        
-00008eb0: 7d0d 0a20 2020 207d 0d0a 0d0a 2020 2020  }..    }....    
-00008ec0: 6966 2022 636f 7374 2220 696e 2053 7461  if "cost" in Sta
-00008ed0: 6765 5061 7261 6d3a 0d0a 2020 2020 2020  geParam:..      
-00008ee0: 2020 6f62 6a50 6172 616d 5b22 7265 7370    objParam["resp
-00008ef0: 6f6e 7365 225d 5b22 636f 7374 225d 3d20  onse"]["cost"]= 
-00008f00: 7374 7228 5374 6167 6550 6172 616d 5b22  str(StageParam["
-00008f10: 636f 7374 225d 290d 0a20 2020 200d 0a20  cost"])..    .. 
-00008f20: 2020 2072 6573 706f 6e73 6520 3d20 7265     response = re
-00008f30: 7175 6573 7473 2e70 6f73 7428 6170 695f  quests.post(api_
-00008f40: 7572 6c2c 2068 6561 6465 7273 3d68 6561  url, headers=hea
-00008f50: 6465 7273 2c20 6461 7461 3d6a 736f 6e2e  ders, data=json.
-00008f60: 6475 6d70 7328 6f62 6a50 6172 616d 2920  dumps(objParam) 
-00008f70: 290d 0a20 2020 206f 626a 5265 733d 7265  )..    objRes=re
-00008f80: 7370 6f6e 7365 2e6a 736f 6e28 290d 0a0d  sponse.json()...
-00008f90: 0a20 2020 2069 6620 5374 6167 6550 6172  .    if StagePar
-00008fa0: 616d 5b22 7374 6167 6522 5d3d 3d41 495f  am["stage"]==AI_
-00008fb0: 5052 4f47 5245 5353 5f44 4f4e 455f 494d  PROGRESS_DONE_IM
-00008fc0: 4147 453a 0d0a 2020 2020 2020 2020 6966  AGE:..        if
-00008fd0: 2067 4973 5669 7274 7561 6c41 493d 3d54   gIsVirtualAI==T
-00008fe0: 7275 653a 0d0a 2020 2020 2020 2020 2020  rue:..          
-00008ff0: 2020 5f64 6972 3d4d 6f72 7068 696e 6750    _dir=MorphingP
-00009000: 6172 616d 5b22 6f64 6972 225d 0d0a 2020  aram["odir"]..  
-00009010: 2020 2020 2020 2020 2020 6966 205f 6469            if _di
-00009020: 723d 3d4e 6f6e 653a 0d0a 2020 2020 2020  r==None:..      
-00009030: 2020 2020 2020 2020 2020 5f64 6972 3d67            _dir=g
-00009040: 4f75 7470 7574 4469 720d 0a20 2020 2020  OutputDir..     
-00009050: 2020 2020 2020 205f 6469 7249 6d61 6765         _dirImage
-00009060: 3d5f 6469 722b 5f66 696c 656e 616d 650d  =_dir+_filename.
-00009070: 0a0d 0a20 2020 2020 2020 2020 2020 2077  ...            w
-00009080: 6974 6820 6f70 656e 285f 6469 7249 6d61  ith open(_dirIma
-00009090: 6765 2c20 2272 6222 2920 6173 2069 6d61  ge, "rb") as ima
-000090a0: 6765 5f66 696c 653a 0d0a 2020 2020 2020  ge_file:..      
-000090b0: 2020 2020 2020 2020 2020 696d 6167 655f            image_
-000090c0: 6461 7461 203d 2069 6d61 6765 5f66 696c  data = image_fil
-000090d0: 652e 7265 6164 2829 0d0a 0d0a 2020 2020  e.read()....    
-000090e0: 2020 2020 2020 2020 696d 5f62 3634 203d          im_b64 =
-000090f0: 2062 6173 6536 342e 6236 3465 6e63 6f64   base64.b64encod
-00009100: 6528 696d 6167 655f 6461 7461 292e 6465  e(image_data).de
-00009110: 636f 6465 2822 7574 6638 2229 0d0a 2020  code("utf8")..  
-00009120: 2020 2020 2020 2020 2020 7061 7261 6d3d            param=
-00009130: 7b0d 0a20 2020 2020 2020 2020 2020 2020  {..             
-00009140: 2020 2022 696d 6167 6522 3a20 696d 5f62     "image": im_b
-00009150: 3634 2c0d 0a20 2020 2020 2020 2020 2020  64,..           
-00009160: 2020 2020 2022 7569 6422 3a20 7374 7228       "uid": str(
-00009170: 4d6f 7270 6869 6e67 5061 7261 6d5b 2275  MorphingParam["u
-00009180: 6964 225d 292c 0d0a 2020 2020 2020 2020  id"]),..        
-00009190: 2020 2020 2020 2020 2263 7963 6c65 223a          "cycle":
-000091a0: 2073 7472 284d 6f72 7068 696e 6750 6172   str(MorphingPar
-000091b0: 616d 5b22 6379 636c 6522 5d29 2c0d 0a20  am["cycle"]),.. 
-000091c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000091d0: 656e 6769 6e65 223a 2043 7265 6450 6172  engine": CredPar
-000091e0: 616d 5b22 656e 6769 6e65 225d 2c0d 0a20  am["engine"],.. 
-000091f0: 2020 2020 2020 2020 2020 207d 2020 2020             }    
-00009200: 2020 2020 2020 2020 0d0a 2020 2020 2020          ..      
-00009210: 2020 2020 2020 5f75 706c 6f61 6449 6d61        _uploadIma
-00009220: 6765 546f 4f53 4149 5328 7061 7261 6d2c  geToOSAIS(param,
-00009230: 2043 7265 6450 6172 616d 5b22 6973 4c6f   CredParam["isLo
-00009240: 6361 6c22 5d29 0d0a 2020 2020 7265 7475  cal"])..    retu
-00009250: 726e 206f 626a 5265 730d 0a0d 0a23 2320  rn objRes....## 
-00009260: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009270: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009280: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009290: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000092a0: 2d2d 2d2d 2d2d 2d2d 0d0a 2320 2020 2020  --------..#     
-000092b0: 2020 496e 6974 2070 726f 6365 7373 696e    Init processin
-000092c0: 670d 0a23 2320 2d2d 2d2d 2d2d 2d2d 2d2d  g..## ----------
-000092d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000092e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000092f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009300: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  --------------..
-00009310: 0d0a 2323 2050 5542 4c49 4320 2d20 7265  ..## PUBLIC - re
-00009320: 7365 7474 696e 6720 7768 6f20 7468 6973  setting who this
-00009330: 2041 4920 6973 2074 616c 6b69 6e67 2074   AI is talking t
-00009340: 6f20 284f 5341 4953 2070 726f 6420 616e  o (OSAIS prod an
-00009350: 6420 6462 6729 0d0a 6465 6620 6f73 6169  d dbg)..def osai
-00009360: 735f 7265 7365 744f 5341 4953 285f 6c6f  s_resetOSAIS(_lo
-00009370: 6361 7469 6f6e 5072 6f64 2c20 5f6c 6f63  cationProd, _loc
-00009380: 616c 7469 6f6e 4465 6275 6729 3a0d 0a20  altionDebug):.. 
-00009390: 2020 2067 6c6f 6261 6c20 674f 7269 6769     global gOrigi
-000093a0: 6e4f 5341 4953 0d0a 2020 2020 676c 6f62  nOSAIS..    glob
-000093b0: 616c 2067 4f72 6967 696e 4c6f 6361 6c4f  al gOriginLocalO
-000093c0: 5341 4953 0d0a 2020 2020 674f 7269 6769  SAIS..    gOrigi
-000093d0: 6e4f 5341 4953 3d5f 6c6f 6361 7469 6f6e  nOSAIS=_location
-000093e0: 5072 6f64 0d0a 2020 2020 674f 7269 6769  Prod..    gOrigi
-000093f0: 6e4c 6f63 616c 4f53 4149 533d 5f6c 6f63  nLocalOSAIS=_loc
-00009400: 616c 7469 6f6e 4465 6275 670d 0a20 2020  altionDebug..   
-00009410: 2069 6620 5f6c 6f63 6174 696f 6e50 726f   if _locationPro
-00009420: 6421 3d4e 6f6e 653a 0d0a 2020 2020 2020  d!=None:..      
-00009430: 2020 7072 696e 7428 223d 3e20 5468 6973    print("=> This
-00009440: 2041 4920 6973 2072 6573 6574 2074 6f20   AI is reset to 
-00009450: 7461 6c6b 2074 6f20 5052 4f44 2022 2b67  talk to PROD "+g
-00009460: 4f72 6967 696e 4f53 4149 5329 0d0a 2020  OriginOSAIS)..  
-00009470: 2020 6966 205f 6c6f 6361 6c74 696f 6e44    if _localtionD
-00009480: 6562 7567 213d 4e6f 6e65 3a0d 0a20 2020  ebug!=None:..   
-00009490: 2020 2020 2070 7269 6e74 2822 3d3e 2054       print("=> T
-000094a0: 6869 7320 4149 2069 7320 7265 7365 7420  his AI is reset 
-000094b0: 746f 2074 616c 6b20 746f 2044 4542 5547  to talk to DEBUG
-000094c0: 2022 2b67 4f72 6967 696e 4c6f 6361 6c4f   "+gOriginLocalO
-000094d0: 5341 4953 2b22 5c72 5c6e 2229 0d0a 2020  SAIS+"\r\n")..  
-000094e0: 2020 7265 7475 726e 2054 7275 650d 0a0d    return True...
-000094f0: 0a23 2320 5055 424c 4943 202d 2049 6e69  .## PUBLIC - Ini
-00009500: 7420 7468 6520 5669 7274 7561 6c20 4149  t the Virtual AI
-00009510: 0d0a 6465 6620 6f73 6169 735f 696e 6974  ..def osais_init
-00009520: 6961 6c69 7a65 4149 2829 3a0d 0a20 2020  ializeAI():..   
-00009530: 2067 6c6f 6261 6c20 6749 7344 6f63 6b65   global gIsDocke
-00009540: 720d 0a20 2020 2067 6c6f 6261 6c20 6749  r..    global gI
-00009550: 734c 6f63 616c 0d0a 2020 2020 676c 6f62  sLocal..    glob
-00009560: 616c 2067 4973 5669 7274 7561 6c41 490d  al gIsVirtualAI.
-00009570: 0a20 2020 2067 6c6f 6261 6c20 6755 7365  .    global gUse
-00009580: 726e 616d 650d 0a20 2020 2067 6c6f 6261  rname..    globa
-00009590: 6c20 674e 616d 650d 0a20 2020 2067 6c6f  l gName..    glo
-000095a0: 6261 6c20 6750 6f72 7441 490d 0a20 2020  bal gPortAI..   
-000095b0: 2067 6c6f 6261 6c20 6756 6572 7369 6f6e   global gVersion
-000095c0: 0d0a 2020 2020 676c 6f62 616c 2067 506f  ..    global gPo
-000095d0: 7274 4761 7465 7761 790d 0a20 2020 2067  rtGateway..    g
-000095e0: 6c6f 6261 6c20 6750 6f72 744c 6f63 616c  lobal gPortLocal
-000095f0: 4f53 4149 530d 0a20 2020 2067 6c6f 6261  OSAIS..    globa
-00009600: 6c20 6749 504c 6f63 616c 0d0a 2020 2020  l gIPLocal..    
-00009610: 676c 6f62 616c 2067 4578 7449 500d 0a20  global gExtIP.. 
-00009620: 2020 2067 6c6f 6261 6c20 674f 7269 6769     global gOrigi
-00009630: 6e47 6174 6577 6179 0d0a 2020 2020 676c  nGateway..    gl
-00009640: 6f62 616c 2067 4175 7468 546f 6b65 6e0d  obal gAuthToken.
-00009650: 0a20 2020 2067 6c6f 6261 6c20 6741 7574  .    global gAut
-00009660: 6854 6f6b 656e 4c6f 6361 6c0d 0a20 2020  hTokenLocal..   
-00009670: 2067 6c6f 6261 6c20 674f 7269 6769 6e4f   global gOriginO
-00009680: 5341 4953 0d0a 2020 2020 676c 6f62 616c  SAIS..    global
-00009690: 2067 4f72 6967 696e 4c6f 6361 6c4f 5341   gOriginLocalOSA
-000096a0: 4953 0d0a 0d0a 2020 2020 2323 206c 6f61  IS....    ## loa
-000096b0: 6420 656e 7620 0d0a 2020 2020 5f65 6e76  d env ..    _env
-000096c0: 4669 6c65 3d22 656e 765f 6c6f 6361 6c22  File="env_local"
-000096d0: 0d0a 2020 2020 6966 2067 4973 446f 636b  ..    if gIsDock
-000096e0: 6572 3a0d 0a20 2020 2020 2020 205f 656e  er:..        _en
-000096f0: 7646 696c 653d 2265 6e76 5f64 6f63 6b65  vFile="env_docke
-00009700: 7222 0d0a 2020 2020 2020 2020 7072 696e  r"..        prin
-00009710: 7428 225c 725c 6e3d 3e20 696e 2044 6f63  t("\r\n=> in Doc
-00009720: 6b65 725c 725c 6e22 290d 0a20 2020 2065  ker\r\n")..    e
-00009730: 6c73 653a 0d0a 2020 2020 2020 2020 7072  lse:..        pr
-00009740: 696e 7428 225c 725c 6e3d 3e20 4e4f 5420  int("\r\n=> NOT 
-00009750: 696e 2044 6f63 6b65 725c 725c 6e22 2920  in Docker\r\n") 
-00009760: 2020 2020 2020 200d 0a20 2020 206f 626a         ..    obj
-00009770: 3d6f 7361 6973 5f67 6574 456e 7628 5f65  =osais_getEnv(_e
-00009780: 6e76 4669 6c65 290d 0a20 2020 2067 4973  nvFile)..    gIs
-00009790: 4c6f 6361 6c3d 6f62 6a5b 2269 734c 6f63  Local=obj["isLoc
-000097a0: 616c 225d 0d0a 2020 2020 6749 7356 6972  al"]..    gIsVir
-000097b0: 7475 616c 4149 3d6f 626a 5b22 6973 5669  tualAI=obj["isVi
-000097c0: 7274 7561 6c41 4922 5d0d 0a20 2020 2067  rtualAI"]..    g
-000097d0: 5573 6572 6e61 6d65 3d6f 626a 5b22 7573  Username=obj["us
-000097e0: 6572 6e61 6d65 225d 0d0a 2020 2020 674e  ername"]..    gN
-000097f0: 616d 653d 6f62 6a5b 226e 616d 6522 5d0d  ame=obj["name"].
-00009800: 0a0d 0a20 2020 2023 2320 6672 6f6d 2065  ...    ## from e
-00009810: 6e76 2c20 6c6f 6164 2041 4920 636f 6e66  nv, load AI conf
-00009820: 6967 0d0a 2020 2020 6743 6f6e 6669 673d  ig..    gConfig=
-00009830: 6f73 6169 735f 6c6f 6164 436f 6e66 6967  osais_loadConfig
-00009840: 2867 4e61 6d65 290d 0a20 2020 2067 506f  (gName)..    gPo
-00009850: 7274 4149 203d 2067 436f 6e66 6967 5b22  rtAI = gConfig["
-00009860: 706f 7274 225d 0d0a 2020 2020 6756 6572  port"]..    gVer
-00009870: 7369 6f6e 203d 2067 436f 6e66 6967 5b22  sion = gConfig["
-00009880: 7665 7273 696f 6e22 5d0d 0a0d 0a20 2020  version"]....   
-00009890: 2070 7269 6e74 2822 5c72 5c6e 3d3d 3d3d   print("\r\n====
-000098a0: 3d20 436f 6e66 6967 203d 3d3d 3d3d 2229  = Config =====")
-000098b0: 0d0a 2020 2020 7072 696e 7428 2269 7320  ..    print("is 
-000098c0: 4c6f 6361 6c3a 2022 2b73 7472 2867 4973  Local: "+str(gIs
-000098d0: 4c6f 6361 6c29 290d 0a20 2020 2070 7269  Local))..    pri
-000098e0: 6e74 2822 6973 2056 6972 7475 616c 3a20  nt("is Virtual: 
-000098f0: 222b 7374 7228 6749 7356 6972 7475 616c  "+str(gIsVirtual
-00009900: 4149 2929 0d0a 2020 2020 7072 696e 7428  AI))..    print(
-00009910: 226f 776e 6564 2062 7920 636c 6965 6e74  "owned by client
-00009920: 3a20 222b 7374 7228 6755 7365 726e 616d  : "+str(gUsernam
-00009930: 6529 290d 0a20 2020 2070 7269 6e74 2822  e))..    print("
-00009940: 3d3d 3d3d 3d20 2f43 6f6e 6669 6720 3d3d  ===== /Config ==
-00009950: 3d3d 3d5c 725c 6e22 290d 0a0d 0a20 2020  ===\r\n")....   
-00009960: 2023 2320 6d61 6b65 2073 7572 6520 7765   ## make sure we
-00009970: 2068 6176 6520 6120 636f 6e66 6967 2066   have a config f
-00009980: 696c 650d 0a20 2020 205f 6c6f 6164 436f  ile..    _loadCo
-00009990: 6e66 6967 2867 4e61 6d65 290d 0a0d 0a20  nfig(gName).... 
-000099a0: 2020 2023 2320 7768 6572 6520 6973 204f     ## where is O
-000099b0: 5341 4953 2066 6f72 2075 7320 7468 656e  SAIS for us then
-000099c0: 3f0d 0a20 2020 2067 4f72 6967 696e 4761  ?..    gOriginGa
-000099d0: 7465 7761 793d 6622 6874 7470 3a2f 2f7b  teway=f"http://{
-000099e0: 6749 504c 6f63 616c 7d3a 7b67 506f 7274  gIPLocal}:{gPort
-000099f0: 4761 7465 7761 797d 2f22 2020 2020 2020  Gateway}/"      
-00009a00: 2020 2023 2320 636f 6e66 6967 2066 6f72     ## config for
-00009a10: 206c 6f63 616c 2067 6174 6577 6179 2028   local gateway (
-00009a20: 6c6f 6361 6c20 616e 6420 6e6f 7420 7669  local and not vi
-00009a30: 7274 7561 6c29 0d0a 2020 2020 6966 2067  rtual)..    if g
-00009a40: 4973 5669 7274 7561 6c41 493a 0d0a 2020  IsVirtualAI:..  
-00009a50: 2020 2020 2020 6966 2067 4973 4c6f 6361        if gIsLoca
-00009a60: 6c3a 0d0a 2020 2020 2020 2020 2020 2020  l:..            
-00009a70: 6f73 6169 735f 7265 7365 744f 5341 4953  osais_resetOSAIS
-00009a80: 284e 6f6e 652c 2066 2268 7474 703a 2f2f  (None, f"http://
-00009a90: 7b67 4950 4c6f 6361 6c7d 3a7b 6750 6f72  {gIPLocal}:{gPor
-00009aa0: 744c 6f63 616c 4f53 4149 537d 2f22 290d  tLocalOSAIS}/").
-00009ab0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-00009ac0: 2020 2020 2020 2020 2020 2020 6f73 6169              osai
-00009ad0: 735f 7265 7365 744f 5341 4953 2822 6874  s_resetOSAIS("ht
-00009ae0: 7470 733a 2f2f 6f70 656e 736f 7572 6365  tps://opensource
-00009af0: 6169 732e 636f 6d2f 222c 204e 6f6e 6529  ais.com/", None)
-00009b00: 0d0a 2020 2020 2020 2020 7472 793a 0d0a  ..        try:..
-00009b10: 2020 2020 2020 2020 2020 2020 6f73 6169              osai
-00009b20: 735f 6175 7468 656e 7469 6361 7465 4149  s_authenticateAI
-00009b30: 2829 0d0a 2020 2020 2020 2020 6578 6365  ()..        exce
-00009b40: 7074 2045 7863 6570 7469 6f6e 2061 7320  pt Exception as 
-00009b50: 6572 723a 0d0a 2020 2020 2020 2020 2020  err:..          
-00009b60: 2020 7072 696e 7428 223d 3e20 4352 4954    print("=> CRIT
-00009b70: 4943 414c 3a20 436f 756c 6420 6e6f 7420  ICAL: Could not 
-00009b80: 636f 6e6e 6563 7420 7669 7274 7561 6c20  connect virtual 
-00009b90: 4149 2022 2b67 4e61 6d65 2b20 2220 746f  AI "+gName+ " to
-00009ba0: 204f 5341 4953 2229 0d0a 2020 2020 2020   OSAIS")..      
-00009bb0: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
-00009bc0: 650d 0a0d 0a20 2020 2020 2020 2069 6620  e....        if 
-00009bd0: 6741 7574 6854 6f6b 656e 213d 4e6f 6e65  gAuthToken!=None
-00009be0: 3a0d 0a20 2020 2020 2020 2020 2020 2070  :..            p
-00009bf0: 7269 6e74 2822 3d3e 2052 756e 6e69 6e67  rint("=> Running
-00009c00: 2022 2b67 4e61 6d65 2b22 2041 4920 6173   "+gName+" AI as
-00009c10: 2061 2076 6972 7475 616c 2041 4920 636f   a virtual AI co
-00009c20: 6e6e 6563 7465 6420 746f 3a20 222b 674f  nnected to: "+gO
-00009c30: 7269 6769 6e4f 5341 4953 290d 0a20 2020  riginOSAIS)..   
-00009c40: 2020 2020 2069 6620 6741 7574 6854 6f6b       if gAuthTok
-00009c50: 656e 4c6f 6361 6c21 3d4e 6f6e 653a 0d0a  enLocal!=None:..
-00009c60: 2020 2020 2020 2020 2020 2020 7072 696e              prin
-00009c70: 7428 223d 3e20 5275 6e6e 696e 6720 222b  t("=> Running "+
-00009c80: 674e 616d 652b 2220 4149 2061 7320 6120  gName+" AI as a 
-00009c90: 7669 7274 7561 6c20 4149 2063 6f6e 6e65  virtual AI conne
-00009ca0: 6374 6564 2074 6f3a 2022 2b67 4f72 6967  cted to: "+gOrig
-00009cb0: 696e 4c6f 6361 6c4f 5341 4953 290d 0a20  inLocalOSAIS).. 
-00009cc0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00009cd0: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
-00009ce0: 2020 2020 6f73 6169 735f 7265 7365 7447      osais_resetG
-00009cf0: 6174 6577 6179 2867 4f72 6967 696e 4761  ateway(gOriginGa
-00009d00: 7465 7761 7929 0d0a 2020 2020 2020 2020  teway)..        
-00009d10: 2020 2020 7072 696e 7428 223d 3e20 5275      print("=> Ru
-00009d20: 6e6e 696e 6720 222b 674e 616d 652b 2220  nning "+gName+" 
-00009d30: 4149 2061 7320 6120 7365 7276 6572 2063  AI as a server c
-00009d40: 6f6e 6e65 6374 6564 2074 6f20 6c6f 6361  onnected to loca
-00009d50: 6c20 4761 7465 7761 7920 222b 674f 7269  l Gateway "+gOri
-00009d60: 6769 6e47 6174 6577 6179 290d 0a20 2020  ginGateway)..   
-00009d70: 2020 2020 200d 0a20 2020 2020 2020 2065       ..        e
-00009d80: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
-00009d90: 6173 2065 7272 3a0d 0a20 2020 2020 2020  as err:..       
-00009da0: 2020 2020 2070 7269 6e74 2822 4352 4954       print("CRIT
-00009db0: 4943 414c 3a20 636f 756c 6420 6e6f 7420  ICAL: could not 
-00009dc0: 6e6f 7469 6679 2047 6174 6577 6179 2061  notify Gateway a
-00009dd0: 7420 222b 674f 7269 6769 6e47 6174 6577  t "+gOriginGatew
-00009de0: 6179 290d 0a20 2020 2020 2020 2020 2020  ay)..           
-00009df0: 2072 6574 7572 6e20 4e6f 6e65 0d0a 0d0a   return None....
-00009e00: 2020 2020 2323 2069 6e69 7420 6465 6661      ## init defa
-00009e10: 756c 7420 636f 7374 0d0a 2020 2020 5f69  ult cost..    _i
-00009e20: 6e69 7469 616c 697a 6543 6f73 7428 290d  nitializeCost().
-00009e30: 0a0d 0a20 2020 2070 7269 6e74 2822 5c72  ...    print("\r
-00009e40: 5c6e 2229 0d0a 2020 2020 7265 7475 726e  \n")..    return
-00009e50: 2067 4e61 6d65 0d0a 0d0a 2323 202d 2d2d   gName....## ---
-00009e60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009e70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009e80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009e90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009ea0: 2d2d 2d2d 2d0d 0a23 2020 2020 2020 2053  -----..#       S
-00009eb0: 7461 7274 696e 6720 706f 696e 7420 6f66  tarting point of
-00009ec0: 204c 6962 0d0a 2323 202d 2d2d 2d2d 2d2d   Lib..## -------
-00009ed0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009ee0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009ef0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009f00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00009f10: 2d0d 0a0d 0a23 204d 756c 7469 7468 7265  -....# Multithre
-00009f20: 6164 696e 6720 666f 7220 6f62 7365 7276  ading for observ
-00009f30: 6572 730d 0a77 6174 6368 5f64 6972 6563  ers..watch_direc
-00009f40: 746f 7279 3d73 7461 7274 5f6f 6273 6572  tory=start_obser
-00009f50: 7665 725f 7468 7265 6164 285f 6765 744f  ver_thread(_getO
-00009f60: 7574 7075 7444 6972 2829 2c20 6f73 6169  utputDir(), osai
-00009f70: 735f 6f6e 4e6f 7469 6679 4669 6c65 4372  s_onNotifyFileCr
-00009f80: 6561 7465 642c 204e 6f6e 6529 2020 2020  eated, None)    
-00009f90: 200d 0a0d 0a23 636c 6561 6e69 6e67 2064   ....#cleaning d
-00009fa0: 6972 2065 7665 7279 2031 306d 696e 0d0a  ir every 10min..
-00009fb0: 7363 6865 6475 6c65 2e65 7665 7279 2831  schedule.every(1
-00009fc0: 3029 2e6d 696e 7574 6573 2e64 6f28 5f63  0).minutes.do(_c
-00009fd0: 6c65 6172 4469 7229 0d0a 0d0a 7072 696e  learDir)....prin
-00009fe0: 7428 225c 725c 6e50 7974 686f 6e20 4f53  t("\r\nPython OS
-00009ff0: 4149 5320 4c69 6220 6973 206c 6f61 6465  AIS Lib is loade
-0000a000: 642e 2e2e 2229 0d0a 0d0a 0d0a            d...")......
+00007d50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a23 2020  -----------..#  
+00007d60: 2020 2020 2067 6574 2066 6f72 6d61 7474       get formatt
+00007d70: 6564 2070 6172 616d 7320 6672 6f6d 2041  ed params from A
+00007d80: 4920 6375 7272 656e 7420 7374 6174 650d  I current state.
+00007d90: 0a23 2320 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  .## ------------
+00007da0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00007db0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00007dc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00007dd0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a  ------------....
+00007de0: 6465 6620 6765 7443 7265 6473 5061 7261  def getCredsPara
+00007df0: 6d73 2829 203a 0d0a 2020 2020 676c 6f62  ms() :..    glob
+00007e00: 616c 2067 4e61 6d65 0d0a 2020 2020 676c  al gName..    gl
+00007e10: 6f62 616c 2067 4172 6773 4f53 4149 530d  obal gArgsOSAIS.
+00007e20: 0a20 2020 2072 6574 7572 6e20 7b0d 0a20  .    return {.. 
+00007e30: 2020 2020 2020 2022 656e 6769 6e65 223a         "engine":
+00007e40: 2067 4e61 6d65 2c20 0d0a 2020 2020 2020   gName, ..      
+00007e50: 2020 2276 6572 7369 6f6e 223a 2067 5665    "version": gVe
+00007e60: 7273 696f 6e2c 200d 0a20 2020 2020 2020  rsion, ..       
+00007e70: 2022 746f 6b65 6e41 4922 3a20 6741 7267   "tokenAI": gArg
+00007e80: 734f 5341 4953 2e74 6f6b 656e 4149 2c0d  sOSAIS.tokenAI,.
+00007e90: 0a20 2020 2020 2020 2022 7573 6572 6e61  .        "userna
+00007ea0: 6d65 223a 2067 4172 6773 4f53 4149 532e  me": gArgsOSAIS.
+00007eb0: 7573 6572 6e61 6d65 2c0d 0a20 2020 2020  username,..     
+00007ec0: 2020 2022 6973 4c6f 6361 6c22 3a20 6741     "isLocal": gA
+00007ed0: 7267 734f 5341 4953 2e69 734c 6f63 616c  rgsOSAIS.isLocal
+00007ee0: 0d0a 2020 2020 7d20 0d0a 0d0a 6465 6620  ..    } ....def 
+00007ef0: 6765 744d 6f72 7068 696e 6750 6172 616d  getMorphingParam
+00007f00: 7328 2920 3a0d 0a20 2020 2067 6c6f 6261  s() :..    globa
+00007f10: 6c20 6741 7267 734f 5341 4953 0d0a 2020  l gArgsOSAIS..  
+00007f20: 2020 7265 7475 726e 207b 0d0a 2020 2020    return {..    
+00007f30: 2020 2020 2275 6964 223a 2067 4172 6773      "uid": gArgs
+00007f40: 4f53 4149 532e 7569 642c 0d0a 2020 2020  OSAIS.uid,..    
+00007f50: 2020 2020 2263 7963 6c65 223a 2067 4172      "cycle": gAr
+00007f60: 6773 4f53 4149 532e 6379 636c 652c 0d0a  gsOSAIS.cycle,..
+00007f70: 2020 2020 2020 2020 2266 696c 656e 616d          "filenam
+00007f80: 6522 3a20 6741 7267 734f 5341 4953 2e66  e": gArgsOSAIS.f
+00007f90: 696c 656e 616d 652c 200d 0a20 2020 2020  ilename, ..     
+00007fa0: 2020 2022 6f64 6972 223a 205f 6765 744f     "odir": _getO
+00007fb0: 7574 7075 7444 6972 2829 0d0a 2020 2020  utputDir()..    
+00007fc0: 7d0d 0a0d 0a64 6566 2067 6574 5374 6167  }....def getStag
+00007fd0: 6550 6172 616d 7328 5f73 7461 6765 2c20  eParams(_stage, 
+00007fe0: 5f63 6f73 7429 203a 0d0a 2020 2020 676c  _cost) :..    gl
+00007ff0: 6f62 616c 2067 4172 6773 4f53 4149 530d  obal gArgsOSAIS.
+00008000: 0a20 2020 2069 6620 5f73 7461 6765 3d3d  .    if _stage==
+00008010: 4149 5f50 524f 4752 4553 535f 4152 4753  AI_PROGRESS_ARGS
+00008020: 3a0d 0a20 2020 2020 2020 2072 6574 7572  :..        retur
+00008030: 6e20 7b22 7374 6167 6522 3a20 4149 5f50  n {"stage": AI_P
+00008040: 524f 4752 4553 535f 4149 5f53 5441 5254  ROGRESS_AI_START
+00008050: 4544 2c20 2264 6573 6372 223a 224a 7573  ED, "descr":"Jus
+00008060: 7420 7061 7273 6564 2041 4920 7061 7261  t parsed AI para
+00008070: 6d73 227d 0d0a 2020 2020 6966 205f 7374  ms"}..    if _st
+00008080: 6167 653d 3d41 495f 5052 4f47 5245 5353  age==AI_PROGRESS
+00008090: 5f45 5252 4f52 3a0d 0a20 2020 2020 2020  _ERROR:..       
+000080a0: 2072 6574 7572 6e20 7b22 7374 6167 6522   return {"stage"
+000080b0: 3a20 4149 5f50 524f 4752 4553 535f 4149  : AI_PROGRESS_AI
+000080c0: 5f53 544f 5050 4544 2c20 2264 6573 6372  _STOPPED, "descr
+000080d0: 223a 2241 4920 7374 6f70 7065 6420 7769  ":"AI stopped wi
+000080e0: 7468 2065 7272 6f72 227d 0d0a 2020 2020  th error"}..    
+000080f0: 6966 205f 7374 6167 653d 3d41 495f 5052  if _stage==AI_PR
+00008100: 4f47 5245 5353 5f41 495f 5354 4152 5445  OGRESS_AI_STARTE
+00008110: 443a 0d0a 2020 2020 2020 2020 7265 7475  D:..        retu
+00008120: 726e 207b 2273 7461 6765 223a 2041 495f  rn {"stage": AI_
+00008130: 5052 4f47 5245 5353 5f41 495f 5354 4152  PROGRESS_AI_STAR
+00008140: 5445 442c 2022 6465 7363 7222 3a22 4149  TED, "descr":"AI
+00008150: 2073 7461 7274 6564 227d 0d0a 2020 2020   started"}..    
+00008160: 6966 205f 7374 6167 653d 3d41 495f 5052  if _stage==AI_PR
+00008170: 4f47 5245 5353 5f41 495f 5354 4f50 5045  OGRESS_AI_STOPPE
+00008180: 443a 0d0a 2020 2020 2020 2020 7265 7475  D:..        retu
+00008190: 726e 207b 2273 7461 6765 223a 2041 495f  rn {"stage": AI_
+000081a0: 5052 4f47 5245 5353 5f41 495f 5354 4f50  PROGRESS_AI_STOP
+000081b0: 5045 442c 2022 6465 7363 7222 3a22 4149  PED, "descr":"AI
+000081c0: 2073 746f 7070 6564 222c 2022 636f 7374   stopped", "cost
+000081d0: 223a 205f 636f 7374 7d0d 0a20 2020 2069  ": _cost}..    i
+000081e0: 6620 5f73 7461 6765 3d3d 4149 5f50 524f  f _stage==AI_PRO
+000081f0: 4752 4553 535f 494e 4954 5f49 4d41 4745  GRESS_INIT_IMAGE
+00008200: 3a0d 0a20 2020 2020 2020 2072 6574 7572  :..        retur
+00008210: 6e20 7b22 7374 6167 6522 3a20 4149 5f50  n {"stage": AI_P
+00008220: 524f 4752 4553 535f 494e 4954 5f49 4d41  ROGRESS_INIT_IMA
+00008230: 4745 2c20 2264 6573 6372 223a 2264 6573  GE, "descr":"des
+00008240: 7469 6e61 7469 6f6e 2069 6d61 6765 203d  tination image =
+00008250: 2022 2b67 4172 6773 4f53 4149 532e 6669   "+gArgsOSAIS.fi
+00008260: 6c65 6e61 6d65 7d0d 0a20 2020 2069 6620  lename}..    if 
+00008270: 5f73 7461 6765 3d3d 4149 5f50 524f 4752  _stage==AI_PROGR
+00008280: 4553 535f 444f 4e45 5f49 4d41 4745 3a0d  ESS_DONE_IMAGE:.
+00008290: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000082a0: 7b22 7374 6167 6522 3a20 4149 5f50 524f  {"stage": AI_PRO
+000082b0: 4752 4553 535f 444f 4e45 5f49 4d41 4745  GRESS_DONE_IMAGE
+000082c0: 2c20 2264 6573 6372 223a 2263 6f70 6965  , "descr":"copie
+000082d0: 6420 696e 7075 7420 696d 6167 6520 746f  d input image to
+000082e0: 2064 6573 7469 6e61 7469 6f6e 2069 6d61   destination ima
+000082f0: 6765 227d 0d0a 2020 2020 7265 7475 726e  ge"}..    return
+00008300: 207b 2273 7461 6765 223a 2041 495f 5052   {"stage": AI_PR
+00008310: 4f47 5245 5353 5f45 5252 4f52 2c20 2264  OGRESS_ERROR, "d
+00008320: 6573 6372 223a 2265 7272 6f72 227d 0d0a  escr":"error"}..
+00008330: 0d0a 2323 202d 2d2d 2d2d 2d2d 2d2d 2d2d  ..## -----------
+00008340: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00008350: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00008360: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00008370: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a23  -------------..#
+00008380: 2020 2020 2020 204e 6f74 6966 6963 6174         Notificat
+00008390: 696f 6e73 2074 6f20 4761 7465 7761 7920  ions to Gateway 
+000083a0: 2f20 4f53 4149 530d 0a23 2320 2d2d 2d2d  / OSAIS..## ----
+000083b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000083c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000083d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000083e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000083f0: 2d2d 2d2d 0d0a 0d0a 2320 5570 6c6f 6164  ----....# Upload
+00008400: 2069 6d61 6765 2074 6f20 4f53 4149 5320   image to OSAIS 
+00008410: 0d0a 6465 6620 5f75 706c 6f61 6449 6d61  ..def _uploadIma
+00008420: 6765 546f 4f53 4149 5328 6f62 6a50 6172  geToOSAIS(objPar
+00008430: 616d 2c20 6973 4c6f 6361 6c29 3a0d 0a20  am, isLocal):.. 
+00008440: 2020 2069 6620 6749 7356 6972 7475 616c     if gIsVirtual
+00008450: 4149 3d3d 4661 6c73 653a 0d0a 2020 2020  AI==False:..    
+00008460: 2020 2020 7265 7475 726e 204e 6f6e 650d      return None.
+00008470: 0a20 2020 200d 0a20 2020 2067 6c6f 6261  .    ..    globa
+00008480: 6c20 6741 7574 6854 6f6b 656e 0d0a 2020  l gAuthToken..  
+00008490: 2020 676c 6f62 616c 2067 4f72 6967 696e    global gOrigin
+000084a0: 4f53 4149 530d 0a20 2020 2067 6c6f 6261  OSAIS..    globa
+000084b0: 6c20 6741 7574 6854 6f6b 656e 4c6f 6361  l gAuthTokenLoca
+000084c0: 6c0d 0a20 2020 2067 6c6f 6261 6c20 674f  l..    global gO
+000084d0: 7269 6769 6e4c 6f63 616c 4f53 4149 530d  riginLocalOSAIS.
+000084e0: 0a0d 0a20 2020 205f 6175 7468 3d67 4175  ...    _auth=gAu
+000084f0: 7468 546f 6b65 6e0d 0a20 2020 2069 6620  thToken..    if 
+00008500: 6973 4c6f 6361 6c3a 0d0a 2020 2020 2020  isLocal:..      
+00008510: 2020 5f61 7574 683d 6741 7574 6854 6f6b    _auth=gAuthTok
+00008520: 656e 4c6f 6361 6c0d 0a20 2020 205f 6f73  enLocal..    _os
+00008530: 6169 733d 674f 7269 6769 6e4f 5341 4953  ais=gOriginOSAIS
+00008540: 0d0a 2020 2020 6966 2069 734c 6f63 616c  ..    if isLocal
+00008550: 3a0d 0a20 2020 2020 2020 205f 6f73 6169  :..        _osai
+00008560: 733d 674f 7269 6769 6e4c 6f63 616c 4f53  s=gOriginLocalOS
+00008570: 4149 530d 0a0d 0a20 2020 2023 206c 6574  AIS....    # let
+00008580: 7320 676f 2063 616c 6c20 4f53 4149 5320  s go call OSAIS 
+00008590: 4149 2047 6174 6577 6179 202f 206f 7220  AI Gateway / or 
+000085a0: 4f53 4149 5320 6974 7365 6c66 0d0a 2020  OSAIS itself..  
+000085b0: 2020 6865 6164 6572 7320 3d20 7b0d 0a20    headers = {.. 
+000085c0: 2020 2020 2020 2022 436f 6e74 656e 742d         "Content-
+000085d0: 5479 7065 223a 2027 6170 706c 6963 6174  Type": 'applicat
+000085e0: 696f 6e2f 6a73 6f6e 272c 200d 0a20 2020  ion/json', ..   
+000085f0: 2020 2020 2027 4163 6365 7074 273a 2027       'Accept': '
+00008600: 7465 7874 2f70 6c61 696e 272c 0d0a 2020  text/plain',..  
+00008610: 2020 2020 2020 2241 7574 686f 7269 7a61        "Authoriza
+00008620: 7469 6f6e 223a 2066 2242 6561 7265 7220  tion": f"Bearer 
+00008630: 7b5f 6175 7468 7d22 0d0a 2020 2020 7d0d  {_auth}"..    }.
+00008640: 0a0d 0a20 2020 2061 7069 5f75 726c 3d66  ...    api_url=f
+00008650: 227b 5f6f 7361 6973 7d61 7069 2f76 312f  "{_osais}api/v1/
+00008660: 7072 6976 6174 652f 7570 6c6f 6164 2220  private/upload" 
+00008670: 2020 2020 2020 200d 0a20 2020 2070 6179         ..    pay
+00008680: 6c6f 6164 203d 206a 736f 6e2e 6475 6d70  load = json.dump
+00008690: 7328 6f62 6a50 6172 616d 290d 0a20 2020  s(objParam)..   
+000086a0: 2072 6573 706f 6e73 6520 3d20 7265 7175   response = requ
+000086b0: 6573 7473 2e70 6f73 7428 6170 695f 7572  ests.post(api_ur
+000086c0: 6c2c 2068 6561 6465 7273 3d68 6561 6465  l, headers=heade
+000086d0: 7273 2c20 6461 7461 3d70 6179 6c6f 6164  rs, data=payload
+000086e0: 2029 0d0a 2020 2020 6f62 6a52 6573 3d72   )..    objRes=r
+000086f0: 6573 706f 6e73 652e 6a73 6f6e 2829 0d0a  esponse.json()..
+00008700: 2020 2020 7265 7475 726e 206f 626a 5265      return objRe
+00008710: 7320 2020 200d 0a0d 0a64 6566 206f 7361  s    ....def osa
+00008720: 6973 5f6f 6e4e 6f74 6966 7946 696c 6543  is_onNotifyFileC
+00008730: 7265 6174 6564 285f 6469 722c 205f 6669  reated(_dir, _fi
+00008740: 6c65 6e61 6d65 2c20 5f61 7267 7329 3a0d  lename, _args):.
+00008750: 0a20 2020 2067 4172 6773 4f53 4149 532e  .    gArgsOSAIS.
+00008760: 6669 6c65 6e61 6d65 3d5f 6669 6c65 6e61  filename=_filena
+00008770: 6d65 0d0a 2020 2020 5f73 7461 6765 5061  me..    _stagePa
+00008780: 7261 6d3d 6765 7453 7461 6765 5061 7261  ram=getStagePara
+00008790: 6d73 2841 495f 5052 4f47 5245 5353 5f44  ms(AI_PROGRESS_D
+000087a0: 4f4e 455f 494d 4147 452c 2030 290d 0a20  ONE_IMAGE, 0).. 
+000087b0: 2020 205f 6d6f 7270 6869 6e67 5061 7261     _morphingPara
+000087c0: 6d3d 6765 744d 6f72 7068 696e 6750 6172  m=getMorphingPar
+000087d0: 616d 7328 290d 0a20 2020 205f 6372 6564  ams()..    _cred
+000087e0: 7350 6172 616d 3d67 6574 4372 6564 7350  sParam=getCredsP
+000087f0: 6172 616d 7328 290d 0a20 2020 206f 7361  arams()..    osa
+00008800: 6973 5f6e 6f74 6966 7928 5f63 7265 6473  is_notify(_creds
+00008810: 5061 7261 6d2c 205f 6d6f 7270 6869 6e67  Param, _morphing
+00008820: 5061 7261 6d2c 205f 7374 6167 6550 6172  Param, _stagePar
+00008830: 616d 2920 2020 2020 2020 2020 2020 2023  am)            #
+00008840: 204f 5341 4953 204e 6f74 6966 6963 6174   OSAIS Notificat
+00008850: 696f 6e0d 0a20 2020 2072 6574 7572 6e20  ion..    return 
+00008860: 5472 7565 0d0a 0d0a 2320 4469 7265 6374  True....# Direct
+00008870: 204e 6f74 6966 7920 4f53 4149 5320 0d0a   Notify OSAIS ..
+00008880: 6465 6620 6f73 6169 735f 6e6f 7469 6679  def osais_notify
+00008890: 2843 7265 6450 6172 616d 2c20 4d6f 7270  (CredParam, Morp
+000088a0: 6869 6e67 5061 7261 6d2c 2053 7461 6765  hingParam, Stage
+000088b0: 5061 7261 6d29 3a0d 0a20 2020 2067 6c6f  Param):..    glo
+000088c0: 6261 6c20 6749 504c 6f63 616c 0d0a 2020  bal gIPLocal..  
+000088d0: 2020 676c 6f62 616c 2067 506f 7274 4761    global gPortGa
+000088e0: 7465 7761 790d 0a20 2020 2067 6c6f 6261  teway..    globa
+000088f0: 6c20 674f 7269 6769 6e4f 5341 4953 0d0a  l gOriginOSAIS..
+00008900: 2020 2020 676c 6f62 616c 2067 4f72 6967      global gOrig
+00008910: 696e 4c6f 6361 6c4f 5341 4953 0d0a 2020  inLocalOSAIS..  
+00008920: 2020 676c 6f62 616c 2067 4973 5669 7274    global gIsVirt
+00008930: 7561 6c41 490d 0a20 2020 2067 6c6f 6261  ualAI..    globa
+00008940: 6c20 6741 7574 6854 6f6b 656e 0d0a 2020  l gAuthToken..  
+00008950: 2020 676c 6f62 616c 2067 4175 7468 546f    global gAuthTo
+00008960: 6b65 6e4c 6f63 616c 0d0a 2020 2020 676c  kenLocal..    gl
+00008970: 6f62 616c 2067 4c61 7374 4368 6563 6b65  obal gLastChecke
+00008980: 645f 6174 0d0a 2020 2020 676c 6f62 616c  d_at..    global
+00008990: 2067 4973 5761 726d 7570 0d0a 0d0a 2020   gIsWarmup....  
+000089a0: 2020 2323 206e 6f20 6e6f 7469 6669 6361    ## no notifica
+000089b0: 7469 6f6e 206f 6620 7761 726d 7570 0d0a  tion of warmup..
+000089c0: 2020 2020 6966 2067 4973 5761 726d 7570      if gIsWarmup
+000089d0: 3a0d 0a20 2020 2020 2020 2072 6574 7572  :..        retur
+000089e0: 6e20 4e6f 6e65 0d0a 2020 2020 0d0a 2020  n None..    ..  
+000089f0: 2020 674c 6173 7443 6865 636b 6564 5f61    gLastChecked_a
+00008a00: 7420 3d20 6461 7465 7469 6d65 2e75 7463  t = datetime.utc
+00008a10: 6e6f 7728 290d 0a0d 0a20 2020 2023 206e  now()....    # n
+00008a20: 6f74 6966 6963 6174 696f 6e20 636f 6e73  otification cons
+00008a30: 6f6c 6520 6c6f 670d 0a20 2020 206d 6572  ole log..    mer
+00008a40: 6765 6420 3d20 6469 6374 2829 0d0a 2020  ged = dict()..  
+00008a50: 2020 6d65 7267 6564 2e75 7064 6174 6528    merged.update(
+00008a60: 4372 6564 5061 7261 6d29 0d0a 2020 2020  CredParam)..    
+00008a70: 6d65 7267 6564 2e75 7064 6174 6528 4d6f  merged.update(Mo
+00008a80: 7270 6869 6e67 5061 7261 6d29 0d0a 2020  rphingParam)..  
+00008a90: 2020 7072 696e 7428 224e 6f74 6966 794f    print("NotifyO
+00008aa0: 5341 4953 2028 222b 7374 7228 5374 6167  SAIS ("+str(Stag
+00008ab0: 6550 6172 616d 5b22 7374 6167 6522 5d29  eParam["stage"])
+00008ac0: 2b22 2f20 222b 5374 6167 6550 6172 616d  +"/ "+StageParam
+00008ad0: 5b22 6465 7363 7222 5d2b 2229 3a20 222b  ["descr"]+"): "+
+00008ae0: 7374 7228 6d65 7267 6564 2929 0d0a 2020  str(merged))..  
+00008af0: 2020 7072 696e 7428 225c 725c 6e22 290d    print("\r\n").
+00008b00: 0a0d 0a20 2020 205f 6669 6c65 6e61 6d65  ...    _filename
+00008b10: 3d22 220d 0a20 2020 2069 6620 4d6f 7270  =""..    if Morp
+00008b20: 6869 6e67 5061 7261 6d5b 2266 696c 656e  hingParam["filen
+00008b30: 616d 6522 5d21 3d22 223a 0d0a 2020 2020  ame"]!="":..    
+00008b40: 2020 2020 5f66 696c 656e 616d 653d 4d6f      _filename=Mo
+00008b50: 7270 6869 6e67 5061 7261 6d5b 2266 696c  rphingParam["fil
+00008b60: 656e 616d 6522 5d0d 0a0d 0a20 2020 2023  ename"]....    #
+00008b70: 206c 6574 7320 676f 2063 616c 6c20 4f53   lets go call OS
+00008b80: 4149 5320 4149 2047 6174 6577 6179 202f  AIS AI Gateway /
+00008b90: 206f 7220 4f53 4149 5320 6974 7365 6c66   or OSAIS itself
+00008ba0: 0d0a 2020 2020 6865 6164 6572 7320 3d20  ..    headers = 
+00008bb0: 7b0d 0a20 2020 2020 2020 2022 436f 6e74  {..        "Cont
+00008bc0: 656e 742d 5479 7065 223a 2022 6170 706c  ent-Type": "appl
+00008bd0: 6963 6174 696f 6e2f 6a73 6f6e 220d 0a20  ication/json".. 
+00008be0: 2020 207d 0d0a 0d0a 2020 2020 2323 2063     }....    ## c
+00008bf0: 6f6e 6669 6720 666f 7220 6361 6c6c 696e  onfig for callin
+00008c00: 6720 6761 7465 7761 790d 0a20 2020 2061  g gateway..    a
+00008c10: 7069 5f75 726c 203d 2066 227b 674f 7269  pi_url = f"{gOri
+00008c20: 6769 6e47 6174 6577 6179 7d61 7069 2f76  ginGateway}api/v
+00008c30: 312f 7075 626c 6963 2f6e 6f74 6966 7922  1/public/notify"
+00008c40: 0d0a 0d0a 2020 2020 2323 2063 6f6e 6669  ....    ## confi
+00008c50: 6720 666f 7220 6361 6c6c 696e 6720 4f53  g for calling OS
+00008c60: 4149 5320 286e 6f20 6761 7465 7761 7929  AIS (no gateway)
+00008c70: 0d0a 2020 2020 6966 2067 4973 5669 7274  ..    if gIsVirt
+00008c80: 7561 6c41 493a 0d0a 2020 2020 2020 2020  ualAI:..        
+00008c90: 5f6f 7361 6973 3d67 4f72 6967 696e 4f53  _osais=gOriginOS
+00008ca0: 4149 530d 0a20 2020 2020 2020 205f 6175  AIS..        _au
+00008cb0: 7468 3d67 4175 7468 546f 6b65 6e0d 0a0d  th=gAuthToken...
+00008cc0: 0a20 2020 2020 2020 2069 6620 4372 6564  .        if Cred
+00008cd0: 5061 7261 6d5b 2269 734c 6f63 616c 225d  Param["isLocal"]
+00008ce0: 3a0d 0a20 2020 2020 2020 2020 2020 205f  :..            _
+00008cf0: 6f73 6169 733d 674f 7269 6769 6e4c 6f63  osais=gOriginLoc
+00008d00: 616c 4f53 4149 530d 0a20 2020 2020 2020  alOSAIS..       
+00008d10: 2020 2020 205f 6175 7468 3d67 4175 7468       _auth=gAuth
+00008d20: 546f 6b65 6e4c 6f63 616c 0d0a 0d0a 2020  TokenLocal....  
+00008d30: 2020 2020 2020 6966 2067 4973 5669 7274        if gIsVirt
+00008d40: 7561 6c41 493d 3d54 7275 653a 0d0a 2020  ualAI==True:..  
+00008d50: 2020 2020 2020 2020 2020 6865 6164 6572            header
+00008d60: 735b 2241 7574 686f 7269 7a61 7469 6f6e  s["Authorization
+00008d70: 225d 3d20 6622 4265 6172 6572 207b 5f61  "]= f"Bearer {_a
+00008d80: 7574 687d 220d 0a20 2020 2020 2020 2020  uth}"..         
+00008d90: 2020 2061 7069 5f75 726c 3d66 227b 5f6f     api_url=f"{_o
+00008da0: 7361 6973 7d61 7069 2f76 312f 7072 6976  sais}api/v1/priv
+00008db0: 6174 652f 6e6f 7469 6679 220d 0a0d 0a20  ate/notify".... 
+00008dc0: 2020 206f 626a 5061 7261 6d3d 7b0d 0a20     objParam={.. 
+00008dd0: 2020 2020 2020 2022 7265 7370 6f6e 7365         "response
+00008de0: 223a 207b 0d0a 2020 2020 2020 2020 2020  ": {..          
+00008df0: 2020 2274 6f6b 656e 223a 2043 7265 6450    "token": CredP
+00008e00: 6172 616d 5b22 746f 6b65 6e41 4922 5d2c  aram["tokenAI"],
+00008e10: 0d0a 2020 2020 2020 2020 2020 2020 2275  ..            "u
+00008e20: 6964 223a 2073 7472 284d 6f72 7068 696e  id": str(Morphin
+00008e30: 6750 6172 616d 5b22 7569 6422 5d29 2c0d  gParam["uid"]),.
+00008e40: 0a20 2020 2020 2020 2020 2020 2022 7374  .            "st
+00008e50: 6167 6522 3a20 7374 7228 5374 6167 6550  age": str(StageP
+00008e60: 6172 616d 5b22 7374 6167 6522 5d29 2c0d  aram["stage"]),.
+00008e70: 0a20 2020 2020 2020 2020 2020 2022 6379  .            "cy
+00008e80: 636c 6522 3a20 7374 7228 4d6f 7270 6869  cle": str(Morphi
+00008e90: 6e67 5061 7261 6d5b 2263 7963 6c65 225d  ngParam["cycle"]
+00008ea0: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
+00008eb0: 2265 6e67 696e 6522 3a20 4372 6564 5061  "engine": CredPa
+00008ec0: 7261 6d5b 2265 6e67 696e 6522 5d2c 0d0a  ram["engine"],..
+00008ed0: 2020 2020 2020 2020 2020 2020 2275 7365              "use
+00008ee0: 726e 616d 6522 3a20 4372 6564 5061 7261  rname": CredPara
+00008ef0: 6d5b 2275 7365 726e 616d 6522 5d2c 0d0a  m["username"],..
+00008f00: 2020 2020 2020 2020 2020 2020 2264 6573              "des
+00008f10: 6372 223a 2053 7461 6765 5061 7261 6d5b  cr": StageParam[
+00008f20: 2264 6573 6372 225d 2c0d 0a20 2020 2020  "descr"],..     
+00008f30: 2020 2020 2020 2022 6669 6c65 6e61 6d65         "filename
+00008f40: 223a 205f 6669 6c65 6e61 6d65 0d0a 2020  ": _filename..  
+00008f50: 2020 2020 2020 7d0d 0a20 2020 207d 0d0a        }..    }..
+00008f60: 0d0a 2020 2020 6966 2022 636f 7374 2220  ..    if "cost" 
+00008f70: 696e 2053 7461 6765 5061 7261 6d3a 0d0a  in StageParam:..
+00008f80: 2020 2020 2020 2020 6f62 6a50 6172 616d          objParam
+00008f90: 5b22 7265 7370 6f6e 7365 225d 5b22 636f  ["response"]["co
+00008fa0: 7374 225d 3d20 7374 7228 5374 6167 6550  st"]= str(StageP
+00008fb0: 6172 616d 5b22 636f 7374 225d 290d 0a20  aram["cost"]).. 
+00008fc0: 2020 200d 0a20 2020 2072 6573 706f 6e73     ..    respons
+00008fd0: 6520 3d20 7265 7175 6573 7473 2e70 6f73  e = requests.pos
+00008fe0: 7428 6170 695f 7572 6c2c 2068 6561 6465  t(api_url, heade
+00008ff0: 7273 3d68 6561 6465 7273 2c20 6461 7461  rs=headers, data
+00009000: 3d6a 736f 6e2e 6475 6d70 7328 6f62 6a50  =json.dumps(objP
+00009010: 6172 616d 2920 290d 0a20 2020 206f 626a  aram) )..    obj
+00009020: 5265 733d 7265 7370 6f6e 7365 2e6a 736f  Res=response.jso
+00009030: 6e28 290d 0a0d 0a20 2020 2069 6620 5374  n()....    if St
+00009040: 6167 6550 6172 616d 5b22 7374 6167 6522  ageParam["stage"
+00009050: 5d3d 3d41 495f 5052 4f47 5245 5353 5f44  ]==AI_PROGRESS_D
+00009060: 4f4e 455f 494d 4147 453a 0d0a 2020 2020  ONE_IMAGE:..    
+00009070: 2020 2020 6966 2067 4973 5669 7274 7561      if gIsVirtua
+00009080: 6c41 493d 3d54 7275 653a 0d0a 2020 2020  lAI==True:..    
+00009090: 2020 2020 2020 2020 5f64 6972 3d4d 6f72          _dir=Mor
+000090a0: 7068 696e 6750 6172 616d 5b22 6f64 6972  phingParam["odir
+000090b0: 225d 0d0a 2020 2020 2020 2020 2020 2020  "]..            
+000090c0: 6966 205f 6469 723d 3d4e 6f6e 653a 0d0a  if _dir==None:..
+000090d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000090e0: 5f64 6972 3d67 4f75 7470 7574 4469 720d  _dir=gOutputDir.
+000090f0: 0a20 2020 2020 2020 2020 2020 205f 6469  .            _di
+00009100: 7249 6d61 6765 3d5f 6469 722b 5f66 696c  rImage=_dir+_fil
+00009110: 656e 616d 650d 0a0d 0a20 2020 2020 2020  ename....       
+00009120: 2020 2020 2077 6974 6820 6f70 656e 285f       with open(_
+00009130: 6469 7249 6d61 6765 2c20 2272 6222 2920  dirImage, "rb") 
+00009140: 6173 2069 6d61 6765 5f66 696c 653a 0d0a  as image_file:..
+00009150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009160: 696d 6167 655f 6461 7461 203d 2069 6d61  image_data = ima
+00009170: 6765 5f66 696c 652e 7265 6164 2829 0d0a  ge_file.read()..
+00009180: 0d0a 2020 2020 2020 2020 2020 2020 696d  ..            im
+00009190: 5f62 3634 203d 2062 6173 6536 342e 6236  _b64 = base64.b6
+000091a0: 3465 6e63 6f64 6528 696d 6167 655f 6461  4encode(image_da
+000091b0: 7461 292e 6465 636f 6465 2822 7574 6638  ta).decode("utf8
+000091c0: 2229 0d0a 2020 2020 2020 2020 2020 2020  ")..            
+000091d0: 7061 7261 6d3d 7b0d 0a20 2020 2020 2020  param={..       
+000091e0: 2020 2020 2020 2020 2022 696d 6167 6522           "image"
+000091f0: 3a20 696d 5f62 3634 2c0d 0a20 2020 2020  : im_b64,..     
+00009200: 2020 2020 2020 2020 2020 2022 7569 6422             "uid"
+00009210: 3a20 7374 7228 4d6f 7270 6869 6e67 5061  : str(MorphingPa
+00009220: 7261 6d5b 2275 6964 225d 292c 0d0a 2020  ram["uid"]),..  
+00009230: 2020 2020 2020 2020 2020 2020 2020 2263                "c
+00009240: 7963 6c65 223a 2073 7472 284d 6f72 7068  ycle": str(Morph
+00009250: 696e 6750 6172 616d 5b22 6379 636c 6522  ingParam["cycle"
+00009260: 5d29 2c0d 0a20 2020 2020 2020 2020 2020  ]),..           
+00009270: 2020 2020 2022 656e 6769 6e65 223a 2043       "engine": C
+00009280: 7265 6450 6172 616d 5b22 656e 6769 6e65  redParam["engine
+00009290: 225d 2c0d 0a20 2020 2020 2020 2020 2020  "],..           
+000092a0: 207d 2020 2020 2020 2020 2020 2020 0d0a   }            ..
+000092b0: 2020 2020 2020 2020 2020 2020 5f75 706c              _upl
+000092c0: 6f61 6449 6d61 6765 546f 4f53 4149 5328  oadImageToOSAIS(
+000092d0: 7061 7261 6d2c 2043 7265 6450 6172 616d  param, CredParam
+000092e0: 5b22 6973 4c6f 6361 6c22 5d29 0d0a 2020  ["isLocal"])..  
+000092f0: 2020 7265 7475 726e 206f 626a 5265 730d    return objRes.
+00009300: 0a0d 0a23 2320 2d2d 2d2d 2d2d 2d2d 2d2d  ...## ----------
+00009310: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009320: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009330: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009340: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  --------------..
+00009350: 2320 2020 2020 2020 496e 6974 2070 726f  #       Init pro
+00009360: 6365 7373 696e 670d 0a23 2320 2d2d 2d2d  cessing..## ----
+00009370: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009380: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009390: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000093a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000093b0: 2d2d 2d2d 0d0a 0d0a 2323 2050 5542 4c49  ----....## PUBLI
+000093c0: 4320 2d20 7265 7365 7474 696e 6720 7768  C - resetting wh
+000093d0: 6f20 7468 6973 2041 4920 6973 2074 616c  o this AI is tal
+000093e0: 6b69 6e67 2074 6f20 284f 5341 4953 2070  king to (OSAIS p
+000093f0: 726f 6420 616e 6420 6462 6729 0d0a 6465  rod and dbg)..de
+00009400: 6620 6f73 6169 735f 7265 7365 744f 5341  f osais_resetOSA
+00009410: 4953 285f 6c6f 6361 7469 6f6e 5072 6f64  IS(_locationProd
+00009420: 2c20 5f6c 6f63 616c 7469 6f6e 4465 6275  , _localtionDebu
+00009430: 6729 3a0d 0a20 2020 2067 6c6f 6261 6c20  g):..    global 
+00009440: 674f 7269 6769 6e4f 5341 4953 0d0a 2020  gOriginOSAIS..  
+00009450: 2020 676c 6f62 616c 2067 4f72 6967 696e    global gOrigin
+00009460: 4c6f 6361 6c4f 5341 4953 0d0a 2020 2020  LocalOSAIS..    
+00009470: 674f 7269 6769 6e4f 5341 4953 3d5f 6c6f  gOriginOSAIS=_lo
+00009480: 6361 7469 6f6e 5072 6f64 0d0a 2020 2020  cationProd..    
+00009490: 674f 7269 6769 6e4c 6f63 616c 4f53 4149  gOriginLocalOSAI
+000094a0: 533d 5f6c 6f63 616c 7469 6f6e 4465 6275  S=_localtionDebu
+000094b0: 670d 0a20 2020 2069 6620 5f6c 6f63 6174  g..    if _locat
+000094c0: 696f 6e50 726f 6421 3d4e 6f6e 653a 0d0a  ionProd!=None:..
+000094d0: 2020 2020 2020 2020 7072 696e 7428 223d          print("=
+000094e0: 3e20 5468 6973 2041 4920 6973 2072 6573  > This AI is res
+000094f0: 6574 2074 6f20 7461 6c6b 2074 6f20 5052  et to talk to PR
+00009500: 4f44 2022 2b67 4f72 6967 696e 4f53 4149  OD "+gOriginOSAI
+00009510: 5329 0d0a 2020 2020 6966 205f 6c6f 6361  S)..    if _loca
+00009520: 6c74 696f 6e44 6562 7567 213d 4e6f 6e65  ltionDebug!=None
+00009530: 3a0d 0a20 2020 2020 2020 2070 7269 6e74  :..        print
+00009540: 2822 3d3e 2054 6869 7320 4149 2069 7320  ("=> This AI is 
+00009550: 7265 7365 7420 746f 2074 616c 6b20 746f  reset to talk to
+00009560: 2044 4542 5547 2022 2b67 4f72 6967 696e   DEBUG "+gOrigin
+00009570: 4c6f 6361 6c4f 5341 4953 2b22 5c72 5c6e  LocalOSAIS+"\r\n
+00009580: 2229 0d0a 2020 2020 7265 7475 726e 2054  ")..    return T
+00009590: 7275 650d 0a0d 0a23 2320 5055 424c 4943  rue....## PUBLIC
+000095a0: 202d 2049 6e69 7420 7468 6520 5669 7274   - Init the Virt
+000095b0: 7561 6c20 4149 0d0a 6465 6620 6f73 6169  ual AI..def osai
+000095c0: 735f 696e 6974 6961 6c69 7a65 4149 2829  s_initializeAI()
+000095d0: 3a0d 0a20 2020 2067 6c6f 6261 6c20 6749  :..    global gI
+000095e0: 7344 6f63 6b65 720d 0a20 2020 2067 6c6f  sDocker..    glo
+000095f0: 6261 6c20 6749 734c 6f63 616c 0d0a 2020  bal gIsLocal..  
+00009600: 2020 676c 6f62 616c 2067 4973 5669 7274    global gIsVirt
+00009610: 7561 6c41 490d 0a20 2020 2067 6c6f 6261  ualAI..    globa
+00009620: 6c20 6755 7365 726e 616d 650d 0a20 2020  l gUsername..   
+00009630: 2067 6c6f 6261 6c20 674e 616d 650d 0a20   global gName.. 
+00009640: 2020 2067 6c6f 6261 6c20 6750 6f72 7441     global gPortA
+00009650: 490d 0a20 2020 2067 6c6f 6261 6c20 6756  I..    global gV
+00009660: 6572 7369 6f6e 0d0a 2020 2020 676c 6f62  ersion..    glob
+00009670: 616c 2067 506f 7274 4761 7465 7761 790d  al gPortGateway.
+00009680: 0a20 2020 2067 6c6f 6261 6c20 6750 6f72  .    global gPor
+00009690: 744c 6f63 616c 4f53 4149 530d 0a20 2020  tLocalOSAIS..   
+000096a0: 2067 6c6f 6261 6c20 6749 504c 6f63 616c   global gIPLocal
+000096b0: 0d0a 2020 2020 676c 6f62 616c 2067 4578  ..    global gEx
+000096c0: 7449 500d 0a20 2020 2067 6c6f 6261 6c20  tIP..    global 
+000096d0: 674f 7269 6769 6e47 6174 6577 6179 0d0a  gOriginGateway..
+000096e0: 2020 2020 676c 6f62 616c 2067 4175 7468      global gAuth
+000096f0: 546f 6b65 6e0d 0a20 2020 2067 6c6f 6261  Token..    globa
+00009700: 6c20 6741 7574 6854 6f6b 656e 4c6f 6361  l gAuthTokenLoca
+00009710: 6c0d 0a20 2020 2067 6c6f 6261 6c20 674f  l..    global gO
+00009720: 7269 6769 6e4f 5341 4953 0d0a 2020 2020  riginOSAIS..    
+00009730: 676c 6f62 616c 2067 4f72 6967 696e 4c6f  global gOriginLo
+00009740: 6361 6c4f 5341 4953 0d0a 0d0a 2020 2020  calOSAIS....    
+00009750: 2323 206c 6f61 6420 656e 7620 0d0a 2020  ## load env ..  
+00009760: 2020 5f65 6e76 4669 6c65 3d22 656e 765f    _envFile="env_
+00009770: 6c6f 6361 6c22 0d0a 2020 2020 6966 2067  local"..    if g
+00009780: 4973 446f 636b 6572 3a0d 0a20 2020 2020  IsDocker:..     
+00009790: 2020 205f 656e 7646 696c 653d 2265 6e76     _envFile="env
+000097a0: 5f64 6f63 6b65 7222 0d0a 2020 2020 2020  _docker"..      
+000097b0: 2020 7072 696e 7428 225c 725c 6e3d 3e20    print("\r\n=> 
+000097c0: 696e 2044 6f63 6b65 725c 725c 6e22 290d  in Docker\r\n").
+000097d0: 0a20 2020 2065 6c73 653a 0d0a 2020 2020  .    else:..    
+000097e0: 2020 2020 7072 696e 7428 225c 725c 6e3d      print("\r\n=
+000097f0: 3e20 4e4f 5420 696e 2044 6f63 6b65 725c  > NOT in Docker\
+00009800: 725c 6e22 2920 2020 2020 2020 200d 0a20  r\n")        .. 
+00009810: 2020 206f 626a 3d6f 7361 6973 5f67 6574     obj=osais_get
+00009820: 456e 7628 5f65 6e76 4669 6c65 290d 0a20  Env(_envFile).. 
+00009830: 2020 2067 4973 4c6f 6361 6c3d 6f62 6a5b     gIsLocal=obj[
+00009840: 2269 734c 6f63 616c 225d 0d0a 2020 2020  "isLocal"]..    
+00009850: 6749 7356 6972 7475 616c 4149 3d6f 626a  gIsVirtualAI=obj
+00009860: 5b22 6973 5669 7274 7561 6c41 4922 5d0d  ["isVirtualAI"].
+00009870: 0a20 2020 2067 5573 6572 6e61 6d65 3d6f  .    gUsername=o
+00009880: 626a 5b22 7573 6572 6e61 6d65 225d 0d0a  bj["username"]..
+00009890: 2020 2020 674e 616d 653d 6f62 6a5b 226e      gName=obj["n
+000098a0: 616d 6522 5d0d 0a0d 0a20 2020 2023 2320  ame"]....    ## 
+000098b0: 6672 6f6d 2065 6e76 2c20 6c6f 6164 2041  from env, load A
+000098c0: 4920 636f 6e66 6967 0d0a 2020 2020 6743  I config..    gC
+000098d0: 6f6e 6669 673d 6f73 6169 735f 6c6f 6164  onfig=osais_load
+000098e0: 436f 6e66 6967 2867 4e61 6d65 290d 0a20  Config(gName).. 
+000098f0: 2020 2067 506f 7274 4149 203d 2067 436f     gPortAI = gCo
+00009900: 6e66 6967 5b22 706f 7274 225d 0d0a 2020  nfig["port"]..  
+00009910: 2020 6756 6572 7369 6f6e 203d 2067 436f    gVersion = gCo
+00009920: 6e66 6967 5b22 7665 7273 696f 6e22 5d0d  nfig["version"].
+00009930: 0a0d 0a20 2020 2070 7269 6e74 2822 5c72  ...    print("\r
+00009940: 5c6e 3d3d 3d3d 3d20 436f 6e66 6967 203d  \n===== Config =
+00009950: 3d3d 3d3d 2229 0d0a 2020 2020 7072 696e  ====")..    prin
+00009960: 7428 2269 7320 4c6f 6361 6c3a 2022 2b73  t("is Local: "+s
+00009970: 7472 2867 4973 4c6f 6361 6c29 290d 0a20  tr(gIsLocal)).. 
+00009980: 2020 2070 7269 6e74 2822 6973 2056 6972     print("is Vir
+00009990: 7475 616c 3a20 222b 7374 7228 6749 7356  tual: "+str(gIsV
+000099a0: 6972 7475 616c 4149 2929 0d0a 2020 2020  irtualAI))..    
+000099b0: 7072 696e 7428 226f 776e 6564 2062 7920  print("owned by 
+000099c0: 636c 6965 6e74 3a20 222b 7374 7228 6755  client: "+str(gU
+000099d0: 7365 726e 616d 6529 290d 0a20 2020 2070  sername))..    p
+000099e0: 7269 6e74 2822 3d3d 3d3d 3d20 2f43 6f6e  rint("===== /Con
+000099f0: 6669 6720 3d3d 3d3d 3d5c 725c 6e22 290d  fig =====\r\n").
+00009a00: 0a0d 0a20 2020 2023 2320 6d61 6b65 2073  ...    ## make s
+00009a10: 7572 6520 7765 2068 6176 6520 6120 636f  ure we have a co
+00009a20: 6e66 6967 2066 696c 650d 0a20 2020 205f  nfig file..    _
+00009a30: 6c6f 6164 436f 6e66 6967 2867 4e61 6d65  loadConfig(gName
+00009a40: 290d 0a0d 0a20 2020 2023 2320 7768 6572  )....    ## wher
+00009a50: 6520 6973 204f 5341 4953 2066 6f72 2075  e is OSAIS for u
+00009a60: 7320 7468 656e 3f0d 0a20 2020 2067 4f72  s then?..    gOr
+00009a70: 6967 696e 4761 7465 7761 793d 6622 6874  iginGateway=f"ht
+00009a80: 7470 3a2f 2f7b 6749 504c 6f63 616c 7d3a  tp://{gIPLocal}:
+00009a90: 7b67 506f 7274 4761 7465 7761 797d 2f22  {gPortGateway}/"
+00009aa0: 2020 2020 2020 2020 2023 2320 636f 6e66           ## conf
+00009ab0: 6967 2066 6f72 206c 6f63 616c 2067 6174  ig for local gat
+00009ac0: 6577 6179 2028 6c6f 6361 6c20 616e 6420  eway (local and 
+00009ad0: 6e6f 7420 7669 7274 7561 6c29 0d0a 2020  not virtual)..  
+00009ae0: 2020 6966 2067 4973 5669 7274 7561 6c41    if gIsVirtualA
+00009af0: 493a 0d0a 2020 2020 2020 2020 6966 2067  I:..        if g
+00009b00: 4973 4c6f 6361 6c3a 0d0a 2020 2020 2020  IsLocal:..      
+00009b10: 2020 2020 2020 6f73 6169 735f 7265 7365        osais_rese
+00009b20: 744f 5341 4953 284e 6f6e 652c 2066 2268  tOSAIS(None, f"h
+00009b30: 7474 703a 2f2f 7b67 4950 4c6f 6361 6c7d  ttp://{gIPLocal}
+00009b40: 3a7b 6750 6f72 744c 6f63 616c 4f53 4149  :{gPortLocalOSAI
+00009b50: 537d 2f22 290d 0a20 2020 2020 2020 2065  S}/")..        e
+00009b60: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
+00009b70: 2020 6f73 6169 735f 7265 7365 744f 5341    osais_resetOSA
+00009b80: 4953 2822 6874 7470 733a 2f2f 6f70 656e  IS("https://open
+00009b90: 736f 7572 6365 6169 732e 636f 6d2f 222c  sourceais.com/",
+00009ba0: 204e 6f6e 6529 0d0a 2020 2020 2020 2020   None)..        
+00009bb0: 7472 793a 0d0a 2020 2020 2020 2020 2020  try:..          
+00009bc0: 2020 6f73 6169 735f 6175 7468 656e 7469    osais_authenti
+00009bd0: 6361 7465 4149 2829 0d0a 2020 2020 2020  cateAI()..      
+00009be0: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
+00009bf0: 6f6e 2061 7320 6572 723a 0d0a 2020 2020  on as err:..    
+00009c00: 2020 2020 2020 2020 7072 696e 7428 223d          print("=
+00009c10: 3e20 4352 4954 4943 414c 3a20 436f 756c  > CRITICAL: Coul
+00009c20: 6420 6e6f 7420 636f 6e6e 6563 7420 7669  d not connect vi
+00009c30: 7274 7561 6c20 4149 2022 2b67 4e61 6d65  rtual AI "+gName
+00009c40: 2b20 2220 746f 204f 5341 4953 2229 0d0a  + " to OSAIS")..
+00009c50: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00009c60: 726e 204e 6f6e 650d 0a0d 0a20 2020 2020  rn None....     
+00009c70: 2020 2069 6620 6741 7574 6854 6f6b 656e     if gAuthToken
+00009c80: 213d 4e6f 6e65 3a0d 0a20 2020 2020 2020  !=None:..       
+00009c90: 2020 2020 2070 7269 6e74 2822 3d3e 2052       print("=> R
+00009ca0: 756e 6e69 6e67 2022 2b67 4e61 6d65 2b22  unning "+gName+"
+00009cb0: 2041 4920 6173 2061 2076 6972 7475 616c   AI as a virtual
+00009cc0: 2041 4920 636f 6e6e 6563 7465 6420 746f   AI connected to
+00009cd0: 3a20 222b 674f 7269 6769 6e4f 5341 4953  : "+gOriginOSAIS
+00009ce0: 290d 0a20 2020 2020 2020 2069 6620 6741  )..        if gA
+00009cf0: 7574 6854 6f6b 656e 4c6f 6361 6c21 3d4e  uthTokenLocal!=N
+00009d00: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
+00009d10: 2020 7072 696e 7428 223d 3e20 5275 6e6e    print("=> Runn
+00009d20: 696e 6720 222b 674e 616d 652b 2220 4149  ing "+gName+" AI
+00009d30: 2061 7320 6120 7669 7274 7561 6c20 4149   as a virtual AI
+00009d40: 2063 6f6e 6e65 6374 6564 2074 6f3a 2022   connected to: "
+00009d50: 2b67 4f72 6967 696e 4c6f 6361 6c4f 5341  +gOriginLocalOSA
+00009d60: 4953 290d 0a20 2020 2065 6c73 653a 0d0a  IS)..    else:..
+00009d70: 2020 2020 2020 2020 7472 793a 0d0a 2020          try:..  
+00009d80: 2020 2020 2020 2020 2020 6f73 6169 735f            osais_
+00009d90: 7265 7365 7447 6174 6577 6179 2867 4f72  resetGateway(gOr
+00009da0: 6967 696e 4761 7465 7761 7929 0d0a 2020  iginGateway)..  
+00009db0: 2020 2020 2020 2020 2020 7072 696e 7428            print(
+00009dc0: 223d 3e20 5275 6e6e 696e 6720 222b 674e  "=> Running "+gN
+00009dd0: 616d 652b 2220 4149 2061 7320 6120 7365  ame+" AI as a se
+00009de0: 7276 6572 2063 6f6e 6e65 6374 6564 2074  rver connected t
+00009df0: 6f20 6c6f 6361 6c20 4761 7465 7761 7920  o local Gateway 
+00009e00: 222b 674f 7269 6769 6e47 6174 6577 6179  "+gOriginGateway
+00009e10: 290d 0a20 2020 2020 2020 200d 0a20 2020  )..        ..   
+00009e20: 2020 2020 2065 7863 6570 7420 4578 6365       except Exce
+00009e30: 7074 696f 6e20 6173 2065 7272 3a0d 0a20  ption as err:.. 
+00009e40: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00009e50: 2822 4352 4954 4943 414c 3a20 636f 756c  ("CRITICAL: coul
+00009e60: 6420 6e6f 7420 6e6f 7469 6679 2047 6174  d not notify Gat
+00009e70: 6577 6179 2061 7420 222b 674f 7269 6769  eway at "+gOrigi
+00009e80: 6e47 6174 6577 6179 290d 0a20 2020 2020  nGateway)..     
+00009e90: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
+00009ea0: 6e65 0d0a 0d0a 2020 2020 2323 2069 6e69  ne....    ## ini
+00009eb0: 7420 6465 6661 756c 7420 636f 7374 0d0a  t default cost..
+00009ec0: 2020 2020 5f69 6e69 7469 616c 697a 6543      _initializeC
+00009ed0: 6f73 7428 290d 0a0d 0a20 2020 2070 7269  ost()....    pri
+00009ee0: 6e74 2822 5c72 5c6e 2229 0d0a 2020 2020  nt("\r\n")..    
+00009ef0: 7265 7475 726e 2067 4e61 6d65 0d0a 0d0a  return gName....
+00009f00: 2323 202d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ## -------------
+00009f10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009f20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009f30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009f40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a23 2020  -----------..#  
+00009f50: 2020 2020 2053 7461 7274 696e 6720 706f       Starting po
+00009f60: 696e 7420 6f66 204c 6962 0d0a 2323 202d  int of Lib..## -
+00009f70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009f80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009f90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009fa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00009fb0: 2d2d 2d2d 2d2d 2d0d 0a0d 0a23 204d 756c  -------....# Mul
+00009fc0: 7469 7468 7265 6164 696e 6720 666f 7220  tithreading for 
+00009fd0: 6f62 7365 7276 6572 730d 0a77 6174 6368  observers..watch
+00009fe0: 5f64 6972 6563 746f 7279 3d73 7461 7274  _directory=start
+00009ff0: 5f6f 6273 6572 7665 725f 7468 7265 6164  _observer_thread
+0000a000: 285f 6765 744f 7574 7075 7444 6972 2829  (_getOutputDir()
+0000a010: 2c20 6f73 6169 735f 6f6e 4e6f 7469 6679  , osais_onNotify
+0000a020: 4669 6c65 4372 6561 7465 642c 204e 6f6e  FileCreated, Non
+0000a030: 6529 2020 2020 200d 0a0d 0a23 636c 6561  e)     ....#clea
+0000a040: 6e69 6e67 2064 6972 2065 7665 7279 2031  ning dir every 1
+0000a050: 306d 696e 0d0a 7363 6865 6475 6c65 2e65  0min..schedule.e
+0000a060: 7665 7279 2831 3029 2e6d 696e 7574 6573  very(10).minutes
+0000a070: 2e64 6f28 5f63 6c65 6172 4469 7229 0d0a  .do(_clearDir)..
+0000a080: 0d0a 7072 696e 7428 225c 725c 6e50 7974  ..print("\r\nPyt
+0000a090: 686f 6e20 4f53 4149 5320 4c69 6220 6973  hon OSAIS Lib is
+0000a0a0: 206c 6f61 6465 642e 2e2e 2229 0d0a 0d0a   loaded...")....
+0000a0b0: 0d0a                                     ..
```

### Comparing `osais-1.0.31/osais.egg-info/PKG-INFO` & `osais-1.0.32/osais.egg-info/PKG-INFO`

 * *Files 24% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: osais
-Version: 1.0.31
+Version: 1.0.32
 Summary: The osais Python lib for connecting AIs to OSAIS cloud
 Home-page: https://github.com/incubiq/osais
 Author: incubiq
 Author-email: eric@incubiq.com
 Keywords: osais,opensourceais
 Classifier: Development Status :: 3 - Alpha
 Classifier: Intended Audience :: Developers
```

### Comparing `osais-1.0.31/setup.py` & `osais-1.0.32/setup.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,12 +1,12 @@
 from setuptools import setup, find_packages
 
 setup(
     name='osais',
-    version='1.0.31',
+    version='1.0.32',
     author='incubiq',
     author_email='eric@incubiq.com',
     description='The osais Python lib for connecting AIs to OSAIS cloud',
     long_description=open('README.md').read(),
     long_description_content_type='text/markdown',
     url='https://github.com/incubiq/osais',
     keywords = "osais, opensourceais",
```

